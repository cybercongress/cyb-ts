{"version":3,"file":"775.8cd4fdf0.chunk.js","mappings":";+GAGA,MAAMA,GAAa,EACbC,GAAe,EAGfC,EAAiB,EACjBC,EAAY,EAIZC,EAAkB,EAClBC,EAAQ,EAGRC,EAAmB,EAEnBC,EAAa,KACbC,EAAY,KAEZC,EAAc,KASdC,EAAgC,EAChCC,EAAmC,EACnCC,EAAoC,EACpCC,EAAuB,GACvBC,EAAsB,GACtBC,EAAa,GAEbC,EAAmC,oBAAnBC,eAChBC,EAAOC,SACPC,EAAY,KAGlB,SAASC,EAAcC,EAAQC,GAC7B,MAAMC,EAAM,IAAIC,YAAYH,GACtBI,EAAM,IAAIC,YAAYL,GAC5B,IAAIM,EAASJ,EAAKD,EAAMtB,IAAiB,KAAO,EAC5C4B,EAASN,IAAQ,EACrB,GAAIK,GAAUR,EAAW,OAAOU,OAAOC,aAAaC,MAAMF,OAAQJ,EAAIO,SAASJ,EAAQA,EAASD,IAChG,MAAMM,EAAQ,GACd,EAAG,CACD,MAAMC,EAAOT,EAAIG,EAAST,EAAY,GAChCgB,EAAOD,GAAQ,OAAUA,EAAO,MAASf,EAAY,EAAIA,EAC/Dc,EAAMG,KAAKP,OAAOC,aAAaC,MAAMF,OAAQJ,EAAIO,SAASJ,EAAQA,GAAUO,KAC5ER,GAAUQ,CACZ,OAASR,EAASR,GAClB,OAAOc,EAAMI,KAAK,IAAMR,OAAOC,aAAaC,MAAMF,OAAQJ,EAAIO,SAASJ,EAAQA,EAASD,GAC1F,CAGA,SAASW,EAAeC,GACtB,MAAMC,EAAa,CAAC,EAEpB,SAASC,EAAUC,EAAQpB,GACzB,OAAKoB,EACEtB,EAAcsB,EAAOrB,OAAQC,GADhB,eAEtB,CAGA,MAAMqB,EAAOJ,EAAQI,IAAMJ,EAAQI,KAAO,CAAC,EAY3C,OAXAA,EAAIC,MAAQD,EAAIC,OAAS,SAAeC,EAAMC,EAAMC,EAAMC,GACxD,MAAMN,EAASF,EAAWE,QAAUC,EAAID,OACxC,MAAMO,MAAM,UAAYR,EAAUC,EAAQG,GAAQ,OAASJ,EAAUC,EAAQI,GAAQ,IAAMC,EAAO,IAAMC,EAC1G,EACAL,EAAIO,MAAQP,EAAIO,OAAS,SAAeL,EAAMM,GAC5C,MAAMT,EAASF,EAAWE,QAAUC,EAAID,OACxCU,EAAQC,IAAI,UAAYZ,EAAUC,EAAQG,IAASM,EAAI,IAAM,IAAMG,MAAMC,UAAUC,MAAMC,KAAKC,UAAW,EAAG,EAAIP,GAAGd,KAAK,MAC1H,EACAE,EAAQoB,KAAOpB,EAAQoB,MAAQA,KAC/BpB,EAAQqB,KAAOrB,EAAQqB,MAAQA,KAExBpB,CACT,CAGA,SAASqB,EAAgBrB,EAAYsB,GACnC,MAAMC,EAAaD,EAASE,QACtBtB,EAASqB,EAAWrB,OACpBuB,EAAQF,EAAWE,MACnBC,EAAQH,EAAoB,QAC5BI,EAASJ,EAAqB,SAC9BK,EAAWL,EAAwB,cAAK,EAG9C,SAASM,EAAQC,GACf,MAAM/C,EAAM,IAAIC,YAAYkB,EAAOrB,QAEnC,IAAKiD,KAAQ,IADC/C,EAAI6C,IAAa,GACL,MAAMnB,MAAM,eAAiBqB,GACvD,OAAO/C,GAAK6C,EAAW,IAAM,GAAU,EAALE,EACpC,CAGA,SAASC,EAAQD,GACf,MAAM/C,EAAM,IAAIC,YAAYkB,EAAOrB,QAEnC,IAAKiD,KAAQ,IADC/C,EAAI6C,IAAa,GACL,MAAMnB,MAAM,eAAiBqB,GACvD,OAAO/C,GAAK6C,EAAW,IAAM,GAAU,EAALE,EAAS,EAC7C,CAGA,SAASE,EAAcC,GACrB,OAAO,GAAKd,KAAKe,MAAOD,IAASpE,EAAoB,GACvD,CA6BA,SAASsE,EAAQC,EAAWC,EAAQC,GAClC,MAAMzD,EAASqB,EAAOrB,OACtB,GAAIyD,EACF,OAAQF,GACN,KAAK,EAAG,OAAO,IAAIG,aAAa1D,GAChC,KAAK,EAAG,OAAO,IAAI2D,aAAa3D,QAGlC,OAAQuD,GACN,KAAK,EAAG,OAAO,IAAKC,EAASI,UAAYC,YAAY7D,GACrD,KAAK,EAAG,OAAO,IAAKwD,EAASM,WAAazD,aAAaL,GACvD,KAAK,EAAG,OAAO,IAAKwD,EAASO,WAAa5D,aAAaH,GACvD,KAAK,EAAG,OAAO,IAAKwD,EAASQ,cAAgBrE,gBAAgBK,GAGjE,MAAM4B,MAAM,sBAAwB2B,EACtC,CA2BA,SAASU,EAAeC,GACtB,MAAMhE,EAAM,IAAIC,YAAYkB,EAAOrB,QAC7BiD,EAAK/C,EAAIgE,EAAMxF,IAAc,GAC7B0E,EAAOJ,EAAQC,GACrB,KAAMG,EAAOtE,GAAkB,MAAM8C,MAAM,iBAAmBqB,GAC9D,MAAMkB,EAAQhB,EAAcC,GAC5B,IAAIgB,EAAMlE,EAAIgE,EAAM7E,IAAqC,GACzD,MAAMiB,EAAS8C,EAAOrE,EAClBmB,EAAIgE,EAAM1E,IAAwB,GAClCU,EAAIkE,EAAMzF,IAAgB,KAAOwF,EACrC,OAAOb,EAAQa,EAAOf,EAAOnE,EAAYmE,EAAOlE,GACzCyB,SAASyD,KAASD,EAAOC,EAAM9D,EACxC,CAyBA,SAAS+D,EAAcC,EAAMf,EAAWtD,GACtC,OAAO,IAAIqE,EAAKC,EAAkBD,EAAMf,EAAWtD,GACrD,CAGA,SAASsE,EAAkBD,EAAMf,EAAWtD,GAC1C,MAAMD,EAASqB,EAAOrB,OAChBE,EAAM,IAAIC,YAAYH,GACtBwE,EAAStE,EAAID,EAAMZ,IAAqC,GAC9D,OAAO,IAAIiF,EAAKtE,EAAQwE,EAAQtE,EAAIsE,EAAS7F,IAAgB,KAAO4E,EACtE,CA6CA,OApJApC,EAAWsD,cARX,SAAuBC,GACrB,MAAMpE,EAASoE,EAAIpE,OACbL,EAAM4C,EAAMvC,GAAU,EAAGzB,GACzBuB,EAAM,IAAIC,YAAYgB,EAAOrB,QACnC,IAAK,IAAI2E,EAAI,EAAGC,EAAI3E,IAAQ,EAAG0E,EAAIrE,IAAUqE,EAAGvE,EAAIwE,EAAID,GAAKD,EAAIG,WAAWF,GAC5E,OAAO1E,CACT,EAYAkB,EAAW2D,YAPX,SAAqB7E,GACnB,MAAMD,EAASqB,EAAOrB,OAEtB,GADW,IAAIG,YAAYH,GAAQC,EAAMvB,IAAc,KAC5CG,EAAW,MAAM+C,MAAM,iBAAmB3B,GACrD,OAAOF,EAAcC,EAAQC,EAC/B,EA6CAkB,EAAW4D,aArBX,SAAsB9B,EAAI+B,GACxB,MAAM5B,EAAOJ,EAAQC,GACrB,KAAMG,GAAQtE,EAAkBC,IAAS,MAAM6C,MAAM,iBAAmBqB,EAAK,MAAQG,GACrF,MAAMe,EAAQhB,EAAcC,GACtB9C,EAAS0E,EAAO1E,OAChB8D,EAAMvB,EAAMvC,GAAU6D,EAAOvF,GAC7BsF,EAAMrB,EAAMO,EAAOrE,EAAQU,EAAaF,EAAsB0D,GAC9D/C,EAAM,IAAIC,YAAYkB,EAAOrB,QACnCE,EAAIgE,EAAM9E,IAAkC,GAAK0D,EAAOsB,GACxDlE,EAAIgE,EAAM7E,IAAqC,GAAK+E,EACpDlE,EAAIgE,EAAM5E,IAAsC,GAAKgB,GAAU6D,EAC3Df,EAAOrE,IAAOmB,EAAIgE,EAAM1E,IAAwB,GAAKc,GACzD,MAAM2E,EAAO3B,EAAQa,EAAOf,EAAOnE,EAAYmE,EAAOlE,GACtD,GAAIkE,EAAOjE,EACT,IAAK,IAAIwF,EAAI,EAAGA,EAAIrE,IAAUqE,EAAGM,GAAMb,IAAQD,GAASQ,GAAK7B,EAAOkC,EAAOL,SAE3EM,EAAKC,IAAIF,EAAQZ,IAAQD,GAE3B,OAAOD,CACT,EAmBA/C,EAAW8C,eAAiBA,EAW5B9C,EAAWgE,WARX,SAAoBjB,GAClB,MAAMkB,EAAQnB,EAAeC,GACvBmB,EAAMD,EAAM9E,OACZgF,EAAM,IAAIrD,MAAMoD,GACtB,IAAK,IAAIV,EAAI,EAAGA,EAAIU,EAAKV,IAAKW,EAAIX,GAAKS,EAAMT,GAC7C,OAAOW,CACT,EAWAnE,EAAWoE,iBANX,SAA0BtF,GACxB,MAAMD,EAASqB,EAAOrB,OAChBM,EAAS,IAAIH,YAAYH,GAAQC,EAAMtB,IAAgB,GAC7D,OAAOqB,EAAOmC,MAAMlC,EAAKA,EAAMK,EACjC,EAiBAa,EAAWqE,eAAiBnB,EAAcoB,KAAK,KAAM7B,UAAW,GAChEzC,EAAWuE,mBAAqBnB,EAAkBkB,KAAK,KAAM7B,UAAW,GACxEzC,EAAWwE,gBAAkBtB,EAAcoB,KAAK,KAAM5B,WAAY,GAClE1C,EAAWyE,oBAAsBrB,EAAkBkB,KAAK,KAAM5B,WAAY,GAC1E1C,EAAW0E,uBAAyBxB,EAAcoB,KAAK,KAAMK,kBAAmB,GAChF3E,EAAW4E,2BAA6BxB,EAAkBkB,KAAK,KAAMK,kBAAmB,GACxF3E,EAAW6E,gBAAkB3B,EAAcoB,KAAK,KAAM3B,WAAY,GAClE3C,EAAW8E,oBAAsB1B,EAAkBkB,KAAK,KAAM3B,WAAY,GAC1E3C,EAAW+E,iBAAmB7B,EAAcoB,KAAK,KAAMpF,YAAa,GACpEc,EAAWgF,qBAAuB5B,EAAkBkB,KAAK,KAAMpF,YAAa,GAC5Ec,EAAWiF,gBAAkB/B,EAAcoB,KAAK,KAAM1B,WAAY,GAClE5C,EAAWkF,oBAAsB9B,EAAkBkB,KAAK,KAAM1B,WAAY,GAC1E5C,EAAWmF,iBAAmBjC,EAAcoB,KAAK,KAAMtF,YAAa,GACpEgB,EAAWoF,qBAAuBhC,EAAkBkB,KAAK,KAAMtF,YAAa,GACxET,IACFyB,EAAWqF,gBAAkBnC,EAAcoB,KAAK,KAAMzB,cAAe,GACrE7C,EAAWsF,oBAAsBlC,EAAkBkB,KAAK,KAAMzB,cAAe,GAC7E7C,EAAWuF,iBAAmBrC,EAAcoB,KAAK,KAAM9F,eAAgB,GACvEwB,EAAWwF,qBAAuBpC,EAAkBkB,KAAK,KAAM9F,eAAgB,IAEjFwB,EAAWyF,kBAAoBvC,EAAcoB,KAAK,KAAM/B,aAAc,GACtEvC,EAAW0F,sBAAwBtC,EAAkBkB,KAAK,KAAM/B,aAAc,GAC9EvC,EAAW2F,kBAAoBzC,EAAcoB,KAAK,KAAM9B,aAAc,GACtExC,EAAW4F,sBAAwBxC,EAAkBkB,KAAK,KAAM9B,aAAc,GAa9ExC,EAAW6F,aAVX,SAAsB/G,EAAKgH,GACzB,MAAM/G,EAAM,IAAIC,YAAYkB,EAAOrB,QACnC,IAAIiD,EAAK/C,EAAKD,EAAMvB,IAAe,GACnC,GAAIuE,GAAM/C,EAAI6C,IAAa,GACzB,MAAOE,GAAMgE,EAAQ,OAAO,QACrBhE,EAAKC,EAAQD,IAEtB,OAAO,CACT,EAKA9B,EAAWE,OAASF,EAAWE,QAAUA,EACzCF,EAAWyB,MAASzB,EAAWyB,OAAUA,EAGlCsE,EAASxE,EAAYvB,EAC9B,CAEA,SAASgG,EAAWC,GAClB,MAA2B,oBAAbC,UAA4BD,aAAaC,QACzD,CAGAC,eAAeC,EAAYC,EAAQtG,GACjC,OAAIiG,EAAWK,QAAeA,GAAgBC,EAAqBD,EAAQtG,GACpEsB,EACLvB,EAAeC,IAAYA,EAAU,CAAC,UAChCwG,YAAYH,YAChBC,aAAkBE,YAAYC,OAC1BH,QACME,YAAYE,QAAQJ,GAC9BtG,GAGN,CAoBAoG,eAAeG,EAAqBD,EAAQtG,GAC1C,OAAKwG,YAAYD,qBAQVjF,EACLvB,EAAeC,IAAYA,EAAU,CAAC,WAC/BwG,YAAYD,qBAAqBD,EAAQtG,IAAUuB,UATnD8E,EACLJ,EAAWK,QAAeA,GACtBA,EAAOK,cACPL,EACJtG,EAON,CAKA,SAASgG,EAASvE,EAASxB,GACzB,IAAI2G,EAAS3G,EAAa4G,OAAOC,OAAO7G,GAAc,CAAC,EACnD8G,EAAqBtF,EAA2B,kBAChD,SAASrC,GAAUqC,EAA2B,kBAAEuF,MAAQ5H,CAAQ,EAChEqC,EAA8B,sBAAKA,EAAmB,WAAK,WAAY,EAC3E,IAAK,IAAIwF,KAAgBxF,EAAS,CAChC,IAAKoF,OAAO7F,UAAUkG,eAAehG,KAAKO,EAASwF,GAAe,SAClE,MAAME,EAAO1F,EAAQwF,GACrB,IAAIvH,EAAQuH,EAAaG,MAAM,KAC3BC,EAAOT,EACX,KAAOlH,EAAMN,OAAS,GAAG,CACvB,IAAIkI,EAAO5H,EAAM6H,QACZV,OAAO7F,UAAUkG,eAAehG,KAAKmG,EAAMC,KAAOD,EAAKC,GAAQ,CAAC,GACrED,EAAOA,EAAKC,EACd,CACA,IAAIE,EAAO9H,EAAM,GACb+H,EAAOD,EAAKE,QAAQ,KACxB,GAAID,GAAQ,EAAG,CACb,IAAIE,EAAYH,EAAKI,UAAU,EAAGH,GAC9BI,EAAYR,EAAKM,GACrB,QAAyB,IAAdE,IAA8BA,EAAU7G,UAAW,CAC5D,IAAI8G,EAAO,YAAYC,GACrB,OAAOD,EAAKE,KAAKF,EAAK9G,UAAUiH,YAAY,KAAMF,GACpD,EACAD,EAAK9G,UAAY,CACfkH,QAAS,WACP,OAAOC,KAAKzJ,EACd,GAEFoJ,EAAKE,KAAO,SAASI,GACnB,OAAOvB,OAAOC,OAAOgB,EAAK9G,UAAW,CAAE,CAACtC,GAAO,CAAEsI,MAAOoB,EAAWC,UAAU,IAC/E,EACIR,GAAWhB,OAAOyB,oBAAoBT,GAAWU,SAAQf,GAC3DX,OAAO2B,eAAeV,EAAMN,EAAMX,OAAO4B,yBAAyBZ,EAAWL,MAE/EH,EAAKM,GAAaG,CACpB,CAGA,GAFAN,EAAOA,EAAKI,UAAUH,EAAO,GAC7BJ,EAAOA,EAAKM,GAAW3G,UACnB,cAAc0H,KAAKlB,IACrB,IAAKX,OAAO7F,UAAUkG,eAAehG,KAAKmG,EAAMG,EAAOA,EAAKI,UAAU,IAAK,CACzE,IAAIe,EAASlH,EAAQwF,EAAa2B,QAAQ,OAAQ,SAC9CC,EAASpH,EAAQwF,EAAa2B,QAAQ,OAAQ,SAClD/B,OAAO2B,eAAenB,EAAMG,EAAM,CAChCsB,IAAK,WAAa,OAAOH,EAAOR,KAAKzJ,GAAQ,EAC7CsF,IAAK,SAASgD,GAAS6B,EAAOV,KAAKzJ,GAAOsI,EAAQ,EAClD+B,YAAY,GAEhB,MAEa,gBAATvB,GACDH,EAAKG,GAAQ,IAAIO,KAChBhB,EAAmBgB,EAAK3I,QACjB+H,KAAQY,KACdiB,SAAW7B,GAEbE,EAAKG,GAAQ,YAAYO,GAExB,OADAhB,EAAmBgB,EAAK3I,QACjB+H,EAAKgB,KAAKzJ,MAAUqJ,EAC7B,GAAGiB,SAAW7B,CAGpB,KACM,cAAcuB,KAAKlB,GAChBX,OAAO7F,UAAUkG,eAAehG,KAAKmG,EAAMG,EAAOA,EAAKI,UAAU,KACpEf,OAAO2B,eAAenB,EAAMG,EAAM,CAChCsB,IAAKrH,EAAQwF,EAAa2B,QAAQ,OAAQ,SAC1C5E,IAAKvC,EAAQwF,EAAa2B,QAAQ,OAAQ,SAC1CG,YAAY,IAGS,mBAAT5B,GAAuBA,IAASJ,GAC/CM,EAAKG,GAAQ,IAAIO,KAChBhB,EAAmBgB,EAAK3I,QACjB+H,KAAQY,KACdiB,SAAW7B,EAEdE,EAAKG,GAAQL,CAGnB,CACA,OAAOP,CACT,CAtHAnF,EAAQ4E,YAAcA,EAetB5E,EAAQwH,gBAZR,SAAyB3C,EAAQtG,GAC/B,OAAOsB,EACLvB,EAAeC,IAAYA,EAAU,CAAC,IACtC,IAAIwG,YAAY0C,SACd5C,aAAkBE,YAAYC,OAC1BH,EACA,IAAIE,YAAYC,OAAOH,GAC3BtG,GAGN,EAoBAyB,EAAQ8E,qBAAuBA,EAuF/B9E,EAAQuE,SAAWA,sCC7ZnBY,EAAOnF,QAAU,EAAjB,2CCFA,IAAI0H,EAAW1H,EA2Bf,SAAS2H,IACLD,EAASE,KAAKC,aACdH,EAASI,OAAOD,WAAWH,EAASK,cACpCL,EAASM,OAAOH,WAAWH,EAASO,aACxC,CAvBAP,EAASQ,MAAQ,UAGjBR,EAASI,OAAe,EAAQ,OAChCJ,EAASK,aAAe,EAAQ,OAChCL,EAASM,OAAe,EAAQ,OAChCN,EAASO,aAAe,EAAQ,OAGhCP,EAASE,KAAe,EAAQ,OAChCF,EAASS,IAAe,EAAQ,OAChCT,EAASU,MAAe,EAAQ,OAChCV,EAASC,UAAeA,EAcxBA,wCClCAxC,EAAOnF,QAAUgI,EAEjB,IAEIC,EAFAL,EAAY,EAAQ,OAIpBS,EAAYT,EAAKS,SACjBC,EAAYV,EAAKU,KAGrB,SAASC,EAAgBC,EAAQC,GAC7B,OAAOC,WAAW,uBAAyBF,EAAOG,IAAM,OAASF,GAAe,GAAK,MAAQD,EAAO9F,IACxG,CAQA,SAASsF,EAAO3K,GAMZqJ,KAAKjF,IAAMpE,EAMXqJ,KAAKiC,IAAM,EAMXjC,KAAKhE,IAAMrF,EAAOM,MACtB,CAEA,IA4CQ4H,EA5CJqD,EAAqC,oBAAf1H,WACpB,SAA4B7D,GAC1B,GAAIA,aAAkB6D,YAAc5B,MAAMuJ,QAAQxL,GAC9C,OAAO,IAAI2K,EAAO3K,GACtB,MAAM4B,MAAM,iBAChB,EAEE,SAAsB5B,GACpB,GAAIiC,MAAMuJ,QAAQxL,GACd,OAAO,IAAI2K,EAAO3K,GACtB,MAAM4B,MAAM,iBAChB,EAEAoG,EAAS,WACT,OAAOuC,EAAKkB,OACN,SAA6BzL,GAC3B,OAAQ2K,EAAO3C,OAAS,SAAuBhI,GAC3C,OAAOuK,EAAKkB,OAAOC,SAAS1L,GACtB,IAAI4K,EAAa5K,GAEjBuL,EAAavL,EACvB,GAAGA,EACP,EAEEuL,CACV,EAuDA,SAASI,IAEL,IAAIC,EAAO,IAAIZ,EAAS,EAAG,GACvBrG,EAAI,EACR,KAAI0E,KAAKhE,IAAMgE,KAAKiC,IAAM,GAanB,CACH,KAAO3G,EAAI,IAAKA,EAAG,CAEf,GAAI0E,KAAKiC,KAAOjC,KAAKhE,IACjB,MAAM6F,EAAgB7B,MAG1B,GADAuC,EAAKC,IAAMD,EAAKC,IAA2B,IAArBxC,KAAKjF,IAAIiF,KAAKiC,OAAmB,EAAJ3G,KAAW,EAC1D0E,KAAKjF,IAAIiF,KAAKiC,OAAS,IACvB,OAAOM,CACf,CAGA,OADAA,EAAKC,IAAMD,EAAKC,IAA6B,IAAvBxC,KAAKjF,IAAIiF,KAAKiC,SAAqB,EAAJ3G,KAAW,EACzDiH,CACX,CAzBI,KAAOjH,EAAI,IAAKA,EAGZ,GADAiH,EAAKC,IAAMD,EAAKC,IAA2B,IAArBxC,KAAKjF,IAAIiF,KAAKiC,OAAmB,EAAJ3G,KAAW,EAC1D0E,KAAKjF,IAAIiF,KAAKiC,OAAS,IACvB,OAAOM,EAKf,GAFAA,EAAKC,IAAMD,EAAKC,IAA2B,IAArBxC,KAAKjF,IAAIiF,KAAKiC,OAAe,MAAQ,EAC3DM,EAAKE,IAAMF,EAAKE,IAA2B,IAArBzC,KAAKjF,IAAIiF,KAAKiC,OAAgB,KAAO,EACvDjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IACvB,OAAOM,EAgBf,GAfIjH,EAAI,EAeJ0E,KAAKhE,IAAMgE,KAAKiC,IAAM,GACtB,KAAO3G,EAAI,IAAKA,EAGZ,GADAiH,EAAKE,IAAMF,EAAKE,IAA2B,IAArBzC,KAAKjF,IAAIiF,KAAKiC,OAAmB,EAAJ3G,EAAQ,KAAO,EAC9D0E,KAAKjF,IAAIiF,KAAKiC,OAAS,IACvB,OAAOM,OAGf,KAAOjH,EAAI,IAAKA,EAAG,CAEf,GAAI0E,KAAKiC,KAAOjC,KAAKhE,IACjB,MAAM6F,EAAgB7B,MAG1B,GADAuC,EAAKE,IAAMF,EAAKE,IAA2B,IAArBzC,KAAKjF,IAAIiF,KAAKiC,OAAmB,EAAJ3G,EAAQ,KAAO,EAC9D0E,KAAKjF,IAAIiF,KAAKiC,OAAS,IACvB,OAAOM,CACf,CAGJ,MAAMhK,MAAM,0BAChB,CAiCA,SAASmK,EAAgB3H,EAAK4H,GAC1B,OAAQ5H,EAAI4H,EAAM,GACV5H,EAAI4H,EAAM,IAAM,EAChB5H,EAAI4H,EAAM,IAAM,GAChB5H,EAAI4H,EAAM,IAAM,MAAQ,CACpC,CA8BA,SAASC,IAGL,GAAI5C,KAAKiC,IAAM,EAAIjC,KAAKhE,IACpB,MAAM6F,EAAgB7B,KAAM,GAEhC,OAAO,IAAI2B,EAASe,EAAgB1C,KAAKjF,IAAKiF,KAAKiC,KAAO,GAAIS,EAAgB1C,KAAKjF,IAAKiF,KAAKiC,KAAO,GACxG,CA5KAX,EAAO3C,OAASA,IAEhB2C,EAAOzI,UAAUgK,OAAS3B,EAAKtI,MAAMC,UAAUvB,UAAuC4J,EAAKtI,MAAMC,UAAUC,MAO3GwI,EAAOzI,UAAUiK,QACTjE,EAAQ,WACL,WACuD,GAA1DA,GAAuC,IAArBmB,KAAKjF,IAAIiF,KAAKiC,QAAuB,EAAOjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IAAK,OAAOpD,EACvC,GAA1DA,GAASA,GAA8B,IAArBmB,KAAKjF,IAAIiF,KAAKiC,OAAgB,KAAO,EAAOjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IAAK,OAAOpD,EACvC,GAA1DA,GAASA,GAA8B,IAArBmB,KAAKjF,IAAIiF,KAAKiC,OAAe,MAAQ,EAAOjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IAAK,OAAOpD,EACvC,GAA1DA,GAASA,GAA8B,IAArBmB,KAAKjF,IAAIiF,KAAKiC,OAAe,MAAQ,EAAOjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IAAK,OAAOpD,EACvC,GAA1DA,GAASA,GAA+B,GAAtBmB,KAAKjF,IAAIiF,KAAKiC,OAAe,MAAQ,EAAOjC,KAAKjF,IAAIiF,KAAKiC,OAAS,IAAK,OAAOpD,EAGjG,IAAKmB,KAAKiC,KAAO,GAAKjC,KAAKhE,IAEvB,MADAgE,KAAKiC,IAAMjC,KAAKhE,IACV6F,EAAgB7B,KAAM,IAEhC,OAAOnB,CACX,GAOJyC,EAAOzI,UAAUkK,MAAQ,WACrB,OAAuB,EAAhB/C,KAAK8C,QAChB,EAMAxB,EAAOzI,UAAUmK,OAAS,WACtB,IAAInE,EAAQmB,KAAK8C,SACjB,OAAOjE,IAAU,IAAc,EAARA,GAAa,CACxC,EAoFAyC,EAAOzI,UAAUoK,KAAO,WACpB,OAAyB,IAAlBjD,KAAK8C,QAChB,EAaAxB,EAAOzI,UAAUqK,QAAU,WAGvB,GAAIlD,KAAKiC,IAAM,EAAIjC,KAAKhE,IACpB,MAAM6F,EAAgB7B,KAAM,GAEhC,OAAO0C,EAAgB1C,KAAKjF,IAAKiF,KAAKiC,KAAO,EACjD,EAMAX,EAAOzI,UAAUsK,SAAW,WAGxB,GAAInD,KAAKiC,IAAM,EAAIjC,KAAKhE,IACpB,MAAM6F,EAAgB7B,KAAM,GAEhC,OAAkD,EAA3C0C,EAAgB1C,KAAKjF,IAAKiF,KAAKiC,KAAO,EACjD,EAkCAX,EAAOzI,UAAUuB,MAAQ,WAGrB,GAAI4F,KAAKiC,IAAM,EAAIjC,KAAKhE,IACpB,MAAM6F,EAAgB7B,KAAM,GAEhC,IAAInB,EAAQqC,EAAK9G,MAAMgJ,YAAYpD,KAAKjF,IAAKiF,KAAKiC,KAElD,OADAjC,KAAKiC,KAAO,EACLpD,CACX,EAOAyC,EAAOzI,UAAUwK,OAAS,WAGtB,GAAIrD,KAAKiC,IAAM,EAAIjC,KAAKhE,IACpB,MAAM6F,EAAgB7B,KAAM,GAEhC,IAAInB,EAAQqC,EAAK9G,MAAMkJ,aAAatD,KAAKjF,IAAKiF,KAAKiC,KAEnD,OADAjC,KAAKiC,KAAO,EACLpD,CACX,EAMAyC,EAAOzI,UAAU0K,MAAQ,WACrB,IAAItM,EAAS+I,KAAK8C,SACdU,EAASxD,KAAKiC,IACdU,EAAS3C,KAAKiC,IAAMhL,EAGxB,GAAI0L,EAAM3C,KAAKhE,IACX,MAAM6F,EAAgB7B,KAAM/I,GAGhC,GADA+I,KAAKiC,KAAOhL,EACR2B,MAAMuJ,QAAQnC,KAAKjF,KACnB,OAAOiF,KAAKjF,IAAIjC,MAAM0K,EAAOb,GAEjC,GAAIa,IAAUb,EAAK,CACf,IAAIc,EAAevC,EAAKkB,OACxB,OAAOqB,EACDA,EAAajK,MAAM,GACnB,IAAIwG,KAAKjF,IAAI+E,YAAY,EACnC,CACA,OAAOE,KAAK6C,OAAO9J,KAAKiH,KAAKjF,IAAKyI,EAAOb,EAC7C,EAMArB,EAAOzI,UAAU6K,OAAS,WACtB,IAAIH,EAAQvD,KAAKuD,QACjB,OAAO3B,EAAK+B,KAAKJ,EAAO,EAAGA,EAAMtM,OACrC,EAOAqK,EAAOzI,UAAU+K,KAAO,SAAc3M,GAClC,GAAsB,iBAAXA,EAAqB,CAE5B,GAAI+I,KAAKiC,IAAMhL,EAAS+I,KAAKhE,IACzB,MAAM6F,EAAgB7B,KAAM/I,GAChC+I,KAAKiC,KAAOhL,CAChB,MACI,GAEI,GAAI+I,KAAKiC,KAAOjC,KAAKhE,IACjB,MAAM6F,EAAgB7B,YACE,IAAvBA,KAAKjF,IAAIiF,KAAKiC,QAE3B,OAAOjC,IACX,EAOAsB,EAAOzI,UAAUgL,SAAW,SAASC,GACjC,OAAQA,GACJ,KAAK,EACD9D,KAAK4D,OACL,MACJ,KAAK,EACD5D,KAAK4D,KAAK,GACV,MACJ,KAAK,EACD5D,KAAK4D,KAAK5D,KAAK8C,UACf,MACJ,KAAK,EACD,KAA0C,IAAlCgB,EAA2B,EAAhB9D,KAAK8C,WACpB9C,KAAK6D,SAASC,GAElB,MACJ,KAAK,EACD9D,KAAK4D,KAAK,GACV,MAGJ,QACI,MAAMrL,MAAM,qBAAuBuL,EAAW,cAAgB9D,KAAKiC,KAE3E,OAAOjC,IACX,EAEAsB,EAAOH,WAAa,SAAS4C,GACzBxC,EAAewC,EACfzC,EAAO3C,OAASA,IAChB4C,EAAaJ,aAEb,IAAI6C,EAAK9C,EAAK+C,KAAO,SAAsC,WAC3D/C,EAAKgD,MAAM5C,EAAOzI,UAAW,CAEzBsL,MAAO,WACH,OAAO7B,EAAevJ,KAAKiH,MAAMgE,IAAI,EACzC,EAEAI,OAAQ,WACJ,OAAO9B,EAAevJ,KAAKiH,MAAMgE,IAAI,EACzC,EAEAK,OAAQ,WACJ,OAAO/B,EAAevJ,KAAKiH,MAAMsE,WAAWN,IAAI,EACpD,EAEAO,QAAS,WACL,OAAO3B,EAAY7J,KAAKiH,MAAMgE,IAAI,EACtC,EAEAQ,SAAU,WACN,OAAO5B,EAAY7J,KAAKiH,MAAMgE,IAAI,EACtC,GAGR,sCC9ZAvF,EAAOnF,QAAUiI,EAGjB,IAAID,EAAS,EAAQ,QACpBC,EAAa1I,UAAY6F,OAAOC,OAAO2C,EAAOzI,YAAYiH,YAAcyB,EAEzE,IAAIL,EAAO,EAAQ,OASnB,SAASK,EAAa5K,GAClB2K,EAAOvI,KAAKiH,KAAMrJ,EAOtB,CAEA4K,EAAaJ,WAAa,WAElBD,EAAKkB,SACLb,EAAa1I,UAAUgK,OAAS3B,EAAKkB,OAAOvJ,UAAUC,MAC9D,EAMAyI,EAAa1I,UAAU6K,OAAS,WAC5B,IAAI1H,EAAMgE,KAAK8C,SACf,OAAO9C,KAAKjF,IAAI0J,UACVzE,KAAKjF,IAAI0J,UAAUzE,KAAKiC,IAAKjC,KAAKiC,IAAMhJ,KAAKyL,IAAI1E,KAAKiC,IAAMjG,EAAKgE,KAAKhE,MACtEgE,KAAKjF,IAAI4J,SAAS,QAAS3E,KAAKiC,IAAKjC,KAAKiC,IAAMhJ,KAAKyL,IAAI1E,KAAKiC,IAAMjG,EAAKgE,KAAKhE,KACxF,EASAuF,EAAaJ,6CCjDb1C,EAAOnF,QAAU,CAAC,sCCKRA,EA6BNsL,QAAU,EAAQ,2CClCtBnG,EAAOnF,QAAUsL,EAEjB,IAAI1D,EAAO,EAAQ,OAsCnB,SAAS0D,EAAQC,EAASC,EAAkBC,GAExC,GAAuB,mBAAZF,EACP,MAAMG,UAAU,8BAEpB9D,EAAK+D,aAAalM,KAAKiH,MAMvBA,KAAK6E,QAAUA,EAMf7E,KAAK8E,iBAAmBI,QAAQJ,GAMhC9E,KAAK+E,kBAAoBG,QAAQH,EACrC,EA3DCH,EAAQ/L,UAAY6F,OAAOC,OAAOuC,EAAK+D,aAAapM,YAAYiH,YAAc8E,EAwE/EA,EAAQ/L,UAAUsM,QAAU,SAASA,EAAQC,EAAQC,EAAaC,EAAcC,EAASC,GAErF,IAAKD,EACD,MAAMP,UAAU,6BAEpB,IAAIS,EAAOzF,KACX,IAAKwF,EACD,OAAOtE,EAAKwE,UAAUP,EAASM,EAAML,EAAQC,EAAaC,EAAcC,GAE5E,GAAKE,EAAKZ,QAKV,IACI,OAAOY,EAAKZ,QACRO,EACAC,EAAYI,EAAKX,iBAAmB,kBAAoB,UAAUS,GAASI,UAC3E,SAAqBC,EAAKC,GAEtB,GAAID,EAEA,OADAH,EAAKK,KAAK,QAASF,EAAKR,GACjBI,EAASI,GAGpB,GAAiB,OAAbC,EAAJ,CAKA,KAAMA,aAAoBP,GACtB,IACIO,EAAWP,EAAaG,EAAKV,kBAAoB,kBAAoB,UAAUc,EACnF,CAAE,MAAOD,GAEL,OADAH,EAAKK,KAAK,QAASF,EAAKR,GACjBI,EAASI,EACpB,CAIJ,OADAH,EAAKK,KAAK,OAAQD,EAAUT,GACrBI,EAAS,KAAMK,EAZtB,CAFIJ,EAAK9C,KAAqB,EAelC,GAER,CAAE,MAAOiD,GAGL,OAFAH,EAAKK,KAAK,QAASF,EAAKR,QACxBW,YAAW,WAAaP,EAASI,EAAM,GAAG,EAE9C,MArCIG,YAAW,WAAaP,EAASjN,MAAM,iBAAmB,GAAG,EAsCrE,EAOAqM,EAAQ/L,UAAU8J,IAAM,SAAaqD,GAOjC,OANIhG,KAAK6E,UACAmB,GACDhG,KAAK6E,QAAQ,KAAM,KAAM,MAC7B7E,KAAK6E,QAAU,KACf7E,KAAK8F,KAAK,OAAOG,OAEdjG,IACX,sCC5IAvB,EAAOnF,QAAUqI,EAEjB,IAAIT,EAAO,EAAQ,OAUnB,SAASS,EAASa,EAAIC,GASlBzC,KAAKwC,GAAKA,IAAO,EAMjBxC,KAAKyC,GAAKA,IAAO,CACrB,CAOA,IAAIyD,EAAOvE,EAASuE,KAAO,IAAIvE,EAAS,EAAG,GAE3CuE,EAAKC,SAAW,WAAa,OAAO,CAAG,EACvCD,EAAKE,SAAWF,EAAK5B,SAAW,WAAa,OAAOtE,IAAM,EAC1DkG,EAAKjP,OAAS,WAAa,OAAO,CAAG,EAOrC,IAAIoP,EAAW1E,EAAS0E,SAAW,mBAOnC1E,EAAS2E,WAAa,SAAoBzH,GACtC,GAAc,IAAVA,EACA,OAAOqH,EACX,IAAIK,EAAO1H,EAAQ,EACf0H,IACA1H,GAASA,GACb,IAAI2D,EAAK3D,IAAU,EACf4D,GAAM5D,EAAQ2D,GAAM,aAAe,EAUvC,OATI+D,IACA9D,GAAMA,IAAO,EACbD,GAAMA,IAAO,IACPA,EAAK,aACPA,EAAK,IACCC,EAAK,aACPA,EAAK,KAGV,IAAId,EAASa,EAAIC,EAC5B,EAOAd,EAAS6E,KAAO,SAAc3H,GAC1B,GAAqB,iBAAVA,EACP,OAAO8C,EAAS2E,WAAWzH,GAC/B,GAAIqC,EAAKuF,SAAS5H,GAAQ,CAEtB,IAAIqC,EAAK+C,KAGL,OAAOtC,EAAS2E,WAAWI,SAAS7H,EAAO,KAF3CA,EAAQqC,EAAK+C,KAAK0C,WAAW9H,EAGrC,CACA,OAAOA,EAAM+H,KAAO/H,EAAMgI,KAAO,IAAIlF,EAAS9C,EAAM+H,MAAQ,EAAG/H,EAAMgI,OAAS,GAAKX,CACvF,EAOAvE,EAAS9I,UAAUsN,SAAW,SAAkBW,GAC5C,IAAKA,GAAY9G,KAAKyC,KAAO,GAAI,CAC7B,IAAID,EAAgB,GAAVxC,KAAKwC,KAAW,EACtBC,GAAMzC,KAAKyC,KAAW,EAG1B,OAFKD,IACDC,EAAKA,EAAK,IAAM,KACXD,EAAU,WAALC,EAClB,CACA,OAAOzC,KAAKwC,GAAe,WAAVxC,KAAKyC,EAC1B,EAOAd,EAAS9I,UAAUkO,OAAS,SAAgBD,GACxC,OAAO5F,EAAK+C,KACN,IAAI/C,EAAK+C,KAAe,EAAVjE,KAAKwC,GAAkB,EAAVxC,KAAKyC,GAAQyC,QAAQ4B,IAEhD,CAAEF,IAAe,EAAV5G,KAAKwC,GAAQqE,KAAgB,EAAV7G,KAAKyC,GAAQqE,SAAU5B,QAAQ4B,GACnE,EAEA,IAAItL,EAAarE,OAAO0B,UAAU2C,WAOlCmG,EAASqF,SAAW,SAAkB1H,GAClC,OAAIA,IAAS+G,EACFH,EACJ,IAAIvE,GACLnG,EAAWzC,KAAKuG,EAAM,GACtB9D,EAAWzC,KAAKuG,EAAM,IAAM,EAC5B9D,EAAWzC,KAAKuG,EAAM,IAAM,GAC5B9D,EAAWzC,KAAKuG,EAAM,IAAM,MAAQ,GAEpC9D,EAAWzC,KAAKuG,EAAM,GACtB9D,EAAWzC,KAAKuG,EAAM,IAAM,EAC5B9D,EAAWzC,KAAKuG,EAAM,IAAM,GAC5B9D,EAAWzC,KAAKuG,EAAM,IAAM,MAAQ,EAE9C,EAMAqC,EAAS9I,UAAUoO,OAAS,WACxB,OAAO9P,OAAOC,aACO,IAAjB4I,KAAKwC,GACLxC,KAAKwC,KAAO,EAAK,IACjBxC,KAAKwC,KAAO,GAAK,IACjBxC,KAAKwC,KAAO,GACK,IAAjBxC,KAAKyC,GACLzC,KAAKyC,KAAO,EAAK,IACjBzC,KAAKyC,KAAO,GAAK,IACjBzC,KAAKyC,KAAO,GAEpB,EAMAd,EAAS9I,UAAUuN,SAAW,WAC1B,IAAIc,EAASlH,KAAKyC,IAAM,GAGxB,OAFAzC,KAAKyC,KAAQzC,KAAKyC,IAAM,EAAIzC,KAAKwC,KAAO,IAAM0E,KAAU,EACxDlH,KAAKwC,IAAQxC,KAAKwC,IAAM,EAAsB0E,KAAU,EACjDlH,IACX,EAMA2B,EAAS9I,UAAUyL,SAAW,WAC1B,IAAI4C,IAAmB,EAAVlH,KAAKwC,IAGlB,OAFAxC,KAAKwC,KAAQxC,KAAKwC,KAAO,EAAIxC,KAAKyC,IAAM,IAAMyE,KAAU,EACxDlH,KAAKyC,IAAQzC,KAAKyC,KAAO,EAAqByE,KAAU,EACjDlH,IACX,EAMA2B,EAAS9I,UAAU5B,OAAS,WACxB,IAAIkQ,EAASnH,KAAKwC,GACd4E,GAASpH,KAAKwC,KAAO,GAAKxC,KAAKyC,IAAM,KAAO,EAC5C4E,EAASrH,KAAKyC,KAAO,GACzB,OAAiB,IAAV4E,EACU,IAAVD,EACED,EAAQ,MACNA,EAAQ,IAAM,EAAI,EAClBA,EAAQ,QAAU,EAAI,EACxBC,EAAQ,MACNA,EAAQ,IAAM,EAAI,EAClBA,EAAQ,QAAU,EAAI,EAC1BC,EAAQ,IAAM,EAAI,EAC7B,sCCtMA,IAAInG,EAAO5H,EA2OX,SAAS4K,EAAMoD,EAAKC,EAAKC,GACrB,IAAK,IAAIC,EAAO/I,OAAO+I,KAAKF,GAAMjM,EAAI,EAAGA,EAAImM,EAAKxQ,SAAUqE,OACnCoM,IAAjBJ,EAAIG,EAAKnM,KAAsBkM,IAC/BF,EAAIG,EAAKnM,IAAMiM,EAAIE,EAAKnM,KAChC,OAAOgM,CACX,CAmBA,SAASK,EAAStI,GAEd,SAASuI,EAAYC,EAASC,GAE1B,KAAM9H,gBAAgB4H,GAClB,OAAO,IAAIA,EAAYC,EAASC,GAKpCpJ,OAAO2B,eAAeL,KAAM,UAAW,CAAEW,IAAK,WAAa,OAAOkH,CAAS,IAGvEtP,MAAMwP,kBACNxP,MAAMwP,kBAAkB/H,KAAM4H,GAE9BlJ,OAAO2B,eAAeL,KAAM,QAAS,CAAEnB,OAAO,IAAItG,OAAQyP,OAAS,KAEnEF,GACA5D,EAAMlE,KAAM8H,EACpB,CA2BA,OAzBAF,EAAY/O,UAAY6F,OAAOC,OAAOpG,MAAMM,UAAW,CACnDiH,YAAa,CACTjB,MAAO+I,EACP1H,UAAU,EACVU,YAAY,EACZqH,cAAc,GAElB5I,KAAM,CACFsB,IAAK,WAAiB,OAAOtB,CAAM,EACnCxD,SAAK6L,EACL9G,YAAY,EAKZqH,cAAc,GAElBtD,SAAU,CACN9F,MAAO,WAAmB,OAAOmB,KAAKX,KAAO,KAAOW,KAAK6H,OAAS,EAClE3H,UAAU,EACVU,YAAY,EACZqH,cAAc,KAIfL,CACX,CAhTA1G,EAAKwE,UAAY,EAAQ,OAGzBxE,EAAKgH,OAAS,EAAQ,OAGtBhH,EAAK+D,aAAe,EAAQ,OAG5B/D,EAAK9G,MAAQ,EAAQ,OAGrB8G,EAAKiH,QAAU,EAAQ,OAGvBjH,EAAKU,KAAO,EAAQ,OAGpBV,EAAKkH,KAAO,EAAQ,OAGpBlH,EAAKS,SAAW,EAAQ,OAOxBT,EAAKmH,OAASnD,aAA0B,IAAX,EAAAoD,GACP,EAAAA,GACA,EAAAA,EAAOC,SACP,EAAAD,EAAOC,QAAQC,UACf,EAAAF,EAAOC,QAAQC,SAASC,MAO9CvH,EAAKwH,OAASxH,EAAKmH,QAAU,EAAAC,GACG,oBAAXK,QAA0BA,QACf,oBAAXlD,MAA0BA,MACjCzF,KAQdkB,EAAK0H,WAAalK,OAAOmK,OAASnK,OAAOmK,OAAO,IAAiC,GAOjF3H,EAAK4H,YAAcpK,OAAOmK,OAASnK,OAAOmK,OAAO,CAAC,GAAgC,CAAC,EAQnF3H,EAAK6H,UAAYC,OAAOD,WAAwC,SAAmBlK,GAC/E,MAAwB,iBAAVA,GAAsBoK,SAASpK,IAAU5F,KAAKiQ,MAAMrK,KAAWA,CACjF,EAOAqC,EAAKuF,SAAW,SAAkB5H,GAC9B,MAAwB,iBAAVA,GAAsBA,aAAiB1H,MACzD,EAOA+J,EAAKiI,SAAW,SAAkBtK,GAC9B,OAAOA,GAA0B,iBAAVA,CAC3B,EAUAqC,EAAKkI,MAQLlI,EAAKmI,MAAQ,SAAeC,EAAKC,GAC7B,IAAI1K,EAAQyK,EAAIC,GAChB,QAAa,MAAT1K,IAAiByK,EAAIvK,eAAewK,MACZ,iBAAV1K,IAAuBjG,MAAMuJ,QAAQtD,GAASA,EAAM5H,OAASyH,OAAO+I,KAAK5I,GAAO5H,QAAU,EAEhH,EAaAiK,EAAKkB,OAAS,WACV,IACI,IAAIA,EAASlB,EAAKiH,QAAQ,UAAU/F,OAEpC,OAAOA,EAAOvJ,UAAU2Q,UAAYpH,EAAoC,IAC5E,CAAE,MAAOqH,GAEL,OAAO,IACX,CACH,CATa,GAYdvI,EAAKwI,aAAe,KAGpBxI,EAAKyI,oBAAsB,KAO3BzI,EAAK0I,UAAY,SAAmBC,GAEhC,MAA8B,iBAAhBA,EACR3I,EAAKkB,OACDlB,EAAKyI,oBAAoBE,GACzB,IAAI3I,EAAKtI,MAAMiR,GACnB3I,EAAKkB,OACDlB,EAAKwI,aAAaG,GACI,oBAAfrP,WACHqP,EACA,IAAIrP,WAAWqP,EACjC,EAMA3I,EAAKtI,MAA8B,oBAAf4B,WAA6BA,WAAwC5B,MAezFsI,EAAK+C,KAAkC/C,EAAKwH,OAAOoB,SAAsC5I,EAAKwH,OAAOoB,QAAQ7F,MACtE/C,EAAKwH,OAAOzE,MACvC/C,EAAKiH,QAAQ,QAOzBjH,EAAK6I,OAAS,mBAOd7I,EAAK8I,QAAU,wBAOf9I,EAAK+I,QAAU,6CAOf/I,EAAKgJ,WAAa,SAAoBrL,GAClC,OAAOA,EACDqC,EAAKS,SAAS6E,KAAK3H,GAAOoI,SAC1B/F,EAAKS,SAAS0E,QACxB,EAQAnF,EAAKiJ,aAAe,SAAsB7K,EAAMwH,GAC5C,IAAIvE,EAAOrB,EAAKS,SAASqF,SAAS1H,GAClC,OAAI4B,EAAK+C,KACE/C,EAAK+C,KAAKmG,SAAS7H,EAAKC,GAAID,EAAKE,GAAIqE,GACzCvE,EAAK4D,SAASjB,QAAQ4B,GACjC,EAiBA5F,EAAKgD,MAAQA,EAObhD,EAAKmJ,QAAU,SAAiBhP,GAC5B,OAAOA,EAAIiP,OAAO,GAAGC,cAAgBlP,EAAIoE,UAAU,EACvD,EA0DAyB,EAAKyG,SAAWA,EAmBhBzG,EAAKsJ,cAAgB7C,EAAS,iBAoB9BzG,EAAKuJ,YAAc,SAAkBC,GAEjC,IADA,IAAIC,EAAW,CAAC,EACPrP,EAAI,EAAGA,EAAIoP,EAAWzT,SAAUqE,EACrCqP,EAASD,EAAWpP,IAAM,EAO9B,OAAO,WACH,IAAK,IAAImM,EAAO/I,OAAO+I,KAAKzH,MAAO1E,EAAImM,EAAKxQ,OAAS,EAAGqE,GAAK,IAAKA,EAC9D,GAA0B,IAAtBqP,EAASlD,EAAKnM,UAA+BoM,IAAlB1H,KAAKyH,EAAKnM,KAAuC,OAAlB0E,KAAKyH,EAAKnM,IACpE,OAAOmM,EAAKnM,EACxB,CACJ,EAeA4F,EAAK0J,YAAc,SAAkBF,GAQjC,OAAO,SAASrL,GACZ,IAAK,IAAI/D,EAAI,EAAGA,EAAIoP,EAAWzT,SAAUqE,EACjCoP,EAAWpP,KAAO+D,UACXW,KAAK0K,EAAWpP,GACnC,CACJ,EAkBA4F,EAAK2J,cAAgB,CACjBC,MAAO3T,OACP4T,MAAO5T,OACPoM,MAAOpM,OACP6T,MAAM,GAIV9J,EAAKC,WAAa,WACd,IAAIiB,EAASlB,EAAKkB,OAEbA,GAMLlB,EAAKwI,aAAetH,EAAOoE,OAAShM,WAAWgM,MAAQpE,EAAOoE,MAE1D,SAAqB3H,EAAOoM,GACxB,OAAO,IAAI7I,EAAOvD,EAAOoM,EAC7B,EACJ/J,EAAKyI,oBAAsBvH,EAAO8I,aAE9B,SAA4BzT,GACxB,OAAO,IAAI2K,EAAO3K,EACtB,GAdAyJ,EAAKwI,aAAexI,EAAKyI,oBAAsB,IAevD,sCCpbAlL,EAAOnF,QAAU8H,EAEjB,IAEIC,EAFAH,EAAY,EAAQ,OAIpBS,EAAYT,EAAKS,SACjBuG,EAAYhH,EAAKgH,OACjBtG,EAAYV,EAAKU,KAWrB,SAASuJ,EAAGnH,EAAIhI,EAAKoP,GAMjBpL,KAAKgE,GAAKA,EAMVhE,KAAKhE,IAAMA,EAMXgE,KAAKqL,UAAO3D,EAMZ1H,KAAKoL,IAAMA,CACf,CAGA,SAASE,IAAQ,CAUjB,SAASC,EAAMC,GAMXxL,KAAKyL,KAAOD,EAAOC,KAMnBzL,KAAK0L,KAAOF,EAAOE,KAMnB1L,KAAKhE,IAAMwP,EAAOxP,IAMlBgE,KAAKqL,KAAOG,EAAOG,MACvB,CAOA,SAASvK,IAMLpB,KAAKhE,IAAM,EAMXgE,KAAKyL,KAAO,IAAIN,EAAGG,EAAM,EAAG,GAM5BtL,KAAK0L,KAAO1L,KAAKyL,KAMjBzL,KAAK2L,OAAS,IAOlB,CAEA,IAAIhN,EAAS,WACT,OAAOuC,EAAKkB,OACN,WACE,OAAQhB,EAAOzC,OAAS,WACpB,OAAO,IAAI0C,CACf,IACJ,EAEE,WACE,OAAO,IAAID,CACf,CACR,EAqCA,SAASwK,EAAUR,EAAKrQ,EAAKkH,GACzBlH,EAAIkH,GAAa,IAANmJ,CACf,CAmBA,SAASS,EAAS7P,EAAKoP,GACnBpL,KAAKhE,IAAMA,EACXgE,KAAKqL,UAAO3D,EACZ1H,KAAKoL,IAAMA,CACf,CA6CA,SAASU,EAAcV,EAAKrQ,EAAKkH,GAC7B,KAAOmJ,EAAI3I,IACP1H,EAAIkH,KAAkB,IAATmJ,EAAI5I,GAAW,IAC5B4I,EAAI5I,IAAM4I,EAAI5I,KAAO,EAAI4I,EAAI3I,IAAM,MAAQ,EAC3C2I,EAAI3I,MAAQ,EAEhB,KAAO2I,EAAI5I,GAAK,KACZzH,EAAIkH,KAAkB,IAATmJ,EAAI5I,GAAW,IAC5B4I,EAAI5I,GAAK4I,EAAI5I,KAAO,EAExBzH,EAAIkH,KAASmJ,EAAI5I,EACrB,CA0CA,SAASuJ,EAAaX,EAAKrQ,EAAKkH,GAC5BlH,EAAIkH,GAA0B,IAAdmJ,EAChBrQ,EAAIkH,EAAM,GAAMmJ,IAAQ,EAAM,IAC9BrQ,EAAIkH,EAAM,GAAMmJ,IAAQ,GAAM,IAC9BrQ,EAAIkH,EAAM,GAAMmJ,IAAQ,EAC5B,CA9JAhK,EAAOzC,OAASA,IAOhByC,EAAO5H,MAAQ,SAAe/B,GAC1B,OAAO,IAAIyJ,EAAKtI,MAAMnB,EAC1B,EAIIyJ,EAAKtI,QAAUA,QACfwI,EAAO5H,MAAQ0H,EAAKkH,KAAKhH,EAAO5H,MAAO0H,EAAKtI,MAAMC,UAAUvB,WAUhE8J,EAAOvI,UAAUmT,MAAQ,SAAchI,EAAIhI,EAAKoP,GAG5C,OAFApL,KAAK0L,KAAO1L,KAAK0L,KAAKL,KAAO,IAAIF,EAAGnH,EAAIhI,EAAKoP,GAC7CpL,KAAKhE,KAAOA,EACLgE,IACX,EA6BA6L,EAAShT,UAAY6F,OAAOC,OAAOwM,EAAGtS,WACtCgT,EAAShT,UAAUmL,GAxBnB,SAAuBoH,EAAKrQ,EAAKkH,GAC7B,KAAOmJ,EAAM,KACTrQ,EAAIkH,KAAe,IAANmJ,EAAY,IACzBA,KAAS,EAEbrQ,EAAIkH,GAAOmJ,CACf,EAyBAhK,EAAOvI,UAAUiK,OAAS,SAAsBjE,GAW5C,OARAmB,KAAKhE,MAAQgE,KAAK0L,KAAO1L,KAAK0L,KAAKL,KAAO,IAAIQ,GACzChN,KAAkB,GACT,IAAY,EACpBA,EAAQ,MAAY,EACpBA,EAAQ,QAAY,EACpBA,EAAQ,UAAY,EACA,EAC1BA,IAAQ7C,IACDgE,IACX,EAQAoB,EAAOvI,UAAUkK,MAAQ,SAAqBlE,GAC1C,OAAOA,EAAQ,EACTmB,KAAKgM,MAAMF,EAAe,GAAInK,EAAS2E,WAAWzH,IAClDmB,KAAK8C,OAAOjE,EACtB,EAOAuC,EAAOvI,UAAUmK,OAAS,SAAsBnE,GAC5C,OAAOmB,KAAK8C,QAAQjE,GAAS,EAAIA,GAAS,MAAQ,EACtD,EAqBAuC,EAAOvI,UAAUuL,OAAS,SAAsBvF,GAC5C,IAAI0D,EAAOZ,EAAS6E,KAAK3H,GACzB,OAAOmB,KAAKgM,MAAMF,EAAevJ,EAAKtL,SAAUsL,EACpD,EASAnB,EAAOvI,UAAUsL,MAAQ/C,EAAOvI,UAAUuL,OAQ1ChD,EAAOvI,UAAUwL,OAAS,SAAsBxF,GAC5C,IAAI0D,EAAOZ,EAAS6E,KAAK3H,GAAOuH,WAChC,OAAOpG,KAAKgM,MAAMF,EAAevJ,EAAKtL,SAAUsL,EACpD,EAOAnB,EAAOvI,UAAUoK,KAAO,SAAoBpE,GACxC,OAAOmB,KAAKgM,MAAMJ,EAAW,EAAG/M,EAAQ,EAAI,EAChD,EAcAuC,EAAOvI,UAAUqK,QAAU,SAAuBrE,GAC9C,OAAOmB,KAAKgM,MAAMD,EAAc,EAAGlN,IAAU,EACjD,EAQAuC,EAAOvI,UAAUsK,SAAW/B,EAAOvI,UAAUqK,QAQ7C9B,EAAOvI,UAAU0L,QAAU,SAAuB1F,GAC9C,IAAI0D,EAAOZ,EAAS6E,KAAK3H,GACzB,OAAOmB,KAAKgM,MAAMD,EAAc,EAAGxJ,EAAKC,IAAIwJ,MAAMD,EAAc,EAAGxJ,EAAKE,GAC5E,EASArB,EAAOvI,UAAU2L,SAAWpD,EAAOvI,UAAU0L,QAQ7CnD,EAAOvI,UAAUuB,MAAQ,SAAqByE,GAC1C,OAAOmB,KAAKgM,MAAM9K,EAAK9G,MAAM6R,aAAc,EAAGpN,EAClD,EAQAuC,EAAOvI,UAAUwK,OAAS,SAAsBxE,GAC5C,OAAOmB,KAAKgM,MAAM9K,EAAK9G,MAAM8R,cAAe,EAAGrN,EACnD,EAEA,IAAIsN,EAAajL,EAAKtI,MAAMC,UAAUgD,IAChC,SAAwBuP,EAAKrQ,EAAKkH,GAChClH,EAAIc,IAAIuP,EAAKnJ,EACjB,EAEE,SAAwBmJ,EAAKrQ,EAAKkH,GAChC,IAAK,IAAI3G,EAAI,EAAGA,EAAI8P,EAAInU,SAAUqE,EAC9BP,EAAIkH,EAAM3G,GAAK8P,EAAI9P,EAC3B,EAOJ8F,EAAOvI,UAAU0K,MAAQ,SAAqB1E,GAC1C,IAAI7C,EAAM6C,EAAM5H,SAAW,EAC3B,IAAK+E,EACD,OAAOgE,KAAKgM,MAAMJ,EAAW,EAAG,GACpC,GAAI1K,EAAKuF,SAAS5H,GAAQ,CACtB,IAAI9D,EAAMqG,EAAO5H,MAAMwC,EAAMkM,EAAOjR,OAAO4H,IAC3CqJ,EAAOkE,OAAOvN,EAAO9D,EAAK,GAC1B8D,EAAQ9D,CACZ,CACA,OAAOiF,KAAK8C,OAAO9G,GAAKgQ,MAAMG,EAAYnQ,EAAK6C,EACnD,EAOAuC,EAAOvI,UAAU6K,OAAS,SAAsB7E,GAC5C,IAAI7C,EAAM4F,EAAK3K,OAAO4H,GACtB,OAAO7C,EACDgE,KAAK8C,OAAO9G,GAAKgQ,MAAMpK,EAAKyK,MAAOrQ,EAAK6C,GACxCmB,KAAKgM,MAAMJ,EAAW,EAAG,EACnC,EAOAxK,EAAOvI,UAAUyT,KAAO,WAIpB,OAHAtM,KAAK2L,OAAS,IAAIJ,EAAMvL,MACxBA,KAAKyL,KAAOzL,KAAK0L,KAAO,IAAIP,EAAGG,EAAM,EAAG,GACxCtL,KAAKhE,IAAM,EACJgE,IACX,EAMAoB,EAAOvI,UAAU0T,MAAQ,WAUrB,OATIvM,KAAK2L,QACL3L,KAAKyL,KAASzL,KAAK2L,OAAOF,KAC1BzL,KAAK0L,KAAS1L,KAAK2L,OAAOD,KAC1B1L,KAAKhE,IAASgE,KAAK2L,OAAO3P,IAC1BgE,KAAK2L,OAAS3L,KAAK2L,OAAON,OAE1BrL,KAAKyL,KAAOzL,KAAK0L,KAAO,IAAIP,EAAGG,EAAM,EAAG,GACxCtL,KAAKhE,IAAO,GAETgE,IACX,EAMAoB,EAAOvI,UAAU2T,OAAS,WACtB,IAAIf,EAAOzL,KAAKyL,KACZC,EAAO1L,KAAK0L,KACZ1P,EAAOgE,KAAKhE,IAOhB,OANAgE,KAAKuM,QAAQzJ,OAAO9G,GAChBA,IACAgE,KAAK0L,KAAKL,KAAOI,EAAKJ,KACtBrL,KAAK0L,KAAOA,EACZ1L,KAAKhE,KAAOA,GAETgE,IACX,EAMAoB,EAAOvI,UAAU8M,OAAS,WAItB,IAHA,IAAI8F,EAAOzL,KAAKyL,KAAKJ,KACjBtQ,EAAOiF,KAAKF,YAAYtG,MAAMwG,KAAKhE,KACnCiG,EAAO,EACJwJ,GACHA,EAAKzH,GAAGyH,EAAKL,IAAKrQ,EAAKkH,GACvBA,GAAOwJ,EAAKzP,IACZyP,EAAOA,EAAKJ,KAGhB,OAAOtQ,CACX,EAEAqG,EAAOD,WAAa,SAASsL,GACzBpL,EAAeoL,EACfrL,EAAOzC,OAASA,IAChB0C,EAAaF,YACjB,sCC/cA1C,EAAOnF,QAAU+H,EAGjB,IAAID,EAAS,EAAQ,QACpBC,EAAaxI,UAAY6F,OAAOC,OAAOyC,EAAOvI,YAAYiH,YAAcuB,EAEzE,IAAIH,EAAO,EAAQ,OAQnB,SAASG,IACLD,EAAOrI,KAAKiH,KAChB,CAuCA,SAAS0M,EAAkBtB,EAAKrQ,EAAKkH,GAC7BmJ,EAAInU,OAAS,GACbiK,EAAKU,KAAKyK,MAAMjB,EAAKrQ,EAAKkH,GACrBlH,EAAIyO,UACTzO,EAAIyO,UAAU4B,EAAKnJ,GAEnBlH,EAAIsR,MAAMjB,EAAKnJ,EACvB,CA5CAZ,EAAaF,WAAa,WAOtBE,EAAa7H,MAAQ0H,EAAKyI,oBAE1BtI,EAAasL,iBAAmBzL,EAAKkB,QAAUlB,EAAKkB,OAAOvJ,qBAAqB2B,YAAiD,QAAnC0G,EAAKkB,OAAOvJ,UAAUgD,IAAIwD,KAClH,SAA8B+L,EAAKrQ,EAAKkH,GACxClH,EAAIc,IAAIuP,EAAKnJ,EAEf,EAEE,SAA+BmJ,EAAKrQ,EAAKkH,GACzC,GAAImJ,EAAIwB,KACNxB,EAAIwB,KAAK7R,EAAKkH,EAAK,EAAGmJ,EAAInU,aACvB,IAAK,IAAIqE,EAAI,EAAGA,EAAI8P,EAAInU,QAC3B8D,EAAIkH,KAASmJ,EAAI9P,IACrB,CACR,EAMA+F,EAAaxI,UAAU0K,MAAQ,SAA4B1E,GACnDqC,EAAKuF,SAAS5H,KACdA,EAAQqC,EAAKwI,aAAa7K,EAAO,WACrC,IAAI7C,EAAM6C,EAAM5H,SAAW,EAI3B,OAHA+I,KAAK8C,OAAO9G,GACRA,GACAgE,KAAKgM,MAAM3K,EAAasL,iBAAkB3Q,EAAK6C,GAC5CmB,IACX,EAcAqB,EAAaxI,UAAU6K,OAAS,SAA6B7E,GACzD,IAAI7C,EAAMkF,EAAKkB,OAAOyK,WAAWhO,GAIjC,OAHAmB,KAAK8C,OAAO9G,GACRA,GACAgE,KAAKgM,MAAMU,EAAmB1Q,EAAK6C,GAChCmB,IACX,EAUAqB,EAAaF,iDClFyM7H,EAAQ,QAAmD,EACjR,IAAIwT,EAAU,EAAQ,OAGtB,IAAIC,EAAW,EAAQ,OACvBrO,OAAO2B,eAAe/G,EAAS,KAA/B,CAA+CsH,YAAY,EAAMD,IAAK,WAAc,OAAOoM,EAASC,UAAY,IAEhH,IAAIC,EAAW,EAAQ,OAKvB,IAAIC,EAAQ,EAAQ,OAGpB,IAAIC,EAAY,EAAQ,OAGxB,IAAIC,EAAS,EAAQ,2CClBrB,MAAM,aAAEC,GAAiB,EAAQ,OAC3BC,EAAc,EAAQ,QACtB,YAAEC,EAAW,WAAEC,GAAe,EAAQ,OAEtCC,EAAWjX,OAAO,WAClBkX,EAAUlX,OAAO,UACjBmX,EAAcnX,OAAO,cACrBoX,EAAepX,OAAO,eACtBqX,EAAkBrX,OAAO,kBA0K/B8C,EAAQwU,qBAxKR,MACEhO,YAAaiO,GACX,GAAkB,iBAAPA,GAA0B,OAAPA,EAAa,CAEzC,MAAM,IAAI/I,UAAU,mEADA,OAAP+I,EAAc,cAAgBA,IAE7C,CAEA/N,KAAK2N,GAAe,GACpB3N,KAAK6N,GAAmB,GACxB7N,KAAK0N,GAAW,OAChB1N,KAAK4N,GAAgB5N,KAAK4N,GAAcxR,KAAK4D,MAE7CA,KAAK+N,GAAKA,EACV/N,KAAK+N,GAAGC,eAAehO,MACvBA,KAAKiO,SAAWF,EAAGE,QACrB,CAEIhX,aACF,OAAO+I,KAAK2N,GAAa1W,MAC3B,CAEAiX,IAAKC,EAAKtP,EAAOuP,GACf,GAAsB,SAAlBpO,KAAK0N,GACP,MAAM,IAAIJ,EAAY,gEAAiE,CACrFe,KAAM,yBAIV,MAAMzI,EAAM5F,KAAK+N,GAAGO,UAAUH,IAAQnO,KAAK+N,GAAGQ,YAAY1P,GAC1D,GAAI+G,EAAK,MAAMA,EAEf,MAAMmI,EAAKK,GAA+B,MAApBA,EAAQI,SAAmBJ,EAAQI,SAAWxO,KAAK+N,GACnElN,EAAWuN,EACXK,EAAcV,EAAGU,YAAYL,GAAWA,EAAQK,aAChDC,EAAgBX,EAAGW,cAAcN,GAAWA,EAAQM,eACpDC,EAAYF,EAAYG,OAG9BR,EAAU,IAAKA,EAASK,YAAaE,EAAWD,cAAeA,EAAcE,QAGzEb,IAAO/N,KAAK+N,KACdK,EAAQI,SAAW,MAGrB,MAAMK,EAAYd,EAAGe,UAAUL,EAAYM,OAAOZ,GAAMQ,GAClDK,EAAcN,EAAcK,OAAOlQ,GAKzC,OAHAmB,KAAKiP,KAAKJ,EAAWG,EAAaZ,GAClCpO,KAAK2N,GAAajW,KAAK,IAAKmJ,EAAUqO,KAAM,MAAOf,MAAKtP,UAEjDmB,IACT,CAEAiP,KAAMd,EAAKtP,EAAOuP,GAAU,CAE5Be,IAAKhB,EAAKC,GACR,GAAsB,SAAlBpO,KAAK0N,GACP,MAAM,IAAIJ,EAAY,gEAAiE,CACrFe,KAAM,yBAIV,MAAMzI,EAAM5F,KAAK+N,GAAGO,UAAUH,GAC9B,GAAIvI,EAAK,MAAMA,EAEf,MAAMmI,EAAKK,GAA+B,MAApBA,EAAQI,SAAmBJ,EAAQI,SAAWxO,KAAK+N,GACnElN,EAAWuN,EACXK,EAAcV,EAAGU,YAAYL,GAAWA,EAAQK,aAChDE,EAAYF,EAAYG,OAa9B,OAVAR,EAAU,IAAKA,EAASK,YAAaE,GAGjCZ,IAAO/N,KAAK+N,KACdK,EAAQI,SAAW,MAGrBxO,KAAKoP,KAAKrB,EAAGe,UAAUL,EAAYM,OAAOZ,GAAMQ,GAAYP,GAC5DpO,KAAK2N,GAAajW,KAAK,IAAKmJ,EAAUqO,KAAM,MAAOf,QAE5CnO,IACT,CAEAoP,KAAMjB,EAAKC,GAAU,CAErBiB,QACE,GAAsB,SAAlBrP,KAAK0N,GACP,MAAM,IAAIJ,EAAY,kEAAmE,CACvFe,KAAM,yBAOV,OAHArO,KAAKsP,SACLtP,KAAK2N,GAAe,GAEb3N,IACT,CAEAsP,SAAW,CAEXjD,MAAO+B,EAAS5I,GAyBd,OAxBAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,GAEC,SAAlBpO,KAAK0N,GACP1N,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,kEAAmE,CACzGe,KAAM,0BAEiB,IAAhBrO,KAAK/I,OACd+I,KAAKuP,MAAM/J,IAEXxF,KAAK0N,GAAW,UAChB1N,KAAKwP,OAAOpB,GAAUxI,IACpB5F,KAAK0N,GAAW,UAChB1N,KAAK6N,GAAiBnW,MAAK,IAAM8N,EAASI,KAIrCA,GAAK5F,KAAK+N,GAAGjI,KAAK,QAAS9F,KAAK2N,IAErC3N,KAAKyP,OAAOzP,KAAK4N,GAAa,KAI3BpI,EAASiI,EAClB,CAEA+B,OAAQpB,EAAS5I,GAAW,CAE5B+J,MAAO/J,GAgBL,OAfAA,EAAW6H,EAAa7H,EAAUiI,GAEZ,YAAlBzN,KAAK0N,GACP1N,KAAK6N,GAAiBnW,KAAK8N,GACA,WAAlBxF,KAAK0N,GACd1N,KAAKiO,SAASzI,IAEdxF,KAAK6N,GAAiBnW,KAAK8N,GAEL,YAAlBxF,KAAK0N,KACP1N,KAAK0N,GAAW,UAChB1N,KAAKyP,OAAOzP,KAAK4N,MAIdpI,EAASiI,EAClB,CAEAgC,OAAQjK,GACNxF,KAAKiO,SAASzI,EAChB,CAEA,CAACoI,KACC5N,KAAK0N,GAAW,SAChB1N,KAAK+N,GAAG2B,eAAe1P,MAEvB,MAAM2P,EAAY3P,KAAK6N,GACvB7N,KAAK6N,GAAmB,GAExB,IAAK,MAAM+B,KAAMD,EACfC,GAEJ,sDC/KF,MAAM,aAAEvC,GAAiB,EAAQ,OAC3BC,EAAc,EAAQ,QACtB,WAAEE,EAAU,YAAED,GAAgB,EAAQ,OAEtCE,EAAWjX,OAAO,WAClBqZ,EAAYrZ,OAAO,YACnBsZ,EAAWtZ,OAAO,WAClBuZ,EAAavZ,OAAO,aACpBwZ,EAAcxZ,OAAO,cACrByZ,EAAazZ,OAAO,aACpB0Z,EAAc1Z,OAAO,cACrB2Z,EAAc3Z,OAAO,cACrB4Z,EAAW5Z,OAAO,WAClB6Z,EAAe7Z,OAAO,eACtB8Z,EAAU9Z,OAAO,UACjBqX,EAAkBrX,OAAO,kBACzB+Z,EAAe/Z,OAAO,eACtBga,EAAiBha,OAAO,iBACxBia,EAAgBja,OAAO,gBACvBka,EAAUla,OAAO,UACjBma,EAAQna,OAAO,QACfoa,EAAUpa,OAAO,UACjBqa,EAASra,OAAO,SAChBsa,EAASta,OAAO,SAEhBua,EAAerS,OAAOmK,OAAO,CAAC,GAC9ByC,EAAO,OACb,IAAI0F,GAAY,EAIhB,MAAMC,EACJnR,YAAaiO,EAAIK,EAAS8C,GACxB,GAAkB,iBAAPnD,GAA0B,OAAPA,EAAa,CAEzC,MAAM,IAAI/I,UAAU,mEADA,OAAP+I,EAAc,cAAgBA,IAE7C,CAEA,GAAuB,iBAAZK,GAAoC,OAAZA,EACjC,MAAM,IAAIpJ,UAAU,iDAGtBhF,KAAKsQ,IAAW,EAChBtQ,KAAK6N,GAAmB,GACxB7N,KAAK8P,IAAY,EACjB9P,KAAKoQ,IAAY,EACjBpQ,KAAKiQ,IAAc,EACnBjQ,KAAK6P,GAAa,KAClB7P,KAAK+P,GAAc/P,KAAK+P,GAAY3T,KAAK4D,MACzCA,KAAKgQ,GAAehQ,KAAKgQ,GAAa5T,KAAK4D,MAC3CA,KAAKqQ,GAAgBrQ,KAAKqQ,GAAcjU,KAAK4D,MAC7CA,KAAKuQ,GAAgBnC,EAAQmC,GAC7BvQ,KAAKwQ,GAAkBpC,EAAQoC,GAC/BxQ,KAAK0Q,GAAWQ,EAChBlR,KAAK6Q,GAAU7H,OAAOD,UAAUqF,EAAQ+C,QAAU/C,EAAQ+C,OAAS,EAAI/C,EAAQ+C,MAAQC,IACvFpR,KAAK8Q,GAAU,EAMf9Q,KAAKyQ,KAAmBrC,EAAQiD,aAEhCrR,KAAK+N,GAAKA,EACV/N,KAAK+N,GAAGC,eAAehO,MACvBA,KAAKiO,SAAWF,EAAGE,QACrB,CAEIqD,YACF,OAAOtR,KAAK8Q,EACd,CAEIK,YACF,OAAOnR,KAAK6Q,EACd,CAEAxF,KAAM7F,GACJ,IAAI+L,EAEJ,QAAiB7J,IAAblC,EACF+L,EAAU,IAAIC,SAAQ,CAACC,EAASC,KAC9BlM,EAAW,CAACI,EAAKuI,EAAKtP,KAChB+G,EAAK8L,EAAO9L,GACN5F,KAAK0Q,QACEhJ,IAARyG,QAA+BzG,IAAV7I,EAAqB4S,IAC9CA,EAAQ,CAACtD,EAAKtP,IAFM4S,EAAQtD,EAER,CAC3B,SAEG,GAAwB,mBAAb3I,EAChB,MAAM,IAAIR,UAAU,+BAmBtB,OAhBIhF,KAAKoQ,GACPpQ,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,yDAA0D,CAChGe,KAAM,6BAECrO,KAAK8P,GACd9P,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,yEAA0E,CAChHe,KAAM,0BAGRrO,KAAK8P,IAAY,EACjB9P,KAAK6P,GAAarK,EAEdxF,KAAK8Q,IAAW9Q,KAAK6Q,GAAS7Q,KAAKiO,SAASjO,KAAK+P,GAAa,MAC7D/P,KAAK2R,MAAM3R,KAAK+P,KAGhBwB,CACT,CAEAI,MAAOnM,GACLxF,KAAKiO,SAASzI,EAChB,CAEAoM,MAAOna,EAAM2W,EAAS5I,GAKpB,OAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAAS2C,GAEzB/H,OAAOD,UAAUtR,IAKlBuI,KAAKoQ,GACPpQ,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,0DAA2D,CACjGe,KAAM,6BAECrO,KAAK8P,GACd9P,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,0EAA2E,CACjHe,KAAM,0BAGJ5W,EAAO,IAAGA,EAAO,GACjBuI,KAAK6Q,GAAUO,MAAU3Z,EAAOwB,KAAKyL,IAAIjN,EAAMuI,KAAK6Q,GAAU7Q,KAAK8Q,KAEvE9Q,KAAK8P,IAAY,EACjB9P,KAAK6P,GAAarK,EAEd/N,GAAQ,EAAGuI,KAAKiO,SAASjO,KAAKgQ,GAAc,KAAM,IACjDhQ,KAAK6R,OAAOpa,EAAM2W,EAASpO,KAAKgQ,KAGhCxK,EAASiI,KAvBdzN,KAAKiO,SAASzI,EAAU,IAAIR,UAAU,iDAC/BQ,EAASiI,GAuBpB,CAEAoE,OAAQpa,EAAM2W,EAAS5I,GACrB,MAAMsM,EAAM,GACNC,EAAS,CAACnM,EAAKuI,EAAKtP,IACpB+G,EACKJ,EAASI,IACP5F,KAAK0Q,QAAmBhJ,IAARyG,QAA+BzG,IAAV7I,OAA8B6I,IAARyG,GAC7D3I,EAAS,KAAMsM,IAGxBA,EAAIpa,KAAKsI,KAAK0Q,GAAW,CAACvC,EAAKtP,GAASsP,QAEpC2D,EAAI7a,SAAWQ,EACjB+N,EAAS,KAAMsM,GAEf9R,KAAK2R,MAAMI,KAIf/R,KAAK2R,MAAMI,EACb,CAEAC,IAAK5D,EAAS5I,GAsBZ,OArBAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAAS2C,GAE1B/Q,KAAKoQ,GACPpQ,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,wDAAyD,CAC/Fe,KAAM,6BAECrO,KAAK8P,GACd9P,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,wEAAyE,CAC/Ge,KAAM,0BAGRrO,KAAK8P,IAAY,EACjB9P,KAAK6P,GAAarK,EAClBxF,KAAKiQ,IAAc,EAEfjQ,KAAK8Q,IAAW9Q,KAAK6Q,GAAS7Q,KAAKiO,SAASjO,KAAKgQ,GAAc,KAAM,IACpEhQ,KAAKiS,KAAK7D,EAASpO,KAAKgQ,KAGxBxK,EAASiI,EAClB,CAEAwE,KAAM7D,EAAS5I,GAEb,IAAI8L,EAAQtR,KAAK8Q,GACjB,MAAMgB,EAAM,GAENF,EAAQ,KAEZ,MAAMna,EAAOuI,KAAK6Q,GAAUO,IAAWnY,KAAKyL,IAAI,IAAK1E,KAAK6Q,GAAUS,GAAS,IAEzE7Z,GAAQ,EACVuI,KAAKiO,SAASzI,EAAU,KAAMsM,GAE9B9R,KAAK6R,OAAOpa,EAAMsZ,EAAcmB,EAClC,EAGIA,EAAU,CAACtM,EAAKuM,KAChBvM,EACFJ,EAASI,GACiB,IAAjBuM,EAAMlb,OACfuO,EAAS,KAAMsM,IAEfA,EAAIpa,KAAKL,MAAMya,EAAKK,GACpBb,GAASa,EAAMlb,OACf2a,IACF,EAGFA,GACF,CAEA,CAAC1B,KACC,MAAMN,EAAK5P,KAAK6P,GAGhB,OAAI7P,KAAKyQ,IAAyB,OAAPb,EAAoBtE,GAE/CtL,KAAK8P,IAAY,EACjB9P,KAAK6P,GAAa,KAEd7P,KAAKoQ,IAAWpQ,KAAKyP,OAAOzP,KAAKqQ,IAE9BT,EACT,CAEA,CAACO,GAAcP,EAAIhK,EAAKuM,GAClBnS,KAAKiQ,GACPjQ,KAAKuP,MAAMK,EAAGxT,KAAK,KAAMwJ,EAAKuM,IAE9BvC,EAAGhK,EAAKuM,EAEZ,CAEAC,KAAMC,EAAQjE,GAGZ,GAFAA,EAAUZ,EAAWY,EAAS2C,GAE1B/Q,KAAKoQ,QAGF,IAAIpQ,KAAK8P,GACd,MAAM,IAAIxC,EAAY,kEAAmE,CACvFe,KAAM,wBAEH,CACL,MAAMI,EAAczO,KAAK+N,GAAGU,YAAYL,EAAQK,aAAezO,KAAKuQ,IAC9D5B,EAAYF,EAAYG,OAE1BR,EAAQK,cAAgBE,IAC1BP,EAAU,IAAKA,EAASK,YAAaE,IAGvC,MAAM2D,EAAStS,KAAK+N,GAAGe,UAAUL,EAAYM,OAAOsD,GAAS1D,GAC7D3O,KAAKuS,MAAMD,EAAQlE,EACrB,EACF,CAEAmE,MAAOF,EAAQjE,GACb,MAAM,IAAId,EAAY,mCAAoC,CACxDe,KAAM,uBAEV,CAEAkB,MAAO/J,GAGL,GAFAA,EAAW6H,EAAa7H,EAAUiI,GAE9BzN,KAAKsQ,GACPtQ,KAAKiO,SAASzI,QACT,GAAIxF,KAAKoQ,GACdpQ,KAAK6N,GAAiBnW,KAAK8N,QAK3B,GAHAxF,KAAKoQ,IAAY,EACjBpQ,KAAK6N,GAAiBnW,KAAK8N,GAEtBxF,KAAK8P,IAEH,GAAI9P,KAAKyQ,GAAgB,CAEnBzQ,KAAKkQ,IAEhBN,CAAG,IAAItC,EAAY,8BAA+B,CAChDe,KAAM,4BAEV,OARErO,KAAKyP,OAAOzP,KAAKqQ,IAWrB,OAAO7K,EAASiI,EAClB,CAEAgC,OAAQjK,GACNxF,KAAKiO,SAASzI,EAChB,CAEA,CAAC6K,KACCrQ,KAAKsQ,IAAW,EAChBtQ,KAAK+N,GAAG2B,eAAe1P,MAEvB,MAAM2P,EAAY3P,KAAK6N,GACvB7N,KAAK6N,GAAmB,GAExB,IAAK,MAAM+B,KAAMD,EACfC,GAEJ,CAEA3R,OAASzH,OAAOgc,iBACd,IACE,IAAIC,EAEJ,UAAwC/K,KAAhC+K,QAAczS,KAAKqL,eACnBoH,CAEV,CAAE,QACKzS,KAAKsQ,UAAgBtQ,KAAKuP,OACjC,CACF,EAIF,MAAMmD,UAAyBzB,EAC7BnR,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAAS,GACnBpO,KAAK2Q,IAA0B,IAAjBvC,EAAQ3G,KACtBzH,KAAK4Q,IAA8B,IAAnBxC,EAAQzS,MAC1B,CAEA,CAACoU,GAAanK,EAAKuI,EAAKtP,GACtB,MAAM+Q,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAOgK,EAAGhK,GAEnB,IACEuI,EAAMnO,KAAK2Q,SAAkBjJ,IAARyG,EAAoBnO,KAAKuQ,GAAcnE,OAAO+B,QAAOzG,EAC1E7I,EAAQmB,KAAK4Q,SAAsBlJ,IAAV7I,EAAsBmB,KAAKwQ,GAAgBpE,OAAOvN,QAAS6I,CACtF,CAAE,MAAO9B,GACP,OAAOgK,EAAG,IAAIgD,EAAoB,QAAShN,GAC7C,MAEc8B,IAARyG,QAA+BzG,IAAV7I,GACzBmB,KAAK8Q,KAGPlB,EAAG,KAAMzB,EAAKtP,EAChB,CAEA,CAACmR,GAAcpK,EAAKiN,GAClB,MAAMjD,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAO5F,KAAKmQ,GAAaP,EAAIhK,GAEtC,IACE,IAAK,MAAMkN,KAASD,EAAS,CAC3B,MAAM1E,EAAM2E,EAAM,GACZjU,EAAQiU,EAAM,GAEpBA,EAAM,GAAK9S,KAAK2Q,SAAkBjJ,IAARyG,EAAoBnO,KAAKuQ,GAAcnE,OAAO+B,QAAOzG,EAC/EoL,EAAM,GAAK9S,KAAK4Q,SAAsBlJ,IAAV7I,EAAsBmB,KAAKwQ,GAAgBpE,OAAOvN,QAAS6I,CACzF,CACF,CAAE,MAAO9B,GACP,OAAO5F,KAAKmQ,GAAaP,EAAI,IAAIgD,EAAoB,UAAWhN,GAClE,CAEA5F,KAAK8Q,IAAW+B,EAAQ5b,OACxB+I,KAAKmQ,GAAaP,EAAI,KAAMiD,EAC9B,CAEAlQ,IAAK6C,GASH,OARKwL,QAAgC,IAAZtY,IACvBsY,GAAY,EACZtY,EAAQqa,KAAK,IAAIzF,EACf,kHACA,CAAEe,KAAM,mBAILrO,KAAKuP,MAAM/J,EACpB,EA8EF,MAAMoN,UAA4BtF,EAChCxN,YAAakT,EAASC,GACpBN,MAAM,6BAA6BK,IAAW,CAC5C3E,KAAM,qBACN4E,SAEJ,EAIF,IAAK,MAAMC,IAAK,CAAC,kBAAmB,oBAAqB,eACvDxU,OAAO2B,eAAeqS,EAAiB7Z,UAAWqa,EAAEjU,MAAM,KAAK,GAAI,CACjE0B,MAAS,MAAM,IAAI2M,EAAY,OAAO4F,qBAAsB,CAAE7E,KAAM,gBAAkB,EACtFxS,MAAS,MAAM,IAAIyR,EAAY,OAAO4F,qBAAsB,CAAE7E,KAAM,gBAAkB,IAK1FqE,EAAiBjE,YAAc8B,EAC/BmC,EAAiBhE,cAAgB8B,EAEjClX,EAAQoZ,iBAAmBA,EAC3BpZ,EAAQ6Z,oBAjGR,cAAkClC,EAChCnR,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAAS,EACrB,CAEA,CAAC2B,GAAanK,EAAKuI,GACjB,MAAMyB,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAOgK,EAAGhK,GAEnB,IACEuI,OAAczG,IAARyG,EAAoBnO,KAAKuQ,GAAcnE,OAAO+B,QAAOzG,CAC7D,CAAE,MAAO9B,GACP,OAAOgK,EAAG,IAAIgD,EAAoB,MAAOhN,GAC3C,MAEY8B,IAARyG,GAAmBnO,KAAK8Q,KAC5BlB,EAAG,KAAMzB,EACX,CAEA,CAAC6B,GAAcpK,EAAK6B,GAClB,MAAMmI,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAO5F,KAAKmQ,GAAaP,EAAIhK,GAEtC,IACE,IAAK,IAAItK,EAAI,EAAGA,EAAImM,EAAKxQ,OAAQqE,IAAK,CACpC,MAAM6S,EAAM1G,EAAKnM,GACjBmM,EAAKnM,QAAaoM,IAARyG,EAAoBnO,KAAKuQ,GAAcnE,OAAO+B,QAAOzG,CACjE,CACF,CAAE,MAAO9B,GACP,OAAO5F,KAAKmQ,GAAaP,EAAI,IAAIgD,EAAoB,OAAQhN,GAC/D,CAEA5F,KAAK8Q,IAAWrJ,EAAKxQ,OACrB+I,KAAKmQ,GAAaP,EAAI,KAAMnI,EAC9B,GAgEFnO,EAAQ8Z,sBA7DR,cAAoCnC,EAClCnR,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAAS,EACrB,CAEA,CAAC2B,GAAanK,EAAK/G,GACjB,MAAM+Q,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAOgK,EAAGhK,GAEnB,IACE/G,OAAkB6I,IAAV7I,EAAsBmB,KAAKwQ,GAAgBpE,OAAOvN,QAAS6I,CACrE,CAAE,MAAO9B,GACP,OAAOgK,EAAG,IAAIgD,EAAoB,QAAShN,GAC7C,MAEc8B,IAAV7I,GAAqBmB,KAAK8Q,KAC9BlB,EAAG,KAAM/Q,EACX,CAEA,CAACmR,GAAcpK,EAAKjK,GAClB,MAAMiU,EAAK5P,KAAKkQ,KAChB,GAAItK,EAAK,OAAO5F,KAAKmQ,GAAaP,EAAIhK,GAEtC,IACE,IAAK,IAAItK,EAAI,EAAGA,EAAIK,EAAO1E,OAAQqE,IAAK,CACtC,MAAMuD,EAAQlD,EAAOL,GACrBK,EAAOL,QAAeoM,IAAV7I,EAAsBmB,KAAKwQ,GAAgBpE,OAAOvN,QAAS6I,CACzE,CACF,CAAE,MAAO9B,GACP,OAAO5F,KAAKmQ,GAAaP,EAAI,IAAIgD,EAAoB,SAAUhN,GACjE,CAEA5F,KAAK8Q,IAAWnV,EAAO1E,OACvB+I,KAAKmQ,GAAaP,EAAI,KAAMjU,EAC9B,uCC5cF,MAAM,SAAE0X,GAAa,EAAQ,QACvB,WAAEC,GAAe,EAAQ,QACzB,aAAErO,GAAiB,EAAQ,QAC3B,aAAEoI,GAAiB,EAAQ,OAC3BC,EAAc,EAAQ,QACtB,iBAAEoF,GAAqB,EAAQ,QAC/B,mBAAEa,EAAkB,qBAAEC,GAAyB,EAAQ,QACvD,iBAAEC,EAAgB,oBAAEC,EAAmB,sBAAEC,GAA0B,EAAQ,QAC3E,oBAAEC,GAAwB,EAAQ,OAClC,YAAErG,EAAW,WAAEC,GAAe,EAAQ,OACtCqG,EAAe,EAAQ,OAEvBpG,EAAWjX,OAAO,WAClBsd,EAAUtd,OAAO,UACjBud,EAAavd,OAAO,aACpBwd,EAAkBxd,OAAO,kBACzBmX,EAAcnX,OAAO,cACrByd,EAAWzd,OAAO,WAClB0d,EAAa1d,OAAO,aACpB2d,EAAW3d,OAAO,WAClBkX,EAAUlX,OAAO,UACjB4d,EAAkB5d,OAAO,kBACzB6d,EAAc7d,OAAO,cACrB+Z,EAAe/Z,OAAO,eACtBga,EAAiBha,OAAO,iBACxB8U,EAAO,OAEb,MAAMgJ,UAAsBrP,EAC1BnF,YAAayU,EAAUnG,GAGrB,GAFAuE,QAEwB,iBAAb4B,GAAsC,OAAbA,EAClC,MAAM,IAAIvP,UAAU,mDAGtBoJ,EAAUZ,EAAWY,GACrB,MAAM,YAAEK,EAAW,cAAEC,EAAa,QAAE8F,KAAYC,GAAYrG,EAE5DpO,KAAK+T,GAAc,IAAIW,IACvB1U,KAAK2N,GAAe,GACpB3N,KAAKkU,IAAc,EACnBlU,KAAKmU,GAAYM,EACjBzU,KAAK0N,GAAW,UAEhB1N,KAAKqT,SAAWA,EAASkB,EAAU,CACjCI,QAAQ,EACRC,UAAU,EACVvF,OAAO,EACPwF,SAAS,EACTC,cAAc,EAGdC,WAAkC,IAAvBR,EAASQ,UACpBC,YAAoC,IAAxBT,EAASS,WAGrBC,aAAa,EACbC,eAAe,EACfC,eAAe,EACfC,aAAa,EAEbC,UAAWd,EAASc,WAAa,CAAC,EAClCC,OAAQ5W,OAAO6W,OAAO,CAAC,EAAGhB,EAASe,OAAQ,CACzCE,SAAS,EACTC,MAAM,EACNC,SAAS,EACTC,QAAQ,EACRzH,KAAK,EACLiB,KAAK,EACLyG,OAAO,EACPvG,OAAO,MAIXrP,KAAKqU,GAAe,IAAIf,EAAWuC,EAAQ7V,OAC3CA,KAAKuQ,GAAgBvQ,KAAKqU,GAAapJ,SAASwD,GAAe,QAC/DzO,KAAKwQ,GAAkBxQ,KAAKqU,GAAapJ,SAASyD,GAAiB,QAGnE,IAAK,MAAMzD,KAAYjL,KAAKqU,GAAagB,YAClCrV,KAAKqT,SAASgC,UAAUpK,EAAS6K,cACpC9V,KAAKqT,SAASgC,UAAUpK,EAAS6K,aAAc,GAInD9V,KAAKoU,GAAmB,CACtB2B,MAAOrX,OAAOmK,OAAO,CAAC,GACtBiK,MAAOpU,OAAOmK,OAAO,CACnB4F,YAAazO,KAAKuQ,GAAcuF,WAChCpH,cAAe1O,KAAKwQ,GAAgBsF,aAEtC3H,IAAKzP,OAAOmK,OAAO,CACjB4F,YAAazO,KAAKuQ,GAAcuF,cAKpC9V,KAAKiO,UAAS,KACRjO,KAAKkU,IACPlU,KAAKyV,KAAK,CAAEjB,SAAS,GAASlJ,EAChC,GAEJ,CAEIqJ,aACF,OAAO3U,KAAK0N,EACd,CAEAe,YAAaxD,GACX,OAAOjL,KAAKqU,GAAapJ,SAAqB,MAAZA,EAAmBA,EAAWjL,KAAKuQ,GACvE,CAEA7B,cAAezD,GACb,OAAOjL,KAAKqU,GAAapJ,SAAqB,MAAZA,EAAmBA,EAAWjL,KAAKwQ,GACvE,CAEAiF,KAAMrH,EAAS5I,GACbA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,IAElCW,EAAU,IAAKpO,KAAKmU,MAAc3G,EAAWY,KAErC4H,iBAA8C,IAA5B5H,EAAQ4H,gBAClC5H,EAAQ6H,gBAAkB7H,EAAQ6H,cAElC,MAAMC,EAAetQ,IACG,YAAlB5F,KAAK0N,IAA4C,YAAlB1N,KAAK0N,GAEtC1N,KAAKmW,KAAKrC,EAASlO,EAAM,IAAMsQ,EAAYtQ,GAAOsQ,GACvB,SAAlBlW,KAAK0N,GACdlI,EAAS,IAAI8H,EAAY,uBAAwB,CAC/Ce,KAAM,0BACN4E,MAAOrN,KAGTJ,GACF,EA8CF,OA3CI4I,EAAQoG,QACY,YAAlBxU,KAAK0N,GACP1N,KAAKmW,KAAKrC,EAASoC,GAEnBlW,KAAKiO,SAASiI,GAEW,WAAlBlW,KAAK0N,IAAyB1N,KAAKkU,IAC5ClU,KAAKkU,IAAc,EACnBlU,KAAK0N,GAAW,UAChB1N,KAAK8F,KAAK,WAEV9F,KAAKoW,MAAMhI,GAAUxI,IACnB,GAAIA,EAUF,OATA5F,KAAK0N,GAAW,SAGhB1N,KAAKgU,IAAiB,KACpBhU,KAAK8F,KAAKgO,GACVoC,EAAYtQ,EAAG,SAGjB5F,KAAKiU,KAIPjU,KAAK0N,GAAW,OAChB1N,KAAKiU,KACLjU,KAAK8F,KAAKgO,GAGY,SAAlB9T,KAAK0N,IAAqB1N,KAAK8F,KAAK,QAGlB,SAAlB9F,KAAK0N,IAAqB1N,KAAK8F,KAAK,SAExCoQ,GAAY,KAEa,SAAlBlW,KAAK0N,GACd1N,KAAKiO,SAASiI,GAEdlW,KAAKmW,KAAKrC,GAAS,IAAM9T,KAAKyV,KAAKrH,EAAS5I,KAGvCA,EAASiI,EAClB,CAEA2I,MAAOhI,EAAS5I,GACdxF,KAAKiO,SAASzI,EAChB,CAEA+J,MAAO/J,GACLA,EAAW6H,EAAa7H,EAAUiI,GAElC,MAAM4I,EAAezQ,IACG,YAAlB5F,KAAK0N,IAA4C,YAAlB1N,KAAK0N,GAEtC1N,KAAKmW,KAAKrC,EAASlO,EAAMyQ,EAAYzQ,GAAOyQ,GACjB,WAAlBrW,KAAK0N,GACdlI,EAAS,IAAI8H,EAAY,yBAA0B,CACjDe,KAAM,4BACN4E,MAAOrN,KAGTJ,GACF,EAGF,GAAsB,SAAlBxF,KAAK0N,GAAqB,CAC5B1N,KAAK0N,GAAW,UAChB1N,KAAK8F,KAAK,WAEV,MAAMwQ,EAAU1Q,IACd5F,KAAK0N,GAAW,OAChB1N,KAAKiU,KACLjU,KAAK8F,KAAKgO,GACVuC,EAAYzQ,EAAG,EAGjB5F,KAAKgU,IAAiB,KACpBhU,KAAKyP,QAAQ7J,IACX,GAAIA,EAAK,OAAO0Q,EAAO1Q,GAEvB5F,KAAK0N,GAAW,SAChB1N,KAAKiU,KACLjU,KAAK8F,KAAKgO,GAGY,WAAlB9T,KAAK0N,IAAuB1N,KAAK8F,KAAK,UAE1CuQ,GAAY,GACb,GAEL,KAA6B,WAAlBrW,KAAK0N,GACd1N,KAAKiO,SAASoI,GAEdrW,KAAKmW,KAAKrC,GAAS,IAAM9T,KAAKuP,MAAM/J,KAGtC,OAAOA,EAASiI,EAClB,CAEA,CAACuG,GAAkBxO,GACjB,GAA8B,IAA1BxF,KAAK+T,GAAYtc,KACnB,OAAOuI,KAAKiO,SAASzI,GAGvB,IAAI+Q,EAAUvW,KAAK+T,GAAYtc,KAC3B+e,GAAO,EAEX,MAAMnL,EAAO,KACO,KAAZkL,IAEAC,EAAMxW,KAAKiO,SAASzI,GACnBA,IACP,EAIF,IAAK,MAAMiR,KAAYzW,KAAK+T,GAC1B0C,EAASlH,MAAMlE,GAGjBmL,GAAO,EACPxW,KAAK+T,GAAY1E,OACnB,CAEAI,OAAQjK,GACNxF,KAAKiO,SAASzI,EAChB,CAEA7E,IAAKwN,EAAKC,EAAS5I,GAKjB,GAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiBtB,OAE9B,YAAlB9S,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAKW,IAAIwN,EAAKC,EAAS5I,KACjCA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,MAAM7H,EAAM5F,KAAKsO,UAAUH,GAE3B,GAAIvI,EAEF,OADA5F,KAAKiO,SAASzI,EAAUI,GACjBJ,EAASiI,GAGlB,MAAMgB,EAAczO,KAAKyO,YAAYL,EAAQK,aACvCC,EAAgB1O,KAAK0O,cAAcN,EAAQM,eAC3CC,EAAYF,EAAYG,OACxBgI,EAAclI,EAAcE,OAgClC,OA7BIR,EAAQK,cAAgBE,GAAaP,EAAQM,gBAAkBkI,IAEjExI,EAAU1P,OAAO6W,OAAO,CAAC,EAAGnH,EAAS,CAAEK,YAAaE,EAAWD,cAAekI,KAGhF5W,KAAK6W,KAAK7W,KAAK8O,UAAUL,EAAYM,OAAOZ,GAAMQ,GAAYP,GAAS,CAACxI,EAAK/G,KAC3E,GAAI+G,EAQF,OANiB,oBAAbA,EAAIyI,MAA8BzI,EAAIkR,UAAY,YAAYvW,KAAKqF,MAChEA,EAAIyI,OAAMzI,EAAIyI,KAAO,mBACrBzI,EAAIkR,WAAUlR,EAAIkR,UAAW,GAC7BlR,EAAI+O,SAAQ/O,EAAI+O,OAAS,MAGzBnP,EAASI,GAGlB,IACE/G,EAAQ6P,EAActC,OAAOvN,EAC/B,CAAE,MAAO+G,GACP,OAAOJ,EAAS,IAAI8H,EAAY,yBAA0B,CACxDe,KAAM,qBACN4E,MAAOrN,IAEX,CAEAJ,EAAS,KAAM3G,EAAK,IAGf2G,EAASiI,EAClB,CAEAoJ,KAAM1I,EAAKC,EAAS5I,GAClBxF,KAAKiO,SAASzI,EAAU,IAAIjN,MAAM,YACpC,CAEAsc,QAASpN,EAAM2G,EAAS5I,GAKtB,GAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiBtB,OAE9B,YAAlB9S,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAK6U,QAAQpN,EAAM2G,EAAS5I,KACtCA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,IAAK7U,MAAMuJ,QAAQsF,GAEjB,OADAzH,KAAKiO,SAASzI,EAAU,IAAIR,UAAU,+CAC/BQ,EAASiI,GAGlB,GAAoB,IAAhBhG,EAAKxQ,OAEP,OADA+I,KAAKiO,SAASzI,EAAU,KAAM,IACvBA,EAASiI,GAGlB,MAAMgB,EAAczO,KAAKyO,YAAYL,EAAQK,aACvCC,EAAgB1O,KAAK0O,cAAcN,EAAQM,eAC3CC,EAAYF,EAAYG,OACxBgI,EAAclI,EAAcE,OAG9BR,EAAQK,cAAgBE,GAAaP,EAAQM,gBAAkBkI,IACjExI,EAAU1P,OAAO6W,OAAO,CAAC,EAAGnH,EAAS,CAAEK,YAAaE,EAAWD,cAAekI,KAGhF,MAAMG,EAAa,IAAIne,MAAM6O,EAAKxQ,QAElC,IAAK,IAAIqE,EAAI,EAAGA,EAAImM,EAAKxQ,OAAQqE,IAAK,CACpC,MAAM6S,EAAM1G,EAAKnM,GACXsK,EAAM5F,KAAKsO,UAAUH,GAE3B,GAAIvI,EAEF,OADA5F,KAAKiO,SAASzI,EAAUI,GACjBJ,EAASiI,GAGlBsJ,EAAWzb,GAAK0E,KAAK8O,UAAUL,EAAYM,OAAOZ,GAAMQ,EAC1D,CAqBA,OAnBA3O,KAAKgX,SAASD,EAAY3I,GAAS,CAACxI,EAAKjK,KACvC,GAAIiK,EAAK,OAAOJ,EAASI,GAEzB,IACE,IAAK,IAAItK,EAAI,EAAGA,EAAIK,EAAO1E,OAAQqE,SACfoM,IAAd/L,EAAOL,KACTK,EAAOL,GAAKoT,EAActC,OAAOzQ,EAAOL,IAG9C,CAAE,MAAOsK,GACP,OAAOJ,EAAS,IAAI8H,EAAY,mCAAmC3R,EAAO1E,kBAAmB,CAC3FoX,KAAM,qBACN4E,MAAOrN,IAEX,CAEAJ,EAAS,KAAM7J,EAAM,IAGhB6J,EAASiI,EAClB,CAEAuJ,SAAUvP,EAAM2G,EAAS5I,GACvBxF,KAAKiO,SAASzI,EAAU,KAAM,IAAI5M,MAAM6O,EAAKxQ,QAAQggB,UAAKvP,GAC5D,CAEAwG,IAAKC,EAAKtP,EAAOuP,EAAS5I,GAKxB,GAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiBtB,OAE9B,YAAlB9S,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAKkO,IAAIC,EAAKtP,EAAOuP,EAAS5I,KACxCA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,MAAM7H,EAAM5F,KAAKsO,UAAUH,IAAQnO,KAAKuO,YAAY1P,GAEpD,GAAI+G,EAEF,OADA5F,KAAKiO,SAASzI,EAAUI,GACjBJ,EAASiI,GAGlB,MAAMgB,EAAczO,KAAKyO,YAAYL,EAAQK,aACvCC,EAAgB1O,KAAK0O,cAAcN,EAAQM,eAC3CC,EAAYF,EAAYG,OACxBgI,EAAclI,EAAcE,OAG9BR,EAAQK,cAAgBE,GAAaP,EAAQM,gBAAkBkI,IACjExI,EAAU1P,OAAO6W,OAAO,CAAC,EAAGnH,EAAS,CAAEK,YAAaE,EAAWD,cAAekI,KAGhF,MAAM/H,EAAY7O,KAAK8O,UAAUL,EAAYM,OAAOZ,GAAMQ,GACpDK,EAAcN,EAAcK,OAAOlQ,GAQzC,OANAmB,KAAKiP,KAAKJ,EAAWG,EAAaZ,GAAUxI,IAC1C,GAAIA,EAAK,OAAOJ,EAASI,GACzB5F,KAAK8F,KAAK,MAAOqI,EAAKtP,GACtB2G,GAAS,IAGJA,EAASiI,EAClB,CAEAwB,KAAMd,EAAKtP,EAAOuP,EAAS5I,GACzBxF,KAAKiO,SAASzI,EAChB,CAEA2J,IAAKhB,EAAKC,EAAS5I,GAKjB,GAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiBjG,KAE9B,YAAlBnO,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAKmP,IAAIhB,EAAKC,EAAS5I,KACjCA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,MAAM7H,EAAM5F,KAAKsO,UAAUH,GAE3B,GAAIvI,EAEF,OADA5F,KAAKiO,SAASzI,EAAUI,GACjBJ,EAASiI,GAGlB,MAAMgB,EAAczO,KAAKyO,YAAYL,EAAQK,aACvCE,EAAYF,EAAYG,OAa9B,OAVIR,EAAQK,cAAgBE,IAC1BP,EAAU1P,OAAO6W,OAAO,CAAC,EAAGnH,EAAS,CAAEK,YAAaE,KAGtD3O,KAAKoP,KAAKpP,KAAK8O,UAAUL,EAAYM,OAAOZ,GAAMQ,GAAYP,GAAUxI,IACtE,GAAIA,EAAK,OAAOJ,EAASI,GACzB5F,KAAK8F,KAAK,MAAOqI,GACjB3I,GAAS,IAGJA,EAASiI,EAClB,CAEA2B,KAAMjB,EAAKC,EAAS5I,GAClBxF,KAAKiO,SAASzI,EAChB,CAEAoQ,MAAOsB,EAAY9I,EAAS5I,GAC1B,IAAKxM,UAAU/B,OAAQ,CACrB,GAAsB,YAAlB+I,KAAK0N,GAAwB,OAAO,IAAIkG,EAAoB5T,MAChE,GAAsB,SAAlBA,KAAK0N,GACP,MAAM,IAAIJ,EAAY,uBAAwB,CAC5Ce,KAAM,4BAGV,OAAOrO,KAAKmX,eACd,CAQA,GANsC3R,EAAZ,mBAAf0R,EAAsCA,EACjC3J,EAAYa,EAAS5I,GAErCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiB2B,OAE9B,YAAlB/V,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAK4V,MAAMsB,EAAY9I,EAAS5I,KAC1CA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,IAAK7U,MAAMuJ,QAAQ+U,GAEjB,OADAlX,KAAKiO,SAASzI,EAAU,IAAIR,UAAU,qDAC/BQ,EAASiI,GAGlB,GAA0B,IAAtByJ,EAAWjgB,OAEb,OADA+I,KAAKiO,SAASzI,GACPA,EAASiI,GAGlB,MAAM6E,EAAS,IAAI1Z,MAAMse,EAAWjgB,SAC5BwX,YAAa2I,EAAI1I,cAAe2I,KAAO5C,GAAYrG,EAE3D,IAAK,IAAI9S,EAAI,EAAGA,EAAI4b,EAAWjgB,OAAQqE,IAAK,CAC1C,GAA6B,iBAAlB4b,EAAW5b,IAAqC,OAAlB4b,EAAW5b,GAElD,OADA0E,KAAKiO,SAASzI,EAAU,IAAIR,UAAU,wCAC/BQ,EAASiI,GAGlB,MAAM6J,EAAK5Y,OAAO6W,OAAO,CAAC,EAAG2B,EAAW5b,IAExC,GAAgB,QAAZgc,EAAGpI,MAA8B,QAAZoI,EAAGpI,KAE1B,OADAlP,KAAKiO,SAASzI,EAAU,IAAIR,UAAU,uEAC/BQ,EAASiI,GAGlB,MAAM7H,EAAM5F,KAAKsO,UAAUgJ,EAAGnJ,KAE9B,GAAIvI,EAEF,OADA5F,KAAKiO,SAASzI,EAAUI,GACjBJ,EAASiI,GAGlB,MAAMM,EAAoB,MAAfuJ,EAAG9I,SAAmB8I,EAAG9I,SAAWxO,KACzCyO,EAAcV,EAAGU,YAAY6I,EAAG7I,aAAe2I,GAC/CzI,EAAYF,EAAYG,OAK9B,GAHA0I,EAAGnJ,IAAMJ,EAAGe,UAAUL,EAAYM,OAAOuI,EAAGnJ,KAAMQ,GAClD2I,EAAG7I,YAAcE,EAED,QAAZ2I,EAAGpI,KAAgB,CACrB,MAAMqI,EAAWvX,KAAKuO,YAAY+I,EAAGzY,OAErC,GAAI0Y,EAEF,OADAvX,KAAKiO,SAASzI,EAAU+R,GACjB/R,EAASiI,GAGlB,MAAMiB,EAAgBX,EAAGW,cAAc4I,EAAG5I,eAAiB2I,GAE3DC,EAAGzY,MAAQ6P,EAAcK,OAAOuI,EAAGzY,OACnCyY,EAAG5I,cAAgBA,EAAcE,MACnC,CAGIb,IAAO/N,OACTsX,EAAG9I,SAAW,MAGhB8D,EAAOhX,GAAKgc,CACd,CAQA,OANAtX,KAAKwX,OAAOlF,EAAQmC,GAAU7O,IAC5B,GAAIA,EAAK,OAAOJ,EAASI,GACzB5F,KAAK8F,KAAK,QAASoR,GACnB1R,GAAS,IAGJA,EAASiI,EAClB,CAEA+J,OAAQN,EAAY9I,EAAS5I,GAC3BxF,KAAKiO,SAASzI,EAChB,CAEAgJ,SAAUnP,EAAM+O,GACd,OAAOpO,KAAKyX,UAAUpY,EAAMqY,EAAiBC,SAASvJ,GACxD,CAEAqJ,UAAWpY,EAAM+O,GACf,OAAO,IAAIsJ,EAAiB1X,KAAMX,EAAM+O,EAC1C,CAEAU,UAAWX,EAAKQ,GACd,OAAOR,CACT,CAEAkB,MAAOjB,EAAS5I,GAKd,GAJAA,EAAW+H,EAAYa,EAAS5I,GAChCA,EAAW6H,EAAa7H,EAAUiI,GAClCW,EAAUZ,EAAWY,EAASpO,KAAKoU,GAAiB2B,OAE9B,YAAlB/V,KAAK0N,GAEP,OADA1N,KAAK0W,OAAM,IAAM1W,KAAKqP,MAAMjB,EAAS5I,KAC9BA,EAASiI,GAGlB,GAAIkJ,EAAW3W,KAAMwF,GACnB,OAAOA,EAASiI,GAGlB,MAAM5M,EAAWuN,EACXK,EAAczO,KAAKyO,YAAYL,EAAQK,aAe7C,OAbAL,EAAUyF,EAAazF,EAASK,IACxBA,YAAcA,EAAYG,OAEZ,IAAlBR,EAAQ+C,MACVnR,KAAKiO,SAASzI,GAEdxF,KAAKsP,OAAOlB,GAAUxI,IACpB,GAAIA,EAAK,OAAOJ,EAASI,GACzB5F,KAAK8F,KAAK,QAASjF,GACnB2E,GAAS,IAINA,EAASiI,EAClB,CAEA6B,OAAQlB,EAAS5I,GACfxF,KAAKiO,SAASzI,EAChB,CAEAoS,SAAUxJ,GACR,MAAMK,EAAczO,KAAKyO,YAAYL,GAAWA,EAAQK,aAClDC,EAAgB1O,KAAK0O,cAAcN,GAAWA,EAAQM,eAc5D,IAZAN,EAAUyF,EAAazF,EAASK,IACxBhH,MAAwB,IAAjB2G,EAAQ3G,KACvB2G,EAAQzS,QAA4B,IAAnByS,EAAQzS,OAGzByS,EAAQsE,EAAiBjE,aAAeA,EACxCL,EAAQsE,EAAiBhE,eAAiBA,EAG1CN,EAAQK,YAAcA,EAAYG,OAClCR,EAAQM,cAAgBA,EAAcE,OAEhB,YAAlB5O,KAAK0N,GACP,OAAO,IAAI+F,EAAiBzT,KAAMoO,GAC7B,GAAsB,SAAlBpO,KAAK0N,GACd,MAAM,IAAIJ,EAAY,uBAAwB,CAC5Ce,KAAM,4BAIV,OAAOrO,KAAK6X,UAAUzJ,EACxB,CAEAyJ,UAAWzJ,GACT,OAAO,IAAIsE,EAAiB1S,KAAMoO,EACpC,CAEA3G,KAAM2G,GAEJ,MAAMK,EAAczO,KAAKyO,YAAYL,GAAWA,EAAQK,aAClDC,EAAgB1O,KAAK0O,cAAcN,GAAWA,EAAQM,eAY5D,IAVAN,EAAUyF,EAAazF,EAASK,IAGxBiE,EAAiBjE,aAAeA,EACxCL,EAAQsE,EAAiBhE,eAAiBA,EAG1CN,EAAQK,YAAcA,EAAYG,OAClCR,EAAQM,cAAgBA,EAAcE,OAEhB,YAAlB5O,KAAK0N,GACP,OAAO,IAAIgG,EAAoB1T,KAAMoO,GAChC,GAAsB,SAAlBpO,KAAK0N,GACd,MAAM,IAAIJ,EAAY,uBAAwB,CAC5Ce,KAAM,4BAIV,OAAOrO,KAAK8X,MAAM1J,EACpB,CAEA0J,MAAO1J,GACL,OAAO,IAAImF,EAAmBvT,KAAMoO,EACtC,CAEAzS,OAAQyS,GACN,MAAMK,EAAczO,KAAKyO,YAAYL,GAAWA,EAAQK,aAClDC,EAAgB1O,KAAK0O,cAAcN,GAAWA,EAAQM,eAY5D,IAVAN,EAAUyF,EAAazF,EAASK,IAGxBiE,EAAiBjE,aAAeA,EACxCL,EAAQsE,EAAiBhE,eAAiBA,EAG1CN,EAAQK,YAAcA,EAAYG,OAClCR,EAAQM,cAAgBA,EAAcE,OAEhB,YAAlB5O,KAAK0N,GACP,OAAO,IAAIiG,EAAsB3T,KAAMoO,GAClC,GAAsB,SAAlBpO,KAAK0N,GACd,MAAM,IAAIJ,EAAY,uBAAwB,CAC5Ce,KAAM,4BAIV,OAAOrO,KAAK+X,QAAQ3J,EACtB,CAEA2J,QAAS3J,GACP,OAAO,IAAIoF,EAAqBxT,KAAMoO,EACxC,CAEAsI,MAAO1S,GACL,GAAkB,mBAAPA,EACT,MAAM,IAAIgB,UAAU,yCAGtBhF,KAAK2N,GAAajW,KAAKsM,EACzB,CAEA,CAACiQ,KACC,GAAiC,IAA7BjU,KAAK2N,GAAa1W,OACpB,OAGF,MAAMigB,EAAalX,KAAK2N,GACxB3N,KAAK2N,GAAe,GAEpB,IAAK,MAAM2J,KAAMJ,EACfI,GAEJ,CAGAtJ,eAAgByI,GACd,GAAwB,iBAAbA,GAAsC,OAAbA,GACR,mBAAnBA,EAASlH,MAChB,MAAM,IAAIvK,UAAU,gDAGtBhF,KAAK+T,GAAYiE,IAAIvB,EACvB,CAGA/G,eAAgB+G,GACdzW,KAAK+T,GAAYkE,OAAOxB,EAC1B,CAEAU,gBACE,OAAO,IAAIvD,EAAoB5T,KACjC,CAEAsO,UAAWH,GACT,GAAIA,QACF,OAAO,IAAIb,EAAY,kCAAmC,CACxDe,KAAM,qBAGZ,CAEAE,YAAa1P,GACX,GAAIA,QACF,OAAO,IAAIyO,EAAY,oCAAqC,CAC1De,KAAM,uBAGZ,EAKFiG,EAAczb,UAAUoV,SAAW,EAAQ,OAE3C,MAAM,iBAAEyJ,GAAqB,EAAQ,MAAR,CAAmC,CAAEpD,kBAElEhb,EAAQgb,cAAgBA,EACxBhb,EAAQoe,iBAAmBA,EAE3B,MAAMf,EAAa,SAAU5I,EAAIvI,GAC/B,MAAoB,SAAhBuI,EAAGL,KACLK,EAAGE,SAASzI,EAAU,IAAI8H,EAAY,uBAAwB,CAC5De,KAAM,8BAED,EAIX,EAEMwH,EAAU,SAAU9H,GACxB,OAAOrP,OAAO+I,KAAKsG,EAAGsF,SAASgC,WAC5B6C,QAAOhF,KAAOnF,EAAGsF,SAASgC,UAAUnC,IACzC,sCC/yBA5Z,EAAQgb,cAAgB,EAAxB,qBACAhb,EAAQoe,iBAAmB,EAA3B,wBACApe,EAAQoZ,iBAAmB,EAA3B,wBACApZ,EAAQ6Z,oBAAsB,EAA9B,2BACA7Z,EAAQ8Z,sBAAwB,EAAhC,6BACA9Z,EAAQwU,qBAAuB,EAA/B,gECLA,MAAM,iBAAE4E,EAAgB,oBAAES,EAAmB,sBAAEC,GAA0B,EAAQ,OAE3E+E,EAAS3hB,OAAO,SAChB4hB,EAAY5hB,OAAO,YACnBuZ,EAAavZ,OAAO,aACpBwZ,EAAcxZ,OAAO,cACrBqZ,EAAYrZ,OAAO,YAGzB,MAAM6hB,UAAiC3F,EACrC5S,YAAaiO,EAAIK,EAASwJ,EAAUU,GAClC3F,MAAM5E,EAAIK,GAEVpO,KAAKoY,GAAaR,EAClB5X,KAAKmY,GAAUG,EACftY,KAAK+P,GAAc/P,KAAK+P,GAAY3T,KAAK4D,MACzCA,KAAKgQ,GAAehQ,KAAKgQ,GAAa5T,KAAK4D,MAC3CA,KAAK6P,GAAa,IACpB,CAEA,CAACE,GAAanK,EAAKuI,EAAKtP,GACtB,MAAM2G,EAAWxF,KAAK6P,GACtB,GAAIjK,EAAK,OAAOJ,EAASI,QACb8B,IAARyG,IAAmBA,EAAMnO,KAAKmY,GAAQhK,IAC1C3I,EAASI,EAAKuI,EAAKtP,EACrB,CAEA,CAACmR,GAAcpK,EAAKiN,GAClB,MAAMrN,EAAWxF,KAAK6P,GACtB,GAAIjK,EAAK,OAAOJ,EAASI,GAEzB,IAAK,MAAMkN,KAASD,EAAS,CAC3B,MAAM1E,EAAM2E,EAAM,QACNpL,IAARyG,IAAmB2E,EAAM,GAAK9S,KAAKmY,GAAQhK,GACjD,CAEA3I,EAASI,EAAKiN,EAChB,EAGF,MAAM0F,UAAoCpF,EACxCrT,YAAaiO,EAAIK,EAASwJ,EAAUU,GAClC3F,MAAM5E,EAAIK,GAEVpO,KAAKoY,GAAaR,EAClB5X,KAAKmY,GAAUG,EACftY,KAAK+P,GAAc/P,KAAK+P,GAAY3T,KAAK4D,MACzCA,KAAKgQ,GAAehQ,KAAKgQ,GAAa5T,KAAK4D,MAC3CA,KAAK6P,GAAa,IACpB,CAEA,CAACE,GAAanK,EAAKuI,GACjB,MAAM3I,EAAWxF,KAAK6P,GACtB,GAAIjK,EAAK,OAAOJ,EAASI,QACb8B,IAARyG,IAAmBA,EAAMnO,KAAKmY,GAAQhK,IAC1C3I,EAASI,EAAKuI,EAChB,CAEA,CAAC6B,GAAcpK,EAAK6B,GAClB,MAAMjC,EAAWxF,KAAK6P,GACtB,GAAIjK,EAAK,OAAOJ,EAASI,GAEzB,IAAK,IAAItK,EAAI,EAAGA,EAAImM,EAAKxQ,OAAQqE,IAAK,CACpC,MAAM6S,EAAM1G,EAAKnM,QACLoM,IAARyG,IAAmB1G,EAAKnM,GAAK0E,KAAKmY,GAAQhK,GAChD,CAEA3I,EAASI,EAAK6B,EAChB,EAGF,MAAM+Q,UAAsCpF,EAC1CtT,YAAaiO,EAAIK,EAASwJ,GACxBjF,MAAM5E,EAAIK,GACVpO,KAAKoY,GAAaR,CACpB,EAGF,IAAK,MAAMa,IAAY,CAACJ,EAA0BE,GAChDE,EAAS5f,UAAU8Y,MAAQ,SAAUnM,GACnCxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAW/M,KAAKrL,KAAK+P,GAC5B,EAEA0I,EAAS5f,UAAUgZ,OAAS,SAAUpa,EAAM2W,EAAS5I,GACnDxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAWxG,MAAMna,EAAM2W,EAASpO,KAAKgQ,GAC5C,EAEAyI,EAAS5f,UAAUoZ,KAAO,SAAU7D,EAAS5I,GAC3CxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAWpG,IAAI5D,EAASpO,KAAKgQ,GACpC,EAGF,IAAK,MAAMyI,IAAY,CAACD,GACtBC,EAAS5f,UAAU8Y,MAAQ,SAAUnM,GACnCxF,KAAKoY,GAAW/M,KAAK7F,EACvB,EAEAiT,EAAS5f,UAAUgZ,OAAS,SAAUpa,EAAM2W,EAAS5I,GACnDxF,KAAKoY,GAAWxG,MAAMna,EAAM2W,EAAS5I,EACvC,EAEAiT,EAAS5f,UAAUoZ,KAAO,SAAU7D,EAAS5I,GAC3CxF,KAAKoY,GAAWpG,IAAI5D,EAAS5I,EAC/B,EAGF,IAAK,MAAMiT,IAAY,CAACJ,EAA0BE,EAA6BC,GAC7EC,EAAS5f,UAAU0Z,MAAQ,SAAUF,EAAQjE,GAC3CpO,KAAKoY,GAAWhG,KAAKC,EAAQjE,EAC/B,EAEAqK,EAAS5f,UAAU4W,OAAS,SAAUjK,GACpCxF,KAAKoY,GAAW7I,MAAM/J,EACxB,EAGFlM,EAAQ+e,yBAA2BA,EACnC/e,EAAQif,4BAA8BA,EACtCjf,EAAQkf,8BAAgCA,sCCzHxC,MAAMlL,EAAc,EAAQ,QACtB,OAAElL,GAAW,EAAQ,QAAa,CAAC,GACnC,yBACJiW,EAAwB,4BACxBE,EAA2B,8BAC3BC,GACE,EAAQ,OAENE,EAAUliB,OAAO,UACjBmiB,EAAcniB,OAAO,cACrBoiB,EAAepiB,OAAO,eACtBqiB,EAAUriB,OAAO,UACjB2hB,EAAS3hB,OAAO,SAEhBsiB,EAAc,IAAIC,YAClBpB,EAAW,CAAEqB,UAAW,KAG9Bva,EAAOnF,QAAU,UAAU,cAAEgb,IAC3B,MAAMoD,UAAyBpD,EAC7B2E,gBAAiB7K,GAEf,GAAuB,iBAAZA,EACT,MAAM,IAAId,EAAY,uEAAwE,CAC5Fe,KAAM,iBAEH,GAAID,GAAWA,EAAQqH,KAC5B,MAAM,IAAInI,EAAY,gDAAiD,CACrEe,KAAM,iBAIV,OAAe,MAAXD,EACKuJ,EACGvJ,EAAQ4K,UAGX5K,EAFA,IAAKA,EAAS4K,UAAW,IAIpC,CAGAlZ,YAAaiO,EAAI1O,EAAM+O,GAErB,MAAM,UAAE4K,EAAS,SAAEzE,KAAaE,GAAYiD,EAAiBC,SAASvJ,GACtE/O,EAAO6Z,EAAK7Z,EAAM2Z,GAGlB,MAAMG,EAAWH,EAAUxd,WAAW,GAAK,EACrC4d,EAASrL,EAAG8K,IAAY9K,EAI9B,IAAK+K,EAAY/J,OAAO1P,GAAMga,OAAMC,GAAKA,EAAIH,GAAYG,EAAI,MAC3D,MAAM,IAAIhM,EAAY,2BAA2B6L,UAAqB,CACpE9K,KAAM,yBAIVsE,MAAM4G,EAAeH,EAAQ7E,GAAWE,GAExC,MAAM+E,GAAUzL,EAAGyL,QAAU,IAAMR,EAAY3Z,EAAO2Z,EAChDS,EAAaD,EAAO1gB,MAAM,GAAI,GAAK3B,OAAOC,aAAa+hB,GAE7DnZ,KAAK6Y,GAAWO,EAChBpZ,KAAK0Y,GAAW,IAAIgB,EAAYF,GAChCxZ,KAAK2Y,GAAe,IAAIe,EAAYD,GACpCzZ,KAAKmY,GAAU,IAAIwB,EAEnB3Z,KAAKiO,SAAWmL,EAAOnL,QACzB,CAEAa,UAAWX,EAAKQ,GACd,GAAkB,SAAdA,EACF,OAAO3O,KAAK0Y,GAAS9W,KAAOuM,EACvB,GAAuB,IAAnBA,EAAItB,WAEb,OAAO7M,KAAK0Y,GAAS/J,GAChB,GAAkB,SAAdA,EAAsB,CAC/B,MAAM/S,EAAOoE,KAAK0Y,GAAS9c,KACrBge,EAAS,IAAIpf,WAAWoB,EAAKiR,WAAasB,EAAItB,YAKpD,OAHA+M,EAAO/d,IAAID,EAAM,GACjBge,EAAO/d,IAAIsS,EAAKvS,EAAKiR,YAEd+M,CACT,CAAO,CACL,MAAMjjB,EAASqJ,KAAK0Y,GAAS/hB,OAC7B,OAAOyL,EAAOyX,OAAO,CAACljB,EAAQwX,GAAMxX,EAAOkW,WAAasB,EAAItB,WAC9D,CACF,CAGA,CAAC+L,GAAekB,EAAOnL,QACHjH,IAAdoS,EAAMC,IACRD,EAAMC,IAAM/Z,KAAK8O,UAAUgL,EAAMC,IAAKpL,QAChBjH,IAAboS,EAAME,GACfF,EAAME,GAAKha,KAAK8O,UAAUgL,EAAME,GAAIrL,GAEpCmL,EAAMC,IAAM/Z,KAAK0Y,GAAS/J,QAGVjH,IAAdoS,EAAMG,IACRH,EAAMG,IAAMja,KAAK8O,UAAUgL,EAAMG,IAAKtL,QAChBjH,IAAboS,EAAMI,GACfJ,EAAMI,GAAKla,KAAK8O,UAAUgL,EAAMI,GAAIvL,GAEpCmL,EAAMG,IAAMja,KAAK2Y,GAAahK,EAElC,CAEI6K,aACF,OAAOxZ,KAAK0Y,GAAS9W,IACvB,CAEImM,SACF,OAAO/N,KAAK6Y,EACd,CAEAzC,MAAOhI,EAAS5I,GAGdxF,KAAK6Y,GAASpD,KAAK,CAAEjB,SAAS,GAAQhP,EACxC,CAEAyJ,KAAMd,EAAKtP,EAAOuP,EAAS5I,GACzBxF,KAAK6Y,GAAS3K,IAAIC,EAAKtP,EAAOuP,EAAS5I,EACzC,CAEAqR,KAAM1I,EAAKC,EAAS5I,GAClBxF,KAAK6Y,GAASlY,IAAIwN,EAAKC,EAAS5I,EAClC,CAEAwR,SAAUvP,EAAM2G,EAAS5I,GACvBxF,KAAK6Y,GAAShE,QAAQpN,EAAM2G,EAAS5I,EACvC,CAEA4J,KAAMjB,EAAKC,EAAS5I,GAClBxF,KAAK6Y,GAAS1J,IAAIhB,EAAKC,EAAS5I,EAClC,CAEAgS,OAAQN,EAAY9I,EAAS5I,GAC3BxF,KAAK6Y,GAASjD,MAAMsB,EAAY9I,EAAS5I,EAC3C,CAEA8J,OAAQlB,EAAS5I,GAEfxF,KAAK4Y,GAAcxK,EAASA,EAAQK,aACpCzO,KAAK6Y,GAASxJ,MAAMjB,EAAS5I,EAC/B,CAEAqS,UAAWzJ,GAETpO,KAAK4Y,GAAcxK,EAASA,EAAQK,aACpC,MAAMmJ,EAAW5X,KAAK6Y,GAASjB,SAASxJ,GAClCkK,EAAQtY,KAAKmY,GAAQxX,IAAIX,KAAK0Y,GAAS9W,KAAK3K,OAAQmX,EAAQK,aAClE,OAAO,IAAI4J,EAAyBrY,KAAMoO,EAASwJ,EAAUU,EAC/D,CAEAR,MAAO1J,GACLpO,KAAK4Y,GAAcxK,EAASA,EAAQK,aACpC,MAAMmJ,EAAW5X,KAAK6Y,GAASpR,KAAK2G,GAC9BkK,EAAQtY,KAAKmY,GAAQxX,IAAIX,KAAK0Y,GAAS9W,KAAK3K,OAAQmX,EAAQK,aAClE,OAAO,IAAI8J,EAA4BvY,KAAMoO,EAASwJ,EAAUU,EAClE,CAEAP,QAAS3J,GACPpO,KAAK4Y,GAAcxK,EAASA,EAAQK,aACpC,MAAMmJ,EAAW5X,KAAK6Y,GAASld,OAAOyS,GACtC,OAAO,IAAIoK,EAA8BxY,KAAMoO,EAASwJ,EAC1D,EAGF,MAAO,CAAEF,mBACX,EAEA,MAAM6B,EAAiB,SAAUH,EAAQ7E,GACvC,MAAO,IAEF6E,EAAO/F,SAGV2C,iBAAiB,EACjBC,eAAe,EAGfX,OAAQ,CAAC,EAIT6E,kBAAmB,CAAC,KAIjB5F,EAEHc,UAAW,CACTzT,KAAMwY,EAAiBhB,EAAQ,QAC/BziB,OAAQyjB,EAAiBhB,EAAQ,UACjCxd,KAAMwe,EAAiBhB,EAAQ,SAGrC,EAEMgB,EAAmB,SAAUhB,EAAQnO,GAEzC,QAAOmO,EAAO/F,SAASgC,UAAUpK,IAC7BmO,EAAO3K,YAAYxD,GAAU5L,OAAS4L,CAE5C,EAEA,MAAMyO,EACJ5Z,YAAaqO,GACXnO,KAAK4B,KAAOuM,EACZnO,KAAKpE,KAAOkd,EAAY/J,OAAOZ,GAC/BnO,KAAKrJ,OAASyL,EAASA,EAAOoE,KAAKxG,KAAKpE,KAAKjF,OAAQ,EAAGqJ,KAAKpE,KAAKiR,YAAc,CAAC,CACnF,EAGF,MAAM8M,EACJ7Z,cACEE,KAAKqa,MAAQ,IAAIC,GACnB,CAEA3Z,IAAK4Z,EAAc5L,GACjB,IAAI2J,EAAQtY,KAAKqa,MAAM1Z,IAAIgO,GAkB3B,YAhBcjH,IAAV4Q,IAEAA,EADgB,SAAd3J,EACM,SAAU4L,EAAcpM,GAE9B,OAAOA,EAAI7W,SAASijB,EACtB,EAAEne,KAAK,KAAMme,GAEL,SAAUA,EAAcpM,GAE9B,OAAOA,EAAIrV,MAAMyhB,EACnB,EAAEne,KAAK,KAAMme,GAGfva,KAAKqa,MAAMxe,IAAI8S,EAAW2J,IAGrBA,CACT,EAGF,MAAMY,EAAO,SAAU7d,EAAKmf,GAC1B,IAAIhX,EAAQ,EACRb,EAAMtH,EAAIpE,OAEd,KAAOuM,EAAQb,GAAOtH,EAAImI,KAAWgX,GAAMhX,IAC3C,KAAOb,EAAMa,GAASnI,EAAIsH,EAAM,KAAO6X,GAAM7X,IAE7C,OAAOtH,EAAIvC,MAAM0K,EAAOb,EAC1B,oCC/PArJ,EAAQiU,YAAc,SAAUa,EAAS5I,GACvC,MAA0B,mBAAZ4I,EAAyBA,EAAU5I,CACnD,EAEAlM,EAAQkU,WAAa,SAAUY,EAASqM,GACtC,MAAuB,iBAAZrM,GAAoC,OAAZA,EAC1BA,OAGG1G,IAAR+S,EACKA,EAGF,CAAC,CACV,qCCdA,MAAM,qBAAE3M,GAAyB,EAAQ,OACnCR,EAAc,EAAQ,OACtBoN,EAAWlkB,OAAO,WAoCxB8C,EAAQsa,oBAjCR,cAAkC9F,EAChChO,YAAaiO,GACX4E,MAAM5E,GACN/N,KAAK0a,GAAY,EACnB,CAEAzL,KAAMd,EAAKtP,EAAOuP,GAChBpO,KAAK0a,GAAUhjB,KAAK,IAAK0W,EAASc,KAAM,MAAOf,MAAKtP,SACtD,CAEAuQ,KAAMjB,EAAKC,GACTpO,KAAK0a,GAAUhjB,KAAK,IAAK0W,EAASc,KAAM,MAAOf,OACjD,CAEAmB,SACEtP,KAAK0a,GAAY,EACnB,CAGAlL,OAAQpB,EAAS5I,GACQ,YAAnBxF,KAAK+N,GAAG4G,OACV3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKwP,OAAOpB,EAAS5I,KACb,SAAnBxF,KAAK+N,GAAG4G,OACa,IAA1B3U,KAAK0a,GAAUzjB,OAAc+I,KAAKiO,SAASzI,GAC1CxF,KAAK+N,GAAGyJ,OAAOxX,KAAK0a,GAAWtM,EAAS5I,GAE7CxF,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,kEAAmE,CACzGe,KAAM,yBAGZ,uCCnCF,MAAM,oBAAE8E,EAAmB,sBAAEC,GAA0B,EAAQ,OAEzDgF,EAAY5hB,OAAO,YACnBqZ,EAAYrZ,OAAO,YACnBuZ,EAAavZ,OAAO,aACpBwZ,EAAcxZ,OAAO,cAE3B,MAAM+c,UAA2BJ,EAC/BrT,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAEVpO,KAAKoY,GAAarK,EAAG6J,SAAS,IAAKxJ,EAAS3G,MAAM,EAAM9L,QAAQ,IAChEqE,KAAK+P,GAAc/P,KAAK+P,GAAY3T,KAAK4D,MACzCA,KAAKgQ,GAAehQ,KAAKgQ,GAAa5T,KAAK4D,KAC7C,EAGF,MAAMwT,UAA6BJ,EACjCtT,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAEVpO,KAAKoY,GAAarK,EAAG6J,SAAS,IAAKxJ,EAAS3G,MAAM,EAAO9L,QAAQ,IACjEqE,KAAK+P,GAAc/P,KAAK+P,GAAY3T,KAAK4D,MACzCA,KAAKgQ,GAAehQ,KAAKgQ,GAAa5T,KAAK4D,KAC7C,EAGF,IAAK,MAAMyY,IAAY,CAAClF,EAAoBC,GAAuB,CACjE,MAAM/L,EAAOgR,IAAalF,EACpBoH,EAAWlT,EAAQqL,GAAUA,EAAM,GAAMA,GAAUA,EAAM,GAE/D2F,EAAS5f,UAAU8Y,MAAQ,SAAUnM,GACnCxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAW/M,KAAKrL,KAAK+P,GAC5B,EAEA0I,EAAS5f,UAAUkX,GAAc,SAAUnK,EAAKuI,EAAKtP,GACnD,MAAM2G,EAAWxF,KAAK6P,GAClBjK,EAAKJ,EAASI,GACbJ,EAAS,KAAMiC,EAAO0G,EAAMtP,EACnC,EAEA4Z,EAAS5f,UAAUgZ,OAAS,SAAUpa,EAAM2W,EAAS5I,GACnDxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAWxG,MAAMna,EAAM2W,EAASpO,KAAKgQ,GAC5C,EAEAyI,EAAS5f,UAAUoZ,KAAO,SAAU7D,EAAS5I,GAC3CxF,KAAK6P,GAAarK,EAClBxF,KAAKoY,GAAWpG,IAAI5D,EAASpO,KAAKgQ,GACpC,EAEAyI,EAAS5f,UAAUmX,GAAe,SAAUpK,EAAKiN,GAC/C,MAAMrN,EAAWxF,KAAK6P,GAClBjK,EAAKJ,EAASI,GACbJ,EAAS,KAAMqN,EAAQ+H,IAAID,GAClC,EAEAlC,EAAS5f,UAAU0Z,MAAQ,SAAUF,EAAQjE,GAC3CpO,KAAKoY,GAAWhG,KAAKC,EAAQjE,EAC/B,EAEAqK,EAAS5f,UAAU4W,OAAS,SAAUjK,GACpCxF,KAAKoY,GAAW7I,MAAM/J,EACxB,CACF,CAGAlM,EAAQia,mBAAqBA,EAC7Bja,EAAQka,qBAAuBA,sCCrE/B,MAAM,iBAAEd,EAAgB,oBAAES,EAAmB,sBAAEC,GAA0B,EAAQ,OAC3E9F,EAAc,EAAQ,OAEtBuN,EAAOrkB,OAAO,OACdyd,EAAWzd,OAAO,WAClBskB,EAAWtkB,OAAO,WAExB,MAAMid,UAAyBf,EAC7B5S,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAEVpO,KAAK6a,GAAQ,KACb7a,KAAK8a,GAAY,IAAM/M,EAAG6J,SAASxJ,GAEnCpO,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKiU,MAC3B,EAGF,MAAMP,UAA4BP,EAChCrT,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAEVpO,KAAK6a,GAAQ,KACb7a,KAAK8a,GAAY,IAAM/M,EAAGtG,KAAK2G,GAE/BpO,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKiU,MAC3B,EAGF,MAAMN,UAA8BP,EAClCtT,YAAaiO,EAAIK,GACfuE,MAAM5E,EAAIK,GAEVpO,KAAK6a,GAAQ,KACb7a,KAAK8a,GAAY,IAAM/M,EAAGpS,OAAOyS,GAEjCpO,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKiU,MAC3B,EAGF,IAAK,MAAMwE,IAAY,CAAChF,EAAkBC,EAAqBC,GAC7D8E,EAAS5f,UAAUob,GAAY,WACN,SAAnBjU,KAAK+N,GAAG4G,SACV3U,KAAK6a,GAAQ7a,KAAK8a,KAEtB,EAEArC,EAAS5f,UAAU8Y,MAAQ,SAAUnM,GAChB,OAAfxF,KAAK6a,GACP7a,KAAK6a,GAAMxP,KAAK7F,GACY,YAAnBxF,KAAK+N,GAAG4G,OACjB3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAK2R,MAAMnM,KAE/BxF,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,yDAA0D,CAChGe,KAAM,4BAGZ,EAEAoK,EAAS5f,UAAUgZ,OAAS,SAAUpa,EAAM2W,EAAS5I,GAChC,OAAfxF,KAAK6a,GACP7a,KAAK6a,GAAMjJ,MAAMna,EAAM2W,EAAS5I,GACJ,YAAnBxF,KAAK+N,GAAG4G,OACjB3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAK6R,OAAOpa,EAAM2W,EAAS5I,KAE/CxF,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,0DAA2D,CACjGe,KAAM,4BAGZ,EAEAoK,EAAS5f,UAAUoZ,KAAO,SAAU7D,EAAS5I,GACxB,OAAfxF,KAAK6a,GACP7a,KAAK6a,GAAM7I,IAAIxM,GACa,YAAnBxF,KAAK+N,GAAG4G,OACjB3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKiS,KAAK7D,EAAS5I,KAEvCxF,KAAKiO,SAASzI,EAAU,IAAI8H,EAAY,wDAAyD,CAC/Fe,KAAM,4BAGZ,EAEAoK,EAAS5f,UAAU0Z,MAAQ,SAAUF,EAAQjE,GACxB,OAAfpO,KAAK6a,GAEP7a,KAAK6a,GAAMtI,MAAMF,EAAQjE,GACG,YAAnBpO,KAAK+N,GAAG4G,QACjB3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKuS,MAAMF,EAAQjE,IAE3C,EAEAqK,EAAS5f,UAAU4W,OAAS,SAAUjK,GACjB,OAAfxF,KAAK6a,GACP7a,KAAK6a,GAAMtL,MAAM/J,GACW,YAAnBxF,KAAK+N,GAAG4G,OACjB3U,KAAK+N,GAAG2I,OAAM,IAAM1W,KAAKyP,OAAOjK,KAEhCxF,KAAKiO,SAASzI,EAElB,EAGFlM,EAAQma,iBAAmBA,EAC3Bna,EAAQoa,oBAAsBA,EAC9Bpa,EAAQqa,sBAAwBA,sCCzGhC,MAAMoH,EAAiB,EAAQ,OAE/Btc,EAAOnF,QAAU,SAAU0K,KAAOpE,GACZ,IAAhBA,EAAK3I,OACP8jB,EAAe/W,GAEf+W,GAAe,IAAM/W,KAAMpE,IAE/B,sCCRA,MAAM0N,EAAc,EAAQ,OACtBvO,EAAiBL,OAAO7F,UAAUkG,eAClC8U,EAAe,IAAIa,IAAI,CAAC,KAAM,MAAO,KAAM,QAEjDjW,EAAOnF,QAAU,SAAU8U,EAASK,GAClC,MAAMmL,EAAS,CAAC,EAEhB,IAAK,MAAM1G,KAAK9E,EACd,GAAKrP,EAAehG,KAAKqV,EAAS8E,IACxB,gBAANA,GAA6B,kBAANA,EAA3B,CAEA,GAAU,UAANA,GAAuB,QAANA,EACnB,MAAM,IAAI5F,EAAY,4BAA4B4F,sBAAuB,CACvE7E,KAAM,iBAEH,GAAU,aAAN6E,EAET,MAAM,IAAI5F,EAAY,mFAAoF,CACxGe,KAAM,iBAINwF,EAAamH,IAAI9H,GAGnB0G,EAAO1G,GAAKzE,EAAYM,OAAOX,EAAQ8E,IAEvC0G,EAAO1G,GAAK9E,EAAQ8E,EAlB4B,CAyBpD,OAHA0G,EAAOqB,UAAYrB,EAAOqB,QAC1BrB,EAAOzI,MAAQnI,OAAOD,UAAU6Q,EAAOzI,QAAUyI,EAAOzI,OAAS,EAAIyI,EAAOzI,OAAS,EAE9EyI,CACT,qDC3BA,MAAM1R,EAAS,EAAQ,OACjBgT,EAAU,EAAQ,OAClBC,EACe,mBAAX3kB,QAAkD,mBAAlBA,OAAY,IAChDA,OAAY,IAAE,8BACd,KAEN8C,EAAQ8I,OAASA,EACjB9I,EAAQ8hB,WAyTR,SAAqBnkB,IACdA,GAAUA,IACbA,EAAS,GAEX,OAAOmL,EAAO5I,OAAOvC,EACvB,EA7TAqC,EAAQ+hB,kBAAoB,GAE5B,MAAMC,EAAe,WAwDrB,SAASC,EAActkB,GACrB,GAAIA,EAASqkB,EACX,MAAM,IAAItZ,WAAW,cAAgB/K,EAAS,kCAGhD,MAAM8D,EAAM,IAAIP,WAAWvD,GAE3B,OADAyH,OAAO8c,eAAezgB,EAAKqH,EAAOvJ,WAC3BkC,CACT,CAYA,SAASqH,EAAQqZ,EAAKC,EAAkBzkB,GAEtC,GAAmB,iBAARwkB,EAAkB,CAC3B,GAAgC,iBAArBC,EACT,MAAM,IAAI1W,UACR,sEAGJ,OAAOkG,EAAYuQ,EACrB,CACA,OAAOjV,EAAKiV,EAAKC,EAAkBzkB,EACrC,CAIA,SAASuP,EAAM3H,EAAO6c,EAAkBzkB,GACtC,GAAqB,iBAAV4H,EACT,OAqHJ,SAAqB6E,EAAQuH,GACH,iBAAbA,GAAsC,KAAbA,IAClCA,EAAW,QAGb,IAAK7I,EAAOuZ,WAAW1Q,GACrB,MAAM,IAAIjG,UAAU,qBAAuBiG,GAG7C,MAAMhU,EAAwC,EAA/B4V,EAAWnJ,EAAQuH,GAClC,IAAIlQ,EAAMwgB,EAAatkB,GAEvB,MAAM2kB,EAAS7gB,EAAIsR,MAAM3I,EAAQuH,GAE7B2Q,IAAW3kB,IAIb8D,EAAMA,EAAIjC,MAAM,EAAG8iB,IAGrB,OAAO7gB,CACT,CA3IW4L,CAAW9H,EAAO6c,GAG3B,GAAIG,YAAYC,OAAOjd,GACrB,OAkJJ,SAAwBkd,GACtB,GAAIC,EAAWD,EAAWvhB,YAAa,CACrC,MAAMoS,EAAO,IAAIpS,WAAWuhB,GAC5B,OAAOE,EAAgBrP,EAAKjW,OAAQiW,EAAKsP,WAAYtP,EAAKC,WAC5D,CACA,OAAOsP,EAAcJ,EACvB,CAxJWK,CAAcvd,GAGvB,GAAa,MAATA,EACF,MAAM,IAAImG,UACR,yHACiDnG,GAIrD,GAAImd,EAAWnd,EAAOgd,cACjBhd,GAASmd,EAAWnd,EAAMlI,OAAQklB,aACrC,OAAOI,EAAgBpd,EAAO6c,EAAkBzkB,GAGlD,GAAiC,oBAAtBolB,oBACNL,EAAWnd,EAAOwd,oBAClBxd,GAASmd,EAAWnd,EAAMlI,OAAQ0lB,oBACrC,OAAOJ,EAAgBpd,EAAO6c,EAAkBzkB,GAGlD,GAAqB,iBAAV4H,EACT,MAAM,IAAImG,UACR,yEAIJ,MAAMjF,EAAUlB,EAAMkB,SAAWlB,EAAMkB,UACvC,GAAe,MAAXA,GAAmBA,IAAYlB,EACjC,OAAOuD,EAAOoE,KAAKzG,EAAS2b,EAAkBzkB,GAGhD,MAAMqlB,EAkJR,SAAqBhT,GACnB,GAAIlH,EAAOC,SAASiH,GAAM,CACxB,MAAMtN,EAA4B,EAAtBugB,EAAQjT,EAAIrS,QAClB8D,EAAMwgB,EAAavf,GAEzB,OAAmB,IAAfjB,EAAI9D,QAIRqS,EAAIsD,KAAK7R,EAAK,EAAG,EAAGiB,GAHXjB,CAKX,CAEA,QAAmB2M,IAAf4B,EAAIrS,OACN,MAA0B,iBAAfqS,EAAIrS,QAAuBulB,EAAYlT,EAAIrS,QAC7CskB,EAAa,GAEfY,EAAc7S,GAGvB,GAAiB,WAAbA,EAAI4F,MAAqBtW,MAAMuJ,QAAQmH,EAAImT,MAC7C,OAAON,EAAc7S,EAAImT,KAE7B,CAzKYC,CAAW7d,GACrB,GAAIyd,EAAG,OAAOA,EAEd,GAAsB,oBAAX9lB,QAAgD,MAAtBA,OAAOmmB,aACH,mBAA9B9d,EAAMrI,OAAOmmB,aACtB,OAAOva,EAAOoE,KAAK3H,EAAMrI,OAAOmmB,aAAa,UAAWjB,EAAkBzkB,GAG5E,MAAM,IAAI+N,UACR,yHACiDnG,EAErD,CAmBA,SAAS+d,EAAYnlB,GACnB,GAAoB,iBAATA,EACT,MAAM,IAAIuN,UAAU,0CACf,GAAIvN,EAAO,EAChB,MAAM,IAAIuK,WAAW,cAAgBvK,EAAO,iCAEhD,CA0BA,SAASyT,EAAazT,GAEpB,OADAmlB,EAAWnlB,GACJ8jB,EAAa9jB,EAAO,EAAI,EAAoB,EAAhB8kB,EAAQ9kB,GAC7C,CAuCA,SAAS0kB,EAAeU,GACtB,MAAM5lB,EAAS4lB,EAAM5lB,OAAS,EAAI,EAA4B,EAAxBslB,EAAQM,EAAM5lB,QAC9C8D,EAAMwgB,EAAatkB,GACzB,IAAK,IAAIqE,EAAI,EAAGA,EAAIrE,EAAQqE,GAAK,EAC/BP,EAAIO,GAAgB,IAAXuhB,EAAMvhB,GAEjB,OAAOP,CACT,CAUA,SAASkhB,EAAiBY,EAAOX,EAAYjlB,GAC3C,GAAIilB,EAAa,GAAKW,EAAMhQ,WAAaqP,EACvC,MAAM,IAAIla,WAAW,wCAGvB,GAAI6a,EAAMhQ,WAAaqP,GAAcjlB,GAAU,GAC7C,MAAM,IAAI+K,WAAW,wCAGvB,IAAIjH,EAYJ,OAVEA,OADiB2M,IAAfwU,QAAuCxU,IAAXzQ,EACxB,IAAIuD,WAAWqiB,QACDnV,IAAXzQ,EACH,IAAIuD,WAAWqiB,EAAOX,GAEtB,IAAI1hB,WAAWqiB,EAAOX,EAAYjlB,GAI1CyH,OAAO8c,eAAezgB,EAAKqH,EAAOvJ,WAE3BkC,CACT,CA2BA,SAASwhB,EAAStlB,GAGhB,GAAIA,GAAUqkB,EACZ,MAAM,IAAItZ,WAAW,0DACasZ,EAAa3W,SAAS,IAAM,UAEhE,OAAgB,EAAT1N,CACT,CAsGA,SAAS4V,EAAYnJ,EAAQuH,GAC3B,GAAI7I,EAAOC,SAASqB,GAClB,OAAOA,EAAOzM,OAEhB,GAAI4kB,YAAYC,OAAOpY,IAAWsY,EAAWtY,EAAQmY,aACnD,OAAOnY,EAAOmJ,WAEhB,GAAsB,iBAAXnJ,EACT,MAAM,IAAIsB,UACR,kGAC0BtB,GAI9B,MAAM1H,EAAM0H,EAAOzM,OACb6lB,EAAa9jB,UAAU/B,OAAS,IAAsB,IAAjB+B,UAAU,GACrD,IAAK8jB,GAAqB,IAAR9gB,EAAW,OAAO,EAGpC,IAAI+gB,GAAc,EAClB,OACE,OAAQ9R,GACN,IAAK,QACL,IAAK,SACL,IAAK,SACH,OAAOjP,EACT,IAAK,OACL,IAAK,QACH,OAAOghB,EAAYtZ,GAAQzM,OAC7B,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAa,EAAN+E,EACT,IAAK,MACH,OAAOA,IAAQ,EACjB,IAAK,SACH,OAAOihB,EAAcvZ,GAAQzM,OAC/B,QACE,GAAI8lB,EACF,OAAOD,GAAa,EAAIE,EAAYtZ,GAAQzM,OAE9CgU,GAAY,GAAKA,GAAUV,cAC3BwS,GAAc,EAGtB,CAGA,SAASG,EAAcjS,EAAUzH,EAAOb,GACtC,IAAIoa,GAAc,EAclB,SALcrV,IAAVlE,GAAuBA,EAAQ,KACjCA,EAAQ,GAINA,EAAQxD,KAAK/I,OACf,MAAO,GAOT,SAJYyQ,IAAR/E,GAAqBA,EAAM3C,KAAK/I,UAClC0L,EAAM3C,KAAK/I,QAGT0L,GAAO,EACT,MAAO,GAOT,IAHAA,KAAS,KACTa,KAAW,GAGT,MAAO,GAKT,IAFKyH,IAAUA,EAAW,UAGxB,OAAQA,GACN,IAAK,MACH,OAAOkS,EAASnd,KAAMwD,EAAOb,GAE/B,IAAK,OACL,IAAK,QACH,OAAO8B,EAAUzE,KAAMwD,EAAOb,GAEhC,IAAK,QACH,OAAOya,EAAWpd,KAAMwD,EAAOb,GAEjC,IAAK,SACL,IAAK,SACH,OAAO0a,EAAYrd,KAAMwD,EAAOb,GAElC,IAAK,SACH,OAAO2a,EAAYtd,KAAMwD,EAAOb,GAElC,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO4a,EAAavd,KAAMwD,EAAOb,GAEnC,QACE,GAAIoa,EAAa,MAAM,IAAI/X,UAAU,qBAAuBiG,GAC5DA,GAAYA,EAAW,IAAIV,cAC3BwS,GAAc,EAGtB,CAUA,SAASS,EAAMlB,EAAG7jB,EAAGglB,GACnB,MAAMniB,EAAIghB,EAAE7jB,GACZ6jB,EAAE7jB,GAAK6jB,EAAEmB,GACTnB,EAAEmB,GAAKniB,CACT,CA2IA,SAASoiB,EAAsB/mB,EAAQyU,EAAK8Q,EAAYjR,EAAU0S,GAEhE,GAAsB,IAAlBhnB,EAAOM,OAAc,OAAQ,EAmBjC,GAhB0B,iBAAfilB,GACTjR,EAAWiR,EACXA,EAAa,GACJA,EAAa,WACtBA,EAAa,WACJA,GAAc,aACvBA,GAAc,YAGZM,EADJN,GAAcA,KAGZA,EAAayB,EAAM,EAAKhnB,EAAOM,OAAS,GAItCilB,EAAa,IAAGA,EAAavlB,EAAOM,OAASilB,GAC7CA,GAAcvlB,EAAOM,OAAQ,CAC/B,GAAI0mB,EAAK,OAAQ,EACZzB,EAAavlB,EAAOM,OAAS,CACpC,MAAO,GAAIilB,EAAa,EAAG,CACzB,IAAIyB,EACC,OAAQ,EADJzB,EAAa,CAExB,CAQA,GALmB,iBAAR9Q,IACTA,EAAMhJ,EAAOoE,KAAK4E,EAAKH,IAIrB7I,EAAOC,SAAS+I,GAElB,OAAmB,IAAfA,EAAInU,QACE,EAEH2mB,EAAajnB,EAAQyU,EAAK8Q,EAAYjR,EAAU0S,GAClD,GAAmB,iBAARvS,EAEhB,OADAA,GAAY,IACgC,mBAAjC5Q,WAAW3B,UAAU0G,QAC1Boe,EACKnjB,WAAW3B,UAAU0G,QAAQxG,KAAKpC,EAAQyU,EAAK8Q,GAE/C1hB,WAAW3B,UAAUglB,YAAY9kB,KAAKpC,EAAQyU,EAAK8Q,GAGvD0B,EAAajnB,EAAQ,CAACyU,GAAM8Q,EAAYjR,EAAU0S,GAG3D,MAAM,IAAI3Y,UAAU,uCACtB,CAEA,SAAS4Y,EAAc/iB,EAAKuQ,EAAK8Q,EAAYjR,EAAU0S,GACrD,IA0BIriB,EA1BAwiB,EAAY,EACZC,EAAYljB,EAAI5D,OAChB+mB,EAAY5S,EAAInU,OAEpB,QAAiByQ,IAAbuD,IAEe,UADjBA,EAAW9T,OAAO8T,GAAUV,gBACY,UAAbU,GACV,YAAbA,GAAuC,aAAbA,GAAyB,CACrD,GAAIpQ,EAAI5D,OAAS,GAAKmU,EAAInU,OAAS,EACjC,OAAQ,EAEV6mB,EAAY,EACZC,GAAa,EACbC,GAAa,EACb9B,GAAc,CAChB,CAGF,SAASvY,EAAM5I,EAAKO,GAClB,OAAkB,IAAdwiB,EACK/iB,EAAIO,GAEJP,EAAIkjB,aAAa3iB,EAAIwiB,EAEhC,CAGA,GAAIH,EAAK,CACP,IAAIO,GAAc,EAClB,IAAK5iB,EAAI4gB,EAAY5gB,EAAIyiB,EAAWziB,IAClC,GAAIqI,EAAK9I,EAAKS,KAAOqI,EAAKyH,GAAqB,IAAhB8S,EAAoB,EAAI5iB,EAAI4iB,IAEzD,IADoB,IAAhBA,IAAmBA,EAAa5iB,GAChCA,EAAI4iB,EAAa,IAAMF,EAAW,OAAOE,EAAaJ,OAEtC,IAAhBI,IAAmB5iB,GAAKA,EAAI4iB,GAChCA,GAAc,CAGpB,MAEE,IADIhC,EAAa8B,EAAYD,IAAW7B,EAAa6B,EAAYC,GAC5D1iB,EAAI4gB,EAAY5gB,GAAK,EAAGA,IAAK,CAChC,IAAI6iB,GAAQ,EACZ,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAWI,IAC7B,GAAIza,EAAK9I,EAAKS,EAAI8iB,KAAOza,EAAKyH,EAAKgT,GAAI,CACrCD,GAAQ,EACR,KACF,CAEF,GAAIA,EAAO,OAAO7iB,CACpB,CAGF,OAAQ,CACV,CAcA,SAAS+iB,EAAUtjB,EAAK2I,EAAQxM,EAAQD,GACtCC,EAAS8R,OAAO9R,IAAW,EAC3B,MAAMonB,EAAYvjB,EAAI9D,OAASC,EAC1BD,GAGHA,EAAS+R,OAAO/R,IACHqnB,IACXrnB,EAASqnB,GAJXrnB,EAASqnB,EAQX,MAAMC,EAAS7a,EAAOzM,OAKtB,IAAIqE,EACJ,IAJIrE,EAASsnB,EAAS,IACpBtnB,EAASsnB,EAAS,GAGfjjB,EAAI,EAAGA,EAAIrE,IAAUqE,EAAG,CAC3B,MAAMkjB,EAAS9X,SAAShD,EAAO+a,OAAW,EAAJnjB,EAAO,GAAI,IACjD,GAAIkhB,EAAYgC,GAAS,OAAOljB,EAChCP,EAAI7D,EAASoE,GAAKkjB,CACpB,CACA,OAAOljB,CACT,CAEA,SAASkO,EAAWzO,EAAK2I,EAAQxM,EAAQD,GACvC,OAAOynB,EAAW1B,EAAYtZ,EAAQ3I,EAAI9D,OAASC,GAAS6D,EAAK7D,EAAQD,EAC3E,CAEA,SAAS0nB,EAAY5jB,EAAK2I,EAAQxM,EAAQD,GACxC,OAAOynB,EAypCT,SAAuBrjB,GACrB,MAAMujB,EAAY,GAClB,IAAK,IAAItjB,EAAI,EAAGA,EAAID,EAAIpE,SAAUqE,EAEhCsjB,EAAUlnB,KAAyB,IAApB2D,EAAIG,WAAWF,IAEhC,OAAOsjB,CACT,CAhqCoBC,CAAanb,GAAS3I,EAAK7D,EAAQD,EACvD,CAEA,SAAS6nB,EAAa/jB,EAAK2I,EAAQxM,EAAQD,GACzC,OAAOynB,EAAWzB,EAAcvZ,GAAS3I,EAAK7D,EAAQD,EACxD,CAEA,SAAS8nB,EAAWhkB,EAAK2I,EAAQxM,EAAQD,GACvC,OAAOynB,EA0pCT,SAAyBrjB,EAAK2jB,GAC5B,IAAIC,EAAGxc,EAAID,EACX,MAAMoc,EAAY,GAClB,IAAK,IAAItjB,EAAI,EAAGA,EAAID,EAAIpE,WACjB+nB,GAAS,GAAK,KADa1jB,EAGhC2jB,EAAI5jB,EAAIG,WAAWF,GACnBmH,EAAKwc,GAAK,EACVzc,EAAKyc,EAAI,IACTL,EAAUlnB,KAAK8K,GACfoc,EAAUlnB,KAAK+K,GAGjB,OAAOmc,CACT,CAxqCoBM,CAAexb,EAAQ3I,EAAI9D,OAASC,GAAS6D,EAAK7D,EAAQD,EAC9E,CA8EA,SAASqmB,EAAaviB,EAAKyI,EAAOb,GAChC,OAAc,IAAVa,GAAeb,IAAQ5H,EAAI9D,OACtBiR,EAAOiX,cAAcpkB,GAErBmN,EAAOiX,cAAcpkB,EAAIjC,MAAM0K,EAAOb,GAEjD,CAEA,SAAS8B,EAAW1J,EAAKyI,EAAOb,GAC9BA,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAC3B,MAAMyc,EAAM,GAEZ,IAAI9jB,EAAIkI,EACR,KAAOlI,EAAIqH,GAAK,CACd,MAAM0c,EAAYtkB,EAAIO,GACtB,IAAIgkB,EAAY,KACZC,EAAoBF,EAAY,IAChC,EACCA,EAAY,IACT,EACCA,EAAY,IACT,EACA,EAEZ,GAAI/jB,EAAIikB,GAAoB5c,EAAK,CAC/B,IAAI6c,EAAYC,EAAWC,EAAYC,EAEvC,OAAQJ,GACN,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EACHG,EAAazkB,EAAIO,EAAI,GACO,MAAV,IAAbkkB,KACHG,GAA6B,GAAZN,IAAqB,EAAoB,GAAbG,EACzCG,EAAgB,MAClBL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAIO,EAAI,GACrBmkB,EAAY1kB,EAAIO,EAAI,GACQ,MAAV,IAAbkkB,IAAsD,MAAV,IAAZC,KACnCE,GAA6B,GAAZN,IAAoB,IAAoB,GAAbG,IAAsB,EAAmB,GAAZC,EACrEE,EAAgB,OAAUA,EAAgB,OAAUA,EAAgB,SACtEL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAIO,EAAI,GACrBmkB,EAAY1kB,EAAIO,EAAI,GACpBokB,EAAa3kB,EAAIO,EAAI,GACO,MAAV,IAAbkkB,IAAsD,MAAV,IAAZC,IAAsD,MAAV,IAAbC,KAClEC,GAA6B,GAAZN,IAAoB,IAAqB,GAAbG,IAAsB,IAAmB,GAAZC,IAAqB,EAAoB,GAAbC,EAClGC,EAAgB,OAAUA,EAAgB,UAC5CL,EAAYK,IAItB,CAEkB,OAAdL,GAGFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QAErBA,GAAa,MACbF,EAAI1nB,KAAK4nB,IAAc,GAAK,KAAQ,OACpCA,EAAY,MAAqB,KAAZA,GAGvBF,EAAI1nB,KAAK4nB,GACThkB,GAAKikB,CACP,CAEA,OAQF,SAAgCK,GAC9B,MAAM5jB,EAAM4jB,EAAW3oB,OACvB,GAAI+E,GAAO6jB,EACT,OAAO1oB,OAAOC,aAAaC,MAAMF,OAAQyoB,GAI3C,IAAIR,EAAM,GACN9jB,EAAI,EACR,KAAOA,EAAIU,GACTojB,GAAOjoB,OAAOC,aAAaC,MACzBF,OACAyoB,EAAW9mB,MAAMwC,EAAGA,GAAKukB,IAG7B,OAAOT,CACT,CAxBSU,CAAsBV,EAC/B,CA3+BA9lB,EAAQymB,WAAazE,EAgBrBlZ,EAAO4d,oBAUP,WAEE,IACE,MAAMnlB,EAAM,IAAIL,WAAW,GACrBylB,EAAQ,CAAEC,IAAK,WAAc,OAAO,EAAG,GAG7C,OAFAxhB,OAAO8c,eAAeyE,EAAOzlB,WAAW3B,WACxC6F,OAAO8c,eAAe3gB,EAAKolB,GACN,KAAdplB,EAAIqlB,KACb,CAAE,MAAOzW,GACP,OAAO,CACT,CACF,CArB6B0W,GAExB/d,EAAO4d,0BAA0C,IAAZtnB,GACb,mBAAlBA,EAAQ0nB,OACjB1nB,EAAQ0nB,MACN,iJAkBJ1hB,OAAO2B,eAAe+B,EAAOvJ,UAAW,SAAU,CAChD+H,YAAY,EACZD,IAAK,WACH,GAAKyB,EAAOC,SAASrC,MACrB,OAAOA,KAAKrJ,MACd,IAGF+H,OAAO2B,eAAe+B,EAAOvJ,UAAW,SAAU,CAChD+H,YAAY,EACZD,IAAK,WACH,GAAKyB,EAAOC,SAASrC,MACrB,OAAOA,KAAKkc,UACd,IAoCF9Z,EAAOie,SAAW,KA8DlBje,EAAOoE,KAAO,SAAU3H,EAAO6c,EAAkBzkB,GAC/C,OAAOuP,EAAK3H,EAAO6c,EAAkBzkB,EACvC,EAIAyH,OAAO8c,eAAepZ,EAAOvJ,UAAW2B,WAAW3B,WACnD6F,OAAO8c,eAAepZ,EAAQ5H,YA8B9B4H,EAAO5I,MAAQ,SAAU/B,EAAMwf,EAAMhM,GACnC,OArBF,SAAgBxT,EAAMwf,EAAMhM,GAE1B,OADA2R,EAAWnlB,GACPA,GAAQ,EACH8jB,EAAa9jB,QAETiQ,IAATuP,EAIyB,iBAAbhM,EACVsQ,EAAa9jB,GAAMwf,KAAKA,EAAMhM,GAC9BsQ,EAAa9jB,GAAMwf,KAAKA,GAEvBsE,EAAa9jB,EACtB,CAOS+B,CAAM/B,EAAMwf,EAAMhM,EAC3B,EAUA7I,EAAO8I,YAAc,SAAUzT,GAC7B,OAAOyT,EAAYzT,EACrB,EAIA2K,EAAOke,gBAAkB,SAAU7oB,GACjC,OAAOyT,EAAYzT,EACrB,EA6GA2K,EAAOC,SAAW,SAAmBia,GACnC,OAAY,MAALA,IAA6B,IAAhBA,EAAEiE,WACpBjE,IAAMla,EAAOvJ,SACjB,EAEAuJ,EAAOoe,QAAU,SAAkBC,EAAGnE,GAGpC,GAFIN,EAAWyE,EAAGjmB,cAAaimB,EAAIre,EAAOoE,KAAKia,EAAGA,EAAEvpB,OAAQupB,EAAE5T,aAC1DmP,EAAWM,EAAG9hB,cAAa8hB,EAAIla,EAAOoE,KAAK8V,EAAGA,EAAEplB,OAAQolB,EAAEzP,cACzDzK,EAAOC,SAASoe,KAAOre,EAAOC,SAASia,GAC1C,MAAM,IAAItX,UACR,yEAIJ,GAAIyb,IAAMnE,EAAG,OAAO,EAEpB,IAAIhD,EAAImH,EAAExpB,OACNypB,EAAIpE,EAAErlB,OAEV,IAAK,IAAIqE,EAAI,EAAGU,EAAM/C,KAAKyL,IAAI4U,EAAGoH,GAAIplB,EAAIU,IAAOV,EAC/C,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GAAI,CACjBge,EAAImH,EAAEnlB,GACNolB,EAAIpE,EAAEhhB,GACN,KACF,CAGF,OAAIge,EAAIoH,GAAW,EACfA,EAAIpH,EAAU,EACX,CACT,EAEAlX,EAAOuZ,WAAa,SAAqB1Q,GACvC,OAAQ9T,OAAO8T,GAAUV,eACvB,IAAK,MACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO,EACT,QACE,OAAO,EAEb,EAEAnI,EAAOyX,OAAS,SAAiB8G,EAAM1pB,GACrC,IAAK2B,MAAMuJ,QAAQwe,GACjB,MAAM,IAAI3b,UAAU,+CAGtB,GAAoB,IAAhB2b,EAAK1pB,OACP,OAAOmL,EAAO5I,MAAM,GAGtB,IAAI8B,EACJ,QAAeoM,IAAXzQ,EAEF,IADAA,EAAS,EACJqE,EAAI,EAAGA,EAAIqlB,EAAK1pB,SAAUqE,EAC7BrE,GAAU0pB,EAAKrlB,GAAGrE,OAItB,MAAMN,EAASyL,EAAO8I,YAAYjU,GAClC,IAAIgL,EAAM,EACV,IAAK3G,EAAI,EAAGA,EAAIqlB,EAAK1pB,SAAUqE,EAAG,CAChC,IAAIP,EAAM4lB,EAAKrlB,GACf,GAAI0gB,EAAWjhB,EAAKP,YACdyH,EAAMlH,EAAI9D,OAASN,EAAOM,QACvBmL,EAAOC,SAAStH,KAAMA,EAAMqH,EAAOoE,KAAKzL,IAC7CA,EAAI6R,KAAKjW,EAAQsL,IAEjBzH,WAAW3B,UAAUgD,IAAI9C,KACvBpC,EACAoE,EACAkH,OAGC,KAAKG,EAAOC,SAAStH,GAC1B,MAAM,IAAIiK,UAAU,+CAEpBjK,EAAI6R,KAAKjW,EAAQsL,EACnB,CACAA,GAAOlH,EAAI9D,MACb,CACA,OAAON,CACT,EAiDAyL,EAAOyK,WAAaA,EA8EpBzK,EAAOvJ,UAAU0nB,WAAY,EAQ7Bne,EAAOvJ,UAAU+nB,OAAS,WACxB,MAAM5kB,EAAMgE,KAAK/I,OACjB,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAEpB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAUgoB,OAAS,WACxB,MAAM7kB,EAAMgE,KAAK/I,OACjB,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAClBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GAExB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAUioB,OAAS,WACxB,MAAM9kB,EAAMgE,KAAK/I,OACjB,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAClBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GACtBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GACtBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GAExB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAU8L,SAAW,WAC1B,MAAM1N,EAAS+I,KAAK/I,OACpB,OAAe,IAAXA,EAAqB,GACA,IAArB+B,UAAU/B,OAAqBwN,EAAUzE,KAAM,EAAG/I,GAC/CimB,EAAa7lB,MAAM2I,KAAMhH,UAClC,EAEAoJ,EAAOvJ,UAAUkoB,eAAiB3e,EAAOvJ,UAAU8L,SAEnDvC,EAAOvJ,UAAUmoB,OAAS,SAAiB1E,GACzC,IAAKla,EAAOC,SAASia,GAAI,MAAM,IAAItX,UAAU,6BAC7C,OAAIhF,OAASsc,GACsB,IAA5Bla,EAAOoe,QAAQxgB,KAAMsc,EAC9B,EAEAla,EAAOvJ,UAAUooB,QAAU,WACzB,IAAI5lB,EAAM,GACV,MAAM6lB,EAAM5nB,EAAQ+hB,kBAGpB,OAFAhgB,EAAM2E,KAAK2E,SAAS,MAAO,EAAGuc,GAAKzgB,QAAQ,UAAW,OAAOyY,OACzDlZ,KAAK/I,OAASiqB,IAAK7lB,GAAO,SACvB,WAAaA,EAAM,GAC5B,EACI8f,IACF/Y,EAAOvJ,UAAUsiB,GAAuB/Y,EAAOvJ,UAAUooB,SAG3D7e,EAAOvJ,UAAU2nB,QAAU,SAAkBnO,EAAQ7O,EAAOb,EAAKwe,EAAWC,GAI1E,GAHIpF,EAAW3J,EAAQ7X,cACrB6X,EAASjQ,EAAOoE,KAAK6L,EAAQA,EAAOnb,OAAQmb,EAAOxF,cAEhDzK,EAAOC,SAASgQ,GACnB,MAAM,IAAIrN,UACR,wFAC2BqN,GAiB/B,QAbc3K,IAAVlE,IACFA,EAAQ,QAEEkE,IAAR/E,IACFA,EAAM0P,EAASA,EAAOpb,OAAS,QAEfyQ,IAAdyZ,IACFA,EAAY,QAEEzZ,IAAZ0Z,IACFA,EAAUphB,KAAK/I,QAGbuM,EAAQ,GAAKb,EAAM0P,EAAOpb,QAAUkqB,EAAY,GAAKC,EAAUphB,KAAK/I,OACtE,MAAM,IAAI+K,WAAW,sBAGvB,GAAImf,GAAaC,GAAW5d,GAASb,EACnC,OAAO,EAET,GAAIwe,GAAaC,EACf,OAAQ,EAEV,GAAI5d,GAASb,EACX,OAAO,EAQT,GAAI3C,OAASqS,EAAQ,OAAO,EAE5B,IAAIiH,GAJJ8H,KAAa,IADbD,KAAe,GAMXT,GAPJ/d,KAAS,IADTa,KAAW,GASX,MAAMxH,EAAM/C,KAAKyL,IAAI4U,EAAGoH,GAElBW,EAAWrhB,KAAKlH,MAAMqoB,EAAWC,GACjCE,EAAajP,EAAOvZ,MAAM0K,EAAOb,GAEvC,IAAK,IAAIrH,EAAI,EAAGA,EAAIU,IAAOV,EACzB,GAAI+lB,EAAS/lB,KAAOgmB,EAAWhmB,GAAI,CACjCge,EAAI+H,EAAS/lB,GACbolB,EAAIY,EAAWhmB,GACf,KACF,CAGF,OAAIge,EAAIoH,GAAW,EACfA,EAAIpH,EAAU,EACX,CACT,EA2HAlX,EAAOvJ,UAAU0oB,SAAW,SAAmBnW,EAAK8Q,EAAYjR,GAC9D,OAAoD,IAA7CjL,KAAKT,QAAQ6L,EAAK8Q,EAAYjR,EACvC,EAEA7I,EAAOvJ,UAAU0G,QAAU,SAAkB6L,EAAK8Q,EAAYjR,GAC5D,OAAOyS,EAAqB1d,KAAMoL,EAAK8Q,EAAYjR,GAAU,EAC/D,EAEA7I,EAAOvJ,UAAUglB,YAAc,SAAsBzS,EAAK8Q,EAAYjR,GACpE,OAAOyS,EAAqB1d,KAAMoL,EAAK8Q,EAAYjR,GAAU,EAC/D,EA4CA7I,EAAOvJ,UAAUwT,MAAQ,SAAgB3I,EAAQxM,EAAQD,EAAQgU,GAE/D,QAAevD,IAAXxQ,EACF+T,EAAW,OACXhU,EAAS+I,KAAK/I,OACdC,EAAS,OAEJ,QAAewQ,IAAXzQ,GAA0C,iBAAXC,EACxC+T,EAAW/T,EACXD,EAAS+I,KAAK/I,OACdC,EAAS,MAEJ,KAAI+R,SAAS/R,GAUlB,MAAM,IAAIqB,MACR,2EAVFrB,KAAoB,EAChB+R,SAAShS,IACXA,KAAoB,OACHyQ,IAAbuD,IAAwBA,EAAW,UAEvCA,EAAWhU,EACXA,OAASyQ,EAMb,CAEA,MAAM4W,EAAYte,KAAK/I,OAASC,EAGhC,SAFewQ,IAAXzQ,GAAwBA,EAASqnB,KAAWrnB,EAASqnB,GAEpD5a,EAAOzM,OAAS,IAAMA,EAAS,GAAKC,EAAS,IAAOA,EAAS8I,KAAK/I,OACrE,MAAM,IAAI+K,WAAW,0CAGlBiJ,IAAUA,EAAW,QAE1B,IAAI8R,GAAc,EAClB,OACE,OAAQ9R,GACN,IAAK,MACH,OAAOoT,EAASre,KAAM0D,EAAQxM,EAAQD,GAExC,IAAK,OACL,IAAK,QACH,OAAOuS,EAAUxJ,KAAM0D,EAAQxM,EAAQD,GAEzC,IAAK,QACL,IAAK,SACL,IAAK,SACH,OAAO0nB,EAAW3e,KAAM0D,EAAQxM,EAAQD,GAE1C,IAAK,SAEH,OAAO6nB,EAAY9e,KAAM0D,EAAQxM,EAAQD,GAE3C,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO8nB,EAAU/e,KAAM0D,EAAQxM,EAAQD,GAEzC,QACE,GAAI8lB,EAAa,MAAM,IAAI/X,UAAU,qBAAuBiG,GAC5DA,GAAY,GAAKA,GAAUV,cAC3BwS,GAAc,EAGtB,EAEA3a,EAAOvJ,UAAU2oB,OAAS,WACxB,MAAO,CACLtS,KAAM,SACNuN,KAAM7jB,MAAMC,UAAUC,MAAMC,KAAKiH,KAAKyhB,MAAQzhB,KAAM,GAExD,EAyFA,MAAM6f,EAAuB,KAoB7B,SAASzC,EAAYriB,EAAKyI,EAAOb,GAC/B,IAAI+e,EAAM,GACV/e,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAE3B,IAAK,IAAIrH,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BomB,GAAOvqB,OAAOC,aAAsB,IAAT2D,EAAIO,IAEjC,OAAOomB,CACT,CAEA,SAASrE,EAAatiB,EAAKyI,EAAOb,GAChC,IAAI+e,EAAM,GACV/e,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAE3B,IAAK,IAAIrH,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BomB,GAAOvqB,OAAOC,aAAa2D,EAAIO,IAEjC,OAAOomB,CACT,CAEA,SAASvE,EAAUpiB,EAAKyI,EAAOb,GAC7B,MAAM3G,EAAMjB,EAAI9D,SAEXuM,GAASA,EAAQ,KAAGA,EAAQ,KAC5Bb,GAAOA,EAAM,GAAKA,EAAM3G,KAAK2G,EAAM3G,GAExC,IAAIC,EAAM,GACV,IAAK,IAAIX,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BW,GAAO0lB,EAAoB5mB,EAAIO,IAEjC,OAAOW,CACT,CAEA,SAASshB,EAAcxiB,EAAKyI,EAAOb,GACjC,MAAMY,EAAQxI,EAAIjC,MAAM0K,EAAOb,GAC/B,IAAIyc,EAAM,GAEV,IAAK,IAAI9jB,EAAI,EAAGA,EAAIiI,EAAMtM,OAAS,EAAGqE,GAAK,EACzC8jB,GAAOjoB,OAAOC,aAAamM,EAAMjI,GAAqB,IAAfiI,EAAMjI,EAAI,IAEnD,OAAO8jB,CACT,CAiCA,SAASwC,EAAa1qB,EAAQ2qB,EAAK5qB,GACjC,GAAKC,EAAS,GAAO,GAAKA,EAAS,EAAG,MAAM,IAAI8K,WAAW,sBAC3D,GAAI9K,EAAS2qB,EAAM5qB,EAAQ,MAAM,IAAI+K,WAAW,wCAClD,CAyQA,SAAS8f,EAAU/mB,EAAK8D,EAAO3H,EAAQ2qB,EAAKX,EAAKxc,GAC/C,IAAKtC,EAAOC,SAAStH,GAAM,MAAM,IAAIiK,UAAU,+CAC/C,GAAInG,EAAQqiB,GAAOriB,EAAQ6F,EAAK,MAAM,IAAI1C,WAAW,qCACrD,GAAI9K,EAAS2qB,EAAM9mB,EAAI9D,OAAQ,MAAM,IAAI+K,WAAW,qBACtD,CA+FA,SAAS+f,EAAgBhnB,EAAK8D,EAAO3H,EAAQwN,EAAKwc,GAChDc,EAAWnjB,EAAO6F,EAAKwc,EAAKnmB,EAAK7D,EAAQ,GAEzC,IAAIsL,EAAKwG,OAAOnK,EAAQojB,OAAO,aAC/BlnB,EAAI7D,KAAYsL,EAChBA,IAAW,EACXzH,EAAI7D,KAAYsL,EAChBA,IAAW,EACXzH,EAAI7D,KAAYsL,EAChBA,IAAW,EACXzH,EAAI7D,KAAYsL,EAChB,IAAIC,EAAKuG,OAAOnK,GAASojB,OAAO,IAAMA,OAAO,aAQ7C,OAPAlnB,EAAI7D,KAAYuL,EAChBA,IAAW,EACX1H,EAAI7D,KAAYuL,EAChBA,IAAW,EACX1H,EAAI7D,KAAYuL,EAChBA,IAAW,EACX1H,EAAI7D,KAAYuL,EACTvL,CACT,CAEA,SAASgrB,EAAgBnnB,EAAK8D,EAAO3H,EAAQwN,EAAKwc,GAChDc,EAAWnjB,EAAO6F,EAAKwc,EAAKnmB,EAAK7D,EAAQ,GAEzC,IAAIsL,EAAKwG,OAAOnK,EAAQojB,OAAO,aAC/BlnB,EAAI7D,EAAS,GAAKsL,EAClBA,IAAW,EACXzH,EAAI7D,EAAS,GAAKsL,EAClBA,IAAW,EACXzH,EAAI7D,EAAS,GAAKsL,EAClBA,IAAW,EACXzH,EAAI7D,EAAS,GAAKsL,EAClB,IAAIC,EAAKuG,OAAOnK,GAASojB,OAAO,IAAMA,OAAO,aAQ7C,OAPAlnB,EAAI7D,EAAS,GAAKuL,EAClBA,IAAW,EACX1H,EAAI7D,EAAS,GAAKuL,EAClBA,IAAW,EACX1H,EAAI7D,EAAS,GAAKuL,EAClBA,IAAW,EACX1H,EAAI7D,GAAUuL,EACPvL,EAAS,CAClB,CAkHA,SAASirB,EAAcpnB,EAAK8D,EAAO3H,EAAQ2qB,EAAKX,EAAKxc,GACnD,GAAIxN,EAAS2qB,EAAM9mB,EAAI9D,OAAQ,MAAM,IAAI+K,WAAW,sBACpD,GAAI9K,EAAS,EAAG,MAAM,IAAI8K,WAAW,qBACvC,CAEA,SAASogB,EAAYrnB,EAAK8D,EAAO3H,EAAQmrB,EAAcC,GAOrD,OANAzjB,GAASA,EACT3H,KAAoB,EACforB,GACHH,EAAapnB,EAAK8D,EAAO3H,EAAQ,GAEnCgkB,EAAQ7O,MAAMtR,EAAK8D,EAAO3H,EAAQmrB,EAAc,GAAI,GAC7CnrB,EAAS,CAClB,CAUA,SAASqrB,EAAaxnB,EAAK8D,EAAO3H,EAAQmrB,EAAcC,GAOtD,OANAzjB,GAASA,EACT3H,KAAoB,EACforB,GACHH,EAAapnB,EAAK8D,EAAO3H,EAAQ,GAEnCgkB,EAAQ7O,MAAMtR,EAAK8D,EAAO3H,EAAQmrB,EAAc,GAAI,GAC7CnrB,EAAS,CAClB,CAzkBAkL,EAAOvJ,UAAUC,MAAQ,SAAgB0K,EAAOb,GAC9C,MAAM3G,EAAMgE,KAAK/I,QACjBuM,IAAUA,GAGE,GACVA,GAASxH,GACG,IAAGwH,EAAQ,GACdA,EAAQxH,IACjBwH,EAAQxH,IANV2G,OAAc+E,IAAR/E,EAAoB3G,IAAQ2G,GASxB,GACRA,GAAO3G,GACG,IAAG2G,EAAM,GACVA,EAAM3G,IACf2G,EAAM3G,GAGJ2G,EAAMa,IAAOb,EAAMa,GAEvB,MAAMgf,EAASxiB,KAAK1I,SAASkM,EAAOb,GAIpC,OAFAjE,OAAO8c,eAAegH,EAAQpgB,EAAOvJ,WAE9B2pB,CACT,EAUApgB,EAAOvJ,UAAU4pB,WACjBrgB,EAAOvJ,UAAU6pB,WAAa,SAAqBxrB,EAAQ2V,EAAYyV,GACrEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAEpD,IAAImU,EAAMpL,KAAK9I,GACXyrB,EAAM,EACNrnB,EAAI,EACR,OAASA,EAAIuR,IAAe8V,GAAO,MACjCvX,GAAOpL,KAAK9I,EAASoE,GAAKqnB,EAG5B,OAAOvX,CACT,EAEAhJ,EAAOvJ,UAAU+pB,WACjBxgB,EAAOvJ,UAAUgqB,WAAa,SAAqB3rB,EAAQ2V,EAAYyV,GACrEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GACHV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAGvC,IAAImU,EAAMpL,KAAK9I,IAAW2V,GACtB8V,EAAM,EACV,KAAO9V,EAAa,IAAM8V,GAAO,MAC/BvX,GAAOpL,KAAK9I,IAAW2V,GAAc8V,EAGvC,OAAOvX,CACT,EAEAhJ,EAAOvJ,UAAUiqB,UACjB1gB,EAAOvJ,UAAUkqB,UAAY,SAAoB7rB,EAAQorB,GAGvD,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpC+I,KAAK9I,EACd,EAEAkL,EAAOvJ,UAAUmqB,aACjB5gB,EAAOvJ,UAAUoqB,aAAe,SAAuB/rB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpC+I,KAAK9I,GAAW8I,KAAK9I,EAAS,IAAM,CAC7C,EAEAkL,EAAOvJ,UAAUqqB,aACjB9gB,EAAOvJ,UAAUolB,aAAe,SAAuB/mB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACnC+I,KAAK9I,IAAW,EAAK8I,KAAK9I,EAAS,EAC7C,EAEAkL,EAAOvJ,UAAUsqB,aACjB/gB,EAAOvJ,UAAUuqB,aAAe,SAAuBlsB,EAAQorB,GAI7D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,SAElC+I,KAAK9I,GACT8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,IAAM,IACD,SAAnB8I,KAAK9I,EAAS,EACrB,EAEAkL,EAAOvJ,UAAUwqB,aACjBjhB,EAAOvJ,UAAUyqB,aAAe,SAAuBpsB,EAAQorB,GAI7D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEpB,SAAf+I,KAAK9I,IACT8I,KAAK9I,EAAS,IAAM,GACrB8I,KAAK9I,EAAS,IAAM,EACrB8I,KAAK9I,EAAS,GAClB,EAEAkL,EAAOvJ,UAAU0qB,gBAAkBC,GAAmB,SAA0BtsB,GAE9EusB,EADAvsB,KAAoB,EACG,UACvB,MAAMwsB,EAAQ1jB,KAAK9I,GACbM,EAAOwI,KAAK9I,EAAS,QACbwQ,IAAVgc,QAAgChc,IAATlQ,GACzBmsB,EAAYzsB,EAAQ8I,KAAK/I,OAAS,GAGpC,MAAMuL,EAAKkhB,EACQ,IAAjB1jB,OAAO9I,GACU,MAAjB8I,OAAO9I,GACP8I,OAAO9I,GAAU,GAAK,GAElBuL,EAAKzC,OAAO9I,GACC,IAAjB8I,OAAO9I,GACU,MAAjB8I,OAAO9I,GACPM,EAAO,GAAK,GAEd,OAAOyqB,OAAOzf,IAAOyf,OAAOxf,IAAOwf,OAAO,IAC5C,IAEA7f,EAAOvJ,UAAU+qB,gBAAkBJ,GAAmB,SAA0BtsB,GAE9EusB,EADAvsB,KAAoB,EACG,UACvB,MAAMwsB,EAAQ1jB,KAAK9I,GACbM,EAAOwI,KAAK9I,EAAS,QACbwQ,IAAVgc,QAAgChc,IAATlQ,GACzBmsB,EAAYzsB,EAAQ8I,KAAK/I,OAAS,GAGpC,MAAMwL,EAAKihB,EAAQ,GAAK,GACL,MAAjB1jB,OAAO9I,GACU,IAAjB8I,OAAO9I,GACP8I,OAAO9I,GAEHsL,EAAKxC,OAAO9I,GAAU,GAAK,GACd,MAAjB8I,OAAO9I,GACU,IAAjB8I,OAAO9I,GACPM,EAEF,OAAQyqB,OAAOxf,IAAOwf,OAAO,KAAOA,OAAOzf,EAC7C,IAEAJ,EAAOvJ,UAAUgrB,UAAY,SAAoB3sB,EAAQ2V,EAAYyV,GACnEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAEpD,IAAImU,EAAMpL,KAAK9I,GACXyrB,EAAM,EACNrnB,EAAI,EACR,OAASA,EAAIuR,IAAe8V,GAAO,MACjCvX,GAAOpL,KAAK9I,EAASoE,GAAKqnB,EAM5B,OAJAA,GAAO,IAEHvX,GAAOuX,IAAKvX,GAAOnS,KAAK6qB,IAAI,EAAG,EAAIjX,IAEhCzB,CACT,EAEAhJ,EAAOvJ,UAAUkrB,UAAY,SAAoB7sB,EAAQ2V,EAAYyV,GACnEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAEpD,IAAIqE,EAAIuR,EACJ8V,EAAM,EACNvX,EAAMpL,KAAK9I,IAAWoE,GAC1B,KAAOA,EAAI,IAAMqnB,GAAO,MACtBvX,GAAOpL,KAAK9I,IAAWoE,GAAKqnB,EAM9B,OAJAA,GAAO,IAEHvX,GAAOuX,IAAKvX,GAAOnS,KAAK6qB,IAAI,EAAG,EAAIjX,IAEhCzB,CACT,EAEAhJ,EAAOvJ,UAAUmrB,SAAW,SAAmB9sB,EAAQorB,GAGrD,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACtB,IAAf+I,KAAK9I,IAC0B,GAA5B,IAAO8I,KAAK9I,GAAU,GADK8I,KAAK9I,EAE3C,EAEAkL,EAAOvJ,UAAUorB,YAAc,SAAsB/sB,EAAQorB,GAC3DprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAC3C,MAAMmU,EAAMpL,KAAK9I,GAAW8I,KAAK9I,EAAS,IAAM,EAChD,OAAc,MAANkU,EAAsB,WAANA,EAAmBA,CAC7C,EAEAhJ,EAAOvJ,UAAUqrB,YAAc,SAAsBhtB,EAAQorB,GAC3DprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAC3C,MAAMmU,EAAMpL,KAAK9I,EAAS,GAAM8I,KAAK9I,IAAW,EAChD,OAAc,MAANkU,EAAsB,WAANA,EAAmBA,CAC7C,EAEAhJ,EAAOvJ,UAAUsrB,YAAc,SAAsBjtB,EAAQorB,GAI3D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEnC+I,KAAK9I,GACV8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,IAAM,GACpB8I,KAAK9I,EAAS,IAAM,EACzB,EAEAkL,EAAOvJ,UAAUurB,YAAc,SAAsBltB,EAAQorB,GAI3D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEnC+I,KAAK9I,IAAW,GACrB8I,KAAK9I,EAAS,IAAM,GACpB8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,EACnB,EAEAkL,EAAOvJ,UAAUwrB,eAAiBb,GAAmB,SAAyBtsB,GAE5EusB,EADAvsB,KAAoB,EACG,UACvB,MAAMwsB,EAAQ1jB,KAAK9I,GACbM,EAAOwI,KAAK9I,EAAS,QACbwQ,IAAVgc,QAAgChc,IAATlQ,GACzBmsB,EAAYzsB,EAAQ8I,KAAK/I,OAAS,GAGpC,MAAMmU,EAAMpL,KAAK9I,EAAS,GACL,IAAnB8I,KAAK9I,EAAS,GACK,MAAnB8I,KAAK9I,EAAS,IACbM,GAAQ,IAEX,OAAQyqB,OAAO7W,IAAQ6W,OAAO,KAC5BA,OAAOyB,EACU,IAAjB1jB,OAAO9I,GACU,MAAjB8I,OAAO9I,GACP8I,OAAO9I,GAAU,GAAK,GAC1B,IAEAkL,EAAOvJ,UAAUyrB,eAAiBd,GAAmB,SAAyBtsB,GAE5EusB,EADAvsB,KAAoB,EACG,UACvB,MAAMwsB,EAAQ1jB,KAAK9I,GACbM,EAAOwI,KAAK9I,EAAS,QACbwQ,IAAVgc,QAAgChc,IAATlQ,GACzBmsB,EAAYzsB,EAAQ8I,KAAK/I,OAAS,GAGpC,MAAMmU,GAAOsY,GAAS,IACH,MAAjB1jB,OAAO9I,GACU,IAAjB8I,OAAO9I,GACP8I,OAAO9I,GAET,OAAQ+qB,OAAO7W,IAAQ6W,OAAO,KAC5BA,OAAOjiB,OAAO9I,GAAU,GAAK,GACZ,MAAjB8I,OAAO9I,GACU,IAAjB8I,OAAO9I,GACPM,EACJ,IAEA4K,EAAOvJ,UAAUuK,YAAc,SAAsBlM,EAAQorB,GAG3D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAM,GAAI,EAC9C,EAEAkL,EAAOvJ,UAAU0rB,YAAc,SAAsBrtB,EAAQorB,GAG3D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAO,GAAI,EAC/C,EAEAkL,EAAOvJ,UAAUyK,aAAe,SAAuBpM,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAM,GAAI,EAC9C,EAEAkL,EAAOvJ,UAAU2rB,aAAe,SAAuBttB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAO,GAAI,EAC/C,EAQAkL,EAAOvJ,UAAU4rB,YACjBriB,EAAOvJ,UAAU6rB,YAAc,SAAsB7lB,EAAO3H,EAAQ2V,EAAYyV,GAI9E,GAHAzjB,GAASA,EACT3H,KAAoB,EACpB2V,KAA4B,GACvByV,EAAU,CAEbR,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EADb5T,KAAK6qB,IAAI,EAAG,EAAIjX,GAAc,EACK,EACtD,CAEA,IAAI8V,EAAM,EACNrnB,EAAI,EAER,IADA0E,KAAK9I,GAAkB,IAAR2H,IACNvD,EAAIuR,IAAe8V,GAAO,MACjC3iB,KAAK9I,EAASoE,GAAMuD,EAAQ8jB,EAAO,IAGrC,OAAOzrB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU8rB,YACjBviB,EAAOvJ,UAAU+rB,YAAc,SAAsB/lB,EAAO3H,EAAQ2V,EAAYyV,GAI9E,GAHAzjB,GAASA,EACT3H,KAAoB,EACpB2V,KAA4B,GACvByV,EAAU,CAEbR,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EADb5T,KAAK6qB,IAAI,EAAG,EAAIjX,GAAc,EACK,EACtD,CAEA,IAAIvR,EAAIuR,EAAa,EACjB8V,EAAM,EAEV,IADA3iB,KAAK9I,EAASoE,GAAa,IAARuD,IACVvD,GAAK,IAAMqnB,GAAO,MACzB3iB,KAAK9I,EAASoE,GAAMuD,EAAQ8jB,EAAO,IAGrC,OAAOzrB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAUgsB,WACjBziB,EAAOvJ,UAAUisB,WAAa,SAAqBjmB,EAAO3H,EAAQorB,GAKhE,OAJAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,IAAM,GACtD8I,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUksB,cACjB3iB,EAAOvJ,UAAUmsB,cAAgB,SAAwBnmB,EAAO3H,EAAQorB,GAMtE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,MAAQ,GACxD8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUosB,cACjB7iB,EAAOvJ,UAAUqsB,cAAgB,SAAwBrmB,EAAO3H,EAAQorB,GAMtE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,MAAQ,GACxD8I,KAAK9I,GAAW2H,IAAU,EAC1BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUssB,cACjB/iB,EAAOvJ,UAAUusB,cAAgB,SAAwBvmB,EAAO3H,EAAQorB,GAQtE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,WAAY,GAC5D8I,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUwsB,cACjBjjB,EAAOvJ,UAAUysB,cAAgB,SAAwBzmB,EAAO3H,EAAQorB,GAQtE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,WAAY,GAC5D8I,KAAK9I,GAAW2H,IAAU,GAC1BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EA8CAkL,EAAOvJ,UAAU0sB,iBAAmB/B,GAAmB,SAA2B3kB,EAAO3H,EAAS,GAChG,OAAO6qB,EAAe/hB,KAAMnB,EAAO3H,EAAQ+qB,OAAO,GAAIA,OAAO,sBAC/D,IAEA7f,EAAOvJ,UAAU2sB,iBAAmBhC,GAAmB,SAA2B3kB,EAAO3H,EAAS,GAChG,OAAOgrB,EAAeliB,KAAMnB,EAAO3H,EAAQ+qB,OAAO,GAAIA,OAAO,sBAC/D,IAEA7f,EAAOvJ,UAAU4sB,WAAa,SAAqB5mB,EAAO3H,EAAQ2V,EAAYyV,GAG5E,GAFAzjB,GAASA,EACT3H,KAAoB,GACforB,EAAU,CACb,MAAMnR,EAAQlY,KAAK6qB,IAAI,EAAI,EAAIjX,EAAc,GAE7CiV,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EAAYsE,EAAQ,GAAIA,EACxD,CAEA,IAAI7V,EAAI,EACJqnB,EAAM,EACN+C,EAAM,EAEV,IADA1lB,KAAK9I,GAAkB,IAAR2H,IACNvD,EAAIuR,IAAe8V,GAAO,MAC7B9jB,EAAQ,GAAa,IAAR6mB,GAAsC,IAAzB1lB,KAAK9I,EAASoE,EAAI,KAC9CoqB,EAAM,GAER1lB,KAAK9I,EAASoE,IAAOuD,EAAQ8jB,GAAQ,GAAK+C,EAAM,IAGlD,OAAOxuB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU8sB,WAAa,SAAqB9mB,EAAO3H,EAAQ2V,EAAYyV,GAG5E,GAFAzjB,GAASA,EACT3H,KAAoB,GACforB,EAAU,CACb,MAAMnR,EAAQlY,KAAK6qB,IAAI,EAAI,EAAIjX,EAAc,GAE7CiV,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EAAYsE,EAAQ,GAAIA,EACxD,CAEA,IAAI7V,EAAIuR,EAAa,EACjB8V,EAAM,EACN+C,EAAM,EAEV,IADA1lB,KAAK9I,EAASoE,GAAa,IAARuD,IACVvD,GAAK,IAAMqnB,GAAO,MACrB9jB,EAAQ,GAAa,IAAR6mB,GAAsC,IAAzB1lB,KAAK9I,EAASoE,EAAI,KAC9CoqB,EAAM,GAER1lB,KAAK9I,EAASoE,IAAOuD,EAAQ8jB,GAAQ,GAAK+C,EAAM,IAGlD,OAAOxuB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU+sB,UAAY,SAAoB/mB,EAAO3H,EAAQorB,GAM9D,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,KAAO,KACnD2H,EAAQ,IAAGA,EAAQ,IAAOA,EAAQ,GACtCmB,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUgtB,aAAe,SAAuBhnB,EAAO3H,EAAQorB,GAMpE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,OAAS,OACzD8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUitB,aAAe,SAAuBjnB,EAAO3H,EAAQorB,GAMpE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,OAAS,OACzD8I,KAAK9I,GAAW2H,IAAU,EAC1BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUktB,aAAe,SAAuBlnB,EAAO3H,EAAQorB,GAQpE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,YAAa,YAC7D8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUmtB,aAAe,SAAuBnnB,EAAO3H,EAAQorB,GASpE,OARAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,YAAa,YACzD2H,EAAQ,IAAGA,EAAQ,WAAaA,EAAQ,GAC5CmB,KAAK9I,GAAW2H,IAAU,GAC1BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUotB,gBAAkBzC,GAAmB,SAA0B3kB,EAAO3H,EAAS,GAC9F,OAAO6qB,EAAe/hB,KAAMnB,EAAO3H,GAAS+qB,OAAO,sBAAuBA,OAAO,sBACnF,IAEA7f,EAAOvJ,UAAUqtB,gBAAkB1C,GAAmB,SAA0B3kB,EAAO3H,EAAS,GAC9F,OAAOgrB,EAAeliB,KAAMnB,EAAO3H,GAAS+qB,OAAO,sBAAuBA,OAAO,sBACnF,IAiBA7f,EAAOvJ,UAAUoT,aAAe,SAAuBpN,EAAO3H,EAAQorB,GACpE,OAAOF,EAAWpiB,KAAMnB,EAAO3H,GAAQ,EAAMorB,EAC/C,EAEAlgB,EAAOvJ,UAAUstB,aAAe,SAAuBtnB,EAAO3H,EAAQorB,GACpE,OAAOF,EAAWpiB,KAAMnB,EAAO3H,GAAQ,EAAOorB,EAChD,EAYAlgB,EAAOvJ,UAAUqT,cAAgB,SAAwBrN,EAAO3H,EAAQorB,GACtE,OAAOC,EAAYviB,KAAMnB,EAAO3H,GAAQ,EAAMorB,EAChD,EAEAlgB,EAAOvJ,UAAUutB,cAAgB,SAAwBvnB,EAAO3H,EAAQorB,GACtE,OAAOC,EAAYviB,KAAMnB,EAAO3H,GAAQ,EAAOorB,EACjD,EAGAlgB,EAAOvJ,UAAU+T,KAAO,SAAeyF,EAAQgU,EAAa7iB,EAAOb,GACjE,IAAKP,EAAOC,SAASgQ,GAAS,MAAM,IAAIrN,UAAU,+BAQlD,GAPKxB,IAAOA,EAAQ,GACfb,GAAe,IAARA,IAAWA,EAAM3C,KAAK/I,QAC9BovB,GAAehU,EAAOpb,SAAQovB,EAAchU,EAAOpb,QAClDovB,IAAaA,EAAc,GAC5B1jB,EAAM,GAAKA,EAAMa,IAAOb,EAAMa,GAG9Bb,IAAQa,EAAO,OAAO,EAC1B,GAAsB,IAAlB6O,EAAOpb,QAAgC,IAAhB+I,KAAK/I,OAAc,OAAO,EAGrD,GAAIovB,EAAc,EAChB,MAAM,IAAIrkB,WAAW,6BAEvB,GAAIwB,EAAQ,GAAKA,GAASxD,KAAK/I,OAAQ,MAAM,IAAI+K,WAAW,sBAC5D,GAAIW,EAAM,EAAG,MAAM,IAAIX,WAAW,2BAG9BW,EAAM3C,KAAK/I,SAAQ0L,EAAM3C,KAAK/I,QAC9Bob,EAAOpb,OAASovB,EAAc1jB,EAAMa,IACtCb,EAAM0P,EAAOpb,OAASovB,EAAc7iB,GAGtC,MAAMxH,EAAM2G,EAAMa,EAalB,OAXIxD,OAASqS,GAAqD,mBAApC7X,WAAW3B,UAAUytB,WAEjDtmB,KAAKsmB,WAAWD,EAAa7iB,EAAOb,GAEpCnI,WAAW3B,UAAUgD,IAAI9C,KACvBsZ,EACArS,KAAK1I,SAASkM,EAAOb,GACrB0jB,GAIGrqB,CACT,EAMAoG,EAAOvJ,UAAUoe,KAAO,SAAe7L,EAAK5H,EAAOb,EAAKsI,GAEtD,GAAmB,iBAARG,EAAkB,CAS3B,GARqB,iBAAV5H,GACTyH,EAAWzH,EACXA,EAAQ,EACRb,EAAM3C,KAAK/I,QACa,iBAAR0L,IAChBsI,EAAWtI,EACXA,EAAM3C,KAAK/I,aAEIyQ,IAAbuD,GAA8C,iBAAbA,EACnC,MAAM,IAAIjG,UAAU,6BAEtB,GAAwB,iBAAbiG,IAA0B7I,EAAOuZ,WAAW1Q,GACrD,MAAM,IAAIjG,UAAU,qBAAuBiG,GAE7C,GAAmB,IAAfG,EAAInU,OAAc,CACpB,MAAMoX,EAAOjD,EAAI5P,WAAW,IACV,SAAbyP,GAAuBoD,EAAO,KAClB,WAAbpD,KAEFG,EAAMiD,EAEV,CACF,KAA0B,iBAARjD,EAChBA,GAAY,IACY,kBAARA,IAChBA,EAAMpC,OAAOoC,IAIf,GAAI5H,EAAQ,GAAKxD,KAAK/I,OAASuM,GAASxD,KAAK/I,OAAS0L,EACpD,MAAM,IAAIX,WAAW,sBAGvB,GAAIW,GAAOa,EACT,OAAOxD,KAQT,IAAI1E,EACJ,GANAkI,KAAkB,EAClBb,OAAc+E,IAAR/E,EAAoB3C,KAAK/I,OAAS0L,IAAQ,EAE3CyI,IAAKA,EAAM,GAGG,iBAARA,EACT,IAAK9P,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EACzB0E,KAAK1E,GAAK8P,MAEP,CACL,MAAM7H,EAAQnB,EAAOC,SAAS+I,GAC1BA,EACAhJ,EAAOoE,KAAK4E,EAAKH,GACfjP,EAAMuH,EAAMtM,OAClB,GAAY,IAAR+E,EACF,MAAM,IAAIgJ,UAAU,cAAgBoG,EAClC,qCAEJ,IAAK9P,EAAI,EAAGA,EAAIqH,EAAMa,IAASlI,EAC7B0E,KAAK1E,EAAIkI,GAASD,EAAMjI,EAAIU,EAEhC,CAEA,OAAOgE,IACT,EAMA,MAAMumB,EAAS,CAAC,EAChB,SAASC,EAAGC,EAAKC,EAAYC,GAC3BJ,EAAOE,GAAO,cAAwBE,EACpC7mB,cACE6S,QAEAjU,OAAO2B,eAAeL,KAAM,UAAW,CACrCnB,MAAO6nB,EAAWrvB,MAAM2I,KAAMhH,WAC9BkH,UAAU,EACV+H,cAAc,IAIhBjI,KAAKX,KAAO,GAAGW,KAAKX,SAASonB,KAG7BzmB,KAAKgI,aAEEhI,KAAKX,IACd,CAEIgP,WACF,OAAOoY,CACT,CAEIpY,SAAMxP,GACRH,OAAO2B,eAAeL,KAAM,OAAQ,CAClCiI,cAAc,EACdrH,YAAY,EACZ/B,QACAqB,UAAU,GAEd,CAEAyE,WACE,MAAO,GAAG3E,KAAKX,SAASonB,OAASzmB,KAAK6H,SACxC,EAEJ,CA+BA,SAAS+e,EAAuBxb,GAC9B,IAAIgU,EAAM,GACN9jB,EAAI8P,EAAInU,OACZ,MAAMuM,EAAmB,MAAX4H,EAAI,GAAa,EAAI,EACnC,KAAO9P,GAAKkI,EAAQ,EAAGlI,GAAK,EAC1B8jB,EAAM,IAAIhU,EAAItS,MAAMwC,EAAI,EAAGA,KAAK8jB,IAElC,MAAO,GAAGhU,EAAItS,MAAM,EAAGwC,KAAK8jB,GAC9B,CAYA,SAAS4C,EAAYnjB,EAAO6F,EAAKwc,EAAKnmB,EAAK7D,EAAQ2V,GACjD,GAAIhO,EAAQqiB,GAAOriB,EAAQ6F,EAAK,CAC9B,MAAMjM,EAAmB,iBAARiM,EAAmB,IAAM,GAC1C,IAAIoV,EAWJ,MARIA,EAFAjN,EAAa,EACH,IAARnI,GAAaA,IAAQud,OAAO,GACtB,OAAOxpB,YAAYA,QAA2B,GAAlBoU,EAAa,KAASpU,IAElD,SAASA,QAA2B,GAAlBoU,EAAa,GAAS,IAAIpU,iBACtB,GAAlBoU,EAAa,GAAS,IAAIpU,IAGhC,MAAMiM,IAAMjM,YAAYyoB,IAAMzoB,IAElC,IAAI8tB,EAAOM,iBAAiB,QAAS/M,EAAOjb,EACpD,EAtBF,SAAsB9D,EAAK7D,EAAQ2V,GACjC4W,EAAevsB,EAAQ,eACHwQ,IAAhB3M,EAAI7D,SAAsDwQ,IAA7B3M,EAAI7D,EAAS2V,IAC5C8W,EAAYzsB,EAAQ6D,EAAI9D,QAAU4V,EAAa,GAEnD,CAkBEia,CAAY/rB,EAAK7D,EAAQ2V,EAC3B,CAEA,SAAS4W,EAAgB5kB,EAAOQ,GAC9B,GAAqB,iBAAVR,EACT,MAAM,IAAI0nB,EAAOQ,qBAAqB1nB,EAAM,SAAUR,EAE1D,CAEA,SAAS8kB,EAAa9kB,EAAO5H,EAAQiY,GACnC,GAAIjW,KAAKiQ,MAAMrK,KAAWA,EAExB,MADA4kB,EAAe5kB,EAAOqQ,GAChB,IAAIqX,EAAOM,iBAAiB3X,GAAQ,SAAU,aAAcrQ,GAGpE,GAAI5H,EAAS,EACX,MAAM,IAAIsvB,EAAOS,yBAGnB,MAAM,IAAIT,EAAOM,iBAAiB3X,GAAQ,SACR,MAAMA,EAAO,EAAI,YAAYjY,IAC7B4H,EACpC,CAvFA2nB,EAAE,4BACA,SAAUnnB,GACR,OAAIA,EACK,GAAGA,gCAGL,gDACT,GAAG2C,YACLwkB,EAAE,wBACA,SAAUnnB,EAAMuc,GACd,MAAO,QAAQvc,4DAA+Duc,GAChF,GAAG5W,WACLwhB,EAAE,oBACA,SAAUnrB,EAAKye,EAAO/d,GACpB,IAAIkrB,EAAM,iBAAiB5rB,sBACvB6rB,EAAWnrB,EAWf,OAVIiN,OAAOD,UAAUhN,IAAU9C,KAAKkuB,IAAIprB,GAAS,GAAK,GACpDmrB,EAAWN,EAAsBzvB,OAAO4E,IACd,iBAAVA,IAChBmrB,EAAW/vB,OAAO4E,IACdA,EAAQkmB,OAAO,IAAMA,OAAO,KAAOlmB,IAAUkmB,OAAO,IAAMA,OAAO,QACnEiF,EAAWN,EAAsBM,IAEnCA,GAAY,KAEdD,GAAO,eAAenN,eAAmBoN,IAClCD,CACT,GAAGjlB,YAiEL,MAAMolB,EAAoB,oBAgB1B,SAASpK,EAAatZ,EAAQsb,GAE5B,IAAIM,EADJN,EAAQA,GAAS5N,IAEjB,MAAMna,EAASyM,EAAOzM,OACtB,IAAIowB,EAAgB,KACpB,MAAM9jB,EAAQ,GAEd,IAAK,IAAIjI,EAAI,EAAGA,EAAIrE,IAAUqE,EAAG,CAI/B,GAHAgkB,EAAY5b,EAAOlI,WAAWF,GAG1BgkB,EAAY,OAAUA,EAAY,MAAQ,CAE5C,IAAK+H,EAAe,CAElB,GAAI/H,EAAY,MAAQ,EAEjBN,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C,QACF,CAAO,GAAI4D,EAAI,IAAMrE,EAAQ,EAEtB+nB,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C,QACF,CAGA2vB,EAAgB/H,EAEhB,QACF,CAGA,GAAIA,EAAY,MAAQ,EACjBN,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C2vB,EAAgB/H,EAChB,QACF,CAGAA,EAAkE,OAArD+H,EAAgB,OAAU,GAAK/H,EAAY,MAC1D,MAAW+H,IAEJrI,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAMhD,GAHA2vB,EAAgB,KAGZ/H,EAAY,IAAM,CACpB,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KAAK4nB,EACb,MAAO,GAAIA,EAAY,KAAO,CAC5B,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,EAAM,IACP,GAAZA,EAAmB,IAEvB,MAAO,GAAIA,EAAY,MAAS,CAC9B,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,GAAM,IACnBA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,IAEvB,KAAO,MAAIA,EAAY,SASrB,MAAM,IAAI/mB,MAAM,sBARhB,IAAKymB,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,GAAO,IACpBA,GAAa,GAAM,GAAO,IAC1BA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,IAIvB,CACF,CAEA,OAAO/b,CACT,CA2BA,SAAS0Z,EAAe5hB,GACtB,OAAO6M,EAAOof,YAxHhB,SAAsBjsB,GAMpB,IAFAA,GAFAA,EAAMA,EAAI4D,MAAM,KAAK,IAEXia,OAAOzY,QAAQ2mB,EAAmB,KAEpCnwB,OAAS,EAAG,MAAO,GAE3B,KAAOoE,EAAIpE,OAAS,GAAM,GACxBoE,GAAY,IAEd,OAAOA,CACT,CA4G4BksB,CAAYlsB,GACxC,CAEA,SAASqjB,EAAYnX,EAAKD,EAAKpQ,EAAQD,GACrC,IAAIqE,EACJ,IAAKA,EAAI,EAAGA,EAAIrE,KACTqE,EAAIpE,GAAUoQ,EAAIrQ,QAAYqE,GAAKiM,EAAItQ,UADpBqE,EAExBgM,EAAIhM,EAAIpE,GAAUqQ,EAAIjM,GAExB,OAAOA,CACT,CAKA,SAAS0gB,EAAY1S,EAAK4F,GACxB,OAAO5F,aAAe4F,GACZ,MAAP5F,GAAkC,MAAnBA,EAAIxJ,aAA+C,MAAxBwJ,EAAIxJ,YAAYT,MACzDiK,EAAIxJ,YAAYT,OAAS6P,EAAK7P,IACpC,CACA,SAASmd,EAAalT,GAEpB,OAAOA,GAAQA,CACjB,CAIA,MAAMqY,EAAsB,WAC1B,MAAM6F,EAAW,mBACXjuB,EAAQ,IAAIX,MAAM,KACxB,IAAK,IAAI0C,EAAI,EAAGA,EAAI,KAAMA,EAAG,CAC3B,MAAMmsB,EAAU,GAAJnsB,EACZ,IAAK,IAAI8iB,EAAI,EAAGA,EAAI,KAAMA,EACxB7kB,EAAMkuB,EAAMrJ,GAAKoJ,EAASlsB,GAAKksB,EAASpJ,EAE5C,CACA,OAAO7kB,CACR,CAV2B,GAa5B,SAASiqB,EAAoBxf,GAC3B,MAAyB,oBAAXie,OAAyByF,GAAyB1jB,CAClE,CAEA,SAAS0jB,KACP,MAAM,IAAInvB,MAAM,uBAClB,qBCnjEA,SAASovB,EAAWC,GAClB,MAAMC,EAAa,IAAIC,WAAWC,gBAElC,SAASC,IACPH,EAAW3vB,QAEX,IAAK,MAAM+vB,KAAUL,EACdK,GAAWA,EAAOC,qBACvBD,EAAOC,oBAAoB,QAASF,EAExC,CAEA,IAAK,MAAMC,KAAUL,EACnB,GAAKK,GAAWA,EAAOE,iBAAvB,CACA,GAAIF,EAAOG,QAAS,CAClBJ,IACA,KACF,CACAC,EAAOE,iBAAiB,QAASH,EALQ,CAQ3C,OAAOH,EAAWI,MACpB,CAEAxpB,EAAOnF,QAAUquB,EACjBlpB,EAAOnF,QAAQquB,UAAYA,sCC3B3B,MAAM,cAAErT,GAAkB,EAAQ,OAC5BhH,EAAc,EAAQ,OACtB+a,EAAW,EAAQ,QACnB,aAAEhb,GAAiB,EAAQ,QAC3B,SAAEoL,GAAa,EAAQ,MACvB6P,EAAc,EAAQ,OACtBjZ,EAAQ,EAAQ,OAChBkZ,EAAiB,EAAQ,OAGzBC,EAAiB,YAEjBC,EAAOjyB,OAAO,OACdkyB,EAAclyB,OAAO,cACrBmyB,EAAYnyB,OAAO,YACnBoyB,EAAWpyB,OAAO,WAClBqyB,EAASryB,OAAO,SAChBsyB,EAActyB,OAAO,cACrBiX,EAAWjX,OAAO,WAExB,MAAMuyB,UAAqBzU,EACzBxU,YAAakpB,EAAU5a,EAAS6a,GAE9B,GAAuB,mBAAZ7a,GAAuC,mBAAN6a,EAC1C,MAAM,IAAI3b,EAAY,uDAAwD,CAC5Ee,KAAM,iBAIV,MAAM,OAAEmL,EAAM,QAAE0P,KAAYzU,GAAYrG,GAAW,CAAC,EAUpD,GARAuE,MAAM,CACJ0C,UAAW,CAAEzZ,MAAM,GACnBmZ,WAAW,EACXiB,iBAAiB,EACjBC,eAAe,EACf7D,MAAM,GACLqC,GAEqB,iBAAbuU,EACT,MAAM,IAAIzwB,MAAM,mDAIlByH,KAAK2oB,GAAaK,EAClBhpB,KAAK0oB,GAAyB,MAAVlP,EAAiBgP,EAAiBhP,EACtDxZ,KAAK4oB,GAAYliB,SAASwiB,GAAW,EAAG,IACxClpB,KAAKyoB,GAAQ,IACf,CAEIO,eACF,OAAOhpB,KAAK2oB,EACd,CAEIQ,iBACF,OAAOnpB,KAAK0oB,EACd,CAEIQ,cACF,OAAOlpB,KAAK4oB,EACd,CAGI7a,SACF,OAAO/N,KAAKyoB,EACd,CAEIvZ,WACF,MAAO,eACT,CAEAkH,MAAOhI,EAAS5I,GACd,MAAM4jB,EAAMC,UAAU5T,KAAKzV,KAAK0oB,GAAe1oB,KAAK2oB,GAAY3oB,KAAK4oB,IAErEQ,EAAIE,QAAU,WACZ9jB,EAAS4jB,EAAIhJ,OAAS,IAAI7nB,MAAM,iBAClC,EAEA6wB,EAAIG,UAAY,KACdvpB,KAAKyoB,GAAQW,EAAIxP,OACjBpU,GAAS,EAGX4jB,EAAII,gBAAmBC,IACrB,MAAM1b,EAAK0b,EAAGpX,OAAOuH,OAEhB7L,EAAG2b,iBAAiBC,SAAS3pB,KAAK2oB,KACrC5a,EAAG6b,kBAAkB5pB,KAAK2oB,GAC5B,CAEJ,CAEA,CAACE,GAASgB,GAER,OADoB7pB,KAAKyoB,GAAMqB,YAAY,CAAC9pB,KAAK2oB,IAAakB,GAC3CE,YAAY/pB,KAAK2oB,GACtC,CAEA,CAACG,GAAcvjB,EAASC,GACtB,MAAMskB,EAAcvkB,EAAQukB,YAI5BA,EAAYE,QAAU,WACpBxkB,EAASskB,EAAY1J,OAAS,IAAI7nB,MAAM,mBAC1C,EAEAuxB,EAAYG,WAAa,WACvBzkB,EAAS,KAAMD,EAAQqU,OACzB,CACF,CAEA/C,KAAM1I,EAAKC,EAAS5I,GAClB,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,YAC3B,IAAIO,EAEJ,IACEA,EAAMc,EAAMvpB,IAAIwN,EAClB,CAAE,MAAOvI,GACP,OAAO5F,KAAKiO,SAASzI,EAAUI,EACjC,CAEA5F,KAAK8oB,GAAaM,GAAK,SAAUxjB,EAAK/G,GACpC,OAAI+G,EAAYJ,EAASI,QAEX8B,IAAV7I,EACK2G,EAAS,IAAI8H,EAAY,kBAAmB,CACjDe,KAAM,0BAIV7I,EAAS,KAAM8iB,EAAYzpB,GAC7B,GACF,CAEAmY,SAAUvP,EAAM2G,EAAS5I,GACvB,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,YACrBsB,EAAQ1iB,EAAKmT,KAAKzM,GAAS9C,IAC/B,IAAI9F,EAEJ,IACEA,EAAU2kB,EAAMvpB,IAAIwN,EACtB,CAAE,MAAOvI,GACP,OAAOyF,EAAKzF,EACd,CAEAL,EAAQgkB,UAAY,KAClB,MAAM1qB,EAAQ0G,EAAQqU,OACtBvO,EAAK,UAAgB3D,IAAV7I,EAAsBA,EAAQypB,EAAYzpB,GAAM,EAG7D0G,EAAQ+jB,QAAWG,IACjBA,EAAGW,kBACH/e,EAAK9F,EAAQ6a,MAAK,CACpB,IAGFiI,EAAS8B,EAAO,GAAI3kB,EACtB,CAEA4J,KAAMjB,EAAKC,EAAS5I,GAClB,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,aAC3B,IAAIO,EAEJ,IACEA,EAAMc,EAAMjS,OAAO9J,EACrB,CAAE,MAAOvI,GACP,OAAO5F,KAAKiO,SAASzI,EAAUI,EACjC,CAEA5F,KAAK8oB,GAAaM,EAAK5jB,EACzB,CAEAyJ,KAAMd,EAAKtP,EAAOuP,EAAS5I,GACzB,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,aAC3B,IAAIO,EAEJ,IAGEA,EAAMc,EAAMhc,IAAIrP,EAAOsP,EACzB,CAAE,MAAOvI,GACP,OAAO5F,KAAKiO,SAASzI,EAAUI,EACjC,CAEA5F,KAAK8oB,GAAaM,EAAK5jB,EACzB,CAGAqS,UAAWzJ,GACT,OAAO,IAAIqK,EAASzY,KAAMA,KAAK2oB,GAAYva,EAC7C,CAEAoJ,OAAQN,EAAY9I,EAAS5I,GAC3B,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,aACrBiB,EAAcI,EAAMJ,YAC1B,IACI1J,EADAiK,EAAQ,EAGZP,EAAYE,QAAU,WACpBxkB,EAAS4a,GAAS0J,EAAY1J,OAAS,IAAI7nB,MAAM,mBACnD,EAEAuxB,EAAYG,WAAa,WACvBzkB,GACF,EAGA,SAAS8kB,IACP,MAAMhT,EAAKJ,EAAWmT,KAChBlc,EAAMmJ,EAAGnJ,IAEf,IAAIib,EAEJ,IACEA,EAAkB,QAAZ9R,EAAGpI,KAAiBgb,EAAMjS,OAAO9J,GAAO+b,EAAMhc,IAAIoJ,EAAGzY,MAAOsP,EACpE,CAAE,MAAOvI,GAGP,OAFAwa,EAAQxa,OACRkkB,EAAY5xB,OAEd,CAEImyB,EAAQnT,EAAWjgB,OACrBmyB,EAAIG,UAAYe,EACuB,mBAAvBR,EAAYS,QAE5BT,EAAYS,QAEhB,CAEAD,EACF,CAEAhb,OAAQlB,EAAS5I,GACf,IAAIglB,EACApB,EAEJ,IACEoB,EAAWjC,EAAena,EAC5B,CAAE,MAAO3E,GAGP,OAAOzJ,KAAKiO,SAASzI,EACvB,CAEA,GAAI4I,EAAQ+C,OAAS,EAGnB,OAAO9B,EAAMrP,KAAMA,KAAK2oB,GAAY6B,EAAUpc,EAAS5I,GAGzD,IACE,MAAM0kB,EAAQlqB,KAAK6oB,GAAQ,aAC3BO,EAAMoB,EAAWN,EAAMjS,OAAOuS,GAAYN,EAAM7a,OAClD,CAAE,MAAOzJ,GACP,OAAO5F,KAAKiO,SAASzI,EAAUI,EACjC,CAEA5F,KAAK8oB,GAAaM,EAAK5jB,EACzB,CAEAiK,OAAQjK,GACNxF,KAAKyoB,GAAMlZ,QACXvP,KAAKiO,SAASzI,EAChB,EAGFujB,EAAa0B,QAAU,SAAUzB,EAAUxP,EAAQhU,GAC3B,mBAAXgU,IACThU,EAAWgU,EACXA,EAASgP,GAGXhjB,EAAW6H,EAAa7H,EAAUiI,GAClC,MAAMlI,EAAU8jB,UAAUqB,eAAelR,EAASwP,GAUlD,OARAzjB,EAAQgkB,UAAY,WAClB/jB,GACF,EAEAD,EAAQ+jB,QAAU,SAAU1jB,GAC1BJ,EAASI,EACX,EAEOJ,EAASiI,EAClB,EAEAnU,EAAQyvB,aAAeA,qCChSvB,MAAM,iBAAErW,GAAqB,EAAQ,OAC/B6V,EAAiB,EAAQ,OACzBD,EAAc,EAAQ,OAEtBqC,EAASn0B,OAAO,SAChBo0B,EAAYp0B,OAAO,YACnB2d,EAAW3d,OAAO,WAClBq0B,EAAkBr0B,OAAO,kBACzBs0B,EAAYt0B,OAAO,YACnBmyB,EAAYnyB,OAAO,YACnBu0B,EAASv0B,OAAO,SAChBua,EAAe,CAAC,EA2NtB,SAASia,EAAalB,GAEc,mBAAvBA,EAAYS,QACrBT,EAAYS,QAEhB,CAPAjxB,EAAQmf,SAvNR,cAAuB/F,EACrB5S,YAAaiO,EAAIib,EAAU5a,GACzBuE,MAAM5E,EAAIK,GAEVpO,KAAK2qB,GAAU,GACf3qB,KAAK4qB,GAA4B,IAAf5qB,KAAKmR,MACvBnR,KAAKmU,GAAY/F,EACjBpO,KAAK6qB,GAAmB,IAAKzc,GAC7BpO,KAAK8qB,QAAapjB,EAClB1H,KAAK2oB,GAAaK,EAClBhpB,KAAK+qB,IAAU,CACjB,CAIAlZ,OAAQpa,EAAM2W,EAAS5I,GAGrB,GAFAxF,KAAK+qB,IAAU,EAEX/qB,KAAK4qB,GACP,OAAO5qB,KAAKiO,SAASzI,EAAU,KAAM,IAChC,GAAIxF,KAAK2qB,GAAQ1zB,OAAS,EAG/B,OADAQ,EAAOwB,KAAKyL,IAAIjN,EAAMuI,KAAK2qB,GAAQ1zB,QAC5B+I,KAAKiO,SAASzI,EAAU,KAAMxF,KAAK2qB,GAAQM,OAAO,EAAGxzB,IAc9D,IAAI+yB,OAVoB9iB,IAApB1H,KAAK8qB,KACH9qB,KAAKmU,GAAU8G,SACjBjb,KAAK6qB,GAAiB3Q,GAAKla,KAAK8qB,GAChC9qB,KAAK6qB,GAAiB5Q,SAAMvS,IAE5B1H,KAAK6qB,GAAiB7Q,GAAKha,KAAK8qB,GAChC9qB,KAAK6qB,GAAiB9Q,SAAMrS,IAMhC,IACE8iB,EAAWjC,EAAevoB,KAAK6qB,GACjC,CAAE,MAAO5B,GAIP,OADAjpB,KAAK4qB,IAAa,EACX5qB,KAAKiO,SAASzI,EAAU,KAAM,GACvC,CAEA,MAAMskB,EAAc9pB,KAAK+N,GAAGA,GAAG+b,YAAY,CAAC9pB,KAAK2oB,IAAa,YACxDuB,EAAQJ,EAAYC,YAAY/pB,KAAK2oB,IACrC9V,EAAU,GAEhB,GAAK7S,KAAKmU,GAAU8G,QAsDb,CAKLiP,GAFgBlqB,KAAKmU,GAAUxY,QAAUuuB,EAAMgB,cAAgB,gBAAkB,cAEnEV,EAAU,QAAQjB,UAAaE,IAC3C,MAAM0B,EAAS1B,EAAGpX,OAAOuH,OAEzB,GAAIuR,EAAQ,CACV,MAAM,IAAEhd,EAAG,MAAEtP,GAAUssB,EACvBnrB,KAAK8qB,GAAa3c,EAElB0E,EAAQnb,KAAK,CACXsI,KAAKmU,GAAU1M,WAAgBC,IAARyG,EAAoBma,EAAYna,QAAOzG,EAC9D1H,KAAKmU,GAAUxY,aAAoB+L,IAAV7I,EAAsBypB,EAAYzpB,QAAS6I,IAGlEmL,EAAQ5b,OAASQ,EACnB0zB,EAAOC,WAEPJ,EAAYlB,EAEhB,MACE9pB,KAAK4qB,IAAa,CACpB,CAEJ,KAhF6B,CAC3B,IAAInjB,EACA9L,EAEJ,MAAM0vB,EAAW,KAEf,QAAa3jB,IAATD,QAAiCC,IAAX/L,EAAsB,OAEhD,MAAM1E,EAASgC,KAAKioB,IAAIzZ,EAAKxQ,OAAQ0E,EAAO1E,QAE7B,IAAXA,GAAgBQ,IAAS2Z,IAC3BpR,KAAK4qB,IAAa,EAElB5qB,KAAK8qB,GAAarjB,EAAKxQ,EAAS,GAIlC4b,EAAQ5b,OAASA,EAGjB,IAAK,IAAIqE,EAAI,EAAGA,EAAIrE,EAAQqE,IAAK,CAC/B,MAAM6S,EAAM1G,EAAKnM,GACXuD,EAAQlD,EAAOL,GAErBuX,EAAQvX,GAAK,CACX0E,KAAKmU,GAAU1M,WAAgBC,IAARyG,EAAoBma,EAAYna,QAAOzG,EAC9D1H,KAAKmU,GAAUxY,aAAoB+L,IAAV7I,EAAsBypB,EAAYzpB,QAAS6I,EAExE,CAEAsjB,EAAYlB,EAAW,EAKrB9pB,KAAKmU,GAAU1M,MAAQhQ,EAAO2Z,IAChC8Y,EAAMoB,WAAWd,EAAU/yB,EAAO2Z,IAAW3Z,OAAOiQ,GAAW6hB,UAAaE,IAC1EhiB,EAAOgiB,EAAGpX,OAAOuH,OACjByR,GAAS,GAGX5jB,EAAO,GACPzH,KAAKiO,SAASod,IAGZrrB,KAAKmU,GAAUxY,OACjBuuB,EAAMqB,OAAOf,EAAU/yB,EAAO2Z,IAAW3Z,OAAOiQ,GAAW6hB,UAAaE,IACtE9tB,EAAS8tB,EAAGpX,OAAOuH,OACnByR,GAAS,GAGX1vB,EAAS,GACTqE,KAAKiO,SAASod,GAElB,CA6BAvB,EAAYE,QAAU,KACpBxkB,EAASskB,EAAY1J,OAAS,IAAI7nB,MAAM,oBACxCiN,EAAW,MAGbskB,EAAYG,WAAa,KACvBzkB,EAAS,KAAMqN,GACfrN,EAAW,KAEf,CAEAmM,MAAOnM,GACL,GAAIxF,KAAK2qB,GAAQ1zB,OAAS,EAAG,CAC3B,MAAOkX,EAAKtP,GAASmB,KAAK2qB,GAAQvrB,QAClCY,KAAKiO,SAASzI,EAAU,KAAM2I,EAAKtP,EACrC,MAAO,GAAImB,KAAK4qB,GACd5qB,KAAKiO,SAASzI,OACT,CACL,IAAI/N,EAAOwB,KAAKyL,IAAI,IAAK1E,KAAKmR,MAAQnR,KAAKsR,OAEvCtR,KAAK+qB,KAEP/qB,KAAK+qB,IAAU,EACftzB,EAAO,GAGTuI,KAAK6R,OAAOpa,EAAMsZ,GAAc,CAACnL,EAAKiN,KACpC,GAAIjN,EAAK,OAAOJ,EAASI,GACzB5F,KAAK2qB,GAAU9X,EACf7S,KAAK2R,MAAMnM,EAAQ,GAEvB,CACF,CAEAyM,KAAM7D,EAAS5I,GACbxF,KAAK+qB,IAAU,EAGf,MAAM1Q,EAAQra,KAAK2qB,GAAQM,OAAO,EAAGjrB,KAAK2qB,GAAQ1zB,QAC5CQ,EAAOuI,KAAKmR,MAAQnR,KAAKsR,MAAQ+I,EAAMpjB,OAE7C,GAAIQ,GAAQ,EACV,OAAOuI,KAAKiO,SAASzI,EAAU,KAAM6U,GAGvCra,KAAK6R,OAAOpa,EAAMsZ,GAAc,CAACnL,EAAKiN,KACpC,GAAIjN,EAAK,OAAOJ,EAASI,GACrByU,EAAMpjB,OAAS,IAAG4b,EAAUwH,EAAMR,OAAOhH,IAC7CrN,EAAS,KAAMqN,EAAO,GAE1B,CAEAN,MAAOF,EAAQjE,GASb,IAAIoc,EARJxqB,KAAK+qB,IAAU,EACf/qB,KAAK2qB,GAAU,GACf3qB,KAAK4qB,IAAa,EAClB5qB,KAAK8qB,QAAapjB,EAGlB1H,KAAK6qB,GAAmB,IAAK7qB,KAAKmU,IAIlC,IACEqW,EAAWjC,EAAevoB,KAAKmU,GACjC,CAAE,MAAO8U,GAEP,YADAjpB,KAAK4qB,IAAa,EAEpB,CAEiB,OAAbJ,GAAsBA,EAASjJ,SAASlP,GAEjCrS,KAAKmU,GAAU8G,QACxBjb,KAAK6qB,GAAiB5Q,IAAM5H,EAE5BrS,KAAK6qB,GAAiB9Q,IAAM1H,EAJ5BrS,KAAK4qB,IAAa,CAMtB,mCCjOFnsB,EAAOnF,QAAU,SAAgByU,EAAIib,EAAUwB,EAAUpc,EAAS5I,GAChE,GAAsB,IAAlB4I,EAAQ+C,MAAa,OAAOpD,EAAGE,SAASzI,GAE5C,MAAMskB,EAAc/b,EAAGA,GAAG+b,YAAY,CAACd,GAAW,aAC5CkB,EAAQJ,EAAYC,YAAYf,GACtC,IAAI1X,EAAQ,EAEZwY,EAAYG,WAAa,WACvBzkB,GACF,EAEAskB,EAAYE,QAAU,WACpBxkB,EAASskB,EAAY1J,OAAS,IAAI7nB,MAAM,mBAC1C,EAIA,MAAM6M,EAAS8kB,EAAMgB,cAAgB,gBAAkB,aACjDM,EAAYpd,EAAQ6M,QAAU,OAAS,OAE7CiP,EAAM9kB,GAAQolB,EAAUgB,GAAWjC,UAAY,SAAUE,GACvD,MAAM0B,EAAS1B,EAAGpX,OAAOuH,OAErBuR,IAEFjB,EAAMjS,OAAOkT,EAAOhd,KAAKob,UAAY,YAC/Bnb,EAAQ+C,OAAS,KAAOG,EAAQlD,EAAQ+C,QAC1Cga,EAAOC,UAEX,EAEJ,CACF,kCChCA,MAAMtS,EAAc,IAAIC,YAExBta,EAAOnF,QAAU,SAAUmjB,GACzB,OAAIA,aAAgBjiB,WACXiiB,EACEA,aAAgBZ,YAClB,IAAIrhB,WAAWiiB,GAGf3D,EAAY/J,OAAO0N,EAE9B,kCCTAhe,EAAOnF,QAAU,SAAyB8U,GACxC,MAAMqd,OAAwB/jB,IAAhB0G,EAAQ2L,IAAoB3L,EAAQ2L,SAAqBrS,IAAf0G,EAAQ4L,GAAmB5L,EAAQ4L,QAAKtS,EAC1FgkB,OAAwBhkB,IAAhB0G,EAAQ6L,IAAoB7L,EAAQ6L,SAAqBvS,IAAf0G,EAAQ8L,GAAmB9L,EAAQ8L,QAAKxS,EAC1FikB,OAAiCjkB,IAAhB0G,EAAQ2L,IACzB6R,OAAiClkB,IAAhB0G,EAAQ6L,IAE/B,YAAcvS,IAAV+jB,QAAiC/jB,IAAVgkB,EAClBG,YAAYC,MAAML,EAAOC,EAAOC,EAAgBC,QACpClkB,IAAV+jB,EACFI,YAAYE,WAAWN,EAAOE,QAClBjkB,IAAVgkB,EACFG,YAAYpS,WAAWiS,EAAOE,GAE9B,IAEX,qDCTI1jB,EAAS,EAAQ,OACjBgT,EAAU,EAAQ,OAClBC,EACiB,mBAAX3kB,QAAkD,mBAAlBA,OAAY,IAChDA,OAAY,IAAE,8BACd,KAEN8C,EAAQ8I,OAASA,EACjB9I,EAAQ8hB,WA2TR,SAAqBnkB,IACdA,GAAUA,IACbA,EAAS,GAEX,OAAOmL,EAAO5I,OAAOvC,EACvB,EA/TAqC,EAAQ+hB,kBAAoB,GAE5B,IAAIC,EAAe,WAwDnB,SAASC,EAActkB,GACrB,GAAIA,EAASqkB,EACX,MAAM,IAAItZ,WAAW,cAAgB/K,EAAS,kCAGhD,IAAI8D,EAAM,IAAIP,WAAWvD,GAEzB,OADAyH,OAAO8c,eAAezgB,EAAKqH,EAAOvJ,WAC3BkC,CACT,CAYA,SAASqH,EAAQqZ,EAAKC,EAAkBzkB,GAEtC,GAAmB,iBAARwkB,EAAkB,CAC3B,GAAgC,iBAArBC,EACT,MAAM,IAAI1W,UACR,sEAGJ,OAAOkG,EAAYuQ,EACrB,CACA,OAAOjV,EAAKiV,EAAKC,EAAkBzkB,EACrC,CAIA,SAASuP,EAAM3H,EAAO6c,EAAkBzkB,GACtC,GAAqB,iBAAV4H,EACT,OAuHJ,SAAqB6E,EAAQuH,GACH,iBAAbA,GAAsC,KAAbA,IAClCA,EAAW,QAGb,IAAK7I,EAAOuZ,WAAW1Q,GACrB,MAAM,IAAIjG,UAAU,qBAAuBiG,GAG7C,IAAIhU,EAAwC,EAA/B4V,EAAWnJ,EAAQuH,GAC5BlQ,EAAMwgB,EAAatkB,GAEnB2kB,EAAS7gB,EAAIsR,MAAM3I,EAAQuH,GAE3B2Q,IAAW3kB,IAIb8D,EAAMA,EAAIjC,MAAM,EAAG8iB,IAGrB,OAAO7gB,CACT,CA7IW4L,CAAW9H,EAAO6c,GAG3B,GAAIG,YAAYC,OAAOjd,GACrB,OAoJJ,SAAwBkd,GACtB,GAAIC,EAAWD,EAAWvhB,YAAa,CACrC,IAAIoS,EAAO,IAAIpS,WAAWuhB,GAC1B,OAAOE,EAAgBrP,EAAKjW,OAAQiW,EAAKsP,WAAYtP,EAAKC,WAC5D,CACA,OAAOsP,EAAcJ,EACvB,CA1JWK,CAAcvd,GAGvB,GAAa,MAATA,EACF,MAAM,IAAImG,UACR,yHACiDnG,GAIrD,GAAImd,EAAWnd,EAAOgd,cACjBhd,GAASmd,EAAWnd,EAAMlI,OAAQklB,aACrC,OAAOI,EAAgBpd,EAAO6c,EAAkBzkB,GAGlD,GAAiC,oBAAtBolB,oBACNL,EAAWnd,EAAOwd,oBAClBxd,GAASmd,EAAWnd,EAAMlI,OAAQ0lB,oBACrC,OAAOJ,EAAgBpd,EAAO6c,EAAkBzkB,GAGlD,GAAqB,iBAAV4H,EACT,MAAM,IAAImG,UACR,yEAIJ,IAAIjF,EAAUlB,EAAMkB,SAAWlB,EAAMkB,UACrC,GAAe,MAAXA,GAAmBA,IAAYlB,EACjC,OAAOuD,EAAOoE,KAAKzG,EAAS2b,EAAkBzkB,GAGhD,IAAIqlB,EAoJN,SAAqBhT,GACnB,GAAIlH,EAAOC,SAASiH,GAAM,CACxB,IAAItN,EAA4B,EAAtBugB,EAAQjT,EAAIrS,QAClB8D,EAAMwgB,EAAavf,GAEvB,OAAmB,IAAfjB,EAAI9D,QAIRqS,EAAIsD,KAAK7R,EAAK,EAAG,EAAGiB,GAHXjB,CAKX,CAEA,QAAmB2M,IAAf4B,EAAIrS,OACN,MAA0B,iBAAfqS,EAAIrS,QAAuBulB,EAAYlT,EAAIrS,QAC7CskB,EAAa,GAEfY,EAAc7S,GAGvB,GAAiB,WAAbA,EAAI4F,MAAqBtW,MAAMuJ,QAAQmH,EAAImT,MAC7C,OAAON,EAAc7S,EAAImT,KAE7B,CA3KUC,CAAW7d,GACnB,GAAIyd,EAAG,OAAOA,EAEd,GAAsB,oBAAX9lB,QAAgD,MAAtBA,OAAOmmB,aACH,mBAA9B9d,EAAMrI,OAAOmmB,aACtB,OAAOva,EAAOoE,KACZ3H,EAAMrI,OAAOmmB,aAAa,UAAWjB,EAAkBzkB,GAI3D,MAAM,IAAI+N,UACR,yHACiDnG,EAErD,CAmBA,SAAS+d,EAAYnlB,GACnB,GAAoB,iBAATA,EACT,MAAM,IAAIuN,UAAU,0CACf,GAAIvN,EAAO,EAChB,MAAM,IAAIuK,WAAW,cAAgBvK,EAAO,iCAEhD,CA0BA,SAASyT,EAAazT,GAEpB,OADAmlB,EAAWnlB,GACJ8jB,EAAa9jB,EAAO,EAAI,EAAoB,EAAhB8kB,EAAQ9kB,GAC7C,CAuCA,SAAS0kB,EAAeU,GAGtB,IAFA,IAAI5lB,EAAS4lB,EAAM5lB,OAAS,EAAI,EAA4B,EAAxBslB,EAAQM,EAAM5lB,QAC9C8D,EAAMwgB,EAAatkB,GACdqE,EAAI,EAAGA,EAAIrE,EAAQqE,GAAK,EAC/BP,EAAIO,GAAgB,IAAXuhB,EAAMvhB,GAEjB,OAAOP,CACT,CAUA,SAASkhB,EAAiBY,EAAOX,EAAYjlB,GAC3C,GAAIilB,EAAa,GAAKW,EAAMhQ,WAAaqP,EACvC,MAAM,IAAIla,WAAW,wCAGvB,GAAI6a,EAAMhQ,WAAaqP,GAAcjlB,GAAU,GAC7C,MAAM,IAAI+K,WAAW,wCAGvB,IAAIjH,EAYJ,OAVEA,OADiB2M,IAAfwU,QAAuCxU,IAAXzQ,EACxB,IAAIuD,WAAWqiB,QACDnV,IAAXzQ,EACH,IAAIuD,WAAWqiB,EAAOX,GAEtB,IAAI1hB,WAAWqiB,EAAOX,EAAYjlB,GAI1CyH,OAAO8c,eAAezgB,EAAKqH,EAAOvJ,WAE3BkC,CACT,CA2BA,SAASwhB,EAAStlB,GAGhB,GAAIA,GAAUqkB,EACZ,MAAM,IAAItZ,WAAW,0DACasZ,EAAa3W,SAAS,IAAM,UAEhE,OAAgB,EAAT1N,CACT,CAqGA,SAAS4V,EAAYnJ,EAAQuH,GAC3B,GAAI7I,EAAOC,SAASqB,GAClB,OAAOA,EAAOzM,OAEhB,GAAI4kB,YAAYC,OAAOpY,IAAWsY,EAAWtY,EAAQmY,aACnD,OAAOnY,EAAOmJ,WAEhB,GAAsB,iBAAXnJ,EACT,MAAM,IAAIsB,UACR,kGAC0BtB,GAI9B,IAAI1H,EAAM0H,EAAOzM,OACb6lB,EAAa9jB,UAAU/B,OAAS,IAAsB,IAAjB+B,UAAU,GACnD,IAAK8jB,GAAqB,IAAR9gB,EAAW,OAAO,EAIpC,IADA,IAAI+gB,GAAc,IAEhB,OAAQ9R,GACN,IAAK,QACL,IAAK,SACL,IAAK,SACH,OAAOjP,EACT,IAAK,OACL,IAAK,QACH,OAAOghB,EAAYtZ,GAAQzM,OAC7B,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAa,EAAN+E,EACT,IAAK,MACH,OAAOA,IAAQ,EACjB,IAAK,SACH,OAAOihB,EAAcvZ,GAAQzM,OAC/B,QACE,GAAI8lB,EACF,OAAOD,GAAa,EAAIE,EAAYtZ,GAAQzM,OAE9CgU,GAAY,GAAKA,GAAUV,cAC3BwS,GAAc,EAGtB,CAGA,SAASG,EAAcjS,EAAUzH,EAAOb,GACtC,IAAIoa,GAAc,EAclB,SALcrV,IAAVlE,GAAuBA,EAAQ,KACjCA,EAAQ,GAINA,EAAQxD,KAAK/I,OACf,MAAO,GAOT,SAJYyQ,IAAR/E,GAAqBA,EAAM3C,KAAK/I,UAClC0L,EAAM3C,KAAK/I,QAGT0L,GAAO,EACT,MAAO,GAOT,IAHAA,KAAS,KACTa,KAAW,GAGT,MAAO,GAKT,IAFKyH,IAAUA,EAAW,UAGxB,OAAQA,GACN,IAAK,MACH,OAAOkS,EAASnd,KAAMwD,EAAOb,GAE/B,IAAK,OACL,IAAK,QACH,OAAO8B,EAAUzE,KAAMwD,EAAOb,GAEhC,IAAK,QACH,OAAOya,EAAWpd,KAAMwD,EAAOb,GAEjC,IAAK,SACL,IAAK,SACH,OAAO0a,EAAYrd,KAAMwD,EAAOb,GAElC,IAAK,SACH,OAAO2a,EAAYtd,KAAMwD,EAAOb,GAElC,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO4a,EAAavd,KAAMwD,EAAOb,GAEnC,QACE,GAAIoa,EAAa,MAAM,IAAI/X,UAAU,qBAAuBiG,GAC5DA,GAAYA,EAAW,IAAIV,cAC3BwS,GAAc,EAGtB,CAUA,SAASS,EAAMlB,EAAG7jB,EAAGglB,GACnB,IAAIniB,EAAIghB,EAAE7jB,GACV6jB,EAAE7jB,GAAK6jB,EAAEmB,GACTnB,EAAEmB,GAAKniB,CACT,CA2IA,SAASoiB,EAAsB/mB,EAAQyU,EAAK8Q,EAAYjR,EAAU0S,GAEhE,GAAsB,IAAlBhnB,EAAOM,OAAc,OAAQ,EAmBjC,GAhB0B,iBAAfilB,GACTjR,EAAWiR,EACXA,EAAa,GACJA,EAAa,WACtBA,EAAa,WACJA,GAAc,aACvBA,GAAc,YAGZM,EADJN,GAAcA,KAGZA,EAAayB,EAAM,EAAKhnB,EAAOM,OAAS,GAItCilB,EAAa,IAAGA,EAAavlB,EAAOM,OAASilB,GAC7CA,GAAcvlB,EAAOM,OAAQ,CAC/B,GAAI0mB,EAAK,OAAQ,EACZzB,EAAavlB,EAAOM,OAAS,CACpC,MAAO,GAAIilB,EAAa,EAAG,CACzB,IAAIyB,EACC,OAAQ,EADJzB,EAAa,CAExB,CAQA,GALmB,iBAAR9Q,IACTA,EAAMhJ,EAAOoE,KAAK4E,EAAKH,IAIrB7I,EAAOC,SAAS+I,GAElB,OAAmB,IAAfA,EAAInU,QACE,EAEH2mB,EAAajnB,EAAQyU,EAAK8Q,EAAYjR,EAAU0S,GAClD,GAAmB,iBAARvS,EAEhB,OADAA,GAAY,IACgC,mBAAjC5Q,WAAW3B,UAAU0G,QAC1Boe,EACKnjB,WAAW3B,UAAU0G,QAAQxG,KAAKpC,EAAQyU,EAAK8Q,GAE/C1hB,WAAW3B,UAAUglB,YAAY9kB,KAAKpC,EAAQyU,EAAK8Q,GAGvD0B,EAAajnB,EAAQ,CAACyU,GAAM8Q,EAAYjR,EAAU0S,GAG3D,MAAM,IAAI3Y,UAAU,uCACtB,CAEA,SAAS4Y,EAAc/iB,EAAKuQ,EAAK8Q,EAAYjR,EAAU0S,GACrD,IA0BIriB,EA1BAwiB,EAAY,EACZC,EAAYljB,EAAI5D,OAChB+mB,EAAY5S,EAAInU,OAEpB,QAAiByQ,IAAbuD,IAEe,UADjBA,EAAW9T,OAAO8T,GAAUV,gBACY,UAAbU,GACV,YAAbA,GAAuC,aAAbA,GAAyB,CACrD,GAAIpQ,EAAI5D,OAAS,GAAKmU,EAAInU,OAAS,EACjC,OAAQ,EAEV6mB,EAAY,EACZC,GAAa,EACbC,GAAa,EACb9B,GAAc,CAChB,CAGF,SAASvY,EAAM5I,EAAKO,GAClB,OAAkB,IAAdwiB,EACK/iB,EAAIO,GAEJP,EAAIkjB,aAAa3iB,EAAIwiB,EAEhC,CAGA,GAAIH,EAAK,CACP,IAAIO,GAAc,EAClB,IAAK5iB,EAAI4gB,EAAY5gB,EAAIyiB,EAAWziB,IAClC,GAAIqI,EAAK9I,EAAKS,KAAOqI,EAAKyH,GAAqB,IAAhB8S,EAAoB,EAAI5iB,EAAI4iB,IAEzD,IADoB,IAAhBA,IAAmBA,EAAa5iB,GAChCA,EAAI4iB,EAAa,IAAMF,EAAW,OAAOE,EAAaJ,OAEtC,IAAhBI,IAAmB5iB,GAAKA,EAAI4iB,GAChCA,GAAc,CAGpB,MAEE,IADIhC,EAAa8B,EAAYD,IAAW7B,EAAa6B,EAAYC,GAC5D1iB,EAAI4gB,EAAY5gB,GAAK,EAAGA,IAAK,CAEhC,IADA,IAAI6iB,GAAQ,EACHC,EAAI,EAAGA,EAAIJ,EAAWI,IAC7B,GAAIza,EAAK9I,EAAKS,EAAI8iB,KAAOza,EAAKyH,EAAKgT,GAAI,CACrCD,GAAQ,EACR,KACF,CAEF,GAAIA,EAAO,OAAO7iB,CACpB,CAGF,OAAQ,CACV,CAcA,SAAS+iB,EAAUtjB,EAAK2I,EAAQxM,EAAQD,GACtCC,EAAS8R,OAAO9R,IAAW,EAC3B,IAAIonB,EAAYvjB,EAAI9D,OAASC,EACxBD,GAGHA,EAAS+R,OAAO/R,IACHqnB,IACXrnB,EAASqnB,GAJXrnB,EAASqnB,EAQX,IAAIC,EAAS7a,EAAOzM,OAEhBA,EAASsnB,EAAS,IACpBtnB,EAASsnB,EAAS,GAEpB,IAAK,IAAIjjB,EAAI,EAAGA,EAAIrE,IAAUqE,EAAG,CAC/B,IAAIkjB,EAAS9X,SAAShD,EAAO+a,OAAW,EAAJnjB,EAAO,GAAI,IAC/C,GAAIkhB,EAAYgC,GAAS,OAAOljB,EAChCP,EAAI7D,EAASoE,GAAKkjB,CACpB,CACA,OAAOljB,CACT,CAEA,SAASkO,EAAWzO,EAAK2I,EAAQxM,EAAQD,GACvC,OAAOynB,EAAW1B,EAAYtZ,EAAQ3I,EAAI9D,OAASC,GAAS6D,EAAK7D,EAAQD,EAC3E,CAEA,SAAS0nB,EAAY5jB,EAAK2I,EAAQxM,EAAQD,GACxC,OAAOynB,EAk4BT,SAAuBrjB,GAErB,IADA,IAAIujB,EAAY,GACPtjB,EAAI,EAAGA,EAAID,EAAIpE,SAAUqE,EAEhCsjB,EAAUlnB,KAAyB,IAApB2D,EAAIG,WAAWF,IAEhC,OAAOsjB,CACT,CAz4BoBC,CAAanb,GAAS3I,EAAK7D,EAAQD,EACvD,CAEA,SAAS6nB,EAAa/jB,EAAK2I,EAAQxM,EAAQD,GACzC,OAAOynB,EAAWzB,EAAcvZ,GAAS3I,EAAK7D,EAAQD,EACxD,CAEA,SAAS8nB,EAAWhkB,EAAK2I,EAAQxM,EAAQD,GACvC,OAAOynB,EAm4BT,SAAyBrjB,EAAK2jB,GAG5B,IAFA,IAAIC,EAAGxc,EAAID,EACPoc,EAAY,GACPtjB,EAAI,EAAGA,EAAID,EAAIpE,WACjB+nB,GAAS,GAAK,KADa1jB,EAIhCmH,GADAwc,EAAI5jB,EAAIG,WAAWF,KACT,EACVkH,EAAKyc,EAAI,IACTL,EAAUlnB,KAAK8K,GACfoc,EAAUlnB,KAAK+K,GAGjB,OAAOmc,CACT,CAj5BoBM,CAAexb,EAAQ3I,EAAI9D,OAASC,GAAS6D,EAAK7D,EAAQD,EAC9E,CA8EA,SAASqmB,EAAaviB,EAAKyI,EAAOb,GAChC,OAAc,IAAVa,GAAeb,IAAQ5H,EAAI9D,OACtBiR,EAAOiX,cAAcpkB,GAErBmN,EAAOiX,cAAcpkB,EAAIjC,MAAM0K,EAAOb,GAEjD,CAEA,SAAS8B,EAAW1J,EAAKyI,EAAOb,GAC9BA,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAI3B,IAHA,IAAIyc,EAAM,GAEN9jB,EAAIkI,EACDlI,EAAIqH,GAAK,CACd,IAWM6c,EAAYC,EAAWC,EAAYC,EAXrCN,EAAYtkB,EAAIO,GAChBgkB,EAAY,KACZC,EAAoBF,EAAY,IAChC,EACCA,EAAY,IACT,EACCA,EAAY,IACT,EACA,EAEZ,GAAI/jB,EAAIikB,GAAoB5c,EAG1B,OAAQ4c,GACN,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EAEyB,MAAV,KADlBG,EAAazkB,EAAIO,EAAI,OAEnBqkB,GAA6B,GAAZN,IAAqB,EAAoB,GAAbG,GACzB,MAClBF,EAAYK,GAGhB,MACF,KAAK,EACHH,EAAazkB,EAAIO,EAAI,GACrBmkB,EAAY1kB,EAAIO,EAAI,GACQ,MAAV,IAAbkkB,IAAsD,MAAV,IAAZC,KACnCE,GAA6B,GAAZN,IAAoB,IAAoB,GAAbG,IAAsB,EAAmB,GAAZC,GACrD,OAAUE,EAAgB,OAAUA,EAAgB,SACtEL,EAAYK,GAGhB,MACF,KAAK,EACHH,EAAazkB,EAAIO,EAAI,GACrBmkB,EAAY1kB,EAAIO,EAAI,GACpBokB,EAAa3kB,EAAIO,EAAI,GACO,MAAV,IAAbkkB,IAAsD,MAAV,IAAZC,IAAsD,MAAV,IAAbC,KAClEC,GAA6B,GAAZN,IAAoB,IAAqB,GAAbG,IAAsB,IAAmB,GAAZC,IAAqB,EAAoB,GAAbC,GAClF,OAAUC,EAAgB,UAC5CL,EAAYK,GAMJ,OAAdL,GAGFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QAErBA,GAAa,MACbF,EAAI1nB,KAAK4nB,IAAc,GAAK,KAAQ,OACpCA,EAAY,MAAqB,KAAZA,GAGvBF,EAAI1nB,KAAK4nB,GACThkB,GAAKikB,CACP,CAEA,OAQF,SAAgCK,GAC9B,IAAI5jB,EAAM4jB,EAAW3oB,OACrB,GAAI+E,GAAO6jB,EACT,OAAO1oB,OAAOC,aAAaC,MAAMF,OAAQyoB,GAI3C,IAAIR,EAAM,GACN9jB,EAAI,EACR,KAAOA,EAAIU,GACTojB,GAAOjoB,OAAOC,aAAaC,MACzBF,OACAyoB,EAAW9mB,MAAMwC,EAAGA,GAAKukB,IAG7B,OAAOT,CACT,CAxBSU,CAAsBV,EAC/B,CA3+BA9lB,EAAQymB,WAAazE,EAgBrBlZ,EAAO4d,oBAUP,WAEE,IACE,IAAInlB,EAAM,IAAIL,WAAW,GACrBylB,EAAQ,CAAEC,IAAK,WAAc,OAAO,EAAG,GAG3C,OAFAxhB,OAAO8c,eAAeyE,EAAOzlB,WAAW3B,WACxC6F,OAAO8c,eAAe3gB,EAAKolB,GACN,KAAdplB,EAAIqlB,KACb,CAAE,MAAOzW,GACP,OAAO,CACT,CACF,CArB6B0W,GAExB/d,EAAO4d,0BAA0C,IAAZtnB,GACb,mBAAlBA,EAAQ0nB,OACjB1nB,EAAQ0nB,MACN,iJAkBJ1hB,OAAO2B,eAAe+B,EAAOvJ,UAAW,SAAU,CAChD+H,YAAY,EACZD,IAAK,WACH,GAAKyB,EAAOC,SAASrC,MACrB,OAAOA,KAAKrJ,MACd,IAGF+H,OAAO2B,eAAe+B,EAAOvJ,UAAW,SAAU,CAChD+H,YAAY,EACZD,IAAK,WACH,GAAKyB,EAAOC,SAASrC,MACrB,OAAOA,KAAKkc,UACd,IAoCF9Z,EAAOie,SAAW,KAgElBje,EAAOoE,KAAO,SAAU3H,EAAO6c,EAAkBzkB,GAC/C,OAAOuP,EAAK3H,EAAO6c,EAAkBzkB,EACvC,EAIAyH,OAAO8c,eAAepZ,EAAOvJ,UAAW2B,WAAW3B,WACnD6F,OAAO8c,eAAepZ,EAAQ5H,YA8B9B4H,EAAO5I,MAAQ,SAAU/B,EAAMwf,EAAMhM,GACnC,OArBF,SAAgBxT,EAAMwf,EAAMhM,GAE1B,OADA2R,EAAWnlB,GACPA,GAAQ,EACH8jB,EAAa9jB,QAETiQ,IAATuP,EAIyB,iBAAbhM,EACVsQ,EAAa9jB,GAAMwf,KAAKA,EAAMhM,GAC9BsQ,EAAa9jB,GAAMwf,KAAKA,GAEvBsE,EAAa9jB,EACtB,CAOS+B,CAAM/B,EAAMwf,EAAMhM,EAC3B,EAUA7I,EAAO8I,YAAc,SAAUzT,GAC7B,OAAOyT,EAAYzT,EACrB,EAIA2K,EAAOke,gBAAkB,SAAU7oB,GACjC,OAAOyT,EAAYzT,EACrB,EA6GA2K,EAAOC,SAAW,SAAmBia,GACnC,OAAY,MAALA,IAA6B,IAAhBA,EAAEiE,WACpBjE,IAAMla,EAAOvJ,SACjB,EAEAuJ,EAAOoe,QAAU,SAAkBC,EAAGnE,GAGpC,GAFIN,EAAWyE,EAAGjmB,cAAaimB,EAAIre,EAAOoE,KAAKia,EAAGA,EAAEvpB,OAAQupB,EAAE5T,aAC1DmP,EAAWM,EAAG9hB,cAAa8hB,EAAIla,EAAOoE,KAAK8V,EAAGA,EAAEplB,OAAQolB,EAAEzP,cACzDzK,EAAOC,SAASoe,KAAOre,EAAOC,SAASia,GAC1C,MAAM,IAAItX,UACR,yEAIJ,GAAIyb,IAAMnE,EAAG,OAAO,EAKpB,IAHA,IAAIhD,EAAImH,EAAExpB,OACNypB,EAAIpE,EAAErlB,OAEDqE,EAAI,EAAGU,EAAM/C,KAAKyL,IAAI4U,EAAGoH,GAAIplB,EAAIU,IAAOV,EAC/C,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GAAI,CACjBge,EAAImH,EAAEnlB,GACNolB,EAAIpE,EAAEhhB,GACN,KACF,CAGF,OAAIge,EAAIoH,GAAW,EACfA,EAAIpH,EAAU,EACX,CACT,EAEAlX,EAAOuZ,WAAa,SAAqB1Q,GACvC,OAAQ9T,OAAO8T,GAAUV,eACvB,IAAK,MACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO,EACT,QACE,OAAO,EAEb,EAEAnI,EAAOyX,OAAS,SAAiB8G,EAAM1pB,GACrC,IAAK2B,MAAMuJ,QAAQwe,GACjB,MAAM,IAAI3b,UAAU,+CAGtB,GAAoB,IAAhB2b,EAAK1pB,OACP,OAAOmL,EAAO5I,MAAM,GAGtB,IAAI8B,EACJ,QAAeoM,IAAXzQ,EAEF,IADAA,EAAS,EACJqE,EAAI,EAAGA,EAAIqlB,EAAK1pB,SAAUqE,EAC7BrE,GAAU0pB,EAAKrlB,GAAGrE,OAItB,IAAIN,EAASyL,EAAO8I,YAAYjU,GAC5BgL,EAAM,EACV,IAAK3G,EAAI,EAAGA,EAAIqlB,EAAK1pB,SAAUqE,EAAG,CAChC,IAAIP,EAAM4lB,EAAKrlB,GACf,GAAI0gB,EAAWjhB,EAAKP,YACdyH,EAAMlH,EAAI9D,OAASN,EAAOM,OAC5BmL,EAAOoE,KAAKzL,GAAK6R,KAAKjW,EAAQsL,GAE9BzH,WAAW3B,UAAUgD,IAAI9C,KACvBpC,EACAoE,EACAkH,OAGC,KAAKG,EAAOC,SAAStH,GAC1B,MAAM,IAAIiK,UAAU,+CAEpBjK,EAAI6R,KAAKjW,EAAQsL,EACnB,CACAA,GAAOlH,EAAI9D,MACb,CACA,OAAON,CACT,EAiDAyL,EAAOyK,WAAaA,EA8EpBzK,EAAOvJ,UAAU0nB,WAAY,EAQ7Bne,EAAOvJ,UAAU+nB,OAAS,WACxB,IAAI5kB,EAAMgE,KAAK/I,OACf,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAEpB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAUgoB,OAAS,WACxB,IAAI7kB,EAAMgE,KAAK/I,OACf,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAClBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GAExB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAUioB,OAAS,WACxB,IAAI9kB,EAAMgE,KAAK/I,OACf,GAAI+E,EAAM,GAAM,EACd,MAAM,IAAIgG,WAAW,6CAEvB,IAAK,IAAI1G,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EAC5BkiB,EAAKxd,KAAM1E,EAAGA,EAAI,GAClBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GACtBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GACtBkiB,EAAKxd,KAAM1E,EAAI,EAAGA,EAAI,GAExB,OAAO0E,IACT,EAEAoC,EAAOvJ,UAAU8L,SAAW,WAC1B,IAAI1N,EAAS+I,KAAK/I,OAClB,OAAe,IAAXA,EAAqB,GACA,IAArB+B,UAAU/B,OAAqBwN,EAAUzE,KAAM,EAAG/I,GAC/CimB,EAAa7lB,MAAM2I,KAAMhH,UAClC,EAEAoJ,EAAOvJ,UAAUkoB,eAAiB3e,EAAOvJ,UAAU8L,SAEnDvC,EAAOvJ,UAAUmoB,OAAS,SAAiB1E,GACzC,IAAKla,EAAOC,SAASia,GAAI,MAAM,IAAItX,UAAU,6BAC7C,OAAIhF,OAASsc,GACsB,IAA5Bla,EAAOoe,QAAQxgB,KAAMsc,EAC9B,EAEAla,EAAOvJ,UAAUooB,QAAU,WACzB,IAAI5lB,EAAM,GACN6lB,EAAM5nB,EAAQ+hB,kBAGlB,OAFAhgB,EAAM2E,KAAK2E,SAAS,MAAO,EAAGuc,GAAKzgB,QAAQ,UAAW,OAAOyY,OACzDlZ,KAAK/I,OAASiqB,IAAK7lB,GAAO,SACvB,WAAaA,EAAM,GAC5B,EACI8f,IACF/Y,EAAOvJ,UAAUsiB,GAAuB/Y,EAAOvJ,UAAUooB,SAG3D7e,EAAOvJ,UAAU2nB,QAAU,SAAkBnO,EAAQ7O,EAAOb,EAAKwe,EAAWC,GAI1E,GAHIpF,EAAW3J,EAAQ7X,cACrB6X,EAASjQ,EAAOoE,KAAK6L,EAAQA,EAAOnb,OAAQmb,EAAOxF,cAEhDzK,EAAOC,SAASgQ,GACnB,MAAM,IAAIrN,UACR,wFAC2BqN,GAiB/B,QAbc3K,IAAVlE,IACFA,EAAQ,QAEEkE,IAAR/E,IACFA,EAAM0P,EAASA,EAAOpb,OAAS,QAEfyQ,IAAdyZ,IACFA,EAAY,QAEEzZ,IAAZ0Z,IACFA,EAAUphB,KAAK/I,QAGbuM,EAAQ,GAAKb,EAAM0P,EAAOpb,QAAUkqB,EAAY,GAAKC,EAAUphB,KAAK/I,OACtE,MAAM,IAAI+K,WAAW,sBAGvB,GAAImf,GAAaC,GAAW5d,GAASb,EACnC,OAAO,EAET,GAAIwe,GAAaC,EACf,OAAQ,EAEV,GAAI5d,GAASb,EACX,OAAO,EAQT,GAAI3C,OAASqS,EAAQ,OAAO,EAS5B,IAPA,IAAIiH,GAJJ8H,KAAa,IADbD,KAAe,GAMXT,GAPJ/d,KAAS,IADTa,KAAW,GASPxH,EAAM/C,KAAKyL,IAAI4U,EAAGoH,GAElBW,EAAWrhB,KAAKlH,MAAMqoB,EAAWC,GACjCE,EAAajP,EAAOvZ,MAAM0K,EAAOb,GAE5BrH,EAAI,EAAGA,EAAIU,IAAOV,EACzB,GAAI+lB,EAAS/lB,KAAOgmB,EAAWhmB,GAAI,CACjCge,EAAI+H,EAAS/lB,GACbolB,EAAIY,EAAWhmB,GACf,KACF,CAGF,OAAIge,EAAIoH,GAAW,EACfA,EAAIpH,EAAU,EACX,CACT,EA2HAlX,EAAOvJ,UAAU0oB,SAAW,SAAmBnW,EAAK8Q,EAAYjR,GAC9D,OAAoD,IAA7CjL,KAAKT,QAAQ6L,EAAK8Q,EAAYjR,EACvC,EAEA7I,EAAOvJ,UAAU0G,QAAU,SAAkB6L,EAAK8Q,EAAYjR,GAC5D,OAAOyS,EAAqB1d,KAAMoL,EAAK8Q,EAAYjR,GAAU,EAC/D,EAEA7I,EAAOvJ,UAAUglB,YAAc,SAAsBzS,EAAK8Q,EAAYjR,GACpE,OAAOyS,EAAqB1d,KAAMoL,EAAK8Q,EAAYjR,GAAU,EAC/D,EA2CA7I,EAAOvJ,UAAUwT,MAAQ,SAAgB3I,EAAQxM,EAAQD,EAAQgU,GAE/D,QAAevD,IAAXxQ,EACF+T,EAAW,OACXhU,EAAS+I,KAAK/I,OACdC,EAAS,OAEJ,QAAewQ,IAAXzQ,GAA0C,iBAAXC,EACxC+T,EAAW/T,EACXD,EAAS+I,KAAK/I,OACdC,EAAS,MAEJ,KAAI+R,SAAS/R,GAUlB,MAAM,IAAIqB,MACR,2EAVFrB,KAAoB,EAChB+R,SAAShS,IACXA,KAAoB,OACHyQ,IAAbuD,IAAwBA,EAAW,UAEvCA,EAAWhU,EACXA,OAASyQ,EAMb,CAEA,IAAI4W,EAAYte,KAAK/I,OAASC,EAG9B,SAFewQ,IAAXzQ,GAAwBA,EAASqnB,KAAWrnB,EAASqnB,GAEpD5a,EAAOzM,OAAS,IAAMA,EAAS,GAAKC,EAAS,IAAOA,EAAS8I,KAAK/I,OACrE,MAAM,IAAI+K,WAAW,0CAGlBiJ,IAAUA,EAAW,QAG1B,IADA,IAAI8R,GAAc,IAEhB,OAAQ9R,GACN,IAAK,MACH,OAAOoT,EAASre,KAAM0D,EAAQxM,EAAQD,GAExC,IAAK,OACL,IAAK,QACH,OAAOuS,EAAUxJ,KAAM0D,EAAQxM,EAAQD,GAEzC,IAAK,QACL,IAAK,SACL,IAAK,SACH,OAAO0nB,EAAW3e,KAAM0D,EAAQxM,EAAQD,GAE1C,IAAK,SAEH,OAAO6nB,EAAY9e,KAAM0D,EAAQxM,EAAQD,GAE3C,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,WACH,OAAO8nB,EAAU/e,KAAM0D,EAAQxM,EAAQD,GAEzC,QACE,GAAI8lB,EAAa,MAAM,IAAI/X,UAAU,qBAAuBiG,GAC5DA,GAAY,GAAKA,GAAUV,cAC3BwS,GAAc,EAGtB,EAEA3a,EAAOvJ,UAAU2oB,OAAS,WACxB,MAAO,CACLtS,KAAM,SACNuN,KAAM7jB,MAAMC,UAAUC,MAAMC,KAAKiH,KAAKyhB,MAAQzhB,KAAM,GAExD,EAyFA,IAAI6f,EAAuB,KAoB3B,SAASzC,EAAYriB,EAAKyI,EAAOb,GAC/B,IAAI+e,EAAM,GACV/e,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAE3B,IAAK,IAAIrH,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BomB,GAAOvqB,OAAOC,aAAsB,IAAT2D,EAAIO,IAEjC,OAAOomB,CACT,CAEA,SAASrE,EAAatiB,EAAKyI,EAAOb,GAChC,IAAI+e,EAAM,GACV/e,EAAM1J,KAAKyL,IAAI3J,EAAI9D,OAAQ0L,GAE3B,IAAK,IAAIrH,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BomB,GAAOvqB,OAAOC,aAAa2D,EAAIO,IAEjC,OAAOomB,CACT,CAEA,SAASvE,EAAUpiB,EAAKyI,EAAOb,GAC7B,IAAI3G,EAAMjB,EAAI9D,SAETuM,GAASA,EAAQ,KAAGA,EAAQ,KAC5Bb,GAAOA,EAAM,GAAKA,EAAM3G,KAAK2G,EAAM3G,GAGxC,IADA,IAAIC,EAAM,GACDX,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EAC7BW,GAAO0lB,EAAoB5mB,EAAIO,IAEjC,OAAOW,CACT,CAEA,SAASshB,EAAcxiB,EAAKyI,EAAOb,GAIjC,IAHA,IAAIY,EAAQxI,EAAIjC,MAAM0K,EAAOb,GACzByc,EAAM,GAED9jB,EAAI,EAAGA,EAAIiI,EAAMtM,OAAS,EAAGqE,GAAK,EACzC8jB,GAAOjoB,OAAOC,aAAamM,EAAMjI,GAAqB,IAAfiI,EAAMjI,EAAI,IAEnD,OAAO8jB,CACT,CAiCA,SAASwC,EAAa1qB,EAAQ2qB,EAAK5qB,GACjC,GAAKC,EAAS,GAAO,GAAKA,EAAS,EAAG,MAAM,IAAI8K,WAAW,sBAC3D,GAAI9K,EAAS2qB,EAAM5qB,EAAQ,MAAM,IAAI+K,WAAW,wCAClD,CAmLA,SAAS8f,EAAU/mB,EAAK8D,EAAO3H,EAAQ2qB,EAAKX,EAAKxc,GAC/C,IAAKtC,EAAOC,SAAStH,GAAM,MAAM,IAAIiK,UAAU,+CAC/C,GAAInG,EAAQqiB,GAAOriB,EAAQ6F,EAAK,MAAM,IAAI1C,WAAW,qCACrD,GAAI9K,EAAS2qB,EAAM9mB,EAAI9D,OAAQ,MAAM,IAAI+K,WAAW,qBACtD,CA+LA,SAASmgB,EAAcpnB,EAAK8D,EAAO3H,EAAQ2qB,EAAKX,EAAKxc,GACnD,GAAIxN,EAAS2qB,EAAM9mB,EAAI9D,OAAQ,MAAM,IAAI+K,WAAW,sBACpD,GAAI9K,EAAS,EAAG,MAAM,IAAI8K,WAAW,qBACvC,CAEA,SAASogB,EAAYrnB,EAAK8D,EAAO3H,EAAQmrB,EAAcC,GAOrD,OANAzjB,GAASA,EACT3H,KAAoB,EACforB,GACHH,EAAapnB,EAAK8D,EAAO3H,EAAQ,GAEnCgkB,EAAQ7O,MAAMtR,EAAK8D,EAAO3H,EAAQmrB,EAAc,GAAI,GAC7CnrB,EAAS,CAClB,CAUA,SAASqrB,EAAaxnB,EAAK8D,EAAO3H,EAAQmrB,EAAcC,GAOtD,OANAzjB,GAASA,EACT3H,KAAoB,EACforB,GACHH,EAAapnB,EAAK8D,EAAO3H,EAAQ,GAEnCgkB,EAAQ7O,MAAMtR,EAAK8D,EAAO3H,EAAQmrB,EAAc,GAAI,GAC7CnrB,EAAS,CAClB,CAvbAkL,EAAOvJ,UAAUC,MAAQ,SAAgB0K,EAAOb,GAC9C,IAAI3G,EAAMgE,KAAK/I,QACfuM,IAAUA,GAGE,GACVA,GAASxH,GACG,IAAGwH,EAAQ,GACdA,EAAQxH,IACjBwH,EAAQxH,IANV2G,OAAc+E,IAAR/E,EAAoB3G,IAAQ2G,GASxB,GACRA,GAAO3G,GACG,IAAG2G,EAAM,GACVA,EAAM3G,IACf2G,EAAM3G,GAGJ2G,EAAMa,IAAOb,EAAMa,GAEvB,IAAIgf,EAASxiB,KAAK1I,SAASkM,EAAOb,GAIlC,OAFAjE,OAAO8c,eAAegH,EAAQpgB,EAAOvJ,WAE9B2pB,CACT,EAUApgB,EAAOvJ,UAAU4pB,WACjBrgB,EAAOvJ,UAAU6pB,WAAa,SAAqBxrB,EAAQ2V,EAAYyV,GACrEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAKpD,IAHA,IAAImU,EAAMpL,KAAK9I,GACXyrB,EAAM,EACNrnB,EAAI,IACCA,EAAIuR,IAAe8V,GAAO,MACjCvX,GAAOpL,KAAK9I,EAASoE,GAAKqnB,EAG5B,OAAOvX,CACT,EAEAhJ,EAAOvJ,UAAU+pB,WACjBxgB,EAAOvJ,UAAUgqB,WAAa,SAAqB3rB,EAAQ2V,EAAYyV,GACrEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GACHV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAKvC,IAFA,IAAImU,EAAMpL,KAAK9I,IAAW2V,GACtB8V,EAAM,EACH9V,EAAa,IAAM8V,GAAO,MAC/BvX,GAAOpL,KAAK9I,IAAW2V,GAAc8V,EAGvC,OAAOvX,CACT,EAEAhJ,EAAOvJ,UAAUiqB,UACjB1gB,EAAOvJ,UAAUkqB,UAAY,SAAoB7rB,EAAQorB,GAGvD,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpC+I,KAAK9I,EACd,EAEAkL,EAAOvJ,UAAUmqB,aACjB5gB,EAAOvJ,UAAUoqB,aAAe,SAAuB/rB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpC+I,KAAK9I,GAAW8I,KAAK9I,EAAS,IAAM,CAC7C,EAEAkL,EAAOvJ,UAAUqqB,aACjB9gB,EAAOvJ,UAAUolB,aAAe,SAAuB/mB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACnC+I,KAAK9I,IAAW,EAAK8I,KAAK9I,EAAS,EAC7C,EAEAkL,EAAOvJ,UAAUsqB,aACjB/gB,EAAOvJ,UAAUuqB,aAAe,SAAuBlsB,EAAQorB,GAI7D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,SAElC+I,KAAK9I,GACT8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,IAAM,IACD,SAAnB8I,KAAK9I,EAAS,EACrB,EAEAkL,EAAOvJ,UAAUwqB,aACjBjhB,EAAOvJ,UAAUyqB,aAAe,SAAuBpsB,EAAQorB,GAI7D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEpB,SAAf+I,KAAK9I,IACT8I,KAAK9I,EAAS,IAAM,GACrB8I,KAAK9I,EAAS,IAAM,EACrB8I,KAAK9I,EAAS,GAClB,EAEAkL,EAAOvJ,UAAUgrB,UAAY,SAAoB3sB,EAAQ2V,EAAYyV,GACnEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAKpD,IAHA,IAAImU,EAAMpL,KAAK9I,GACXyrB,EAAM,EACNrnB,EAAI,IACCA,EAAIuR,IAAe8V,GAAO,MACjCvX,GAAOpL,KAAK9I,EAASoE,GAAKqnB,EAM5B,OAFIvX,IAFJuX,GAAO,OAESvX,GAAOnS,KAAK6qB,IAAI,EAAG,EAAIjX,IAEhCzB,CACT,EAEAhJ,EAAOvJ,UAAUkrB,UAAY,SAAoB7sB,EAAQ2V,EAAYyV,GACnEprB,KAAoB,EACpB2V,KAA4B,EACvByV,GAAUV,EAAY1qB,EAAQ2V,EAAY7M,KAAK/I,QAKpD,IAHA,IAAIqE,EAAIuR,EACJ8V,EAAM,EACNvX,EAAMpL,KAAK9I,IAAWoE,GACnBA,EAAI,IAAMqnB,GAAO,MACtBvX,GAAOpL,KAAK9I,IAAWoE,GAAKqnB,EAM9B,OAFIvX,IAFJuX,GAAO,OAESvX,GAAOnS,KAAK6qB,IAAI,EAAG,EAAIjX,IAEhCzB,CACT,EAEAhJ,EAAOvJ,UAAUmrB,SAAW,SAAmB9sB,EAAQorB,GAGrD,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACtB,IAAf+I,KAAK9I,IAC0B,GAA5B,IAAO8I,KAAK9I,GAAU,GADK8I,KAAK9I,EAE3C,EAEAkL,EAAOvJ,UAAUorB,YAAc,SAAsB/sB,EAAQorB,GAC3DprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAC3C,IAAImU,EAAMpL,KAAK9I,GAAW8I,KAAK9I,EAAS,IAAM,EAC9C,OAAc,MAANkU,EAAsB,WAANA,EAAmBA,CAC7C,EAEAhJ,EAAOvJ,UAAUqrB,YAAc,SAAsBhtB,EAAQorB,GAC3DprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAC3C,IAAImU,EAAMpL,KAAK9I,EAAS,GAAM8I,KAAK9I,IAAW,EAC9C,OAAc,MAANkU,EAAsB,WAANA,EAAmBA,CAC7C,EAEAhJ,EAAOvJ,UAAUsrB,YAAc,SAAsBjtB,EAAQorB,GAI3D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEnC+I,KAAK9I,GACV8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,IAAM,GACpB8I,KAAK9I,EAAS,IAAM,EACzB,EAEAkL,EAAOvJ,UAAUurB,YAAc,SAAsBltB,EAAQorB,GAI3D,OAHAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QAEnC+I,KAAK9I,IAAW,GACrB8I,KAAK9I,EAAS,IAAM,GACpB8I,KAAK9I,EAAS,IAAM,EACpB8I,KAAK9I,EAAS,EACnB,EAEAkL,EAAOvJ,UAAUuK,YAAc,SAAsBlM,EAAQorB,GAG3D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAM,GAAI,EAC9C,EAEAkL,EAAOvJ,UAAU0rB,YAAc,SAAsBrtB,EAAQorB,GAG3D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAO,GAAI,EAC/C,EAEAkL,EAAOvJ,UAAUyK,aAAe,SAAuBpM,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAM,GAAI,EAC9C,EAEAkL,EAAOvJ,UAAU2rB,aAAe,SAAuBttB,EAAQorB,GAG7D,OAFAprB,KAAoB,EACforB,GAAUV,EAAY1qB,EAAQ,EAAG8I,KAAK/I,QACpCikB,EAAQvX,KAAK3D,KAAM9I,GAAQ,EAAO,GAAI,EAC/C,EAQAkL,EAAOvJ,UAAU4rB,YACjBriB,EAAOvJ,UAAU6rB,YAAc,SAAsB7lB,EAAO3H,EAAQ2V,EAAYyV,IAC9EzjB,GAASA,EACT3H,KAAoB,EACpB2V,KAA4B,EACvByV,IAEHR,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EADf5T,KAAK6qB,IAAI,EAAG,EAAIjX,GAAc,EACO,GAGtD,IAAI8V,EAAM,EACNrnB,EAAI,EAER,IADA0E,KAAK9I,GAAkB,IAAR2H,IACNvD,EAAIuR,IAAe8V,GAAO,MACjC3iB,KAAK9I,EAASoE,GAAMuD,EAAQ8jB,EAAO,IAGrC,OAAOzrB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU8rB,YACjBviB,EAAOvJ,UAAU+rB,YAAc,SAAsB/lB,EAAO3H,EAAQ2V,EAAYyV,IAC9EzjB,GAASA,EACT3H,KAAoB,EACpB2V,KAA4B,EACvByV,IAEHR,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EADf5T,KAAK6qB,IAAI,EAAG,EAAIjX,GAAc,EACO,GAGtD,IAAIvR,EAAIuR,EAAa,EACjB8V,EAAM,EAEV,IADA3iB,KAAK9I,EAASoE,GAAa,IAARuD,IACVvD,GAAK,IAAMqnB,GAAO,MACzB3iB,KAAK9I,EAASoE,GAAMuD,EAAQ8jB,EAAO,IAGrC,OAAOzrB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAUgsB,WACjBziB,EAAOvJ,UAAUisB,WAAa,SAAqBjmB,EAAO3H,EAAQorB,GAKhE,OAJAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,IAAM,GACtD8I,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUksB,cACjB3iB,EAAOvJ,UAAUmsB,cAAgB,SAAwBnmB,EAAO3H,EAAQorB,GAMtE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,MAAQ,GACxD8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUosB,cACjB7iB,EAAOvJ,UAAUqsB,cAAgB,SAAwBrmB,EAAO3H,EAAQorB,GAMtE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,MAAQ,GACxD8I,KAAK9I,GAAW2H,IAAU,EAC1BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUssB,cACjB/iB,EAAOvJ,UAAUusB,cAAgB,SAAwBvmB,EAAO3H,EAAQorB,GAQtE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,WAAY,GAC5D8I,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUwsB,cACjBjjB,EAAOvJ,UAAUysB,cAAgB,SAAwBzmB,EAAO3H,EAAQorB,GAQtE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,WAAY,GAC5D8I,KAAK9I,GAAW2H,IAAU,GAC1BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAU4sB,WAAa,SAAqB5mB,EAAO3H,EAAQ2V,EAAYyV,GAG5E,GAFAzjB,GAASA,EACT3H,KAAoB,GACforB,EAAU,CACb,IAAInR,EAAQlY,KAAK6qB,IAAI,EAAI,EAAIjX,EAAc,GAE3CiV,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EAAYsE,EAAQ,GAAIA,EACxD,CAEA,IAAI7V,EAAI,EACJqnB,EAAM,EACN+C,EAAM,EAEV,IADA1lB,KAAK9I,GAAkB,IAAR2H,IACNvD,EAAIuR,IAAe8V,GAAO,MAC7B9jB,EAAQ,GAAa,IAAR6mB,GAAsC,IAAzB1lB,KAAK9I,EAASoE,EAAI,KAC9CoqB,EAAM,GAER1lB,KAAK9I,EAASoE,IAAOuD,EAAQ8jB,GAAQ,GAAK+C,EAAM,IAGlD,OAAOxuB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU8sB,WAAa,SAAqB9mB,EAAO3H,EAAQ2V,EAAYyV,GAG5E,GAFAzjB,GAASA,EACT3H,KAAoB,GACforB,EAAU,CACb,IAAInR,EAAQlY,KAAK6qB,IAAI,EAAI,EAAIjX,EAAc,GAE3CiV,EAAS9hB,KAAMnB,EAAO3H,EAAQ2V,EAAYsE,EAAQ,GAAIA,EACxD,CAEA,IAAI7V,EAAIuR,EAAa,EACjB8V,EAAM,EACN+C,EAAM,EAEV,IADA1lB,KAAK9I,EAASoE,GAAa,IAARuD,IACVvD,GAAK,IAAMqnB,GAAO,MACrB9jB,EAAQ,GAAa,IAAR6mB,GAAsC,IAAzB1lB,KAAK9I,EAASoE,EAAI,KAC9CoqB,EAAM,GAER1lB,KAAK9I,EAASoE,IAAOuD,EAAQ8jB,GAAQ,GAAK+C,EAAM,IAGlD,OAAOxuB,EAAS2V,CAClB,EAEAzK,EAAOvJ,UAAU+sB,UAAY,SAAoB/mB,EAAO3H,EAAQorB,GAM9D,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,KAAO,KACnD2H,EAAQ,IAAGA,EAAQ,IAAOA,EAAQ,GACtCmB,KAAK9I,GAAmB,IAAR2H,EACT3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUgtB,aAAe,SAAuBhnB,EAAO3H,EAAQorB,GAMpE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,OAAS,OACzD8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUitB,aAAe,SAAuBjnB,EAAO3H,EAAQorB,GAMpE,OALAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,OAAS,OACzD8I,KAAK9I,GAAW2H,IAAU,EAC1BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUktB,aAAe,SAAuBlnB,EAAO3H,EAAQorB,GAQpE,OAPAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,YAAa,YAC7D8I,KAAK9I,GAAmB,IAAR2H,EAChBmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,GACvB3H,EAAS,CAClB,EAEAkL,EAAOvJ,UAAUmtB,aAAe,SAAuBnnB,EAAO3H,EAAQorB,GASpE,OARAzjB,GAASA,EACT3H,KAAoB,EACforB,GAAUR,EAAS9hB,KAAMnB,EAAO3H,EAAQ,EAAG,YAAa,YACzD2H,EAAQ,IAAGA,EAAQ,WAAaA,EAAQ,GAC5CmB,KAAK9I,GAAW2H,IAAU,GAC1BmB,KAAK9I,EAAS,GAAM2H,IAAU,GAC9BmB,KAAK9I,EAAS,GAAM2H,IAAU,EAC9BmB,KAAK9I,EAAS,GAAc,IAAR2H,EACb3H,EAAS,CAClB,EAiBAkL,EAAOvJ,UAAUoT,aAAe,SAAuBpN,EAAO3H,EAAQorB,GACpE,OAAOF,EAAWpiB,KAAMnB,EAAO3H,GAAQ,EAAMorB,EAC/C,EAEAlgB,EAAOvJ,UAAUstB,aAAe,SAAuBtnB,EAAO3H,EAAQorB,GACpE,OAAOF,EAAWpiB,KAAMnB,EAAO3H,GAAQ,EAAOorB,EAChD,EAYAlgB,EAAOvJ,UAAUqT,cAAgB,SAAwBrN,EAAO3H,EAAQorB,GACtE,OAAOC,EAAYviB,KAAMnB,EAAO3H,GAAQ,EAAMorB,EAChD,EAEAlgB,EAAOvJ,UAAUutB,cAAgB,SAAwBvnB,EAAO3H,EAAQorB,GACtE,OAAOC,EAAYviB,KAAMnB,EAAO3H,GAAQ,EAAOorB,EACjD,EAGAlgB,EAAOvJ,UAAU+T,KAAO,SAAeyF,EAAQgU,EAAa7iB,EAAOb,GACjE,IAAKP,EAAOC,SAASgQ,GAAS,MAAM,IAAIrN,UAAU,+BAQlD,GAPKxB,IAAOA,EAAQ,GACfb,GAAe,IAARA,IAAWA,EAAM3C,KAAK/I,QAC9BovB,GAAehU,EAAOpb,SAAQovB,EAAchU,EAAOpb,QAClDovB,IAAaA,EAAc,GAC5B1jB,EAAM,GAAKA,EAAMa,IAAOb,EAAMa,GAG9Bb,IAAQa,EAAO,OAAO,EAC1B,GAAsB,IAAlB6O,EAAOpb,QAAgC,IAAhB+I,KAAK/I,OAAc,OAAO,EAGrD,GAAIovB,EAAc,EAChB,MAAM,IAAIrkB,WAAW,6BAEvB,GAAIwB,EAAQ,GAAKA,GAASxD,KAAK/I,OAAQ,MAAM,IAAI+K,WAAW,sBAC5D,GAAIW,EAAM,EAAG,MAAM,IAAIX,WAAW,2BAG9BW,EAAM3C,KAAK/I,SAAQ0L,EAAM3C,KAAK/I,QAC9Bob,EAAOpb,OAASovB,EAAc1jB,EAAMa,IACtCb,EAAM0P,EAAOpb,OAASovB,EAAc7iB,GAGtC,IAAIxH,EAAM2G,EAAMa,EAahB,OAXIxD,OAASqS,GAAqD,mBAApC7X,WAAW3B,UAAUytB,WAEjDtmB,KAAKsmB,WAAWD,EAAa7iB,EAAOb,GAEpCnI,WAAW3B,UAAUgD,IAAI9C,KACvBsZ,EACArS,KAAK1I,SAASkM,EAAOb,GACrB0jB,GAIGrqB,CACT,EAMAoG,EAAOvJ,UAAUoe,KAAO,SAAe7L,EAAK5H,EAAOb,EAAKsI,GAEtD,GAAmB,iBAARG,EAAkB,CAS3B,GARqB,iBAAV5H,GACTyH,EAAWzH,EACXA,EAAQ,EACRb,EAAM3C,KAAK/I,QACa,iBAAR0L,IAChBsI,EAAWtI,EACXA,EAAM3C,KAAK/I,aAEIyQ,IAAbuD,GAA8C,iBAAbA,EACnC,MAAM,IAAIjG,UAAU,6BAEtB,GAAwB,iBAAbiG,IAA0B7I,EAAOuZ,WAAW1Q,GACrD,MAAM,IAAIjG,UAAU,qBAAuBiG,GAE7C,GAAmB,IAAfG,EAAInU,OAAc,CACpB,IAAIoX,EAAOjD,EAAI5P,WAAW,IACR,SAAbyP,GAAuBoD,EAAO,KAClB,WAAbpD,KAEFG,EAAMiD,EAEV,CACF,KAA0B,iBAARjD,EAChBA,GAAY,IACY,kBAARA,IAChBA,EAAMpC,OAAOoC,IAIf,GAAI5H,EAAQ,GAAKxD,KAAK/I,OAASuM,GAASxD,KAAK/I,OAAS0L,EACpD,MAAM,IAAIX,WAAW,sBAGvB,GAAIW,GAAOa,EACT,OAAOxD,KAQT,IAAI1E,EACJ,GANAkI,KAAkB,EAClBb,OAAc+E,IAAR/E,EAAoB3C,KAAK/I,OAAS0L,IAAQ,EAE3CyI,IAAKA,EAAM,GAGG,iBAARA,EACT,IAAK9P,EAAIkI,EAAOlI,EAAIqH,IAAOrH,EACzB0E,KAAK1E,GAAK8P,MAEP,CACL,IAAI7H,EAAQnB,EAAOC,SAAS+I,GACxBA,EACAhJ,EAAOoE,KAAK4E,EAAKH,GACjBjP,EAAMuH,EAAMtM,OAChB,GAAY,IAAR+E,EACF,MAAM,IAAIgJ,UAAU,cAAgBoG,EAClC,qCAEJ,IAAK9P,EAAI,EAAGA,EAAIqH,EAAMa,IAASlI,EAC7B0E,KAAK1E,EAAIkI,GAASD,EAAMjI,EAAIU,EAEhC,CAEA,OAAOgE,IACT,EAKA,IAAIonB,EAAoB,oBAgBxB,SAASpK,EAAatZ,EAAQsb,GAE5B,IAAIM,EADJN,EAAQA,GAAS5N,IAMjB,IAJA,IAAIna,EAASyM,EAAOzM,OAChBowB,EAAgB,KAChB9jB,EAAQ,GAEHjI,EAAI,EAAGA,EAAIrE,IAAUqE,EAAG,CAI/B,IAHAgkB,EAAY5b,EAAOlI,WAAWF,IAGd,OAAUgkB,EAAY,MAAQ,CAE5C,IAAK+H,EAAe,CAElB,GAAI/H,EAAY,MAAQ,EAEjBN,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C,QACF,CAAO,GAAI4D,EAAI,IAAMrE,EAAQ,EAEtB+nB,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C,QACF,CAGA2vB,EAAgB/H,EAEhB,QACF,CAGA,GAAIA,EAAY,MAAQ,EACjBN,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAC9C2vB,EAAgB/H,EAChB,QACF,CAGAA,EAAkE,OAArD+H,EAAgB,OAAU,GAAK/H,EAAY,MAC1D,MAAW+H,IAEJrI,GAAS,IAAM,GAAGzb,EAAM7L,KAAK,IAAM,IAAM,KAMhD,GAHA2vB,EAAgB,KAGZ/H,EAAY,IAAM,CACpB,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KAAK4nB,EACb,MAAO,GAAIA,EAAY,KAAO,CAC5B,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,EAAM,IACP,GAAZA,EAAmB,IAEvB,MAAO,GAAIA,EAAY,MAAS,CAC9B,IAAKN,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,GAAM,IACnBA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,IAEvB,KAAO,MAAIA,EAAY,SASrB,MAAM,IAAI/mB,MAAM,sBARhB,IAAKymB,GAAS,GAAK,EAAG,MACtBzb,EAAM7L,KACJ4nB,GAAa,GAAO,IACpBA,GAAa,GAAM,GAAO,IAC1BA,GAAa,EAAM,GAAO,IACd,GAAZA,EAAmB,IAIvB,CACF,CAEA,OAAO/b,CACT,CA2BA,SAAS0Z,EAAe5hB,GACtB,OAAO6M,EAAOof,YAxHhB,SAAsBjsB,GAMpB,IAFAA,GAFAA,EAAMA,EAAI4D,MAAM,KAAK,IAEXia,OAAOzY,QAAQ2mB,EAAmB,KAEpCnwB,OAAS,EAAG,MAAO,GAE3B,KAAOoE,EAAIpE,OAAS,GAAM,GACxBoE,GAAY,IAEd,OAAOA,CACT,CA4G4BksB,CAAYlsB,GACxC,CAEA,SAASqjB,EAAYnX,EAAKD,EAAKpQ,EAAQD,GACrC,IAAK,IAAIqE,EAAI,EAAGA,EAAIrE,KACbqE,EAAIpE,GAAUoQ,EAAIrQ,QAAYqE,GAAKiM,EAAItQ,UADhBqE,EAE5BgM,EAAIhM,EAAIpE,GAAUqQ,EAAIjM,GAExB,OAAOA,CACT,CAKA,SAAS0gB,EAAY1S,EAAK4F,GACxB,OAAO5F,aAAe4F,GACZ,MAAP5F,GAAkC,MAAnBA,EAAIxJ,aAA+C,MAAxBwJ,EAAIxJ,YAAYT,MACzDiK,EAAIxJ,YAAYT,OAAS6P,EAAK7P,IACpC,CACA,SAASmd,EAAalT,GAEpB,OAAOA,GAAQA,CACjB,CAIA,IAAIqY,EAAsB,WAGxB,IAFA,IAAI6F,EAAW,mBACXjuB,EAAQ,IAAIX,MAAM,KACb0C,EAAI,EAAGA,EAAI,KAAMA,EAExB,IADA,IAAImsB,EAAU,GAAJnsB,EACD8iB,EAAI,EAAGA,EAAI,KAAMA,EACxB7kB,EAAMkuB,EAAMrJ,GAAKoJ,EAASlsB,GAAKksB,EAASpJ,GAG5C,OAAO7kB,CACR,CAVyB,mCChwD1BkF,EAAOnF,QAuCP,SAAeuF,EAAOuP,GACpB,GAAqB,iBAAVvP,EACT,OAAOmtB,EAAMntB,GAGf,GAAqB,iBAAVA,EACT,OAAO+P,EAAO/P,EAAOuP,GAGvB,OAAO,IACT,EAhDA3P,EAAOnF,QAAQsV,OAASA,EACxBnQ,EAAOnF,QAAQ0yB,MAAQA,EAOvB,IAAIC,EAAwB,wBAExBC,EAAuB,wBAEvBtR,EAAM,CACR0B,EAAI,EACJ6P,GAAI,KACJC,GAAI,GAAK,GACTC,GAAI,GAAK,GACTC,GAAIrzB,KAAK6qB,IAAI,KAAM,GACnByI,GAAItzB,KAAK6qB,IAAI,KAAM,IAGjB0I,EAAc,gDA+ClB,SAAS5d,EAAO/P,EAAOuP,GACrB,IAAKpF,OAAOC,SAASpK,GACnB,OAAO,KAGT,IAAI4tB,EAAMxzB,KAAKkuB,IAAItoB,GACf6tB,EAAsBte,GAAWA,EAAQse,oBAAuB,GAChEC,EAAiBve,GAAWA,EAAQue,eAAkB,GACtDC,EAAiBxe,QAAqC1G,IAA1B0G,EAAQwe,cAA+Bxe,EAAQwe,cAAgB,EAC3FC,EAAgB3nB,QAAQkJ,GAAWA,EAAQye,eAC3CC,EAAQ1e,GAAWA,EAAQ0e,MAAS,GAEnCA,GAASlS,EAAIkS,EAAKviB,iBAEnBuiB,EADEL,GAAO7R,EAAI2R,GACN,KACEE,GAAO7R,EAAI0R,GACb,KACEG,GAAO7R,EAAIyR,GACb,KACEI,GAAO7R,EAAIwR,GACb,KACEK,GAAO7R,EAAIuR,GACb,KAEA,KAIX,IACI9wB,GADMwD,EAAQ+b,EAAIkS,EAAKviB,gBACbwiB,QAAQH,GActB,OAZKC,IACHxxB,EAAMA,EAAIoF,QAAQyrB,EAAsB,OAGtCQ,IACFrxB,EAAMA,EAAI4D,MAAM,KAAK2b,KAAI,SAAUoS,EAAG1xB,GACpC,OAAa,IAANA,EACH0xB,EAAEvsB,QAAQwrB,EAAuBS,GACjCM,CACN,IAAGr1B,KAAK,MAGH0D,EAAMsxB,EAAgBG,CAC/B,CAaA,SAASd,EAAM5gB,GACb,GAAmB,iBAARA,IAAqB6hB,MAAM7hB,GACpC,OAAOA,EAGT,GAAmB,iBAARA,EACT,OAAO,KAIT,IACI8hB,EADAC,EAAUX,EAAYY,KAAKhiB,GAE3B0hB,EAAO,IAYX,OAVKK,GAMHD,EAAaG,WAAWF,EAAQ,IAChCL,EAAOK,EAAQ,GAAG5iB,gBALlB2iB,EAAaxmB,SAAS0E,EAAK,IAC3B0hB,EAAO,KAOLG,MAAMC,GACD,KAGFj0B,KAAKiQ,MAAM0R,EAAIkS,GAAQI,EAChC,sCCvKA,IAAIjf,EAAW,EAAQ,OAEvB3U,EAAQ+T,aAAe,SAAU7H,EAAU8nB,GACzC,QAAiB5lB,IAAblC,EAAwB,CAC1B,IAAI+L,EAAU,IAAIC,SAAQ,SAAUC,EAASC,GAC3ClM,EAAW,SAAUI,EAAKwZ,GACpBxZ,EAAK8L,EAAO9L,GACX6L,EAAQ2N,EACf,CACF,IAEA5Z,OAAoBkC,IAAX4lB,EAAuBA,EAAS,WAAa/b,CACxD,MAAO,GAAwB,mBAAb/L,EAChB,MAAM,IAAIR,UAAU,+BAGtB,OAAOQ,CACT,EAEAlM,EAAQi0B,YAAc,SAAUhc,EAAS/L,GACvC,QAAiBkC,IAAblC,EAAwB,OAAO+L,EAEnCA,EACGic,MAAK,SAAUpO,GAAOnR,GAAS,IAAMzI,EAAS,KAAM4Z,IAAM,IAC1DqO,OAAM,SAAU7nB,GAAOqI,GAAS,IAAMzI,EAASI,IAAM,GAC1D,qBC3BAnH,EAAOnF,QAAoC,mBAAnByhB,eAAgCA,eAAkB/W,GAAOwN,QAAQC,UAAU+b,KAAKxpB,uICKxG,MAAM0pB,EAAcl3B,OAAO,iBACrBm3B,EAAiBn3B,OAAO,oBACxBo3B,EAAep3B,OAAO,wBACtBq3B,EAAYr3B,OAAO,qBACnBs3B,EAAct3B,OAAO,kBACrB2S,EAAYiC,GAAwB,iBAARA,GAA4B,OAARA,GAAgC,mBAARA,EAgDxE2iB,EAAmB,IAAIzT,IAAI,CAC7B,CAAC,QA7CwB,CACzB0T,UAAY5iB,GAAQjC,EAASiC,IAAQA,EAAIsiB,GACzCO,UAAU3kB,GACN,MAAM,MAAE4kB,EAAK,MAAEC,GAAU,IAAIC,eAE7B,OADAC,EAAO/kB,EAAK4kB,GACL,CAACC,EAAO,CAACA,GACpB,EACA7F,YAAYgG,GAER,OADAA,EAAK9qB,QAiJF+qB,EAhJSD,EAgJO,GAAIjc,GAD/B,IAAkBA,CA9Id,IAoCA,CAAC,QA/BwB,CACzB2b,UAAYnvB,GAAUsK,EAAStK,IAAUivB,KAAejvB,EACxDovB,WAAU,MAAEpvB,IACR,IAAI2vB,EAcJ,OAZIA,EADA3vB,aAAiBtG,MACJ,CACTk2B,SAAS,EACT5vB,MAAO,CACHgJ,QAAShJ,EAAMgJ,QACfxI,KAAMR,EAAMQ,KACZ2I,MAAOnJ,EAAMmJ,QAKR,CAAEymB,SAAS,EAAO5vB,SAE5B,CAAC2vB,EAAY,GACxB,EACAlG,YAAYkG,GACR,GAAIA,EAAWC,QACX,MAAM/vB,OAAO6W,OAAO,IAAIhd,MAAMi2B,EAAW3vB,MAAMgJ,SAAU2mB,EAAW3vB,OAExE,MAAM2vB,EAAW3vB,KACrB,MAoBJ,SAASwvB,EAAO/kB,EAAKolB,EAAK5G,WAAY6G,EAAiB,CAAC,MACpDD,EAAGvG,iBAAiB,WAAW,SAAS3iB,EAASikB,GAC7C,IAAKA,IAAOA,EAAGhN,KACX,OAEJ,IAhBR,SAAyBkS,EAAgBC,GACrC,IAAK,MAAMC,KAAiBF,EAAgB,CACxC,GAAIC,IAAWC,GAAmC,MAAlBA,EAC5B,OAAO,EAEX,GAAIA,aAAyBC,QAAUD,EAActuB,KAAKquB,GACtD,OAAO,CAEf,CACA,OAAO,CACX,CAMaG,CAAgBJ,EAAgBlF,EAAGmF,QAEpC,YADAl2B,EAAQqa,KAAK,mBAAmB0W,EAAGmF,6BAGvC,MAAM,GAAEh1B,EAAE,KAAEsV,EAAI,KAAE8f,GAAStwB,OAAO6W,OAAO,CAAEyZ,KAAM,IAAMvF,EAAGhN,MACpDwS,GAAgBxF,EAAGhN,KAAKwS,cAAgB,IAAIrU,IAAIsU,GACtD,IAAIC,EACJ,IACI,MAAM/V,EAAS4V,EAAKl2B,MAAM,GAAI,GAAGs2B,QAAO,CAAC9lB,EAAKC,IAASD,EAAIC,IAAOD,GAC5D+lB,EAAWL,EAAKI,QAAO,CAAC9lB,EAAKC,IAASD,EAAIC,IAAOD,GACvD,OAAQ4F,GACJ,IAAK,MAEGigB,EAAcE,EAElB,MACJ,IAAK,MAEGjW,EAAO4V,EAAKl2B,OAAO,GAAG,IAAMo2B,EAAczF,EAAGhN,KAAK5d,OAClDswB,GAAc,EAElB,MACJ,IAAK,QAEGA,EAAcE,EAASh4B,MAAM+hB,EAAQ6V,GAEzC,MACJ,IAAK,YAGGE,EAAcG,EADA,IAAID,KAAYJ,IAGlC,MACJ,IAAK,WACD,CACI,MAAM,MAAEf,EAAK,MAAEC,GAAU,IAAIC,eAC7BC,EAAO/kB,EAAK6kB,GACZgB,EAkKxB,SAAkB7lB,EAAKimB,GAEnB,OADAC,EAAc3zB,IAAIyN,EAAKimB,GAChBjmB,CACX,CArKsCmmB,CAASvB,EAAO,CAACA,GACnC,CACA,MACJ,IAAK,UAEGiB,OAAcznB,EAElB,MACJ,QACI,OAEZ,CACA,MAAO7I,GACHswB,EAAc,CAAEtwB,QAAO,CAACivB,GAAc,EAC1C,CACAtc,QAAQC,QAAQ0d,GACX1B,OAAO5uB,IACD,CAAEA,QAAO,CAACivB,GAAc,MAE9BN,MAAM2B,IACP,MAAOO,EAAWC,GAAiBC,EAAYT,GAC/CT,EAAGmB,YAAYnxB,OAAO6W,OAAO7W,OAAO6W,OAAO,CAAC,EAAGma,GAAY,CAAE91B,OAAO+1B,GACvD,YAATzgB,IAEAwf,EAAGxG,oBAAoB,UAAW1iB,GAClCsqB,EAAcpB,GACVb,KAAavkB,GAAiC,mBAAnBA,EAAIukB,IAC/BvkB,EAAIukB,KAEZ,IAECJ,OAAOrN,IAER,MAAOsP,EAAWC,GAAiBC,EAAY,CAC3C/wB,MAAO,IAAImG,UAAU,+BACrB,CAAC8oB,GAAc,IAEnBY,EAAGmB,YAAYnxB,OAAO6W,OAAO7W,OAAO6W,OAAO,CAAC,EAAGma,GAAY,CAAE91B,OAAO+1B,EAAc,GAE1F,IACIjB,EAAGlrB,OACHkrB,EAAGlrB,OAEX,CAIA,SAASssB,EAAcC,IAHvB,SAAuBA,GACnB,MAAqC,gBAA9BA,EAASjwB,YAAYT,IAChC,EAEQ2wB,CAAcD,IACdA,EAASxgB,OACjB,CAIA,SAAS0gB,EAAqBC,GAC1B,GAAIA,EACA,MAAM,IAAI33B,MAAM,6CAExB,CACA,SAAS43B,EAAgBzB,GACrB,OAAO0B,EAAuB1B,EAAI,CAC9Bxf,KAAM,YACPse,MAAK,KACJsC,EAAcpB,EAAG,GAEzB,CACA,MAAM2B,EAAe,IAAIC,QACnBC,EAAkB,yBAA0BzI,YAC9C,IAAI0I,sBAAsB9B,IACtB,MAAM+B,GAAYJ,EAAa1vB,IAAI+tB,IAAO,GAAK,EAC/C2B,EAAax0B,IAAI6yB,EAAI+B,GACJ,IAAbA,GACAN,EAAgBzB,EACpB,IAcR,SAASH,EAAYG,EAAIM,EAAO,GAAI3c,EAAS,WAAc,GACvD,IAAIqe,GAAkB,EACtB,MAAMpB,EAAQ,IAAIqB,MAAMte,EAAQ,CAC5B1R,IAAIiwB,EAASrnB,GAET,GADA0mB,EAAqBS,GACjBnnB,IAASqkB,EACT,MAAO,MAXvB,SAAyB0B,GACjBiB,GACAA,EAAgBM,WAAWvB,EAEnC,CAQoBwB,CAAgBxB,GAChBa,EAAgBzB,GAChBgC,GAAkB,CAAI,EAG9B,GAAa,SAATnnB,EAAiB,CACjB,GAAoB,IAAhBylB,EAAK/3B,OACL,MAAO,CAAEu2B,KAAM,IAAM8B,GAEzB,MAAMyB,EAAIX,EAAuB1B,EAAI,CACjCxf,KAAM,MACN8f,KAAMA,EAAKpU,KAAKrf,GAAMA,EAAEoJ,eACzB6oB,KAAK0B,GACR,OAAO6B,EAAEvD,KAAKpxB,KAAK20B,EACvB,CACA,OAAOxC,EAAYG,EAAI,IAAIM,EAAMzlB,GACrC,EACA1N,IAAI+0B,EAASrnB,EAAM8lB,GACfY,EAAqBS,GAGrB,MAAO7xB,EAAO8wB,GAAiBC,EAAYP,GAC3C,OAAOe,EAAuB1B,EAAI,CAC9Bxf,KAAM,MACN8f,KAAM,IAAIA,EAAMzlB,GAAMqR,KAAKrf,GAAMA,EAAEoJ,aACnC9F,SACD8wB,GAAenC,KAAK0B,EAC3B,EACA73B,MAAMu5B,EAASI,EAAUC,GACrBhB,EAAqBS,GACrB,MAAMl5B,EAAOw3B,EAAKA,EAAK/3B,OAAS,GAChC,GAAIO,IAASm2B,EACT,OAAOyC,EAAuB1B,EAAI,CAC9Bxf,KAAM,aACPse,KAAK0B,GAGZ,GAAa,SAAT13B,EACA,OAAO+2B,EAAYG,EAAIM,EAAKl2B,MAAM,GAAI,IAE1C,MAAOm2B,EAAcU,GAAiBuB,EAAiBD,GACvD,OAAOb,EAAuB1B,EAAI,CAC9Bxf,KAAM,QACN8f,KAAMA,EAAKpU,KAAKrf,GAAMA,EAAEoJ,aACxBsqB,gBACDU,GAAenC,KAAK0B,EAC3B,EACAiC,UAAUP,EAASK,GACfhB,EAAqBS,GACrB,MAAOzB,EAAcU,GAAiBuB,EAAiBD,GACvD,OAAOb,EAAuB1B,EAAI,CAC9Bxf,KAAM,YACN8f,KAAMA,EAAKpU,KAAKrf,GAAMA,EAAEoJ,aACxBsqB,gBACDU,GAAenC,KAAK0B,EAC3B,IAGJ,OA7EJ,SAAuBI,EAAOZ,GAC1B,MAAM+B,GAAYJ,EAAa1vB,IAAI+tB,IAAO,GAAK,EAC/C2B,EAAax0B,IAAI6yB,EAAI+B,GACjBF,GACAA,EAAgBa,SAAS9B,EAAOZ,EAAIY,EAE5C,CAsEI+B,CAAc/B,EAAOZ,GACdY,CACX,CAIA,SAAS4B,EAAiBjC,GACtB,MAAMqC,EAAYrC,EAAarU,IAAIgV,GACnC,MAAO,CAAC0B,EAAU1W,KAAK2W,GAAMA,EAAE,MALnB12B,EAK+By2B,EAAU1W,KAAK2W,GAAMA,EAAE,KAJ3D34B,MAAMC,UAAUghB,OAAOxiB,MAAM,GAAIwD,KAD5C,IAAgBA,CAMhB,CACA,MAAM20B,EAAgB,IAAIc,QAK1B,SAAShB,EAAMhmB,GACX,OAAO5K,OAAO6W,OAAOjM,EAAK,CAAE,CAACokB,IAAc,GAC/C,CAQA,SAASkC,EAAY/wB,GACjB,IAAK,MAAOQ,EAAMmyB,KAAYzD,EAC1B,GAAIyD,EAAQxD,UAAUnvB,GAAQ,CAC1B,MAAO4yB,EAAiB9B,GAAiB6B,EAAQvD,UAAUpvB,GAC3D,MAAO,CACH,CACIqQ,KAAM,UACN7P,OACAR,MAAO4yB,GAEX9B,EAER,CAEJ,MAAO,CACH,CACIzgB,KAAM,MACNrQ,SAEJ2wB,EAAc7uB,IAAI9B,IAAU,GAEpC,CACA,SAASqwB,EAAcrwB,GACnB,OAAQA,EAAMqQ,MACV,IAAK,UACD,OAAO6e,EAAiBptB,IAAI9B,EAAMQ,MAAMipB,YAAYzpB,EAAMA,OAC9D,IAAK,MACD,OAAOA,EAAMA,MAEzB,CACA,SAASuxB,EAAuB1B,EAAIzH,EAAKsI,GACrC,OAAO,IAAI/d,SAASC,IAChB,MAAM7X,EAeH,IAAIhB,MAAM,GACZqe,KAAK,GACL2D,KAAI,IAAM3hB,KAAKiQ,MAAMjQ,KAAKy4B,SAAW1oB,OAAO2oB,kBAAkBhtB,SAAS,MACvEhN,KAAK,KAjBN+2B,EAAGvG,iBAAiB,WAAW,SAASyJ,EAAEnI,GACjCA,EAAGhN,MAASgN,EAAGhN,KAAK7iB,IAAM6vB,EAAGhN,KAAK7iB,KAAOA,IAG9C80B,EAAGxG,oBAAoB,UAAW0J,GAClCngB,EAAQgY,EAAGhN,MACf,IACIiS,EAAGlrB,OACHkrB,EAAGlrB,QAEPkrB,EAAGmB,YAAYnxB,OAAO6W,OAAO,CAAE3b,MAAMqtB,GAAMsI,EAAU,GAE7D,sCC9UwBj2B,EAAQu4B,0BAA4Bv4B,EAAQw4B,kBAAoBx4B,EAAQy4B,wBAA0Bz4B,EAAQ04B,gBAAkB14B,EAAQ24B,qBAAuB34B,EAAQ44B,aAAe54B,EAAQ64B,gBAAkB74B,EAAQ84B,aAAoC,EAEhR,MAAMC,EAAS,EAAQ,OACjBC,EAAS,EAAQ,OACjBC,EAAW,EAAQ,OACnBC,EAAY,EAAQ,OAsN1B,SAASC,IACL,MAAO,CACHC,UAAW,GACXC,OAAQL,EAAOM,OAAOC,YAAY,CAAC,GAE3C,CAlNAv5B,EAAQ84B,QAAU,CACdU,QAAS,+BACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UACf,KAAxBkJ,EAAQmrB,aACRxnB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQmrB,aAEX,KAAtBnrB,EAAQorB,WACRznB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQorB,WAErC,IAAK,MAAM1B,KAAK1pB,EAAQqrB,OACpBb,EAAOc,KAAKpkB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEpD,OAAOhB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAvBH,CACHmrB,YAAa,GACbC,UAAW,GACXC,OAAQ,IAqBR,KAAOpxB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQmrB,YAAclxB,EAAO4B,SAC7B,MACJ,KAAK,EACDmE,EAAQorB,UAAYnxB,EAAO4B,SAC3B,MACJ,KAAK,EACDmE,EAAQqrB,OAAOx7B,KAAK26B,EAAOc,KAAK/mB,OAAOtK,EAAQA,EAAOgB,WACtD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EA5CH,CACH0pB,YAAa,GACbC,UAAW,GACXC,OAAQ,IAgDR,OANI,EAAIV,EAAUnpB,OAAOkqB,EAAOP,eAC5B1pB,EAAI0pB,YAAc77B,OAAOo8B,EAAOP,eAChC,EAAIR,EAAUnpB,OAAOkqB,EAAON,aAC5B3pB,EAAI2pB,UAAY97B,OAAOo8B,EAAON,YAC9Br6B,MAAMuJ,QAAQoxB,GAAQL,UACtB5pB,EAAI4pB,OAASK,EAAOL,OAAOtY,KAAKnR,GAAM4oB,EAAOc,KAAKG,SAAS7pB,MACxDH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EASb,YARwB5B,IAAxBG,EAAQmrB,cAA8B1pB,EAAI0pB,YAAcnrB,EAAQmrB,kBAC1CtrB,IAAtBG,EAAQorB,YAA4B3pB,EAAI2pB,UAAYprB,EAAQorB,WACxDprB,EAAQqrB,OACR5pB,EAAI4pB,OAASrrB,EAAQqrB,OAAOtY,KAAKnR,GAAOA,EAAI4oB,EAAOc,KAAK3R,OAAO/X,QAAK/B,IAGpE4B,EAAI4pB,OAAS,GAEV5pB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAlEH,CACHmrB,YAAa,GACbC,UAAW,GACXC,OAAQ,IAmER,OAHArrB,EAAQmrB,YAAcO,EAAOP,aAAe,GAC5CnrB,EAAQorB,UAAYM,EAAON,WAAa,GACxCprB,EAAQqrB,OAASK,EAAOL,QAAQtY,KAAKnR,GAAM4oB,EAAOc,KAAKN,YAAYppB,MAAO,GACnE5B,CACX,GAKJvO,EAAQ64B,gBAAkB,CACtBW,QAAS,uCACT/jB,OAAM,CAACka,EAAGzd,EAAS+mB,EAASQ,aAAap0B,WAC9B6M,EAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAVH,CAAC,EAWJ,KAAO/F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SAGXhB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASrK,IArBF,CAAC,GAyBRzH,OAAOyH,IACS,CAAC,GAGjB4J,YAAY5J,IA7BL,CAAC,IAwCZ3vB,EAAQ44B,aAAe,CACnBY,QAAS,oCACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UAC3C,IAAK,MAAM4yB,KAAK1pB,EAAQ2rB,OACpBlB,EAAOmB,MAAM1kB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAErD,IAAK,MAAM+kB,KAAK1pB,EAAQ6rB,QACpBpB,EAAOqB,OAAO5kB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEtD,OAAOhB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAnBH,CACH2rB,OAAQ,GACRE,QAAS,IAkBT,KAAO5xB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ2rB,OAAO97B,KAAK46B,EAAOmB,MAAMrnB,OAAOtK,EAAQA,EAAOgB,WACvD,MACJ,KAAK,EACD+E,EAAQ6rB,QAAQh8B,KAAK46B,EAAOqB,OAAOvnB,OAAOtK,EAAQA,EAAOgB,WACzD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EArCH,CACHkqB,OAAQ,GACRE,QAAS,IAwCT,OAJI96B,MAAMuJ,QAAQoxB,GAAQC,UACtBlqB,EAAIkqB,OAASD,EAAOC,OAAO5Y,KAAKnR,GAAM6oB,EAAOmB,MAAMH,SAAS7pB,MAC5D7Q,MAAMuJ,QAAQoxB,GAAQG,WACtBpqB,EAAIoqB,QAAUH,EAAOG,QAAQ9Y,KAAKnR,GAAM6oB,EAAOqB,OAAOL,SAAS7pB,MAC5DH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAab,OAZIzB,EAAQ2rB,OACRlqB,EAAIkqB,OAAS3rB,EAAQ2rB,OAAO5Y,KAAKnR,GAAOA,EAAI6oB,EAAOmB,MAAMjS,OAAO/X,QAAK/B,IAGrE4B,EAAIkqB,OAAS,GAEb3rB,EAAQ6rB,QACRpqB,EAAIoqB,QAAU7rB,EAAQ6rB,QAAQ9Y,KAAKnR,GAAOA,EAAI6oB,EAAOqB,OAAOnS,OAAO/X,QAAK/B,IAGxE4B,EAAIoqB,QAAU,GAEXpqB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EA7DH,CACH2rB,OAAQ,GACRE,QAAS,IA8DT,OAFA7rB,EAAQ2rB,OAASD,EAAOC,QAAQ5Y,KAAKnR,GAAM6oB,EAAOmB,MAAMZ,YAAYppB,MAAO,GAC3E5B,EAAQ6rB,QAAUH,EAAOG,SAAS9Y,KAAKnR,GAAM6oB,EAAOqB,OAAOd,YAAYppB,MAAO,GACvE5B,CACX,GAKJvO,EAAQ24B,qBAAuB,CAC3Ba,QAAS,4CACT/jB,OAAM,CAACka,EAAGzd,EAAS+mB,EAASQ,aAAap0B,WAC9B6M,EAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAVH,CAAC,EAWJ,KAAO/F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SAGXhB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASrK,IArBF,CAAC,GAyBRzH,OAAOyH,IACS,CAAC,GAGjB4J,YAAY5J,IA7BL,CAAC,IAwCZ3vB,EAAQ04B,gBAAkB,CACtBc,QAAS,uCACT/jB,OAAM,CAAClH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,YACjB,KAAtBkJ,EAAQ6qB,WACRlnB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQ6qB,gBAEdhrB,IAAnBG,EAAQ8qB,QACRL,EAAOM,OAAO7jB,OAAOlH,EAAQ8qB,OAAQnnB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAE5DhB,GAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAAU4qB,IAChB,KAAO3wB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ6qB,UAAY5wB,EAAO4B,SAC3B,MACJ,KAAK,EACDmE,EAAQ8qB,OAASL,EAAOM,OAAOxmB,OAAOtK,EAAQA,EAAOgB,UACrD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EAAMmpB,IAKZ,OAJI,EAAID,EAAUnpB,OAAOkqB,EAAOb,aAC5BppB,EAAIopB,UAAYv7B,OAAOo8B,EAAOb,aAC9B,EAAIF,EAAUnpB,OAAOkqB,EAAOZ,UAC5BrpB,EAAIqpB,OAASL,EAAOM,OAAOU,SAASC,EAAOZ,SACxCrpB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAGb,YAFsB5B,IAAtBG,EAAQ6qB,YAA4BppB,EAAIopB,UAAY7qB,EAAQ6qB,gBACzChrB,IAAnBG,EAAQ8qB,SAAyBrpB,EAAIqpB,OAAS9qB,EAAQ8qB,OAASL,EAAOM,OAAOpR,OAAO3Z,EAAQ8qB,aAAUjrB,GAC/F4B,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAAU4qB,IAKhB,OAJA5qB,EAAQ6qB,UAAYa,EAAOb,WAAa,QAClBhrB,IAAlB6rB,EAAOZ,QAA0C,OAAlBY,EAAOZ,SACtC9qB,EAAQ8qB,OAASL,EAAOM,OAAOC,YAAYU,EAAOZ,SAE/C9qB,CACX,GAKJvO,EAAQy4B,wBAA0B,CAC9Be,QAAS,+CACT/jB,OAAM,CAACka,EAAGzd,EAAS+mB,EAASQ,aAAap0B,WAC9B6M,EAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAVH,CAAC,EAWJ,KAAO/F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SAGXhB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASrK,IArBF,CAAC,GAyBRzH,OAAOyH,IACS,CAAC,GAGjB4J,YAAY5J,IA7BL,CAAC,IAyCZ3vB,EAAQw4B,kBAAoB,CACxBgB,QAAS,yCACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UACjB,KAAtBkJ,EAAQ6qB,WACRlnB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQ6qB,WAErC,IAAK,MAAMnB,KAAK1pB,EAAQ+rB,YACpBtB,EAAOuB,YAAY9kB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAE3D,IAAK,MAAM+kB,KAAK1pB,EAAQisB,cACpBtoB,EAAO1I,OAAO,IAAIY,OAAO6tB,GAE7B,OAAO/lB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAvBH,CACH6qB,UAAW,GACXkB,YAAa,GACbE,cAAe,IAqBf,KAAOhyB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ6qB,UAAY5wB,EAAO4B,SAC3B,MACJ,KAAK,EACDmE,EAAQ+rB,YAAYl8B,KAAK46B,EAAOuB,YAAYznB,OAAOtK,EAAQA,EAAOgB,WAClE,MACJ,KAAK,EACD+E,EAAQisB,cAAcp8B,KAAKoK,EAAO4B,UAClC,MACJ,QACI5B,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EA5CH,CACHopB,UAAW,GACXkB,YAAa,GACbE,cAAe,IAgDf,OANI,EAAItB,EAAUnpB,OAAOkqB,EAAOb,aAC5BppB,EAAIopB,UAAYv7B,OAAOo8B,EAAOb,YAC9B95B,MAAMuJ,QAAQoxB,GAAQK,eACtBtqB,EAAIsqB,YAAcL,EAAOK,YAAYhZ,KAAKnR,GAAM6oB,EAAOuB,YAAYP,SAAS7pB,MAC5E7Q,MAAMuJ,QAAQoxB,GAAQO,iBACtBxqB,EAAIwqB,cAAgBP,EAAOO,cAAclZ,KAAKnR,GAAMtS,OAAOsS,MACxDH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAcb,YAbsB5B,IAAtBG,EAAQ6qB,YAA4BppB,EAAIopB,UAAY7qB,EAAQ6qB,WACxD7qB,EAAQ+rB,YACRtqB,EAAIsqB,YAAc/rB,EAAQ+rB,YAAYhZ,KAAKnR,GAAOA,EAAI6oB,EAAOuB,YAAYrS,OAAO/X,QAAK/B,IAGrF4B,EAAIsqB,YAAc,GAElB/rB,EAAQisB,cACRxqB,EAAIwqB,cAAgBjsB,EAAQisB,cAAclZ,KAAKnR,GAAMA,IAGrDH,EAAIwqB,cAAgB,GAEjBxqB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAvEH,CACH6qB,UAAW,GACXkB,YAAa,GACbE,cAAe,IAwEf,OAHAjsB,EAAQ6qB,UAAYa,EAAOb,WAAa,GACxC7qB,EAAQ+rB,YAAcL,EAAOK,aAAahZ,KAAKnR,GAAM6oB,EAAOuB,YAAYhB,YAAYppB,MAAO,GAC3F5B,EAAQisB,cAAgBP,EAAOO,eAAelZ,KAAKnR,GAAMA,KAAM,GACxD5B,CACX,GAKJvO,EAAQu4B,0BAA4B,CAChCiB,QAAS,iDACT/jB,OAAM,CAACka,EAAGzd,EAAS+mB,EAASQ,aAAap0B,WAC9B6M,EAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAVH,CAAC,EAWJ,KAAO/F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SAGXhB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASrK,IArBF,CAAC,GAyBRzH,OAAOyH,IACS,CAAC,GAGjB4J,YAAY5J,IA7BL,CAAC,wCC1YY3vB,EAAQy6B,IAAMz6B,EAAQ06B,IAAM16B,EAAQ26B,eAAiB36B,EAAQ46B,gBAAkB56B,EAAQ66B,SAAW76B,EAAQ86B,WAAa96B,EAAQ+6B,SAAW/6B,EAAQg7B,OAASh7B,EAAQi7B,iBAAqDj7B,EAAQk7B,QAA+B,EAEvR,MAAMC,EAAQ,EAAQ,OAChBC,EAAY,EAAQ,OACpBC,EAAa,EAAQ,OACrBtC,EAAS,EAAQ,OACjBE,EAAW,EAAQ,OACnBC,EAAY,EAAQ,OAiF1B,SAASoC,IACL,MAAO,CACHC,UAAW,IAAIr6B,WACfs6B,cAAe,IAAIt6B,WACnBu6B,WAAY,GAEpB,CAsEA,SAASC,IACL,MAAO,CACHH,UAAW,IAAIr6B,WACfs6B,cAAe,IAAIt6B,WACnBy6B,QAAS,GACTC,cAAejT,OAAO,GAE9B,CA8EA,SAASkT,IACL,MAAO,CACHN,UAAW,IAAIr6B,WACf46B,eAAW1tB,EACXutB,QAAS,GACTC,cAAejT,OAAO,GACtBoT,SAAUpT,OAAO,GACjBqT,SAAK5tB,EAEb,CAwGA,SAAS6tB,IACL,MAAO,CACHC,SAAU,GACVC,KAAM,GACNC,cAAezT,OAAO,GACtB0T,iBAAkB,GAClBC,4BAA6B,GAErC,CAoLA,SAASC,IACL,MAAO,CACHT,eAAW1tB,EACXouB,cAAUpuB,EACV2tB,SAAUpT,OAAO,GAEzB,CAwPA,SAAS8T,IACL,MAAO,CACH7C,OAAQ,GACR8C,SAAU/T,OAAO,GACjBgU,MAAO,GACPC,QAAS,GAEjB,CA+IA,SAASC,IACL,MAAO,CACHC,QAAS,GACTC,aAAS3uB,EACTmiB,KAAM,EACNyM,IAAK,IAAI97B,WAEjB,CAj7BAlB,EAAQk7B,GAAK,CACT1B,QAAS,wBACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,eACtB+I,IAAjBG,EAAQ0uB,MACRj9B,EAAQg7B,OAAOvlB,OAAOlH,EAAQ0uB,KAAM/qB,EAAO1I,OAAO,IAAIwJ,QAAQE,cAEzC9E,IAArBG,EAAQ2uB,UACRl9B,EAAQ+6B,SAAStlB,OAAOlH,EAAQ2uB,SAAUhrB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAExE,IAAK,MAAM+kB,KAAK1pB,EAAQktB,WACpBvpB,EAAO1I,OAAO,IAAIS,MAAMguB,GAE5B,OAAO/lB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAvBH,CACH0uB,UAAM7uB,EACN8uB,cAAU9uB,EACVqtB,WAAY,IAqBZ,KAAOjzB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ0uB,KAAOj9B,EAAQg7B,OAAOloB,OAAOtK,EAAQA,EAAOgB,UACpD,MACJ,KAAK,EACD+E,EAAQ2uB,SAAWl9B,EAAQ+6B,SAASjoB,OAAOtK,EAAQA,EAAOgB,UAC1D,MACJ,KAAK,EACD+E,EAAQktB,WAAWr9B,KAAKoK,EAAOyB,SAC/B,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EA5CH,CACHitB,UAAM7uB,EACN8uB,cAAU9uB,EACVqtB,WAAY,IAgDZ,OANI,EAAIvC,EAAUnpB,OAAOkqB,EAAOgD,QAC5BjtB,EAAIitB,KAAOj9B,EAAQg7B,OAAOhB,SAASC,EAAOgD,QAC1C,EAAI/D,EAAUnpB,OAAOkqB,EAAOiD,YAC5BltB,EAAIktB,SAAWl9B,EAAQ+6B,SAASf,SAASC,EAAOiD,WAChD59B,MAAMuJ,QAAQoxB,GAAQwB,cACtBzrB,EAAIyrB,WAAaxB,EAAOwB,WAAWna,KAAKnR,IAAM,EAAI+oB,EAAUiE,iBAAiBhtB,MAC1EH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAUb,YATiB5B,IAAjBG,EAAQ0uB,OAAuBjtB,EAAIitB,KAAO1uB,EAAQ0uB,KAAOj9B,EAAQg7B,OAAO9S,OAAO3Z,EAAQ0uB,WAAQ7uB,QAC1EA,IAArBG,EAAQ2uB,WACHltB,EAAIktB,SAAW3uB,EAAQ2uB,SAAWl9B,EAAQ+6B,SAAS7S,OAAO3Z,EAAQ2uB,eAAY9uB,GAC/EG,EAAQktB,WACRzrB,EAAIyrB,WAAaltB,EAAQktB,WAAWna,KAAKnR,IAAM,EAAI+oB,EAAUkE,sBAAuBhvB,IAAN+B,EAAkBA,EAAI,IAAIjP,cAGxG8O,EAAIyrB,WAAa,GAEdzrB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAnEH,CACH0uB,UAAM7uB,EACN8uB,cAAU9uB,EACVqtB,WAAY,IAwEZ,YAPoBrtB,IAAhB6rB,EAAOgD,MAAsC,OAAhBhD,EAAOgD,OACpC1uB,EAAQ0uB,KAAOj9B,EAAQg7B,OAAOzB,YAAYU,EAAOgD,YAE7B7uB,IAApB6rB,EAAOiD,UAA8C,OAApBjD,EAAOiD,WACxC3uB,EAAQ2uB,SAAWl9B,EAAQ+6B,SAASxB,YAAYU,EAAOiD,WAE3D3uB,EAAQktB,WAAaxB,EAAOwB,YAAYna,KAAKnR,GAAMA,KAAM,GAClD5B,CACX,GA6KJvO,EAAQi7B,iBAAmB,CACvBzB,QAAS,sCACT/jB,OAAM,CAAClH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,YACV,IAA7BkJ,EAAQgtB,UAAU59B,QAClBuU,EAAO1I,OAAO,IAAIS,MAAMsE,EAAQgtB,gBAEVntB,IAAtBG,EAAQutB,WACRX,EAAMkC,IAAI5nB,OAAOlH,EAAQutB,UAAW5pB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAE1C,KAApB3E,EAAQotB,SACRzpB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQotB,SAEjCptB,EAAQqtB,gBAAkBjT,OAAO,IACjCzW,EAAO1I,OAAO,IAAIsB,OAAOyD,EAAQqtB,eAEjCrtB,EAAQwtB,WAAapT,OAAO,IAC5BzW,EAAO1I,OAAO,IAAIsB,OAAOyD,EAAQwtB,eAEjB3tB,IAAhBG,EAAQytB,KACRh8B,EAAQy6B,IAAIhlB,OAAOlH,EAAQytB,IAAK9pB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEvDhB,GAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAAUstB,IAChB,KAAOrzB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQgtB,UAAY/yB,EAAOyB,QAC3B,MACJ,KAAK,EACDsE,EAAQutB,UAAYX,EAAMkC,IAAIvqB,OAAOtK,EAAQA,EAAOgB,UACpD,MACJ,KAAK,EACD+E,EAAQotB,QAAUnzB,EAAO4B,SACzB,MACJ,KAAK,EACDmE,EAAQqtB,cAAgBpzB,EAAOsC,SAC/B,MACJ,KAAK,EACDyD,EAAQwtB,SAAWvzB,EAAOsC,SAC1B,MACJ,KAAK,EACDyD,EAAQytB,IAAMh8B,EAAQy6B,IAAI3nB,OAAOtK,EAAQA,EAAOgB,UAChD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EAAM6rB,IAaZ,OAZI,EAAI3C,EAAUnpB,OAAOkqB,EAAOsB,aAC5BvrB,EAAIurB,WAAY,EAAIrC,EAAUiE,iBAAiBlD,EAAOsB,aACtD,EAAIrC,EAAUnpB,OAAOkqB,EAAO6B,aAC5B9rB,EAAI8rB,UAAYX,EAAMkC,IAAIrD,SAASC,EAAO6B,aAC1C,EAAI5C,EAAUnpB,OAAOkqB,EAAO0B,WAC5B3rB,EAAI2rB,QAAU99B,OAAOo8B,EAAO0B,WAC5B,EAAIzC,EAAUnpB,OAAOkqB,EAAO2B,iBAC5B5rB,EAAI4rB,cAAgBjT,OAAOsR,EAAO2B,cAAcvwB,cAChD,EAAI6tB,EAAUnpB,OAAOkqB,EAAO8B,YAC5B/rB,EAAI+rB,SAAWpT,OAAOsR,EAAO8B,SAAS1wB,cACtC,EAAI6tB,EAAUnpB,OAAOkqB,EAAO+B,OAC5BhsB,EAAIgsB,IAAMh8B,EAAQy6B,IAAIT,SAASC,EAAO+B,MACnChsB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAUb,YATsB5B,IAAtBG,EAAQgtB,YACHvrB,EAAIurB,WAAY,EAAIrC,EAAUkE,sBAAuChvB,IAAtBG,EAAQgtB,UAA0BhtB,EAAQgtB,UAAY,IAAIr6B,kBACxFkN,IAAtBG,EAAQutB,YACH9rB,EAAI8rB,UAAYvtB,EAAQutB,UAAYX,EAAMkC,IAAInV,OAAO3Z,EAAQutB,gBAAa1tB,QAC3DA,IAApBG,EAAQotB,UAA0B3rB,EAAI2rB,QAAUptB,EAAQotB,cAC9BvtB,IAA1BG,EAAQqtB,gBACH5rB,EAAI4rB,eAAiBrtB,EAAQqtB,eAAiBjT,OAAO,IAAItd,iBACzC+C,IAArBG,EAAQwtB,WAA2B/rB,EAAI+rB,UAAYxtB,EAAQwtB,UAAYpT,OAAO,IAAItd,iBAClE+C,IAAhBG,EAAQytB,MAAsBhsB,EAAIgsB,IAAMztB,EAAQytB,IAAMh8B,EAAQy6B,IAAIvS,OAAO3Z,EAAQytB,UAAO5tB,GACjF4B,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAAUstB,IAehB,OAdAttB,EAAQgtB,UAAYtB,EAAOsB,WAAa,IAAIr6B,gBACnBkN,IAArB6rB,EAAO6B,WAAgD,OAArB7B,EAAO6B,YACzCvtB,EAAQutB,UAAYX,EAAMkC,IAAI9D,YAAYU,EAAO6B,YAErDvtB,EAAQotB,QAAU1B,EAAO0B,SAAW,QACPvtB,IAAzB6rB,EAAO2B,eAAwD,OAAzB3B,EAAO2B,gBAC7CrtB,EAAQqtB,cAAgBjT,OAAOsR,EAAO2B,cAAcvwB,kBAEhC+C,IAApB6rB,EAAO8B,UAA8C,OAApB9B,EAAO8B,WACxCxtB,EAAQwtB,SAAWpT,OAAOsR,EAAO8B,SAAS1wB,kBAE3B+C,IAAf6rB,EAAO+B,KAAoC,OAAf/B,EAAO+B,MACnCztB,EAAQytB,IAAMh8B,EAAQy6B,IAAIlB,YAAYU,EAAO+B,MAE1CztB,CACX,GAWJvO,EAAQg7B,OAAS,CACbxB,QAAS,4BACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UAC3C,IAAK,MAAM4yB,KAAK1pB,EAAQ2tB,SACpBf,EAAMkC,IAAI5nB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAE7B,KAAjB3E,EAAQ4tB,MACRjqB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQ4tB,MAEjC5tB,EAAQ6tB,gBAAkBzT,OAAO,IACjCzW,EAAO1I,OAAO,IAAIsB,OAAOyD,EAAQ6tB,eAErC,IAAK,MAAMnE,KAAK1pB,EAAQ8tB,iBACpBlB,EAAMkC,IAAI5nB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,MAAMwJ,QAAQE,SAEpD,IAAK,MAAM+kB,KAAK1pB,EAAQ+tB,4BACpBnB,EAAMkC,IAAI5nB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,OAAOwJ,QAAQE,SAErD,OAAOhB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAAU0tB,IAChB,KAAOzzB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ2tB,SAAS99B,KAAK+8B,EAAMkC,IAAIvqB,OAAOtK,EAAQA,EAAOgB,WACtD,MACJ,KAAK,EACD+E,EAAQ4tB,KAAO3zB,EAAO4B,SACtB,MACJ,KAAK,EACDmE,EAAQ6tB,cAAgB5zB,EAAOsC,SAC/B,MACJ,KAAK,KACDyD,EAAQ8tB,iBAAiBj+B,KAAK+8B,EAAMkC,IAAIvqB,OAAOtK,EAAQA,EAAOgB,WAC9D,MACJ,KAAK,KACD+E,EAAQ+tB,4BAA4Bl+B,KAAK+8B,EAAMkC,IAAIvqB,OAAOtK,EAAQA,EAAOgB,WACzE,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EAAMisB,IAWZ,OAVI38B,MAAMuJ,QAAQoxB,GAAQiC,YACtBlsB,EAAIksB,SAAWjC,EAAOiC,SAAS5a,KAAKnR,GAAMgrB,EAAMkC,IAAIrD,SAAS7pB,OAC7D,EAAI+oB,EAAUnpB,OAAOkqB,EAAOkC,QAC5BnsB,EAAImsB,KAAOt+B,OAAOo8B,EAAOkC,QACzB,EAAIjD,EAAUnpB,OAAOkqB,EAAOmC,iBAC5BpsB,EAAIosB,cAAgBzT,OAAOsR,EAAOmC,cAAc/wB,aAChD/L,MAAMuJ,QAAQoxB,GAAQoC,oBACtBrsB,EAAIqsB,iBAAmBpC,EAAOoC,iBAAiB/a,KAAKnR,GAAMgrB,EAAMkC,IAAIrD,SAAS7pB,MAC7E7Q,MAAMuJ,QAAQoxB,GAAQqC,+BACtBtsB,EAAIssB,4BAA8BrC,EAAOqC,4BAA4Bhb,KAAKnR,GAAMgrB,EAAMkC,IAAIrD,SAAS7pB,MAChGH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAsBb,OArBIzB,EAAQ2tB,SACRlsB,EAAIksB,SAAW3tB,EAAQ2tB,SAAS5a,KAAKnR,GAAOA,EAAIgrB,EAAMkC,IAAInV,OAAO/X,QAAK/B,IAGtE4B,EAAIksB,SAAW,QAEF9tB,IAAjBG,EAAQ4tB,OAAuBnsB,EAAImsB,KAAO5tB,EAAQ4tB,WACxB/tB,IAA1BG,EAAQ6tB,gBACHpsB,EAAIosB,eAAiB7tB,EAAQ6tB,eAAiBzT,OAAO,IAAItd,YAC1DkD,EAAQ8tB,iBACRrsB,EAAIqsB,iBAAmB9tB,EAAQ8tB,iBAAiB/a,KAAKnR,GAAOA,EAAIgrB,EAAMkC,IAAInV,OAAO/X,QAAK/B,IAGtF4B,EAAIqsB,iBAAmB,GAEvB9tB,EAAQ+tB,4BACRtsB,EAAIssB,4BAA8B/tB,EAAQ+tB,4BAA4Bhb,KAAKnR,GAAMA,EAAIgrB,EAAMkC,IAAInV,OAAO/X,QAAK/B,IAG3G4B,EAAIssB,4BAA8B,GAE/BtsB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAAU0tB,IAShB,OARA1tB,EAAQ2tB,SAAWjC,EAAOiC,UAAU5a,KAAKnR,GAAMgrB,EAAMkC,IAAI9D,YAAYppB,MAAO,GAC5E5B,EAAQ4tB,KAAOlC,EAAOkC,MAAQ,QACD/tB,IAAzB6rB,EAAOmC,eAAwD,OAAzBnC,EAAOmC,gBAC7C7tB,EAAQ6tB,cAAgBzT,OAAOsR,EAAOmC,cAAc/wB,aAExDkD,EAAQ8tB,iBAAmBpC,EAAOoC,kBAAkB/a,KAAKnR,GAAMgrB,EAAMkC,IAAI9D,YAAYppB,MAAO,GAC5F5B,EAAQ+tB,4BACJrC,EAAOqC,6BAA6Bhb,KAAKnR,GAAMgrB,EAAMkC,IAAI9D,YAAYppB,MAAO,GACzE5B,CACX,GASJvO,EAAQ+6B,SAAW,CACfvB,QAAS,8BACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UAC3C,IAAK,MAAM4yB,KAAK1pB,EAAQ+uB,YACpBt9B,EAAQ86B,WAAWrlB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAQ3D,YANoB9E,IAAhBG,EAAQgvB,KACRv9B,EAAQ06B,IAAIjlB,OAAOlH,EAAQgvB,IAAKrrB,EAAO1I,OAAO,IAAIwJ,QAAQE,cAE1C9E,IAAhBG,EAAQytB,KACRh8B,EAAQy6B,IAAIhlB,OAAOlH,EAAQytB,IAAK9pB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEvDhB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAvBH,CACH+uB,YAAa,GACbC,SAAKnvB,EACL4tB,SAAK5tB,GAqBL,KAAO5F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQ+uB,YAAYl/B,KAAK4B,EAAQ86B,WAAWhoB,OAAOtK,EAAQA,EAAOgB,WAClE,MACJ,KAAK,EACD+E,EAAQgvB,IAAMv9B,EAAQ06B,IAAI5nB,OAAOtK,EAAQA,EAAOgB,UAChD,MACJ,KAAK,EACD+E,EAAQytB,IAAMh8B,EAAQy6B,IAAI3nB,OAAOtK,EAAQA,EAAOgB,UAChD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EA5CH,CACHstB,YAAa,GACbC,SAAKnvB,EACL4tB,SAAK5tB,GAgDL,OANI9O,MAAMuJ,QAAQoxB,GAAQqD,eACtBttB,EAAIstB,YAAcrD,EAAOqD,YAAYhc,KAAKnR,GAAMnQ,EAAQ86B,WAAWd,SAAS7pB,OAC5E,EAAI+oB,EAAUnpB,OAAOkqB,EAAOsD,OAC5BvtB,EAAIutB,IAAMv9B,EAAQ06B,IAAIV,SAASC,EAAOsD,OACtC,EAAIrE,EAAUnpB,OAAOkqB,EAAO+B,OAC5BhsB,EAAIgsB,IAAMh8B,EAAQy6B,IAAIT,SAASC,EAAO+B,MACnChsB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EASb,OARIzB,EAAQ+uB,YACRttB,EAAIstB,YAAc/uB,EAAQ+uB,YAAYhc,KAAKnR,GAAOA,EAAInQ,EAAQ86B,WAAW5S,OAAO/X,QAAK/B,IAGrF4B,EAAIstB,YAAc,QAENlvB,IAAhBG,EAAQgvB,MAAsBvtB,EAAIutB,IAAMhvB,EAAQgvB,IAAMv9B,EAAQ06B,IAAIxS,OAAO3Z,EAAQgvB,UAAOnvB,QACxEA,IAAhBG,EAAQytB,MAAsBhsB,EAAIgsB,IAAMztB,EAAQytB,IAAMh8B,EAAQy6B,IAAIvS,OAAO3Z,EAAQytB,UAAO5tB,GACjF4B,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAlEH,CACH+uB,YAAa,GACbC,SAAKnvB,EACL4tB,SAAK5tB,GAuEL,OAPAG,EAAQ+uB,YAAcrD,EAAOqD,aAAahc,KAAKnR,GAAMnQ,EAAQ86B,WAAWvB,YAAYppB,MAAO,QACxE/B,IAAf6rB,EAAOsD,KAAoC,OAAftD,EAAOsD,MACnChvB,EAAQgvB,IAAMv9B,EAAQ06B,IAAInB,YAAYU,EAAOsD,WAE9BnvB,IAAf6rB,EAAO+B,KAAoC,OAAf/B,EAAO+B,MACnCztB,EAAQytB,IAAMh8B,EAAQy6B,IAAIlB,YAAYU,EAAO+B,MAE1CztB,CACX,GASJvO,EAAQ86B,WAAa,CACjBtB,QAAS,gCACT/jB,OAAM,CAAClH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,iBACjB+I,IAAtBG,EAAQutB,WACRX,EAAMkC,IAAI5nB,OAAOlH,EAAQutB,UAAW5pB,EAAO1I,OAAO,IAAIwJ,QAAQE,cAEzC9E,IAArBG,EAAQiuB,UACRx8B,EAAQ66B,SAASplB,OAAOlH,EAAQiuB,SAAUtqB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEpE3E,EAAQwtB,WAAapT,OAAO,IAC5BzW,EAAO1I,OAAO,IAAIsB,OAAOyD,EAAQwtB,UAE9B7pB,GAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAAUguB,IAChB,KAAO/zB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQutB,UAAYX,EAAMkC,IAAIvqB,OAAOtK,EAAQA,EAAOgB,UACpD,MACJ,KAAK,EACD+E,EAAQiuB,SAAWx8B,EAAQ66B,SAAS/nB,OAAOtK,EAAQA,EAAOgB,UAC1D,MACJ,KAAK,EACD+E,EAAQwtB,SAAWvzB,EAAOsC,SAC1B,MACJ,QACItC,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EAAMusB,IAOZ,OANI,EAAIrD,EAAUnpB,OAAOkqB,EAAO6B,aAC5B9rB,EAAI8rB,UAAYX,EAAMkC,IAAIrD,SAASC,EAAO6B,aAC1C,EAAI5C,EAAUnpB,OAAOkqB,EAAOuC,YAC5BxsB,EAAIwsB,SAAWx8B,EAAQ66B,SAASb,SAASC,EAAOuC,YAChD,EAAItD,EAAUnpB,OAAOkqB,EAAO8B,YAC5B/rB,EAAI+rB,SAAWpT,OAAOsR,EAAO8B,SAAS1wB,aACnC2E,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAMb,YALsB5B,IAAtBG,EAAQutB,YACH9rB,EAAI8rB,UAAYvtB,EAAQutB,UAAYX,EAAMkC,IAAInV,OAAO3Z,EAAQutB,gBAAa1tB,QAC1DA,IAArBG,EAAQiuB,WACHxsB,EAAIwsB,SAAWjuB,EAAQiuB,SAAWx8B,EAAQ66B,SAAS3S,OAAO3Z,EAAQiuB,eAAYpuB,QAC9DA,IAArBG,EAAQwtB,WAA2B/rB,EAAI+rB,UAAYxtB,EAAQwtB,UAAYpT,OAAO,IAAItd,YAC3E2E,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAAUguB,IAUhB,YATyBnuB,IAArB6rB,EAAO6B,WAAgD,OAArB7B,EAAO6B,YACzCvtB,EAAQutB,UAAYX,EAAMkC,IAAI9D,YAAYU,EAAO6B,iBAE7B1tB,IAApB6rB,EAAOuC,UAA8C,OAApBvC,EAAOuC,WACxCjuB,EAAQiuB,SAAWx8B,EAAQ66B,SAAStB,YAAYU,EAAOuC,gBAEnCpuB,IAApB6rB,EAAO8B,UAA8C,OAApB9B,EAAO8B,WACxCxtB,EAAQwtB,SAAWpT,OAAOsR,EAAO8B,SAAS1wB,aAEvCkD,CACX,GAQJvO,EAAQ66B,SAAW,CACfrB,QAAS,8BACT/jB,OAAM,CAAClH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,iBACpB+I,IAAnBG,EAAQivB,QACRx9B,EAAQ46B,gBAAgBnlB,OAAOlH,EAAQivB,OAAQtrB,EAAO1I,OAAO,IAAIwJ,QAAQE,cAEvD9E,IAAlBG,EAAQkvB,OACRz9B,EAAQ26B,eAAellB,OAAOlH,EAAQkvB,MAAOvrB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEpEhB,GAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAnBH,CACHivB,YAAQpvB,EACRqvB,WAAOrvB,GAkBP,KAAO5F,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQivB,OAASx9B,EAAQ46B,gBAAgB9nB,OAAOtK,EAAQA,EAAOgB,UAC/D,MACJ,KAAK,EACD+E,EAAQkvB,MAAQz9B,EAAQ26B,eAAe7nB,OAAOtK,EAAQA,EAAOgB,UAC7D,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EArCH,CACHwtB,YAAQpvB,EACRqvB,WAAOrvB,GAwCP,OAJI,EAAI8qB,EAAUnpB,OAAOkqB,EAAOuD,UAC5BxtB,EAAIwtB,OAASx9B,EAAQ46B,gBAAgBZ,SAASC,EAAOuD,UACrD,EAAItE,EAAUnpB,OAAOkqB,EAAOwD,SAC5BztB,EAAIytB,MAAQz9B,EAAQ26B,eAAeX,SAASC,EAAOwD,QAChDztB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAKb,YAJmB5B,IAAnBG,EAAQivB,SACHxtB,EAAIwtB,OAASjvB,EAAQivB,OAASx9B,EAAQ46B,gBAAgB1S,OAAO3Z,EAAQivB,aAAUpvB,QAClEA,IAAlBG,EAAQkvB,QACHztB,EAAIytB,MAAQlvB,EAAQkvB,MAAQz9B,EAAQ26B,eAAezS,OAAO3Z,EAAQkvB,YAASrvB,GACzE4B,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EArDH,CACHivB,YAAQpvB,EACRqvB,WAAOrvB,GA0DP,YANsBA,IAAlB6rB,EAAOuD,QAA0C,OAAlBvD,EAAOuD,SACtCjvB,EAAQivB,OAASx9B,EAAQ46B,gBAAgBrB,YAAYU,EAAOuD,cAE3CpvB,IAAjB6rB,EAAOwD,OAAwC,OAAjBxD,EAAOwD,QACrClvB,EAAQkvB,MAAQz9B,EAAQ26B,eAAepB,YAAYU,EAAOwD,QAEvDlvB,CACX,GAOJvO,EAAQ46B,gBAAkB,CACtBpB,QAAS,4BACT/jB,OAAM,CAAClH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,YACtB,IAAjBkJ,EAAQgiB,MACRre,EAAO1I,OAAO,GAAGC,MAAM8E,EAAQgiB,MAE5Bre,GAEXY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAfH,CACHgiB,KAAM,GAeN,KAAO/nB,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,GAAQuwB,IAAQ,GACP,EACDxrB,EAAQgiB,KAAO/nB,EAAOiB,aAGtBjB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EA9BH,CACHugB,KAAM,GAgCN,OAFI,EAAI2I,EAAUnpB,OAAOkqB,EAAO1J,QAC5BvgB,EAAIugB,MAAO,EAAI6K,EAAUsC,kBAAkBzD,EAAO1J,OAC/CvgB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAEb,YADiB5B,IAAjBG,EAAQgiB,OAAuBvgB,EAAIugB,MAAO,EAAI6K,EAAUuC,gBAAgBpvB,EAAQgiB,OACzEvgB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAzCH,CACHgiB,KAAM,GA0CN,OADAhiB,EAAQgiB,KAAO0J,EAAO1J,MAAQ,EACvBhiB,CACX,GAQJvO,EAAQ26B,eAAiB,CACrBnB,QAAS,2BACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,eAClB+I,IAArBG,EAAQqvB,UACRvC,EAAWwC,gBAAgBpoB,OAAOlH,EAAQqvB,SAAU1rB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAElF,IAAK,MAAM+kB,KAAK1pB,EAAQuvB,UACpB99B,EAAQ66B,SAASplB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAEzD,OAAOhB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAnBH,CACHqvB,cAAUxvB,EACV0vB,UAAW,IAkBX,KAAOt1B,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQqvB,SAAWvC,EAAWwC,gBAAgB/qB,OAAOtK,EAAQA,EAAOgB,UACpE,MACJ,KAAK,EACD+E,EAAQuvB,UAAU1/B,KAAK4B,EAAQ66B,SAAS/nB,OAAOtK,EAAQA,EAAOgB,WAC9D,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EArCH,CACH4tB,cAAUxvB,EACV0vB,UAAW,IAwCX,OAJI,EAAI5E,EAAUnpB,OAAOkqB,EAAO2D,YAC5B5tB,EAAI4tB,SAAWvC,EAAWwC,gBAAgB7D,SAASC,EAAO2D,WAC1Dt+B,MAAMuJ,QAAQoxB,GAAQ6D,aACtB9tB,EAAI8tB,UAAY7D,EAAO6D,UAAUxc,KAAKnR,GAAMnQ,EAAQ66B,SAASb,SAAS7pB,MACnEH,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EASb,YARqB5B,IAArBG,EAAQqvB,WACH5tB,EAAI4tB,SAAWrvB,EAAQqvB,SAAWvC,EAAWwC,gBAAgB3V,OAAO3Z,EAAQqvB,eAAYxvB,GACzFG,EAAQuvB,UACR9tB,EAAI8tB,UAAYvvB,EAAQuvB,UAAUxc,KAAKnR,GAAOA,EAAInQ,EAAQ66B,SAAS3S,OAAO/X,QAAK/B,IAG/E4B,EAAI8tB,UAAY,GAEb9tB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAzDH,CACHqvB,cAAUxvB,EACV0vB,UAAW,IA4DX,YAJwB1vB,IAApB6rB,EAAO2D,UAA8C,OAApB3D,EAAO2D,WACxCrvB,EAAQqvB,SAAWvC,EAAWwC,gBAAgBtE,YAAYU,EAAO2D,WAErErvB,EAAQuvB,UAAY7D,EAAO6D,WAAWxc,KAAKnR,GAAMnQ,EAAQ66B,SAAStB,YAAYppB,MAAO,GAC9E5B,CACX,GAUJvO,EAAQ06B,IAAM,CACVlB,QAAS,yBACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UAC3C,IAAK,MAAM4yB,KAAK1pB,EAAQqrB,OACpBb,EAAOc,KAAKpkB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAWpD,OATI3E,EAAQmuB,WAAa/T,OAAO,IAC5BzW,EAAO1I,OAAO,IAAIsB,OAAOyD,EAAQmuB,UAEf,KAAlBnuB,EAAQouB,OACRzqB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQouB,OAEb,KAApBpuB,EAAQquB,SACR1qB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQquB,SAE9B1qB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAAUkuB,IAChB,KAAOj0B,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQqrB,OAAOx7B,KAAK26B,EAAOc,KAAK/mB,OAAOtK,EAAQA,EAAOgB,WACtD,MACJ,KAAK,EACD+E,EAAQmuB,SAAWl0B,EAAOsC,SAC1B,MACJ,KAAK,EACDyD,EAAQouB,MAAQn0B,EAAO4B,SACvB,MACJ,KAAK,EACDmE,EAAQquB,QAAUp0B,EAAO4B,SACzB,MACJ,QACI5B,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EAAMysB,IASZ,OARIn9B,MAAMuJ,QAAQoxB,GAAQL,UACtB5pB,EAAI4pB,OAASK,EAAOL,OAAOtY,KAAKnR,GAAM4oB,EAAOc,KAAKG,SAAS7pB,OAC3D,EAAI+oB,EAAUnpB,OAAOkqB,EAAOyC,YAC5B1sB,EAAI0sB,SAAW/T,OAAOsR,EAAOyC,SAASrxB,cACtC,EAAI6tB,EAAUnpB,OAAOkqB,EAAO0C,SAC5B3sB,EAAI2sB,MAAQ9+B,OAAOo8B,EAAO0C,SAC1B,EAAIzD,EAAUnpB,OAAOkqB,EAAO2C,WAC5B5sB,EAAI4sB,QAAU/+B,OAAOo8B,EAAO2C,UACzB5sB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAUb,OATIzB,EAAQqrB,OACR5pB,EAAI4pB,OAASrrB,EAAQqrB,OAAOtY,KAAKnR,GAAOA,EAAI4oB,EAAOc,KAAK3R,OAAO/X,QAAK/B,IAGpE4B,EAAI4pB,OAAS,QAEIxrB,IAArBG,EAAQmuB,WAA2B1sB,EAAI0sB,UAAYnuB,EAAQmuB,UAAY/T,OAAO,IAAItd,iBAChE+C,IAAlBG,EAAQouB,QAAwB3sB,EAAI2sB,MAAQpuB,EAAQouB,YAChCvuB,IAApBG,EAAQquB,UAA0B5sB,EAAI4sB,QAAUruB,EAAQquB,SACjD5sB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAAUkuB,IAOhB,OANAluB,EAAQqrB,OAASK,EAAOL,QAAQtY,KAAKnR,GAAM4oB,EAAOc,KAAKN,YAAYppB,MAAO,QAClD/B,IAApB6rB,EAAOyC,UAA8C,OAApBzC,EAAOyC,WACxCnuB,EAAQmuB,SAAW/T,OAAOsR,EAAOyC,SAASrxB,aAE9CkD,EAAQouB,MAAQ1C,EAAO0C,OAAS,GAChCpuB,EAAQquB,QAAU3C,EAAO2C,SAAW,GAC7BruB,CACX,GAQJvO,EAAQy6B,IAAM,CACVjB,QAAS,yBACT/jB,OAAOlH,EAAS2D,EAAS+mB,EAASQ,aAAap0B,UAC3C,IAAK,MAAM4yB,KAAK1pB,EAAQqrB,OACpBb,EAAOc,KAAKpkB,OAAOwiB,EAAG/lB,EAAO1I,OAAO,IAAIwJ,QAAQE,SAKpD,MAHuB,KAAnB3E,EAAQwvB,QACR7rB,EAAO1I,OAAO,IAAIY,OAAOmE,EAAQwvB,QAE9B7rB,CACX,EACAY,OAAOrQ,EAAO9E,GACV,MAAM6K,EAAS/F,aAAiBw2B,EAASa,aAAer3B,EAAQ,IAAIw2B,EAASa,aAAar3B,GAC1F,IAAI4G,OAAiB+E,IAAXzQ,EAAuB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EAC3D,MAAM4Q,EAnBH,CACHqrB,OAAQ,GACRmE,OAAQ,IAkBR,KAAOv1B,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACDxrB,EAAQqrB,OAAOx7B,KAAK26B,EAAOc,KAAK/mB,OAAOtK,EAAQA,EAAOgB,WACtD,MACJ,KAAK,EACD+E,EAAQwvB,OAASv1B,EAAO4B,SACxB,MACJ,QACI5B,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAOxrB,CACX,EACAyrB,SAASC,GACL,MAAMjqB,EArCH,CACH4pB,OAAQ,GACRmE,OAAQ,IAwCR,OAJIz+B,MAAMuJ,QAAQoxB,GAAQL,UACtB5pB,EAAI4pB,OAASK,EAAOL,OAAOtY,KAAKnR,GAAM4oB,EAAOc,KAAKG,SAAS7pB,OAC3D,EAAI+oB,EAAUnpB,OAAOkqB,EAAO8D,UAC5B/tB,EAAI+tB,OAASlgC,OAAOo8B,EAAO8D,SACxB/tB,CACX,EACAkY,OAAO3Z,GACH,MAAMyB,EAAM,CAAC,EAQb,OAPIzB,EAAQqrB,OACR5pB,EAAI4pB,OAASrrB,EAAQqrB,OAAOtY,KAAKnR,GAAOA,EAAI4oB,EAAOc,KAAK3R,OAAO/X,QAAK/B,IAGpE4B,EAAI4pB,OAAS,QAEExrB,IAAnBG,EAAQwvB,SAAyB/tB,EAAI+tB,OAASxvB,EAAQwvB,QAC/C/tB,CACX,EACAupB,YAAYU,GACR,MAAM1rB,EAxDH,CACHqrB,OAAQ,GACRmE,OAAQ,IAyDR,OAFAxvB,EAAQqrB,OAASK,EAAOL,QAAQtY,KAAKnR,GAAM4oB,EAAOc,KAAKN,YAAYppB,MAAO,GAC1E5B,EAAQwvB,OAAS9D,EAAO8D,QAAU,GAC3BxvB,CACX,wBC17BJ,IAAIa,EAAyB,oBAATjD,KAAuBA,KAAOzF,KAC9Cs3B,EAAW,WACf,SAASC,IACTv3B,KAAKw3B,OAAQ,EACbx3B,KAAKy3B,aAAe/uB,EAAO+uB,YAC3B,CAEA,OADAF,EAAE1+B,UAAY6P,EACP,IAAI6uB,CACV,CAPc,IAQf,SAAU9xB,IAEO,SAAWnM,GAE1B,IAAIo+B,EAAU,CACZC,aAAc,oBAAqBlyB,EACnCmyB,SAAU,WAAYnyB,GAAQ,aAAcjP,OAC5CqhC,KACE,eAAgBpyB,GAChB,SAAUA,GACV,WACE,IAEE,OADA,IAAIqyB,MACG,CACT,CAAE,MAAOruB,GACP,OAAO,CACT,CACD,CAPD,GAQFsuB,SAAU,aAActyB,EACxBjH,YAAa,gBAAiBiH,GAOhC,GAAIiyB,EAAQl5B,YACV,IAAIw5B,EAAc,CAChB,qBACA,sBACA,6BACA,sBACA,uBACA,sBACA,uBACA,wBACA,yBAGEC,EACFpc,YAAYC,QACZ,SAASxS,GACP,OAAOA,GAAO0uB,EAAYz4B,QAAQb,OAAO7F,UAAU8L,SAAS5L,KAAKuQ,KAAS,CAC5E,EAGJ,SAAS4uB,EAAc74B,GAIrB,GAHoB,iBAATA,IACTA,EAAOlI,OAAOkI,IAEZ,4BAA4BkB,KAAKlB,GACnC,MAAM,IAAI2F,UAAU,0CAEtB,OAAO3F,EAAKkL,aACd,CAEA,SAAS4tB,EAAet5B,GAItB,MAHqB,iBAAVA,IACTA,EAAQ1H,OAAO0H,IAEVA,CACT,CAGA,SAASu5B,EAAYjmB,GACnB,IAAIyF,EAAW,CACbvM,KAAM,WACJ,IAAIxM,EAAQsT,EAAM/S,QAClB,MAAO,CAACi5B,UAAgB3wB,IAAV7I,EAAqBA,MAAOA,EAC5C,GASF,OANI64B,EAAQE,WACVhgB,EAASphB,OAAOohB,UAAY,WAC1B,OAAOA,CACT,GAGKA,CACT,CAEA,SAAS0gB,EAAQC,GACfv4B,KAAK4a,IAAM,CAAC,EAER2d,aAAmBD,EACrBC,EAAQn4B,SAAQ,SAASvB,EAAOQ,GAC9BW,KAAKw4B,OAAOn5B,EAAMR,EACpB,GAAGmB,MACMpH,MAAMuJ,QAAQo2B,GACvBA,EAAQn4B,SAAQ,SAASq4B,GACvBz4B,KAAKw4B,OAAOC,EAAO,GAAIA,EAAO,GAChC,GAAGz4B,MACMu4B,GACT75B,OAAOyB,oBAAoBo4B,GAASn4B,SAAQ,SAASf,GACnDW,KAAKw4B,OAAOn5B,EAAMk5B,EAAQl5B,GAC5B,GAAGW,KAEP,CA8DA,SAAS04B,EAASnC,GAChB,GAAIA,EAAKoC,SACP,OAAOnnB,QAAQE,OAAO,IAAI1M,UAAU,iBAEtCuxB,EAAKoC,UAAW,CAClB,CAEA,SAASC,EAAgB92B,GACvB,OAAO,IAAI0P,SAAQ,SAASC,EAASC,GACnC5P,EAAO+2B,OAAS,WACdpnB,EAAQ3P,EAAO8X,OACjB,EACA9X,EAAOwnB,QAAU,WACf5X,EAAO5P,EAAOse,MAChB,CACF,GACF,CAEA,SAAS0Y,EAAsBjB,GAC7B,IAAI/1B,EAAS,IAAIi3B,WACbxnB,EAAUqnB,EAAgB92B,GAE9B,OADAA,EAAOk3B,kBAAkBnB,GAClBtmB,CACT,CAmBA,SAAS0nB,EAAYl+B,GACnB,GAAIA,EAAIjC,MACN,OAAOiC,EAAIjC,MAAM,GAEjB,IAAI8C,EAAO,IAAIpB,WAAWO,EAAI8R,YAE9B,OADAjR,EAAKC,IAAI,IAAIrB,WAAWO,IACjBa,EAAKjF,MAEhB,CAEA,SAASuiC,IA0FP,OAzFAl5B,KAAK24B,UAAW,EAEhB34B,KAAKm5B,UAAY,SAAS5C,GAhM5B,IAAoBjtB,EAiMhBtJ,KAAKo5B,UAAY7C,EACZA,EAEsB,iBAATA,EAChBv2B,KAAKq5B,UAAY9C,EACRmB,EAAQG,MAAQC,KAAKj/B,UAAUygC,cAAc/C,GACtDv2B,KAAKu5B,UAAYhD,EACRmB,EAAQK,UAAYyB,SAAS3gC,UAAUygC,cAAc/C,GAC9Dv2B,KAAKy5B,cAAgBlD,EACZmB,EAAQC,cAAgB+B,gBAAgB7gC,UAAUygC,cAAc/C,GACzEv2B,KAAKq5B,UAAY9C,EAAK5xB,WACb+yB,EAAQl5B,aAAek5B,EAAQG,QA5M1BvuB,EA4M6CitB,IA3MjDoD,SAAS9gC,UAAUygC,cAAchwB,KA4M3CtJ,KAAK45B,iBAAmBX,EAAY1C,EAAK5/B,QAEzCqJ,KAAKo5B,UAAY,IAAItB,KAAK,CAAC93B,KAAK45B,oBACvBlC,EAAQl5B,cAAgBqd,YAAYhjB,UAAUygC,cAAc/C,IAAS0B,EAAkB1B,IAChGv2B,KAAK45B,iBAAmBX,EAAY1C,GAEpCv2B,KAAKq5B,UAAY9C,EAAO73B,OAAO7F,UAAU8L,SAAS5L,KAAKw9B,GAhBvDv2B,KAAKq5B,UAAY,GAmBdr5B,KAAKu4B,QAAQ53B,IAAI,kBACA,iBAAT41B,EACTv2B,KAAKu4B,QAAQ18B,IAAI,eAAgB,4BACxBmE,KAAKu5B,WAAav5B,KAAKu5B,UAAUrqB,KAC1ClP,KAAKu4B,QAAQ18B,IAAI,eAAgBmE,KAAKu5B,UAAUrqB,MACvCwoB,EAAQC,cAAgB+B,gBAAgB7gC,UAAUygC,cAAc/C,IACzEv2B,KAAKu4B,QAAQ18B,IAAI,eAAgB,mDAGvC,EAEI67B,EAAQG,OACV73B,KAAK63B,KAAO,WACV,IAAIgC,EAAWnB,EAAS14B,MACxB,GAAI65B,EACF,OAAOA,EAGT,GAAI75B,KAAKu5B,UACP,OAAO/nB,QAAQC,QAAQzR,KAAKu5B,WACvB,GAAIv5B,KAAK45B,iBACd,OAAOpoB,QAAQC,QAAQ,IAAIqmB,KAAK,CAAC93B,KAAK45B,oBACjC,GAAI55B,KAAKy5B,cACd,MAAM,IAAIlhC,MAAM,wCAEhB,OAAOiZ,QAAQC,QAAQ,IAAIqmB,KAAK,CAAC93B,KAAKq5B,YAE1C,EAEAr5B,KAAKxB,YAAc,WACjB,OAAIwB,KAAK45B,iBACAlB,EAAS14B,OAASwR,QAAQC,QAAQzR,KAAK45B,kBAEvC55B,KAAK63B,OAAOrK,KAAKsL,EAE5B,GAGF94B,KAAK85B,KAAO,WACV,IA3FoBjC,EAClB/1B,EACAyP,EAyFEsoB,EAAWnB,EAAS14B,MACxB,GAAI65B,EACF,OAAOA,EAGT,GAAI75B,KAAKu5B,UACP,OAjGkB1B,EAiGI73B,KAAKu5B,UAhG3Bz3B,EAAS,IAAIi3B,WACbxnB,EAAUqnB,EAAgB92B,GAC9BA,EAAOi4B,WAAWlC,GACXtmB,EA8FE,GAAIvR,KAAK45B,iBACd,OAAOpoB,QAAQC,QA5FrB,SAA+B1W,GAI7B,IAHA,IAAIa,EAAO,IAAIpB,WAAWO,GACtBi/B,EAAQ,IAAIphC,MAAMgD,EAAK3E,QAElBqE,EAAI,EAAGA,EAAIM,EAAK3E,OAAQqE,IAC/B0+B,EAAM1+B,GAAKnE,OAAOC,aAAawE,EAAKN,IAEtC,OAAO0+B,EAAMriC,KAAK,GACpB,CAoF6BsiC,CAAsBj6B,KAAK45B,mBAC7C,GAAI55B,KAAKy5B,cACd,MAAM,IAAIlhC,MAAM,wCAEhB,OAAOiZ,QAAQC,QAAQzR,KAAKq5B,UAEhC,EAEI3B,EAAQK,WACV/3B,KAAK+3B,SAAW,WACd,OAAO/3B,KAAK85B,OAAOtM,KAAKphB,EAC1B,GAGFpM,KAAKgL,KAAO,WACV,OAAOhL,KAAK85B,OAAOtM,KAAK0M,KAAKlO,MAC/B,EAEOhsB,IACT,CA3MAs4B,EAAQz/B,UAAU2/B,OAAS,SAASn5B,EAAMR,GACxCQ,EAAO64B,EAAc74B,GACrBR,EAAQs5B,EAAet5B,GACvB,IAAIs7B,EAAWn6B,KAAK4a,IAAIvb,GACxBW,KAAK4a,IAAIvb,GAAQ86B,EAAWA,EAAW,KAAOt7B,EAAQA,CACxD,EAEAy5B,EAAQz/B,UAAkB,OAAI,SAASwG,UAC9BW,KAAK4a,IAAIsd,EAAc74B,GAChC,EAEAi5B,EAAQz/B,UAAU8H,IAAM,SAAStB,GAE/B,OADAA,EAAO64B,EAAc74B,GACdW,KAAKgb,IAAI3b,GAAQW,KAAK4a,IAAIvb,GAAQ,IAC3C,EAEAi5B,EAAQz/B,UAAUmiB,IAAM,SAAS3b,GAC/B,OAAOW,KAAK4a,IAAI7b,eAAem5B,EAAc74B,GAC/C,EAEAi5B,EAAQz/B,UAAUgD,IAAM,SAASwD,EAAMR,GACrCmB,KAAK4a,IAAIsd,EAAc74B,IAAS84B,EAAet5B,EACjD,EAEAy5B,EAAQz/B,UAAUuH,QAAU,SAASoF,EAAU40B,GAC7C,IAAK,IAAI/6B,KAAQW,KAAK4a,IAChB5a,KAAK4a,IAAI7b,eAAeM,IAC1BmG,EAASzM,KAAKqhC,EAASp6B,KAAK4a,IAAIvb,GAAOA,EAAMW,KAGnD,EAEAs4B,EAAQz/B,UAAU4O,KAAO,WACvB,IAAI0K,EAAQ,GAIZ,OAHAnS,KAAKI,SAAQ,SAASvB,EAAOQ,GAC3B8S,EAAMza,KAAK2H,EACb,IACO+4B,EAAYjmB,EACrB,EAEAmmB,EAAQz/B,UAAU8C,OAAS,WACzB,IAAIwW,EAAQ,GAIZ,OAHAnS,KAAKI,SAAQ,SAASvB,GACpBsT,EAAMza,KAAKmH,EACb,IACOu5B,EAAYjmB,EACrB,EAEAmmB,EAAQz/B,UAAUga,QAAU,WAC1B,IAAIV,EAAQ,GAIZ,OAHAnS,KAAKI,SAAQ,SAASvB,EAAOQ,GAC3B8S,EAAMza,KAAK,CAAC2H,EAAMR,GACpB,IACOu5B,EAAYjmB,EACrB,EAEIulB,EAAQE,WACVU,EAAQz/B,UAAUrC,OAAOohB,UAAY0gB,EAAQz/B,UAAUga,SAqJzD,IAAIwnB,EAAU,CAAC,SAAU,MAAO,OAAQ,UAAW,OAAQ,OAO3D,SAASC,EAAQv+B,EAAOqS,GAEtB,IAPuBhJ,EACnBm1B,EAMAhE,GADJnoB,EAAUA,GAAW,CAAC,GACHmoB,KAEnB,GAAIx6B,aAAiBu+B,EAAS,CAC5B,GAAIv+B,EAAM48B,SACR,MAAM,IAAI3zB,UAAU,gBAEtBhF,KAAKw6B,IAAMz+B,EAAMy+B,IACjBx6B,KAAKy6B,YAAc1+B,EAAM0+B,YACpBrsB,EAAQmqB,UACXv4B,KAAKu4B,QAAU,IAAID,EAAQv8B,EAAMw8B,UAEnCv4B,KAAKoF,OAASrJ,EAAMqJ,OACpBpF,KAAK6pB,KAAO9tB,EAAM8tB,KAClB7pB,KAAKioB,OAASlsB,EAAMksB,OACfsO,GAA2B,MAAnBx6B,EAAMq9B,YACjB7C,EAAOx6B,EAAMq9B,UACbr9B,EAAM48B,UAAW,EAErB,MACE34B,KAAKw6B,IAAMrjC,OAAO4E,GAYpB,GATAiE,KAAKy6B,YAAcrsB,EAAQqsB,aAAez6B,KAAKy6B,aAAe,eAC1DrsB,EAAQmqB,SAAYv4B,KAAKu4B,UAC3Bv4B,KAAKu4B,QAAU,IAAID,EAAQlqB,EAAQmqB,UAErCv4B,KAAKoF,QAjCkBA,EAiCOgJ,EAAQhJ,QAAUpF,KAAKoF,QAAU,MAhC3Dm1B,EAAUn1B,EAAOs1B,cACdL,EAAQ96B,QAAQg7B,IAAY,EAAIA,EAAUn1B,GAgCjDpF,KAAK6pB,KAAOzb,EAAQyb,MAAQ7pB,KAAK6pB,MAAQ,KACzC7pB,KAAKioB,OAAS7Z,EAAQ6Z,QAAUjoB,KAAKioB,OACrCjoB,KAAK26B,SAAW,MAEK,QAAhB36B,KAAKoF,QAAoC,SAAhBpF,KAAKoF,SAAsBmxB,EACvD,MAAM,IAAIvxB,UAAU,6CAEtBhF,KAAKm5B,UAAU5C,EACjB,CAMA,SAASnqB,EAAOmqB,GACd,IAAIqE,EAAO,IAAIpB,SAYf,OAXAjD,EACGrd,OACAja,MAAM,KACNmB,SAAQ,SAASmD,GAChB,GAAIA,EAAO,CACT,IAAItE,EAAQsE,EAAMtE,MAAM,KACpBI,EAAOJ,EAAMG,QAAQqB,QAAQ,MAAO,KACpC5B,EAAQI,EAAMtH,KAAK,KAAK8I,QAAQ,MAAO,KAC3Cm6B,EAAKpC,OAAOqC,mBAAmBx7B,GAAOw7B,mBAAmBh8B,GAC3D,CACF,IACK+7B,CACT,CAoBA,SAAS58B,EAAS88B,EAAU1sB,GACrBA,IACHA,EAAU,CAAC,GAGbpO,KAAKkP,KAAO,UACZlP,KAAK2U,YAA4BjN,IAAnB0G,EAAQuG,OAAuB,IAAMvG,EAAQuG,OAC3D3U,KAAK+6B,GAAK/6B,KAAK2U,QAAU,KAAO3U,KAAK2U,OAAS,IAC9C3U,KAAKg7B,WAAa,eAAgB5sB,EAAUA,EAAQ4sB,WAAa,KACjEh7B,KAAKu4B,QAAU,IAAID,EAAQlqB,EAAQmqB,SACnCv4B,KAAKw6B,IAAMpsB,EAAQosB,KAAO,GAC1Bx6B,KAAKm5B,UAAU2B,EACjB,CAlDAR,EAAQzhC,UAAUoiC,MAAQ,WACxB,OAAO,IAAIX,EAAQt6B,KAAM,CAACu2B,KAAMv2B,KAAKo5B,WACvC,EAkCAF,EAAKngC,KAAKuhC,EAAQzhC,WAgBlBqgC,EAAKngC,KAAKiF,EAASnF,WAEnBmF,EAASnF,UAAUoiC,MAAQ,WACzB,OAAO,IAAIj9B,EAASgC,KAAKo5B,UAAW,CAClCzkB,OAAQ3U,KAAK2U,OACbqmB,WAAYh7B,KAAKg7B,WACjBzC,QAAS,IAAID,EAAQt4B,KAAKu4B,SAC1BiC,IAAKx6B,KAAKw6B,KAEd,EAEAx8B,EAASoiB,MAAQ,WACf,IAAIva,EAAW,IAAI7H,EAAS,KAAM,CAAC2W,OAAQ,EAAGqmB,WAAY,KAE1D,OADAn1B,EAASqJ,KAAO,QACTrJ,CACT,EAEA,IAAIq1B,EAAmB,CAAC,IAAK,IAAK,IAAK,IAAK,KAE5Cl9B,EAASm9B,SAAW,SAASX,EAAK7lB,GAChC,IAA0C,IAAtCumB,EAAiB37B,QAAQoV,GAC3B,MAAM,IAAI3S,WAAW,uBAGvB,OAAO,IAAIhE,EAAS,KAAM,CAAC2W,OAAQA,EAAQ4jB,QAAS,CAACvP,SAAUwR,IACjE,EAEAlhC,EAAQm+B,aAAehyB,EAAKgyB,aAC5B,IACE,IAAIn+B,EAAQm+B,YACd,CAAE,MAAO7xB,GACPtM,EAAQm+B,aAAe,SAAS5vB,EAASxI,GACvCW,KAAK6H,QAAUA,EACf7H,KAAKX,KAAOA,EACZ,IAAI+gB,EAAQ7nB,MAAMsP,GAClB7H,KAAKgI,MAAQoY,EAAMpY,KACrB,EACA1O,EAAQm+B,aAAa5+B,UAAY6F,OAAOC,OAAOpG,MAAMM,WACrDS,EAAQm+B,aAAa5+B,UAAUiH,YAAcxG,EAAQm+B,YACvD,CAEA,SAASD,EAAMz7B,EAAOq/B,GACpB,OAAO,IAAI5pB,SAAQ,SAASC,EAASC,GACnC,IAAInM,EAAU,IAAI+0B,EAAQv+B,EAAOq/B,GAEjC,GAAI71B,EAAQ0iB,QAAU1iB,EAAQ0iB,OAAOG,QACnC,OAAO1W,EAAO,IAAIpY,EAAQm+B,aAAa,UAAW,eAGpD,IAAI4D,EAAM,IAAIC,eAEd,SAASC,IACPF,EAAInjC,OACN,CAEAmjC,EAAIxC,OAAS,WACX,IAxFgB2C,EAChBjD,EAuFInqB,EAAU,CACZuG,OAAQ0mB,EAAI1mB,OACZqmB,WAAYK,EAAIL,WAChBzC,SA3FciD,EA2FQH,EAAII,yBAA2B,GA1FvDlD,EAAU,IAAID,EAGQkD,EAAW/6B,QAAQ,eAAgB,KACzCxB,MAAM,SAASmB,SAAQ,SAAS/H,GAClD,IAAId,EAAQc,EAAK4G,MAAM,KACnBkP,EAAM5W,EAAM6H,QAAQ8Z,OACxB,GAAI/K,EAAK,CACP,IAAItP,EAAQtH,EAAMI,KAAK,KAAKuhB,OAC5Bqf,EAAQC,OAAOrqB,EAAKtP,EACtB,CACF,IACO05B,IAgFHnqB,EAAQosB,IAAM,gBAAiBa,EAAMA,EAAIK,YAActtB,EAAQmqB,QAAQ53B,IAAI,iBAC3E,IAAI41B,EAAO,aAAc8E,EAAMA,EAAIx1B,SAAWw1B,EAAIM,aAClDlqB,EAAQ,IAAIzT,EAASu4B,EAAMnoB,GAC7B,EAEAitB,EAAI/R,QAAU,WACZ5X,EAAO,IAAI1M,UAAU,0BACvB,EAEAq2B,EAAIO,UAAY,WACdlqB,EAAO,IAAI1M,UAAU,0BACvB,EAEAq2B,EAAIrR,QAAU,WACZtY,EAAO,IAAIpY,EAAQm+B,aAAa,UAAW,cAC7C,EAEA4D,EAAI5lB,KAAKlQ,EAAQH,OAAQG,EAAQi1B,KAAK,GAEV,YAAxBj1B,EAAQk1B,YACVY,EAAIQ,iBAAkB,EACW,SAAxBt2B,EAAQk1B,cACjBY,EAAIQ,iBAAkB,GAGpB,iBAAkBR,GAAO3D,EAAQG,OACnCwD,EAAIS,aAAe,QAGrBv2B,EAAQgzB,QAAQn4B,SAAQ,SAASvB,EAAOQ,GACtCg8B,EAAIU,iBAAiB18B,EAAMR,EAC7B,IAEI0G,EAAQ0iB,SACV1iB,EAAQ0iB,OAAOE,iBAAiB,QAASoT,GAEzCF,EAAIW,mBAAqB,WAEA,IAAnBX,EAAIY,YACN12B,EAAQ0iB,OAAOC,oBAAoB,QAASqT,EAEhD,GAGFF,EAAIa,UAAkC,IAAtB32B,EAAQ6zB,UAA4B,KAAO7zB,EAAQ6zB,UACrE,GACF,CAEA5B,EAAM2E,UAAW,EAEZ12B,EAAK+xB,QACR/xB,EAAK+xB,MAAQA,EACb/xB,EAAK6yB,QAAUA,EACf7yB,EAAK60B,QAAUA,EACf70B,EAAKzH,SAAWA,GAGlB1E,EAAQg/B,QAAUA,EAClBh/B,EAAQghC,QAAUA,EAClBhhC,EAAQ0E,SAAWA,EACnB1E,EAAQk+B,MAAQA,EAEhB94B,OAAO2B,eAAe/G,EAAS,aAAc,CAAEuF,OAAO,GAIvD,CAhhBgB,CAghBd,CAAC,EACH,CAnhBD,CAmhBGy4B,GACHA,EAASE,MAAM4E,UAAW,SAEnB9E,EAASE,MAAM2E,SAGtB,IAAIE,EAAM/E,GACVh+B,EAAU+iC,EAAI7E,OACd,QAAkB6E,EAAI7E,MACtBl+B,EAAQk+B,MAAQ6E,EAAI7E,MACpBl+B,EAAQg/B,QAAU+D,EAAI/D,QACtBh/B,EAAQghC,QAAU+B,EAAI/B,QACtBhhC,EAAQ0E,SAAWq+B,EAAIr+B,SACvBS,EAAOnF,QAAUA,yBCziBjB,OAcA,SAAUoP,GACR,aAEA,IACQ4zB,EACAC,EACAC,EAHJC,GACIH,EAAQ,mEACRC,EAAW,uIACXC,EAAe,cAGZ,SAAUE,EAAMx1B,EAAMy1B,EAAKC,GAchC,GAXyB,IAArB5jC,UAAU/B,QAAiC,YA2KzC,QADEmU,EA1K6BsxB,GA4KlC,YAGGh1B,IAAR0D,EACK,YAGU,iBAARA,SACKA,EAGZxS,MAAMuJ,QAAQiJ,GACT,QAGF,CAAC,EAAEzG,SAAS5L,KAAKqS,GACrBtS,MAAM,GAAI,GAAGyR,gBA5LkD,KAAKhK,KAAKm8B,KACpEx1B,EAAOw1B,EACPA,OAAOh1B,IAGTg1B,EAAOA,GAAQ,IAAIxjC,gBAEEA,OACnBwjC,EAAO,IAAIxjC,KAAKwjC,IAGdzP,MAAMyP,GACR,MAAM13B,UAAU,gBA8J1B,IAAgBoG,EAxJJyxB,GAHJ31B,EAAO/P,OAAOslC,EAAWK,MAAM51B,IAASA,GAAQu1B,EAAWK,MAAe,UAGrDhkC,MAAM,EAAG,GACZ,SAAd+jC,GAAsC,SAAdA,IAC1B31B,EAAOA,EAAKpO,MAAM,GAClB6jC,GAAM,EACY,SAAdE,IACFD,GAAM,IAIV,IAAI3T,EAAI0T,EAAM,SAAW,MACrBI,EAAIL,EAAKzT,EAAI,UACb+T,EAAIN,EAAKzT,EAAI,SACbxL,EAAIif,EAAKzT,EAAI,WACbvI,EAAIgc,EAAKzT,EAAI,cACbgU,EAAIP,EAAKzT,EAAI,WACbiU,EAAIR,EAAKzT,EAAI,aACb+D,EAAI0P,EAAKzT,EAAI,aACbkU,EAAIT,EAAKzT,EAAI,kBACblrB,EAAI4+B,EAAM,EAAID,EAAKU,oBACnBC,EA2FZ,SAAiBX,GAEf,IAAIY,EAAiB,IAAIpkC,KAAKwjC,EAAKa,cAAeb,EAAKc,WAAYd,EAAKe,WAGxEH,EAAeI,QAAQJ,EAAeG,WAAcH,EAAeK,SAAW,GAAK,EAAK,GAGxF,IAAIC,EAAgB,IAAI1kC,KAAKokC,EAAeC,cAAe,EAAG,GAG9DK,EAAcF,QAAQE,EAAcH,WAAcG,EAAcD,SAAW,GAAK,EAAK,GAGrF,IAAIE,EAAKP,EAAeF,oBAAsBQ,EAAcR,oBAC5DE,EAAeQ,SAASR,EAAeS,WAAaF,GAGpD,IAAIG,GAAYV,EAAiBM,GAAiB,OAClD,OAAO,EAAI3kC,KAAKiQ,MAAM80B,EACxB,CA/GgBC,CAAQvB,GACZwB,EAuHZ,SAAsBxB,GACpB,IAAIyB,EAAMzB,EAAKiB,SAIf,OAHW,IAARQ,IACDA,EAAM,GAEDA,CACT,CA7HgBC,CAAa1B,GACjB2B,EAAQ,CACVtB,EAAMA,EACNuB,GAAMC,EAAIxB,GACVyB,IAAM/B,EAAWgC,KAAKC,SAAS1B,GAC/B2B,KAAMlC,EAAWgC,KAAKC,SAAS1B,EAAI,GACnCvf,EAAMA,EAAI,EACVmhB,GAAML,EAAI9gB,EAAI,GACdohB,IAAMpC,EAAWgC,KAAKK,WAAWrhB,GACjCshB,KAAMtC,EAAWgC,KAAKK,WAAWrhB,EAAI,IACrCuhB,GAAM7nC,OAAOupB,GAAG5nB,MAAM,GACtBmmC,KAAMve,EACNwe,EAAMjC,EAAI,IAAM,GAChBkC,GAAMZ,EAAItB,EAAI,IAAM,IACpBA,EAAMA,EACNmC,GAAMb,EAAItB,GACVC,EAAMA,EACNmC,GAAMd,EAAIrB,GACVlQ,EAAMA,EACNsS,GAAMf,EAAIvR,GACV4E,EAAM2M,EAAIpB,EAAG,GACbA,EAAMoB,EAAItlC,KAAKsmC,MAAMpC,EAAI,KACzBqC,EAAMvC,EAAI,GAAKR,EAAWgC,KAAKgB,UAAU,GAAKhD,EAAWgC,KAAKgB,UAAU,GACxEC,GAAMzC,EAAI,GAAKR,EAAWgC,KAAKgB,UAAU,GAAKhD,EAAWgC,KAAKgB,UAAU,GACxEE,EAAM1C,EAAI,GAAKR,EAAWgC,KAAKgB,UAAU,GAAKhD,EAAWgC,KAAKgB,UAAU,GACxEG,GAAM3C,EAAI,GAAKR,EAAWgC,KAAKgB,UAAU,GAAKhD,EAAWgC,KAAKgB,UAAU,GACxEI,EAAMjD,EAAM,MAAQD,EAAM,OAASxlC,OAAOulC,GAAMoD,MAAMvD,IAAa,CAAC,KAAKwD,MAAMt/B,QAAQ+7B,EAAc,IACrGz+B,GAAOA,EAAI,EAAI,IAAM,KAAOwgC,EAAmC,IAA/BtlC,KAAKiQ,MAAMjQ,KAAKkuB,IAAIppB,GAAK,IAAY9E,KAAKkuB,IAAIppB,GAAK,GAAI,GACvFiiC,EAAM,CAAC,KAAM,KAAM,KAAM,MAAMjD,EAAI,GAAK,EAAI,GAAKA,EAAI,IAAMA,EAAI,IAAM,IAAMA,EAAI,IAC/EM,EAAMA,EACNa,EAAMA,GAGR,OAAOh3B,EAAKzG,QAAQ67B,GAAO,SAAUwD,GACnC,OAAIA,KAASzB,EACJA,EAAMyB,GAERA,EAAMhnC,MAAM,EAAGgnC,EAAM7oC,OAAS,EACvC,GACF,GAkCN,SAASsnC,EAAInzB,EAAKpP,GAGhB,IAFAoP,EAAMjU,OAAOiU,GACbpP,EAAMA,GAAO,EACNoP,EAAInU,OAAS+E,GAClBoP,EAAM,IAAMA,EAEd,OAAOA,CACT,CAtCEqxB,EAAWK,MAAQ,CACjB,QAAyB,2BACzB,UAAyB,SACzB,WAAyB,cACzB,SAAyB,eACzB,SAAyB,qBACzB,UAAyB,UACzB,WAAyB,aACzB,SAAyB,eACzB,QAAyB,aACzB,QAAyB,WACzB,YAAyB,yBACzB,eAAyB,+BACzB,oBAAyB,+BAI3BL,EAAWgC,KAAO,CAChBC,SAAU,CACR,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAC1C,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,YAEpEI,WAAY,CACV,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAC7E,UAAW,WAAY,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,YAEhHW,UAAW,CACT,IAAK,IAAK,KAAM,KAAM,IAAK,IAAK,KAAM,YAyFvC,KAFD,aACE,OAAOhD,CACR,+BAMJ,CAtND,sBCVA,IAAIzP,EAAI,IACJvP,EAAQ,GAAJuP,EACJkS,EAAQ,GAAJzhB,EACJsf,EAAQ,GAAJmC,EACJe,EAAQ,EAAJlD,EACJrc,EAAQ,OAAJqc,EAqJR,SAASmD,EAAOC,EAAIC,EAAO3nC,EAAG4G,GAC5B,IAAIghC,EAAWD,GAAa,IAAJ3nC,EACxB,OAAOQ,KAAKsmC,MAAMY,EAAK1nC,GAAK,IAAM4G,GAAQghC,EAAW,IAAM,GAC7D,CAxIA5hC,EAAOnF,QAAU,SAAS8R,EAAKgD,GAC7BA,EAAUA,GAAW,CAAC,EACtB,IAAIc,SAAc9D,EAClB,GAAa,WAAT8D,GAAqB9D,EAAInU,OAAS,EACpC,OAkBJ,SAAeoE,GAEb,IADAA,EAAMlE,OAAOkE,IACLpE,OAAS,IACf,OAEF,IAAI6oC,EAAQ,mIAAmI1S,KAC7I/xB,GAEF,IAAKykC,EACH,OAEF,IAAIrnC,EAAI40B,WAAWyS,EAAM,IAEzB,QADYA,EAAM,IAAM,MAAMv1B,eAE5B,IAAK,QACL,IAAK,OACL,IAAK,MACL,IAAK,KACL,IAAK,IACH,OAAO9R,EAAIioB,EACb,IAAK,QACL,IAAK,OACL,IAAK,IACH,OAAOjoB,EAAIwnC,EACb,IAAK,OACL,IAAK,MACL,IAAK,IACH,OAAOxnC,EAAIskC,EACb,IAAK,QACL,IAAK,OACL,IAAK,MACL,IAAK,KACL,IAAK,IACH,OAAOtkC,EAAIymC,EACb,IAAK,UACL,IAAK,SACL,IAAK,OACL,IAAK,MACL,IAAK,IACH,OAAOzmC,EAAIglB,EACb,IAAK,UACL,IAAK,SACL,IAAK,OACL,IAAK,MACL,IAAK,IACH,OAAOhlB,EAAIu0B,EACb,IAAK,eACL,IAAK,cACL,IAAK,QACL,IAAK,OACL,IAAK,KACH,OAAOv0B,EACT,QACE,OAEN,CAzEWuzB,CAAM5gB,GACR,GAAa,WAAT8D,GAAqBjG,SAASmC,GACvC,OAAOgD,EAAQkyB,KA0GnB,SAAiBH,GACf,IAAIC,EAAQnnC,KAAKkuB,IAAIgZ,GACrB,GAAIC,GAASrD,EACX,OAAOmD,EAAOC,EAAIC,EAAOrD,EAAG,OAE9B,GAAIqD,GAASlB,EACX,OAAOgB,EAAOC,EAAIC,EAAOlB,EAAG,QAE9B,GAAIkB,GAAS3iB,EACX,OAAOyiB,EAAOC,EAAIC,EAAO3iB,EAAG,UAE9B,GAAI2iB,GAASpT,EACX,OAAOkT,EAAOC,EAAIC,EAAOpT,EAAG,UAE9B,OAAOmT,EAAK,KACd,CAzH0BI,CAAQn1B,GAiFlC,SAAkB+0B,GAChB,IAAIC,EAAQnnC,KAAKkuB,IAAIgZ,GACrB,GAAIC,GAASrD,EACX,OAAO9jC,KAAKsmC,MAAMY,EAAKpD,GAAK,IAE9B,GAAIqD,GAASlB,EACX,OAAOjmC,KAAKsmC,MAAMY,EAAKjB,GAAK,IAE9B,GAAIkB,GAAS3iB,EACX,OAAOxkB,KAAKsmC,MAAMY,EAAK1iB,GAAK,IAE9B,GAAI2iB,GAASpT,EACX,OAAO/zB,KAAKsmC,MAAMY,EAAKnT,GAAK,IAE9B,OAAOmT,EAAK,IACd,CAhGyCK,CAASp1B,GAEhD,MAAM,IAAI7S,MACR,wDACE2hC,KAAKuG,UAAUr1B,GAErB,mDC/BA9R,EAAQonC,WA2IR,SAAoB9gC,GAQnB,GAPAA,EAAK,IAAMI,KAAK2gC,UAAY,KAAO,IAClC3gC,KAAK4gC,WACJ5gC,KAAK2gC,UAAY,MAAQ,KAC1B/gC,EAAK,IACJI,KAAK2gC,UAAY,MAAQ,KAC1B,IAAMliC,EAAOnF,QAAQunC,SAAS7gC,KAAK8gC,OAE/B9gC,KAAK2gC,UACT,OAGD,MAAM1hB,EAAI,UAAYjf,KAAK+gC,MAC3BnhC,EAAKqrB,OAAO,EAAG,EAAGhM,EAAG,kBAKrB,IAAIoL,EAAQ,EACR2W,EAAQ,EACZphC,EAAK,GAAGa,QAAQ,eAAeq/B,IAChB,OAAVA,IAGJzV,IACc,OAAVyV,IAGHkB,EAAQ3W,GACT,IAGDzqB,EAAKqrB,OAAO+V,EAAO,EAAG/hB,EACvB,EA3KA3lB,EAAQ2nC,KA6LR,SAAcC,GACb,IACKA,EACH5nC,EAAQ6nC,QAAQC,QAAQ,QAASF,GAEjC5nC,EAAQ6nC,QAAQE,WAAW,QAE7B,CAAE,MAAOjhB,GAGT,CACD,EAvMA9mB,EAAQgoC,KA+MR,WACC,IAAIvQ,EACJ,IACCA,EAAIz3B,EAAQ6nC,QAAQI,QAAQ,QAC7B,CAAE,MAAOnhB,GAGT,EAGK2Q,QAAwB,IAAZxoB,GAA2B,QAASA,IACpDwoB,EAAIxoB,EAAQtQ,IAAIupC,OAGjB,OAAOzQ,CACR,EA7NAz3B,EAAQqnC,UAyGR,WAIC,GAAsB,oBAAXh4B,QAA0BA,OAAOJ,UAAoC,aAAxBI,OAAOJ,QAAQ2G,MAAuBvG,OAAOJ,QAAQk5B,QAC5G,OAAO,EAIR,GAAyB,oBAAdC,WAA6BA,UAAUC,WAAaD,UAAUC,UAAUp3B,cAAcu1B,MAAM,yBACtG,OAAO,EAKR,MAA4B,oBAAb8B,UAA4BA,SAASC,iBAAmBD,SAASC,gBAAgBC,OAASF,SAASC,gBAAgBC,MAAMC,kBAEpH,oBAAXp5B,QAA0BA,OAAOjQ,UAAYiQ,OAAOjQ,QAAQspC,SAAYr5B,OAAOjQ,QAAQupC,WAAat5B,OAAOjQ,QAAQa,QAGrG,oBAAdmoC,WAA6BA,UAAUC,WAAaD,UAAUC,UAAUp3B,cAAcu1B,MAAM,mBAAqBp5B,SAASooB,OAAOoT,GAAI,KAAO,IAE9H,oBAAdR,WAA6BA,UAAUC,WAAaD,UAAUC,UAAUp3B,cAAcu1B,MAAM,qBACtG,EA/HAxmC,EAAQ6nC,QAyOR,WACC,IAGC,OAAOgB,YACR,CAAE,MAAO/hB,GAGT,CACD,CAlPkBgiB,GAClB9oC,EAAQmxB,QAAU,MACjB,IAAI4X,GAAS,EAEb,MAAO,KACDA,IACJA,GAAS,EACT3pC,EAAQqa,KAAK,yIACd,CAED,EATiB,GAelBzZ,EAAQgpC,OAAS,CAChB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAsFDhpC,EAAQX,IAAMD,EAAQ6pC,OAAS7pC,EAAQC,KAAO,MAAS,GAkEvD8F,EAAOnF,QAAU,EAAQ,MAAR,CAAoBA,GAErC,MAAM,WAACkpC,GAAc/jC,EAAOnF,QAM5BkpC,EAAWpkB,EAAI,SAAUmT,GACxB,IACC,OAAO2I,KAAKuG,UAAUlP,EACvB,CAAE,MAAOnR,GACR,MAAO,+BAAiCA,EAAMvY,OAC/C,CACD,wCCKApJ,EAAOnF,QA3QP,SAAerB,GAqDd,SAASwqC,EAAY7B,GACpB,IAAI8B,EAEAC,EACAC,EAFAC,EAAiB,KAIrB,SAASN,KAAS3iC,GAEjB,IAAK2iC,EAAMO,QACV,OAGD,MAAMr9B,EAAO88B,EAGPrjC,EAAO8J,OAAO,IAAI9P,MAClBinC,EAAKjhC,GAAQwjC,GAAYxjC,GAC/BuG,EAAKq7B,KAAOX,EACZ16B,EAAKs9B,KAAOL,EACZj9B,EAAKvG,KAAOA,EACZwjC,EAAWxjC,EAEXU,EAAK,GAAK6iC,EAAYO,OAAOpjC,EAAK,IAEX,iBAAZA,EAAK,IAEfA,EAAKqjC,QAAQ,MAId,IAAI5Y,EAAQ,EACZzqB,EAAK,GAAKA,EAAK,GAAGa,QAAQ,iBAAiB,CAACq/B,EAAOlxB,KAElD,GAAc,OAAVkxB,EACH,MAAO,IAERzV,IACA,MAAM6Y,EAAYT,EAAYD,WAAW5zB,GACzC,GAAyB,mBAAds0B,EAA0B,CACpC,MAAM93B,EAAMxL,EAAKyqB,GACjByV,EAAQoD,EAAUnqC,KAAK0M,EAAM2F,GAG7BxL,EAAKqrB,OAAOZ,EAAO,GACnBA,GACD,CACA,OAAOyV,CAAK,IAIb2C,EAAY/B,WAAW3nC,KAAK0M,EAAM7F,IAEpB6F,EAAK9M,KAAO8pC,EAAY9pC,KAChCtB,MAAMoO,EAAM7F,EACnB,CAgCA,OA9BA2iC,EAAM3B,UAAYA,EAClB2B,EAAM5B,UAAY8B,EAAY9B,YAC9B4B,EAAMxB,MAAQ0B,EAAYU,YAAYvC,GACtC2B,EAAMa,OAASA,EACfb,EAAM9X,QAAUgY,EAAYhY,QAE5B/rB,OAAO2B,eAAekiC,EAAO,UAAW,CACvC3hC,YAAY,EACZqH,cAAc,EACdtH,IAAK,IACmB,OAAnBkiC,EACIA,GAEJF,IAAoBF,EAAYvB,aACnCyB,EAAkBF,EAAYvB,WAC9B0B,EAAeH,EAAYK,QAAQlC,IAG7BgC,GAER/mC,IAAK01B,IACJsR,EAAiBtR,CAAC,IAKY,mBAArBkR,EAAYrH,MACtBqH,EAAYrH,KAAKmH,GAGXA,CACR,CAEA,SAASa,EAAOxC,EAAWyC,GAC1B,MAAMC,EAAWb,EAAYziC,KAAK4gC,gBAAkC,IAAdyC,EAA4B,IAAMA,GAAazC,GAErG,OADA0C,EAAS3qC,IAAMqH,KAAKrH,IACb2qC,CACR,CAwFA,SAASC,EAAYC,GACpB,OAAOA,EAAO7+B,WACZlF,UAAU,EAAG+jC,EAAO7+B,WAAW1N,OAAS,GACxCwJ,QAAQ,UAAW,IACtB,CA0BA,OAvQAgiC,EAAYF,MAAQE,EACpBA,EAAYgB,QAAUhB,EACtBA,EAAYO,OAoPZ,SAAgB53B,GACf,GAAIA,aAAe7S,MAClB,OAAO6S,EAAIpD,OAASoD,EAAIvD,QAEzB,OAAOuD,CACR,EAxPAq3B,EAAYiB,QAwLZ,WACC,MAAMxC,EAAa,IACfuB,EAAYkB,MAAM/oB,IAAI2oB,MACtBd,EAAYmB,MAAMhpB,IAAI2oB,GAAa3oB,KAAIgmB,GAAa,IAAMA,KAC5DjpC,KAAK,KAEP,OADA8qC,EAAYoB,OAAO,IACZ3C,CACR,EA9LAuB,EAAYoB,OAsJZ,SAAgB3C,GAOf,IAAI5lC,EANJmnC,EAAYxB,KAAKC,GACjBuB,EAAYvB,WAAaA,EAEzBuB,EAAYkB,MAAQ,GACpBlB,EAAYmB,MAAQ,GAGpB,MAAM3kC,GAA+B,iBAAfiiC,EAA0BA,EAAa,IAAIjiC,MAAM,UACjEjD,EAAMiD,EAAMhI,OAElB,IAAKqE,EAAI,EAAGA,EAAIU,EAAKV,IACf2D,EAAM3D,KAOW,OAFtB4lC,EAAajiC,EAAM3D,GAAGmF,QAAQ,MAAO,QAEtB,GACdgiC,EAAYmB,MAAMlsC,KAAK,IAAIo3B,OAAO,IAAMoS,EAAWpoC,MAAM,GAAK,MAE9D2pC,EAAYkB,MAAMjsC,KAAK,IAAIo3B,OAAO,IAAMoS,EAAa,MAGxD,EA9KAuB,EAAYK,QAsMZ,SAAiBzjC,GAChB,GAA8B,MAA1BA,EAAKA,EAAKpI,OAAS,GACtB,OAAO,EAGR,IAAIqE,EACAU,EAEJ,IAAKV,EAAI,EAAGU,EAAMymC,EAAYmB,MAAM3sC,OAAQqE,EAAIU,EAAKV,IACpD,GAAImnC,EAAYmB,MAAMtoC,GAAGiF,KAAKlB,GAC7B,OAAO,EAIT,IAAK/D,EAAI,EAAGU,EAAMymC,EAAYkB,MAAM1sC,OAAQqE,EAAIU,EAAKV,IACpD,GAAImnC,EAAYkB,MAAMroC,GAAGiF,KAAKlB,GAC7B,OAAO,EAIT,OAAO,CACR,EA1NAojC,EAAY5B,SAAW,EAAQ,OAC/B4B,EAAYhY,QA0PZ,WACC/xB,EAAQqa,KAAK,wIACd,EA1PArU,OAAO+I,KAAKxP,GAAKmI,SAAQ+N,IACxBs0B,EAAYt0B,GAAOlW,EAAIkW,EAAI,IAO5Bs0B,EAAYkB,MAAQ,GACpBlB,EAAYmB,MAAQ,GAOpBnB,EAAYD,WAAa,CAAC,EAkB1BC,EAAYU,YAVZ,SAAqBvC,GACpB,IAAIthC,EAAO,EAEX,IAAK,IAAIhE,EAAI,EAAGA,EAAIslC,EAAU3pC,OAAQqE,IACrCgE,GAASA,GAAQ,GAAKA,EAAQshC,EAAUplC,WAAWF,GACnDgE,GAAQ,EAGT,OAAOmjC,EAAYH,OAAOrpC,KAAKkuB,IAAI7nB,GAAQmjC,EAAYH,OAAOrrC,OAC/D,EA2NAwrC,EAAYoB,OAAOpB,EAAYnB,QAExBmB,CACR,kCC5QA,MAEMqB,EAAmB,KACxB,MAAM1jB,EAAQ,IAAI7nB,MAAM,iBAExB,OADA6nB,EAAM/gB,KAAO,aACN+gB,CAAK,EAGP2jB,EAAc,EAAEC,aAAcC,EAAcl+B,WAAYlK,EAAKqoC,iBAAiB,CAAC/D,GAAKthC,QAAOopB,UAAU,CAAC,KAC3G,GAAIA,GAAUA,EAAOG,QACpB,OAAO5W,QAAQE,OAAOoyB,KAGvB,IAAIK,EACAC,EACAC,EACJ,MAAMh1B,EAAQ40B,GAAgBD,aAExBM,EAAiB,KACtBj1B,EAAM80B,GACNE,EAASP,IAAmB,EASvBS,EAAe,IAAI/yB,SAAQ,CAACC,EAASC,KAC1C0yB,EAAS,KANLnc,GACHA,EAAOC,oBAAoB,QAASoc,GAOhCJ,EACHzyB,EAAQ5S,GAER6S,EAAO7S,EACR,EAGDwlC,EAAW3yB,EACXyyB,GAAatoC,GAAOkK,YAAYq+B,EAAQjE,EAAG,IAa5C,OAVIlY,GACHA,EAAOE,iBAAiB,QAASmc,EAAgB,CAACnuB,MAAM,IAGzDouB,EAAal1B,MAAQ,KACpBA,EAAM80B,GACNA,EAAY,KACZC,GAAQ,EAGFG,CAAY,EAGdC,EAAmBC,IACxB,MAAMC,EAAQX,EAAY,IAAIU,EAAaP,aAAa,IAGxD,OAFAQ,EAAMhzB,OAASqyB,EAAY,IAAIU,EAAaP,aAAa,IACzDQ,EAAM5qB,MAAQ,CAAC6qB,EAASC,EAASx2B,IAAYs2B,EA3DxB,EAACC,EAASC,IAAY3rC,KAAKiQ,MAAOjQ,KAAKy4B,UAAYkT,EAAUD,EAAU,GAAMA,GA2D/CE,CAAcF,EAASC,GAAUx2B,GAC7Es2B,CAAK,EAGPA,EAAQF,IACdE,EAAMF,iBAAmBA,EAEzB/lC,EAAOnF,QAAUorC,EAEjBjmC,EAAOnF,QAAP,QAAyBorC,kCClEzB,SAASI,EAAOjoB,EAAOzO,GACjBA,EAAUA,GAAW,CAAC,EAC1BpO,KAAK+kC,UAAY32B,EAAQ42B,SAEzBhlC,KAAKilC,MAAQ,EACbjlC,KAAKklC,MAAQ,EAETtsC,MAAMuJ,QAAQ0a,GAChB7c,KAAKmlC,WAAWtoB,IAEhB7c,KAAKolC,cAAgB,EACrBplC,KAAKqlC,MAAQ,IAAIzsC,MAAM,GAE3B,CAgBAksC,EAAOjsC,UAAUysC,OAAS,SAAgBjb,GACxC,IAAI/uB,EAAI+uB,EAER,GAAK/uB,KAAW,EAAJA,GAAZ,CAGA,IAAIU,EAAMgE,KAAKvI,OACf,KAAI6D,GAAKU,GAAOV,GAAKU,GAGrB,OAFIV,EAAI,IAAGA,GAAKU,GAChBV,EAAK0E,KAAKilC,MAAQ3pC,EAAK0E,KAAKolC,cACrBplC,KAAKqlC,MAAM/pC,EALlB,CAMF,EAOAwpC,EAAOjsC,UAAU8H,IAAM,SAAarF,GAClC,OAAO0E,KAAKslC,OAAOhqC,EACrB,EAMAwpC,EAAOjsC,UAAU0sC,KAAO,WACtB,GAAIvlC,KAAKilC,QAAUjlC,KAAKklC,MACxB,OAAOllC,KAAKqlC,MAAMrlC,KAAKilC,MACzB,EAMAH,EAAOjsC,UAAU2sC,UAAY,WAC3B,OAAOxlC,KAAKulC,MACd,EAMAT,EAAOjsC,UAAU4sC,SAAW,WAC1B,OAAOzlC,KAAKslC,QAAQ,EACtB,EAMA5mC,OAAO2B,eAAeykC,EAAOjsC,UAAW,SAAU,CAChD8H,IAAK,WACH,OAAOX,KAAKvI,MACd,IAOFqtC,EAAOjsC,UAAUpB,KAAO,WACtB,OAAIuI,KAAKilC,QAAUjlC,KAAKklC,MAAc,EAClCllC,KAAKilC,MAAQjlC,KAAKklC,MAAcllC,KAAKklC,MAAQllC,KAAKilC,MAC1CjlC,KAAKolC,cAAgB,GAAKplC,KAAKilC,MAAQjlC,KAAKklC,MAC1D,EAMAJ,EAAOjsC,UAAUoqC,QAAU,SAAiBxwB,GAC1C,GAAyB,IAArBzZ,UAAU/B,OAAc,OAAO+I,KAAKvI,OACxC,IAAIuE,EAAMgE,KAAKqlC,MAAMpuC,OAKrB,OAJA+I,KAAKilC,MAASjlC,KAAKilC,MAAQ,EAAIjpC,EAAOgE,KAAKolC,cAC3CplC,KAAKqlC,MAAMrlC,KAAKilC,OAASxyB,EACrBzS,KAAKklC,QAAUllC,KAAKilC,OAAOjlC,KAAK0lC,aAChC1lC,KAAK+kC,WAAa/kC,KAAKvI,OAASuI,KAAK+kC,WAAW/kC,KAAK+/B,MACrD//B,KAAKilC,MAAQjlC,KAAKklC,MAAcllC,KAAKklC,MAAQllC,KAAKilC,MAC1CjlC,KAAKolC,cAAgB,GAAKplC,KAAKilC,MAAQjlC,KAAKklC,MAC1D,EAOAJ,EAAOjsC,UAAUuG,MAAQ,WACvB,IAAIqM,EAAOzL,KAAKilC,MAChB,GAAIx5B,IAASzL,KAAKklC,MAAlB,CACA,IAAIzyB,EAAOzS,KAAKqlC,MAAM55B,GAItB,OAHAzL,KAAKqlC,MAAM55B,QAAQ/D,EACnB1H,KAAKilC,MAASx5B,EAAO,EAAKzL,KAAKolC,cAC3B35B,EAAO,GAAKzL,KAAKklC,MAAQ,KAASllC,KAAKklC,OAASllC,KAAKqlC,MAAMpuC,SAAW,GAAG+I,KAAK2lC,eAC3ElzB,CALkC,CAM3C,EAMAqyB,EAAOjsC,UAAUnB,KAAO,SAAc+a,GACpC,GAAyB,IAArBzZ,UAAU/B,OAAc,OAAO+I,KAAKvI,OACxC,IAAIiU,EAAO1L,KAAKklC,MAShB,OARAllC,KAAKqlC,MAAM35B,GAAQ+G,EACnBzS,KAAKklC,MAASx5B,EAAO,EAAK1L,KAAKolC,cAC3BplC,KAAKklC,QAAUllC,KAAKilC,OACtBjlC,KAAK0lC,aAEH1lC,KAAK+kC,WAAa/kC,KAAKvI,OAASuI,KAAK+kC,WACvC/kC,KAAKZ,QAEHY,KAAKilC,MAAQjlC,KAAKklC,MAAcllC,KAAKklC,MAAQllC,KAAKilC,MAC1CjlC,KAAKolC,cAAgB,GAAKplC,KAAKilC,MAAQjlC,KAAKklC,MAC1D,EAOAJ,EAAOjsC,UAAUknC,IAAM,WACrB,IAAIr0B,EAAO1L,KAAKklC,MAChB,GAAIx5B,IAAS1L,KAAKilC,MAAlB,CACA,IAAIjpC,EAAMgE,KAAKqlC,MAAMpuC,OACrB+I,KAAKklC,MAASx5B,EAAO,EAAI1P,EAAOgE,KAAKolC,cACrC,IAAI3yB,EAAOzS,KAAKqlC,MAAMrlC,KAAKklC,OAG3B,OAFAllC,KAAKqlC,MAAMrlC,KAAKklC,YAASx9B,EACrB1H,KAAKilC,MAAQ,GAAKv5B,EAAO,KAASA,GAAQ1P,IAAQ,GAAGgE,KAAK2lC,eACvDlzB,CANkC,CAO3C,EAQAqyB,EAAOjsC,UAAU+sC,UAAY,SAAmBvb,GAC9C,IAAI/uB,EAAI+uB,EAER,GAAK/uB,KAAW,EAAJA,IAGR0E,KAAKilC,QAAUjlC,KAAKklC,MAAxB,CACA,IAAIztC,EAAOuI,KAAKvI,OACZuE,EAAMgE,KAAKqlC,MAAMpuC,OACrB,KAAIqE,GAAK7D,GAAQ6D,GAAK7D,GAAtB,CACI6D,EAAI,IAAGA,GAAK7D,GAChB6D,EAAK0E,KAAKilC,MAAQ3pC,EAAK0E,KAAKolC,cAC5B,IACIlyB,EADAT,EAAOzS,KAAKqlC,MAAM/pC,GAEtB,GAAI+uB,EAAQ5yB,EAAO,EAAG,CACpB,IAAKyb,EAAImX,EAAOnX,EAAI,EAAGA,IACrBlT,KAAKqlC,MAAM/pC,GAAK0E,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,eAEtDplC,KAAKqlC,MAAM/pC,QAAK,EAChB0E,KAAKilC,MAASjlC,KAAKilC,MAAQ,EAAIjpC,EAAOgE,KAAKolC,aAC7C,KAAO,CACL,IAAKlyB,EAAIzb,EAAO,EAAI4yB,EAAOnX,EAAI,EAAGA,IAChClT,KAAKqlC,MAAM/pC,GAAK0E,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,eAEtDplC,KAAKqlC,MAAM/pC,QAAK,EAChB0E,KAAKklC,MAASllC,KAAKklC,MAAQ,EAAIlpC,EAAOgE,KAAKolC,aAC7C,CACA,OAAO3yB,CAlBkC,CAHG,CAsB9C,EAUAqyB,EAAOjsC,UAAUgtC,OAAS,SAAgBxb,EAAO/Y,GAC/C,IACIw0B,EADAxqC,EAAI+uB,EAEJ0b,EAAYz0B,EAEhB,GAAKhW,KAAW,EAAJA,IAGR0E,KAAKilC,QAAUjlC,KAAKklC,MAAxB,CACA,IAAIztC,EAAOuI,KAAKvI,OACZuE,EAAMgE,KAAKqlC,MAAMpuC,OACrB,KAAIqE,GAAK7D,GAAQ6D,GAAK7D,GAAQ6Z,EAAQ,GAAtC,CAEA,GADIhW,EAAI,IAAGA,GAAK7D,GACF,IAAV6Z,IAAgBA,EAGlB,OAFAw0B,EAAU,IAAIltC,MAAM,IACZ,GAAKoH,KAAK4lC,UAAUtqC,GACrBwqC,EAET,GAAU,IAANxqC,GAAWA,EAAIgW,GAAS7Z,EAG1B,OAFAquC,EAAU9lC,KAAKgmC,UACfhmC,KAAKqP,QACEy2B,EAGT,IAAI5yB,EAEJ,IAHI5X,EAAIgW,EAAQ7Z,IAAM6Z,EAAQ7Z,EAAO6D,GAErCwqC,EAAU,IAAIltC,MAAM0Y,GACf4B,EAAI,EAAGA,EAAI5B,EAAO4B,IACrB4yB,EAAQ5yB,GAAKlT,KAAKqlC,MAAOrlC,KAAKilC,MAAQ3pC,EAAI4X,EAAKlT,KAAKolC,eAGtD,GADA9pC,EAAK0E,KAAKilC,MAAQ3pC,EAAK0E,KAAKolC,cACxB/a,EAAQ/Y,IAAU7Z,EAAM,CAE1B,IADAuI,KAAKklC,MAASllC,KAAKklC,MAAQ5zB,EAAQtV,EAAOgE,KAAKolC,cAC1ClyB,EAAI5B,EAAO4B,EAAI,EAAGA,IACrBlT,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,oBAAiB,EAEvD,OAAOU,CACT,CACA,GAAc,IAAVzb,EAAa,CAEf,IADArqB,KAAKilC,MAASjlC,KAAKilC,MAAQ3zB,EAAQtV,EAAOgE,KAAKolC,cAC1ClyB,EAAI5B,EAAQ,EAAG4B,EAAI,EAAGA,IACzBlT,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,oBAAiB,EAEvD,OAAOU,CACT,CACA,GAAIxqC,EAAI7D,EAAO,EAAG,CAEhB,IADAuI,KAAKilC,MAASjlC,KAAKilC,MAAQ5a,EAAQ/Y,EAAQtV,EAAOgE,KAAKolC,cAClDlyB,EAAImX,EAAOnX,EAAI,EAAGA,IACrBlT,KAAKijC,QAAQjjC,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,gBAGnD,IADA9pC,EAAK0E,KAAKilC,MAAQ,EAAIjpC,EAAOgE,KAAKolC,cAC3BW,EAAY,GACjB/lC,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,oBAAiB,EACrDW,IAEE1b,EAAQ,IAAGrqB,KAAKklC,MAAQ5pC,EAC9B,KAAO,CAGL,IAFA0E,KAAKklC,MAAQ5pC,EACbA,EAAKA,EAAIgW,EAAQtV,EAAOgE,KAAKolC,cACxBlyB,EAAIzb,GAAQ6Z,EAAQ+Y,GAAQnX,EAAI,EAAGA,IACtClT,KAAKtI,KAAKsI,KAAKqlC,MAAM/pC,MAGvB,IADAA,EAAI0E,KAAKklC,MACFa,EAAY,GACjB/lC,KAAKqlC,MAAM/pC,EAAKA,EAAI,EAAIU,EAAOgE,KAAKolC,oBAAiB,EACrDW,GAEJ,CAEA,OADI/lC,KAAKilC,MAAQ,GAAKjlC,KAAKklC,MAAQ,KAASllC,KAAKklC,OAASlpC,IAAQ,GAAGgE,KAAK2lC,eACnEG,CAzD+C,CAHV,CA6D9C,EAaAhB,EAAOjsC,UAAUoyB,OAAS,SAAgBZ,EAAO/Y,GAC/C,IAAIhW,EAAI+uB,EAER,GAAK/uB,KAAW,EAAJA,GAAZ,CAGA,IAAI7D,EAAOuI,KAAKvI,OAEhB,GADI6D,EAAI,IAAGA,GAAK7D,KACZ6D,EAAI7D,GAAR,CACA,GAAIuB,UAAU/B,OAAS,EAAG,CACxB,IAAIic,EACA+yB,EACAH,EACAI,EAAUltC,UAAU/B,OACpB+E,EAAMgE,KAAKqlC,MAAMpuC,OACjBkvC,EAAkB,EACtB,IAAK1uC,GAAQ6D,EAAI7D,EAAO,EAAG,CAEzB,IADAwuC,EAAO,IAAIrtC,MAAM0C,GACZ4X,EAAI,EAAGA,EAAI5X,EAAG4X,IACjB+yB,EAAK/yB,GAAKlT,KAAKqlC,MAAOrlC,KAAKilC,MAAQ/xB,EAAKlT,KAAKolC,eAW/C,IATc,IAAV9zB,GACFw0B,EAAU,GACNxqC,EAAI,IACN0E,KAAKilC,MAASjlC,KAAKilC,MAAQ3pC,EAAIU,EAAOgE,KAAKolC,iBAG7CU,EAAU9lC,KAAK6lC,OAAOvqC,EAAGgW,GACzBtR,KAAKilC,MAASjlC,KAAKilC,MAAQ3pC,EAAIU,EAAOgE,KAAKolC,eAEtCc,EAAUC,GACfnmC,KAAKijC,QAAQjqC,YAAYktC,IAE3B,IAAKhzB,EAAI5X,EAAG4X,EAAI,EAAGA,IACjBlT,KAAKijC,QAAQgD,EAAK/yB,EAAI,GAE1B,KAAO,CAEL,IAAIkzB,GADJH,EAAO,IAAIrtC,MAAMnB,GAAQ6D,EAAIgW,KACbra,OAChB,IAAKic,EAAI,EAAGA,EAAIkzB,EAAMlzB,IACpB+yB,EAAK/yB,GAAKlT,KAAKqlC,MAAOrlC,KAAKilC,MAAQ3pC,EAAIgW,EAAQ4B,EAAKlT,KAAKolC,eAW3D,IATc,IAAV9zB,GACFw0B,EAAU,GACNxqC,GAAK7D,IACPuI,KAAKklC,MAASllC,KAAKilC,MAAQ3pC,EAAIU,EAAOgE,KAAKolC,iBAG7CU,EAAU9lC,KAAK6lC,OAAOvqC,EAAGgW,GACzBtR,KAAKklC,MAASllC,KAAKklC,MAAQkB,EAAOpqC,EAAOgE,KAAKolC,eAEzCe,EAAkBD,GACvBlmC,KAAKtI,KAAKsB,UAAUmtC,MAEtB,IAAKjzB,EAAI,EAAGA,EAAIkzB,EAAMlzB,IACpBlT,KAAKtI,KAAKuuC,EAAK/yB,GAEnB,CACA,OAAO4yB,CACT,CACE,OAAO9lC,KAAK6lC,OAAOvqC,EAAGgW,EApDG,CAH3B,CAyDF,EAKAwzB,EAAOjsC,UAAUwW,MAAQ,WACvBrP,KAAKqlC,MAAQ,IAAIzsC,MAAMoH,KAAKqlC,MAAMpuC,QAClC+I,KAAKilC,MAAQ,EACbjlC,KAAKklC,MAAQ,CACf,EAMAJ,EAAOjsC,UAAUwtC,QAAU,WACzB,OAAOrmC,KAAKilC,QAAUjlC,KAAKklC,KAC7B,EAMAJ,EAAOjsC,UAAUmtC,QAAU,WACzB,OAAOhmC,KAAKsmC,YAAW,EACzB,EAcAxB,EAAOjsC,UAAUssC,WAAa,SAAoBtoB,GAChD,IAAI5lB,EAAS4lB,EAAM5lB,OACf+tC,EAAWhlC,KAAKumC,cAActvC,GAElC+I,KAAKqlC,MAAQ,IAAIzsC,MAAMosC,GACvBhlC,KAAKolC,cAAgBJ,EAAW,EAChChlC,KAAKklC,MAAQjuC,EAEb,IAAK,IAAIqE,EAAI,EAAGA,EAAIrE,EAAQqE,IAAK0E,KAAKqlC,MAAM/pC,GAAKuhB,EAAMvhB,EACzD,EASAwpC,EAAOjsC,UAAUytC,WAAa,SAAoBE,EAAU/uC,GAC1D,IAAI8P,EAAMvH,KAAKqlC,MACXL,EAAWz9B,EAAItQ,OACfA,EAAS+I,KAAK/I,OAIlB,IAHAQ,GAAcR,IAGFA,GAAU+I,KAAKilC,MAAQjlC,KAAKklC,MAEtC,OAAOllC,KAAKqlC,MAAMvsC,MAAMkH,KAAKilC,MAAOjlC,KAAKklC,OAG3C,IAGI5pC,EAHAmrC,EAAO,IAAI7tC,MAAMnB,GAEjByb,EAAI,EAER,GAAIszB,GAAYxmC,KAAKilC,MAAQjlC,KAAKklC,MAAO,CACvC,IAAK5pC,EAAI0E,KAAKilC,MAAO3pC,EAAI0pC,EAAU1pC,IAAKmrC,EAAKvzB,KAAO3L,EAAIjM,GACxD,IAAKA,EAAI,EAAGA,EAAI0E,KAAKklC,MAAO5pC,IAAKmrC,EAAKvzB,KAAO3L,EAAIjM,EACnD,MACE,IAAKA,EAAI0E,KAAKilC,MAAO3pC,EAAI0E,KAAKklC,MAAO5pC,IAAKmrC,EAAKvzB,KAAO3L,EAAIjM,GAG5D,OAAOmrC,CACT,EAMA3B,EAAOjsC,UAAU6sC,WAAa,WAC5B,GAAkB,GAAd1lC,KAAKilC,MAAY,CAEnB,IAAIyB,EAAU1mC,KAAKsmC,YAAW,EAAMtmC,KAAKqlC,MAAMpuC,QAAU,GAEzD+I,KAAKklC,MAAQllC,KAAKqlC,MAAMpuC,OACxB+I,KAAKilC,MAAQ,EAEbjlC,KAAKqlC,MAAQqB,CACf,MACE1mC,KAAKklC,MAAQllC,KAAKqlC,MAAMpuC,OACxB+I,KAAKqlC,MAAMpuC,SAAW,EAGxB+I,KAAKolC,cAAiBplC,KAAKolC,eAAiB,EAAK,CACnD,EAMAN,EAAOjsC,UAAU8sC,aAAe,WAC9B3lC,KAAKqlC,MAAMpuC,UAAY,EACvB+I,KAAKolC,iBAAmB,CAC1B,EAQAN,EAAOjsC,UAAU0tC,cAAgB,SAAuBI,GACtD,IACIC,EAAW,GADJ3tC,KAAKN,IAAIguC,GAAO1tC,KAAKN,IAAI,GACR,EAE5B,OAAOM,KAAKioB,IAAI0lB,EAAU,EAC5B,EAEAnoC,EAAOnF,QAAUwrC,sFCheb+B,EAAgD,SAAUC,EAAItgC,EAAMugC,GACpE,GAAIA,GAA6B,IAArB/tC,UAAU/B,OAAc,IAAK,IAA4B+vC,EAAxB1rC,EAAI,EAAGs2B,EAAIprB,EAAKvP,OAAYqE,EAAIs2B,EAAGt2B,KACxE0rC,GAAQ1rC,KAAKkL,IACRwgC,IAAIA,EAAKpuC,MAAMC,UAAUC,MAAMC,KAAKyN,EAAM,EAAGlL,IAClD0rC,EAAG1rC,GAAKkL,EAAKlL,IAGrB,OAAOwrC,EAAGjtB,OAAOmtB,GAAMpuC,MAAMC,UAAUC,MAAMC,KAAKyN,GACtD,EACIygC,EACA,SAAqB5nC,EAAM6pB,EAASge,GAChClnC,KAAKX,KAAOA,EACZW,KAAKkpB,QAAUA,EACflpB,KAAKknC,GAAKA,EACVlnC,KAAKkP,KAAO,SAChB,EAIAi4B,EACA,SAAkBje,GACdlpB,KAAKkpB,QAAUA,EACflpB,KAAKkP,KAAO,OACZlP,KAAKX,KAAO,OACZW,KAAKknC,GAAK3+B,EAAQ6+B,QACtB,EAIAC,EACA,SAA6BhoC,EAAM6pB,EAASge,EAAII,GAC5CtnC,KAAKX,KAAOA,EACZW,KAAKkpB,QAAUA,EACflpB,KAAKknC,GAAKA,EACVlnC,KAAKsnC,IAAMA,EACXtnC,KAAKkP,KAAO,YAChB,EAIAq4B,EACA,WACIvnC,KAAKkP,KAAO,MACZlP,KAAKsnC,KAAM,EACXtnC,KAAKX,KAAO,MACZW,KAAKkpB,QAAU,KACflpB,KAAKknC,GAAK,IACd,EAIAM,EACA,WACIxnC,KAAKkP,KAAO,eACZlP,KAAKX,KAAO,eACZW,KAAKkpB,QAAU,KACflpB,KAAKknC,GAAK,IACd,EAMAO,EAAqB,qFACrBC,EAAyB,EACzBC,EAAiB,CACjB,CAAC,MAAO,0BACR,CAAC,OAAQ,qBACT,CAAC,WAAY,uBACb,CAAC,gBAAiB,0BAClB,CAAC,YAAa,yBACd,CAAC,UAAW,8BACZ,CAAC,OAAQ,yBACT,CAAC,OAAQ,4BACT,CAAC,SAAU,6BACX,CAAC,gBAAiB,qBAClB,CACI,mBACA,0DAEJ,CAAC,SAAU,oDACX,CAAC,YAAa,iCACd,CAAC,QAAS,6BACV,CAAC,UAAW,+BACZ,CAAC,QAAS,qBACV,CAAC,aAAc,mCACf,CAAC,QAAS,6BACV,CAAC,QAAS,2BACV,CAAC,MAAO,oDACR,CAAC,MAAO,iGACR,CAAC,WAAY,wCACb,CAAC,KAAM,6CACP,CAAC,KAAM,uCACP,CAAC,KAAM,gBACP,CAAC,OAAQ,qCACT,CAAC,UAAW,uBACZ,CAAC,MAAO,0CACR,CAAC,SAAU,gCACX,CAAC,WAAY,uBACb,CAAC,YAAa,yBACd,CAAC,cAAe,mCAChB,CAAC,cAAe,qCAChB,CAAC,OAAQ,sBACT,CAAC,YAzCoB,iIA2CrBC,EAAuB,CACvB,CAAC,MAAO,kBACR,CAAC,aAAc,WACf,CAAC,gBAAiB,mBAClB,CAAC,iBAAkB,YACnB,CAAC,YAAa,UACd,CAAC,eAAgB,SACjB,CAAC,aAAc,qCACf,CAAC,aAAc,wBACf,CAAC,eAAgB,mCACjB,CAAC,aAAc,iCACf,CAAC,sBAAuB,oBACxB,CAAC,gBAAiB,oBAClB,CAAC,YAAa,oBACd,CAAC,YAAa,oBACd,CAAC,cAAe,oBAChB,CAAC,aAAc,qBACf,CAAC,aAAc,cACf,CAAC,aAAc,uDACf,CAAC,WAAY,WACb,CAAC,SAAU,SACX,CAAC,YAAa,QACd,CAAC,QAAS,iBACV,CAAC,SAAU,6BACX,CAAC,MAAO,OACR,CAAC,OAAQ,QACT,CAAC,OAAQ,UAEN,SAASC,EAAOlG,GACnB,OAAMA,EACKmG,EAAenG,GAEF,oBAAbC,UACc,oBAAdF,WACe,gBAAtBA,UAAUqG,QACH,IAAIP,EAEU,oBAAd9F,UACAoG,EAAepG,UAAUC,gBA6DJ,IAAZp5B,GAA2BA,EAAQ2gB,QACvC,IAAIie,EAAS5+B,EAAQ2gB,QAAQpwB,MAAM,IAAM,IA3D7D,CACA,SAASkvC,EAAeC,GAKpB,MAAe,KAAPA,GACJN,EAAevY,QAAO,SAAU8Y,EAASC,GACrC,IAAIC,EAAUD,EAAG,GAAIE,EAAQF,EAAG,GAChC,GAAID,EACA,OAAOA,EAEX,IAAII,EAAUD,EAAMjb,KAAK6a,GACzB,QAASK,GAAW,CAACF,EAASE,EAClC,IAAG,EACX,CAKO,SAASR,EAAeG,GAC3B,IAAIM,EAAcP,EAAeC,GACjC,IAAKM,EACD,OAAO,KAEX,IAAIlpC,EAAOkpC,EAAY,GAAIzI,EAAQyI,EAAY,GAC/C,GAAa,cAATlpC,EACA,OAAO,IAAIkoC,EAGf,IAAIiB,EAAe1I,EAAM,IAAMA,EAAM,GAAG7gC,MAAM,KAAKtH,KAAK,KAAKsH,MAAM,KAAKnG,MAAM,EAAG,GAC7E0vC,EACIA,EAAavxC,OAASywC,IACtBc,EAAe3B,EAAcA,EAAc,GAAI2B,GAAc,GA4BzE,SAA4Bl3B,GAExB,IADA,IAAIm3B,EAAS,GACJC,EAAK,EAAGA,EAAKp3B,EAAOo3B,IACzBD,EAAO/wC,KAAK,KAEhB,OAAO+wC,CACX,CAlCgFE,CAAmBjB,EAAyBc,EAAavxC,SAAS,IAI1IuxC,EAAe,GAEnB,IAAItf,EAAUsf,EAAa7wC,KAAK,KAC5BuvC,EAOD,SAAkBe,GACrB,IAAK,IAAIS,EAAK,EAAGp3B,EAAQs2B,EAAqB3wC,OAAQyxC,EAAKp3B,EAAOo3B,IAAM,CACpE,IAAIP,EAAKP,EAAqBc,GAAKxB,EAAKiB,EAAG,GAE3C,GAFuDA,EAAG,GACxC/a,KAAK6a,GAEnB,OAAOf,CAEf,CACA,OAAO,IACX,CAhBa0B,CAASX,GACdY,EAAiBpB,EAAmBra,KAAK6a,GAC7C,OAAIY,GAAkBA,EAAe,GAC1B,IAAIxB,EAAoBhoC,EAAM6pB,EAASge,EAAI2B,EAAe,IAE9D,IAAI5B,EAAY5nC,EAAM6pB,EAASge,EAC1C,qBChMoEzoC,EAAOnF,QAAQ,SAASkmC,EAAE/mC,EAAEgR,EAAEnO,EAAEyC,GAAG,IAAItF,EAAEA,EAAEwG,MAAMxG,EAAEwG,MAAM,KAAKxG,EAAE6C,EAAE,EAAEA,EAAE7C,EAAExB,OAAOqE,IAAIkkC,EAAEA,EAAEA,EAAE/mC,EAAE6C,IAAIyC,EAAE,OAAOyhC,IAAIzhC,EAAE0L,EAAE+1B,CAAC,kCCcrL,SAASjqB,EAAOjM,EAAKw/B,GACjB,IAAK,MAAM36B,KAAO26B,EACdpqC,OAAO2B,eAAeiJ,EAAK6E,EAAK,CAC5BtP,MAAOiqC,EAAM36B,GACbvN,YAAY,EACZqH,cAAc,IAItB,OAAOqB,CACX,CA4CA7K,EAAOnF,QAnCP,SAAqBsM,EAAKyI,EAAMy6B,GAC5B,IAAKljC,GAAsB,iBAARA,EACf,MAAM,IAAIZ,UAAU,oCAGnB8jC,IACDA,EAAQ,CAAC,GAGO,iBAATz6B,IACPy6B,EAAQz6B,EACRA,EAAO,IAGPA,IACAy6B,EAAMz6B,KAAOA,GAGjB,IACI,OAAOkH,EAAO3P,EAAKkjC,EACvB,CAAE,MAAO7f,GACL6f,EAAMjhC,QAAUjC,EAAIiC,QACpBihC,EAAM9gC,MAAQpC,EAAIoC,MAElB,MAAM+gC,EAAW,WAAa,EAE9BA,EAASlwC,UAAY6F,OAAOC,OAAOD,OAAOsqC,eAAepjC,IAKzD,OAFe2P,EAAO,IAAIwzB,EAAYD,EAG1C,CACJ,sCChEA,MAAMG,EAAmB,EAAQ,MACjC3vC,EAAQ,GAAgB2vC,EAAiBC,cAQvBD,EAAiBC,gECVnCxqC,OAAO2B,eAAe/G,EAAS,aAAc,CAAEuF,OAAO,IACtD,MAAMsqC,EACFrpC,cACIE,KAAKopC,UAAY,GACjBppC,KAAKqpC,UAAY,GACjBrpC,KAAKspC,cAAgB,CAAC,EACtBtpC,KAAKupC,UAAW,EAChBvpC,KAAKwpC,WAAY,CACrB,CACA9xC,KAAKmH,GACD,GAAImB,KAAKwpC,UACL,OACJ,MAAMC,EAAa,CAAE5qC,QAAOw5B,MAAM,GAClC,GAAIr4B,KAAKopC,UAAUnyC,OAAQ,CACvB,MAAMyyC,EAAc1pC,KAAKopC,UAAUhqC,QAC/BsqC,GACAA,EAAYj4B,QAAQg4B,EAC5B,MAEIzpC,KAAKqpC,UAAU3xC,KAAK8Z,QAAQC,QAAQg4B,SACT/hC,IAAvB1H,KAAK2pC,eACL3pC,KAAKqpC,UAAUpyC,QAAU+I,KAAK2pC,gBAC7B3pC,KAAKupC,WACNvpC,KAAKupC,UAAW,EACZvpC,KAAKspC,cAAcM,UACnB5pC,KAAKspC,cAAcM,YAEdlxC,GACLA,EAAQqa,KAAK,+BAA+B/S,KAAKqpC,UAAUpyC,gBAI3E,CACA4yC,OACI,IAAI7pC,KAAKwpC,UAAT,CAEAxpC,KAAKwpC,WAAY,EACjBxpC,KAAK6lC,SACL,IAAK,MAAM6D,KAAe1pC,KAAKopC,UAC3BM,EAAYj4B,QAAQ,CAAE5S,WAAO6I,EAAW2wB,MAAM,IAElDr4B,KAAKopC,UAAUnyC,OAAS,CANd,CAOd,CACA6yC,KAAK1pB,GACD,IAAIpgB,KAAKwpC,UAIT,GAFAxpC,KAAKwpC,WAAY,EACjBxpC,KAAK6lC,SACD7lC,KAAKopC,UAAUnyC,OAAQ,CACvB,IAAK,MAAMyyC,KAAe1pC,KAAKopC,UAC3BM,EAAYh4B,OAAO0O,GAEvBpgB,KAAKopC,UAAUnyC,OAAS,CAC5B,KACK,CACD,MAAM8yC,EAAYv4B,QAAQE,OAAO0O,GAEjC2pB,EAAUtc,OAAM,SAChBztB,KAAKqpC,UAAU3xC,KAAKqyC,EACxB,CACJ,CACAlE,SACIr0B,QAAQC,UAAU+b,MAAK,KACfxtB,KAAKgqC,gBACLhqC,KAAKgqC,gBAAgB,GAEjC,CACA,CAACxzC,OAAOgc,iBACJ,MAAO,CACHnH,KAAOxM,IACH,MAAM+a,EAAS5Z,KAAKqpC,UAAUjqC,QAC9B,OAAIwa,QAC0BlS,IAAtB1H,KAAKiqC,cACLjqC,KAAKqpC,UAAUpyC,QAAU+I,KAAKiqC,cAC9BjqC,KAAKupC,WACLvpC,KAAKupC,UAAW,EACZvpC,KAAKspC,cAAcY,UACnBlqC,KAAKspC,cAAcY,YAGpBtwB,GAEF5Z,KAAKwpC,UACHh4B,QAAQC,QAAQ,CAAE5S,WAAO6I,EAAW2wB,MAAM,IAG1C,IAAI7mB,SAAQ,CAACC,EAASC,KACzB1R,KAAKopC,UAAU1xC,KAAK,CAAE+Z,UAASC,UAAS,GAEhD,EAEJy4B,OAAQ,KACJnqC,KAAKwpC,WAAY,EACjBxpC,KAAKqpC,UAAUpyC,OAAS,EACxB+I,KAAK6lC,SACEr0B,QAAQC,QAAQ,CAAE5S,WAAO6I,EAAW2wB,MAAM,KAG7D,EAEJ,MAAM6Q,EACFppC,YAAYsqC,GAAQ,cAAET,EAAgB,IAAG,aAAEM,EAAe,GAAM,CAAC,GAC7D,MAAMI,EAAQ,IAAIlB,EAClBkB,EAAMV,cAAgBA,EACtBU,EAAMJ,aAAeA,EACrBI,EAAML,eACFI,EAAO,CACH1yC,KAAMmH,GAASwrC,EAAM3yC,KAAKmH,GAC1BgrC,KAAM,IAAMQ,EAAMR,OAClBC,KAAM1pB,GAASiqB,EAAMP,KAAK1pB,GAC1BkqB,GAAI,CAACC,EAAOvmC,KACRqmC,EAAMf,cAAciB,GAASvmC,CAAE,KAEjC,MAAU,GACpBhE,KAAKxJ,OAAOgc,eAAiB,IAAM63B,EAAM7zC,OAAOgc,iBAChD9T,OAAOmK,OAAO7I,KAClB,EAEJ1G,EAAQ4vC,cAAgBA,EACxB5vC,EAAA,QAAkB4vC,0CC1FdsB,aAPAC,EAAuB,iBAAZC,QAAuBA,QAAU,KAC5CC,EAAeF,GAAwB,mBAAZA,EAAEpzC,MAC7BozC,EAAEpzC,MACF,SAAsBgb,EAAQu4B,EAAUhrC,GACxC,OAAOirC,SAAShyC,UAAUxB,MAAM0B,KAAKsZ,EAAQu4B,EAAUhrC,EACzD,EAIA4qC,EADEC,GAA0B,mBAAdA,EAAEK,QACCL,EAAEK,QACVpsC,OAAOqsC,sBACC,SAAwB14B,GACvC,OAAO3T,OAAOyB,oBAAoBkS,GAC/BwH,OAAOnb,OAAOqsC,sBAAsB14B,GACzC,EAEiB,SAAwBA,GACvC,OAAO3T,OAAOyB,oBAAoBkS,EACpC,EAOF,IAAI24B,EAAchiC,OAAOikB,OAAS,SAAqBpuB,GACrD,OAAOA,GAAUA,CACnB,EAEA,SAASoG,IACPA,EAAam2B,KAAKriC,KAAKiH,KACzB,CACAvB,EAAOnF,QAAU2L,EACjBxG,EAAOnF,QAAQ6c,KAwYf,SAAc80B,EAAS5rC,GACrB,OAAO,IAAImS,SAAQ,SAAUC,EAASC,GACpC,SAASw5B,EAActlC,GACrBqlC,EAAQE,eAAe9rC,EAAM+rC,GAC7B15B,EAAO9L,EACT,CAEA,SAASwlC,IAC+B,mBAA3BH,EAAQE,gBACjBF,EAAQE,eAAe,QAASD,GAElCz5B,EAAQ,GAAG3Y,MAAMC,KAAKC,WACxB,CAEAqyC,EAA+BJ,EAAS5rC,EAAM+rC,EAAU,CAAEj1B,MAAM,IACnD,UAAT9W,GAMR,SAAuC4rC,EAASzZ,EAAS6M,GAC7B,mBAAf4M,EAAQX,IACjBe,EAA+BJ,EAAS,QAASzZ,EAAS6M,EAE9D,CATMiN,CAA8BL,EAASC,EAAe,CAAE/0B,MAAM,GAElE,GACF,EAxZAlR,EAAaA,aAAeA,EAE5BA,EAAapM,UAAU0yC,aAAU7jC,EACjCzC,EAAapM,UAAU2yC,aAAe,EACtCvmC,EAAapM,UAAU4yC,mBAAgB/jC,EAIvC,IAAIgkC,EAAsB,GAE1B,SAASC,EAAcC,GACrB,GAAwB,mBAAbA,EACT,MAAM,IAAI5mC,UAAU,0EAA4E4mC,EAEpG,CAoCA,SAASC,EAAiBC,GACxB,YAA2BpkC,IAAvBokC,EAAKL,cACAxmC,EAAaymC,oBACfI,EAAKL,aACd,CAkDA,SAASM,EAAa15B,EAAQnD,EAAM08B,EAAUI,GAC5C,IAAIvuB,EACAnI,EACA22B,EA1HsBC,EAgJ1B,GApBAP,EAAcC,QAGClkC,KADf4N,EAASjD,EAAOk5B,UAEdj2B,EAASjD,EAAOk5B,QAAU7sC,OAAOC,OAAO,MACxC0T,EAAOm5B,aAAe,SAIK9jC,IAAvB4N,EAAO62B,cACT95B,EAAOvM,KAAK,cAAeoJ,EACf08B,EAASA,SAAWA,EAASA,SAAWA,GAIpDt2B,EAASjD,EAAOk5B,SAElBU,EAAW32B,EAAOpG,SAGHxH,IAAbukC,EAEFA,EAAW32B,EAAOpG,GAAQ08B,IACxBv5B,EAAOm5B,kBAeT,GAbwB,mBAAbS,EAETA,EAAW32B,EAAOpG,GAChB88B,EAAU,CAACJ,EAAUK,GAAY,CAACA,EAAUL,GAErCI,EACTC,EAAShJ,QAAQ2I,GAEjBK,EAASv0C,KAAKk0C,IAIhBnuB,EAAIouB,EAAiBx5B,IACb,GAAK45B,EAASh1C,OAASwmB,IAAMwuB,EAAS5J,OAAQ,CACpD4J,EAAS5J,QAAS,EAGlB,IAAIpC,EAAI,IAAI1nC,MAAM,+CACE0zC,EAASh1C,OAAS,IAAME,OAAO+X,GADjC,qEAIlB+wB,EAAE5gC,KAAO,8BACT4gC,EAAEgL,QAAU54B,EACZ4tB,EAAE/wB,KAAOA,EACT+wB,EAAE3uB,MAAQ26B,EAASh1C,OA7KGi1C,EA8KHjM,EA7KnBvnC,GAAWA,EAAQqa,MAAMra,EAAQqa,KAAKm5B,EA8KxC,CAGF,OAAO75B,CACT,CAaA,SAAS+5B,IACP,IAAKpsC,KAAKqsC,MAGR,OAFArsC,KAAKqS,OAAO84B,eAAenrC,KAAKkP,KAAMlP,KAAKssC,QAC3CtsC,KAAKqsC,OAAQ,EACY,IAArBrzC,UAAU/B,OACL+I,KAAK4rC,SAAS7yC,KAAKiH,KAAKqS,QAC1BrS,KAAK4rC,SAASv0C,MAAM2I,KAAKqS,OAAQrZ,UAE5C,CAEA,SAASuzC,EAAUl6B,EAAQnD,EAAM08B,GAC/B,IAAIY,EAAQ,CAAEH,OAAO,EAAOC,YAAQ5kC,EAAW2K,OAAQA,EAAQnD,KAAMA,EAAM08B,SAAUA,GACjFa,EAAUL,EAAYhwC,KAAKowC,GAG/B,OAFAC,EAAQb,SAAWA,EACnBY,EAAMF,OAASG,EACRA,CACT,CAyHA,SAASC,EAAWr6B,EAAQnD,EAAMy9B,GAChC,IAAIr3B,EAASjD,EAAOk5B,QAEpB,QAAe7jC,IAAX4N,EACF,MAAO,GAET,IAAIs3B,EAAat3B,EAAOpG,GACxB,YAAmBxH,IAAfklC,EACK,GAEiB,mBAAfA,EACFD,EAAS,CAACC,EAAWhB,UAAYgB,GAAc,CAACA,GAElDD,EAsDT,SAAyB9xC,GAEvB,IADA,IAAI6mB,EAAM,IAAI9oB,MAAMiC,EAAI5D,QACfqE,EAAI,EAAGA,EAAIomB,EAAIzqB,SAAUqE,EAChComB,EAAIpmB,GAAKT,EAAIS,GAAGswC,UAAY/wC,EAAIS,GAElC,OAAOomB,CACT,CA3DImrB,CAAgBD,GAAcE,EAAWF,EAAYA,EAAW31C,OACpE,CAmBA,SAAS81C,EAAc79B,GACrB,IAAIoG,EAAStV,KAAKurC,QAElB,QAAe7jC,IAAX4N,EAAsB,CACxB,IAAIs3B,EAAat3B,EAAOpG,GAExB,GAA0B,mBAAf09B,EACT,OAAO,EACF,QAAmBllC,IAAfklC,EACT,OAAOA,EAAW31C,MAEtB,CAEA,OAAO,CACT,CAMA,SAAS61C,EAAWjyC,EAAKpC,GAEvB,IADA,IAAImU,EAAO,IAAIhU,MAAMH,GACZ6C,EAAI,EAAGA,EAAI7C,IAAK6C,EACvBsR,EAAKtR,GAAKT,EAAIS,GAChB,OAAOsR,CACT,CA2CA,SAASy+B,EAA+BJ,EAAS5rC,EAAMusC,EAAUvN,GAC/D,GAA0B,mBAAf4M,EAAQX,GACbjM,EAAMloB,KACR80B,EAAQ90B,KAAK9W,EAAMusC,GAEnBX,EAAQX,GAAGjrC,EAAMusC,OAEd,IAAwC,mBAA7BX,EAAQ9iB,iBAYxB,MAAM,IAAInjB,UAAU,6EAA+EimC,GATnGA,EAAQ9iB,iBAAiB9oB,GAAM,SAAS2tC,EAAavxB,GAG/C4iB,EAAMloB,MACR80B,EAAQ/iB,oBAAoB7oB,EAAM2tC,GAEpCpB,EAASnwB,EACX,GAGF,CACF,CAraA/c,OAAO2B,eAAe4E,EAAc,sBAAuB,CACzDrE,YAAY,EACZD,IAAK,WACH,OAAO+qC,CACT,EACA7vC,IAAK,SAAS4f,GACZ,GAAmB,iBAARA,GAAoBA,EAAM,GAAKuvB,EAAYvvB,GACpD,MAAM,IAAIzZ,WAAW,kGAAoGyZ,EAAM,KAEjIiwB,EAAsBjwB,CACxB,IAGFxW,EAAam2B,KAAO,gBAEG1zB,IAAjB1H,KAAKurC,SACLvrC,KAAKurC,UAAY7sC,OAAOsqC,eAAehpC,MAAMurC,UAC/CvrC,KAAKurC,QAAU7sC,OAAOC,OAAO,MAC7BqB,KAAKwrC,aAAe,GAGtBxrC,KAAKyrC,cAAgBzrC,KAAKyrC,oBAAiB/jC,CAC7C,EAIAzC,EAAapM,UAAUo0C,gBAAkB,SAAyBx0C,GAChE,GAAiB,iBAANA,GAAkBA,EAAI,GAAKuyC,EAAYvyC,GAChD,MAAM,IAAIuJ,WAAW,gFAAkFvJ,EAAI,KAG7G,OADAuH,KAAKyrC,cAAgBhzC,EACduH,IACT,EAQAiF,EAAapM,UAAUq0C,gBAAkB,WACvC,OAAOrB,EAAiB7rC,KAC1B,EAEAiF,EAAapM,UAAUiN,KAAO,SAAcoJ,GAE1C,IADA,IAAItP,EAAO,GACFtE,EAAI,EAAGA,EAAItC,UAAU/B,OAAQqE,IAAKsE,EAAKlI,KAAKsB,UAAUsC,IAC/D,IAAI6xC,EAAoB,UAATj+B,EAEXoG,EAAStV,KAAKurC,QAClB,QAAe7jC,IAAX4N,EACF63B,EAAWA,QAA4BzlC,IAAjB4N,EAAO8K,WAC1B,IAAK+sB,EACR,OAAO,EAGT,GAAIA,EAAS,CACX,IAAIC,EAGJ,GAFIxtC,EAAK3I,OAAS,IAChBm2C,EAAKxtC,EAAK,IACRwtC,aAAc70C,MAGhB,MAAM60C,EAGR,IAAIxnC,EAAM,IAAIrN,MAAM,oBAAsB60C,EAAK,KAAOA,EAAGvlC,QAAU,IAAM,KAEzE,MADAjC,EAAIynC,QAAUD,EACRxnC,CACR,CAEA,IAAI4rB,EAAUlc,EAAOpG,GAErB,QAAgBxH,IAAZ8pB,EACF,OAAO,EAET,GAAuB,mBAAZA,EACTmZ,EAAanZ,EAASxxB,KAAMJ,OAE5B,KAAI5D,EAAMw1B,EAAQv6B,OACdq2C,EAAYR,EAAWtb,EAASx1B,GACpC,IAASV,EAAI,EAAGA,EAAIU,IAAOV,EACzBqvC,EAAa2C,EAAUhyC,GAAI0E,KAAMJ,EAHX,CAM1B,OAAO,CACT,EAgEAqF,EAAapM,UAAU00C,YAAc,SAAqBr+B,EAAM08B,GAC9D,OAAOG,EAAa/rC,KAAMkP,EAAM08B,GAAU,EAC5C,EAEA3mC,EAAapM,UAAUyxC,GAAKrlC,EAAapM,UAAU00C,YAEnDtoC,EAAapM,UAAU20C,gBACnB,SAAyBt+B,EAAM08B,GAC7B,OAAOG,EAAa/rC,KAAMkP,EAAM08B,GAAU,EAC5C,EAoBJ3mC,EAAapM,UAAUsd,KAAO,SAAcjH,EAAM08B,GAGhD,OAFAD,EAAcC,GACd5rC,KAAKsqC,GAAGp7B,EAAMq9B,EAAUvsC,KAAMkP,EAAM08B,IAC7B5rC,IACT,EAEAiF,EAAapM,UAAU40C,oBACnB,SAA6Bv+B,EAAM08B,GAGjC,OAFAD,EAAcC,GACd5rC,KAAKwtC,gBAAgBt+B,EAAMq9B,EAAUvsC,KAAMkP,EAAM08B,IAC1C5rC,IACT,EAGJiF,EAAapM,UAAUsyC,eACnB,SAAwBj8B,EAAM08B,GAC5B,IAAIjrB,EAAMrL,EAAQo4B,EAAUpyC,EAAGqyC,EAK/B,GAHAhC,EAAcC,QAGClkC,KADf4N,EAAStV,KAAKurC,SAEZ,OAAOvrC,KAGT,QAAa0H,KADbiZ,EAAOrL,EAAOpG,IAEZ,OAAOlP,KAET,GAAI2gB,IAASirB,GAAYjrB,EAAKirB,WAAaA,EACb,KAAtB5rC,KAAKwrC,aACTxrC,KAAKurC,QAAU7sC,OAAOC,OAAO,cAEtB2W,EAAOpG,GACVoG,EAAO61B,gBACTnrC,KAAK8F,KAAK,iBAAkBoJ,EAAMyR,EAAKirB,UAAYA,SAElD,GAAoB,mBAATjrB,EAAqB,CAGrC,IAFA+sB,GAAY,EAEPpyC,EAAIqlB,EAAK1pB,OAAS,EAAGqE,GAAK,EAAGA,IAChC,GAAIqlB,EAAKrlB,KAAOswC,GAAYjrB,EAAKrlB,GAAGswC,WAAaA,EAAU,CACzD+B,EAAmBhtB,EAAKrlB,GAAGswC,SAC3B8B,EAAWpyC,EACX,KACF,CAGF,GAAIoyC,EAAW,EACb,OAAO1tC,KAEQ,IAAb0tC,EACF/sB,EAAKvhB,QAiIf,SAAmBuhB,EAAM0J,GACvB,KAAOA,EAAQ,EAAI1J,EAAK1pB,OAAQozB,IAC9B1J,EAAK0J,GAAS1J,EAAK0J,EAAQ,GAC7B1J,EAAKof,KACP,CAnIU6N,CAAUjtB,EAAM+sB,GAGE,IAAhB/sB,EAAK1pB,SACPqe,EAAOpG,GAAQyR,EAAK,SAEQjZ,IAA1B4N,EAAO61B,gBACTnrC,KAAK8F,KAAK,iBAAkBoJ,EAAMy+B,GAAoB/B,EAC1D,CAEA,OAAO5rC,IACT,EAEJiF,EAAapM,UAAUoN,IAAMhB,EAAapM,UAAUsyC,eAEpDlmC,EAAapM,UAAUg1C,mBACnB,SAA4B3+B,GAC1B,IAAIo+B,EAAWh4B,EAAQha,EAGvB,QAAeoM,KADf4N,EAAStV,KAAKurC,SAEZ,OAAOvrC,KAGT,QAA8B0H,IAA1B4N,EAAO61B,eAUT,OATyB,IAArBnyC,UAAU/B,QACZ+I,KAAKurC,QAAU7sC,OAAOC,OAAO,MAC7BqB,KAAKwrC,aAAe,QACM9jC,IAAjB4N,EAAOpG,KACY,KAAtBlP,KAAKwrC,aACTxrC,KAAKurC,QAAU7sC,OAAOC,OAAO,aAEtB2W,EAAOpG,IAEXlP,KAIT,GAAyB,IAArBhH,UAAU/B,OAAc,CAC1B,IACIkX,EADA1G,EAAO/I,OAAO+I,KAAK6N,GAEvB,IAAKha,EAAI,EAAGA,EAAImM,EAAKxQ,SAAUqE,EAEjB,oBADZ6S,EAAM1G,EAAKnM,KAEX0E,KAAK6tC,mBAAmB1/B,GAK1B,OAHAnO,KAAK6tC,mBAAmB,kBACxB7tC,KAAKurC,QAAU7sC,OAAOC,OAAO,MAC7BqB,KAAKwrC,aAAe,EACbxrC,IACT,CAIA,GAAyB,mBAFzBstC,EAAYh4B,EAAOpG,IAGjBlP,KAAKmrC,eAAej8B,EAAMo+B,QACrB,QAAkB5lC,IAAd4lC,EAET,IAAKhyC,EAAIgyC,EAAUr2C,OAAS,EAAGqE,GAAK,EAAGA,IACrC0E,KAAKmrC,eAAej8B,EAAMo+B,EAAUhyC,IAIxC,OAAO0E,IACT,EAmBJiF,EAAapM,UAAUy0C,UAAY,SAAmBp+B,GACpD,OAAOw9B,EAAW1sC,KAAMkP,GAAM,EAChC,EAEAjK,EAAapM,UAAUi1C,aAAe,SAAsB5+B,GAC1D,OAAOw9B,EAAW1sC,KAAMkP,GAAM,EAChC,EAEAjK,EAAa8nC,cAAgB,SAAS9B,EAAS/7B,GAC7C,MAAqC,mBAA1B+7B,EAAQ8B,cACV9B,EAAQ8B,cAAc79B,GAEtB69B,EAAch0C,KAAKkyC,EAAS/7B,EAEvC,EAEAjK,EAAapM,UAAUk0C,cAAgBA,EAiBvC9nC,EAAapM,UAAUk1C,WAAa,WAClC,OAAO/tC,KAAKwrC,aAAe,EAAIhB,EAAexqC,KAAKurC,SAAW,EAChE,kCCvaA9sC,EAAOnF,QAAU,SAAyB00C,GACxC,IAAIC,EAAMD,EAAKC,IACb5uC,EAAO2uC,EAAK3uC,KACZ6P,EAAO8+B,EAAK9+B,KACdlP,KAAKiuC,IAAMA,EACXjuC,KAAKX,KAAOA,EACZW,KAAKkP,KAAOA,CACd,sCCPA,IAAIg/B,EAA2B,EAAQ,OAEvCzvC,EAAOnF,QAAU,SAAS60C,EAAatvC,EAAOmwB,EAAMof,GASlD,IAAInT,OARS,IAATjM,IACFA,EAAO,SAGiB,IAAtBof,IACFA,EAAoBF,GAItB,IAAIG,EAAQ,IAAI/zB,IAEhB,SAASg0B,EAAQC,EAAOn2C,GACtB,IAAIo2C,EAAcH,EAAM1tC,IAAIvI,GACxBo2C,EAAaA,EAAY92C,KAAKL,MAAMm3C,EAAaD,GAChDF,EAAMxyC,IAAIzD,EAAMm2C,EACvB,CAEA,GAAIH,EAAkBvvC,GACpBo8B,EAAQ,KACRqT,EAAQ,CAACtf,GAAOnwB,OACX,CACL,IAAI2a,EAASwV,EAAOA,EAAO,IAAM,GACjC,GAAwB,oBAAbyf,UAA4B5vC,aAAiB4vC,SACtDxT,EAAQriC,MAAMC,UAAU+hB,IAAI7hB,KAAK8F,GAAO,SAAUzG,EAAMkD,GAEtD,OADAgzC,EAAQ,CAAC,GAAK90B,EAASle,GAAIlD,GACpB,IACT,SACG,GAAIQ,MAAMuJ,QAAQtD,GACrBo8B,EAAQp8B,EAAM+b,KAAI,SAAU8zB,EAAOpzC,GACjC,IAAIse,EAASu0B,EAAaO,EAAO,GAAKl1B,EAASle,EAAG8yC,GAElD,OADAx0B,EAAOy0B,MAAMjuC,QAAQkuC,GACd10B,EAAOqhB,KAChB,SACG,GAAIp8B,GAASA,EAAMiB,cAAgBpB,OAGtC,IAAK,IAAIpD,KAFT2/B,EAAQ,CAAC,EAEKp8B,EAAO,CACnB,IAAI+a,EAASu0B,EAAatvC,EAAMvD,GAAI,GAAKke,EAASle,EAAG8yC,GACrDx0B,EAAOy0B,MAAMjuC,QAAQkuC,GACrBrT,EAAM3/B,GAAKse,EAAOqhB,KACpB,MACKA,EAAQp8B,CACjB,CAEA,MAAO,CACLo8B,MAAOA,EACPoT,MAAOA,EAEX,sCCnDA,IAAIM,EAAkB,EAAQ,OAE9BlwC,EAAOnF,QAAU,SAA2BuF,GAC1C,MACmB,oBAAT+vC,MAAwB/vC,aAAiB+vC,MAChC,oBAAT9W,MAAwBj5B,aAAiBi5B,MACjDj5B,aAAiB8vC,CAErB,oBCVAlwC,EAAOnF,QAAU,MACfwG,YAAa+uC,GACX,KAAMA,EAAM,IAA4B,IAApBA,EAAM,EAAKA,GAAY,MAAM,IAAIt2C,MAAM,qDAC3DyH,KAAKrJ,OAAS,IAAIiC,MAAMi2C,GACxB7uC,KAAKkH,KAAO2nC,EAAM,EAClB7uC,KAAK8uC,IAAM,EACX9uC,KAAK+uC,IAAM,EACX/uC,KAAKqL,KAAO,IACd,CAEA3T,KAAM+kB,GACJ,YAA8B/U,IAA1B1H,KAAKrJ,OAAOqJ,KAAK8uC,OACrB9uC,KAAKrJ,OAAOqJ,KAAK8uC,KAAOryB,EACxBzc,KAAK8uC,IAAO9uC,KAAK8uC,IAAM,EAAK9uC,KAAKkH,MAC1B,EACT,CAEA9H,QACE,MAAM5H,EAAOwI,KAAKrJ,OAAOqJ,KAAK+uC,KAC9B,QAAarnC,IAATlQ,EAGJ,OAFAwI,KAAKrJ,OAAOqJ,KAAK+uC,UAAOrnC,EACxB1H,KAAK+uC,IAAO/uC,KAAK+uC,IAAM,EAAK/uC,KAAKkH,KAC1B1P,CACT,CAEA+tC,OACE,OAAOvlC,KAAKrJ,OAAOqJ,KAAK+uC,IAC1B,CAEA1I,UACE,YAAiC3+B,IAA1B1H,KAAKrJ,OAAOqJ,KAAK+uC,IAC1B,0BC/BF,MAAMC,EAAY,EAAQ,MAE1BvwC,EAAOnF,QAAU,MACfwG,YAAa+uC,GACX7uC,KAAK6uC,IAAMA,GAAO,GAClB7uC,KAAKyL,KAAO,IAAIujC,EAAUhvC,KAAK6uC,KAC/B7uC,KAAK0L,KAAO1L,KAAKyL,IACnB,CAEA/T,KAAM0T,GACJ,IAAKpL,KAAKyL,KAAK/T,KAAK0T,GAAM,CACxB,MAAM23B,EAAO/iC,KAAKyL,KAClBzL,KAAKyL,KAAOs3B,EAAK13B,KAAO,IAAI2jC,EAAU,EAAIhvC,KAAKyL,KAAK9U,OAAOM,QAC3D+I,KAAKyL,KAAK/T,KAAK0T,EACjB,CACF,CAEAhM,QACE,MAAMgM,EAAMpL,KAAK0L,KAAKtM,QACtB,QAAYsI,IAAR0D,GAAqBpL,KAAK0L,KAAKL,KAAM,CACvC,MAAMA,EAAOrL,KAAK0L,KAAKL,KAGvB,OAFArL,KAAK0L,KAAKL,KAAO,KACjBrL,KAAK0L,KAAOL,EACLrL,KAAK0L,KAAKtM,OACnB,CACA,OAAOgM,CACT,CAEAm6B,OACE,OAAOvlC,KAAK0L,KAAK65B,MACnB,CAEAc,UACE,OAAOrmC,KAAKyL,KAAK46B,SACnB,qCChBF,SAAS/mC,EAAK0tB,EAAGkS,EAAI5/B,EAAK2vC,MACtB,MAAMrd,EAAI5E,EAAE/1B,OACZ,IAAK,IAAIqE,EAAI,EAAGA,EAAIs2B,EAAGt2B,IACnB4jC,GAAKlS,EAAExxB,WAAWF,GAClB4jC,IAAMA,GAAK,IAAMA,GAAK,IAAMA,GAAK,IAAMA,GAAK,IAAMA,GAAK,IAE3D,OAAOA,IAAM,CACjB,CAxBAxgC,OAAO2B,eAAe/G,EAAS,aAAc,CAAEuF,OAAO,IAQtDS,EAAK2vC,KAAO,WAiBZ31C,EAAA,QAAkBgG,EAClBb,EAAOnF,QAAUgG,qBC1BjBb,EAAOnF,QAAyB,iBAARmM,KAAmBA,KAAK+zB,SAAW7wB,OAAO6wB,4BCDlE/6B,EAAOnF,QAAU,SAAU4nB,GAEzB,IAAKA,EAAK,MAAM3oB,MAAM,iEAEtB,IAAId,EAAO,EAAG4iB,EAAQ3b,OAAOC,OAAO,MAAOuwC,EAASxwC,OAAOC,OAAO,MAElE,SAASwwC,EAAQhhC,EAAKtP,GACpBwb,EAAMlM,GAAOtP,IACbpH,GACWypB,IACTzpB,EAAO,EACPy3C,EAAS70B,EACTA,EAAQ3b,OAAOC,OAAO,MAE1B,CAEA,MAAO,CACLqc,IAAK,SAAU7M,GACb,YAAsBzG,IAAf2S,EAAMlM,SAAsCzG,IAAhBwnC,EAAO/gC,EAC5C,EACA03B,OAAQ,SAAU13B,QACEzG,IAAf2S,EAAMlM,KACPkM,EAAMlM,QAAOzG,QACIA,IAAhBwnC,EAAO/gC,KACR+gC,EAAO/gC,QAAOzG,EAClB,EACA/G,IAAK,SAAUwN,GACb,IAAIojB,EAAIlX,EAAMlM,GACd,YAASzG,IAAN6pB,EAAwBA,OACF7pB,KAArB6pB,EAAI2d,EAAO/gC,KACbghC,EAAOhhC,EAAKojB,GACLA,QAFT,CAIF,EACA11B,IAAK,SAAUsS,EAAKtP,QACA6I,IAAf2S,EAAMlM,GAAoBkM,EAAMlM,GAAOtP,EACrCswC,EAAOhhC,EAAKtP,EACnB,EACAwQ,MAAO,WACLgL,EAAQ3b,OAAOC,OAAO,MACtBuwC,EAASxwC,OAAOC,OAAO,KACzB,EAEJ,kCCzCA,IAAIqc,EAAMtc,OAAO7F,UAAUkG,eACvBya,EAAS,IASb,SAAS41B,IAAU,CA4BnB,SAASC,EAAGrrC,EAAIqpC,EAASl3B,GACvBnW,KAAKgE,GAAKA,EACVhE,KAAKqtC,QAAUA,EACfrtC,KAAKmW,KAAOA,IAAQ,CACtB,CAaA,SAASo3B,EAAYtC,EAASV,EAAOvmC,EAAIqpC,EAASl3B,GAChD,GAAkB,mBAAPnS,EACT,MAAM,IAAIgB,UAAU,mCAGtB,IAAI4mC,EAAW,IAAIyD,EAAGrrC,EAAIqpC,GAAWpC,EAAS90B,GAC1Cm5B,EAAM91B,EAASA,EAAS+wB,EAAQA,EAMpC,OAJKU,EAAQM,QAAQ+D,GACXrE,EAAQM,QAAQ+D,GAAKtrC,GAC1BinC,EAAQM,QAAQ+D,GAAO,CAACrE,EAAQM,QAAQ+D,GAAM1D,GADhBX,EAAQM,QAAQ+D,GAAK53C,KAAKk0C,IADlCX,EAAQM,QAAQ+D,GAAO1D,EAAUX,EAAQO,gBAI7DP,CACT,CASA,SAASsE,EAAWtE,EAASqE,GACI,KAAzBrE,EAAQO,aAAoBP,EAAQM,QAAU,IAAI6D,SAC5CnE,EAAQM,QAAQ+D,EAC9B,CASA,SAASrqC,IACPjF,KAAKurC,QAAU,IAAI6D,EACnBpvC,KAAKwrC,aAAe,CACtB,CAzEI9sC,OAAOC,SACTywC,EAAOv2C,UAAY6F,OAAOC,OAAO,OAM5B,IAAIywC,GAASI,YAAWh2B,GAAS,IA2ExCvU,EAAapM,UAAUk1C,WAAa,WAClC,IACIz4B,EACAjW,EAFAskC,EAAQ,GAIZ,GAA0B,IAAtB3jC,KAAKwrC,aAAoB,OAAO7H,EAEpC,IAAKtkC,KAASiW,EAAStV,KAAKurC,QACtBvwB,EAAIjiB,KAAKuc,EAAQjW,IAAOskC,EAAMjsC,KAAK8hB,EAASna,EAAKvG,MAAM,GAAKuG,GAGlE,OAAIX,OAAOqsC,sBACFpH,EAAM9pB,OAAOnb,OAAOqsC,sBAAsBz1B,IAG5CquB,CACT,EASA1+B,EAAapM,UAAUy0C,UAAY,SAAmB/C,GACpD,IAAI+E,EAAM91B,EAASA,EAAS+wB,EAAQA,EAChCkF,EAAWzvC,KAAKurC,QAAQ+D,GAE5B,IAAKG,EAAU,MAAO,GACtB,GAAIA,EAASzrC,GAAI,MAAO,CAACyrC,EAASzrC,IAElC,IAAK,IAAI1I,EAAI,EAAGs2B,EAAI6d,EAASx4C,OAAQy4C,EAAK,IAAI92C,MAAMg5B,GAAIt2B,EAAIs2B,EAAGt2B,IAC7Do0C,EAAGp0C,GAAKm0C,EAASn0C,GAAG0I,GAGtB,OAAO0rC,CACT,EASAzqC,EAAapM,UAAUk0C,cAAgB,SAAuBxC,GAC5D,IAAI+E,EAAM91B,EAASA,EAAS+wB,EAAQA,EAChC+C,EAAYttC,KAAKurC,QAAQ+D,GAE7B,OAAKhC,EACDA,EAAUtpC,GAAW,EAClBspC,EAAUr2C,OAFM,CAGzB,EASAgO,EAAapM,UAAUiN,KAAO,SAAcykC,EAAOoF,EAAIC,EAAIC,EAAIC,EAAIC,GACjE,IAAIT,EAAM91B,EAASA,EAAS+wB,EAAQA,EAEpC,IAAKvqC,KAAKurC,QAAQ+D,GAAM,OAAO,EAE/B,IAEI1vC,EACAtE,EAHAgyC,EAAYttC,KAAKurC,QAAQ+D,GACzBtzC,EAAMhD,UAAU/B,OAIpB,GAAIq2C,EAAUtpC,GAAI,CAGhB,OAFIspC,EAAUn3B,MAAMnW,KAAKmrC,eAAeZ,EAAO+C,EAAUtpC,QAAI0D,GAAW,GAEhE1L,GACN,KAAK,EAAG,OAAOsxC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,UAAU,EACrD,KAAK,EAAG,OAAOC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,QAASsC,IAAK,EACzD,KAAK,EAAG,OAAOrC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,QAASsC,EAAIC,IAAK,EAC7D,KAAK,EAAG,OAAOtC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,QAASsC,EAAIC,EAAIC,IAAK,EACjE,KAAK,EAAG,OAAOvC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,QAASsC,EAAIC,EAAIC,EAAIC,IAAK,EACrE,KAAK,EAAG,OAAOxC,EAAUtpC,GAAGjL,KAAKu0C,EAAUD,QAASsC,EAAIC,EAAIC,EAAIC,EAAIC,IAAK,EAG3E,IAAKz0C,EAAI,EAAGsE,EAAO,IAAIhH,MAAMoD,EAAK,GAAIV,EAAIU,EAAKV,IAC7CsE,EAAKtE,EAAI,GAAKtC,UAAUsC,GAG1BgyC,EAAUtpC,GAAG3M,MAAMi2C,EAAUD,QAASztC,EACxC,KAAO,CACL,IACIwe,EADAnnB,EAASq2C,EAAUr2C,OAGvB,IAAKqE,EAAI,EAAGA,EAAIrE,EAAQqE,IAGtB,OAFIgyC,EAAUhyC,GAAG6a,MAAMnW,KAAKmrC,eAAeZ,EAAO+C,EAAUhyC,GAAG0I,QAAI0D,GAAW,GAEtE1L,GACN,KAAK,EAAGsxC,EAAUhyC,GAAG0I,GAAGjL,KAAKu0C,EAAUhyC,GAAG+xC,SAAU,MACpD,KAAK,EAAGC,EAAUhyC,GAAG0I,GAAGjL,KAAKu0C,EAAUhyC,GAAG+xC,QAASsC,GAAK,MACxD,KAAK,EAAGrC,EAAUhyC,GAAG0I,GAAGjL,KAAKu0C,EAAUhyC,GAAG+xC,QAASsC,EAAIC,GAAK,MAC5D,KAAK,EAAGtC,EAAUhyC,GAAG0I,GAAGjL,KAAKu0C,EAAUhyC,GAAG+xC,QAASsC,EAAIC,EAAIC,GAAK,MAChE,QACE,IAAKjwC,EAAM,IAAKwe,EAAI,EAAGxe,EAAO,IAAIhH,MAAMoD,EAAK,GAAIoiB,EAAIpiB,EAAKoiB,IACxDxe,EAAKwe,EAAI,GAAKplB,UAAUolB,GAG1BkvB,EAAUhyC,GAAG0I,GAAG3M,MAAMi2C,EAAUhyC,GAAG+xC,QAASztC,GAGpD,CAEA,OAAO,CACT,EAWAqF,EAAapM,UAAUyxC,GAAK,SAAYC,EAAOvmC,EAAIqpC,GACjD,OAAOE,EAAYvtC,KAAMuqC,EAAOvmC,EAAIqpC,GAAS,EAC/C,EAWApoC,EAAapM,UAAUsd,KAAO,SAAco0B,EAAOvmC,EAAIqpC,GACrD,OAAOE,EAAYvtC,KAAMuqC,EAAOvmC,EAAIqpC,GAAS,EAC/C,EAYApoC,EAAapM,UAAUsyC,eAAiB,SAAwBZ,EAAOvmC,EAAIqpC,EAASl3B,GAClF,IAAIm5B,EAAM91B,EAASA,EAAS+wB,EAAQA,EAEpC,IAAKvqC,KAAKurC,QAAQ+D,GAAM,OAAOtvC,KAC/B,IAAKgE,EAEH,OADAurC,EAAWvvC,KAAMsvC,GACVtvC,KAGT,IAAIstC,EAAYttC,KAAKurC,QAAQ+D,GAE7B,GAAIhC,EAAUtpC,GAEVspC,EAAUtpC,KAAOA,GACfmS,IAAQm3B,EAAUn3B,MAClBk3B,GAAWC,EAAUD,UAAYA,GAEnCkC,EAAWvvC,KAAMsvC,OAEd,CACL,IAAK,IAAIh0C,EAAI,EAAGga,EAAS,GAAIre,EAASq2C,EAAUr2C,OAAQqE,EAAIrE,EAAQqE,KAEhEgyC,EAAUhyC,GAAG0I,KAAOA,GACnBmS,IAASm3B,EAAUhyC,GAAG6a,MACtBk3B,GAAWC,EAAUhyC,GAAG+xC,UAAYA,IAErC/3B,EAAO5d,KAAK41C,EAAUhyC,IAOtBga,EAAOre,OAAQ+I,KAAKurC,QAAQ+D,GAAyB,IAAlBh6B,EAAOre,OAAeqe,EAAO,GAAKA,EACpEi6B,EAAWvvC,KAAMsvC,EACxB,CAEA,OAAOtvC,IACT,EASAiF,EAAapM,UAAUg1C,mBAAqB,SAA4BtD,GACtE,IAAI+E,EAUJ,OARI/E,GACF+E,EAAM91B,EAASA,EAAS+wB,EAAQA,EAC5BvqC,KAAKurC,QAAQ+D,IAAMC,EAAWvvC,KAAMsvC,KAExCtvC,KAAKurC,QAAU,IAAI6D,EACnBpvC,KAAKwrC,aAAe,GAGfxrC,IACT,EAKAiF,EAAapM,UAAUoN,IAAMhB,EAAapM,UAAUsyC,eACpDlmC,EAAapM,UAAU00C,YAActoC,EAAapM,UAAUyxC,GAK5DrlC,EAAa+qC,SAAWx2B,EAKxBvU,EAAaA,aAAeA,EAM1BxG,EAAOnF,QAAU2L,yBC9UnB,MAAMgrC,EAAmB,EAAQ,OAC3BC,EAAmB,EAAQ,MAC3BC,EAAmB,EAAQ,OAC3BC,EAAsB,EAAQ,QAC9B,yBAACC,EAAwB,4BAAEC,EAA2B,mBAAEC,GAAsB,EAAQ,MACtFC,EAAoB,EAAQ,OAC5BC,EAAsB,EAAQ,OAC9BC,EAAyB,EAAQ,OACjCC,EAAmB,EAAQ,OAC3BC,EAAmB,EAAQ,OAC3BC,EAAoB,EAAQ,OAC5BC,EAAiB,EAAQ,OAE/BryC,EAAOnF,QAAU,CACf22C,mBACAC,mBACAC,mBACAC,sBACAI,oBACAC,sBACAJ,2BACAC,8BACAC,qBACAG,yBACAC,mBACAC,mBACAC,oBACAC,yCC3BF,MAAMA,EAAiB,EAAQ,OAM/BryC,EAAOnF,QAAU,MACfwG,YAAYixC,EAAaC,GACvBhxC,KAAKixC,aAAeF,EACpB/wC,KAAKkxC,cAAgBF,CACvB,CAQAG,YAAYC,EAAOC,GACjB,OAAKD,EAIE,IAAIN,EACTM,EAAME,gBACNr4C,KAAKyL,IAAI0sC,EAAMG,aAAcF,EAAQA,EAAME,aAAe,GAC1DH,EAAMI,eACNJ,EAAMK,mBAPC,IASX,CAQAC,QAAQvjC,EAAKwjC,EAAkB,EAAGvjC,EAAU,CAAC,GAC3C,OAAOpO,KAAKixC,aAAaS,QAAQvjC,EAAKwjC,EAAiBvjC,GACpDqf,OAAOmkB,GACFA,aAAiBd,EACZ9wC,KAAKkxC,cAAcQ,QAAQvjC,EAAKwjC,EAAiBvjC,GACrDof,MAAM6jB,GACE7/B,QAAQC,QAAQzR,KAAKmxC,YAAYS,EAAOP,MAEhD5jB,OAAOokB,GACAA,aAAiBf,EACZt/B,QAAQE,OAAO1R,KAAKmxC,YAAYS,EAAOC,IAEvCrgC,QAAQE,OAAOmgC,KAKvBrgC,QAAQE,OAAOkgC,IAG9B,CAQAjxC,IAAIwN,GACF,OAAOqD,QAAQQ,IAAI,CACjBhS,KAAKixC,aAAatwC,IAAIwN,GACtBnO,KAAKkxC,cAAcvwC,IAAIwN,KACtBqf,MAAK,EAAE4jB,EAAOC,KACRrxC,KAAKmxC,YAAYC,EAAOC,IAEnC,CAEIS,aACF,OAAO9xC,KAAKixC,aAAaa,MAC3B,0BC5EF,MAAMhB,EAAiB,EAAQ,OAE/BryC,EAAOnF,QAAU,MACfwG,YAAYiyC,EAAO,CAAC,GAClB/xC,KAAKgyC,QAAUD,EAAKC,QACpBhyC,KAAKiyC,UAAYF,EAAKE,UACtBjyC,KAAKkyC,UAAYH,EAAKG,UACtBlyC,KAAKmyC,cAAgBJ,EAAKI,cAC1BnyC,KAAKoyC,cAAgBL,EAAKK,cAC1BpyC,KAAKqyC,gBAAkBN,EAAKM,eAC9B,CAEIL,cACF,OAAOhyC,KAAKsyC,QACd,CAEIN,YAAQnzC,GACV,QAAqB,IAAVA,EACT,MAAM,IAAItG,MAAM,sBAGlByH,KAAKsyC,SAAWzzC,CAClB,CAEIwzC,sBACF,OAAOryC,KAAKuyC,gBACd,CAEIF,oBAAgBxzC,GAClBmB,KAAKuyC,sBAAoC,IAAV1zC,GAAgCA,CACjE,CAEIozC,gBACF,OAAOjyC,KAAKwyC,UACd,CAEIP,cAAUpzC,GACZmB,KAAKwyC,WAAa55C,MAAMuJ,QAAQtD,GAASA,EAAQ,EACnD,CAEIszC,oBACF,OAAOnyC,KAAKyyC,cACd,CAEIN,kBAAcO,GAIhB,QAHoB,IAATA,IACTA,EAAO,KAAM,GAEK,mBAATA,EACT,MAAM,IAAIn6C,MAAM,kCAElByH,KAAKyyC,eAAiBC,CACxB,CAEIR,gBACF,OAAOlyC,KAAK2yC,UACd,CAEIT,cAAUrzC,GACZmB,KAAK2yC,WAAa/5C,MAAMuJ,QAAQtD,GAASA,EAAQ,EACnD,CAEIuzC,oBACF,OAAOpyC,KAAK4yC,cACd,CAEIR,kBAAcM,GAIhB,QAHoB,IAATA,IACTA,EAAO,KAAM,GAEK,mBAATA,EACT,MAAM,IAAIn6C,MAAM,kCAElByH,KAAK4yC,eAAiBF,CACxB,CAEAG,uBAAuB1kC,GACrB,OAAOnO,KAAKiyC,UAAU1yC,QAAQ4O,IAAQ,GAAKnO,KAAKmyC,cAAchkC,EAChE,CAEA2kC,uBAAuB3kC,GACrB,OAAOnO,KAAKkyC,UAAU3yC,QAAQ4O,IAAQ,GAAKnO,KAAKoyC,cAAcjkC,EAChE,CAEA4kC,cACE,OAAO,IAAIjC,EAAe,EAAG9nC,OAAO2oB,iBAAkB,GAAG,EAC3D,CAEAqhB,cACE,OAAO,IAAIlC,EAAe9nC,OAAO2oB,iBAAkB,EAAG,GAAG,EAC3D,CAEAshB,cACE,OAAOzhC,QAAQE,OAAO1R,KAAK+yC,cAC7B,CAEAG,eACE,OAAO1hC,QAAQC,QAAQzR,KAAK+yC,cAC9B,CAEAI,eACE,OAAO3hC,QAAQC,QAAQzR,KAAKgzC,cAC9B,CAEAtB,QAAQvjC,EAAKwjC,EAAkB,GAC7B,IAAIvyB,EAOJ,OANIpf,KAAK8yC,uBAAuB3kC,GAC9BiR,EAAMpf,KAAKmzC,eACFnzC,KAAK6yC,uBAAuB1kC,KACrCiR,EAAMpf,KAAKizC,oBAGM,IAAR7zB,EACFpf,KAAKgyC,QAAQN,QAAQvjC,EAAKwjC,IAG/B3xC,KAAKqyC,iBACPryC,KAAKgyC,QAAQN,QAAQvjC,EAAKwjC,GAAiBlkB,OAAM,SAE5CrO,EACT,CAEAg0B,MAAMjlC,EAAKklC,GACT,IAAIj0B,EAOJ,OANIpf,KAAK8yC,uBAAuB3kC,GAC9BiR,EAAMpf,KAAKmzC,eACFnzC,KAAK6yC,uBAAuB1kC,KACrCiR,EAAMpf,KAAKkzC,qBAGM,IAAR9zB,EACFpf,KAAKgyC,QAAQoB,MAAMjlC,EAAKklC,IAG7BrzC,KAAKqyC,iBACPryC,KAAKgyC,QAAQoB,MAAMjlC,EAAKklC,GAAa5lB,OAAM,SAEtCrO,EACT,CAEAk0B,QAAQnlC,EAAK2jC,GACX,IAAI1yB,EAOJ,OANIpf,KAAK8yC,uBAAuB3kC,GAC9BiR,EAAMpf,KAAKmzC,eACFnzC,KAAK6yC,uBAAuB1kC,KACrCiR,EAAMpf,KAAKkzC,qBAGM,IAAR9zB,EACFpf,KAAKgyC,QAAQsB,QAAQnlC,EAAK2jC,IAG/B9xC,KAAKqyC,iBACPryC,KAAKgyC,QAAQsB,QAAQnlC,EAAK2jC,GAAQrkB,OAAM,SAEnCrO,EACT,CAEAm0B,OAAOplC,EAAK2jC,GACV,IAAI1yB,EAOJ,OANIpf,KAAK8yC,uBAAuB3kC,GAC9BiR,EAAMpf,KAAKmzC,eACFnzC,KAAK6yC,uBAAuB1kC,KACrCiR,EAAMpf,KAAKkzC,qBAGM,IAAR9zB,EACFpf,KAAKgyC,QAAQuB,OAAOplC,EAAK2jC,IAG9B9xC,KAAKqyC,iBACPryC,KAAKgyC,QAAQuB,OAAOplC,EAAK2jC,GAAQrkB,OAAM,SAElCrO,EACT,CAEAze,IAAIwN,GACF,IAAIiR,EAOJ,OANIpf,KAAK8yC,uBAAuB3kC,GAC9BiR,EAAMpf,KAAKmzC,eACFnzC,KAAK6yC,uBAAuB1kC,KACrCiR,EAAMpf,KAAKkzC,qBAGM,IAAR9zB,GAAuBpf,KAAKqyC,gBAC9BryC,KAAKgyC,QAAQrxC,IAAIwN,GAGnBiR,CACT,CAEAnH,OAAO9J,GACL,OAAOnO,KAAKgyC,QAAQ/5B,OAAO9J,EAC7B,sBCjMF1P,EAAOnF,QAAU,MAYfwG,YAAYiyC,EAAO,CAAC,GAClB/xC,KAAK8xC,OAASC,EAAKD,OACnB9xC,KAAKwzC,SAAWzB,EAAKyB,SACrBxzC,KAAKyzC,cAAgB1B,EAAK0B,cAC1BzzC,KAAK0zC,WAAa3B,EAAK2B,WACvB1zC,KAAK2zC,qBAAuB5B,EAAK4B,qBACjC3zC,KAAK4zC,UAAY7B,EAAK6B,SACxB,CAEI9B,aACF,OAAO9xC,KAAK6zC,OACd,CAEI/B,WAAOjzC,GACTmB,KAAK6zC,QAAUh1C,GAAS,EAAIA,EAAQ,CACtC,CAEI20C,eACF,OAAOxzC,KAAK8zC,SACd,CAEIN,aAAS30C,GACXmB,KAAK8zC,eAA6B,IAAVj1C,EAAwB,EAAIA,CACtD,CAEIk1C,iBACF,OAAuB,IAAhB/zC,KAAKwzC,QACd,CAEIC,oBACF,OAAOzzC,KAAKg0C,cACd,CAEIP,kBAAc50C,GAChBmB,KAAKg0C,oBAAkC,IAAVn1C,EAAwB,EAAIA,CAC3D,CAEIo1C,sBACF,OAA4B,IAArBj0C,KAAKyzC,aACd,CAEIC,iBACF,OAAO1zC,KAAKk0C,WACd,CAEIR,eAAW70C,GACbmB,KAAKk0C,iBAA+B,IAAVr1C,GAAgCqG,QAAQrG,EACpE,CAEI80C,2BACF,OAAO3zC,KAAKm0C,qBACd,CAEIR,yBAAqB90C,GACvBmB,KAAKm0C,2BAAyC,IAAVt1C,EAAwB5F,KAAKm7C,KAAKp0C,KAAK+zC,WAAa/zC,KAAK8xC,QAAUjzC,CACzG,CAEI+0C,gBACF,OAAO5zC,KAAKq0C,UACd,CAEIT,cAAU/0C,GAIZ,QAHqB,IAAVA,IACTA,EAAQ,SAEW,iBAAVA,EACT,MAAM,IAAItG,MAAM,4BAElByH,KAAKq0C,WAAax1C,CACpB,CAEAy1C,mBAAmBlmC,EAAU,CAAC,GAC5B,OAAOA,GAAWA,EAAQmmC,gBAAkB,EACxCnmC,EAAQmmC,eACRv0C,KAAKwzC,QACX,CAEAgB,OAAOrmC,GACL,OAAOnO,KAAK4zC,UAAU38C,OAAS,EAAI,GAAG+I,KAAK4zC,aAAazlC,IAAQA,CAClE,CAEAsmC,SAASC,GACP,OAAOA,EAAMj1C,UAAUO,KAAK4zC,UAAU38C,OACxC,CAEAy6C,UACE,MAAM,IAAIn5C,MAAM,8CAClB,CAEA+6C,UACE,MAAM,IAAI/6C,MAAM,8CAClB,CAEAg7C,SACE,MAAM,IAAIh7C,MAAM,6CAClB,CAEAoI,MACE,MAAM,IAAIpI,MAAM,0CAClB,CAEAsD,MACE,MAAM,IAAItD,MAAM,0CAClB,CAEA66C,QACE,MAAM,IAAI76C,MAAM,4CAClB,CAEA0f,SACE,MAAM,IAAI1f,MAAM,6CAClB,mDCtGF,MAAMo8C,EAAU,EAAQ,OAClBC,EAAS,EAAQ,OACjBC,EAAsB,EAAQ,OAC9BrE,EAAoB,EAAQ,OAC5BM,EAAiB,EAAQ,OAEzBgE,EAAU,wBAChB,IAAIC,EAAiB,KAErB,MAAMC,EAAqB,SAAUC,EAAQhuB,EAAK/X,EAAMkQ,GACtD,IAAI3C,EAEFA,EADU,OAAR2C,IAAwB,IAARA,IAAwB,IAARA,EAC3BA,EAEA,CACLkyB,gBAAiBlyB,EAAIkyB,gBACrBC,aAAcnyB,EAAImyB,aAClBC,eAAgBpyB,EAAIoyB,eACpBC,kBAAmBryB,EAAIqyB,mBAG3BwD,EAAO/Y,KAAK,CACV4Y,UACAlB,UAAW3sB,EAAI2sB,UACfsB,UAAWjuB,EAAIiuB,UACfhmC,OACAuN,QAEJ,EAEM04B,EAAiB,SAAUC,GAC/BrvC,YAAW,KACL/F,KAAKq1C,WACP9sC,EAAQ2zB,KAAKkZ,QAEyC,IAAtCp1C,KAAKs1C,UAAUF,EAAQF,YACvCC,EAAep8C,KAAKiH,KAAMo1C,EAC5B,GACC,GACL,EAEMG,EAAqB,SAAU7C,EAAMwC,EAAW/mC,EAAKsN,EAAKs2B,GAC9D,MAAMqD,EAAU,CACdN,UACAlB,UAAW5zC,KAAK4zC,UAChBlB,OACAwC,YACAz4B,KAAM,CACJtO,MACAsN,MACAs2B,SAIC/xC,KAAKq1C,WAIR9sC,EAAQ2zB,KAAKkZ,GAFbD,EAAep8C,KAAKiH,KAAMo1C,EAI9B,EAEMI,EAAmB,SAAUP,EAAQhuB,GACzC,IAAKA,GAAOA,EAAI6tB,UAAYA,QAAwD,IAAtC90C,KAAKy1C,cAAcxuB,EAAI2sB,WACnE,OAAO,EAGT,IAAIriC,EAEJ,OAAQ0V,EAAIyrB,MACV,IAAK,UACHnhC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAWlC,QAAQzqB,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKhB,IAAKwL,EAAIxK,KAAKs1B,MACzF,MACF,IAAK,UACHxgC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAWN,QAAQrsB,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKhB,IAAKwL,EAAIxK,KAAKs1B,MACzF,MACF,IAAK,SACHxgC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAWL,OAAOtsB,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKhB,IAAKwL,EAAIxK,KAAKs1B,MACxF,MACF,IAAK,QACHxgC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAWR,MAAMnsB,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKhB,IAAKwL,EAAIxK,KAAKs1B,MACvF,MACF,IAAK,MACHxgC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAWjzC,IAAIsmB,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKs1B,MACvE,MACF,IAAK,SACHxgC,EAAUvR,KAAKy1C,cAAcxuB,EAAI2sB,WAAW37B,OAAOgP,EAAIxK,KAAKtO,IAAK8Y,EAAIxK,KAAKs1B,MAC1E,MACF,QACE,OAAO,EAGPxgC,GACFA,EACGic,MAAMpO,IACL41B,EAAmBC,EAAQhuB,EAAK,UAAW7H,EAAI,IAEhDqO,OAAOioB,IACNV,EAAmBC,EAAQhuB,EAAK,SAAUyuB,EAAO,GAGzD,EAEMC,EAAmB,SAAU1uB,GACjC,IAAKA,GAAOA,EAAI6tB,UAAYA,GAAW7tB,EAAI2sB,YAAc5zC,KAAK4zC,UAC5D,OAAO,EAGT,GAAI5zC,KAAKs1C,UAAUruB,EAAIiuB,WAAY,CAEjC,IAAI91B,EAYJ,OAbA4kB,aAAahkC,KAAKs1C,UAAUruB,EAAIiuB,WAAW/Q,WAGzC/kB,EADe,OAAb6H,EAAIxK,OAA8B,IAAbwK,EAAIxK,OAA8B,IAAbwK,EAAIxK,KAC1CwK,EAAIxK,KAEJ,IAAIq0B,EACR7pB,EAAIxK,KAAK60B,gBACTrqB,EAAIxK,KAAK80B,aACTtqB,EAAIxK,KAAK+0B,eACTvqB,EAAIxK,KAAKg1B,mBAILxqB,EAAI/X,MACV,IAAK,UACHlP,KAAKs1C,UAAUruB,EAAIiuB,WAAWzjC,QAAQ2N,GACtC,MACF,IAAK,SACHpf,KAAKs1C,UAAUruB,EAAIiuB,WAAWxjC,OAAO0N,GACrC,MACF,QACE,MAAM,IAAI7mB,MAAM,6CAA6C0uB,EAAI/X,gBAG9DlP,KAAKs1C,UAAUruB,EAAIiuB,UAC5B,CACF,EAOMU,EAAU,WACd,MAAO,CACL9D,OAAQ9xC,KAAK8xC,OACb0B,SAAUxzC,KAAKwzC,SACfC,cAAezzC,KAAKyzC,cACpBC,WAAY1zC,KAAK0zC,WACjBC,qBAAsB3zC,KAAK2zC,qBAC3BC,UAAW5zC,KAAK4zC,UAEpB,EAEMiC,EAAc,SAAUpkC,EAASC,GACrC,MAAMokC,EAASvtC,EAAQutC,SACvB,IAAIZ,EAAYY,EAAO,GAAGnxC,WAAamxC,EAAO,GAAGnxC,WAejD,YAbyC,IAA9B3E,KAAKs1C,UAAUJ,KACxBA,GAAaN,EAAOmB,YAAY,IAAIpxC,SAAS,WAG/C3E,KAAKs1C,UAAUJ,GAAa,CAC1BzjC,UACAC,SACAyyB,UAAWp+B,YAAW,YACb/F,KAAKs1C,UAAUJ,GACtBxjC,EAAO,IAAInZ,MAAM,6DAA6D,GAC7EyH,KAAKg2C,YAGHd,CACT,EA0KAz2C,EAAOnF,QAAU,CACf+2C,yBAzKF,MACEvwC,cACE,GAAIi1C,EACF,OAAOA,EAGT/0C,KAAKy1C,cAAgB,CAAC,EAEtBd,EAAQ1H,gBAAgB,GAExB0H,EAAQrK,GAAG,WAAW,CAAC2K,EAAQhuB,KACzBA,GAAOA,EAAI6tB,UAAYA,GAAwB,SAAb7tB,EAAI/X,WAEc,IAA3ClP,KAAKy1C,cAAcxuB,EAAI8qB,KAAK6B,aACrC5zC,KAAKy1C,cAAcxuB,EAAI8qB,KAAK6B,WAAa,IAAIpD,EAAkBvpB,EAAI8qB,OAGrEkD,EAAO/Y,KAAK,CACV4Y,UACA5lC,KAAM,OACN0kC,UAAW3sB,EAAI8qB,KAAK6B,aAGtB4B,EAAiBz8C,KAAKiH,KAAMi1C,EAAQhuB,EACtC,IAGF8tB,EAAiB/0C,IACnB,GA8IAswC,4BA3IF,MACExwC,YAAYm2C,GACV,GAAIlB,EACF,OAAOA,EAGT/0C,KAAKy1C,cAAgB,CAAC,EAEtBQ,EAAIC,WAAU,CAACtwC,EAAKuwC,KAClBA,EAAO7L,GAAG,eAAgB8L,IACxB,MAAMnvB,EAAMmvB,EAAOC,IACnB,GAAIpvB,GAAOA,EAAI6tB,UAAYA,GAAwB,SAAb7tB,EAAI/X,UAEc,IAA3ClP,KAAKy1C,cAAcxuB,EAAI8qB,KAAK6B,aACrC5zC,KAAKy1C,cAAcxuB,EAAI8qB,KAAK6B,WAAa,IAAIpD,EAAkBvpB,EAAI8qB,OAGrEkE,EAAIK,oBAAoBF,EAAO7tC,QAAQguC,MAAO,CAC5C95B,KAAM,CAAC,EACP+5B,MAAO1B,EACPA,UACA5lC,KAAM,OACN0kC,UAAW3sB,EAAI8qB,KAAK6B,YACnB,CAAC6C,EAASr3B,KACPq3B,GACF/9C,EAAQC,IAAI89C,EAASr3B,EACvB,QAEG,CAeLo2B,EAAiBz8C,KAAKiH,KAdP,CACbk8B,KAAOwa,IACL,MAAMC,EAAaD,EACnBC,EAAWH,MAAQ1B,OACY,IAApB6B,EAAWl6B,OACpBk6B,EAAWl6B,KAAO,CAAC,GAErBw5B,EAAIK,oBAAoBF,EAAO7tC,QAAQguC,MAAOI,GAAY,CAACF,EAASr3B,KAC9Dq3B,GACF/9C,EAAQC,IAAI89C,EAASr3B,EACvB,GACA,GAG8B6H,EACtC,IACA,IAGJ8tB,EAAiB/0C,IACnB,GA2FAuwC,mBAxFF,cAAuCsE,EACjCmB,gBACF,OAAOh2C,KAAK42C,UACd,CAEIZ,cAAUn3C,GACZmB,KAAK42C,gBAA8B,IAAV/3C,EAAwB,IAAO5F,KAAKkuB,IAAIzgB,SAAS7H,GAC5E,CAEAiB,YAAYiyC,EAAO,CAAC,GAClBp/B,MAAMo/B,GAENxpC,EAAQ0kC,gBAAgB,GAExBjtC,KAAKg2C,UAAYjE,EAAKiE,UAEtBh2C,KAAKq1C,YAAa,EAElB9sC,EAAQ+hC,GAAG,WAAYrjB,IACjBA,GAAOA,EAAI6tB,UAAYA,GAAwB,SAAb7tB,EAAI/X,MAAmB+X,EAAI2sB,YAAc5zC,KAAK4zC,UAClF5zC,KAAKq1C,YAAa,EAElBM,EAAiB58C,KAAKiH,KAAMinB,EAC9B,IAIF1e,EAAQ2zB,KAAK,CACX4Y,UACA5lC,KAAM,OACN6iC,KAAM6D,EAAQ78C,KAAKiH,QAGrBA,KAAKs1C,UAAY,CAAC,CACpB,CAEA5D,QAAQvjC,EAAKwjC,EAAkB,EAAGvjC,EAAU,CAAC,GAC3C,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,UAAWk1C,EAAW/mC,EAAKwjC,EAAiBvjC,EAAQ,GAEtF,CAEAklC,QAAQnlC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GAClC,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,UAAWk1C,EAAW/mC,EAAK2jC,EAAQ1jC,EAAQ,GAE7E,CAEAmlC,OAAOplC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GACjC,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,SAAUk1C,EAAW/mC,EAAK2jC,EAAQ1jC,EAAQ,GAE5E,CAEAglC,MAAMjlC,EAAKklC,EAAajlC,EAAU,CAAC,GACjC,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,QAASk1C,EAAW/mC,EAAKklC,EAAajlC,EAAQ,GAEhF,CAEAzN,IAAIwN,EAAKC,EAAU,CAAC,GAClB,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,MAAOk1C,EAAW/mC,EAAKC,EAAQ,GAEjE,CAEA6J,OAAO9J,EAAKC,EAAU,CAAC,GACrB,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMwjC,EAAYW,EAAY98C,KAAKiH,KAAMyR,EAASC,GAElD6jC,EAAmBx8C,KAAKiH,KAAM,SAAUk1C,EAAW/mC,EAAKC,EAAQ,GAEpE,2BCvWF,MAAMyoC,EAA2B,EAAQ,OACnC/F,EAAiB,EAAQ,OAoJ/BryC,EAAOnF,QAlJP,cAAkCu9C,EAUhC/2C,YAAYiyC,GACVp/B,MAAMo/B,GAEN/xC,KAAK82C,OAAS/E,EAAKgF,WACrB,CAEAC,mBAAmBtC,EAAOuC,EAAer9B,GACvC,MAAMwF,EAAM,IAAI0xB,EAMhB,OALA1xB,EAAIoyB,eAAiB9qC,SAASkT,EAAO43B,gBACrCpyB,EAAIqyB,kBAAoB73B,EAAO43B,iBAAmByF,EAClD73B,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjEpyB,EAAImyB,aAAe33B,EAAO23B,aAEnBnyB,CACT,CAEA83B,QAAQxC,EAAO5C,EAAQiC,EAAYoD,GAAc,EAAO/oC,EAAU,CAAC,GACjE,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAM0lC,EAAQl+C,KAAKm+C,MACbhE,EAAcp6C,KAAKiQ,MAAM6qC,EAAa,KAExCoD,EACFn3C,KAAK82C,OAAOj7C,IAAI64C,EAAO5C,EAAQuB,GAAcztC,IACtCA,EAcH8L,EAAO9L,GAbP5F,KAAK82C,OAAOj7C,IACV,GAAG64C,WACHrB,EAAc,EAAI+D,EAAuB,IAAd/D,GAAuB,EAClDA,GACA,KAKE5hC,EAJY,CACV+/B,eAAgBM,EAChBP,aAAc8B,EAAc,EAAkB,IAAdA,GAAsB,GAE5C,GAKlB,IAGFrzC,KAAK82C,OAAOQ,KAAK5C,EAAO5C,GAAQ,CAAClsC,EAAK4rC,KAChC5rC,IAA0B,IAAnB4rC,EACTxxC,KAAK82C,OAAO9+B,IAAI08B,EAAO5C,EAAQuB,GAAa,CAACkE,EAAWC,KACtD,GAAID,IAAcC,EAEhB,QAAqC,IAA1BppC,EAAQqpC,eAAiCrpC,EAAQqpC,cAAgB,EAAG,CAC7E,MAAMC,EAAch5C,OAAO6W,OAAO,CAAC,EAAGnH,GACtCspC,EAAYD,cAAgBC,EAAYD,cAAiBC,EAAYD,cAAgB,EAAK,EAE1Fz3C,KAAKk3C,QAAQxC,EAAO5C,EAAQiC,EAAYoD,EAAaO,GAClDlqB,MAAKmqB,GAAalmC,EAAQkmC,KAC1BlqB,OAAMmqB,GAAalmC,EAAOkmC,IAC/B,MACElmC,EAAO,IAAInZ,MAAM,yBAGnByH,KAAK82C,OAAO9+B,IACV,GAAG08B,WACHrB,EAAc,EAAI+D,EAAuB,IAAd/D,GAAuB,EAClDA,GACA,KAKE5hC,EAJY,CACV+/B,eAAgBM,EAChBP,aAAc8B,EAAc,EAAkB,IAAdA,GAAsB,GAE5C,GAGlB,IAGFrzC,KAAK82C,OAAOn2C,IAAI,GAAG+zC,YAAgB,CAACmD,EAAcC,KAChD,GAAID,EACFnmC,EAAOmmC,OACF,CACL,MAAME,GAA8B,IAAnBD,EAA2B,EAAIA,EAC1C14B,EAAM,CACVoyB,iBACAD,aAAcwG,GAAY,EAAI9+C,KAAKioB,IAAI62B,EAAWX,EAAO,IAAM,GAEjE3lC,EAAQ2N,EACV,IAEJ,GAEJ,GAEJ,CAEAvI,KAAK69B,GACH,OAAO,IAAIljC,SAAQ,CAACC,EAASC,KAC3B,MAAM0lC,EAAQl+C,KAAKm+C,MAEnBr3C,KAAK82C,OAAOn2C,IAAI+zC,GAAO,CAAC9uC,EAAK4rC,KACtBA,EAGHxxC,KAAK82C,OAAOn2C,IAAI,GAAG+zC,YAAgB,CAACmD,EAAcC,KAChD,GAAID,EACFnmC,EAAOmmC,OACF,CACL,MAAME,GAA8B,IAAnBD,EAA2B,EAAIA,EAC1C14B,EAAM,CACVoyB,iBACAD,aAAcwG,GAAY,EAAI9+C,KAAKioB,IAAI62B,EAAWX,EAAO,IAAM,GAEjE3lC,EAAQ2N,EACV,KAZF3N,EAAQ,KAcV,GACA,GAEN,CAEAumC,QAAQtD,GACN,OAAO,IAAIljC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK82C,OAAO3nC,IAAIulC,GAAO,CAAC9uC,EAAKwZ,KACvBxZ,EACF8L,EAAO9L,IACU,IAARwZ,EACT3N,EAAQ2N,GAERpf,KAAK82C,OAAO3nC,IAAI,GAAGulC,YAAiBuD,IAC9BA,EACFvmC,EAAOumC,GAEPxmC,EAAQ2N,EACV,GAEJ,GACA,GAEN,0BClJF,MAAMy1B,EAAsB,EAAQ,OAC9BqD,EAAgB,EAAQ,OACxBpH,EAAiB,EAAQ,OAsG/BryC,EAAOnF,QApGP,cAAgCu7C,EAC9B/0C,YAAYiyC,EAAO,CAAC,GAClBp/B,MAAMo/B,GAEN/xC,KAAKm4C,eAAiB,IAAID,CAC5B,CAQAxG,QAAQvjC,EAAKwjC,EAAkB,EAAGvjC,EAAU,CAAC,GAC3C,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMgjC,EAAQ10C,KAAKw0C,OAAOrmC,GACpBklC,EAAcrzC,KAAKs0C,mBAAmBlmC,GAC5C,IAAIgR,EAAMpf,KAAKm4C,eAAeC,OAAO1D,EAAO/C,EAAiB0B,GAG7D,GAFAj0B,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GAE7DpyB,EAAIoyB,eAAiBxxC,KAAK8xC,OAExB9xC,KAAKyzC,cAAgB,GAAKr0B,EAAIoyB,gBAAmBxxC,KAAK8xC,OAASH,IAEjEvyB,EAAMpf,KAAKm4C,eAAet8C,IAAI64C,EAAOt1B,EAAIoyB,eAAgBxxC,KAAKyzC,gBAEhE/hC,EAAO0N,QACF,GAAIpf,KAAK0zC,YAAct0B,EAAImyB,aAAe,IAAMnyB,EAAIqyB,kBAAmB,CAE5E,IAAI/M,EAAQzrC,KAAKm7C,KAAKh1B,EAAImyB,cAAgBnyB,EAAIkyB,gBAAkB,IAC5D5M,EAAQ1kC,KAAK2zC,uBACfjP,EAAQtlB,EAAIoyB,eAAiBxxC,KAAK2zC,sBAGpC5tC,WAAW0L,EAASizB,EAAOtlB,EAC7B,MACE3N,EAAQ2N,EACV,GAEJ,CAEAk0B,QAAQnlC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GAClC,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAASC,IAClB,MAAM4hC,EAAcrzC,KAAKs0C,mBAAmBlmC,GACtCgR,EAAMpf,KAAKm4C,eAAeC,OAAO1D,EAAO5C,EAAQuB,GACtDj0B,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjE//B,EAAQ2N,EAAI,GAEhB,CAEAm0B,OAAOplC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GACjC,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAASC,IAClB,MAAM4hC,EAAcrzC,KAAKs0C,mBAAmBlmC,GACtCgR,EAAMpf,KAAKm4C,eAAeC,OAAO1D,GAAQ5C,EAAQuB,GACvDj0B,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjE//B,EAAQ2N,EAAI,GAEhB,CAQAg0B,MAAMjlC,EAAKklC,GACT,MAAMU,EAA2B,IAAdV,EACbgF,EAAar4C,KAAK8xC,OAAS,EAGjC,OADA9xC,KAAKm4C,eAAet8C,IAAImE,KAAKw0C,OAAOrmC,GAAMkqC,EAAYhF,GAC/C7hC,QAAQC,QACb,IAAIq/B,EAAe,EAAkB,IAAfiD,GAAoB,EAAIA,EAAYsE,GAE9D,CAEAx8C,IAAIsS,EAAK2jC,EAAQuB,GACf,MAAMU,EAAgE,KAAlDV,GAAe,EAAIA,EAAcrzC,KAAKwzC,UAG1D,OADAxzC,KAAKm4C,eAAet8C,IAAImE,KAAKw0C,OAAOrmC,GAAM2jC,EAAQuB,GAC3C7hC,QAAQC,QACb,IAAIq/B,EAAe,EAAkB,IAAfiD,GAAoB,EAAIA,EAAYjC,GAE9D,CAEAnxC,IAAIwN,GACF,MAAMiR,EAAMpf,KAAKm4C,eAAex3C,IAAIX,KAAKw0C,OAAOrmC,IAKhD,OAJY,OAARiR,IACFA,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,IAG5DhgC,QAAQC,QAAQ2N,EACzB,CAEAnH,OAAO9J,GACL,OAAOqD,QAAQC,QAAQzR,KAAKm4C,eAAelgC,OAAOjY,KAAKw0C,OAAOrmC,IAChE,yBCrGF,MAAM0oC,EAA2B,EAAQ,OACnC/F,EAAiB,EAAQ,OAO/B,SAASwH,EAAiBxB,GACxB,IACE,MAAMyB,EAAUzB,EAAOA,OAASA,EAAOA,OAASA,GAE1C,QAAE5tB,GAAYqvB,EAAQC,SAASxrB,EAAE5e,QAAQqqC,SAASC,OAClDC,EAAKzvB,EAAQjqB,MAAM,KAAK2b,KAAI2W,GAAK7qB,SAAS6qB,KAEhD,MAAO,CACLqnB,MAAOD,EAAG,GACVE,QAASF,EAAG,GACZG,MAAOH,EAAG,GAEd,CAAE,MAAO/yC,GACP,MAAO,CAAEgzC,MAAO,EAAGC,QAAS,EAAGC,MAAO,EACxC,CACF,CAEA,MAAM5I,UAAyB2G,EAW7B/2C,YAAYiyC,GACVp/B,MAAMo/B,GAEN/xC,KAAK+4C,OAAShH,EAAKgH,OACnB/4C,KAAKg5C,UAAYjH,EAAKiH,UACtBh5C,KAAKi5C,eAAiBlH,EAAKkH,eAEvBlH,EAAKmH,MACPl5C,KAAK82C,OAAS/E,EAAKmH,MAEnBl5C,KAAK82C,OAAS/E,EAAKgF,YAEW,mBAArB/2C,KAAK82C,OAAOtpB,KAErBxtB,KAAK82C,OACFtpB,MAAM2rB,IACLn5C,KAAK82C,OAASqC,EACdn5C,KAAKo5C,kBACLp5C,KAAKq5C,eAAiBf,EAAiBt4C,KAAK82C,OAAO,KAGvD92C,KAAKo5C,kBACLp5C,KAAKq5C,eAAiBf,EAAiBt4C,KAAK82C,QAEhD,CAEIiC,aACF,OAAO/4C,KAAKs5C,OACd,CAEIP,WAAOl6C,GACTmB,KAAKs5C,aAA2B,IAAVz6C,EAAwBqxC,EAAiBqJ,YAAc16C,CAC/E,CAEAoa,mBACE,MAAO,4BACT,CAEI+/B,gBACF,OAAOh5C,KAAKw5C,UACd,CAEIR,cAAUn6C,GACZmB,KAAKw5C,gBAA8B,IAAV36C,EAAwBmB,KAAK4zC,UAAY/0C,CACpE,CAEIi4C,aACF,OAAO92C,KAAKu4C,OACd,CAEIzB,WAAOj4C,GACT,QAAqB,IAAVA,EACT,MAAM,IAAItG,MAAM,oBAElByH,KAAKu4C,QAAU15C,CACjB,CAEIo6C,qBACF,OAAOj5C,KAAKy5C,eACd,CAEIR,mBAAe3vC,GACjBtJ,KAAKy5C,gBAAkBnwC,GAAO,CAAC,CACjC,CAEA8vC,kBACE,MAIMM,GAJ+B,mBAAnB15C,KAAK82C,OAAO/oC,GAC1B/N,KAAK82C,OAAO/oC,GAAG/N,KAAK+4C,QACpB/4C,KAAK82C,QAEa4C,WAAW15C,KAAKg5C,WACtCU,EAAWC,YAAY,CAAEC,QAAS,GAAK,CAAEC,mBAAoB,IAC7DH,EAAWC,YAAYj7C,OAAO6W,OAAO,CAAC,EAAGvV,KAAKi5C,eAAgB,CAAE9qC,IAAK,IAAM,CAAE2rC,QAAQ,IAErF95C,KAAK+5C,YAAcL,CACrB,CAEA1C,mBAAmBtC,EAAOuC,EAAer9B,GACvC,MAAMwF,EAAM,IAAI0xB,EAEhB,IAAIkJ,EAeJ,OAbEA,OAD0B,IAAjBpgC,EAAO/a,MACV+a,EAEAA,EAAO/a,MAGfugB,EAAIqyB,kBAAoBuI,EAAIlI,SAAWmF,EACvC73B,EAAIoyB,eAAiBwI,EAAIlI,OAEzB1yB,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjEpyB,EAAImyB,aAA8B,OAAfyI,EAAIJ,OACnB3gD,KAAKioB,IAAI,IAAIhoB,KAAK8gD,EAAIJ,QAAQK,UAAY/gD,KAAKm+C,MAAO,IACrD,EAEEj4B,CACT,CAEA83B,QAAQ/oC,EAAK2jC,EAAQiC,EAAYoD,GAAc,EAAO/oC,EAAU,CAAC,GAC/D,IAAKpO,KAAK+5C,YACR,OAAOvoC,QAAQE,OAAOnZ,MAAM,wCAG9B,MAAM2hD,EAAW9rC,EAAQ+rC,OAAS,CAAC,EAEnC,IAAIC,EACAC,EACAlD,GACFiD,EAAQ,CAAEjsC,OACVisC,EAAQ17C,OAAO6W,OAAO6kC,EAAOF,GAC7BG,EAAa,CACXC,KAAM,CACJnsC,MACA2jC,SACA8H,OAAQ7F,EAAa,EAAI,IAAI76C,KAAKA,KAAKm+C,MAAQtD,GAAc,OAGjEsG,EAAWC,KAAO57C,OAAO6W,OAAO8kC,EAAWC,KAAMJ,KAEjDE,EAAQ,CACNG,IAAK,CACH,CAAEX,OAAQ,CAAEY,IAAK,IAAIthD,OACrB,CAAE0gD,OAAQ,CAAEa,IAAK,QAEnBtsC,OAEFisC,EAAQ17C,OAAO6W,OAAO6kC,EAAOF,GAC7BG,EAAa,CACXK,aAAc,CACZvsC,MACAyrC,OAAQ7F,EAAa,EAAI,IAAI76C,KAAKA,KAAKm+C,MAAQtD,GAAc,MAE/D4G,KAAM,CAAE7I,WAEVuI,EAAWK,aAAeh8C,OAAO6W,OAAO8kC,EAAWK,aAAcR,IAInE,MAAMU,EAAgB,CACpBC,QAAQ,GAmBV,OAjBK76C,KAAKq5C,eAAeT,OAAS,GACC,IAA9B54C,KAAKq5C,eAAeT,OAClB54C,KAAKq5C,eAAeR,SAAU,GAC9B74C,KAAKq5C,eAAeR,SAAW,GAC5B74C,KAAKq5C,eAAeP,OAAS,EAErC8B,EAAcE,eAAiB,QAE/BF,EAAcG,gBAAiB,EAS1B,IAAIvpC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+5C,YAAYiB,iBACfZ,EACAC,EACAO,GACAptB,MAAMpO,IACN3N,EAAQ2N,EAAI,IACXqO,OAAOmqB,IACR,GAAIA,GAAgC,OAAnBA,EAAUvpC,KAAgB,CACzC,MAAM4sC,EAAev8C,OAAO6W,OAAO,CACjCglC,IAAK,CACH,CAAEX,OAAQ,CAAEsB,KAAM,IAAIhiD,OACtB,CAAE0gD,OAAQ,CAAEa,IAAK,QAEnBtsC,OACC+rC,GAEGiB,EAAY,CAChBb,KAAM57C,OAAO6W,OAAO,CAClBpH,MACA2jC,SACA8H,OAAQ7F,EAAa,EAAI,IAAI76C,KAAKA,KAAKm+C,MAAQtD,GAAc,MAC5DmG,IAGLl6C,KAAK+5C,YAAYiB,iBACfC,EACAE,EACAP,GACAptB,MAAMpO,IACN3N,EAAQ2N,EAAI,IACXqO,OAAO2tB,IACJA,GAAkC,OAApBA,EAAW/sC,KAC3BrO,KAAKk3C,QAAQ/oC,EAAK2jC,EAAQiC,EAAYoD,GACnC3pB,MAAKpO,GAAO3N,EAAQ2N,KACpBqO,OAAM7nB,GAAO8L,EAAO9L,KAEvB8L,EAAO0pC,EACT,GAEJ,MACE1pC,EAAOkmC,EACT,GACA,GAEN,CAEA/gC,KAAK69B,EAAOtmC,EAAU,CAAC,GACrB,IAAKpO,KAAK+5C,YACR,OAAOvoC,QAAQE,OAAOnZ,MAAM,wCAG9B,MAAM2hD,EAAW9rC,EAAQ+rC,OAAS,CAAC,EAE7BC,EAAQ17C,OAAO6W,OAAO,CAC1BpH,IAAKumC,EACL6F,IAAK,CACH,CAAEX,OAAQ,CAAEY,IAAK,IAAIthD,OACrB,CAAE0gD,OAAQ,CAAEa,IAAK,SAElBP,GAEH,OAAOl6C,KAAK+5C,YAAYsB,QAAQjB,EAClC,CAEApC,QAAQtD,EAAOtmC,EAAU,CAAC,GACxB,IAAKpO,KAAK+5C,YACR,OAAOvoC,QAAQE,OAAOnZ,MAAM,wCAG9B,MAAM2hD,EAAW9rC,EAAQ+rC,OAAS,CAAC,EAC7BC,EAAQ17C,OAAO6W,OAAO,CAAEpH,IAAKumC,GAASwF,GAE5C,OAAOl6C,KAAK+5C,YAAYuB,UAAUlB,GAC/B5sB,MAAKpO,GAAOA,EAAIm8B,aAAe,GACpC,EAGF98C,EAAOnF,QAAU42C,yBChRjB,MAAM2G,EAA2B,EAAQ,OACnC/F,EAAiB,EAAQ,OAyX/BryC,EAAOnF,QAvXP,cAA+Bu9C,EAgB7B/2C,YAAYiyC,EAAMniC,EAAK,MACrB+C,MAAMo/B,GAEN/xC,KAAK82C,OAAS/E,EAAKgF,YACnB/2C,KAAKw7C,WAAazJ,EAAK0J,UAEvBz7C,KAAK+4C,OAAShH,EAAKgH,OACnB/4C,KAAKg5C,UAAYjH,EAAKiH,UAEtBh5C,KAAK07C,sBAAwB3J,EAAK2J,sBAElC17C,KAAK27C,aAAe5J,EAAK4J,aACpB37C,KAAK27C,cAmBJ37C,KAAK07C,uBACP17C,KAAK47C,uBAEW,mBAAPhsC,GACTA,KAtBF5P,KAAK67C,oBACFruB,MAAK,KACJxtB,KAAK27C,cAAe,EAChB37C,KAAK07C,uBACP17C,KAAK47C,uBAEW,mBAAPhsC,GACTA,GACF,IAED6d,OAAO7nB,IACN,GAAkB,mBAAPgK,EAGT,MAAMhK,EAFNgK,EAAGhK,EAGL,GAUR,CAEAk2C,aAAalC,GACX,OAAO,IAAIpoC,SAASC,IAClBzR,KAAK+7C,iBACFvuB,MAAM2rB,IACLA,EAAK6C,MAAM,qCAAsC,CAACh8C,KAAK+4C,OAAQ/4C,KAAKg5C,UAAWY,IAAS,KACtF55C,KAAKi8C,mBAAmB9C,GACxB1nC,GAAS,GACT,IAEHgc,OAAM,KACLhc,GAAS,GACT,GAER,CAEAmqC,uBACM57C,KAAKk8C,wBACPlY,aAAahkC,KAAKk8C,wBAEpBl8C,KAAKk8C,uBAAyBn2C,YAAW,KACvC/F,KAAK87C,aAAa5iD,KAAKm+C,MAAQ,MAC5B7pB,MAAK,KACJxtB,KAAK47C,sBAAsB,GAC3B,GACH,KACH57C,KAAKk8C,uBAAuBC,OAC9B,CAOAJ,iBACE,OAAQ/7C,KAAKw7C,YACX,IAAK,OACH,OAAO,IAAIhqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK82C,OAAOsF,eAAc,CAACC,EAASlD,KAClC,GAAIkD,EACF,OAAO3qC,EAAO2qC,GAGhB5qC,EAAQ0nC,EAAK,GACb,IAEN,IAAK,YACH,OAAOn5C,KAAK82C,OAAOwF,kBAAkBF,gBACvC,IAAK,OACH,OAAOp8C,KAAK82C,OAAOA,OAAOyF,oBAC5B,QACE,OAAO/qC,QAAQC,QAAQzR,KAAK82C,QAElC,CAEAmF,mBAAmB9C,GACjB,OAAQn5C,KAAKw7C,YACX,IAAK,OACH,OAAOrC,EAAKqD,UACd,IAAK,YACH,OAAOx8C,KAAK82C,OAAOwF,kBAAkBG,kBAAkBtD,GACzD,IAAK,OACH,OAAOn5C,KAAK82C,OAAOA,OAAO2F,kBAAkBtD,GAC9C,QACE,OAAO,EAEb,CAOA0C,oBACE,OAAO,IAAIrqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+7C,iBACFvuB,MAAM2rB,IACLA,EAAK6C,MAAM,mCAAmCh8C,KAAK+4C,aAAc2D,IAC/D,GAAIA,EAEF,OADA18C,KAAKi8C,mBAAmB9C,GACjBznC,EAAOgrC,GAEhBvD,EAAK6C,MAAMh8C,KAAK28C,uBAAwB/2C,IACtC,GAAIA,EAEF,OADA5F,KAAKi8C,mBAAmB9C,GACjBznC,EAAO9L,GAEhB5F,KAAKi8C,mBAAmB9C,GACxB1nC,GAAS,GACT,GACF,IAEHgc,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,GAER,CAEA+2C,sBACE,MAAO,gCAAgC38C,KAAK+4C,cAAc/4C,KAAKg5C,uKAMjE,CAEIwC,iBACF,OAAOx7C,KAAK48C,WACd,CAEIpB,eAAW38C,GACb,QAAqB,IAAVA,EACT,GAAqC,eAAjCmB,KAAK82C,OAAOh3C,YAAYT,KAC1BR,EAAQ,kBACH,GAAqC,SAAjCmB,KAAK82C,OAAOh3C,YAAYT,KACjCR,EAAQ,WACH,IAAqC,cAAjCmB,KAAK82C,OAAOh3C,YAAYT,KAGjC,MAAM,IAAI9G,MAAM,4BAFhBsG,EAAQ,WAGV,CAEFmB,KAAK48C,YAAc/9C,EAAM0L,aAC3B,CAEIwuC,aACF,OAAO/4C,KAAKs5C,OACd,CAEIP,WAAOl6C,GACTmB,KAAKs5C,aAA2B,IAAVz6C,EAAwB,YAAcA,CAC9D,CAEIm6C,gBACF,OAAOh5C,KAAKw5C,UACd,CAEIR,cAAUn6C,GACZmB,KAAKw5C,gBAA8B,IAAV36C,EAAwBmB,KAAK4zC,UAAY/0C,CACpE,CAEI88C,mBACF,OAAO37C,KAAK68C,aACd,CAEIlB,iBAAa98C,GACfmB,KAAK68C,mBAAiC,IAAVh+C,KAAkCA,CAChE,CAEI68C,4BACF,OAAO17C,KAAK88C,sBACd,CAEIpB,0BAAsB78C,GACxBmB,KAAK88C,4BAA0C,IAAVj+C,GAA+BqG,QAAQrG,EAC9E,CAEAm4C,mBAAmBtC,EAAOuC,EAAer9B,GACvC,MAAMwF,EAAM,IAAI0xB,GACTiM,GAAOnjC,EAUd,OARAwF,EAAIqyB,kBAAoBwF,IAAkB8F,EAAIjL,OAC9C1yB,EAAIoyB,eAAiBpyB,EAAIqyB,kBAAoBwF,EAAgB8F,EAAIjL,OAEjE1yB,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjEpyB,EAAImyB,aAAewL,EAAInD,OACnB3gD,KAAKioB,IAAI67B,EAAInD,OAAS1gD,KAAKm+C,MAAO,IACjC,EAEEj4B,CACT,CAEA49B,mBAAmB7D,EAAMhrC,EAAK2jC,EAAQiC,EAAYoD,GAChD,OAAO,IAAI3lC,SAAQ,CAACC,EAASC,KAC3BynC,EAAK6C,MAAM,SAAUiB,IACnB,GAAIA,EAGF,OAFA9D,EAAK+D,WAEExrC,EAAOurC,GAGhB,MAAME,EAAUjkD,KAAKm+C,MACf+F,EAAYrJ,EAAa,EAAIoJ,EAAUpJ,EAAa,KAE1D,IAAIsJ,EACA1hD,EACAw7C,GACFkG,EAAI,4HAIJ1hD,EAAS,CACPqE,KAAK+4C,OAAQ/4C,KAAKg5C,UAAW7qC,EAAK2jC,EAAQsL,EAC1CtL,EACAsL,KAGFC,EAAI,oLAIJ1hD,EAAS,CACPqE,KAAK+4C,OAAQ/4C,KAAKg5C,UAAW7qC,EAAK2jC,EAAQsL,EAC1CD,EAASrL,EAAQA,EACjBqL,EAASC,IAIbjE,EAAK6C,MAAMqB,EAAG1hD,GAASi8C,IACrB,GAAIA,EAGF,OAFAuB,EAAK+D,WAEExrC,EAAOkmC,GAEhBuB,EAAK6C,MAAM,oDAAqD,CAACh8C,KAAK+4C,OAAQ/4C,KAAKg5C,UAAW7qC,IAAM,CAACmvC,EAAWl+B,KAC9G,GAAIk+B,EAGF,OAFAnE,EAAK+D,WAEExrC,EAAO4rC,GAGhBnE,EAAK6C,MAAM,UAAWp2C,IACpB,GAAIA,EAGF,OAFAuzC,EAAK+D,WAEExrC,EAAO9L,GAGhB6L,EAAQ2N,EAAI,GACZ,GACF,GACF,GACF,GAEN,CAEA83B,QAAQ/oC,EAAK2jC,EAAQiC,EAAYoD,GAAc,GAC7C,OAAKn3C,KAAK27C,aAIH,IAAInqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+7C,iBACFvuB,MAAM2rB,IACLn5C,KAAKg9C,mBAAmB7D,EAAMhrC,EAAK2jC,EAAQiC,EAAYoD,GACpD3pB,MAAMpO,IACL3N,EAAQ2N,GACRpf,KAAKi8C,mBAAmB9C,EAAK,IAE9B1rB,OAAO7nB,IACN8L,EAAO9L,GACP5F,KAAKi8C,mBAAmB9C,EAAK,GAC7B,IAEL1rB,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,IAlBG4L,QAAQE,OAAOnZ,MAAM,4BAoBhC,CAEAse,KAAK69B,GACH,OAAK10C,KAAK27C,aAIH,IAAInqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+7C,iBACFvuB,MAAM2rB,IACLA,EAAK6C,MACH,0FACA,CAACh8C,KAAK+4C,OAAQ/4C,KAAKg5C,UAAWtE,EAAOx7C,KAAKm+C,QAC1C,CAACzxC,EAAKwZ,KACAxZ,EACF8L,EAAO9L,GACiB,IAAfwZ,EAAInoB,OACbwa,EAAQ,MAERA,EAAQ2N,GAGVpf,KAAKi8C,mBAAmB9C,EAAK,GAEhC,IAEF1rB,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,IAxBG4L,QAAQE,OAAOnZ,MAAM,4BA0BhC,CAEAy/C,QAAQtD,GACN,OAAK10C,KAAK27C,aAIH,IAAInqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+7C,iBACFvuB,MAAM2rB,IACLA,EAAK6C,MACH,oCACA,CAACh8C,KAAK+4C,OAAQ/4C,KAAKg5C,UAAWtE,IAC9B,CAAC9uC,EAAKwZ,KACAxZ,EACF8L,EAAO9L,GAEP6L,EAAQ2N,EAAIm+B,aAAe,GAG7Bv9C,KAAKi8C,mBAAmB9C,EAAK,GAEhC,IAEF1rB,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,IAtBG4L,QAAQE,OAAOnZ,MAAM,4BAwBhC,0BCvXF,MAAMs+C,EAA2B,EAAQ,OACnC/F,EAAiB,EAAQ,OAsT/BryC,EAAOnF,QApTP,cAAkCu9C,EAehC/2C,YAAYiyC,EAAMniC,EAAK,MACrB+C,MAAMo/B,GAEN/xC,KAAK82C,OAAS/E,EAAKgF,YACnB/2C,KAAKw7C,WAAazJ,EAAK0J,UAEvBz7C,KAAKg5C,UAAYjH,EAAKiH,UAEtBh5C,KAAK07C,sBAAwB3J,EAAK2J,sBAElC17C,KAAK27C,aAAe5J,EAAK4J,aACpB37C,KAAK27C,aAmBU,mBAAP/rC,GACTA,IAnBF5P,KAAKw9C,eACFhwB,MAAK,KACJxtB,KAAK27C,cAAe,EAChB37C,KAAK07C,uBACP17C,KAAK47C,uBAEW,mBAAPhsC,GACTA,GACF,IAED6d,OAAO7nB,IACN,GAAkB,mBAAPgK,EAGT,MAAMhK,EAFNgK,EAAGhK,EAGL,GAOR,CAEAk2C,aAAalC,GACX,OAAO,IAAIpoC,SAASC,IAClB,MAAM4rC,EAAI,CACRh+C,KAAM,sBACNy6B,KAAM,eAAe95B,KAAKg5C,8BAC1Br9C,OAAQ,CAACi+C,IAEX55C,KAAKy9C,OAAOJ,GACT7vB,MAAK,KACJ/b,GAAS,IAEVgc,OAAM,KAELhc,GAAS,GACT,GAER,CAOAmqC,uBACM57C,KAAKk8C,wBACPlY,aAAahkC,KAAKk8C,wBAEpBl8C,KAAKk8C,uBAAyBn2C,YAAW,KACvC/F,KAAK87C,aAAa5iD,KAAKm+C,MAAQ,MAC5B7pB,MAAK,KACJxtB,KAAK47C,sBAAsB,GAC3B,GACH,KACH57C,KAAKk8C,uBAAuBC,OAC9B,CAOAJ,iBACE,OAAQ/7C,KAAKw7C,YACX,IAAK,OAQL,QACE,OAAOhqC,QAAQC,QAAQzR,KAAK82C,QAP9B,IAAK,YACH,OAAO92C,KAAK82C,OAAOwF,kBAAkBF,gBACvC,IAAK,OACH,OAAOp8C,KAAK82C,OAAOA,OAAOyF,oBAC5B,IAAK,UACH,OAAO/qC,QAAQC,QAAQzR,KAAK82C,OAAO4B,OAAOgF,QAIhD,CAEAzB,mBAAmB9C,GACjB,OAAQn5C,KAAKw7C,YACX,IAAK,OAML,IAAK,UAEL,QACE,OAAO,EAPT,IAAK,YACH,OAAOx7C,KAAK82C,OAAOwF,kBAAkBG,kBAAkBtD,GACzD,IAAK,OACH,OAAOn5C,KAAK82C,OAAOA,OAAO2F,kBAAkBtD,GAMlD,CAOAqE,eACE,OAAO,IAAIhsC,SAAQ,CAACC,EAASC,KAC3B1R,KAAKy9C,OAAO,CACV3jB,KAAM95B,KAAK28C,wBAEVnvB,MAAK,KACJ/b,GAAS,IAEVgc,OAAO7nB,IACW,UAAbA,EAAIyI,KAINoD,IAEAC,EAAO9L,EACT,GACA,GAER,CAEA+2C,sBACE,MAAO,8BAA8B38C,KAAKg5C,0HAK5C,CAEIwC,iBACF,OAAOx7C,KAAK48C,WACd,CAEIpB,eAAW38C,GACb,MAAM8+C,EAAkB39C,KAAK82C,OAAOh3C,YAAYT,KAEhD,QAAqB,IAAVR,EACT,GAAwB,WAApB8+C,EACF9+C,EAAQ,cACH,GACe,SAApB8+C,GACoB,cAApBA,EAEA9+C,EAAQ,WACH,IAAwB,cAApB8+C,EAGT,MAAM,IAAIplD,MAAM,4BAFhBsG,EAAQ,WAGV,CAGFmB,KAAK48C,YAAc/9C,EAAM0L,aAC3B,CAEIyuC,gBACF,OAAOh5C,KAAKw5C,UACd,CAEIR,cAAUn6C,GACZmB,KAAKw5C,gBAA8B,IAAV36C,EAAwBmB,KAAK4zC,UAAY/0C,CACpE,CAEI88C,mBACF,OAAO37C,KAAK68C,aACd,CAEIlB,iBAAa98C,GACfmB,KAAK68C,mBAAiC,IAAVh+C,KAAkCA,CAChE,CAEI68C,4BACF,OAAO17C,KAAK88C,sBACd,CAEIpB,0BAAsB78C,GACxBmB,KAAK88C,4BAA0C,IAAVj+C,GAA+BqG,QAAQrG,EAC9E,CAEAm4C,mBAAmBtC,EAAOuC,EAAer9B,GACvC,MAAMwF,EAAM,IAAI0xB,EACViM,EAAMnjC,EAAOgkC,KAAK,GAUxB,OARAx+B,EAAIqyB,kBAAoBwF,IAAkB8F,EAAIjL,OAC9C1yB,EAAIoyB,eAAiBpyB,EAAIqyB,kBAAoBwF,EAAgB8F,EAAIjL,OAEjE1yB,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjEpyB,EAAImyB,aAAewL,EAAInD,OACnB3gD,KAAKioB,IAAI67B,EAAInD,OAAS1gD,KAAKm+C,MAAO,IACjC,EAEEj4B,CACT,CAEAq+B,OAAOJ,GACL,MACMQ,EAAW,CAAEx+C,KAAM,GADVW,KAAKg5C,UAAUzuC,iBACQ8yC,EAAEh+C,OAAQy6B,KAAMujB,EAAEvjB,KAAMn+B,OAAQ0hD,EAAE1hD,QACxE,OAAO,IAAI6V,SAAQ,CAACC,EAASC,KAC3B1R,KAAK+7C,iBACFvuB,MAAM2rB,IACLA,EAAK6C,MAAM6B,GACRrwB,MAAMpO,IACL3N,EAAQ2N,GACRpf,KAAKi8C,mBAAmB9C,EAAK,IAE9B1rB,OAAO7nB,IACN8L,EAAO9L,GACP5F,KAAKi8C,mBAAmB9C,EAAK,GAC7B,IAEL1rB,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,GAER,CAEAsxC,QAAQ/oC,EAAK2jC,EAAQiC,EAAYoD,GAAc,GAC7C,IAAKn3C,KAAK27C,aACR,OAAOnqC,QAAQE,OAAOnZ,MAAM,6BAG9B,MAAM6kD,EAAYrJ,EAAa,EAAI76C,KAAKm+C,MAAQtD,EAAa,KACvD+J,EAAU3G,EACZ,OACA,4BACYn3C,KAAKg5C,qDACLh5C,KAAKg5C,qCAGrB,OAAOh5C,KAAKy9C,OAAO,CACjBp+C,KAAM83C,EAAc,qBAAuB,eAC3Crd,KAAM,6BACc95B,KAAKg5C,+IAGGh5C,KAAKg5C,+BAA+B7B,EAAc,EAAI,8CACvDn3C,KAAKg5C,oFAEX8E,2CAErBniD,OAAQ,CAACwS,EAAK2jC,EAAQsL,EAAWlkD,KAAKm+C,QAE1C,CAEAxgC,KAAK69B,GACH,OAAK10C,KAAK27C,aAIH,IAAInqC,SAAQ,CAACC,EAASC,KAC3B1R,KAAKy9C,OAAO,CACVp+C,KAAM,YACNy6B,KAAM,4CAC2B95B,KAAKg5C,gEACtCr9C,OAAQ,CAAC+4C,EAAOx7C,KAAKm+C,SAEpB7pB,MAAMpO,IACgB,IAAjBA,EAAI2+B,WACN3+B,EAAM,MAER3N,EAAQ2N,EAAI,IAEbqO,OAAO7nB,IACN8L,EAAO9L,EAAI,GACX,IAlBG4L,QAAQE,OAAOnZ,MAAM,4BAoBhC,CAEAy/C,QAAQtD,GACN,OAAK10C,KAAK27C,aAIH37C,KAAKy9C,OAAO,CACjBp+C,KAAM,eACNy6B,KAAM,eAAe95B,KAAKg5C,2BAC1Br9C,OAAQ,CAAC+4C,KAERlnB,MAAKpO,GAAOA,EAAI2+B,SAAW,IARrBvsC,QAAQE,OAAOnZ,MAAM,4BAShC,0BCpTF,MAAMylD,EAAwB,EAAQ,OAChCC,EAAiB,WACjBC,EAAc,UAEpBz/C,EAAOnF,QAAU,MACfwG,YAAYq+C,EAAiBpM,EAAO,CAClCqM,aAAcH,IAEdj+C,KAAKq+C,eAAiB,CACpBH,YAAa,IAAII,EAAyBH,EAAiBpM,IAE7D/xC,KAAKu+C,iBAAmBJ,EACxBn+C,KAAKw+C,cAAgBzM,EAAKqM,YAC5B,CAEAK,mBAAmBtwC,EAAM+vC,GACvB,OAAIl+C,KAAKq+C,eAAelwC,GACfnO,KAAKq+C,eAAelwC,GAAKswC,qBAEzBjtC,QAAQC,QAAQzR,KAAKu+C,iBAAiBzM,OAEjD,CAEA4M,aAAaC,EAAQxwC,EAAM+vC,GASzB,OARKl+C,KAAKq+C,eAAelwC,KACvBnO,KAAKq+C,eAAelwC,GAAO,IAAImwC,EAC7Bt+C,KAAKu+C,iBAAkB,CACrBpwC,MACAiwC,aAAcp+C,KAAKw+C,iBAIlBx+C,KAAKq+C,eAAelwC,GAAKuwC,aAAaC,EAC/C,GAGF,MAAML,EAEJx+C,YAAYq+C,EAAiBpM,EAAO,CAClCqM,aAAcH,EACd9vC,IAAK+vC,IAELl+C,KAAK4+C,KAAO7M,EAAK5jC,IACjBnO,KAAK6+C,aAAe,KACpB7+C,KAAK8+C,OAAS,GACd9+C,KAAKu+C,iBAAmBJ,EAExBn+C,KAAKw+C,cAAgBzM,EAAKqM,YAC5B,CAEAK,qBACE,OAAOz+C,KAAKu+C,iBAAiB59C,IAAIX,KAAK4+C,MACnCpxB,MAAM4jB,GACY,OAAVA,EAAiBA,EAAME,gBAAkBtxC,KAAKu+C,iBAAiBzM,QAE5E,CAEA4M,aAAaC,GACX,MAAMI,EAAQ/+C,KAEd,OAAO,IAAIwR,SAAQ,CAACC,EAASC,KACvBitC,EAASI,EAAMR,iBAAiBzM,OAClCpgC,EAAO,IAAIssC,EAAsB,oBAAoBW,qBAA0BI,EAAMR,iBAAiBzM,+BAIpGiN,EAAMD,OAAO7nD,OAAS,EACxB8nD,EAAMC,cAAcjmD,KAAKgmD,EAAOttC,EAASC,EAAQitC,GAEjDI,EAAMR,iBAAiB7M,QAAQqN,EAAMH,KAAMD,GACxCnxB,MAAMpO,IACL3N,EAAQ2N,EAAIkyB,gBAAgB,IAE7B7jB,OAAOwxB,IACFA,aAAe1mD,MACjBmZ,EAAOutC,IAEPF,EAAMC,cAAcjmD,KAAKgmD,EAAOttC,EAASC,EAAQitC,GACtB,OAAvBI,EAAMF,eACRE,EAAMF,aAAe94C,WAAWg5C,EAAMG,aAAa9iD,KAAK2iD,GAAQE,EAAI1N,eAExE,GAEN,GAEJ,CAEAyN,cAAcvtC,EAASC,EAAQitC,GAC7B,MAAMI,EAAQ/+C,KACV++C,EAAMD,OAAO7nD,OAAS8nD,EAAMP,cAC9BO,EAAMD,OAAOpnD,KAAK,CAAC+Z,UAASC,SAAQitC,WAEpCjtC,EAAO,IAAIssC,EAAsB,2CAA2Ce,EAAMP,iBAEtF,CAEAU,eACE,MAAMH,EAAQ/+C,KAOd,GAL2B,OAAvB++C,EAAMF,eACR7a,aAAa+a,EAAMF,cACnBE,EAAMF,aAAe,MAGK,IAAxBE,EAAMD,OAAO7nD,OACf,OAGF,MAAMwb,EAAOssC,EAAMD,OAAO1/C,QAC1B2/C,EAAMR,iBAAiB7M,QAAQqN,EAAMH,KAAMnsC,EAAKksC,QAC7CnxB,MAAMpO,IACL3M,EAAKhB,QAAQ2N,EAAIkyB,iBACjByN,EAAMG,aAAanmD,KAAKgmD,EAAM,IAE/BtxB,OAAOwxB,IACFA,aAAe1mD,OACjBka,EAAKf,OAAOutC,GACZF,EAAMG,aAAanmD,KAAKgmD,KAExBA,EAAMD,OAAO7b,QAAQxwB,GACM,OAAvBssC,EAAMF,eACRE,EAAMF,aAAe94C,WAAWg5C,EAAMG,aAAa9iD,KAAK2iD,GAAQE,EAAI1N,eAExE,GAEN,0BC7HF,MAAMsF,EAA2B,EAAQ,OACnC/F,EAAiB,EAAQ,OAEzBqO,EAAmB,mQA6KzB1gD,EAAOnF,QAnKP,cAA+Bu9C,EAW7B/2C,YAAYiyC,GACVp/B,MAAMo/B,GACN/xC,KAAK82C,OAAS/E,EAAKgF,YAEnB/2C,KAAKo/C,yBAA2BrN,EAAKsN,sBAErCr/C,KAAKs/C,gBAAkBvN,EAAKuN,gBAC5Bt/C,KAAKu/C,yBAA2BxN,EAAKwN,yBACI,mBAA9Bv/C,KAAK82C,OAAO0I,eACrBx/C,KAAK82C,OAAO0I,cAAc,YAAa,CACrCC,aAAc,EACdC,IAAKP,GAGX,CASAQ,gBACE,OAAK3/C,KAAKo/C,0BAINp/C,KAAK82C,OAAOniC,QAAiC,UAAvB3U,KAAK82C,OAAOniC,WAIH,mBAAxB3U,KAAK82C,OAAO8I,UAA2B5/C,KAAK82C,OAAO8I,UAIhE,CAEA5I,mBAAmBtC,EAAOuC,EAAer9B,GACvC,IAAK8e,EAAUmnB,GAAYjmC,EAEvBhhB,MAAMuJ,QAAQu2B,MACf,CAAEA,GAAYA,GACd,CAAEmnB,GAAYA,GAGjB,MAAMzgC,EAAM,IAAI0xB,EAMhB,OALA1xB,EAAIoyB,eAAiB9qC,SAASgyB,GAC9BtZ,EAAIqyB,kBAAoBryB,EAAIoyB,iBAAmByF,EAC/C73B,EAAIkyB,gBAAkBr4C,KAAKioB,IAAIlhB,KAAK8xC,OAAS1yB,EAAIoyB,eAAgB,GACjEpyB,EAAImyB,aAAesO,EAEZzgC,CACT,CAEAnhB,cAAcy2C,EAAO5C,EAAQiC,EAAYoD,GAAc,GACrD,IAAKn3C,KAAK2/C,gBACR,MAAM,IAAIpnD,MAAM,iCAGlB,MAAM86C,EAAcp6C,KAAKiQ,MAAM6qC,EAAa,KACtChd,EAAQ/2B,KAAK82C,OAAO/f,QAE1B,OAAIogB,GACE9D,EAAc,EACZrzC,KAAKs/C,iBAAoBt/C,KAAKu/C,yBAGhCxoB,EAAMl7B,IAAI64C,EAAO5C,EAAQ,CAAEgO,GAAIzM,IAF/Btc,EAAMl7B,IAAI64C,EAAO5C,EAAQ,KAAMuB,GAKjCtc,EAAMl7B,IAAI64C,EAAO5C,GAGf9xC,KAAKs/C,iBAAoBt/C,KAAKu/C,yBAG3BxoB,EAAMgpB,KAAKrL,GAAOtnB,MAAK,GAFrB2J,EAAMipB,KAAKtL,GAAOtnB,MAAK,IAK9BimB,EAAc,EACZrzC,KAAKs/C,iBAAoBt/C,KAAKu/C,yBAI9Bv/C,KAAKu/C,yBACA,IAAI/tC,SAAQ,CAACC,EAASC,KAC3B,MAAMuuC,EAAe,SAAUr6C,EAAKgU,GAClC,OAAIhU,EACK8L,EAAO9L,GAGT6L,EAAQmI,EACjB,EAEqC,mBAA1B5Z,KAAK82C,OAAOoJ,UACrBlgD,KAAK82C,OAAOoJ,UAAUxL,EAAO5C,EAAQuB,EAAa4M,GAElDjgD,KAAK82C,OAAOqJ,KAAKhB,EAAkB,EAAGzK,EAAO5C,EAAQuB,EAAa4M,EACpE,IAGKjgD,KAAK82C,OAAOqJ,KAAKhB,EAAkB,CACxC13C,KAAM,CAACitC,GACP17C,UAAW,CAAC7B,OAAO26C,GAAS36C,OAAOk8C,MAtB9BrzC,KAAK82C,OAAOoJ,UACjB,CAACxL,GAAO76B,OAAO,CAAC1iB,OAAO26C,GAAS36C,OAAOk8C,MAyBvCrzC,KAAKs/C,iBAAoBt/C,KAAKu/C,yBAI3BxoB,EAAMqpB,OAAO1L,EAAO5C,GAAQiO,KAAKrL,GAAOtnB,MAAK,GAH3C2J,EAAMqhB,OAAO1D,EAAO5C,GAAQkO,KAAKtL,GAAOtnB,MAAK,EAK1D,CAEAnvB,WAAWy2C,GACT,IAAK10C,KAAK2/C,gBACR,MAAM,IAAIpnD,MAAM,iCAElB,OAAIyH,KAAKs/C,iBAAoBt/C,KAAKu/C,yBAa3Bv/C,KAAK82C,OACT/f,QACAp2B,IAAI+zC,GACJqL,KAAKrL,GACLtnB,MAAK,GACLI,MAAM5T,IACL,MAAOk4B,GAAUl4B,EACjB,OAAe,OAAXk4B,EAAwB,KACrBl4B,CAAM,IApBR5Z,KAAK82C,OACT/f,QACAp2B,IAAI+zC,GACJsL,KAAKtL,GACLtnB,OACAI,MAAM5T,IACL,OAAQ,CAACk4B,IAAWl4B,EACpB,OAAe,OAAXk4B,EAAwB,KACrBl4B,CAAM,GAcrB,CAEAo+B,QAAQtD,GACN,OAAO10C,KAAK82C,OACT3nC,IAAIulC,GACJlnB,MAAK5T,GAAUA,EAAS,GAC7B,sBC7KFnb,EAAOnF,QAAU,MACfwG,YAAYwxC,EAAiBC,EAAcC,EAAgBC,GACzDzxC,KAAKsxC,qBAA6C,IAApBA,EAAkC,EAAIA,EACpEtxC,KAAKuxC,kBAAuC,IAAjBA,EAA+B,EAAIA,EAC9DvxC,KAAKwxC,oBAA2C,IAAnBA,EAAiC,EAAIA,EAClExxC,KAAKyxC,uBAAiD,IAAtBA,GAA4CA,CAC9E,CAEIF,mBACF,OAAOvxC,KAAKqgD,aACd,CAEI9O,iBAAapR,GAEf,OADAngC,KAAKqgD,cAAgBlgB,EACdngC,IACT,CAEIsxC,sBACF,OAAOtxC,KAAKsgD,gBACd,CAEIhP,oBAAgB/1C,GAElB,OADAyE,KAAKsgD,iBAAmB/kD,EACjByE,IACT,CAEIwxC,qBACF,OAAOxxC,KAAKugD,eACd,CAEI/O,mBAAej2C,GAEjB,OADAyE,KAAKugD,gBAAkBhlD,EAChByE,IACT,CAEIyxC,wBACF,OAAOzxC,KAAKwgD,kBACd,CAEI/O,sBAAkB5yC,GACpBmB,KAAKwgD,mBAAqBt7C,QAAQrG,EACpC,CAEA4hD,0BACE,MAAO,CACLnP,gBAAiBtxC,KAAKsxC,gBACtBC,aAAcvxC,KAAKuxC,aACnBC,eAAgBxxC,KAAKwxC,eACrBC,kBAAmBzxC,KAAKyxC,kBAE5B,CAEA,CAACj7C,OAAOkqD,IAAI,iCACV,OAAO1gD,KAAKygD,yBACd,CAEA97C,WACE,OAAOu1B,KAAKuG,UAAUzgC,KAAKygD,0BAC7B,CAEAj/B,SACE,OAAOxhB,KAAKygD,yBACd,0BC9DF,MAAM5L,EAAsB,EAAQ,OAC9B8L,EAAc,EAAQ,OACtB7P,EAAiB,EAAQ,OAE/BryC,EAAOnF,QAAU,cAAuCu7C,EAWtD/0C,YAAYiyC,EAAO,CAAC,GAClBp/B,MAAMo/B,GAEN/xC,KAAK4gD,wBAA0B7O,EAAK6O,wBACpC5gD,KAAK6gD,sBAAwB9O,EAAK8O,sBAClC7gD,KAAK8gD,iBAAmB/O,EAAK+O,iBAC7B9gD,KAAK+gD,qBAAuB,IAAIJ,CAClC,CAEI7J,aACF,OAAO92C,KAAKu4C,OACd,CAEIzB,WAAOj4C,GACT,QAAqB,IAAVA,EACT,MAAM,IAAItG,MAAM,0BAElByH,KAAKu4C,QAAU15C,CACjB,CAgBAmiD,cAAcvvC,EAASC,EAAQgjC,EAAOuC,EAAegK,EAAa7yC,EAAU,CAAC,GAC3E,MAAMgR,EAAMpf,KAAKg3C,mBAAmBtC,EAAOuC,EAAegK,GAE1D,GAAIjhD,KAAK4gD,wBAA0B,KAAO5gD,KAAK6gD,sBAAwB,IAClEzhC,EAAIoyB,gBAAkBxxC,KAAK4gD,wBAG9B,OADA5gD,KAAK+gD,qBAAqBG,MAAMxM,EAAOt1B,EAAImyB,cACvCnyB,EAAIoyB,eAAiBxxC,KAAK8xC,OACrBpgC,EAAO0N,GAEP3N,EAAQ2N,GAEZ,GAAIA,EAAIoyB,eAAiBxxC,KAAK8xC,OAAQ,CAC3C,IAAIqP,EAAe3vC,QAAQC,UAEvBzR,KAAKyzC,cAAgB,GAAKr0B,EAAIoyB,gBAAmBxxC,KAAK8xC,OAASmF,IACjE73B,EAAImyB,aAAevxC,KAAKi0C,gBACxBkN,EAAenhD,KAAKohD,OAAO1M,EAAOt1B,EAAIoyB,eAAgBxxC,KAAKi0C,gBAAiB7lC,IAG1EpO,KAAK4gD,wBAA0B,GAAKxhC,EAAIoyB,gBAAkBxxC,KAAK4gD,0BAEjE5gD,KAAK+gD,qBAAqB/oC,IAAI08B,EAAO10C,KAAK6gD,uBAC1CzhC,EAAImyB,aAAevxC,KAAKqhD,yBAG1BF,EACG3zB,MAAK,KACJ9b,EAAO0N,EAAI,IAEZqO,OAAO7nB,IACN8L,EAAO9L,EAAI,GAEjB,MAAO,GAAI5F,KAAK0zC,YAAct0B,EAAImyB,aAAe,IAAMnyB,EAAIqyB,kBAAmB,CAC5E,IAAI/M,EAAQzrC,KAAKm7C,KAAKh1B,EAAImyB,cAAgBnyB,EAAIkyB,gBAAkB,IAC5D5M,EAAQ1kC,KAAK2zC,uBACfjP,EAAQtlB,EAAIoyB,eAAiBxxC,KAAK2zC,sBAGpC5tC,WAAW0L,EAASizB,EAAOtlB,EAC7B,MACE3N,EAAQ2N,EAEZ,CAEAkiC,aAAa17C,EAAK27C,EAAU9vC,EAASC,EAAQvD,EAAKsO,GAAO,EAAOrO,EAAU,CAAC,GACnEpO,KAAK8gD,4BAA4BjM,EAGrC70C,KAAK8gD,iBAAiBS,GAAUpzC,EAAKsO,EAAMrO,GACxCof,MAAMpO,IACL3N,EAAQ2N,EAAI,IAEbqO,OAAOrO,IACN1N,EAAO0N,EAAI,IAPf1N,EAAO9L,EAUX,CAEA47C,+BAA+B9M,GAC7B,OAAI10C,KAAK4gD,wBAA0B,EAC1B5gD,KAAK+gD,qBAAqBU,eAAe/M,GAG3C,CACT,CAEIkM,8BACF,OAAO5gD,KAAK0hD,wBACd,CAEId,4BAAwB/hD,GAE1B,GADAmB,KAAK0hD,yBAA2B7iD,EAAQ6H,SAAS7H,GAAS,EACtDmB,KAAK4gD,wBAA0B,GAAK5gD,KAAK8xC,OAAS9xC,KAAK4gD,wBACzD,MAAM,IAAIroD,MAAM,0EAEpB,CAEIsoD,4BACF,OAAO7gD,KAAK2hD,sBACd,CAEId,0BAAsBhiD,GAExB,GADAmB,KAAK2hD,uBAAyB9iD,EAAQ6H,SAAS7H,GAAS,EACpDmB,KAAK6gD,sBAAwB,GAAsC,IAAjC7gD,KAAK4gD,wBACzC,MAAM,IAAIroD,MAAM,gDAEpB,CAEI8oD,8BACF,OAAqC,IAA9BrhD,KAAK2hD,sBACd,CAEIb,uBACF,OAAO9gD,KAAK4hD,iBACd,CAEId,qBAAiBjiD,GACnB,QAAqB,IAAVA,KAA2BA,aAAiBg2C,GACrD,MAAM,IAAIt8C,MAAM,4DAElByH,KAAK4hD,kBAAoB/iD,EACrBmB,KAAK4hD,oBACP5hD,KAAK4hD,kBAAkBnO,cAAgBzzC,KAAKyzC,cAC5CzzC,KAAK4hD,kBAAkBlO,WAAa1zC,KAAK0zC,WAE7C,CAWAN,MAAMjlC,EAAKklC,EAAajlC,EAAU,CAAC,GACjC,MAAM2lC,EAA2B,IAAdV,EACnB,OAAOrzC,KAAKohD,OAAOphD,KAAKw0C,OAAOrmC,GAAMnO,KAAK8xC,OAAS,EAAGiC,EAAY3lC,EACpE,CAYAvS,IAAIsS,EAAK2jC,EAAQuB,EAAajlC,EAAU,CAAC,GACvC,MAAM2lC,EAAgE,KAAlDV,GAAe,EAAIA,EAAcrzC,KAAKwzC,UAC1D,OAAOxzC,KAAKohD,OAAOphD,KAAKw0C,OAAOrmC,GAAM2jC,EAAQiC,EAAY3lC,EAC3D,CASAsjC,QAAQvjC,EAAKwjC,EAAkB,EAAGvjC,EAAU,CAAC,GAC3C,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B,MAAMgjC,EAAQ10C,KAAKw0C,OAAOrmC,GAEpB0zC,EAA8B7hD,KAAKwhD,+BAA+B9M,GACxE,GAAImN,EAA8B,EAChC,OAAOnwC,EAAO,IAAIo/B,EAAe,EAAG+Q,IAGtC7hD,KAAKk3C,QAAQxC,EAAO/C,EAAoD,IAAnC3xC,KAAKs0C,mBAAmBlmC,IAAiB,EAAOA,GAClFof,MAAMpO,IACLpf,KAAKghD,cAAcvvC,EAASC,EAAQgjC,EAAO/C,EAAiBvyB,EAAI,IAEjEqO,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,UAAW6L,EAASC,EAAQvD,EAAKwjC,EAAiBvjC,EAAQ,GACjF,GAER,CASAklC,QAAQnlC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GAClC,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAAQ,CAACC,EAASC,KAC3B1R,KAAKk3C,QAAQxC,EAAO5C,EAA2C,IAAnC9xC,KAAKs0C,mBAAmBlmC,IAAiB,EAAOA,GACzEof,MAAMpO,IACL3N,EAAQzR,KAAKg3C,mBAAmBtC,EAAO5C,EAAQ1yB,GAAK,IAErDqO,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,UAAW6L,EAASC,EAAQvD,EAAK2jC,EAAQ1jC,EAAQ,GACxE,GAER,CASAmlC,OAAOplC,EAAK2jC,EAAS,EAAG1jC,EAAU,CAAC,GACjC,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAAQ,CAACC,EAASC,KAC3B1R,KAAKk3C,QAAQxC,GAAQ5C,EAA2C,IAAnC9xC,KAAKs0C,mBAAmBlmC,IAAiB,EAAOA,GAC1Eof,MAAMpO,IACL3N,EAAQzR,KAAKg3C,mBAAmBtC,GAAQ5C,EAAQ1yB,GAAK,IAEtDqO,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,SAAU6L,EAASC,EAAQvD,EAAK2jC,EAAQ1jC,EAAQ,GACvE,GAER,CAQAzN,IAAIwN,EAAKC,EAAU,CAAC,GAClB,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAAQ,CAACC,EAASC,KAC3B1R,KAAK6W,KAAK69B,EAAOtmC,GACdof,MAAMpO,IAEH3N,EADE2N,QACM,KAEApf,KAAKg3C,mBAAmBtC,EAAO,EAAGt1B,GAC5C,IAEDqO,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,MAAO6L,EAASC,EAAQvD,EAAKC,EAAQ,GAC5D,GAER,CAQA6J,OAAO9J,EAAKC,EAAU,CAAC,GACrB,MAAMsmC,EAAQ10C,KAAKw0C,OAAOrmC,GAC1B,OAAO,IAAIqD,SAAQ,CAACC,EAASC,KAC3B1R,KAAKg4C,QAAQtD,EAAOtmC,GACjBof,MAAMpO,IACLpf,KAAK+gD,qBAAqB9oC,OAAOy8B,GACjCjjC,EAAQ2N,EAAI,IAEbqO,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,SAAU6L,EAASC,EAAQvD,EAAKC,EAAQ,GAC/D,GAER,CAKA0zC,2BACE9hD,KAAK+gD,qBAAqB9oC,QAC5B,CAUA++B,mBAAmBtC,EAAOuC,EAAegK,GACvC,MAAM,IAAI1oD,MAAM,yDAClB,CAaA6oD,OAAO1M,EAAO2D,EAAYtE,EAAY3lC,EAAU,CAAC,GAC/C,OAAO,IAAIoD,SAAQ,CAACC,EAASC,KAC3B1R,KAAKk3C,QAAQxC,EAAO2D,EAAYtE,GAAY,EAAM3lC,GAC/Cof,MAAK,KACJ/b,EAAQ,IAAIq/B,EAAe,EAAGiD,EAAa,EAAIA,GAAc,EAAGsE,GAAY,IAE7E5qB,OAAO7nB,IACN5F,KAAKshD,aAAa17C,EAAK,QAAS6L,EAASC,EAAQ1R,KAAKy0C,SAASC,GAAQX,EAAa,IAAM3lC,EAAQ,GAClG,GAER,CAaAyI,KAAK69B,EAAOtmC,EAAU,CAAC,GACrB,MAAM,IAAI7V,MAAM,2CAClB,CAaAy/C,QAAQtD,EAAOtmC,EAAU,CAAC,GACxB,MAAM,IAAI7V,MAAM,8CAClB,CAeA2+C,QAAQxC,EAAO5C,EAAQiC,EAAYoD,GAAc,EAAO/oC,EAAU,CAAC,GACjE,MAAM,IAAI7V,MAAM,8CAClB,0BC9XF,MAAMs8C,EAAsB,EAAQ,OAEpCp2C,EAAOnF,QAAU,MACfwG,eAAeiiD,GACb,GAAIA,EAAS9qD,OAAS,EACpB,MAAM,IAAIsB,MAAM,4DAElBwpD,EAAS3hD,SAAS4xC,IAChB,KAAMA,aAAmB6C,GACvB,MAAM,IAAIt8C,MAAM,4EAClB,IAGFyH,KAAKgiD,UAAYD,CACnB,CAEArQ,QAAQvjC,EAAK2jC,EAAS,GACpB,OAAO,IAAItgC,SAAQ,CAACC,EAASC,KAC3B,MAAMkD,EAAW,GACjB5U,KAAKgiD,UAAU5hD,SAAS4xC,IACtBp9B,EAASld,KAAKs6C,EAAQN,QAAQvjC,EAAK2jC,GAAQrkB,OAAMwxB,IAAO,CAAGplB,UAAU,EAAMolB,UAAQ,IAGrFztC,QAAQQ,IAAI4C,GACT4Y,MAAMpO,IACL,MAAM6iC,EAAS,CAAC,EAChB,IAAIpoB,GAAW,EAEfza,EAAIhf,SAASqS,KACW,IAAlBA,EAAKonB,WACPA,GAAW,EACb,IAGF,IAAK,IAAIv+B,EAAI,EAAGA,EAAI8jB,EAAInoB,OAAQqE,IAC1Bu+B,IAAgC,IAApBza,EAAI9jB,GAAGu+B,SACrBooB,EAAOjiD,KAAKgiD,UAAU1mD,GAAGs4C,WAAax0B,EAAI9jB,GAAG2jD,IACnCplB,IACVooB,EAAOjiD,KAAKgiD,UAAU1mD,GAAGs4C,WAAax0B,EAAI9jB,IAI1Cu+B,EACFnoB,EAAOuwC,GAEPxwC,EAAQwwC,EACV,GACA,GAER,sBCjDFxjD,EAAOnF,QAAU,MACfwG,cACEE,KAAK8X,MAAQ,CAAC,EACd9X,KAAKkiD,iBAAmB,CAC1B,CAEAC,iBACE,MAAM9K,EAAMn+C,KAAKm+C,MAEjB34C,OAAO+I,KAAKzH,KAAK8X,OAAO1X,SAAS+N,IAC3BnO,KAAK8X,MAAM3J,IAAQkpC,UACdr3C,KAAK8X,MAAM3J,EACpB,IAGFnO,KAAKkiD,iBAAmBxjD,OAAO+I,KAAKzH,KAAK8X,OAAO7gB,MAClD,CAQA+gB,IAAI7J,EAAKi0C,GACPpiD,KAAKkhD,MAAM/yC,EAAW,IAANi0C,EAClB,CAQAlB,MAAM/yC,EAAKgyB,GACTngC,KAAK8X,MAAM3J,GAAOjV,KAAKm+C,MAAQlX,EAC/BngC,KAAKkiD,mBACDliD,KAAKkiD,iBAAmB,KAC1BliD,KAAKmiD,gBAET,CAQAV,eAAetzC,GACb,MAAMyrC,EAAS55C,KAAK8X,MAAM3J,GAE1B,GAAIyrC,GAAUA,GAAU1gD,KAAKm+C,MAAO,CAClCr3C,KAAKmiD,iBACL,MAAM9K,EAAMn+C,KAAKm+C,MACjB,OAAOuC,GAAUvC,EAAMuC,EAASvC,EAAM,CACxC,CAEA,OAAO,CACT,CAOAp/B,OAAO9J,GACDA,SACKnO,KAAK8X,MAAM3J,GAElBzP,OAAO+I,KAAKzH,KAAK8X,OAAO1X,SAAS+N,WACxBnO,KAAK8X,MAAM3J,EAAI,GAG5B,0BCzEF,MAAMwyC,EAAc,EAAQ,OAE5BliD,EAAOnF,QAAUqnD,yBCFjB,MAAM0B,EAAS,EAAQ,OACjBvR,EAAiB,EAAQ,OAE/BryC,EAAOnF,QAAU,MACfwG,cAKEE,KAAKsiD,SAAW,CAAC,CACnB,CAEAlK,OAAOjqC,EAAKtP,EAAO0jD,GACjB,GAAIviD,KAAKsiD,SAASn0C,GAAM,CACtB,MAAMq0C,EAAkBxiD,KAAKsiD,SAASn0C,GAAKs0C,UACvCziD,KAAKsiD,SAASn0C,GAAKs0C,UAAUxI,WAAY,IAAI/gD,MAAO+gD,WACnD,EACL,OAAwB,IAApBuI,GAEFxiD,KAAKsiD,SAASn0C,GAAKtP,MAAQmB,KAAKsiD,SAASn0C,GAAKtP,MAAQA,EAE/C,IAAIiyC,EAAe,EAAG0R,EAAiBxiD,KAAKsiD,SAASn0C,GAAKtP,OAAO,IAGnEmB,KAAKnE,IAAIsS,EAAKtP,EAAO0jD,EAC9B,CACA,OAAOviD,KAAKnE,IAAIsS,EAAKtP,EAAO0jD,EAC9B,CAEA1mD,IAAIsS,EAAKtP,EAAO0jD,GACd,MAAMG,EAA2B,IAAdH,EAmBnB,OAjBIviD,KAAKsiD,SAASn0C,IAAQnO,KAAKsiD,SAASn0C,GAAKg2B,WAC3CH,aAAahkC,KAAKsiD,SAASn0C,GAAKg2B,WAGlCnkC,KAAKsiD,SAASn0C,GAAO,IAAIk0C,EACvBxjD,EACA6jD,EAAa,EAAI,IAAIxpD,KAAKA,KAAKm+C,MAAQqL,GAAc,MAEnDA,EAAa,IACf1iD,KAAKsiD,SAASn0C,GAAKg2B,UAAYp+B,YAAW,YACjC/F,KAAKsiD,SAASn0C,EAAI,GACxBu0C,GACC1iD,KAAKsiD,SAASn0C,GAAKg2B,UAAUgY,OAC/Bn8C,KAAKsiD,SAASn0C,GAAKg2B,UAAUgY,SAI1B,IAAIrL,EAAe,EAAkB,IAAf4R,GAAoB,EAAIA,EAAY1iD,KAAKsiD,SAASn0C,GAAKtP,OAAO,EAC7F,CAOA8B,IAAIwN,GACF,GAAInO,KAAKsiD,SAASn0C,GAAM,CACtB,MAAMq0C,EAAkBxiD,KAAKsiD,SAASn0C,GAAKs0C,UACvCziD,KAAKsiD,SAASn0C,GAAKs0C,UAAUxI,WAAY,IAAI/gD,MAAO+gD,WACnD,EACL,OAAO,IAAInJ,EAAe,EAAG0R,EAAiBxiD,KAAKsiD,SAASn0C,GAAKtP,OAAO,EAC1E,CACA,OAAO,IACT,CAOAoZ,OAAO9J,GACL,QAAInO,KAAKsiD,SAASn0C,KACZnO,KAAKsiD,SAASn0C,GAAKg2B,WACrBH,aAAahkC,KAAKsiD,SAASn0C,GAAKg2B,kBAE3BnkC,KAAKsiD,SAASn0C,IACd,EAGX,sBCjFF1P,EAAOnF,QAAU,MAOfwG,YAAYjB,EAAO4jD,EAAWte,EAAY,MACxCnkC,KAAKnB,MAAQA,EACbmB,KAAKyiD,UAAYA,EACjBziD,KAAKmkC,UAAYA,CACnB,CAEItlC,YACF,OAAOmB,KAAK2iD,MACd,CAEI9jD,UAAMA,GACRmB,KAAK2iD,OAASj8C,SAAS7H,EACzB,CAEI4jD,gBACF,OAAOziD,KAAK4iD,UACd,CAEIH,cAAU5jD,GACNA,aAAiB3F,OAAS8P,OAAOD,UAAUlK,KAC/CA,EAAQ,IAAI3F,KAAK2F,IAEnBmB,KAAK4iD,WAAa/jD,CACpB,CAEIslC,gBACF,OAAOnkC,KAAK6iD,UACd,CAEI1e,cAAUtlC,GACZmB,KAAK6iD,WAAahkD,CACpB,sBCtCFJ,EAAOnF,QAAU,cAAoCf,MACnDuH,YAAY+H,EAASi7C,GACnBnwC,QACIpa,MAAMwP,mBACRxP,MAAMwP,kBAAkB/H,KAAMA,KAAKF,aAErCE,KAAKX,KAAO,cACZW,KAAK6H,QAAUA,EACXi7C,IACF9iD,KAAK8iD,MAAQA,EAEjB,0BCXF,UAKQ,EAAO,CAAC,eAA8B,0BAAP,EAK9B,SAASC,GACd,aAGA,IAAIC,EAAUD,EAAUzhD,OAAQ2hD,EAAUF,EAAU3hD,OAAQ8hD,EAAQH,EAAU7hD,KAG1EiiD,EAAQJ,EAAUrhD,MAAe,UAAMqhD,EAAUrhD,MAAe,QAAI,CAAC,GAm0DzE,OAj0DAyhD,EAAMC,IAAM,WAmBR,SAASA,EAAI7nD,GAGT,GAFAyE,KAAKqjD,cAAgB,GACrBrjD,KAAKw1B,SAAW,GACZj6B,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CA2BA,IAAIioD,EAywDJ,OA5xDAH,EAAIvqD,UAAUwqD,cAAgBH,EAAMt6C,WAQpCw6C,EAAIvqD,UAAU28B,SAAW0tB,EAAMt6C,WAQ/Bw6C,EAAIvqD,UAAU2qD,QAAU,KAWxB9kD,OAAO2B,eAAe+iD,EAAIvqD,UAAW,WAAY,CAC7C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,YACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3BH,EAAIr0C,OAAS,SAAgB0O,EAAGwiB,GAG5B,GAFKA,IACDA,EAAIgjB,EAAQtkD,UACO,MAAnB8e,EAAE4lC,eAAyB5lC,EAAE4lC,cAAcpsD,OAC3C,IAAK,IAAIqE,EAAI,EAAGA,EAAImiB,EAAE4lC,cAAcpsD,SAAUqE,EAC1C6nD,EAAMC,IAAIK,QAAQ10C,OAAO0O,EAAE4lC,cAAc/nD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAE1E,GAAkB,MAAdiR,EAAE+X,UAAoB/X,EAAE+X,SAASv+B,OACjC,IAASqE,EAAI,EAAGA,EAAImiB,EAAE+X,SAASv+B,SAAUqE,EACrC6nD,EAAMC,IAAIM,QAAQ30C,OAAO0O,EAAE+X,SAASl6B,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAIrE,OAFiB,MAAbiR,EAAE+lC,SAAmB9kD,OAAOK,eAAehG,KAAK0kB,EAAG,YACnD0lC,EAAMC,IAAIO,eAAe50C,OAAO0O,EAAE+lC,QAASvjB,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAC7DyzB,CACX,EAaAmjB,EAAIh3C,OAAS,SAAgB2kB,EAAGa,GACtBb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IACpDryB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACK/hB,EAAE4lC,eAAiB5lC,EAAE4lC,cAAcpsD,SACrCwmB,EAAE4lC,cAAgB,IACtB5lC,EAAE4lC,cAAc3rD,KAAKyrD,EAAMC,IAAIK,QAAQr3C,OAAO2kB,EAAGA,EAAEjuB,WACnD,MACJ,KAAK,EACK2a,EAAE+X,UAAY/X,EAAE+X,SAASv+B,SAC3BwmB,EAAE+X,SAAW,IACjB/X,EAAE+X,SAAS99B,KAAKyrD,EAAMC,IAAIM,QAAQt3C,OAAO2kB,EAAGA,EAAEjuB,WAC9C,MACJ,KAAK,EACD2a,EAAE+lC,QAAUL,EAAMC,IAAIO,eAAev3C,OAAO2kB,EAAGA,EAAEjuB,UACjD,MACJ,QACIiuB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUA2lC,EAAI1mC,WAAa,SAAoBqgB,GACjC,GAAIA,aAAaomB,EAAMC,IACnB,OAAOrmB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAClB,GAAIrmB,EAAEsmB,cAAe,CACjB,IAAKzqD,MAAMuJ,QAAQ46B,EAAEsmB,eACjB,MAAMr+C,UAAU,sCACpByY,EAAE4lC,cAAgB,GAClB,IAAK,IAAI/nD,EAAI,EAAGA,EAAIyhC,EAAEsmB,cAAcpsD,SAAUqE,EAAG,CAC7C,GAAkC,iBAAvByhC,EAAEsmB,cAAc/nD,GACvB,MAAM0J,UAAU,uCACpByY,EAAE4lC,cAAc/nD,GAAK6nD,EAAMC,IAAIK,QAAQ/mC,WAAWqgB,EAAEsmB,cAAc/nD,GACtE,CACJ,CACA,GAAIyhC,EAAEvH,SAAU,CACZ,IAAK58B,MAAMuJ,QAAQ46B,EAAEvH,UACjB,MAAMxwB,UAAU,iCAEpB,IADAyY,EAAE+X,SAAW,GACJl6B,EAAI,EAAGA,EAAIyhC,EAAEvH,SAASv+B,SAAUqE,EAAG,CACxC,GAA6B,iBAAlByhC,EAAEvH,SAASl6B,GAClB,MAAM0J,UAAU,kCACpByY,EAAE+X,SAASl6B,GAAK6nD,EAAMC,IAAIM,QAAQhnC,WAAWqgB,EAAEvH,SAASl6B,GAC5D,CACJ,CACA,GAAiB,MAAbyhC,EAAEymB,QAAiB,CACnB,GAAyB,iBAAdzmB,EAAEymB,QACT,MAAMx+C,UAAU,iCACpByY,EAAE+lC,QAAUL,EAAMC,IAAIO,eAAejnC,WAAWqgB,EAAEymB,QACtD,CACA,OAAO/lC,CACX,EAWA2lC,EAAIQ,SAAW,SAAkBnmC,EAAG1f,GAC3BA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAKT,IAJIh/B,EAAE8lD,QAAU9lD,EAAE4Z,YACdolB,EAAEsmB,cAAgB,GAClBtmB,EAAEvH,SAAW,IAEb/X,EAAE4lC,eAAiB5lC,EAAE4lC,cAAcpsD,OAAQ,CAC3C8lC,EAAEsmB,cAAgB,GAClB,IAAK,IAAIjlC,EAAI,EAAGA,EAAIX,EAAE4lC,cAAcpsD,SAAUmnB,EAC1C2e,EAAEsmB,cAAcjlC,GAAK+kC,EAAMC,IAAIK,QAAQG,SAASnmC,EAAE4lC,cAAcjlC,GAAIrgB,EAE5E,CACA,GAAI0f,EAAE+X,UAAY/X,EAAE+X,SAASv+B,OAEzB,IADA8lC,EAAEvH,SAAW,GACJpX,EAAI,EAAGA,EAAIX,EAAE+X,SAASv+B,SAAUmnB,EACrC2e,EAAEvH,SAASpX,GAAK+kC,EAAMC,IAAIM,QAAQE,SAASnmC,EAAE+X,SAASpX,GAAIrgB,GAQlE,OALiB,MAAb0f,EAAE+lC,SAAmB/lC,EAAE1e,eAAe,aACtCg+B,EAAEymB,QAAUL,EAAMC,IAAIO,eAAeC,SAASnmC,EAAE+lC,QAASzlD,GACrDA,EAAE+lD,SACF/mB,EAAEgnB,SAAW,YAEdhnB,CACX,EASAqmB,EAAIvqD,UAAU2oB,OAAS,WACnB,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEAu4C,EAAIK,QAAU,WAkBV,SAASA,EAAQloD,GACb,GAAIA,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CAmBA,IAAIioD,EAqIJ,OAhJAE,EAAQ5qD,UAAUmrD,UAAY,KAQ9BP,EAAQ5qD,UAAU29C,MAAQ,KAW1B93C,OAAO2B,eAAeojD,EAAQ5qD,UAAW,aAAc,CACnD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,cACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeojD,EAAQ5qD,UAAW,SAAU,CAC/C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,UACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3BE,EAAQ10C,OAAS,SAAgB0O,EAAGwiB,GAOhC,OANKA,IACDA,EAAIgjB,EAAQtkD,UACG,MAAf8e,EAAEumC,WAAqBtlD,OAAOK,eAAehG,KAAK0kB,EAAG,cACrDwiB,EAAEn9B,OAAO,GAAGG,KAAKwa,EAAEumC,WACR,MAAXvmC,EAAE+4B,OAAiB93C,OAAOK,eAAehG,KAAK0kB,EAAG,UACjDwiB,EAAEn9B,OAAO,IAAIY,OAAO+Z,EAAE+4B,OACnBvW,CACX,EAaAwjB,EAAQr3C,OAAS,SAAgB2kB,EAAGa,GAC1Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAIK,QACxD1yB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACD/hB,EAAEumC,UAAYjzB,EAAE9tB,OAChB,MACJ,KAAK,EACDwa,EAAE+4B,MAAQzlB,EAAErtB,SACZ,MACJ,QACIqtB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUAgmC,EAAQ/mC,WAAa,SAAoBqgB,GACrC,GAAIA,aAAaomB,EAAMC,IAAIK,QACvB,OAAO1mB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAIK,QAOtB,OANmB,MAAf1mB,EAAEinB,YACFvmC,EAAEumC,UAAY9+C,QAAQ63B,EAAEinB,YAEb,MAAXjnB,EAAEyZ,QACF/4B,EAAE+4B,MAAQr/C,OAAO4lC,EAAEyZ,QAEhB/4B,CACX,EAWAgmC,EAAQG,SAAW,SAAkBnmC,EAAG1f,GAC/BA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAWT,OAVmB,MAAftf,EAAEumC,WAAqBvmC,EAAE1e,eAAe,eACxCg+B,EAAEinB,UAAYvmC,EAAEumC,UACZjmD,EAAE+lD,SACF/mB,EAAEknB,WAAa,cAER,MAAXxmC,EAAE+4B,OAAiB/4B,EAAE1e,eAAe,WACpCg+B,EAAEyZ,MAAQ/4B,EAAE+4B,MACRz4C,EAAE+lD,SACF/mB,EAAEmnB,OAAS,UAEZnnB,CACX,EASA0mB,EAAQ5qD,UAAU2oB,OAAS,WACvB,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEO44C,CACV,CAhLa,GAkLdL,EAAIM,QAAU,WAsBV,SAASA,EAAQnoD,GACb,GAAIA,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CAmDA,IAAIioD,EA2OJ,OAtRAG,EAAQ7qD,UAAU2N,KAAO,KAQzBk9C,EAAQ7qD,UAAU4jB,KAAO,KAQzBinC,EAAQ7qD,UAAUsrD,MAAQ,KAQ1BT,EAAQ7qD,UAAU29C,MAAQ,GAQ1BkN,EAAQ7qD,UAAUurD,UAAY,KAQ9BV,EAAQ7qD,UAAUsV,IAAM,KAWxBzP,OAAO2B,eAAeqjD,EAAQ7qD,UAAW,QAAS,CAC9C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,SACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeqjD,EAAQ7qD,UAAW,QAAS,CAC9C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,SACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeqjD,EAAQ7qD,UAAW,SAAU,CAC/C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,UACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeqjD,EAAQ7qD,UAAW,aAAc,CACnD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,cACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeqjD,EAAQ7qD,UAAW,OAAQ,CAC7C8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,QACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3BG,EAAQ30C,OAAS,SAAgB0O,EAAGwiB,GAchC,OAbKA,IACDA,EAAIgjB,EAAQtkD,UACF,MAAV8e,EAAEjX,MAAgB9H,OAAOK,eAAehG,KAAK0kB,EAAG,SAChDwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEjX,MACX,MAAViX,EAAEhB,MAAgB/d,OAAOK,eAAehG,KAAK0kB,EAAG,SAChDwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEhB,MACV,MAAXgB,EAAE0mC,OAAiBzlD,OAAOK,eAAehG,KAAK0kB,EAAG,UACjDwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAE0mC,OACzBlkB,EAAEn9B,OAAO,IAAIY,OAAO+Z,EAAE+4B,OACH,MAAf/4B,EAAE2mC,WAAqB1lD,OAAOK,eAAehG,KAAK0kB,EAAG,cACrDwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAE2mC,WACZ,MAAT3mC,EAAEtP,KAAezP,OAAOK,eAAehG,KAAK0kB,EAAG,QAC/CwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEtP,KAClB8xB,CACX,EAaAyjB,EAAQt3C,OAAS,SAAgB2kB,EAAGa,GAC1Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAIM,QACxD3yB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACD/hB,EAAEjX,KAAOuqB,EAAExtB,QACX,MACJ,KAAK,EACDka,EAAEhB,KAAOsU,EAAExtB,QACX,MACJ,KAAK,EACDka,EAAE0mC,MAAQpzB,EAAExtB,QACZ,MACJ,KAAK,EACDka,EAAE+4B,MAAQzlB,EAAErtB,SACZ,MACJ,KAAK,EACD+Z,EAAE2mC,UAAYrzB,EAAExtB,QAChB,MACJ,KAAK,EACDka,EAAEtP,IAAM4iB,EAAExtB,QACV,MACJ,QACIwtB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,IAAK/hB,EAAE1e,eAAe,SAClB,MAAMmkD,EAAM14C,cAAc,2BAA4B,CAAEpR,SAAUqkB,IACtE,OAAOA,CACX,EAUAimC,EAAQhnC,WAAa,SAAoBqgB,GACrC,GAAIA,aAAaomB,EAAMC,IAAIM,QACvB,OAAO3mB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAIM,QAkCtB,OAjCc,MAAV3mB,EAAEv2B,OACoB,iBAAXu2B,EAAEv2B,KACT08C,EAAMh7C,OAAOkE,OAAO2wB,EAAEv2B,KAAMiX,EAAEjX,KAAO08C,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEv2B,OAAQ,GAC9Eu2B,EAAEv2B,KAAKvP,SACZwmB,EAAEjX,KAAOu2B,EAAEv2B,OAEL,MAAVu2B,EAAEtgB,OACoB,iBAAXsgB,EAAEtgB,KACTymC,EAAMh7C,OAAOkE,OAAO2wB,EAAEtgB,KAAMgB,EAAEhB,KAAOymC,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEtgB,OAAQ,GAC9EsgB,EAAEtgB,KAAKxlB,SACZwmB,EAAEhB,KAAOsgB,EAAEtgB,OAEJ,MAAXsgB,EAAEonB,QACqB,iBAAZpnB,EAAEonB,MACTjB,EAAMh7C,OAAOkE,OAAO2wB,EAAEonB,MAAO1mC,EAAE0mC,MAAQjB,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEonB,QAAS,GACjFpnB,EAAEonB,MAAMltD,SACbwmB,EAAE0mC,MAAQpnB,EAAEonB,QAEL,MAAXpnB,EAAEyZ,QACF/4B,EAAE+4B,MAAQr/C,OAAO4lC,EAAEyZ,QAEJ,MAAfzZ,EAAEqnB,YACyB,iBAAhBrnB,EAAEqnB,UACTlB,EAAMh7C,OAAOkE,OAAO2wB,EAAEqnB,UAAW3mC,EAAE2mC,UAAYlB,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEqnB,YAAa,GAC7FrnB,EAAEqnB,UAAUntD,SACjBwmB,EAAE2mC,UAAYrnB,EAAEqnB,YAEX,MAATrnB,EAAE5uB,MACmB,iBAAV4uB,EAAE5uB,IACT+0C,EAAMh7C,OAAOkE,OAAO2wB,EAAE5uB,IAAKsP,EAAEtP,IAAM+0C,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAE5uB,MAAO,GAC3E4uB,EAAE5uB,IAAIlX,SACXwmB,EAAEtP,IAAM4uB,EAAE5uB,MAEXsP,CACX,EAWAimC,EAAQE,SAAW,SAAkBnmC,EAAG1f,GAC/BA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAgCT,OA/BIh/B,EAAE4Z,WACFolB,EAAEyZ,MAAQ,IAEA,MAAV/4B,EAAEjX,MAAgBiX,EAAE1e,eAAe,UACnCg+B,EAAEv2B,KAAOzI,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEjX,KAAM,EAAGiX,EAAEjX,KAAKvP,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEjX,MAAQiX,EAAEjX,KACrIzI,EAAE+lD,SACF/mB,EAAEsnB,MAAQ,SAEJ,MAAV5mC,EAAEhB,MAAgBgB,EAAE1e,eAAe,UACnCg+B,EAAEtgB,KAAO1e,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEhB,KAAM,EAAGgB,EAAEhB,KAAKxlB,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEhB,MAAQgB,EAAEhB,KACrI1e,EAAE+lD,SACF/mB,EAAEunB,MAAQ,SAEH,MAAX7mC,EAAE0mC,OAAiB1mC,EAAE1e,eAAe,WACpCg+B,EAAEonB,MAAQpmD,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAE0mC,MAAO,EAAG1mC,EAAE0mC,MAAMltD,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAE0mC,OAAS1mC,EAAE0mC,MACzIpmD,EAAE+lD,SACF/mB,EAAEwnB,OAAS,UAEJ,MAAX9mC,EAAE+4B,OAAiB/4B,EAAE1e,eAAe,WACpCg+B,EAAEyZ,MAAQ/4B,EAAE+4B,OAEG,MAAf/4B,EAAE2mC,WAAqB3mC,EAAE1e,eAAe,eACxCg+B,EAAEqnB,UAAYrmD,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAE2mC,UAAW,EAAG3mC,EAAE2mC,UAAUntD,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAE2mC,WAAa3mC,EAAE2mC,UACzJrmD,EAAE+lD,SACF/mB,EAAEynB,WAAa,cAEV,MAAT/mC,EAAEtP,KAAesP,EAAE1e,eAAe,SAClCg+B,EAAE5uB,IAAMpQ,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEtP,IAAK,EAAGsP,EAAEtP,IAAIlX,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEtP,KAAOsP,EAAEtP,IACjIpQ,EAAE+lD,SACF/mB,EAAE6hB,KAAO,QAEV7hB,CACX,EASA2mB,EAAQ7qD,UAAU2oB,OAAS,WACvB,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEO64C,CACV,CA1Ta,GA4TdN,EAAIO,eAAiB,WAoBjB,SAASA,EAAepoD,GAKpB,GAJAyE,KAAKykD,MAAQ,GACbzkD,KAAK0kD,MAAQ,GACb1kD,KAAK2kD,MAAQ,GACb3kD,KAAK4kD,MAAQ,GACTrpD,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CA+NA,OAvNAqoD,EAAe9qD,UAAU4rD,MAAQvB,EAAMt6C,WAQvC+6C,EAAe9qD,UAAU6rD,MAAQxB,EAAMt6C,WAQvC+6C,EAAe9qD,UAAU8rD,MAAQzB,EAAMt6C,WAQvC+6C,EAAe9qD,UAAU+rD,MAAQ1B,EAAMt6C,WAWvC+6C,EAAe50C,OAAS,SAAgB0O,EAAGwiB,GAGvC,GAFKA,IACDA,EAAIgjB,EAAQtkD,UACD,MAAX8e,EAAEgnC,OAAiBhnC,EAAEgnC,MAAMxtD,OAC3B,IAAK,IAAIqE,EAAI,EAAGA,EAAImiB,EAAEgnC,MAAMxtD,SAAUqE,EAClC6nD,EAAMC,IAAIyB,aAAa91C,OAAO0O,EAAEgnC,MAAMnpD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAEvE,GAAe,MAAXiR,EAAEinC,OAAiBjnC,EAAEinC,MAAMztD,OAC3B,IAASqE,EAAI,EAAGA,EAAImiB,EAAEinC,MAAMztD,SAAUqE,EAClC6nD,EAAMC,IAAI0B,aAAa/1C,OAAO0O,EAAEinC,MAAMppD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAEvE,GAAe,MAAXiR,EAAEknC,OAAiBlnC,EAAEknC,MAAM1tD,OAC3B,IAASqE,EAAI,EAAGA,EAAImiB,EAAEknC,MAAM1tD,SAAUqE,EAClC6nD,EAAMC,IAAI2B,aAAah2C,OAAO0O,EAAEknC,MAAMrpD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAEvE,GAAe,MAAXiR,EAAEmnC,OAAiBnnC,EAAEmnC,MAAM3tD,OAC3B,IAASqE,EAAI,EAAGA,EAAImiB,EAAEmnC,MAAM3tD,SAAUqE,EAClC6nD,EAAMC,IAAI4B,aAAaj2C,OAAO0O,EAAEmnC,MAAMtpD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAEvE,OAAOyzB,CACX,EAaA0jB,EAAev3C,OAAS,SAAgB2kB,EAAGa,GACjCb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAIO,eACxD5yB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACK/hB,EAAEgnC,OAAShnC,EAAEgnC,MAAMxtD,SACrBwmB,EAAEgnC,MAAQ,IACdhnC,EAAEgnC,MAAM/sD,KAAKyrD,EAAMC,IAAIyB,aAAaz4C,OAAO2kB,EAAGA,EAAEjuB,WAChD,MACJ,KAAK,EACK2a,EAAEinC,OAASjnC,EAAEinC,MAAMztD,SACrBwmB,EAAEinC,MAAQ,IACdjnC,EAAEinC,MAAMhtD,KAAKyrD,EAAMC,IAAI0B,aAAa14C,OAAO2kB,EAAGA,EAAEjuB,WAChD,MACJ,KAAK,EACK2a,EAAEknC,OAASlnC,EAAEknC,MAAM1tD,SACrBwmB,EAAEknC,MAAQ,IACdlnC,EAAEknC,MAAMjtD,KAAKyrD,EAAMC,IAAI2B,aAAa34C,OAAO2kB,EAAGA,EAAEjuB,WAChD,MACJ,KAAK,EACK2a,EAAEmnC,OAASnnC,EAAEmnC,MAAM3tD,SACrBwmB,EAAEmnC,MAAQ,IACdnnC,EAAEmnC,MAAMltD,KAAKyrD,EAAMC,IAAI4B,aAAa54C,OAAO2kB,EAAGA,EAAEjuB,WAChD,MACJ,QACIiuB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUAkmC,EAAejnC,WAAa,SAAoBqgB,GAC5C,GAAIA,aAAaomB,EAAMC,IAAIO,eACvB,OAAO5mB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAIO,eACtB,GAAI5mB,EAAE0nB,MAAO,CACT,IAAK7rD,MAAMuJ,QAAQ46B,EAAE0nB,OACjB,MAAMz/C,UAAU,6CACpByY,EAAEgnC,MAAQ,GACV,IAAK,IAAInpD,EAAI,EAAGA,EAAIyhC,EAAE0nB,MAAMxtD,SAAUqE,EAAG,CACrC,GAA0B,iBAAfyhC,EAAE0nB,MAAMnpD,GACf,MAAM0J,UAAU,8CACpByY,EAAEgnC,MAAMnpD,GAAK6nD,EAAMC,IAAIyB,aAAanoC,WAAWqgB,EAAE0nB,MAAMnpD,GAC3D,CACJ,CACA,GAAIyhC,EAAE2nB,MAAO,CACT,IAAK9rD,MAAMuJ,QAAQ46B,EAAE2nB,OACjB,MAAM1/C,UAAU,6CAEpB,IADAyY,EAAEinC,MAAQ,GACDppD,EAAI,EAAGA,EAAIyhC,EAAE2nB,MAAMztD,SAAUqE,EAAG,CACrC,GAA0B,iBAAfyhC,EAAE2nB,MAAMppD,GACf,MAAM0J,UAAU,8CACpByY,EAAEinC,MAAMppD,GAAK6nD,EAAMC,IAAI0B,aAAapoC,WAAWqgB,EAAE2nB,MAAMppD,GAC3D,CACJ,CACA,GAAIyhC,EAAE4nB,MAAO,CACT,IAAK/rD,MAAMuJ,QAAQ46B,EAAE4nB,OACjB,MAAM3/C,UAAU,6CAEpB,IADAyY,EAAEknC,MAAQ,GACDrpD,EAAI,EAAGA,EAAIyhC,EAAE4nB,MAAM1tD,SAAUqE,EAAG,CACrC,GAA0B,iBAAfyhC,EAAE4nB,MAAMrpD,GACf,MAAM0J,UAAU,8CACpByY,EAAEknC,MAAMrpD,GAAK6nD,EAAMC,IAAI2B,aAAaroC,WAAWqgB,EAAE4nB,MAAMrpD,GAC3D,CACJ,CACA,GAAIyhC,EAAE6nB,MAAO,CACT,IAAKhsD,MAAMuJ,QAAQ46B,EAAE6nB,OACjB,MAAM5/C,UAAU,6CAEpB,IADAyY,EAAEmnC,MAAQ,GACDtpD,EAAI,EAAGA,EAAIyhC,EAAE6nB,MAAM3tD,SAAUqE,EAAG,CACrC,GAA0B,iBAAfyhC,EAAE6nB,MAAMtpD,GACf,MAAM0J,UAAU,8CACpByY,EAAEmnC,MAAMtpD,GAAK6nD,EAAMC,IAAI4B,aAAatoC,WAAWqgB,EAAE6nB,MAAMtpD,GAC3D,CACJ,CACA,OAAOmiB,CACX,EAWAkmC,EAAeC,SAAW,SAAkBnmC,EAAG1f,GACtCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAOT,IANIh/B,EAAE8lD,QAAU9lD,EAAE4Z,YACdolB,EAAE0nB,MAAQ,GACV1nB,EAAE2nB,MAAQ,GACV3nB,EAAE4nB,MAAQ,GACV5nB,EAAE6nB,MAAQ,IAEVnnC,EAAEgnC,OAAShnC,EAAEgnC,MAAMxtD,OAAQ,CAC3B8lC,EAAE0nB,MAAQ,GACV,IAAK,IAAIrmC,EAAI,EAAGA,EAAIX,EAAEgnC,MAAMxtD,SAAUmnB,EAClC2e,EAAE0nB,MAAMrmC,GAAK+kC,EAAMC,IAAIyB,aAAajB,SAASnmC,EAAEgnC,MAAMrmC,GAAIrgB,EAEjE,CACA,GAAI0f,EAAEinC,OAASjnC,EAAEinC,MAAMztD,OAEnB,IADA8lC,EAAE2nB,MAAQ,GACDtmC,EAAI,EAAGA,EAAIX,EAAEinC,MAAMztD,SAAUmnB,EAClC2e,EAAE2nB,MAAMtmC,GAAK+kC,EAAMC,IAAI0B,aAAalB,SAASnmC,EAAEinC,MAAMtmC,GAAIrgB,GAGjE,GAAI0f,EAAEknC,OAASlnC,EAAEknC,MAAM1tD,OAEnB,IADA8lC,EAAE4nB,MAAQ,GACDvmC,EAAI,EAAGA,EAAIX,EAAEknC,MAAM1tD,SAAUmnB,EAClC2e,EAAE4nB,MAAMvmC,GAAK+kC,EAAMC,IAAI2B,aAAanB,SAASnmC,EAAEknC,MAAMvmC,GAAIrgB,GAGjE,GAAI0f,EAAEmnC,OAASnnC,EAAEmnC,MAAM3tD,OAEnB,IADA8lC,EAAE6nB,MAAQ,GACDxmC,EAAI,EAAGA,EAAIX,EAAEmnC,MAAM3tD,SAAUmnB,EAClC2e,EAAE6nB,MAAMxmC,GAAK+kC,EAAMC,IAAI4B,aAAapB,SAASnmC,EAAEmnC,MAAMxmC,GAAIrgB,GAGjE,OAAOg/B,CACX,EASA4mB,EAAe9qD,UAAU2oB,OAAS,WAC9B,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEO84C,CACV,CA7PoB,GA+PrBP,EAAIyB,aAAe,WAkBf,SAASA,EAAatpD,GAElB,GADAyE,KAAKilD,WAAa,GACd1pD,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CAmBA,IAAIioD,EA0IJ,OArJAsB,EAAahsD,UAAUqsD,QAAU,KAQjCL,EAAahsD,UAAUosD,WAAa/B,EAAMt6C,WAW1ClK,OAAO2B,eAAewkD,EAAahsD,UAAW,WAAY,CACtD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,YACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3BsB,EAAa91C,OAAS,SAAgB0O,EAAGwiB,GAKrC,GAJKA,IACDA,EAAIgjB,EAAQtkD,UACC,MAAb8e,EAAEynC,SAAmBxmD,OAAOK,eAAehG,KAAK0kB,EAAG,YACnDwiB,EAAEn9B,OAAO,IAAIY,OAAO+Z,EAAEynC,SACN,MAAhBznC,EAAEwnC,YAAsBxnC,EAAEwnC,WAAWhuD,OACrC,IAAK,IAAIqE,EAAI,EAAGA,EAAImiB,EAAEwnC,WAAWhuD,SAAUqE,EACvC2kC,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEwnC,WAAW3pD,IAExC,OAAO2kC,CACX,EAaA4kB,EAAaz4C,OAAS,SAAgB2kB,EAAGa,GAC/Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAIyB,aACxD9zB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,SACd,MACJ,KAAK,EACK+Z,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,SAC/BwmB,EAAEwnC,WAAa,IACnBxnC,EAAEwnC,WAAWvtD,KAAKq5B,EAAExtB,SACpB,MACJ,QACIwtB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUAonC,EAAanoC,WAAa,SAAoBqgB,GAC1C,GAAIA,aAAaomB,EAAMC,IAAIyB,aACvB,OAAO9nB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAIyB,aAItB,GAHiB,MAAb9nB,EAAEmoB,UACFznC,EAAEynC,QAAU/tD,OAAO4lC,EAAEmoB,UAErBnoB,EAAEkoB,WAAY,CACd,IAAKrsD,MAAMuJ,QAAQ46B,EAAEkoB,YACjB,MAAMjgD,UAAU,gDACpByY,EAAEwnC,WAAa,GACf,IAAK,IAAI3pD,EAAI,EAAGA,EAAIyhC,EAAEkoB,WAAWhuD,SAAUqE,EACR,iBAApByhC,EAAEkoB,WAAW3pD,GACpB4nD,EAAMh7C,OAAOkE,OAAO2wB,EAAEkoB,WAAW3pD,GAAImiB,EAAEwnC,WAAW3pD,GAAK4nD,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEkoB,WAAW3pD,KAAM,GACzGyhC,EAAEkoB,WAAW3pD,GAAGrE,SACrBwmB,EAAEwnC,WAAW3pD,GAAKyhC,EAAEkoB,WAAW3pD,GAE3C,CACA,OAAOmiB,CACX,EAWAonC,EAAajB,SAAW,SAAkBnmC,EAAG1f,GACpCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAST,IARIh/B,EAAE8lD,QAAU9lD,EAAE4Z,YACdolB,EAAEkoB,WAAa,IAEF,MAAbxnC,EAAEynC,SAAmBznC,EAAE1e,eAAe,aACtCg+B,EAAEmoB,QAAUznC,EAAEynC,QACVnnD,EAAE+lD,SACF/mB,EAAEooB,SAAW,YAEjB1nC,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,OAAQ,CACrC8lC,EAAEkoB,WAAa,GACf,IAAK,IAAI7mC,EAAI,EAAGA,EAAIX,EAAEwnC,WAAWhuD,SAAUmnB,EACvC2e,EAAEkoB,WAAW7mC,GAAKrgB,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEwnC,WAAW7mC,GAAI,EAAGX,EAAEwnC,WAAW7mC,GAAGnnB,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEwnC,WAAW7mC,IAAMX,EAAEwnC,WAAW7mC,EAEhM,CACA,OAAO2e,CACX,EASA8nB,EAAahsD,UAAU2oB,OAAS,WAC5B,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEOg6C,CACV,CAtLkB,GAwLnBzB,EAAI0B,aAAe,WAiBf,SAASA,EAAavpD,GAElB,GADAyE,KAAKilD,WAAa,GACd1pD,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CA0HA,OAlHAwpD,EAAajsD,UAAUosD,WAAa/B,EAAMt6C,WAW1Ck8C,EAAa/1C,OAAS,SAAgB0O,EAAGwiB,GAGrC,GAFKA,IACDA,EAAIgjB,EAAQtkD,UACI,MAAhB8e,EAAEwnC,YAAsBxnC,EAAEwnC,WAAWhuD,OACrC,IAAK,IAAIqE,EAAI,EAAGA,EAAImiB,EAAEwnC,WAAWhuD,SAAUqE,EACvC2kC,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEwnC,WAAW3pD,IAExC,OAAO2kC,CACX,EAaA6kB,EAAa14C,OAAS,SAAgB2kB,EAAGa,GAC/Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAI0B,aACxD/zB,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACF08B,IAAM,GACT,GACK/hB,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,SAC/BwmB,EAAEwnC,WAAa,IACnBxnC,EAAEwnC,WAAWvtD,KAAKq5B,EAAExtB,UAGpBwtB,EAAEltB,SAAa,EAAJ27B,EAGnB,CACA,OAAO/hB,CACX,EAUAqnC,EAAapoC,WAAa,SAAoBqgB,GAC1C,GAAIA,aAAaomB,EAAMC,IAAI0B,aACvB,OAAO/nB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAI0B,aACtB,GAAI/nB,EAAEkoB,WAAY,CACd,IAAKrsD,MAAMuJ,QAAQ46B,EAAEkoB,YACjB,MAAMjgD,UAAU,gDACpByY,EAAEwnC,WAAa,GACf,IAAK,IAAI3pD,EAAI,EAAGA,EAAIyhC,EAAEkoB,WAAWhuD,SAAUqE,EACR,iBAApByhC,EAAEkoB,WAAW3pD,GACpB4nD,EAAMh7C,OAAOkE,OAAO2wB,EAAEkoB,WAAW3pD,GAAImiB,EAAEwnC,WAAW3pD,GAAK4nD,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAEkoB,WAAW3pD,KAAM,GACzGyhC,EAAEkoB,WAAW3pD,GAAGrE,SACrBwmB,EAAEwnC,WAAW3pD,GAAKyhC,EAAEkoB,WAAW3pD,GAE3C,CACA,OAAOmiB,CACX,EAWAqnC,EAAalB,SAAW,SAAkBnmC,EAAG1f,GACpCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAIT,IAHIh/B,EAAE8lD,QAAU9lD,EAAE4Z,YACdolB,EAAEkoB,WAAa,IAEfxnC,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,OAAQ,CACrC8lC,EAAEkoB,WAAa,GACf,IAAK,IAAI7mC,EAAI,EAAGA,EAAIX,EAAEwnC,WAAWhuD,SAAUmnB,EACvC2e,EAAEkoB,WAAW7mC,GAAKrgB,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEwnC,WAAW7mC,GAAI,EAAGX,EAAEwnC,WAAW7mC,GAAGnnB,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEwnC,WAAW7mC,IAAMX,EAAEwnC,WAAW7mC,EAEhM,CACA,OAAO2e,CACX,EASA+nB,EAAajsD,UAAU2oB,OAAS,WAC5B,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEOi6C,CACV,CAlJkB,GAoJnB1B,EAAI2B,aAAe,WAiBf,SAASA,EAAaxpD,GAClB,GAAIA,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CAWA,IAAIioD,EA6GJ,OAhHAwB,EAAalsD,UAAUqsD,QAAU,KAWjCxmD,OAAO2B,eAAe0kD,EAAalsD,UAAW,WAAY,CACtD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,YACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3BwB,EAAah2C,OAAS,SAAgB0O,EAAGwiB,GAKrC,OAJKA,IACDA,EAAIgjB,EAAQtkD,UACC,MAAb8e,EAAEynC,SAAmBxmD,OAAOK,eAAehG,KAAK0kB,EAAG,YACnDwiB,EAAEn9B,OAAO,IAAIY,OAAO+Z,EAAEynC,SACnBjlB,CACX,EAaA8kB,EAAa34C,OAAS,SAAgB2kB,EAAGa,GAC/Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAI2B,aACxDh0B,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACF08B,IAAM,GACT,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,SAGdqtB,EAAEltB,SAAa,EAAJ27B,EAGnB,CACA,OAAO/hB,CACX,EAUAsnC,EAAaroC,WAAa,SAAoBqgB,GAC1C,GAAIA,aAAaomB,EAAMC,IAAI2B,aACvB,OAAOhoB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAI2B,aAItB,OAHiB,MAAbhoB,EAAEmoB,UACFznC,EAAEynC,QAAU/tD,OAAO4lC,EAAEmoB,UAElBznC,CACX,EAWAsnC,EAAanB,SAAW,SAAkBnmC,EAAG1f,GACpCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAMT,OALiB,MAAbtf,EAAEynC,SAAmBznC,EAAE1e,eAAe,aACtCg+B,EAAEmoB,QAAUznC,EAAEynC,QACVnnD,EAAE+lD,SACF/mB,EAAEooB,SAAW,YAEdpoB,CACX,EASAgoB,EAAalsD,UAAU2oB,OAAS,WAC5B,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEOk6C,CACV,CA/IkB,GAiJnB3B,EAAI4B,aAAe,WAmBf,SAASA,EAAazpD,GAElB,GADAyE,KAAKolD,MAAQ,GACT7pD,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CA2BA,IAAIioD,EA2KJ,OA9LAyB,EAAansD,UAAUqsD,QAAU,KAQjCF,EAAansD,UAAUusD,MAAQlC,EAAMt6C,WAQrCo8C,EAAansD,UAAUwsD,QAAU,KAWjC3mD,OAAO2B,eAAe2kD,EAAansD,UAAW,WAAY,CACtD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,YACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAe2kD,EAAansD,UAAW,WAAY,CACtD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,YACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3ByB,EAAaj2C,OAAS,SAAgB0O,EAAGwiB,GAKrC,GAJKA,IACDA,EAAIgjB,EAAQtkD,UACC,MAAb8e,EAAEynC,SAAmBxmD,OAAOK,eAAehG,KAAK0kB,EAAG,YACnDwiB,EAAEn9B,OAAO,IAAIY,OAAO+Z,EAAEynC,SACX,MAAXznC,EAAE2nC,OAAiB3nC,EAAE2nC,MAAMnuD,OAC3B,IAAK,IAAIqE,EAAI,EAAGA,EAAImiB,EAAE2nC,MAAMnuD,SAAUqE,EAClC6nD,EAAMC,IAAIkC,SAASv2C,OAAO0O,EAAE2nC,MAAM9pD,GAAI2kC,EAAEn9B,OAAO,IAAIwJ,QAAQE,SAInE,OAFiB,MAAbiR,EAAE4nC,SAAmB3mD,OAAOK,eAAehG,KAAK0kB,EAAG,YACnDwiB,EAAEn9B,OAAO,IAAIsB,OAAOqZ,EAAE4nC,SACnBplB,CACX,EAaA+kB,EAAa54C,OAAS,SAAgB2kB,EAAGa,GAC/Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAI4B,aACxDj0B,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,SACd,MACJ,KAAK,EACK+Z,EAAE2nC,OAAS3nC,EAAE2nC,MAAMnuD,SACrBwmB,EAAE2nC,MAAQ,IACd3nC,EAAE2nC,MAAM1tD,KAAKyrD,EAAMC,IAAIkC,SAASl5C,OAAO2kB,EAAGA,EAAEjuB,WAC5C,MACJ,KAAK,EACD2a,EAAE4nC,QAAUt0B,EAAE3sB,SACd,MACJ,QACI2sB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUAunC,EAAatoC,WAAa,SAAoBqgB,GAC1C,GAAIA,aAAaomB,EAAMC,IAAI4B,aACvB,OAAOjoB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAI4B,aAItB,GAHiB,MAAbjoB,EAAEmoB,UACFznC,EAAEynC,QAAU/tD,OAAO4lC,EAAEmoB,UAErBnoB,EAAEqoB,MAAO,CACT,IAAKxsD,MAAMuJ,QAAQ46B,EAAEqoB,OACjB,MAAMpgD,UAAU,2CACpByY,EAAE2nC,MAAQ,GACV,IAAK,IAAI9pD,EAAI,EAAGA,EAAIyhC,EAAEqoB,MAAMnuD,SAAUqE,EAAG,CACrC,GAA0B,iBAAfyhC,EAAEqoB,MAAM9pD,GACf,MAAM0J,UAAU,4CACpByY,EAAE2nC,MAAM9pD,GAAK6nD,EAAMC,IAAIkC,SAAS5oC,WAAWqgB,EAAEqoB,MAAM9pD,GACvD,CACJ,CAWA,OAViB,MAAbyhC,EAAEsoB,UACEnC,EAAMj/C,MACLwZ,EAAE4nC,QAAUnC,EAAMj/C,KAAKshD,UAAUxoB,EAAEsoB,UAAUv+C,UAAW,EAC/B,iBAAdi2B,EAAEsoB,QACd5nC,EAAE4nC,QAAU3+C,SAASq2B,EAAEsoB,QAAS,IACN,iBAAdtoB,EAAEsoB,QACd5nC,EAAE4nC,QAAUtoB,EAAEsoB,QACY,iBAAdtoB,EAAEsoB,UACd5nC,EAAE4nC,QAAU,IAAInC,EAAMvhD,SAASo7B,EAAEsoB,QAAQz+C,MAAQ,EAAGm2B,EAAEsoB,QAAQx+C,OAAS,GAAGV,UAAS,KAEpFsX,CACX,EAWAunC,EAAapB,SAAW,SAAkBnmC,EAAG1f,GACpCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAST,IARIh/B,EAAE8lD,QAAU9lD,EAAE4Z,YACdolB,EAAEqoB,MAAQ,IAEG,MAAb3nC,EAAEynC,SAAmBznC,EAAE1e,eAAe,aACtCg+B,EAAEmoB,QAAUznC,EAAEynC,QACVnnD,EAAE+lD,SACF/mB,EAAEooB,SAAW,YAEjB1nC,EAAE2nC,OAAS3nC,EAAE2nC,MAAMnuD,OAAQ,CAC3B8lC,EAAEqoB,MAAQ,GACV,IAAK,IAAIhnC,EAAI,EAAGA,EAAIX,EAAE2nC,MAAMnuD,SAAUmnB,EAClC2e,EAAEqoB,MAAMhnC,GAAK+kC,EAAMC,IAAIkC,SAAS1B,SAASnmC,EAAE2nC,MAAMhnC,GAAIrgB,EAE7D,CASA,OARiB,MAAb0f,EAAE4nC,SAAmB5nC,EAAE1e,eAAe,aACb,iBAAd0e,EAAE4nC,QACTtoB,EAAEsoB,QAAUtnD,EAAE+M,QAAU3T,OAASA,OAAOsmB,EAAE4nC,SAAW5nC,EAAE4nC,QAEvDtoB,EAAEsoB,QAAUtnD,EAAE+M,QAAU3T,OAAS+rD,EAAMj/C,KAAKpL,UAAU8L,SAAS5L,KAAK0kB,EAAE4nC,SAAWtnD,EAAE+M,QAAU9B,OAAS,IAAIk6C,EAAMvhD,SAAS8b,EAAE4nC,QAAQz+C,MAAQ,EAAG6W,EAAE4nC,QAAQx+C,OAAS,GAAGV,UAAS,GAAQsX,EAAE4nC,QACvLtnD,EAAE+lD,SACF/mB,EAAEyoB,SAAW,YAEdzoB,CACX,EASAioB,EAAansD,UAAU2oB,OAAS,WAC5B,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEOm6C,CACV,CAhOkB,GAkOnB5B,EAAIkC,SAAW,WAkBX,SAASA,EAAS/pD,GACd,GAAIA,EACA,IAAK,IAAI+nD,EAAK5kD,OAAO+I,KAAKlM,GAAID,EAAI,EAAGA,EAAIgoD,EAAGrsD,SAAUqE,EAClC,MAAZC,EAAE+nD,EAAGhoD,MACL0E,KAAKsjD,EAAGhoD,IAAMC,EAAE+nD,EAAGhoD,IACnC,CAmBA,IAAIioD,EA2IJ,OAtJA+B,EAASzsD,UAAU4sD,OAAS,KAQ5BH,EAASzsD,UAAU6sD,iBAAmB,KAWtChnD,OAAO2B,eAAeilD,EAASzsD,UAAW,UAAW,CACjD8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,WACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAS3B7kD,OAAO2B,eAAeilD,EAASzsD,UAAW,oBAAqB,CAC3D8H,IAAKuiD,EAAMz4C,YAAY84C,EAAe,CAAC,qBACvC1nD,IAAKqnD,EAAMt4C,YAAY24C,KAY3B+B,EAASv2C,OAAS,SAAgB0O,EAAGwiB,GAOjC,OANKA,IACDA,EAAIgjB,EAAQtkD,UACA,MAAZ8e,EAAEgoC,QAAkB/mD,OAAOK,eAAehG,KAAK0kB,EAAG,WAClDwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEgoC,QACC,MAAtBhoC,EAAEioC,kBAA4BhnD,OAAOK,eAAehG,KAAK0kB,EAAG,qBAC5DwiB,EAAEn9B,OAAO,IAAIS,MAAMka,EAAEioC,kBAClBzlB,CACX,EAaAqlB,EAASl5C,OAAS,SAAgB2kB,EAAGa,GAC3Bb,aAAaiyB,IACfjyB,EAAIiyB,EAAQrkD,OAAOoyB,IAEvB,IADA,IAAI9R,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EAAGnU,EAAI,IAAI0lC,EAAMC,IAAIkC,SACxDv0B,EAAE9uB,IAAMgd,GAAG,CACd,IAAIugB,EAAIzO,EAAEjuB,SACV,OAAQ08B,IAAM,GACd,KAAK,EACD/hB,EAAEgoC,OAAS10B,EAAExtB,QACb,MACJ,KAAK,EACDka,EAAEioC,iBAAmB30B,EAAExtB,QACvB,MACJ,QACIwtB,EAAEltB,SAAa,EAAJ27B,GAGnB,CACA,OAAO/hB,CACX,EAUA6nC,EAAS5oC,WAAa,SAAoBqgB,GACtC,GAAIA,aAAaomB,EAAMC,IAAIkC,SACvB,OAAOvoB,EACX,IAAItf,EAAI,IAAI0lC,EAAMC,IAAIkC,SAatB,OAZgB,MAAZvoB,EAAE0oB,SACsB,iBAAb1oB,EAAE0oB,OACTvC,EAAMh7C,OAAOkE,OAAO2wB,EAAE0oB,OAAQhoC,EAAEgoC,OAASvC,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAE0oB,SAAU,GACpF1oB,EAAE0oB,OAAOxuD,SACdwmB,EAAEgoC,OAAS1oB,EAAE0oB,SAEK,MAAtB1oB,EAAE2oB,mBACgC,iBAAvB3oB,EAAE2oB,iBACTxC,EAAMh7C,OAAOkE,OAAO2wB,EAAE2oB,iBAAkBjoC,EAAEioC,iBAAmBxC,EAAMt5C,UAAUs5C,EAAMh7C,OAAOjR,OAAO8lC,EAAE2oB,mBAAoB,GAClH3oB,EAAE2oB,iBAAiBzuD,SACxBwmB,EAAEioC,iBAAmB3oB,EAAE2oB,mBAExBjoC,CACX,EAWA6nC,EAAS1B,SAAW,SAAkBnmC,EAAG1f,GAChCA,IACDA,EAAI,CAAC,GACT,IAAIg/B,EAAI,CAAC,EAWT,OAVgB,MAAZtf,EAAEgoC,QAAkBhoC,EAAE1e,eAAe,YACrCg+B,EAAE0oB,OAAS1nD,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEgoC,OAAQ,EAAGhoC,EAAEgoC,OAAOxuD,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEgoC,QAAUhoC,EAAEgoC,OAC7I1nD,EAAE+lD,SACF/mB,EAAE4oB,QAAU,WAEM,MAAtBloC,EAAEioC,kBAA4BjoC,EAAE1e,eAAe,sBAC/Cg+B,EAAE2oB,iBAAmB3nD,EAAEwF,QAAUpM,OAAS+rD,EAAMh7C,OAAO6G,OAAO0O,EAAEioC,iBAAkB,EAAGjoC,EAAEioC,iBAAiBzuD,QAAU8G,EAAEwF,QAAU3K,MAAQA,MAAMC,UAAUC,MAAMC,KAAK0kB,EAAEioC,kBAAoBjoC,EAAEioC,iBACrL3nD,EAAE+lD,SACF/mB,EAAE6oB,kBAAoB,qBAEvB7oB,CACX,EASAuoB,EAASzsD,UAAU2oB,OAAS,WACxB,OAAOxhB,KAAKF,YAAY8jD,SAAS5jD,KAAM+iD,EAAU7hD,KAAK2J,cAC1D,EAEOy6C,CACV,CAtLc,GAwLRlC,CACV,CA/zDW,GAi0DLD,CACX,GAh1D8C,2LCJnC0C,EAAmC,mBAAZv1B,WAC7B,SAAM,WAAc,MAA4B,eAArBoR,UAAUqG,UAA6Br/B,OAAOo9C,cAAgB,IACnFC,EAAmC,mBAAZC,QACvBC,EAAiC,mBAAXzvD,QAA+C,mBAAfA,OAAOkqD,IAC7DwF,EAA4BD,GAAgBzvD,OAAOgc,eAChC,SAAM,WAAc,OAAO7J,OAAOi5B,SAASukB,aAAe,KAUxF,SAAM,WAAc,OAAOzkB,UAAUC,UAAUpiC,QAAQ,UAAY,CAAG,wCChB/D,SAAS6mD,EAAMC,GAClB,IACI,OAAOA,GACX,CACA,MAAOle,GAAM,CACjB,mKCHO,SAASme,EAAOvqD,GACnB,OAAOmJ,SAAQ,QAAUnJ,GAC7B,CAEO,SAASwqD,EAAOxqD,GACnB,OAAOmJ,SAAQ,QAAUnJ,GAC7B,CAEO,SAASyqD,EAAKzqD,GACjB,OAAOmJ,SAAQ,QAAQnJ,GAC3B,sHCVA,MAAM0qD,EAAkB,GAClBC,EAAkB,GAClBC,EAAS,ICHR,MACHt8B,MAAQ,EACRtuB,MAAQ,GACR6qD,IAAI7qD,GAGA,OAFAiE,KAAKqqB,MAAQ,EACbrqB,KAAKjE,MAAQA,EACNiE,IACX,CAEA6mD,eAAe7iD,GACX,MAAMqmB,EAAQrqB,KAAKqqB,MACbzQ,EAAS5V,IAIf,YAHe0D,IAAXkS,IACA5Z,KAAKqqB,MAAQA,GAEVzQ,CACX,CAEAktC,UAAU9iD,GACN,MAAM4V,EAAS5V,IACf,GAAIhE,KAAKqqB,QAAUrqB,KAAKjE,MAAM9E,OAG9B,OAAO2iB,CACX,CAEAmtC,WACI,KAAI/mD,KAAKqqB,OAASrqB,KAAKjE,MAAM9E,QAG7B,OAAO+I,KAAKjE,MAAMiE,KAAKqqB,MAC3B,CAEA28B,WACI,KAAIhnD,KAAKqqB,OAASrqB,KAAKjE,MAAM9E,QAG7B,OAAO+I,KAAKjE,MAAMiE,KAAKqqB,QAC3B,CAEA48B,cAAc50C,GACV,OAAOrS,KAAK6mD,gBAAe,KACvB,MAAMrsC,EAAOxa,KAAKgnD,WAClB,GAAIxsC,IAASnI,EAGb,OAAOmI,CAAI,GAEnB,CAOA0sC,cAAcC,EAAK98B,EAAO+8B,GACtB,OAAOpnD,KAAK6mD,gBAAe,KACvB,KAAIx8B,EAAQ,QACwB3iB,IAA5B1H,KAAKinD,cAAcE,IAI3B,OAAOC,GAAO,GAEtB,CAMAC,WAAWC,EAAOC,EAAWC,EAAiBC,GAC1C,OAAOznD,KAAK6mD,gBAAe,KACvB,IAAIjtC,EAAS,EACT8tC,EAAa,EACjB,MAAMC,EAAc3nD,KAAK+mD,WACzB,QAAoBr/C,IAAhBigD,EACA,OAEJ,MAAMC,EAAiC,MAAhBD,EACjBE,EAAW,IAAM,EAAIJ,GAAY,EAEvC,OAAa,CACT,MAAMK,EAAQ9nD,KAAK6mD,gBAAe,KAC9B,MAAMrsC,EAAOxa,KAAKgnD,WAClB,QAAat/C,IAAT8S,EACA,OAEJ,MAAMmsB,EAAM39B,OAAOtC,SAAS8T,EAAM8sC,GAClC,OAAIt+C,OAAOikB,MAAM0Z,QAAjB,EAGOA,CAAG,IAEd,QAAcj/B,IAAVogD,EACA,MAIJ,GAFAluC,GAAU0tC,EACV1tC,GAAUkuC,EACNluC,EAASiuC,EACT,OAGJ,GADAH,GAAc,OACIhgD,IAAd6/C,GACIG,EAAaH,EACb,MAGZ,CACA,OAAmB,IAAfG,IAGMF,GAAmBI,GAAkBF,EAAa,OAFxD,EAMO9tC,CACX,GAER,CAEAmuC,eACI,OAAO/nD,KAAK6mD,gBAAe,KACvB,MAAM5qD,EAAM,IAAIzB,WAAW,GAC3B,IAAK,IAAIc,EAAI,EAAGA,EAAIW,EAAIhF,OAAQqE,IAAK,CACjC,MAAM0sD,EAAKhoD,KAAKknD,cAAc,IAAK5rD,GAAG,IAAM0E,KAAKqnD,WAAW,GAAI,GAAG,EAAO,KAC1E,QAAW3/C,IAAPsgD,EACA,OAEJ/rD,EAAIX,GAAK0sD,CACb,CACA,OAAO/rD,CAAG,GAElB,CAEAgsD,eAQI,MAAMC,EAAcC,IAChB,IAAK,IAAI7sD,EAAI,EAAGA,EAAI6sD,EAAOlxD,OAAS,EAAGqE,IAAK,CACxC,MAAM0sD,EAAS,EAAJ1sD,EAEX,GAAIA,EAAI6sD,EAAOlxD,OAAS,EAAG,CACvB,MAAMmxD,EAAOpoD,KAAKknD,cAAc,IAAK5rD,GAAG,IAAM0E,KAAK+nD,iBACnD,QAAargD,IAAT0gD,EAKA,OAJAD,EAAOH,GAAMI,EAAK,GAClBD,EAAOH,EAAK,GAAKI,EAAK,GACtBD,EAAOH,EAAK,GAAKI,EAAK,GACtBD,EAAOH,EAAK,GAAKI,EAAK,GACf,CAACJ,EAAK,GAAG,EAExB,CACA,MAAMK,EAAQroD,KAAKknD,cAAc,IAAK5rD,GAAG,IAAM0E,KAAKqnD,WAAW,GAAI,GAAG,EAAM,KAC5E,QAAc3/C,IAAV2gD,EACA,MAAO,CAACL,GAAI,GAEhBG,EAAOH,GAAMK,GAAS,EACtBF,EAAOH,EAAK,GAAa,IAARK,CACrB,CACA,MAAO,CAACF,EAAOlxD,QAAQ,EAAM,EAEjC,OAAO+I,KAAK6mD,gBAAe,KAEvB,MAAMp7C,EAAO,IAAIjR,WAAW,KACrB8tD,EAAUC,GAAWL,EAAWz8C,GACvC,GAAiB,KAAb68C,EACA,OAAO78C,EAGX,GAAI88C,EACA,OAIJ,QAAgC7gD,IAA5B1H,KAAKinD,cAAc,KACnB,OAEJ,QAAgCv/C,IAA5B1H,KAAKinD,cAAc,KACnB,OAIJ,MAAMv7C,EAAO,IAAIlR,WAAW,IACtB2W,EAAQ,IAAMm3C,EAAW,IACxBE,GAAYN,EAAWx8C,EAAKpU,SAAS,EAAG6Z,IAG/C,OADA1F,EAAK5P,IAAI6P,EAAKpU,SAAS,EAAGkxD,GAAW,GAAKA,GACnC/8C,CAAI,GAEnB,CAEAg9C,aACI,OAAOzoD,KAAK+nD,gBAAkB/nD,KAAKioD,cACvC,GDhMG,SAASS,EAAU3sD,GACtB,KAAIA,EAAM9E,OAASyvD,GAGnB,OAAOC,EAAOC,IAAI7qD,GAAO+qD,WAAU,IAAMH,EAAOoB,gBACpD,CAEO,SAASY,EAAU5sD,GACtB,KAAIA,EAAM9E,OAASwvD,GAGnB,OAAOE,EAAOC,IAAI7qD,GAAO+qD,WAAU,IAAMH,EAAOsB,gBACpD,CAEO,SAASW,EAAQ7sD,GACpB,KAAIA,EAAM9E,OAASwvD,GAGnB,OAAOE,EAAOC,IAAI7qD,GAAO+qD,WAAU,IAAMH,EAAO8B,cACpD,g0EErBO,SAASI,IACZ,MAAMC,GAAW,SACjB,IAAIC,GAAQ,EACZ,MAAO,CACHC,KAAM/qD,MAAOE,IACT,GAAI4qD,EACA,MAAM,IAAIxwD,MAAM,iBAEpBwwD,GAAQ,EACRD,EAASr3C,QAAQtT,EAAO,EAE5BA,OAASF,kBACL,MAAME,QAAe2qD,EAASv3C,cACvBpT,CACX,CAHQ,GAKhB,gBCpBO,MAAM8qD,EAA6B,MAE7BC,EAAoBhkD,QAAQ4iB,WAAWvf,SAAStQ,KAAKixD,4CCFlE,SAASC,EAAO1wD,GACZ,IAAKuQ,OAAOogD,cAAc3wD,IAAMA,EAAI,EAChC,MAAM,IAAIF,MAAM,2BAA2BE,IACnD,CAKA,SAAS8K,EAAM+Y,KAAM+sC,GACjB,KAAM/sC,aAAa9hB,YACf,MAAM,IAAIjC,MAAM,uBACpB,GAAI8wD,EAAQpyD,OAAS,IAAMoyD,EAAQ9nC,SAASjF,EAAErlB,QAC1C,MAAM,IAAIsB,MAAM,iCAAiC8wD,oBAA0B/sC,EAAErlB,SACrF,CACA,SAAS,EAAKqI,GACV,GAAoB,mBAATA,GAA8C,mBAAhBA,EAAKX,OAC1C,MAAM,IAAIpG,MAAM,mDACpB4wD,EAAO7pD,EAAKgqD,WACZH,EAAO7pD,EAAKiqD,SAChB,CACA,SAASC,EAAOpwD,EAAUqwD,GAAgB,GACtC,GAAIrwD,EAASswD,UACT,MAAM,IAAInxD,MAAM,oCACpB,GAAIkxD,GAAiBrwD,EAASuwD,SAC1B,MAAM,IAAIpxD,MAAM,wCACxB,CACA,SAASkwC,EAAOxsC,EAAK7C,GACjBmK,EAAMtH,GACN,MAAMyI,EAAMtL,EAASkwD,UACrB,GAAIrtD,EAAIhF,OAASyN,EACb,MAAM,IAAInM,MAAM,yDAAyDmM,IAEjF,CChCO,MAAM,EAA+B,iBAAfojB,YAA2B,WAAYA,WAAaA,WAAW8sB,YAASltC,ECQ/FkiD,EAAOnpC,GAAMA,aAAajmB,WAKnBqvD,EAAchvD,GAAQ,IAAI8+B,SAAS9+B,EAAIlE,OAAQkE,EAAIqhB,WAAYrhB,EAAIgS,YAEnEi9C,EAAO,CAACC,EAAM3qD,IAAW2qD,GAAS,GAAK3qD,EAAW2qD,IAAS3qD,EAIxE,KADgF,KAA5D,IAAI5E,WAAW,IAAI1D,YAAY,CAAC,YAAaH,QAAQ,IAErE,MAAM,IAAI4B,MAAM,+CAiEb,SAASyxD,EAAQvtC,GAGpB,GAFoB,iBAATA,IACPA,EAZD,SAAqBphB,GACxB,GAAmB,iBAARA,EACP,MAAM,IAAI9C,MAAM,2CAA2C8C,GAC/D,OAAO,IAAIb,YAAW,IAAIue,aAAchK,OAAO1T,GACnD,CAQe2hB,CAAYP,KAClBmtC,EAAIntC,GACL,MAAM,IAAIlkB,MAAM,mCAAmCkkB,GACvD,OAAOA,CACX,CAgBO,MAAMwtC,EAEThvB,QACI,OAAOj7B,KAAKkqD,YAChB,EASG,SAAS,EAAgBC,GAC5B,MAAMC,EAASnjC,GAAQkjC,IAAWhb,OAAO6a,EAAQ/iC,IAAMojC,SACjDC,EAAMH,IAIZ,OAHAC,EAAMd,UAAYgB,EAAIhB,UACtBc,EAAMb,SAAWe,EAAIf,SACrBa,EAAMzrD,OAAS,IAAMwrD,IACdC,CACX,CC5HO,MAAMG,UAAaN,EACtBnqD,YAAYR,EAAMs/C,GACdjsC,QACA3S,KAAK2pD,UAAW,EAChB3pD,KAAK0pD,WAAY,EACjB,EAAWpqD,GACX,MAAM6O,EAAM67C,EAAQpL,GAEpB,GADA5+C,KAAKwqD,MAAQlrD,EAAKX,SACe,mBAAtBqB,KAAKwqD,MAAMrb,OAClB,MAAM,IAAI52C,MAAM,uDACpByH,KAAKupD,SAAWvpD,KAAKwqD,MAAMjB,SAC3BvpD,KAAKspD,UAAYtpD,KAAKwqD,MAAMlB,UAC5B,MAAMC,EAAWvpD,KAAKupD,SAChBhrB,EAAM,IAAI/jC,WAAW+uD,GAE3BhrB,EAAI1iC,IAAIsS,EAAIlX,OAASsyD,EAAWjqD,EAAKX,SAASwwC,OAAOhhC,GAAKk8C,SAAWl8C,GACrE,IAAK,IAAI7S,EAAI,EAAGA,EAAIijC,EAAItnC,OAAQqE,IAC5BijC,EAAIjjC,IAAM,GACd0E,KAAKwqD,MAAMrb,OAAO5Q,GAElBv+B,KAAKyqD,MAAQnrD,EAAKX,SAElB,IAAK,IAAIrD,EAAI,EAAGA,EAAIijC,EAAItnC,OAAQqE,IAC5BijC,EAAIjjC,IAAM,IACd0E,KAAKyqD,MAAMtb,OAAO5Q,GAClBA,EAAItnB,KAAK,EACb,CACAk4B,OAAOp0C,GAGH,OAFA,EAAaiF,MACbA,KAAKwqD,MAAMrb,OAAOp0C,GACXiF,IACX,CACA0qD,WAAWzuD,GACP,EAAa+D,MACb,EAAY/D,EAAK+D,KAAKspD,WACtBtpD,KAAK2pD,UAAW,EAChB3pD,KAAKwqD,MAAME,WAAWzuD,GACtB+D,KAAKyqD,MAAMtb,OAAOlzC,GAClB+D,KAAKyqD,MAAMC,WAAWzuD,GACtB+D,KAAKyqB,SACT,CACA4/B,SACI,MAAMpuD,EAAM,IAAIzB,WAAWwF,KAAKyqD,MAAMnB,WAEtC,OADAtpD,KAAK0qD,WAAWzuD,GACTA,CACX,CACAiuD,WAAWpjB,GAEPA,IAAOA,EAAKpoC,OAAOC,OAAOD,OAAOsqC,eAAehpC,MAAO,CAAC,IACxD,MAAM,MAAEyqD,EAAK,MAAED,EAAK,SAAEb,EAAQ,UAAED,EAAS,SAAEH,EAAQ,UAAED,GAActpD,KAQnE,OANA8mC,EAAG6iB,SAAWA,EACd7iB,EAAG4iB,UAAYA,EACf5iB,EAAGyiB,SAAWA,EACdziB,EAAGwiB,UAAYA,EACfxiB,EAAG2jB,MAAQA,EAAMP,WAAWpjB,EAAG2jB,OAC/B3jB,EAAG0jB,MAAQA,EAAMN,WAAWpjB,EAAG0jB,OACxB1jB,CACX,CACArc,UACIzqB,KAAK0pD,WAAY,EACjB1pD,KAAKyqD,MAAMhgC,UACXzqB,KAAKwqD,MAAM//B,SACf,EAQG,MAAM,EAAO,CAACnrB,EAAM6O,EAAKtG,IAAY,IAAI0iD,EAAKjrD,EAAM6O,GAAKghC,OAAOtnC,GAASwiD,SC7DzE,SAASM,EAAQrrD,EAAMsrD,EAAKC,GAO/B,OANA,EAAWvrD,QAIEoI,IAATmjD,IACAA,EAAO,IAAIrwD,WAAW8E,EAAKgqD,YACxB,EAAKhqD,EAAM0qD,EAAQa,GAAOb,EAAQY,GAC7C,CDsDA,EAAKjsD,OAAS,CAACW,EAAM6O,IAAQ,IAAIo8C,EAAKjrD,EAAM6O,GCpD5C,MAAM28C,EAA+B,IAAItwD,WAAW,CAAC,IAC/CuwD,EAA+B,IAAIvwD,WAOlC,SAASwwD,EAAO1rD,EAAM2rD,EAAKlxD,EAAM9C,EAAS,IAG7C,GAFA,EAAWqI,GACX,EAAarI,GACTA,EAAS,IAAMqI,EAAKgqD,UACpB,MAAM,IAAI/wD,MAAM,mCACpB,MAAM2yD,EAASjyD,KAAKm7C,KAAKn9C,EAASqI,EAAKgqD,gBAC1B5hD,IAAT3N,IACAA,EAAOgxD,GAEX,MAAMI,EAAM,IAAI3wD,WAAW0wD,EAAS5rD,EAAKgqD,WAEnCiB,EAAO,SAAYjrD,EAAM2rD,GACzBG,EAAUb,EAAKL,aACfvqB,EAAI,IAAInlC,WAAW+vD,EAAKjB,WAC9B,IAAK,IAAI+B,EAAU,EAAGA,EAAUH,EAAQG,IACpCP,EAAa,GAAKO,EAAU,EAG5BD,EAAQjc,OAAmB,IAAZkc,EAAgBN,EAAeprB,GACzCwP,OAAOp1C,GACPo1C,OAAO2b,GACPJ,WAAW/qB,GAChBwrB,EAAItvD,IAAI8jC,EAAGrgC,EAAKgqD,UAAY+B,GAC5Bd,EAAKL,WAAWkB,GAMpB,OAJAb,EAAK9/B,UACL2gC,EAAQ3gC,UACRkV,EAAE1oB,KAAK,GACP6zC,EAAa7zC,KAAK,GACXk0C,EAAIryD,MAAM,EAAG7B,EACxB,CC7CO,MAAMq0D,UAAarB,EACtBnqD,YAAYypD,EAAUD,EAAWiC,EAAWC,GACxC74C,QACA3S,KAAKupD,SAAWA,EAChBvpD,KAAKspD,UAAYA,EACjBtpD,KAAKurD,UAAYA,EACjBvrD,KAAKwrD,KAAOA,EACZxrD,KAAK2pD,UAAW,EAChB3pD,KAAK/I,OAAS,EACd+I,KAAKiC,IAAM,EACXjC,KAAK0pD,WAAY,EACjB1pD,KAAKrJ,OAAS,IAAI6D,WAAW+uD,GAC7BvpD,KAAKpE,KAAOiuD,EAAW7pD,KAAKrJ,OAChC,CACAw4C,OAAO1yB,GACH+sC,EAAOxpD,MACP,MAAM,KAAEpE,EAAI,OAAEjF,EAAM,SAAE4yD,GAAavpD,KAE7BhE,GADNygB,EAAOutC,EAAQvtC,IACExlB,OACjB,IAAK,IAAIgL,EAAM,EAAGA,EAAMjG,GAAM,CAC1B,MAAMyvD,EAAOxyD,KAAKyL,IAAI6kD,EAAWvpD,KAAKiC,IAAKjG,EAAMiG,GAEjD,GAAIwpD,IAASlC,EAMb5yD,EAAOkF,IAAI4gB,EAAKnlB,SAAS2K,EAAKA,EAAMwpD,GAAOzrD,KAAKiC,KAChDjC,KAAKiC,KAAOwpD,EACZxpD,GAAOwpD,EACHzrD,KAAKiC,MAAQsnD,IACbvpD,KAAKuI,QAAQ3M,EAAM,GACnBoE,KAAKiC,IAAM,OAXf,CACI,MAAMypD,EAAW7B,EAAWptC,GAC5B,KAAO8sC,GAAYvtD,EAAMiG,EAAKA,GAAOsnD,EACjCvpD,KAAKuI,QAAQmjD,EAAUzpD,EAE/B,CAQJ,CAGA,OAFAjC,KAAK/I,QAAUwlB,EAAKxlB,OACpB+I,KAAK2rD,aACE3rD,IACX,CACA0qD,WAAWzuD,GACPutD,EAAOxpD,MACPyoC,EAAOxsC,EAAK+D,MACZA,KAAK2pD,UAAW,EAIhB,MAAM,OAAEhzD,EAAM,KAAEiF,EAAI,SAAE2tD,EAAQ,KAAEiC,GAASxrD,KACzC,IAAI,IAAEiC,GAAQjC,KAEdrJ,EAAOsL,KAAS,IAChBjC,KAAKrJ,OAAOW,SAAS2K,GAAKgV,KAAK,GAE3BjX,KAAKurD,UAAYhC,EAAWtnD,IAC5BjC,KAAKuI,QAAQ3M,EAAM,GACnBqG,EAAM,GAGV,IAAK,IAAI3G,EAAI2G,EAAK3G,EAAIiuD,EAAUjuD,IAC5B3E,EAAO2E,GAAK,GAxExB,SAAsBM,EAAMsgB,EAAYrd,EAAO2sD,GAC3C,GAAiC,mBAAtB5vD,EAAKgwD,aACZ,OAAOhwD,EAAKgwD,aAAa1vC,EAAYrd,EAAO2sD,GAChD,MAAMK,EAAO5pC,OAAO,IACd6pC,EAAW7pC,OAAO,YAClB8pC,EAAK/iD,OAAQnK,GAASgtD,EAAQC,GAC9BE,EAAKhjD,OAAOnK,EAAQitD,GACpB5sB,EAAIssB,EAAO,EAAI,EACf55B,EAAI45B,EAAO,EAAI,EACrB5vD,EAAKqwD,UAAU/vC,EAAagjB,EAAG6sB,EAAIP,GACnC5vD,EAAKqwD,UAAU/vC,EAAa0V,EAAGo6B,EAAIR,EACvC,CAiEQI,CAAahwD,EAAM2tD,EAAW,EAAGtnC,OAAqB,EAAdjiB,KAAK/I,QAAau0D,GAC1DxrD,KAAKuI,QAAQ3M,EAAM,GACnB,MAAMswD,EAAQrC,EAAW5tD,GACnBD,EAAMgE,KAAKspD,UAEjB,GAAIttD,EAAM,EACN,MAAM,IAAIzD,MAAM,+CACpB,MAAM4zD,EAASnwD,EAAM,EACfwwC,EAAQxsC,KAAKW,MACnB,GAAIwrD,EAAS3f,EAAMv1C,OACf,MAAM,IAAIsB,MAAM,sCACpB,IAAK,IAAI+C,EAAI,EAAGA,EAAI6wD,EAAQ7wD,IACxB4wD,EAAMD,UAAU,EAAI3wD,EAAGkxC,EAAMlxC,GAAIkwD,EACzC,CACAnB,SACI,MAAM,OAAE1zD,EAAM,UAAE2yD,GAActpD,KAC9BA,KAAK0qD,WAAW/zD,GAChB,MAAMyoB,EAAMzoB,EAAOmC,MAAM,EAAGwwD,GAE5B,OADAtpD,KAAKyqB,UACErL,CACX,CACA8qC,WAAWpjB,GACPA,IAAOA,EAAK,IAAI9mC,KAAKF,aACrBgnC,EAAGjrC,OAAOmE,KAAKW,OACf,MAAM,SAAE4oD,EAAQ,OAAE5yD,EAAM,OAAEM,EAAM,SAAE0yD,EAAQ,UAAED,EAAS,IAAEznD,GAAQjC,KAO/D,OANA8mC,EAAG7vC,OAASA,EACZ6vC,EAAG7kC,IAAMA,EACT6kC,EAAG6iB,SAAWA,EACd7iB,EAAG4iB,UAAYA,EACXzyD,EAASsyD,GACTziB,EAAGnwC,OAAOkF,IAAIlF,GACXmwC,CACX,EC1GJ,MAEMslB,EAAM,CAAC3rC,EAAGnE,EAAG2C,IAAOwB,EAAInE,EAAMmE,EAAIxB,EAAM3C,EAAI2C,EAI5CotC,EAA2B,IAAIv1D,YAAY,CAC7C,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WACpF,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UACpF,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UACpF,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,aAIlFw1D,EAAqB,IAAIx1D,YAAY,CACvC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,aAIlFy1D,EAA2B,IAAIz1D,YAAY,IACjD,MAAM01D,UAAelB,EACjBxrD,cACI6S,MAAM,GAAI,GAAI,GAAG,GAGjB3S,KAAKysD,EAAY,EAARH,EAAG,GACZtsD,KAAK0sD,EAAY,EAARJ,EAAG,GACZtsD,KAAK2sD,EAAY,EAARL,EAAG,GACZtsD,KAAKg9B,EAAY,EAARsvB,EAAG,GACZtsD,KAAKwmB,EAAY,EAAR8lC,EAAG,GACZtsD,KAAKu3B,EAAY,EAAR+0B,EAAG,GACZtsD,KAAK4sD,EAAY,EAARN,EAAG,GACZtsD,KAAKi9B,EAAY,EAARqvB,EAAG,EAChB,CACA3rD,MACI,MAAM,EAAE8rD,EAAC,EAAEC,EAAC,EAAEC,EAAC,EAAE3vB,EAAC,EAAExW,EAAC,EAAE+Q,EAAC,EAAEq1B,EAAC,EAAE3vB,GAAMj9B,KACnC,MAAO,CAACysD,EAAGC,EAAGC,EAAG3vB,EAAGxW,EAAG+Q,EAAGq1B,EAAG3vB,EACjC,CAEAphC,IAAI4wD,EAAGC,EAAGC,EAAG3vB,EAAGxW,EAAG+Q,EAAGq1B,EAAG3vB,GACrBj9B,KAAKysD,EAAQ,EAAJA,EACTzsD,KAAK0sD,EAAQ,EAAJA,EACT1sD,KAAK2sD,EAAQ,EAAJA,EACT3sD,KAAKg9B,EAAQ,EAAJA,EACTh9B,KAAKwmB,EAAQ,EAAJA,EACTxmB,KAAKu3B,EAAQ,EAAJA,EACTv3B,KAAK4sD,EAAQ,EAAJA,EACT5sD,KAAKi9B,EAAQ,EAAJA,CACb,CACA10B,QAAQ3M,EAAM1E,GAEV,IAAK,IAAIoE,EAAI,EAAGA,EAAI,GAAIA,IAAKpE,GAAU,EACnCq1D,EAASjxD,GAAKM,EAAKixD,UAAU31D,GAAQ,GACzC,IAAK,IAAIoE,EAAI,GAAIA,EAAI,GAAIA,IAAK,CAC1B,MAAMwxD,EAAMP,EAASjxD,EAAI,IACnByxD,EAAKR,EAASjxD,EAAI,GAClB0xD,EAAKlD,EAAKgD,EAAK,GAAKhD,EAAKgD,EAAK,IAAOA,IAAQ,EAC7CG,EAAKnD,EAAKiD,EAAI,IAAMjD,EAAKiD,EAAI,IAAOA,IAAO,GACjDR,EAASjxD,GAAM2xD,EAAKV,EAASjxD,EAAI,GAAK0xD,EAAKT,EAASjxD,EAAI,IAAO,CACnE,CAEA,IAAI,EAAEmxD,EAAC,EAAEC,EAAC,EAAEC,EAAC,EAAE3vB,EAAC,EAAExW,EAAC,EAAE+Q,EAAC,EAAEq1B,EAAC,EAAE3vB,GAAMj9B,KACjC,IAAK,IAAI1E,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,MACM4xD,EAAMjwB,GADG6sB,EAAKtjC,EAAG,GAAKsjC,EAAKtjC,EAAG,IAAMsjC,EAAKtjC,EAAG,OAnEjD/F,EAoE4B+F,GAAG+Q,GApEP9W,EAoEUmsC,GAAKP,EAAS/wD,GAAKixD,EAASjxD,GAAM,EAE/D6xD,GADSrD,EAAK2C,EAAG,GAAK3C,EAAK2C,EAAG,IAAM3C,EAAK2C,EAAG,KAC7BL,EAAIK,EAAGC,EAAGC,GAAM,EACrC1vB,EAAI2vB,EACJA,EAAIr1B,EACJA,EAAI/Q,EACJA,EAAKwW,EAAIkwB,EAAM,EACflwB,EAAI2vB,EACJA,EAAID,EACJA,EAAID,EACJA,EAAKS,EAAKC,EAAM,CACpB,CA/EI,IAAC1sC,EAiFLgsC,EAAKA,EAAIzsD,KAAKysD,EAAK,EACnBC,EAAKA,EAAI1sD,KAAK0sD,EAAK,EACnBC,EAAKA,EAAI3sD,KAAK2sD,EAAK,EACnB3vB,EAAKA,EAAIh9B,KAAKg9B,EAAK,EACnBxW,EAAKA,EAAIxmB,KAAKwmB,EAAK,EACnB+Q,EAAKA,EAAIv3B,KAAKu3B,EAAK,EACnBq1B,EAAKA,EAAI5sD,KAAK4sD,EAAK,EACnB3vB,EAAKA,EAAIj9B,KAAKi9B,EAAK,EACnBj9B,KAAKnE,IAAI4wD,EAAGC,EAAGC,EAAG3vB,EAAGxW,EAAG+Q,EAAGq1B,EAAG3vB,EAClC,CACA0uB,aACIY,EAASt1C,KAAK,EAClB,CACAwT,UACIzqB,KAAKnE,IAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC9BmE,KAAKrJ,OAAOsgB,KAAK,EACrB,EAqBG,MAAMm2C,EAAyB,GAAgB,IAAM,IAAIZ,ICvHnDa,GAAe,CACxBC,WAAW7wC,GACA2wC,EAAO3wC,GAElB8wC,QAAQC,EAAI5C,GACR,MAAMK,EAAMN,EAAQyC,EAAQxC,EAAK4C,GAE3BrC,EADaH,EAAOoC,EAAQnC,OAAKvjD,EAAW,IAKlD,MAAO,CAHIyjD,EAAI7zD,SAAS,EAAG,IAChB6zD,EAAI7zD,SAAS,GAAI,IACjB6zD,EAAI7zD,SAAS,GAAI,IAEhC,EACAm2D,wBACI,MAAMC,EAAY,8BAElB,MAAO,CACHt4B,UAFc,kBAAoBs4B,GAGlCC,WAAYD,EAEpB,EACAE,8BAA8BC,IAEnB,CACHz4B,UAFc,kBAAoBy4B,GAGlCF,WAAYE,IAGpBC,wBAAuB,CAACH,EAAYv4B,IACzB,qBAAuBu4B,EAAYv4B,GAE9C24B,wBAAuB,CAACC,EAAWC,EAAOC,EAAIh7C,KACnC,EAAAi7C,EAAA,IAAiBj7C,EAAG+6C,EAAOC,GAAIE,QAAQJ,GAElDK,wBAAuB,CAACC,EAAYL,EAAOC,EAAIh7C,EAAG5L,KACvC,EAAA6mD,EAAA,IAAiBj7C,EAAG+6C,EAAOC,GAAIK,QAAQD,EAAYhnD,ICnC3D,SAAS,GAAavM,GACzB,OAAyB,MAArB+sB,WAAW1lB,OACJ,IAAI5H,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAEnD9R,CACX,CCOO,SAASmQ,GAAYzT,EAAO,GAC/B,OAAsC,MAAlCqwB,WAAW1lB,QAAQ8I,YACZ,GAAa4c,WAAW1lB,OAAO8I,YAAYzT,IAE/C,IAAI+C,WAAW/C,EAC1B,CChBO,SAASoiB,GAAOgqC,EAAQ5sD,GACb,MAAVA,IACAA,EAAS4sD,EAAOz0B,QAAO,CAACtd,EAAK5S,IAAS4S,EAAM5S,EAAKjI,QAAQ,IAE7D,MAAMwxC,EAASv9B,GAAYjU,GAC3B,IAAIC,EAAS,EACb,IAAK,MAAM2D,KAAOgpD,EACdpb,EAAO5sC,IAAIhB,EAAK3D,GAChBA,GAAU2D,EAAI5D,OAElB,OAAO,GAAawxC,EACxB,CCfA,MAMa+lB,GAAkB3vD,IAC3B,MAAMwT,GAPWrW,EAOU,EANvB8rB,WAAW1lB,OACJ0lB,WAAW1lB,OAAO8I,YAAYlP,GAElC,IAAIxB,WAAWwB,IAJN,IAACA,EASjB,OADA,IAAI29B,SAAStnB,EAAO1b,OAAQ0b,EAAO6J,WAAY7J,EAAOxF,YAAY4hD,UAAU,EAAG5vD,GAAO,GAC/EwT,CAAM,EAEjBm8C,GAAejrD,MAAQ,EAChB,MAAMmrD,GAAkBjyC,IAC3B,GAAIA,EAAKxlB,OAAS,EACd,MAAM+K,WAAW,4BACrB,OAAIya,aAAgBjiB,WACT,IAAIm/B,SAASld,EAAK9lB,OAAQ8lB,EAAKP,WAAYO,EAAK5P,YAAY8hD,UAAU,GAAG,GAE7ElyC,EAAKkyC,UAAU,EAAE,EAE5BD,GAAenrD,MAAQ,gDCqGvB,IAAI,GArHJ,SAAeqrD,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,EAKA,GAFsC,GC5HxB,IAAI7E,WAAW,GAA7B,MAsCMwoC,GAASjlC,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAMy3D,GAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,GAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,GAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,GAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,GAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,GAAK,CAACI,EAAMC,IAAU,IAAIH,GAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,GAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,GAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,GAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,GAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,GAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,GAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,GAAMob,EAAUnoB,GAC3C,OAAOmH,GAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQkJ,GAAO52B,EAAO0tB,KAC/B,EA4GUi3B,GAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,GAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrC+xD,GAASN,GAAM,CAC1Bt3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,eCDC6pC,GAASN,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mBACVwpC,YAAa,IAGFM,GAAcP,GAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mBACVwpC,YAAa,ICXFO,GAAQR,GAAQ,CAC3Bv3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,KACVwpC,YAAa,ICNTxpC,GAAW5uB,MAAM4N,KAAK,0eACtBgrD,GAAgDhqC,GAAS4H,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAED,GAAK2jB,EAAU1jB,IAA4B,IAC5Hk2D,GAAgDjqC,GAAS4H,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAyB0jB,EAAEmxC,YAAY,IAAO90D,EAAUC,IAA4B,IA6BlK,MAAMm2D,GAAelrD,GAAK,CAC/BgT,OAAQ,KACRna,KAAM,eACN0P,OA1BF,SAAiB0N,GACf,OAAOA,EAAK2S,QAAO,CAAC7zB,EAAG0jB,IACrB1jB,GAAKi2D,GAAqBvyC,IAEzB,GACL,EAsBE7S,OAhBF,SAAiB/Q,GACf,MAAMs2D,EAAO,GACb,IAAK,MAAMn3C,KAAQnf,EAAK,CACtB,MAAMu2D,EAAMH,GAA4Cj3C,EAAK41C,YAAY,IACzE,QAAY1oD,IAARkqD,EACF,MAAM,IAAIr5D,MAAM,+BAA+BiiB,KAEjDm3C,EAAKj6D,KAAKk6D,EACZ,CACA,OAAO,IAAIp3D,WAAWm3D,EACxB,IC7BaE,GAASd,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGFc,GAAcf,GAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGFe,GAAYhB,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGFgB,GAAiBjB,GAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGFiB,GAAYlB,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGFkB,GAAiBnB,GAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGFmB,GAAepB,GAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGFoB,GAAoBrB,GAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGFqB,GAAUtB,GAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DFsB,GAASxB,GAAM,CAC1Bt3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,yCAGC+qC,GAAczB,GAAM,CAC/Bt3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,yCCTCgrC,GAAY1B,GAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGCirC,GAAe3B,GAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCPC,GAASupC,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGF0B,GAAY3B,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGF2B,GAAY5B,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGF4B,GAAe7B,GAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICzBF6B,GAAQ9B,GAAQ,CAC3Bv3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,WACVwpC,YAAa,ICHF8B,GAAWtsD,GAAK,CAC3BgT,OAAQ,KACRna,KAAM,WACN0P,OAAShU,IAAQ,OXwDFuhB,EWxDWvhB,GXwDN,IAAKg4D,aAAe3mD,OAAOkQ,GAAhCA,KWxDe,EAC9BlQ,OAAS/Q,GXiDQA,KAAO,IAAK0d,aAAehK,OAAO1T,GWjDlCsL,CAAWtL,KCFxByd,GAAc,IAAIC,YAClBi6C,GAAc,IAAID,YAEX,GAAO,OACP1kD,GAAO,IAOP,GAAU5F,GAASqQ,GAAY/J,OAAOmrB,KAAKuG,UAAUh4B,IAOrD,GAAUgU,GAASyd,KAAKlO,MAAMgnC,GAAY5mD,OAAOqQ,IChBjD,GAAO,MACP,GAAO,GAMP,GAAUhU,GAASu6B,GAAOv6B,GAM1B,GAAUgU,GAASumB,GAAOvmB,GCtBvC,IAAIw2C,GAOJ,SAAS,EAAOtsB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAOwsB,IACXl3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,GAC/BzsB,GAAO,IAET,KAAMA,EAAM0sB,IACVp3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,GAC/BzsB,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBIm3D,GAAM,IAENC,IAAS,IACTF,GAAMl6D,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAASngB,EAAK5I,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADAjuB,EAAKJ,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAIg3C,KAAWl0D,GACfkd,EAAIg3C,IAAUr6D,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAKi3C,IAId,OAFA5vD,EAAKJ,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BIm0C,GAAQ,IACRD,GAAS,IA2Bb,IAAIE,GAAKv6D,KAAK6qB,IAAI,EAAI,GAClB2vC,GAAKx6D,KAAK6qB,IAAI,EAAG,IACjB4vC,GAAKz6D,KAAK6qB,IAAI,EAAG,IACjB6vC,GAAK16D,KAAK6qB,IAAI,EAAG,IACjB8vC,GAAK36D,KAAK6qB,IAAI,EAAG,IACjB+vC,GAAK56D,KAAK6qB,IAAI,EAAG,IACjBgwC,GAAK76D,KAAK6qB,IAAI,EAAG,IACjBiwC,GAAK96D,KAAK6qB,IAAI,EAAG,IACjBkwC,GAAK/6D,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQkkD,GACR7mD,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ20D,GAAK,EACb30D,EAAQ40D,GAAK,EACb50D,EAAQ60D,GAAK,EACb70D,EAAQ80D,GAAK,EACb90D,EAAQ+0D,GAAK,EACb/0D,EAAQg1D,GAAK,EACbh1D,EAAQi1D,GAAK,EACbj1D,EAAQk1D,GAAK,EACbl1D,EAAQm1D,GAAK,EACA,EAEjB,GCzEO,MAAM,GAAS,CAACv3C,EAAMvlB,EAAS,IAE7B,CADM,UAAculB,EAAMvlB,GACnB,iBAQHg9D,GAAW,CAACC,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI4hD,GAAkBE,GACtB,kBAAsBA,GCjBlBx1D,GAAS,CAAC0P,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAIC,GAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAShC,GAAUgxD,IACrB,MAAMhxD,EAAQy/B,GAAOuxB,IACdlmD,EAAM+lD,GAAc,GAAc7wD,IAClC9L,EAAM48D,GAAgB,GAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI+7D,GAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM+wD,GASXx0D,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtFF,MAIM,GAASy/B,GAQF,GAAW,CAAE30B,KAZb,EAYiB,KAXjB,WAWuB,OAAQ,UAF5BtS,GAAU,GAVb,EAUiC,GAAOA,KCHxC,GAAO,EAAGsD,OAAMgP,OAAMU,YAAa,IAAIylD,GAAOn1D,EAAMgP,EAAMU,GAWhE,MAAMylD,GAOX10D,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,EC1CF,MAAMk8D,GAAMp1D,GAIVpB,SAAc,IAAIzD,iBAAiBo6C,OAAO8f,OAAOrK,OAAOhrD,EAAMod,IAEnD,GAAS,GAAK,CACzBpd,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,aAGDE,GAAS,GAAK,CACzBt1D,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,aCHD7lD,GAAS,CAACgmD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG4rC,GACLvxD,EACAwxD,GAAUH,GAC+B,GAAUpC,GAAU3B,SAGxDmE,GACLzxD,EACAwxD,GAAUH,GACmCC,GAAQhD,GAAOhB,QAElE,EAoBIx2C,GAAQ,IAAIiW,QAMZykC,GAAYE,IAChB,MAAMF,EAAY16C,GAAM1Z,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADAD,GAAMxe,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAMG,GAOXp1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAASgnD,GACX,MAAM,IAAI98D,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAASinD,GACrB,MAAM,IAAI/8D,MAAM,sDAGlB,OACE28D,GAAIK,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAY,GAAclmD,EAAMg8C,GACtC,OACE6K,GAAIO,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAOR,GAAIl0C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SJ5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YhBrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GgB0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GIiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAOjmD,GAAO5O,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK5S,GAAO5O,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiBq2D,GAEnB,OAAOr2D,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAIq2D,GACThsC,EACA7a,EACwC,EACxC9K,GAASwyD,GAAU7sC,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAMm3D,IAAqB,CAIpC,MAAM,QAAE9sC,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,GAAckK,GACjB,OAAOW,GAAIv2D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAASgnD,GACX,MAAM,IAAI98D,MACR,wCAAwC88D,sBAG1C,OAAO,IAAIH,GAAIhsC,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQwyD,GAAU7sC,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI2xD,GAAIhsC,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO6K,GAAIv2D,OAAO,EAAG02D,GAAahL,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO6K,GAAIv2D,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAaf,GAAIgB,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQjB,GAAIkB,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiBvzB,GACrBz/B,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,GACjB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACFgsC,GAAIK,SAAyD,GAC7DL,GAAIO,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,GAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,GAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAASszD,GAAgB14D,EAAQ02D,GAE1CI,EAAMC,GAAI9oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFAw8D,GAAUE,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM4B,GAAkB,CAAC14D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQrC,GACxB,MAAO,CACkBA,GAAgB,OACvCjC,EAAQnkD,OAAO,GAAGomD,GAAUh5C,SAASrb,KAEzC,CACA,KAAKq0D,GAAUh5C,OAAQ,CACrB,MAAM+2C,EAAUsE,GAAQrC,GACxB,MAAO,CAAuBA,GAAgB,OAAGjC,EAAQnkD,OAAOjO,GAClE,CACA,KAAK0zD,GAAOr4C,OAAQ,CAClB,MAAM+2C,EAAUsE,GAAQhD,GACxB,MAAO,CAAuBA,GAAa,OAAGtB,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI22D,GAAa,CAACvxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAWg5C,GAAUh5C,OACvB,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASID,GAAa,CAACzxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGII,GAAc,IACdC,GAAe,GAQfS,GAAY,CAAC7sC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,GAAsB5tC,GACnC6tC,EAAaD,EAAa,GAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,GAAgBqc,EAAS3lB,EAAO,GAChC,GAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGHyyD,GAAYx/D,OAAOkqD,IAAI,oBCnkBvBsW,GAAQ,IAAK,KAAiB,KAAU,KAAU,KAAW,KAAW,KAAW,KAAW,KAAW,KAAW,GChB1H,SAASC,GAAY53D,EAAMma,EAAQzK,EAAQ3C,GACvC,MAAO,CACH/M,OACAma,SACAq3C,QAAS,CACLxxD,OACAma,SACAzK,UAEJwhD,QAAS,CACLnkD,UAGZ,CACA,MAAM1I,GAASuzD,GAAY,OAAQ,KAAMl8D,GAE9B,IADS,IAAIg4D,YAAY,QACX3mD,OAAOrR,KAC5BM,IACgB,IAAI0d,aACLhK,OAAO1T,EAAIoE,UAAU,MAElCy3D,GAAQD,GAAY,QAAS,KAAMl8D,IACrC,IAAI2I,EAAS,IACb,IAAK,IAAIpI,EAAI,EAAGA,EAAIP,EAAI9D,OAAQqE,IAC5BoI,GAAUvM,OAAOC,aAAa2D,EAAIO,IAEtC,OAAOoI,CAAM,IACbrI,IAEA,MAAMN,EAAMmQ,IADZ7P,EAAMA,EAAIoE,UAAU,IACQxI,QAC5B,IAAK,IAAIqE,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC5BP,EAAIO,GAAKD,EAAIG,WAAWF,GAE5B,OAAOP,CAAG,IAWd,OATc,CACV6G,KAAM8B,GACN,QAASA,GACTyzD,IAAKH,GAAM3F,OACX+F,OAAQF,GACRA,SACAG,OAAQH,MACLF,ICnCA,SAAS,GAAWtzD,EAAQuH,EAAW,QAC1C,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKtE,QAAQnkD,OAAO,GAAGyoD,EAAKr7C,SAAS9V,KAHjC,GAAaokB,WAAW1lB,OAAOoE,KAAK9C,EAAQ,SAI3D,CChBO,SAAS,GAAO+c,EAAGnE,GACtB,GAAImE,IAAMnE,EACN,OAAO,EAEX,GAAImE,EAAE5T,aAAeyP,EAAEzP,WACnB,OAAO,EAEX,IAAK,IAAIvR,EAAI,EAAGA,EAAImlB,EAAE5T,WAAYvR,IAC9B,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GACX,OAAO,EAGf,OAAO,CACX,CCfA,MAAMg8D,GAAyB,GACzBC,GAA0B,GAC1BC,GAAmB,GAwCzB,SAASC,GAAWC,EAAetiC,GAC/B,MAAMu4B,EAAa,IAAInzD,WAAW+8D,IAClC,IAAK,IAAIj8D,EAAI,EAAGA,EAAIk8D,GAAkBl8D,IAClCqyD,EAAWryD,GAAKo8D,EAAcp8D,GAC9BqyD,EAAW6J,GAAmBl8D,GAAK85B,EAAU95B,GAEjD,OAAOqyD,CACX,CC/CA,QACIhtD,IAAIg3D,EAAM7vC,YACN,MAAM8vC,EAAeD,EAAI/iB,OACzB,GAAoB,MAAhBgjB,GAA+C,MAAvBA,EAAalD,OACrC,MAAMh2D,OAAO6W,OAAO,IAAIhd,MAAM,gRAI0D,CAAE8V,KAAM,2BAEpG,OAAOupD,CACX,GCDG,MAAMC,GAA0B,CAAEC,IAAK,UAAWj2C,KAAK,EAAM3O,EAAG,yBAA0B6kD,QAAS,CAAC,UAAW,WAAYC,IAAK,OCNhI/5D,eAAeg6D,GAAStK,EAAYuK,GACvC,MAAMC,EDOH,SAAgBpmB,GACnB,MAAMqmB,EAAYrmB,GAAMqmB,WAAa,UACrC,IAAIC,EAAYtmB,GAAMsmB,WAAa,GACnC,MAAMC,EAAcvmB,GAAMumB,aAAe,GACnCjO,EAAStY,GAAMsY,QAAU,UACzBkO,EAAaxmB,GAAMwmB,YAAc,GACjCC,EAAazmB,GAAMymB,YAAc,MACjC5jB,EAAS,SA0Ef,OAzEAyjB,GAAa,EAqEE,CACXjK,QAjEJnwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOjW,EAAO6jB,gBAAgB,IAAIj+D,WAAW+9D,IAC7CtK,EAAQrZ,EAAO6jB,gBAAgB,IAAIj+D,WAAW89D,IAC9CI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OAAc,CACvB2hE,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,YACtG,IACI,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,WAC1G,CACJ,KACK,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAM/J,QAAmB1Z,EAAO8f,OAAOtG,QAAQsK,EAAQE,EAAWn8C,GAClE,OAAO5C,GAAO,CAACgxC,EAAM6N,EAAOC,GAAI,IAAIn+D,WAAW8zD,IACnD,EAsCIC,QA/BJtwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOpuC,EAAKnlB,SAAS,EAAGihE,GACxBtK,EAAQxxC,EAAKnlB,SAASihE,EAAYA,EAAaD,GAC/ChK,EAAa7xC,EAAKnlB,SAASihE,EAAaD,GACxCI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OACT,IACI,MAAM6hE,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,WAC1G,KAEC,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAMrK,QAAkBpZ,EAAO8f,OAAOnG,QAAQmK,EAAQE,EAAWtK,GACjE,OAAO,IAAI9zD,WAAWwzD,EAC1B,EAMJ,CCzFmB,GACTkL,QAAqBf,EAAO/J,QAAQT,EAAYuK,GACtD,OAAO,UAAcgB,EACzB,KCLWC,GAMPC,GAWOC,GAiDAC,gBAjEX,SAAWH,GACPA,EAAa,IAAI,MACjBA,EAAiB,QAAI,UACrBA,EAAmB,UAAI,WAC1B,CAJD,CAIGA,KAAYA,GAAU,CAAC,IAE1B,SAAWC,GACPA,EAAgBA,EAAqB,IAAI,GAAK,MAC9CA,EAAgBA,EAAyB,QAAI,GAAK,UAClDA,EAAgBA,EAA2B,UAAI,GAAK,WACvD,CAJD,CAIGA,KAAoBA,GAAkB,CAAC,IAC1C,SAAWD,GACPA,EAAQxC,MAAQ,KACL,SAAYyC,GAE1B,CAJD,CAIGD,KAAYA,GAAU,CAAC,IAE1B,SAAWE,GACP,IAAIE,EACJF,EAAU1C,MAAQ,KACA,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACTq2D,GAAQxC,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAOk+D,GAAQxC,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXF,EAAUtqD,OAAUzF,IACT,SAAcA,EAAK+vD,EAAU1C,SAExC0C,EAAUjtD,OAAUrR,IACT,SAAcA,EAAKs+D,EAAU1C,QAE3C,CA/CD,CA+CG0C,KAAcA,GAAY,CAAC,IAE9B,SAAWC,GACP,IAAIC,EACJD,EAAW3C,MAAQ,KACD,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACTq2D,GAAQxC,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAOk+D,GAAQxC,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXD,EAAWvqD,OAAUzF,IACV,SAAcA,EAAKgwD,EAAW3C,SAEzC2C,EAAWltD,OAAUrR,IACV,SAAcA,EAAKu+D,EAAW3C,QAE5C,CA/CD,CA+CG2C,KAAeA,GAAa,CAAC,IChHzB,MAAMI,GACT9a,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAO+a,GAAUxrD,EAAK,GAC/B,CACAlQ,aAAawe,EAAM6Z,GACf,OL0BDr4B,eAA6Bm3B,EAAWkB,EAAKrP,GAChD,OAAO,YAAUqP,EAAKrP,EAAKmO,EAC/B,CK5Be,CAAqBp1B,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMs2D,GACTjb,KACAkb,WAGAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAO+a,GAAUxrD,EAAK,IAC3BnO,KAAK85D,WAAaH,GAAUvkC,EAAW,GAC3C,CACAn3B,WAAW4J,GACP,OLPD5J,eAA2B0vD,EAAY1mC,GAC1C,MAAMywC,EAAgB/J,EAAWr2D,SAAS,EAAGkgE,IAC7C,OAAO,UAAQvwC,EAAKywC,EACxB,CKIe,CAAmB13D,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAIL,GAAiB15D,KAAK85D,WACrC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAUAtF,WACI,MAAMgN,EAAW,UAAgBjL,KAAK+5D,OAAOx2D,OAC7C,OAAOivD,GAAUzjD,OAAO9D,EAAS1H,OAAO9D,UAAU,EACtD,CAIAxB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAASorD,GAA2Bz2D,GAEvC,GAAIA,EAAMtM,OAAS,GAAyB,CAExC,MAAMgjE,GADN12D,EAAQo2D,GAAUp2D,EAAO,GAA0B,KACrBjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,GAAyBiM,EAAMtM,QACrE,OAAO,IAAI4iE,GAAkBI,EAAiBC,EAClD,CAEA,MAAMD,GADN12D,EAAQo2D,GAAUp2D,EAAO,KACKjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,IACtC,OAAO,IAAIuiE,GAAkBI,EAAiBC,EAClD,CACO,SAASC,GAA0B52D,GAEtC,OADAA,EAAQo2D,GAAUp2D,EAAO,IAClB,IAAIm2D,GAAiBn2D,EAChC,CACOtF,eAAem8D,KAClB,MAAM,WAAEzM,EAAU,UAAEv4B,SLrGjBn3B,iBAEH,MAAMy5D,EAAgB,8BAChBtiC,EAAY,kBAAgBsiC,GAGlC,MAAO,CACH/J,WAFe8J,GAAWC,EAAetiC,GAGzCA,YAER,CK2F4C,GACxC,OAAO,IAAIykC,GAAkBlM,EAAYv4B,EAC7C,CACOn3B,eAAeo8D,GAAwBxM,GAC1C,MAAM,WAAEF,EAAU,UAAEv4B,SL3FjBn3B,eAAmC4vD,GACtC,GAAIA,EAAK52D,SAAWugE,GAChB,MAAM,IAAIxyD,UAAU,sCAEnB,KAAM6oD,aAAgBrzD,YACvB,MAAM,IAAIwK,UAAU,mDAGxB,MAAM0yD,EAAgB7J,EAChBz4B,EAAY,kBAAgBsiC,GAElC,MAAO,CACH/J,WAFe8J,GAAWC,EAAetiC,GAGzCA,YAER,CK4E4C,CAA2By4B,GACnE,OAAO,IAAIgM,GAAkBlM,EAAYv4B,EAC7C,CACA,SAASukC,GAAUxrD,EAAKlX,GAEpB,IADAkX,EAAM3T,WAAWgM,KAAK2H,GAAO,KACrBlX,SAAWA,EACf,MAAM,IAAI,MAAU,sCAAsCA,UAAekX,EAAIlX,SAAU,wBAE3F,OAAOkX,CACX,CChHO,SAAS,GAAS0O,EAAO5R,EAAW,QACvC,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKhE,QAAQ9hD,OAAO8N,GAAOpd,UAAU,GAHjCqoB,WAAW1lB,OAAOoE,KAAKqW,EAAMlmB,OAAQkmB,EAAMX,WAAYW,EAAMhQ,YAAYlI,SAAS,OAIjG,mBCXO,SAAS21D,GAA0B3zB,EAAK3qC,GAE3C,IAAIjB,EAAMP,WAAWgM,KAAKmgC,EAAIxf,MAAMG,eAMpC,GADAvsB,EAAiB,IAAXA,EAAI,GAAWA,EAAIzD,SAAS,GAAKyD,EAC5B,MAAPiB,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAO,GAAmBA,EAAK,YACnC,CAEO,SAASw/D,GAAsBl/D,GAClC,MAAMN,EAGH,SAA2BM,EAAKW,GACnC,IAAIjB,EAAM,GAAqBM,EAAK,gBACpC,GAAW,MAAPW,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAOA,CACX,CAXgB,CAAkBM,GAC9B,OAAO,IAAI,mBAAsB,GAAmBN,EAAK,UAAW,GACxE,CCpBA,MAAMwH,GAAO,CACT,QAAS,IACT,QAAS,IACT,QAAS,KAEM7D,OAAO+I,KAAKlF,IACN5K,KAAK,gBCVf,SAAS,GAAYV,GAChC,GAAIg2B,MAAMh2B,IAAWA,GAAU,EAC3B,MAAM,IAAI,MAAU,qDAAsD,sBAE9E,O7C6IG,SAAqBujE,EAAc,IACtC,GAAI,GAA4C,mBAA3B,kBACjB,OAAO,kBAAuB,IAAIhgE,WAAWggE,IAEjD,MAAM,IAAIjiE,MAAM,yCACpB,C6ClJW,CAAMtB,EACjB,UCHA,SAASwjE,GAAQtsD,EAAKusD,GAClB,OAAOA,EAAM9/C,KAAI4kB,GAAK+6B,GAAsBpsD,EAAIqxB,KACpD,CCgBOvhC,eAAe,GAAoBkQ,GACtC,MAIM06C,EAAO,OAJY,SAAgB6L,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,eAGAs7D,GAAwBxsD,IAE5B1G,QAAamzD,GAAU,CACzBjN,WAAY9E,EAAK,GACjBzzB,UAAWyzB,EAAK,KAEpB,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CAiBAxJ,eAAe28D,GAAU/R,GACrB,GAAuB,MAAnBA,EAAK8E,YAAwC,MAAlB9E,EAAKzzB,UAChC,MAAM,IAAI,MAAU,sCAAuC,0BAE/D,OAAO5jB,QAAQQ,IAAI,CACf,SAAgB0iD,OAAOkG,UAAU,MAAO/R,EAAK8E,YAC7C,SAAgB+G,OAAOkG,UAAU,MAAO/R,EAAKzzB,YAErD,CACAn3B,eAAe08D,GAAwBE,GACnC,OAAO,SAAgBnG,OAAOmE,UAAU,MAAO,CAC3Cb,IAAK6C,EAAM7C,IACXv/D,EAAGoiE,EAAMpiE,EACTgR,EAAGoxD,EAAMpxD,GACV,CACCpK,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,UACd,CAYA,SAASy7D,GAAW3sD,EAAK4sD,EAAK9zC,EAAK+zC,GAC/B,MAAMC,EAAOF,ED7EV,SAAiB5sD,GACpB,OAAO,0BAA6BssD,GAAQtsD,EAAK,CAAC,IAAK,MAC3D,CC2EuB+sD,CAAQ/sD,GDhFxB,SAAkBA,GACrB,OAAO,2BAA8BssD,GAAQtsD,EAAK,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,OAC5F,CC8EsCgtD,CAAShtD,GAG3C,OAAO,GADO6sD,EADD,GAAmBxgE,WAAWgM,KAAKygB,GAAM,SAC3Bg0C,GACQ,QACvC,CAOO,SAASG,GAAQC,GACpB,GAAgB,QAAZA,EAAIrD,IACJ,MAAM,IAAI,MAAU,mBAAoB,wBAEvC,GAAa,MAATqD,EAAI5iE,EACT,MAAM,IAAI,MAAU,sBAAuB,2BAG/C,OAAsB,EADR,GAAqB4iE,EAAI5iE,EAAG,aAC7BxB,MACjB,CCjGO,MAAMqkE,GAAe,KACrB,MAAMC,GACT3c,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODgCDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,MAAMmO,QAAkB,SAAgBs/B,OAAOmE,UAAU,MAAO1qD,EAAK,CACjE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,WACX,OAAO,SAAgBq1D,OAAO8G,OAAO,CAAEn8D,KAAM,qBAAuB+1B,EAAWkB,EAAKrP,EACxF,CCtCe,CAAqBjnB,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OCkCD,SAAmByB,GACtB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,EACrB,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMgyD,EAAO,uBAA0B,CACnChjE,EAAG8hE,GAAsBc,EAAI5iE,GAC7BgR,EAAG8wD,GAAsBc,EAAI5xD,KAEjC,OAAO,GAAqB,cAAiBgyD,GAAMC,WAAY,QACnE,CD3Ce,CAAuB17D,KAAK4+C,KACvC,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA82D,QAAQ7qD,GACJ,ODgEGu3D,GChEmB96D,KAAK4+C,MDgER,EChEcr7C,GDgEH,CAAC0jB,EAAK9Y,IAAQA,EAAIigD,QAAQnnC,IC/D5D,CACAjG,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMo4D,GACT/c,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,CACtB,CACAwmC,YACI,OAAO,GAAuB,GAClC,CACA39D,WAAW4J,GACP,ODTD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM0mC,QAAmB,SAAgB+G,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,SACLi3B,QAAY,SAAgBo+B,OAAOnuD,KAAK,CAAElH,KAAM,qBAAuBsuD,EAAYnzD,WAAWgM,KAAKygB,IACzG,OAAO,IAAIzsB,WAAW87B,EAAK,EAAGA,EAAIzpB,WACtC,CCEe,CAAmB7M,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,GAAuB,MAAnB/5D,KAAK85D,WACL,MAAM,IAAI,MAAU,0BAA2B,2BAEnD,OAAO,IAAIyB,GAAav7D,KAAK85D,WACjC,CACAvL,QAAQhrD,GACJ,ODqCGu3D,GCrCmB96D,KAAK4+C,MDqCR,ECrCcr7C,GDqCF,CAAC0jB,EAAK9Y,IAAQA,EAAIogD,QAAQtnC,ICpC7D,CACA2yC,UACI,OCnCD,SAAoByB,GACvB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,GAAsB,MAAT4xD,EAAIt+B,GAAsB,MAATs+B,EAAI9/D,GAAsB,MAAT8/D,EAAIhe,GAAuB,MAAVge,EAAIQ,IAAwB,MAAVR,EAAIS,IAAwB,MAAVT,EAAIU,GAC7H,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMN,EAAO,wBAA2B,CACpChjE,EAAG8hE,GAAsBc,EAAI5iE,GAC7BgR,EAAG8wD,GAAsBc,EAAI5xD,GAC7BszB,EAAGw9B,GAAsBc,EAAIt+B,GAC7BxhC,EAAGg/D,GAAsBc,EAAI9/D,GAC7B8hD,EAAGkd,GAAsBc,EAAIhe,GAC7B2e,GAAIzB,GAAsBc,EAAIQ,IAC9BI,GAAI1B,GAAsBc,EAAIS,IAC9BI,KAAM3B,GAAsBc,EAAIU,MAEpC,OAAO,GAAqB,cAAiBN,GAAMC,WAAY,QACnE,CDoBe,CAAwB17D,KAAK4+C,KACxC,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,UAC5B,GAAe,WAAXA,EAAqB,CACrB,MAAMjY,EAAS,IAAI,mBAAsBqJ,KAAK45D,WACxC6B,EAAO,gBAAmB9kE,GAC1Bg3D,EAAa,0BAA6B8N,GAC1CrtD,EAAU,CACZgqD,UAAW,SACX9mD,MAAO,IACP6qD,SAAU,GACVC,aAAc,UAElB,OAAO,4BAA+BzO,EAAYuK,EAAU9pD,EAChE,CACK,GAAe,eAAXQ,EACL,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG3Q,eAAeo+D,GAAuB94D,GACzC,MAAM83D,ECxGH,SAAoB93D,GACvB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpDoqD,EAAa,0BAA6B8N,GAEhD,MAAO,CACHzD,IAAK,MACLv/D,EAAG6hE,GAA0B3M,EAAWl1D,GACxCgR,EAAG6wD,GAA0B3M,EAAWlkD,GACxCszB,EAAGu9B,GAA0B3M,EAAW5wB,GACxCxhC,EAAG++D,GAA0B3M,EAAWpyD,GACxC8hD,EAAGid,GAA0B3M,EAAWtQ,GACxCwe,GAAIvB,GAA0B3M,EAAWqO,IACzCF,GAAIxB,GAA0B3M,EAAWsO,IACzCF,GAAIzB,GAA0B3M,EAAWuO,MACzCpE,IAAK,QAEb,CDwFgB,CAAwBv0D,GACpC,GAAI,GAAe83D,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAIM,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACO,SAASknC,GAAsB/4D,GAClC,MAAM83D,EC7EH,SAAmB93D,GACtB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpD6xB,EAAY,yBAA4BqmC,GAC9C,MAAO,CACHzD,IAAK,MACLv/D,EAAG6hE,GAA0BllC,EAAU38B,GACvCgR,EAAG6wD,GAA0BllC,EAAU3rB,GAE/C,CDqEgB,CAAuBlG,GACnC,GAAI,GAAe83D,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,OAAO,IAAIC,GAAaF,EAC5B,CACOp9D,eAAes+D,GAAQlB,GAC1B,GAAI,GAAeA,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAIM,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACOn3B,eAAe,GAAgBsE,GAClC,GAAIA,EAAO+4D,GACP,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QDlIHxJ,eAA2BsE,GAC9B,MAAMsmD,QAAa,SAAgB6L,OAAO8H,YAAY,CAClDn9D,KAAM,oBACNo9D,cAAel6D,EACfm6D,eAAgB,IAAIliE,WAAW,CAAC,EAAM,EAAM,IAC5C8E,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,OAAQ,WACZoI,QAAamzD,GAAU/R,GAC7B,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CCsHuB,CAAmBlF,GACtC,OAAO,IAAIo5D,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,iBE3FO,SAASunC,GAAkBxuD,GAC9B,IACI,8BAA6BA,EACjC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,yBACrC,CACJ,CCjDO,MAAMg3D,GACThe,KACA9+C,YAAYqO,GACR,GAAyBA,GACzBnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODUDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,IACI,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,OAAO,aAAYqP,EAAK+zB,EAAQl8C,EACpC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CClBe,CAAqB5F,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,ODgB0BzrD,EChBMnO,KAAK4+C,KDiB3B,8BAA6BzwC,GAAK0uD,YAAW,GADxD,IAA2B1uD,CCf9B,CACI5K,YACA,OAAO,UAA8B,CACjCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMu5D,GACTle,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,GDmBnB,SAA0Bu4B,GAC7B,IACI,OAAO,mBAAkBA,GAAY,EACzC,CACA,MAAO/nD,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CC1BuC,CAAwBuI,GDGxD,SAA4BA,GAC/B,IACI,mBAAkBA,GAAK,EAC3B,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CCTQ,CAA0B5F,KAAK4+C,MAC/B,GAAyB5+C,KAAK85D,WAClC,CACA77D,WAAW4J,GACP,ODhCD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,IAEI,OADkB,WAAUojC,EAAQl8C,GACnB4uD,eACrB,CACA,MAAOn3D,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CCuBe,CAAmB5F,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAI6C,GAAmB58D,KAAK85D,WACvC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAA+B,CAClCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAASouD,GAA6Bz5D,GACzC,OAAO,IAAIu5D,GAAoBv5D,EACnC,CACO,SAAS05D,GAA4B15D,GACxC,OAAO,IAAIq5D,GAAmBr5D,EAClC,CACOtF,eAAe,KAClB,MAAMg8D,EDxFC,+BCyFP,OAAO,IAAI6C,GAAoB7C,EACnC,CChFO,MAAMiD,GAAgB,CACzBC,IAAK,EACLC,QAAS,EACTC,UAAW,GAEf,SAASC,GAAepuD,GACpB,MAAMquD,EAAY7+D,OAAO+I,KAAKy1D,IAAevlE,KAAK,OAClD,OAAO,IAAI,MAAU,mCAAmCuX,cAAiBquD,IAAa,2BAC1F,CA4COt/D,eAAe,GAAoBlD,GACtC,MAAMyiE,EAAU,UAA0BziE,GACpC0hB,EAAO+gD,EAAQ/D,MAAQ,IAAIj/D,WACjC,OAAQgjE,EAAQviE,MACZ,KAAK,OACD,OAAOiiE,GAAcC,IAAId,uBAAuB5/C,GACpD,KAAK,WACD,OAAOygD,GAAcE,QAAQpD,2BAA2Bv9C,GAC5D,KAAK,aACD,OAAOygD,GAAcG,UAAUL,6BAA6BvgD,GAChE,QACI,MAAM6gD,GAAeE,EAAQviE,MAAQ,OAEjD,gBCxEA,MAAMgmB,GAAUzqB,OAAOkqD,IAAI,8BACrB+c,GAAc/+D,OACf/C,OAAOq7D,IACPp8C,KAAI+7C,GAASA,EAAMpG,UAEnBnhC,QAAO,CAACtd,EAAK5S,IAAS4S,EAAIw+C,GAAGpxD,IAAO83D,GAAMlE,SAASvC,SAElDmN,GAAkB,IAClBC,GAAwC,GACxCC,GAAyC,GAC/C,MAAMC,GACF3uD,KACAqlD,UACA5G,WACAv4B,UACA1xB,OACA5D,YAAYs7B,GACRp7B,KAAKkP,KAAOksB,EAAKlsB,KACjBlP,KAAKu0D,UAAYn5B,EAAKm5B,UACtBv0D,KAAK2tD,WAAavyB,EAAKuyB,WAEvBjvD,OAAO2B,eAAeL,KAAM,SAAU,CAClCY,YAAY,EACZV,UAAU,GAElB,CACY41D,IAAPt/D,OAAOs/D,eACR,MAAO,UAAU91D,KAAK2E,aAC1B,CACA,CAAC,OAAU,EACXA,WAII,OAHmB,MAAf3E,KAAK0D,SACL1D,KAAK0D,OAAS8uD,GAAUzjD,OAAO/O,KAAKu0D,UAAUhxD,OAAOzK,MAAM,IAExDkH,KAAK0D,MAChB,CAGAo6D,QACI,OAAO5I,GAAIO,SAASiI,GAAiB19D,KAAKu0D,UAC9C,CACAvK,UACI,OAAOhqD,KAAKu0D,UAAUhxD,KAC1B,CAIAie,SACI,OAAOxhB,KAAK2E,UAChB,CAIAqc,OAAOpnB,GACH,GAAIA,aAAcY,WACd,OAAO,GAAiBwF,KAAKu0D,UAAUhxD,MAAO3J,GAE7C,GAAkB,iBAAPA,EACZ,OAyEL,SAA0ByB,EAAKk1D,GAElC,GADAA,EAAUA,GAAWkN,GACC,MAAlBpiE,EAAIiP,OAAO,IAAgC,MAAlBjP,EAAIiP,OAAO,GAAY,CAGhD,MAAMiqD,EAAY,GAAc/B,GAAUpmD,OAAO,IAAI/Q,MACrD,OAAIA,EAAI0iE,WAAW,OACR,IAAIC,GAAkB,CAAEzJ,cAE1Bl5D,EAAI0iE,WAAW,OACb,IAAIE,GAAoB,CAAE1J,cAG1B,IAAI2J,GAAc,CAAE3J,aAEnC,CACA,OAEG,SAAyBx5D,GAC5B,IACI,MAAMw5D,EAAY,GAAcx5D,GAChC,GAAIw5D,EAAUlmD,OAAS,QAAe,CAClC,GAAIkmD,EAAUlK,OAAOpzD,SAAW0mE,GAC5B,OAAO,IAAIK,GAAkB,CAAEzJ,cAE9B,GAAIA,EAAUlK,OAAOpzD,SAAW2mE,GACjC,OAAO,IAAIK,GAAoB,CAAE1J,aAEzC,CACA,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI6vD,GAAc,CAAE3J,aAEnC,CACA,MACI,OAID,SAAuBU,GAC1B,GAAW,MAAPA,GAAgC,MAAjBA,EAAIV,WAAoC,MAAfU,EAAI/rC,SAAoC,IAAhB+rC,EAAI/rC,SAAiB+rC,EAAI5mD,OAASqvD,GAClG,MAAM,IAAInlE,MAAM,kCAEpB,MAAMg8D,EAAYU,EAAIV,UACtB,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI6vD,GAAc,CAAE3J,UAAWU,EAAIV,YAEzC,GAAIA,EAAUlmD,OAAS,QAAe,CACvC,GAAIkmD,EAAUlK,OAAOpzD,SAAW0mE,GAC5B,OAAO,IAAIK,GAAkB,CAAEzJ,UAAWU,EAAIV,YAE7C,GAAIA,EAAUlK,OAAOpzD,SAAW2mE,GACjC,OAAO,IAAIK,GAAoB,CAAE1J,UAAWU,EAAIV,WAExD,CACA,MAAM,IAAIh8D,MAAM,iCACpB,CArBe4lE,CAAcjJ,GAAI9oD,OAAOrR,GACpC,CACA,MAAM,IAAIxC,MAAM,iCACpB,CArBW6lE,CAAgBX,GAAYrxD,OAAO/Q,GAC9C,CA1FmBgjE,CAAiBzkE,GAAIonB,OAAOhhB,MAElC,GAA4B,MAAxBpG,GAAI26D,WAAWhxD,MACpB,OAAO,GAAiBvD,KAAKu0D,UAAUhxD,MAAO3J,EAAG26D,UAAUhxD,OAG3D,MAAM,IAAIhL,MAAM,eAExB,CAaA,CAAC0oB,MACG,MAAO,UAAUjhB,KAAK2E,aAC1B,EAEJ,MAAMu5D,WAAsBL,GACxB3uD,KAAO,MACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,QACvBlP,KAAKo1B,UAAYgG,EAAKhG,SAC1B,EAEJ,MAAM4oC,WAA0BH,GAC5B3uD,KAAO,UACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,YACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EAEJ,MAAM4T,WAA4BJ,GAC9B3uD,KAAO,YACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,cACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EAsFGpsD,eAAeqgE,GAAelpC,EAAWu4B,GAC5C,OAAIv4B,EAAUn+B,SAAW0mE,GACd,IAAIK,GAAkB,CAAEzJ,UAAW,GAAc,QAAen/B,GAAYu4B,eAEnFv4B,EAAUn+B,SAAW2mE,GACd,IAAIK,GAAoB,CAAE1J,UAAW,GAAc,QAAen/B,GAAYu4B,eAElF,IAAIuQ,GAAc,CAAE3J,gBAAiB,UAAcn/B,GAAYA,YAAWu4B,cACrF,CC1MO,IAAI4Q,GA8CAC,GC/CJvgE,eAAewgE,GAAWC,EAAWC,EAAiBC,GACzD,MAAMC,QAaH5gE,eAA2B6gE,EAAQ1pB,GACtC,GAAyB,MAArB0pB,EAAOnR,WACP,MAAM,IAAIp1D,MAAM,sCAGpB,aADyB,GAAoBumE,EAAOnR,aAClCpnD,KAAK6uC,EAC3B,CAnBgC2pB,CAAYL,EAAWM,GAAoBL,IACvE,GAA2B,MAAvBD,EAAUtpC,UACV,MAAM,IAAI78B,MAAM,2CAEpB,OAEG,SAAgC0mE,EAAiBJ,EAAeD,GACnE,OAAOJ,GAAsBzvD,OAAO,CAChCmwD,YAAaD,EACbE,YAAaN,EACbD,WAAYA,GAAc,CAAEQ,uBAAwB,MACrD9nE,UACP,CARW+nE,CAAuBX,EAAUtpC,UAAWypC,EAAeD,EACtE,CAeO3gE,eAAeqhE,GAAqBlqB,GACvC,OAAOkpB,GAAelpB,EAAQ8pB,YAClC,CACO,SAASK,GAAcnqB,GAC1B,OAAOopB,GAAsBpyD,OAAOgpC,EACxC,CACO,SAAS4pB,GAAoB5pC,GAChC,MAAM5b,EAAS,GAAqB,4BACpC,OAAO,GAAiB,CAACA,EAAQ4b,GAAY5b,EAAOviB,OAASm+B,EAAUn+B,OAC3E,CASOgH,eAAeuhE,GAAoBC,EAAgBrqB,EAASsqB,GAE/D,MAAMC,QAAsBrB,GAAelpB,EAAQ8pB,aACnD,IAAKS,EAAc3+C,OAAO0+C,GACtB,MAAM,IAAInnE,MAAM,wBAAwBonE,EAAch7D,kDAAkD+6D,EAAW/6D,cAEvH,MAAMi7D,EAAmBZ,GAAoBS,GAC7C,GAA+B,MAA3BE,EAAcvqC,UACd,MAAM,IAAI78B,MAAM,qCAEpB,GAA2B,MAAvB68C,EAAQ+pB,YACR,MAAM,IAAI5mE,MAAM,sCAEpB,MAAM68B,EHXH,SAA4Br6B,GAC/B,MAAMyiE,EAAU,UAAyBziE,GACnC0hB,EAAO+gD,EAAQ/D,MAAQ,IAAIj/D,WACjC,OAAQgjE,EAAQviE,MACZ,KAAK,OACD,OAAOiiE,GAAcC,IAAIb,sBAAsB7/C,GACnD,KAAK,WACD,OAAOygD,GAAcE,QAAQjD,0BAA0B19C,GAC3D,KAAK,aACD,OAAOygD,GAAcG,UAAUJ,4BAA4BxgD,GAC/D,QACI,MAAM6gD,GAAeE,EAAQviE,MAAQ,WAEjD,CGFsB,CAAmB0kE,EAAcvqC,WAEnD,UADoBA,EAAUomC,OAAOoE,EAAkBxqB,EAAQ+pB,aAE3D,MAAM,IAAI5mE,MAAM,yDAEpB,OAAOonE,CACX,CACO,SAASE,GAAiBC,GAC7B,OAAMA,aAActlE,YAGF,KAAdslE,EAAG7oE,MAIX,EDjEA,SAAWsnE,GACP,IAAIhF,EACJgF,EAAgB5H,MAAQ,KACN,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,KAI9B,IAH6B,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAE4B,MAA9BhD,EAAI81D,uBACJ,IAAK,MAAMvgE,KAASyK,EAAI81D,uBACpBn/B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM1E,IAGa,IAAzBkzC,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CACR81D,uBAAwB,IAEtBz8D,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,GAAQuwB,IAAQ,GACP,EACD/pB,EAAI81D,uBAAuB1nE,KAAKoK,EAAOyB,cAGvCzB,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXgF,EAAgBxvD,OAAUzF,IACf,SAAcA,EAAKi1D,EAAgB5H,SAE9C4H,EAAgBnyD,OAAUrR,IACf,SAAcA,EAAKwjE,EAAgB5H,QAEjD,CA5CD,CA4CG4H,KAAoBA,GAAkB,CAAC,IAE1C,SAAWC,GACP,IAAIjF,EACJiF,EAAsB7H,MAAQ,KACZ,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,SAEqB,IAAvBylC,EAAKguB,eAA8C,MAAnBz2D,EAAI41D,aAAuB51D,EAAI41D,YAAYryD,WAAa,KACxFozB,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAI41D,aAAe,IAAI1kE,WAAW,OAEnB,IAAvBu3C,EAAKguB,eAA8C,MAAnBz2D,EAAI61D,aAAuB71D,EAAI61D,YAAYtyD,WAAa,KACxFozB,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAI61D,aAAe,IAAI3kE,WAAW,KAExB,MAAlB8O,EAAIs1D,aACJ3+B,EAAEn9B,OAAO,IACTy7D,GAAgB5H,QAAQ5nD,OAAOzF,EAAIs1D,WAAY3+B,EAAG,CAC9C8/B,eAAe,MAGM,IAAzBhuB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CACR41D,YAAa,IAAI1kE,WAAW,GAC5B2kE,YAAa,IAAI3kE,WAAW,IAE1BmI,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAI41D,YAAcp9D,EAAOyB,QACzB,MACJ,KAAK,EACD+F,EAAI61D,YAAcr9D,EAAOyB,QACzB,MACJ,KAAK,EACD+F,EAAIs1D,WAAaL,GAAgB5H,QAAQvqD,OAAOtK,EAAQA,EAAOgB,UAC/D,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXiF,EAAsBzvD,OAAUzF,IACrB,SAAcA,EAAKk1D,EAAsB7H,SAEpD6H,EAAsBpyD,OAAUrR,IACrB,SAAcA,EAAKyjE,EAAsB7H,QAEvD,CA3DD,CA2DG6H,KAA0BA,GAAwB,CAAC,oBE3GtD,gBAAsBjtC,GACN,MAALA,EAAY,YAAcihC,GAAUvC,WAAW1+B,GAG1D,gBAAsBA,GACN,MAALA,EAAY,YAAcsgC,GAAO5B,WAAW1+B,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAc,cAAkBA,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WC3BvC,MAAMhM,GDwCC,SAAgB0G,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAKpC,OAHI,WAAc,GAAGA,YAAuF,MAAtE,cAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,GAAM,GAAG6G,YAEdX,OAAO6W,OAAO,GAAMlW,GAAO,CAC9B+gB,MAAO,GAAM,GAAG/gB,WAChB7G,SAER,CCnDYwnE,CAAO,gBAEnB,IAAIG,GAeG,SAASC,GAAsB32D,GAC9BA,GACA02D,GAAU,8BAA8B,GAAmB12D,EAAE2rB,UAAW,UACxE+qC,GAAU,+BAA+B,GAAmB12D,EAAEkkD,WAAY,WAG1EwS,GAAU,gCAElB,CAIO,SAASE,GAAsBC,GAClCH,GAAU,+BAA+B,GAAmBG,EAAI,SACpE,CA3BIH,GADAjX,EACYvwD,GAGA+F,OAAO6W,QAAO,QAAW,CACjCutB,SAAS,EACTtqC,MAAO,OACP4nB,MAAO,SCAR,MAAMmgD,GACT9nE,EACA8K,MACA3H,KACAkE,YAAYrH,EAjBS,GAkBjBuH,KAAKvH,EAAIA,EACTuH,KAAKuD,MAAQ,IAAI/I,WAAW,IAC5BwF,KAAKpE,KAAO,IAAI+9B,SAAS35B,KAAKuD,MAAM5M,OAAQqJ,KAAKuD,MAAM2Y,WAAYlc,KAAKuD,MAAMsJ,YAC9E7M,KAAKpE,KAAKqwD,UAAU,EAAGxzD,GAAG,EAC9B,CACA+nE,YACIxgE,KAAKvH,IAELuH,KAAKpE,KAAKqwD,UAAU,EAAGjsD,KAAKvH,GAAG,EACnC,CACAijE,WACI,OAAO17D,KAAKuD,KAChB,CACAk9D,YACI,OAAOzgE,KAAKvH,CAChB,CACAioE,cACI,GAAI1gE,KAAKvH,EA5BQ,WA6Bb,MAAM,IAAIF,MA5BA,uEA8BlB,ECjCG,MAAMooE,GACT/rB,OACA90C,YAAY80C,GACR50C,KAAK40C,OAASA,CAClB,CACAgsB,cAAcC,EAAI3S,EAAIF,GAClB,MAAMvkD,EAAIzJ,KAAKouD,QAAQyS,EAAG3tD,EAAG2tD,EAAGpoE,EAAGy1D,EAAIF,GAEvC,OADA6S,EAAGpoE,EAAE+nE,YACE/2D,CACX,CACAq3D,cAAcD,EAAI3S,EAAII,EAAYhnD,GAC9B,MAAM,UAAE0mD,EAAS,MAAE+S,GAAU/gE,KAAKuuD,QAAQsS,EAAG3tD,EAAG2tD,EAAGpoE,EAAGy1D,EAAII,EAAYhnD,GAGtE,OAFIy5D,GACAF,EAAGpoE,EAAE+nE,YACF,CAAExS,YAAW+S,QACxB,CAEAC,OAAOH,GACH,OAAQ7gE,KAAKihE,WAAWJ,EAAG3tD,EAC/B,CACAguD,iBACI,OAAO,IAAI1mE,WAAW,GAC1B,CACAymE,WAAW/tD,GAEP,OAAO,GADUlT,KAAKkhE,iBACYhuD,EACtC,CACAk7C,QAAQl7C,EAAGza,EAAGy1D,EAAIF,GAEd,OADAv1D,EAAEioE,cACK1gE,KAAK40C,OAAOmZ,wBAAwBC,EAAWv1D,EAAEijE,WAAYxN,EAAIh7C,EAC5E,CACAiuD,eAAe7hC,EAAI0uB,GACf,IAAIM,EAQJ,OANIA,EADAtuD,KAAKghE,OAAO1hC,EAAGuhC,IACF7gE,KAAK4gE,cAActhC,EAAGuhC,GAAIvhC,EAAGJ,EAAG8uB,GAGhCA,EAEjBhuD,KAAKohE,QAAQ9hC,EAAIgvB,GACVA,CACX,CACAC,QAAQr7C,EAAGza,EAAGy1D,EAAII,EAAYhnD,GAC1B7O,EAAEioE,cACF,MAAMW,EAAmBrhE,KAAK40C,OAAOyZ,wBAAwBC,EAAY71D,EAAEijE,WAAYxN,EAAIh7C,EAAG5L,GAC9F,OAAI+5D,EACO,CACHrT,UAAWqT,EACXN,OAAO,GAIJ,CACH/S,UAAW,IAAIxzD,WAAW,GAC1BumE,OAAO,EAGnB,CACAO,eAAehiC,EAAIgvB,GACf,IAAIN,EACA+S,GAAQ,EAQZ,OAPI/gE,KAAKghE,OAAO1hC,EAAGuhC,MACZ7S,YAAW+S,SAAU/gE,KAAK8gE,cAAcxhC,EAAGuhC,GAAIvhC,EAAGJ,EAAGovB,IAGxDN,EAAYM,EAEhBtuD,KAAKohE,QAAQ9hC,EAAIgvB,GACV,CAAEN,YAAW+S,QACxB,CACAQ,GAAG5T,EAAYv4B,GACX,IACI,MAAMosC,EAAYxhE,KAAK40C,OAAOkZ,wBAAwBH,EAAYv4B,GAClE,OAAyB,KAArBosC,EAAUvqE,OACHuqE,EAEJA,EAAUlqE,SAAS,EAAG,GACjC,CACA,MAAOmS,GACH,MAAM7D,EAAM6D,EAEZ,OADA9Q,GAAA,MAAaiN,GACN,IAAIpL,WAAW,GAC1B,CACJ,CACA4mE,QAAQ9hC,EAAI7iB,GACR6iB,EAAGJ,EAAIl/B,KAAKyhE,QAAQniC,EAAGJ,EAAGziB,EAC9B,CACAglD,QAAQhhD,EAAGnE,GAEP,OADUtc,KAAK40C,OAAO0Y,WAAW,GAAiB,CAAC7sC,EAAGnE,GAAImE,EAAExpB,OAASqlB,EAAErlB,QAE3E,CACAyqE,OAAOpiC,EAAIsrB,GACP,MAAO4C,EAAImU,GAAS3hE,KAAK40C,OAAO2Y,QAAQjuB,EAAGkuB,GAAI5C,GAC/CtrB,EAAGuhC,GAAK7gE,KAAK4hE,cAAcD,GAC3BriC,EAAGkuB,GAAKA,CACZ,CACAoU,cAAc1uD,GACV,MAAO,CAAEA,IAAGza,EAAG,IAAI8nE,GACvB,CAEAsB,oBAAoBC,GAChB,MAAMC,EAAoB,GAAqBD,EAAc,SACvD5iC,EAAIl/B,KAAKgiE,iBAAiBD,GAC1BvU,EAAKtuB,EACL/wB,EAAMnO,KAAKkhE,iBAEjB,MAAO,CAAEL,GADE7gE,KAAK4hE,cAAczzD,GACjBq/C,KAAItuB,IACrB,CACA8iC,iBAAiBF,GACb,GAAIA,EAAa7qE,QAAU,GAAI,CAC3B,MAAMioC,EAAI,IAAI1kC,WAAW,IAEzB,OADA0kC,EAAErjC,IAAIimE,GACC5iC,CACX,CAEI,OAAOl/B,KAAKyhE,QAAQK,EAAc,IAAItnE,WAAW,GAEzD,CACAyE,MAAMqgC,GACF,MAAO2iC,EAAQC,GAAUliE,KAAK40C,OAAO2Y,QAAQjuB,EAAGkuB,GAAI,IAAIhzD,WAAW,IAGnE,MAAO,CAAE2nE,IAFGniE,KAAK4hE,cAAcK,GAEjBG,IADFpiE,KAAK4hE,cAAcM,GAEnC,CACAG,oBAAoBxB,EAAIzrB,GACpB,MAAMkZ,EAAatuD,KAAK4gE,cAAcC,EAAI,IAAIrmE,WAAW,GAAI46C,GAG7D,MAAO,CAAEktB,GAFEtiE,KAAKkhE,iBAEHqB,GADF,IAAI/nE,WAAW,GACT8zD,aACrB,CACAkU,mBAAmB3B,EAAIh5D,GACnB,OAAO7H,KAAK8gE,cAAcD,EAAI,IAAIrmE,WAAW,GAAIqN,EAAQymD,WAC7D,ECvIG,MAAMmU,WAAW9B,GACpB+B,oBAAoBC,EAAU31C,EAAG41C,EAAIC,GACjC,MACMvjC,EAAKt/B,KAAK6hE,oBADH,oCAEb7hE,KAAKohE,QAAQ9hC,EAAIqjC,GAEjB,MAAO,CAAErjC,KAAItS,IAAG41C,KAAIC,MAAKvC,GADd,IAAI9lE,WAAW,IAE9B,CACAsoE,oBAAoBH,EAAU31C,EAAG41C,EAAIC,GACjC,MACMvjC,EAAKt/B,KAAK6hE,oBADH,oCAEb7hE,KAAKohE,QAAQ9hC,EAAIqjC,GAEjB,MAAO,CAAErjC,KAAItS,IAAG41C,KAAIC,MAAKvC,GADd,IAAI9lE,WAAW,IAE9B,CACAuoE,cAAcC,EAAI5tB,EAAS3rC,GACvB,MAAM84D,EAAK,IAAI/nE,WAAW,GAEtBwoE,EAAGv5D,OADG/B,IAAN+B,EACOA,EAGAzJ,KAAK40C,OAAO6Y,wBAEvB,MAAM6U,EAAKU,EAAGv5D,EAAE2rB,UAChBp1B,KAAKohE,QAAQ4B,EAAG1jC,GAAIgjC,GAEpB,MAAO,CAAEA,KAAIC,KAAIjU,WADEtuD,KAAKmhE,eAAe6B,EAAG1jC,GAAI8V,GAElD,CACA6tB,cAAcD,EAAI5tB,GACd4tB,EAAGv5D,EAAIzJ,KAAK40C,OAAO6Y,wBACnB,MAAM6U,EAAKU,EAAGv5D,EAAE2rB,UAChBp1B,KAAKohE,QAAQ4B,EAAG1jC,GAAIgjC,GACpBtiE,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGv5D,EAAEkkD,WAAYqV,EAAG1C,KAC/C,MAAM4C,EAAMF,EAAGh2C,EAAEoI,UACXmtC,EAAKviE,KAAKmhE,eAAe6B,EAAG1jC,GAAI4jC,GACtCljE,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGh2C,EAAE2gC,WAAYqV,EAAG1C,KAE/C,MAAO,CAAEgC,KAAIC,KAAIjU,WADEtuD,KAAKmhE,eAAe6B,EAAG1jC,GAAI8V,GAElD,CACA+tB,cAAcH,EAAI5tB,GACd,MAAM8tB,EAAMF,EAAGh2C,EAAEoI,UACXmtC,EAAKviE,KAAKmhE,eAAe6B,EAAG1jC,GAAI4jC,GACtCljE,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGh2C,EAAE2gC,WAAYqV,EAAG1C,KAC/C,MAAMhS,EAAatuD,KAAKmhE,eAAe6B,EAAG1jC,GAAI8V,GAExCguB,EAAgB,CAAEd,GADbtiE,KAAKkhE,iBACYqB,KAAIjU,eAC1B,IAAE6T,EAAG,IAAEC,GAAQpiE,KAAKf,MAAM+jE,EAAG1jC,IACnC,MAAO,CAAEJ,EAAG8jC,EAAG1jC,GAAGJ,EAAGkkC,gBAAejB,MAAKC,MAC7C,CACAiB,aAAaL,EAAIn7D,GAKb,OAJIg4D,GAAiBh4D,EAAQy6D,MACzBU,EAAG1C,GAAKz4D,EAAQy6D,IAEpBtiE,KAAKohE,QAAQ4B,EAAG1jC,GAAI0jC,EAAG1C,IAChBtgE,KAAKshE,eAAe0B,EAAG1jC,GAAIz3B,EAAQymD,WAC9C,CACAgV,aAAaN,EAAIn7D,GAKb,GAJIg4D,GAAiBh4D,EAAQy6D,MACzBU,EAAG1C,GAAKz4D,EAAQy6D,IAEpBtiE,KAAKohE,QAAQ4B,EAAG1jC,GAAI0jC,EAAG1C,KAClB0C,EAAGv5D,EACJ,MAAM,IAAIlR,MAAM,yCAEpByH,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGv5D,EAAEkkD,WAAYqV,EAAG1C,KAC/C,MAAQtS,UAAWuU,EAAIxB,MAAOwC,GAAWvjE,KAAKshE,eAAe0B,EAAG1jC,GAAIz3B,EAAQ06D,IACxEgB,GAAU1D,GAAiB0C,KAC3BS,EAAGJ,GAAKL,GAEZviE,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGv5D,EAAEkkD,WAAYqV,EAAGJ,KAC/C,MAAM,UAAE5U,EAAW+S,MAAOyC,GAAWxjE,KAAKshE,eAAe0B,EAAG1jC,GAAIz3B,EAAQymD,YACxE,MAAO,CAAEN,YAAW+S,MAAQwC,GAAUC,EAC1C,CACAC,aAAaT,EAAIn7D,GACb,MAAQmmD,UAAWuU,EAAIxB,MAAOwC,GAAWvjE,KAAKshE,eAAe0B,EAAG1jC,GAAIz3B,EAAQ06D,IAI5E,GAHIgB,GAAU1D,GAAiB0C,KAC3BS,EAAGJ,GAAKL,IAEPS,EAAGv5D,EACJ,MAAM,IAAIlR,MAAM,yCAEpByH,KAAK0hE,OAAOsB,EAAG1jC,GAAIt/B,KAAKuhE,GAAGyB,EAAGv5D,EAAEkkD,WAAYqV,EAAGJ,KAC/C,MAAM,UAAE5U,EAAW+S,MAAOyC,GAAWxjE,KAAKshE,eAAe0B,EAAG1jC,GAAIz3B,EAAQymD,aAClE,IAAE6T,EAAG,IAAEC,GAAQpiE,KAAKf,MAAM+jE,EAAG1jC,IACnC,MAAO,CAAEJ,EAAG8jC,EAAG1jC,GAAGJ,EAAG8uB,YAAW+S,MAAQwC,GAAUC,EAASrB,MAAKC,MACpE,CACAsB,YAAYC,EAAWhB,EAAU31C,GAC7B,MAAM61C,EAAM7iE,KAAKkhE,iBACX0B,EAAK,IAAIpoE,WAAW,IAC1B,IAAIwoE,EAOJ,OALIA,EADAW,EACK3jE,KAAK0iE,oBAAoBC,EAAU31C,EAAG41C,EAAIC,GAG1C7iE,KAAK8iE,oBAAoBH,EAAU31C,EAAG41C,EAAIC,GAE5C,CACHG,KACA1nE,EAAGqoE,EACHC,GAAI,EAEZ,CACAC,YAAYC,EAASj8D,EAASk8D,GAC1B,IAAIX,EACJ,GAAmB,IAAfU,EAAQF,GACRR,EAAgBpjE,KAAK+iE,cAAce,EAAQd,GAAIn7D,EAASk8D,QAEvD,GAAmB,IAAfD,EAAQF,GACbR,EAAgBpjE,KAAKijE,cAAca,EAAQd,GAAIn7D,QAE9C,GAAmB,IAAfi8D,EAAQF,GAAU,CACvB,MAAM,EAAE1kC,EAAGkkC,cAAeY,EAAe,IAAE7B,EAAG,IAAEC,GAAQpiE,KAAKmjE,cAAcW,EAAQd,GAAIn7D,GACvFu7D,EAAgBY,EAChBF,EAAQ5kC,EAAIA,EACZ4kC,EAAQ3B,IAAMA,EACd2B,EAAQ1B,IAAMA,CAClB,KACK,MAAI0B,EAAQF,GAAK,GAelB,MAAM,IAAIrrE,MAAM,oBAdhB,GAAIurE,EAAQxoE,EAAG,CACX,IAAKwoE,EAAQ3B,IACT,MAAM,IAAI5pE,MAAM,qCAEpB6qE,EAAgBpjE,KAAKqiE,oBAAoByB,EAAQ3B,IAAKt6D,EAC1D,KACK,CACD,IAAKi8D,EAAQ1B,IACT,MAAM,IAAI7pE,MAAM,qCAEpB6qE,EAAgBpjE,KAAKqiE,oBAAoByB,EAAQ1B,IAAKv6D,EAC1D,CAIJ,CAEA,OADAi8D,EAAQF,KACDR,CACX,CACAa,YAAYH,EAASj8D,GACjB,IAAImmD,EAAY,IAAIxzD,WAAW,GAC3BumE,GAAQ,EACZ,GAAmB,IAAf+C,EAAQF,KACL5V,YAAW+S,SAAU/gE,KAAKqjE,aAAaS,EAAQd,GAAIn7D,SAErD,GAAmB,IAAfi8D,EAAQF,KACV5V,YAAW+S,SAAU/gE,KAAKsjE,aAAaQ,EAAQd,GAAIn7D,SAErD,GAAmB,IAAfi8D,EAAQF,GAAU,CACvB,MAAM,EAAE1kC,EAAG8uB,UAAWkW,EAAoBnD,MAAOoD,EAAc,IAAEhC,EAAG,IAAEC,GAAQpiE,KAAKyjE,aAAaK,EAAQd,GAAIn7D,GAC5GmmD,EAAYkW,EACZnD,EAAQoD,EACRL,EAAQ5kC,EAAIA,EACZ4kC,EAAQ3B,IAAMA,EACd2B,EAAQ1B,IAAMA,CAClB,CAEA,OADA0B,EAAQF,KACD,CAAE5V,YAAW+S,QACxB,ECzJG,MAAMqD,GACTC,YACAP,QACApE,WACA4E,iBAAmB,CAAElF,uBAAwB,IAC7ChqB,QACAmvB,WACAC,GACAC,cACA9B,SACA7iE,YAAYukE,EAAajvB,EAASutB,EAAU/tB,EAAQ6vB,EAAeF,EAAY7E,EAAYgF,GACvF1kE,KAAKqkE,YAAcA,EACnBrkE,KAAKo1C,QAAUA,EACfp1C,KAAK2iE,SAAWA,EAChB3iE,KAAKykE,cAAgBA,EACrBzkE,KAAKukE,WAAaA,EACd7E,IACA1/D,KAAK0/D,WAAaA,GAEtB1/D,KAAKwkE,GAAKE,GAAa,IAAIjC,GAAG7tB,GAC9B50C,KAAK8jE,QAAU9jE,KAAKwkE,GAAGd,YAAY1jE,KAAKqkE,YAAarkE,KAAK2iE,SAAU3iE,KAAKykE,cAC7E,CAEAxmE,gBJZG,IAA4B+uB,EhDOXnlB,EoDOhB,GJd2BmlB,EIaRhtB,KAAK8jE,QAAQd,GAAGh2C,EJZvCmzC,GAAU,2BAA2B,GAAmBnzC,EAAEoI,UAAW,UACrE+qC,GAAU,4BAA4B,GAAmBnzC,EAAE2gC,WAAY,UIY/D3tD,KAAKqkE,YAAa,CAClB1rE,GAAA,MAAa,uDACb,MAAMyqE,EAAgBpjE,KAAKwkE,GAAGX,YAAY7jE,KAAK8jE,QAAS,IAAItpE,WAAW,UACjEwF,KAAKukE,WAAWl4D,OpDVVxE,EoDUwBu7D,EpDTrC,GAAiB,CAACv7D,EAAQy6D,GAAIz6D,EAAQymD,YAAazmD,EAAQy6D,GAAGrrE,OAAS4Q,EAAQymD,WAAWr3D,UoDUzF0B,GAAA,MAAa,uDACbynE,GAAsBpgE,KAAK8jE,QAAQd,GAAGv5D,EAC1C,KACK,CACD9Q,GAAA,MAAa,2DACb,MAAMgsE,EpDPX,SAAiB5oE,GACpB,GAAIA,EAAM9E,OAAS,GACf,MAAM,IAAIsB,MAAM,mEAEpB,MAAO,CACH+pE,GAAIvmE,EAAMzE,SAAS,EAAG,IACtBg3D,WAAYvyD,EAAMzE,SAAS,GAAIyE,EAAM9E,QACrCsrE,GAAI,IAAI/nE,WAAW,GAE3B,CoDF0CoqE,QAAe5kE,KAAKukE,WAAW5gE,QAAQrM,aAC/D,MAAEypE,GAAU/gE,KAAKwkE,GAAGP,YAAYjkE,KAAK8jE,QAASa,GACpD,IAAK5D,EACD,MAAM,IAAI,MAA2B,wCAEzCpoE,GAAA,MAAa,+CACb0nE,GAAsBrgE,KAAK8jE,QAAQd,GAAG1C,GAC1C,CACJ,CAEAriE,iBACI,GAAI+B,KAAKqkE,YAAa,CAClB1rE,GAAA,MAAa,0EACb,MAAMgsE,EpDVX,SAAiB5oE,GACpB,GAAIA,EAAM9E,OAAS,GACf,MAAM,IAAIsB,MAAM,mEAEpB,MAAO,CACH+pE,GAAIvmE,EAAMzE,SAAS,EAAG,IACtBirE,GAAIxmE,EAAMzE,SAAS,GAAI,IACvBg3D,WAAYvyD,EAAMzE,SAAS,GAAIyE,EAAM9E,QAE7C,CoDC0C4tE,QAAe7kE,KAAKukE,WAAW5gE,QAAQrM,aAC/D,UAAE02D,EAAS,MAAE+S,GAAU/gE,KAAKwkE,GAAGP,YAAYjkE,KAAK8jE,QAASa,GAC/D,IAAK5D,EACD,MAAM,IAAI,MAA2B,wCAEzCpoE,GAAA,MAAa,6CACb0nE,GAAsBrgE,KAAK8jE,QAAQd,GAAG1C,IJ7BfsC,EI8BJ5iE,KAAK8jE,QAAQd,GAAGJ,GJ7B3CzC,GAAU,4BAA4B,GAAmByC,EAAI,UI8BrDjqE,GAAA,MAAa,kDACb,IACI,MAAMmsE,EAAiBvF,GAAcvR,GACrChuD,KAAK0/D,WAAa1/D,KAAK0/D,kBAAoBJ,GAAqBwF,SAC1DtF,GAAoBx/D,KAAK8jE,QAAQd,GAAGJ,GAAIkC,EAAgB9kE,KAAK0/D,YACnE1/D,KAAK+kE,wBAAwBD,EAAelG,WAChD,CACA,MAAOn1D,GACH,MAAM7D,EAAM6D,EACZ,MAAM,IAAI,MAAoB,kDAAkD7D,EAAIiC,UACxF,CACAlP,GAAA,MAAa,+BACjB,KACK,CACDA,GAAA,MAAa,qFACb,MAAMyqE,EAAgBpjE,KAAKwkE,GAAGX,YAAY7jE,KAAK8jE,QAAS9jE,KAAKo1C,eACvDp1C,KAAKukE,WAAWl4D,OpDlDVxE,EoDkDwBu7D,EpDjDrC,GAAiB,CAACv7D,EAAQy6D,GAAIz6D,EAAQ06D,GAAI16D,EAAQymD,YAAazmD,EAAQy6D,GAAGrrE,OAAS4Q,EAAQ06D,GAAGtrE,OAAS4Q,EAAQymD,WAAWr3D,UoDkDzH0B,GAAA,MAAa,8EACbynE,GAAsBpgE,KAAK8jE,QAAQd,GAAGv5D,EAC1C,CpDrDD,IAAiB5B,EgDGW+6D,CImD/B,CAEA3kE,eACI,GAAI+B,KAAKqkE,YAAa,CAClB1rE,GAAA,MAAa,wDACb,MAAMyqE,EAAgBpjE,KAAKwkE,GAAGX,YAAY7jE,KAAK8jE,QAAS9jE,KAAKo1C,eACvDp1C,KAAKukE,WAAWl4D,OpDzDVxE,EoDyDwBu7D,EpDxDrC,GAAiB,CAACv7D,EAAQ06D,GAAI16D,EAAQymD,YAAazmD,EAAQ06D,GAAGtrE,OAAS4Q,EAAQymD,WAAWr3D,UoDyDzF0B,GAAA,MAAa,wDACjB,KACK,CACDA,GAAA,MAAa,8DACb,MAAMgsE,EpDvCX,SAAiB5oE,GACpB,GAAIA,EAAM9E,OAAS,GACf,MAAM,IAAIsB,MAAM,mEAEpB,MAAO,CACH+pE,GAAI,IAAI9nE,WAAW,GACnB+nE,GAAIxmE,EAAMzE,SAAS,EAAG,IACtBg3D,WAAYvyD,EAAMzE,SAAS,GAAIyE,EAAM9E,QAE7C,CoD8B0C+tE,QAAehlE,KAAKukE,WAAW5gE,QAAQrM,aAC/D,UAAE02D,EAAS,MAAE+S,GAAU/gE,KAAKwkE,GAAGP,YAAYjkE,KAAK8jE,QAASa,GAC/D,IAAK5D,EACD,MAAM,IAAI,MAA2B,wCAEzCpoE,GAAA,MAAa,iEACb,IACI,MAAMmsE,EAAiBvF,GAAcvR,GACrChuD,KAAK0/D,WAAa1/D,KAAK0/D,kBAAoBJ,GAAqBwF,SAC1DtF,GAAoBx/D,KAAK8jE,QAAQd,GAAGJ,GAAIkC,EAAgB9kE,KAAK0/D,YACnE1/D,KAAK+kE,wBAAwBD,EAAelG,WAChD,CACA,MAAOn1D,GACH,MAAM7D,EAAM6D,EACZ,MAAM,IAAI,MAAoB,kDAAkD7D,EAAIiC,UACxF,CACJ,CpD9ED,IAAiBA,EgDMOi8D,KIyER9jE,KAAK8jE,SJxEZ3B,KAAO2B,EAAQ1B,KACvBjC,GAAU,kBAAkB2D,EAAQ3B,IAAI1pE,EAAEgoE,eAAe,GAAmBqD,EAAQ3B,IAAIjvD,EAAG,UAC3FitD,GAAU,kBAAkB2D,EAAQ1B,IAAI3pE,EAAEgoE,eAAe,GAAmBqD,EAAQ1B,IAAIlvD,EAAG,WAG3FitD,GAAU,wBIoEd,CACA/R,QAAQJ,EAAW8V,GACf,MAAMjD,EAAK7gE,KAAKilE,MAAMnB,GACtB,OAAO9jE,KAAKwkE,GAAG5D,cAAcC,EAAI,IAAIrmE,WAAW,GAAIwzD,EACxD,CACAO,QAAQD,EAAYwV,EAASx8D,GACzB,MAAMu5D,EAAK7gE,KAAKilE,MAAMnB,GAAS,GAC/B,OAAO9jE,KAAKwkE,GAAG1D,cAAcD,EAAI,IAAIrmE,WAAW,GAAI8zD,EAAYhnD,EACpE,CACA49D,qBACI,OAAOllE,KAAK8jE,QAAQd,GAAGJ,EAC3B,CACAqC,MAAMnB,EAASqB,GAAa,GACxB,IAAKrB,EAAQ3B,MAAQ2B,EAAQ1B,IACzB,MAAM,IAAI,MAA2B,kEAEzC,OAAIpiE,KAAKqkE,YACEc,EAAarB,EAAQ3B,IAAM2B,EAAQ1B,IAGnC+C,EAAarB,EAAQ1B,IAAM0B,EAAQ3B,GAElD,CACA4C,wBAAwBt7D,GAChBA,IACAzJ,KAAKskE,iBAAmB76D,EAEhC,EC7HG,MAAM27D,GACTC,SAAW,SACXzwB,OACA+tB,SACA2C,WACA1G,WACA2G,QACAzlE,YAAYs7B,EAAO,CAAC,GAChB,MAAM,eAAEoqC,EAAc,WAAE5G,EAAU,OAAEhqB,EAAM,cAAE6wB,EAAa,QAAEF,GAAYnqC,EACvEp7B,KAAK40C,OAASA,GAAUyY,GACxBrtD,KAAK4+D,WAAaA,EAClB5+D,KAAKulE,QAAUA,ECtBhB,SAAyBA,GAC5B,MAAO,CACHG,qBAAsBH,EAAQI,gBAAgB,2CAA4C,CACtFC,KAAM,iDAEVC,kBAAmBN,EAAQI,gBAAgB,uCAAwC,CAC/EC,KAAM,6CAEVE,iBAAkBP,EAAQI,gBAAgB,uCAAwC,CAC9EC,KAAM,wDAEVG,iBAAkBR,EAAQI,gBAAgB,uCAAwC,CAC9EC,KAAM,2CAEVI,cAAeT,EAAQI,gBAAgB,oCAAqC,CACxEC,KAAM,wCAGlB,CDIiCK,CAAgBV,QAAW79D,EAGhD1H,KAAKslE,WAFLE,EAEkBxlE,KAAK40C,OAAOgZ,8BAA8B4X,GAG1CxlE,KAAK40C,OAAO6Y,wBAElCztD,KAAK2iE,SAAW8C,GAAiB,IAAIjrE,WAAW,EACpD,CASAyD,qBAAqBygE,EAAW6F,EAAY7E,GACxC,MAAMwG,GAAoB,OAAS3B,EAAY,CAC3C4B,cAAe3X,GACf4X,cAAe1X,GACf2X,cAAepd,IAEbyb,QAAkB1kE,KAAKsmE,iBAAiB,CAC1C/B,WAAY2B,EACZ7B,aAAa,EACb3F,YACAgB,eAGJ,MAAO,CACHvmB,WAFen5C,KAAKumE,uBAAuBL,EAAmBxB,GAG9DJ,iBAAkBI,EAAUJ,iBAC5B5E,WAAYgF,EAAUhF,WAE9B,CASAzhE,oBAAoBygE,EAAW6F,EAAY7E,GACvC,MAAMwG,GAAoB,OAAS3B,EAAY,CAC3C4B,cAAe3X,GACf4X,cAAe1X,GACf2X,cAAepd,IAEbyb,QAAkB1kE,KAAKsmE,iBAAiB,CAC1C/B,WAAY2B,EACZ7B,aAAa,EACb3F,YACAgB,eAGJ,MAAO,CACHvmB,WAFen5C,KAAKumE,uBAAuBL,EAAmBxB,GAG9DhF,WAAYgF,EAAUhF,WACtB4E,iBAAkBI,EAAUJ,iBAEpC,CAOArmE,uBAAuB00B,GACnB,MAAMyiB,QAAgBqpB,GAAW9rC,EAAO+rC,UAAW1+D,KAAKslE,WAAWlwC,UAAWp1B,KAAK4+D,YAEnF,OAAO5+D,KAAKwmE,mBAAmB7zC,EAAQyiB,EAC3C,CACAn3C,yBAAyB00B,EAAQyiB,GAC7B,MAAM,YAAEivB,EAAW,WAAE3E,EAAU,WAAE6E,GAAe5xC,EAC1C+xC,EAAY,IAAIN,GAAYC,EAAajvB,EAASp1C,KAAK2iE,SAAU3iE,KAAK40C,OAAQ50C,KAAKslE,WAAYf,EAAY7E,GACjH,UACUgF,EAAU+B,gBACV/B,EAAUgC,iBACVhC,EAAU/+D,SAChB3F,KAAKulE,SAASG,qBAAqBlF,WACvC,CACA,MAAO/2D,GAEH,GADAzJ,KAAKulE,SAASM,kBAAkBrF,YAC5B/2D,aAAalR,MAEb,MADAkR,EAAE5B,QAAU,uCAAuC4B,EAAE5B,UAC/C4B,CAEd,CACA,OAAOi7D,CACX,CACAzmE,6BAA6BsmE,EAAYG,GAErC,MAAOiC,EAAQC,GEjHhB,WACH,MAAMnmD,EAAIooC,IACJvsC,EAAIusC,IACV,MAAO,CACH,CACI1qD,OAAQsiB,EAAEtiB,OACV6qD,KAAM1sC,EAAE0sC,MAEZ,CACI7qD,OAAQme,EAAEne,OACV6qD,KAAMvoC,EAAEuoC,MAGpB,CFoG+B6d,GACjBC,EAAUvC,EAAW53B,SAQ3B,aAPM,OAAKg6B,EGnHZ,SAAuBjC,EAAWa,GACrC,OAAOtnE,gBAAiBE,GACpB,UAAW,MAAM4oE,KAAS5oE,EACtB,IAAK,IAAI7C,EAAI,EAAGA,EAAIyrE,EAAM9vE,OAAQqE,GpENQ2tD,MoEMqC,CAC3E,IAAItmD,EAAMrH,EpEP4B2tD,MoEQlCtmD,EAAMokE,EAAM9vE,SACZ0L,EAAMokE,EAAM9vE,QAEhB,MAAMwlB,EAAOioD,EAAUtW,QAAQ2Y,EAAMzvE,SAASgE,EAAGqH,GAAM+hE,EAAUZ,SACjEyB,GAASO,iBAAiBtF,kBACpBhS,GAAe/xC,EAAK5P,kBACpB4P,CACV,CAER,CACJ,CHqGQuqD,CAActC,EAAW1kE,KAAKulE,SAC9BuB,GACC3oE,IAAW,OAAOA,EAAQ,CAAEioE,cAAe1X,MGrG7C,SAAuBgW,EAAWa,GACrC,OAAOtnE,gBAAiBE,GACpB,UAAW,MAAM4oE,KAAS5oE,EACtB,IAAK,IAAI7C,EAAI,EAAGA,EAAIyrE,EAAM9vE,OAAQqE,GAAK2tD,EAA4B,CAC/D,IAAItmD,EAAMrH,EAAI2tD,EAId,GAHItmD,EAAMokE,EAAM9vE,SACZ0L,EAAMokE,EAAM9vE,QAEZ0L,EA3BM,GA2BoBrH,EAC1B,MAAM,IAAI/C,MAAM,iBAEpB,MAAM0uE,EAAYF,EAAMzvE,SAASgE,EAAGqH,GAK9B2E,EAAMy/D,EAAMzvE,SAASgE,EAAGqH,EAnCpB,KAoCFqrD,UAAWkZ,EAAS,MAAEnG,GAAU2D,EAAUnW,QAAQ0Y,EAAWvC,EAAUZ,QAASx8D,GACxF,IAAKy5D,EAED,MADAwE,GAASS,cAAcxF,YACjB,IAAIjoE,MAAM,sCAEpBgtE,GAASQ,iBAAiBvF,kBACpB0G,CACV,CAER,CACJ,CH2EQC,CAAczC,EAAW1kE,KAAKulE,SAC9BoB,GAEOC,CACX,EI7HG,SAASQ,GAAMhsC,EAAO,CAAC,GAC1B,MAAO,IAAM,IAAIgqC,GAAMhqC,EAC3B,iGCsHA,IAIA,EAzHA,SAAewzB,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECzHc,IAAI7E,WAAW,GCiB7B,MAAMw1D,EAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,EAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,EAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,EAAK,CAACI,EAAMC,IAAU,IAAIH,EAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,EAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,EAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,EAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,EAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,EAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,EAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,EAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GD5LG/7B,KACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,ECsLjCyqC,CAAO52B,EAAO0tB,KAC/B,EA4GUi3B,EAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,EAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrCwyD,EAASd,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,ICJFwB,GDOczB,EAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkBD,EAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQD,EAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DUF,EAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,gECDCtf,GDIe4oD,EAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCPUupC,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,KAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICcR,SAASgP,EAAO3gE,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAKpC,OAHI,UAAc,GAAGA,YAAuF,MAAtE,aAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,EAAM,GAAG6G,YAEdX,OAAO6W,OAAO,EAAMlW,GAAO,CAC9B+gB,MAAO,EAAM,GAAG/gB,WAChB7G,SAER,CAjDA,eAAsB+4B,GACN,MAALA,EAAY,YAAcihC,EAAUvC,WAAW1+B,GAG1D,eAAsBA,GACN,MAALA,EAAY,YAAcsgC,EAAO5B,WAAW1+B,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcrpB,EAAO+nD,WAAW1+B,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WC9BhC,MAAM0iE,UAAmB9uE,MAC5BuH,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EC6CG,SAASi5D,EAAgBnpE,EAAQ8pB,EAAQ7Z,GAC5C,MAAM2jC,EAAO3jC,GAAW,CAAC,EACnBwJ,ECpDH,SAAqBtO,GACxB,GAAW,MAAPA,EAAa,CACb,GAAoC,mBAAzBA,EAAI9S,OAAOohB,UAClB,OAAOtO,EAAI9S,OAAOohB,YAEtB,GAAyC,mBAA9BtO,EAAI9S,OAAOgc,eAClB,OAAOlJ,EAAI9S,OAAOgc,iBAEtB,GAAwB,mBAAblJ,EAAI+B,KACX,OAAO/B,CAEf,CACA,MAAM,IAAI/Q,MAAM,0CACpB,CDuCqBgvE,CAAYppE,GA+D7B,OA9DAF,kBACI,IAAIupE,EACJ,MAAMC,EAAe,KACO,MAApBD,GACAA,GAAkB,EAG1B,IADAv/C,EAAOE,iBAAiB,QAASs/C,KACpB,CACT,IAAI7tD,EACJ,IACI,GAAIqO,EAAOG,QAAS,CAChB,MAAM,aAAEs/C,EAAY,UAAEC,GAAc51B,EACpC,MAAM,IAAIs1B,EAAWK,EAAcC,EACvC,CACA,MAAMzvE,EAAQ,IAAIsZ,SAAQ,CAACC,EAASC,KAChC81D,EAAmB,KACf,MAAM,aAAEE,EAAY,UAAEC,GAAc51B,EACpCrgC,EAAO,IAAI21D,EAAWK,EAAcC,GAAW,CAClD,IAGL/tD,QAAepI,QAAQo2D,KAAK,CAAC1vE,EAAO0f,EAASvM,SAC7Cm8D,EAAmB,IACvB,CACA,MAAO5hE,GACHqiB,EAAOC,oBAAoB,QAASu/C,GAEpC,MAAMI,EAA8B,YAAbjiE,EAAIsJ,MAAsB+Y,EAAOG,QAMxD,GALIy/C,GAAmC,MAAhB91B,EAAK/pB,SAExB+pB,EAAK/pB,QAAQ7pB,GAGc,mBAApByZ,EAASuyB,OAChB,IACI,MAAM5uC,EAAIqc,EAASuyB,SACf5uC,aAAaiW,SACbjW,EAAEkyB,OAAM7nB,IACsB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EACvB,GAGZ,CACA,MAAOA,GACuB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EAE3B,CAEJ,GAAIiiE,IAAyC,IAAvB91B,EAAKg2B,cACvB,OAEJ,MAAMniE,CACV,CACA,IAAoB,IAAhBgU,EAAOye,KACP,YAEEze,EAAO/a,KACjB,CACAopB,EAAOC,oBAAoB,QAASu/C,EACxC,CACOO,EACX,2BEnHA,MAAMh5B,EACFr4C,OACAuQ,KACA4nC,IACAC,IACA1jC,KACAvL,YAAY+uC,GACR,KAAMA,EAAM,IAA4B,IAApBA,EAAM,EAAKA,GAC3B,MAAM,IAAIt2C,MAAM,qDAEpByH,KAAKrJ,OAAS,IAAIiC,MAAMi2C,GACxB7uC,KAAKkH,KAAO2nC,EAAM,EAClB7uC,KAAK8uC,IAAM,EACX9uC,KAAK+uC,IAAM,EACX/uC,KAAKqL,KAAO,IAChB,CACA3T,KAAK+kB,GACD,YAA8B/U,IAA1B1H,KAAKrJ,OAAOqJ,KAAK8uC,OAGrB9uC,KAAKrJ,OAAOqJ,KAAK8uC,KAAOryB,EACxBzc,KAAK8uC,IAAO9uC,KAAK8uC,IAAM,EAAK9uC,KAAKkH,MAC1B,EACX,CACA9H,QACI,MAAM5H,EAAOwI,KAAKrJ,OAAOqJ,KAAK+uC,KAC9B,QAAarnC,IAATlQ,EAKJ,OAFAwI,KAAKrJ,OAAOqJ,KAAK+uC,UAAOrnC,EACxB1H,KAAK+uC,IAAO/uC,KAAK+uC,IAAM,EAAK/uC,KAAKkH,KAC1B1P,CACX,CACA6uC,UACI,YAAiC3+B,IAA1B1H,KAAKrJ,OAAOqJ,KAAK+uC,IAC5B,EAEG,MAAMk5B,EACTxwE,KACAo3C,IACApjC,KACAC,KACA5L,YAAYsO,EAAU,CAAC,GACnBpO,KAAK6uC,IAAMzgC,EAAQ85D,YAAc,GACjCloE,KAAKyL,KAAO,IAAIujC,EAAUhvC,KAAK6uC,KAC/B7uC,KAAK0L,KAAO1L,KAAKyL,KACjBzL,KAAKvI,KAAO,CAChB,CACA0wE,cAAc7+D,GACV,OAAuB,MAAnBA,GAAKuD,WACEvD,EAAIuD,WAER,CACX,CACAnV,KAAK0T,GAID,GAHkB,MAAdA,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,SAEnCmB,KAAKyL,KAAK/T,KAAK0T,GAAM,CACtB,MAAM23B,EAAO/iC,KAAKyL,KAClBzL,KAAKyL,KAAOs3B,EAAK13B,KAAO,IAAI2jC,EAAU,EAAIhvC,KAAKyL,KAAK9U,OAAOM,QAC3D+I,KAAKyL,KAAK/T,KAAK0T,EACnB,CACJ,CACAhM,QACI,IAAIgM,EAAMpL,KAAK0L,KAAKtM,QACpB,QAAYsI,IAAR0D,GAAwC,MAAlBpL,KAAK0L,KAAKL,KAAe,CAC/C,MAAMA,EAAOrL,KAAK0L,KAAKL,KACvBrL,KAAK0L,KAAKL,KAAO,KACjBrL,KAAK0L,KAAOL,EACZD,EAAMpL,KAAK0L,KAAKtM,OACpB,CAIA,OAHkB,MAAdgM,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,QAEjCuM,CACX,CACAi7B,UACI,OAAOrmC,KAAKyL,KAAK46B,SACrB,EC9BG,MAAM,UAAmB9tC,MAC5B2W,KACAb,KACAvO,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EA8CJ,SAAS+5D,EAAUC,EAASj6D,GAExB,IAEIk6D,EACAC,EACAC,EAJAC,GADJr6D,EAAUA,GAAW,CAAC,GACFq6D,MAChB9xE,EAAS,IAAIsxE,EAIbS,GAAQ,SACZ,MAiCMC,EAAct9D,GACF,MAAVk9D,EACOA,EAAOl9D,IAElB1U,EAAOe,KAAK2T,GACLi9D,GAUL5wE,EAAQmH,IACV,GAAI2pE,EACA,OAAOF,EAGX,IAA4B,IAAxBl6D,GAASw6D,YAA4C,MAArB/pE,GAAOgO,WACvC,MAAM,IAAItU,MAAM,kEAEpB,OAAOowE,EAAW,CAAEtwC,MAAM,EAAOx5B,SAAQ,EAEvC8D,EAAOiD,GACL4iE,EACOF,GACXE,GAAQ,EACO,MAAP5iE,EAtBQ,CAACA,IACjBjP,EAAS,IAAIsxE,EACC,MAAVM,EACOA,EAAO,CAAEnoD,MAAOxa,KAE3BjP,EAAOe,KAAK,CAAE0oB,MAAOxa,IACd0iE,IAgBgBO,CAAYjjE,GAAO+iE,EAAW,CAAEtwC,MAAM,KAkDjE,GAvCAiwC,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KA3EapN,UACb,IACI,OAAKtH,EAAO0vC,UAGRmiC,EACO,CAAEnwC,MAAM,SAEN,IAAI7mB,SAAQ,CAACC,EAASC,KAC/B62D,EAAUl9D,IACNk9D,EAAS,KACT5xE,EAAOe,KAAK2T,GACZ,IACIoG,EAAQ42D,EAAQ1xE,GACpB,CACA,MAAOiP,GACH8L,EAAO9L,EACX,CACA,OAAO0iE,CAAQ,CAClB,IAhBMD,EAAQ1xE,EAkBvB,CACA,QACQA,EAAO0vC,WAGPtrB,gBAAe,KACX2tD,EAAMj3D,UACNi3D,GAAQ,QAAU,GAG9B,GA6CAv+B,OAZY,KACZxzC,EAAS,IAAIsxE,EACbtlE,IACO,CAAE01B,MAAM,IAUfywC,MARYljE,IACZjD,EAAIiD,GACG,CAAEyyB,MAAM,IAOf3gC,OACAiL,MACIomE,qBACA,OAAOpyE,EAAOc,IAClB,EACAuxE,QAAS/qE,MAAOmQ,IACZ,MAAM6Z,EAAS7Z,GAAS6Z,OAExB,GADAA,GAAQghD,iBACJtyE,EAAO0vC,UACP,OAEJ,IAAI/vB,EACAs1B,EACU,MAAV3jB,IACA3R,EAAS,IAAI9E,SAAQ,CAACC,EAASC,KAC3Bk6B,EAAW,KACPl6B,EAAO,IAAI,EAAa,EAE5BuW,EAAOE,iBAAiB,QAASyjB,EAAS,KAGlD,UACUp6B,QAAQo2D,KAAK,CACfc,EAAMn3D,QACN+E,GAER,CACA,QACoB,MAAZs1B,GAA8B,MAAV3jB,GACpBA,GAAQC,oBAAoB,QAAS0jB,EAE7C,IAGK,MAAT68B,EACA,OAAOH,EAEX,MAAMF,EAAYE,EAmClB,OAlCAA,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KAAI,IACO+8D,EAAU/8D,OAErBy9D,MAAMljE,IACFwiE,EAAUU,MAAMljE,GACH,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB8R,OAAM,KACFi+B,EAAUj+B,SACG,MAATs+B,IACAA,IACAA,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB3gC,OACAiL,IAAIiD,IACAwiE,EAAUzlE,IAAIiD,GACD,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL4gE,GAEPS,qBACA,OAAOX,EAAUW,cACrB,GAEGT,CACX,CCrQO,MAAMY,EAAoB,oBACpBC,EAAuB,uBACvBC,EAAwB,wBACxBC,EAA4B,4BAC5BC,EAA6B,6BAC7BC,EAAmB,mBACnBC,EAA2B,2BAC3BC,EAAkB,IAAI/0D,IAAI,CACnCw0D,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,IAGSE,EAAqB,qBACrBC,EAAyB,yBACzBC,EAA0B,0BAU1BC,EAAwB,OC3BxBC,EAAgB,CACzBnxE,IAAKqnE,EAAO,gBACZ+J,iBAAiB,EACjBC,kBAAmB,IACnBC,kBAAmB,IACnBC,mBAAoB,IACpBC,wBAAyBN,EACzBO,oBDwB6B,SCvB7BC,eAAgB,WCXTC,EAWAC,cAVX,SAAWD,GAEPA,EAAUA,EAAgB,KAAI,GAAK,OAEnCA,EAAUA,EAAwB,aAAI,GAAK,eAE3CA,EAAUA,EAAgB,KAAI,GAAK,OAEnCA,EAAUA,EAAkB,OAAI,GAAK,QACxC,CATD,CASGA,IAAcA,EAAY,CAAC,IAE9B,SAAWC,GAEPA,EAAKA,EAAU,IAAI,GAAK,MAExBA,EAAKA,EAAU,IAAI,GAAK,MAExBA,EAAKA,EAAU,IAAI,GAAK,MAExBA,EAAKA,EAAU,IAAI,GAAK,KAC3B,CATD,CASGA,IAASA,EAAO,CAAC,IACpB,MAAMC,EAAY9rE,OAAO/C,OAAO4uE,GAAMryD,QAAQoB,GAAmB,iBAANA,IAEpD,IAAImxD,GACX,SAAWA,GACPA,EAAWA,EAA8B,kBAAI,GAAK,oBAClDA,EAAWA,EAA0B,cAAI,GAAK,gBAC9CA,EAAWA,EAA0B,cAAI,GAAK,eACjD,CAJD,CAIGA,IAAeA,EAAa,CAAC,IAEzB,SAASC,EAAgBjyC,GAC5B,MAAM4F,EAAQmsC,EAAUtyD,QAAOyyD,IAAMlyC,EAAOmyC,KAAOD,KAAOA,IAAG/vD,KAAI+vD,GAAKJ,EAAKI,KAAIhzE,KAAK,KACpF,MAAO,YAAY8gC,EAAOoyC,iBAAiBP,EAAU7xC,EAAOvpB,cAAcmvB,YAAgB5F,EAAOxhC,QACrG,CC5BA,MAAM6zE,EAAW,GAAK,GAoBf,MAAM,EACT3sE,OAEAxH,OAEAo0E,gBACAjrE,YAAY3B,GASR6B,KAAK7B,OAsEN,SAA0BA,GAC7B,QAAgCuJ,IAA5BvJ,EAAO3H,OAAOohB,UAAyB,CACvC,MAAMA,EAAWzZ,EAAO3H,OAAOohB,YAE/B,OADAA,EAASuyB,YAASziC,EACX,CACH,CAAClR,OAAOohB,UAAS,IAAYA,EAErC,CACK,QAAqClQ,IAAjCvJ,EAAO3H,OAAOgc,eAA8B,CACjD,MAAMoF,EAAWzZ,EAAO3H,OAAOgc,iBAE/B,OADAoF,EAASuyB,YAASziC,EACX,CACH,CAAClR,OAAOgc,eAAc,IAAYoF,EAE1C,CAEI,MAAM,IAAIrf,MAAM,2DAExB,CAxFsByyE,CAAiB7sE,GAC/B6B,KAAKrJ,OAAS,IAAI,IAClBqJ,KAAK+qE,iBAAkB,CAC3B,CAOA9sE,mBACI,UAAW,MAAM8oE,KAAS/mE,KAAK7B,OAI3B,IAHA6B,KAAKrJ,OAAO6hC,OAAOuuC,KAGN,CACT,MAAMtuC,EAASz4B,KAAKirE,aACpB,QAAevjE,IAAX+wB,EACA,MAEJ,MAAM,KAAEvpB,EAAI,OAAEjY,GAAWwhC,EACrBvpB,IAASo7D,EAAU7Q,MAGnBz5D,KAAK+qE,iBAAkB,OACjB,CACFtyC,SACAyyC,SAAUlrE,KAAKmrE,UAAU/uE,KAAK4D,KAAM/I,UAIlC,CAAEwhC,SAEhB,CAER,CACAwyC,aAGI,GAAIjrE,KAAK+qE,gBACL,MAAM,IAAI,KAAU,qCHzDM,0BG2D9B,GAAI/qE,KAAKrJ,OAAOM,ODrDK,GCuDjB,OAEJ,MAAMwhC,EA3EP,SAAsBhc,GACzB,GDUyB,ICVrBA,EAAK,GACL,MAAM,IAAI,KAAU,wBAAyB6sD,GAEjD,MAAO,CACHp6D,KAAMuN,EAAK,GACXmuD,MAAOnuD,EAAK,IAAM,GAAKA,EAAK,GAC5BouD,SAAWpuD,EAAK,GAAKquD,GAAaruD,EAAK,IAAM,KAAOA,EAAK,IAAM,GAAKA,EAAK,GACzExlB,OAASwlB,EAAK,GAAKquD,GAAaruD,EAAK,IAAM,KAAOA,EAAK,KAAO,GAAKA,EAAK,IAEhF,CAiEuB2uD,CAAaprE,KAAKrJ,OAAOW,SAAS,EDzD5B,KC2DrB,OADA0I,KAAKrJ,OAAO+6C,QD1DS,IC2DdjZ,CACX,CACAx6B,gBAAgBhH,GACZ,GAAI+I,KAAKrJ,OAAOM,OAASA,EACrB,UAAW,MAAM8vE,KAAS/mE,KAAK7B,OAE3B,GADA6B,KAAKrJ,OAAO6hC,OAAOuuC,GACf/mE,KAAKrJ,OAAOM,QAAUA,EAEtB,MAIZ,MAAMgF,EAAM+D,KAAKrJ,OAAO00E,QAAQ,EAAGp0E,GAInC,OAHA+I,KAAKrJ,OAAO+6C,QAAQz6C,GAEpB+I,KAAK+qE,iBAAkB,EAChB9uE,CACX,ECzGG,SAASqvE,EAAa7yC,GACzB,MAAM8yC,EAAQ,IAAI/wE,WF4BO,IEdzB,OAXA+wE,EAAM,GAAK9yC,EAAOvpB,KAClBq8D,EAAM,GAAK9yC,EAAOmyC,OAAS,EAC3BW,EAAM,GAAK9yC,EAAOmyC,KAClBW,EAAM,GAAK9yC,EAAOoyC,WAAa,GAC/BU,EAAM,GAAK9yC,EAAOoyC,WAAa,GAC/BU,EAAM,GAAK9yC,EAAOoyC,WAAa,EAC/BU,EAAM,GAAK9yC,EAAOoyC,SAClBU,EAAM,GAAK9yC,EAAOxhC,SAAW,GAC7Bs0E,EAAM,GAAK9yC,EAAOxhC,SAAW,GAC7Bs0E,EAAM,IAAM9yC,EAAOxhC,SAAW,EAC9Bs0E,EAAM,IAAM9yC,EAAOxhC,OACZs0E,CACX,2BCqBA,ICjCWC,EDiCX,EAlCA,SAAiBrtE,EAAQ6F,GACrB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMi5D,KAASttE,QAChB6F,EAAGynE,SACHA,CAEb,CALM,GAQX,MAAMC,GAAW,OAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GACf,GAAyB,mBAAdugB,GAAKoO,KACZ,OAAO,wBACG3uB,EACN,UAAW,MAAMuM,KAAOsgE,QACd1nE,EAAGoH,SACHA,CAEb,CANM,GAQX,MAAMsnC,EAAO1uC,EACb,OAAO,kBACGnF,EACN,IAAK,MAAMuM,KAAOsgE,EACdh5B,EAAKtnC,SACCA,CAEb,CANM,EAOX,GC/BA,SAAWogE,GACPA,EAAYA,EAAkB,KAAI,GAAK,OACvCA,EAAYA,EAAqB,QAAI,GAAK,UAC1CA,EAAYA,EAAyB,YAAI,GAAK,cAC9CA,EAAYA,EAAyB,YAAI,GAAK,cAC9CA,EAAYA,EAAsB,SAAI,GAAK,UAC9C,CAND,CAMGA,IAAgBA,EAAc,CAAC,IAE3B,MAAMG,UAAoB,IAC7BtsE,KACAmtC,MACAo/B,OACAC,IAEAC,mBAEAC,yBAEAC,WAEAC,mBAMAC,WACAC,OACAC,UACAtsE,YAAYs7B,GACRzoB,MAAM,IACCyoB,EACHqtC,MAAQ7iE,IACJ5F,KAAKwsC,MAAQg/B,EAAYa,SACzBjxC,EAAKqtC,QAAQ7iE,EAAI,IAGzB5F,KAAK4rE,OAASxwC,EAAKwwC,OACnB5rE,KAAK6rE,IAAMnlE,SAAS00B,EAAKxhC,GAAI,IAC7BoG,KAAKX,KAAO+7B,EAAK/7B,KACjBW,KAAKwsC,MAAQpR,EAAKoR,MAClBxsC,KAAK8rE,mBAAqBjC,EAC1B7pE,KAAKgsE,WAAahsE,KAAK4rE,OAAOzB,wBAC9BnqE,KAAKisE,mBAAqBjsE,KAAKgsE,WAC/BhsE,KAAKksE,WAAahzE,KAAKm+C,MACvBr3C,KAAKmsE,OAAS/wC,EAAK+wC,OACnBnsE,KAAKosE,UAAYhxC,EAAKgxC,UACtBpsE,KAAK7B,OAAS,EAAK6B,KAAK7B,QAAQ,KAC5B6B,KAAKssE,kBAAkB,GAE/B,CAQAruE,sBACA,CAIAA,eAAelD,EAAKqT,EAAU,CAAC,GAG3B,IAFArT,EAAMA,EAAIswE,UAEgB,IAAnBtwE,EAAI8R,YAAkB,CAMzB,GAJgC,IAA5B7M,KAAK8rE,0BACC9rE,KAAKusE,0BAA0Bn+D,GAGrB,SAAhBpO,KAAK2U,OACL,OAGJ,MAAM63D,EAASvzE,KAAKyL,IAAI1E,KAAK8rE,mBAAoB9rE,KAAK4rE,OAAOvB,eJpD5C,GIoD4EtvE,EAAI9D,QAC3FonC,EAAQr+B,KAAKysE,eACnBzsE,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAU7Q,KAChBmR,KAAMvsC,EACNwsC,SAAU7qE,KAAK6rE,IACf50E,OAAQu1E,GACTzxE,EAAIzD,SAAS,EAAGk1E,IACnBxsE,KAAK8rE,oBAAsBU,EAC3BzxE,EAAI22C,QAAQ86B,EAChB,CACJ,CAIAvuE,kBACI+B,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAUoC,aAChB9B,KAAML,EAAKoC,IACX9B,SAAU7qE,KAAK6rE,IACf50E,OAAQ,GAEhB,CAKAgH,uBACI,MAAMogC,EAAQr+B,KAAKysE,eAAiBlC,EAAKqC,IACzC5sE,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAUoC,aAChB9B,KAAMvsC,EACNwsC,SAAU7qE,KAAK6rE,IACf50E,OAAQ,GAEhB,CAKAgH,sBACA,CAMAA,gCAAgCmQ,EAAU,CAAC,GACvC,GAAIpO,KAAK8rE,mBAAqB,EAC1B,OAEJ,IAAIr6D,EACAC,EACJ,MAAMxZ,EAAQ,KACU,SAAhB8H,KAAK2U,OACLjD,EAAO,IAAI,KAAU,iBNnHL,qBMuHhBD,GACJ,EAEJrD,EAAQ6Z,QAAQE,iBAAiB,QAASjwB,GAC1C,UACU,IAAIsZ,SAAQ,CAACq7D,EAAUC,KACzB9sE,KAAK+rE,yBAA2B,KAC5Bc,GAAU,EAEdn7D,EAASo7D,EACTr7D,EAAUo7D,CAAQ,GAE1B,CACA,QACIz+D,EAAQ6Z,QAAQC,oBAAoB,QAAShwB,EACjD,CACJ,CAIA60E,mBAAmBt0C,GACfz4B,KAAKrH,KAAKH,MAAM,sCAAuCwH,KAAK6rE,KAC5D7rE,KAAKgtE,aAAav0C,EAAOmyC,MAEzB,MAAMqC,EAAYjtE,KAAK8rE,mBACvB9rE,KAAK8rE,oBAAsBrzC,EAAOxhC,OAEhB,IAAdg2E,GAAmBx0C,EAAOxhC,OAAS,GACnC+I,KAAK+rE,4BAEb,CAIA9tE,iBAAiBw6B,EAAQyyC,GAIrB,GAHAlrE,KAAKrH,KAAKH,MAAM,6BAA8BwH,KAAK6rE,KACnD7rE,KAAKgtE,aAAav0C,EAAOmyC,MAErB5qE,KAAKisE,mBAAqBxzC,EAAOxhC,OACjC,MAAM,IAAI,KAAU,0BAA2BuyE,EAA0B,CAAEyD,UAAWjtE,KAAKisE,mBAAoBiB,KAAMz0C,EAAOxhC,SAEhI,MAAMwlB,QAAayuD,IACnBlrE,KAAKisE,oBAAsBxzC,EAAOxhC,OAClC+I,KAAKmtE,WAAW1wD,EACpB,CAIAuwD,aAAa3uC,IACJA,EAAQksC,EAAK6C,OAAS7C,EAAK6C,KACxBptE,KAAKwsC,QAAUg/B,EAAY6B,UAC3BrtE,KAAKwsC,MAAQg/B,EAAY8B,cAG5BjvC,EAAQksC,EAAKqC,OAASrC,EAAKqC,KAC5B5sE,KAAKutE,oBAEJlvC,EAAQksC,EAAKoC,OAASpC,EAAKoC,KAC5B3sE,KAAKuM,OAEb,CAOAkgE,eACI,OAAQzsE,KAAKwsC,OACT,KAAKg/B,EAAYgC,KAEb,OADAxtE,KAAKwsC,MAAQg/B,EAAY6B,QAClB9C,EAAKkD,IAChB,KAAKjC,EAAYkC,YAEb,OADA1tE,KAAKwsC,MAAQg/B,EAAY8B,YAClB/C,EAAK6C,IAChB,QACI,OAAO,EAEnB,CAIAd,mBAEI,MAAMjuC,EAAQr+B,KAAKysE,eAIbp1B,EAAMn+C,KAAKm+C,MACXs2B,EAAM3tE,KAAKmsE,SAKjB,GAJc,IAAV9tC,GAAesvC,EAAM,GAAKt2B,EAAMr3C,KAAKksE,WAAmB,EAANyB,IAElD3tE,KAAKgsE,WAAa/yE,KAAKyL,IAAsB,EAAlB1E,KAAKgsE,WAAgBhsE,KAAK4rE,OAAOxB,sBAE5DpqE,KAAKisE,oBAAsBjsE,KAAKgsE,YAAwB,IAAV3tC,EAE9C,OAGJ,MAAMuvC,EAAQ5tE,KAAKgsE,WAAahsE,KAAKisE,mBACrCjsE,KAAKisE,mBAAqBjsE,KAAKgsE,WAE/BhsE,KAAKksE,WAAa70B,EAElBr3C,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAUoC,aAChB9B,KAAMvsC,EACNwsC,SAAU7qE,KAAK6rE,IACf50E,OAAQ22E,GAEhB,EChPJ,MAAMC,EAAoB,eAEnB,MAAMC,GACTzI,SAAWwI,EACXE,MACAjuE,YAAYs7B,EAAO,CAAC,GAChBp7B,KAAK+tE,MAAQ3yC,CACjB,CACA4yC,kBAAkB5yC,GACd,OAAO,IAAI6yC,GAAW,IACfjuE,KAAK+tE,SACL3yC,GAEX,EAEG,MAAM6yC,GACT5I,SAAWwI,EACX1vE,OACA6qD,KACA4iB,OACAjzE,IAEAu1E,gBAEAC,aAEAC,SAEAC,WAEAC,WAEAX,IAEA72B,OACAy3B,YACAC,aAEAC,kBAEAC,mBACAC,iBACAC,YACA9uE,YAAYs7B,GACRp7B,KAAK82C,OAA4B,aAAnB1b,EAAK5P,UACnBxrB,KAAK4rE,OAAS,IAAK9B,KAAkB1uC,GACrCp7B,KAAKrH,IAAMqH,KAAK4rE,OAAOjzE,IN5CxB,SAAsBizE,GACzB,GAAIA,EAAO5B,mBAAqB,EAC5B,MAAM,IAAI,KAAU,uCAAwCN,GAEhE,GAAIkC,EAAO3B,kBAAoB,EAC3B,MAAM,IAAI,KAAU,gDAAiDP,GAEzE,GAAIkC,EAAO1B,mBAAqB,EAC5B,MAAM,IAAI,KAAU,iDAAkDR,GAE1E,GAAIkC,EAAOzB,wBAA0BN,EACjC,MAAM,IAAI,KAAU,yDAA0DH,GAElF,GAAIkC,EAAOxB,oBAAsBwB,EAAOzB,wBACpC,MAAM,IAAI,KAAU,sEAAuET,GAE/F,GAAIkC,EAAOxB,oBAAsB,GAAK,GAAK,EACvC,MAAM,IAAI,KAAU,yDAA0DV,GAElF,GAAIkC,EAAOvB,eAAiB,KACxB,MAAM,IAAI,KAAU,iDAAkDX,EAE9E,CMuBQmF,CAAa7uE,KAAK4rE,QAClB5rE,KAAKkuE,gBAAkB,IAAInmD,gBAC3B/nB,KAAK2uE,iBAAmBvzC,EAAKuzC,iBAC7B3uE,KAAK4uE,YAAcxzC,EAAKwzC,YACxB5uE,KAAKouE,SAAW,IAAI9zD,IACpBta,KAAK7B,ORJN,SAAkBiQ,EAAU,CAAC,GAehC,OAAOg6D,GAdUzxE,IACb,MAAM0U,EAAO1U,EAAOyI,QACpB,GAAY,MAARiM,EACA,MAAO,CAAEgtB,MAAM,GAEnB,GAAkB,MAAdhtB,EAAK+U,MACL,MAAM/U,EAAK+U,MAEf,MAAO,CACHiY,MAAoB,IAAdhtB,EAAKgtB,KAEXx5B,MAAOwM,EAAKxM,MACf,GAEqBuP,EAC9B,CQZsBk6D,CAAS,CACnBG,MAAO,KACHzoE,KAAKrH,KAAKH,MAAM,sBAChBwH,KAAKouE,SAAShuE,SAAQ0uE,IAClBA,EAAOrkD,SAAS,GAClB,IAGVzqB,KAAKgpD,KAAO/qD,MAAOE,IAEf,IAAI4wE,EAAQ3uD,EADZjiB,EAASmpE,EAAgBnpE,EAAQ6B,KAAKkuE,gBAAgBjmD,OAAQ,CAAE8/C,eAAe,IAE/E,IACI,MAAMxX,EAAU,IAAI,EAAQpyD,SACtB,OAAKoyD,EAAQye,WAAW5yE,KAAKm0D,IAAUtyD,MAAOE,IAChD,UAAW,MAAM,OAAEs6B,EAAM,SAAEyyC,KAAc/sE,QAC/B6B,KAAKivE,YAAYx2C,EAAQyyC,EACnC,IAEJ6D,EAAStE,EAAWyE,iBACxB,CACA,MAAOtpE,GAEH,MAAMupE,EAAUvpE,EAAIyI,KAChBo7D,EAAgBzuD,IAAIm0D,IACpBnvE,KAAKrH,KAAKynB,MAAM,yBAA0Bxa,GAC1CmpE,EAAStE,EAAWjgE,gBAGpBxK,KAAKrH,KAAKynB,MAAM,yBAA0Bxa,GAC1CmpE,EAAStE,EAAW2E,eAExBhvD,EAAQxa,CACZ,CACA5F,KAAKrH,KAAKH,MAAM,oBACH,MAAT4nB,EACApgB,KAAK9H,MAAMkoB,EAAO2uD,SAGZ/uE,KAAKuP,MAAM,CAAEw/D,UACvB,EAEJ/uE,KAAKyuE,kBAAoB,EACzBzuE,KAAK0uE,mBAAqB,EAE1B1uE,KAAKmuE,aAAenuE,KAAK82C,OAAS,EAAI,EACtC92C,KAAKquE,WAAa,EAClBruE,KAAK2tE,IAAM,EACX3tE,KAAKrH,KAAKH,MAAM,iBACZwH,KAAK4rE,OAAO7B,iBACZ/pE,KAAKqvE,gBAAgB5hD,OAAMhkB,GAAKzJ,KAAKrH,KAAKynB,MAAM,sBAAuB3W,IAE/E,CACI6lE,cACA,OAAO12E,MAAM4N,KAAKxG,KAAKouE,SAASzyE,SACpC,CACA4zE,UAAUlwE,GACN,QAA0BqI,IAAtB1H,KAAKwuE,aACL,MAAM,IAAI,KAAU,wBAAyB5E,GAEjD,QAAyBliE,IAArB1H,KAAKuuE,YACL,MAAM,IAAI,KAAU,uBAAwB5E,GAEhD,MAAM/vE,EAAKoG,KAAKmuE,aAGhB,GAFAnuE,KAAKmuE,cAAgB,EAEjBnuE,KAAK0uE,oBAAsB1uE,KAAK4rE,OAAO1B,mBACvC,MAAM,IAAI,KAAU,gCP1GiB,uCO4GzClqE,KAAKrH,KAAKH,MAAM,4BAA6BoB,GAC7C,MAAMk1E,EAAS9uE,KAAKwvE,WAAW51E,EAAIyF,EAAMmsE,EAAYgC,KAAM,YAK3D,OAJAxtE,KAAKouE,SAASvyE,IAAIjC,EAAIk1E,GACtB9uE,KAAK0uE,qBAELI,EAAOxC,mBACAwC,CACX,CASA7wE,aACI,QAA0ByJ,IAAtB1H,KAAKwuE,aACL,MAAM,IAAI,KAAU,wBAAyB5E,GAEjD,QAAyBliE,IAArB1H,KAAKuuE,YACL,MAAM,IAAI,KAAU,uBAAwB5E,GAGhD,QAAwBjiE,IAApB1H,KAAKsuE,WAA0B,CAE/B,IAAIzB,EAAW,OACf7sE,KAAKsuE,WAAa,CACd10E,GAAIoG,KAAKquE,aAET98D,QAAS,IAAIC,SAAQ,CAACC,EAASC,KAC3B,MAAMiE,EAAS,KACXjE,EAAO,IAAI,KAAU,uBAAwBi4D,GAAwB,EAEzE3pE,KAAKkuE,gBAAgBjmD,OAAOE,iBAAiB,QAASxS,EAAQ,CAAEQ,MAAM,IACtE02D,EAAW,KACP7sE,KAAKkuE,gBAAgBjmD,OAAOC,oBAAoB,QAASvS,GACzDlE,GAAS,CACZ,IAELA,QAASo7D,GAGb,MAAMrpE,EAAQtK,KAAKm+C,MACnBr3C,KAAKyvE,SAASzvE,KAAKsuE,WAAW10E,IAE9B,UACUoG,KAAKsuE,WAAW/8D,OAC1B,CACA,eAEWvR,KAAKsuE,UAChB,CAEA,MAAM3rE,EAAMzJ,KAAKm+C,MACjBr3C,KAAK2tE,IAAMhrE,EAAMa,CACrB,YAGUxD,KAAKsuE,WAAW/8D,QAE1B,OAAOvR,KAAK2tE,GAChB,CAQAxB,SACI,OAAOnsE,KAAK2tE,GAChB,CAIA1vE,YAAYmQ,EAAU,CAAC,GACnB,GAAIpO,KAAKkuE,gBAAgBjmD,OAAOG,QAE5B,OAEJ,MAAM2mD,EAAS3gE,GAAS2gE,QAAUtE,EAAWyE,kBAC7ClvE,KAAKrH,KAAKH,MAAM,wBAAyBu2E,GACzC3gE,EAAQ6Z,OAAS7Z,EAAQ6Z,QAAUynD,YAAYC,QA1MjC,KA2Md,UACUn+D,QAAQQ,IAAI,IAAIhS,KAAKouE,SAASzyE,UAAUif,KAAI3c,MAAO+uB,GAAMA,EAAEzd,MAAMnB,MAEvEpO,KAAK4vE,WAAWb,GAChB/uE,KAAK6vE,aACT,CACA,MAAOjqE,GACH5F,KAAK9H,MAAM0N,EACf,CACJ,CACA1N,MAAM0N,EAAKmpE,GACP,IAAI/uE,KAAKkuE,gBAAgBjmD,OAAOG,QAAhC,CAIA2mD,EAASA,GAAUtE,EAAW2E,cAE9BpvE,KAAKrH,KAAKynB,MAAM,iCAAkC2uD,EAAQnpE,GAE1D,IAAK,MAAMkpE,KAAU9uE,KAAKouE,SAASzyE,SAC/BmzE,EAAO52E,MAAM0N,GAGjB5F,KAAK4vE,WAAWb,GAChB/uE,KAAK6vE,aAVL,CAWJ,CACAC,WACI,OAAO9vE,KAAKkuE,gBAAgBjmD,OAAOG,OACvC,CAIAynD,cAEI7vE,KAAKkuE,gBAAgBh2E,QAErB8H,KAAK7B,OAAOwE,KAChB,CAEA6sE,WAAW51E,EAAIyF,EAAMmtC,EAAOhhB,GACxB,GAA6B,MAAzBxrB,KAAKouE,SAASztE,IAAI/G,GAClB,MAAM,IAAI,KAAU,wBAAyByvE,EAA2B,CAAEzvE,OAE9E,MAAMk1E,EAAS,IAAInD,EAAY,CAC3B/xE,GAAIA,EAAG+K,WACPtF,OACAmtC,QACAhhB,YACA4gD,UAAWpsE,KAAKosE,UAAUhwE,KAAK4D,MAC/ByoE,MAAO,KACHzoE,KAAK+vE,YAAYn2E,GACjBoG,KAAK4uE,cAAcE,EAAO,EAE9Bn2E,IAAKqnE,EAAO,gBAAgBx0C,KAAa5xB,KACzCgyE,OAAQ5rE,KAAK4rE,OACbO,OAAQnsE,KAAKmsE,OAAO/vE,KAAK4D,QAE7B,OAAO8uE,CACX,CAKAiB,YAAYn2E,GACJoG,KAAK82C,UAAYl9C,EAAK,GAAM,GAC5BoG,KAAKyuE,oBAGLzuE,KAAK0uE,qBAET1uE,KAAKouE,SAASn2D,OAAOre,EACzB,CACAqE,sBACI,MAAM+xE,EAAe,IAAIx+D,SAAQ,CAACq7D,EAAUn7D,KAAa1R,KAAKkuE,gBAAgBjmD,OAAOE,iBAAiB,QAASzW,EAAQ,CAAEyE,MAAM,GAAO,IAEtI,IADAnW,KAAKrH,KAAKH,MAAM,sCAAuCwH,KAAK4rE,OAAO5B,qBACtD,CACT,IAAI7lC,EACJ,UACU3yB,QAAQo2D,KAAK,CACfoI,EACA,IAAIx+D,SAASC,IACT0yB,EAAYp+B,WAAW0L,EAASzR,KAAK4rE,OAAO5B,kBAAkB,MAGtEhqE,KAAKiwE,OAAOxiD,OAAMhkB,GAAKzJ,KAAKrH,KAAKynB,MAAM,iBAAkB3W,IAC7D,CACA,MAAOA,GAGH,YADAymE,cAAc/rC,EAElB,CACJ,CACJ,CACAlmC,kBAAkBw6B,EAAQyyC,GACtB,MAAM,SAAEL,EAAQ,KAAE37D,EAAI,OAAEjY,GAAWwhC,EAEnC,GADAz4B,KAAKrH,KAAKH,MAAM,oBAAqBkyE,EAAgBjyC,IACpC,IAAboyC,EACA,OAAQ37D,GACJ,KAAKo7D,EAAU6F,KAGP,YADAnwE,KAAKowE,WAAW33C,GAGxB,KAAK6xC,EAAU+F,OAGP,YADArwE,KAAKswE,aAAar5E,GAG1B,QAEI,MAAM,IAAI,KAAU,qBAAsBiyE,EAAmB,CAAEzwC,gBAIvE,OAAQA,EAAOvpB,MACX,KAAKo7D,EAAU7Q,KACf,KAAK6Q,EAAUoC,aAGP,kBADM1sE,KAAKuwE,oBAAoB93C,EAAQyyC,GAG/C,QAEI,MAAM,IAAI,KAAU,qBAAsBhC,EAAmB,CAAEzwC,WAG/E,CACA23C,WAAW33C,GAEP,GAAIA,EAAOmyC,OAASL,EAAKkD,IACrBztE,KAAKrH,KAAKH,MAAM,kCAAmCigC,EAAOxhC,QAC1D+I,KAAKyvE,SAASh3C,EAAOxhC,OAAQszE,EAAK6C,SAEjC,IAAI30C,EAAOmyC,OAASL,EAAK6C,IAM1B,MAAM,IAAI,KAAU,qBAAsBlE,EAAmB,CAAEzwC,WAL/Dz4B,KAAKrH,KAAKH,MAAM,mCAAoCigC,EAAOxhC,QAC3D+I,KAAKwwE,mBAAmB/3C,EAAOxhC,OAKnC,CACJ,CACAu5E,mBAAmBC,GACf,QAAwB/oE,IAApB1H,KAAKsuE,WAEL,MAAM,IAAI,KAAU,qBAAsBnF,GAE9C,GAAInpE,KAAKsuE,WAAW10E,KAAO62E,EAEvB,MAAM,IAAI,KAAU,4BAA8BrH,GAGtDppE,KAAKsuE,WAAW78D,SACpB,CACA6+D,aAAavB,GACT/uE,KAAKrH,KAAKH,MAAM,4BAA6BiyE,EAAWsE,IAAW,WACnE/uE,KAAKwuE,aAAeO,EAGpB,IAAK,MAAMD,KAAU9uE,KAAKouE,SAASzyE,SAC/BmzE,EAAOviE,QAEXvM,KAAK6vE,aACT,CACA5xE,0BAA0Bw6B,EAAQyyC,GAC9B,MAAM,SAAEL,EAAQ,KAAED,EAAI,KAAE17D,GAASupB,GAC5BmyC,EAAOL,EAAKkD,OAASlD,EAAKkD,KAC3BztE,KAAK0wE,eAAe7F,GAExB,MAAMiE,EAAS9uE,KAAKouE,SAASztE,IAAIkqE,GACjC,QAAenjE,IAAXonE,EAaJ,OAAQ5/D,GACJ,KAAKo7D,EAAUoC,aAEX,YADAoC,EAAO/B,mBAAmBt0C,GAG9B,KAAK6xC,EAAU7Q,KACX,QAAiB/xD,IAAbwjE,EACA,MAAM,IAAI3yE,MAAM,eAGpB,kBADMu2E,EAAO6B,WAAWl4C,EAAQyyC,GAGpC,QACI,MAAM,IAAI3yE,MAAM,oBAzBpB,GAAI2W,IAASo7D,EAAU7Q,KAAM,CAEzB,GADAz5D,KAAKrH,MAAM,mCAAoCkyE,QAC9BnjE,IAAbwjE,EACA,MAAM,IAAI3yE,MAAM,qBAEd2yE,GACV,MAEIlrE,KAAKrH,MAAM,iCAAkCkyE,EAmBzD,CACA6F,eAAe92E,GACX,GAAIoG,KAAK82C,UAAYl9C,EAAK,GAAM,GAC5B,MAAM,IAAI,KAAU,6BAA8B2vE,GAEtD,GAAIvpE,KAAKouE,SAASpzD,IAAIphB,GAClB,OAGJ,GADAoG,KAAKrH,KAAKH,MAAM,4BAA6BoB,QACpB8N,IAArB1H,KAAKuuE,YAQL,YANAvuE,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAUoC,aAChB9B,KAAML,EAAKoC,IACX9B,SAAUjxE,EACV3C,OAAQ,IAKhB,GAAI+I,KAAKyuE,mBAAqBzuE,KAAK4rE,OAAO3B,kBAQtC,OAPAjqE,KAAKrH,MAAM,0DACXqH,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAUoC,aAChB9B,KAAML,EAAKoC,IACX9B,SAAUjxE,EACV3C,OAAQ,IAKhB,MAAM63E,EAAS9uE,KAAKwvE,WAAW51E,OAAI8N,EAAW8jE,EAAYkC,YAAa,WACvE1tE,KAAKyuE,oBAELzuE,KAAKouE,SAASvyE,IAAIjC,EAAIk1E,GACtB9uE,KAAK2uE,mBAAmBG,EAC5B,CACA1C,UAAU3zC,EAAQhc,GAEd,GADAzc,KAAKrH,KAAKH,MAAM,mBAAoBkyE,EAAgBjyC,IAChDA,EAAOvpB,OAASo7D,EAAU7Q,KAAM,CAChC,QAAa/xD,IAAT+U,EACA,MAAM,IAAI,KAAU,gBAAiBysD,GAEzClpE,KAAK7B,OAAOzG,KAAK4zE,EAAa7yC,IAC9Bz4B,KAAK7B,OAAOzG,KAAK+kB,EACrB,MAEIzc,KAAK7B,OAAOzG,KAAK4zE,EAAa7yC,GAEtC,CACAg3C,SAASgB,EAAQ7F,EAAOL,EAAKkD,KACrB7C,IAASL,EAAKkD,IACdztE,KAAKrH,KAAKH,MAAM,iCAAkCi4E,GAGlDzwE,KAAKrH,KAAKH,MAAM,kCAAmCi4E,GAEvDzwE,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAU6F,KAChBvF,OACAC,SAAU,EACV5zE,OAAQw5E,GAEhB,CACAb,WAAWb,EAAStE,EAAWyE,mBAC3BlvE,KAAKrH,MAAM,2BAA4B8xE,EAAWsE,IAClD/uE,KAAKuuE,YAAcQ,EACnB/uE,KAAKosE,UAAU,CACXl9D,KAAMo7D,EAAU+F,OAChBzF,KAAM,EACNC,SAAU,EACV5zE,OAAQ83E,GAEhB,ECpeG,SAAS6B,GAAMx1C,EAAO,CAAC,GAC1B,MAAO,IAAM,IAAI0yC,GAAM1yC,EAC3B,6CCA4B10B,SAAS,SAAU,IACrB,IAAIlM,WAAW,CACrC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAAK,gOCWvC,MAdA,SAAe2D,GACX,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,UAAW,MAAMM,KAAS3U,EACtB,OAAO2U,CAGd,EALM,GAOX,IAAK,MAAMA,KAAS3U,EAChB,OAAO2U,CAGf,ECgCA,MA7CA,SAAe3U,EAAQ1G,EAAO,GAE1B,OADAA,EAAOuR,OAAOvR,GAHwB,MAIlB0G,EAJP3H,OAAOgc,eAKRvU,kBACJ,IAAI4yE,EAAS,GAIb,GAHIp5E,EAAO,IACPA,EAAO,GAEPA,IAASwB,KAAKsmC,MAAM9nC,GACpB,MAAM,IAAIc,MAAM,iCAEpB,UAAW,MAAMkzE,KAASttE,EAEtB,IADA0yE,EAAOn5E,KAAK+zE,GACLoF,EAAO55E,QAAUQ,SACdo5E,EAAO/3E,MAAM,EAAGrB,GACtBo5E,EAASA,EAAO/3E,MAAMrB,GAG9B,KAAOo5E,EAAO55E,OAAS,SACb45E,EAAO/3E,MAAM,EAAGrB,GACtBo5E,EAASA,EAAO/3E,MAAMrB,EAE9B,CAnBO,GAqBH,YACJ,IAAIo5E,EAAS,GAIb,GAHIp5E,EAAO,IACPA,EAAO,GAEPA,IAASwB,KAAKsmC,MAAM9nC,GACpB,MAAM,IAAIc,MAAM,iCAEpB,IAAK,MAAMkzE,KAASttE,EAEhB,IADA0yE,EAAOn5E,KAAK+zE,GACLoF,EAAO55E,QAAUQ,SACdo5E,EAAO/3E,MAAM,EAAGrB,GACtBo5E,EAASA,EAAO/3E,MAAMrB,GAG9B,KAAOo5E,EAAO55E,OAAS,SACb45E,EAAO/3E,MAAM,EAAGrB,GACtBo5E,EAASA,EAAO/3E,MAAMrB,EAE9B,CAnBO,EAoBX,ECzCewG,eAAgB6yE,EAAc3yE,EAAQ1G,EAAO,GACxD,UAAW,MAAM0yB,KAAS,EAAMhsB,EAAQ1G,GAAO,CAC3C,MAAMo5E,EAAS1mD,EAAMvP,KAAI3c,MAAO1C,GACrBA,IAAIiyB,MAAK3uB,IAAS,CAAGk8B,IAAI,EAAMl8B,YAAU+G,IAAO,CAAGm1B,IAAI,EAAOn1B,YAEzE,IAAK,IAAItK,EAAI,EAAGA,EAAIu1E,EAAO55E,OAAQqE,IAAK,CACpC,MAAMse,QAAei3D,EAAOv1E,GAC5B,IAAIse,EAAOmhB,GAIP,MAAMnhB,EAAOhU,UAHPgU,EAAO/a,KAKrB,CACJ,CACJ,gBCpBA,MACakyE,EAAY,CAAC3iE,EAAU,CAAC,KACjC,MAAM4iE,EAAY5iE,EAAQ4iE,WAFH,OAGvB,OAAO/yE,gBAAiCE,GACpC,IAAIwiB,EAAO,IAAI,IACXswD,EAAgB,EAChBC,GAAU,EACd,UAAW,MAAMv6E,KAAUwH,EAGvB,IAFAwiB,EAAK6X,OAAO7hC,GACZs6E,GAAiBt6E,EAAOM,OACjBg6E,GAAiBD,GAIpB,SAHMrwD,EAAK7nB,MAAM,EAAGk4E,GACpBE,GAAU,EAENF,IAAcrwD,EAAK1pB,OACnB0pB,EAAO,IAAI,IACXswD,EAAgB,MAEf,CACD,MAAME,EAAQ,IAAI,IAClBA,EAAM34C,OAAO7X,EAAK0qD,QAAQ2F,IAC1BrwD,EAAOwwD,EAEPF,GAAiBD,CACrB,GAGHE,GAAWD,EAAgB,WAEtBtwD,EAAKrpB,SAAS,EAAG25E,GAE/B,CAAC,MC1BMxX,EAsHA2X,EAiDAC,yBAtKX,SAAW5X,GACP,IAAI6X,EASAC,EAcAhY,GAtBJ,SAAW+X,GACPA,EAAc,IAAI,MAClBA,EAAoB,UAAI,YACxBA,EAAe,KAAI,OACnBA,EAAmB,SAAI,WACvBA,EAAkB,QAAI,UACtBA,EAAoB,UAAI,WAC3B,CAPD,CAOGA,EAAW7X,EAAK6X,WAAa7X,EAAK6X,SAAW,CAAC,IAEjD,SAAWC,GACPA,EAAiBA,EAAsB,IAAI,GAAK,MAChDA,EAAiBA,EAA4B,UAAI,GAAK,YACtDA,EAAiBA,EAAuB,KAAI,GAAK,OACjDA,EAAiBA,EAA2B,SAAI,GAAK,WACrDA,EAAiBA,EAA0B,QAAI,GAAK,UACpDA,EAAiBA,EAA4B,UAAI,GAAK,WACzD,CAPD,CAOGA,IAAqBA,EAAmB,CAAC,IAC5C,SAAWD,GACPA,EAAS3a,MAAQ,KACN,QAAY4a,EAE1B,CAJD,CAIGD,EAAW7X,EAAK6X,WAAa7X,EAAK6X,SAAW,CAAC,IAEjD7X,EAAK9C,MAAQ,KACK,MAAV4C,IACAA,GAAS,SAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,KAgB9B,IAf6B,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACT22D,EAAK6X,SAAS3a,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAE3B,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,OAEI,MAAhBnwD,EAAIkoE,WACJvxC,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOkF,EAAIkoE,WAEK,MAAlBloE,EAAImoE,WACJ,IAAK,MAAM5yE,KAASyK,EAAImoE,WACpBxxC,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOvF,GAGG,MAAhByK,EAAIooE,WACJzxC,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOkF,EAAIooE,WAEC,MAAdpoE,EAAIqoE,SACJ1xC,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOkF,EAAIqoE,SAED,MAAZroE,EAAIugB,OACJoW,EAAEn9B,OAAO,IACTm9B,EAAEn9B,OAAOwG,EAAIugB,OAEA,MAAbvgB,EAAIsoE,QACJ3xC,EAAEn9B,OAAO,IACTsuE,EAASza,QAAQ5nD,OAAOzF,EAAIsoE,MAAO3xC,KAEV,IAAzB8R,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CACRmoE,WAAY,IAEV9uE,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAOw+D,EAAK6X,SAAS3a,QAAQvqD,OAAOtK,GACxC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,KAAK,EACD+F,EAAIkoE,SAAW1vE,EAAOsC,SACtB,MACJ,KAAK,EACDkF,EAAImoE,WAAW/5E,KAAKoK,EAAOsC,UAC3B,MACJ,KAAK,EACDkF,EAAIooE,SAAW5vE,EAAOsC,SACtB,MACJ,KAAK,EACDkF,EAAIqoE,OAAS7vE,EAAOsC,SACpB,MACJ,KAAK,EACDkF,EAAIugB,KAAO/nB,EAAOgB,SAClB,MACJ,KAAK,EACDwG,EAAIsoE,MAAQR,EAASza,QAAQvqD,OAAOtK,EAAQA,EAAOgB,UACnD,MACJ,QACIhB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXE,EAAK1qD,OAAUzF,IACJ,QAAcA,EAAKmwD,EAAK9C,SAEnC8C,EAAKrtD,OAAUrR,IACJ,QAAcA,EAAK0+D,EAAK9C,QAEtC,CApHD,CAoHG8C,IAASA,EAAO,CAAC,IAEpB,SAAW2X,GACP,IAAI7X,EACJ6X,EAASza,MAAQ,KACC,MAAV4C,IACAA,GAAS,SAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEa,MAAfhD,EAAIuoE,UACJ5xC,EAAEn9B,OAAO,GACTm9B,EAAE97B,MAAMmF,EAAIuoE,UAEiB,MAA7BvoE,EAAIwoE,wBACJ7xC,EAAEn9B,OAAO,IACTm9B,EAAE/8B,QAAQoG,EAAIwoE,yBAEW,IAAzB//B,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIuoE,QAAU/vE,EAAOqC,QACrB,MACJ,KAAK,EACDmF,EAAIwoE,sBAAwBhwE,EAAOoB,UACnC,MACJ,QACIpB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEX6X,EAASriE,OAAUzF,IACR,QAAcA,EAAK8nE,EAASza,SAEvCya,EAAShlE,OAAUrR,IACR,QAAcA,EAAKq2E,EAASza,QAE1C,CA/CD,CA+CGya,IAAaA,EAAW,CAAC,IAE5B,SAAWC,GACP,IAAI9X,EACJ8X,EAAS1a,MAAQ,KACC,MAAV4C,IACAA,GAAS,SAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEc,MAAhBhD,EAAIyoE,WACJ9xC,EAAEn9B,OAAO,IACTm9B,EAAEv8B,OAAO4F,EAAIyoE,YAEY,IAAzBhgC,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,GAAQuwB,IAAQ,GACP,EACD/pB,EAAIyoE,SAAWjwE,EAAO4B,cAGtB5B,EAAO+B,SAAe,EAANwvB,EAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEX8X,EAAStiE,OAAUzF,IACR,QAAcA,EAAK+nE,EAAS1a,SAEvC0a,EAASjlE,OAAUrR,IACR,QAAcA,EAAKs2E,EAAS1a,QAE1C,CAxCD,CAwCG0a,IAAaA,EAAW,CAAC,ICpN5B,MAAM3W,EAAQ,CACVsX,IAAK,MACLC,UAAW,YACXrjC,KAAM,OACNyiC,SAAU,WACVa,QAAS,UACTC,UAAW,0BAETC,EAAW,CACb,YACA,0BAEEC,EAAoB3rE,SAAS,OAAQ,GACrC4rE,EAAyB5rE,SAAS,OAAQ,GAChD,MAAM6rE,EAIFt5D,iBAAiBu5D,GACb,MAAM3qE,EAAU,SAAc2qE,GACxB/1D,EAAO,IAAI81D,EAAO,CACpBrjE,KAAMwrD,EAAsB,MAAhB7yD,EAAQ5M,KAAe4M,EAAQ5M,KAAK0J,WAAa,QAC7D8X,KAAM5U,EAAQ4xD,KACdgZ,WAAY5qE,EAAQ4pE,WACpB5nD,KAAMhiB,EAAQgiB,KACd+nD,MAAwB,MAAjB/pE,EAAQ+pE,MACT,CACEc,KAAM7qE,EAAQ+pE,MAAMC,SAAW,GAC/Bc,MAAO9qE,EAAQ+pE,MAAME,4BAEvBpqE,EACNiqE,OAAQ9pE,EAAQ8pE,SAIpB,OADAl1D,EAAKm2D,cAAgB/qE,EAAQgiB,MAAQ,EAC9BpN,CACX,CACAvN,KACAuN,KACAg2D,WACAf,SACAC,OACAC,MACAiB,MACAD,cACA9yE,YAAYsO,EAAU,CAClBc,KAAM,SAEN,MAAM,KAAEA,EAAI,KAAEuN,EAAI,WAAEg2D,EAAU,SAAEf,EAAQ,OAAEC,EAAM,MAAEC,EAAK,KAAE/nD,GAASzb,EAClE,GAAY,MAARc,IAAiBxQ,OAAO/C,OAAO++D,GAAOn5C,SAASrS,GAC/C,MAAM,EAAQ,IAAI3W,MAAM,SAAW2W,EAAO,iBAAkB,oBAEhElP,KAAKkP,KAAOA,GAAQ,OACpBlP,KAAKyc,KAAOA,EACZzc,KAAK0xE,SAAWA,EAChB1xE,KAAK2xE,OAASA,EACd3xE,KAAKyyE,WAAaA,GAAc,GAChCzyE,KAAK4yE,cAAgB,EACrB5yE,KAAK6pB,KAAOA,EACZ7pB,KAAK4xE,MAAQA,CACjB,CACI/nD,SAAKA,GAED7pB,KAAK6yE,MADG,MAARhpD,EACa7pB,KAAK8yE,cAAgBR,EAAyBD,EAGtC,KAAPxoD,CAEtB,CACIA,WACA,OAAO7pB,KAAK6yE,KAChB,CACAC,cACI,OAAOV,EAAS7wD,SAASvhB,KAAKkP,KAClC,CACA6jE,aAAat7E,GACTuI,KAAKyyE,WAAW/6E,KAAKD,EACzB,CACAu7E,gBAAgB3oD,GACZrqB,KAAKyyE,WAAWxnD,OAAOZ,EAAO,EAClC,CAIA4oD,WACI,GAAIjzE,KAAK8yE,cAEL,OAAO,GAEX,IAAII,EAAM,GAOV,OANAlzE,KAAKyyE,WAAWryE,SAAS3I,IACrBy7E,GAAOz7E,CAAI,IAEE,MAAbuI,KAAKyc,OACLy2D,GAAOjxD,OAAOjiB,KAAKyc,KAAKxlB,SAErBi8E,CACX,CAIAtZ,UACI,IAAI1qD,EACJ,OAAQlP,KAAKkP,MACT,IAAK,MACDA,EAAO,eACP,MACJ,IAAK,YACDA,EAAO,qBACP,MACJ,IAAK,OACDA,EAAO,gBACP,MACJ,IAAK,WACDA,EAAO,oBACP,MACJ,IAAK,UACDA,EAAO,mBACP,MACJ,IAAK,yBACDA,EAAO,qBACP,MACJ,QACI,MAAM,EAAQ,IAAI3W,MAAM,SAAS2W,kBAAsB,oBAE/D,IAII2a,EAUA+nD,EAdAn1D,EAAOzc,KAAKyc,KAqBhB,OApBiB,MAAbzc,KAAKyc,MAAqC,IAArBzc,KAAKyc,KAAKxlB,SAC/BwlB,OAAO/U,GAGM,MAAb1H,KAAK6pB,OACLA,EAA6B,WAArB7pB,KAAK4yE,eAA+B5yE,KAAK6pB,MAAQ,GACrDA,IAASwoD,GAAsBryE,KAAK8yE,gBACpCjpD,OAAOniB,GAEPmiB,IAASyoD,GAA0BtyE,KAAK8yE,gBACxCjpD,OAAOniB,IAIG,MAAd1H,KAAK4xE,QACLA,EAAQ,CACJC,QAAS7xE,KAAK4xE,MAAMc,KACpBZ,sBAAuB9xE,KAAK4xE,MAAMe,QAGnC,SAAc,CACjB13E,KAAMiU,EACNuqD,KAAMh9C,EACN+0D,SAAUxxE,KAAK8yE,mBAAgBprE,EAAY1H,KAAKizE,WAChDxB,WAAYzxE,KAAKyyE,WACjBf,SAAU1xE,KAAK0xE,SACfC,OAAQ3xE,KAAK2xE,OACb9nD,OACA+nD,SAER,EC9JJ,MAAM77D,EAAQ,IAAIvb,WAAW,GAUvB24E,EAAUhc,IACd,MAAMic,EAAQjc,EAAIr3B,MAAM,OACxB,OAAOszC,EAAQ,IAAI54E,WAAW44E,EAAMx4D,KAAI0B,GAAK5V,SAAS4V,EAAG,OAAQvG,GA0B7D,EAAShY,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,ECnCxC,EAAO,MACP8V,EAAO,GAMPU,EAAUtG,GAAS,EAAOA,GAM1B2D,EAAUqQ,GAAS,EAAOA,kBCoGvC,IAIA,EAzHA,SAAemyC,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECxGA,MAAM2wD,EAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,EAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,EAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,EAAK,CAACI,EAAMC,IAAU,IAAIH,EAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,EAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,EAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,EAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,EAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,EAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,EAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,EAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,EAAO1tB,EAAO0tB,KAC/B,EA4GUi3B,EAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,EAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI,CAAOF,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DI,CAAOF,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrC,EAAS0xD,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,ICJF,GDOcD,EAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkBD,EAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQD,EAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DUF,EAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,gEAGgBspC,EAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCXZ,IAAIyrC,EAOJ,SAAS,EAAOtsB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAOwsB,GACXl3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,GAAO,IAET,KAAMA,EAAM0sB,GACVp3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBIm3D,EAAM,IAENC,GAAS,IACTF,EAAMl6D,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,EAKJ,SAASngB,EAAK5I,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADAjuB,EAAKJ,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAIg3C,IAAWl0D,GACfkd,EAAIg3C,GAAUr6D,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAKi3C,GAId,OAFA5vD,EAAKJ,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BIm0C,EAAQ,IACRD,EAAS,IA2Bb,IAAIE,EAAKv6D,KAAK6qB,IAAI,EAAI,GAClB2vC,EAAKx6D,KAAK6qB,IAAI,EAAG,IACjB4vC,EAAKz6D,KAAK6qB,IAAI,EAAG,IACjB6vC,EAAK16D,KAAK6qB,IAAI,EAAG,IACjB8vC,EAAK36D,KAAK6qB,IAAI,EAAG,IACjB+vC,EAAK56D,KAAK6qB,IAAI,EAAG,IACjBgwC,EAAK76D,KAAK6qB,IAAI,EAAG,IACjBiwC,EAAK96D,KAAK6qB,IAAI,EAAG,IACjBkwC,GAAK/6D,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQkkD,EACR7mD,OAAQ,EACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ20D,EAAK,EACb30D,EAAQ40D,EAAK,EACb50D,EAAQ60D,EAAK,EACb70D,EAAQ80D,EAAK,EACb90D,EAAQ+0D,EAAK,EACb/0D,EAAQg1D,EAAK,EACbh1D,EAAQi1D,EAAK,EACbj1D,EAAQk1D,EAAK,EACbl1D,EAAQm1D,GAAK,EACA,EAEjB,GCzEO,MAAM,GAAS,CAACv3C,EAAMvlB,EAAS,IAE7B,CADM,UAAculB,EAAMvlB,GACnB,iBAQHg9D,GAAW,CAACC,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI4hD,GAAkBE,GACtB,kBAAsBA,GCjBlB,GAAS,CAAC9lD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAShC,GAAUgxD,IACrB,MAAMhxD,EAAQ,EAAOgxD,IACdlmD,EAAM+lD,GAAc,GAAc7wD,IAClC9L,EAAM48D,GAAgB,GAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI,GAAO8V,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtEK,MAAMqL,GAAS,CAACgmD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG4rC,GACLvxD,EACAwxD,GAAUH,GAC+B,GAAU,WAG9CI,GACLzxD,EACAwxD,GAAUH,GACmCC,GAAQ,UAE3D,EAoBIx6C,GAAQ,IAAIiW,QAMZykC,GAAYE,IAChB,MAAMF,EAAY16C,GAAM1Z,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADAD,GAAMxe,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAMG,GAOXp1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAASgnD,GACX,MAAM,IAAI98D,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAASinD,GACrB,MAAM,IAAI/8D,MAAM,sDAGlB,OACE28D,GAAIK,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAY,GAAclmD,EAAMg8C,GACtC,OACE6K,GAAIO,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAOR,GAAIl0C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SD5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YRrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GQ0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GCiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAOjmD,GAAO5O,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK5S,GAAO5O,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiBq2D,GAEnB,OAAOr2D,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAIq2D,GACThsC,EACA7a,EACwC,EACxC9K,GAASwyD,GAAU7sC,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAMm3D,IAAqB,CAIpC,MAAM,QAAE9sC,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,GAAckK,GACjB,OAAOW,GAAIv2D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAASgnD,GACX,MAAM,IAAI98D,MACR,wCAAwC88D,sBAG1C,OAAO,IAAIH,GAAIhsC,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQwyD,GAAU7sC,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI2xD,GAAIhsC,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO6K,GAAIv2D,OAAO,EAAG02D,GAAahL,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO6K,GAAIv2D,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAaf,GAAIgB,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQjB,GAAIkB,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiB,EACrBhzD,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAI,GACjB8L,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACFgsC,GAAIK,SAAyD,GAC7DL,GAAIO,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,GAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,GAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAASszD,GAAgB14D,EAAQ02D,GAE1CI,EAAMC,GAAI9oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFAw8D,GAAUE,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM4B,GAAkB,CAAC14D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQ,EACxB,MAAO,CACkB,EAAgB,OACvCtE,EAAQnkD,OAAO,GAAG,WAAmBjO,KAEzC,CACA,KAAK,SAAkB,CACrB,MAAMoyD,EAAUsE,GAAQ,EACxB,MAAO,CAAuB,EAAgB,OAAGtE,EAAQnkD,OAAOjO,GAClE,CACA,KAAK,SAAe,CAClB,MAAMoyD,EAAUsE,GAAQ,EACxB,MAAO,CAAuB,EAAa,OAAGtE,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI22D,GAAa,CAACvxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAW,SACb,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASID,GAAa,CAACzxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGII,GAAc,IACdC,GAAe,GAQfS,GAAY,CAAC7sC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,GAAsB5tC,GACnC6tC,EAAaD,EAAa,GAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,GAAgBqc,EAAS3lB,EAAO,GAChC,GAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGHyyD,GAAYx/D,OAAOkqD,IAAI,oBC3kBhB,GAAO,EAAGrhD,OAAMgP,OAAMU,YAAa,IAAIylD,GAAOn1D,EAAMgP,EAAMU,GAWhE,MAAMylD,GAOX10D,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,EC1CF,MAAMk8D,GAAMp1D,GAIVpB,SAAc,IAAIzD,iBAAiBo6C,OAAO8f,OAAOrK,OAAOhrD,EAAMod,IAEnD2wC,GAAS,GAAK,CACzB/tD,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,aCbD4e,IDgBS,GAAK,CACzBh0E,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,aCnBSx2D,MAAOtH,EAAQ28E,EAAYllE,KACzB,MAAjBA,EAAQuoD,QACRvoD,EAAQuoD,MAAQ,GAEpB,MAAMpC,QAAkBnH,GAAO/C,OAAO1zD,GAChCs+D,EAAMC,GAAIv2D,OAAOyP,EAAQmlE,WAAYnlE,EAAQuoD,MAAMtoD,KAAMkmD,GAE/D,aADM+e,EAAWplE,IAAI+mD,EAAKt+D,EAAQyX,GAC3B6mD,CAAG,GCLP,SAASue,GAAsBplE,GAClC,OAAOnQ,gBAA+B7F,EAAMk7E,GACxC,IAAIG,EAAe,GACnB,UAAW,IAAIrgC,KAASh7C,EAAKs7E,cACnBz1E,UACF,IAAI01E,EACJ,MAAM5hC,EAAO,CACT4kB,MAAO,EACP4c,WAAYnlE,EAAQmlE,WACpBK,WAAYxlE,EAAQwlE,YAEpBxlE,EAAQylE,WACR9hC,EAAK4kB,MAAQ,EACb5kB,EAAKwhC,WAAa,IAGlBI,EAAS,IAAIpB,EAAO,CAChBrjE,KAAMd,EAAQ0lE,SACdr3D,KAAM22B,IAEVA,EAAQ,SAAa,CACjBqmB,KAAMka,EAAO/Z,UACbma,MAAO,MAGf,MAAM9e,QAAYoe,GAAQjgC,EAAOkgC,EAAYvhC,GAO7C,OANA0hC,GAAgBxxD,OAAOmxB,EAAMvmC,YAC7BuB,EAAQwlE,aAAa,IAAI,IAAoB,sCAAuC,CAChFH,eACAxe,MACAjmC,KAAM52B,EAAK42B,QAER,CACHimC,MACA0e,SACAl8E,KAAMwqB,OAAOmxB,EAAMn8C,QACnBm8C,QACH,CAGb,CACJ,CC3CO,MAAM4gC,GAAa/1E,MAAO0f,EAAK21D,EAAYllE,KAC9C,MAAMulE,EAAS,IAAIpB,EAAO,CACtBrjE,KAAM,YACN0iE,MAAOj0D,EAAIi0D,MACX/nD,KAAMlM,EAAIkM,OAERupB,GAAQ,IAAArkC,SAAO,IAAAklE,SAAQ,CAAExa,KAAMka,EAAO/Z,aAG5C,MAAO,CACH3E,UAHcoe,GAAQjgC,EAAOkgC,EAAYllE,GAIzC4gB,KAHSrR,EAAIqR,KAIb2kD,SACAl8E,KAAMwqB,OAAOmxB,EAAMn8C,QACnBi9E,aAAcv2D,EAAIu2D,aAClB9gC,QACH,ECmBL,SAAS+gC,GAAoBv6D,GACzB,OAAyB,IAAlBA,EAAOkd,MAClB,CACA,MA+Fas9C,GAAcn2E,MAAO7F,EAAMg7C,EAAOhlC,IACpCA,EAAQimE,OAnInBp2E,gBAA+B7F,EAAMk7E,EAAYllE,GAC7C,IACIkmE,EADAhjE,GAAS,EAEb,UAAW,MAAMwB,KAASg+D,EAAc1iE,EAAQmmE,eAAen8E,EAAMk7E,GAAallE,EAAQomE,uBACtFljE,IACc,IAAVA,GAQe,IAAVA,GAA4B,MAAZgjE,SAEf,IACCA,EACHlhC,WAAO1rC,EACPovB,YAAQpvB,GAEZ4sE,OAAW5sE,QAGT,IACCoL,EACHsgC,WAAO1rC,IAlBP4sE,EAAW,IACJxhE,EACHgkB,QAAQ,GAmBJ,MAAZw9C,UACMA,EAEd,CAoG0BG,CAAer8E,EAAMg7C,EAAOhlC,GAhGvC,EAAChW,EAAMk7E,EAAYllE,IACdnQ,eAAgBy2E,GAC5B,GAAsB,IAAlBA,EAAOz9E,QAAgBk9E,GAAoBO,EAAO,KAAOtmE,EAAQumE,uBAAwB,CACzF,MAAMC,EAAOF,EAAO,GACpB,IAAIjsE,EAAOmsE,EAAKxhC,MAsBhB,OArBI+gC,GAAoBS,SAAyBltE,IAAftP,EAAKw5E,YAAqClqE,IAAdtP,EAAKyxB,OAG/D+qD,EAAKjB,OAAS,IAAIpB,EAAO,CACrBrjE,KAAM,OACN0iE,MAAOx5E,EAAKw5E,MACZ/nD,KAAMzxB,EAAKyxB,KACXpN,KAAMm4D,EAAKxhC,QAEf3qC,EAAO,CAAEgxD,KAAMmb,EAAKjB,OAAO/Z,UAAWma,MAAO,IAC7Ca,EAAKxhC,OAAQ,IAAArkC,SAAO,IAAAklE,SAAQxrE,IAC5BmsE,EAAK3f,UAAYoe,GAAQuB,EAAKxhC,MAAOkgC,EAAY,IAC1CllE,EACHmlE,WAAYnlE,EAAQmlE,aAExBqB,EAAKn9E,KAAOwqB,OAAO2yD,EAAKxhC,MAAMn8C,SAElCmX,EAAQwlE,aAAa,IAAI,IAAoB,uCAAwC,CACjF3e,IAAK2f,EAAK3f,IACVjmC,KAAM4lD,EAAKV,gBAER,CACHjf,IAAK2f,EAAK3f,IACVjmC,KAAM52B,EAAK42B,KACX2kD,OAAQiB,EAAKjB,OACbl8E,KAAMm9E,EAAKn9E,KACXy8E,aAAcU,EAAKV,aAE3B,CAEA,MAAMvJ,EAAI,IAAI4H,EAAO,CACjBrjE,KAAM,OACN0iE,MAAOx5E,EAAKw5E,MACZ/nD,KAAMzxB,EAAKyxB,OAETgrD,EAAQH,EACTx8D,QAAO08D,GACJA,EAAK3f,IAAI5mD,OAAS,GAAiBumE,EAAKn9E,KAAO,GAG/B,MAAfm9E,EAAKjB,QAAwC,MAApBiB,EAAKjB,OAAOl3D,MAAiBm4D,EAAKjB,OAAOV,WAAa,IAG7E/tE,QAAQ0vE,EAAKjB,QAAQl3D,MAAMxlB,UAEjC2jB,KAAKg6D,GACFA,EAAK3f,IAAI5mD,OAAS,GAElBs8D,EAAEoI,aAAa6B,EAAKn9E,MACb,CACHq9E,KAAM,GACNC,MAAO/rE,OAAO4rE,EAAKn9E,MACnBwyD,KAAM2qB,EAAK3f,OAGC,MAAf2f,EAAKjB,QAAwC,MAApBiB,EAAKjB,OAAOl3D,KAEtCkuD,EAAEoI,aAAa6B,EAAKjB,QAAQV,YAAc,IAI1CtI,EAAEoI,aAAa9wD,OAAO2yD,EAAKjB,OAAOl3D,KAAKxlB,SAEpC,CACH69E,KAAM,GACNC,MAAO/rE,OAAO4rE,EAAKn9E,MACnBwyD,KAAM2qB,EAAK3f,QAGbxsD,EAAO,CACTgxD,KAAMkR,EAAE/Q,UACRma,MAAOc,GAELzhC,GAAQ,IAAArkC,SAAO,IAAAklE,SAAQxrE,IACvBwsD,QAAYoe,GAAQjgC,EAAOkgC,EAAYllE,GAK7C,OAJAA,EAAQwlE,aAAa,IAAI,IAAoB,uCAAwC,CACjF3e,MACAjmC,KAAM52B,EAAK87E,gBAER,CACHjf,MACAjmC,KAAM52B,EAAK42B,KACX2kD,OAAQhJ,EACRlzE,KAAMwqB,OAAOmxB,EAAMn8C,OAASwR,EAAKsrE,MAAM3kD,QAAO,CAACtd,EAAK5S,IAAS4S,GAAO5S,EAAK61E,OAAS,IAAI,IACtFb,aAAc97E,EAAK87E,aACnB9gC,QAER,EAI4DhkB,CAAOh3B,EAAMg7C,EAAOhlC,IC/HpF,SAAS4mE,GAAuBtB,GAC5B,IACI,GAAIA,aAAmBl5E,WACnB,OAAQyD,wBACEy1E,CACV,CAFO,GAIN,GAbOjI,EAaQiI,EAZjBl9E,OAAOohB,YAAY6zD,EAalB,OAAQxtE,wBACGy1E,CACX,CAFO,GAIN,GAfb,SAAyBjI,GACrB,OAAOj1E,OAAOgc,iBAAiBi5D,CACnC,CAaiB,CAAgBiI,GACrB,OAAOA,CAEf,CACA,MACI,MAAM,EAAQ,IAAIn7E,MAAM,uBAAwB,sBACpD,CAxBJ,IAAoBkzE,EAyBhB,MAAM,EAAQ,IAAIlzE,MAAM,uBAAwB,sBACpD,CAiDA,SAAS08E,GAAgBniE,GACrB,OAAwB,MAAjBA,EAAM4gE,OACjB,iBC/EO,MAAMwB,GAAwB,IAC1Bj3E,gBAA+BE,GAClC,UAAW,MAAMu1E,KAAWv1E,EAAQ,CAChC,QAAuBuJ,IAAnBgsE,EAAQz8E,OACR,MAAM,EAAQ,IAAIsB,MAAM,uBAAwB,uBAEpD,GAAuB,iBAAZm7E,GAAwBA,aAAmBv8E,aAC5C,QAAqBu8E,EAAQ/uE,iBAElC,GAAI/L,MAAMuJ,QAAQuxE,SACbl5E,WAAWgM,KAAKktE,OAErB,MAAIA,aAAmBl5E,YAIxB,MAAM,EAAQ,IAAIjC,MAAM,uBAAwB,6BAH1Cm7E,CAIV,CACJ,CACJ,ECpBEyB,GAAgC,IAC/B,SAASC,GAAShnE,GACrB,MAAMinE,EAAqBjnE,GAASinE,oBAAsBF,GAC1D,OAAOl3E,eAAeq3E,EAAen3E,EAAQixB,GACzC,MAAM1tB,EAAQ,GACd,UAAW,MAAM6zE,KAAW,EAAMp3E,EAAQk3E,GACtC3zE,EAAMhK,WAAW03B,EAAOmmD,IAE5B,OAAI7zE,EAAMzK,OAAS,EACRq+E,EAAe5zE,EAAO0tB,GAE1B1tB,EAAM,EACjB,CACJ,CCbO,MAAM8zE,GACTpnE,QACAqnE,KACA93D,IACAqR,KACA0mD,MACAC,KACAv8D,OACAw8D,UACAjC,OACA9pD,KACA+nD,MACA3c,IACAx9D,KACAo+E,SACA/1E,YAAYgpC,EAAO16B,GACfpO,KAAKoO,QAAUA,GAAW,CAAC,EAC3BpO,KAAKy1E,KAAO3sC,EAAM2sC,KAClBz1E,KAAK2d,IAAMmrB,EAAMnrB,IACjB3d,KAAKgvB,KAAO8Z,EAAM9Z,KAClBhvB,KAAK01E,MAAQ5sC,EAAM4sC,MACnB11E,KAAK21E,KAAO7sC,EAAM6sC,KAClB31E,KAAKoZ,OAAS0vB,EAAM1vB,OACpBpZ,KAAK41E,UAAY9sC,EAAM8sC,UACvB51E,KAAK2zE,OAAS7qC,EAAM6qC,OACpB3zE,KAAK6pB,KAAOif,EAAMjf,KAClB7pB,KAAK4xE,MAAQ9oC,EAAM8oC,KACvB,EAMG,MAAMkE,GAAS5gB,GAAIlpC,MAAM,kDACnB+pD,GAAS7gB,GAAIlpC,MAAM,qDC/BzB,MAAMgqD,WAAgBR,GACzBS,UACAn2E,YAAYgpC,EAAO16B,GACfuE,MAAMm2B,EAAO16B,GACbpO,KAAKi2E,UAAY,IAAI37D,GACzB,CACArc,UAAUoB,EAAMR,GACZmB,KAAKi1D,SAAMvtD,EACX1H,KAAKvI,UAAOiQ,EACZ1H,KAAK61E,cAAWnuE,EAChB1H,KAAKi2E,UAAUp6E,IAAIwD,EAAMR,EAC7B,CACAZ,UAAUoB,GACN,OAAOmS,QAAQC,QAAQzR,KAAKi2E,UAAUt1E,IAAItB,GAC9C,CACA62E,aACI,OAAOl2E,KAAKi2E,UAAUx+E,IAC1B,CACA0+E,sBACI,OAAOn2E,KAAKk2E,YAChB,CACAE,YACI,OAAOp2E,KAAKi2E,UAAUt6E,SAAS0P,OAAOxM,KAC1C,CACAZ,wBACI,IAAK,MAAOkQ,EAAKugC,KAAU1uC,KAAKi2E,UAAUpjE,eAChC,CACF1E,MACAugC,QAGZ,CACA2nC,mBACI,QAAsB3uE,IAAlB1H,KAAK61E,SACL,OAAO71E,KAAK61E,SAEhB71E,KAAK61E,SAAW,EAGhB,IAAK,MAAOx2E,EAAMqvC,KAAU1uC,KAAKi2E,UAAUpjE,UACrB,MAAd67B,EAAMj3C,MAA8B,MAAbi3C,EAAMumB,MAC7Bj1D,KAAK61E,UAAYx2E,EAAKpI,QAAsC,IAA5B+I,KAAKoO,QAAQmlE,WAAmBwC,GAAOxyE,MAAMsJ,WAAaipE,GAAOvyE,MAAMsJ,aAG/G,OAAO7M,KAAK61E,QAChB,CACA53E,YAAam1C,GACT,MAAMyhC,EAAQ,GACd,IAAK,MAAOx1E,EAAMqvC,KAAU1uC,KAAKi2E,UAAUpjE,UAAW,CAClD,IAAI+G,EAAS80B,EACb,GAAIA,aAAiB8mC,GACjB,UAAW,MAAM1iE,KAAS47B,EAAM4nC,MAAMljC,GAClCx5B,EAAS9G,QACHA,EAGK,MAAf8G,EAAOniB,MAA+B,MAAdmiB,EAAOq7C,KAC/B4f,EAAMn9E,KAAK,CACPo9E,KAAMz1E,EACN01E,MAAO/rE,OAAO4Q,EAAOniB,MACrBwyD,KAAMrwC,EAAOq7C,KAGzB,CACA,MAAM0e,EAAS,IAAIpB,EAAO,CACtBrjE,KAAM,YACN0iE,MAAO5xE,KAAK4xE,MACZ/nD,KAAM7pB,KAAK6pB,OAETphB,EAAO,CAAEgxD,KAAMka,EAAO/Z,UAAWma,MAAOc,GACxCl+E,GAAS,IAAAoY,SAAO,IAAAklE,SAAQxrE,IACxBwsD,QAAYoe,GAAQ18E,EAAQy8C,EAAOpzC,KAAKoO,SACxC3W,EAAOd,EAAOM,OAASwR,EAAKsrE,MAAM3kD,QAKxC,CAACtd,EAAK5S,IAAS4S,GAAqB,MAAd5S,EAAK61E,MAAgB,EAAI71E,EAAK61E,QAAQ,GAC5D/0E,KAAKi1D,IAAMA,EACXj1D,KAAKvI,KAAOA,OACN,CACFw9D,MACA0e,SACA3kD,KAAMhvB,KAAKgvB,KACXv3B,KAAMwqB,OAAOxqB,GAErB,EC1FJ,MAAM,GAAQ,IAAI+C,WAAW,GAUvB,GAAU28D,IACd,MAAMic,EAAQjc,EAAIr3B,MAAM,OACxB,OAAOszC,EAAQ,IAAI54E,WAAW44E,EAAMx4D,KAAI0B,GAAK5V,SAAS4V,EAAG,OAAQ,ICZnE,IAAI,GAOJ,SAAS,EAAOqqB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAO,IACX1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,GAAO,IAET,KAAMA,EAAM,IACV1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBI,GAAM,IAEN,IAAS,IACT,GAAMhD,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAAS,EAAK/oB,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADA,EAAKruB,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAI,KAAWld,GACfkd,EAAI,IAAUrjB,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAK,IAId,OAFA,EAAK/Y,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BI,GAAQ,IACR,GAAS,IA2Bb,IAAI,GAAKnmB,KAAK6qB,IAAI,EAAI,GAClB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQ,GACR3C,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACA,EAEjB,GCzEO,MAUM,GAAW,CAACs1D,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI,GAAkB8hD,GACtB,kBAAsBA,GCjBlB,GAAS,CAAC9lD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAuDtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,EC/EK,MAAM,GAAO,EAAGlE,OAAMgP,OAAMU,YAAa,IAAI,GAAO1P,EAAMgP,EAAMU,GAWhE,MAAM,GAOXjP,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,ECyEF,IAIA,GAzHA,SAAeq2D,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECxGA,MAAM,GAMJS,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM,GAMJuH,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,EAaF,MAAM,GAIJzwD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAM,GAAK,CAACC,EAAMC,IAAU,IAAI,GAA4C,IAC7ED,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAM,GAOX7wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAI,GAAQxxD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAI,GAAQlxD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAM,GAAO,EAAGsD,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAI,GAAM/M,EAAMma,EAAQzK,EAAQ3C,GAWrB,GAAQ,EAAGoN,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,GAAMob,EAAUnoB,GAC3C,OAAO,GAAK,CACVma,SACAna,OACA0P,SAIA3C,OAAQ0tB,GN5LG/7B,KACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EMsLjC,CAAO6T,EAAO0tB,KAC/B,EA4GU,GAAU,EAAGz6B,OAAMma,SAAQw3C,cAAaxpC,cAC5C,GAAK,CACVhO,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI,CAAOF,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DI,CAAOF,EAAOyrB,EAAUwpC,EAAa3xD,KCrVzB,GAAM,CAC7BA,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGgB,GAAM,CAChCnoB,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCTU,GAAQ,CAC5BhO,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGY,GAAQ,CACjCx3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGU,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGe,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGU,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGe,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGa,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkB,GAAQ,CACvCx3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQ,GAAQ,CAC7Bx3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,ICRD,IAAI1gC,QAwBX,MAAM,GAQXxwB,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAAS,gBACX,MAAM,IAAI9V,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAAS,iBACrB,MAAM,IAAI9V,MAAM,sDAGlB,OACE,GAAIg9D,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAYD,OAAO31D,OAAO0P,EAAMg8C,GACtC,OACE,GAAIoL,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAO,GAAI10C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SACzBorC,OAAOtzC,OAAOvb,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAO,WAAO70D,KAAM60D,EACtB,CAEArzC,SACE,MAAO,CAAE,IAAK,WAAOxhB,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiB,GAEnB,OAAOA,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAI,GACTqqB,EACA7a,EACwC,EACxC9K,GAAS,cAAU2lB,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAM,eAAqB,CAIpC,MAAM,QAAEqqB,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEHiK,OAAOloD,OAAOmoD,GACjB,OAAO,GAAI51D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAAS,gBACX,MAAM,IAAI9V,MACR,wCAAwC,mCAG1C,OAAO,IAAI,GAAI2wB,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQ,cAAU2lB,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI,GAAI2lB,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO,GAAI1rD,OAAO,EAAG,gBAAa0rD,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO,GAAI1rD,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAa,GAAIC,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQ,GAAIC,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiBvzB,OACrBz/B,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,OAAOA,OACxB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACF,GAAIqsC,SAAyD,GAC7D,GAAIE,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAUs/E,OAAOnqE,OAAOwqD,EAAat/D,SAASJ,IAExD,OADUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,gBAS7B,GARuC,KAAd,GAEI,EAClB,GAEiBtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAAS,oBAAgBpF,EAAQ02D,GAE1CI,EAAM,GAAI7oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFA,cAAU08D,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAqGgBz+D,OAAOkqD,IAAI,oCCjkBJ,GAAK,CAC5BrhD,KAAM,aACNgP,KAAM,GACNU,OAAShT,GAZX,SAA+BotD,GAC7B,MAAM5lD,EAAQ,IAAI3K,MAAM,GACxB,IAAK,IAAI0C,EAAI,EAAGA,EAAI,EAAGA,IACrBiI,EAAMjI,GAAc,IAAT6tD,EACXA,IAAmB,EAErB,OAAO,IAAI3uD,WAAW+I,EACxB,CAKqBizE,CAAqB,cAAez6E,MAHlD,MAMM06E,GAAa,GAAK,CAC7Bp3E,KAAM,cACNgP,KAAM,GACNU,OAAShT,GAAU,GAAc,eAAgBA,MAI1B,GAAK,CAC5BsD,KAAM,iBACNgP,KAAM,GACNU,OAAShT,GAAU,GAAc,eAAgBA,IAAQzE,SAAS,EAAG,qBC5BvE2G,eAAey4E,GAAW37E,GACtB,aAAc07E,GAAW1nE,OAAOhU,IAI3BjC,MAAM,EAAG,GAETmiB,SACT,CACA,MAAM07D,GAAiB10D,OAAO,IAqD9B,OAnDA,cAAyBuzD,GACrBoB,QACA92E,YAAYgpC,EAAO16B,GACfuE,MAAMm2B,EAAO16B,GACbpO,KAAK42E,SAAU,QAAW,CACtBC,OAAQH,GACRn0E,KAAM6L,EAAQ0oE,iBAPE,GASxB,CACA74E,UAAUoB,EAAMR,GACZmB,KAAKi1D,SAAMvtD,EACX1H,KAAKvI,UAAOiQ,EACZ1H,KAAK61E,cAAWnuE,QACV1H,KAAK42E,QAAQ1oE,IAAI7O,EAAMR,EACjC,CACAZ,UAAUoB,GACN,OAAOW,KAAK42E,QAAQj2E,IAAItB,EAC5B,CACA62E,aACI,OAAOl2E,KAAK42E,QAAQG,WACxB,CACAZ,sBACI,OAAOn2E,KAAK42E,QAAQI,eACxB,CACAZ,YACI,OAAOp2E,KAAK42E,QAAQR,WACxB,CACAn4E,wBACI,UAAW,MAAM,IAAEkQ,EAAG,MAAEtP,KAAWmB,KAAK42E,QAAQK,sBACtC,CACF9oE,MACAugC,MAAO7vC,EAGnB,CACAw3E,mBACI,YAAsB3uE,IAAlB1H,KAAK61E,WAGT71E,KAAK61E,SAAW1N,GAAcnoE,KAAK42E,QAAS52E,KAAMA,KAAKoO,UAF5CpO,KAAK61E,QAIpB,CACA53E,YAAaq1E,GACT,UAAW,MAAMxgE,KAASwjE,GAAMt2E,KAAK42E,QAAStD,EAAYtzE,KAAMA,KAAKoO,cAC3D,IACC0E,EACHkc,KAAMhvB,KAAKgvB,KAGvB,GAGJ/wB,eAAgBq4E,GAAMY,EAAQ5D,EAAY6D,EAAW/oE,GACjD,MAAMgpE,EAAWF,EAAOjB,UAClBoB,GAAaH,EAAOI,YAAc,GAAG3yE,SAAS,IAAI1N,OAClD49E,EAAQ,GACd,IAAI0C,EAAe,GACnB,IAAK,IAAIj8E,EAAI,EAAGA,EAAI87E,EAASngF,OAAQqE,IAAK,CACtC,MAAMozC,EAAQ0oC,EAASz2E,IAAIrF,GAC3B,GAAa,MAATozC,EACA,SAEJ,MAAM8oC,EAAcl8E,EAAEqJ,SAAS,IAAI+1B,cAAc+8C,SAASJ,EAAW,KACrE,GAAI3oC,aAAiB,KAAQ,CACzB,IAAIgpC,EACJ,UAAW,MAAMC,KAAYrB,GAAM5nC,EAAO4kC,EAAY,KAAMllE,GACxDspE,EAAQC,EAEZ,GAAa,MAATD,EACA,MAAM,IAAIn/E,MAAM,wDAEpBs8E,EAAMn9E,KAAK,CACPo9E,KAAM0C,EACNzC,MAAO/rE,OAAO0uE,EAAMjgF,MACpBwyD,KAAMytB,EAAMziB,MAEhBsiB,GAAgBG,EAAMjgF,IAC1B,MACK,GA0DmB,mBA1DTi3C,EAAM7vC,MA0DPy3E,MA1De,CACzB,MAAM34D,EAAM+wB,EAAM7vC,MAClB,IAAI+4E,EACJ,UAAW,MAAM9kE,KAAS6K,EAAI24D,MAAMhD,GAChCsE,EAAa9kE,QACP8kE,EAEV,GAAkB,MAAdA,EACA,MAAM,IAAIr/E,MAAM,qBAEpB,MAAMs/E,EAAQL,EAAc9oC,EAAMvgC,IAClC0mE,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAO4uE,EAAWngF,MACzBwyD,KAAM2tB,EAAW3iB,MAErBsiB,GAAgBK,EAAWngF,IAC/B,KACK,CACD,MAAMoH,EAAQ6vC,EAAM7vC,MACpB,GAAiB,MAAbA,EAAMo2D,IACN,SAEJ,MAAM4iB,EAAQL,EAAc9oC,EAAMvgC,IAC5B1W,EAAOoH,EAAMpH,KACnBo9E,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAOvR,GACdwyD,KAAMprD,EAAMo2D,MAEhBsiB,GAAgBt1D,OAAOxqB,GAAQ,EACnC,CACJ,CAGA,MAAMglB,EAAOjiB,WAAWgM,KAAK4wE,EAASU,WAAW78D,WAC3C0C,EAAM,IAAI40D,EAAO,CACnBrjE,KAAM,yBACNuN,OACAk1D,OAAQ1vD,OAAOi1D,EAAOI,aACtB5F,SAAUiF,GACV/E,MAAOuF,GAAWvF,MAClB/nD,KAAMstD,GAAWttD,OAEfphB,EAAO,CACTgxD,KAAM97C,EAAIi8C,UACVma,MAAOc,GAELl+E,GAAS,IAAAoY,SAAO,IAAAklE,SAAQxrE,IACxBwsD,QAAYoe,GAAQ18E,EAAQ28E,EAAYllE,GACxC3W,EAAOwqB,OAAOtrB,EAAOkW,YAAc0qE,OACnC,CACFtiB,MACA0e,OAAQh2D,EACRlmB,OAER,CAIA,SAAS0wE,GAAc+O,EAAQC,EAAW/oE,GACtC,MAAMgpE,EAAWF,EAAOjB,UAClBoB,GAAaH,EAAOI,YAAc,GAAG3yE,SAAS,IAAI1N,OAClD49E,EAAQ,GACd,IAAK,IAAIv5E,EAAI,EAAGA,EAAI87E,EAASngF,OAAQqE,IAAK,CACtC,MAAMozC,EAAQ0oC,EAASz2E,IAAIrF,GAC3B,GAAa,MAATozC,EACA,SAEJ,MAAM8oC,EAAcl8E,EAAEqJ,SAAS,IAAI+1B,cAAc+8C,SAASJ,EAAW,KACrE,GAAI3oC,aAAiB,KAAQ,CACzB,MAAMj3C,EAAO0wE,GAAcz5B,EAAO,KAAMtgC,GACxCymE,EAAMn9E,KAAK,CACPo9E,KAAM0C,EACNzC,MAAO/rE,OAAOvR,GACdwyD,KAA6B,IAAvB77C,EAAQmlE,WAAmBuC,GAASC,IAElD,MACK,GAAiC,mBAAtBrnC,EAAM7vC,MAAMy3E,MAAsB,CAC9C,MACM7+E,EADMi3C,EAAM7vC,MACDg3E,WACjBhB,EAAMn9E,KAAK,CACPo9E,KAAM0C,EAAc9oC,EAAMvgC,IAC1B4mE,MAAO/rE,OAAOvR,GACdwyD,KAA6B,IAAvB77C,EAAQmlE,WAAmBuC,GAASC,IAElD,KACK,CACD,MAAMl3E,EAAQ6vC,EAAM7vC,MACpB,GAAiB,MAAbA,EAAMo2D,IACN,SAEJ,MAAM4iB,EAAQL,EAAc9oC,EAAMvgC,IAC5B1W,EAAOoH,EAAMpH,KACnBo9E,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAOvR,GACdwyD,KAAMprD,EAAMo2D,KAEpB,CACJ,CAGA,MAAMx4C,EAAOjiB,WAAWgM,KAAK4wE,EAASU,WAAW78D,WAC3C0C,EAAM,IAAI40D,EAAO,CACnBrjE,KAAM,yBACNuN,OACAk1D,OAAQ1vD,OAAOi1D,EAAOI,aACtB5F,SAAUiF,GACV/E,MAAOuF,GAAWvF,MAClB/nD,KAAMstD,GAAWttD,OAMrB,OAJe,IAAA9a,SAAO,IAAAklE,SAAQ,CAC1Bxa,KAAM97C,EAAIi8C,UACVma,MAAOc,KAEG59E,MAClB,CClNOgH,eAAe85E,GAAYrpC,EAAO/wB,EAAKq6D,EAAW5pE,GACrD,IAAI6pE,EAASt6D,EACTA,aAAeq4D,IAAWr4D,EAAI04D,mBAAqB2B,IACnDC,QAiBRh6E,eAA8Bi6E,EAAQ9pE,GAClC,MAAM6pE,EAAS,IAAI,GAAW,CAC1BxC,KAAMyC,EAAOzC,KACb93D,KAAK,EACLvE,OAAQ8+D,EAAO9+D,OACfw8D,UAAWsC,EAAOtC,UAClB5mD,KAAMkpD,EAAOlpD,KACb0mD,MAAOwC,EAAOxC,MACdC,MAAM,EACN/D,MAAOsG,EAAOtG,MACd/nD,KAAMquD,EAAOruD,MACdzb,GACH,UAAW,MAAM,IAAED,EAAG,MAAEugC,KAAWwpC,EAAOC,wBAChCF,EAAO/pE,IAAIC,EAAKugC,GAE1B,OAAOupC,CACX,CAjCuBG,CAAez6D,EAAKvP,IAEvC,MAAMgL,EAAS6+D,EAAO7+D,OACtB,GAAc,MAAVA,EAAgB,CAChB,GAAI6+D,IAAWt6D,EAAK,CAIhB,GAHa,MAAT+wB,IACAA,EAAMt1B,OAAS6+D,GAEK,MAApBA,EAAOrC,UACP,MAAM,IAAIr9E,MAAM,6BAEd6gB,EAAOlL,IAAI+pE,EAAOrC,UAAWqC,EACvC,CACA,OAAOF,GAAYE,EAAQ7+D,EAAQ4+D,EAAW5pE,EAClD,CACA,OAAO6pE,CACX,CCrBO,MAAMI,GAAmB,CAACrpD,EAAO,KAE7BA,EAAK/vB,MAAM,aAAaiZ,OAAOhT,SCE1CjH,eAAeq6E,GAAUt5E,EAAMu5E,EAAMnqE,GACjC,MAAMoqE,EAAYH,GAAiBr5E,EAAKgwB,MAAQ,IAC1CypD,EAAYD,EAAUvhF,OAAS,EACrC,IAAImiB,EAASm/D,EACTG,EAAc,GAClB,IAAK,IAAIp9E,EAAI,EAAGA,EAAIk9E,EAAUvhF,OAAQqE,IAAK,CACvC,MAAMq9E,EAAWH,EAAUl9E,GAC3Bo9E,GAAe,GAAmB,KAAhBA,EAAqB,IAAM,KAAKC,IAClD,MAAMnhF,EAAQ8D,IAAMm9E,EAIpB,GAHAr/D,EAAOs8D,OAAQ,EACft8D,EAAO67C,SAAMvtD,EACb0R,EAAO3hB,UAAOiQ,EACVlQ,QACM4hB,EAAOlL,IAAIyqE,EAAU35E,GAC3Bu5E,QAAaR,GAAY,KAAM3+D,EAAQhL,EAAQwqE,yBAA0BxqE,OAExE,CACD,IAAIuP,QAAYvE,EAAOzY,IAAIg4E,GACf,MAAPh7D,GAAkBA,aAAe63D,KAClC73D,EAAM,IAAIq4D,GAAQ,CACdP,MAAM,EACN93D,KAAK,EACLvE,SACAw8D,UAAW+C,EACX3pD,KAAM0pD,EACNhD,OAAO,EACPC,MAAM,EACN/D,MAAOj0D,GAAKg2D,QAAQ/B,MACpB/nD,KAAMlM,GAAKg2D,QAAQ9pD,MACpBzb,UAEDgL,EAAOlL,IAAIyqE,EAAUh7D,GAC3BvE,EAASuE,CACb,CACJ,CACA,OAAO46D,CACX,CACAt6E,eAAgB46E,GAAcN,EAAMjF,GAC1BiF,aAAgB/C,SAMf+C,EAAKjC,MAAMhD,IALqB,IAA/BiF,EAAK5E,QAAQb,sBACPyF,EAKlB,CCbOt6E,eAAgB66E,GAAS36E,EAAQm1E,EAAYllE,EAAU,CAAC,GAC3D,IAAI2qE,EAEAA,EADAviF,OAAOgc,iBAAiBrU,GAAU3H,OAAOohB,YAAYzZ,EACxCA,EAGA,CAACA,GAElB,MAAM66E,EAAoB5qE,EAAQ4qE,oBAAqB,EACjDJ,EAA2BxqE,EAAQwqE,0BAA4B,OAC/D9B,EAAkB1oE,EAAQ0oE,iBAAmB,EAC7CvD,EAAanlE,EAAQmlE,YAAc,EACnCM,EAAYzlE,EAAQylE,YAAa,EACjCC,EAAW1lE,EAAQ0lE,UAAY,OAC/BmF,EAAwB7qE,EAAQ6qE,uBAAyB,GACzDzE,EAAwBpmE,EAAQomE,uBAAyB,GACzDG,EAAyBvmE,EAAQumE,yBAA0B,EAC3DuE,EAAU9qE,EAAQ8qE,SAAWnI,IAC7BoI,EAAiB/qE,EAAQ+qE,gBAAkBjE,KAC3CkE,EAAWhrE,EAAQirE,YpBxBtB,SAA2BjrE,GAC9B,OAAOnQ,gBAA2BE,EAAQm1E,GACtC,UAAW,MAAMxgE,KAAS3U,EAAQ,CAC9B,IAAI+1E,EAQJ,GAPkB,MAAdphE,EAAMkc,OACNklD,EAAephE,EAAMkc,KACrBlc,EAAMkc,KAAOlc,EAAMkc,KACd/vB,MAAM,KACNiZ,QAAO8W,GAAgB,MAARA,GAAyB,MAATA,IAC/Br3B,KAAK,MAEVs9E,GAAgBniE,GAAQ,CACxB,MAAM1a,EAAO,CACT42B,KAAMlc,EAAMkc,KACZ4iD,MAAO9+D,EAAM8+D,MACb/nD,KAAM/W,EAAM+W,KACZ6pD,QAAS,kBACL,IAAI4F,EAAY,GAChB,UAAW,MAAMvS,KAAS34D,EAAQ8qE,QAAQ9qE,EAAQ+qE,eAAenE,GAAuBliE,EAAM4gE,WAAY,CACtG,MAAM6F,EAAmBt3D,OAAO8kD,EAAMl6D,YACtCysE,GAAaC,EACbnrE,EAAQwlE,aAAa,IAAI,IAAoB,qCAAsC,CAC/E0F,YACAtI,UAAWuI,EACXvqD,KAAMlc,EAAMkc,cAEV+3C,CACV,CACH,CAZQ,GAaTmN,sBAEEj2E,SAAYm2E,GAAYh8E,EAAMk7E,EAAYllE,EACpD,KACK,IAAkB,MAAd0E,EAAMkc,KAUX,MAAM,IAAIz2B,MAAM,sDAVS,CACzB,MAAMolB,EAAM,CACRqR,KAAMlc,EAAMkc,KACZ4iD,MAAO9+D,EAAM8+D,MACb/nD,KAAM/W,EAAM+W,KACZqqD,sBAEEj2E,SAAY+1E,GAAWr2D,EAAK21D,EAAYllE,EAClD,CAGA,CACJ,CACJ,CACJ,CoBvB2CorE,CAAkB,CACrDN,UACAC,iBACAH,oBACA3E,OAAQjmE,EAAQimE,QAAUe,KAC1Bb,eAAgBnmE,EAAQmmE,gBAAkBf,GAAsB,CAC5DD,aACAM,YACAC,WACAF,WAAYxlE,EAAQwlE,aAExBY,wBACAG,yBACApB,aACAK,WAAYxlE,EAAQwlE,aAElB6F,EAAYrrE,EAAQsrE,aDrBvB,SAA4BtrE,GAC/B,OAAOnQ,gBAA4BE,EAAQi1C,GACvC,IAOIumC,EAPApB,EAAO,IAAIvC,GAAQ,CACnBP,MAAM,EACN93D,KAAK,EACLqR,KAAM,GACN0mD,OAAO,EACPC,MAAM,GACPvnE,GAECwrE,GAAa,EACjB,UAAW,MAAM9mE,KAAS3U,EAAQ,CAC9B,GAAa,MAAT2U,EACA,SAIJ,MAAM6K,EAAM,GAAG7K,EAAMohE,cAAgB,KAAKj1E,MAAM,KAAK,GAC1C,MAAP0e,GAAuB,KAARA,IACA,MAAXg8D,GACAA,EAAUh8D,EACVi8D,GAAa,GAERD,IAAYh8D,IACjBi8D,GAAa,IAGrBrB,QAAaD,GAAUxlE,EAAOylE,EAAMnqE,GAChB,MAAhB0E,EAAM6gE,QAAmB7gE,EAAM6gE,OAAOb,sBAChChgE,EAEd,CACA,GAAI1E,EAAQ4qE,mBAAsBY,GAAcrB,EAAKrC,aAAe,QACzD2C,GAAcN,EAAMnlC,QAG3B,UAAW,MAAMymC,KAAatB,EAAKJ,kBACd,MAAb0B,UAGGhB,GAAcgB,EAAUnrC,MAAO0E,GAGlD,CACJ,CCvB6C0mC,CAAmB,CACxDd,oBACAJ,2BACA9B,kBACAvD,aACAK,WAAYxlE,EAAQwlE,aAExB,UAAW,MAAM9gE,KAAS2mE,EAAU3I,EAAcsI,EAASL,EAAYzF,GAAa2F,GAAwB3F,QAClG,CACFre,IAAKniD,EAAMmiD,IACXjmC,KAAMlc,EAAMkc,KACZ2kD,OAAQ7gE,EAAM6gE,OACdl8E,KAAMqb,EAAMrb,KAGxB,CAuBOwG,eAAe87E,GAAWrG,EAASJ,EAAYllE,EAAU,CAAC,GAC7D,MAAMwL,QAAe,EAAMk/D,GAAS,CAACpF,GAAUJ,EAAYllE,IAC3D,GAAc,MAAVwL,EACA,MAAM,EAAQ,IAAIrhB,MAAM,oBAAqB,sBAEjD,OAAOqhB,CACX,UC3FO,MClBDogE,GAA0B,CAC5BzG,WAAY,EACZM,WAAW,EACXQ,OAAQe,GAAS,CACbC,mBAAoB,OAExB6D,QAASnI,EAAU,CACfC,UAAW,WASZ/yE,eAAeg8E,GAAS12E,EAAO+vE,EAAYllE,EAAU,CAAC,GACzD,MAAM,IAAE6mD,SF2ILh3D,eAA2BlD,EAAKu4E,EAAYllE,EAAU,CAAC,GAC1D,OAAO2rE,GAAW,CACdrG,QAAS34E,GACVu4E,EAAYllE,EACnB,CE/I0B8rE,CAAY32E,EAAO+vE,EAAY,IAC9C0G,MACA5rE,IAEP,OAAO6mD,CACX,CACOh3D,eAAek8E,GAAc52E,EAAO+vE,EAAYllE,EAAU,CAAC,GAC9D,MAAM,IAAE6mD,SF8JLh3D,eAAgCm8E,EAAM9G,EAAYllE,EAAU,CAAC,GAChE,OAAO2rE,GAAW,CACdrG,QAAS0G,GACV9G,EAAYllE,EACnB,CElK0BisE,CAAiB92E,EAAO+vE,EAAY,IACnD0G,MACA5rE,IAEP,OAAO6mD,CACX,CAQOh3D,eAAeq8E,GAAa38D,EAAK21D,EAAYllE,EAAU,CAAC,GAC3D,MAAM,IAAE6mD,SF6FLh3D,eAA+By1E,EAASJ,EAAYllE,EAAU,CAAC,GAClE,MAAMwL,QAAe,EAAMk/D,GAAS,CAACpF,GAAUJ,EAAYllE,IAC3D,GAAc,MAAVwL,EACA,MAAM,EAAQ,IAAIrhB,MAAM,oBAAqB,sBAEjD,OAAOqhB,CACX,CEnG0B2gE,CAAgB,IAC/B58D,EACHqR,KAAMrR,EAAIqR,MAAQ,KACnBskD,EAAY,IACR0G,MACA5rE,IAEP,OAAO6mD,CACX,CCjCA,OAhBA,SAAc92D,GACV,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,IAAI4M,EACJ,UAAW,MAAMtM,KAAS3U,EACtBihB,EAAMtM,EAEV,OAAOsM,CACV,EANM,GAQX,IAAIA,EACJ,IAAK,MAAMtM,KAAS3U,EAChBihB,EAAMtM,EAEV,OAAOsM,CACX,cCfA,MAYa0zC,GAZA,ECwDb,OAxDgB70D,MAAOg3D,EAAK51D,EAAM2vB,EAAMwrD,EAAW/oE,EAASgpE,EAAOnH,EAAYllE,KAC3E,MAAMglC,QAAckgC,EAAW3yE,IAAIs0D,EAAK7mD,GAClCmlB,EAAS,UAAe6f,GAC9B,IAAIsnC,EAAYnnD,EACZonD,EAAU3rD,EACd,KAAOwrD,EAAUvjF,OAAS,GAAG,CACzB,MAAMsS,EAAOixE,EAAU,GACvB,KAAIjxE,KAAQmxE,GA+BR,MAAM,EAAQ,IAAIniF,MAAM,qBAAqBgR,wBAA2B0rD,KAAQ,eA/B7D,CAEnBulB,EAAUp7E,QACVu7E,EAAU,GAAGA,KAAWpxE,IACxB,MAAMqxE,EAAe1lB,GAAIC,MAAMulB,EAAUnxE,IACzC,GAAoB,MAAhBqxE,EACA,MAAO,CACH9nE,MAAO,CACH5D,KAAM,SACN7P,OACA2vB,OACAimC,MACAxsD,KAAM2qC,EACNqnC,QACAhjF,KAAMwqB,OAAOmxB,EAAMn8C,QACnBy8E,QAASz1E,wBACCs1B,CACV,GAEJloB,KAAM,CACF4pD,IAAK2lB,EACLv7E,KAAMkK,EACNylB,KAAM2rD,EACNH,cAIZE,EAAYA,EAAUnxE,EAC1B,CAKJ,CACA,MAAO,CACHuJ,MAAO,CACH5D,KAAM,SACN7P,OACA2vB,OACAimC,MACAxsD,KAAM2qC,EACNqnC,QACAhjF,KAAMwqB,OAAOmxB,EAAMn8C,QACnBy8E,QAASz1E,wBACCs1B,CACV,GAEP,ECvCL,OAlBA,SAA8B6f,EAAOynC,EAAYC,EAAgBC,GAC7D,MAAMC,EAAc/4D,OAAOmxB,EAAMn8C,QAC3BgkF,EAAWh5D,OAAO44D,EAAaG,GACrC,OAAIF,GAAkBG,GAAYF,EAAeF,EAGtC,IAAIrgF,WAAW,IAEtBugF,GAAgBF,GAAcE,EAAeE,IAE7C7nC,EAAQA,EAAM97C,SAAS,EAAG0R,OAAO+xE,EAAeF,KAEhDC,GAAkBD,GAAcC,EAAiBG,IAEjD7nC,EAAQA,EAAM97C,SAAS0R,OAAO8xE,EAAiBD,KAE5CznC,EACX,ECWA,OA3BgC,CAAC37C,EAAMP,EAAS,EAAGD,EAASQ,KACxD,MAAMw7E,EAAWhxD,OAAOxqB,GAClB+L,EAAQye,OAAO/qB,GAAU,GAC/B,IAAIyL,EAAMsf,OAAOhrB,GAOjB,GANI0L,IAAQswE,IACRtwE,EAAMa,EAAQb,GAEdA,EAAMswE,IACNtwE,EAAMswE,GAENzvE,EAAQ,GACR,MAAM,EAAQ,IAAIjL,MAAM,6CAA8C,sBAE1E,GAAIiL,EAAQyvE,EACR,MAAM,EAAQ,IAAI16E,MAAM,0CAA2C,sBAEvE,GAAIoK,EAAM,GACN,MAAM,EAAQ,IAAIpK,MAAM,6CAA8C,sBAE1E,GAAIoK,EAAMswE,EACN,MAAM,EAAQ,IAAI16E,MAAM,0CAA2C,sBAEvE,MAAO,CACHiL,QACAb,MACH,ECUL,OAlBgB1E,MAAOg3D,EAAK51D,EAAM2vB,EAAMwrD,EAAW/oE,EAASgpE,EAAOnH,EAAYllE,KAC3E,GAAIosE,EAAUvjF,OAAS,EACnB,MAAM,EAAQ,IAAIsB,MAAM,iBAAiBy2B,uBAA0BimC,KAAQ,iBAE/E,MAAMl6D,EAAM,GAAUk6D,EAAIV,UAAUhxD,OACpC,MAAO,CACHuP,MAAO,CACH5D,KAAM,WACN7P,OACA2vB,OACAimC,MACAye,SAxBQjrE,EAwBY1N,EAAIsvD,OAvBhCpsD,gBAAiCmQ,EAAU,CAAC,GACxC,MAAM,MAAE5K,EAAK,IAAEb,GAAQ,GAAwB8F,EAAKxR,OAAQmX,EAAQlX,OAAQkX,EAAQnX,QAC9E8D,EAAM,GAAqB0N,EAAM,GAAIjF,EAAOb,GAClDyL,EAAQwlE,aAAa,IAAI,IAAoB,oCAAqC,CAC9E0F,UAAWr3D,OAAOlnB,EAAI8R,YACtBquE,WAAYv4E,EAAMa,EAClByvE,SAAUhxD,OAAOxZ,EAAKoE,qBAEpB9R,CACV,GAeQ0/E,QACAhjF,KAAMwqB,OAAOlnB,EAAIsvD,OAAOpzD,QACxBwR,KAAM1N,EAAIsvD,SA3BH,IAAC5hD,CA6Bf,ECCL,OAlBgBxK,MAAOg3D,EAAK51D,EAAM2vB,EAAMwrD,EAAW/oE,EAASgpE,EAAOnH,EAAYllE,KAC3E,GAAIosE,EAAUvjF,OAAS,EACnB,MAAM,EAAQ,IAAIsB,MAAM,iBAAiBy2B,uBAA0BimC,KAAQ,iBAE/E,MAAM7hB,QAAckgC,EAAW3yE,IAAIs0D,EAAK7mD,GACxC,MAAO,CACH0E,MAAO,CACH5D,KAAM,MACN7P,OACA2vB,OACAimC,MACAye,SAxBQjrE,EAwBY2qC,EAvB5Bn1C,gBAAiCmQ,EAAU,CAAC,GACxC,MAAM,MAAE5K,EAAK,IAAEb,GAAQ,GAAwB8F,EAAKxR,OAAQmX,EAAQlX,OAAQkX,EAAQnX,QAC9E8D,EAAM,GAAqB0N,EAAM,GAAIjF,EAAOb,GAClDyL,EAAQwlE,aAAa,IAAI,IAAoB,+BAAgC,CACzE0F,UAAWr3D,OAAOlnB,EAAI8R,YACtBquE,WAAYv4E,EAAMa,EAClByvE,SAAUhxD,OAAOxZ,EAAKoE,qBAEpB9R,CACV,GAeQ0/E,QACAhjF,KAAMwqB,OAAOmxB,EAAMn8C,QACnBwR,KAAM2qC,IA3BC,IAAC3qC,CA6Bf,ECjCL,MAAM,GAAQ,IAAIjO,WAAW,GAUvB,GAAU28D,IACd,MAAMic,EAAQjc,EAAIr3B,MAAM,OACxB,OAAOszC,EAAQ,IAAI54E,WAAW44E,EAAMx4D,KAAI0B,GAAK5V,SAAS4V,EAAG,OAAQ,ICZnE,IAAI,GAOJ,SAAS,EAAOqqB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAO,IACX1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,GAAO,IAET,KAAMA,EAAM,IACV1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBI,GAAM,IAEN,IAAS,IACT,GAAMhD,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAAS,EAAK/oB,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADA,EAAKruB,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAI,KAAWld,GACfkd,EAAI,IAAUrjB,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAK,IAId,OAFA,EAAK/Y,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BI,GAAQ,IACR,GAAS,IA2Bb,IAAI,GAAKnmB,KAAK6qB,IAAI,EAAI,GAClB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQ,GACR3C,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACA,EAEjB,GCzEO,MAUM,GAAW,CAACs1D,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI,GAAkB8hD,GACtB,kBAAsBA,GCjBlB,GAAS,CAAC9lD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAuDtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,EC/EK,MAAM,GAAO,EAAGlE,OAAMgP,OAAMU,YAAa,IAAI,GAAO1P,EAAMgP,EAAMU,GAWhE,MAAM,GAOXjP,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,ECyEF,IAIA,GAzHA,SAAeq2D,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECxGA,MAAM,GAMJS,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM,GAMJuH,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,EAaF,MAAM,GAIJzwD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAM,GAAK,CAACC,EAAMC,IAAU,IAAI,GAA4C,IAC7ED,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAM,GAOX7wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAI,GAAQxxD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAI,GAAQlxD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAM,GAAO,EAAGsD,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAI,GAAM/M,EAAMma,EAAQzK,EAAQ3C,GAWrB,GAAQ,EAAGoN,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,GAAMob,EAAUnoB,GAC3C,OAAO,GAAK,CACVma,SACAna,OACA0P,SAIA3C,OAAQ0tB,GN5LG/7B,KACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EMsLjC,CAAO6T,EAAO0tB,KAC/B,EA4GU,GAAU,EAAGz6B,OAAMma,SAAQw3C,cAAaxpC,cAC5C,GAAK,CACVhO,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI,CAAOF,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DI,CAAOF,EAAOyrB,EAAUwpC,EAAa3xD,KCrVzB,GAAM,CAC7BA,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGgB,GAAM,CAChCnoB,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCTU,GAAQ,CAC5BhO,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGY,GAAQ,CACjCx3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGU,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGe,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGU,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGe,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGa,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkB,GAAQ,CACvCx3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQ,GAAQ,CAC7Bx3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,ICRD,IAAI1gC,QAwBX,MAAM,GAQXxwB,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAAS,oBACX,MAAM,IAAI9V,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAAS,qBACrB,MAAM,IAAI9V,MAAM,sDAGlB,OACE,GAAIg9D,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAYD,OAAO31D,OAAO0P,EAAMg8C,GACtC,OACE,GAAIoL,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAO,GAAI10C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SACzBorC,OAAOtzC,OAAOvb,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAO,eAAO70D,KAAM60D,EACtB,CAEArzC,SACE,MAAO,CAAE,IAAK,eAAOxhB,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiB,GAEnB,OAAOA,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAI,GACTqqB,EACA7a,EACwC,EACxC9K,GAAS,kBAAU2lB,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAM,mBAAqB,CAIpC,MAAM,QAAEqqB,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEHiK,OAAOloD,OAAOmoD,GACjB,OAAO,GAAI51D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAAS,oBACX,MAAM,IAAI9V,MACR,wCAAwC,uCAG1C,OAAO,IAAI,GAAI2wB,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQ,kBAAU2lB,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI,GAAI2lB,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO,GAAI1rD,OAAO,EAAG,oBAAa0rD,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO,GAAI1rD,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAa,GAAIC,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQ,GAAIC,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiBvzB,OACrBz/B,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,OAAOA,OACxB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACF,GAAIqsC,SAAyD,GAC7D,GAAIE,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAUs/E,OAAOnqE,OAAOwqD,EAAat/D,SAASJ,IAExD,OADUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,oBAS7B,GARuC,KAAd,GAEI,EAClB,GAEiBtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAAS,wBAAgBpF,EAAQ02D,GAE1CI,EAAM,GAAI7oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFA,kBAAU08D,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAqGgBz+D,OAAOkqD,IAAI,oBCjkBJ,GAAK,CAC5BrhD,KAAM,aACNgP,KAAM,GACNU,OAAShT,GAZX,SAA+BotD,GAC7B,MAAM5lD,EAAQ,IAAI3K,MAAM,GACxB,IAAK,IAAI0C,EAAI,EAAGA,EAAI,EAAGA,IACrBiI,EAAMjI,GAAc,IAAT6tD,EACXA,IAAmB,EAErB,OAAO,IAAI3uD,WAAW+I,EACxB,CAKqB,CAAqB,cAAexH,MAHlD,MAMM,GAAa,GAAK,CAC7BsD,KAAM,cACNgP,KAAM,GACNU,OAAShT,GAAU,GAAc,eAAgBA,MCrB7C86E,IDyBmB,GAAK,CAC5Bx3E,KAAM,iBACNgP,KAAM,GACNU,OAAShT,GAAU,GAAc,eAAgBA,IAAQzE,SAAS,EAAG,KC5BxD2G,eAAgBlD,GAC3B,aAAc,UAAkBA,IAI3BjC,MAAM,EAAG,GAETmiB,SACT,GAmBMkgE,GAAW,CAACztC,EAAU2pC,IACjB3pC,EACF/oC,SAAS,IACT+1B,cACA+8C,SAASJ,EAAW,KACpB53E,UAAU,EAAG43E,GAYhB+D,GAAen9E,MAAOwK,EAAMpJ,EAAMi0E,EAAYjmC,EAASj/B,KACzD,GAAe,MAAXi/B,EAAiB,CACjB,GAAiB,MAAb5kC,EAAKgxD,KACL,MAAM,EAAQ,IAAIlhE,MAAM,qBAAsB,kBAElD,IAAIolB,EACJ,IACIA,EAAM40D,EAAO8I,UAAU5yE,EAAKgxD,KAChC,CACA,MAAO7zD,GACH,MAAM,EAAQA,EAAK,iBACvB,CACA,GAAiB,2BAAb+X,EAAIzO,KACJ,MAAM,EAAQ,IAAI3W,MAAM,cAAe,kBAE3C,GAAkB,MAAdolB,EAAIg0D,OACJ,MAAM,EAAQ,IAAIp5E,MAAM,kBAAmB,kBAE/C,MAAM+iF,GAAa,QAAW,CAC1BzE,UACAt0E,KAAMtJ,KAAKsiF,KAAKvyE,OAAO2U,EAAIg0D,WAE/BtkC,EAAU,CACNiuC,aACAE,UAAW,EACXC,WAAYH,EAEpB,CACA,MAAMjE,GAAahqC,EAAQouC,WAAWnE,YAAc,GAAG3yE,SAAS,IAAI1N,YA/D3CgH,OAAO42E,EAAOqC,EAAQoE,KAC/C,MAAMjE,GAAaH,EAAOI,YAAc,GAAG3yE,SAAS,IAAI1N,aAClDua,QAAQQ,IAAI6iE,EAAMj6D,KAAI3c,MAAO22D,IAC/B,GAAiB,MAAbA,EAAKkgB,KAEL,MAAM,IAAIv8E,MAAM,kCAEpB,GAAIq8D,EAAKkgB,KAAK79E,SAAWogF,QAQnBiE,EAAWptE,IAAI0mD,EAAKkgB,KAAKr1E,UAAU,IAAI,OAR7C,CACI,MAAMwC,EAAMyE,SAASkuD,EAAKkgB,KAAM,IAChCoC,EAAOwE,aAAaz5E,EAAK,IAAI,KAAO,CAChC3C,KAAMg8E,EAAWK,SAASr8E,KAC1BiD,KAAM+4E,EAAWK,SAASp5E,MAC3B20E,EAAQj1E,GAEf,CACkD,IACnD,EAgDG25E,CAAqBnzE,EAAKsrE,MAAO1mC,EAAQouC,WAAYpuC,EAAQiuC,YACnE,MAAM5tC,QAAiBL,EAAQiuC,WAAWO,qBAAqBx8E,GAC/D,IAAIma,EAAS2hE,GAASztC,EAASzrC,IAAKo1E,GACpC,MAAMyE,EA1CW,CAACpuC,IAClB,IAAIwpC,EAASxpC,EAASwpC,OACtB,MAAMloD,EAAO,GACb,KAAyB,MAAlBkoD,EAAO6E,SACV/sD,EAAKt3B,KAAKw/E,GACVA,EAASA,EAAO6E,QAGpB,OADA/sD,EAAKt3B,KAAKw/E,GACHloD,EAAK/T,SAAS,EAkCF+gE,CAAatuC,GAC5BouC,EAAW7kF,OAASo2C,EAAQmuC,YAC5BnuC,EAAQouC,WAAaK,EAAWzuC,EAAQmuC,WACxChiE,EAAS2hE,GAAS9tC,EAAQouC,WAAWQ,aAAc5E,IAEvD,MAAMziB,EAAOnsD,EAAKsrE,MAAM7T,MAAKtL,IACzB,GAAiB,MAAbA,EAAKkgB,KACL,OAAO,EAEX,MAAMoH,EAActnB,EAAKkgB,KAAKr1E,UAAU,EAAG43E,GACrC8E,EAAYvnB,EAAKkgB,KAAKr1E,UAAU43E,GACtC,OAAI6E,IAAgB1iE,IAIF,KAAd2iE,GAAoBA,IAAc98E,EAI3B,IAEf,GAAY,MAARu1D,EACA,OAEJ,GAAiB,MAAbA,EAAKkgB,MAAgBlgB,EAAKkgB,KAAKr1E,UAAU43E,KAAeh4E,EACxD,OAAOu1D,EAAK3K,KAEhB5c,EAAQmuC,YACR,MAAMpoC,QAAckgC,EAAW3yE,IAAIi0D,EAAK3K,KAAM77C,GAE9C,OADA3F,GAAO,IAAA2D,QAAOgnC,GACPgoC,GAAa3yE,EAAMpJ,EAAMi0E,EAAYjmC,EAASj/B,EAAQ,EAEjE,sBCpEA,OA1CA,SAAgBjQ,EAAQ6F,GACpB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMM,KAAS3U,QACZ6F,EAAG8O,WACHA,EAGjB,CANM,GASX,MAAM44D,GAAW,QAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GAEf,GAAwB,mBAAbugB,EAAIoO,KACX,OAAO,wBACOpO,UACAvgB,GAEV,UAAW,MAAMiU,KAAS44D,QACZ1nE,EAAG8O,WACHA,EAGjB,CATM,GAWX,MAAM4/B,EAAO1uC,EACb,OAAO,aACS,IAARob,UACMvgB,GAEV,IAAK,MAAMiU,KAAS44D,EACZh5B,EAAK5/B,WACCA,EAGjB,CATM,EAUX,ECTA,OAhCA,SAAa3U,EAAQu0C,GACjB,GAHsC,MAGlBv0C,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMpH,KAAOjN,QACdu0C,EAAKtnC,EAElB,CAJM,GAOX,MAAMsgE,GAAW,QAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMszB,EAAK7zC,GAEjB,GAAwB,mBAAbugB,EAAIoO,KACX,OAAO,8BACSpO,EACZ,UAAW,MAAMhU,KAAOsgE,QACdh5B,EAAKtnC,EAElB,CALM,GAOX,MAAMpH,EAAK0uC,EACX,OAAO,kBACGtzB,EACN,IAAK,MAAMhU,KAAOsgE,QACR1nE,EAAGoH,EAEhB,CALM,EAMX,0BCXA,OAnByB,CAAC6pD,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,IAC/Dr1E,gBAAsCmQ,EAAU,CAAC,GAC7C,MAAMlX,EAASkX,EAAQlX,QAAU,EAC3BD,EAASmX,EAAQnX,QAAUwR,EAAKsrE,MAAM98E,OACtC49E,EAAQpsE,EAAKsrE,MAAMj7E,MAAM5B,EAAQD,GACvCmX,EAAQwlE,aAAa,IAAI,IAAoB,iCAAkC,CAC3E3e,gBAEG,QAAK4f,GAAO12E,GAAU,GAAIA,GAAQy2D,GAC9B32D,UACH,MAAMm+E,EAAWxnB,EAAKkgB,MAAQ,GACxBuH,EAAW,GAAGrtD,KAAQotD,IAE5B,aADqB3qE,EAAQmjD,EAAK3K,KAAMmyB,EAAUC,EAAU,GAAI5B,EAAQ,EAAGnH,EAAYllE,IACzE0E,KAAK,MAEvB3U,IAAU,QAASA,EAAQ,CAAEm+E,SAAS,MAASn+E,GAAU,GAAOA,GAAQ2U,GAAkB,MAATA,KACzF,0BCTJ7U,eAAes+E,GAAQjJ,EAAY7qE,EAAM4hC,EAAOmyC,EAAgBh5E,EAAOb,EAAKyL,GAExE,GAAI3F,aAAgBjO,WAAY,CAC5B,MAAMO,EAAM,GAAqB0N,EAAM+zE,EAAgBh5E,EAAOb,GAE9D,YADA0nC,EAAM3yC,KAAKqD,EAEf,CACA,GAAiB,MAAb0N,EAAKgxD,KACL,MAAM,EAAQ,IAAIlhE,MAAM,qBAAsB,kBAElD,IAAIH,EACJ,IACIA,EAAOm6E,EAAO8I,UAAU5yE,EAAKgxD,KACjC,CACA,MAAO7zD,GACH,MAAM,EAAQA,EAAK,iBACvB,CAEA,GAAiB,MAAbxN,EAAKqkB,KAAc,CACnB,MAAMA,EAAOrkB,EAAKqkB,KACZ1hB,EAAM,GAAqB0hB,EAAM+/D,EAAgBh5E,EAAOb,GAC9D0nC,EAAM3yC,KAAKqD,GACXyhF,GAAkBv6D,OAAOlnB,EAAI8R,WACjC,CACA,MAAM4vE,EAAW,GACjB,GAAIh0E,EAAKsrE,MAAM98E,SAAWmB,EAAKq6E,WAAWx7E,OACtC,MAAM,EAAQ,IAAIsB,MAAM,0CAA2C,kBAEvE,IAAK,IAAI+C,EAAI,EAAGA,EAAImN,EAAKsrE,MAAM98E,OAAQqE,IAAK,CACxC,MAAMohF,EAAYj0E,EAAKsrE,MAAMz4E,GACvBqhF,EAAaH,EACbI,EAAWD,EAAavkF,EAAKq6E,WAAWn3E,GAU9C,IATKkI,GAASm5E,GAAcn5E,EAAQo5E,GAC/Bj6E,GAAOg6E,GAAch6E,GAAOi6E,GAC5Bp5E,EAAQm5E,GAAch6E,EAAMi6E,IAC7BH,EAAS/kF,KAAK,CACVk9D,KAAM8nB,EACN7B,WAAY2B,KAGpBA,EAAiBI,GACIj6E,EACjB,KAER,OACM,QAAK85E,GAAWt+E,GAAW,GAAIA,GAASmZ,GACnCrZ,UACH,MAAMm1C,QAAckgC,EAAW3yE,IAAI2W,EAAGs9C,KAAK3K,KAAM77C,GACjD,MAAO,IACAkJ,EACH87B,QACH,MAEJj1C,IAAW,QAASA,EAAQ,CAC7Bm+E,SAAS,MACTr+E,MAAOE,IACP,UAAW,MAAM,KAAEy2D,EAAI,MAAExhB,EAAK,WAAEynC,KAAgB18E,EAAQ,CACpD,IAAIuwC,EACJ,OAAQkmB,EAAK3K,KAAK57C,MACd,KAAK,OACDqgC,EAAQ,SAAa0E,GACrB,MACJ,KAAK,EACD1E,EAAQ0E,EACR,MACJ,QAEI,YADA/I,EAAM1nC,IAAI,EAAQ,IAAIpK,MAAM,sBAAsBq8D,EAAK3K,KAAK57C,QAAS,mBAK7E,MAAMwuE,EAAa,IAAI,KAAO,CAC1BC,YAAa,IAGjBD,EAAWvyC,GAAG,SAASlqB,IACnBiqB,EAAM1nC,IAAIyd,EAAM,IAGfy8D,EAAW7kE,KAAI/Z,UAChBmQ,EAAQwlE,aAAa,IAAI,IAAoB,4BAA6B,CACtE3e,IAAKL,EAAK3K,cAERsyB,GAAQjJ,EAAY5kC,EAAOrE,EAAOwwC,EAAYr3E,EAAOb,EAAKyL,EAAQ,UAGtEyuE,EAAWE,QACrB,KAEAP,GAAkB75E,GAClB0nC,EAAM1nC,KAEd,CA8CA,OA7CoB,CAACsyD,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,IAC1Dr1E,gBAAiCmQ,EAAU,CAAC,GACxC,MAAM6kE,EAAWU,EAAOV,WACxB,QAAiBvrE,IAAburE,EACA,MAAM,IAAI16E,MAAM,wBAEpB,MAAM,MAAEiL,EAAK,IAAEb,GAAQ,GAAwBswE,EAAU7kE,EAAQlX,OAAQkX,EAAQnX,QACjF,GAAY,KAAR0L,EACA,OAEJ,IAAIgB,EAAO,GACX,MAAMq5E,EAASr6E,EAAMa,EACf6mC,GAAQ,UACdj8B,EAAQwlE,aAAa,IAAI,IAAoB,4BAA6B,CACtE3e,SAECsnB,GAAQjJ,EAAY7qE,EAAM4hC,EAAO,GAAI7mC,EAAOb,EAAKyL,GACjDqf,OAAM7nB,IACPykC,EAAM1nC,IAAIiD,EAAI,IAElB,UAAW,MAAM7K,KAAOsvC,EACpB,GAAW,MAAPtvC,EAAJ,CAIA,GADA4I,GAAQse,OAAOlnB,EAAI8R,YACflJ,EAAOq5E,EAEP,MADA3yC,EAAM1nC,MACA,EAAQ,IAAIpK,MAAM,qGAAsG,iBAE9HoL,IAASq5E,GACT3yC,EAAM1nC,MAEVyL,EAAQwlE,aAAa,IAAI,IAAoB,uCAAwC,CACjF0F,UAAW31E,EACXu3E,WAAY8B,EACZ/J,oBAEEl4E,CAdN,CAgBJ,GAAI4I,EAAOq5E,EACP,MAAM,EAAQ,IAAIzkF,MAAM,sDAAuD,iBAEvF,ECnIJ0F,eAAgBg/E,GAAcx0E,EAAMumB,EAAMvd,EAASgpE,EAAOnH,EAAYllE,GAClE,MAAMymE,EAAQpsE,EAAKsrE,MACnB,GAAiB,MAAbtrE,EAAKgxD,KACL,MAAM,EAAQ,IAAIlhE,MAAM,qBAAsB,kBAElD,IAAIolB,EACJ,IACIA,EAAM40D,EAAO8I,UAAU5yE,EAAKgxD,KAChC,CACA,MAAO7zD,GACH,MAAM,EAAQA,EAAK,iBACvB,CACA,GAAkB,MAAd+X,EAAIg0D,OACJ,MAAM,EAAQ,IAAIp5E,MAAM,kBAAmB,kBAE/C,MAAM8+E,GAAa15D,EAAIg0D,OAAS,IAAIhtE,SAAS,IAAI1N,OAC3Ck2B,GAAU,QAAK0nD,GAAO12E,GAAU,GAAIA,GAAQy2D,GACvC32D,UACH,MAAMoB,EAAoB,MAAbu1D,EAAKkgB,KAAelgB,EAAKkgB,KAAKr1E,UAAU43E,GAAa,KAClE,GAAY,MAARh4E,GAAyB,KAATA,EAAa,CAC7B,MAAMua,QAAenI,EAAQmjD,EAAK3K,KAAM5qD,EAAM,GAAG2vB,KAAQ3vB,IAAQ,GAAIo7E,EAAQ,EAAGnH,EAAYllE,GAC5F,MAAO,CAAEyE,QAAyB,MAAhB+G,EAAO9G,MAAgB,GAAK,CAAC8G,EAAO9G,OAC1D,CACK,CAED,MAAMsgC,QAAckgC,EAAW3yE,IAAIi0D,EAAK3K,KAAM77C,GAK9C,OAJA3F,GAAO,IAAA2D,QAAOgnC,GACdhlC,EAAQwlE,aAAa,IAAI,IAAoB,8CAA+C,CACxF3e,IAAKL,EAAK3K,QAEP,CAAEp3C,QAASoqE,GAAcx0E,EAAMumB,EAAMvd,EAASgpE,EAAOnH,EAAYllE,GAC5E,OAEJjQ,IAAU,QAASA,EAAQ,CAAEm+E,SAAS,MAC1C,UAAW,MAAM,QAAEzpE,KAAasa,QACrBta,CAEf,CACA,OA/CoC,CAACoiD,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,IAC1E,SAAmCllE,EAAU,CAAC,GAI1C,OAHAA,EAAQwlE,aAAa,IAAI,IAAoB,8CAA+C,CACxF3e,SAEGgoB,GAAcx0E,EAAMumB,EAAMvd,EAASgpE,EAAOnH,EAAYllE,EACjE,ECNJ,MAIM8uE,GAAmB,CACrB7mC,IAAK,GACLj+C,KAAM,GACN+kF,UAAW,GACX,yBAA0B,GAC1B1kC,SAAU,CAACwc,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,IACzC,IAAM,GAEjB8J,QAAS,CAACnoB,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,IACxC,IAAM,IAkFrB,OA9EuBr1E,MAAOg3D,EAAK51D,EAAM2vB,EAAMwrD,EAAW/oE,EAASgpE,EAAOnH,EAAYllE,KAClF,MAAMglC,QAAckgC,EAAW3yE,IAAIs0D,EAAK7mD,GAClC3F,GAAO,IAAA2D,QAAOgnC,GACpB,IAAIugC,EACAtoE,EAIJ,GAHY,MAARhM,IACAA,EAAO41D,EAAItwD,YAEE,MAAb8D,EAAKgxD,KACL,MAAM,EAAQ,IAAIlhE,MAAM,qBAAsB,kBAElD,IACIo7E,EAASpB,EAAO8I,UAAU5yE,EAAKgxD,KACnC,CACA,MAAO7zD,GAEH,MAAM,EAAQA,EAAK,iBACvB,CAIA,GAHY,MAARopB,IACAA,EAAO3vB,GAEPm7E,EAAUvjF,OAAS,EAAG,CACtB,IAAIomF,EAQJ,GALIA,EAFiB,2BAAjB1J,GAAQzkE,WAEQ,GAAazG,EAAM+xE,EAAU,GAAIlH,GA1CzC,EAAC7qE,EAAMpJ,KACvB,MAAMu1D,EAAOnsD,EAAKsrE,MAAM7T,MAAKtL,GAAQA,EAAKkgB,OAASz1E,IACnD,OAAOu1D,GAAM3K,IAAI,EA2CCqzB,CAAY70E,EAAM+xE,EAAU,IAE3B,MAAX6C,EACA,MAAM,EAAQ,IAAI9kF,MAAM,uBAAwB,iBAGpD,MAAMglF,EAAW/C,EAAUp7E,QAE3BiM,EAAO,CACH4pD,IAAKooB,EACL7C,YACAn7E,KAAMk+E,GAAY,GAClBvuD,KALa,GAAGA,KAAQuuD,IAOhC,CACA,MAAM7J,EAAUwJ,GAAiBvJ,EAAOzkE,MAAM+lD,EAAKxsD,EAAMkrE,EAAQ3kD,EAAMvd,EAASgpE,EAAOnH,GACvF,GAAe,MAAXI,EACA,MAAM,EAAQ,IAAIn7E,MAAM,mCAAoC,iBAEhE,OAAIo7E,EAAOb,cACA,CACHhgE,MAAO,CACH5D,KAAM,YACN7P,OACA2vB,OACAimC,MACAye,UACAC,SACA8G,QACAhyE,OACAhR,KAAMk8E,EAAOV,YAEjB5nE,QAGD,CACHyH,MAAO,CACH5D,KAAM,OACN7P,OACA2vB,OACAimC,MACAye,UACAC,SACA8G,QACAhyE,OACAhR,KAAMk8E,EAAOV,YAEjB5nE,OACH,EC3FL,MAAMmyE,GAAY,CACd,CAAC,QAAa,GACd,CAAC,GAAWnnC,GACZ,CAAC,SAAe,GAChB,CAACyc,IAAgB,IAEf,GAAU70D,MAAOg3D,EAAK51D,EAAM2vB,EAAMwrD,EAAWC,EAAOnH,EAAYllE,KAClE,MAAMg9B,EAAWoyC,GAAUvoB,EAAI5mD,MAC/B,GAAgB,MAAZ+8B,EACA,MAAM,EAAQ,IAAI7yC,MAAM,wBAAwB08D,EAAI5mD,QAAS,mBAEjE,OAAO+8B,EAAS6pB,EAAK51D,EAAM2vB,EAAMwrD,EAAW,GAASC,EAAOnH,EAAYllE,EAAQ,EAEpF,UClBA,MAOMqvE,GAAczuD,IAChB,GAAIA,aAAgBx0B,WAChB,MAAO,CACHy6D,IAAKC,GAAI9oD,OAAO4iB,GAChBwrD,UAAW,IAGnB,MAAMvlB,EAAMC,GAAIC,MAAMnmC,GACtB,GAAW,MAAPimC,EACA,MAAO,CACHA,MACAulB,UAAW,IAGnB,GAAoB,iBAATxrD,EAAmB,CACK,IAA3BA,EAAKzvB,QAAQ,YACbyvB,EAAOA,EAAKvvB,UAAU,IAE1B,MAAMgpC,EAzBW,EAACzZ,EAAO,MAErBA,EACH9V,OACA4mB,MAAM,qBAAuB,IAC7B5nB,OAAOhT,SAoBO,CAAiB8pB,GAChC,MAAO,CACHimC,IAAKC,GAAIlpC,MAAMyc,EAAO,IACtB+xC,UAAW/xC,EAAO3vC,MAAM,GAEhC,CACA,MAAM,EAAQ,IAAIP,MAAM,qBAAqBy2B,KAAS,eAAe,EAyBlE/wB,eAAeg6D,GAASjpC,EAAMskD,EAAYllE,EAAU,CAAC,GACxD,MAAMwL,QAAe,GAxBlB3b,gBAAyB+wB,EAAMskD,EAAYllE,EAAU,CAAC,GACzD,IAAI,IAAE6mD,EAAG,UAAEulB,GAAciD,GAAWzuD,GAChC3vB,EAAO41D,EAAItwD,WACX+4E,EAAYr+E,EAChB,MAAMs+E,EAAgBnD,EAAUvjF,OAChC,OAAa,CACT,MAAM2iB,QAAe,GAAQq7C,EAAK51D,EAAMq+E,EAAWlD,EAAWmD,EAAerK,EAAYllE,GACzF,GAAoB,MAAhBwL,EAAO9G,OAAgC,MAAf8G,EAAOvO,KAC/B,MAAM,EAAQ,IAAI9S,MAAM,qBAAqBy2B,KAAS,iBAK1D,GAHoB,MAAhBpV,EAAO9G,cACD8G,EAAO9G,OAEE,MAAf8G,EAAOvO,KACP,OAGJmvE,EAAY5gE,EAAOvO,KAAKmvE,UACxBvlB,EAAMr7C,EAAOvO,KAAK4pD,IAClB51D,EAAOua,EAAOvO,KAAKhM,KACnBq+E,EAAY9jE,EAAOvO,KAAK2jB,IAC5B,CACJ,CAE8B4uD,CAAS5uD,EAAMskD,EAAYllE,IACrD,GAAc,MAAVwL,EACA,MAAM,EAAQ,IAAIrhB,MAAM,qBAAqBy2B,KAAS,iBAE1D,OAAOpV,CACX,CACO3b,eAAgB4/E,GAAU7uD,EAAMskD,EAAYllE,EAAU,CAAC,GAC1D,MAAM3F,QAAawvD,GAASjpC,EAAMskD,EAAYllE,GAC9C,GAAY,MAAR3F,UAGEA,EACY,cAAdA,EAAKyG,MACL,UAAW,MAAMw/B,KAIrBzwC,eAAgB6/E,EAAQr1E,EAAM2F,GAC1B,UAAW,MAAMhW,KAAQqQ,EAAKirE,QAAQtlE,SAC5BhW,EACFA,aAAgBoC,YAGF,cAAdpC,EAAK8W,aACE4uE,EAAQ1lF,EAAMgW,GAGjC,CAd8B0vE,CAAQr1E,EAAM2F,SAC9BsgC,CAclB,iBCzFO,MAAMqvC,WAAoBxlF,MAC7B8G,KACAgP,KACAvO,YAAY+H,EAASxI,EAAMgP,GACvBsE,MAAM9K,GACN7H,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,CAChB,EAEG,MAAM2vE,WAAuBD,GAChCj+E,YAAY+H,EAAU,qBAClB8K,MAAM9K,EAAS,iBAAkB,iBACrC,EAEG,MAAMo2E,WAA2BF,GACpCj+E,YAAY+H,EAAU,kBAClB8K,MAAM9K,EAAS,qBAAsB,qBACzC,EAEG,MAAM,WAAqBk2E,GAC9Bj+E,YAAY+H,EAAU,iBAClB8K,MAAM9K,EAAS,qBAAsB,oBACzC,EAEG,MAAMq2E,WAA2BH,GACpCj+E,YAAY+H,EAAU,uBAClB8K,MAAM9K,EAAS,qBAAsB,qBACzC,EAEG,MAAMs2E,WAA0BJ,GACnCj+E,YAAY+H,EAAU,uBAClB8K,MAAM9K,EAAS,oBAAqB,qBACxC,EAEG,MAAMu2E,WAAuBL,GAChCj+E,YAAY+H,EAAU,cAClB8K,MAAM9K,EAAS,iBAAkB,iBACrC,EAEG,MAAMw2E,WAAsBN,GAC/Bj+E,YAAY+H,EAAU,cAClB8K,MAAM9K,EAAS,gBAAiB,iBACpC,EAEG,MAAMy2E,WAA2BP,GACpCj+E,YAAY+H,EAAU,mBAClB8K,MAAM9K,EAAS,qBAAsB,sBACzC,EAEG,MAAM02E,WAA+BR,GACxCj+E,YAAY+H,EAAU,sBAClB8K,MAAM9K,EAAS,yBAA0B,yBAC7C,kBChDG,MAAMK,GAAS6oD,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICcR,SAASgP,GAAO3gE,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAKpC,OAHI,WAAc,GAAGA,YAAuF,MAAtE,cAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,GAAM,GAAG6G,YAEdX,OAAO6W,OAAO,GAAMlW,GAAO,CAC9B+gB,MAAO,GAAM,GAAG/gB,WAChB7G,SAER,CAjDA,gBAAsB+4B,GACN,MAALA,EAAY,YAAc,aAAqBA,GAG1D,gBAAsBA,GACN,MAALA,EAAY,YAAc,aAAkBA,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAcrpB,GAAO+nD,WAAW1+B,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,uCC7BhC,SAAS65E,GAAS3H,GAUrB,OATA,SAAiBh4E,GACb,OAAIA,aAAiB4/E,GAEV5/E,EAGA,IAAI4/E,GAAa5/E,EAAOg4E,EAEvC,CAEJ,CACO,MAAM4H,GACT97B,OACA+7B,QACAC,OACAC,eACAC,oBACAC,SACAh/E,YAAYjB,EAAOg4E,GACf,KAAMh4E,aAAiBrE,YACnB,MAAM,IAAIjC,MAAM,6BAEpByH,KAAK2iD,OAAS9jD,EACdmB,KAAK0+E,QAAU7H,EACf72E,KAAK2+E,QAAU,EACf3+E,KAAK4+E,eAAiB,EACtB5+E,KAAK6+E,oBAAsB,EAC3B7+E,KAAK8+E,SAAW,EACpB,CACA7gF,WAAWsE,GACP,IAAIw8E,EAAcx8E,EAClB,KAAOvC,KAAK4+E,eAAiBG,SACnB/+E,KAAKg/E,mBAEf,IAAIplE,EAAS,EACb,KAAOmlE,EAAc,GAAG,CACpB,MAAMz/E,EAAOU,KAAK8+E,SAAS9+E,KAAK6+E,qBAC1B5R,EAAYh0E,KAAKyL,IAAIpF,EAAK2/E,gBAAiBF,GAEjDnlE,GAAUA,GAAUqzD,GADP3tE,EAAKmsD,KAAKwhB,GAEvB8R,GAAe9R,EACfjtE,KAAK4+E,gBAAkB3R,EACM,IAAzB3tE,EAAK2/E,iBACLj/E,KAAK6+E,qBAEb,CACA,OAAOjlE,CACX,CACAslE,OAAO38E,GACH,IAAIw8E,EAAcx8E,EAClB,KAAOw8E,EAAc,GAAG,CACpB,MAAMz/E,EAAOU,KAAK8+E,SAAS9+E,KAAK6+E,qBAC1BM,EAAqBlmF,KAAKyL,IAAIpF,EAAK8/E,YAAc9/E,EAAK2/E,gBAAiBF,GAC7Ez/E,EAAK4/E,OAAOC,GACZJ,GAAeI,EACfn/E,KAAK4+E,gBAAkBO,EACnBn/E,KAAK6+E,oBAAsB,GAAKv/E,EAAK8/E,cAAgB9/E,EAAK2/E,kBAC1Dj/E,KAAK2+E,SACL3+E,KAAK6+E,sBAEb,CACJ,CACA5gF,yBACI+B,KAAK2+E,SACL,MAAM9/E,EAAQmB,KAAK2+E,OAAS,GAAI,QAAiB,CAAC3+E,KAAK2iD,OAAQnoD,WAAWgM,KAAK,CAACxG,KAAK2+E,WAAa3+E,KAAK2iD,OACjG08B,QAAkBr/E,KAAK0+E,QAAQ7/E,GAC/BlI,EAAS,IAAI2oF,GAAiBD,GACpCr/E,KAAK8+E,SAASpnF,KAAKf,GACnBqJ,KAAK4+E,gBAAkBjoF,EAAOsoF,eAClC,EAEJ,MAAMM,GAAc,CAChB,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KAEEC,GAAa,CACf,EACA,EACA,EACA,GACA,GACA,GACA,IACA,KAEG,MAAMF,GACT38B,OACA88B,gBACAC,eACA5/E,YAAYjB,GACRmB,KAAK2iD,OAAS9jD,EACdmB,KAAKy/E,gBAAkB5gF,EAAM5H,OAAS,EACtC+I,KAAK0/E,eAAiB,CAC1B,CACAT,gBACI,OAAOj/E,KAAK0/E,eAAiB,EAA2B,EAAvB1/E,KAAKy/E,eAC1C,CACAL,YACI,OAA4B,EAArBp/E,KAAK2iD,OAAO1rD,MACvB,CACAw0D,KAAKlpD,GACD,IAAIw8E,EAAcx8E,EACdqX,EAAS,EACb,KAAOmlE,EAAc,GAAK/+E,KAAK2/E,aAAa,CACxC,MAAMC,EAAO5/E,KAAK2iD,OAAO3iD,KAAKy/E,iBACxBR,EAAgBj/E,KAAK0/E,eAAiB,EACtCG,EAAS5mF,KAAKyL,IAAIu6E,EAAeF,GAEvCnlE,GAAUA,GAAUimE,GADNC,GAAcF,EAAMX,EAAgBY,EAAQA,GAE1Dd,GAAec,EACf7/E,KAAK0/E,gBAAkBG,EACnB7/E,KAAK0/E,eAAiB,IACtB1/E,KAAK0/E,eAAiB,EACtB1/E,KAAKy/E,kBAEb,CACA,OAAO7lE,CACX,CACAslE,OAAO38E,GAEH,IADAvC,KAAK0/E,gBAAkBn9E,EAChBvC,KAAK0/E,eAAiB,GACzB1/E,KAAK0/E,gBAAkB,EACvB1/E,KAAKy/E,iBAAmB,CAEhC,CACAE,YACI,OAAO3/E,KAAKy/E,iBAAmB,CACnC,EAEJ,SAASK,GAAcF,EAAMp8E,EAAOvM,GAChC,MAAMiQ,EAGV,SAAiB1D,EAAOvM,GACpB,OAAOsoF,GAAY/7E,GAASg8E,GAAWvmF,KAAKyL,IAAIzN,EAASuM,EAAQ,EAAG,GACxE,CALiBu8E,CAAQv8E,EAAOvM,GAC5B,OAAQ2oF,EAAO14E,KAAU1D,CAC7B,CC1HyB,GAAK,CAC5BnE,KAAM,aACNgP,KAAM,GACNU,OAAShT,GAZX,SAA+BotD,GAC7B,MAAM5lD,EAAQ,IAAI3K,MAAM,GACxB,IAAK,IAAI0C,EAAI,EAAGA,EAAI,EAAGA,IACrBiI,EAAMjI,GAAc,IAAT6tD,EACXA,IAAmB,EAErB,OAAO,IAAI3uD,WAAW+I,EACxB,CAKqB,CAAqB,cAAexH,MAHlD,MAMM,GAAa,GAAK,CAC7BsD,KAAM,cACNgP,KAAM,GACNU,OAAShT,GAAU,EAAc,eAAgBA,MC1BtCikF,ID8BY,GAAK,CAC5B3gF,KAAM,iBACNgP,KAAM,GACNU,OAAShT,GAAU,EAAc,eAAgBA,IAAQzE,SAAS,EAAG,KCjC3C2qB,OAAO,UAE5BhkB,eAAe,GAAWlD,GAC7B,aAAc,UAAkBA,IAI3BzD,SAAS,EAAG,GAEZ2jB,SACT,CCRO,MAAM,GAAUhd,MAAOtH,EAAQ28E,EAAYllE,KACzB,MAAjBA,EAAQuoD,QACRvoD,EAAQuoD,MAAQ,GAEpB,MAAMpC,QAAkBnH,GAAO/C,OAAO1zD,GAChCs+D,EAAMC,GAAIv2D,OAAOyP,EAAQmlE,WAAYnlE,EAAQuoD,MAAMtoD,KAAMkmD,GAK/D,aAJM+e,EAAWplE,IAAI+mD,EAAKt+D,EAAQ,IAC3ByX,EACH6Z,OAAQ7Z,EAAQ6Z,SAEbgtC,CAAG,ECPd,MAAM,GACF7mD,QACAqnE,KACA93D,IACAqR,KACA0mD,MACAC,KACAv8D,OACAw8D,UACAjC,OACA9pD,KACA+nD,MACA3c,IACAx9D,KACAo+E,SACA/1E,YAAYgpC,EAAO16B,GACfpO,KAAKoO,QAAUA,GAAW,CAAC,EAC3BpO,KAAKy1E,KAAO3sC,EAAM2sC,KAClBz1E,KAAK2d,IAAMmrB,EAAMnrB,IACjB3d,KAAKgvB,KAAO8Z,EAAM9Z,KAClBhvB,KAAK01E,MAAQ5sC,EAAM4sC,MACnB11E,KAAK21E,KAAO7sC,EAAM6sC,KAClB31E,KAAKoZ,OAAS0vB,EAAM1vB,OACpBpZ,KAAK41E,UAAY9sC,EAAM8sC,UACvB51E,KAAK2zE,OAAS7qC,EAAM6qC,OACpB3zE,KAAK6pB,KAAOif,EAAMjf,KAClB7pB,KAAK4xE,MAAQ9oC,EAAM8oC,KACvB,EAEG,MAAM,WAAmB,GAC5BgF,QACA92E,YAAYgpC,EAAO16B,GACfuE,MAAMm2B,EAAO16B,GACbpO,KAAK42E,SAAU,QAAW,CACtBC,OAAQ,GACRt0E,KAAM,GAEd,CACAtE,UAAUoB,EAAMR,GACZmB,KAAKi1D,SAAMvtD,EACX1H,KAAKvI,UAAOiQ,EACZ1H,KAAK61E,cAAWnuE,QACV1H,KAAK42E,QAAQ1oE,IAAI7O,EAAMR,EACjC,CACAZ,UAAUoB,GACN,OAAOW,KAAK42E,QAAQj2E,IAAItB,EAC5B,CACA62E,aACI,OAAOl2E,KAAK42E,QAAQG,WACxB,CACAZ,sBACI,OAAOn2E,KAAK42E,QAAQI,eACxB,CACAZ,YACI,OAAOp2E,KAAK42E,QAAQR,WACxB,CACAn4E,wBACI,UAAW,MAAM,IAAEkQ,EAAG,MAAEtP,KAAWmB,KAAK42E,QAAQK,sBACtC,CACF9oE,MACAugC,MAAO7vC,EAGnB,CACAw3E,mBACI,YAAsB3uE,IAAlB1H,KAAK61E,WAGT71E,KAAK61E,SAAW,GAAc71E,KAAK42E,QAAS52E,KAAMA,KAAKoO,UAF5CpO,KAAK61E,QAIpB,CACA53E,YAAaq1E,GACT,UAAW,MAAMxgE,KAAS,GAAM9S,KAAK42E,QAAStD,EAAYtzE,KAAMA,KAAKoO,cAC3D,IACC0E,EACHkc,KAAMhvB,KAAKgvB,KAGvB,EAEJ/wB,eAAgB,GAAMi5E,EAAQ5D,EAAY6D,EAAW/oE,GACjD,MAAMgpE,EAAWF,EAAOjB,UAClBpB,EAAQ,GACd,IAAI0C,EAAe,GACnB,IAAK,IAAIj8E,EAAI,EAAGA,EAAI87E,EAASngF,OAAQqE,IAAK,CACtC,MAAMozC,EAAQ0oC,EAASz2E,IAAIrF,GAC3B,GAAa,MAATozC,EACA,SAEJ,MAAM8oC,EAAcl8E,EAAEqJ,SAAS,IAAI+1B,cAAc+8C,SAAS,EAAG,KAC7D,GAAI/oC,aAAiB,KAAQ,CACzB,IAAIgpC,EACJ,UAAW,MAAMC,KAAY,GAAMjpC,EAAO4kC,EAAY,KAAMllE,GACxDspE,EAAQC,EAEZ,GAAa,MAATD,EACA,MAAM,IAAIn/E,MAAM,wDAEpBs8E,EAAMn9E,KAAK,CACPo9E,KAAM0C,EACNzC,MAAO/rE,OAAO0uE,EAAMjgF,MACpBwyD,KAAMytB,EAAMziB,MAEhBsiB,GAAgBG,EAAMjgF,IAC1B,MACK,GA0DmB,mBA1DTi3C,EAAM7vC,MA0DPy3E,MA1De,CACzB,MAAM34D,EAAM+wB,EAAM7vC,MAClB,IAAI+4E,EACJ,UAAW,MAAM9kE,KAAS6K,EAAI24D,MAAMhD,GAChCsE,EAAa9kE,QACP8kE,EAEV,GAAkB,MAAdA,EACA,MAAM,IAAIr/E,MAAM,qBAEpB,MAAMs/E,EAAQL,EAAc9oC,EAAMvgC,IAClC0mE,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAO4uE,EAAWngF,MACzBwyD,KAAM2tB,EAAW3iB,MAErBsiB,GAAgBK,EAAWngF,IAC/B,KACK,CACD,MAAMoH,EAAQ6vC,EAAM7vC,MACpB,GAAiB,MAAbA,EAAMo2D,IACN,SAEJ,MAAM4iB,EAAQL,EAAc9oC,EAAMvgC,IAC5B1W,EAAOoH,EAAMpH,KACnBo9E,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAOvR,GACdwyD,KAAMprD,EAAMo2D,MAEhBsiB,GAAgBt1D,OAAOxqB,GAAQ,EACnC,CACJ,CAGA,MAAMglB,EAAOjiB,WAAWgM,KAAK4wE,EAASU,WAAW78D,WAC3C0C,EAAM,IAAI40D,EAAO,CACnBrjE,KAAM,yBACNuN,OACAk1D,OAAQ1vD,OAAOi1D,EAAOI,aACtB5F,SAAUsO,GACVpO,MAAOuF,GAAWvF,MAClB/nD,KAAMstD,GAAWttD,OAEfphB,EAAO,CACTgxD,KAAM97C,EAAIi8C,UACVma,MAAOc,GAELl+E,GAAS,IAAAoY,SAAO,IAAAklE,SAAQxrE,IACxBwsD,QAAY,GAAQt+D,EAAQ28E,EAAYllE,GACxC3W,EAAOwqB,OAAOtrB,EAAOkW,YAAc0qE,OACnC,CACFtiB,MACA0e,OAAQh2D,EACRlmB,OAER,CAIA,SAAS,GAAcy/E,EAAQC,EAAW/oE,GACtC,MAAMgpE,EAAWF,EAAOjB,UAClBpB,EAAQ,GACd,IAAK,IAAIv5E,EAAI,EAAGA,EAAI87E,EAASngF,OAAQqE,IAAK,CACtC,MAAMozC,EAAQ0oC,EAASz2E,IAAIrF,GAC3B,GAAa,MAATozC,EACA,SAEJ,MAAM8oC,EAAcl8E,EAAEqJ,SAAS,IAAI+1B,cAAc+8C,SAAS,EAAG,KAC7D,GAAI/oC,aAAiB,KAAQ,CACzB,MAAMj3C,EAAO,GAAci3C,EAAO,KAAMtgC,GACxCymE,EAAMn9E,KAAK,CACPo9E,KAAM0C,EACNzC,MAAO/rE,OAAOvR,GACdwyD,KAA6B,IAAvB77C,EAAQmlE,WAAmB,GAAS,IAElD,MACK,GAAiC,mBAAtB7kC,EAAM7vC,MAAMy3E,MAAsB,CAC9C,MACM7+E,EADMi3C,EAAM7vC,MACDg3E,WACjBhB,EAAMn9E,KAAK,CACPo9E,KAAM0C,EAAc9oC,EAAMvgC,IAC1B4mE,MAAO/rE,OAAOvR,GACdwyD,KAA6B,IAAvB77C,EAAQmlE,WAAmB,GAAS,IAElD,KACK,CACD,MAAM10E,EAAQ6vC,EAAM7vC,MACpB,GAAiB,MAAbA,EAAMo2D,IACN,SAEJ,MAAM4iB,EAAQL,EAAc9oC,EAAMvgC,IAC5B1W,EAAOoH,EAAMpH,KACnBo9E,EAAMn9E,KAAK,CACPo9E,KAAM+C,EACN9C,MAAO/rE,OAAOvR,GACdwyD,KAAMprD,EAAMo2D,KAEpB,CACJ,CAGA,MAAMx4C,EAAOjiB,WAAWgM,KAAK4wE,EAASU,WAAW78D,WAC3C0C,EAAM,IAAI40D,EAAO,CACnBrjE,KAAM,yBACNuN,OACAk1D,OAAQ1vD,OAAOi1D,EAAOI,aACtB5F,SAAUsO,GACVpO,MAAOuF,GAAWvF,MAClB/nD,KAAMstD,GAAWttD,OAMrB,OAJe,IAAA9a,SAAO,IAAAklE,SAAQ,CAC1Bxa,KAAM97C,EAAIi8C,UACVma,MAAOc,KAEG59E,MAClB,CAKO,MAAM,GAASi+D,GAAIlpC,MAAM,kDACnB,GAASkpC,GAAIlpC,MAAM,qDC9N1BrzB,GAAMqnE,GAAO,0CACN,GAAYtyB,GACdA,EACF/oC,SAAS,IACT+1B,cACA+8C,SAAS,EAAG,KACZh4E,UAAU,EAAG,GA0BTwgF,GAAyBhiF,MAAO+wB,EAAMskD,EAAYllE,KAE3D,MAAM+oE,EAAY5E,EAAO8I,UAAUrsD,EAAK,GAAGvmB,KAAKgxD,MAAQ,IAAIj/D,WAAW,IAEjEm3E,EAAS1vD,OAAOhpB,KAAK6qB,IAAI,EH7CL,IGgD1B,IAAImxC,EACAxsD,EAFJumB,EAAK/T,UAGL,IAAK,IAAI3f,EAAI,EAAGA,EAAI0zB,EAAK/3B,OAAQqE,IAAK,CAClC,MAAM4kF,EAAS5kF,IAAM0zB,EAAK/3B,OAAS,EAC7BkpF,EAAUnxD,EAAK1zB,GAGfmhB,EAAOjiB,WAAWgM,KAAK25E,EAAQ/I,SAASU,WAAW78D,WACnD0C,EAAM,IAAI40D,EAAO,CACnBrjE,KAAM,yBACNuN,OACAk1D,SACAD,SAAUsO,KAEVE,IACAviE,EAAIi0D,MAAQuF,EAAUvF,MACtBj0D,EAAIkM,KAAOstD,EAAUttD,MAEzBphB,EAAO,CACHgxD,KAAM97C,EAAIi8C,UACVma,MAAOoM,EAAQ13E,KAAKsrE,OAExB,MAAM3gC,EAAQ,SAAa,UAAc3qC,IAEzC,GADAwsD,QAAY,GAAQ7hB,EAAOkgC,EAAYllE,IAClC8xE,EAAQ,CAET,MAAME,EAAcpxD,EAAK1zB,EAAI,GAC7B,GAAmB,MAAf8kF,EACA,MAAM,IAAI7nF,MAAM,2DAEpBI,GAAI,mDAAoDynF,EAAY5mE,QACpE4mE,EAAY33E,KAAKsrE,MAAQqM,EAAY33E,KAAKsrE,MAAM77D,QAAO0Z,GAAKA,EAAEkjD,OAASsL,EAAY5mE,SACnF4mE,EAAY33E,KAAKsrE,MAAMr8E,KAAK,CACxBo9E,KAAMsL,EAAY5mE,OAClBywC,KAAMgL,EACN8f,MAAOoL,EAAQ13E,KAAKsrE,MAAM3kD,QAAO,CAACtd,EAAK5S,IAAS4S,GAAO5S,EAAK61E,OAAS,IAAI3hC,EAAMvmC,aAEvF,CACJ,CACA,GAAW,MAAPooD,GAAuB,MAARxsD,EACf,MAAM,IAAIlQ,MAAM,oBAEpB,MAAO,CAAE08D,MAAKxsD,OAAM,EAEX43E,GAA2BpiF,MAAOg3D,EAAKqrB,EAAUhN,EAAYllE,KACtE,MACM9O,EADUk/E,GAAS,GACZ/xC,EAAQ,QAAqB6zC,IACpCtxD,EAAO,GAEb,OAAa,CACT,MAAMokB,QAAckgC,EAAW3yE,IAAIs0D,EAAK7mD,GAClC3F,EAAO,SAAa2qC,GACpBgkC,EAAW,IAAI,GACf/sD,QAAc/qB,EAAKmsD,KHrGH,GGsGhBjyC,EAAS,GAAS6Q,GAMxB,IAAIqyD,EALJ1tD,EAAKt3B,KAAK,CACN8hB,SACA49D,WACA3uE,SAKJ,IAAK,MAAMmsD,KAAQnsD,EAAKsrE,MAAO,CAC3B,MAAMqI,EAAWxnB,EAAKkgB,MAAQ,GAC9B,GAAIsH,EAASnlF,OAAS,EAClB,MAAM,IAAIsB,MAAM,0CAEpB,MAAMm1C,EAAWhnC,SAAS01E,EAAS38E,UAAU,EAAG,GAAI,IACpD23E,EAASv7E,IAAI6xC,GAAU,GAEnB0uC,EAASre,WAAWvkD,KACpBkjE,EAAY9nB,EAEpB,CACA,GAAiB,MAAb8nB,EAAmB,CACnB/jF,GAAI,sCAAuC6gB,EAAQ8mE,GAEnD,KACJ,CACA,MAAMlE,EAAWM,EAAU5H,MAAQ,GACnC,GAAIsH,EAASnlF,OAAS,EAClB,MAAM,IAAIsB,MAAM,0CAEpB,GAAwB,IAApB6jF,EAASnlF,OAMb,MAJIg+D,EAAMynB,EAAUzyB,KAChBtxD,GAAI,wCAAyCyjF,EAIrD,CACA,MAAO,CAAEptD,OAAM1vB,OAAM,ECrIlBrB,eAAesiF,GAAqB93E,EAAM6qE,EAAY0E,EAAW5pE,GACpE,GAAiB,MAAb3F,EAAKgxD,KACL,MAAM,IAAIlhE,MAAM,0BAEpB,MAAMo7E,EAASpB,EAAO8I,UAAU5yE,EAAKgxD,MACrC,IAAIhiE,EACJ,GAAoB,cAAhBk8E,EAAOzkE,KACPzX,EAUR,SAA0BgR,GACtB,IAAIhR,EAAO,EAGX,IAAK,MAAMm9D,KAAQnsD,EAAKsrE,MACpBt8E,IAASm9D,EAAKkgB,MAAQ,IAAI79E,OAC1BQ,GAA8B,IAAtBm9D,EAAK3K,KAAK/gC,QAAgB,oBAA0B,oBAEhE,OAAOzxB,CACX,CAnBe4+E,CAAiB5tE,OAEvB,IAAoB,2BAAhBkrE,EAAOzkE,KAIZ,MAAM,IAAI3W,MAAM,uDAHhBd,QAAa+oF,GAAkB/3E,EAAM,EAAGuvE,EAAW1E,EAAYllE,EAInE,CACA,OAAO3W,EAAOugF,CAClB,CAWA/5E,eAAeuiF,GAAkB/3E,EAAMg4E,EAASv/D,EAAKoyD,EAAYllE,GAC7D,GAAIqyE,EAAUv/D,EACV,OAAOA,EAEX,GAAiB,MAAbzY,EAAKgxD,KACL,OAAOgnB,EAGX,IADelO,EAAO8I,UAAU5yE,EAAKgxD,MACzBqZ,cACR,OAAO2N,EAEX,IAAK,MAAM7rB,KAAQnsD,EAAKsrE,MAAO,CAC3B,IAAI10E,EAAOu1D,EAAKkgB,MAAQ,GAKxB,GAHAz1E,EAAOA,EAAKI,UAAU,GACtBghF,GAAWphF,EAAKpI,OAChBwpF,GAAW7rB,EAAK3K,KAAK1mD,MAAMsJ,WACvB+nD,EAAK3K,KAAK57C,OAAS,OAAY,CAC/B,MAAM+kC,QAAckgC,EAAW3yE,IAAIi0D,EAAK3K,KAAM77C,GACxC3F,EAAO,SAAa2qC,GAC1BqtC,SAAiBD,GAAkB/3E,EAAMg4E,EAASv/D,EAAKoyD,EAAYllE,EACvE,CACJ,CACA,OAAOqyE,CACX,CC/CA,MAAM,GAAMzgB,GAAO,0CACZ/hE,eAAeyiF,GAAQtnE,EAAQs1B,EAAO4kC,EAAYllE,GACrD,GAAwB,MAApBgL,EAAO3Q,KAAKgxD,KACZ,MAAM,IAAI8kB,GAAuB,oCAGrC,GAAkB,2BADLhM,EAAO8I,UAAUjiE,EAAO3Q,KAAKgxD,MACjCvqD,KAEL,OADA,GAAI,oCACGyxE,GAAsBvnE,EAAQs1B,EAAO4kC,EAAYllE,GAE5D,GAAI,UAAUsgC,EAAMomC,SAASpmC,EAAMub,8BACnC,MAAMrwC,QAAegnE,GAAexnE,EAAQs1B,EAAO4kC,EAAYllE,GAC/D,SAAUmyE,GAAqB3mE,EAAOnR,KAAM6qE,EAAYllE,EAAQwqE,yBAA0BxqE,GAAU,CAChG,GAAI,6CACJ,MAAMyyE,QAAkBC,GAA0BlnE,EAAQ05D,GAC1D15D,EAAOq7C,IAAM4rB,EAAU5rB,IACvBr7C,EAAOnR,KAAO,eAAmB6qE,EAAW3yE,IAAIkgF,EAAU5rB,IAAK7mD,GACnE,CACA,OAAOwL,CACX,CACA,MAAMknE,GAA4B7iF,MAAOmb,EAAQk6D,KAC7C,GAAwB,MAApBl6D,EAAO3Q,KAAKgxD,KACZ,MAAM,IAAI8kB,GAAuB,sDAErC,MAAM5K,EAASpB,EAAO8I,UAAUjiE,EAAO3Q,KAAKgxD,MACtC7/C,OFnBiB3b,OAAOq1E,EAAYyN,EAAU3yE,KACpD,MAAMspE,EAAQ,IAAI,GAAW,CACzBjC,MAAM,EACN93D,KAAK,EACLvE,YAAQ1R,EACRkuE,eAAWluE,EACXsnB,KAAM,GACN0mD,OAAO,EACPC,MAAM,EACN/D,MAAOxjE,EAAQwjE,MACf/nD,KAAMzb,EAAQyb,MACfzb,GACH,IAAK,IAAI9S,EAAI,EAAGA,EAAIylF,EAAS9pF,OAAQqE,UAC3Bo8E,EAAMd,QAAQ1oE,IAAI6yE,EAASzlF,GAAG+D,KAAM,CACtC5H,KAAMspF,EAASzlF,GAAG7D,KAClBw9D,IAAK8rB,EAASzlF,GAAG25D,MAGzB,MAAM71C,QAAY,GAAKs4D,EAAMpB,MAAMhD,IACnC,GAAW,MAAPl0D,EACA,MAAM,IAAI7mB,MAAM,oCAEpB,OAAO6mB,CAAG,EEHW4hE,CAAY1N,EAAYl6D,EAAO3Q,KAAKsrE,MAAMn5D,KAAIg6C,IAAQ,CACvEv1D,KAAOu1D,EAAKkgB,MAAQ,GACpBr9E,KAAMwqB,OAAO2yC,EAAKmgB,OAAS,GAC3B9f,IAAKL,EAAK3K,SACT,CACDpgC,KAAM8pD,EAAO9pD,KACb+nD,MAAO+B,EAAO/B,MACd2B,WAAYn6D,EAAO67C,IAAI/rC,UAG3B,OADA,GAAI,4CAA4CtP,EAAOq7C,OAChDr7C,CAAM,EAEXgnE,GAAiB3iF,MAAOmb,EAAQs1B,EAAO4kC,EAAYllE,KAErD,MAAM6yE,EAAc7nE,EAAO3Q,KAAKsrE,MAAM77D,QAAQ08C,IAC1C,MAAMssB,EAAUtsB,EAAKkgB,OAASpmC,EAAMomC,KACpC,GAAIoM,IAAY9yE,EAAQ+yE,iBACpB,MAAM,IAAIjD,GAEd,OAAQgD,CAAO,IAGnB,GADAD,EAAYvpF,KAAKg3C,GACO,MAApBt1B,EAAO3Q,KAAKgxD,KACZ,MAAM,IAAIwkB,GAAmB,qDAEjC,MAAMx1E,EAAO8pE,EAAO8I,UAAUjiE,EAAO3Q,KAAKgxD,MAC1C,IAAIh9C,EACJ,GAAkB,MAAdhU,EAAKmpE,MAAe,CAEpB,MAAMzxC,EAAKjnC,KAAKm+C,MACVq7B,EAAOz5E,KAAKiQ,MAAMi3B,EAAK,KAC7B13B,EAAKmpE,MAAQ,CACTc,KAAMzwD,OAAOywD,GACbC,MAA8B,KAAtBxyC,EAAa,IAAPuyC,IAElBj2D,EAAOhU,EAAKmxD,SAChB,MAEIn9C,EAAOrD,EAAO3Q,KAAKgxD,KAEvBrgD,EAAO3Q,KAAO,UAAc,CACxBgxD,KAAMh9C,EACNs3D,MAAOkN,IAGX,MAAMlmF,EAAM,SAAaqe,EAAO3Q,MAC1BnJ,QAAa8tD,GAAO/C,OAAOtvD,GAC3Bk6D,EAAMC,GAAIv2D,OAAOya,EAAO67C,IAAI/rC,QAAS,OAAY5pB,GAEvD,aADMg0E,EAAWplE,IAAI+mD,EAAKl6D,GACnB,CACH0N,KAAM2Q,EAAO3Q,KACbwsD,MACH,EAEC0rB,GAAwB1iF,MAAOmb,EAAQs1B,EAAO4kC,EAAYllE,KAC5D,MAAM,KAAE4gB,EAAI,KAAE1vB,SAAe+gF,GAAyBjnE,EAAO67C,IAAKvmB,EAAMomC,KAAMxB,EAAYllE,GACpFgzE,EAAepyD,EAAKA,EAAK/3B,OAAS,GACxC,GAAoB,MAAhBmqF,EACA,MAAM,IAAI7oF,MAAM,yCAIpB,MAAMihB,EAAS4nE,EAAa5nE,OACtB6Q,EAAQ3jB,SAAS8S,EAAQ,IAC/B,GAAI,2BAA4Bk1B,EAAMomC,KAAMt7D,GAC5C,MAAM4iE,EAAW,GAAG5iE,IAASk1B,EAAMomC,OAC7BuM,EAAeD,EAAa34E,KAAKsrE,MAAM7T,MAAKtuC,IAAMA,EAAEkjD,MAAQ,IAAI/W,WAAWvkD,KACjF,GAAoB,MAAhB6nE,EAGA,GAFA,GAAI,+BAAgCjF,GAEhCiF,EAAavM,OAASsH,EAAU,CAEhC,IAAKhuE,EAAQ+yE,iBACT,MAAM,IAAIjD,GAEd,GAAI,6BAA8BxvC,EAAMomC,MACxCsM,EAAa34E,KAAKsrE,MAAQqN,EAAa34E,KAAKsrE,MAAM77D,QAAO0Z,GAAKA,EAAEkjD,OAASsH,IACzEgF,EAAa34E,KAAKsrE,MAAMr8E,KAAK,CACzBo9E,KAAMsH,EACNnyB,KAAMvb,EAAMub,KACZ8qB,MAAOrmC,EAAMqmC,OAErB,KACK,IAAkC,IAA9BsM,EAAavM,MAAM79E,OACxB,MAAM,IAAIsB,MAAM,gCAEf,CAED,GAAI,kDAAmDihB,GAEvD,MAAM6Q,EAAQ+2D,EAAa34E,KAAKsrE,MAAMuN,WAAU1vD,GAAKA,EAAEkjD,MAAM/W,WAAWvkD,KAClE+nE,EAAUH,EAAa34E,KAAKsrE,MAAM9oD,OAAOZ,EAAO,GAAG,GAEnDm3D,GAAeD,EAAQzM,MAAQ,IAAIr1E,UAAU,GAE7CgiF,EADUjD,GAAS,GACL/xC,EAAQ,QAAqB+0C,IAEjD,IAAK,IAAIlmF,EAAI,EAAGA,EAAI0zB,EAAK/3B,OAAQqE,UACvBmmF,EAAYh2B,KLtIJ,GKwIlB,OAAa,CACT,MAAMi2B,QAAqBD,EAAYh2B,KLzIzB,GK0IRk2B,EAAgB,GAASD,GAC/BH,EAAQzM,KAAO,GAAG6M,IAAgBH,IAElC,MAAMI,QAAiBtiF,EAAKmsD,KL7Id,GK8IRo2B,EAAY,GAASD,GAC3B,GAAID,IAAkBE,EAAW,CAI7B,MAAMzK,EAAW,IAAI,GACrBA,EAASv7E,IAAI+lF,GAAU,GACvB5yD,EAAKt3B,KAAK,CACN8hB,OAAQqoE,EACRzK,WACA3uE,KAAM,CACFsrE,MAAO,MAGf,QACJ,CAEA,MAAMqD,EAAW,IAAI,GACrBA,EAASv7E,IAAI+lF,GAAU,GACvBxK,EAASv7E,IAAI6lF,GAAc,GAE3B1yD,EAAKt3B,KAAK,CACN8hB,SACA49D,WACA3uE,KAAM,CACFsrE,MAAO,CACHwN,EAAS,CACLzM,KAAM,GAAG+M,IAAYnzC,EAAMomC,OAC3B7qB,KAAMvb,EAAMub,KACZ8qB,MAAOrmC,EAAMqmC,WAK7B,KACJ,CACJ,OAGA,GAAI,uCAAwCqH,GAE5C1tC,EAAMomC,KAAOsH,EACbgF,EAAa34E,KAAKsrE,MAAMr8E,KAAKg3C,GAC7B0yC,EAAahK,SAASv7E,IAAIwuB,GAAO,GACjC,GAAI,kCAAmC+xD,GAE3C,OAAO6D,GAAuBjxD,EAAMskD,EAAYllE,EAAQ,EC5LrDnQ,eAAe6jF,GAAe7sB,EAAKqe,EAAYllE,EAAU,CAAC,GAC7D,MAAM0E,QAAcmlD,GAAShD,EAAKqe,EAAYllE,GAC9C,GAAmB,cAAf0E,EAAM5D,KACN,MAAM,IAAIovE,GAAmB,GAAGrpB,EAAItwD,yCAExC,MAAO,CACHswD,MACAxsD,KAAMqK,EAAMrK,KAEpB,CCROxK,eAAe8jF,GAAY9sB,EAAK51D,EAAMi0E,EAAYllE,GACrD,MAAM4zE,QAAoB/pB,GAAShD,EAAKqe,EAAYllE,GACpD,GAAyB,cAArB4zE,EAAY9yE,MAA6C,SAArB8yE,EAAY9yE,MAAwC,QAArB8yE,EAAY9yE,KAC/E,MAAM,IAAI8uE,GAAe,GAAG/oB,EAAItwD,oCAEpC,MAAO,CACHmwE,KAAMz1E,EACN01E,MAAOiN,EAAYv5E,gBAAgBjO,WAAawnF,EAAYv5E,KAAKoE,WAAao1E,GAAaD,EAAYv5E,MACvGwhD,KAAMgL,EAEd,CACA,SAASgtB,GAAax5E,GAClB,MAAMy5E,EAAYz5E,EAAKsrE,MAAM3kD,QAAO,CAACtd,EAAK5S,IAAS4S,GAAO5S,EAAK61E,OAAS,IAAI,GAC5E,OAAO,SAAatsE,GAAMoE,WAAaq1E,CAC3C,CCXA,MAAM,GAAMliB,GAAO,yCACZ/hE,eAAe,GAAQg3D,EAAKjmC,EAAMskD,EAAYllE,GACjD,GAAY,MAAR4gB,GAAyB,KAATA,EAChB,MAAO,CAAEimC,OAEb,GAAI,wBAAyBjmC,EAAMimC,GACnC,MAAM19D,EAAQy3B,EAAK/vB,MAAM,KAAKiZ,OAAOhT,SAC/Bi9E,EAAW,CAAC,CACV9iF,KAAM,GACN41D,MACAx9D,KAAM,KAEd,IAAK,IAAI6D,EAAI,EAAGA,EAAI/D,EAAMN,OAAQqE,IAAK,CACnC,MAAM6D,EAAO5H,EAAM+D,GACbse,QAAeq+C,GAAShD,EAAKqe,EAAYllE,GAE/C,GADA,GAAI,iBAAkBjP,EAAMya,GACR,SAAhBA,EAAO1K,KAAiB,CACxB,GAAI5T,EAAI/D,EAAMN,OAAS,EACnB,MAAM,IAAIsnF,GAAuB,oBAErCtpB,EAAMr7C,EAAOq7C,GACjB,KACK,IAAoB,cAAhBr7C,EAAO1K,KAmBZ,MAAM,IAAIqvE,GAAuB,0BAnBC,CAClC,IAAI6D,EACJ,UAAW,MAAMtvE,KAAS8G,EAAO85D,UAC7B,GAAI5gE,EAAMzT,OAASF,EAAM,CACrBijF,EAAStvE,EAAMmiD,IACf,KACJ,CAEJ,GAAc,MAAVmtB,EACA,MAAM,IAAIjE,GAAkB,oCAEhClpB,EAAMmtB,EACND,EAASzqF,KAAK,CACV2H,KAAMF,EACN81D,MACAx9D,KAAMmiB,EAAOniB,MAErB,CAGA,CACJ,CAEA,OADA,GAAI,oBAAqBu3B,EAAMimC,GACxB,CACHA,MACAjmC,OACAmzD,WAER,CAKOlkF,eAAeokF,GAAeptB,EAAKr7C,EAAQ05D,EAAYllE,GAC1D,GAAuB,MAAnBwL,EAAOuoE,UAA+C,IAA3BvoE,EAAOuoE,SAASlrF,OAC3C,OAAOg+D,EAEX,IAAIvmB,EAAQ90B,EAAOuoE,SAASpiD,MAC5B,GAAa,MAAT2O,EACA,MAAM,IAAIn2C,MAAM,yBAEpBm2C,EAAMumB,IAAMA,EACZr7C,EAAOuoE,SAASlnE,UAChB,IAAK,MAAM7B,KAAUQ,EAAOuoE,SAAU,CAClC,MAAOhF,EAAWmF,SAAgB9wE,QAAQQ,IAAI,CAC1C8vE,GAAe1oE,EAAO67C,IAAKqe,EAAYllE,GACvC2zE,GAAYrzC,EAAMumB,IAAKvmB,EAAMrvC,KAAMi0E,EAAYllE,KAOnD6mD,SALqByrB,GAAQvD,EAAWmF,EAAQhP,EAAY,IACrDllE,EACH+yE,kBAAkB,EAClB5N,WAAYte,EAAI/rC,WAEP+rC,IACb77C,EAAO67C,IAAMA,EACbvmB,EAAQt1B,CACZ,CACA,OAAO67C,CACX,CClFA,MAAMstB,GAAe,UAAe,CAAEC,iBAAiB,IACjDC,GAAiB,CAAC,ECLjB,MAAMC,GAA8B,OCerC,GAAe,UAAe,CAAEF,iBAAiB,IACjD,GAAMxiB,GAAO,sBACb,GAAiB,CACnB6d,WAAW,EACXjF,yBAA0B8J,ICZ9B,MAAM,GAAe,UAAe,CAAEF,iBAAiB,IACjD,GAAMxiB,GAAO,mBACb,GAAiB,CACnB2iB,OAAO,EACP/J,yBAA0B8J,ICP9B,MAAM,GAAe,UAAe,CAAEF,iBAAiB,IACjD,GAAiB,CAAC,ECOxB,MAAM,GAAe,UAAe,CAAEA,iBAAiB,IACjD,GAAMxiB,GAAO,sBACb,GAAiB,CACnBuT,WAAY,EACZoP,OAAO,EACP/J,yBAA0B8J,ICT9B,MAAM,GAAM1iB,GAAO,kCAkBnB,MAAM4iB,GAAsB3kF,MAAOmb,EAAQ/Z,EAAMi0E,EAAYllE,KAEzDgL,EAAO3Q,KAAKsrE,MAAQ36D,EAAO3Q,KAAKsrE,MAAM77D,QAAQ08C,GACnCA,EAAKkgB,OAASz1E,IAEzB,MAAMwjF,EAAc,SAAazpE,EAAO3Q,MAClCq6E,QAAkB,GAAQD,EAAavP,EAAY,IAClDllE,EACHmlE,WAAYn6D,EAAO67C,IAAI/rC,UAG3B,OADA,GAAI,6BAA6B45D,KAC1B,CACHr6E,KAAM2Q,EAAO3Q,KACbwsD,IAAK6tB,EACR,EAECC,GAA6B9kF,MAAOmb,EAAQ/Z,EAAMi0E,EAAYllE,KAChE,MAAM,KAAE4gB,SAAeqxD,GAAyBjnE,EAAO67C,IAAK51D,EAAMi0E,EAAYllE,GACxEgzE,EAAepyD,EAAKA,EAAK/3B,OAAS,GACxC,GAAoB,MAAhBmqF,EACA,MAAM,IAAI7oF,MAAM,yCAEpB,MAAM6jF,EAAWgF,EAAa34E,KAAKsrE,MAAM77D,QAAO0Z,IAAMA,EAAEkjD,MAAQ,IAAIr1E,UAAU,KAAOJ,IAAMub,KAAIgX,GAAKA,EAAEkjD,OAAM/0C,MAC5G,GAAgB,MAAZq8C,EACA,MAAM,IAAI7jF,MAAM,kBAEpB,MAAMihB,EAAS4iE,EAAS38E,UAAU,EAAG,GAC/B4qB,EAAQ3jB,SAAS8S,EAAQ,IAI/B,GAFA4nE,EAAa34E,KAAKsrE,MAAQqN,EAAa34E,KAAKsrE,MAAM77D,QAAO08C,GAAQA,EAAKkgB,OAASsH,IAC/EgF,EAAahK,SAAS4L,MAAM34D,GACW,IAAnC+2D,EAAa34E,KAAKsrE,MAAM98E,OAExB,KACwB,IAAhB+3B,EAAK/3B,QADA,CAIT,MAAMkpF,EAAUnxD,EAAKA,EAAK/3B,OAAS,GACnC,GAAe,MAAXkpF,GAAmBA,EAAQ13E,KAAKsrE,MAAM98E,OAAS,EAC/C,MAGJ+3B,EAAK+Q,MACL,MAAMqgD,EAAcpxD,EAAKA,EAAK/3B,OAAS,GACvC,GAAmB,MAAfmpF,EACA,MAEJ,MAAMxrB,EAAOurB,EAAQ13E,KAAKsrE,MAAM,GAChCqM,EAAY33E,KAAKsrE,MAAQqM,EAAY33E,KAAKsrE,MAAM77D,QAAO0Z,KAAOA,EAAEkjD,MAAQ,IAAI/W,WAAWqiB,EAAY5mE,UACnG4mE,EAAY33E,KAAKsrE,MAAMr8E,KAAK,CACxBuyD,KAAM2K,EAAK3K,KACX6qB,KAAM,GAAGsL,EAAY5mE,UAAUo7C,EAAKkgB,MAAQ,IAAIr1E,UAAU,KAC1Ds1E,MAAOngB,EAAKmgB,OAEpB,CAEJ,OAAOkL,GAAuBjxD,EAAMskD,EAAYllE,EAAQ,EAEtD60E,GAAyBhlF,MAAOmb,EAAQk6D,EAAYllE,KACtD,GAAwB,MAApBgL,EAAO3Q,KAAKgxD,KACZ,MAAM,IAAI8kB,GAAuB,mDAErC,MAAM2E,EAAW,CACbnP,MAAO,IAELp2D,QAAYs6C,GAAS7+C,EAAO67C,IAAKqe,GACvC,GAAiB,cAAb31D,EAAIzO,KACJ,MAAM,IAAI3W,MAAM,wBAEpB,UAAW,MAAMua,KAAS6K,EAAI+1D,UAAW,CACrC,IAAIyP,EAAQ,EAERA,EADArwE,EAAMrK,gBAAgBjO,WACdsY,EAAMrK,KAAKoE,WAGX,SAAaiG,EAAMrK,MAAMxR,OAErCisF,EAASnP,MAAMr8E,KAAK,CAChBuyD,KAAMn3C,EAAMmiD,IACZ6f,KAAMhiE,EAAMzT,KACZ01E,MAAOoO,GAEf,CAEA,MAAMC,EAAY7Q,EAAO8I,UAAUjiE,EAAO3Q,KAAKgxD,MAC/CypB,EAASzpB,KAAO,IAAI8Y,EAAO,CAAErjE,KAAM,YAAa2a,KAAMu5D,EAAUv5D,KAAM+nD,MAAOwR,EAAUxR,QAAShY,UAChG,MAAMxmB,EAAQ,SAAa,UAAc8vC,IAMzC,MAAO,CACHjuB,UANc,GAAQ7hB,EAAOkgC,EAAY,CACzC3c,MAAO,EACP4c,WAAYn6D,EAAO67C,IAAI/rC,QACvBjB,OAAQ7Z,EAAQ6Z,SAIhBxf,KAAMy6E,EACT,ECnHC,GAAe,UAAe,CAAEV,iBAAiB,IACjD,GAAMxiB,GAAO,mBACb,GAAiB,CACnB4Y,yBAA0B8J,IAEvBzkF,eAAeolF,GAAGhxE,EAAQhT,EAAMi0E,EAAYllE,EAAU,CAAC,GAC1D,MAAM2jC,EAAO,GAAa,GAAgB3jC,GAC1C,GAAI/O,EAAKkiB,SAAS,KACd,MAAM,IAAIg9D,GAAuB,8BAErC,MAAMpB,QAAkB2E,GAAezvE,EAAQihE,EAAYvhC,GAC3D,GAAI,sBAAuB1yC,EAAMgT,GACjC,MAAMuH,QDTH3b,eAA0Bmb,EAAQ/Z,EAAMi0E,EAAYllE,GACvD,GAAwB,MAApBgL,EAAO3Q,KAAKgxD,KACZ,MAAM,IAAIwkB,GAAmB,2BAGjC,GAAkB,2BADL1L,EAAO8I,UAAUjiE,EAAO3Q,KAAKgxD,MACjCvqD,KAAmC,CACxC,GAAI,YAAY7P,4BAChB,MAAMua,QAAempE,GAA2B3pE,EAAQ/Z,EAAMi0E,EAAYllE,GAC1E,aAAYmyE,GAAqB3mE,EAAOnR,KAAM6qE,EAAYllE,EAAQwqE,yBAA0BxqE,GAIrFwL,GAHH,GAAI,wCAAyCR,EAAO67C,KAC7CguB,GAAuBrpE,EAAQ05D,EAAYllE,GAG1D,CAEA,OADA,GAAI,iBAAiB/O,uBACdujF,GAAoBxpE,EAAQ/Z,EAAMi0E,EAAYllE,EACzD,CCPyBk1E,CAAWnG,EAAW99E,EAAMi0E,EAAY,IACtDvhC,EACHwhC,WAAYlhE,EAAO6W,UAEvB,OAAOtP,EAAOq7C,GAClB,CCfA,MAAM,GAAe,UAAe,CAAEutB,iBAAiB,IACjD,GAAMxiB,GAAO,qBACb,GAAiB,CAAC,EACjB/hE,eAAeslF,GAAKtuB,EAAKqe,EAAYllE,EAAU,CAAC,GACnD,MAAM2jC,EAAO,GAAa,GAAgB3jC,GACpCo1E,QAAiB,GAAQvuB,EAAK7mD,EAAQ4gB,KAAMskD,EAAYvhC,GAC9D,GAAI,UAAWyxC,EAASvuB,KACxB,MAAMr7C,QAAeq+C,GAASurB,EAASvuB,IAAKqe,EAAYvhC,GACxD,GAAoB,SAAhBn4B,EAAO1K,MAAmC,cAAhB0K,EAAO1K,MAAwC,QAAhB0K,EAAO1K,KAChE,MAAM,IAAI8uE,GAEd,IAKIn0D,EACA+nD,EANAqB,EAAW,GACXwQ,EAAU,GACVC,EAAgB,GAChBC,EAAe,GACfz4B,EAAS,EAGb,MAAMh8C,EAAO0K,EAAO1K,KACpB,IAAIykE,EAkBJ,GAjBoB,QAAhB/5D,EAAO1K,OACP+jE,EAAWhxD,OAAOrI,EAAOnR,KAAKoE,YAC9B42E,EAAUxhE,OAAOrI,EAAOnR,KAAKoE,YAC7B62E,EAAgBzhE,OAAOrI,EAAOnR,KAAKoE,YACnC82E,EAAe1hE,OAAOrI,EAAOnR,KAAKoE,YAClCq+C,EAAS,GAEO,cAAhBtxC,EAAO1K,OACP+jE,EAAW,GACXwQ,EAAUxhE,OAAOrI,EAAO+5D,OAAO/Z,UAAU/sD,YACzC62E,EAAgB,GAChBC,EAAeF,EACfv4B,EAAS,EACTrhC,EAAOjQ,EAAO+5D,OAAO9pD,KACrB+nD,EAAQh4D,EAAO+5D,OAAO/B,MACtB+B,EAAS/5D,EAAO+5D,QAEA,SAAhB/5D,EAAO1K,KAAiB,CACxB,MAAMie,QAAgBy2D,GAAWJ,EAASvuB,IAAKqe,EAAYvhC,GAC3DkhC,EAAWr5D,EAAO+5D,OAAOV,WACzBwQ,EAAUxhE,QAAQrI,EAAOnR,KAAKgxD,MAAM5sD,YAAc,GAAK+M,EAAOnR,KAAKsrE,MAAM3kD,QAAO,CAACtd,EAAK5S,IAAS4S,GAAO5S,EAAK61E,OAAS,IAAI,IACxH2O,EAAgBzhE,OAAOkL,EAAQu2D,eAC/BC,EAAe1hE,OAAOkL,EAAQw2D,cAC9Bz4B,EAAS/9B,EAAQ+9B,OACjBrhC,EAAOjQ,EAAO+5D,OAAO9pD,KACrB+nD,EAAQh4D,EAAO+5D,OAAO/B,MACtB+B,EAAS/5D,EAAO+5D,MACpB,CACA,MAAO,CACH1e,IAAKuuB,EAASvuB,IACdprC,OACA+nD,QACAqB,WACAwQ,UACAC,gBACAC,eACAz4B,SACAh8C,OACAykE,SAER,CACA11E,eAAe2lF,GAAW3uB,EAAKqe,EAAYllE,GACvC,MAAM+e,EAAU,CACZu2D,cAAe,EACfC,aAAc,EACdz4B,OAAQ,GAEZ,SAAUooB,EAAWt4D,IAAIi6C,EAAK7mD,GAAU,CACpC,MAAMglC,QAAckgC,EAAW3yE,IAAIs0D,EAAK7mD,GAGxC,GAFA+e,EAAQ+9B,SACR/9B,EAAQw2D,cAAgBvwC,EAAMvmC,WAC1BooD,EAAI5mD,OAAS,EACb8e,EAAQu2D,eAAiBtwC,EAAMvmC,eAE9B,IAAIooD,EAAI5mD,OAAS,OAwBlB,MAAM,IAAI,GAAa,GAAG4mD,EAAItwD,yCAxBA,CAC9B,MAAMk/E,EAAS,SAAazwC,GAC5B,GAAIywC,EAAO9P,MAAM98E,OAAS,EAEtB,IAAK,MAAM29D,KAAQivB,EAAO9P,MAAO,CAC7B,MAAM+P,QAAmBF,GAAWhvB,EAAK3K,KAAMqpB,EAAYllE,GAC3D+e,EAAQu2D,eAAiBI,EAAWJ,cACpCv2D,EAAQw2D,cAAgBG,EAAWH,aACnCx2D,EAAQ+9B,QAAU44B,EAAW54B,MACjC,KAEC,CAED,GAAmB,MAAf24B,EAAOpqB,KACP,MAAM,IAAIwkB,GAAmB,UAAUhpB,EAAItwD,0BAE/C,MAAMgvE,EAASpB,EAAO8I,UAAUwI,EAAOpqB,MACvC,GAAmB,MAAfka,EAAOl3D,KACP,MAAM,IAAIwhE,GAAmB,eAAehpB,EAAItwD,0BAEpDwoB,EAAQu2D,eAAiB/P,EAAOl3D,KAAK5P,YAAc,CACvD,CACJ,CAGA,CACJ,CACA,OAAOsgB,CACX,CC/FA,MAAM,GAAe,UAAe,CAAEq1D,iBAAiB,IACjD,GAAMxiB,GAAO,sBACb,GAAiB,CACnB6d,WAAW,EACXjF,yBAA0B8J,aCkC9B,MAAMqB,GACFC,WACAlkF,YAAYkkF,GACRhkF,KAAKgkF,WAAaA,CACtB,CACA/lF,aAAcE,EAAQiQ,EAAU,CAAC,SpD1C9BnQ,gBAAuBE,EAAQm1E,EAAYllE,EAAU,CAAC,SAClD0qE,GAAS36E,EAAQm1E,EAAY,IAC7B0G,MACA5rE,GAEX,CoDsCe61E,CAAO9lF,EAAQ6B,KAAKgkF,WAAW1Q,WAAYllE,EACtD,CACAnQ,eAAesF,EAAO6K,EAAU,CAAC,GAC7B,OAAO6rE,GAAS12E,EAAOvD,KAAKgkF,WAAW1Q,WAAYllE,EACvD,CACAnQ,oBAAoBsF,EAAO6K,EAAU,CAAC,GAClC,OAAO+rE,GAAc52E,EAAOvD,KAAKgkF,WAAW1Q,WAAYllE,EAC5D,CACAnQ,cAAc7F,EAAMgW,EAAU,CAAC,GAC3B,OpDhCDnQ,eAAuB7F,EAAMk7E,EAAYllE,EAAU,CAAC,GACvD,MAAM,IAAE6mD,SAAc8kB,GAAW3hF,EAAMk7E,EAAY,IAC5C0G,MACA5rE,IAEP,OAAO6mD,CACX,CoD0Be3mB,CAAQl2C,EAAM4H,KAAKgkF,WAAW1Q,WAAYllE,EACrD,CACAnQ,mBAAmB0f,EAAM,CAAC,EAAGvP,EAAU,CAAC,GACpC,OAAOksE,GAAa38D,EAAK3d,KAAKgkF,WAAW1Q,WAAYllE,EACzD,CACAnQ,UAAWg3D,EAAK7mD,EAAU,CAAC,SVnExBnQ,gBAAoBg3D,EAAKqe,EAAYllE,EAAU,CAAC,GACnD,MAAM2jC,EAAOwwC,GAAaE,GAAgBr0E,GACpCo1E,QAAiB,GAAQvuB,EAAKljB,EAAK/iB,KAAMskD,EAAYvhC,GACrDn4B,QAAeq+C,GAASurB,EAASvuB,IAAKqe,EAAYvhC,GACxD,GAAoB,SAAhBn4B,EAAO1K,MAAmC,QAAhB0K,EAAO1K,KACjC,MAAM,IAAImvE,GAEd,GAAsB,MAAlBzkE,EAAO85D,QACP,MAAM,IAAI0K,SAEPxkE,EAAO85D,QAAQ3hC,EAC1B,CUyDemyC,CAAIjvB,EAAKj1D,KAAKgkF,WAAW1Q,WAAYllE,EAChD,CACAnQ,YAAYg3D,EAAKprC,EAAMzb,EAAU,CAAC,GAC9B,ORxDDnQ,eAAqBg3D,EAAKprC,EAAMypD,EAAYllE,EAAU,CAAC,GAC1D,MAAM2jC,EAAO,GAAa,GAAgB3jC,GACpCo1E,QAAiB,GAAQvuB,EAAKljB,EAAK/iB,KAAMskD,EAAYllE,GAE3D,GADA,GAAI,cAAeo1E,EAASvuB,IAAKprC,GAC7BkoB,EAAK8rC,UAAW,CAGhB,MAAMpI,QAAa,SAAKx3E,kBACpB,UAAW,MAAM6U,KAAS+qE,GAAU2F,EAASvuB,IAAKqe,EAAYllE,GAAU,CACpE,IAAIqqC,EACAo8B,EAAQ,GACZ,GAAmB,QAAf/hE,EAAM5D,KAENupC,EAAW,IAAI85B,EAAO,CAAErjE,KAAM,OAAQuN,KAAM3J,EAAMrK,WAEjD,IAAmB,SAAfqK,EAAM5D,MAAkC,cAAf4D,EAAM5D,KAKpC,MAAM,IAAI8uE,GAJVvlC,EAAW3lC,EAAM6gE,OACjBkB,EAAQ/hE,EAAMrK,KAAKsrE,KAIvB,CACAt7B,EAAS5uB,KAAOA,EAChB,MAAMphB,EAAO,CACTgxD,KAAMhhB,EAASmhB,UACfma,MAAOc,QAEL,CACF7lD,KAAMlc,EAAMkc,KACZ0kD,QAASjrE,EAEjB,CACJ,IAECtK,GAAW26E,GAAS36E,EAAQm1E,EAAY,IAClCvhC,EACHsnC,WAAYp7E,gBAAiBE,EAAQi1C,GACjC,UAAW,MAAMtgC,KAAS3U,QAChBF,iBAEF,MAAMwK,EAAOqK,EAAM4gE,QACb34E,EAAM,SAAa0N,GACnB07E,QAAmB,GAAQppF,EAAKq4C,EAAO,IACtCrB,EACHwhC,WAAYte,EAAI/rC,UAEpB,GAAiB,MAAbzgB,EAAKgxD,KACL,MAAM,IAAIwkB,GAAmB,GAAGkG,iBAEpC,MAAMxQ,EAASpB,EAAO8I,UAAU5yE,EAAKgxD,MACrC,MAAO,CACHxE,IAAKkvB,EACL1sF,KAAMwqB,OAAOlnB,EAAI9D,QACjB+3B,KAAMlc,EAAMkc,KACZ2kD,SAER,CAER,MACA11E,MAAOmmF,GAAU,GAAKA,KAC1B,GAAY,MAAR3O,EACA,MAAM,IAAI,GAAa,mBAAmB+N,EAASvuB,IAAItwD,cAE3D,OAAO09E,GAAe5M,EAAKxgB,IAAKuuB,EAAUlQ,EAAYvhC,EAC1D,CACA,MAAMqB,QAAckgC,EAAW3yE,IAAI6iF,EAASvuB,IAAK7mD,GACjD,IAAIqqC,EACAo8B,EAAQ,GACZ,GAAI2O,EAASvuB,IAAI5mD,OAAS,EAEtBoqC,EAAW,IAAI85B,EAAO,CAAErjE,KAAM,OAAQuN,KAAM22B,QAE3C,CACD,MAAM3qC,EAAO,SAAa2qC,GAC1B,GAAiB,MAAb3qC,EAAKgxD,KACL,MAAM,IAAIwkB,GAAmB,GAAGuF,EAASvuB,IAAItwD,0BAEjDkwE,EAAQpsE,EAAKsrE,MACbt7B,EAAW85B,EAAO8I,UAAU5yE,EAAKgxD,KACrC,CACAhhB,EAAS5uB,KAAOA,EAChB,MAAMw6D,EAAe,SAAa,CAC9B5qB,KAAMhhB,EAASmhB,UACfma,MAAOc,IAELv1E,QAAa8tD,GAAO/C,OAAOg6B,GAC3BF,EAAajvB,GAAIv2D,OAAO6kF,EAASvuB,IAAI/rC,QAAS,OAAY5pB,GAEhE,aADMg0E,EAAWplE,IAAIi2E,EAAYE,GAC1BhC,GAAe8B,EAAYX,EAAUlQ,EAAYvhC,EAC5D,CQjCeuyC,CAAMrvB,EAAKprC,EAAM7pB,KAAKgkF,WAAW1Q,WAAYllE,EACxD,CACAnQ,SAASE,EAAQkU,EAAQhT,EAAM+O,EAAU,CAAC,GACtC,OPnEDnQ,eAAkBE,EAAQkU,EAAQhT,EAAMi0E,EAAYllE,EAAU,CAAC,GAClE,MAAM2jC,EAAO,GAAa,GAAgB3jC,GAC1C,GAAI/O,EAAKkiB,SAAS,KACd,MAAM,IAAIg9D,GAAuB,8BAErC,MAAOpB,EAAWmF,SAAgB9wE,QAAQQ,IAAI,CAC1C8vE,GAAezvE,EAAQihE,EAAYvhC,GACnCgwC,GAAY5jF,EAAQkB,EAAMi0E,EAAYvhC,KAQ1C,OANA,GAAI,0BAA2B5zC,EAAQkB,EAAMgT,UACxBquE,GAAQvD,EAAWmF,EAAQhP,EAAY,CACxD6N,iBAAkBpvC,EAAK4wC,MACvBpP,WAAYlhE,EAAO6W,WAChB6oB,KAEOkjB,GAClB,COmDesvB,CAAGpmF,EAAQkU,EAAQhT,EAAMW,KAAKgkF,WAAW1Q,WAAYllE,EAChE,CACAnQ,SAAUg3D,EAAK7mD,EAAU,CAAC,SN5EvBnQ,gBAAmBg3D,EAAKqe,EAAYllE,EAAU,CAAC,GAClD,MAAM2jC,EAAO,GAAa,GAAgB3jC,GACpCo1E,QAAiB,GAAQvuB,EAAKljB,EAAK/iB,KAAMskD,EAAYvhC,GACrDn4B,QAAeq+C,GAASurB,EAASvuB,IAAKqe,GAC5C,GAAoB,SAAhB15D,EAAO1K,MAAmC,QAAhB0K,EAAO1K,KAArC,CAIA,GAAsB,MAAlB0K,EAAO85D,QACP,MAAM,IAAI0K,GAEd,GAAoB,cAAhBxkE,EAAO1K,KACP,MAAM,IAAIovE,SAEP1kE,EAAO85D,QAAQ,CAClBx8E,OAAQkX,EAAQlX,OAChBD,OAAQmX,EAAQnX,QATpB,YAFU2iB,CAad,CM2De4qE,CAAGvvB,EAAKj1D,KAAKgkF,WAAW1Q,WAAYllE,EAC/C,CACAnQ,YAAYg3D,EAAKwvB,EAASr2E,EAAU,CAAC,GACjC,OLnEDnQ,eAAqB6kF,EAAW2B,EAASnR,EAAYllE,EAAU,CAAC,GACnE,MAAM2jC,EAAO,GAAa,GAAgB3jC,GAC1C,GAAIq2E,EAAQljE,SAAS,KACjB,MAAM,IAAIg9D,GAAuB,8BAGrC,GAAmB,qBADCtmB,GAAS6qB,EAAWxP,EAAYllE,IAC1Cc,KACN,MAAM,IAAIovE,GAAmB,GAAGwE,EAAUn+E,yCAE9C,GAAI,cAAe8/E,GACnB,MAMMh8E,EAAO,CACTgxD,KAPa,IAAI8Y,EAAO,CACxBrjE,KAAM,YACN2a,KAAMkoB,EAAKloB,KACX+nD,MAAO7/B,EAAK6/B,QAIGhY,UACfma,MAAO,IAELh5E,EAAM,SAAa0N,GACnBnJ,QAAa8tD,GAAO/C,OAAOtvD,GAC3B2pF,EAAcxvB,GAAIv2D,OAAOozC,EAAKwhC,WAAY,OAAYj0E,SACtDg0E,EAAWplE,IAAIw2E,EAAa3pF,GAClC,MAAOoiF,EAAWmF,SAAgB9wE,QAAQQ,IAAI,CAC1C8vE,GAAegB,EAAWxP,EAAYvhC,GACtCgwC,GAAY2C,EAAaD,EAASnR,EAAYvhC,KAOlD,OALA,GAAI,mCAAoC0yC,EAAS3B,UAC5BpC,GAAQvD,EAAWmF,EAAQhP,EAAY,IACrDvhC,EACHovC,iBAAkBpvC,EAAK4wC,SAEb1tB,GAClB,CKiCe0vB,CAAM1vB,EAAKwvB,EAASzkF,KAAKgkF,WAAW1Q,WAAYllE,EAC3D,CACAnQ,SAASg3D,EAAKjmC,EAAM5gB,EAAU,CAAC,GAC3B,OAAOi1E,GAAGpuB,EAAKjmC,EAAMhvB,KAAKgkF,WAAW1Q,WAAYllE,EACrD,CACAnQ,WAAWg3D,EAAK7mD,EAAU,CAAC,GACvB,OAAOm1E,GAAKtuB,EAAKj1D,KAAKgkF,WAAW1Q,WAAYllE,EACjD,CACAnQ,YAAYg3D,EAAK7mD,EAAU,CAAC,GACxB,OD1EDnQ,eAAqBg3D,EAAKqe,EAAYllE,EAAU,CAAC,GACpD,MAAM2jC,EAAO,GAAa,GAAgB3jC,GACpCo1E,QAAiB,GAAQvuB,EAAKljB,EAAK/iB,KAAMskD,EAAYvhC,GACrD6/B,EAAQ7/B,EAAK6/B,OAAS,CACxBc,KAAMzwD,OAAOhpB,KAAKsmC,MAAMrmC,KAAKm+C,MAAQ,MACrCs7B,MAAO,GAGX,GADA,GAAI,cAAe6Q,EAASvuB,IAAK2c,GAC7B7/B,EAAK8rC,UAAW,CAGhB,MAAMpI,QAAa,SAAKx3E,kBACpB,UAAW,MAAM6U,KAAS+qE,GAAU2F,EAASvuB,IAAKqe,GAAa,CAC3D,IAAI76B,EACAo8B,EACJ,GAAmB,QAAf/hE,EAAM5D,KACNupC,EAAW,IAAI85B,EAAO,CAAE91D,KAAM3J,EAAMrK,OACpCosE,EAAQ,OAEP,IAAmB,SAAf/hE,EAAM5D,MAAkC,cAAf4D,EAAM5D,KAKpC,MAAM,IAAI8uE,GAJVvlC,EAAW3lC,EAAM6gE,OACjBkB,EAAQ/hE,EAAMrK,KAAKsrE,KAIvB,CACAt7B,EAASm5B,MAAQA,EACjB,MAAMnpE,EAAO,CACTgxD,KAAMhhB,EAASmhB,UACfma,MAAOc,QAEL,CACF7lD,KAAMlc,EAAMkc,KACZ0kD,QAASjrE,EAEjB,CACJ,IAECtK,GAAW26E,GAAS36E,EAAQm1E,EAAY,IAClCvhC,EACHsnC,WAAYp7E,gBAAiBE,EAAQi1C,GACjC,UAAW,MAAMtgC,KAAS3U,QAChBF,iBAEF,MAAMwK,EAAOqK,EAAM4gE,QACb34E,EAAM,SAAa0N,GACnB07E,QAAmB,GAAQppF,EAAKq4C,EAAO,IACtCrB,EACHwhC,WAAYte,EAAI/rC,UAEpB,GAAiB,MAAbzgB,EAAKgxD,KACL,MAAM,IAAIwkB,GAAmB,GAAGkG,iBAEpC,MAAMxQ,EAASpB,EAAO8I,UAAU5yE,EAAKgxD,MACrC,MAAO,CACHxE,IAAKkvB,EACL1sF,KAAMwqB,OAAOlnB,EAAI9D,QACjB+3B,KAAMlc,EAAMkc,KACZ2kD,SAER,CAER,MACA11E,MAAOmmF,GAAU,GAAKA,KAC1B,GAAY,MAAR3O,EACA,MAAM,IAAI,GAAa,mBAAmB+N,EAASvuB,IAAItwD,cAE3D,OAAO09E,GAAe5M,EAAKxgB,IAAKuuB,EAAUlQ,EAAYvhC,EAC1D,CACA,MAAMqB,QAAckgC,EAAW3yE,IAAI6iF,EAASvuB,IAAK7mD,GACjD,IAAIqqC,EACAo8B,EAAQ,GACZ,GAAI2O,EAASvuB,IAAI5mD,OAAS,EACtBoqC,EAAW,IAAI85B,EAAO,CAAE91D,KAAM22B,QAE7B,CACD,MAAM3qC,EAAO,SAAa2qC,GAE1B,GADAyhC,EAAQpsE,EAAKsrE,MACI,MAAbtrE,EAAKgxD,KACL,MAAM,IAAIwkB,GAAmB,GAAGuF,EAASvuB,IAAItwD,0BAEjD8zC,EAAW85B,EAAO8I,UAAU5yE,EAAKgxD,KACrC,CACAhhB,EAASm5B,MAAQA,EACjB,MAAMyS,EAAe,SAAa,CAC9B5qB,KAAMhhB,EAASmhB,UACfma,MAAOc,IAELv1E,QAAa8tD,GAAO/C,OAAOg6B,GAC3BF,EAAajvB,GAAIv2D,OAAO6kF,EAASvuB,IAAI/rC,QAAS,OAAY5pB,GAEhE,aADMg0E,EAAWplE,IAAIi2E,EAAYE,GAC1BhC,GAAe8B,EAAYX,EAAUlQ,EAAYvhC,EAC5D,CClBe6yC,CAAM3vB,EAAKj1D,KAAKgkF,WAAW1Q,WAAYllE,EAClD,EAKG,SAASulE,GAAOkR,GACnB,OAAO,IAAId,GAAcc,EAC7B,uHCvGO,MAAMxd,UAAmB9uE,MAC5BuH,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,ECFG,SAASi5D,EAAgBnpE,EAAQ8pB,EAAQ7Z,GAC5C,MAAM2jC,EAAO3jC,GAAW,CAAC,EACnBwJ,ECLH,SAAqBtO,GACxB,GAAW,MAAPA,EAAa,CACb,GAAoC,mBAAzBA,EAAI9S,OAAOohB,UAClB,OAAOtO,EAAI9S,OAAOohB,YAEtB,GAAyC,mBAA9BtO,EAAI9S,OAAOgc,eAClB,OAAOlJ,EAAI9S,OAAOgc,iBAEtB,GAAwB,mBAAblJ,EAAI+B,KACX,OAAO/B,CAEf,CACA,MAAM,IAAI/Q,MAAM,0CACpB,CDRqBgvE,CAAYppE,GA+D7B,OA9DAF,kBACI,IAAIupE,EACJ,MAAMC,EAAe,KACO,MAApBD,GACAA,GAAkB,EAG1B,IADAv/C,EAAOE,iBAAiB,QAASs/C,KACpB,CACT,IAAI7tD,EACJ,IACI,GAAIqO,EAAOG,QAAS,CAChB,MAAM,aAAEs/C,EAAY,UAAEC,GAAc51B,EACpC,MAAM,IAAIs1B,EAAWK,EAAcC,EACvC,CACA,MAAMzvE,EAAQ,IAAIsZ,SAAQ,CAACC,EAASC,KAChC81D,EAAmB,KACf,MAAM,aAAEE,EAAY,UAAEC,GAAc51B,EACpCrgC,EAAO,IAAI21D,EAAWK,EAAcC,GAAW,CAClD,IAGL/tD,QAAepI,QAAQo2D,KAAK,CAAC1vE,EAAO0f,EAASvM,SAC7Cm8D,EAAmB,IACvB,CACA,MAAO5hE,GACHqiB,EAAOC,oBAAoB,QAASu/C,GAEpC,MAAMI,EAA8B,YAAbjiE,EAAIsJ,MAAsB+Y,EAAOG,QAMxD,GALIy/C,GAAmC,MAAhB91B,EAAK/pB,eAElB+pB,EAAK/pB,QAAQ7pB,GAGQ,mBAApByZ,EAASuyB,OAChB,IACI,MAAM5uC,EAAIqc,EAASuyB,SACf5uC,aAAaiW,SACbjW,EAAEkyB,OAAM7nB,IACsB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EACvB,GAGZ,CACA,MAAOA,GACuB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EAE3B,CAEJ,GAAIiiE,IAAyC,IAAvB91B,EAAKg2B,cACvB,OAEJ,MAAMniE,CACV,CACA,IAAoB,IAAhBgU,EAAOye,KACP,YAEEze,EAAO/a,KACjB,CACAopB,EAAOC,oBAAoB,QAASu/C,EACxC,CACOO,EACX,CACO,SAAS8c,EAAc97B,EAAM/gC,EAAQ7Z,GACxC,OAAQjQ,GAAW6qD,EAAKse,EAAgBnpE,EAAQ8pB,EAAQ7Z,GAC5D,CACO,SAAS22E,EAAgBC,EAAQ/8D,EAAQ7Z,GAC5C,MAAO,CACH46C,KAAM87B,EAAcE,EAAOh8B,KAAM/gC,EAAQ,IAClC7Z,EACH4Z,aAAStgB,IAEbvJ,OAAQmpE,EAAgB0d,EAAO7mF,OAAQ8pB,EAAQ7Z,GAEvD,qCEjFe,SAAS62E,EAAapoE,GACpC,IAAKjkB,MAAMuJ,QAAQ0a,GAClB,MAAM,IAAI7X,UAAU,iCAAiC6X,GAKtD,IAAK,IAAIwN,GAFTxN,EAAQ,IAAIA,IAEW5lB,OAAS,EAAGozB,EAAQ,EAAGA,IAAS,CACtD,MAAMu3D,EAAW3oF,KAAKiQ,MAAMjQ,KAAKy4B,UAAYrH,EAAQ,KACpDxN,EAAMwN,GAAQxN,EAAM+kE,IAAa,CAAC/kE,EAAM+kE,GAAW/kE,EAAMwN,GAC3D,CAEA,OAAOxN,CACR,oHCXe,SAASqoE,EAASrtD,GAC7B,MAA2B,mBAAhBA,EAAKi3C,QACL,OAA0Bj3C,EAAKi3C,WAInC,OAA0B,IAAI9wE,SAAS65B,GAAMtB,KACxD,ocCRO,SAAS4uD,EAAgBv/E,GAE5B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,eAChB,EAAQqN,EAAK,kBACxB,CACO,SAASw/E,EAAiBx/E,GAE7B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,gBAChB,EAAQqN,EAAK,mBACxB,CACO,SAASy/E,EAAez/E,GAE3B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,cAChB,EAAQqN,EAAK,iBACxB,CACO,SAAS0/E,EAAe1/E,GAE3B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,cAChB,EAAQqN,EAAK,iBACxB,CACO,SAAS2/E,EAAkB3/E,GAE9B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,iBAChB,EAAQqN,EAAK,oBACxB,CACO,SAAS4/E,EAAe5/E,GAE3B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,cAChB,EAAQqN,EAAK,iBACxB,CACO,SAAS6/E,EAAc7/E,GAE1B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,aAChB,EAAQqN,EAAK,gBACxB,CACO,SAAS8/E,EAAa9/E,GAEzB,OADAA,EAAMA,GAAO,IAAIrN,MAAM,WAChB,EAAQqN,EAAK,cACxB,CChCO,MAAM,EACToV,IAAI7M,EAAKC,GACL,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACA2V,IAAIC,EAAK/C,EAAKgD,GACV,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACA0F,cAAeE,EAAQiQ,GACnB,UAAW,MAAM,IAAE6mD,EAAG,MAAE7hB,KAAWj1C,QACzB6B,KAAKkO,IAAI+mD,EAAK7hB,EAAOhlC,SACrB6mD,CAEd,CACAt0D,IAAIwN,EAAKC,GACL,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACA0F,cAAeE,EAAQiQ,GACnB,UAAW,MAAMD,KAAOhQ,OACd,CACF82D,IAAK9mD,EACLilC,YAAapzC,KAAKW,IAAIwN,EAAKC,GAGvC,CACAnQ,aAAakQ,EAAKC,SACRoD,QAAQE,OAAO,IAAInZ,MAAM,8BACnC,CACA0F,iBAAkBE,EAAQiQ,GACtB,UAAW,MAAMD,KAAOhQ,QACd6B,KAAKiY,OAAO9J,EAAKC,SACjBD,CAEd,CAIAlQ,aAAcmQ,GACV,MAAM,IAAI7V,MAAM,6BACpB,ECoFJ,IAIA,EAzHA,SAAeq2D,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECzHc,IAAI7E,WAAW,GAA7B,MAsCM,EAASuD,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAMy3D,EAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,EAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,EAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,EAAK,CAACI,EAAMC,IAAU,IAAIH,EAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,EAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,EAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,EAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,EAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,EAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,EAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,EAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,EAAO1tB,EAAO0tB,KAC/B,EA4GUi3B,EAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,EAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrCwyD,EAASd,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,ICJFwB,GDOczB,EAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkBD,EAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQD,EAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DUF,EAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,gEAGgBspC,EAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCXZ,IAAIyrC,EAOJ,SAAS,EAAOtsB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAOwsB,GACXl3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,GAAO,IAET,KAAMA,EAAM0sB,GACVp3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBIm3D,EAAM,IAENC,GAAS,IACTF,EAAMl6D,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,EAKJ,SAASngB,EAAK5I,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADAjuB,EAAKJ,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAIg3C,IAAWl0D,GACfkd,EAAIg3C,GAAUr6D,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAKi3C,GAId,OAFA5vD,EAAKJ,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BIm0C,EAAQ,IACRD,EAAS,IA2Bb,IAAIE,EAAKv6D,KAAK6qB,IAAI,EAAI,GAClB2vC,EAAKx6D,KAAK6qB,IAAI,EAAG,IACjB4vC,EAAKz6D,KAAK6qB,IAAI,EAAG,IACjB6vC,EAAK16D,KAAK6qB,IAAI,EAAG,IACjB8vC,EAAK36D,KAAK6qB,IAAI,EAAG,IACjB+vC,EAAK56D,KAAK6qB,IAAI,EAAG,IACjBgwC,EAAK76D,KAAK6qB,IAAI,EAAG,IACjBiwC,EAAK96D,KAAK6qB,IAAI,EAAG,IACjBkwC,EAAK/6D,KAAK6qB,IAAI,EAAG,IAyBrB,EARa,CACT/U,OAAQkkD,EACR7mD,OAAQ,EACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ20D,EAAK,EACb30D,EAAQ40D,EAAK,EACb50D,EAAQ60D,EAAK,EACb70D,EAAQ80D,EAAK,EACb90D,EAAQ+0D,EAAK,EACb/0D,EAAQg1D,EAAK,EACbh1D,EAAQi1D,EAAK,EACbj1D,EAAQk1D,EAAK,EACbl1D,EAAQm1D,EAAK,EACA,EAEjB,GCzEO,MAAM,EAAS,CAACv3C,EAAMvlB,EAAS,IAE7B,CADM,SAAculB,EAAMvlB,GACnB,gBAQHg9D,EAAW,CAACC,EAAK9hD,EAAQnb,EAAS,KAC7C,SAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI4hD,EAAkBE,GACtB,iBAAsBA,GCElB,EAAUI,IACrB,MAAMhxD,EAAQ,EAAOgxD,IACdlmD,EAAM+lD,GAAc,EAAc7wD,IAClC9L,EAAM48D,GAAgB,EAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI+7D,EAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM+wD,EASXx0D,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtEK,MAAMqL,EAAS,CAACgmD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG4rC,EACLvxD,EACAwxD,EAAUH,GAC+B,GAAUpC,EAAU3B,SAGxDmE,GACLzxD,EACAwxD,EAAUH,GACmCC,GAAQhD,EAAOhB,QAElE,EAoBIx2C,EAAQ,IAAIiW,QAMZykC,EAAYE,IAChB,MAAMF,EAAY16C,EAAM1Z,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADAD,EAAMxe,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAMG,EAOXp1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAASgnD,GACX,MAAM,IAAI98D,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAASinD,GACrB,MAAM,IAAI/8D,MAAM,sDAGlB,OACE28D,EAAIK,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EDxJQ,EAAClmD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,EAAsB/lD,GACnCgmD,EAAeD,EAAa,EAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,EAAgB4W,EAAM9K,EAAO,GAC7B,EAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAIC,EAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EC8InB,CAAc8K,EAAMg8C,GACtC,OACE6K,EAAIO,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAOR,EAAIl0C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SD5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YNrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GM0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GCiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAOjmD,EAAO5O,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK5S,EAAO5O,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiBq2D,EAEnB,OAAOr2D,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAIq2D,EACThsC,EACA7a,EACwC,EACxC9K,GAASwyD,GAAU7sC,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAMm3D,IAAqB,CAIpC,MAAM,QAAE9sC,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,EAAckK,GACjB,OAAOW,EAAIv2D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAASgnD,GACX,MAAM,IAAI98D,MACR,wCAAwC88D,sBAG1C,OAAO,IAAIH,EAAIhsC,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQwyD,GAAU7sC,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI2xD,EAAIhsC,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO6K,EAAIv2D,OAAO,EAAG02D,GAAahL,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO6K,EAAIv2D,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAaf,EAAIgB,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQjB,EAAIkB,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiB,EACrBhzD,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,EACjB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACFgsC,EAAIK,SAAyD,GAC7DL,EAAIO,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,EAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,GAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAASszD,EAAgB14D,EAAQ02D,GAE1CI,EAAMC,EAAI9oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFAw8D,EAAUE,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM4B,EAAkB,CAAC14D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQrC,EACxB,MAAO,CACkBA,EAAgB,OACvCjC,EAAQnkD,OAAO,GAAGomD,EAAUh5C,SAASrb,KAEzC,CACA,KAAKq0D,EAAUh5C,OAAQ,CACrB,MAAM+2C,EAAUsE,GAAQrC,EACxB,MAAO,CAAuBA,EAAgB,OAAGjC,EAAQnkD,OAAOjO,GAClE,CACA,KAAK0zD,EAAOr4C,OAAQ,CAClB,MAAM+2C,EAAUsE,GAAQhD,EACxB,MAAO,CAAuBA,EAAa,OAAGtB,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI22D,EAAa,CAACvxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAWg5C,EAAUh5C,OACvB,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASID,GAAa,CAACzxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGII,GAAc,IACdC,GAAe,GAQfS,GAAY,CAAC7sC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,EAAsB5tC,GACnC6tC,EAAaD,EAAa,EAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,EAAgBqc,EAAS3lB,EAAO,GAChC,EAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGHyyD,GAAYx/D,OAAOkqD,IAAI,oBC/kBtB,MAAMilC,WAAyB,EAClClpE,KACA3c,cACI6S,QACA3S,KAAKyc,KAAO,IAAInC,GACpB,CACApM,IAAIC,EAAK/C,GAEL,OADApL,KAAKyc,KAAK5gB,IAAIg2D,EAAO9iD,OAAOZ,EAAIomD,UAAUhxD,OAAQ6H,GAC3C+C,CACX,CACAxN,IAAIwN,GACA,MAAMpT,EAAMiF,KAAKyc,KAAK9b,IAAIkxD,EAAO9iD,OAAOZ,EAAIomD,UAAUhxD,QACtD,GAAW,MAAPxI,EACA,MAAM,IAEV,OAAOA,CACX,CACAigB,IAAI7M,GACA,OAAOnO,KAAKyc,KAAKzB,IAAI62C,EAAO9iD,OAAOZ,EAAIomD,UAAUhxD,OACrD,CACAtF,aAAakQ,GACTnO,KAAKyc,KAAKxE,OAAO45C,EAAO9iD,OAAOZ,EAAIomD,UAAUhxD,OACjD,CACAtF,eACI,IAAK,MAAOkQ,EAAKtP,KAAUmB,KAAKyc,KAAK5J,eAC3B,CACFoiD,IAAKC,EAAIO,SCtBL,GDsBwB,EAAc5D,EAAOzlD,OAAO+B,KACxDilC,MAAOv0C,EAGnB,kBEhCG,MAAMqJ,GAAS6oD,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICxBf,gBAAsBz/B,GACN,MAALA,EAAY,YAAcihC,EAAUvC,WAAW1+B,GAG1D,gBAAsBA,GACN,MAALA,EAAY,YAAcsgC,EAAO5B,WAAW1+B,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAcrpB,GAAO+nD,WAAW1+B,GAGvD,gBAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,gBAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WCoBhC,MAAM0iE,WAAmB9uE,MAC5B2W,KACAb,KACAvO,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,GDdG,SAAgBhP,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAEhC,WAAc,GAAGA,YAAuF,MAAtE,cAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,GAAM,GAAG6G,YAEdX,OAAO6W,OAAO,GAAMlW,GAAO,CAC9B+gB,MAAO,GAAM,GAAG/gB,WAChB7G,SAER,CE/CYwnE,CAAO,0BCFZ,MAAM,GAAS,IACf,oMCQP,MAAM4lB,EAAU,CAAChuD,EAAUiuD,IAClB,kBACL,MAAMlqF,QCbKsC,eAAmBE,GAC9B,MAAMtD,EAAM,GACZ,UAAW,MAAMiY,KAAS3U,EACtBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACX,CDOyB,CAAI+8B,SACjBj8B,EAAOmqF,KAAKD,EACrB,CAHM,GAyBF,MAAME,EAIXtwE,OACE,OAAOjE,QAAQE,OAAO,IAAInZ,MAAM,4BAClC,CAKAgX,QACE,OAAOiC,QAAQE,OAAO,IAAInZ,MAAM,6BAClC,CAQA2V,IAAKC,EAAK/C,EAAKgD,GACb,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAoI,IAAKwN,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAyiB,IAAK7M,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOA0f,OAAQ9J,EAAKC,GACX,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,8BAClC,CAOA0F,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWV,QAC3B6B,KAAKkO,IAAIC,EAAKtP,EAAOuP,QACrB,CAAED,MAAKtP,QAEjB,CAOAZ,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKW,IAAIwN,EAAKC,EAExB,CAOAnQ,iBAAoBE,EAAQiQ,EAAU,CAAC,GACrC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKiY,OAAO9J,EAAKC,SACjBD,CAEV,CAKAyH,QAEE,IAAIowE,EAAO,GAEPC,EAAO,GAEX,MAAO,CACL/3E,IAAKC,EAAKtP,GACRmnF,EAAKtuF,KAAK,CAAEyW,MAAKtP,SACnB,EAEAoZ,OAAQ9J,GACN83E,EAAKvuF,KAAKyW,EACZ,EACAoc,OAAQtsB,MAAOmQ,UACP,OAAMpO,KAAKkmF,QAAQF,EAAM53E,IAC/B43E,EAAO,SACD,OAAMhmF,KAAKmmF,WAAWF,EAAM73E,IAClC63E,EAAO,EAAC,EAGd,CAUAhoF,WAAco/C,EAAGjvC,GACf,MAAM,IAAI7V,MAAM,2BAClB,CAUA0F,eAAkBo/C,EAAGjvC,GACnB,MAAM,IAAI7V,MAAM,+BAClB,CAMAyjD,MAAOqB,EAAGjvC,GACR,IAAIg4E,EAAKpmF,KAAKiS,KAAKorC,EAAGjvC,GAgBtB,GAdgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAyB38E,GACnCA,EAAE0E,IAAIxJ,WAAWo5D,WAAW1gB,EAAE7jC,QAAU,OAIxC5gB,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAMib,EAAQQ,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,MAAQ+hD,EAAEnmD,QAAU,IAC5C,CAMA,OAJe,MAAXmmD,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,CAMAG,UAAWlpC,EAAGjvC,GACZ,IAAIg4E,EAAKpmF,KAAKwmF,SAASnpC,EAAGjvC,GAc1B,GAZgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAwBnxB,GAAQA,EAAItwD,WAAWo5D,WAAW1gB,EAAE7jC,QAAU,OAGhF5gB,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAMib,EAAQQ,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAA8B+hD,EAAQ,QAC9D,CAMA,OAJe,MAAXA,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,EE9NF,SAASK,EAAUxxB,GACjB,MAAMh2C,EAAI,WAAUg2C,GAEpB,IAAKh2C,EACH,MAAM,EAAQ,IAAI1mB,MAAM,mBAAoB,mBAG9C,OAAO,IAAI,IAAI,IAAMs5D,EAAO,OAAP,OAAc5yC,EAAEs1C,UAAUhxD,OAAOzK,MAAM,GAAG4hC,eAAe,EAChF,CAUA,SAASgsD,EAAUv4E,GAEjB,OAAO,cAAakoC,EAAIhoC,KAAM,KAAcwjD,EAAO,OAAP,OAAc,IAAM1jD,EAAIxJ,WAAW7L,MAAM,GAAGyR,gBAC1F,CAaA,SAASo8E,EAAentE,GACtB,MAAMotE,EAAYptE,EAAO/Z,UAAU,EAAG,GAEtC,GAAkB,MAAdmnF,EACF,OAAOD,EAAcntE,EAAO/Z,UAAU,IAIxC,IAAI8wD,EAkBAhtD,EAdFgtD,EAF8B,MAA5Bq2B,EAAUr8E,cAEDxO,GAAU81D,EAAO,OAAP,OAAc91D,EAAMwO,eAAejT,SAAS,GAC5B,MAA5BsvF,EAAUr8E,cAERxO,GAAU81D,EAAAE,UAAA,OAAiBh2D,EAAMwO,eAAejT,SAAS,GAC7C,MAAdsvF,EAEE7qF,GAAU8qF,EAAAr0B,UAAA,OAAiBz2D,GAAOzE,SAAS,GAC/B,MAAdsvF,EAEE7qF,GAAU8qF,EAAAr0B,UAAA,OAAiB,IAAMz2D,GAEjCA,GAAU81D,EAAO,OAAP,OAAc,IAAM91D,EAAMwO,eAAejT,SAAS,GAMzE,IAAK,IAAIgE,EAAI,EAAGA,EAAIke,EAAOviB,OAAQqE,IACjC,IACEiI,EAAQgtD,EAAQ/2C,EAAO/Z,UAAU,EAAGnE,GACtC,CAAE,MAA0BsK,GAC1B,GAAoB,2BAAhBA,EAAIiC,QACN,MAAMjC,CAEV,CAGF,IAAIvK,EAAM,KAQV,OANIkI,IAGFlI,EAAM,IAAIw2D,EAAO,OAAP,OAActuD,GAAOzK,MAAM,GAAI,GAAG4hC,eAAiB,OAGxDr/B,CACT,CAgEO,MAAMyrF,UAAmCf,EAI9CjmF,YAAainF,GACXp0E,QAEA3S,KAAK0uC,MAAQq4C,CACf,CAEAtxE,OACE,OAAOzV,KAAK0uC,MAAMj5B,MACpB,CAEAlG,QACE,OAAOvP,KAAK0uC,MAAMn/B,OACpB,CAMAtR,YAAe+9C,EAAO5tC,GACpB,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWmB,KAAK0uC,MAAMsN,MAjFlD,SAAuBA,GACrB,MAAO,IACFA,EACHxiC,OAAQwiC,EAAMxiC,OAASmtE,EAAc3qC,EAAMxiC,aAAU9R,EACrD2+E,QAASrqC,EAAMqqC,QACXrqC,EAAMqqC,QAAQzrE,KACd1C,GAAW2wC,GACF3wC,EAAO,CAAE/J,IAAKu4E,EAAS79B,EAAK16C,KAAMtP,MAAOgqD,EAAKhqD,eAGvD6I,EACJ4+E,OAAQtqC,EAAMsqC,OACVtqC,EAAMsqC,OAAO1rE,KACbosE,GAAS,CAACvmE,EAAGnE,IACJ0qE,EAAM,CAAE74E,IAAKu4E,EAASjmE,EAAEtS,KAAMtP,MAAO4hB,EAAE5hB,OAAS,CAAEsP,IAAKu4E,EAASpqE,EAAEnO,KAAMtP,MAAOyd,EAAEzd,eAG1F6I,EAER,CA8DwDu/E,CAAajrC,GAAQ5tC,QACjE,CAAED,IAAKu4E,EAASv4E,GAAMtP,QAEhC,CAMAZ,gBAAmB+9C,EAAO5tC,GACxB,UAAW,MAAMD,KAAOnO,KAAK0uC,MAAM63C,UAlEvC,SAA0BvqC,GACxB,MAAO,IACFA,EACHxiC,OAAQwiC,EAAMxiC,OAASmtE,EAAc3qC,EAAMxiC,aAAU9R,EACrD2+E,QAASrqC,EAAMqqC,QACXrqC,EAAMqqC,QAAQzrE,KACd1C,GAAW/J,GACF+J,EAAOwuE,EAASv4E,WAGzBzG,EACJ4+E,OAAQtqC,EAAMsqC,OACVtqC,EAAMsqC,OAAO1rE,KACbosE,GAAS,CAACvmE,EAAGnE,IACJ0qE,EAAMN,EAASjmE,GAAIimE,EAASpqE,WAGrC5U,EAER,CA+CiDw/E,CAAgBlrC,GAAQ5tC,SAC7Ds4E,EAASv4E,EAEnB,CAOAlQ,UAAWg3D,EAAK7mD,GACd,OAAOpO,KAAK0uC,MAAM/tC,IAAI8lF,EAASxxB,GAAM7mD,EACvC,CAMAnQ,cAAiBkpF,EAAM/4E,GACrB,UAAW,MAAM6mD,KAAOkyB,QAChBnnF,KAAKW,IAAIs0D,EAAK7mD,EAExB,CAOAnQ,UAAWg3D,EAAKp2D,EAAOuP,SACfpO,KAAK0uC,MAAMxgC,IAAIu4E,EAASxxB,GAAMp2D,EAAOuP,EAC7C,CAMAnQ,cAAiBitD,EAAQ98C,GASvB,MAAMq6B,GAAS,OAAS,CACtBmgC,YAAY,KAKC9gD,WAAWvf,SAAWuf,WAAWvf,QAAQ0F,SAAW6Z,WAAWvf,QAAQ0F,SAAY6Z,WAAWs/D,cAAgBt/D,WAAW/hB,aAEjI9H,UACL,IACE,MAAMisB,EAAQlqB,KAAK0uC,YAEb,OAAM1uC,KAAK0uC,MAAMw3C,QAAQjoF,kBAC7B,UAAW,MAAMm1C,KAAS8X,EAAQ,CAChC,MAAM/8C,EAAMs4E,EAASrzC,EAAMjlC,WACN+b,EAAMlP,IAAI7M,EAAKC,UAG5B,CAAED,MAAKtP,MAAOu0C,EAAMv0C,QAK5B4pC,EAAO/wC,KAAK07C,EACd,CACF,CAb+Bn1C,KAe/BwqC,EAAO9lC,KACT,CAAE,MAA0BiD,GAC1B6iC,EAAO9lC,IAAIiD,EACb,WAGM6iC,CACV,CAMAztB,IAAKi6C,EAAK7mD,GACR,OAAOpO,KAAK0uC,MAAM1zB,IAAIyrE,EAASxxB,GAAM7mD,EACvC,CAMA6J,OAAQg9C,EAAK7mD,GACX,OAAOpO,KAAK0uC,MAAMz2B,OAAOwuE,EAASxxB,GAAM7mD,EAC1C,CAMA+3E,WAAYgB,EAAM/4E,GAChB,MAAMnS,GAAM,OAAS,CACnB2sE,YAAY,IAed,OAZA,OAAM5oE,KAAK0uC,MAAMy3C,WAAYloF,kBAC3B,UAAW,MAAMg3D,KAAOkyB,QAChBV,EAASxxB,GAEfh5D,EAAIvE,KAAKu9D,GAGXh5D,EAAI0G,KACN,CAR4B,GAQtByL,IAAUqf,OAAM7nB,IACpB3J,EAAI0G,IAAIiD,EAAG,IAGN3J,CACT,gGClMF,IAIA,EAzHA,SAAe2yD,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECzHc,IAAI7E,WAAW,GAA7B,MAsCM,EAASuD,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAMy3D,EAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,EAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,EAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,EAAK,CAACI,EAAMC,IAAU,IAAIH,EAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,EAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,EAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,EAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,EAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,EAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,EAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,EAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,EAAO1tB,EAAO0tB,KAC/B,EA4GUi3B,EAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,EAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrCwyD,EAASd,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGFc,EAAcf,EAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,ICXFwB,GDcYzB,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkBD,EAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQD,EAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DUF,EAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,gEAGgBspC,EAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCXZ,IAAIyrC,EAOJ,SAAS,EAAOtsB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAOwsB,GACXl3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,GAAO,IAET,KAAMA,EAAM0sB,GACVp3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,EAC/BzsB,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBIm3D,EAAM,IAENC,GAAS,IACTF,EAAMl6D,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,EAKJ,SAASngB,EAAK5I,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADAjuB,EAAKJ,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAIg3C,IAAWl0D,GACfkd,EAAIg3C,GAAUr6D,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAKi3C,GAId,OAFA5vD,EAAKJ,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BIm0C,EAAQ,IACRD,EAAS,IA2Bb,IAAIE,EAAKv6D,KAAK6qB,IAAI,EAAI,GAClB2vC,EAAKx6D,KAAK6qB,IAAI,EAAG,IACjB4vC,EAAKz6D,KAAK6qB,IAAI,EAAG,IACjB6vC,EAAK16D,KAAK6qB,IAAI,EAAG,IACjB8vC,EAAK36D,KAAK6qB,IAAI,EAAG,IACjB+vC,EAAK56D,KAAK6qB,IAAI,EAAG,IACjBgwC,EAAK76D,KAAK6qB,IAAI,EAAG,IACjBiwC,EAAK96D,KAAK6qB,IAAI,EAAG,IACjBkwC,EAAK/6D,KAAK6qB,IAAI,EAAG,IAyBrB,EARa,CACT/U,OAAQkkD,EACR7mD,OAAQ,EACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ20D,EAAK,EACb30D,EAAQ40D,EAAK,EACb50D,EAAQ60D,EAAK,EACb70D,EAAQ80D,EAAK,EACb90D,EAAQ+0D,EAAK,EACb/0D,EAAQg1D,EAAK,EACbh1D,EAAQi1D,EAAK,EACbj1D,EAAQk1D,EAAK,EACbl1D,EAAQm1D,EAAK,EACA,EAEjB,GCzEO,MAAM,EAAS,CAACv3C,EAAMvlB,EAAS,IAE7B,CADM,SAAculB,EAAMvlB,GACnB,gBAQHg9D,EAAW,CAACC,EAAK9hD,EAAQnb,EAAS,KAC7C,SAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI4hD,EAAkBE,GACtB,iBAAsBA,GCElB,EAAUI,IACrB,MAAMhxD,EAAQ,EAAOgxD,IACdlmD,EAAM+lD,GAAc,EAAc7wD,IAClC9L,EAAM48D,GAAgB,EAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI+7D,EAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM+wD,EASXx0D,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtEK,MAAMqL,EAAS,CAACgmD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG4rC,EACLvxD,EACAwxD,EAAUH,GAC+B,GAAUpC,EAAU3B,SAGxDmE,EACLzxD,EACAwxD,EAAUH,GACmCC,GAAQhD,EAAOhB,QAElE,EAoBIx2C,EAAQ,IAAIiW,QAMZykC,EAAYE,IAChB,MAAMF,EAAY16C,EAAM1Z,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADAD,EAAMxe,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAMG,EAOXp1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAASgnD,EACX,MAAM,IAAI98D,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAASinD,EACrB,MAAM,IAAI/8D,MAAM,sDAGlB,OACE28D,EAAIK,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EDxJQ,EAAClmD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,EAAsB/lD,GACnCgmD,EAAeD,EAAa,EAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,EAAgB4W,EAAM9K,EAAO,GAC7B,EAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAIC,EAAOjmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EC8InB,CAAc8K,EAAMg8C,GACtC,OACE6K,EAAIO,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAOR,EAAIl0C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SD5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YNrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GM0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GCiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAOjmD,EAAO5O,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK5S,EAAO5O,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiBq2D,EAEnB,OAAOr2D,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAIq2D,EACThsC,EACA7a,EACwC,EACxC9K,GAASwyD,EAAU7sC,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAMm3D,GAAqB,CAIpC,MAAM,QAAE9sC,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,EAAckK,GACjB,OAAOW,EAAIv2D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAASgnD,EACX,MAAM,IAAI98D,MACR,wCAAwC88D,qBAG1C,OAAO,IAAIH,EAAIhsC,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQwyD,EAAU7sC,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI2xD,EAAIhsC,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO6K,EAAIv2D,OAAO,EAAG02D,EAAahL,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO6K,EAAIv2D,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAaf,EAAIgB,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQjB,EAAIkB,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiB,EACrBhzD,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,EACjB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACFgsC,EAAIK,SAAyD,GAC7DL,EAAIO,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,EAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,EAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAASszD,EAAgB14D,EAAQ02D,GAE1CI,EAAMC,EAAI9oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFAw8D,EAAUE,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM4B,EAAkB,CAAC14D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQrC,EACxB,MAAO,CACkBA,EAAgB,OACvCjC,EAAQnkD,OAAO,GAAGomD,EAAUh5C,SAASrb,KAEzC,CACA,KAAKq0D,EAAUh5C,OAAQ,CACrB,MAAM+2C,EAAUsE,GAAQrC,EACxB,MAAO,CAAuBA,EAAgB,OAAGjC,EAAQnkD,OAAOjO,GAClE,CACA,KAAK0zD,EAAOr4C,OAAQ,CAClB,MAAM+2C,EAAUsE,GAAQhD,EACxB,MAAO,CAAuBA,EAAa,OAAGtB,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI22D,EAAa,CAACvxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAWg5C,EAAUh5C,OACvB,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASID,EAAa,CAACzxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGII,EAAc,IACdC,EAAe,GAQfS,EAAY,CAAC7sC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,EAAsB5tC,GACnC6tC,EAAaD,EAAa,EAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,EAAgBqc,EAAS3lB,EAAO,GAChC,EAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGHyyD,EAAYx/D,OAAOkqD,IAAI,oBC/kBtB,MAAM2mC,UAAsB,KAC/Br+D,SACAE,QACAnb,GACA8mD,KACA/0D,YAAYkpB,EAAUoS,EAAO,CAAC,GAC1BzoB,QACA3S,KAAKgpB,SAAW,GAAGoS,EAAK5hB,QAAU,KAAKwP,IACvChpB,KAAKkpB,QAAUkS,EAAKlS,SAAW,EAE/BlpB,KAAK60D,KAAOz5B,EAAKy5B,MAAQ/C,CAC7B,CACA,GAAQmD,GACJ,MAAO,IAAIj1D,KAAK60D,KAAKhE,QAAQ9hD,OAAOkmD,EAAIV,UAAUhxD,QACtD,CACA,GAAQ4K,GACJ,OAAO+mD,EAAIO,SCZC,GDYkB,EAAcz1D,KAAK60D,KAAKtE,QAAQnkD,OAAO+B,EAAI1O,UAAU,KACvF,CACAxB,aACI,IACI,MAAM+qB,EAAWhpB,KAAKgpB,SACtBhpB,KAAK+N,SAAW,QAAOib,EAAUhpB,KAAKkpB,QAAS,CAC3Co+D,QAAQv5E,GACJA,EAAG6b,kBAAkBZ,EACzB,GAER,CACA,MAAOpjB,GACH,MAAM,qBAAuBA,EACjC,CACJ,CACA3H,cACI+B,KAAK+N,IAAIwB,OACb,CACAtR,UAAUkQ,EAAK/C,GACX,GAAe,MAAXpL,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,IAEI,aADMyH,KAAK+N,GAAGG,IAAIlO,KAAKgpB,SAAU5d,EAAKpL,MAAK,EAAQmO,IAC5CA,CACX,CACA,MAAOvI,GACH,MAAM,oBAAsBA,EAChC,CACJ,CACA3H,UAAUkQ,GACN,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,IAAI6S,EACJ,IACIA,QAAYpL,KAAK+N,GAAGpN,IAAIX,KAAKgpB,SAAUhpB,MAAK,EAAQmO,GACxD,CACA,MAAOvI,GACH,MAAM,oBAAsBA,EAChC,CACA,QAAY8B,IAAR0D,EACA,MAAM,qBAEV,OAAOA,CACX,CACAnN,aAAakQ,GACT,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,UACUyH,KAAK+N,GAAGkK,OAAOjY,KAAKgpB,SAAUhpB,MAAK,EAAQmO,GACrD,CACA,MAAOvI,GACH,MAAM,oBAAsBA,EAChC,CACJ,CACA3H,UAAUkQ,GACN,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,IACI,OAAO2M,cAAclF,KAAK+N,GAAGymC,OAAOx0C,KAAKgpB,SAAUhpB,MAAK,EAAQmO,IACpE,CACA,MAAOvI,GACH,MAAM,oBAAsBA,EAChC,CACJ,CACA3H,aAAcmQ,GACV,GAAe,MAAXpO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,IAAK,MAAM4V,WAAanO,KAAK+N,GAAGud,WAAWtrB,KAAKgpB,UAAW,CACvD,MAAMisC,EAAMj1D,MAAK,EAAQmO,EAAIxJ,YACvByuC,QAAcpzC,KAAKW,IAAIs0D,QACvB,CAAEA,MAAK7hB,QACjB,CACJ,CACAn1C,sBACU,QAAS+B,KAAKgpB,SACxB,uCE/FW/qB,eAAgBspF,EAA0BzY,EAAQ1gE,EAAU,CAAC,GACxE,MAAMtM,EAASgtE,EAAO0Y,YACtB,IACI,OAAa,CACT,MAAM5tE,QAAe9X,EAAO6B,OAC5B,GAAIiW,EAAOye,KACP,aAEEze,EAAO/a,KACjB,CACJ,CACA,SACkC,IAA1BuP,EAAQq5E,qBACF3lF,EAAOwU,SAEjBxU,EAAO4lF,aACX,CACJ,qECxBe,SAASC,EAAS5sF,GAC7B,OAAIA,aAAeP,WACR,CACHmG,IAAI0pB,GACOtvB,EAAIsvB,GAEfxuB,IAAIwuB,EAAOxrB,GACP9D,EAAIsvB,GAASxrB,CACjB,GAGD,CACH8B,IAAI0pB,GACOtvB,EAAI4F,IAAI0pB,GAEnBxuB,IAAIwuB,EAAOxrB,GACP9D,EAAIc,IAAIwuB,EAAOxrB,EACnB,EAER,4iBCXO,MAAM+oF,EAAiB,CAC5B,GACA,IACA,MACA,WACA3lE,OAAO,yBAEF,SAASa,EAAUrG,EAAMvlB,EAAQkX,IACtC,QAAiBqO,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAQ4d,EAAKvlB,GACnB,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,EAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAI,qEAEtB,OAAOsG,CACT,CACO,SAASipF,EAAWrrE,EAAMvlB,EAAQkX,IACvC,QAAiBqO,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAQ4d,EAAKvlB,IAAW,EAAIulB,EAAKvlB,EAAS,GAChD,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,EAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAI,qEAEtB,OAAOsG,CACT,CACO,SAASkpF,EAAWtrE,EAAMvlB,EAAQkX,IACvC,QAAiBqO,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAuB,SAAf4d,EAAKvlB,IAAsBulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GAC3G,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,EAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAI,qEAEtB,OAAOsG,CACT,CACO,SAASmpF,EAAWvrE,EAAMvlB,EAAQkX,IACvC,QAAiBqO,EAAMvlB,EAAQ,GAC/B,MAAMuL,EAAoB,SAAfga,EAAKvlB,IAAsBulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GAClGsL,EAAwB,SAAnBia,EAAKvlB,EAAS,IAAiBulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GACtG2H,GAASojB,OAAOxf,IAAOwf,OAAO,KAAOA,OAAOzf,GAClD,IAAuB,IAAnB4L,EAAQy5E,QAAmBhpF,EAAQ+oF,EAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAI,qEAEtB,GAAIsG,GAASmK,OAAO2oB,iBAClB,OAAO3oB,OAAOnK,GAEhB,IAA4B,IAAxBuP,EAAQ65E,YACV,OAAOppF,EAET,MAAM,IAAItG,MAAM,GAAI,oEACtB,CACO,SAAS2vF,EAAYzrE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,IAAI,IAAM,SAAW0U,EAAUrG,EAAMxa,EAAM,EAAGmM,GAAU,EACjE,CACO,SAASg6E,EAAa3rE,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,IAAM,SAAW05E,EAAWrrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,CACO,SAASi6E,EAAa5rE,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,IAAM,SAAW25E,EAAWtrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,CACO,SAASk6E,EAAa7rE,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,IAAM,SAAW45E,EAAWvrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,CACO,SAASm6E,EAAWxtF,EAAKuhC,GAC9B,OAAOksD,EAAgBztF,EAAK,EAAGuhC,EAAMz9B,MACvC,CACO,SAAS2pF,EAAgBztF,EAAK69C,EAAO6vC,GAC1C,GAAIA,EAAOb,EAAe,GAAI,CAC5B,MAAMc,EAAQ1/E,OAAOy/E,GACrB1tF,EAAIrD,KAAK,CAACkhD,EAAQ8vC,GACpB,MAAO,GAAID,EAAOb,EAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GACrB1tF,EAAIrD,KAAK,CACC,GAARkhD,EACA8vC,GAEJ,MAAO,GAAID,EAAOb,EAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GACrB1tF,EAAIrD,KAAK,CACC,GAARkhD,EACA8vC,IAAU,EACF,IAARA,GAEJ,MAAO,GAAID,EAAOb,EAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GACrB1tF,EAAIrD,KAAK,CACC,GAARkhD,EACA8vC,IAAU,GAAK,IACfA,IAAU,GAAK,IACfA,IAAU,EAAI,IACN,IAARA,GAEJ,KAAO,CACL,MAAMC,EAAQ1mE,OAAOwmE,GACrB,KAAIE,EAAQf,EAAe,IA6BzB,MAAM,IAAIrvF,MAAM,GAAI,uDA7BS,CAC7B,MAAMsD,EAAM,CACF,GAAR+8C,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GAEF,IAAIp2C,EAAKwG,OAAO2/E,EAAQ1mE,OAAO,aAC3Bxf,EAAKuG,OAAO2/E,GAAS1mE,OAAO,IAAMA,OAAO,aAC7CpmB,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACT3G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACT1H,EAAIrD,KAAKmE,EACX,CAGF,CACF,CACA0sF,EAAWK,YAAc,SAAqBtsD,GAC5C,OAAOksD,EAAgBI,YAAYtsD,EAAMz9B,MAC3C,EACA2pF,EAAgBI,YAAc,SAAqBH,GACjD,OAAIA,EAAOb,EAAe,GACjB,EAELa,EAAOb,EAAe,GACjB,EAELa,EAAOb,EAAe,GACjB,EAELa,EAAOb,EAAe,GACjB,EAEF,CACT,EACAW,EAAWM,cAAgB,SAAuBC,EAAMC,GACtD,OAAOD,EAAKjqF,MAAQkqF,EAAKlqF,OAAS,EAAIiqF,EAAKjqF,MAAQkqF,EAAKlqF,MAAQ,EAAI,CACtE,4MCjJO,SAASmqF,EAAcvsE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO,IAAI,IAAM,YAAc,EAAI,KAAeqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC7E,CACO,SAAS66E,EAAexsE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,IAAI,IAAM,YAAc,EAAI,KAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC9E,CACO,SAAS86E,EAAezsE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,IAAI,IAAM,YAAc,EAAI,KAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC9E,CACA,MAAM+6E,EAAQlnE,QAAQ,GAChBmnE,EAAQnnE,OAAO,GACd,SAASonE,EAAe5sE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,MAAM+lD,EAAM,KAAgB13C,EAAMxa,EAAM,EAAGmM,GAC3C,GAAmB,iBAAR+lD,EAAkB,CAC3B,MAAMt1D,GAAS,EAAIs1D,EACnB,GAAIt1D,GAASmK,OAAOsgF,iBAClB,OAAO,IAAI,IAAM,WAAazqF,EAAO,EAEzC,CACA,IAA4B,IAAxBuP,EAAQ65E,YACV,MAAM,IAAI1vF,MAAM,GAAI,qEAEtB,OAAO,IAAI,IAAM,WAAa4wF,EAAQlnE,OAAOkyC,GAAM,EACrD,CACO,SAASo1B,EAAaxuF,EAAKuhC,GAChC,MAAMktD,EAASltD,EAAMz9B,MACfiI,EAA6B,iBAAX0iF,EAAsBA,EAASL,EAAQC,GAAkB,EAAVI,EAAc,EACrF,KAAqBzuF,EAAKuhC,EAAMptB,KAAKu6E,aAAc3iF,EACrD,CACAyiF,EAAaX,YAAc,SAAqBtsD,GAC9C,MAAMktD,EAASltD,EAAMz9B,MACfiI,EAA6B,iBAAX0iF,EAAsBA,EAASL,EAAQC,GAAkB,EAAVI,EAAc,EACrF,OAAI1iF,EAAW,QACN,EAELA,EAAW,QACN,EAELA,EAAW,QACN,EAELA,EAAW,QACN,EAEF,CACT,EACAyiF,EAAaV,cAAgB,SAAuBC,EAAMC,GACxD,OAAOD,EAAKjqF,MAAQkqF,EAAKlqF,MAAQ,EAAIiqF,EAAKjqF,MAAQkqF,EAAKlqF,OAAS,EAAI,CACtE,+OCxCA,SAAS6qF,EAAQjtE,EAAMxa,EAAKuX,EAAQviB,IAClC,QAAiBwlB,EAAMxa,EAAKuX,EAASviB,GACrC,MAAM8D,GAAM,QAAM0hB,EAAMxa,EAAMuX,EAAQvX,EAAMuX,EAASviB,GACrD,OAAO,IAAI,IAAM,UAAY8D,EAAKye,EAASviB,EAC7C,CACO,SAAS0yF,EAAmBltE,EAAMxa,EAAK2nF,EAAOjO,GACnD,OAAO+N,EAAQjtE,EAAMxa,EAAK,EAAG2nF,EAC/B,CACO,SAASC,EAAaptE,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,CACO,SAAS07E,EAAcrtE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAAS27E,EAActtE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAAS47E,EAAcvtE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,MAAMwjB,EAAI,KAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAI,mDAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAG2vB,EAC/B,CACA,SAASq4D,EAAW3tD,GAIlB,YAH2B50B,IAAvB40B,EAAM4tD,eACR5tD,EAAM4tD,aAAe5tD,EAAMptB,OAAS,YAAc,QAAWotB,EAAMz9B,OAASy9B,EAAMz9B,OAE7Ey9B,EAAM4tD,YACf,CACO,SAASC,EAAYpvF,EAAKuhC,GAC/B,MAAM/4B,EAAQ0mF,EAAW3tD,GACzB,KAAqBvhC,EAAKuhC,EAAMptB,KAAKu6E,aAAclmF,EAAMtM,QACzD8D,EAAIrD,KAAK6L,EACX,CACA4mF,EAAYvB,YAAc,SAAqBtsD,GAC7C,MAAM/4B,EAAQ0mF,EAAW3tD,GACzB,OAAO,iBAAiC/4B,EAAMtM,QAAUsM,EAAMtM,MAChE,EACAkzF,EAAYtB,cAAgB,SAAuBC,EAAMC,GACvD,OAE2BqB,EAFPH,EAAWnB,GAEAuB,EAFOJ,EAAWlB,GAG1CqB,EAAGnzF,OAASozF,EAAGpzF,QAAU,EAAImzF,EAAGnzF,OAASozF,EAAGpzF,OAAS,GAAI,QAAQmzF,EAAIC,GADvE,IAAsBD,EAAIC,CADjC,yPCzCA,SAASX,EAAQjtE,EAAMxa,EAAKuX,EAAQviB,EAAQmX,GAC1C,MAAMk8E,EAAY9wE,EAASviB,GAC3B,QAAiBwlB,EAAMxa,EAAKqoF,GAC5B,MAAMC,EAAM,IAAI,IAAM,YAAa,QAAS9tE,EAAMxa,EAAMuX,EAAQvX,EAAMqoF,GAAYA,GAIlF,OAHkC,IAA9Bl8E,EAAQo8E,oBACVD,EAAIE,WAAY,QAAMhuE,EAAMxa,EAAMuX,EAAQvX,EAAMqoF,IAE3CC,CACT,CACO,SAASG,EAAoBjuE,EAAMxa,EAAK2nF,EAAOx7E,GACpD,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG2nF,EAAOx7E,EACtC,CACO,SAASu8E,EAAcluE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAewa,EAAMxa,EAAM,EAAGmM,GAAUA,EACvE,CACO,SAASw8E,EAAenuE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAAUA,EACxE,CACO,SAASy8E,EAAepuE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAAUA,EACxE,CACO,SAAS08E,EAAeruE,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,MAAMwjB,EAAI,KAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAI,oDAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAG2vB,EAAGxjB,EAClC,CACO,MAAM28E,EAAe,8PCpC5B,SAASrB,EAAQplC,EAAO0mC,EAAMxxE,EAAQviB,GACpC,OAAO,IAAI,IAAM,UAAYA,EAAQuiB,EACvC,CACO,SAASyxE,EAAmBxuE,EAAMxa,EAAK2nF,EAAOjO,GACnD,OAAO+N,EAAQjtE,EAAMxa,EAAK,EAAG2nF,EAC/B,CACO,SAASsB,EAAazuE,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,CACO,SAAS+8E,EAAc1uE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAASg9E,EAAc3uE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAASi9E,EAAc5uE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,MAAMwjB,EAAI,KAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAI,mDAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAG2vB,EAC/B,CACO,SAAS05D,EAAsB7uE,EAAMxa,EAAKkmF,EAAQ/5E,GACvD,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAI,4CAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAGmP,IAC/B,CACO,SAASo6E,EAAYzwF,EAAKuhC,GAC/B,KAAqBvhC,EAAK,uBAAyBuhC,EAAMz9B,MAC3D,CACA2sF,EAAY3C,cAAgB,mBAC5B2C,EAAY5C,YAAc,SAAqBtsD,GAC7C,OAAO,iBAAiCA,EAAMz9B,MAChD,2PClCA,SAAS6qF,EAAQplC,EAAO0mC,EAAMxxE,EAAQviB,GACpC,OAAO,IAAI,IAAM,QAAUA,EAAQuiB,EACrC,CACO,SAASiyE,EAAiBhvE,EAAMxa,EAAK2nF,EAAOjO,GACjD,OAAO+N,EAAQjtE,EAAMxa,EAAK,EAAG2nF,EAC/B,CACO,SAAS8B,EAAWjvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC5C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,CACO,SAASu9E,EAAYlvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAASw9E,EAAYnvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAOs7E,EAAQjtE,EAAMxa,EAAK,EAAG,KAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,CACO,SAASy9E,EAAYpvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,MAAMwjB,EAAI,KAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAI,iDAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAG2vB,EAC/B,CACO,SAASk6D,EAAoBrvE,EAAMxa,EAAKkmF,EAAQ/5E,GACrD,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAI,4CAEtB,OAAOmxF,EAAQjtE,EAAMxa,EAAK,EAAGmP,IAC/B,CACO,SAAS26E,EAAUhxF,EAAKuhC,GAC7B,KAAqBvhC,EAAK,qBAAuBuhC,EAAMz9B,MACzD,CACAktF,EAAUlD,cAAgB,mBAC1BkD,EAAUnD,YAAc,SAAqBtsD,GAC3C,OAAO,iBAAiCA,EAAMz9B,MAChD,yNCnCO,SAASmtF,EAAiB1nC,EAAO0mC,EAAMpB,EAAOjO,GACnD,OAAO,IAAI,IAAM,QAAUiO,EAAO,EACpC,CACO,SAASqC,EAAWxvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC5C,OAAO,IAAI,IAAM,QAAU,KAAeqO,EAAMxa,EAAM,EAAGmM,GAAU,EACrE,CACO,SAAS89E,EAAYzvE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,IAAI,IAAM,QAAU,KAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,CACO,SAAS+9E,EAAY1vE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,IAAI,IAAM,QAAU,KAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,CACO,SAASg+E,EAAY3vE,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,IAAI,IAAM,QAAU,KAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,CACO,SAASi+E,EAAUtxF,EAAKuhC,GAC7B,KAAqBvhC,EAAK,qBAAuBuhC,EAAMz9B,MACzD,CACAwtF,EAAUxD,cAAgB,mBAC1BwD,EAAUzD,YAAc,SAAqBtsD,GAC3C,OAAO,iBAAiCA,EAAMz9B,MAChD,oOCpBA,MAAMytF,EAAc,GACdC,EAAa,GACbC,EAAa,GACbC,EAAkB,GACjB,SAASC,EAAgBpoC,EAAO0mC,EAAM7C,EAAQ/5E,GACnD,IAA+B,IAA3BA,EAAQu+E,eACV,MAAM,IAAIp0F,MAAM,GAAI,2CACf,OAAsC,IAAlC6V,EAAQw+E,sBACV,IAAI,IAAM,SAAW,KAAM,GAE7B,IAAI,IAAM,mBAAgBllF,EAAW,EAC9C,CACO,SAASmlF,EAAYvoC,EAAO0mC,EAAM7C,EAAQ/5E,GAC/C,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAI,4CAEtB,OAAO,IAAI,IAAM,eAAYmP,EAAW,EAC1C,CACA,SAASolF,EAAYjuF,EAAO0E,EAAO6K,GACjC,GAAIA,EAAS,CACX,IAAyB,IAArBA,EAAQ2+E,UAAsB/jF,OAAOikB,MAAMpuB,GAC7C,MAAM,IAAItG,MAAM,GAAI,qCAEtB,IAA8B,IAA1B6V,EAAQ4+E,gBAA4BnuF,IAAUuS,KAAYvS,KAAWuS,KACvE,MAAM,IAAI7Y,MAAM,GAAI,yCAExB,CACA,OAAO,IAAI,IAAM,UAAYsG,EAAO0E,EACtC,CACO,SAAS0pF,EAAcxwE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO0+E,EAAYI,EAAYzwE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,CACO,SAAS++E,EAAc1wE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO0+E,EAAYM,EAAY3wE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,CACO,SAASi/E,EAAc5wE,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO0+E,EAAYQ,EAAY7wE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,CACO,SAASm/E,EAAYxyF,EAAKuhC,EAAOluB,GACtC,MAAMhU,EAAQkiC,EAAMz9B,MACpB,IAAc,IAAVzE,EACFW,EAAIrD,KAAK,CAAC,uBAA0B40F,SAC/B,IAAc,IAAVlyF,EACTW,EAAIrD,KAAK,CAAC,uBAA0B60F,SAC/B,GAAc,OAAVnyF,EACTW,EAAIrD,KAAK,CAAC,uBAA0B80F,SAC/B,QAAc9kF,IAAVtN,EACTW,EAAIrD,KAAK,CAAC,uBAA0B+0F,QAC/B,CACL,IAAIjvB,EACAgwB,GAAU,EACTp/E,IAA+B,IAApBA,EAAQq/E,UACtBC,EAActzF,GACdojE,EAAU0vB,EAAYS,EAAM,GACxBvzF,IAAUojE,GAAWx0D,OAAOikB,MAAM7yB,IACpCuzF,EAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,EAAK70F,MAAM,EAAG,IACvB00F,GAAU,IAEVI,EAAcxzF,GACdojE,EAAU4vB,EAAYO,EAAM,GACxBvzF,IAAUojE,IACZmwB,EAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,EAAK70F,MAAM,EAAG,IACvB00F,GAAU,KAIXA,IA8FcK,EA7FHzzF,EA8FlBsxD,EAASoiC,WAAW,EAAGD,GAAK,GA7FxBrwB,EAAU8vB,EAAYK,EAAM,GAC5BA,EAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,EAAK70F,MAAM,EAAG,IAE3B,CAwFF,IAAuB+0F,CAvFvB,CACAN,EAAY3E,YAAc,SAAqBtsD,EAAOluB,GACpD,MAAMhU,EAAQkiC,EAAMz9B,MACpB,IAAc,IAAVzE,IAA6B,IAAVA,GAAnBA,MAAqCA,EACvC,OAAO,EAET,IAAKgU,IAA+B,IAApBA,EAAQq/E,QAAkB,CACxCC,EAActzF,GACd,IAAIojE,EAAU0vB,EAAYS,EAAM,GAChC,GAAIvzF,IAAUojE,GAAWx0D,OAAOikB,MAAM7yB,GACpC,OAAO,EAIT,GAFAwzF,EAAcxzF,GACdojE,EAAU4vB,EAAYO,EAAM,GACxBvzF,IAAUojE,EACZ,OAAO,CAEX,CACA,OAAO,CACT,EACA,MAAM7mE,EAAS,IAAIklB,YAAY,GACzB6vC,EAAW,IAAI/xB,SAAShjC,EAAQ,GAChCg3F,EAAO,IAAInzF,WAAW7D,EAAQ,GACpC,SAAS+2F,EAAcG,GACrB,GAAIA,IAAQz8E,IACVs6C,EAAS+C,UAAU,EAAG,OAAO,QACxB,GAAIo/B,KAASz8E,IAClBs6C,EAAS+C,UAAU,EAAG,OAAO,QACxB,GAAIzlD,OAAOikB,MAAM4gE,GACtBniC,EAAS+C,UAAU,EAAG,OAAO,OACxB,CACL/C,EAASqiC,WAAW,EAAGF,GACvB,MAAMG,EAAStiC,EAASmB,UAAU,GAC5BohC,GAAqB,WAATD,IAAwB,GACpCE,EAAoB,QAATF,EACjB,GAAiB,MAAbC,EACFviC,EAAS+C,UAAU,EAAG,OAAO,QACxB,GAAiB,IAAbw/B,EACTviC,EAAS+C,UAAU,GAAU,WAANo/B,IAAqB,GAAKK,GAAY,IAAI,OAC5D,CACL,MAAMC,EAAkBF,EAAW,IAC/BE,GAAmB,GACrBziC,EAAS+C,UAAU,EAAG,GACb0/B,GAAmB,GAC5BziC,EAAS+C,UAAU,GAAa,WAATu/B,IAAwB,GAAK,GAAK,GAAKG,GAAiB,GAE/EziC,EAAS+C,UAAU,GAAa,WAATu/B,IAAwB,GAAKG,EAAkB,IAAM,GAAKD,GAAY,IAAI,EAErG,CACF,CACF,CACA,SAAShB,EAAYS,EAAM1rF,GACzB,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAI,oCAEtB,MAAM61F,GAAQT,EAAK1rF,IAAQ,GAAK0rF,EAAK1rF,EAAM,GAC3C,GAAa,QAATmsF,EACF,OAAOh9E,IAET,GAAa,QAATg9E,EACF,OAAQh9E,IAEV,GAAa,QAATg9E,EACF,OAAOC,IAET,MAAMC,EAAMF,GAAQ,GAAK,GACnBG,EAAc,KAAPH,EACb,IAAIhjF,EAQJ,OANEA,EADU,IAARkjF,EACIC,EAAO,IAAM,GACF,KAARD,GACFC,EAAO,MAAQ,IAAMD,EAAM,IAEnB,IAATC,EAAan9E,IAAWi9E,IAElB,MAAPD,GAAgBhjF,EAAMA,CAC/B,CACA,SAASwiF,EAAcC,GACrBniC,EAASqiC,WAAW,EAAGF,GAAK,EAC9B,CACA,SAAST,EAAYO,EAAM1rF,GACzB,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAI,oCAEtB,MAAMrB,GAAUy2F,EAAKzxE,YAAc,GAAKja,EACxC,OAAO,IAAI03B,SAASg0D,EAAKh3F,OAAQO,EAAQ,GAAGs3F,WAAW,GAAG,EAC5D,CAIA,SAASlB,EAAYK,EAAM1rF,GACzB,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAI,oCAEtB,MAAMrB,GAAUy2F,EAAKzxE,YAAc,GAAKja,EACxC,OAAO,IAAI03B,SAASg0D,EAAKh3F,OAAQO,EAAQ,GAAGu3F,WAAW,GAAG,EAC5D,CACAlB,EAAY1E,cAAgB,wRClLrB,MAAM6F,EAAY5mE,WAAWvf,UAAYuf,WAAWvf,QAAQ6/B,SAAWtgB,WAAW1lB,QAAgD,mBAA/B0lB,WAAW1lB,OAAOC,SACtH2wD,EAAc,IAAID,YAClBj6C,EAAc,IAAIC,YACxB,SAAS1W,EAAStH,GAChB,OAAO2zF,GAAa5mE,WAAW1lB,OAAOC,SAAStH,EACjD,CACO,SAAS4zF,EAAM5zF,GACpB,OAAMA,aAAeP,WAGd6H,EAAStH,GAAO,IAAIP,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAAc9R,EAF3EP,WAAWgM,KAAKzL,EAG3B,CACO,MAAM4J,EAAW+pF,EAAY,CAACnrF,EAAOC,EAAOb,IAC1CA,EAAMa,EAAQ,GAAKskB,WAAW1lB,OAAOoE,KAAKjD,EAAMjM,SAASkM,EAAOb,IAAMgC,SAAS,QAAUF,EAAUlB,EAAOC,EAAOb,GACtH,CAACY,EAAOC,EAAOb,IACVA,EAAMa,EAAQ,GAAKwvD,EAAY5mD,OAAO7I,EAAMjM,SAASkM,EAAOb,IAAQ8B,EAAUlB,EAAOC,EAAOb,GAExFgE,EAAa+nF,EAAYhrF,GAC7BA,EAAOzM,OAAS,GAAK6wB,WAAW1lB,OAAOoE,KAAK9C,GAAUsZ,EAAYtZ,GACvEA,GACKA,EAAOzM,OAAS,GAAK6hB,EAAY/J,OAAOrL,GAAUsZ,EAAYtZ,GAE1DkrF,EAAY/zF,GAChBL,WAAWgM,KAAK3L,GAEZ/B,EAAQ41F,EAAY,CAACnrF,EAAOC,EAAOb,IAC1CN,EAASkB,GACJ,IAAI/I,WAAW+I,EAAMjM,SAASkM,EAAOb,IAEvCY,EAAMzK,MAAM0K,EAAOb,GACxB,CAACY,EAAOC,EAAOb,IACVY,EAAMzK,MAAM0K,EAAOb,GAEfkX,EAAS60E,EAAY,CAACG,EAAQ53F,KACzC43F,EAASA,EAAOj0E,KAAIqE,GAAKA,aAAazkB,WAAaykB,EAAI6I,WAAW1lB,OAAOoE,KAAKyY,KACvE0vE,EAAM7mE,WAAW1lB,OAAOyX,OAAOg1E,EAAQ53F,KAC5C,CAAC43F,EAAQ53F,KACX,MAAMgF,EAAM,IAAIzB,WAAWvD,GAC3B,IAAIgP,EAAM,EACV,IAAK,IAAIqW,KAAKuyE,EACR5oF,EAAMqW,EAAErlB,OAASgF,EAAIhF,SACvBqlB,EAAIA,EAAEhlB,SAAS,EAAG2E,EAAIhF,OAASgP,IAEjChK,EAAIJ,IAAIygB,EAAGrW,GACXA,GAAOqW,EAAErlB,OAEX,OAAOgF,CAAG,EAECzC,EAAQk1F,EAAYj3F,GACxBqwB,WAAW1lB,OAAO8I,YAAYzT,GACnCA,GACK,IAAI+C,WAAW/C,GAuCjB,SAAS+oB,EAAQ4pE,EAAIC,GAC1B,GAAIhoF,EAAS+nF,IAAO/nF,EAASgoF,GAC3B,OAAOD,EAAG5pE,QAAQ6pE,GAEpB,IAAK,IAAI/uF,EAAI,EAAGA,EAAI8uF,EAAGnzF,OAAQqE,IAC7B,GAAI8uF,EAAG9uF,KAAO+uF,EAAG/uF,GAGjB,OAAO8uF,EAAG9uF,GAAK+uF,EAAG/uF,IAAM,EAAI,EAE9B,OAAO,CACT,CACA,SAAS0hB,EAAYtZ,EAAQsb,EAAQ5N,KACnC,IAAIkO,EACJ,MAAMroB,EAASyM,EAAOzM,OACtB,IAAIowB,EAAgB,KACpB,MAAM9jB,EAAQ,GACd,IAAK,IAAIjI,EAAI,EAAGA,EAAIrE,IAAUqE,EAAG,CAE/B,GADAgkB,EAAY5b,EAAOlI,WAAWF,GAC1BgkB,EAAY,OAASA,EAAY,MAAO,CAC1C,IAAK+H,EAAe,CAClB,GAAI/H,EAAY,MAAO,EAChBN,GAAS,IAAM,GAClBzb,EAAM7L,KAAK,IAAK,IAAK,KACvB,QACF,CAAO,GAAI4D,EAAI,IAAMrE,EAAQ,EACtB+nB,GAAS,IAAM,GAClBzb,EAAM7L,KAAK,IAAK,IAAK,KACvB,QACF,CACA2vB,EAAgB/H,EAChB,QACF,CACA,GAAIA,EAAY,MAAO,EAChBN,GAAS,IAAM,GAClBzb,EAAM7L,KAAK,IAAK,IAAK,KACvB2vB,EAAgB/H,EAChB,QACF,CACAA,EAAgE,OAAnD+H,EAAgB,OAAS,GAAK/H,EAAY,MACzD,MAAW+H,IACJrI,GAAS,IAAM,GAClBzb,EAAM7L,KAAK,IAAK,IAAK,KAGzB,GADA2vB,EAAgB,KACZ/H,EAAY,IAAK,CACnB,IAAKN,GAAS,GAAK,EACjB,MACFzb,EAAM7L,KAAK4nB,EACb,MAAO,GAAIA,EAAY,KAAM,CAC3B,IAAKN,GAAS,GAAK,EACjB,MACFzb,EAAM7L,KAAK4nB,GAAa,EAAI,IAAiB,GAAZA,EAAiB,IACpD,MAAO,GAAIA,EAAY,MAAO,CAC5B,IAAKN,GAAS,GAAK,EACjB,MACFzb,EAAM7L,KAAK4nB,GAAa,GAAK,IAAKA,GAAa,EAAI,GAAK,IAAiB,GAAZA,EAAiB,IAChF,KAAO,MAAIA,EAAY,SAKrB,MAAM,IAAI/mB,MAAM,sBAJhB,IAAKymB,GAAS,GAAK,EACjB,MACFzb,EAAM7L,KAAK4nB,GAAa,GAAK,IAAKA,GAAa,GAAK,GAAK,IAAKA,GAAa,EAAI,GAAK,IAAiB,GAAZA,EAAiB,IAG5G,CACF,CACA,OAAO/b,CACT,CACA,SAASkB,EAAU1J,EAAK7D,EAAQyL,GAC9B,MAAMyc,EAAM,GACZ,KAAOloB,EAASyL,GAAK,CACnB,MAAM0c,EAAYtkB,EAAI7D,GACtB,IAAIooB,EAAY,KACZC,EAAmBF,EAAY,IAAM,EAAIA,EAAY,IAAM,EAAIA,EAAY,IAAM,EAAI,EACzF,GAAInoB,EAASqoB,GAAoB5c,EAAK,CACpC,IAAI6c,EAAYC,EAAWC,EAAYC,EACvC,OAAQJ,GACR,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EACHG,EAAazkB,EAAI7D,EAAS,GACC,MAAT,IAAbsoB,KACHG,GAA6B,GAAZN,IAAmB,EAAiB,GAAbG,EACpCG,EAAgB,MAClBL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAI7D,EAAS,GAC1BuoB,EAAY1kB,EAAI7D,EAAS,GACE,MAAT,IAAbsoB,IAAmD,MAAT,IAAZC,KACjCE,GAA6B,GAAZN,IAAmB,IAAmB,GAAbG,IAAoB,EAAgB,GAAZC,EAC9DE,EAAgB,OAASA,EAAgB,OAASA,EAAgB,SACpEL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAI7D,EAAS,GAC1BuoB,EAAY1kB,EAAI7D,EAAS,GACzBwoB,EAAa3kB,EAAI7D,EAAS,GACC,MAAT,IAAbsoB,IAAmD,MAAT,IAAZC,IAAmD,MAAT,IAAbC,KAC9DC,GAA6B,GAAZN,IAAmB,IAAmB,GAAbG,IAAoB,IAAkB,GAAZC,IAAmB,EAAiB,GAAbC,EACvFC,EAAgB,OAASA,EAAgB,UAC3CL,EAAYK,IAIpB,CACkB,OAAdL,GACFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QACrBA,GAAa,MACbF,EAAI1nB,KAAK4nB,IAAc,GAAK,KAAO,OACnCA,EAAY,MAAoB,KAAZA,GAEtBF,EAAI1nB,KAAK4nB,GACTpoB,GAAUqoB,CACZ,CACA,OAAOO,EAAsBV,EAC/B,CACA,MAAMS,EAAuB,KACtB,SAASC,EAAsBF,GACpC,MAAM5jB,EAAM4jB,EAAW3oB,OACvB,GAAI+E,GAAO6jB,EACT,OAAO1oB,OAAOC,aAAaC,MAAMF,OAAQyoB,GAE3C,IAAIR,EAAM,GACN9jB,EAAI,EACR,KAAOA,EAAIU,GACTojB,GAAOjoB,OAAOC,aAAaC,MAAMF,OAAQyoB,EAAW9mB,MAAMwC,EAAGA,GAAKukB,IAEpE,OAAOT,CACT,uHCnOA,MAAM0vE,EAAkB,qBAClBC,EAAkB,qBAClBC,EAAuB,GAM7B,SAASC,EAAiBxyE,EAAMxa,EAAKitF,GACnC,GAAIzyE,EAAKxlB,OAASgL,EAAMitF,EACtB,MAAM,IAAI32F,MAAM,GAAIu2F,6BAExB,CATAE,EAAqB,IAAM,EAC3BA,EAAqB,IAAM,EAC3BA,EAAqB,IAAM,EAC3BA,EAAqB,IAAM,EAC3BA,EAAqB,IAAM,4GCD3B,MAAMG,EAAuB,CAC3BtH,QAAQ,EACR0D,iBAAiB,EACjBoB,gBAAgB,EAChB1E,aAAa,GAEf,MAAMmH,EACJtvF,YAAY2c,EAAMrO,EAAU,CAAC,GAC3BpO,KAAKiC,IAAM,EACXjC,KAAKyc,KAAOA,EACZzc,KAAKoO,QAAUA,CACjB,CACAiqB,OACE,OAAOr4B,KAAKiC,KAAOjC,KAAKyc,KAAKxlB,MAC/B,CACAoU,OACE,MAAMumD,EAAM5xD,KAAKyc,KAAKzc,KAAKiC,KAC3B,IAAIq6B,EAAQ,KAAMs1B,GAClB,QAAclqD,IAAV40B,EAAqB,CACvB,MAAMi0B,EAAU,KAAKqB,GACrB,IAAKrB,EACH,MAAM,IAAIh4D,MAAM,GAAI,kCAA+Cq5D,IAAQ,aAAeA,EAAIjtD,SAAS,IAAI8yE,SAAS,EAAG,SAEzH,MAAMmS,EAAc,GAANh4B,EACdt1B,EAAQi0B,EAAQvwD,KAAKyc,KAAMzc,KAAKiC,IAAK2nF,EAAO5pF,KAAKoO,QACnD,CAEA,OADApO,KAAKiC,KAAOq6B,EAAM+yD,cACX/yD,CACT,EAEF,MAAMgzD,EAAO94F,OAAOkqD,IAAI,QAClB6uC,EAAQ/4F,OAAOkqD,IAAI,SAqDzB,SAAS8uC,EAAeC,EAAWrhF,GACjC,GAAIqhF,EAAUp3D,OACZ,OAAOi3D,EAET,MAAMhzD,EAAQmzD,EAAUpkF,OACxB,GAAIixB,EAAMptB,OAAS,UACjB,OAAOqgF,EAET,GAAIjzD,EAAMptB,KAAKwgF,SACb,OAAOpzD,EAAMz9B,MAEf,GAAIy9B,EAAMptB,OAAS,UACjB,OAhEJ,SAAsBotB,EAAOmzD,EAAWrhF,GACtC,MAAMvT,EAAM,GACZ,IAAK,IAAIS,EAAI,EAAGA,EAAIghC,EAAMz9B,MAAOvD,IAAK,CACpC,MAAMuD,EAAQ2wF,EAAeC,EAAWrhF,GACxC,GAAIvP,IAAU0wF,EAAO,CACnB,GAAIjzD,EAAMz9B,QAAUuS,IAClB,MAEF,MAAM,IAAI7Y,MAAM,GAAI,8CACtB,CACA,GAAIsG,IAAUywF,EACZ,MAAM,IAAI/2F,MAAM,GAAI,gDAA6D+C,eAAiBghC,EAAMz9B,UAE1GhE,EAAIS,GAAKuD,CACX,CACA,OAAOhE,CACT,CAgDW80F,CAAarzD,EAAOmzD,EAAWrhF,GAExC,GAAIkuB,EAAMptB,OAAS,QACjB,OAlDJ,SAAoBotB,EAAOmzD,EAAWrhF,GACpC,MAAMwhF,GAA8B,IAApBxhF,EAAQwhF,QAClBtmF,EAAMsmF,OAAUloF,EAAY,CAAC,EAC7B+V,EAAImyE,EAAU,IAAIt1E,SAAQ5S,EAChC,IAAK,IAAIpM,EAAI,EAAGA,EAAIghC,EAAMz9B,MAAOvD,IAAK,CACpC,MAAM6S,EAAMqhF,EAAeC,EAAWrhF,GACtC,GAAID,IAAQohF,EAAO,CACjB,GAAIjzD,EAAMz9B,QAAUuS,IAClB,MAEF,MAAM,IAAI7Y,MAAM,GAAI,4CACtB,CACA,GAAI4V,IAAQmhF,EACV,MAAM,IAAI/2F,MAAM,GAAI,8CAA2D+C,wBAA0BghC,EAAMz9B,UAEjH,IAAgB,IAAZ+wF,GAAmC,iBAARzhF,EAC7B,MAAM,IAAI5V,MAAM,GAAI,kDAA+D4V,MAErF,IAAuC,IAAnCC,EAAQyhF,yBACND,GAAWnyE,EAAEzC,IAAI7M,KAASyhF,GAAWzhF,KAAO7E,GAC9C,MAAM,IAAI/Q,MAAM,GAAI,8BAA2C4V,MAGnE,MAAMtP,EAAQ2wF,EAAeC,EAAWrhF,GACxC,GAAIvP,IAAUywF,EACZ,MAAM,IAAI/2F,MAAM,GAAI,8CAA2D+C,0BAA4BghC,EAAMz9B,UAE/G+wF,EACFnyE,EAAE5hB,IAAIsS,EAAKtP,GAEXyK,EAAI6E,GAAOtP,CAEf,CACA,OAAO+wF,EAAUnyE,EAAInU,CACvB,CAgBWwmF,CAAWxzD,EAAOmzD,EAAWrhF,GAEtC,GAAIkuB,EAAMptB,OAAS,QAAU,CAC3B,GAAId,EAAQ2hF,MAA6C,mBAA9B3hF,EAAQ2hF,KAAKzzD,EAAMz9B,OAAuB,CACnE,MAAMmxF,EAASR,EAAeC,EAAWrhF,GACzC,OAAOA,EAAQ2hF,KAAKzzD,EAAMz9B,OAAOmxF,EACnC,CACA,MAAM,IAAIz3F,MAAM,GAAI,2BAAwC+jC,EAAMz9B,SACpE,CACA,MAAM,IAAItG,MAAM,cAClB,CACA,SAAS6T,EAAOqQ,EAAMrO,GACpB,KAAMqO,aAAgBjiB,YACpB,MAAM,IAAIjC,MAAM,GAAI,4CAGtB,MAAMk3F,GADNrhF,EAAU1P,OAAO6W,OAAO,CAAC,EAAG45E,EAAsB/gF,IACxB6hF,WAAa,IAAIb,EAAU3yE,EAAMrO,GACrDovD,EAAUgyB,EAAeC,EAAWrhF,GAC1C,GAAIovD,IAAY8xB,EACd,MAAM,IAAI/2F,MAAM,GAAI,2CAEtB,GAAIilE,IAAY+xB,EACd,MAAM,IAAIh3F,MAAM,GAAI,6BAEtB,IAAKk3F,EAAUp3D,OACb,MAAM,IAAI9/B,MAAM,GAAI,gDAEtB,OAAOilE,CACT,+FCrIA,MAAM0yB,EAAU,CACd,SACA,SACA,SACA,UAEIC,EAAkB,CACtB,WACA,YACA,iBACA,oBACA,yBACA,gBACA,aACA,QACA,SACA,SACA,SACA,OACA,QACA,MACA,MACA,UACA,UACA,cACA,oBACA,WACA,UACA,MACA,cACA,YACA,aACA,oBACA,aACA,cACA,aACA,cACA,eACA,eACA,gBACA,kBAEK,SAASC,EAAGvxF,GACjB,GAAc,OAAVA,EACF,MAAO,OAET,QAAc6I,IAAV7I,EACF,MAAO,YAET,IAAc,IAAVA,IAA4B,IAAVA,EACpB,MAAO,UAET,MAAMwxF,SAAgBxxF,EACtB,GAAIqxF,EAAQ3uE,SAAS8uE,GACnB,OAAOA,EAET,GAAe,aAAXA,EACF,MAAO,WAET,GAAIz3F,MAAMuJ,QAAQtD,GAChB,MAAO,QAET,GASF,SAAkBA,GAChB,OAAOA,GAASA,EAAMiB,aAAejB,EAAMiB,YAAYuC,UAAYxD,EAAMiB,YAAYuC,SAAStJ,KAAK,KAAM8F,EAC3G,CAXMwD,CAASxD,GACX,MAAO,SAET,MAAMyxF,EASR,SAAuBzxF,GACrB,MAAM0xF,EAAiB7xF,OAAO7F,UAAU8L,SAAS5L,KAAK8F,GAAO/F,MAAM,GAAI,GACvE,GAAIq3F,EAAgB5uE,SAASgvE,GAC3B,OAAOA,EAET,MACF,CAfqBC,CAAc3xF,GACjC,OAAIyxF,GAGG,QACT,2BChEO,MAAMG,EACX3wF,YAAYkxE,EAFW,KAGrBhxE,KAAKgxE,UAAYA,EACjBhxE,KAAKmrB,OAAS,EACdnrB,KAAK0wF,WAAa,EAClB1wF,KAAK6uF,OAAS,GACd7uF,KAAK2wF,gBAAkB,IACzB,CACApkF,QACEvM,KAAKmrB,OAAS,EACdnrB,KAAK0wF,WAAa,EACd1wF,KAAK6uF,OAAO53F,SACd+I,KAAK6uF,OAAS,IAEa,OAAzB7uF,KAAK2wF,kBACP3wF,KAAK6uF,OAAOn3F,KAAKsI,KAAK2wF,iBACtB3wF,KAAK0wF,UAAY1wF,KAAK2wF,gBAAgB15F,OAAS,EAEnD,CACAS,KAAK6L,GACH,IAAIqtF,EAAW5wF,KAAK6uF,OAAO7uF,KAAK6uF,OAAO53F,OAAS,GAEhD,GADe+I,KAAKmrB,OAAS5nB,EAAMtM,QACrB+I,KAAK0wF,UAAY,EAAG,CAChC,MAAMG,EAAWD,EAAS35F,QAAU+I,KAAK0wF,UAAY1wF,KAAKmrB,QAAU,EACpEylE,EAAS/0F,IAAI0H,EAAOstF,EACtB,KAAO,CACL,GAAID,EAAU,CACZ,MAAMC,EAAWD,EAAS35F,QAAU+I,KAAK0wF,UAAY1wF,KAAKmrB,QAAU,EAChE0lE,EAAWD,EAAS35F,SACtB+I,KAAK6uF,OAAO7uF,KAAK6uF,OAAO53F,OAAS,GAAK25F,EAASt5F,SAAS,EAAGu5F,GAC3D7wF,KAAK0wF,UAAY1wF,KAAKmrB,OAAS,EAEnC,CACI5nB,EAAMtM,OAAS,IAAMsM,EAAMtM,OAAS+I,KAAKgxE,WAC3C4f,GAAW,QAAM5wF,KAAKgxE,WACtBhxE,KAAK6uF,OAAOn3F,KAAKk5F,GACjB5wF,KAAK0wF,WAAaE,EAAS35F,OACE,OAAzB+I,KAAK2wF,kBACP3wF,KAAK2wF,gBAAkBC,GAEzBA,EAAS/0F,IAAI0H,EAAO,KAEpBvD,KAAK6uF,OAAOn3F,KAAK6L,GACjBvD,KAAK0wF,WAAantF,EAAMtM,OAE5B,CACA+I,KAAKmrB,QAAU5nB,EAAMtM,MACvB,CACA+yD,QAAQz9C,GAAQ,GACd,IAAIolD,EACJ,GAA2B,IAAvB3xD,KAAK6uF,OAAO53F,OAAc,CAC5B,MAAM8vE,EAAQ/mE,KAAK6uF,OAAO,GACtBtiF,GAASvM,KAAKmrB,OAAS47C,EAAM9vE,OAAS,GACxC06D,EAAO3xD,KAAKmrB,SAAW47C,EAAM9vE,OAAS8vE,EAAQA,EAAMzvE,SAAS,EAAG0I,KAAKmrB,QACrEnrB,KAAK2wF,gBAAkB,KACvB3wF,KAAK6uF,OAAS,IAEdl9B,GAAO,QAAMoV,EAAO,EAAG/mE,KAAKmrB,OAEhC,MACEwmC,GAAO,QAAO3xD,KAAK6uF,OAAQ7uF,KAAKmrB,QAKlC,OAHI5e,GACFvM,KAAKuM,QAEAolD,CACT,8HCvDF,MAAMm/B,EAAuB,CAC3BrD,SAAS,EACTsD,UA6KF,SAAmBC,EAAIC,GACrB,MAAMC,EAAYt4F,MAAMuJ,QAAQ6uF,EAAG,IAAMA,EAAG,GAAG,GAAKA,EAAG,GACjDG,EAAYv4F,MAAMuJ,QAAQ8uF,EAAG,IAAMA,EAAG,GAAG,GAAKA,EAAG,GACvD,GAAIC,EAAUhiF,OAASiiF,EAAUjiF,KAC/B,OAAOgiF,EAAUhiF,KAAKsR,QAAQ2wE,EAAUjiF,MAE1C,MAAM0pC,EAAQs4C,EAAUhiF,KAAK0pC,MACvBw4C,EAAOC,EAAaz4C,GAAOiwC,cAAcqI,EAAWC,GAC7C,IAATC,GACF14F,EAAQqa,KAAK,yEAEf,OAAOq+E,CACT,EAxLEE,iBAAgB,MAclB,MAAMD,EAZC,WACL,MAAME,EAAW,GASjB,OARAA,EAAS,gBAAmB,KAC5BA,EAAS,kBAAqB,KAC9BA,EAAS,iBAAoB,KAC7BA,EAAS,kBAAqB,KAC9BA,EAAS,iBAAoB,KAC7BA,EAAS,eAAkB,KAC3BA,EAAS,eAAkB,KAC3BA,EAAS,iBAAoB,KACtBA,CACT,CACqBC,GACfz2F,EAAM,IAAI01F,EAChB,MAAMgB,EACJ3xF,YAAYwJ,EAAK8P,GACfpZ,KAAKsJ,IAAMA,EACXtJ,KAAKoZ,OAASA,CAChB,CACAmI,SAASjY,GACP,IAAI/N,EAAIyE,KACR,GACE,GAAIzE,EAAE+N,MAAQA,EACZ,OAAO,QAEF/N,EAAIA,EAAE6d,QACf,OAAO,CACT,CACAH,mBAAmBjR,EAAOsB,GACxB,GAAItB,GAASA,EAAMuZ,SAASjY,GAC1B,MAAM,IAAI/Q,MAAM,GAAI,4CAEtB,OAAO,IAAIk5F,EAAInoF,EAAKtB,EACtB,EAEF,MAAM0pF,EAAe,CACnBC,KAAM,IAAI,IAAM,SAAW,MAC3BjqF,UAAW,IAAI,IAAM,mBAAgBA,GACrCkqF,KAAM,IAAI,IAAM,UAAW,GAC3BC,MAAO,IAAI,IAAM,WAAY,GAC7BjpF,WAAY,IAAI,IAAM,UAAY,GAClCkpF,SAAU,IAAI,IAAM,QAAU,IAE1BC,EAAe,CACnB5oC,OAAM,CAAC7/C,EAAK0oF,EAAMrW,EAAUsW,IACrBjpF,OAAOD,UAAUO,IAASN,OAAOogD,cAAc9/C,GAEzCA,GAAO,EACT,IAAI,IAAM,SAAWA,GAErB,IAAI,IAAM,WAAaA,GAJvB,IAAI,IAAM,UAAYA,GAOjC4oF,OAAM,CAAC5oF,EAAK0oF,EAAMrW,EAAUsW,IACtB3oF,GAAO2Y,OAAO,GACT,IAAI,IAAM,SAAW3Y,GAErB,IAAI,IAAM,WAAaA,GAGlC9O,WAAU,CAAC8O,EAAK0oF,EAAMrW,EAAUsW,IACvB,IAAI,IAAM,UAAY3oF,GAE/B5F,OAAM,CAAC4F,EAAK0oF,EAAMrW,EAAUsW,IACnB,IAAI,IAAM,WAAa3oF,GAEhC6oF,QAAO,CAAC7oF,EAAK0oF,EAAMrW,EAAUsW,IACpB3oF,EAAMooF,EAAaE,KAAOF,EAAaG,MAEhDF,KAAI,CAACS,EAAMJ,EAAMrW,EAAUsW,IAClBP,EAAaC,KAEtBjqF,UAAS,CAAC0qF,EAAMJ,EAAMrW,EAAUsW,IACvBP,EAAahqF,UAEtBmU,YAAW,CAACvS,EAAK0oF,EAAMrW,EAAUsW,IACxB,IAAI,IAAM,UAAY,IAAIz3F,WAAW8O,IAE9CqwB,SAAQ,CAACrwB,EAAK0oF,EAAMrW,EAAUsW,IACrB,IAAI,IAAM,UAAY,IAAIz3F,WAAW8O,EAAI3S,OAAQ2S,EAAI4S,WAAY5S,EAAIuD,aAE9EjU,MAAM0Q,EAAK0oF,EAAM5jF,EAASikF,GACxB,IAAK/oF,EAAIrS,OACP,OAA+B,IAA3BmX,EAAQkkF,eACH,CACLZ,EAAa9oF,WACb,IAAI,IAAM,YAGP8oF,EAAa9oF,WAEtBypF,EAAWZ,EAAIc,YAAYF,EAAU/oF,GACrC,MAAMuJ,EAAU,GAChB,IAAIvX,EAAI,EACR,IAAK,MAAMmO,KAAKH,EACduJ,EAAQvX,KAAOk3F,EAAe/oF,EAAG2E,EAASikF,GAE5C,OAAIjkF,EAAQkkF,eACH,CACL,IAAI,IAAM,UAAYhpF,EAAIrS,QAC1B4b,EACA,IAAI,IAAM,YAGP,CACL,IAAI,IAAM,UAAYvJ,EAAIrS,QAC1B4b,EAEJ,EACAnU,OAAO4K,EAAKmpF,EAAKrkF,EAASikF,GACxB,MAAMK,EAAgB,WAARD,EACRhrF,EAAOirF,EAAQppF,EAAI7B,OAAS/I,OAAO+I,KAAK6B,GACxCrS,EAASy7F,EAAQppF,EAAI7R,KAAOgQ,EAAKxQ,OACvC,IAAKA,EACH,OAA+B,IAA3BmX,EAAQkkF,eACH,CACLZ,EAAaI,SACb,IAAI,IAAM,YAGPJ,EAAaI,SAEtBO,EAAWZ,EAAIc,YAAYF,EAAU/oF,GACrC,MAAMuJ,EAAU,GAChB,IAAIvX,EAAI,EACR,IAAK,MAAM6S,KAAO1G,EAChBoL,EAAQvX,KAAO,CACbk3F,EAAerkF,EAAKC,EAASikF,GAC7BG,EAAeE,EAAQppF,EAAI3I,IAAIwN,GAAO7E,EAAI6E,GAAMC,EAASikF,IAI7D,OAiCJ,SAAwBx/E,EAASzE,GAC3BA,EAAQ2iF,WACVl+E,EAAQizE,KAAK13E,EAAQ2iF,UAEzB,CAtCI4B,CAAe9/E,EAASzE,GACpBA,EAAQkkF,eACH,CACL,IAAI,IAAM,QAAUr7F,GACpB4b,EACA,IAAI,IAAM,YAGP,CACL,IAAI,IAAM,QAAU5b,GACpB4b,EAEJ,GAEFk/E,EAAaz3E,IAAMy3E,EAAarzF,OAChCqzF,EAAa3vF,OAAS2vF,EAAav3F,WACnC,IAAK,MAAMi4F,IAAO,iFAAiFxzF,MAAM,KACvG8yF,EAAa,GAAIU,UAAeV,EAAap4D,SAE/C,SAAS64D,EAAelpF,EAAK8E,EAAU,CAAC,EAAGikF,GACzC,MAAMI,EAAMrC,EAAG9mF,GACTspF,EAAoBxkF,GAAWA,EAAQ2jF,cAAgB3jF,EAAQ2jF,aAAaU,IAAQV,EAAaU,GACvG,GAAiC,mBAAtBG,EAAkC,CAC3C,MAAMj0C,EAASi0C,EAAkBtpF,EAAKmpF,EAAKrkF,EAASikF,GACpD,GAAc,MAAV1zC,EACF,OAAOA,CAEX,CACA,MAAMk0C,EAAcd,EAAaU,GACjC,IAAKI,EACH,MAAM,IAAIt6F,MAAM,GAAI,0BAAuCk6F,KAE7D,OAAOI,EAAYvpF,EAAKmpF,EAAKrkF,EAASikF,EACxC,CAmBA,SAASS,EAAgB/3F,EAAK4jD,EAAQ4yC,EAAUnjF,GAC9C,GAAIxV,MAAMuJ,QAAQw8C,GAChB,IAAK,MAAMriB,KAASqiB,EAClBm0C,EAAgB/3F,EAAKuhC,EAAOi1D,EAAUnjF,QAGxCmjF,EAAS5yC,EAAOzvC,KAAK0pC,OAAO79C,EAAK4jD,EAAQvwC,EAE7C,CACA,SAAS2kF,EAAat2E,EAAM80E,EAAUnjF,GACpC,MAAMuwC,EAAS6zC,EAAe/1E,EAAMrO,GACpC,IAAKxV,MAAMuJ,QAAQw8C,IAAWvwC,EAAQkjF,iBAAkB,CACtD,MAAM0B,EAAa5kF,EAAQkjF,iBAAiB3yC,GAC5C,GAAIq0C,EACF,OAAOA,EAET,MAAMniC,EAAU0gC,EAAS5yC,EAAOzvC,KAAK0pC,OACrC,GAAIiY,EAAQ+3B,YAAa,CACvB,MAAMnxF,EAAOo5D,EAAQ+3B,YAAYjqC,EAAQvwC,GACnCrT,EAAM,IAAI01F,EAAGh5F,GAEnB,GADAo5D,EAAQ91D,EAAK4jD,EAAQvwC,GACK,IAAtBrT,EAAI8zF,OAAO53F,OACb,MAAM,IAAIsB,MAAM,+CAAgDomD,eAElE,OAAO,QAAM5jD,EAAI8zF,OAAO,GAC1B,CACF,CAGA,OAFA9zF,EAAIwR,QACJumF,EAAgB/3F,EAAK4jD,EAAQ4yC,EAAUnjF,GAChCrT,EAAIivD,SAAQ,EACrB,CACA,SAASj7C,EAAO0N,EAAMrO,GAEpB,OADAA,EAAU1P,OAAO6W,OAAO,CAAC,EAAGu7E,EAAsB1iF,GAC3C2kF,EAAat2E,EAAM40E,EAAcjjF,EAC1C,uKCxOA,MAAM6kF,UAAoBr6F,MACxBkH,cACE6S,QACA3S,KAAKkzF,YAAc,EACrB,CACA15E,OAAOze,GACL,MAAMo4F,EAASnzF,KAAKkzF,YAAYlzF,KAAKkzF,YAAYj8F,OAAS,GACtDk8F,IACEA,EAAOjkF,OAAS,YAClBikF,EAAOC,WACiB,IAApBD,EAAOC,UACTr4F,EAAIrD,KAAK,CAAC,MAGVy7F,EAAOjkF,OAAS,UAClBikF,EAAOC,WACiB,IAApBD,EAAOC,WACLD,EAAOC,SAAW,GAAM,EAC1Br4F,EAAIrD,KAAK,CAAC,KAEVqD,EAAIrD,KAAK,CAAC,OAKpB,CACA,CAAC,gBAAiBqD,EAAKuhC,GACrBt8B,KAAKwZ,OAAOze,GACZ,MAAMq1F,EAAKj5F,OAAOmlC,EAAMz9B,OAClBw0F,EAAM,GACZ,IAAK,IAAI/3F,EAAI,EAAGA,EAAI80F,EAAGn5F,OAAQqE,IAC7B+3F,EAAI/3F,GAAK80F,EAAG50F,WAAWF,GAEzBP,EAAIrD,KAAK27F,EACX,CACA,CAAC,kBAAmBt4F,EAAKuhC,GACvBt8B,KAAK,gBAAiBjF,EAAKuhC,EAC7B,CACA,CAAC,iBAAkBg3D,EAAMC,GACvB,MAAM,IAAIh7F,MAAM,GAAI,oCACtB,CACA,CAAC,kBAAmBwC,EAAKuhC,GACvBt8B,KAAKwZ,OAAOze,GACZ,MAAM42D,GAAO,QAAWz3B,KAAKuG,UAAUnE,EAAMz9B,QAC7C9D,EAAIrD,KAAKi6D,EAAK16D,OAAS,IAAK,QAAM06D,GAAQA,EAC5C,CACA,CAAC,iBAAkB52D,EAAKw4F,GACtBvzF,KAAKwZ,OAAOze,GACZiF,KAAKkzF,YAAYx7F,KAAK,CACpBwX,KAAM,UACNkkF,SAAU,IAEZr4F,EAAIrD,KAAK,CAAC,IACZ,CACA,CAAC,eAAgBqD,EAAKw4F,GACpBvzF,KAAKwZ,OAAOze,GACZiF,KAAKkzF,YAAYx7F,KAAK,CACpBwX,KAAM,QACNkkF,SAAU,IAEZr4F,EAAIrD,KAAK,CAAC,KACZ,CACA,CAAC,eAAgB47F,EAAMC,GACvB,CACA,CAAC,iBAAkBx4F,EAAKuhC,GACtB,GAAwB,UAApBA,EAAMptB,KAAK7P,KAAkB,CAC/B,MAAM8zF,EAASnzF,KAAKkzF,YAAYnzD,MAChC,GAAIozD,EAAQ,CACV,GAAIA,EAAOjkF,OAAS,UAClBnU,EAAIrD,KAAK,CAAC,SACL,IAAIy7F,EAAOjkF,OAAS,QAGzB,MAAM,IAAI3W,MAAM,sDAFhBwC,EAAIrD,KAAK,CAAC,KAGZ,CACA,MACF,CACA,MAAM,IAAIa,MAAM,4CAClB,CACA,QAAoBmP,IAAhB40B,EAAMz9B,MACR,MAAM,IAAItG,MAAM,GAAI,oCAGtB,GADAyH,KAAKwZ,OAAOze,GACY,SAApBuhC,EAAMptB,KAAK7P,KAOb,YANAtE,EAAIrD,KAAK,CACP,IACA,IACA,IACA,MAGG,GAAwB,UAApB4kC,EAAMptB,KAAK7P,KAQpB,YAPAtE,EAAIrD,KAAK,CACP,IACA,GACA,IACA,IACA,MAGG,GAAwB,SAApB4kC,EAAMptB,KAAK7P,KAOpB,YANAtE,EAAIrD,KAAK,CACP,IACA,IACA,IACA,MAIJ,MAAM04F,EAAKj5F,OAAOmlC,EAAMz9B,OAClBw0F,EAAM,GACZ,IAAIx3B,GAAK,EACT,IAAK,IAAIvgE,EAAI,EAAGA,EAAI80F,EAAGn5F,OAAQqE,IAC7B+3F,EAAI/3F,GAAK80F,EAAG50F,WAAWF,GAClBugE,GAAkB,KAAXw3B,EAAI/3F,IAAwB,MAAX+3F,EAAI/3F,IAAyB,KAAX+3F,EAAI/3F,KACjDugE,GAAK,GAGJA,IACHw3B,EAAI37F,KAAK,IACT27F,EAAI37F,KAAK,KAEXqD,EAAIrD,KAAK27F,EACX,EAmBF,MAAMvC,EAAuB,CAC3BwB,gBAAgB,EAChBvB,UAnBF,SAAmBC,EAAIC,GACrB,GAAIr4F,MAAMuJ,QAAQ6uF,EAAG,KAAOp4F,MAAMuJ,QAAQ8uF,EAAG,IAC3C,MAAM,IAAI14F,MAAM,GAAI,2CAEtB,MAAM24F,EAAYF,EAAG,GACfG,EAAYF,EAAG,GACrB,GAAIC,EAAUhiF,OAAS,YAAeiiF,EAAUjiF,OAAS,WACvD,MAAM,IAAI3W,MAAM,GAAI,8CAEtB,GAAI24F,EAAYC,EACd,OAAQ,EAEV,GAAID,EAAYC,EACd,OAAO,EAET,MAAM,IAAI54F,MAAM,GAAI,4DACtB,GAKA,SAAS,EAAOkkB,EAAMrO,GAEpB,OADAA,EAAU1P,OAAO6W,OAAO,CAAC,EAAGu7E,EAAsB1iF,IAC3C,EAAAW,EAAA,IAAa0N,EAAM,IAAIw2E,EAAe7kF,EAC/C,gBCrJA,MAAMolF,EACJ1zF,YAAY2c,EAAMrO,EAAU,CAAC,GAC3BpO,KAAKiC,IAAM,EACXjC,KAAKyc,KAAOA,EACZzc,KAAKoO,QAAUA,EACfpO,KAAKyzF,UAAY,CAAC,SAClBzzF,KAAK0zF,UAAY,EACnB,CACAr7D,OACE,OAAOr4B,KAAKiC,KAAOjC,KAAKyc,KAAKxlB,MAC/B,CACA08F,KACE,OAAO3zF,KAAKyc,KAAKzc,KAAKiC,IACxB,CACA2xF,cACE,OAAO5zF,KAAKyzF,UAAUzzF,KAAKyzF,UAAUx8F,OAAS,EAChD,CACA48F,iBACE,IAAI50E,EAAIjf,KAAK2zF,KACb,KAAa,KAAN10E,GAAkB,IAANA,GAAiB,KAANA,GAAkB,KAANA,GACxCA,EAAIjf,KAAKyc,OAAOzc,KAAKiC,IAEzB,CACA6xF,OAAOz4F,GACL,GAAI2E,KAAKyc,KAAKxlB,OAAS+I,KAAKiC,IAAM5G,EAAIpE,OACpC,MAAM,IAAIsB,MAAM,GAAI,4CAAyDyH,KAAKiC,OAEpF,IAAK,IAAI3G,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC9B,GAAI0E,KAAKyc,KAAKzc,KAAKiC,SAAW5G,EAAIC,GAChC,MAAM,IAAI/C,MAAM,GAAI,qCAAkDyH,KAAKiC,0BAA4B9K,OAAOC,gBAAgBiE,MAGpI,CACA04F,cACE,MAAMC,EAAWh0F,KAAKiC,IACtB,IAAIgyF,GAAW,EACX75F,GAAQ,EACZ,MAAM85F,EAAUl6D,IACd,MAAQh6B,KAAKq4B,QAAQ,CACnB,MAAMs7D,EAAK3zF,KAAK2zF,KAChB,IAAI35D,EAAMzY,SAASoyE,GAGjB,MAFA3zF,KAAKiC,KAIT,GAMF,GAJkB,KAAdjC,KAAK2zF,OACPM,GAAW,EACXj0F,KAAKiC,OAEW,KAAdjC,KAAK2zF,KAAa,CAEpB,GADA3zF,KAAKiC,MACa,KAAdjC,KAAK2zF,KAIP,OAAO,IAAI,IAAM,SAAW,EAAG3zF,KAAKiC,IAAM+xF,GAH1Ch0F,KAAKiC,MACL7H,GAAQ,CAIZ,CAaA,GAZA85F,EAAQ,CACN,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,KAEED,GAAYj0F,KAAKiC,MAAQ+xF,EAAW,EACtC,MAAM,IAAIz7F,MAAM,GAAI,qCAAkDyH,KAAKiC,OAE7E,IAAKjC,KAAKq4B,QAAwB,KAAdr4B,KAAK2zF,KAAa,CACpC,GAAIv5F,EACF,MAAM,IAAI7B,MAAM,GAAI,qCAAkDyH,KAAKiC,OAE7E7H,GAAQ,EACR4F,KAAKiC,MACLiyF,EAAQ,CACN,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEJ,CACKl0F,KAAKq4B,QAAyB,MAAdr4B,KAAK2zF,MAA8B,KAAd3zF,KAAK2zF,OAC7Cv5F,GAAQ,EACR4F,KAAKiC,MACAjC,KAAKq4B,QAAyB,KAAdr4B,KAAK2zF,MAA6B,KAAd3zF,KAAK2zF,MAC5C3zF,KAAKiC,MAEPiyF,EAAQ,CACN,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,MAGJ,MAAMC,EAASh9F,OAAOC,aAAaC,MAAM,KAAM2I,KAAKyc,KAAKnlB,SAAS08F,EAAUh0F,KAAKiC,MAC3E0kC,EAAMtZ,WAAW8mE,GACvB,OAAI/5F,EACK,IAAI,IAAM,UAAYusC,EAAK3mC,KAAKiC,IAAM+xF,IAEd,IAA7Bh0F,KAAKoO,QAAQ65E,aAAwBj/E,OAAOogD,cAAcziB,GACrD,IAAI,IAAMA,GAAO,EAAI,SAAY,WAAaA,EAAK3mC,KAAKiC,IAAM+xF,GAEhE,IAAI,IAAMrtD,GAAO,EAAI,SAAY,WAAa1kB,OAAOkyE,GAASn0F,KAAKiC,IAAM+xF,EAClF,CACAI,cACE,GAAkB,KAAdp0F,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAI,yCAAsDyH,KAAKiC,8BAEjFjC,KAAKiC,MACL,IAAK,IAAI3G,EAAI0E,KAAKiC,IAAK2vB,EAAI,EAAGt2B,EAAI0E,KAAKyc,KAAKxlB,QAAU26B,EAAI,MAAOt2B,IAAKs2B,IAAK,CACzE,MAAM+hE,EAAK3zF,KAAKyc,KAAKnhB,GACrB,GAAW,KAAPq4F,GAAaA,EAAK,IAAMA,GAAM,IAChC,MAEF,GAAW,KAAPA,EAAW,CACb,MAAMt4F,EAAMlE,OAAOC,aAAaC,MAAM,KAAM2I,KAAKyc,KAAKnlB,SAAS0I,KAAKiC,IAAK3G,IAEzE,OADA0E,KAAKiC,IAAM3G,EAAI,EACR,IAAI,IAAM,WAAaD,EAAKu2B,EACrC,CACF,CACA,MAAMoiE,EAAWh0F,KAAKiC,IAChB+3B,EAAQ,GACRq6D,EAAS,KACb,GAAIr0F,KAAKiC,IAAM,GAAKjC,KAAKyc,KAAKxlB,OAC5B,MAAM,IAAIsB,MAAM,GAAI,8DAA2EyH,KAAKiC,OAEtG,IAAIqyF,EAAK,EACT,IAAK,IAAIh5F,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAIq4F,EAAK3zF,KAAK2zF,KACd,GAAIA,GAAM,IAAMA,GAAM,GACpBA,GAAM,QACD,GAAIA,GAAM,IAAMA,GAAM,IAC3BA,EAAKA,EAAK,GAAK,OACV,MAAIA,GAAM,IAAMA,GAAM,IAG3B,MAAM,IAAIp7F,MAAM,GAAI,wDAAqEyH,KAAKiC,OAF9F0xF,EAAKA,EAAK,GAAK,EAGjB,CACAW,EAAU,GAALA,EAAUX,EACf3zF,KAAKiC,KACP,CACA,OAAOqyF,CAAE,EAELC,EAAe,KACnB,MAAMl1E,EAAYrf,KAAK2zF,KACvB,IAKIn0E,EAAYC,EAAWC,EAAYC,EALnCL,EAAY,KACZC,EAAmBF,EAAY,IAAM,EAAIA,EAAY,IAAM,EAAIA,EAAY,IAAM,EAAI,EACzF,GAAIrf,KAAKiC,IAAMsd,EAAmBvf,KAAKyc,KAAKxlB,OAC1C,MAAM,IAAIsB,MAAM,GAAI,gDAA6DyH,KAAKiC,OAGxF,OAAQsd,GACR,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EACHG,EAAaxf,KAAKyc,KAAKzc,KAAKiC,IAAM,GACP,MAAT,IAAbud,KACHG,GAA6B,GAAZN,IAAmB,EAAiB,GAAbG,EACpCG,EAAgB,MAClBL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAaxf,KAAKyc,KAAKzc,KAAKiC,IAAM,GAClCwd,EAAYzf,KAAKyc,KAAKzc,KAAKiC,IAAM,GACN,MAAT,IAAbud,IAAmD,MAAT,IAAZC,KACjCE,GAA6B,GAAZN,IAAmB,IAAmB,GAAbG,IAAoB,EAAgB,GAAZC,EAC9DE,EAAgB,OAASA,EAAgB,OAASA,EAAgB,SACpEL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAaxf,KAAKyc,KAAKzc,KAAKiC,IAAM,GAClCwd,EAAYzf,KAAKyc,KAAKzc,KAAKiC,IAAM,GACjCyd,EAAa1f,KAAKyc,KAAKzc,KAAKiC,IAAM,GACP,MAAT,IAAbud,IAAmD,MAAT,IAAZC,IAAmD,MAAT,IAAbC,KAC9DC,GAA6B,GAAZN,IAAmB,IAAmB,GAAbG,IAAoB,IAAkB,GAAZC,IAAmB,EAAiB,GAAbC,EACvFC,EAAgB,OAASA,EAAgB,UAC3CL,EAAYK,IAIA,OAAdL,GACFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QACrBA,GAAa,MACb0a,EAAMtiC,KAAK4nB,IAAc,GAAK,KAAO,OACrCA,EAAY,MAAoB,KAAZA,GAEtB0a,EAAMtiC,KAAK4nB,GACXtf,KAAKiC,KAAOsd,CAAgB,EAE9B,MAAQvf,KAAKq4B,QAAQ,CACnB,MAAMs7D,EAAK3zF,KAAK2zF,KAChB,IAAIa,EACJ,OAAQb,GACR,KAAK,GAEH,GADA3zF,KAAKiC,MACDjC,KAAKq4B,OACP,MAAM,IAAI9/B,MAAM,GAAI,kDAA+DyH,KAAKiC,OAI1F,OAFAuyF,EAAMx0F,KAAK2zF,KACX3zF,KAAKiC,MACGuyF,GACR,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACHx6D,EAAMtiC,KAAK88F,GACX,MACF,KAAK,GACHx6D,EAAMtiC,KAAK,GACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,GACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK28F,KACX,MACF,QACE,MAAM,IAAI97F,MAAM,GAAI,uDAAoEyH,KAAKiC,OAE/F,MACF,KAAK,GAEH,OADAjC,KAAKiC,MACE,IAAI,IAAM,YAAa,QAAsB+3B,GAAQh6B,KAAKiC,IAAM+xF,GACzE,QACE,GAAIL,EAAK,GACP,MAAM,IAAIp7F,MAAM,GAAI,8CAA2DyH,KAAKiC,OAC3E0xF,EAAK,KACd35D,EAAMtiC,KAAKi8F,GACX3zF,KAAKiC,OAELsyF,IAGN,CACA,MAAM,IAAIh8F,MAAM,GAAI,6CAA0DyH,KAAKiC,MACrF,CACAwyF,aACE,OAAQz0F,KAAK2zF,MACb,KAAK,IAGH,OAFA3zF,KAAKyzF,UAAU/7F,KAAK,aACpBsI,KAAKiC,MACE,IAAI,IAAM,QAAUmP,IAAU,GACvC,KAAK,GAGH,OAFApR,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAKiC,MACE,IAAI,IAAM,UAAYmP,IAAU,GACzC,KAAK,GACD,OAAOpR,KAAKo0F,cAEhB,KAAK,IAOH,OANAp0F,KAAK8zF,OAAO,CACV,IACA,IACA,IACA,MAEK,IAAI,IAAM,SAAW,KAAM,GACpC,KAAK,IAQH,OAPA9zF,KAAK8zF,OAAO,CACV,IACA,GACA,IACA,IACA,MAEK,IAAI,IAAM,WAAY,EAAO,GACtC,KAAK,IAOH,OANA9zF,KAAK8zF,OAAO,CACV,IACA,IACA,IACA,MAEK,IAAI,IAAM,UAAW,EAAM,GACpC,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACH,OAAO9zF,KAAK+zF,cACd,QACE,MAAM,IAAIx7F,MAAM,GAAI,yCAAsDyH,KAAKiC,OAEnF,CACAoJ,OAEE,OADArL,KAAK6zF,iBACG7zF,KAAK4zF,eACb,IAAK,QAEH,OADA5zF,KAAKyzF,UAAU1zD,MACR//B,KAAKy0F,aACd,IAAK,cAED,GADAz0F,KAAKyzF,UAAU1zD,MACG,KAAd//B,KAAK2zF,KAGP,OAFA3zF,KAAKiC,MACLjC,KAAK6zF,iBACE,IAAI,IAAM,eAAYnsF,EAAW,GAE1C,GAAkB,KAAd1H,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAI,yCAAsDyH,KAAKiC,iDAAmD9K,OAAOC,aAAa4I,KAAK2zF,UAK7J,OAHA3zF,KAAKiC,MACLjC,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,aAEhB,IAAK,cAED,OADAz0F,KAAKyzF,UAAU1zD,MACG,KAAd//B,KAAK2zF,MACP3zF,KAAKiC,MACLjC,KAAK6zF,iBACE,IAAI,IAAM,eAAYnsF,EAAW,KAE1C1H,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,cAEhB,IAAK,UACH,GAAkB,MAAdz0F,KAAK2zF,KAIP,OAHA3zF,KAAKyzF,UAAU1zD,MACf//B,KAAKiC,MACLjC,KAAK6zF,iBACE,IAAI,IAAM,eAAYnsF,EAAW,GAE1C,GAAkB,KAAd1H,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAI,yCAAsDyH,KAAKiC,kDAAoD9K,OAAOC,aAAa4I,KAAK2zF,UAE9J3zF,KAAKiC,MACLjC,KAAK6zF,iBACP,IAAK,YAAa,CAEd,GADA7zF,KAAKyzF,UAAU1zD,MACG,MAAd//B,KAAK2zF,KAGP,OAFA3zF,KAAKiC,MACLjC,KAAK6zF,iBACE,IAAI,IAAM,eAAYnsF,EAAW,GAE1C,MAAM40B,EAAQt8B,KAAKo0F,cAEnB,GADAp0F,KAAK6zF,iBACa,KAAd7zF,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAI,yCAAsDyH,KAAKiC,yDAA2D9K,OAAOC,aAAa4I,KAAK2zF,UAIrK,OAFA3zF,KAAKiC,MACLjC,KAAKyzF,UAAU/7F,KAAK,aACb4kC,CACT,CACF,IAAK,YAID,OAHAt8B,KAAKyzF,UAAU1zD,MACf//B,KAAKyzF,UAAU/7F,KAAK,WACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,aAEhB,QACE,MAAM,IAAIl8F,MAAM,GAAI,2CAAwDyH,KAAKiC,8BAErF,EAEF,SAAS,EAAOwa,EAAMrO,GAEpB,OADAA,EAAU1P,OAAO6W,OAAO,CAAE06E,UAAW,IAAIuD,EAAU/2E,EAAMrO,IAAYA,IAC9D,QAAQqO,EAAMrO,EACvB,mPC1YA,SAASsmF,EAAaj4E,EAAMxa,EAAK2nF,GAC/B,MAAM,IAAIrxF,MAAM,GAAI,mCAAgDqxF,gBAAsBntE,EAAKxa,KAAS,IAC1G,CACA,SAAS0yF,EAAQ1tE,GACf,MAAO,KACL,MAAM,IAAI1uB,MAAM,GAAI,QAAqB0uB,IAAO,CAEpD,CACO,MAAM2tE,EAAO,GACpB,IAAK,IAAIt5F,EAAI,EAAGA,GAAK,GAAIA,IACvBs5F,EAAKt5F,GAAKo5F,EAEZE,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACX,IAAK,IAAIp5F,EAAI,GAAIA,GAAK,GAAIA,IACxBs5F,EAAKt5F,GAAKo5F,EAEZE,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACX,IAAK,IAAIp5F,EAAI,GAAIA,GAAK,GAAIA,IACxBs5F,EAAKt5F,GAAK,KAEZs5F,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAM,KACXA,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMF,EACXE,EAAK,IAAMD,EAAQ,qDACnB,IAAK,IAAIr5F,EAAI,GAAIA,GAAK,IAAKA,IACzBs5F,EAAKt5F,GAAK,KAEZs5F,EAAK,KAAO,KACZA,EAAK,KAAO,IACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOD,EAAQ,qDACpB,IAAK,IAAIr5F,EAAI,IAAKA,GAAK,IAAKA,IAC1Bs5F,EAAKt5F,GAAK,KAEZs5F,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAO,KACZ,IAAK,IAAIt5F,EAAI,IAAKA,GAAK,IAAKA,IAC1Bs5F,EAAKt5F,GAAK,KAEZs5F,EAAK,KAAO,IACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAO,KACZ,IAAK,IAAIt5F,EAAI,IAAKA,GAAK,IAAKA,IAC1Bs5F,EAAKt5F,GAAK,KAEZs5F,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZ,IAAK,IAAIp5F,EAAI,IAAKA,GAAK,IAAKA,IAC1Bs5F,EAAKt5F,GAAKq5F,EAAQ,mCAEpBC,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAO,KACZA,EAAK,KAAOD,EAAQ,mCACpBC,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAO,KACZA,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAOF,EACZE,EAAK,KAAO,KACL,MAAMC,EAAQ,GACrB,IAAK,IAAIv5F,EAAI,EAAGA,EAAI,GAAIA,IACtBu5F,EAAMv5F,GAAK,IAAI,IAAM,SAAWA,EAAG,GAErC,IAAK,IAAIA,GAAK,EAAGA,IAAM,GAAIA,IACzBu5F,EAAM,GAAKv5F,GAAK,IAAI,IAAM,WAAaA,EAAG,GASrC,SAASg2F,EAAiBh1D,GAC/B,OAAQA,EAAMptB,MACd,KAAK,UACH,OAAO,QAAU,CAAC,MACpB,KAAK,SACH,OAAO,QAAU,CAAC,MACpB,KAAK,SACH,OAAO,QAAU,CAAC,MACpB,KAAK,UACH,OAAKotB,EAAMz9B,MAAM5H,YAGjB,GAFS,QAAU,CAAC,KAGtB,KAAK,WACH,MAAoB,KAAhBqlC,EAAMz9B,OACD,QAAU,CAAC,UAEpB,EACF,KAAK,UACH,OAAoB,IAAhBy9B,EAAMz9B,OACD,QAAU,CAAC,WAEpB,EACF,KAAK,QACH,OAAoB,IAAhBy9B,EAAMz9B,OACD,QAAU,CAAC,WAEpB,EACF,KAAK,SACH,OAAIy9B,EAAMz9B,MAAQ,IACT,QAAU,CAACmK,OAAOszB,EAAMz9B,cAEjC,EACF,KAAK,WACH,GAAIy9B,EAAMz9B,QAAU,GAClB,OAAO,QAAU,CAAC,GAAKmK,OAAOszB,EAAMz9B,SAG1C,CA7CAg2F,EAAM,IAAM,IAAI,IAAM,UAAY,IAAIr6F,WAAW,GAAI,GACrDq6F,EAAM,IAAM,IAAI,IAAM,WAAa,GAAI,GACvCA,EAAM,KAAO,IAAI,IAAM,UAAY,EAAG,GACtCA,EAAM,KAAO,IAAI,IAAM,QAAU,EAAG,GACpCA,EAAM,KAAO,IAAI,IAAM,WAAY,EAAO,GAC1CA,EAAM,KAAO,IAAI,IAAM,UAAW,EAAM,GACxCA,EAAM,KAAO,IAAI,IAAM,SAAW,KAAM,8FChIxC,MAAM55F,EACJ6E,YAAY84C,EAAOv5C,EAAMqwF,GACvB1vF,KAAK44C,MAAQA,EACb54C,KAAKypF,aAAe7wC,GAAS,EAC7B54C,KAAKX,KAAOA,EACZW,KAAK0vF,SAAWA,CAClB,CACA/qF,WACE,MAAO,QAAS3E,KAAK44C,UAAY54C,KAAKX,MACxC,CACAmhB,QAAQiyE,GACN,OAAOzyF,KAAK44C,MAAQ65C,EAAI75C,OAAS,EAAI54C,KAAK44C,MAAQ65C,EAAI75C,MAAQ,EAAI,CACpE,EAEF39C,EAAKwtF,KAAO,IAAIxtF,EAAK,EAAG,QAAQ,GAChCA,EAAKuuF,OAAS,IAAIvuF,EAAK,EAAG,UAAU,GACpCA,EAAKsI,MAAQ,IAAItI,EAAK,EAAG,SAAS,GAClCA,EAAKyI,OAAS,IAAIzI,EAAK,EAAG,UAAU,GACpCA,EAAK4hB,MAAQ,IAAI5hB,EAAK,EAAG,SAAS,GAClCA,EAAK2f,IAAM,IAAI3f,EAAK,EAAG,OAAO,GAC9BA,EAAKo4B,IAAM,IAAIp4B,EAAK,EAAG,OAAO,GAC9BA,EAAKb,MAAQ,IAAIa,EAAK,EAAG,SAAS,GAClCA,EAAK42F,MAAQ,IAAI52F,EAAK,EAAG,SAAS,GAClCA,EAAK22F,KAAO,IAAI32F,EAAK,EAAG,QAAQ,GAChCA,EAAK02F,KAAO,IAAI12F,EAAK,EAAG,QAAQ,GAChCA,EAAKyM,UAAY,IAAIzM,EAAK,EAAG,aAAa,GAC1CA,EAAK65F,MAAQ,IAAI75F,EAAK,EAAG,SAAS,GAClC,MAAM85F,EACJj1F,YAAYoP,EAAMrQ,EAAOwwF,GACvBrvF,KAAKkP,KAAOA,EACZlP,KAAKnB,MAAQA,EACbmB,KAAKqvF,cAAgBA,EACrBrvF,KAAKkqF,kBAAexiF,EACpB1H,KAAKyqF,eAAY/iF,CACnB,CACA/C,WACE,MAAO,SAAU3E,KAAKkP,SAAWlP,KAAKnB,OACxC,iNCpCK,SAASm2F,EAAY14E,GACxB,OAAOpU,EAAAyqD,UAAA,OAAiBr2C,GAAGxjB,MAAM,EACrC,CACO,SAASm8F,EAAcjoE,GAC1B,OAAO9kB,EAAAyqD,UAAA,OAAiB,IAAI3lC,IAChC,gBCIA,SAASkoE,EAAgB9wC,GACrB,MAAM+wC,EAAU,CACZ/wC,UAAW6wC,EAAc7wC,EAAUA,YAMvC,OAJIA,EAAU3rB,SACV08D,EAAQ18D,OAAS2rB,EAAU3rB,QAC3B2rB,EAAUgxC,YACVD,EAAQC,UAAYH,EAAc7wC,EAAUgxC,YACzCD,CACX,CAcA,SAASE,EAAgBF,GACrB,MAAM5uF,EAAO,CACT69C,UAAW4wC,EAAYG,EAAQ/wC,YAMnC,OAJI+wC,EAAQ18D,SACRlyB,EAAKkyB,OAAS08D,EAAQ18D,QACtB08D,EAAQC,YACR7uF,EAAK6uF,UAAYJ,EAAYG,EAAQC,YAClC7uF,CACX,CC7BA,SAAS+uF,EAAgBC,GACrB,MAAMC,EAAS,CAAC,EAKhB,OAJID,EAAUE,gBACVD,EAAOC,cAAgBR,EAAcM,EAAUE,gBAC/CF,EAAU98D,SACV+8D,EAAO/8D,OAAS88D,EAAU98D,QACvB+8D,CACX,CAgBA,SAASE,EAAgBP,GACrB,MAAMI,EAAY,CAAC,EAKnB,OAJIJ,EAAQM,gBACRF,EAAUE,cAAgBT,EAAYG,EAAQM,gBAC9CN,EAAQ18D,SACR88D,EAAU98D,OAAS08D,EAAQ18D,QACxB88D,CACX,gBCxCO,MAAM,EAAO,WACPlnF,EAAO,IACpB,SAASsnF,EAASC,GACd,MAAQ,YAAaA,GACO,iBAAjBA,EAAKxgD,SACZ,eAAgBwgD,GAChBh9F,MAAMuJ,QAAQyzF,EAAK7gE,WAC3B,CAiBA,SAAS8gE,EAASD,GACd,MAAQ,eAAgBA,GACO,iBAApBA,EAAKtnC,YACZ,OAAQsnC,GACW,iBAAZA,EAAKj9B,IACZ,cAAei9B,GACW,iBAAnBA,EAAKR,WACZ,QAASQ,GACW,iBAAbA,EAAKviE,GACpB,CACO,SAASyiE,EAAUF,GACtB,GAAoB,iBAATA,EAAmB,CAC1B,MAAM32F,EAAQ22F,EAAK32F,MAAM,KACzB,GAAqB,IAAjBA,EAAMhI,OACN,OFvCL,SAAmBgI,GACtB,MAAO82F,EAAiB3gD,EAASgP,GAAanlD,EAC9C,MAAO,CACHm2C,UACArgB,WAAY,CAAC,CAAEqgE,UAAWW,EAAiB3xC,cAC3CwQ,KAAM,YAAWqgC,EAAc7/C,IAEvC,CEgCmB,CAAkBn2C,GAExB,GAAqB,IAAjBA,EAAMhI,OACX,OD3CL,SAAmBgI,GACtB,MAAO82F,EAAiBN,EAAe98B,EAAIrK,EAAYj7B,GAAOp0B,EACxD+2F,EAAM,CACR1nC,aACAqK,KACAy8B,UAAWW,EACX1iE,OAIJ,OAFIoiE,IACAO,EAAIC,WAAa,CAAC,CAAER,mBACjBO,CACX,CCgCmB,CAAqB/2F,GAEhC,MAAM,IAAI1G,MAAM,0BACpB,CACA,GAAIo9F,EAASC,IAASC,EAASD,GAC3B,OAAOA,EAEX,MAAM,IAAIr9F,MAAM,oCACpB,CACO,SAAS,EAAO+Q,GAInB,IAAI4sF,EACJ,GAJmB,iBAAR5sF,IACPA,EAAMwsF,EAAUxsF,IAGhBqsF,EAASrsF,GACT4sF,EFvCD,SAAgBC,GACnB,MAAM/gD,EAAU6/C,EAAckB,EAAI/gD,SAClC,IACI,YAAWA,EACf,CACA,MAAO3rC,GACH,MAAM,IAAIlR,MAAM,qBACpB,CACA,MAAO,CACH68C,UACArgB,WAAYohE,EAAIphE,WAAWna,IAAIs6E,GAEvC,CE2BsB,CAAe5rF,OAE5B,KAAIusF,EAASvsF,GAId,MAAM,IAAI/Q,MAAM,2BAHhB29F,EDzCD,SAAgBF,GACnB,MAAMI,EAAS,CACX9nC,WAAY2mC,EAAce,EAAI1nC,YAC9B8mC,UAAWH,EAAce,EAAIZ,WAC7Bz8B,GAAIs8B,EAAce,EAAIr9B,IACtBtlC,IAAK4hE,EAAce,EAAI3iE,MAQ3B,OANI2iE,EAAIK,MACJD,EAAOC,IAAMpB,EAAce,EAAIK,MAC/BL,EAAIC,aACJG,EAAOH,WAAaD,EAAIC,WAAWr7E,IAAI06E,IACvCU,EAAIM,cACJF,EAAOE,YAAcN,EAAIM,aACtBF,CACX,CC2BsB,CAAkB9sF,EAIpC,CACA,OAAO,IAAI9O,WAAW,SAAY07F,GACtC,CACO,SAAS,EAAOz5E,GACnB,IAAI04E,EACJ,IACIA,EAAU,SAAY14E,EAC1B,CACA,MAAOhT,GACH,MAAM,IAAIlR,MAAM,8BACpB,CACA,GAjEQ,YADUq9F,EAkEDT,IAhEbS,EAAKxgD,mBAAmB56C,YACxB,eAAgBo7F,GAChBh9F,MAAMuJ,QAAQyzF,EAAK7gE,YA+DnB,OFnCD,SAAgBogE,GACnB,MAAM33B,EAAU,CACZpoB,QAAS4/C,EAAYG,EAAQ//C,SAC7BrgB,WAAYogE,EAAQpgE,WAAWna,IAAIy6E,IAGvC,OADA73B,EAAQ5I,KAAO,YAAW,IAAIp6D,WAAW26F,EAAQ//C,UAC1CooB,CACX,CE4Be,CAAe23B,GAErB,GA/DT,SAAsBS,GAClB,MAAQ,eAAgBA,GACpBA,EAAKtnC,sBAAsB9zD,YAC3B,OAAQo7F,GACRA,EAAKj9B,cAAcn+D,YACnB,cAAeo7F,GACfA,EAAKR,qBAAqB56F,YAC1B,QAASo7F,GACTA,EAAKviE,eAAe74B,UAC5B,CAsDa+7F,CAAapB,GAClB,ODrCD,SAAgBA,GACnB,MAAMa,EAAM,CACR1nC,WAAY0mC,EAAYG,EAAQ7mC,YAChC8mC,UAAWJ,EAAYG,EAAQC,WAC/Bz8B,GAAIq8B,EAAYG,EAAQx8B,IACxBtlC,IAAK2hE,EAAYG,EAAQ9hE,MAQ7B,OANI8hE,EAAQkB,MACRL,EAAIK,IAAMrB,EAAYG,EAAQkB,MAC9BlB,EAAQc,aACRD,EAAIC,WAAad,EAAQc,WAAWr7E,IAAI86E,IACxCP,EAAQmB,cACRN,EAAIM,YAAcnB,EAAQmB,aACvBN,CACX,CCuBe,CAAkBb,GAGzB,MAAM,IAAI58F,MAAM,+BAzExB,IAAsBq9F,CA2EtB,sECzEA,MAVA,SAAez3F,GACX,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,UAAW,MAAMyW,KAAK9qB,GACzB,EAFM,GAKP,IAAK,MAAM8qB,KAAK9qB,GAExB,aCkCA,MA1CA,SAAgBA,EAAQ6F,GACpB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMM,KAAS3U,QACZ6F,EAAG8O,WACHA,EAGjB,CANM,GASX,MAAM44D,GAAW,OAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GAEf,GAAwB,mBAAbugB,EAAIoO,KACX,OAAO,wBACOpO,UACAvgB,GAEV,UAAW,MAAMiU,KAAS44D,QACZ1nE,EAAG8O,WACHA,EAGjB,CATM,GAWX,MAAM4/B,EAAO1uC,EACb,OAAO,aACS,IAARob,UACMvgB,GAEV,IAAK,MAAMiU,KAAS44D,EACZh5B,EAAK5/B,WACCA,EAGjB,CATM,EAUX,EC1BA,MAhBA,SAAa3U,GACT,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,MAAM3X,EAAM,GACZ,UAAW,MAAMiY,KAAS3U,EACtBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACV,EANM,GAQX,MAAMA,EAAM,GACZ,IAAK,MAAMiY,KAAS3U,EAChBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACX,ECFA,MAZA,SAAcsD,EAAQ0nF,GAClB,OAHsC,MAGlB1nF,EAHP3H,OAAOgc,eAIT,kBACH,MAAM3X,QAAY,EAAIsD,SACftD,EAAIirF,KAAKD,EACnB,CAHM,GAKJ,YACH,MAAMhrF,EAAM,EAAIsD,SACTtD,EAAIirF,KAAKD,EACnB,CAHM,EAIX,ECkBA,MA9BA,SAAc1nF,EAAQgT,GAClB,OAHsC,MAGlBhT,EAHP3H,OAAOgc,eAIT,kBACH,IAAIL,EAAQ,EACZ,KAAIhB,EAAQ,GAGZ,UAAW,MAAM2B,KAAS3U,EAGtB,SAFM2U,EACNX,IACIA,IAAUhB,EACV,MAGX,CAZM,GAcJ,YACH,IAAIgB,EAAQ,EACZ,KAAIhB,EAAQ,GAGZ,IAAK,MAAM2B,KAAS3U,EAGhB,SAFM2U,EACNX,IACIA,IAAUhB,EACV,MAGX,CAZM,EAaX,EC5BO,MAAMqlF,EACTtoF,IAAIC,EAAK/C,EAAKgD,GACV,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACAoI,IAAIwN,EAAKC,GACL,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACAyiB,IAAI7M,EAAKC,GACL,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BACpC,CACA0f,OAAO9J,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,8BACpC,CACA0F,cAAeE,EAAQiQ,EAAU,CAAC,GAC9B,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWV,QACzB6B,KAAKkO,IAAIC,EAAKtP,EAAOuP,SACrBD,CAEd,CACAlQ,cAAeE,EAAQiQ,EAAU,CAAC,GAC9B,UAAW,MAAMD,KAAOhQ,OACd,CACFgQ,MACAtP,YAAamB,KAAKW,IAAIwN,EAAKC,GAGvC,CACAnQ,iBAAkBE,EAAQiQ,EAAU,CAAC,GACjC,UAAW,MAAMD,KAAOhQ,QACd6B,KAAKiY,OAAO9J,EAAKC,SACjBD,CAEd,CACAyH,QACI,IAAIowE,EAAO,GACPC,EAAO,GACX,MAAO,CACH/3E,IAAIC,EAAKtP,GACLmnF,EAAKtuF,KAAK,CAAEyW,MAAKtP,SACrB,EACAoZ,OAAO9J,GACH83E,EAAKvuF,KAAKyW,EACd,EACAoc,OAAQtsB,MAAOmQ,UACL,EAAMpO,KAAKkmF,QAAQF,EAAM53E,IAC/B43E,EAAO,SACD,EAAMhmF,KAAKmmF,WAAWF,EAAM73E,IAClC63E,EAAO,EAAE,EAGrB,CAKAhoF,WAAYo/C,EAAGjvC,GACX,MAAM,IAAI7V,MAAM,2BACpB,CAKA0F,eAAgBo/C,EAAGjvC,GACf,MAAM,IAAI7V,MAAM,+BACpB,CACAyjD,MAAMqB,EAAGjvC,GACL,IAAIg4E,EAAKpmF,KAAKiS,KAAKorC,EAAGjvC,GACtB,GAAgB,MAAZivC,EAAE7jC,OAAgB,CAClB,MAAMA,EAAS6jC,EAAE7jC,OACjB4sE,EAAK,EAAOA,GAAK38E,GAAMA,EAAE0E,IAAIxJ,WAAWo5D,WAAWvkD,IACvD,CAOA,GANI5gB,MAAMuJ,QAAQk7C,EAAEgpC,WAChBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAOyb,EAAIzb,IAAIyb,IAEhDxtF,MAAMuJ,QAAQk7C,EAAEipC,UAChBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAKyb,EAAIzb,IAAIyb,IAEjC,MAAZ/oC,EAAEnmD,OAAgB,CAClB,IAAIoE,EAAI,EACR,MAAMpE,EAASmmD,EAAEnmD,OACjBkvF,EAAK,EAAOA,GAAI,IAAM9qF,KAAOpE,GACjC,CAIA,OAHe,MAAXmmD,EAAElsC,QACFi1E,EAAK,EAAKA,EAAI/oC,EAAElsC,QAEbi1E,CACX,CACAG,UAAUlpC,EAAGjvC,GACT,IAAIg4E,EAAKpmF,KAAKwmF,SAASnpC,EAAGjvC,GAC1B,GAAgB,MAAZivC,EAAE7jC,OAAgB,CAClB,MAAMA,EAAS6jC,EAAE7jC,OACjB4sE,EAAK,EAAOA,GAAKj4E,GAAQA,EAAIxJ,WAAWo5D,WAAWvkD,IACvD,CAOA,GANI5gB,MAAMuJ,QAAQk7C,EAAEgpC,WAChBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAOyb,EAAIzb,IAAIyb,IAEhDxtF,MAAMuJ,QAAQk7C,EAAEipC,UAChBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAKyb,EAAIzb,IAAIyb,IAEjC,MAAZ/oC,EAAEnmD,OAAgB,CAClB,MAAMA,EAASmmD,EAAEnmD,OACjB,IAAIoE,EAAI,EACR8qF,EAAK,EAAOA,GAAI,IAAM9qF,KAAOpE,GACjC,CAIA,OAHe,MAAXmmD,EAAElsC,QACFi1E,EAAK,EAAKA,EAAI/oC,EAAElsC,QAEbi1E,CACX,0SC/GG,SAASqQ,EAAkB7wF,GAE9B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,wBAChB,EAAQqN,EAAK,qBACxB,CACO,SAAS8wF,EAAoB9wF,GAEhC,OADAA,EAAMA,GAAO,IAAIrN,MAAM,iBAChB,EAAQqN,EAAK,uBACxB,CACO,SAAS+wF,EAAmB/wF,GAE/B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,gBAChB,EAAQqN,EAAK,sBACxB,CACO,SAASgxF,EAAkBhxF,GAE9B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,eAChB,EAAQqN,EAAK,qBACxB,CACO,SAAS6/E,EAAc7/E,GAE1B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,aAChB,EAAQqN,EAAK,gBACxB,CACO,SAAS8/E,EAAa9/E,GAEzB,OADAA,EAAMA,GAAO,IAAIrN,MAAM,WAChB,EAAQqN,EAAK,cACxB,qJCvBO,MACMixF,EAAc,8CCGV,IAAI,IAAIA,GC6ClB,MAAMxvB,UAAmB9uE,MAC5B2W,KACAb,KACAvO,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,iBCiEJ,IAIA,EAzHA,SAAeugD,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,ECzHc,IAAI7E,WAAW,GCiB7B,MAAMw1D,EAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,EAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,EAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,EAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,EAAK,CAACI,EAAMC,IAAU,IAAIH,EAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,EAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,EAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,EAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,EAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,EAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,EAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,EAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GD5LG/7B,KACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,ECsLjCyqC,CAAO52B,EAAO0tB,KAC/B,EA4GUi3B,EAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,EAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrCwyD,EAASd,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,ICJFwB,GDOczB,EAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGeD,EAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGkBD,EAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGQD,EAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DUF,EAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,gECDCtf,GDIe4oD,EAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCPUupC,EAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,KAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGUD,EAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGaD,EAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICxBf,eAAsBz/B,GACN,MAALA,EAAY,YAAcihC,EAAUvC,WAAW1+B,GAG1D,eAAsBA,GACN,MAALA,EAAY,YAAcsgC,EAAO5B,WAAW1+B,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcrpB,EAAO+nD,WAAW1+B,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,YAahC,SAAgBtF,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAEhC,UAAc,GAAGA,YAAuF,MAAtE,aAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,EAAM,GAAG6G,YAEdX,OAAO6W,OAAO,EAAMlW,GAAO,CAC9B+gB,MAAO,EAAM,GAAG/gB,WAChB7G,SAER,CCjDYwnE,CAAO,kICFZ,MAAM82B,UAAwB,IACjCr6E,KACA3c,cACI6S,QACA3S,KAAKyc,KAAO,IAAInC,GACpB,CACApM,IAAIC,EAAK/C,GAEL,OADApL,KAAKyc,KAAK5gB,IAAIsS,EAAIxJ,WAAYyG,GACvB+C,CACX,CACAxN,IAAIwN,GACA,MAAMyL,EAAS5Z,KAAKyc,KAAK9b,IAAIwN,EAAIxJ,YACjC,GAAc,MAAViV,EACA,MAAM,kBAEV,OAAOA,CACX,CACAoB,IAAI7M,GACA,OAAOnO,KAAKyc,KAAKzB,IAAI7M,EAAIxJ,WAC7B,CACAsT,OAAO9J,GACHnO,KAAKyc,KAAKxE,OAAO9J,EAAIxJ,WACzB,CACA,QACI,IAAK,MAAOwJ,EAAKtP,KAAUmB,KAAKyc,KAAK5J,eAC3B,CAAE1E,IAAK,IAAI,IAAIA,GAAMtP,QAEnC,CACA,YACI,IAAK,MAAMsP,KAAOnO,KAAKyc,KAAKhV,aAClB,IAAI,IAAI0G,EAEtB,4GChCJ,MAAM4oF,EAAW,IACXC,GAAW,IAAIj+E,aAAchK,OAAOgoF,GACpCE,EAAUD,EAAS,GAiBlB,MAAME,EACT5D,KAKAxzF,YAAYktB,EAAGmqE,GACX,GAAiB,iBAANnqE,EACPhtB,KAAKszF,MAAO,OAAqBtmE,OAEhC,MAAIA,aAAaxyB,YAIlB,MAAM,IAAIjC,MAAM,+CAHhByH,KAAKszF,KAAOtmE,CAIhB,CAOA,GANa,MAATmqE,IACAA,GAAQ,GAERA,GACAn3F,KAAKm3F,QAEoB,IAAzBn3F,KAAKszF,KAAKzmF,YAAoB7M,KAAKszF,KAAK,KAAO2D,EAC/C,MAAM,IAAI1+F,MAAM,cAExB,CAOAoM,SAASsG,EAAW,QAChB,OAAO,OAAmBjL,KAAKszF,KAAMroF,EACzC,CAMAmsF,aACI,OAAOp3F,KAAKszF,IAChB,CAMYx9B,IAAPt/D,OAAOs/D,eACR,MAAO,OAAO91D,KAAK2E,aACvB,CAaAsU,sBAAsB0H,GAClB,OAAO,IAAIu2E,EAAIv2E,EAAKhpB,KAAKo/F,GAC7B,CAYA99E,gBACI,OAAO,IAAIi+E,GAAI,UAASz2F,QAAQ,KAAM,IAC1C,CAIAwY,aAAay8C,GACT,OAAIA,aAAiBl7D,YAA+B,iBAAVk7D,EAE/B,IAAIwhC,EAAIxhC,GAEa,mBAArBA,EAAM0hC,WAEN,IAAIF,EAAIxhC,EAAM0hC,cAElB,IACX,CAMAD,QAII,GAHiB,MAAbn3F,KAAKszF,MAAyC,IAAzBtzF,KAAKszF,KAAKzmF,aAC/B7M,KAAKszF,KAAO0D,GAEZh3F,KAAKszF,KAAK,KAAO2D,EAAS,CAC1B,MAAM1zF,EAAQ,IAAI/I,WAAWwF,KAAKszF,KAAKzmF,WAAa,GACpDtJ,EAAM0T,KAAKggF,EAAS,EAAG,GACvB1zF,EAAM1H,IAAImE,KAAKszF,KAAM,GACrBtzF,KAAKszF,KAAO/vF,CAChB,CAEA,KAAOvD,KAAKszF,KAAKzmF,WAAa,GAAK7M,KAAKszF,KAAKtzF,KAAKszF,KAAKzmF,WAAa,KAAOoqF,GACvEj3F,KAAKszF,KAAOtzF,KAAKszF,KAAKh8F,SAAS,GAAI,EAE3C,CAOA+/F,KAAKlpF,GACD,MAAMmpF,EAAQt3F,KAAK2gB,OACb42E,EAAQppF,EAAIwS,OAClB,IAAK,IAAIrlB,EAAI,EAAGA,EAAIg8F,EAAMrgG,OAAQqE,IAAK,CACnC,GAAIi8F,EAAMtgG,OAASqE,EAAI,EACnB,OAAO,EAEX,MAAMk8F,EAAKF,EAAMh8F,GACXm8F,EAAKF,EAAMj8F,GACjB,GAAIk8F,EAAKC,EACL,OAAO,EAEN,GAAID,EAAKC,EACV,OAAO,CAEf,CACA,OAAOH,EAAMrgG,OAASsgG,EAAMtgG,MAChC,CAYAgkB,UACI,OAAOi8E,EAAIQ,eAAe13F,KAAK2gB,OAAO7nB,QAAQmiB,UAClD,CAMAimB,aACI,OAAOlhC,KAAK2gB,MAChB,CAWAg3E,gBACI,MAAMp1B,EAAKviE,KAAKkhC,aAChB,OAAOqhC,EAAGA,EAAGtrE,OAAS,EAC1B,CAYA0pB,OACI,OAAO3gB,KAAK2E,WAAW1F,MAAM83F,GAAUj+F,MAAM,EACjD,CAYAoW,OACI,OAqJR,SAAuBqzD,GACnB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,GAAI1H,EAAMN,OAAS,EACf,MAAO,GAEX,OAAOM,EAAMuB,MAAM,GAAI,GAAGnB,KAAK,IACnC,CA3JeigG,CAAc53F,KAAK23F,gBAC9B,CAYAt4F,OACI,OAoJR,SAAwBkjE,GACpB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,OAAO1H,EAAMA,EAAMN,OAAS,EAChC,CAvJe4gG,CAAe73F,KAAK23F,gBAC/B,CAaAv+F,SAAS4zB,GACL,OAAO,IAAIkqE,EAAIl3F,KAAK2E,WAAa,IAAMqoB,EAC3C,CAYAgC,OACI,IAAIzzB,EAAIyE,KAAKoZ,SAASzU,WAKtB,OAJKpJ,EAAEu8F,SAASf,KACZx7F,GAAKw7F,GAETx7F,GAAKyE,KAAKkP,OACH,IAAIgoF,EAAI37F,EACnB,CAYA6d,SACI,MAAMuH,EAAO3gB,KAAK2gB,OAClB,OAAoB,IAAhBA,EAAK1pB,OACE,IAAIigG,EAAIH,GAEZ,IAAIG,EAAIv2E,EAAK7nB,MAAM,GAAI,GAAGnB,KAAKo/F,GAC1C,CAaAroD,MAAMvgC,GACF,OAAInO,KAAK2E,aAAeoyF,EACb5oF,EAEFA,EAAIxJ,aAAeoyF,EACjB/2F,KAEJ,IAAIk3F,EAAIl3F,KAAK2E,WAAawJ,EAAIxJ,YAAY,EACrD,CAaAozF,aAAariC,GACT,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB+wD,EAAM/wD,WAAWo5D,WAAW/9D,KAAK2E,WAC5C,CAaAqzF,cAActiC,GACV,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB3E,KAAK2E,WAAWo5D,WAAWrI,EAAM/wD,WAC5C,CAMAszF,aACI,OAA8B,IAAvBj4F,KAAK2gB,OAAO1pB,MACvB,CAOA4iB,UAAUpS,GACN,OAAOyvF,EAAIQ,eAAe,IAAI13F,KAAKkhC,iBAiC1BrmC,EAjCmD4M,EAAKmT,KAAIzM,GAAOA,EAAI+yB,eAkC7E,GAAKrnB,UAAUhf,MAD1B,IAAiBA,CAhCb,iICxWJ,MAAMk8F,EAAW,IACXC,GAAW,IAAIj+E,aAAchK,OAAOgoF,GACpCE,EAAUD,EAAS,GAiBlB,MAAME,EAKTp3F,YAAYktB,EAAGmqE,GACX,GAAiB,iBAANnqE,EACPhtB,KAAKszF,MAAO,OAAqBtmE,OAEhC,MAAIA,aAAaxyB,YAIlB,MAAM,IAAIjC,MAAM,+CAHhByH,KAAKszF,KAAOtmE,CAIhB,CAOA,GANa,MAATmqE,IACAA,GAAQ,GAERA,GACAn3F,KAAKm3F,QAEoB,IAAzBn3F,KAAKszF,KAAKzmF,YAAoB7M,KAAKszF,KAAK,KAAO2D,EAC/C,MAAM,IAAI1+F,MAAM,cAExB,CAOAoM,SAASsG,EAAW,QAChB,OAAO,OAAmBjL,KAAKszF,KAAMroF,EACzC,CAMAmsF,aACI,OAAOp3F,KAAKszF,IAChB,CAMYx9B,IAAPt/D,OAAOs/D,eACR,MAAO,OAAO91D,KAAK2E,aACvB,CAaAsU,sBAAsB0H,GAClB,OAAO,IAAIu2E,EAAIv2E,EAAKhpB,KAAKo/F,GAC7B,CAYA99E,gBACI,OAAO,IAAIi+E,GAAI,UAASz2F,QAAQ,KAAM,IAC1C,CAIAwY,aAAay8C,GACT,OAAIA,aAAiBl7D,YAA+B,iBAAVk7D,EAE/B,IAAIwhC,EAAIxhC,GAEa,mBAArBA,EAAM0hC,WAEN,IAAIF,EAAIxhC,EAAM0hC,cAElB,IACX,CAMAD,QAII,GAHiB,MAAbn3F,KAAKszF,MAAyC,IAAzBtzF,KAAKszF,KAAKzmF,aAC/B7M,KAAKszF,KAAO0D,GAEZh3F,KAAKszF,KAAK,KAAO2D,EAAS,CAC1B,MAAM1zF,EAAQ,IAAI/I,WAAWwF,KAAKszF,KAAKzmF,WAAa,GACpDtJ,EAAM0T,KAAKggF,EAAS,EAAG,GACvB1zF,EAAM1H,IAAImE,KAAKszF,KAAM,GACrBtzF,KAAKszF,KAAO/vF,CAChB,CAEA,KAAOvD,KAAKszF,KAAKzmF,WAAa,GAAK7M,KAAKszF,KAAKtzF,KAAKszF,KAAKzmF,WAAa,KAAOoqF,GACvEj3F,KAAKszF,KAAOtzF,KAAKszF,KAAKh8F,SAAS,GAAI,EAE3C,CAOA+/F,KAAKlpF,GACD,MAAMmpF,EAAQt3F,KAAK2gB,OACb42E,EAAQppF,EAAIwS,OAClB,IAAK,IAAIrlB,EAAI,EAAGA,EAAIg8F,EAAMrgG,OAAQqE,IAAK,CACnC,GAAIi8F,EAAMtgG,OAASqE,EAAI,EACnB,OAAO,EAEX,MAAMk8F,EAAKF,EAAMh8F,GACXm8F,EAAKF,EAAMj8F,GACjB,GAAIk8F,EAAKC,EACL,OAAO,EAEN,GAAID,EAAKC,EACV,OAAO,CAEf,CACA,OAAOH,EAAMrgG,OAASsgG,EAAMtgG,MAChC,CAYAgkB,UACI,OAAOi8E,EAAIQ,eAAe13F,KAAK2gB,OAAO7nB,QAAQmiB,UAClD,CAMAimB,aACI,OAAOlhC,KAAK2gB,MAChB,CAWAg3E,gBACI,MAAMp1B,EAAKviE,KAAKkhC,aAChB,OAAOqhC,EAAGA,EAAGtrE,OAAS,EAC1B,CAYA0pB,OACI,OAAO3gB,KAAK2E,WAAW1F,MAAM83F,GAAUj+F,MAAM,EACjD,CAYAoW,OACI,OAsJR,SAAuBqzD,GACnB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,GAAI1H,EAAMN,OAAS,EACf,MAAO,GAEX,OAAOM,EAAMuB,MAAM,GAAI,GAAGnB,KAAK,IACnC,CA5JeigG,CAAc53F,KAAK23F,gBAC9B,CAYAt4F,OACI,OAqJR,SAAwBkjE,GACpB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,OAAO1H,EAAMA,EAAMN,OAAS,EAChC,CAxJe4gG,CAAe73F,KAAK23F,gBAC/B,CAaAv+F,SAAS4zB,GACL,OAAO,IAAIkqE,EAAIl3F,KAAK2E,WAAa,IAAMqoB,EAC3C,CAYAgC,OACI,IAAIzzB,EAAIyE,KAAKoZ,SAASzU,WAKtB,OAJKpJ,EAAEu8F,SAASf,KACZx7F,GAAKw7F,GAETx7F,GAAKyE,KAAKkP,OACH,IAAIgoF,EAAI37F,EACnB,CAYA6d,SACI,MAAMuH,EAAO3gB,KAAK2gB,OAClB,OAAoB,IAAhBA,EAAK1pB,OACE,IAAIigG,EAAIH,GAEZ,IAAIG,EAAIv2E,EAAK7nB,MAAM,GAAI,GAAGnB,KAAKo/F,GAC1C,CAaAroD,MAAMvgC,GACF,OAAInO,KAAK2E,aAAeoyF,EACb5oF,EAEFA,EAAIxJ,aAAeoyF,EACjB/2F,KAEJ,IAAIk3F,EAAIl3F,KAAK2E,WAAawJ,EAAIxJ,YAAY,EACrD,CAaAozF,aAAariC,GACT,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB+wD,EAAM/wD,WAAWo5D,WAAW/9D,KAAK2E,WAC5C,CAaAqzF,cAActiC,GACV,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB3E,KAAK2E,WAAWo5D,WAAWrI,EAAM/wD,WAC5C,CAOAszF,aACI,OAA8B,IAAvBj4F,KAAK2gB,OAAO1pB,MACvB,CAOA4iB,UAAUpS,GACN,OAAOyvF,EAAIQ,eAAe,IAAI13F,KAAKkhC,iBAiC1BrmC,EAjCmD4M,EAAKmT,KAAIzM,GAAOA,EAAI+yB,eAkC7E,GAAKrnB,UAAUhf,MAD1B,IAAiBA,CAhCb,iBC7TJ,MA1CA,SAAgBsD,EAAQ6F,GACpB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMM,KAAS3U,QACZ6F,EAAG8O,WACHA,EAGjB,CANM,GASX,MAAM44D,GAAW,OAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GAEf,GAAwB,mBAAbugB,EAAIoO,KACX,OAAO,wBACOpO,UACAvgB,GAEV,UAAW,MAAMiU,KAAS44D,QACZ1nE,EAAG8O,WACHA,EAGjB,CATM,GAWX,MAAM4/B,EAAO1uC,EACb,OAAO,aACS,IAARob,UACMvgB,GAEV,IAAK,MAAMiU,KAAS44D,EACZh5B,EAAK5/B,WACCA,EAGjB,CATM,EAUX,EC1BA,MAhBA,SAAa3U,GACT,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,MAAM3X,EAAM,GACZ,UAAW,MAAMiY,KAAS3U,EACtBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACV,EANM,GAQX,MAAMA,EAAM,GACZ,IAAK,MAAMiY,KAAS3U,EAChBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACX,ECFA,MAZA,SAAcsD,EAAQ0nF,GAClB,OAHsC,MAGlB1nF,EAHP3H,OAAOgc,eAIT,kBACH,MAAM3X,QAAY,EAAIsD,SACftD,EAAIirF,KAAKD,EACnB,CAHM,GAKJ,YACH,MAAMhrF,EAAM,EAAIsD,SACTtD,EAAIirF,KAAKD,EACnB,CAHM,EAIX,ECVO,MAAMqS,UAAqB,KAC9BlvE,SACAE,QACAnb,GACAjO,YAAYkpB,EAAUoS,EAAO,CAAC,GAC1BzoB,QACA3S,KAAKgpB,SAAW,GAAGoS,EAAK5hB,QAAU,KAAKwP,IACvChpB,KAAKkpB,QAAUkS,EAAKlS,SAAW,CACnC,CACAjrB,aACI,IACI,MAAM+qB,EAAWhpB,KAAKgpB,SACtBhpB,KAAK+N,SAAW,QAAOib,EAAUhpB,KAAKkpB,QAAS,CAC3Co+D,QAAQv5E,GACJA,EAAG6b,kBAAkBZ,EACzB,GAER,CACA,MAAOpjB,GACH,MAAM,uBAAyBA,EACnC,CACJ,CACA3H,cACI+B,KAAK+N,IAAIwB,OACb,CACAtR,UAAUkQ,EAAK/C,GACX,GAAe,MAAXpL,KAAK+N,GACL,MAAM,IAAIxV,MAAM,iCAEpB,IAEI,aADMyH,KAAK+N,GAAGG,IAAIlO,KAAKgpB,SAAU5d,EAAK+C,EAAIxJ,YACnCwJ,CACX,CACA,MAAOvI,GACH,MAAM,wBAA0BA,EACpC,CACJ,CACA3H,UAAUkQ,GACN,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,iCAEpB,IAAI6S,EACJ,IACIA,QAAYpL,KAAK+N,GAAGpN,IAAIX,KAAKgpB,SAAU7a,EAAIxJ,WAC/C,CACA,MAAOiB,GACH,MAAM,uBAAyBA,EACnC,CACA,QAAY8B,IAAR0D,EACA,MAAM,qBAEV,OAAOA,CACX,CACAnN,UAAUkQ,GACN,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,kCAEpB,IACI,OAAO2M,cAAclF,KAAK+N,GAAGymC,OAAOx0C,KAAKgpB,SAAU7a,EAAIxJ,YAC3D,CACA,MAAOiB,GACH,MAAM,uBAAyBA,EACnC,CACJ,CACA3H,aAAakQ,GACT,GAAe,MAAXnO,KAAK+N,GACL,MAAM,IAAIxV,MAAM,iCAEpB,UACUyH,KAAK+N,GAAGkK,OAAOjY,KAAKgpB,SAAU7a,EAAIxJ,WAC5C,CACA,MAAOiB,GACH,MAAM,wBAA0BA,EACpC,CACJ,CACAgQ,QACI,MAAMowE,EAAO,GACPC,EAAO,GACb,MAAO,CACH/3E,IAAIC,EAAKtP,GACLmnF,EAAKtuF,KAAK,CAAEyW,MAAKtP,SACrB,EACAoZ,OAAO9J,GACH83E,EAAKvuF,KAAKyW,EACd,EACAoc,OAAQtsB,UACJ,GAAe,MAAX+B,KAAK+N,GACL,MAAM,IAAIxV,MAAM,iCAEpB,MAAM4/F,EAAKn4F,KAAK+N,GAAG+b,YAAY9pB,KAAKgpB,SAAU,aAC9C,IACI,MAAMovE,EAAMpS,EAAK9tE,QAAO,EAAG/J,SAE6C,MAA7D83E,EAAK/lB,MAAKm4B,GAAUA,EAAO1zF,aAAewJ,EAAIxJ,eAEpDiW,KAAI1M,GACEjQ,gBACGk6F,EAAGjuE,MAAMhc,IAAIA,EAAIrP,MAAOqP,EAAIC,IAAIxJ,WAAW,IAGpDkV,OAAOosE,EAAKrrE,KAAIzM,GACVlQ,gBACGk6F,EAAGjuE,MAAMjS,OAAO9J,EAAIxJ,WAAW,KAGxCkV,QAAO5b,gBACFk6F,EAAG9/D,IAAI,UAEX7mB,QAAQQ,IAAIomF,EAAIx9E,KAAI3c,MAAOqZ,UAAeA,GAAI,IACxD,CACA,MACI6gF,EAAGjgG,OACP,GAGZ,CACA+F,YAAao/C,GACT,IAAI+oC,EAAKpmF,MAAK,EAASq9C,GAAG,CAAClvC,EAAKtP,KACrB,CAAEsP,MAAKtP,YAEdjG,MAAMuJ,QAAQk7C,EAAEgpC,WAChBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAOyb,EAAIzb,IAAIyb,IAEhDxtF,MAAMuJ,QAAQk7C,EAAEipC,UAChBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAKyb,EAAIzb,IAAIyb,UAE1CA,CACX,CACAnoF,gBAAiBo/C,GACb,IAAI+oC,EAAKpmF,MAAK,EAASq9C,GAAIlvC,GAAQA,IAC/BvV,MAAMuJ,QAAQk7C,EAAEgpC,WAChBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAOyb,EAAIzb,IAAIyb,IAEhDxtF,MAAMuJ,QAAQk7C,EAAEipC,UAChBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAKyb,EAAIzb,IAAIyb,UAE1CA,CACX,CACAnoF,SAAgBo/C,EAAGi7C,GACf,GAAe,MAAXt4F,KAAK+N,GACL,MAAM,IAAIxV,MAAM,iCAEpB,IAAIggG,EAAU,EACVluE,GAAS,EACb,IAAK,MAAMlc,WAAanO,KAAK+N,GAAGud,WAAWtrB,KAAKgpB,UAAW,CACvD,GAAgB,MAAZq0B,EAAE7jC,SAAmBrL,EAAIxJ,WAAWo5D,WAAW1gB,EAAE7jC,QACjD,SAEJ,GAAe,MAAX6jC,EAAElsC,OAAiBonF,IAAYl7C,EAAElsC,MACjC,OAGJ,GADAkZ,IACgB,MAAZgzB,EAAEnmD,QAAkBmzB,EAAQgzB,EAAEnmD,OAC9B,SAEJ,MAAMgc,EAAI,IAAIgkF,EAAI/oF,EAAIxJ,YACtB,IAAI9F,EACJ,IACIA,QAAcmB,KAAKW,IAAIuS,EAC3B,CACA,MAAOtN,GACH,GAAiB,kBAAbA,EAAIyI,KACJ,MAAMzI,EAEV,QACJ,CACa,MAAT/G,UAGEy5F,EAAUplF,EAAGrU,GACnB05F,IACJ,CACJ,CACAt6F,sBACU,QAAS+B,KAAKgpB,SACxB,iGC/JG,SAAS2tE,EAAoB/wF,GAElC,OADAA,EAAMA,GAAO,IAAIrN,MAAM,gBAChB,EAAQqN,EAAK,sBACtB,UCdO,MACMixF,EAAc,WCCpB,MAAM,EAAU,CAACj/D,EAAUiuD,IACzB,kBACL,MAAMlqF,QCXKsC,eAAmBE,GAC9B,MAAMtD,EAAM,GACZ,UAAW,MAAMiY,KAAS3U,EACtBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACX,CDKyB,CAAI+8B,SACjBj8B,EAAOmqF,KAAKD,EACrB,CAHM,wCEUF,MAAM,EAIXpwE,OACE,OAAOjE,QAAQE,OAAO,IAAInZ,MAAM,4BAClC,CAKAgX,QACE,OAAOiC,QAAQE,OAAO,IAAInZ,MAAM,6BAClC,CAQA2V,IAAKC,EAAK/C,EAAKgD,GACb,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAoI,IAAKwN,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAyiB,IAAK7M,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOA0f,OAAQ9J,EAAKC,GACX,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,8BAClC,CAOA0F,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWV,QAC3B6B,KAAKkO,IAAIC,EAAKtP,EAAOuP,QACrB,CAAED,MAAKtP,QAEjB,CAOAZ,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKW,IAAIwN,EAAKC,EAExB,CAOAnQ,iBAAoBE,EAAQiQ,EAAU,CAAC,GACrC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKiY,OAAO9J,EAAKC,SACjBD,CAEV,CAKAyH,QAEE,IAAIowE,EAAO,GAEPC,EAAO,GAEX,MAAO,CACL/3E,IAAKC,EAAKtP,GACRmnF,EAAKtuF,KAAK,CAAEyW,MAAKtP,SACnB,EAEAoZ,OAAQ9J,GACN83E,EAAKvuF,KAAKyW,EACZ,EACAoc,OAAQtsB,MAAOmQ,UACP,OAAMpO,KAAKkmF,QAAQF,EAAM53E,IAC/B43E,EAAO,SACD,OAAMhmF,KAAKmmF,WAAWF,EAAM73E,IAClC63E,EAAO,EAAC,EAGd,CAUAhoF,WAAco/C,EAAGjvC,GACf,MAAM,IAAI7V,MAAM,2BAClB,CAUA0F,eAAkBo/C,EAAGjvC,GACnB,MAAM,IAAI7V,MAAM,+BAClB,CAMAyjD,MAAOqB,EAAGjvC,GACR,IAAIg4E,EAAKpmF,KAAKiS,KAAKorC,EAAGjvC,GAgBtB,GAdgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAK38E,GACfA,EAAE0E,IAAIxJ,WAAWo5D,WAAkC1gB,EAAQ,WAI3DzkD,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAQyb,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAA8B+hD,EAAQ,QAC9D,CAMA,OAJe,MAAXA,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,CAMAG,UAAWlpC,EAAGjvC,GACZ,IAAIg4E,EAAKpmF,KAAKwmF,SAASnpC,EAAGjvC,GAgB1B,GAdgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAKj4E,GACfA,EAAIxJ,WAAWo5D,WAAkC1gB,EAAQ,WAIzDzkD,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAQyb,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAA8B+hD,EAAQ,QAC9D,CAMA,OAJe,MAAXA,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,ECrNe,IAAI,IAAIyQ,GACF,IAAI,IJAF,YKNb,eAAO,8DCeZ,MAAM2B,UAAuB,EAKlC14F,YAAakvB,EAAM+iB,EAAO,CAAC,GACzBp/B,QAGA3S,KAAK+N,GAAqB,iBAATihB,EACb,IAAI,EAAAypE,MAAMzpE,EAAM,IACb+iB,EACHtjC,YAAa,OACbC,cAAe,SAEfsgB,EAGJhvB,KAAK+xC,KAAO,CACV/7B,iBAAiB,EACjB0iF,aAAa,KACV3mD,EAEP,CAEA9zC,aACE,UACQ+B,KAAK+N,GAAG0H,KAAKzV,KAAK+xC,KAC1B,CAAE,MAA0BnsC,GAC1B,MP7CC,SAA4BA,GAEjC,OADAA,EAAMA,GAAO,IAAIrN,MAAM,wBAChB,EAAQqN,EAAK,qBACtB,CO0CY,CAAyBA,EACjC,CACF,CAMA3H,UAAWkQ,EAAKtP,GACd,UACQmB,KAAK+N,GAAGG,IAAIC,EAAIxJ,WAAY9F,EACpC,CAAE,MAA0B+G,GAC1B,MAAM,EAA0BA,EAClC,CACF,CAMA3H,UAAWkQ,GACT,IAAIsO,EACJ,IACEA,QAAazc,KAAK+N,GAAGpN,IAAIwN,EAAIxJ,WAC/B,CAAE,MAA0BiB,GAC1B,GAAIA,EAAIkR,SAAU,MP9CjB,SAAwBlR,GAE7B,OADAA,EAAMA,GAAO,IAAIrN,MAAM,aAChB,EAAQqN,EAAK,gBACtB,CO2C8B,CAAqBA,GAC7C,MAAM,EAA0BA,EAClC,CACA,OAAO6W,CACT,CAMAxe,UAAWkQ,GACT,UACQnO,KAAK+N,GAAGpN,IAAIwN,EAAIxJ,WACxB,CAAE,MAA0BiB,GAC1B,GAAIA,EAAIkR,SAAU,OAAO,EACzB,MAAMlR,CACR,CACA,OAAO,CACT,CAMA3H,aAAckQ,GACZ,UACQnO,KAAK+N,GAAGoB,IAAIhB,EAAIxJ,WACxB,CAAE,MAA0BiB,GAC1B,MP1FC,SAA8BA,GAEnC,OADAA,EAAMA,GAAO,IAAIrN,MAAM,iBAChB,EAAQqN,EAAK,uBACtB,COuFY,CAA2BA,EACnC,CACF,CAEA2J,QACE,OAAOvP,KAAK+N,IAAM/N,KAAK+N,GAAGwB,OAC5B,CAKAqG,QAEE,MAAMwiF,EAAM,GACZ,MAAO,CACLlqF,IAAK,CAACC,EAAKtP,KACTu5F,EAAI1gG,KAAK,CACPwX,KAAM,MACNf,IAAKA,EAAIxJ,WACT9F,MAAOA,GACR,EAEHoZ,OAAS9J,IACPiqF,EAAI1gG,KAAK,CACPwX,KAAM,MACNf,IAAKA,EAAIxJ,YACV,EAEH4lB,OAAQ,IACCvqB,KAAK+N,GAAG6H,MAAMwiF,GAG3B,CAKAp8C,MAAOqB,GACL,IAAI+oC,EAAKpmF,KAAKy9C,OAAO,CACnB9hD,QAAQ,EACR6d,OAAQ6jC,EAAE7jC,SAGR5gB,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAKyb,EAAIzb,IAAIyb,IAG/C,MAAM,OAAElvF,EAAM,MAAEia,GAAUksC,EAC1B,GAAInmD,EAAQ,CACV,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAAOpE,GAC/B,CAMA,OAJIia,IACFi1E,GAAK,OAAKA,EAAIj1E,IAGTi1E,CACT,CAKAG,UAAWlpC,GACT,IAAI+oC,GAAK,OAAIpmF,KAAKy9C,OAAO,CACvB9hD,QAAQ,EACR6d,OAAQ6jC,EAAE7jC,UACR,EAAGrL,SAAUA,IAEbvV,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAKyb,EAAIzb,IAAIyb,IAG/C,MAAM,OAAElvF,EAAM,MAAEia,GAAUksC,EAC1B,GAAInmD,EAAQ,CACV,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAAOpE,GAC/B,CAMA,OAJIia,IACFi1E,GAAK,OAAKA,EAAIj1E,IAGTi1E,CACT,CAQA3oC,OAAQ1L,GAEN,MAAM4mD,EAAe,CACnBlxF,MAAM,EACNgH,YAAa,SACb9S,OAAQo2C,EAAKp2C,QAIf,GAAmB,MAAfo2C,EAAKv4B,OAAgB,CACvB,MAAMA,EAASu4B,EAAKv4B,OAAO7U,WAE3Bg0F,EAAa5+E,IAAMP,EAEnBm/E,EAAaz+E,GAAKV,EAAS,GAC7B,CAEA,MAAM5B,EAAW5X,KAAK+N,GAAG6J,SAAS+gF,GAElC,GAAI/gF,EAASphB,OAAOgc,eAClB,OAiBNvU,gBAA0C26F,GACxC,UAAW,MAAOzqF,EAAKtP,KAAU+5F,OACzB,CAAEzqF,IAAK,IAAI,IAAIA,GAAK,GAAQtP,eAG9B+5F,EAAGrpF,OACX,CAvBaspF,CAAwBjhF,GAIjC,GAAqB,MAAjBA,EAASvM,MAAgC,MAAhBuM,EAASjV,IAEpC,OA6B+Bi2F,EA7BGhhF,EA8B/B,CACL,CAACphB,OAAOgc,eAAe,KACd,CACLnH,KAAM,IAAM,IAAImG,SAAQ,CAACC,EAASC,KAChCknF,EAAGvtF,MAAK,CAACzF,EAAKuI,EAAKtP,IACb+G,EAAY8L,EAAO9L,GACZ,MAAPuI,EACKyqF,EAAGj2F,KAAIiD,IACZ,GAAIA,EAAK,OAAO8L,EAAO9L,GACvB6L,EAAQ,CAAE4mB,MAAM,EAAMx5B,WAAO6I,GAAW,SAG5C+J,EAAQ,CAAE4mB,MAAM,EAAOx5B,MAAO,CAAEsP,IAAK,IAAI,IAAIA,GAAK,GAAQtP,YAC3D,IAEHsrC,OAAQ,IAAM,IAAI34B,SAAQ,CAACC,EAASC,KAClCknF,EAAGj2F,KAAIiD,IACL,GAAIA,EAAK,OAAO8L,EAAO9L,GACvB6L,EAAQ,CAAE4mB,MAAM,EAAMx5B,WAAO6I,GAAW,GACzC,OApBX,IAAqCkxF,EA1BjC,MAAM,IAAIrgG,MAAM,uCAClB,wGC/NK,MACMs+F,EAAc,WCCpB,MAAM,EAAU,CAACj/D,EAAUiuD,IACzB,kBACL,MAAMlqF,QCXKsC,eAAmBE,GAC9B,MAAMtD,EAAM,GACZ,UAAW,MAAMiY,KAAS3U,EACtBtD,EAAInD,KAAKob,GAEb,OAAOjY,CACX,CDKyB,CAAI+8B,SACjBj8B,EAAOmqF,KAAKD,EACrB,CAHM,wCEUF,MAAM,EAIXpwE,OACE,OAAOjE,QAAQE,OAAO,IAAInZ,MAAM,4BAClC,CAKAgX,QACE,OAAOiC,QAAQE,OAAO,IAAInZ,MAAM,6BAClC,CAQA2V,IAAKC,EAAK/C,EAAKgD,GACb,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAoI,IAAKwN,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOAyiB,IAAK7M,EAAKC,GACR,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,2BAClC,CAOA0f,OAAQ9J,EAAKC,GACX,OAAOoD,QAAQE,OAAO,IAAInZ,MAAM,8BAClC,CAOA0F,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWV,QAC3B6B,KAAKkO,IAAIC,EAAKtP,EAAOuP,QACrB,CAAED,MAAKtP,QAEjB,CAOAZ,cAAiBE,EAAQiQ,EAAU,CAAC,GAClC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKW,IAAIwN,EAAKC,EAExB,CAOAnQ,iBAAoBE,EAAQiQ,EAAU,CAAC,GACrC,UAAW,MAAMD,KAAOhQ,QAChB6B,KAAKiY,OAAO9J,EAAKC,SACjBD,CAEV,CAKAyH,QAEE,IAAIowE,EAAO,GAEPC,EAAO,GAEX,MAAO,CACL/3E,IAAKC,EAAKtP,GACRmnF,EAAKtuF,KAAK,CAAEyW,MAAKtP,SACnB,EAEAoZ,OAAQ9J,GACN83E,EAAKvuF,KAAKyW,EACZ,EACAoc,OAAQtsB,MAAOmQ,UACP,OAAMpO,KAAKkmF,QAAQF,EAAM53E,IAC/B43E,EAAO,SACD,OAAMhmF,KAAKmmF,WAAWF,EAAM73E,IAClC63E,EAAO,EAAC,EAGd,CAUAhoF,WAAco/C,EAAGjvC,GACf,MAAM,IAAI7V,MAAM,2BAClB,CAUA0F,eAAkBo/C,EAAGjvC,GACnB,MAAM,IAAI7V,MAAM,+BAClB,CAMAyjD,MAAOqB,EAAGjvC,GACR,IAAIg4E,EAAKpmF,KAAKiS,KAAKorC,EAAGjvC,GAgBtB,GAdgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAK38E,GACfA,EAAE0E,IAAIxJ,WAAWo5D,WAAkC1gB,EAAQ,WAI3DzkD,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAQyb,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAA8B+hD,EAAQ,QAC9D,CAMA,OAJe,MAAXA,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,CAMAG,UAAWlpC,EAAGjvC,GACZ,IAAIg4E,EAAKpmF,KAAKwmF,SAASnpC,EAAGjvC,GAgB1B,GAdgB,MAAZivC,EAAE7jC,SACJ4sE,GAAK,OAAOA,GAAKj4E,GACfA,EAAIxJ,WAAWo5D,WAAkC1gB,EAAQ,WAIzDzkD,MAAMuJ,QAAQk7C,EAAEgpC,WAClBD,EAAK/oC,EAAEgpC,QAAQj3D,QAAO,CAACg3D,EAAIzb,KAAM,OAAOyb,EAAIzb,IAAIyb,IAG9CxtF,MAAMuJ,QAAQk7C,EAAEipC,UAClBF,EAAK/oC,EAAEipC,OAAOl3D,QAAO,CAACg3D,EAAIzb,IAAM,EAAQyb,EAAIzb,IAAIyb,IAGlC,MAAZ/oC,EAAEnmD,OAAgB,CACpB,IAAIoE,EAAI,EACR8qF,GAAK,OAAOA,GAAI,IAAM9qF,KAA8B+hD,EAAQ,QAC9D,CAMA,OAJe,MAAXA,EAAElsC,QACJi1E,GAAK,OAAKA,EAAI/oC,EAAElsC,QAGXi1E,CACT,ECrNe,IAAI,IAAIyQ,GACF,IAAI,IJAF,2BKNb,QAAO,8DCEnB,MAAMj2D,EAAY,WAKX,SAASk4D,EAAc/9F,GAC5B,OAAO,OAAmBA,EAAK,SACjC,CAOO,SAASg+F,EAAY5qF,IAGP,iBAARA,GAAoBA,aAAehX,UAC5CgX,GAAM,OAAqBA,EAAIxJ,aAGjC,MAAMq0F,GAAS,OAAmB7qF,EAAK,aAEvC,MAAO,GAAGyyB,IAAYo4D,GACxB,gBCzBA,MAAM,GAAM,QAAO,8BAWZ,MAAMC,UAAwB,EAYnCn5F,YAAao5F,EAAQnS,EAAWjoB,EAAQq6B,EAAWC,EAAUC,GAG3D,GAFA1mF,SAEKwmF,EACH,MAAM,IAAI,IAAU,oBAAqB,0BAG3C,GAAyB,mBAAdA,EACT,MAAM,IAAI,IAAU,4BAA6B,0BAGnD,GAAwB,mBAAbC,EACT,MAAM,IAAI,IAAU,0BAA2B,0BAGjD,GAAIC,GAAkD,mBAAtBA,EAC9B,MAAM,IAAI,IAAU,qCAAsC,0BAG5Dr5F,KAAKs5F,QAAUJ,EACfl5F,KAAKu5F,WAAaxS,EAClB/mF,KAAKw5F,QAAU16B,EACf9+D,KAAKy5F,WAAaN,EAClBn5F,KAAK05F,UAAYN,EACjBp5F,KAAK25F,yBAA2BN,EAGhCr5F,KAAK45F,WAAa55F,KAAK45F,WAAWx9F,KAAK4D,MACvCA,KAAKs5F,QAAQnxE,iBAAiB,UAAWnoB,KAAK45F,WAChD,CAUA37F,UAAWkQ,EAAK/C,EAAKgD,GACnB,KAAMD,aAAe3T,YAAa,CAChC,MAAMq/F,EAAS,6CAGf,MADA,EAAIz5E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,4BAC9B,CAEA,KAAMzuF,aAAe5Q,YAAa,CAChC,MAAMq/F,EAAS,qCAGf,MADA,EAAIz5E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,6BAC9B,CAEA,MAAMC,EAAmBf,EAAW5qF,GAEpC,EAAI,2BAA2B2rF,WAGzB95F,KAAKs5F,QAAQS,QAAQD,EAAkB1uF,EAC/C,CASAnN,UAAWkQ,EAAKC,GACd,KAAMD,aAAe3T,YAAa,CAChC,MAAMq/F,EAAS,6CAGf,MADA,EAAIz5E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,4BAC9B,CAEA,MAAMC,EAAmBf,EAAW5qF,GAC9Bk1C,QAAsBrjD,KAAKs5F,QAAQU,YAGzC,GAAI32C,GAAiBzqD,MAAMuJ,QAAQkhD,IAAkBA,EAAc9jD,QAAQu6F,IAAqB,EAC9F,OAAO95F,KAAKi6F,UAAU9rF,EAAKC,GAI7B,UACQpO,KAAKs5F,QAAQt1C,UAAU81C,EAC/B,CAAE,MAA0Bl0F,GAC1B,MAAMi0F,EAAS,0BAA0BC,IAGzC,MADA,EAAI15E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,wBAC9B,CAGA,OAFA,EAAI,6BAA6BC,KAE1B95F,KAAKi6F,UAAU9rF,EACxB,CAQA+rF,YAAa/rF,GACX,MAAM2rF,EAAmBf,EAAW5qF,GAEpC,OAAOnO,KAAKs5F,QAAQY,YAAYJ,EAClC,CASA77F,gBAAiBkQ,EAAKC,GAEpB,MAAM+rF,EAAa,IAAI,IAAI,IAAMrB,EAAa3qF,IAAM,GACpD,IAAIisF,EAEJ,IACEA,QAAcp6F,KAAKu5F,WAAW54F,IAAIw5F,EAAY/rF,EAChD,CAAE,MAA0BxI,GAC1B,GAAiB,kBAAbA,EAAIyI,KAA0B,CAChC,MAAMwrF,EAAS,gDAAgDM,EAAWx1F,aAG1E,MADA,EAAIyb,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,sCAC9B,CACA,MAAMA,EAAS,4CAA4CM,EAAWx1F,aAGtE,MADA,EAAIyb,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,gBAC9B,CAEA,KAAMO,aAAiB5/F,YAAa,CAClC,MAAMq/F,EAAS,mDAGf,MADA,EAAIz5E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,8BAC9B,CAEA,OAAOO,CACT,CAOAn8F,iBAAkBqxC,GAChB,MAAMroB,EAAMqoB,EAAI+qD,OAEhB,GAAiB,WAAbpzE,EAAI/X,KAEN,YADA,EAAIkR,MAAM,6EAIZ,MAAM,KAAE3D,EAAI,KAAEjW,EAAI,MAAEgwC,GAAUvvB,EAC9B,IAAI9Y,EACJ,IACEA,ED3JC,SAAqBqoC,GAC1B,GAAIA,EAAM/2C,UAAU,EAAGmhC,EAAU3pC,UAAY2pC,EAC3C,MAAM,IAAI,IAAU,sCAAuC,0CAG7D,MAAMzyB,EAAMqoC,EAAM/2C,UAAUmhC,EAAU3pC,QAEtC,OAAO,OAAqBkX,EAAK,YACnC,CCmJYmsF,CAAW9jD,EACnB,CAAE,MAA0B5wC,GAE1B,YADA,EAAIwa,MAAMxa,EAEZ,CAKA,GAHA,EAAI,8BAA8B4wC,KAG9Bx2C,KAAKw5F,QAAQx4E,OAAOxa,GACtB,EAAI,qDADN,CAKA,GAAIxG,KAAK25F,yBAA0B,CACjC,IAAIv6E,EAEJ,IACEA,QAAYpf,KAAK25F,yBAAyBxrF,EAC5C,CAAE,MAA0BvI,GAE1B,YADA,EAAIwa,MAAM,6CAEZ,CAEAjS,EAAMiR,CACR,CAEA,UACQpf,KAAKu6F,6BAA6BpsF,EAAKsO,EAC/C,CAAE,MAA0B7W,GAC1B,EAAIwa,MAAMxa,EACZ,CAnBA,CAoBF,CASA3H,mCAAoCkQ,EAAKsO,EAAMrO,GAC7C,IAAIosF,GAAW,EAEf,IACEA,QAAiBx6F,KAAKy6F,UAAUtsF,EAAKsO,EACvC,CAAE,MAA0B7W,GAC1B,GAAiB,yBAAbA,EAAIyI,KACN,MAAMzI,CAEV,CAEI40F,SACIx6F,KAAK06F,aAAavsF,EAAKsO,EAAMrO,EAEvC,CAQAnQ,sBAAuBkQ,EAAKtP,GAC1B,OAAOmB,KAAKy5F,WAAWtrF,EAAKtP,EAC9B,CAQAZ,oBAAqBkQ,EAAKwsF,GAIxB,OAAe,UAHG36F,KAAK05F,UAAUvrF,EAAKwsF,EAIxC,CAQA18F,gBAAiBkQ,EAAK/C,GACpB,UACQpL,KAAK46F,gBAAgBzsF,EAAK/C,EAClC,CAAE,MAA0BxF,GAE1B,MAAMi0F,EAAS,8CAGf,MADA,EAAIz5E,MAAMy5E,GACJ,IAAI,IAAUA,EAAQ,uBAC9B,CAGA,MAAMgB,EAAQ,IAAI,IAAI1sF,GACtB,IAAI2sF,EAEJ,IACEA,QAAsB96F,KAAKi6F,UAAUY,EAAMzD,aAC7C,CAAE,MAA0BxxF,GAE1B,OAAO,CACT,CAGA,QAAI,OAAiBk1F,EAAe1vF,IAK7BpL,KAAK+6F,cAAc5sF,EAAK,CAAC2sF,EAAe1vF,GACjD,CASAnN,mBAAoBkQ,EAAKsO,EAAMrO,GAE7B,MAAM+rF,EAAa,IAAI,IAAI,IAAMrB,EAAa3qF,IAAM,SAE9CnO,KAAKu5F,WAAWrrF,IAAIisF,EAAY19E,EAAMrO,GAC5C,EAAI,cAAc2qF,EAAW5qF,iCAC/B,iGCpUF,MAAM6sF,EAAclzE,WAAW0P,MACzByjE,EAAgBnzE,WAAWwQ,QACXxQ,WAAWwS,QACVxS,WAAW9pB,SCC3B,SAASk9F,EAAcC,EAAgBC,EAAUC,GACpD,MAAO,GAAGF,UAAuBC,UAAiBC,GACtD,CAIOp9F,eAAesH,EAAQkR,EAAUwR,GACpC,MAAMmB,QAAY,EAAY3S,EAAU,CACpC8hB,QAAS,IAAI,EAAQ,CACjB+iE,OAAQ,yBAEZrzE,WAGJ,aADkBmB,EAAIpe,MAE1B,CAOO,SAASuwF,EAAYH,EAAUC,GAClC,MAAO,GAAGA,KAAcD,GAC5B,CCzBA,MAAMziG,EAAM+F,OAAO6W,OAAO,EAAM,0BAA2B,CACvD6K,MAAO,EAAM,kCAuMjB,MAjMA,MAOItgB,YAAYsO,EAAU,CAAC,GACnBpO,KAAKkvC,OAAS,IAAI,EAAW,CAAEhuB,IAAK9S,GAASotF,UAAY,MACzDx7F,KAAKy7F,UAAY,IAAI,EAAW,CAAEv6E,IAAK9S,GAASotF,UAAY,MAC5Dx7F,KAAK07F,SAAW,CACZ,uCACA,8BAEJ17F,KAAK27F,SAAWvtF,EAAQ7I,SAAW,EACnCvF,KAAK47F,kBAAoB,EAC7B,CAKAtlF,SACItW,KAAK47F,kBAAkBx7F,SAAQynB,GAAcA,EAAW3vB,SAC5D,CAKA2jG,aACI,OAAO77F,KAAK07F,QAChB,CAKAI,sBACI,MAAMC,EAAa,IAAI/7F,KAAK07F,UAC5B,IAAK,IAAIpgG,EAAIygG,EAAW9kG,OAAS,EAAGqE,EAAI,EAAGA,IAAK,CAC5C,MAAM8iB,EAAInlB,KAAKiQ,MAAMjQ,KAAKy4B,SAAWp2B,GAC/B2qC,EAAO81D,EAAWzgG,GACxBygG,EAAWzgG,GAAKygG,EAAW39E,GAC3B29E,EAAW39E,GAAK6nB,CACpB,CACA,OAAO81D,CACX,CAMAC,WAAWC,GACPj8F,KAAK07F,SAAWO,CACpB,CAOAh+F,cAAcm9F,EAAUc,EAAS,KAC7B,OAAQA,GACJ,IAAK,IACD,aAAal8F,KAAKm8F,SAASf,GAC/B,IAAK,OACD,aAAap7F,KAAKo8F,SAAShB,GAC/B,IAAK,MACD,aAAap7F,KAAKq8F,WAAWjB,GACjC,QACI,MAAM,IAAI7iG,MAAM,GAAG2jG,sBAE/B,CAMAj+F,eAAem9F,GACX,MAAMC,EAAa,IACbiB,EAASt8F,KAAKkvC,OAAOvuC,IAAI,EAAkBy6F,EAAUC,IAC3D,GAAc,MAAViB,EACA,OAAOA,EAEX,IAAIl0E,GAAU,EACd,IAAK,MAAMm0E,KAAUv8F,KAAK87F,sBAAuB,CAC7C,MAAMj0E,EAAa,IAAIE,gBACvB/nB,KAAK47F,kBAAkBlkG,KAAKmwB,GAC5B,IACI,MAAMhiB,QAAiB7F,KAAK27F,SAAS,EAAoBY,EAAQnB,EAAUC,GAAaxzE,EAAWI,QAC7FxL,EAAO5W,EAAS22F,OAAO5hF,KAAI6F,GAAKA,EAAEhE,OAClCggF,EAAMxjG,KAAKyL,OAAOmB,EAAS22F,OAAO5hF,KAAI6F,GAAKA,EAAEi8E,OAEnD,OADA18F,KAAKkvC,OAAOrzC,IAAI,EAAkBu/F,EAAUC,GAAa5+E,EAAM,CAAEggF,QAC1DhgF,CACX,CACA,MAAO7W,GACCiiB,EAAWI,OAAOG,UAClBA,GAAU,GAEdzvB,EAAIynB,MAAM,GAAGm8E,uBAA4BnB,YAAmBC,IAChE,CACA,QACIr7F,KAAK47F,kBAAoB57F,KAAK47F,kBAAkB1jF,QAAO+G,GAAKA,IAAM4I,GACtE,CACJ,CACA,GAAIO,EACA,MAAM1pB,OAAO6W,OAAO,IAAIhd,MAAM,qBAAsB,CAChD8V,KAAM,eAGd,MAAM,IAAI9V,MAAM,qBAAqB6iG,YAAmBC,IAC5D,CAMAp9F,eAAem9F,GACX,MAAMC,EAAa,OACbiB,EAASt8F,KAAKkvC,OAAOvuC,IAAI,EAAkBy6F,EAAUC,IAC3D,GAAc,MAAViB,EACA,OAAOA,EAEX,IAAIl0E,GAAU,EACd,IAAK,MAAMm0E,KAAUv8F,KAAK87F,sBAAuB,CAC7C,MAAMj0E,EAAa,IAAIE,gBACvB/nB,KAAK47F,kBAAkBlkG,KAAKmwB,GAC5B,IACI,MAAMhiB,QAAiB7F,KAAK27F,SAAS,EAAoBY,EAAQnB,EAAUC,GAAaxzE,EAAWI,QAC7FxL,EAAO5W,EAAS22F,OAAO5hF,KAAI6F,GAAKA,EAAEhE,OAClCggF,EAAMxjG,KAAKyL,OAAOmB,EAAS22F,OAAO5hF,KAAI6F,GAAKA,EAAEi8E,OAEnD,OADA18F,KAAKkvC,OAAOrzC,IAAI,EAAkBu/F,EAAUC,GAAa5+E,EAAM,CAAEggF,QAC1DhgF,CACX,CACA,MAAO7W,GACCiiB,EAAWI,OAAOG,UAClBA,GAAU,GAEdzvB,EAAIynB,MAAM,GAAGm8E,uBAA4BnB,YAAmBC,IAChE,CACA,QACIr7F,KAAK47F,kBAAoB57F,KAAK47F,kBAAkB1jF,QAAO+G,GAAKA,IAAM4I,GACtE,CACJ,CACA,GAAIO,EACA,MAAM1pB,OAAO6W,OAAO,IAAIhd,MAAM,wBAAyB,CACnD8V,KAAM,eAGd,MAAM,IAAI9V,MAAM,qBAAqB6iG,YAAmBC,IAC5D,CAMAp9F,iBAAiBm9F,GACb,MAAMC,EAAa,MACbiB,EAASt8F,KAAKy7F,UAAU96F,IAAI,EAAkBy6F,EAAUC,IAC9D,GAAc,MAAViB,EACA,OAAOA,EAEX,IAAIl0E,GAAU,EACd,IAAK,MAAMm0E,KAAUv8F,KAAK87F,sBAAuB,CAC7C,MAAMj0E,EAAa,IAAIE,gBACvB/nB,KAAK47F,kBAAkBlkG,KAAKmwB,GAC5B,IACI,MAAMhiB,QAAiB7F,KAAK27F,SAAS,EAAoBY,EAAQnB,EAAUC,GAAaxzE,EAAWI,QAC7FxL,EAAO5W,EAAS22F,OAAO5hF,KAAI6F,GAAK,CAACA,EAAEhE,KAAKhc,QAAQ,SAAU,OAC1Dg8F,EAAMxjG,KAAKyL,OAAOmB,EAAS22F,OAAO5hF,KAAI6F,GAAKA,EAAEi8E,OAEnD,OADA18F,KAAKy7F,UAAU5/F,IAAI,EAAkBu/F,EAAUC,GAAa5+E,EAAM,CAAEggF,QAC7DhgF,CACX,CACA,MAAO7W,GACCiiB,EAAWI,OAAOG,UAClBA,GAAU,GAEdzvB,EAAIynB,MAAM,GAAGm8E,uBAA4BnB,YAAmBC,IAChE,CACA,QACIr7F,KAAK47F,kBAAoB57F,KAAK47F,kBAAkB1jF,QAAO+G,GAAKA,IAAM4I,GACtE,CACJ,CACA,GAAIO,EACA,MAAM1pB,OAAO6W,OAAO,IAAIhd,MAAM,uBAAwB,CAClD8V,KAAM,eAGd,MAAM,IAAI9V,MAAM,qBAAqB6iG,YAAmBC,IAC5D,CACAsB,aACI38F,KAAKkvC,OAAO7/B,QACZrP,KAAKy7F,UAAUpsF,OACnB,gJCzMJ,MAAMutF,EAAel+F,OAAOC,OAAO,MACnCi+F,EAAmB,KAAI,IACvBA,EAAoB,MAAI,IACxBA,EAAmB,KAAI,IACvBA,EAAmB,KAAI,IACvBA,EAAsB,QAAI,IAC1BA,EAAsB,QAAI,IAC1BA,EAAmB,KAAI,IACvB,MAAMC,EAAuBn+F,OAAOC,OAAO,MAC3CD,OAAO+I,KAAKm1F,GAAcx8F,SAAQ+N,IAC9B0uF,EAAqBD,EAAazuF,IAAQA,CAAG,IAEjD,MAAM2uF,EAAe,CAAE5tF,KAAM,QAASuN,KAAM,gBCXtCsgF,EAAiC,mBAATjlE,MACT,oBAATA,MACqC,6BAAzCp5B,OAAO7F,UAAU8L,SAAS5L,KAAK++B,MACjCklE,EAA+C,mBAAhBnhF,YA4B/BohF,EAAqB,CAACxgF,EAAMjX,KAC9B,MAAM03F,EAAa,IAAInkE,WAKvB,OAJAmkE,EAAWrkE,OAAS,WAChB,MAAM66C,EAAUwpB,EAAWtjF,OAAO3a,MAAM,KAAK,GAC7CuG,EAAS,KAAOkuE,GAAW,IAC/B,EACOwpB,EAAWC,cAAc1gF,EAAK,EAEzC,MA7BqB,EAAGvN,OAAMuN,QAAQ2gF,EAAgB53F,KAClD,OAAIu3F,GAAkBtgF,aAAgBqb,KAC9BslE,EACO53F,EAASiX,GAGTwgF,EAAmBxgF,EAAMjX,GAG/Bw3F,IACJvgF,aAAgBZ,cAfVvS,EAegCmT,EAdN,mBAAvBZ,YAAYC,OACpBD,YAAYC,OAAOxS,GACnBA,GAAOA,EAAI3S,kBAAkBklB,cAa3BuhF,EACO53F,EAASiX,GAGTwgF,EAAmB,IAAInlE,KAAK,CAACrb,IAAQjX,GAI7CA,EAASo3F,EAAa1tF,IAASuN,GAAQ,KAxBnCnT,KAwBuC,EC7BtD,MAAM0wB,EAAQ,mEAERqjE,EAA+B,oBAAf7iG,WAA6B,GAAK,IAAIA,WAAW,KACvE,IAAK,IAAIc,EAAI,EAAGA,EAAI0+B,EAAM/iC,OAAQqE,IAC9B+hG,EAAOrjE,EAAMx+B,WAAWF,IAAMA,EAE3B,MCLD,EAA+C,mBAAhBugB,YA4B/ByhF,EAAqB,CAAC7gF,EAAM8gF,KAC9B,GAAI,EAAuB,CACvB,MAAM//B,EDTQ,CAACt1D,IACnB,IAA8D5M,EAAUkiG,EAAUC,EAAUC,EAAUC,EAAlGC,EAA+B,IAAhB11F,EAAOjR,OAAe+E,EAAMkM,EAAOjR,OAAWsE,EAAI,EACnC,MAA9B2M,EAAOA,EAAOjR,OAAS,KACvB2mG,IACkC,MAA9B11F,EAAOA,EAAOjR,OAAS,IACvB2mG,KAGR,MAAMC,EAAc,IAAIhiF,YAAY+hF,GAAer6F,EAAQ,IAAI/I,WAAWqjG,GAC1E,IAAKviG,EAAI,EAAGA,EAAIU,EAAKV,GAAK,EACtBkiG,EAAWH,EAAOn1F,EAAO1M,WAAWF,IACpCmiG,EAAWJ,EAAOn1F,EAAO1M,WAAWF,EAAI,IACxCoiG,EAAWL,EAAOn1F,EAAO1M,WAAWF,EAAI,IACxCqiG,EAAWN,EAAOn1F,EAAO1M,WAAWF,EAAI,IACxCiI,EAAMhI,KAAQiiG,GAAY,EAAMC,GAAY,EAC5Cl6F,EAAMhI,MAAoB,GAAXkiG,IAAkB,EAAMC,GAAY,EACnDn6F,EAAMhI,MAAoB,EAAXmiG,IAAiB,EAAiB,GAAXC,EAE1C,OAAOE,CAAW,ECTEzxF,CAAOqQ,GACvB,OAAOqhF,EAAUtgC,EAAS+/B,EAC9B,CAEI,MAAO,CAAEr1F,QAAQ,EAAMuU,OAC3B,EAEEqhF,EAAY,CAACrhF,EAAM8gF,IAEZ,SADDA,GAEO9gF,aAAgBZ,YAAc,IAAIic,KAAK,CAACrb,IAGxCA,EAGnB,MA7CqB,CAACshF,EAAeR,KACjC,GAA6B,iBAAlBQ,EACP,MAAO,CACH7uF,KAAM,UACNuN,KAAMqhF,EAAUC,EAAeR,IAGvC,MAAMruF,EAAO6uF,EAAczzF,OAAO,GAClC,GAAa,MAAT4E,EACA,MAAO,CACHA,KAAM,UACNuN,KAAM6gF,EAAmBS,EAAct+F,UAAU,GAAI89F,IAI7D,OADmBV,EAAqB3tF,GAIjC6uF,EAAc9mG,OAAS,EACxB,CACEiY,KAAM2tF,EAAqB3tF,GAC3BuN,KAAMshF,EAAct+F,UAAU,IAEhC,CACEyP,KAAM2tF,EAAqB3tF,IARxB4tF,CASN,EC1BT,MAAMkB,EAAY7mG,OAAOC,aAAa,mBCF/B,MAAM6mG,EACW,oBAATx4F,KACAA,KAEgB,oBAAXkD,OACLA,OAGAkiC,SAAS,cAATA,GCPR,SAASqzD,EAAK50F,KAAQ60F,GACzB,OAAOA,EAAK/uE,QAAO,CAACtd,EAAKoB,KACjB5J,EAAIvK,eAAemU,KACnBpB,EAAIoB,GAAK5J,EAAI4J,IAEVpB,IACR,CAAC,EACR,CAEA,MAAMssF,EAAqB,aACrBC,EAAuB,eACtB,SAASC,EAAsBh1F,EAAKyoC,GACnCA,EAAKwsD,iBACLj1F,EAAIk1F,aAAeJ,EAAmBhiG,KAAK,GAC3CkN,EAAIm1F,eAAiBJ,EAAqBjiG,KAAK,KAG/CkN,EAAIk1F,aAAe,kBAA2B,GAC9Cl1F,EAAIm1F,eAAiB,oBAA6B,GAE1D,CClBA,MAAMC,UAAuBnmG,MACzBuH,YAAYivE,EAAQ4vB,EAAatxD,GAC7B16B,MAAMo8D,GACN/uE,KAAK2+F,YAAcA,EACnB3+F,KAAKqtC,QAAUA,EACfrtC,KAAKkP,KAAO,gBAChB,EAEG,MAAM0vF,UAAkB,IAO3B9+F,YAAYiyC,GACRp/B,QACA3S,KAAKE,UAAW,EAChBo+F,EAAsBt+F,KAAM+xC,GAC5B/xC,KAAK+xC,KAAOA,EACZ/xC,KAAKg8C,MAAQjK,EAAKiK,MAClBh8C,KAAK6+F,OAAS9sD,EAAK8sD,MACvB,CAUAC,QAAQ/vB,EAAQ4vB,EAAatxD,GAEzB,OADA16B,MAAMosF,aAAa,QAAS,IAAIL,EAAe3vB,EAAQ4vB,EAAatxD,IAC7DrtC,IACX,CAIAyV,OAGI,OAFAzV,KAAKi8B,WAAa,UAClBj8B,KAAKg/F,SACEh/F,IACX,CAIAuP,QAKI,MAJwB,YAApBvP,KAAKi8B,YAAgD,SAApBj8B,KAAKi8B,aACtCj8B,KAAKi/F,UACLj/F,KAAKk/F,WAEFl/F,IACX,CAMAk8B,KAAKijE,GACuB,SAApBn/F,KAAKi8B,YACLj8B,KAAKqM,MAAM8yF,EAKnB,CAMAC,SACIp/F,KAAKi8B,WAAa,OAClBj8B,KAAKE,UAAW,EAChByS,MAAMosF,aAAa,OACvB,CAOAM,OAAO5iF,GACH,MAAM25B,EAAS,EAAa35B,EAAMzc,KAAK6+F,OAAOtB,YAC9Cv9F,KAAKs/F,SAASlpD,EAClB,CAMAkpD,SAASlpD,GACLzjC,MAAMosF,aAAa,SAAU3oD,EACjC,CAMA8oD,QAAQK,GACJv/F,KAAKi8B,WAAa,SAClBtpB,MAAMosF,aAAa,QAASQ,EAChC,CAMAC,MAAMC,GAAW,EC9GrB,MAAMj4E,EAAW,mEAAmEvoB,MAAM,IAAK,EAAS,GAAI2b,EAAM,CAAC,EACnH,IAAqBmoB,EAAjB8qB,EAAO,EAAGvyD,EAAI,EAQX,SAAS,EAAOqrC,GACnB,IAAIwuD,EAAU,GACd,GACIA,EAAU3tE,EAASmf,EAAM,GAAUwuD,EACnCxuD,EAAM1tC,KAAKiQ,MAAMy9B,EAAM,SAClBA,EAAM,GACf,OAAOwuD,CACX,CAqBO,SAASuK,IACZ,MAAMroD,EAAM,GAAQ,IAAIn+C,MACxB,OAAIm+C,IAAQtU,GACD8qB,EAAO,EAAG9qB,EAAOsU,GACrBA,EAAM,IAAM,EAAOwW,IAC9B,CAIA,KAAOvyD,EAAI,EAAQA,IACfsf,EAAI4M,EAASlsB,IAAMA,ECzChB,SAAS,EAAOgO,GACnB,IAAIjO,EAAM,GACV,IAAK,IAAIC,KAAKgO,EACNA,EAAIvK,eAAezD,KACfD,EAAIpE,SACJoE,GAAO,KACXA,GAAOskG,mBAAmBrkG,GAAK,IAAMqkG,mBAAmBr2F,EAAIhO,KAGpE,OAAOD,CACX,CCjBA,IAAIwD,GAAQ,EACZ,IACIA,EAAkC,oBAAnBy8B,gBACX,oBAAqB,IAAIA,cACjC,CACA,MAAO11B,GAGP,CACO,MAAMg6F,EAAU/gG,ECPhB,SAASghG,EAAI9tD,GAChB,MAAM+tD,EAAU/tD,EAAK+tD,QAErB,IACI,GAAI,oBAAuBxkE,kBAAoBwkE,GAAWF,GACtD,OAAO,IAAItkE,cAEnB,CACA,MAAO7xB,GAAK,CACZ,IAAKq2F,EACD,IACI,OAAO,IAAI,EAAW,CAAC,UAAUjmF,OAAO,UAAUliB,KAAK,OAAM,oBACjE,CACA,MAAO8R,GAAK,CAEpB,CCVA,SAASsM,IAAU,CACnB,MAAMgqF,EAIK,MAHK,IAAI,EAAe,CAC3BD,SAAS,IAEMhkE,aA8NhB,MAAMxB,UAAgB,IAOzBx6B,YAAYmuC,EAAK8D,GACbp/B,QACA2rF,EAAsBt+F,KAAM+xC,GAC5B/xC,KAAK+xC,KAAOA,EACZ/xC,KAAKoF,OAAS2sC,EAAK3sC,QAAU,MAC7BpF,KAAKiuC,IAAMA,EACXjuC,KAAK/B,OAAQ,IAAU8zC,EAAK9zC,MAC5B+B,KAAKyc,UAAO/U,IAAcqqC,EAAKt1B,KAAOs1B,EAAKt1B,KAAO,KAClDzc,KAAKrB,QACT,CAMAA,SACI,MAAMozC,EAAOmsD,EAAKl+F,KAAK+xC,KAAM,QAAS,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,aACjHA,EAAK+tD,UAAY9/F,KAAK+xC,KAAKiuD,GAC3BjuD,EAAKkuD,UAAYjgG,KAAK+xC,KAAKmuD,GAC3B,MAAM7kE,EAAOr7B,KAAKq7B,IAAM,IAAI,EAAe0W,GAC3C,IACI1W,EAAI5lB,KAAKzV,KAAKoF,OAAQpF,KAAKiuC,IAAKjuC,KAAK/B,OACrC,IACI,GAAI+B,KAAK+xC,KAAKouD,aAAc,CACxB9kE,EAAI+kE,uBAAyB/kE,EAAI+kE,uBAAsB,GACvD,IAAK,IAAI9kG,KAAK0E,KAAK+xC,KAAKouD,aAChBngG,KAAK+xC,KAAKouD,aAAaphG,eAAezD,IACtC+/B,EAAIU,iBAAiBzgC,EAAG0E,KAAK+xC,KAAKouD,aAAa7kG,GAG3D,CACJ,CACA,MAAOmO,GAAK,CACZ,GAAI,SAAWzJ,KAAKoF,OAChB,IACIi2B,EAAIU,iBAAiB,eAAgB,2BACzC,CACA,MAAOtyB,GAAK,CAEhB,IACI4xB,EAAIU,iBAAiB,SAAU,MACnC,CACA,MAAOtyB,GAAK,CAER,oBAAqB4xB,IACrBA,EAAIQ,gBAAkB77B,KAAK+xC,KAAKlW,iBAEhC77B,KAAK+xC,KAAKsuD,iBACVhlE,EAAIs0C,QAAU3vE,KAAK+xC,KAAKsuD,gBAE5BhlE,EAAIW,mBAAqB,KACjB,IAAMX,EAAIY,aAEV,MAAQZ,EAAI1mB,QAAU,OAAS0mB,EAAI1mB,OACnC3U,KAAKsgG,SAKLtgG,KAAKw+F,cAAa,KACdx+F,KAAK8+F,QAA8B,iBAAfzjE,EAAI1mB,OAAsB0mB,EAAI1mB,OAAS,EAAE,GAC9D,GACP,EAEJ0mB,EAAIa,KAAKl8B,KAAKyc,KAClB,CACA,MAAOhT,GAOH,YAHAzJ,KAAKw+F,cAAa,KACdx+F,KAAK8+F,QAAQr1F,EAAE,GAChB,EAEP,CACwB,oBAAbm4B,WACP5hC,KAAKqqB,MAAQiQ,EAAQimE,gBACrBjmE,EAAQkmE,SAASxgG,KAAKqqB,OAASrqB,KAEvC,CAMA8+F,QAAQl5F,GACJ5F,KAAK++F,aAAa,QAASn5F,EAAK5F,KAAKq7B,KACrCr7B,KAAKygG,SAAQ,EACjB,CAMAA,QAAQC,GACJ,QAAI,IAAuB1gG,KAAKq7B,KAAO,OAASr7B,KAAKq7B,IAArD,CAIA,GADAr7B,KAAKq7B,IAAIW,mBAAqBjmB,EAC1B2qF,EACA,IACI1gG,KAAKq7B,IAAInjC,OACb,CACA,MAAOuR,GAAK,CAEQ,oBAAbm4B,iBACAtH,EAAQkmE,SAASxgG,KAAKqqB,OAEjCrqB,KAAKq7B,IAAM,IAXX,CAYJ,CAMAilE,SACI,MAAM7jF,EAAOzc,KAAKq7B,IAAIM,aACT,OAATlf,IACAzc,KAAK++F,aAAa,OAAQtiF,GAC1Bzc,KAAK++F,aAAa,WAClB/+F,KAAKygG,UAEb,CAMAvoG,QACI8H,KAAKygG,SACT,EASJ,GAPAnmE,EAAQimE,cAAgB,EACxBjmE,EAAQkmE,SAAW,CAAC,EAMI,oBAAb5+D,SAEP,GAA2B,mBAAhB++D,YAEPA,YAAY,WAAYC,QAEvB,GAAgC,mBAArBz4E,iBAAiC,CAE7CA,iBADyB,eAAgB,EAAa,WAAa,SAChCy4E,GAAe,EACtD,CAEJ,SAASA,IACL,IAAK,IAAItlG,KAAKg/B,EAAQkmE,SACdlmE,EAAQkmE,SAASzhG,eAAezD,IAChCg/B,EAAQkmE,SAASllG,GAAGpD,OAGhC,CC7YO,MAAM+V,EACqC,mBAAZuD,SAAqD,mBAApBA,QAAQC,QAE/D7B,GAAO4B,QAAQC,UAAU+b,KAAK5d,GAG/B,CAACA,EAAI4uF,IAAiBA,EAAa5uF,EAAI,GAGzCixF,EAAY,aAAwB,2BCHjD,MAAMC,EAAqC,oBAAdp/D,WACI,iBAAtBA,UAAUqG,SACmB,gBAApCrG,UAAUqG,QAAQx9B,cCPf,MAAMw2F,EAAa,CACtBC,UDOG,cAAiBpC,EAOpB9+F,YAAYiyC,GACRp/B,MAAMo/B,GACN/xC,KAAKo9F,gBAAkBrrD,EAAKkvD,WAChC,CACI5hG,WACA,MAAO,WACX,CACA2/F,SACI,IAAKh/F,KAAKkhG,QAEN,OAEJ,MAAMjzD,EAAMjuC,KAAKiuC,MACXkzD,EAAYnhG,KAAK+xC,KAAKovD,UAEtBpvD,EAAO+uD,EACP,CAAC,EACD5C,EAAKl+F,KAAK+xC,KAAM,QAAS,oBAAqB,MAAO,MAAO,aAAc,OAAQ,KAAM,UAAW,qBAAsB,eAAgB,kBAAmB,SAAU,aAAc,SAAU,uBAChM/xC,KAAK+xC,KAAKouD,eACVpuD,EAAKxZ,QAAUv4B,KAAK+xC,KAAKouD,cAE7B,IACIngG,KAAKohG,GACyBN,EAIpB,IAAID,EAAU5yD,EAAKkzD,EAAWpvD,GAH9BovD,EACI,IAAIN,EAAU5yD,EAAKkzD,GACnB,IAAIN,EAAU5yD,EAEhC,CACA,MAAOroC,GACH,OAAO5F,KAAK++F,aAAa,QAASn5F,EACtC,CACA5F,KAAKohG,GAAG7D,WAAav9F,KAAK6+F,OAAOtB,YDrCR,cCsCzBv9F,KAAKqhG,mBACT,CAMAA,oBACIrhG,KAAKohG,GAAGE,OAAS,KACTthG,KAAK+xC,KAAKwvD,WACVvhG,KAAKohG,GAAGI,QAAQrlD,QAEpBn8C,KAAKo/F,QAAQ,EAEjBp/F,KAAKohG,GAAGK,QAAWC,GAAe1hG,KAAKk/F,QAAQ,CAC3CP,YAAa,8BACbtxD,QAASq0D,IAEb1hG,KAAKohG,GAAGO,UAAal4E,GAAOzpB,KAAKq/F,OAAO51E,EAAGhN,MAC3Czc,KAAKohG,GAAG93E,QAAW7f,GAAMzJ,KAAK8+F,QAAQ,kBAAmBr1F,EAC7D,CACA4C,MAAM8yF,GACFn/F,KAAKE,UAAW,EAGhB,IAAK,IAAI5E,EAAI,EAAGA,EAAI6jG,EAAQloG,OAAQqE,IAAK,CACrC,MAAM86C,EAAS+oD,EAAQ7jG,GACjBsmG,EAAatmG,IAAM6jG,EAAQloG,OAAS,EAC1C,EAAam/C,EAAQp2C,KAAKo9F,gBAAiB3gF,IAmBvC,IAGQzc,KAAKohG,GAAGllE,KAAKzf,EAKrB,CACA,MAAOhT,GACP,CACIm4F,GAGA3zF,GAAS,KACLjO,KAAKE,UAAW,EAChBF,KAAK++F,aAAa,QAAQ,GAC3B/+F,KAAKw+F,aACZ,GAER,CACJ,CACAS,eAC2B,IAAZj/F,KAAKohG,KACZphG,KAAKohG,GAAG7xF,QACRvP,KAAKohG,GAAK,KAElB,CAMAnzD,MACI,IAAI+N,EAAQh8C,KAAKg8C,OAAS,CAAC,EAC3B,MAAM6lD,EAAS7hG,KAAK+xC,KAAK40B,OAAS,MAAQ,KAC1C,IAAIr4C,EAAO,GAEPtuB,KAAK+xC,KAAKzjB,OACR,QAAUuzE,GAAqC,MAA3B74F,OAAOhJ,KAAK+xC,KAAKzjB,OAClC,OAASuzE,GAAqC,KAA3B74F,OAAOhJ,KAAK+xC,KAAKzjB,SACzCA,EAAO,IAAMtuB,KAAK+xC,KAAKzjB,MAGvBtuB,KAAK+xC,KAAK+vD,oBACV9lD,EAAMh8C,KAAK+xC,KAAKgwD,gBAAkBrC,KAGjC1/F,KAAKo9F,iBACNphD,EAAMgmD,IAAM,GAEhB,MAAMC,EAAe,EAAOjmD,GAE5B,OAAQ6lD,EACJ,QAF8C,IAArC7hG,KAAK+xC,KAAKqpD,SAAS77F,QAAQ,KAG5B,IAAMS,KAAK+xC,KAAKqpD,SAAW,IAAMp7F,KAAK+xC,KAAKqpD,UACnD9sE,EACAtuB,KAAK+xC,KAAK/iB,MACTizE,EAAahrG,OAAS,IAAMgrG,EAAe,GACpD,CAOAf,QACI,QAASL,CACb,GCjKAqB,QHWG,cAAsBtD,EAOzB9+F,YAAYiyC,GAGR,GAFAp/B,MAAMo/B,GACN/xC,KAAKkiG,SAAU,EACS,oBAAbl5E,SAA0B,CACjC,MAAMm5E,EAAQ,WAAan5E,SAASq8C,SACpC,IAAI/2C,EAAOtF,SAASsF,KAEfA,IACDA,EAAO6zE,EAAQ,MAAQ,MAE3BniG,KAAKggG,GACoB,oBAAbh3E,UACJ+oB,EAAKqpD,WAAapyE,SAASoyE,UAC3B9sE,IAASyjB,EAAKzjB,KACtBtuB,KAAKkgG,GAAKnuD,EAAK40B,SAAWw7B,CAC9B,CAIA,MAAMlB,EAAclvD,GAAQA,EAAKkvD,YACjCjhG,KAAKo9F,eAAiB2C,IAAYkB,CACtC,CACI5hG,WACA,MAAO,SACX,CAOA2/F,SACIh/F,KAAKoiG,MACT,CAOA5C,MAAMC,GACFz/F,KAAKi8B,WAAa,UAClB,MAAMujE,EAAQ,KACVx/F,KAAKi8B,WAAa,SAClBwjE,GAAS,EAEb,GAAIz/F,KAAKkiG,UAAYliG,KAAKE,SAAU,CAChC,IAAImiG,EAAQ,EACRriG,KAAKkiG,UACLG,IACAriG,KAAKmW,KAAK,gBAAgB,aACpBksF,GAAS7C,GACf,KAECx/F,KAAKE,WACNmiG,IACAriG,KAAKmW,KAAK,SAAS,aACbksF,GAAS7C,GACf,IAER,MAEIA,GAER,CAMA4C,OACIpiG,KAAKkiG,SAAU,EACfliG,KAAKsiG,SACLtiG,KAAK++F,aAAa,OACtB,CAMAM,OAAO5iF,GRpFW,EAAC8lF,EAAgBhF,KACnC,MAAMiF,EAAiBD,EAAetjG,MAAM++F,GACtCmB,EAAU,GAChB,IAAK,IAAI7jG,EAAI,EAAGA,EAAIknG,EAAevrG,OAAQqE,IAAK,CAC5C,MAAMmnG,EAAgB,EAAaD,EAAelnG,GAAIiiG,GAEtD,GADA4B,EAAQznG,KAAK+qG,GACc,UAAvBA,EAAcvzF,KACd,KAER,CACA,OAAOiwF,CAAO,EQyFV5/B,CAAc9iD,EAAMzc,KAAK6+F,OAAOtB,YAAYn9F,SAd1Bg2C,IAMd,GAJI,YAAcp2C,KAAKi8B,YAA8B,SAAhBma,EAAOlnC,MACxClP,KAAKo/F,SAGL,UAAYhpD,EAAOlnC,KAEnB,OADAlP,KAAKk/F,QAAQ,CAAEP,YAAa,oCACrB,EAGX3+F,KAAKs/F,SAASlpD,EAAO,IAKrB,WAAap2C,KAAKi8B,aAElBj8B,KAAKkiG,SAAU,EACfliG,KAAK++F,aAAa,gBACd,SAAW/+F,KAAKi8B,YAChBj8B,KAAKoiG,OAKjB,CAMAnD,UACI,MAAM1vF,EAAQ,KACVvP,KAAKqM,MAAM,CAAC,CAAE6C,KAAM,UAAW,EAE/B,SAAWlP,KAAKi8B,WAChB1sB,IAKAvP,KAAKmW,KAAK,OAAQ5G,EAE1B,CAOAlD,MAAM8yF,GACFn/F,KAAKE,UAAW,ERxJF,EAACi/F,EAAS35F,KAE5B,MAAMvO,EAASkoG,EAAQloG,OACjBurG,EAAiB,IAAI5pG,MAAM3B,GACjC,IAAIqa,EAAQ,EACZ6tF,EAAQ/+F,SAAQ,CAACg2C,EAAQ96C,KAErB,EAAa86C,GAAQ,GAAO2nD,IACxByE,EAAelnG,GAAKyiG,IACdzsF,IAAUra,GACZuO,EAASg9F,EAAe7qG,KAAKqmG,GACjC,GACF,GACJ,EQ4IE0E,CAAcvD,GAAU1iF,IACpBzc,KAAK2iG,QAAQlmF,GAAM,KACfzc,KAAKE,UAAW,EAChBF,KAAK++F,aAAa,QAAQ,GAC5B,GAEV,CAMA9wD,MACI,IAAI+N,EAAQh8C,KAAKg8C,OAAS,CAAC,EAC3B,MAAM6lD,EAAS7hG,KAAK+xC,KAAK40B,OAAS,QAAU,OAC5C,IAAIr4C,EAAO,IAEP,IAAUtuB,KAAK+xC,KAAK+vD,oBACpB9lD,EAAMh8C,KAAK+xC,KAAKgwD,gBAAkBrC,KAEjC1/F,KAAKo9F,gBAAmBphD,EAAM4mD,MAC/B5mD,EAAMgmD,IAAM,GAGZhiG,KAAK+xC,KAAKzjB,OACR,UAAYuzE,GAAqC,MAA3B74F,OAAOhJ,KAAK+xC,KAAKzjB,OACpC,SAAWuzE,GAAqC,KAA3B74F,OAAOhJ,KAAK+xC,KAAKzjB,SAC3CA,EAAO,IAAMtuB,KAAK+xC,KAAKzjB,MAE3B,MAAM2zE,EAAe,EAAOjmD,GAE5B,OAAQ6lD,EACJ,QAF8C,IAArC7hG,KAAK+xC,KAAKqpD,SAAS77F,QAAQ,KAG5B,IAAMS,KAAK+xC,KAAKqpD,SAAW,IAAMp7F,KAAK+xC,KAAKqpD,UACnD9sE,EACAtuB,KAAK+xC,KAAK/iB,MACTizE,EAAahrG,OAAS,IAAMgrG,EAAe,GACpD,CAOA18F,QAAQwsC,EAAO,CAAC,GAEZ,OADArzC,OAAO6W,OAAOw8B,EAAM,CAAEiuD,GAAIhgG,KAAKggG,GAAIE,GAAIlgG,KAAKkgG,IAAMlgG,KAAK+xC,MAChD,IAAIzX,EAAQt6B,KAAKiuC,MAAO8D,EACnC,CAQA4wD,QAAQlmF,EAAMzY,GACV,MAAMolB,EAAMppB,KAAKuF,QAAQ,CACrBH,OAAQ,OACRqX,KAAMA,IAEV2M,EAAIkhB,GAAG,UAAWtmC,GAClBolB,EAAIkhB,GAAG,SAAS,CAACu4D,EAAWx1D,KACxBrtC,KAAK8+F,QAAQ,iBAAkB+D,EAAWx1D,EAAQ,GAE1D,CAMAi1D,SACI,MAAMl5E,EAAMppB,KAAKuF,UACjB6jB,EAAIkhB,GAAG,OAAQtqC,KAAKq/F,OAAOjjG,KAAK4D,OAChCopB,EAAIkhB,GAAG,SAAS,CAACu4D,EAAWx1D,KACxBrtC,KAAK8+F,QAAQ,iBAAkB+D,EAAWx1D,EAAQ,IAEtDrtC,KAAK8iG,QAAU15E,CACnB,IItNEk3C,EAAK,sPACL/oE,EAAQ,CACV,SAAU,WAAY,YAAa,WAAY,OAAQ,WAAY,OAAQ,OAAQ,WAAY,OAAQ,YAAa,OAAQ,QAAS,UAElI,SAASy0B,EAAM3wB,GAClB,MAAMkM,EAAMlM,EAAKihB,EAAIjhB,EAAIkE,QAAQ,KAAMkK,EAAIpO,EAAIkE,QAAQ,MAC7C,GAAN+c,IAAiB,GAAN7S,IACXpO,EAAMA,EAAIoE,UAAU,EAAG6c,GAAKjhB,EAAIoE,UAAU6c,EAAG7S,GAAGhJ,QAAQ,KAAM,KAAOpF,EAAIoE,UAAUgK,EAAGpO,EAAIpE,SAE9F,IAAIwmB,EAAI6iD,EAAGlzC,KAAK/xB,GAAO,IAAK4yC,EAAM,CAAC,EAAG3yC,EAAI,GAC1C,KAAOA,KACH2yC,EAAI12C,EAAM+D,IAAMmiB,EAAEniB,IAAM,GAU5B,OARU,GAANghB,IAAiB,GAAN7S,IACXwkC,EAAI9vC,OAASoJ,EACb0mC,EAAI80D,KAAO90D,EAAI80D,KAAKtjG,UAAU,EAAGwuC,EAAI80D,KAAK9rG,OAAS,GAAGwJ,QAAQ,KAAM,KACpEwtC,EAAIvb,UAAYub,EAAIvb,UAAUjyB,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAAIA,QAAQ,KAAM,KAC9EwtC,EAAI+0D,SAAU,GAElB/0D,EAAIg1D,UAIR,SAAmB35F,EAAK0lB,GACpB,MAAMk0E,EAAO,WAAYv/D,EAAQ3U,EAAKvuB,QAAQyiG,EAAM,KAAKjkG,MAAM,KACvC,KAApB+vB,EAAKl2B,MAAM,EAAG,IAA6B,IAAhBk2B,EAAK/3B,QAChC0sC,EAAM1Y,OAAO,EAAG,GAEE,KAAlB+D,EAAKl2B,OAAO,IACZ6qC,EAAM1Y,OAAO0Y,EAAM1sC,OAAS,EAAG,GAEnC,OAAO0sC,CACX,CAboBs/D,CAAUh1D,EAAKA,EAAU,MACzCA,EAAIk1D,SAaR,SAAkBl1D,EAAK+N,GACnB,MAAMv/B,EAAO,CAAC,EAMd,OALAu/B,EAAMv7C,QAAQ,6BAA6B,SAAU2iG,EAAIlhE,EAAImhE,GACrDnhE,IACAzlB,EAAKylB,GAAMmhE,EAEnB,IACO5mF,CACX,CArBmB0mF,CAASl1D,EAAKA,EAAW,OACjCA,CACX,CCnCO,MAAMq1D,UAAe,IAOxBxjG,YAAYmuC,EAAK8D,EAAO,CAAC,GACrBp/B,QACA3S,KAAKujG,YAAc,GACft1D,GAAO,iBAAoBA,IAC3B8D,EAAO9D,EACPA,EAAM,MAENA,GACAA,EAAMjiB,EAAMiiB,GACZ8D,EAAKqpD,SAAWntD,EAAI80D,KACpBhxD,EAAK40B,OAA0B,UAAjB14B,EAAIo3B,UAAyC,QAAjBp3B,EAAIo3B,SAC9CtzB,EAAKzjB,KAAO2f,EAAI3f,KACZ2f,EAAI+N,QACJjK,EAAKiK,MAAQ/N,EAAI+N,QAEhBjK,EAAKgxD,OACVhxD,EAAKqpD,SAAWpvE,EAAM+lB,EAAKgxD,MAAMA,MAErCzE,EAAsBt+F,KAAM+xC,GAC5B/xC,KAAK2mE,OACD,MAAQ50B,EAAK40B,OACP50B,EAAK40B,OACe,oBAAb39C,UAA4B,WAAaA,SAASq8C,SAC/DtzB,EAAKqpD,WAAarpD,EAAKzjB,OAEvByjB,EAAKzjB,KAAOtuB,KAAK2mE,OAAS,MAAQ,MAEtC3mE,KAAKo7F,SACDrpD,EAAKqpD,WACoB,oBAAbpyE,SAA2BA,SAASoyE,SAAW,aAC/Dp7F,KAAKsuB,KACDyjB,EAAKzjB,OACoB,oBAAbtF,UAA4BA,SAASsF,KACvCtF,SAASsF,KACTtuB,KAAK2mE,OACD,MACA,MAClB3mE,KAAK+gG,WAAahvD,EAAKgvD,YAAc,CAAC,UAAW,aACjD/gG,KAAKujG,YAAc,GACnBvjG,KAAKwjG,cAAgB,EACrBxjG,KAAK+xC,KAAOrzC,OAAO6W,OAAO,CACtByZ,KAAM,aACNy0E,OAAO,EACP5nE,iBAAiB,EACjByrD,SAAS,EACTya,eAAgB,IAChB2B,iBAAiB,EACjBC,kBAAkB,EAClBC,oBAAoB,EACpBC,kBAAmB,CACf7rB,UAAW,MAEf8rB,iBAAkB,CAAC,EACnBC,qBAAqB,GACtBhyD,GACH/xC,KAAK+xC,KAAK/iB,KACNhvB,KAAK+xC,KAAK/iB,KAAKvuB,QAAQ,MAAO,KACzBT,KAAK+xC,KAAK4xD,iBAAmB,IAAM,IACb,iBAApB3jG,KAAK+xC,KAAKiK,QACjBh8C,KAAK+xC,KAAKiK,MR/Cf,SAAgBgoD,GACnB,IAAIC,EAAM,CAAC,EACPC,EAAQF,EAAG/kG,MAAM,KACrB,IAAK,IAAI3D,EAAI,EAAGs2B,EAAIsyE,EAAMjtG,OAAQqE,EAAIs2B,EAAGt2B,IAAK,CAC1C,IAAIutD,EAAOq7C,EAAM5oG,GAAG2D,MAAM,KAC1BglG,EAAIppE,mBAAmBguB,EAAK,KAAOhuB,mBAAmBguB,EAAK,GAC/D,CACA,OAAOo7C,CACX,CQuC8B,CAAOjkG,KAAK+xC,KAAKiK,QAGvCh8C,KAAKpG,GAAK,KACVoG,KAAKmkG,SAAW,KAChBnkG,KAAKokG,aAAe,KACpBpkG,KAAKqkG,YAAc,KAEnBrkG,KAAKskG,iBAAmB,KACQ,mBAArBn8E,mBACHnoB,KAAK+xC,KAAKgyD,sBAIV/jG,KAAKukG,0BAA4B,KACzBvkG,KAAKwkG,YAELxkG,KAAKwkG,UAAU32D,qBACf7tC,KAAKwkG,UAAUj1F,QACnB,EAEJ4Y,iBAAiB,eAAgBnoB,KAAKukG,2BAA2B,IAE/C,cAAlBvkG,KAAKo7F,WACLp7F,KAAKykG,qBAAuB,KACxBzkG,KAAKk/F,QAAQ,kBAAmB,CAC5BP,YAAa,2BACf,EAENx2E,iBAAiB,UAAWnoB,KAAKykG,sBAAsB,KAG/DzkG,KAAKyV,MACT,CAQAivF,gBAAgBrlG,GACZ,MAAM28C,EAAQt9C,OAAO6W,OAAO,CAAC,EAAGvV,KAAK+xC,KAAKiK,OAE1CA,EAAM2oD,IbtFU,EawFhB3oD,EAAMwoD,UAAYnlG,EAEdW,KAAKpG,KACLoiD,EAAM4mD,IAAM5iG,KAAKpG,IACrB,MAAMm4C,EAAOrzC,OAAO6W,OAAO,CAAC,EAAGvV,KAAK+xC,KAAK+xD,iBAAiBzkG,GAAOW,KAAK+xC,KAAM,CACxEiK,QACA6iD,OAAQ7+F,KACRo7F,SAAUp7F,KAAKo7F,SACfz0B,OAAQ3mE,KAAK2mE,OACbr4C,KAAMtuB,KAAKsuB,OAEf,OAAO,IAAIyyE,EAAW1hG,GAAM0yC,EAChC,CAMAt8B,OACI,IAAI+uF,EACJ,GAAIxkG,KAAK+xC,KAAK2xD,iBACVJ,EAAOsB,wBACmC,IAA1C5kG,KAAK+gG,WAAWxhG,QAAQ,aACxBilG,EAAY,gBAEX,IAAI,IAAMxkG,KAAK+gG,WAAW9pG,OAK3B,YAHA+I,KAAKw+F,cAAa,KACdx+F,KAAK++F,aAAa,QAAS,0BAA0B,GACtD,GAIHyF,EAAYxkG,KAAK+gG,WAAW,EAChC,CACA/gG,KAAKi8B,WAAa,UAElB,IACIuoE,EAAYxkG,KAAK0kG,gBAAgBF,EACrC,CACA,MAAO/6F,GAGH,OAFAzJ,KAAK+gG,WAAW3hG,aAChBY,KAAKyV,MAET,CACA+uF,EAAU/uF,OACVzV,KAAK6kG,aAAaL,EACtB,CAMAK,aAAaL,GACLxkG,KAAKwkG,WACLxkG,KAAKwkG,UAAU32D,qBAGnB7tC,KAAKwkG,UAAYA,EAEjBA,EACKl6D,GAAG,QAAStqC,KAAK8kG,QAAQ1oG,KAAK4D,OAC9BsqC,GAAG,SAAUtqC,KAAKs/F,SAASljG,KAAK4D,OAChCsqC,GAAG,QAAStqC,KAAK8+F,QAAQ1iG,KAAK4D,OAC9BsqC,GAAG,SAAUykC,GAAW/uE,KAAKk/F,QAAQ,kBAAmBnwB,IACjE,CAOAg2B,MAAM1lG,GACF,IAAImlG,EAAYxkG,KAAK0kG,gBAAgBrlG,GACjC2lG,GAAS,EACb1B,EAAOsB,uBAAwB,EAC/B,MAAMK,EAAkB,KAChBD,IAEJR,EAAUtoE,KAAK,CAAC,CAAEhtB,KAAM,OAAQuN,KAAM,WACtC+nF,EAAUruF,KAAK,UAAW8Q,IACtB,IAAI+9E,EAEJ,GAAI,SAAW/9E,EAAI/X,MAAQ,UAAY+X,EAAIxK,KAAM,CAG7C,GAFAzc,KAAKklG,WAAY,EACjBllG,KAAK++F,aAAa,YAAayF,IAC1BA,EACD,OACJlB,EAAOsB,sBAAwB,cAAgBJ,EAAUnlG,KACzDW,KAAKwkG,UAAUhF,OAAM,KACbwF,GAEA,WAAahlG,KAAKi8B,aAEtBwkE,IACAzgG,KAAK6kG,aAAaL,GAClBA,EAAUtoE,KAAK,CAAC,CAAEhtB,KAAM,aACxBlP,KAAK++F,aAAa,UAAWyF,GAC7BA,EAAY,KACZxkG,KAAKklG,WAAY,EACjBllG,KAAKs2E,QAAO,GAEpB,KACK,CACD,MAAM1wE,EAAM,IAAIrN,MAAM,eAEtBqN,EAAI4+F,UAAYA,EAAUnlG,KAC1BW,KAAK++F,aAAa,eAAgBn5F,EACtC,KACF,EAEN,SAASu/F,IACDH,IAGJA,GAAS,EACTvE,IACA+D,EAAUj1F,QACVi1F,EAAY,KAChB,CAEA,MAAMl7E,EAAW1jB,IACb,MAAMwa,EAAQ,IAAI7nB,MAAM,gBAAkBqN,GAE1Cwa,EAAMokF,UAAYA,EAAUnlG,KAC5B8lG,IACAnlG,KAAK++F,aAAa,eAAgB3+E,EAAM,EAE5C,SAASglF,IACL97E,EAAQ,mBACZ,CAEA,SAASm4E,IACLn4E,EAAQ,gBACZ,CAEA,SAAS+7E,EAAUv+D,GACX09D,GAAa19D,EAAGznC,OAASmlG,EAAUnlG,MACnC8lG,GAER,CAEA,MAAM1E,EAAU,KACZ+D,EAAUr5D,eAAe,OAAQ85D,GACjCT,EAAUr5D,eAAe,QAAS7hB,GAClCk7E,EAAUr5D,eAAe,QAASi6D,GAClCplG,KAAKiG,IAAI,QAASw7F,GAClBzhG,KAAKiG,IAAI,YAAao/F,EAAU,EAEpCb,EAAUruF,KAAK,OAAQ8uF,GACvBT,EAAUruF,KAAK,QAASmT,GACxBk7E,EAAUruF,KAAK,QAASivF,GACxBplG,KAAKmW,KAAK,QAASsrF,GACnBzhG,KAAKmW,KAAK,YAAakvF,GACvBb,EAAU/uF,MACd,CAMA2pF,SAOI,GANAp/F,KAAKi8B,WAAa,OAClBqnE,EAAOsB,sBAAwB,cAAgB5kG,KAAKwkG,UAAUnlG,KAC9DW,KAAK++F,aAAa,QAClB/+F,KAAKs2E,QAGD,SAAWt2E,KAAKi8B,YAAcj8B,KAAK+xC,KAAKu1C,QAAS,CACjD,IAAIhsF,EAAI,EACR,MAAMs2B,EAAI5xB,KAAKmkG,SAASltG,OACxB,KAAOqE,EAAIs2B,EAAGt2B,IACV0E,KAAK+kG,MAAM/kG,KAAKmkG,SAAS7oG,GAEjC,CACJ,CAMAgkG,SAASlpD,GACL,GAAI,YAAcp2C,KAAKi8B,YACnB,SAAWj8B,KAAKi8B,YAChB,YAAcj8B,KAAKi8B,WAInB,OAHAj8B,KAAK++F,aAAa,SAAU3oD,GAE5Bp2C,KAAK++F,aAAa,aACV3oD,EAAOlnC,MACX,IAAK,OACDlP,KAAKslG,YAAYprE,KAAKlO,MAAMoqB,EAAO35B,OACnC,MACJ,IAAK,OACDzc,KAAKulG,mBACLvlG,KAAKwlG,WAAW,QAChBxlG,KAAK++F,aAAa,QAClB/+F,KAAK++F,aAAa,QAClB,MACJ,IAAK,QACD,MAAMn5F,EAAM,IAAIrN,MAAM,gBAEtBqN,EAAIyI,KAAO+nC,EAAO35B,KAClBzc,KAAK8+F,QAAQl5F,GACb,MACJ,IAAK,UACD5F,KAAK++F,aAAa,OAAQ3oD,EAAO35B,MACjCzc,KAAK++F,aAAa,UAAW3oD,EAAO35B,MAMpD,CAOA6oF,YAAY7oF,GACRzc,KAAK++F,aAAa,YAAatiF,GAC/Bzc,KAAKpG,GAAK6iB,EAAKmmF,IACf5iG,KAAKwkG,UAAUxoD,MAAM4mD,IAAMnmF,EAAKmmF,IAChC5iG,KAAKmkG,SAAWnkG,KAAKylG,eAAehpF,EAAK0nF,UACzCnkG,KAAKokG,aAAe3nF,EAAK2nF,aACzBpkG,KAAKqkG,YAAc5nF,EAAK4nF,YACxBrkG,KAAK0lG,WAAajpF,EAAKipF,WACvB1lG,KAAKo/F,SAED,WAAap/F,KAAKi8B,YAEtBj8B,KAAKulG,kBACT,CAMAA,mBACIvlG,KAAKy+F,eAAez+F,KAAKskG,kBACzBtkG,KAAKskG,iBAAmBtkG,KAAKw+F,cAAa,KACtCx+F,KAAKk/F,QAAQ,eAAe,GAC7Bl/F,KAAKokG,aAAepkG,KAAKqkG,aACxBrkG,KAAK+xC,KAAKwvD,WACVvhG,KAAKskG,iBAAiBnoD,OAE9B,CAMA2oD,UACI9kG,KAAKujG,YAAYt4E,OAAO,EAAGjrB,KAAKwjG,eAIhCxjG,KAAKwjG,cAAgB,EACjB,IAAMxjG,KAAKujG,YAAYtsG,OACvB+I,KAAK++F,aAAa,SAGlB/+F,KAAKs2E,OAEb,CAMAA,QACI,GAAI,WAAat2E,KAAKi8B,YAClBj8B,KAAKwkG,UAAUtkG,WACdF,KAAKklG,WACNllG,KAAKujG,YAAYtsG,OAAQ,CACzB,MAAMkoG,EAAUn/F,KAAK2lG,qBACrB3lG,KAAKwkG,UAAUtoE,KAAKijE,GAGpBn/F,KAAKwjG,cAAgBrE,EAAQloG,OAC7B+I,KAAK++F,aAAa,QACtB,CACJ,CAOA4G,qBAII,KAH+B3lG,KAAK0lG,YACR,YAAxB1lG,KAAKwkG,UAAUnlG,MACfW,KAAKujG,YAAYtsG,OAAS,GAE1B,OAAO+I,KAAKujG,YAEhB,IAAIqC,EAAc,EAClB,IAAK,IAAItqG,EAAI,EAAGA,EAAI0E,KAAKujG,YAAYtsG,OAAQqE,IAAK,CAC9C,MAAMmhB,EAAOzc,KAAKujG,YAAYjoG,GAAGmhB,KAIjC,GAHIA,IACAmpF,GXxYO,iBADIt8F,EWyYemT,GXlY1C,SAAoBphB,GAChB,IAAI4jB,EAAI,EAAGhoB,EAAS,EACpB,IAAK,IAAIqE,EAAI,EAAGs2B,EAAIv2B,EAAIpE,OAAQqE,EAAIs2B,EAAGt2B,IACnC2jB,EAAI5jB,EAAIG,WAAWF,GACf2jB,EAAI,IACJhoB,GAAU,EAELgoB,EAAI,KACThoB,GAAU,EAELgoB,EAAI,OAAUA,GAAK,MACxBhoB,GAAU,GAGVqE,IACArE,GAAU,GAGlB,OAAOA,CACX,CAxBe4uG,CAAWv8F,GAGfrQ,KAAKm7C,KAPQ,MAOF9qC,EAAIuD,YAAcvD,EAAI7R,QWsY5B6D,EAAI,GAAKsqG,EAAc5lG,KAAK0lG,WAC5B,OAAO1lG,KAAKujG,YAAYzqG,MAAM,EAAGwC,GAErCsqG,GAAe,CACnB,CX/YD,IAAoBt8F,EWgZnB,OAAOtJ,KAAKujG,WAChB,CASAl3F,MAAM4a,EAAK7Y,EAASpK,GAEhB,OADAhE,KAAKwlG,WAAW,UAAWv+E,EAAK7Y,EAASpK,GAClChE,IACX,CACAk8B,KAAKjV,EAAK7Y,EAASpK,GAEf,OADAhE,KAAKwlG,WAAW,UAAWv+E,EAAK7Y,EAASpK,GAClChE,IACX,CAUAwlG,WAAWt2F,EAAMuN,EAAMrO,EAASpK,GAS5B,GARI,mBAAsByY,IACtBzY,EAAKyY,EACLA,OAAO/U,GAEP,mBAAsB0G,IACtBpK,EAAKoK,EACLA,EAAU,MAEV,YAAcpO,KAAKi8B,YAAc,WAAaj8B,KAAKi8B,WACnD,QAEJ7tB,EAAUA,GAAW,CAAC,GACd03F,UAAW,IAAU13F,EAAQ03F,SACrC,MAAM1vD,EAAS,CACXlnC,KAAMA,EACNuN,KAAMA,EACNrO,QAASA,GAEbpO,KAAK++F,aAAa,eAAgB3oD,GAClCp2C,KAAKujG,YAAY7rG,KAAK0+C,GAClBpyC,GACAhE,KAAKmW,KAAK,QAASnS,GACvBhE,KAAKs2E,OACT,CAIA/mE,QACI,MAAMA,EAAQ,KACVvP,KAAKk/F,QAAQ,gBACbl/F,KAAKwkG,UAAUj1F,OAAO,EAEpBw2F,EAAkB,KACpB/lG,KAAKiG,IAAI,UAAW8/F,GACpB/lG,KAAKiG,IAAI,eAAgB8/F,GACzBx2F,GAAO,EAELy2F,EAAiB,KAEnBhmG,KAAKmW,KAAK,UAAW4vF,GACrB/lG,KAAKmW,KAAK,eAAgB4vF,EAAgB,EAqB9C,MAnBI,YAAc/lG,KAAKi8B,YAAc,SAAWj8B,KAAKi8B,aACjDj8B,KAAKi8B,WAAa,UACdj8B,KAAKujG,YAAYtsG,OACjB+I,KAAKmW,KAAK,SAAS,KACXnW,KAAKklG,UACLc,IAGAz2F,GACJ,IAGCvP,KAAKklG,UACVc,IAGAz2F,KAGDvP,IACX,CAMA8+F,QAAQl5F,GACJ09F,EAAOsB,uBAAwB,EAC/B5kG,KAAK++F,aAAa,QAASn5F,GAC3B5F,KAAKk/F,QAAQ,kBAAmBt5F,EACpC,CAMAs5F,QAAQnwB,EAAQ4vB,GACR,YAAc3+F,KAAKi8B,YACnB,SAAWj8B,KAAKi8B,YAChB,YAAcj8B,KAAKi8B,aAEnBj8B,KAAKy+F,eAAez+F,KAAKskG,kBAEzBtkG,KAAKwkG,UAAU32D,mBAAmB,SAElC7tC,KAAKwkG,UAAUj1F,QAEfvP,KAAKwkG,UAAU32D,qBACoB,mBAAxB3lB,sBACPA,oBAAoB,eAAgBloB,KAAKukG,2BAA2B,GACpEr8E,oBAAoB,UAAWloB,KAAKykG,sBAAsB,IAG9DzkG,KAAKi8B,WAAa,SAElBj8B,KAAKpG,GAAK,KAEVoG,KAAK++F,aAAa,QAAShwB,EAAQ4vB,GAGnC3+F,KAAKujG,YAAc,GACnBvjG,KAAKwjG,cAAgB,EAE7B,CAOAiC,eAAetB,GACX,MAAM8B,EAAmB,GACzB,IAAI3qG,EAAI,EACR,MAAM8iB,EAAI+lF,EAASltG,OACnB,KAAOqE,EAAI8iB,EAAG9iB,KACL0E,KAAK+gG,WAAWxhG,QAAQ4kG,EAAS7oG,KAClC2qG,EAAiBvuG,KAAKysG,EAAS7oG,IAEvC,OAAO2qG,CACX,EAEJ3C,EAAOj+B,SbliBiB,Ec5BAi+B,EAAOj+B,2HCgCxB,MAAM6gC,EAAsB,CAClCvlG,IAAK,CAAChK,EAAQO,IAAiC,IAArBP,EAAOO,EAAS,GAAeP,EAAOO,EAAS,IAAO,EAAOP,EAAOO,EAAS,IAAO,GAAQP,EAAOO,IAAY,GACzI8E,IAAK,iBCfCiC,eAAekoG,EAAmBpqG,GACxC,KAAMA,aAAiBvB,YAAcuB,aAAiB8f,aACrD,MAAM,IAAI7W,UAAU,+GAA+GjJ,OAGpI,MAAMpF,EAASoF,aAAiBvB,WAAauB,EAAQ,IAAIvB,WAAWuB,GAEpE,GAAMpF,GAAQM,OAAS,EAIvB,OAAOmvG,EAAsB,KAAmBzvG,GACjD,CAOA,SAAS0vG,EAAO1vG,EAAQ4hC,EAASnqB,GAChCA,EAAU,CACTlX,OAAQ,KACLkX,GAGJ,IAAK,MAAOic,EAAOoO,KAAWF,EAAQ1lB,UAErC,GAAIzE,EAAQlH,MAEX,GAAIuxB,KAAYrqB,EAAQlH,KAAKmjB,GAAS1zB,EAAO0zB,EAAQjc,EAAQlX,SAC5D,OAAO,OAEF,GAAIuhC,IAAW9hC,EAAO0zB,EAAQjc,EAAQlX,QAC5C,OAAO,EAIT,OAAO,CACR,CAEO+G,eAAemoG,EAAsBnW,GAC3C,IACC,OAAO,IAAIqW,GAAiBt6E,MAAMikE,EACnC,CAAE,MAAO7vE,GACR,KAAMA,aAAiB,MACtB,MAAMA,CAER,CACD,CAEA,MAAMkmF,EACLpF,MAAMzoE,EAAQrqB,GACb,OAAOi4F,EAAOrmG,KAAKrJ,OAAQ8hC,EAAQrqB,EACpC,CAEAm4F,YAAY9tE,EAAQrqB,GACnB,OAAOpO,KAAKkhG,OD7EgBx9F,EC6EI+0B,ED5E1B,IAAI/0B,GAAQkX,KAAI4rF,GAAaA,EAAUhrG,WAAW,MC4Ef4S,GD7EpC,IAAuB1K,CC8E7B,CAEAzF,YAAYgyF,GAcX,GAbAjwF,KAAKrJ,OAAS,EAAAyL,OAAA,MAvEK,WA0EasF,IAA5BuoF,EAAUwW,SAAShvG,OACtBw4F,EAAUwW,SAAShvG,KAAOuR,OAAO2oB,kBAGlC3xB,KAAKiwF,UAAYA,QAEXA,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACM,OAAQ,GAAI0vG,WAAW,IAI5D3mG,KAAKkhG,MAAM,CAAC,GAAM,KACrB,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,MACrB,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,0BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IACrB,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,iCAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,KACrB,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,4BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,KAGrB,aAFMjR,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACM,OAAQ,GAAI0vG,WAAW,IAG/D3mG,KAAKumG,YAAY,YAAa,CAACrvG,OAAQ,KACpC8I,KAAKumG,YAAY,SAAU,CAACrvG,OAAQ,KAEhC,CACN2qB,IAAK,MACL+kF,KAAM,mBAID,CACN/kF,IAAK,KACL+kF,KAAM,0BAIR,GACC5mG,KAAKkhG,MAAM,CAAC,GAAM,OACflhG,KAAKkhG,MAAM,CAAC,GAAM,MAErB,MAAO,CACNr/E,IAAK,IACL+kF,KAAM,0BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,MACrB,MAAO,CACNr/E,IAAK,OACL+kF,KAAM,sBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,MACrB,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,qBAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,MAG3B,OADAlhG,KAAKiwF,UAAU4W,OAAO,GACf7mG,KAAKgsB,MAAMikE,GAGnB,GAAIjwF,KAAKkhG,MAAM,CAAC,GAAM,GAAM,KAC3B,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,MAC3B,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,sBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,IAAM,IAC3B,MAAO,CACNr/E,IAAK,KACL+kF,KAAM,oBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,MAC3B,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,uBAIR,GAAI5mG,KAAKumG,YAAY,OAAQ,OACtBtW,EAAU4W,OAAO,GACvB,MAAMC,QAAwB7W,EAAU8W,UAAUb,GAClD,OAAIjW,EAAUviD,SAAWo5D,EAAkB7W,EAAUwW,SAAShvG,KAEtD,CACNoqB,IAAK,MACL+kF,KAAM,qBAIF3W,EAAU4W,OAAOC,GAChBV,EAAsBnW,GAC9B,CAGA,GAAIjwF,KAAKumG,YAAY,OACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,oBAIR,IACqB,KAAnB5mG,KAAKrJ,OAAO,IAAkC,KAAnBqJ,KAAKrJ,OAAO,KACrCqJ,KAAKkhG,MAAM,CAAC,GAAM,IAAO,CAAChqG,OAAQ,IAErC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,iCAOR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,MAC3B,OAAIlhG,KAAKkhG,MAAM,CAAC,KAAO,CAAChqG,OAAQ,IACxB,CACN2qB,IAAK,MACL+kF,KAAM,aAID,CACN/kF,IAAK,MACL+kF,KAAM,cAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,OACL+kF,KAAM,cAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,6BAIR,GAAI5mG,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,IACrC,MAAO,CACN2qB,IAAK,OACL+kF,KAAM,cAKR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,oBAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,cAIR,GAAI5mG,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,IACrC,MAAO,CACN2qB,IAAK,OACL+kF,KAAM,cAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,EAAK,IAAO,CACvC,IACC,KAAOjR,EAAUviD,SAAW,GAAKuiD,EAAUwW,SAAShvG,MAAM,OACnDw4F,EAAU+W,WAAWhnG,KAAKrJ,OAAQ,CAACM,OAAQ,KAGjD,MAAMgwG,EAAY,CACjBC,eAAgBlnG,KAAKrJ,OAAOysB,aAAa,IACzC+jF,iBAAkBnnG,KAAKrJ,OAAOysB,aAAa,IAC3CgkF,eAAgBpnG,KAAKrJ,OAAOssB,aAAa,IACzCokF,iBAAkBrnG,KAAKrJ,OAAOssB,aAAa,KAO5C,GAJAgkF,EAAUK,eAAiBrX,EAAU8W,UAAU,IAAI,KAAiBE,EAAUG,eAAgB,gBACxFnX,EAAU4W,OAAOI,EAAUI,kBAGN,yBAAvBJ,EAAUK,SACb,MAAO,CACNzlF,IAAK,MACL+kF,KAAM,2BAIR,GAAIK,EAAUK,SAASxP,SAAS,UAAYmP,EAAUK,SAASxP,SAAS,QAAS,CAEhF,OADamP,EAAUK,SAASroG,MAAM,KAAK,IAE1C,IAAK,QAiBL,QACC,MAhBD,IAAK,OACJ,MAAO,CACN4iB,IAAK,OACL+kF,KAAM,2EAER,IAAK,MACJ,MAAO,CACN/kF,IAAK,OACL+kF,KAAM,6EAER,IAAK,KACJ,MAAO,CACN/kF,IAAK,OACL+kF,KAAM,qEAKV,CAEA,GAAIK,EAAUK,SAASvpC,WAAW,OACjC,MAAO,CACNl8C,IAAK,OACL+kF,KAAM,qEAIR,GAAIK,EAAUK,SAASvpC,WAAW,QAAUkpC,EAAUK,SAASxP,SAAS,UACvE,MAAO,CACNj2E,IAAK,MACL+kF,KAAM,aAUR,GAA2B,aAAvBK,EAAUK,UAA2BL,EAAUC,iBAAmBD,EAAUE,iBAAkB,CACjG,IAAII,QAAiBtX,EAAU8W,UAAU,IAAI,KAAiBE,EAAUC,eAAgB,UAGxF,OAFAK,EAAWA,EAASruF,OAEZquF,GACP,IAAK,uBACJ,MAAO,CACN1lF,IAAK,OACL+kF,KAAM,wBAER,IAAK,0CACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,2CAER,IAAK,iDACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,kDAER,IAAK,kDACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,mDAIV,CAGA,GAAiC,IAA7BK,EAAUC,eAAsB,CACnC,IAAIM,GAAmB,EAEvB,KAAOA,EAAkB,GAAMvX,EAAUviD,SAAWuiD,EAAUwW,SAAShvG,YAChEw4F,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACgwG,WAAW,IAEpDa,EAAkBxnG,KAAKrJ,OAAO4I,QAAQ,WAAY,EAAG,aAE/C0wF,EAAU4W,OAAOW,GAAmB,EAAIA,EAAkBxnG,KAAKrJ,OAAOM,OAE9E,YACOg5F,EAAU4W,OAAOI,EAAUC,eAEnC,CACD,CAAE,MAAO9mF,GACR,KAAMA,aAAiB,MACtB,MAAMA,CAER,CAEA,MAAO,CACNyB,IAAK,MACL+kF,KAAM,kBAER,CAEA,GAAI5mG,KAAKumG,YAAY,QAAS,OAEvBtW,EAAU4W,OAAO,IACvB,MAAM33F,EAAO,EAAA9M,OAAA,MAAa,GAI1B,aAHM6tF,EAAU+W,WAAW93F,GAGvBm3F,EAAOn3F,EAAM,CAAC,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,MACpD,CACN2S,IAAK,OACL+kF,KAAM,cAKJP,EAAOn3F,EAAM,CAAC,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,KAC9C,CACN2S,IAAK,MACL+kF,KAAM,aAKJP,EAAOn3F,EAAM,CAAC,EAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC9C,CACN2S,IAAK,MACL+kF,KAAM,aAKJP,EAAOn3F,EAAM,CAAC,IAAM,GAAM,GAAM,GAAM,KAClC,CACN2S,IAAK,MACL+kF,KAAM,aAKJP,EAAOn3F,EAAM,CAAC,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,KAC9C,CACN2S,IAAK,MACL+kF,KAAM,aAKJP,EAAOn3F,EAAM,CAAC,EAAM,IAAM,IAAM,IAAM,GAAM,IAAM,MAC9C,CACN2S,IAAK,MACL+kF,KAAM,aAKD,CACN/kF,IAAK,MACL+kF,KAAM,kBAER,CAEA,GACC5mG,KAAKkhG,MAAM,CAAC,GAAM,OACK,IAAnBlhG,KAAKrJ,OAAO,IAAiC,IAAnBqJ,KAAKrJ,OAAO,IAAiC,IAAnBqJ,KAAKrJ,OAAO,MAC7C,IAAnBqJ,KAAKrJ,OAAO,IAAiC,IAAnBqJ,KAAKrJ,OAAO,IAAiC,IAAnBqJ,KAAKrJ,OAAO,IAEpE,MAAO,CACNkrB,IAAK,MACL+kF,KAAM,mBAUR,GACC5mG,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,KACH,IAAV,GAAjB8I,KAAKrJ,OAAO,IACf,CAGD,MAAM8wG,EAAaznG,KAAKrJ,OAAOgO,SAAS,SAAU,EAAG,IAAIlE,QAAQ,KAAM,KAAKyY,OAC5E,OAAQuuF,GACP,IAAK,OACL,IAAK,OACJ,MAAO,CAAC5lF,IAAK,OAAQ+kF,KAAM,cAC5B,IAAK,OACJ,MAAO,CAAC/kF,IAAK,OAAQ+kF,KAAM,cAC5B,IAAK,OACJ,MAAO,CAAC/kF,IAAK,OAAQ+kF,KAAM,uBAC5B,IAAK,OACL,IAAK,OACJ,MAAO,CAAC/kF,IAAK,OAAQ+kF,KAAM,cAC5B,IAAK,OACL,IAAK,OACJ,MAAO,CAAC/kF,IAAK,OAAQ+kF,KAAM,uBAC5B,IAAK,KACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,mBAC3B,IAAK,MACL,IAAK,OACL,IAAK,OACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,eAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,eAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,aAC3B,IAAK,MACJ,MAAO,CAAC/kF,IAAK,MAAO+kF,KAAM,qBAC3B,QACC,OAAIa,EAAW1pC,WAAW,MACrB0pC,EAAW1pC,WAAW,OAClB,CAACl8C,IAAK,MAAO+kF,KAAM,eAGpB,CAAC/kF,IAAK,MAAO+kF,KAAM,cAGpB,CAAC/kF,IAAK,MAAO+kF,KAAM,aAE7B,CAEA,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,cAIR,GACC5mG,KAAKumG,YAAY,UAEhBvmG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,GAAO,CAAChqG,OAAQ,KAC3C8I,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,KAGtC,MAAO,CACN2qB,IAAK,OACL+kF,KAAM,aAIR,GACC5mG,KAAKumG,YAAY,UAEhBvmG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,GAAO,CAAChqG,OAAQ,KAC3C8I,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,KAGtC,MAAO,CACN2qB,IAAK,QACL+kF,KAAM,cAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,OAAUlhG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,MACzE,MAAO,CACNr/E,IAAK,OACL+kF,KAAM,gCAKR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,eAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,KACL+kF,KAAM,sBAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,OACL+kF,KAAM,gBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,MACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,KACL+kF,KAAM,iBAIR,GAAI5mG,KAAKumG,YAAY,QAAS,CAC7B,UACOtW,EAAU4W,OAAO,MACvB,MAAMa,EAAgB,SAChB/wG,EAAS,EAAAyL,OAAA,MAAanJ,KAAKyL,IAAIgjG,EAAezX,EAAUwW,SAAShvG,OAIvE,SAHMw4F,EAAU+W,WAAWrwG,EAAQ,CAACgwG,WAAW,IAG3ChwG,EAAO4qB,SAAS,EAAAnf,OAAA,KAAY,kBAC/B,MAAO,CACNyf,IAAK,KACL+kF,KAAM,yBAGT,CAAE,MAAOxmF,GAER,KAAMA,aAAiB,MACtB,MAAMA,CAER,CAGA,MAAO,CACNyB,IAAK,MACL+kF,KAAM,kBAER,CAEA,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,GAAM,IAAM,MACjC,MAAO,CACNr/E,IAAK,OACL+kF,KAAM,oBAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,KAAQ,CAC7B,MAAMyG,QAAiB3nG,KAAK4nG,gBAAe,GAC3C,GAAID,EACH,OAAOA,CAET,CAGA,GAAI3nG,KAAKkhG,MAAM,CAAC,GAAM,KAAQ,CAC7B,MAAMyG,QAAiB3nG,KAAK4nG,gBAAe,GAC3C,GAAID,EACH,OAAOA,CAET,CAEA,GAAI3nG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,aAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,IAAM,MAAQ,CACzCjjG,eAAe4pG,IACd,MAAMC,QAAY7X,EAAU8X,WAAW,MACvC,IAAI7gG,EAAO,IACP8gG,EAAK,EAGT,KAAwB,IAAhBF,EAAM5gG,IAAwB,IAATA,KAC1B8gG,EACF9gG,IAAS,EAGV,MAAMtN,EAAK,EAAAwI,OAAA,MAAa4lG,EAAK,GAE7B,aADM/X,EAAU+W,WAAWptG,GACpBA,CACR,CAEAqE,eAAegqG,IACd,MAAMruG,QAAWiuG,IACXK,QAAoBL,IAC1BK,EAAY,IAAM,KAASA,EAAYjxG,OAAS,EAChD,MAAMkxG,EAAWlvG,KAAKyL,IAAI,EAAGwjG,EAAYjxG,QACzC,MAAO,CACN2C,GAAIA,EAAGipB,WAAW,EAAGjpB,EAAG3C,QACxB+E,IAAKksG,EAAYrlF,WAAWqlF,EAAYjxG,OAASkxG,EAAUA,GAE7D,CAEAlqG,eAAemqG,EAAahxB,GAC3B,KAAOA,EAAW,GAAG,CACpB,MAAMixB,QAAgBJ,IACtB,GAAmB,QAAfI,EAAQzuG,GAAgB,CAE3B,aADuBq2F,EAAU8W,UAAU,IAAI,KAAiBsB,EAAQrsG,IAAK,WAC7DyE,QAAQ,UAAW,GACpC,OAEMwvF,EAAU4W,OAAOwB,EAAQrsG,OAC7Bo7E,CACH,CACD,CAEA,MAAM9W,QAAW2nC,IAGjB,aAFsBG,EAAa9nC,EAAGtkE,MAGrC,IAAK,OACJ,MAAO,CACN6lB,IAAK,OACL+kF,KAAM,cAGR,IAAK,WACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,oBAGR,QACC,OAEH,CAGA,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,KAAQ,CACzC,GAAIlhG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,IAAO,CAAChqG,OAAQ,IAC3C,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,iBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,IAAO,CAAChqG,OAAQ,IACjD,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,kBAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,IAAO,CAAChqG,OAAQ,IACjD,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,cAGT,CAEA,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,SACL+kF,KAAM,yBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,KACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,kCAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,yCAIR,GACC5mG,KAAKumG,YAAY,SACdvmG,KAAKumG,YAAY,QAEpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,qCAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,MACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,qBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,MACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,mBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,IAAM,GAAM,MACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,oBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,GAAM,KACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,qBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,KACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,8BAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,UACL+kF,KAAM,yBAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,GAAM,IACvC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,YAIR,GAAI5mG,KAAKumG,YAAY,SACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKumG,YAAY,UACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,mBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,IACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,eAIR,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,KACL+kF,KAAM,cAIR,GACC5mG,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KAChC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,KACnC8I,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,IAEtC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,gCAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,MAAQ,CAEzC,GAAIlhG,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,OACzC,MAAO,CACN2a,IAAK,MACL+kF,KAAM,cAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,OACzC,MAAO,CACN2a,IAAK,MACL+kF,KAAM,aAGT,CAEA,GAAI5mG,KAAKumG,YAAY,QACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,+BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,MACjC,MAAO,CACNr/E,IAAK,QACL+kF,KAAM,uBAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,IAAM,GAAM,GAAM,IAC7C,MAAO,CACNr/E,IAAK,KACL+kF,KAAM,oBAIR,GAAI5mG,KAAKumG,YAAY,UACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,mBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,IAAM,IAAM,IAAM,GAAM,KAC7C,MAAO,CACNr/E,IAAK,KACL+kF,KAAM,+BAIR,GACC5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,IAAM,GAAM,GAAM,MACnB,IAAnBlhG,KAAKrJ,OAAO,IAAiC,IAAnBqJ,KAAKrJ,OAAO,IAE1C,MAAO,CACNkrB,IAAK,MACL+kF,KAAM,gCAIR,GAAI5mG,KAAKumG,YAAY,UACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKumG,YAAY,MAAO,CAC3B,MAAMr9E,EAAUlpB,KAAKrJ,OAAOgO,SAAS,SAAU,EAAG,GAClD,GAAIukB,EAAQ4W,MAAM,QAAU5W,GAAW,KAAQA,GAAW,KACzD,MAAO,CACNrH,IAAK,MACL+kF,KAAM,gBAGT,CAEA,GAAI5mG,KAAKumG,YAAY,UACpB,MAAO,CACN1kF,IAAK,OACL+kF,KAAM,sBAMR,GAAI5mG,KAAKumG,YAAY,WACpB,MAAO,CACN1kF,IAAK,QACL+kF,KAAM,yBAIR,GAAI5mG,KAAKumG,YAAY,WAAY,OAC1BtW,EAAU4W,OAAO,GAEvB,MAAe,wBADM5W,EAAU8W,UAAU,IAAI,KAAiB,GAAI,UAE1D,CACNllF,IAAK,MACL+kF,KAAM,qBAID,CACN/kF,IAAK,KACL+kF,KAAM,6BAER,CAEA,GAAI5mG,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,YAChC+4F,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACM,OAAQ,GAAI0vG,WAAW,IAC5D3mG,KAAKumG,YAAY,KAAM,CAACrvG,OAAQ,MACnC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,gCAOT,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,KAAQ,CAWjEjjG,eAAeqqG,IACd,MAAO,CACNrxG,aAAcg5F,EAAU8W,UAAU,MAClC73F,WAAY+gF,EAAU8W,UAAU,IAAI,KAAiB,EAAG,WAE1D,OAPM9W,EAAU4W,OAAO,GASvB,EAAG,CACF,MAAM9/B,QAAcuhC,IACpB,GAAIvhC,EAAM9vE,OAAS,EAClB,OAGD,OAAQ8vE,EAAM73D,MACb,IAAK,OACJ,MAAO,CACN2S,IAAK,MACL+kF,KAAM,aAER,IAAK,OACJ,MAAO,CACN/kF,IAAK,OACL+kF,KAAM,cAER,cACO3W,EAAU4W,OAAO9/B,EAAM9vE,OAAS,GAEzC,OAASg5F,EAAUviD,SAAW,EAAIuiD,EAAUwW,SAAShvG,MAErD,MAAO,CACNoqB,IAAK,MACL+kF,KAAM,YAER,CAEA,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,EAAM,IACzD,MAAO,CACNr/E,IAAK,QACL+kF,KAAM,8BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,GAAM,GAAM,EAAM,EAAM,EAAM,IACzD,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,qBAKR,GACC5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,KAAO,CAAChqG,OAAQ,KAC3C8I,KAAKkhG,MAAM,CAAC,IAAM,IAAM,GAAM,KAAO,CAAChqG,OAAQ,KAC9C8I,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,KAAO,CAAChqG,OAAQ,KAC9C8I,KAAKkhG,MAAM,CAAC,IAAM,IAAM,IAAM,KAAO,CAAChqG,OAAQ,IAEjD,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,mBAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,GAAM,EAAM,EAAM,EAAM,EAAM,KAC/D,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,uBAIR,GAAI5mG,KAAKumG,YAAY,aACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,eAMR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,EAAM,GAAM,EAAM,EAAM,EAAM,IAAM,IAAM,IAAM,MACjF,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,yBAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,MAAQ,CAC7EjjG,eAAegtE,IACd,MAAMs9B,EAAO,EAAAnmG,OAAA,MAAa,IAE1B,aADM6tF,EAAU+W,WAAWuB,GACpB,CACN3uG,GAAI2uG,EACJ9wG,KAAMuR,aAAainF,EAAU8W,UAAU,OAEzC,CAIA,UAFM9W,EAAU4W,OAAO,IAEhB5W,EAAUviD,SAAW,GAAKuiD,EAAUwW,SAAShvG,MAAM,CACzD,MAAMghC,QAAewyC,IACrB,IAAI71B,EAAU3c,EAAOhhC,KAAO,GAC5B,GAAI4uG,EAAO5tE,EAAO7+B,GAAI,CAAC,IAAM,EAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,EAAM,IAAM,GAAM,GAAM,GAAM,MAAQ,CAExH,MAAM4uG,EAAS,EAAApmG,OAAA,MAAa,IAG5B,GAFAgzC,SAAiB66C,EAAU+W,WAAWwB,GAElCnC,EAAOmC,EAAQ,CAAC,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,EAAM,IAAM,GAAM,GAAM,GAAM,KAE7G,MAAO,CACN3mF,IAAK,MACL+kF,KAAM,kBAIR,GAAIP,EAAOmC,EAAQ,CAAC,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,EAAM,IAAM,GAAM,GAAM,GAAM,KAE7G,MAAO,CACN3mF,IAAK,MACL+kF,KAAM,kBAIR,KACD,OAEM3W,EAAU4W,OAAOzxD,EACxB,CAGA,MAAO,CACNvzB,IAAK,MACL+kF,KAAM,yBAER,CAEA,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,IAAM,GAAM,GAAM,GAAM,KACjF,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,IAAK5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,KAAUlhG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,MAAWlhG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,IAAO,CAAChqG,OAAQ,IACvH,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,qBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,GAAO,CAAChqG,OAAQ,IACjG,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,4BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,IAAM,KACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,GAAM,IAAM,GAAM,GAAM,GAAM,GAAM,GAAM,IAAM,KAAQ,OAGnFjR,EAAU4W,OAAO,IAEvB,aADmB5W,EAAU8W,UAAU,IAAI,KAAiB,EAAG,WAE9D,IAAK,OACJ,MAAO,CACNllF,IAAK,MACL+kF,KAAM,aAER,IAAK,OACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,aAER,IAAK,OACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,aAER,IAAK,OACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,aAER,QACC,OAEH,CAEA,GACC5mG,KAAKkhG,MAAM,CAAC,IAAM,MACflhG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,IAAM,KAEjF,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,aAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,MACrB,OAAIlhG,KAAKkhG,MAAM,CAAC,EAAG,GAAI,EAAG,GAAI,EAAG,IAAK,EAAG,IAAK,EAAG,KAAM,CAAChqG,OAAQ,IACxD,CACN2qB,IAAK,MACL+kF,KAAM,wBAIR,EAKD,GACC5mG,KAAKkhG,MAAM,CAAC,EAAK,EAAK,EAAK,OACxBlhG,KAAKkhG,MAAM,CAAC,EAAK,EAAK,EAAK,MAE9B,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,cAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,EAAM,IACvC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,YAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,IACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,gBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,IACjC,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,gBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,MAEzD,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,qBASR,SAJM3W,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACM,OAAQgC,KAAKyL,IAAI,IAAKurF,EAAUwW,SAAShvG,MAAOkvG,WAAW,IAIhG3mG,KAAKumG,YAAY,UAAW,CAC/B,GAAIvmG,KAAKumG,YAAY,QAAS,CAACrvG,OAAQ,IACtC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,cAIR,GAAI5mG,KAAKumG,YAAY,YAAa,CAACrvG,OAAQ,IAC1C,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,gBAGT,CAGA,GAAI5mG,KAAKumG,YAAY,mBACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,wBAIR,GAAI5mG,KAAKumG,YAAY,oBACpB,MAAO,CACN1kF,IAAK,KACL+kF,KAAM,cAIR,GAAI5mG,KAAKumG,YAAY,uBACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,eAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,EAAM,KAAUlhG,KAAKrJ,OAAOM,QAAU,GAAI,CACrE,MAAMwxG,EAAWzoG,KAAKrJ,OAAOysB,aAAa,IAC1C,GAAIqlF,EAAW,IAAMzoG,KAAKrJ,OAAOM,QAAUwxG,EAAW,GACrD,IACC,MAAMhwE,EAASz4B,KAAKrJ,OAAOmC,MAAM,GAAI2vG,EAAW,IAAI9jG,WAGpD,GAFau1B,KAAKlO,MAAMyM,GAEf4V,MACR,MAAO,CACNxsB,IAAK,OACL+kF,KAAM,qBAGT,CAAE,MAAO,CAEX,CAEA,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,GAAM,GAAM,GAAM,EAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,EAAM,IAC7F,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,mBAIR,GAAI5mG,KAAKumG,YAAY,OAAQ,CAACrvG,OAAQ,KACrC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,eAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,MAAUlhG,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,MACrD,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,cAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,KAAO8I,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,MAClE,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,cAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,IAAO,CAAChqG,OAAQ,KACzE,MAAO,CACN2qB,IAAK,OACL+kF,KAAM,kCAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,GAAM,GAAM,IAAO,CAAChqG,OAAQ,MACjD,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,qBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,EAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,IAAM,EAAM,EAAM,EAAM,EAAM,EAAM,EAAM,KACjI,MAAO,CACNr/E,IAAK,MACL+kF,KAAM,6BAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAM,IAAM,IAAM,IAAM,EAAM,EAAM,EAAM,EAAM,IAAM,GAAM,IAAM,IAAM,EAAM,EAAM,EAAM,IACzG,MAAO,CACNr/E,IAAK,QACL+kF,KAAM,6BAIR,GACC5mG,KAAKkhG,MAAM,CAAC,GAAM,IAAO,CAAChqG,OAAQ,OAEjC8I,KAAKkhG,MAAM,CAAC,EAAM,EAAM,GAAO,CAAChqG,OAAQ,KACrC8I,KAAKkhG,MAAM,CAAC,EAAM,EAAM,GAAO,CAAChqG,OAAQ,KACxC8I,KAAKkhG,MAAM,CAAC,EAAM,EAAM,GAAO,CAAChqG,OAAQ,KAG5C,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,iCAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,EAAM,EAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,KACzG,MAAO,CACNr/E,IAAK,OACL+kF,KAAM,0BAQR,SAHM3W,EAAUyW,WAAW1mG,KAAKrJ,OAAQ,CAACM,OAAQgC,KAAKyL,IAAI,IAAKurF,EAAUwW,SAAShvG,MAAOkvG,WAAW,IDx5C/F,SAAkChwG,EAAQO,EAAS,GACzD,MAAMwxG,EAAU1/F,OAAOtC,SAAS/P,EAAOgO,SAAS,OAAQ,IAAK,KAAKlE,QAAQ,QAAS,IAAIyY,OAAQ,GAC/F,GAAIlQ,OAAOikB,MAAMy7E,GAChB,OAAO,EAGR,IAAIx1B,EAAM,IAEV,IAAK,IAAI7oD,EAAQnzB,EAAQmzB,EAAQnzB,EAAS,IAAKmzB,IAC9C6oD,GAAOv8E,EAAO0zB,GAGf,IAAK,IAAIA,EAAQnzB,EAAS,IAAKmzB,EAAQnzB,EAAS,IAAKmzB,IACpD6oD,GAAOv8E,EAAO0zB,GAGf,OAAOq+E,IAAYx1B,CACpB,CC04CMy1B,CAAyB3oG,KAAKrJ,QACjC,MAAO,CACNkrB,IAAK,MACL+kF,KAAM,qBAIR,GAAI5mG,KAAKkhG,MAAM,CAAC,IAAM,MACrB,OAAIlhG,KAAKkhG,MAAM,CAAC,GAAI,EAAG,GAAI,EAAG,IAAK,EAAG,IAAK,EAAG,IAAK,GAAI,CAAChqG,OAAQ,IACxD,CACN2qB,IAAK,MACL+kF,KAAM,mBAIJ5mG,KAAKkhG,MAAM,CAAC,IAAM,GAAM,GAAM,EAAM,IAAM,EAAM,IAAM,EAAM,IAAM,EAAM,GAAM,EAAM,IAAM,EAAM,GAAM,EAAM,IAAM,EAAM,GAAM,EAAM,GAAM,EAAM,IAAM,EAAM,IAAM,EAAM,IAAM,EAAM,IAAM,GAAO,CAAChqG,OAAQ,IACtM,CACN2qB,IAAK,MACL+kF,KAAM,qCAIR,EAGD,GAAI5mG,KAAKumG,YAAY,+BACpB,MAAO,CACN1kF,IAAK,MACL+kF,KAAM,6BAKR,GAAI5mG,KAAKrJ,OAAOM,QAAU,GAAK+I,KAAKkhG,MAAM,CAAC,IAAM,KAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,IAAM,OAAS,CACzF,GAAIlH,KAAKkhG,MAAM,CAAC,IAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,MAEzC,OAAIlH,KAAKkhG,MAAM,CAAC,GAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,KAClC,CACN2a,IAAK,MACL+kF,KAAM,aAaT,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,KACzC,MAAO,CACN2a,IAAK,MACL+kF,KAAM,cAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,KACzC,MAAO,CACN2a,IAAK,MACL+kF,KAAM,cAKR,GAAI5mG,KAAKkhG,MAAM,CAAC,GAAO,CAAChqG,OAAQ,EAAGgQ,KAAM,CAAC,KACzC,MAAO,CACN2a,IAAK,MACL+kF,KAAM,aAGT,CACD,CAEA3oG,kBAAkB2qG,GACjB,MAAMC,QAAc7oG,KAAKiwF,UAAU8W,UAAU6B,EAAY,KAAkB,KAE3E,OADA5oG,KAAKiwF,UAAU4W,OAAO,IACdgC,GACP,KAAK,MACJ,MAAO,CACNhnF,IAAK,MACL+kF,KAAM,oBAER,KAAK,MACJ,MAAO,CACN/kF,IAAK,MACL+kF,KAAM,qBAIV,CAEA3oG,kBAAkB2qG,GACjB,MAAME,QAAqB9oG,KAAKiwF,UAAU8W,UAAU6B,EAAY,KAAkB,KAClF,IAAK,IAAInwG,EAAI,EAAGA,EAAIqwG,IAAgBrwG,EAAG,CACtC,MAAMkvG,QAAiB3nG,KAAK+oG,YAAYH,GACxC,GAAIjB,EACH,OAAOA,CAET,CACD,CAEA1pG,qBAAqB2qG,GACpB,MAAM1/E,GAAW0/E,EAAY,KAAkB,KAAiBjoG,IAAIX,KAAKrJ,OAAQ,GAC3EqyG,GAAaJ,EAAY,KAAkB,MAAiBjoG,IAAIX,KAAKrJ,OAAQ,GAEnF,GAAgB,KAAZuyB,EAAgB,CAEnB,GAAI8/E,GAAa,EAAG,CACnB,GAAIhpG,KAAKumG,YAAY,KAAM,CAACrvG,OAAQ,IACnC,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,qBAIR,GAAIoC,GAAa,IAAMhpG,KAAKkhG,MAAM,CAAC,GAAM,EAAM,IAAM,GAAO,CAAChqG,OAAQ,KAAO8I,KAAKkhG,MAAM,CAAC,GAAM,EAAM,GAAM,GAAO,CAAChqG,OAAQ,KACzH,MAAO,CACN2qB,IAAK,MACL+kF,KAAM,oBAGT,OAEM5mG,KAAKiwF,UAAU4W,OAAOmC,GAE5B,aADuBhpG,KAAKipG,YAAYL,IACrB,CAClB/mF,IAAK,MACL+kF,KAAM,aAER,CAEA,GAAgB,KAAZ19E,EACH,MAAO,CACNrH,IAAK,MACL+kF,KAAM,aAGT,EAsCkC,IAAIlyF,IAAI,KACT,IAAIA,IAAI,0EC1lDnC,MAAMw0F,EAAwB,CACjCl9E,MAAOkO,KAAKlO,MACZyU,UAAWvG,KAAKuG,gDCKpB,MAAM0oE,EAA6BtqG,GAAUuvC,EAAkBvvC,IAChD,OAAVA,GAAmC,iBAAVA,GAA4C,mBAAfA,EAAMuqG,KAqCjE,MA/B0B,CAACptD,EAAOqtD,EAAWC,EAAeC,EAAiBL,KACzE,MAAM,MAAEjuE,EAAK,MAAEoT,GAAUF,EAAa,CAAE6N,QAAOqtD,YAAWC,iBAAiB,GAAIH,GAC/E,GAAmB,IAAf96D,EAAM52C,KAAY,CAClB,IAAKmB,MAAMuJ,QAAQ65C,GACf,OAAOutD,EAAe9oE,UAAUxF,GAEpC,QAAyB,IAAdouE,IAA8BzwG,MAAMuJ,QAAQknG,GACnD,MAAM,IAAI9wG,MAAM,uEAGpB,MAAM68C,EAAU4G,EAAM5sB,QAAO,CAACo6E,EAAMC,EAAcp/E,KAC9Cm/E,EAAK9xG,KAAK,CAAEskD,MAAOytD,EAAcJ,UAAWA,EAAYA,EAAUh/E,QAAS3iB,IACpE8hG,IACR,IACH,OAAOD,EAAe9oE,UAAU2U,EACpC,CACA,MACMxa,EAAO,IADoB,oBAAbpB,SAA2B,EAAeA,UAE9DoB,EAAKpC,OAAO,aAAc+wE,EAAe9oE,UAAUxF,IACnD,MAAMrgB,EAAM,CAAC,EACb,IAAItf,EAAI,EASR,OARA+yC,EAAMjuC,SAASmuC,IACX3zB,IAAMtf,GAAKizC,CAAK,IAEpB3T,EAAKpC,OAAO,MAAO+wE,EAAe9oE,UAAU7lB,IAC5Ctf,EAAI,EACJ+yC,EAAMjuC,SAAQ,CAACmuC,EAAOn2C,KAClBwiC,EAAKpC,OAAO,MAAKl9B,EAAKlD,EAAK,IAExBwiC,CAAI,4BCvCf,MAAM8uE,EAAwB9nE,IAC1B,IAAI0nE,EACJ,MAAMK,EAAuB/nE,EAASgoE,YAAY1xF,QAAQ2xF,GAAmC,wBAApBA,EAAWC,OAIpF,OAHoC,IAAhCH,EAAqB1yG,SACrBqyG,EAAgBK,EAAqB,IAAItqG,MAAMR,OAE5CyqG,CAAa,EAEXS,EAA0BnoE,IACnC,GAAwB,iBAAbA,EAAuB,CAC9B,IAAI0nE,EACJ,IACI,MAAMU,GAAiB,QAAMpoE,GAC7B0nE,EAAgBI,EAAqBM,EACzC,CACA,MAAOpkG,GAEP,CACA,MAAO,CAAEo2C,MAAOpa,EAAU0nE,gBAC9B,CACA,MAAMA,EAAgBI,EAAqB9nE,GAC3C,MAAO,CAAEoa,OAAO,OAAMpa,GAAW0nE,gBAAe,ECzB7C,MAAMW,UAAoB1xG,MAC7BuH,YAAY+F,EAAUN,GAKlBoN,MAJgB,GAAGs3F,EAAYC,eAAerkG,OAAcq0B,KAAKuG,UAAU,CACvE56B,WACAN,eAGJ7G,OAAO8c,eAAexb,KAAMiqG,EAAYpxG,WACxCmH,KAAK6F,SAAWA,EAChB7F,KAAKuF,QAAUA,EAEwB,mBAA5BhN,MAAMwP,mBACbxP,MAAMwP,kBAAkB/H,KAAMiqG,EAEtC,CACAhxF,sBAAsBpT,GAClB,OAAOA,EAAS0gB,SAAS,IAAI1e,SAAW,wBAAwBhC,EAAS8O,SAC7E,qCCNJ,MAAMw1F,EAAkB5xE,IACpB,IAAI6xE,EAAW,CAAC,EAiBhB,OAhBI7xE,IACwB,oBAAZD,SAA2BC,aAAmBD,SACrD,GAAc,WAAsBC,aAAmB,UACxD6xE,ECZgC,CAAC7xE,IACzC,MAAMx6B,EAAI,CAAC,EAIX,OAHAw6B,EAAQn4B,SAAQ,CAACmxB,EAAGre,KAChBnV,EAAEmV,GAAKqe,CAAC,IAELxzB,CAAC,EDOWssG,CAA6B9xE,GAEnC3/B,MAAMuJ,QAAQo2B,GACnBA,EAAQn4B,SAAQ,EAAEf,EAAMR,MAChBQ,QAAkBqI,IAAV7I,IACRurG,EAAS/qG,GAAQR,EACrB,IAIJurG,EAAW7xE,GAGZ6xE,CAAQ,EAKbE,EAAcjvG,GAAQA,EAAIoF,QAAQ,sBAAuB,KAAKyY,OA8B9DqxF,EAA2BnlG,GAAWnH,MAAO00B,IAC/C,MAAM,IAAE6H,EAAG,MAAEwhB,EAAK,UAAEqtD,EAAS,cAAEC,EAAa,MAAE9xE,EAAK,aAAEgzE,EAAY,WAAEC,GAAe93E,EAC5E4F,EAAU,IAAK5F,EAAO4F,SAC5B,IACIhC,EADAm0E,EAAc,GAEH,SAAXtlG,GACAmxB,EAAO,EAAkBylB,EAAOqtD,EAAWC,EAAekB,EAAajB,gBACnD,iBAAThzE,IAEPgC,EAAQ,gBAAkB,qBAK9BmyE,EAxCmB,CAAC/3E,IACxB,IAAK/5B,MAAMuJ,QAAQwwB,EAAOqpB,OAAQ,CAC9B,MAAM2uD,EAAUh4E,EACVi4E,EAAS,CAAC,SAASjL,mBAAmB2K,EAAWK,EAAQ3uD,WAO/D,OANIrpB,EAAO02E,WACPuB,EAAOlzG,KAAK,aAAaioG,mBAAmBgL,EAAQpB,eAAe9oE,UAAUkqE,EAAQtB,eAErFsB,EAAQrB,eACRsB,EAAOlzG,KAAK,iBAAiBioG,mBAAmBgL,EAAQrB,kBAErDsB,EAAOjzG,KAAK,IACvB,CACA,QAAgC,IAArBg7B,EAAO02E,YAA8BzwG,MAAMuJ,QAAQwwB,EAAO02E,WACjE,MAAM,IAAI9wG,MAAM,gEAGpB,MAAMoyG,EAAUh4E,EACVyiB,EAAUziB,EAAOqpB,MAAM5sB,QAAO,CAACtd,EAAK23F,EAAcp/E,KACpDvY,EAAIpa,KAAK,CACLskD,MAAOsuD,EAAWb,GAClBJ,UAAWsB,EAAQtB,UAAYsB,EAAQpB,eAAe9oE,UAAUkqE,EAAQtB,UAAUh/E,SAAU3iB,IAEzFoK,IACR,IACH,MAAO,SAAS6tF,mBAAmBgL,EAAQpB,eAAe9oE,UAAU2U,KAAW,EAgB7Dy1D,CAAmB,CAC7B7uD,QACAqtD,YACAC,gBACAC,eAAgBiB,EAAajB,gBAAkBL,IAGvD,MAAM9tE,EAAO,CACTh2B,SACAmzB,UACAhC,UACGi0E,GAEP,IAAIM,EAActwE,EACduwE,EAAe3vE,EACnB,GAAIqvE,EAAY,CACZ,MAAM7wF,QAAepI,QAAQC,QAAQg5F,EAAW,IAAKrvE,EAAMZ,MAAK8uE,gBAAeD,gBACvE7uE,IAAKwwE,KAAWC,GAAYrxF,EACpCkxF,EAAcE,EACdD,EAAeE,CACnB,CAIA,OAHIP,IACAI,EAAc,GAAGA,KAAeJ,WAEvBlzE,EAAMszE,EAAaC,EAAa,EAK1C,MAAMG,EACTprG,YAAY06B,EAAK2wE,EAAgB,CAAC,GAC9BnrG,KAAKw6B,IAAMA,EACXx6B,KAAKmrG,cAAgBA,EAIrBnrG,KAAKorG,WAAantG,SAAU2B,KACxB,MAAOyrG,EAAgBhC,EAAWiC,GAAkB1rG,EAC9C2rG,EE1GiB,EAACF,EAAgBhC,EAAWiC,IACpDD,EAAervD,MAChBqvD,EACA,CACErvD,MAAOqvD,EACPhC,UAAWA,EACXiC,eAAgBA,EAChBrjF,YAAQvgB,GFmGkB8jG,CAAoBH,EAAgBhC,EAAWiC,IACnE,QAAE/yE,EAAO,MAAEf,EAAQ,EAAU,OAAEpyB,EAAS,OAAM,kBAAEqmG,EAAiB,mBAAEC,KAAuBlB,GAAiBxqG,KAAKmrG,eAChH,IAAE3wE,GAAQx6B,UACiB0H,IAA7B6jG,EAAkBtjF,SAClBuiF,EAAaviF,OAASsjF,EAAkBtjF,QAE5C,MAAM,cAAEqhF,GAAkBS,EAAuBwB,EAAkBvvD,OACnE,OAAO2vD,EAAY,CACfnxE,MACAwhB,MAAOuvD,EAAkBvvD,MACzBqtD,UAAWkC,EAAkBlC,UAC7B9wE,QAAS,IACF4xE,EAAeyB,EAAerzE,OAC9B4xE,EAAeoB,EAAkBD,iBAExChC,gBACA9xE,QACApyB,SACAolG,eACAC,WAAYgB,IAEXj+E,MAAM3nB,IACH6lG,GACAA,EAAmB7lG,GAEhBA,KAEN4nB,OAAOrN,IAIR,MAHIsrF,GACAA,EAAmBtrF,GAEjBA,CAAK,GACb,CAEV,CACAniB,cAAc4tG,KAAsBC,GAChC,MAAOzC,EAAWiC,GAAkBQ,EAC9BC,EEzJkB,EAACF,EAAmBxC,EAAWiC,IACpDO,EAAkBjqE,SACnBiqE,EACA,CACEjqE,SAAUiqE,EACVxC,UAAWA,EACXiC,eAAgBA,EAChBrjF,YAAQvgB,GFkJWskG,CAAiBH,EAAmBxC,EAAWiC,IAChE,QAAE/yE,EAAO,MAAEf,EAAQ,EAAU,OAAEpyB,EAAS,OAAM,kBAAEqmG,EAAiB,mBAAEC,KAAuBlB,GAAiBxqG,KAAKmrG,eAChH,IAAE3wE,GAAQx6B,UACc0H,IAA1BqkG,EAAe9jF,SACfuiF,EAAaviF,OAAS8jF,EAAe9jF,QAEzC,MAAM,MAAE+zB,EAAK,cAAEstD,GAAkBS,EAAuBgC,EAAenqE,UACvE,OAAO+pE,EAAY,CACfnxE,MACAwhB,QACAqtD,UAAW0C,EAAe1C,UAC1B9wE,QAAS,IACF4xE,EAAeyB,EAAerzE,OAC9B4xE,EAAe4B,EAAeT,iBAErChC,gBACA9xE,QACApyB,SACAolG,eACAC,WAAYgB,IAEXj+E,MAAM3nB,IACH6lG,GACAA,EAAmB7lG,GAEhBA,EAAS4W,QAEfgR,OAAOrN,IAIR,MAHIsrF,GACAA,EAAmBtrF,GAEjBA,CAAK,GAEnB,CAEA6rF,cAAcC,EAAoBZ,GAC9B,MAAMa,EEzKuB,EAACD,EAAoBZ,IAC/CY,EAAmBE,UACpBF,EACA,CACEE,UAAWF,EACXZ,eAAgBA,EAChBrjF,YAAQvgB,GFmKgB2kG,CAAsBH,EAAoBZ,IAChE,QAAE/yE,KAAYiyE,GAAiBxqG,KAAKmrG,mBACPzjG,IAA/BykG,EAAoBlkF,SACpBuiF,EAAaviF,OAASkkF,EAAoBlkF,QAE9C,MAAMqkF,EAAUH,EAAoBC,UAAUxxF,KAAI,EAAGgnB,cAAemoE,EAAuBnoE,GAAUoa,QAC/FqtD,EAAY8C,EAAoBC,UAAUxxF,KAAI,EAAGyuF,eAAgBA,IACvE,OAAOsC,EAAY,CACfnxE,IAAKx6B,KAAKw6B,IACVwhB,MAAOswD,EAEPjD,YACA9wE,QAAS,IACF4xE,EAAeyB,EAAerzE,OAC9B4xE,EAAegC,EAAoBb,iBAE1ChC,mBAAe5hG,EACf8vB,MAAOx3B,KAAKmrG,cAAc3zE,OAAS,EACnCpyB,OAAQpF,KAAKmrG,cAAc/lG,QAAU,OACrColG,eACAC,WAAYzqG,KAAKmrG,cAAcM,oBAE9Bj+E,MAAM3nB,IACH7F,KAAKmrG,cAAcO,oBACnB1rG,KAAKmrG,cAAcO,mBAAmB7lG,GAEnCA,EAAS4W,QAEfgR,OAAOrN,IAIR,MAHIpgB,KAAKmrG,cAAcO,oBACnB1rG,KAAKmrG,cAAcO,mBAAmBtrF,GAEpCA,CAAK,GAEnB,CACAmsF,WAAWh0E,GAEP,OADAv4B,KAAKmrG,cAAc5yE,QAAUA,EACtBv4B,IACX,CAIAwsG,UAAUr+F,EAAKtP,GACX,MAAM,QAAE05B,GAAYv4B,KAAKmrG,cASzB,OARI5yE,EAGAA,EAAQpqB,GAAOtP,EAGfmB,KAAKmrG,cAAc5yE,QAAU,CAAE,CAACpqB,GAAMtP,GAEnCmB,IACX,CAIAysG,YAAY5tG,GAER,OADAmB,KAAKw6B,IAAM37B,EACJmB,IACX,EAEJ,MAAM2rG,EAAc1tG,MAAO00B,IACvB,MAAM,MAAEqpB,EAAK,UAAEqtD,EAAS,aAAEmB,GAAiB73E,EACrC+5E,EAAUnC,GAAkC53E,EAAOvtB,QAAU,QC7PjCs1B,eD8PlC,MAAMiyE,EAAkB/zG,MAAMuJ,QAAQwwB,EAAOqpB,OACvCn2C,QAAiB6mG,EAAQ/5E,GACzB/Y,QAAegzF,EAAU/mG,EAAU2kG,EAAajB,gBAAkBL,GAClE2D,EAA2Bj0G,MAAMuJ,QAAQyX,IACxCA,EAAOkzF,MAAK,EAAGrwF,WAAYA,IAC5BvX,QAAQ0U,EAAO6C,MACfswF,EAAgCn0G,MAAMuJ,QAAQyX,KAC/CA,EAAO2M,QACP3tB,MAAMuJ,QAAQyX,EAAO2M,UAAY3M,EAAO2M,OAAOtvB,QACnB,QAA7BuzG,EAAawC,aACgB,WAA7BxC,EAAawC,YACjB,GAAInnG,EAASk1B,IAAMgyE,GAAiCF,EAA0B,CAE1E,MAAM,OAAEtmF,KAAW0mF,IAASr0G,MAAMuJ,QAAQyX,GAAUA,GAC9C6C,EAAoC,WAA7B+tF,EAAawC,YAA2BC,EAAOrzF,EAG5D,MAAO,IAFc+yF,EAAkB,CAAElwF,QAASA,EAI9C8b,QAAS1yB,EAAS0yB,QAClB5jB,OAAQ9O,EAAS8O,OAEzB,CAOI,MAAM,IAAIs1F,EAEV,IAPsC,iBAAXrwF,EACrB,CACEwG,MAAOxG,GAETA,EAGYjF,OAAQ9O,EAAS8O,OAAQ4jB,QAAS1yB,EAAS0yB,SAAW,CAAEyjB,QAAOqtD,aACrF,EA4EJ,MAAMuD,EAAY3uG,MAAO4H,EAAU0jG,KAC/B,IAAI2D,EAMJ,OALArnG,EAAS0yB,QAAQn4B,SAAQ,CAACvB,EAAOsP,KACH,iBAAtBA,EAAI5D,gBACJ2iG,EAAcruG,EAClB,IAEAquG,IACCA,EAAY3iG,cAAcwzD,WAAW,qBAClCmvC,EAAY3iG,cAAcwzD,WAAW,6BACrCmvC,EAAY3iG,cAAcwzD,WAAW,sCAClCwrC,EAAev9E,YAAYnmB,EAASi0B,QAGpCj0B,EAASi0B,MACpB,EAEE8xE,EAAkB/sG,GACI,mBAAVA,EAAuBA,IAAUA,uHGzX5C,MAAMsuG,EACTrtG,YAAYsO,EAASgL,EAAQg0F,EAAc,GACvCptG,KAAK27E,SAAWvtE,EAChBpO,KAAKqtG,UAAY,EACjBrtG,KAAK+7E,QAAU3iE,EACfpZ,KAAKi8E,aAAemxB,EACpBptG,KAAKi2E,UAAY,IAAI,EACrBj2E,KAAKmO,IAAM,IACf,CACAlQ,UAAUkQ,EAAKtP,GACX,MAAMyuG,QAActtG,KAAK67E,qBAAqB1tE,SACxCm/F,EAAMp2B,OAAOq2B,OAAOD,EAAOn/F,EAAKtP,EAC1C,CACAZ,UAAUkQ,GACN,MAAMugC,QAAc1uC,KAAKwtG,WAAWr/F,GACpC,GAAa,MAATugC,EACA,OAAOA,EAAM7vC,KAErB,CACAZ,UAAUkQ,GACN,MAAMm/F,QAActtG,KAAKytG,WAAWt/F,GAC9BugC,EAAQ4+D,EAAMp2B,OAAOw2B,IAAIJ,EAAMrrG,KACxB,MAATysC,GAAiBA,EAAMvgC,MAAQA,GAC/Bm/F,EAAMp2B,OAAOy2B,OAAOL,EAAMrrG,IAElC,CACA80E,YAEI,OADiB/2E,KAAKi2E,UAAU23B,eAChBx+E,QAAO,CAACtd,EAAK48B,IACrBA,aAAiBy+D,EACVr7F,EAAM48B,EAAMqoC,YAEhBjlE,EAAM,GACd,EACP,CACAklE,gBACI,OAAOh3E,KAAKi2E,UAAUh/E,MAC1B,CACAm/E,YACI,OAAOp2E,KAAKi2E,UAAUt1E,IAAI,EAC9B,CACA,kBACI,MAAMy2E,EAAWp3E,KAAKi2E,UAAU23B,eAChC,IAAK,MAAMl/D,KAAS0oC,EACZ1oC,aAAiBy+D,QACVz+D,EAAMuoC,uBAGPvoC,CAGlB,CACAzgB,UAAUrT,EAAKwU,GAGX,OAAOA,EAAOpvB,KAAKi2E,UAAU7mD,QAAO,CAACtd,EAAK48B,EAAOrkB,KAChC,MAATqkB,IACIA,aAAiBy+D,EACjBr7F,EAAIpa,KAAKg3C,EAAMzgB,UAAUrT,EAAKwU,IAG9Btd,EAAIpa,KAAKkjB,EAAI8zB,EAAOrkB,KAGrBvY,IAXC,IAahB,CACA7T,qBAAqB4vG,EAAUC,GAC3B,aAAaC,EAAqB/tG,KAAM6tG,EAAUC,EACtD,CACAtsF,SACI,OAAOxhB,KAAKiuB,UAAU+/E,EAASC,EACnC,CACAC,cACI,OAAOh0E,KAAKuG,UAAUzgC,KAAKwhB,SAAU,KAAM,KAC/C,CACA81D,YACI,OAAOr+E,KAAK6qB,IAAI,EAAG9jB,KAAK27E,SAASp5E,KACrC,CACAtE,iBAAiBkQ,GACb,MAAMyL,QAAe5Z,KAAKytG,WAAWt/F,GAC/BugC,EAAQ90B,EAAOs9D,OAAOw2B,IAAI9zF,EAAO3X,KACvC,KAAIysC,aAAiBy+D,GAKrB,OAAa,MAATz+D,GAAiBA,EAAMvgC,MAAQA,EACxBugC,OADX,CAGJ,CACAzwC,iBAAiBkQ,GACb,MAAMkxE,EAAYr/E,KAAK27E,SAASr8E,KAAoB,iBAAR6O,GAAmB,OAAqBA,GAAOA,GACrFkc,QAAcg1D,EAAU5zB,KAAKzrD,KAAK27E,SAASp5E,MAC3CmsC,EAAQ1uC,KAAKi2E,UAAUt1E,IAAI0pB,GACjC,OAAIqkB,aAAiBy+D,QACJz+D,EAAM++D,WAAWpuB,GAE3B,CACHnI,OAAQl3E,KACRiC,IAAKooB,EACL/qB,KAAM+/E,EACN8uB,cAAez/D,EAEvB,CACAzwC,2BAA2BkQ,GACvB,MAAMm/F,QAActtG,KAAKytG,WAAWt/F,GACpC,GAA4B,MAAvBm/F,EAAMa,eAA0Bb,EAAMa,cAAchgG,MAAQA,EAAK,CAElE,MAAM+oE,EAAS,IAAIi2B,EAAOntG,KAAK27E,SAAU2xB,EAAMp2B,OAAQo2B,EAAMrrG,KAC7DqrG,EAAMp2B,OAAOwE,aAAa4xB,EAAMrrG,IAAKi1E,GAErC,MAAMk3B,QAAiBl3B,EAAOu2B,WAAWH,EAAMa,cAAc7uG,MAE7D,OADA8uG,EAASl3B,OAAOq2B,OAAOa,EAAUd,EAAMa,cAAchgG,IAAKm/F,EAAMa,cAActvG,aACjEq4E,EAAO2E,qBAAqByxB,EAAMhuG,KACnD,CAEA,OAAOguG,CACX,CACAC,OAAOD,EAAOn/F,EAAKtP,GACfmB,KAAK07E,aAAa4xB,EAAMrrG,IAAK,CACzBkM,IAAKA,EACLtP,MAAOA,EACPS,KAAMguG,EAAMhuG,MAEpB,CACAo8E,aAAaz5E,EAAKsxB,GACiB,MAA3BvzB,KAAKi2E,UAAUt1E,IAAIsB,IACnBjC,KAAKqtG,YAETrtG,KAAKi2E,UAAUp6E,IAAIoG,EAAKsxB,EAC5B,CACAo6E,OAAO1rG,GACH,IAAa,IAATA,EACA,MAAM,IAAI1J,MAAM,oBAEW,MAA3ByH,KAAKi2E,UAAUt1E,IAAIsB,IACnBjC,KAAKqtG,YAETrtG,KAAKi2E,UAAU+M,MAAM/gF,GACrBjC,KAAKquG,QACT,CACAA,SACI,GAAoB,MAAhBruG,KAAK+7E,SAAmB/7E,KAAKqtG,WAAa,EAC1C,GAAuB,IAAnBrtG,KAAKqtG,UAAiB,CAEtB,MAAMj3B,EAAYp2E,KAAKi2E,UAAU/V,KAAK1W,GACtC,GAAkB,MAAb4sB,KAAwBA,aAAqB+2B,GAAS,CACvD,MAAM7tG,EAAO82E,EAAU92E,KACvBA,EAAK4/E,OAAOl/E,KAAK27E,SAASp5E,MAC1B,MAAM+qG,EAAQ,CACVrrG,IAAKjC,KAAKi8E,aACV38E,KAAMA,EACN43E,OAAQl3E,KAAK+7E,SAEjB/7E,KAAK+7E,QAAQwxB,OAAOD,EAAOl3B,EAAUjoE,IAAKioE,EAAUv3E,MACxD,CACJ,MAEImB,KAAK+7E,QAAQ4xB,OAAO3tG,KAAKi8E,aAGrC,CACAyxB,IAAIrjF,GACA,OAAOrqB,KAAKi2E,UAAUt1E,IAAI0pB,EAC9B,EAEJ,SAASm/B,EAAOzrD,GACZ,OAAOmH,QAAQnH,EACnB,CACA,SAASiwG,EAAQvlG,EAAMwgB,GACnB,OAAOxgB,EAAK0F,GAChB,CACA,SAAS8/F,EAAY7pB,GACjB,OAAOA,CACX,CACAnmF,eAAe8vG,EAAqB72B,EAAQ22B,EAAUC,GAClD,MAAMrlE,EAAS,GACf,IAAK,MAAMiG,KAASwoC,EAAOjB,UAAU23B,eACjC,GAAIl/D,aAAiBy+D,QACXY,EAAqBr/D,EAAOm/D,EAAUC,OAE3C,CACD,MAAMQ,QAAuBT,EAASn/D,GACtCjG,EAAO/wC,KAAK,CACRogF,SAAUZ,EAAOjB,UAAU6B,WAC3BV,SAAUk3B,GAElB,CAEJ,aAAaR,EAAYrlE,EAC7B,CClMA,MAAM82C,EAAc,CAChB,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KAEEC,EAAa,CACf,EACA,EACA,EACA,GACA,GACA,GACA,IACA,KAEG,MAAMF,EACTx/E,YAAYjB,GACRmB,KAAK2iD,OAAS9jD,EACdmB,KAAKy/E,gBAAkB5gF,EAAM5H,OAAS,EACtC+I,KAAK0/E,eAAiB,CAC1B,CACAT,gBACI,OAAOj/E,KAAK0/E,eAAiB,EAA2B,EAAvB1/E,KAAKy/E,eAC1C,CACAL,YACI,OAA4B,EAArBp/E,KAAK2iD,OAAO1rD,MACvB,CACAw0D,KAAKlpD,GACD,IAAIw8E,EAAcx8E,EACdqX,EAAS,EACb,KAAOmlE,EAAc,GAAK/+E,KAAK2/E,aAAa,CACxC,MAAMC,EAAO5/E,KAAK2iD,OAAO3iD,KAAKy/E,iBACxBR,EAAgBj/E,KAAK0/E,eAAiB,EACtCG,EAAS5mF,KAAKyL,IAAIu6E,EAAeF,GAEvCnlE,GAAUA,GAAUimE,GADNC,EAAcF,EAAMX,EAAgBY,EAAQA,GAE1Dd,GAAec,EACf7/E,KAAK0/E,gBAAkBG,EACnB7/E,KAAK0/E,eAAiB,IACtB1/E,KAAK0/E,eAAiB,EACtB1/E,KAAKy/E,kBAEb,CACA,OAAO7lE,CACX,CACAslE,OAAO38E,GAEH,IADAvC,KAAK0/E,gBAAkBn9E,EAChBvC,KAAK0/E,eAAiB,GACzB1/E,KAAK0/E,gBAAkB,EACvB1/E,KAAKy/E,iBAAmB,CAEhC,CACAE,YACI,OAAO3/E,KAAKy/E,iBAAmB,CACnC,EAEJ,SAASK,EAAcF,EAAMp8E,EAAOvM,GAChC,MAAMiQ,EAGV,SAAiB1D,EAAOvM,GACpB,OAAOsoF,EAAY/7E,GAASg8E,EAAWvmF,KAAKyL,IAAIzN,EAASuM,EAAQ,EAAG,GACxE,CALiBu8E,CAAQv8E,EAAOvM,GAC5B,OAAQ2oF,EAAO14E,KAAU1D,CAC7B,gBClDO,MAAMi7E,EACT3+E,YAAYjB,EAAOg4E,GACf,KAAMh4E,aAAiBrE,YACnB,MAAM,IAAIjC,MAAM,6BAEpByH,KAAK2iD,OAAS9jD,EACdmB,KAAK0+E,QAAU7H,EACf72E,KAAK2+E,QAAU,EACf3+E,KAAK4+E,eAAiB,EACtB5+E,KAAK6+E,oBAAsB,EAC3B7+E,KAAK8+E,SAAW,EACpB,CACA7gF,WAAWsE,GACP,IAAIw8E,EAAcx8E,EAClB,KAAOvC,KAAK4+E,eAAiBG,SACnB/+E,KAAKg/E,mBAEf,IAAIplE,EAAS,EACb,KAAOmlE,EAAc,GAAG,CACpB,MAAMz/E,EAAOU,KAAK8+E,SAAS9+E,KAAK6+E,qBAC1B5R,EAAYh0E,KAAKyL,IAAIpF,EAAK2/E,gBAAiBF,GAEjDnlE,GAAUA,GAAUqzD,GADP3tE,EAAKmsD,KAAKwhB,GAEvB8R,GAAe9R,EACfjtE,KAAK4+E,gBAAkB3R,EACM,IAAzB3tE,EAAK2/E,iBACLj/E,KAAK6+E,qBAEb,CACA,OAAOjlE,CACX,CACAslE,OAAO38E,GACH,IAAIw8E,EAAcx8E,EAClB,KAAOw8E,EAAc,GAAG,CACpB,MAAMz/E,EAAOU,KAAK8+E,SAAS9+E,KAAK6+E,qBAC1BM,EAAqBlmF,KAAKyL,IAAIpF,EAAK8/E,YAAc9/E,EAAK2/E,gBAAiBF,GAC7Ez/E,EAAK4/E,OAAOC,GACZJ,GAAeI,EACfn/E,KAAK4+E,gBAAkBO,EACnBn/E,KAAK6+E,oBAAsB,GAAKv/E,EAAK8/E,cAAgB9/E,EAAK2/E,kBAC1Dj/E,KAAK2+E,SACL3+E,KAAK6+E,sBAEb,CACJ,CACA5gF,yBACI+B,KAAK2+E,SACL,MAAM9/E,EAAQmB,KAAK2+E,OAAS,GAAI,OAAiB,CAAC3+E,KAAK2iD,OAAQnoD,WAAWgM,KAAK,CAACxG,KAAK2+E,WAAa3+E,KAAK2iD,OACjG08B,QAAkBr/E,KAAK0+E,QAAQ7/E,GAC/BlI,EAAS,IAAI2oF,EAAiBD,GACpCr/E,KAAK8+E,SAASpnF,KAAKf,GACnBqJ,KAAK4+E,gBAAkBjoF,EAAOsoF,eAClC,EChEG,SAASsvB,EAAWngG,GACvB,GAAe,MAAXA,GAAqC,MAAlBA,EAAQyoE,OAC3B,MAAM,IAAIt+E,MAAM,mCAEpB,MAAMi2G,EAAgB,CAClBjsG,KAAM6L,EAAQ7L,MAAQ,EACtBjD,MDNiBu3E,ECMFzoE,EAAQyoE,ODL3B,SAAiBh4E,GACb,OAAIA,aAAiB4/E,EAEV5/E,EAGA,IAAI4/E,EAAa5/E,EAAOg4E,EAEvC,IATG,IAAkBA,ECQrB,OAAO,IAAIs2B,EAAOqB,EACtB,i6LC+GA,IAAIjnG,EArHJ,SAAeqnD,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,EAKA,EAFsCkI,EC5HxB,IAAI/M,WAAW,GAA7B,MAsCM,GAASuD,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAMy3D,GAMJlwD,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM23D,GAMJpwD,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAOD,GAAGtwD,KAAMuwD,EAClB,EAaF,MAAMC,GAIJ1wD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAOD,GAAGtwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAMH,GAAK,CAACI,EAAMC,IAAU,IAAIH,GAA4C,IAC7EE,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAMC,GAOX9wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAIb,GAAQ3wD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAIL,GAAQ7wD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAMyK,GAAO,EAAGnH,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAIwkD,GAAMvxD,EAAMma,EAAQzK,EAAQ3C,GAWrB0kD,GAAQ,EAAGt3C,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,EAAMob,EAAUnoB,GAC3C,OAAOmH,GAAK,CACVgT,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,GAAO1tB,EAAO0tB,KAC/B,EA4GUi3B,GAAU,EAAG1xD,OAAMma,SAAQw3C,cAAaxpC,cAC5ChhB,GAAK,CACVgT,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI8S,CAAOhT,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DImQ,CAAOrQ,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrC,GAAS0xD,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGFc,GAAcf,GAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGFe,GAAYhB,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGFgB,GAAiBjB,GAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGFiB,GAAYlB,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGFkB,GAAiBnB,GAAQ,CACpCv3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGFmB,GAAepB,GAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGFoB,GAAoBrB,GAAQ,CACvCv3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGFqB,GAAUtB,GAAQ,CAC7Bv3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DF,GAAYF,GAAM,CAC7BzxD,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGCirC,GAAe3B,GAAM,CAChCzxD,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCPC,GAASupC,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGF0B,GAAY3B,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGF2B,GAAY5B,GAAQ,CAC/Bv3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGF4B,GAAe7B,GAAQ,CAClCv3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICcR,SAASgP,GAAO3gE,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgBC,CAAqB,GAAG5gE,WAKpC,OAHI,UAAc,GAAGA,YAAuF,MAAtE,aAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,EAAM,GAAG6G,YAEdX,OAAO6W,OAAO,EAAMlW,GAAO,CAC9B+gB,MAAO,EAAM,GAAG/gB,WAChB7G,SAER,CAjDA,eAAsB+4B,GACN,MAALA,EAAY,YAAc,cAAqBA,GAG1D,eAAsBA,GACN,MAALA,EAAY,YAAc,cAAkBA,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAc,cAAkBA,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,mDCjBvC,OAVA,SAAexG,GACX,GAHsC,MAGlBA,EAHP3H,OAAOgc,eAIhB,MAAO,WACH,UAAW,MAAMyW,KAAK9qB,GACzB,EAFM,GAKP,IAAK,MAAM8qB,KAAK9qB,GAExB,ECZI80D,GAOJ,SAAS,EAAOtsB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAOwsB,IACXl3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,GAC/BzsB,GAAO,IAET,KAAMA,EAAM0sB,IACVp3D,EAAI/E,KAAmB,IAANyvC,EAAcysB,GAC/BzsB,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBIm3D,GAAM,IAENC,IAAS,IACTF,GAAMl6D,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAASngB,EAAK5I,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADAjuB,EAAKJ,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAIg3C,KAAWl0D,GACfkd,EAAIg3C,IAAUr6D,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAKi3C,IAId,OAFA5vD,EAAKJ,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BIm0C,GAAQ,IACRD,GAAS,IA2Bb,IAAIE,GAAKv6D,KAAK6qB,IAAI,EAAI,GAClB2vC,GAAKx6D,KAAK6qB,IAAI,EAAG,IACjB4vC,GAAKz6D,KAAK6qB,IAAI,EAAG,IACjB6vC,GAAK16D,KAAK6qB,IAAI,EAAG,IACjB8vC,GAAK36D,KAAK6qB,IAAI,EAAG,IACjB+vC,GAAK56D,KAAK6qB,IAAI,EAAG,IACjBgwC,GAAK76D,KAAK6qB,IAAI,EAAG,IACjBiwC,GAAK96D,KAAK6qB,IAAI,EAAG,IACjBkwC,GAAK/6D,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQkkD,GACR7mD,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ20D,GAAK,EACb30D,EAAQ40D,GAAK,EACb50D,EAAQ60D,GAAK,EACb70D,EAAQ80D,GAAK,EACb90D,EAAQ+0D,GAAK,EACb/0D,EAAQg1D,GAAK,EACbh1D,EAAQi1D,GAAK,EACbj1D,EAAQk1D,GAAK,EACbl1D,EAAQm1D,GAAK,EACA,EAEjB,GCzEO,MAAM,GAAS,CAACv3C,EAAMvlB,EAAS,IAE7B,CADM,UAAculB,EAAMvlB,GACnB,iBAQHg9D,GAAW,CAACC,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI4hD,GAAkBE,GACtB,kBAAsBA,GCjBlBx1D,GAAS,CAAC0P,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAShC,GAAUgxD,IACrB,MAAMhxD,EAAQ,GAAOgxD,IACdlmD,EAAM+lD,GAAc,GAAc7wD,IAClC9L,EAAM48D,GAAgB,GAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI,GAAO8V,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtFF,MAIM,GAAS,GAQF,GAAW,CAAE8K,KAZb,EAYmBhP,KAXnB,WAWuB,OAAQ,UAF5BtD,GAAU,GAVb,EAUiC,GAAOA,KCHxC,GAAO,EAAGsD,OAAMgP,OAAMU,YAAa,IAAIylD,GAAOn1D,EAAMgP,EAAMU,GAWhE,MAAMylD,GAOX10D,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,EC1CF,MAAMk8D,GAAMp1D,GAIVpB,SAAc,IAAIzD,iBAAiBo6C,OAAO8f,OAAOrK,OAAOhrD,EAAMod,IAEnD,GAAS,GAAK,CACzBpd,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,aAGDE,GAAS,GAAK,CACzBt1D,KAAM,WACNgP,KAAM,GACNU,OAAQ0lD,GAAI,6BCjBd,MAAMy7B,GAAU,CACd,SACA,SACA,SACA,UAGIC,GAAkB,CACtB,WACA,YACA,iBACA,oBACA,yBACA,gBACA,aACA,QACA,SACA,SACA,SACA,OACA,QACA,MACA,MACA,UACA,UACA,cACA,oBACA,WACA,UACA,MACA,cACA,YACA,aACA,oBACA,aACA,cACA,aACA,cACA,eACA,eACA,gBACA,kBAOK,SAASC,GAAIvxF,GAClB,GAAc,OAAVA,EACF,MAAO,OAET,QAAc6I,IAAV7I,EACF,MAAO,YAET,IAAc,IAAVA,IAA4B,IAAVA,EACpB,MAAO,UAET,MAAMwxF,SAAgBxxF,EACtB,GAAIqxF,GAAQ3uE,SAAS8uE,GACnB,OAAOA,EAIT,GAAe,aAAXA,EACF,MAAO,WAET,GAAIz3F,MAAMuJ,QAAQtD,GAChB,MAAO,QAET,GAeF,SAAmBA,GACjB,OAAOA,GAASA,EAAMiB,aAAejB,EAAMiB,YAAYuC,UAAYxD,EAAMiB,YAAYuC,SAAStJ,KAAK,KAAM8F,EAC3G,CAjBMwD,CAASxD,GACX,MAAO,SAET,MAAMyxF,EAoBR,SAAwBzxF,GACtB,MAAM0xF,EAAiB7xF,OAAO7F,UAAU8L,SAAS5L,KAAK8F,GAAO/F,MAAM,GAAI,GACvE,GAAIq3F,GAAgB5uE,SAASgvE,GAC3B,OAAOA,EAGT,MACF,CA3BqBC,CAAc3xF,GACjC,OAAIyxF,GAIG,QACT,CCpFA,MAAM,GAMJxwF,YAAa84C,EAAOv5C,EAAMqwF,GACxB1vF,KAAK44C,MAAQA,EACb54C,KAAKypF,aAAe7wC,GAAS,EAC7B54C,KAAKX,KAAOA,EACZW,KAAK0vF,SAAWA,CAClB,CAGA/qF,WACE,MAAO,QAAQ3E,KAAK44C,UAAU54C,KAAKX,MACrC,CAMAmhB,QAASiyE,GAEP,OAAOzyF,KAAK44C,MAAQ65C,EAAI75C,OAAS,EAAI54C,KAAK44C,MAAQ65C,EAAI75C,MAAQ,EAAI,CACpE,EAIF,GAAK6vC,KAAO,IAAI,GAAK,EAAG,QAAQ,GAChC,GAAKe,OAAS,IAAI,GAAK,EAAG,UAAU,GACpC,GAAKjmF,MAAQ,IAAI,GAAK,EAAG,SAAS,GAClC,GAAKG,OAAS,IAAI,GAAK,EAAG,UAAU,GACpC,GAAKmZ,MAAQ,IAAI,GAAK,EAAG,SAAS,GAClC,GAAKjC,IAAM,IAAI,GAAK,EAAG,OAAO,GAC9B,GAAKyY,IAAM,IAAI,GAAK,EAAG,OAAO,GAC9B,GAAKj5B,MAAQ,IAAI,GAAK,EAAG,SAAS,GAClC,GAAKy3F,MAAQ,IAAI,GAAK,EAAG,SAAS,GAClC,GAAKD,KAAO,IAAI,GAAK,EAAG,QAAQ,GAChC,GAAKD,KAAO,IAAI,GAAK,EAAG,QAAQ,GAChC,GAAKjqF,UAAY,IAAI,GAAK,EAAG,aAAa,GAC1C,GAAKotF,MAAQ,IAAI,GAAK,EAAG,SAAS,GAGlC,MAAM,GAMJh1F,YAAaoP,EAAMrQ,EAAOwwF,GACxBrvF,KAAKkP,KAAOA,EACZlP,KAAKnB,MAAQA,EACbmB,KAAKqvF,cAAgBA,EAErBrvF,KAAKkqF,kBAAexiF,EAEpB1H,KAAKyqF,eAAY/iF,CACnB,CAGA/C,WACE,MAAO,SAAS3E,KAAKkP,SAASlP,KAAKnB,OACrC,EC3DK,MAAM6vF,GAAY5mE,WAAWvf,UAEjCuf,WAAWvf,QAAQ6/B,SAEpBtgB,WAAW1lB,QAE2B,mBAA/B0lB,WAAW1lB,OAAOC,SAErB2wD,GAAc,IAAID,YAClBj6C,GAAc,IAAIC,YAMxB,SAAS,GAAUhe,GAEjB,OAAO2zF,IAAa5mE,WAAW1lB,OAAOC,SAAStH,EACjD,CAMO,SAAS,GAAOA,GAErB,OAAMA,aAAeP,WAGd,GAASO,GAAO,IAAIP,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAAc9R,EAF3EP,WAAWgM,KAAKzL,EAG3B,CAEO,MAAM,GAAW2zF,GAOpB,CAACnrF,EAAOC,EAAOb,IACNA,EAAMa,EAAQ,GAGnBskB,WAAW1lB,OAAOoE,KAAKjD,EAAMjM,SAASkM,EAAOb,IAAMgC,SAAS,QAC1DF,GAAUlB,EAAOC,EAAOb,GAS9B,CAACY,EAAOC,EAAOb,IACNA,EAAMa,EAAQ,GACjBwvD,GAAY5mD,OAAO7I,EAAMjM,SAASkM,EAAOb,IACzC8B,GAAUlB,EAAOC,EAAOb,GAGrB,GAAa+rF,GAKrBhrF,GACQA,EAAOzM,OAAS,GAGrB6wB,WAAW1lB,OAAOoE,KAAK9C,GACrBsZ,GAAYtZ,GAOjBA,GACQA,EAAOzM,OAAS,GAAK6hB,GAAY/J,OAAOrL,GAAUsZ,GAAYtZ,GAQ9DkrF,GAAa/zF,GACjBL,WAAWgM,KAAK3L,GAGZ/B,GAAQ41F,GAOjB,CAACnrF,EAAOC,EAAOb,IACT,GAASY,GACJ,IAAI/I,WAAW+I,EAAMjM,SAASkM,EAAOb,IAEvCY,EAAMzK,MAAM0K,EAAOb,GAS5B,CAACY,EAAOC,EAAOb,IACNY,EAAMzK,MAAM0K,EAAOb,GAGnBkX,GAAS60E,GAOlB,CAACG,EAAQ53F,KAGP43F,EAASA,EAAOj0E,KAAKqE,GAAMA,aAAazkB,WACpCykB,EAKF6I,WAAW1lB,OAAOoE,KAAKyY,KAElB,GAAM6I,WAAW1lB,OAAOyX,OAAOg1E,EAAQ53F,KAShD,CAAC43F,EAAQ53F,KACP,MAAMgF,EAAM,IAAIzB,WAAWvD,GAC3B,IAAIgP,EAAM,EACV,IAAK,IAAIqW,KAAKuyE,EACR5oF,EAAMqW,EAAErlB,OAASgF,EAAIhF,SAEvBqlB,EAAIA,EAAEhlB,SAAS,EAAG2E,EAAIhF,OAASgP,IAEjChK,EAAIJ,IAAIygB,EAAGrW,GACXA,GAAOqW,EAAErlB,OAEX,OAAOgF,GAGAzC,GAAQk1F,GAMhBj3F,GAGQqwB,WAAW1lB,OAAO8I,YAAYzT,GAQtCA,GACQ,IAAI+C,WAAW/C,GA4G5B,SAASulB,GAAa3hB,GACpB,MAAMY,EAAM,GACZ,IAAIV,EAAI,EACR,IAAK,IAAID,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAAK,CACnC,IAAI2jB,EAAI5jB,EAAIG,WAAWF,GACnB2jB,EAAI,IACNhjB,EAAIV,KAAO0jB,EACFA,EAAI,MACbhjB,EAAIV,KAAQ0jB,GAAK,EAAK,IACtBhjB,EAAIV,KAAY,GAAJ0jB,EAAU,KAEJ,QAAZ,MAAJA,IAA4B3jB,EAAI,EAAKD,EAAIpE,QACL,QAAZ,MAAxBoE,EAAIG,WAAWF,EAAI,KAErB2jB,EAAI,QAAgB,KAAJA,IAAe,KAA6B,KAAtB5jB,EAAIG,aAAaF,IACvDW,EAAIV,KAAQ0jB,GAAK,GAAM,IACvBhjB,EAAIV,KAAS0jB,GAAK,GAAM,GAAM,IAC9BhjB,EAAIV,KAAS0jB,GAAK,EAAK,GAAM,IAC7BhjB,EAAIV,KAAY,GAAJ0jB,EAAU,MAEtBhjB,EAAIV,KAAQ0jB,GAAK,GAAM,IACvBhjB,EAAIV,KAAS0jB,GAAK,EAAK,GAAM,IAC7BhjB,EAAIV,KAAY,GAAJ0jB,EAAU,IAE1B,CACA,OAAOhjB,CACT,CAWA,SAASwI,GAAW1J,EAAK7D,EAAQyL,GAC/B,MAAMyc,EAAM,GAEZ,KAAOloB,EAASyL,GAAK,CACnB,MAAM0c,EAAYtkB,EAAI7D,GACtB,IAAIooB,EAAY,KACZC,EAAoBF,EAAY,IAAQ,EAAKA,EAAY,IAAQ,EAAKA,EAAY,IAAQ,EAAI,EAElG,GAAInoB,EAASqoB,GAAoB5c,EAAK,CACpC,IAAI6c,EAAYC,EAAWC,EAAYC,EAEvC,OAAQJ,GACN,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EACHG,EAAazkB,EAAI7D,EAAS,GACE,MAAV,IAAbsoB,KACHG,GAA6B,GAAZN,IAAqB,EAAoB,GAAbG,EACzCG,EAAgB,MAClBL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAI7D,EAAS,GAC1BuoB,EAAY1kB,EAAI7D,EAAS,GACG,MAAV,IAAbsoB,IAAsD,MAAV,IAAZC,KACnCE,GAA6B,GAAZN,IAAoB,IAAoB,GAAbG,IAAsB,EAAmB,GAAZC,EAErEE,EAAgB,OAAUA,EAAgB,OAAUA,EAAgB,SACtEL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAazkB,EAAI7D,EAAS,GAC1BuoB,EAAY1kB,EAAI7D,EAAS,GACzBwoB,EAAa3kB,EAAI7D,EAAS,GACE,MAAV,IAAbsoB,IAAsD,MAAV,IAAZC,IAAsD,MAAV,IAAbC,KAClEC,GAA6B,GAAZN,IAAoB,IAAqB,GAAbG,IAAsB,IAAmB,GAAZC,IAAqB,EAAoB,GAAbC,EAClGC,EAAgB,OAAUA,EAAgB,UAC5CL,EAAYK,IAItB,CAGkB,OAAdL,GAGFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QAErBA,GAAa,MACbF,EAAI1nB,KAAK4nB,IAAc,GAAK,KAAQ,OACpCA,EAAY,MAAqB,KAAZA,GAGvBF,EAAI1nB,KAAK4nB,GACTpoB,GAAUqoB,CACZ,CAEA,OAAOO,GAAsBV,EAC/B,CAKA,MAAMS,GAAuB,KAMtB,SAASC,GAAuBF,GACrC,MAAM5jB,EAAM4jB,EAAW3oB,OACvB,GAAI+E,GAAO6jB,GACT,OAAO1oB,OAAOC,aAAaC,MAAMF,OAAQyoB,GAI3C,IAAIR,EAAM,GACN9jB,EAAI,EACR,KAAOA,EAAIU,GACTojB,GAAOjoB,OAAOC,aAAaC,MACzBF,OACAyoB,EAAW9mB,MAAMwC,EAAGA,GAAKukB,KAG7B,OAAOT,CACT,CCtYO,MAAMqxE,GAIX3wF,YAAakxE,EANU,KAOrBhxE,KAAKgxE,UAAYA,EAEjBhxE,KAAKmrB,OAAS,EAEdnrB,KAAK0wF,WAAa,EAElB1wF,KAAK6uF,OAAS,GAGd7uF,KAAK2wF,gBAAkB,IACzB,CAEApkF,QACEvM,KAAKmrB,OAAS,EACdnrB,KAAK0wF,WAAa,EACd1wF,KAAK6uF,OAAO53F,SACd+I,KAAK6uF,OAAS,IAEa,OAAzB7uF,KAAK2wF,kBACP3wF,KAAK6uF,OAAOn3F,KAAKsI,KAAK2wF,iBACtB3wF,KAAK0wF,UAAY1wF,KAAK2wF,gBAAgB15F,OAAS,EAEnD,CAKAS,KAAM6L,GACJ,IAAIqtF,EAAW5wF,KAAK6uF,OAAO7uF,KAAK6uF,OAAO53F,OAAS,GAEhD,GADe+I,KAAKmrB,OAAS5nB,EAAMtM,QACrB+I,KAAK0wF,UAAY,EAAG,CAEhC,MAAMG,EAAWD,EAAS35F,QAAU+I,KAAK0wF,UAAY1wF,KAAKmrB,QAAU,EAEpEylE,EAAS/0F,IAAI0H,EAAOstF,EACtB,KAAO,CAEL,GAAID,EAAU,CAEZ,MAAMC,EAAWD,EAAS35F,QAAU+I,KAAK0wF,UAAY1wF,KAAKmrB,QAAU,EAChE0lE,EAAWD,EAAS35F,SAEtB+I,KAAK6uF,OAAO7uF,KAAK6uF,OAAO53F,OAAS,GAAK25F,EAASt5F,SAAS,EAAGu5F,GAC3D7wF,KAAK0wF,UAAY1wF,KAAKmrB,OAAS,EAEnC,CACI5nB,EAAMtM,OAAS,IAAMsM,EAAMtM,OAAS+I,KAAKgxE,WAE3C4f,EAAWp3F,GAAMwG,KAAKgxE,WACtBhxE,KAAK6uF,OAAOn3F,KAAKk5F,GACjB5wF,KAAK0wF,WAAaE,EAAS35F,OACE,OAAzB+I,KAAK2wF,kBACP3wF,KAAK2wF,gBAAkBC,GAGzBA,EAAS/0F,IAAI0H,EAAO,KAGpBvD,KAAK6uF,OAAOn3F,KAAK6L,GACjBvD,KAAK0wF,WAAantF,EAAMtM,OAE5B,CACA+I,KAAKmrB,QAAU5nB,EAAMtM,MACvB,CAMA+yD,QAASz9C,GAAQ,GACf,IAAIolD,EACJ,GAA2B,IAAvB3xD,KAAK6uF,OAAO53F,OAAc,CAC5B,MAAM8vE,EAAQ/mE,KAAK6uF,OAAO,GACtBtiF,GAASvM,KAAKmrB,OAAS47C,EAAM9vE,OAAS,GAGxC06D,EAAO3xD,KAAKmrB,SAAW47C,EAAM9vE,OAAS8vE,EAAQA,EAAMzvE,SAAS,EAAG0I,KAAKmrB,QACrEnrB,KAAK2wF,gBAAkB,KACvB3wF,KAAK6uF,OAAS,IAGdl9B,EAAO74D,GAAMiuE,EAAO,EAAG/mE,KAAKmrB,OAEhC,MAEEwmC,EAAO93C,GAAO7Z,KAAK6uF,OAAQ7uF,KAAKmrB,QAKlC,OAHI5e,GACFvM,KAAKuM,QAEAolD,CACT,EC1HF,MAAMm9B,GAAkB,qBAClB,GAAkB,qBAElBE,GAAuB,GAY7B,SAASC,GAAkBxyE,EAAMxa,EAAKitF,GACpC,GAAIzyE,EAAKxlB,OAASgL,EAAMitF,EACtB,MAAM,IAAI32F,MAAM,GAAGu2F,8BAEvB,CAfAE,GAAqB,IAAM,EAC3BA,GAAqB,IAAM,EAC3BA,GAAqB,IAAM,EAC3BA,GAAqB,IAAM,EAC3BA,GAAqB,IAAM,ECHpB,MAAMpH,GAAiB,CAAC,GAAI,IAAK,MAAO,WAAY3lE,OAAO,yBAa3D,SAASa,GAAWrG,EAAMvlB,EAAQkX,GACvC6gF,GAAiBxyE,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAQ4d,EAAKvlB,GACnB,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,GAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAGu2F,mEAErB,OAAOjwF,CACT,CAQO,SAASipF,GAAYrrE,EAAMvlB,EAAQkX,GACxC6gF,GAAiBxyE,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAS4d,EAAKvlB,IAAW,EAAKulB,EAAKvlB,EAAS,GAClD,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,GAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAGu2F,mEAErB,OAAOjwF,CACT,CAQO,SAASkpF,GAAYtrE,EAAMvlB,EAAQkX,GACxC6gF,GAAiBxyE,EAAMvlB,EAAQ,GAC/B,MAAM2H,EAAwB,SAAf4d,EAAKvlB,IAAqCulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GAC3H,IAAuB,IAAnBkX,EAAQy5E,QAAmBhpF,EAAQ+oF,GAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAGu2F,mEAErB,OAAOjwF,CACT,CAQO,SAASmpF,GAAYvrE,EAAMvlB,EAAQkX,GAExC6gF,GAAiBxyE,EAAMvlB,EAAQ,GAC/B,MAAMuL,EAAqB,SAAfga,EAAKvlB,IAAqCulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GAClHsL,EAAyB,SAAnBia,EAAKvlB,EAAS,IAAgCulB,EAAKvlB,EAAS,IAAM,KAAOulB,EAAKvlB,EAAS,IAAM,GAAKulB,EAAKvlB,EAAS,GACtH2H,GAASojB,OAAOxf,IAAOwf,OAAO,KAAOA,OAAOzf,GAClD,IAAuB,IAAnB4L,EAAQy5E,QAAmBhpF,EAAQ+oF,GAAe,GACpD,MAAM,IAAIrvF,MAAM,GAAGu2F,mEAErB,GAAIjwF,GAASmK,OAAO2oB,iBAClB,OAAO3oB,OAAOnK,GAEhB,IAA4B,IAAxBuP,EAAQ65E,YACV,OAAOppF,EAET,MAAM,IAAItG,MAAM,GAAGu2F,kEACrB,CAyDO,SAASvG,GAAYxtF,EAAKuhC,GAC/B,OAAOksD,GAAgBztF,EAAK,EAAGuhC,EAAMz9B,MACvC,CAOO,SAAS2pF,GAAiBztF,EAAK69C,EAAO6vC,GAC3C,GAAIA,EAAOb,GAAe,GAAI,CAC5B,MAAMc,EAAQ1/E,OAAOy/E,GAErB1tF,EAAIrD,KAAK,CAACkhD,EAAQ8vC,GACpB,MAAO,GAAID,EAAOb,GAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GAErB1tF,EAAIrD,KAAK,CAAS,GAARkhD,EAAY8vC,GACxB,MAAO,GAAID,EAAOb,GAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GAErB1tF,EAAIrD,KAAK,CAAS,GAARkhD,EAAY8vC,IAAU,EAAW,IAARA,GACrC,MAAO,GAAID,EAAOb,GAAe,GAAI,CACnC,MAAMc,EAAQ1/E,OAAOy/E,GAErB1tF,EAAIrD,KAAK,CAAS,GAARkhD,EAAa8vC,IAAU,GAAM,IAAOA,IAAU,GAAM,IAAOA,IAAU,EAAK,IAAc,IAARA,GAC5F,KAAO,CACL,MAAMC,EAAQ1mE,OAAOwmE,GACrB,KAAIE,EAAQf,GAAe,IAsBzB,MAAM,IAAIrvF,MAAM,GAAGu2F,qDAtBU,CAE7B,MAAMjzF,EAAM,CAAS,GAAR+8C,EAAY,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAE3C,IAAIp2C,EAAKwG,OAAO2/E,EAAQ1mE,OAAO,aAC3Bxf,EAAKuG,OAAO2/E,GAAS1mE,OAAO,IAAMA,OAAO,aAC7CpmB,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACTA,IAAW,EACX3G,EAAI,GAAU,IAAL2G,EACT3G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACTA,IAAW,EACX5G,EAAI,GAAU,IAAL4G,EACT1H,EAAIrD,KAAKmE,EACX,CAGF,CACF,CAMA0sF,GAAWK,YAAc,SAAsBtsD,GAC7C,OAAOksD,GAAgBI,YAAYtsD,EAAMz9B,MAC3C,EAMA2pF,GAAgBI,YAAc,SAAsBH,GAClD,OAAIA,EAAOb,GAAe,GACjB,EAELa,EAAOb,GAAe,GACjB,EAELa,EAAOb,GAAe,GACjB,EAELa,EAAOb,GAAe,GACjB,EAEF,CACT,EAOAW,GAAWM,cAAgB,SAAwBC,EAAMC,GACvD,OAAOD,EAAKjqF,MAAQkqF,EAAKlqF,OAAS,EAAIiqF,EAAKjqF,MAAQkqF,EAAKlqF,MAAQ,EAAyB,CAC3F,ECtLA,MAAMsqF,GAAQlnE,QAAQ,GAChBmnE,GAAQnnE,OAAO,GA2Bd,SAASsnE,GAAcxuF,EAAKuhC,GACjC,MAAMktD,EAASltD,EAAMz9B,MACfiI,EAA8B,iBAAX0iF,EAAuBA,EAASL,GAAQC,IAAoB,EAAVI,EAAc,EACzF,GAAqBzuF,EAAKuhC,EAAMptB,KAAKu6E,aAAc3iF,EACrD,CC3DA,SAAS4iF,GAASjtE,EAAMxa,EAAKuX,EAAQviB,GACnCg4F,GAAiBxyE,EAAMxa,EAAKuX,EAASviB,GACrC,MAAM8D,EAAMjC,GAAM2jB,EAAMxa,EAAMuX,EAAQvX,EAAMuX,EAASviB,GACrD,OAAO,IAAI,GAAM,SAAY8D,EAAKye,EAASviB,EAC7C,CASO,SAAS0yF,GAAoBltE,EAAMxa,EAAK2nF,EAAOjO,GACpD,OAAO+N,GAAQjtE,EAAMxa,EAAK,EAAG2nF,EAC/B,CAyDA,SAASK,GAAY3tD,GAKnB,YAJ2B50B,IAAvB40B,EAAM4tD,eACR5tD,EAAM4tD,aAAe5tD,EAAMptB,OAAS,UAAc,GAAWotB,EAAMz9B,OAASy9B,EAAMz9B,OAG7Ey9B,EAAM4tD,YACf,CAMO,SAASC,GAAapvF,EAAKuhC,GAChC,MAAM/4B,EAAQ0mF,GAAW3tD,GACzB,GAAqBvhC,EAAKuhC,EAAMptB,KAAKu6E,aAAclmF,EAAMtM,QACzD8D,EAAIrD,KAAK6L,EACX,CCtFA,SAAS,GAASkZ,EAAMxa,EAAKuX,EAAQviB,EAAQmX,GAC3C,MAAMk8E,EAAY9wE,EAASviB,EAC3Bg4F,GAAiBxyE,EAAMxa,EAAKqoF,GAC5B,MAAMC,EAAM,IAAI,GAAM,UAAa,GAAS9tE,EAAMxa,EAAMuX,EAAQvX,EAAMqoF,GAAYA,GAIlF,OAHkC,IAA9Bl8E,EAAQo8E,oBACVD,EAAIE,UAAY3xF,GAAM2jB,EAAMxa,EAAMuX,EAAQvX,EAAMqoF,IAE3CC,CACT,CASO,SAASG,GAAqBjuE,EAAMxa,EAAK2nF,EAAOx7E,GACrD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG2nF,EAAOx7E,EACtC,CF4CAm7E,GAAaX,YAAc,SAAsBtsD,GAC/C,MAAMktD,EAASltD,EAAMz9B,MACfiI,EAA8B,iBAAX0iF,EAAuBA,EAASL,GAAQC,IAAoB,EAAVI,EAAc,EAGzF,OAAI1iF,EAAW,MACN,EAELA,EAAW,MACN,EAELA,EAAW,MACN,EAELA,EAAW,MACN,EAEF,CACT,EAOAyiF,GAAaV,cAAgB,SAAwBC,EAAMC,GAEzD,OAAOD,EAAKjqF,MAAQkqF,EAAKlqF,MAAQ,EAAIiqF,EAAKjqF,MAAQkqF,EAAKlqF,OAAS,EAAyB,CAC3F,ECCAsrF,GAAYvB,YAAc,SAAsBtsD,GAC9C,MAAM/4B,EAAQ0mF,GAAW3tD,GACzB,OAAO,eAAiC/4B,EAAMtM,QAAUsM,EAAMtM,MAChE,EAOAkzF,GAAYtB,cAAgB,SAAwBC,EAAMC,GACxD,OAQ4BqB,EARRH,GAAWnB,GAQCuB,EARMJ,GAAWlB,GAS1CqB,EAAGnzF,OAASozF,EAAGpzF,QAAU,EAAImzF,EAAGnzF,OAASozF,EAAGpzF,OAAS,ELkIvD,SAAkBmzF,EAAIC,GAE3B,GAAI,GAASD,IAAO,GAASC,GAG3B,OAAOD,EAAG5pE,QAAQ6pE,GAEpB,IAAK,IAAI/uF,EAAI,EAAGA,EAAI8uF,EAAGnzF,OAAQqE,IAC7B,GAAI8uF,EAAG9uF,KAAO+uF,EAAG/uF,GAGjB,OAAO8uF,EAAG9uF,GAAK+uF,EAAG/uF,IAAM,EAAI,EAE9B,OAAO,CACT,CKhJkEklB,CAAQ4pE,EAAIC,GADvE,IAAuBD,EAAIC,CAPlC,EClCO,MAAMU,GAAeZ,GCzE5B,SAAS,GAAS7lC,EAAO0mC,EAAMxxE,EAAQviB,GACrC,OAAO,IAAI,GAAM,SAAYA,EAAQuiB,EACvC,CASO,SAASyxE,GAAoBxuE,EAAMxa,EAAK2nF,EAAOjO,GACpD,OAAO,GAAQl/D,EAAMxa,EAAK,EAAG2nF,EAC/B,CAqEO,SAAS4B,GAAazwF,EAAKuhC,GAChC,GAAqBvhC,EAAK,sBAAyBuhC,EAAMz9B,MAC3D,CCpFA,SAAS,GAASylD,EAAO0mC,EAAMxxE,EAAQviB,GACrC,OAAO,IAAI,GAAM,OAAUA,EAAQuiB,EACrC,CASO,SAASiyE,GAAkBhvE,EAAMxa,EAAK2nF,EAAOjO,GAClD,OAAO,GAAQl/D,EAAMxa,EAAK,EAAG2nF,EAC/B,CAqEO,SAASmC,GAAWhxF,EAAKuhC,GAC9B,GAAqBvhC,EAAK,oBAAuBuhC,EAAMz9B,MACzD,CCrFO,SAASmtF,GAAkB1nC,EAAO0mC,EAAMpB,EAAOjO,GACpD,OAAO,IAAI,GAAM,OAAUiO,EAAO,EACpC,CAkDO,SAASyC,GAAWtxF,EAAKuhC,GAC9B,GAAqBvhC,EAAK,oBAAuBuhC,EAAMz9B,MACzD,CFmCA2sF,GAAY3C,cAAgB,iBAM5B2C,GAAY5C,YAAc,SAAsBtsD,GAC9C,OAAO,eAAiCA,EAAMz9B,MAChD,ECRAktF,GAAUlD,cAAgB,iBAM1BkD,GAAUnD,YAAc,SAAsBtsD,GAC5C,OAAO,eAAiCA,EAAMz9B,MAChD,ECzCAwtF,GAAUxD,cAAgB,iBAM1BwD,GAAUzD,YAAc,SAAsBtsD,GAC5C,OAAO,eAAiCA,EAAMz9B,MAChD,EClEA,MAAMytF,GAAc,GACdC,GAAa,GACbC,GAAa,GACbC,GAAkB,GAsCxB,SAASK,GAAajuF,EAAO0E,EAAO6K,GAClC,GAAIA,EAAS,CACX,IAAyB,IAArBA,EAAQ2+E,UAAsB/jF,OAAOikB,MAAMpuB,GAC7C,MAAM,IAAItG,MAAM,GAAGu2F,mCAErB,IAA8B,IAA1B1gF,EAAQ4+E,gBAA4BnuF,IAAUuS,KAAYvS,KAAWuS,KACvE,MAAM,IAAI7Y,MAAM,GAAGu2F,uCAEvB,CACA,OAAO,IAAI,GAAM,SAAYjwF,EAAO0E,EACtC,CAwCO,SAASgqF,GAAaxyF,EAAKuhC,EAAOluB,GACvC,MAAMhU,EAAQkiC,EAAMz9B,MAEpB,IAAc,IAAVzE,EACFW,EAAIrD,KAAK,CAAC,sBAA0B40F,UAC/B,IAAc,IAAVlyF,EACTW,EAAIrD,KAAK,CAAC,sBAA0B60F,UAC/B,GAAc,OAAVnyF,EACTW,EAAIrD,KAAK,CAAC,sBAA0B80F,UAC/B,QAAc9kF,IAAVtN,EACTW,EAAIrD,KAAK,CAAC,sBAA0B+0F,SAC/B,CACL,IAAIjvB,EACAgwB,GAAU,EACTp/E,IAA+B,IAApBA,EAAQq/E,UACtBC,GAActzF,GACdojE,EAAU0vB,GAAYS,GAAM,GACxBvzF,IAAUojE,GAAWx0D,OAAOikB,MAAM7yB,IACpCuzF,GAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,GAAK70F,MAAM,EAAG,IACvB00F,GAAU,IAEVI,GAAcxzF,GACdojE,EAAU4vB,GAAYO,GAAM,GACxBvzF,IAAUojE,IACZmwB,GAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,GAAK70F,MAAM,EAAG,IACvB00F,GAAU,KAIXA,IAgJeK,EA/IJzzF,EAgJlBsxD,GAASoiC,WAAW,EAAGD,GAAK,GA/IxBrwB,EAAU8vB,GAAYK,GAAM,GAC5BA,GAAK,GAAK,IACV5yF,EAAIrD,KAAKi2F,GAAK70F,MAAM,EAAG,IAE3B,CA0IF,IAAwB+0F,CAzIxB,CAOAN,GAAY3E,YAAc,SAAsBtsD,EAAOluB,GACrD,MAAMhU,EAAQkiC,EAAMz9B,MAEpB,IAAc,IAAVzE,IAA6B,IAAVA,GAAnBA,MAAqCA,EACvC,OAAO,EAGT,IAAKgU,IAA+B,IAApBA,EAAQq/E,QAAkB,CACxCC,GAActzF,GACd,IAAIojE,EAAU0vB,GAAYS,GAAM,GAChC,GAAIvzF,IAAUojE,GAAWx0D,OAAOikB,MAAM7yB,GACpC,OAAO,EAIT,GAFAwzF,GAAcxzF,GACdojE,EAAU4vB,GAAYO,GAAM,GACxBvzF,IAAUojE,EACZ,OAAO,CAEX,CACA,OAAO,CACT,EAEA,MAAM7mE,GAAS,IAAIklB,YAAY,GACzB6vC,GAAW,IAAI/xB,SAAShjC,GAAQ,GAChCg3F,GAAO,IAAInzF,WAAW7D,GAAQ,GAKpC,SAAS+2F,GAAeG,GACtB,GAAIA,IAAQz8E,IACVs6C,GAAS+C,UAAU,EAAG,OAAQ,QACzB,GAAIo/B,KAASz8E,IAClBs6C,GAAS+C,UAAU,EAAG,OAAQ,QACzB,GAAIzlD,OAAOikB,MAAM4gE,GACtBniC,GAAS+C,UAAU,EAAG,OAAQ,OACzB,CACL/C,GAASqiC,WAAW,EAAGF,GACvB,MAAMG,EAAStiC,GAASmB,UAAU,GAC5BohC,GAAqB,WAATD,IAAwB,GACpCE,EAAoB,QAATF,EAGjB,GAAiB,MAAbC,EAEFviC,GAAS+C,UAAU,EAAG,OAAQ,QACzB,GAAiB,IAAbw/B,EAETviC,GAAS+C,UAAU,GAAW,WAANo/B,IAAqB,GAAOK,GAAY,IAAK,OAChE,CAEL,MAAMC,EAAkBF,EAAW,IAG/BE,GAAmB,GAKrBziC,GAAS+C,UAAU,EAAG,GACb0/B,GAAmB,GAI5BziC,GAAS+C,UAAU,GAAc,WAATu/B,IAAwB,GAAsB,GAAM,GAAKG,GAAmB,GAEpGziC,GAAS+C,UAAU,GAAc,WAATu/B,IAAwB,GAAQG,EAAkB,IAAO,GAAOD,GAAY,IAAK,EAE7G,CACF,CACF,CAOA,SAAShB,GAAaS,EAAM1rF,GAC1B,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAGu2F,kCAGrB,MAAMV,GAAQT,EAAK1rF,IAAQ,GAAK0rF,EAAK1rF,EAAM,GAC3C,GAAa,QAATmsF,EACF,OAAOh9E,IAET,GAAa,QAATg9E,EACF,OAAQh9E,IAEV,GAAa,QAATg9E,EACF,OAAOC,IAET,MAAMC,EAAOF,GAAQ,GAAM,GACrBG,EAAc,KAAPH,EACb,IAAIhjF,EAUJ,OAREA,EADU,IAARkjF,EACIC,EAAQ,IAAM,GACH,KAARD,GACFC,EAAO,MAAS,IAAMD,EAAM,IAIpB,IAATC,EAAan9E,IAAWi9E,IAEjB,MAAPD,GAAkBhjF,EAAMA,CAClC,CAKA,SAASwiF,GAAeC,GACtBniC,GAASqiC,WAAW,EAAGF,GAAK,EAC9B,CAOA,SAAST,GAAaO,EAAM1rF,GAC1B,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAGu2F,kCAErB,MAAM53F,GAAUy2F,EAAKzxE,YAAc,GAAKja,EACxC,OAAO,IAAI03B,SAASg0D,EAAKh3F,OAAQO,EAAQ,GAAGs3F,WAAW,GAAG,EAC5D,CAcA,SAASlB,GAAaK,EAAM1rF,GAC1B,GAAI0rF,EAAK12F,OAASgL,EAAM,EACtB,MAAM,IAAI1J,MAAM,GAAGu2F,kCAErB,MAAM53F,GAAUy2F,EAAKzxE,YAAc,GAAKja,EACxC,OAAO,IAAI03B,SAASg0D,EAAKh3F,OAAQO,EAAQ,GAAGu3F,WAAW,GAAG,EAC5D,CCjRA,SAASiG,GAAcj4E,EAAMxa,EAAK2nF,GAChC,MAAM,IAAIrxF,MAAM,GAAGu2F,iCAA8ClF,gBAAoBntE,EAAKxa,KAAS,IACrG,CAMA,SAAS0yF,GAAS1tE,GAChB,MAAO,KAAQ,MAAM,IAAI1uB,MAAM,GAAGu2F,MAAmB7nE,IAAK,CAC5D,CD8QAsmE,GAAY1E,cAAgBN,GAAWM,cC3QhC,MAAM+L,GAAO,GAGpB,IAAK,IAAIt5F,EAAI,EAAGA,GAAK,GAAMA,IACzBs5F,GAAKt5F,GAAKo5F,GAEZE,GAAK,IRuDE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,GAAM,QAAW0U,GAAUrG,EAAMxa,EAAM,EAAGmM,GAAU,EACjE,EQxDAwmF,GAAK,IRiEE,SAAuBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO,IAAI,GAAM,QAAW05E,GAAWrrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,EQlEAwmF,GAAK,IR2EE,SAAuBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO,IAAI,GAAM,QAAW25E,GAAWtrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,EQ5EAwmF,GAAK,IRqFE,SAAuBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO,IAAI,GAAM,QAAW45E,GAAWvrE,EAAMxa,EAAM,EAAGmM,GAAU,EAClE,EQtFAwmF,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GAEb,IAAK,IAAIp5F,EAAI,GAAMA,GAAK,GAAMA,IAC5Bs5F,GAAKt5F,GAAKo5F,GAEZE,GAAK,IPlCE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,IAAI,GAAM,WAAc,EAAI,GAAeqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC7E,EOiCAwmF,GAAK,IPxBE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,OAAO,IAAI,GAAM,WAAc,EAAI,GAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC9E,EOuBAwmF,GAAK,IPdE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,OAAO,IAAI,GAAM,WAAc,EAAI,GAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EAC9E,EOaAwmF,GAAK,IPDE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,MAAM+lD,EAAM,GAAgB13C,EAAMxa,EAAM,EAAGmM,GAC3C,GAAmB,iBAAR+lD,EAAkB,CAC3B,MAAMt1D,GAAS,EAAIs1D,EACnB,GAAIt1D,GAASmK,OAAOsgF,iBAClB,OAAO,IAAI,GAAM,UAAazqF,EAAO,EAEzC,CACA,IAA4B,IAAxBuP,EAAQ65E,YACV,MAAM,IAAI1vF,MAAM,GAAGu2F,mEAErB,OAAO,IAAI,GAAM,UAAa3F,GAAQlnE,OAAOkyC,GAAM,EACrD,EOVAygC,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GAEb,IAAK,IAAIp5F,EAAI,GAAMA,GAAK,GAAMA,IAC5Bs5F,GAAKt5F,GAAK,GAEZs5F,GAAK,INvBE,SAAuBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAOs7E,GAAQjtE,EAAMxa,EAAK,EAAG,GAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,EMsBAwmF,GAAK,INbE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAOs7E,GAAQjtE,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EMYAwmF,GAAK,INHE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAOs7E,GAAQjtE,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EMEAwmF,GAAK,INQE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,MAAMwjB,EAAI,GAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAGu2F,iDAErB,OAAOpF,GAAQjtE,EAAMxa,EAAK,EAAG2vB,EAC/B,EMbAgjE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQF,GACbE,GAAK,IAAQD,GAAQ,qDAErB,IAAK,IAAIr5F,EAAI,GAAMA,GAAK,IAAMA,IAC5Bs5F,GAAKt5F,GAAK,GAEZs5F,GAAK,KL7BE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAewa,EAAMxa,EAAM,EAAGmM,GAAUA,EACvE,EK4BAwmF,GAAK,KLnBE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAAUA,EACxE,EKkBAwmF,GAAK,KLTE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAAUA,EACxE,EKQAwmF,GAAK,KLEE,SAAyBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACjD,MAAMwjB,EAAI,GAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAGu2F,kDAErB,OAAO,GAAQryE,EAAMxa,EAAK,EAAG2vB,EAAGxjB,EAClC,EKPAwmF,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQD,GAAQ,qDAErB,IAAK,IAAIr5F,EAAI,IAAMA,GAAK,IAAMA,IAC5Bs5F,GAAKt5F,GAAK,GAEZs5F,GAAK,KJlDE,SAAuBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC/C,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,EIiDAwmF,GAAK,KJxCE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EIuCAwmF,GAAK,KJ9BE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EI6BAwmF,GAAK,KJnBE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,MAAMwjB,EAAI,GAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAGu2F,iDAErB,OAAO,GAAQryE,EAAMxa,EAAK,EAAG2vB,EAC/B,EIcAgjE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KJRE,SAAgCn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACxD,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAGu2F,0CAErB,OAAO,GAAQryE,EAAMxa,EAAK,EAAGmP,IAC/B,EIKA,IAAK,IAAI9V,EAAI,IAAMA,GAAK,IAAMA,IAC5Bs5F,GAAKt5F,GAAK,GAEZs5F,GAAK,KH9DE,SAAqBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAewa,EAAMxa,EAAM,EAAGmM,GAC7D,EG6DAwmF,GAAK,KHpDE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EGmDAwmF,GAAK,KH1CE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,GAAQqO,EAAMxa,EAAK,EAAG,GAAgBwa,EAAMxa,EAAM,EAAGmM,GAC9D,EGyCAwmF,GAAK,KH/BE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,MAAMwjB,EAAI,GAAgBnV,EAAMxa,EAAM,EAAGmM,GACzC,GAAiB,iBAANwjB,EACT,MAAM,IAAIr5B,MAAM,GAAGu2F,+CAErB,OAAO,GAAQryE,EAAMxa,EAAK,EAAG2vB,EAC/B,EG0BAgjE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KHpBE,SAA8Bn4E,EAAMxa,EAAKkmF,EAAQ/5E,GACtD,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAGu2F,0CAErB,OAAO,GAAQryE,EAAMxa,EAAK,EAAGmP,IAC/B,EGiBA,IAAK,IAAI9V,EAAI,IAAMA,GAAK,IAAMA,IAC5Bs5F,GAAKt5F,GAAK,GAEZs5F,GAAK,KFtFE,SAAqBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC7C,OAAO,IAAI,GAAM,OAAU,GAAeqO,EAAMxa,EAAM,EAAGmM,GAAU,EACrE,EEqFAwmF,GAAK,KF5EE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,GAAM,OAAU,GAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,EE2EAwmF,GAAK,KFlEE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,GAAM,OAAU,GAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,EEiEAwmF,GAAK,KFxDE,SAAsBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAC9C,OAAO,IAAI,GAAM,OAAU,GAAgBqO,EAAMxa,EAAM,EAAGmM,GAAU,EACtE,EEuDAwmF,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GAEb,IAAK,IAAIp5F,EAAI,IAAMA,GAAK,IAAMA,IAC5Bs5F,GAAKt5F,GAAKq5F,GAAQ,mCAEpBC,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KDtGE,SAA0BtwC,EAAO0mC,EAAM7C,EAAQ/5E,GACpD,IAA+B,IAA3BA,EAAQu+E,eACV,MAAM,IAAIp0F,MAAM,GAAGu2F,yCACd,OAAsC,IAAlC1gF,EAAQw+E,sBACV,IAAI,GAAM,QAAW,KAAM,GAE7B,IAAI,GAAM,kBAAgBllF,EAAW,EAC9C,ECgGAktF,GAAK,KAAQD,GAAQ,mCACrBC,GAAK,KDxDE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO0+E,GAAYI,GAAYzwE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,ECuDAwmF,GAAK,KD9CE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO0+E,GAAYM,GAAY3wE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,EC6CAwmF,GAAK,KDpCE,SAAwBn4E,EAAMxa,EAAKkmF,EAAQ/5E,GAChD,OAAO0+E,GAAYQ,GAAY7wE,EAAMxa,EAAM,GAAI,EAAGmM,EACpD,ECmCAwmF,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KAAQF,GACbE,GAAK,KD9FE,SAAsBtwC,EAAO0mC,EAAM7C,EAAQ/5E,GAChD,IAAgC,IAA5BA,EAAQm9E,gBACV,MAAM,IAAIhzF,MAAM,GAAGu2F,0CAErB,OAAO,IAAI,GAAM,cAAYpnF,EAAW,EAC1C,EC4FO,MAAMmtF,GAAQ,GAErB,IAAK,IAAIv5F,EAAI,EAAGA,EAAI,GAAIA,IACtBu5F,GAAMv5F,GAAK,IAAI,GAAM,QAAWA,EAAG,GAGrC,IAAK,IAAIA,GAAK,EAAGA,IAAM,GAAIA,IACzBu5F,GAAM,GAAKv5F,GAAK,IAAI,GAAM,UAAaA,EAAG,GAG5Cu5F,GAAM,IAAQ,IAAI,GAAM,SAAY,IAAIr6F,WAAW,GAAI,GAEvDq6F,GAAM,IAAQ,IAAI,GAAM,UAAa,GAAI,GAEzCA,GAAM,KAAQ,IAAI,GAAM,SAAY,EAAG,GAEvCA,GAAM,KAAQ,IAAI,GAAM,OAAU,EAAG,GAErCA,GAAM,KAAQ,IAAI,GAAM,UAAY,EAAO,GAE3CA,GAAM,KAAQ,IAAI,GAAM,SAAW,EAAM,GAEzCA,GAAM,KAAQ,IAAI,GAAM,QAAW,KAAM,mBCtIzC,MAAM/D,GAAuB,CAC3BrD,SAAS,EACTsD,UAkWF,SAAoBC,EAAIC,GAItB,MAAMC,EAAYt4F,MAAMuJ,QAAQ6uF,EAAG,IAAMA,EAAG,GAAG,GAAKA,EAAG,GACjDG,EAAYv4F,MAAMuJ,QAAQ8uF,EAAG,IAAMA,EAAG,GAAG,GAAKA,EAAG,GAGvD,GAAIC,EAAUhiF,OAASiiF,EAAUjiF,KAC/B,OAAOgiF,EAAUhiF,KAAKsR,QAAQ2wE,EAAUjiF,MAG1C,MAAM0pC,EAAQs4C,EAAUhiF,KAAK0pC,MAEvBw4C,EAAOC,GAAaz4C,GAAOiwC,cAAcqI,EAAWC,GAE7C,IAATC,GAGF14F,GAAQqa,KAAK,yEAEf,OAAOq+E,CACT,EAvXEE,iBDyIK,SAA2Bh1D,GAChC,OAAQA,EAAMptB,MACZ,KAAK,SACH,OAAO0/E,GAAU,CAAC,MACpB,KAAK,QACH,OAAOA,GAAU,CAAC,MACpB,KAAK,QACH,OAAOA,GAAU,CAAC,MACpB,KAAK,SACH,OAAKtyD,EAAMz9B,MAAM5H,YAGjB,EAFS23F,GAAU,CAAC,KAGtB,KAAK,UACH,MAAoB,KAAhBtyD,EAAMz9B,MACD+vF,GAAU,CAAC,UAEpB,EACF,KAAK,SACH,OAAoB,IAAhBtyD,EAAMz9B,MACD+vF,GAAU,CAAC,WAIpB,EACF,KAAK,OACH,OAAoB,IAAhBtyD,EAAMz9B,MACD+vF,GAAU,CAAC,WAIpB,EACF,KAAK,QACH,OAAItyD,EAAMz9B,MAAQ,GACT+vF,GAAU,CAAC5lF,OAAOszB,EAAMz9B,cAEjC,EACF,KAAK,UACH,GAAIy9B,EAAMz9B,QAAU,GAClB,OAAO+vF,GAAU,CAAC,GAAK5lF,OAAOszB,EAAMz9B,SAG5C,GClKA,MAAMwyF,GAbC,WACL,MAAME,EAAW,GASjB,OARAA,EAAS,eAAmBhJ,GAC5BgJ,EAAS,iBAAqBhI,GAC9BgI,EAAS,gBAAoBpH,GAC7BoH,EAAS,iBAAqBxG,GAC9BwG,EAAS,gBAAoB/F,GAC7B+F,EAAS,cAAkBxF,GAC3BwF,EAAS,cAAkBlF,GAC3BkF,EAAS,gBAAoBhE,GACtBgE,CACT,CAEqBC,GAEfz2F,GAAM,IAAI01F,GAGhB,MAAMgB,GAKJ3xF,YAAawJ,EAAK8P,GAChBpZ,KAAKsJ,IAAMA,EACXtJ,KAAKoZ,OAASA,CAChB,CAMAmI,SAAUjY,GAER,IAAI/N,EAAIyE,KACR,GACE,GAAIzE,EAAE+N,MAAQA,EACZ,OAAO,QAEF/N,EAAIA,EAAE6d,QACf,OAAO,CACT,CAOAH,mBAAoBjR,EAAOsB,GACzB,GAAItB,GAASA,EAAMuZ,SAASjY,GAC1B,MAAM,IAAI/Q,MAAM,GAAG,0CAErB,OAAO,IAAIk5F,GAAInoF,EAAKtB,EACtB,EAGF,MAAM0pF,GAAe,CACnBC,KAAM,IAAI,GAAM,QAAW,MAC3BjqF,UAAW,IAAI,GAAM,kBAAgBA,GACrCkqF,KAAM,IAAI,GAAM,SAAW,GAC3BC,MAAO,IAAI,GAAM,UAAY,GAC7BjpF,WAAY,IAAI,GAAM,SAAY,GAClCkpF,SAAU,IAAI,GAAM,OAAU,IAI1BC,GAAe,CAQnB5oC,OAAO,CAAC7/C,EAAK0oF,EAAMrW,EAAUsW,IACtBjpF,OAAOD,UAAUO,IAASN,OAAOogD,cAAc9/C,GAG3C,IAAI,GADFA,GAAO,EACC,QAEA,UAFWA,GAFrB,IAAI,GAAM,SAAYA,GAejC4oF,OAAO,CAAC5oF,EAAK0oF,EAAMrW,EAAUsW,IACvB3oF,GAAO2Y,OAAO,GACT,IAAI,GAAM,QAAW3Y,GAErB,IAAI,GAAM,UAAaA,GAWlC9O,WAAW,CAAC8O,EAAK0oF,EAAMrW,EAAUsW,IACxB,IAAI,GAAM,SAAY3oF,GAU/B5F,OAAO,CAAC4F,EAAK0oF,EAAMrW,EAAUsW,IACpB,IAAI,GAAM,UAAa3oF,GAUhC6oF,QAAQ,CAAC7oF,EAAK0oF,EAAMrW,EAAUsW,IACrB3oF,EAAMooF,GAAaE,KAAOF,GAAaG,MAUhDF,KAAK,CAACS,EAAMJ,EAAMrW,EAAUsW,IACnBP,GAAaC,KAUtBjqF,UAAU,CAAC0qF,EAAMJ,EAAMrW,EAAUsW,IACxBP,GAAahqF,UAUtBmU,YAAY,CAACvS,EAAK0oF,EAAMrW,EAAUsW,IACzB,IAAI,GAAM,SAAY,IAAIz3F,WAAW8O,IAU9CqwB,SAAS,CAACrwB,EAAK0oF,EAAMrW,EAAUsW,IACtB,IAAI,GAAM,SAAY,IAAIz3F,WAAW8O,EAAI3S,OAAQ2S,EAAI4S,WAAY5S,EAAIuD,aAU9EjU,MAAO0Q,EAAK0oF,EAAM5jF,EAASikF,GACzB,IAAK/oF,EAAIrS,OACP,OAA+B,IAA3BmX,EAAQkkF,eACH,CAACZ,GAAa9oF,WAAY,IAAI,GAAM,WAEtC8oF,GAAa9oF,WAEtBypF,EAAWZ,GAAIc,YAAYF,EAAU/oF,GACrC,MAAMuJ,EAAU,GAChB,IAAIvX,EAAI,EACR,IAAK,MAAMmO,KAAKH,EACduJ,EAAQvX,KAAOk3F,GAAe/oF,EAAG2E,EAASikF,GAE5C,OAAIjkF,EAAQkkF,eACH,CAAC,IAAI,GAAM,SAAYhpF,EAAIrS,QAAS4b,EAAS,IAAI,GAAM,WAEzD,CAAC,IAAI,GAAM,SAAYvJ,EAAIrS,QAAS4b,EAC7C,EASAnU,OAAQ4K,EAAKmpF,EAAKrkF,EAASikF,GAEzB,MAAMK,EAAgB,WAARD,EAERhrF,EAAOirF,EAAQppF,EAAI7B,OAAS/I,OAAO+I,KAAK6B,GACxCrS,EAASy7F,EAAQppF,EAAI7R,KAAOgQ,EAAKxQ,OACvC,IAAKA,EACH,OAA+B,IAA3BmX,EAAQkkF,eACH,CAACZ,GAAaI,SAAU,IAAI,GAAM,WAEpCJ,GAAaI,SAEtBO,EAAWZ,GAAIc,YAAYF,EAAU/oF,GAErC,MAAMuJ,EAAU,GAChB,IAAIvX,EAAI,EACR,IAAK,MAAM6S,KAAO1G,EAChBoL,EAAQvX,KAAO,CACbk3F,GAAerkF,EAAKC,EAASikF,GAC7BG,GAAeE,EAAQppF,EAAI3I,IAAIwN,GAAO7E,EAAI6E,GAAMC,EAASikF,IAI7D,OA0GJ,SAAyBx/E,EAASzE,GAC5BA,EAAQ2iF,WACVl+E,EAAQizE,KAAK13E,EAAQ2iF,UAEzB,CA/GI4B,CAAe9/E,EAASzE,GACpBA,EAAQkkF,eACH,CAAC,IAAI,GAAM,OAAUr7F,GAAS4b,EAAS,IAAI,GAAM,WAEnD,CAAC,IAAI,GAAM,OAAU5b,GAAS4b,EACvC,GAGFk/E,GAAaz3E,IAAMy3E,GAAarzF,OAChCqzF,GAAa3vF,OAAS2vF,GAAav3F,WACnC,IAAK,MAAMi4F,IAAO,iFAAiFxzF,MAAM,KACvG8yF,GAAa,GAAGU,UAAcV,GAAap4D,SAS7C,SAAS64D,GAAgBlpF,EAAK8E,EAAU,CAAC,EAAGikF,GAC1C,MAAMI,EAAMrC,GAAG9mF,GACTspF,EAAqBxkF,GAAWA,EAAQ2jF,cAAmD3jF,EAAQ2jF,aAAaU,IAASV,GAAaU,GAC5I,GAAiC,mBAAtBG,EAAkC,CAC3C,MAAMj0C,EAASi0C,EAAkBtpF,EAAKmpF,EAAKrkF,EAASikF,GACpD,GAAc,MAAV1zC,EACF,OAAOA,CAEX,CACA,MAAMk0C,EAAcd,GAAaU,GACjC,IAAKI,EACH,MAAM,IAAIt6F,MAAM,GAAG,wBAAqCk6F,KAE1D,OAAOI,EAAYvpF,EAAKmpF,EAAKrkF,EAASikF,EACxC,CAkHA,SAASS,GAAiB/3F,EAAK4jD,EAAQ4yC,EAAUnjF,GAC/C,GAAIxV,MAAMuJ,QAAQw8C,GAChB,IAAK,MAAMriB,KAASqiB,EAClBm0C,GAAgB/3F,EAAKuhC,EAAOi1D,EAAUnjF,QAGxCmjF,EAAS5yC,EAAOzvC,KAAK0pC,OAAO79C,EAAK4jD,EAAQvwC,EAE7C,CAQA,SAAS,GAAcqO,EAAM80E,EAAUnjF,GACrC,MAAMuwC,EAAS6zC,GAAe/1E,EAAMrO,GACpC,IAAKxV,MAAMuJ,QAAQw8C,IAAWvwC,EAAQkjF,iBAAkB,CACtD,MAAM0B,EAAa5kF,EAAQkjF,iBAAiB3yC,GAC5C,GAAIq0C,EACF,OAAOA,EAET,MAAMniC,EAAU0gC,EAAS5yC,EAAOzvC,KAAK0pC,OACrC,GAAIiY,EAAQ+3B,YAAa,CACvB,MAAMnxF,EAAOo5D,EAAQ+3B,YAAYjqC,EAAQvwC,GACnCrT,EAAM,IAAI01F,GAAGh5F,GAInB,GAHAo5D,EAAQ91D,EAAK4jD,EAAQvwC,GAGK,IAAtBrT,EAAI8zF,OAAO53F,OACb,MAAM,IAAIsB,MAAM,+CAA+ComD,eAEjE,OAAO,GAAM5jD,EAAI8zF,OAAO,GAC1B,CACF,CAGA,OAFA9zF,GAAIwR,QACJumF,GAAgB/3F,GAAK4jD,EAAQ4yC,EAAUnjF,GAChCrT,GAAIivD,SAAQ,EACrB,CAOA,SAAS,GAAQvtC,EAAMrO,GAErB,OADAA,EAAU1P,OAAO6W,OAAO,CAAC,EAAGu7E,GAAsB1iF,GAC3C,GAAaqO,EAAM40E,GAAcjjF,EAC1C,CCncA,MAAM+gF,GAAuB,CAC3BtH,QAAQ,EACR0D,iBAAiB,EACjBoB,gBAAgB,EAChB1E,aAAa,GAMf,MAAMmH,GAKJtvF,YAAa2c,EAAMrO,EAAU,CAAC,GAC5BpO,KAAKgrF,KAAO,EACZhrF,KAAKyc,KAAOA,EACZzc,KAAKoO,QAAUA,CACjB,CAEAnM,MACE,OAAOjC,KAAKgrF,IACd,CAEA3yD,OACE,OAAOr4B,KAAKgrF,MAAQhrF,KAAKyc,KAAKxlB,MAChC,CAEAoU,OACE,MAAMumD,EAAM5xD,KAAKyc,KAAKzc,KAAKgrF,MAC3B,IAAI1uD,EAAQu4D,GAAMjjC,GAClB,QAAclqD,IAAV40B,EAAqB,CACvB,MAAMi0B,EAAUqkC,GAAKhjC,GAGrB,IAAKrB,EACH,MAAM,IAAIh4D,MAAM,GAAGu2F,gCAA6Cl9B,IAAQ,aAAaA,EAAIjtD,SAAS,IAAI8yE,SAAS,EAAG,SAEpH,MAAMmS,EAAc,GAANh4B,EACdt1B,EAAQi0B,EAAQvwD,KAAKyc,KAAMzc,KAAKgrF,KAAMpB,EAAO5pF,KAAKoO,QACpD,CAGA,OADApO,KAAKgrF,MAAQ1uD,EAAM+yD,cACZ/yD,CACT,EAGF,MAAMgzD,GAAO94F,OAAOkqD,IAAI,QAClB6uC,GAAQ/4F,OAAOkqD,IAAI,SA+EzB,SAAS8uC,GAAgBC,EAAWrhF,GAGlC,GAAIqhF,EAAUp3D,OACZ,OAAOi3D,GAGT,MAAMhzD,EAAQmzD,EAAUpkF,OAExB,GAAIixB,EAAMptB,OAAS,SACjB,OAAOqgF,GAGT,GAAIjzD,EAAMptB,KAAKwgF,SACb,OAAOpzD,EAAMz9B,MAGf,GAAIy9B,EAAMptB,OAAS,SACjB,OAzFJ,SAAuBotB,EAAOmzD,EAAWrhF,GACvC,MAAMvT,EAAM,GACZ,IAAK,IAAIS,EAAI,EAAGA,EAAIghC,EAAMz9B,MAAOvD,IAAK,CACpC,MAAMuD,EAAQ2wF,GAAeC,EAAWrhF,GACxC,GAAIvP,IAAU0wF,GAAO,CACnB,GAAIjzD,EAAMz9B,QAAUuS,IAElB,MAEF,MAAM,IAAI7Y,MAAM,GAAGu2F,4CACrB,CACA,GAAIjwF,IAAUywF,GACZ,MAAM,IAAI/2F,MAAM,GAAGu2F,8CAA2DxzF,eAAeghC,EAAMz9B,UAErGhE,EAAIS,GAAKuD,CACX,CACA,OAAOhE,CACT,CAwEW80F,CAAarzD,EAAOmzD,EAAWrhF,GAGxC,GAAIkuB,EAAMptB,OAAS,OACjB,OApEJ,SAAqBotB,EAAOmzD,EAAWrhF,GACrC,MAAMwhF,GAA8B,IAApBxhF,EAAQwhF,QAClBtmF,EAAMsmF,OAAUloF,EAAY,CAAC,EAC7B+V,EAAImyE,EAAU,IAAIt1E,SAAQ5S,EAChC,IAAK,IAAIpM,EAAI,EAAGA,EAAIghC,EAAMz9B,MAAOvD,IAAK,CACpC,MAAM6S,EAAMqhF,GAAeC,EAAWrhF,GACtC,GAAID,IAAQohF,GAAO,CACjB,GAAIjzD,EAAMz9B,QAAUuS,IAElB,MAEF,MAAM,IAAI7Y,MAAM,GAAGu2F,0CACrB,CACA,GAAI3gF,IAAQmhF,GACV,MAAM,IAAI/2F,MAAM,GAAGu2F,4CAAyDxzF,wBAAwBghC,EAAMz9B,UAE5G,IAAgB,IAAZ+wF,GAAmC,iBAARzhF,EAC7B,MAAM,IAAI5V,MAAM,GAAGu2F,gDAA6D3gF,MAElF,IAAuC,IAAnCC,EAAQyhF,yBAELD,GAAWnyE,EAAEzC,IAAI7M,KAAWyhF,GAAYzhF,KAAO7E,GAClD,MAAM,IAAI/Q,MAAM,GAAGu2F,4BAAyC3gF,MAGhE,MAAMtP,EAAQ2wF,GAAeC,EAAWrhF,GACxC,GAAIvP,IAAUywF,GACZ,MAAM,IAAI/2F,MAAM,GAAGu2F,4CAAyDxzF,0BAA0BghC,EAAMz9B,UAE1G+wF,EAEFnyE,EAAE5hB,IAAIsS,EAAKtP,GAGXyK,EAAI6E,GAAOtP,CAEf,CAEA,OAAO+wF,EAAUnyE,EAAInU,CACvB,CA6BWwmF,CAAWxzD,EAAOmzD,EAAWrhF,GAGtC,GAAIkuB,EAAMptB,OAAS,OAAU,CAC3B,GAAId,EAAQ2hF,MAA6C,mBAA9B3hF,EAAQ2hF,KAAKzzD,EAAMz9B,OAAuB,CACnE,MAAMmxF,EAASR,GAAeC,EAAWrhF,GACzC,OAAOA,EAAQ2hF,KAAKzzD,EAAMz9B,OAAOmxF,EACnC,CACA,MAAM,IAAIz3F,MAAM,GAAGu2F,yBAAsCxyD,EAAMz9B,SACjE,CAEA,MAAM,IAAItG,MAAM,cAClB,CA4BA,SAAS,GAAQkkB,EAAMrO,GACrB,MAAOovD,EAASvH,GAtBlB,SAAsBx5C,EAAMrO,GAC1B,KAAMqO,aAAgBjiB,YACpB,MAAM,IAAIjC,MAAM,GAAGu2F,0CAGrB,MAAMW,GADNrhF,EAAU1P,OAAO6W,OAAO,CAAC,EAAG45E,GAAsB/gF,IACxB6hF,WAAa,IAAIb,GAAU3yE,EAAMrO,GACrDovD,EAAUgyB,GAAeC,EAAWrhF,GAC1C,GAAIovD,IAAY8xB,GACd,MAAM,IAAI/2F,MAAM,GAAGu2F,yCAErB,GAAItxB,IAAY+xB,GACd,MAAM,IAAIh3F,MAAM,GAAGu2F,2BAErB,MAAO,CAACtxB,EAAS/gD,EAAKnlB,SAASm4F,EAAUxtF,OAC3C,CAQ+Bi0D,CAAYz5C,EAAMrO,GAC/C,GAAI6nD,EAAUh/D,OAAS,EACrB,MAAM,IAAIsB,MAAM,GAAGu2F,8CAErB,OAAOtxB,CACT,yCC3MA,MAAMu5B,GAAW,IACXC,IAAW,IAAIj+E,aAAchK,OAAOgoF,IACpCE,GAAUD,GAAS,GAiBlB,MAAME,GAKTp3F,YAAYktB,EAAGmqE,GACX,GAAiB,iBAANnqE,EACPhtB,KAAKszF,MAAO,QAAqBtmE,OAEhC,MAAIA,aAAaxyB,YAIlB,MAAM,IAAIjC,MAAM,+CAHhByH,KAAKszF,KAAOtmE,CAIhB,CAOA,GANa,MAATmqE,IACAA,GAAQ,GAERA,GACAn3F,KAAKm3F,QAEoB,IAAzBn3F,KAAKszF,KAAKzmF,YAAoB7M,KAAKszF,KAAK,KAAO2D,GAC/C,MAAM,IAAI1+F,MAAM,cAExB,CAOAoM,SAASsG,EAAW,QAChB,OAAO,QAAmBjL,KAAKszF,KAAMroF,EACzC,CAMAmsF,aACI,OAAOp3F,KAAKszF,IAChB,CAMYx9B,IAAPt/D,OAAOs/D,eACR,MAAO,OAAO91D,KAAK2E,aACvB,CAaAsU,sBAAsB0H,GAClB,OAAO,IAAIu2E,GAAIv2E,EAAKhpB,KAAKo/F,IAC7B,CAYA99E,gBACI,OAAO,IAAIi+E,IAAI,WAASz2F,QAAQ,KAAM,IAC1C,CAIAwY,aAAay8C,GACT,OAAIA,aAAiBl7D,YAA+B,iBAAVk7D,EAE/B,IAAIwhC,GAAIxhC,GAEa,mBAArBA,EAAM0hC,WAEN,IAAIF,GAAIxhC,EAAM0hC,cAElB,IACX,CAMAD,QAII,GAHiB,MAAbn3F,KAAKszF,MAAyC,IAAzBtzF,KAAKszF,KAAKzmF,aAC/B7M,KAAKszF,KAAO0D,IAEZh3F,KAAKszF,KAAK,KAAO2D,GAAS,CAC1B,MAAM1zF,EAAQ,IAAI/I,WAAWwF,KAAKszF,KAAKzmF,WAAa,GACpDtJ,EAAM0T,KAAKggF,GAAS,EAAG,GACvB1zF,EAAM1H,IAAImE,KAAKszF,KAAM,GACrBtzF,KAAKszF,KAAO/vF,CAChB,CAEA,KAAOvD,KAAKszF,KAAKzmF,WAAa,GAAK7M,KAAKszF,KAAKtzF,KAAKszF,KAAKzmF,WAAa,KAAOoqF,IACvEj3F,KAAKszF,KAAOtzF,KAAKszF,KAAKh8F,SAAS,GAAI,EAE3C,CAOA+/F,KAAKlpF,GACD,MAAMmpF,EAAQt3F,KAAK2gB,OACb42E,EAAQppF,EAAIwS,OAClB,IAAK,IAAIrlB,EAAI,EAAGA,EAAIg8F,EAAMrgG,OAAQqE,IAAK,CACnC,GAAIi8F,EAAMtgG,OAASqE,EAAI,EACnB,OAAO,EAEX,MAAMk8F,EAAKF,EAAMh8F,GACXm8F,EAAKF,EAAMj8F,GACjB,GAAIk8F,EAAKC,EACL,OAAO,EAEN,GAAID,EAAKC,EACV,OAAO,CAEf,CACA,OAAOH,EAAMrgG,OAASsgG,EAAMtgG,MAChC,CAYAgkB,UACI,OAAOi8E,GAAIQ,eAAe13F,KAAK2gB,OAAO7nB,QAAQmiB,UAClD,CAMAimB,aACI,OAAOlhC,KAAK2gB,MAChB,CAWAg3E,gBACI,MAAMp1B,EAAKviE,KAAKkhC,aAChB,OAAOqhC,EAAGA,EAAGtrE,OAAS,EAC1B,CAYA0pB,OACI,OAAO3gB,KAAK2E,WAAW1F,MAAM83F,IAAUj+F,MAAM,EACjD,CAYAoW,OACI,OAsJR,SAAuBqzD,GACnB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,GAAI1H,EAAMN,OAAS,EACf,MAAO,GAEX,OAAOM,EAAMuB,MAAM,GAAI,GAAGnB,KAAK,IACnC,CA5JeigG,CAAc53F,KAAK23F,gBAC9B,CAYAt4F,OACI,OAqJR,SAAwBkjE,GACpB,MAAMhrE,EAAQgrE,EAAGtjE,MAAM,KACvB,OAAO1H,EAAMA,EAAMN,OAAS,EAChC,CAxJe4gG,CAAe73F,KAAK23F,gBAC/B,CAaAv+F,SAAS4zB,GACL,OAAO,IAAIkqE,GAAIl3F,KAAK2E,WAAa,IAAMqoB,EAC3C,CAYAgC,OACI,IAAIzzB,EAAIyE,KAAKoZ,SAASzU,WAKtB,OAJKpJ,EAAEu8F,SAASf,MACZx7F,GAAKw7F,IAETx7F,GAAKyE,KAAKkP,OACH,IAAIgoF,GAAI37F,EACnB,CAYA6d,SACI,MAAMuH,EAAO3gB,KAAK2gB,OAClB,OAAoB,IAAhBA,EAAK1pB,OACE,IAAIigG,GAAIH,IAEZ,IAAIG,GAAIv2E,EAAK7nB,MAAM,GAAI,GAAGnB,KAAKo/F,IAC1C,CAaAroD,MAAMvgC,GACF,OAAInO,KAAK2E,aAAeoyF,GACb5oF,EAEFA,EAAIxJ,aAAeoyF,GACjB/2F,KAEJ,IAAIk3F,GAAIl3F,KAAK2E,WAAawJ,EAAIxJ,YAAY,EACrD,CAaAozF,aAAariC,GACT,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB+wD,EAAM/wD,WAAWo5D,WAAW/9D,KAAK2E,WAC5C,CAaAqzF,cAActiC,GACV,OAAIA,EAAM/wD,aAAe3E,KAAK2E,YAGvB3E,KAAK2E,WAAWo5D,WAAWrI,EAAM/wD,WAC5C,CAOAszF,aACI,OAA8B,IAAvBj4F,KAAK2gB,OAAO1pB,MACvB,CAOA4iB,UAAUpS,GACN,OAAOyvF,GAAIQ,eAAe,IAAI13F,KAAKkhC,iBAiC1BrmC,EAjCmD4M,EAAKmT,KAAIzM,GAAOA,EAAI+yB,eAkC7E,GAAKrnB,UAAUhf,MAD1B,IAAiBA,CAhCb,ECzWG,MAAMy3D,GAASxB,GAAM,CAC1Bt3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,yCAGC+qC,GAAczB,GAAM,CAC/Bt3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,yCCQC5Y,GAAS,CAACgmD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG4rC,GACLvxD,EACAwxD,GAAUH,GAC+B,GAAU,YAG9CI,GACLzxD,EACAwxD,GAAUH,GACmCC,GAAQ,WAE3D,EAoBIx6C,GAAQ,IAAIiW,QAMZykC,GAAYE,IAChB,MAAMF,EAAY16C,GAAM1Z,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADAD,GAAMxe,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAM,GAOXj1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAASgnD,GACX,MAAM,IAAI98D,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAASinD,GACrB,MAAM,IAAI/8D,MAAM,sDAGlB,OACE,GAAIg9D,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAY,GAAclmD,EAAMg8C,GACtC,OACE,GAAIoL,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAO,GAAI10C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,StB5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YTrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GS0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GsBiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAOjmD,GAAO5O,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK5S,GAAO5O,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiB,GAEnB,OAAOA,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAI,GACTqqB,EACA7a,EACwC,EACxC9K,GAASwyD,GAAU7sC,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAMm3D,IAAqB,CAIpC,MAAM,QAAE9sC,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,GAAckK,GACjB,OAAO,GAAI51D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAASgnD,GACX,MAAM,IAAI98D,MACR,wCAAwC88D,sBAG1C,OAAO,IAAI,GAAInsC,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQwyD,GAAU7sC,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI,GAAI2lB,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO,GAAI1rD,OAAO,EAAG02D,GAAahL,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO,GAAI1rD,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAa,GAAIC,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQ,GAAIC,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiB,GACrBhzD,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAI,GACjB8L,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACF,GAAIqsC,SAAyD,GAC7D,GAAIE,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,GAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,GAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAASszD,GAAgB14D,EAAQ02D,GAE1CI,EAAM,GAAI7oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFAw8D,GAAUE,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM4B,GAAkB,CAAC14D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CACkB,GAAgB,OACvCtE,EAAQnkD,OAAO,GAAG,YAAmBjO,KAEzC,CACA,KAAK,UAAkB,CACrB,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CAAuB,GAAgB,OAAGtE,EAAQnkD,OAAOjO,GAClE,CACA,KAAK,UAAe,CAClB,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CAAuB,GAAa,OAAGtE,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI22D,GAAa,CAACvxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAW,UACb,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASID,GAAa,CAACzxD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGII,GAAc,IACdC,GAAe,GAQfS,GAAY,CAAC7sC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,GAAsB5tC,GACnC6tC,EAAaD,EAAa,GAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,GAAgBqc,EAAS3lB,EAAO,GAChC,GAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGHyyD,GAAYx/D,OAAOkqD,IAAI,uECrlB7B,IAKI+tD,GALAC,GAAkE,SAAU9jE,EAAU4B,EAAOs9D,EAAMn/B,GACnG,GAAa,MAATm/B,IAAiBn/B,EAAG,MAAM,IAAI3lE,UAAU,iDAC5C,GAAqB,mBAAVwnC,EAAuB5B,IAAa4B,IAAUm+B,GAAKn+B,EAAMxxB,IAAI4vB,GAAW,MAAM,IAAI5lC,UAAU,4EACvG,MAAgB,MAAT8kG,EAAen/B,EAAa,MAATm/B,EAAen/B,EAAE5xE,KAAK6xC,GAAY+/B,EAAIA,EAAE9rE,MAAQ2tC,EAAM7rC,IAAIiqC,EACxF,EAkCA6jE,GAAuB,IAAIn+E,QAC3B,IC5BIq+E,GAAmBC,GAAmCC,GAA2BC,GAAuBC,GAAqBC,GAAkBC,GAAqBC,GAAoBC,GAAmBC,GAAeC,GAAoBC,GAAiBC,GAAqBC,GAAkBC,GAAwBC,GAAsCC,GAAwCC,GAAcC,GAA0BC,GAA8BC,GAA2BC,GAAoCC,GAAoBC,GAAsBC,GAAsBC,GD4BrlB,GAhCA,MACItwG,cACI2uG,GAAqB5yG,IAAImE,KAAM,GACnC,CACAqwG,QAAQC,EAAKliG,GAKT,MAAMi6F,EAAU,CACZkI,UALJniG,EAAU,CACNmiG,SAAU,KACPniG,IAGemiG,SAClBD,OAEJ,GAAItwG,KAAKvI,MAAQi3G,GAAuB1uG,KAAMyuG,GAAsB,KAAKzuG,KAAKvI,KAAO,GAAG84G,UAAYniG,EAAQmiG,SAExG,YADA7B,GAAuB1uG,KAAMyuG,GAAsB,KAAK/2G,KAAK2wG,GAGjE,MAAMh+E,EEtBC,SAAoBxN,EAAOhe,EAAO2xG,GAC7C,IAAI9sF,EAAQ,EACRpS,EAAQuL,EAAM5lB,OAClB,KAAOqa,EAAQ,GAAG,CACd,MAAMm/F,EAAOx3G,KAAKy3G,MAAMp/F,EAAQ,GAChC,IAAI80E,EAAK1iE,EAAQ+sF,EACbD,EAAW3zF,EAAMupE,GAAKvnF,IAAU,GAChC6kB,IAAU0iE,EACV90E,GAASm/F,EAAO,GAGhBn/F,EAAQm/F,CAEhB,CACA,OAAO/sF,CACX,CFOsBqI,CAAW2iF,GAAuB1uG,KAAMyuG,GAAsB,KAAMpG,GAAS,CAAC5nF,EAAGnE,IAAMA,EAAEi0F,SAAW9vF,EAAE8vF,WACpH7B,GAAuB1uG,KAAMyuG,GAAsB,KAAKxjF,OAAOZ,EAAO,EAAGg+E,EAC7E,CACAsI,UACI,MAAMl+F,EAAOi8F,GAAuB1uG,KAAMyuG,GAAsB,KAAKrvG,QACrE,OAAOqT,aAAmC,EAASA,EAAK69F,GAC5D,CACAp4F,OAAO9J,GACH,OAAOsgG,GAAuB1uG,KAAMyuG,GAAsB,KAAKv2F,QAAQmwF,GAAYA,EAAQkI,WAAaniG,EAAQmiG,WAAU31F,KAAKytF,GAAYA,EAAQiI,KACvJ,CACI74G,WACA,OAAOi3G,GAAuB1uG,KAAMyuG,GAAsB,KAAKx3G,MACnE,GCpCA25G,GAAkE,SAAUhmE,EAAU4B,EAAO3tC,EAAOirG,EAAMn/B,GAC1G,GAAa,MAATm/B,EAAc,MAAM,IAAI9kG,UAAU,kCACtC,GAAa,MAAT8kG,IAAiBn/B,EAAG,MAAM,IAAI3lE,UAAU,iDAC5C,GAAqB,mBAAVwnC,EAAuB5B,IAAa4B,IAAUm+B,GAAKn+B,EAAMxxB,IAAI4vB,GAAW,MAAM,IAAI5lC,UAAU,2EACvG,MAAiB,MAAT8kG,EAAen/B,EAAE5xE,KAAK6xC,EAAU/rC,GAAS8rE,EAAIA,EAAE9rE,MAAQA,EAAQ2tC,EAAM3wC,IAAI+uC,EAAU/rC,GAASA,CACxG,EACI,GAAkE,SAAU+rC,EAAU4B,EAAOs9D,EAAMn/B,GACnG,GAAa,MAATm/B,IAAiBn/B,EAAG,MAAM,IAAI3lE,UAAU,iDAC5C,GAAqB,mBAAVwnC,EAAuB5B,IAAa4B,IAAUm+B,GAAKn+B,EAAMxxB,IAAI4vB,GAAW,MAAM,IAAI5lC,UAAU,4EACvG,MAAgB,MAAT8kG,EAAen/B,EAAa,MAATm/B,EAAen/B,EAAE5xE,KAAK6xC,GAAY+/B,EAAIA,EAAE9rE,MAAQ2tC,EAAM7rC,IAAIiqC,EACxF,EAQO,MAAMy8B,WAAmB9uE,OAKhC,MAAMs4G,WAAe,MAEjB/wG,YAAYsO,GACR,IAAI+5B,EAAI2oE,EAAIC,EAAIC,EAuChB,GAtCAr+F,QACAg8F,GAAkB32F,IAAIhY,MACtB4uG,GAAkC/yG,IAAImE,UAAM,GAC5C6uG,GAA0BhzG,IAAImE,UAAM,GACpC8uG,GAAsBjzG,IAAImE,KAAM,GAChC+uG,GAAoBlzG,IAAImE,UAAM,GAC9BgvG,GAAiBnzG,IAAImE,UAAM,GAC3BivG,GAAoBpzG,IAAImE,KAAM,GAC9BkvG,GAAmBrzG,IAAImE,UAAM,GAC7BmvG,GAAkBtzG,IAAImE,UAAM,GAC5BovG,GAAcvzG,IAAImE,UAAM,GACxBqvG,GAAmBxzG,IAAImE,UAAM,GAC7BsvG,GAAgBzzG,IAAImE,KAAM,GAE1BuvG,GAAoB1zG,IAAImE,UAAM,GAC9BwvG,GAAiB3zG,IAAImE,UAAM,GAC3ByvG,GAAuB5zG,IAAImE,UAAM,GAMjCtB,OAAO2B,eAAeL,KAAM,UAAW,CACnCY,YAAY,EACZqH,cAAc,EACd/H,UAAU,EACVrB,WAAO,MAY0B,iBATrCuP,EAAU,CACN6iG,2BAA2B,EAC3BC,YAAaloG,OAAOmoG,kBACpBC,SAAU,EACVt0B,YAAa9zE,OAAOmoG,kBACpBE,WAAW,EACXC,WAAY,MACTljG,IAEc8iG,aAA4B9iG,EAAQ8iG,aAAe,GACpE,MAAM,IAAIlsG,UAAU,gEAAyJ,QAAxF8rG,EAAoC,QAA9B3oE,EAAK/5B,EAAQ8iG,mBAAgC,IAAP/oE,OAAgB,EAASA,EAAGxjC,kBAA+B,IAAPmsG,EAAgBA,EAAK,gBAAgB1iG,EAAQ8iG,gBAEtO,QAAyBxpG,IAArB0G,EAAQgjG,YAA4BpoG,OAAOC,SAASmF,EAAQgjG,WAAahjG,EAAQgjG,UAAY,GAC7F,MAAM,IAAIpsG,UAAU,2DAAiJ,QAArFgsG,EAAiC,QAA3BD,EAAK3iG,EAAQgjG,gBAA6B,IAAPL,OAAgB,EAASA,EAAGpsG,kBAA+B,IAAPqsG,EAAgBA,EAAK,gBAAgB5iG,EAAQgjG,aAE9NR,GAAuB5wG,KAAM4uG,GAAmCxgG,EAAQ6iG,0BAA2B,KACnGL,GAAuB5wG,KAAM6uG,GAA2BzgG,EAAQ8iG,cAAgBloG,OAAOmoG,mBAA0C,IAArB/iG,EAAQgjG,SAAgB,KACpIR,GAAuB5wG,KAAM+uG,GAAqB3gG,EAAQ8iG,YAAa,KACvEN,GAAuB5wG,KAAMgvG,GAAkB5gG,EAAQgjG,SAAU,KACjER,GAAuB5wG,KAAMovG,GAAe,IAAIhhG,EAAQkjG,WAAc,KACtEV,GAAuB5wG,KAAMqvG,GAAoBjhG,EAAQkjG,WAAY,KACrEtxG,KAAK88E,YAAc1uE,EAAQ0uE,YAC3B98E,KAAK2vE,QAAUvhE,EAAQuhE,QACvBihC,GAAuB5wG,KAAMyvG,IAAmD,IAA3BrhG,EAAQmjG,eAAyB,KACtFX,GAAuB5wG,KAAMwvG,IAAwC,IAAtBphG,EAAQijG,UAAqB,IAChF,CACIv0B,kBACA,OAAO,GAAuB98E,KAAMuvG,GAAqB,IAC7D,CACIzyB,gBAAY00B,GACZ,KAAgC,iBAAnBA,GAA+BA,GAAkB,GAC1D,MAAM,IAAIxsG,UAAU,gEAAgEwsG,eAA4BA,MAEpHZ,GAAuB5wG,KAAMuvG,GAAqBiC,EAAgB,KAClE,GAAuBxxG,KAAM2uG,GAAmB,IAAKuB,IAAsBn3G,KAAKiH,KACpF,CACA/B,UAAUwzG,EAAWrjG,EAAU,CAAC,GAM5B,OALAA,EAAU,CACNuhE,QAAS3vE,KAAK2vE,QACd4hC,eAAgB,GAAuBvxG,KAAMyvG,GAAwB,QAClErhG,GAEA,IAAIoD,SAAQ,CAACC,EAASC,KACzB,GAAuB1R,KAAMovG,GAAe,KAAKiB,SAAQpyG,UACrD,IAAIkqC,EACA2oE,EAAIC,EACRH,GAAuB5wG,KAAMsvG,IAAkBwB,EAAK,GAAuB9wG,KAAMsvG,GAAiB,OAAMwB,GAAW,KACnHF,GAAuB5wG,KAAM8uG,IAAwBiC,EAAK,GAAuB/wG,KAAM8uG,GAAuB,OAAMiC,GAAW,KAC/H,IAEI,GAA8B,QAAzB5oE,EAAK/5B,EAAQ6Z,cAA2B,IAAPkgB,OAAgB,EAASA,EAAG/f,QAE9D,MAAM,IAAIi/C,GAAW,yBAEzB,IAAIqqC,EAAYD,EAAU,CAAExpF,OAAQ7Z,EAAQ6Z,SACxC7Z,EAAQuhE,UACR+hC,GAAY,SAASlgG,QAAQC,QAAQigG,GAAYtjG,EAAQuhE,UAEzDvhE,EAAQ6Z,SACRypF,EAAYlgG,QAAQo2D,KAAK,CAAC8pC,EAAW,GAAuB1xG,KAAM2uG,GAAmB,IAAKwB,IAAsBp3G,KAAKiH,KAAMoO,EAAQ6Z,WAEvI,MAAMrO,QAAe83F,EACrBjgG,EAAQmI,GACR5Z,KAAK8F,KAAK,YAAa8T,EAC3B,CACA,MAAOwG,GACH,GAAIA,aAAiB,QAAiBhS,EAAQmjG,eAE1C,YADA9/F,IAGJC,EAAO0O,GACPpgB,KAAK8F,KAAK,QAASsa,EACvB,CACA,QACI,GAAuBpgB,KAAM2uG,GAAmB,IAAKiB,IAAc72G,KAAKiH,KAC5E,IACDoO,GACHpO,KAAK8F,KAAK,OACV,GAAuB9F,KAAM2uG,GAAmB,IAAKoB,IAA2Bh3G,KAAKiH,KAAK,GAElG,CACA/B,aAAa0zG,EAAWvjG,GACpB,OAAOoD,QAAQQ,IAAI2/F,EAAU/2F,KAAI3c,MAAOwzG,GAAczxG,KAAKgY,IAAIy5F,EAAWrjG,KAC9E,CAIA5K,QACI,OAAK,GAAuBxD,KAAMwvG,GAAkB,MAGpDoB,GAAuB5wG,KAAMwvG,IAAkB,EAAO,KACtD,GAAuBxvG,KAAM2uG,GAAmB,IAAKuB,IAAsBn3G,KAAKiH,MACzEA,MAJIA,IAKf,CAIAw/F,QACIoR,GAAuB5wG,KAAMwvG,IAAkB,EAAM,IACzD,CAIAngG,QACIuhG,GAAuB5wG,KAAMovG,GAAe,IAAK,GAAuBpvG,KAAMqvG,GAAoB,MAAS,IAC/G,CAMApxG,gBAEkE,IAA1D,GAAuB+B,KAAMovG,GAAe,KAAK33G,YAG/C,GAAuBuI,KAAM2uG,GAAmB,IAAKyB,IAAiBr3G,KAAKiH,KAAM,QAC3F,CAQA/B,qBAAqBkT,GAEb,GAAuBnR,KAAMovG,GAAe,KAAK33G,KAAO0Z,SAGtD,GAAuBnR,KAAM2uG,GAAmB,IAAKyB,IAAiBr3G,KAAKiH,KAAM,QAAQ,IAAM,GAAuBA,KAAMovG,GAAe,KAAK33G,KAAO0Z,GACjK,CAMAlT,eAE+D,IAAvD,GAAuB+B,KAAMsvG,GAAiB,MAAwE,IAA1D,GAAuBtvG,KAAMovG,GAAe,KAAK33G,YAG3G,GAAuBuI,KAAM2uG,GAAmB,IAAKyB,IAAiBr3G,KAAKiH,KAAM,OAC3F,CAIIvI,WACA,OAAO,GAAuBuI,KAAMovG,GAAe,KAAK33G,IAC5D,CAMAm6G,OAAOxjG,GAEH,OAAO,GAAuBpO,KAAMovG,GAAe,KAAKl3F,OAAO9J,GAASnX,MAC5E,CAIIsf,cACA,OAAO,GAAuBvW,KAAMsvG,GAAiB,IACzD,CAII/lE,eACA,OAAO,GAAuBvpC,KAAMwvG,GAAkB,IAC1D,EAEJZ,GAAoC,IAAIt+E,QAAWu+E,GAA4B,IAAIv+E,QAAWw+E,GAAwB,IAAIx+E,QAAWy+E,GAAsB,IAAIz+E,QAAW0+E,GAAmB,IAAI1+E,QAAW2+E,GAAsB,IAAI3+E,QAAW4+E,GAAqB,IAAI5+E,QAAW6+E,GAAoB,IAAI7+E,QAAW8+E,GAAgB,IAAI9+E,QAAW++E,GAAqB,IAAI/+E,QAAWg/E,GAAkB,IAAIh/E,QAAWi/E,GAAsB,IAAIj/E,QAAWk/E,GAAmB,IAAIl/E,QAAWm/E,GAAyB,IAAIn/E,QAAWq+E,GAAoB,IAAI3oD,QAAW0pD,GAAuC,WACjlB,OAAO,GAAuB1vG,KAAM6uG,GAA2B,MAAQ,GAAuB7uG,KAAM8uG,GAAuB,KAAO,GAAuB9uG,KAAM+uG,GAAqB,IACxL,EAAGY,GAAyC,WACxC,OAAO,GAAuB3vG,KAAMsvG,GAAiB,KAAO,GAAuBtvG,KAAMuvG,GAAqB,IAClH,EAAGK,GAAe,WACd,IAAIznE,EACJyoE,GAAuB5wG,KAAMsvG,IAAkBnnE,EAAK,GAAuBnoC,KAAMsvG,GAAiB,OAAMnnE,GAAW,KACnH,GAAuBnoC,KAAM2uG,GAAmB,IAAKoB,IAA2Bh3G,KAAKiH,MACrFA,KAAK8F,KAAK,OACd,EAAG+pG,GAA2B,WAC1B,GAAuB7vG,KAAM2uG,GAAmB,IAAKsB,IAAoBl3G,KAAKiH,MAC9E,GAAuBA,KAAM2uG,GAAmB,IAAKqB,IAAoCj3G,KAAKiH,MAC9F4wG,GAAuB5wG,KAAMmvG,QAAmBznG,EAAW,IAC/D,EAAGooG,GAA+B,WAC9B,MAAMz4D,EAAMn+C,KAAKm+C,MACjB,QAA8D3vC,IAA1D,GAAuB1H,KAAMkvG,GAAoB,KAAoB,CACrE,MAAMxqE,EAAQ,GAAuB1kC,KAAMivG,GAAqB,KAAO53D,EACvE,KAAI3S,EAAQ,GAYR,YAL6Dh9B,IAAzD,GAAuB1H,KAAMmvG,GAAmB,MAChDyB,GAAuB5wG,KAAMmvG,GAAmBppG,YAAW,KACvD,GAAuB/F,KAAM2uG,GAAmB,IAAKkB,IAA0B92G,KAAKiH,KAAK,GAC1F0kC,GAAQ,MAER,EATPksE,GAAuB5wG,KAAM8uG,GAAwB,GAAuB9uG,KAAM4uG,GAAmC,KAAQ,GAAuB5uG,KAAMsvG,GAAiB,KAAO,EAAG,IAW7L,CACA,OAAO,CACX,EAAGS,GAA4B,WAC3B,GAA8D,IAA1D,GAAuB/vG,KAAMovG,GAAe,KAAK33G,KAWjD,OARI,GAAuBuI,KAAMkvG,GAAoB,MACjDh/B,cAAc,GAAuBlwE,KAAMkvG,GAAoB,MAEnE0B,GAAuB5wG,KAAMkvG,QAAoBxnG,EAAW,KAC5D1H,KAAK8F,KAAK,SACiD,IAAvD,GAAuB9F,KAAMsvG,GAAiB,MAC9CtvG,KAAK8F,KAAK,SAEP,EAEX,IAAK,GAAuB9F,KAAMwvG,GAAkB,KAAM,CACtD,MAAMqC,GAAyB,GAAuB7xG,KAAM2uG,GAAmB,IAAKmB,IACpF,GAAI,GAAuB9vG,KAAM2uG,GAAmB,IAAKe,KAAyC,GAAuB1vG,KAAM2uG,GAAmB,IAAKgB,IAAyC,CAC5L,MAAMmC,EAAM,GAAuB9xG,KAAMovG,GAAe,KAAKuB,UAC7D,QAAKmB,IAGL9xG,KAAK8F,KAAK,UACVgsG,IACID,GACA,GAAuB7xG,KAAM2uG,GAAmB,IAAKqB,IAAoCj3G,KAAKiH,OAE3F,EACX,CACJ,CACA,OAAO,CACX,EAAGgwG,GAAqC,WAChC,GAAuBhwG,KAAM6uG,GAA2B,WAAkEnnG,IAA1D,GAAuB1H,KAAMkvG,GAAoB,OAGrH0B,GAAuB5wG,KAAMkvG,GAAoB6C,aAAY,KACzD,GAAuB/xG,KAAM2uG,GAAmB,IAAKsB,IAAoBl3G,KAAKiH,KAAK,GACpF,GAAuBA,KAAMgvG,GAAkB,MAAO,KACzD4B,GAAuB5wG,KAAMivG,GAAqB/1G,KAAKm+C,MAAQ,GAAuBr3C,KAAMgvG,GAAkB,KAAM,KACxH,EAAGiB,GAAqB,WAC6C,IAA7D,GAAuBjwG,KAAM8uG,GAAuB,MAAqE,IAAvD,GAAuB9uG,KAAMsvG,GAAiB,MAAc,GAAuBtvG,KAAMkvG,GAAoB,OAC/Kh/B,cAAc,GAAuBlwE,KAAMkvG,GAAoB,MAC/D0B,GAAuB5wG,KAAMkvG,QAAoBxnG,EAAW,MAEhEkpG,GAAuB5wG,KAAM8uG,GAAuB,GAAuB9uG,KAAM4uG,GAAmC,KAAO,GAAuB5uG,KAAMsvG,GAAiB,KAAO,EAAG,KACnL,GAAuBtvG,KAAM2uG,GAAmB,IAAKuB,IAAsBn3G,KAAKiH,KACpF,EAAGkwG,GAAuB,WAEtB,KAAO,GAAuBlwG,KAAM2uG,GAAmB,IAAKoB,IAA2Bh3G,KAAKiH,QAChG,EAAGmwG,GAAuBlyG,eAAoCgqB,GAC1D,OAAO,IAAIzW,SAAQ,CAACq7D,EAAUn7D,KAC1BuW,EAAOE,iBAAiB,SAAS,KAG7BzW,EAAO,IAAI21D,GAAW,yBAAyB,GAChD,CAAElxD,MAAM,GAAO,GAE1B,EAAGi6F,GAAkBnyG,eAA+BssC,EAAOryB,GACvD,OAAO,IAAI1G,SAAQC,IACf,MAAMm6B,EAAW,KACT1zB,IAAWA,MAGflY,KAAKiG,IAAIskC,EAAOqB,GAChBn6B,IAAS,EAEbzR,KAAKsqC,GAAGC,EAAOqB,EAAS,GAEhC,EACA,kCE/TA,MAAMqnD,WAAoBr6F,MACxBkH,cACE6S,QAEA3S,KAAKkzF,YAAc,EACrB,CAKA15E,OAAQze,GACN,MAAMo4F,EAASnzF,KAAKkzF,YAAYlzF,KAAKkzF,YAAYj8F,OAAS,GACtDk8F,IACEA,EAAOjkF,OAASjU,KAAK4hB,QACvBs2E,EAAOC,WACiB,IAApBD,EAAOC,UACTr4F,EAAIrD,KAAK,CAAC,MAGVy7F,EAAOjkF,OAASjU,KAAK2f,MACvBu4E,EAAOC,WACiB,IAApBD,EAAOC,WACLD,EAAOC,SAAW,GAAM,EAC1Br4F,EAAIrD,KAAK,CAAC,KAEVqD,EAAIrD,KAAK,CAAC,OAKpB,CAMA,CAAC,eAAkBqD,EAAKuhC,GACtBt8B,KAAKwZ,OAAOze,GACZ,MAAMq1F,EAAKj5F,OAAOmlC,EAAMz9B,OAClBw0F,EAAM,GACZ,IAAK,IAAI/3F,EAAI,EAAGA,EAAI80F,EAAGn5F,OAAQqE,IAC7B+3F,EAAI/3F,GAAK80F,EAAG50F,WAAWF,GAEzBP,EAAIrD,KAAK27F,EACX,CAMA,CAAC,iBAAoBt4F,EAAKuhC,GAExBt8B,KAAK/E,KAAKwtF,KAAK7vC,OAAO79C,EAAKuhC,EAC7B,CAMA,CAAC,gBAAmBg3D,EAAMC,GACxB,MAAM,IAAIh7F,MAAM,GAAGw2F,+CACrB,CAMA,CAAC,iBAAoBh0F,EAAKuhC,GACxBt8B,KAAKwZ,OAAOze,GAIZ,MAAM42D,EAAOhrD,WAAWuzB,KAAKuG,UAAUnE,EAAMz9B,QAC7C9D,EAAIrD,KAAKi6D,EAAK16D,OAAS,GAAK03F,MAAMh9B,GAAQA,EAC5C,CAMA,CAAC,gBAAmB52D,EAAKw4F,GACvBvzF,KAAKwZ,OAAOze,GACZiF,KAAKkzF,YAAYx7F,KAAK,CAAEwX,KAAMjU,KAAK4hB,MAAOu2E,SAAU,IACpDr4F,EAAIrD,KAAK,CAAC,IACZ,CAMA,CAAC,cAAiBqD,EAAKw4F,GACrBvzF,KAAKwZ,OAAOze,GACZiF,KAAKkzF,YAAYx7F,KAAK,CAAEwX,KAAMjU,KAAK2f,IAAKw4E,SAAU,IAClDr4F,EAAIrD,KAAK,CAAC,KACZ,CAMA,CAAC,cAAiB47F,EAAMC,GAAS,CAMjC,CAAC,gBAAmBx4F,EAAKuhC,GACvB,GAAwB,UAApBA,EAAMptB,KAAK7P,KAAkB,CAC/B,MAAM8zF,EAASnzF,KAAKkzF,YAAYnzD,MAChC,GAAIozD,EAAQ,CACV,GAAIA,EAAOjkF,OAASjU,KAAK4hB,MACvB9hB,EAAIrD,KAAK,CAAC,SACL,IAAIy7F,EAAOjkF,OAASjU,KAAK2f,IAI9B,MAAM,IAAIriB,MAAM,sDAHhBwC,EAAIrD,KAAK,CAAC,KAIZ,CACA,MACF,CAEA,MAAM,IAAIa,MAAM,4CAClB,CACA,QAAoBmP,IAAhB40B,EAAMz9B,MACR,MAAM,IAAItG,MAAM,GAAGw2F,+CAIrB,GADA/uF,KAAKwZ,OAAOze,GACY,SAApBuhC,EAAMptB,KAAK7P,KAEb,YADAtE,EAAIrD,KAAK,CAAC,IAAK,IAAK,IAAK,MAEpB,GAAwB,UAApB4kC,EAAMptB,KAAK7P,KAEpB,YADAtE,EAAIrD,KAAK,CAAC,IAAK,GAAI,IAAK,IAAK,MAExB,GAAwB,SAApB4kC,EAAMptB,KAAK7P,KAEpB,YADAtE,EAAIrD,KAAK,CAAC,IAAK,IAAK,IAAK,MAK3B,MAAM04F,EAAKj5F,OAAOmlC,EAAMz9B,OAClBw0F,EAAM,GACZ,IAAIx3B,GAAK,EACT,IAAK,IAAIvgE,EAAI,EAAGA,EAAI80F,EAAGn5F,OAAQqE,IAC7B+3F,EAAI/3F,GAAK80F,EAAG50F,WAAWF,GAClBugE,GAAkB,KAAXw3B,EAAI/3F,IAAwB,MAAX+3F,EAAI/3F,IAAyB,KAAX+3F,EAAI/3F,KACjDugE,GAAK,GAGJA,IACHw3B,EAAI37F,KAAK,IACT27F,EAAI37F,KAAK,KAEXqD,EAAIrD,KAAK27F,EACX,ECxJF,MAAMG,GAKJ1zF,YAAa2c,EAAMrO,EAAU,CAAC,GAC5BpO,KAAKgrF,KAAO,EACZhrF,KAAKyc,KAAOA,EACZzc,KAAKoO,QAAUA,EAEfpO,KAAKyzF,UAAY,CAAC,SAClBzzF,KAAK0zF,UAAY,EACnB,CAEAzxF,MACE,OAAOjC,KAAKgrF,IACd,CAKA3yD,OACE,OAAOr4B,KAAKgrF,MAAQhrF,KAAKyc,KAAKxlB,MAChC,CAKA08F,KACE,OAAO3zF,KAAKyc,KAAKzc,KAAKgrF,KACxB,CAKA4I,cACE,OAAO5zF,KAAKyzF,UAAUzzF,KAAKyzF,UAAUx8F,OAAS,EAChD,CAEA48F,iBACE,IAAI50E,EAAIjf,KAAK2zF,KAEb,KAAa,KAAN10E,GAA4B,IAANA,GAA4B,KAANA,GAA6B,KAANA,GACxEA,EAAIjf,KAAKyc,OAAOzc,KAAKgrF,KAEzB,CAKA8I,OAAQz4F,GACN,GAAI2E,KAAKyc,KAAKxlB,OAAS+I,KAAKgrF,KAAO3vF,EAAIpE,OACrC,MAAM,IAAIsB,MAAM,GAAGu2F,0CAAuD9uF,KAAKgrF,QAEjF,IAAK,IAAI1vF,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC9B,GAAI0E,KAAKyc,KAAKzc,KAAKgrF,UAAY3vF,EAAIC,GACjC,MAAM,IAAI/C,MAAM,GAAGu2F,mCAAgD9uF,KAAKgrF,2BAA2B7zF,OAAOC,gBAAgBiE,MAGhI,CAEA04F,cACE,MAAMC,EAAWh0F,KAAKgrF,KACtB,IAAIiJ,GAAW,EACX75F,GAAQ,EAKZ,MAAM85F,EAAWl6D,IACf,MAAQh6B,KAAKq4B,QAAQ,CACnB,MAAMs7D,EAAK3zF,KAAK2zF,KAChB,IAAI35D,EAAMzY,SAASoyE,GAGjB,MAFA3zF,KAAKgrF,MAIT,GAQF,GAJkB,KAAdhrF,KAAK2zF,OACPM,GAAW,EACXj0F,KAAKgrF,QAEW,KAAdhrF,KAAK2zF,KAAa,CAEpB,GADA3zF,KAAKgrF,OACa,KAAdhrF,KAAK2zF,KAIP,OAAO,IAAI,GAAM,QAAW,EAAG3zF,KAAKgrF,KAAOgJ,GAH3Ch0F,KAAKgrF,OACL5wF,GAAQ,CAIZ,CAEA,GADA85F,EAAQ,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KACzCD,GAAYj0F,KAAKgrF,OAASgJ,EAAW,EACvC,MAAM,IAAIz7F,MAAM,GAAGu2F,mCAAgD9uF,KAAKgrF,QAE1E,IAAKhrF,KAAKq4B,QAAwB,KAAdr4B,KAAK2zF,KAAa,CACpC,GAAIv5F,EACF,MAAM,IAAI7B,MAAM,GAAGu2F,mCAAgD9uF,KAAKgrF,QAE1E5wF,GAAQ,EACR4F,KAAKgrF,OACLkJ,EAAQ,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAC/C,CACKl0F,KAAKq4B,QAAyB,MAAdr4B,KAAK2zF,MAA8B,KAAd3zF,KAAK2zF,OAC7Cv5F,GAAQ,EACR4F,KAAKgrF,OACAhrF,KAAKq4B,QAAyB,KAAdr4B,KAAK2zF,MAA6B,KAAd3zF,KAAK2zF,MAC5C3zF,KAAKgrF,OAEPkJ,EAAQ,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,MAG/C,MAAMC,EAASh9F,OAAOC,aAAaC,MAAM,KAAM2I,KAAKyc,KAAKnlB,SAAS08F,EAAUh0F,KAAKgrF,OAC3ErkD,EAAMtZ,WAAW8mE,GACvB,OAAI/5F,EACK,IAAI,GAAM,SAAYusC,EAAK3mC,KAAKgrF,KAAOgJ,IAEf,IAA7Bh0F,KAAKoO,QAAQ65E,aAAwBj/E,OAAOogD,cAAcziB,GACrD,IAAI,GAAMA,GAAO,EAAI,QAAY,UAAaA,EAAK3mC,KAAKgrF,KAAOgJ,GAEjE,IAAI,GAAMrtD,GAAO,EAAI,QAAY,UAAa1kB,OAAOkyE,GAASn0F,KAAKgrF,KAAOgJ,EACnF,CAKAI,cAEE,GAAkB,KAAdp0F,KAAK2zF,KAEP,MAAM,IAAIp7F,MAAM,GAAGu2F,uCAAoD9uF,KAAKgrF,+BAE9EhrF,KAAKgrF,OAIL,IAAK,IAAI1vF,EAAI0E,KAAKgrF,KAAMp5D,EAAI,EAAGt2B,EAAI0E,KAAKyc,KAAKxlB,QAAU26B,EAAI,MAASt2B,IAAKs2B,IAAK,CAC5E,MAAM+hE,EAAK3zF,KAAKyc,KAAKnhB,GACrB,GAAW,KAAPq4F,GAAaA,EAAK,IAAMA,GAAM,IAChC,MAEF,GAAW,KAAPA,EAAW,CAEb,MAAMt4F,EAAMlE,OAAOC,aAAaC,MAAM,KAAM2I,KAAKyc,KAAKnlB,SAAS0I,KAAKgrF,KAAM1vF,IAE1E,OADA0E,KAAKgrF,KAAO1vF,EAAI,EACT,IAAI,GAAM,UAAaD,EAAKu2B,EACrC,CACF,CAEA,MAAMoiE,EAAWh0F,KAAKgrF,KAChBhxD,EAAQ,GAERq6D,EAAS,KACb,GAAIr0F,KAAKgrF,KAAO,GAAKhrF,KAAKyc,KAAKxlB,OAC7B,MAAM,IAAIsB,MAAM,GAAGu2F,4DAAyE9uF,KAAKgrF,QAEnG,IAAIsJ,EAAK,EACT,IAAK,IAAIh5F,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAIq4F,EAAK3zF,KAAK2zF,KACd,GAAIA,GAAM,IAAMA,GAAM,GACpBA,GAAM,QACD,GAAIA,GAAM,IAAMA,GAAM,IAC3BA,EAAKA,EAAK,GAAK,OACV,MAAIA,GAAM,IAAMA,GAAM,IAG3B,MAAM,IAAIp7F,MAAM,GAAGu2F,sDAAmE9uF,KAAKgrF,QAF3F2I,EAAKA,EAAK,GAAK,EAGjB,CACAW,EAAU,GAALA,EAAUX,EACf3zF,KAAKgrF,MACP,CACA,OAAOsJ,GAIHC,EAAe,KACnB,MAAMl1E,EAAYrf,KAAK2zF,KACvB,IAQIn0E,EAAYC,EAAWC,EAAYC,EARnCL,EAAY,KAEZC,EAAoBF,EAAY,IAAQ,EAAKA,EAAY,IAAQ,EAAKA,EAAY,IAAQ,EAAI,EAElG,GAAIrf,KAAKgrF,KAAOzrE,EAAmBvf,KAAKyc,KAAKxlB,OAC3C,MAAM,IAAIsB,MAAM,GAAGu2F,8CAA2D9uF,KAAKgrF,QAKrF,OAAQzrE,GAGN,KAAK,EACCF,EAAY,MACdC,EAAYD,GAEd,MACF,KAAK,EACHG,EAAaxf,KAAKyc,KAAKzc,KAAKgrF,KAAO,GACP,MAAV,IAAbxrE,KACHG,GAA6B,GAAZN,IAAqB,EAAoB,GAAbG,EACzCG,EAAgB,MAClBL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAaxf,KAAKyc,KAAKzc,KAAKgrF,KAAO,GACnCvrE,EAAYzf,KAAKyc,KAAKzc,KAAKgrF,KAAO,GACN,MAAV,IAAbxrE,IAAsD,MAAV,IAAZC,KACnCE,GAA6B,GAAZN,IAAoB,IAAoB,GAAbG,IAAsB,EAAmB,GAAZC,EAErEE,EAAgB,OAAUA,EAAgB,OAAUA,EAAgB,SACtEL,EAAYK,IAGhB,MACF,KAAK,EACHH,EAAaxf,KAAKyc,KAAKzc,KAAKgrF,KAAO,GACnCvrE,EAAYzf,KAAKyc,KAAKzc,KAAKgrF,KAAO,GAClCtrE,EAAa1f,KAAKyc,KAAKzc,KAAKgrF,KAAO,GACP,MAAV,IAAbxrE,IAAsD,MAAV,IAAZC,IAAsD,MAAV,IAAbC,KAClEC,GAA6B,GAAZN,IAAoB,IAAqB,GAAbG,IAAsB,IAAmB,GAAZC,IAAqB,EAAoB,GAAbC,EAClGC,EAAgB,OAAUA,EAAgB,UAC5CL,EAAYK,IAMF,OAAdL,GAGFA,EAAY,MACZC,EAAmB,GACVD,EAAY,QAErBA,GAAa,MACb0a,EAAMtiC,KAAK4nB,IAAc,GAAK,KAAQ,OACtCA,EAAY,MAAqB,KAAZA,GAGvB0a,EAAMtiC,KAAK4nB,GACXtf,KAAKgrF,MAAQzrE,GAKf,MAAQvf,KAAKq4B,QAAQ,CACnB,MAAMs7D,EAAK3zF,KAAK2zF,KAChB,IAAIa,EACJ,OAAQb,GACN,KAAK,GAEH,GADA3zF,KAAKgrF,OACDhrF,KAAKq4B,OACP,MAAM,IAAI9/B,MAAM,GAAGu2F,gDAA6D9uF,KAAKgrF,QAIvF,OAFAwJ,EAAMx0F,KAAK2zF,KACX3zF,KAAKgrF,OACGwJ,GACN,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACHx6D,EAAMtiC,KAAK88F,GACX,MACF,KAAK,GACHx6D,EAAMtiC,KAAK,GACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,GACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK,IACX,MACF,KAAK,IACHsiC,EAAMtiC,KAAK28F,KACX,MACF,QACE,MAAM,IAAI97F,MAAM,GAAGu2F,qDAAkE9uF,KAAKgrF,QAE9F,MACF,KAAK,GAEH,OADAhrF,KAAKgrF,OACE,IAAI,GAAM,UAAalrE,GAAsBka,GAAQh6B,KAAKgrF,KAAOgJ,GAC1E,QACE,GAAIL,EAAK,GACP,MAAM,IAAIp7F,MAAM,GAAGu2F,4CAAyD9uF,KAAKgrF,QACxE2I,EAAK,KACd35D,EAAMtiC,KAAKi8F,GACX3zF,KAAKgrF,QAELuJ,IAGR,CAEA,MAAM,IAAIh8F,MAAM,GAAGu2F,2CAAwD9uF,KAAKgrF,OAClF,CAKAyJ,aACE,OAAQz0F,KAAK2zF,MACX,KAAK,IAGH,OAFA3zF,KAAKyzF,UAAU/7F,KAAK,aACpBsI,KAAKgrF,OACE,IAAI,GAAM,OAAU55E,IAAU,GACvC,KAAK,GAGH,OAFApR,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAKgrF,OACE,IAAI,GAAM,SAAY55E,IAAU,GACzC,KAAK,GACH,OAAOpR,KAAKo0F,cAEd,KAAK,IAEH,OADAp0F,KAAK8zF,OAAO,CAAC,IAAK,IAAK,IAAK,MACrB,IAAI,GAAM,QAAW,KAAM,GACpC,KAAK,IAEH,OADA9zF,KAAK8zF,OAAO,CAAC,IAAK,GAAI,IAAK,IAAK,MACzB,IAAI,GAAM,UAAY,EAAO,GACtC,KAAK,IAEH,OADA9zF,KAAK8zF,OAAO,CAAC,IAAK,IAAK,IAAK,MACrB,IAAI,GAAM,SAAW,EAAM,GACpC,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACH,OAAO9zF,KAAK+zF,cACd,QACE,MAAM,IAAIx7F,MAAM,GAAGu2F,uCAAoD9uF,KAAKgrF,QAElF,CAKA3/E,OAEE,OADArL,KAAK6zF,iBACG7zF,KAAK4zF,eACX,IAAK,QAEH,OADA5zF,KAAKyzF,UAAU1zD,MACR//B,KAAKy0F,aACd,IAAK,cAEH,GADAz0F,KAAKyzF,UAAU1zD,MACG,KAAd//B,KAAK2zF,KAGP,OAFA3zF,KAAKgrF,OACLhrF,KAAK6zF,iBACE,IAAI,GAAM,cAAYnsF,EAAW,GAE1C,GAAkB,KAAd1H,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAGu2F,uCAAoD9uF,KAAKgrF,kDAAkD7zF,OAAOC,aAAa4I,KAAK2zF,UAKzJ,OAHA3zF,KAAKgrF,OACLhrF,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,aAEd,IAAK,cAEH,OADAz0F,KAAKyzF,UAAU1zD,MACG,KAAd//B,KAAK2zF,MACP3zF,KAAKgrF,OACLhrF,KAAK6zF,iBACE,IAAI,GAAM,cAAYnsF,EAAW,KAE1C1H,KAAKyzF,UAAU/7F,KAAK,eACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,cAGd,IAAK,UACH,GAAkB,MAAdz0F,KAAK2zF,KAIP,OAHA3zF,KAAKyzF,UAAU1zD,MACf//B,KAAKgrF,OACLhrF,KAAK6zF,iBACE,IAAI,GAAM,cAAYnsF,EAAW,GAE1C,GAAkB,KAAd1H,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAGu2F,uCAAoD9uF,KAAKgrF,mDAAmD7zF,OAAOC,aAAa4I,KAAK2zF,UAE1J3zF,KAAKgrF,OACLhrF,KAAK6zF,iBACP,IAAK,YAAa,CAEhB,GADA7zF,KAAKyzF,UAAU1zD,MACG,MAAd//B,KAAK2zF,KAGP,OAFA3zF,KAAKgrF,OACLhrF,KAAK6zF,iBACE,IAAI,GAAM,cAAYnsF,EAAW,GAE1C,MAAM40B,EAAQt8B,KAAKo0F,cAEnB,GADAp0F,KAAK6zF,iBACa,KAAd7zF,KAAK2zF,KACP,MAAM,IAAIp7F,MAAM,GAAGu2F,uCAAoD9uF,KAAKgrF,0DAA0D7zF,OAAOC,aAAa4I,KAAK2zF,UAIjK,OAFA3zF,KAAKgrF,OACLhrF,KAAKyzF,UAAU/7F,KAAK,aACb4kC,CACT,CACA,IAAK,YAIH,OAHAt8B,KAAKyzF,UAAU1zD,MACf//B,KAAKyzF,UAAU/7F,KAAK,WACpBsI,KAAK6zF,iBACE7zF,KAAKy0F,aAGd,QACE,MAAM,IAAIl8F,MAAM,GAAGu2F,yCAAsD9uF,KAAKgrF,+BAEpF,EC1NF,MAAMgnB,GAAgB,CACpBzmB,iBAAiB,EACjBoB,gBAAgB,EAChBI,UAAU,EACVC,eAAe,EACf/E,aAAa,EAEbJ,QAAQ,EACR+H,SAAS,EACTC,wBAAwB,EAExBE,KAAM,IAKRiiB,GAAcjiB,KAAK,IAAM,SA8BL,IAAIh9B,YAQJ,IAAIh6C,YApCjB,MC5OD,GAAc,IAAIg6C,YAexB,SAASk/C,GAAc1uG,EAAOrM,GAC5B,IAAIq6B,EAAI,EAER,IAAK,IAAInyB,EAAQ,GAAKA,GAAS,EAAG,CAEhC,GAAIA,GAAS,GACX,MAAM,IAAI7G,MAAM,6BAGlB,GAAIrB,GAAUqM,EAAMtM,OAClB,MAAM,IAAIsB,MAAM,oCAGlB,MAAM+jB,EAAI/Y,EAAMrM,KAEhB,GADAq6B,GAAKnyB,EAAQ,IAAU,IAAJkd,IAAald,GAAa,IAAJkd,GAAa,GAAKld,EACvDkd,EAAI,IACN,KAEJ,CACA,MAAO,CAACiV,EAAGr6B,EACb,CAOA,SAASg7G,GAAa3uG,EAAOrM,GAC3B,IAAIi7G,GACFA,EAASj7G,GAAU+6G,GAAa1uG,EAAOrM,GACzC,MAAMk7G,EAAal7G,EAASi7G,EAG5B,GAAIA,EAAU,GAAKC,EAAa,EAC9B,MAAM,IAAI75G,MAAM,4BAGlB,GAAI65G,EAAa7uG,EAAMtM,OACrB,MAAM,IAAIsB,MAAM,oCAGlB,MAAO,CAACgL,EAAMjM,SAASJ,EAAQk7G,GAAaA,EAC9C,CAOA,SAASC,GAAW9uG,EAAO8mB,GACzB,IAAIioF,EAGJ,OAFEA,EAAMjoF,GAAS4nF,GAAa1uG,EAAO8mB,GAE9B,CAAQ,EAAPioF,EAAYA,GAAQ,EAAGjoF,EACjC,CAMA,SAASkoF,GAAYhvG,GAEnB,MAAMqxD,EAAO,CAAC,EACRhjC,EAAIruB,EAAMtM,OAChB,IAAIozB,EAAQ,EAEZ,KAAOA,EAAQuH,GAAG,CAChB,IAAI9tB,EAAU0uG,EAGd,IAFE1uG,EAAU0uG,EAAUnoF,GAASgoF,GAAU9uG,EAAO8mB,GAE/B,IAAbmoF,EAAgB,CAClB,GAAI59C,EAAK3K,KACP,MAAM,IAAI1xD,MAAM,6CAElB,GAAiB,IAAbuL,EACF,MAAM,IAAIvL,MAAM,sCAAsCuL,eAExD,QAAkB4D,IAAdktD,EAAKkgB,KACP,MAAM,IAAIv8E,MAAM,4DAElB,QAAmBmP,IAAfktD,EAAKmgB,MACP,MAAM,IAAIx8E,MAAM,8DAGjBq8D,EAAK3K,KAAM5/B,GAAS6nF,GAAY3uG,EAAO8mB,EAC1C,MAAO,GAAiB,IAAbmoF,EAAgB,CACzB,QAAkB9qG,IAAdktD,EAAKkgB,KACP,MAAM,IAAIv8E,MAAM,6CAElB,GAAiB,IAAbuL,EACF,MAAM,IAAIvL,MAAM,sCAAsCuL,eAExD,QAAmB4D,IAAfktD,EAAKmgB,MACP,MAAM,IAAIx8E,MAAM,6DAGlB,IAAIo5D,GACFA,EAAMtnC,GAAS6nF,GAAY3uG,EAAO8mB,GACpCuqC,EAAKkgB,KAAO,GAAY1oE,OAAOulD,EACjC,KAAO,IAAiB,IAAb6gD,EAUT,MAAM,IAAIj6G,MAAM,mEAAmEi6G,KATnF,QAAmB9qG,IAAfktD,EAAKmgB,MACP,MAAM,IAAIx8E,MAAM,8CAElB,GAAiB,IAAbuL,EACF,MAAM,IAAIvL,MAAM,sCAAsCuL,iBAGvD8wD,EAAKmgB,MAAO1qD,GAAS4nF,GAAa1uG,EAAO8mB,EAG5C,CACF,CAGA,GAAIA,EAAQuH,EACV,MAAM,IAAIr5B,MAAM,6CAGlB,OAAOq8D,CACT,CCtIoB,IAAI77C,YCUJ,IAAIA,YC0CjB,SAAS,GAAQxV,GACtB,MAAMkvG,EHuFD,SAAqBlvG,GAC1B,MAAMquB,EAAIruB,EAAMtM,OAChB,IAEI49E,EAGAp4D,EALA4N,EAAQ,EAGRqoF,GAAkB,EAItB,KAAOroF,EAAQuH,GAAG,CAChB,IAAI9tB,EAAU0uG,EAGd,IAFE1uG,EAAU0uG,EAAUnoF,GAASgoF,GAAU9uG,EAAO8mB,GAE/B,IAAbvmB,EACF,MAAM,IAAIvL,MAAM,wDAAwDuL,KAG1E,GAAiB,IAAb0uG,EAAgB,CAClB,GAAI/1F,EACF,MAAM,IAAIlkB,MAAM,8CAGjBkkB,EAAM4N,GAAS6nF,GAAY3uG,EAAO8mB,GAC/BwqD,IACF69B,GAAkB,EAEtB,KAAO,IAAiB,IAAbF,EAUT,MAAM,IAAIj6G,MAAM,gEAAgEi6G,KAVvD,CACzB,GAAIE,EACF,MAAM,IAAIn6G,MAAM,8CAIlB,IAAIo5D,EAHQkjB,IACVA,EAAQ,KAGRljB,EAAMtnC,GAAS6nF,GAAY3uG,EAAO8mB,GACpCwqD,EAAMn9E,KAAK66G,GAAW5gD,GACxB,CAEA,CACF,CAGA,GAAItnC,EAAQuH,EACV,MAAM,IAAIr5B,MAAM,6CAIlB,MAAMkQ,EAAO,CAAC,EAKd,OAJIgU,IACFhU,EAAKgxD,KAAOh9C,GAEdhU,EAAKsrE,MAAQc,GAAS,GACfpsE,CACT,CG3IckqG,CAAWpvG,GAEjBkF,EAAO,CAAC,EAyBd,OAvBIgqG,EAAIh5C,OACNhxD,EAAKgxD,KAAOg5C,EAAIh5C,MAGdg5C,EAAI1+B,QACNtrE,EAAKsrE,MAAQ0+B,EAAI1+B,MAAMn5D,KAAKgX,IAC1B,MAAMgjC,EAAO,CAAC,EACd,IACEA,EAAK3K,KAAO,UAAWr4B,EAAEq4B,KAC3B,CAAE,MAAOxgD,GAAI,CACb,IAAKmrD,EAAK3K,KACR,MAAM,IAAI1xD,MAAM,kDAQlB,YANemP,IAAXkqB,EAAEkjD,OACJlgB,EAAKkgB,KAAOljD,EAAEkjD,WAEAptE,IAAZkqB,EAAEmjD,QACJngB,EAAKmgB,MAAQnjD,EAAEmjD,OAEVngB,MAIJnsD,CACT,CC1EA,MAAM,GAAc,IAAIsQ,YAClB,GAAc,IAAIg6C,YAEX,GAAO,OACP,GAAO,IAOP,GAAUtqD,GAAS,GAAYsG,OAAOmrB,KAAKuG,UAAUh4B,IAOrD,GAAUgU,GAASyd,KAAKlO,MAAM,GAAY5f,OAAOqQ,IChBjD,GAAO,MACP,GAAO,GAMP,GAAUhU,GAAS,GAAOA,GAM1B,GAAUgU,GAAS,GAAOA,GCR1Bm2F,GAAc,CACvBj8C,MHCgB,IGAhB14D,WAAYm1C,GACR,MAAM3qC,EAAO,GAAa2qC,SACnB3qC,EAAKsrE,MAAMn5D,KAAIgX,GAAKA,EAAEq4B,MACjC,GAKS4oD,GAAY,CACrBl8C,MAAO,GACP14D,aAEA,GASS60G,GAAgB,CACzBn8C,MAAO,QACP14D,WAAYm1C,GACR,MAAM+zC,EAAO,GACP4I,EAAO,GACbA,EAXQ,IAWSxsF,IACb,GAAiB,IAAbA,EAAM,GACN,MAAM,IAAIhL,MAAM,sDAEpB,MAAM08D,EAAM,UAAW1xD,EAAMjM,SAAS,IAEtC,OADA6vF,EAAKzvF,KAAKu9D,GACHA,CAAG,EAEd,GAAa7hB,EAAO,CAChB28C,eAEG5I,CACX,GAKJ,MAAM,WAAyB,GAC3B4rB,YACAjzG,YAAY2c,EAAMrO,GACduE,MAAM8J,EAAMrO,GACZpO,KAAK+yG,YAAc,EACvB,CACA16E,OACI,OAAmC,IAA5Br4B,KAAK+yG,YAAY97G,QAAgB0b,MAAM0lB,MAClD,CACA1mB,QACI,OAAI3R,KAAK+yG,YAAY97G,OAAS,EAEnB+I,KAAK+yG,YAAYhzE,MAErBptB,MAAMtH,MACjB,CAIAA,OACI,MAAMixB,EAAQt8B,KAAK2R,QACnB,GAAI2qB,EAAMptB,OAAS,OAAU,CACzB,MAAM8jG,EAAWhzG,KAAK2R,QACtB,GAAIqhG,EAAS9jG,OAAS,WAAkC,MAAnB8jG,EAASn0G,MAAe,CACzD,MAAMo0G,EAAajzG,KAAK2R,QACxB,GAAIshG,EAAW/jG,OAAS,UAAa,CAEjC,GADmBlP,KAAK2R,QACTzC,OAAS,SACpB,MAAM,IAAI3W,MAAM,4BAGpB,OADAyH,KAAK+yG,YAAYr7G,KAAKu7G,GACf,IAAI,GAAM,OAAU,GAAI,EACnC,CACA,GAAIA,EAAW/jG,OAAS,OAAU,CAC9B,MAAMgkG,EAAgBlzG,KAAK2R,QAC3B,GAAIuhG,EAAchkG,OAAS,WAAuC,UAAxBgkG,EAAcr0G,MAAmB,CACvE,MAAMs0G,EAAkBnzG,KAAK2R,QAC7B,GAAIwhG,EAAgBjkG,OAAS,UAAa,CACtC,IAAK,IAAI5T,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAExB,GADmB0E,KAAK2R,QACTzC,OAAS,SACpB,MAAM,IAAI3W,MAAM,6BAExB,CACA,MAAMgL,EAAQ,UAAc,IAAI4vG,EAAgBt0G,SAChD,OAAO,IAAI,GAAM,SAAY0E,EAAO4vG,EAAgBt0G,MAAM5H,OAC9D,CACA+I,KAAK+yG,YAAYr7G,KAAKy7G,EAC1B,CACAnzG,KAAK+yG,YAAYr7G,KAAKw7G,EAC1B,CACAlzG,KAAK+yG,YAAYr7G,KAAKu7G,EAC1B,CACAjzG,KAAK+yG,YAAYr7G,KAAKs7G,EAC1B,CACA,OAAO12E,CACX,EAOG,MAAM82E,GAAgB,CACzBz8C,MPkHgB,IOjHhB14D,WAAYm1C,GACR,MAAM+zC,EAAO,GACP4I,EAAO,GR8TrB,IAAiBtzE,EAAMrO,EQ7Tf2hF,EAhGQ,IAgGSrsF,IACb,MAAMuxD,EAAM,SAAUvxD,GAEtB,OADAyjF,EAAKzvF,KAAKu9D,GACHA,CAAG,ER0TLx4C,EQxTQ22B,ERwTFhlC,EQxTS,CACpB2hF,OACAE,UAAW,IAAI,GAAiB78C,EAAO,CACnC28C,OACAxE,iBAAiB,EACjBoB,gBAAgB,EAChBI,UAAU,EACVC,eAAe,EACf/E,aAAa,EACbJ,QAAQ,EACRgI,wBAAwB,KRgT/B,GAAQpzE,EADfrO,EAAU1P,OAAO6W,OAAO,CAAE06E,UAAW,IAAIuD,GAAU/2E,EAAMrO,IAAYA,UQ5SxD+4E,CACX,GCzIEksB,GAAsB,CACxBR,GACAD,GACAE,GACAM,GD2IsB,CACtBz8C,MAAO,GACP14D,aAAgB,IC1Idq1G,GAAuB,QACvBC,GAAyB,iBACzBC,GAAqBlhD,GAG3B,SAASmhD,GAAQx+C,GAIb,OAHoB,IAAhBA,EAAI/rC,UACJ+rC,EAAMA,EAAIO,QAEP,IAAI0hC,GAAI,GAAGoc,KAAuBr+C,EAAItwD,SAAS6uG,MAC1D,CACO,MAAME,GACT3sB,UACAzT,WACAqgC,WACA7zG,YAAYinF,EAAWzT,EAAYqgC,GAC/B3zG,KAAK+mF,UAAYA,EACjB/mF,KAAKszE,WAAaA,EAClBtzE,KAAK2zG,WAAa,CAAC,EACnB,IAAIN,MAAwBM,GAAYvzG,SAAQwzG,IAC5C5zG,KAAK2zG,WAAWC,EAAUj9C,OAASi9C,CAAS,GAEpD,CACA31G,UAAUg3D,EAAK7mD,EAAU,CAAC,GACtB,MAAMylG,EAASJ,GAAQx+C,GACvB,SAAUj1D,KAAK+mF,UAAU/rE,IAAI64F,GACzB,MAAM,IAAIt7G,MAAM,kBAEpB,MAAMkiF,EAAQxhF,KAAKsmC,MAAMnxB,EAAQqsE,OAASrpE,KAC1C,GAAIqpE,EAAQ,EACR,MAAM,IAAIliF,MAAM,4CAGpB,MAAM8xC,EAAQ,IAAI,GAAO,CACrByyC,YA9BuB,IAgCtBzyC,EAAMryB,KAAI/Z,gBACL+B,MAAK,EAASi1D,EAAK5qB,GAAQypE,IAEyC,MAAlEA,EAAYC,SAAS7zC,MAAKjhD,IAAK,QAAiBA,EAAGg2C,EAAI1xD,WAG3DuwG,EAAYE,WACZF,EAAYC,SAASr8G,KAAKu9D,EAAI1xD,OAAM,GACrC,IACI6K,EACHqsE,SACF,IAGN,MAAM3xB,GAAW,UACjBze,EAAMC,GAAG,SAAU1kC,IACfykC,EAAMh7B,QACNy5C,EAASp3C,OAAO9L,EAAI,UAGlB4L,QAAQo2D,KAAK,CACfv9B,EAAM0yC,SACNj0B,EAASv3C,UAEb,MAAM0iG,EAAM,CACRx5B,QACAhiC,SAAUrqC,EAAQqqC,UAAY,CAAC,GAGnC,aADMz4C,KAAK+mF,UAAU74E,IAAI2lG,EAAQ,GAAaI,GAAM7lG,GAC7C,CACH6mD,SACGg/C,EAEX,CAKAh2G,QAAeg3D,EAAK5qB,EAAO6pE,EAAiB9lG,GACxC,IAAuB,IAAnBA,EAAQqsE,MACR,OAEJ,MAAMm5B,EAAY5zG,KAAK2zG,WAAW1+C,EAAI5mD,MACtC,GAAiB,MAAbulG,EACA,MAAM,IAAIr7G,MAAM,qCAAqC08D,EAAI5mD,QAE7D,MAAM+kC,QAAcpzC,KAAKszE,WAAW3yE,IAAIs0D,EAAK7mD,SACvCpO,MAAK,EAAmBi1D,EAAKi/C,EAAiB9lG,GAEpD,UAAW,MAAM6mD,KAAO2+C,EAAUO,KAAK/gE,GAC9B/I,EAAMryB,KAAI/Z,gBACL+B,MAAK,EAASi1D,EAAK5qB,EAAO6pE,EAAiB,IAC1C9lG,EACHqsE,MAAOrsE,EAAQqsE,MAAQ,GACzB,GAGd,CAIAx8E,QAAyBg3D,EAAKi/C,EAAiB9lG,GAC3C,MAAMgmG,EAAW,IAAIld,GAAI,GAAGqc,KAAyBC,GAAmBzkG,OAAOkmD,EAAIV,UAAUhxD,UAC7F,IAAIuwG,EAAc,CACdE,SAAU,EACVD,SAAU,IAEd,IACID,EAAc,SAAmB9zG,KAAK+mF,UAAUpmF,IAAIyzG,EAAUhmG,GAClE,CACA,MAAOxI,GACH,GAAiB,kBAAbA,EAAIyI,KACJ,MAAMzI,CAEd,CACAsuG,EAAgBJ,GACa,IAAzBA,EAAYE,gBACFh0G,KAAK+mF,UAAU/rE,IAAIo5F,SACnBp0G,KAAK+mF,UAAU9uE,OAAOm8F,UAI9Bp0G,KAAK+mF,UAAU74E,IAAIkmG,EAAU,GAAaN,GAAc1lG,GAC9DA,EAAQwlE,aAAa,IAAI,KAAoB,gBAAiB,CAAEymB,OAAQplC,KAC5E,CACAh3D,SAASg3D,EAAK7mD,EAAU,CAAC,GACrB,MAAMylG,EAASJ,GAAQx+C,GAEjBg/C,EAAM,SADMj0G,KAAK+mF,UAAUpmF,IAAIkzG,EAAQzlG,UAEvCpO,KAAK+mF,UAAU9uE,OAAO47F,EAAQzlG,GAEpC,MAAMi8B,EAAQ,IAAI,GAAO,CACrByyC,YA5HuB,IAwI3B,OAVKzyC,EAAMryB,KAAI/Z,gBACL+B,MAAK,EAASi1D,EAAK5qB,GAAQypE,IAC7BA,EAAYE,WACZF,EAAYC,SAAWD,EAAYC,SAAS77F,QAAO+G,IAAK,QAAiBA,EAAGg2C,EAAI1xD,QAAO,GACxF,IACI6K,EACHqsE,MAAOw5B,EAAIx5B,OACb,UAEApwC,EAAM0yC,SACL,CACH9nB,SACGg/C,EAEX,CACAh2G,SAAUmQ,EAAU,CAAC,GACjB,UAAW,MAAM,IAAED,EAAG,MAAEtP,KAAWmB,KAAK+mF,UAAU/qC,MAAM,CACpDxiC,OAAQ85F,IAAuC,MAAfllG,EAAQ6mD,IAAc,GAAG7mD,EAAQ6mD,IAAItwD,SAAS2tD,MAAY,KAC3FlkD,GAAU,CACT,MAAM6mD,EAAM,SAAU9mD,EAAIxJ,WAAWlF,UAAU,GAAI6yD,IAC7C2hD,EAAM,GAAap1G,QACnB,CACFo2D,SACGg/C,EAEX,CACJ,CACAh2G,eAAeg3D,EAAK7mD,EAAU,CAAC,GAC3B,MAAMgmG,EAAW,IAAIld,GAAI,GAAGqc,KAAyBC,GAAmBzkG,OAAOkmD,EAAIV,UAAUhxD,UAC7F,OAAOvD,KAAK+mF,UAAU/rE,IAAIo5F,EAAUhmG,EACxC,kBC1KG,MAAMimG,GACTC,KACA5lE,MACA6lE,KAIAz0G,YAAYwzE,EAAYihC,EAAMnmG,EAAU,CAAC,GACrCpO,KAAK0uC,MAAQ4kC,EACbtzE,KAAKu0G,KAAOA,EACZv0G,KAAKs0G,MAAO,QAAc,CACtBE,cAAepmG,EAAQqmG,YAE/B,CACA9nE,SACI,OAAO3sC,KAAK0uC,KAChB,CAIAzwC,UAAUg3D,EAAK7hB,EAAOhlC,EAAU,CAAC,GAC7B,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,IACI,aAAa10G,KAAK0uC,MAAMxgC,IAAI+mD,EAAK7hB,EAAOhlC,EAC5C,CACA,QACIs5E,GACJ,CACJ,CAIAzpF,cAAeitD,EAAQ98C,EAAU,CAAC,GAC9B,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,UACW10G,KAAK0uC,MAAMw3C,QAAQh7B,EAAQ98C,EACtC,CACA,QACIs5E,GACJ,CACJ,CAIAzpF,UAAUg3D,EAAK7mD,EAAU,CAAC,GACtB,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,IACI,aAAa10G,KAAK0uC,MAAM/tC,IAAIs0D,EAAK7mD,EACrC,CACA,QACIs5E,GACJ,CACJ,CAIAzpF,cAAekpF,EAAM/4E,EAAU,CAAC,GAC5B,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,UACW10G,KAAK0uC,MAAM75B,QAAQsyE,EAAM/4E,EACpC,CACA,QACIs5E,GACJ,CACJ,CAIAzpF,aAAag3D,EAAK7mD,EAAU,CAAC,GACzB,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKK,YACpC,IACI,SAAU30G,KAAKu0G,KAAKK,SAAS3/C,GACzB,MAAM,IAAI18D,MAAM,wBAEdyH,KAAK0uC,MAAMz2B,OAAOg9C,EAAK7mD,EACjC,CACA,QACIs5E,GACJ,CACJ,CAIAzpF,iBAAkBkpF,EAAM/4E,EAAU,CAAC,GAC/B,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKK,YACpC,IACI,MAAMxzE,EAAUnhC,WACTA,KAAK0uC,MAAMy3C,WAAYloF,kBAC1B,UAAW,MAAMg3D,KAAOkyB,EAAM,CAC1B,SAAUhmD,EAAQozE,KAAKK,SAAS3/C,GAC5B,MAAM,IAAI18D,MAAM,wBAEd08D,CACV,CACJ,CAP6B,GAOvB7mD,EACV,CACA,QACIs5E,GACJ,CACJ,CACAzpF,UAAUg3D,EAAK7mD,EAAU,CAAC,GACtB,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,IACI,aAAa10G,KAAK0uC,MAAM1zB,IAAIi6C,EAAK7mD,EACrC,CACA,QACIs5E,GACJ,CACJ,CACAzpF,aAAcmQ,EAAU,CAAC,GACrB,MAAMs5E,QAAoB1nF,KAAKs0G,KAAKI,WACpC,UACW10G,KAAK0uC,MAAMnjB,OAAOnd,EAC7B,CACA,QACIs5E,GACJ,CACJ,ECxHJ,MAAMmtB,GAAiB,IAAI3d,GAAI,4BC2C/B,OA1CA,SAAgB/4F,EAAQ6F,GACpB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMM,KAAS3U,QACZ6F,EAAG8O,WACHA,EAGjB,CANM,GASX,MAAM44D,GAAW,QAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GAEf,GAAwB,mBAAbugB,EAAIoO,KACX,OAAO,wBACOpO,UACAvgB,GAEV,UAAW,MAAMiU,KAAS44D,QACZ1nE,EAAG8O,WACHA,EAGjB,CATM,GAWX,MAAM4/B,EAAO1uC,EACb,OAAO,aACS,IAARob,UACMvgB,GAEV,IAAK,MAAMiU,KAAS44D,EACZh5B,EAAK5/B,WACCA,EAGjB,CATM,EAUX,ECPA,OAlCA,SAAiB3U,EAAQ6F,GACrB,GAHsC,MAGlB7F,EAHP3H,OAAOgc,eAIhB,OAAO,kBACH,UAAW,MAAMi5D,KAASttE,QAChB6F,EAAGynE,SACHA,CAEb,CALM,GAQX,MAAMC,GAAW,QAAKvtE,IAChB,MAAEU,EAAK,KAAEw5B,GAASqzC,EAASrgE,OACjC,IAAa,IAATgtB,EACA,OAAQ,YAAe,CAAhB,GAEX,MAAMjZ,EAAMpb,EAAGnF,GACf,GAAyB,mBAAdugB,GAAKoO,KACZ,OAAO,wBACG3uB,EACN,UAAW,MAAMuM,KAAOsgE,QACd1nE,EAAGoH,SACHA,CAEb,CANM,GAQX,MAAMsnC,EAAO1uC,EACb,OAAO,kBACGnF,EACN,IAAK,MAAMuM,KAAOsgE,EACdh5B,EAAKtnC,SACCA,CAEb,CANM,EAOX,EC9BO,MAAM0pG,GACTpmE,MACAqmE,QAIAj1G,YAAYwzE,EAAYllE,EAAU,CAAC,GAC/BpO,KAAK0uC,MAAQ4kC,EACbtzE,KAAK+0G,QAAU3mG,EAAQ2mG,OAC3B,CACApoE,SACI,OAAO3sC,KAAK0uC,KAChB,CAIAzwC,UAAUg3D,EAAK7hB,EAAOhlC,EAAU,CAAC,GAC7B,aAAUpO,KAAK0uC,MAAM1zB,IAAIi6C,IACrB7mD,EAAQwlE,aAAa,IAAI,KAAoB,uBAAwB3e,IAC9DA,KAEuB,IAA9Bj1D,KAAK+0G,SAASC,cACd5mG,EAAQwlE,aAAa,IAAI,KAAoB,4BAA6B3e,IAC1Ej1D,KAAK+0G,QAAQE,OAAOhgD,EAAK7hB,EAAOhlC,IAEpCA,EAAQwlE,aAAa,IAAI,KAAoB,4BAA6B3e,IACnEj1D,KAAK0uC,MAAMxgC,IAAI+mD,EAAK7hB,EAAOhlC,GACtC,CAIAnQ,cAAeitD,EAAQ98C,EAAU,CAAC,GAC9B,MAAM8mG,EAAgB,GAAOhqD,GAAQjtD,OAASg3D,UAC1C,MAAMj6C,QAAYhb,KAAK0uC,MAAM1zB,IAAIi6C,GAIjC,OAHIj6C,GACA5M,EAAQwlE,aAAa,IAAI,KAAoB,4BAA6B3e,KAEtEj6C,CAAG,IAETm6F,EAAa,GAAQD,GAAe,EAAGjgD,MAAK7hB,YAC9ChlC,EAAQwlE,aAAa,IAAI,KAAoB,iCAAkC3e,IAC/Ej1D,KAAK+0G,SAASE,OAAOhgD,EAAK7hB,EAAOhlC,EAAQ,IAE7CA,EAAQwlE,aAAa,IAAI,KAAoB,8CACtC5zE,KAAK0uC,MAAMw3C,QAAQivB,EAAY/mG,EAC1C,CAIAnQ,UAAUg3D,EAAK7mD,EAAU,CAAC,GACtB,IAAwB,IAApBA,EAAQgnG,SAAiD,MAA7Bp1G,KAAK+0G,SAASC,oBAA+Bh1G,KAAK0uC,MAAM1zB,IAAIi6C,GAAO,CAC/F7mD,EAAQwlE,aAAa,IAAI,KAAoB,yBAA0B3e,IACvE,MAAM7hB,QAAcpzC,KAAK+0G,QAAQM,KAAKpgD,EAAK7mD,GAG3C,OAFAA,EAAQwlE,aAAa,IAAI,KAAoB,4BAA6B3e,UACpEj1D,KAAK0uC,MAAMxgC,IAAI+mD,EAAK7hB,EAAOhlC,GAC1BglC,CACX,CAEA,OADAhlC,EAAQwlE,aAAa,IAAI,KAAoB,4BAA6B3e,IACnEj1D,KAAK0uC,MAAM/tC,IAAIs0D,EAAK7mD,EAC/B,CAIAnQ,cAAekpF,EAAM/4E,EAAU,CAAC,GAC5BA,EAAQwlE,aAAa,IAAI,KAAoB,8CACtC5zE,KAAK0uC,MAAM75B,QAAQ,GAAQsyE,GAAMlpF,MAAOg3D,IAC3C,IAAwB,IAApB7mD,EAAQgnG,UAAkD,IAA9Bp1G,KAAK+0G,SAASC,oBAAgCh1G,KAAK0uC,MAAM1zB,IAAIi6C,GAAO,CAChG7mD,EAAQwlE,aAAa,IAAI,KAAoB,8BAA+B3e,IAC5E,MAAM7hB,QAAcpzC,KAAK+0G,QAAQM,KAAKpgD,EAAK7mD,GAC3CA,EAAQwlE,aAAa,IAAI,KAAoB,iCAAkC3e,UACzEj1D,KAAK0uC,MAAMxgC,IAAI+mD,EAAK7hB,EAAOhlC,EACrC,KAER,CAIAnQ,aAAag3D,EAAK7mD,EAAU,CAAC,GACzBA,EAAQwlE,aAAa,IAAI,KAAoB,kCAAmC3e,UAC1Ej1D,KAAK0uC,MAAMz2B,OAAOg9C,EAAK7mD,EACjC,CAIAnQ,iBAAkBkpF,EAAM/4E,EAAU,CAAC,GAC/BA,EAAQwlE,aAAa,IAAI,KAAoB,oDACtC5zE,KAAK0uC,MAAMy3C,WAAYloF,kBAC1B,UAAW,MAAMg3D,KAAOkyB,QACdlyB,CAEd,CAJ6B,GAIvB7mD,EACV,CACAnQ,UAAUg3D,EAAK7mD,EAAU,CAAC,GACtB,OAAOpO,KAAK0uC,MAAM1zB,IAAIi6C,EAAK7mD,EAC/B,CACAnQ,aAAcmQ,EAAU,CAAC,GACrBA,EAAQwlE,aAAa,IAAI,KAAoB,6CACtC5zE,KAAK0uC,MAAMnjB,OAAOnd,EAC7B,EC/FJ,MAAMzV,GAAMqnE,GAAO,SACZ,MAAMs1C,GACTC,OACAjiC,WACAyT,UACAwtB,KACA,GACAz0G,YAAYs7B,GACR,MAAMo6E,EAAU,CACZ,GACA7gD,GACA,MACIv5B,EAAKo6E,SAAW,IAExBx1G,MAAK,GAAW,QAAco7B,EAAKm6E,OAAQn6E,EAAKk4C,WAAY,CACxDmiC,WAAY,CACRC,UAAWz3G,MAAO03G,IACd,MAAMC,EAASJ,EAAQt1C,MAAK01C,GACjBA,EAAOvnG,OAASsnG,GAAeC,EAAOv2G,OAASs2G,IAE1D,GAAc,MAAVC,EACA,OAAOA,EAEX,MAAM,IAAIr9G,MAAM,wCAAwCo9G,KAAe,KAInF,MAAME,EAAmB,IAAIf,GAAiB15E,EAAKk4C,WAAY,CAC3DyhC,QAAS/0G,MAAK,IAElBA,KAAKu0G,KAAO,IAAIb,GAASt4E,EAAK2rD,UAAW8uB,EAAkBz6E,EAAKu4E,YAAc,IAC9E3zG,KAAKu1G,OAASn6E,EAAKm6E,OACnBv1G,KAAKszE,WAAa,IAAI+gC,GAAawB,EAAkB71G,KAAKu0G,KAAM,CAC5DE,WAAYr5E,EAAKq5E,aAErBz0G,KAAK+mF,UAAY3rD,EAAK2rD,SAC1B,CACA9oF,oBJ1CGA,eAA+C8oF,GAClD,UAAYA,EAAU/rE,IAAI65F,IAEtB,kBADM9tB,EAAU74E,IAAI2mG,IAAgB,QAAqB,MAG7D,MAAM95G,QAAYgsF,EAAUpmF,IAAIk0G,IAC1Bx5G,GAAM,QAAmBN,GAE/B,GAToB,IAQJ2L,SAASrL,EAAK,IAG1B,MAAM,IAAI9C,MAAM,mEAExB,CI+Bcu9G,CAAgC91G,KAAK+mF,iBACrC/mF,MAAK,GAAUwD,eACfxD,KAAKu1G,OAAO/xG,OACtB,CACAvF,mBACU+B,KAAKu1G,OAAO1rE,aACZ7pC,MAAK,GAAU6pC,OACzB,CACA5rC,SAASmQ,EAAU,CAAC,GAChB,MAAMs5E,QAAoB1nF,KAAKszE,WAAWghC,KAAKK,YAC/C,IACI,MAAM9vB,EAAQ7kF,KACRszE,EAAatzE,KAAKszE,WAAW3mC,SACnCh0C,GAAI,kBACE,GAAM26E,EAAW6S,WAAYloF,kBAC/B,UAAW,MAAM,IAAEg3D,KAASqe,EAAW/nD,SACnC,IACI,SAAUs5D,EAAM0vB,KAAKK,SAAS3/C,EAAK7mD,GAC/B,eAEE6mD,EACN7mD,EAAQwlE,aAAa,IAAI,KAAoB,mBAAoB3e,GACrE,CACA,MAAOrvD,GACHjN,GAAIynB,MAAM,kBAAmBxa,GAC7BwI,EAAQwlE,aAAa,IAAI,KAAoB,iBAAkBhuE,GACnE,CAER,CAdkC,IAetC,CACA,QACI8hF,GACJ,CACA/uF,GAAI,cACR,qDCwCJ,IAAI,GArHJ,SAAei2D,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,EAKA,GAFsC,GC5HxB,IAAI7E,WAAW,GAA7B,MAsCM,GAASuD,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAM,GAMJuH,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM,GAMJuH,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,EAaF,MAAM,GAIJzwD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAM,GAAK,CAACC,EAAMC,IAAU,IAAI,GAA4C,IAC7ED,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAM,GAOX7wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAI,GAAQxxD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAI,GAAQlxD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAM,GAAO,EAAGsD,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAI,GAAM/M,EAAMma,EAAQzK,EAAQ3C,GAWrB,GAAQ,EAAGoN,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,GAAMob,EAAUnoB,GAC3C,OAAO,GAAK,CACVma,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,GAAO1tB,EAAO0tB,KAC/B,EA4GU,GAAU,EAAGz6B,OAAMma,SAAQw3C,cAAaxpC,cAC5C,GAAK,CACVhO,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI,CAAOF,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DI,CAAOF,EAAOyrB,EAAUwpC,EAAa3xD,KCrVrC,GAAY,GAAM,CAC7BA,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGC,GAAe,GAAM,CAChCnoB,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCTC4pC,GAAS,GAAM,CAC1B53C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,eCDC6pC,GAAS,GAAQ,CAC5B73C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mBACVwpC,YAAa,IAGFM,GAAc,GAAQ,CACjC93C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mBACVwpC,YAAa,ICXFO,GAAQ,GAAQ,CAC3B/3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,KACVwpC,YAAa,ICNTxpC,GAAW5uB,MAAM4N,KAAK,0eACtBgrD,GAAgDhqC,GAAS4H,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAED,GAAK2jB,EAAU1jB,IAA4B,IAC5Hk2D,GAAgDjqC,GAAS4H,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAyB0jB,EAAEmxC,YAAY,IAAO90D,EAAUC,IAA4B,IA6BlK,MAAMm2D,GAAe,GAAK,CAC/Bl4C,OAAQ,KACRna,KAAM,eACN0P,OA1BF,SAAiB0N,GACf,OAAOA,EAAK2S,QAAO,CAAC7zB,EAAG0jB,IACrB1jB,GAAKi2D,GAAqBvyC,IAEzB,GACL,EAsBE7S,OAhBF,SAAiB/Q,GACf,MAAMs2D,EAAO,GACb,IAAK,MAAMn3C,KAAQnf,EAAK,CACtB,MAAMu2D,EAAMH,GAA4Cj3C,EAAK41C,YAAY,IACzE,QAAY1oD,IAARkqD,EACF,MAAM,IAAIr5D,MAAM,+BAA+BiiB,KAEjDm3C,EAAKj6D,KAAKk6D,EACZ,CACA,OAAO,IAAIp3D,WAAWm3D,EACxB,IC7Ba,GAAS,GAAQ,CAC5Bn4C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAc,GAAQ,CACjCx3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAiB,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAiB,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAe,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAoB,GAAQ,CACvCx3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAU,GAAQ,CAC7Bx3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DF,GAAS,GAAM,CAC1Bx3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,yCAGC,GAAc,GAAM,CAC/BhO,OAAQ,IACRna,KAAM,cACNmoB,SAAU,yCCPC,GAAS,GAAQ,CAC5BhO,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGF,GAAe,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,ICzBF6B,GAAQ,GAAQ,CAC3Br5C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,WACVwpC,YAAa,ICHF,GAAW,GAAK,CAC3Bx3C,OAAQ,KACRna,KAAM,WACN0P,OAAShU,IAAQ,OXwDFuhB,EWxDWvhB,GXwDN,IAAKg4D,aAAe3mD,OAAOkQ,GAAhCA,KWxDe,EAC9BlQ,OAAS/Q,GXiDQA,KAAO,IAAK0d,aAAehK,OAAO1T,GWjDlC,CAAWA,KCFxB,GAAc,IAAI0d,YAClB,GAAc,IAAIg6C,YAEX,GAAO,OACP,GAAO,IAOP,GAAUtqD,GAAS,GAAYsG,OAAOmrB,KAAKuG,UAAUh4B,IAOrD,GAAUgU,GAASyd,KAAKlO,MAAM,GAAY5f,OAAOqQ,IChBjD,GAAO,MACP,GAAO,GAMP,GAAUhU,GAAS,GAAOA,GAM1B,GAAUgU,GAAS,GAAOA,GCtBvC,IAAI,GAOJ,SAAS,EAAOkqB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAO,IACX1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,GAAO,IAET,KAAMA,EAAM,IACV1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBI,GAAM,IAEN,IAAS,IACT,GAAMhD,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAAS,EAAK/oB,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADA,EAAKruB,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAI,KAAWld,GACfkd,EAAI,IAAUrjB,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAK,IAId,OAFA,EAAK/Y,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BI,GAAQ,IACR,GAAS,IA2Bb,IAAI,GAAKnmB,KAAK6qB,IAAI,EAAI,GAClB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQ,GACR3C,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACA,EAEjB,GCzEO,MAAM,GAAS,CAAC4d,EAAMvlB,EAAS,IAE7B,CADM,UAAculB,EAAMvlB,GACnB,iBAQH,GAAW,CAACi9D,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI,GAAkB8hD,GACtB,kBAAsBA,GCjBlB,GAAS,CAAC9lD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAShC,GAAUgxD,IACrB,MAAMhxD,EAAQ,GAAOgxD,IACdlmD,EAAM+lD,GAAc,GAAc7wD,IAClC9L,EAAM48D,GAAgB,GAAc9wD,EAAMjM,SAAS88D,IACpD/J,EAAS9mD,EAAMjM,SAAS88D,EAAaC,GAE3C,GAAIhK,EAAOx9C,aAAepV,EACxB,MAAM,IAAIc,MAAM,oBAGlB,OAAO,IAAI,GAAO8V,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAoCtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,ECtFF,MAIM,GAAS,GAQF,GAAW,CAAE8K,KAZb,EAYiB,KAXjB,WAWuB,OAAQ,UAF5BtS,GAAU,GAVb,EAUiC,GAAOA,KCHxC,GAAO,EAAGsD,OAAMgP,OAAMU,YAAa,IAAI,GAAO1P,EAAMgP,EAAMU,GAWhE,MAAM,GAOXjP,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,EC1CF,MAAM,GAAM8G,GAIVpB,SAAc,IAAIzD,iBAAiBo6C,OAAO8f,OAAOrK,OAAOhrD,EAAMod,IAEnD,GAAS,GAAK,CACzBpd,KAAM,WACNgP,KAAM,GACNU,OAAQ,GAAI,aAGD,GAAS,GAAK,CACzB1P,KAAM,WACNgP,KAAM,GACNU,OAAQ,GAAI,aCHD,GAAS,CAAC6lD,EAAMC,KAC3B,MAAM,MAAEtxD,EAAK,QAAE2lB,GAAY0rC,EAC3B,OACO,IADC1rC,EAEG,GACL3lB,EACA,GAAUqxD,GAC+B,GAAU,YAG9C,GACLrxD,EACA,GAAUqxD,GACmCC,GAAQ,WAE3D,EAoBI,GAAQ,IAAIvkC,QAMZ,GAAY2kC,IAChB,MAAMF,EAAY,GAAMp0D,IAAIs0D,GAC5B,GAAiB,MAAbF,EAAmB,CACrB,MAAMA,EAAY,IAAIz6C,IAEtB,OADA,GAAMze,IAAIo5D,EAAKF,GACRA,CACT,CACA,OAAOA,GAWF,MAAM,GAOXj1D,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAAS,GACX,MAAM,IAAI9V,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAAS,GACrB,MAAM,IAAI9V,MAAM,sDAGlB,OACE,GAAIg9D,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAY,GAAclmD,EAAMg8C,GACtC,OACE,GAAIoL,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAO,GAAI10C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SJ5JT,EAACzI,EAAGnE,KACxB,GAAImE,IAAMnE,EACR,OAAO,EACF,CACL,MAAMG,EAAoE,EAE1E,OACEgE,EAAEpS,OAASoO,EAAKpO,MAChBoS,EAAEhpB,OAASglB,EAAKhlB,MAChBglB,EAAKlZ,iBAAiB/I,YhBrCb,EAACo7D,EAAIC,KAClB,GAAID,IAAOC,EAAI,OAAO,EACtB,GAAID,EAAG/oD,aAAegpD,EAAGhpD,WACvB,OAAO,EAGT,IAAK,IAAI67B,EAAK,EAAGA,EAAKktB,EAAG/oD,WAAY67B,IACnC,GAAIktB,EAAGltB,KAAQmtB,EAAGntB,GAChB,OAAO,EAIX,OAAO,GgB0BH,CAAWjoB,EAAEld,MAAOkZ,EAAKlZ,MAE7B,GIiJI,CAAckC,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAO,GAAO70D,KAAM60D,EACtB,CAKArzC,SACE,MAAO,CAAE,IAAK,GAAOxhB,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiB,GAEnB,OAAOA,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAI,GACTqqB,EACA7a,EACwC,EACxC9K,GAAS,GAAU2lB,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAM,IAAqB,CAIpC,MAAM,QAAEqqB,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEH,GAAckK,GACjB,OAAO,GAAI51D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAAS,GACX,MAAM,IAAI9V,MACR,wCAAwC,sBAG1C,OAAO,IAAI,GAAI2wB,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQ,GAAU2lB,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI,GAAI2lB,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO,GAAI1rD,OAAO,EAAG,GAAa0rD,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO,GAAI1rD,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAa,GAAIC,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQ,GAAIC,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiB,GACrBhzD,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAI,GACjB8L,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACF,GAAIqsC,SAAyD,GAC7D,GAAIE,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAU,GAAc2/D,EAAat/D,SAASJ,IAExD,OADAA,GAAUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,GAS7B,GARuC,KAAd,GAEvBztC,EAA2B,EAC3BhyB,EAAS,GAETy/D,EAA0BtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAAS,GAAgBpF,EAAQ02D,GAE1CI,EAAM,GAAI7oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFA,GAAU08D,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAaF,MAAM,GAAkB,CAAC92D,EAAQ02D,KAC/B,OAAQ12D,EAAO,IAEb,IAAK,IAAK,CACR,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CACkB,GAAgB,OACvCtE,EAAQnkD,OAAO,GAAG,YAAmBjO,KAEzC,CACA,KAAK,UAAkB,CACrB,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CAAuB,GAAgB,OAAGtE,EAAQnkD,OAAOjO,GAClE,CACA,KAAK,UAAe,CAClB,MAAMoyD,EAAUsE,GAAQ,GACxB,MAAO,CAAuB,GAAa,OAAGtE,EAAQnkD,OAAOjO,GAC/D,CACA,QACE,GAAY,MAAR02D,EACF,MAAMt8D,MACJ,mFAGJ,MAAO,CAAuB4F,EAAO,GAAK02D,EAAKzoD,OAAOjO,IAE1D,EASI,GAAa,CAACoF,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACnB,GAAIr7C,IAAW,UACb,MAAMjhB,MAAM,8BAA8Bs8D,EAAKx1D,iBAGjD,MAAM41D,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAAOzK,MAAM,GAErC,OADAuhB,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EASI,GAAa,CAAC1xD,EAAO8W,EAAOw6C,KAChC,MAAM,OAAEr7C,GAAWq7C,EACbI,EAAM56C,EAAM1Z,IAAI6Y,GACtB,GAAW,MAAPy7C,EAAa,CACf,MAAMA,EAAMJ,EAAK9lD,OAAOxL,GAExB,OADA8W,EAAMxe,IAAI2d,EAAQy7C,GACXA,CACT,CACE,OAAOA,CACT,EAGI,GAAc,IACd,GAAe,GAQf,GAAY,CAAC/rC,EAAS7a,EAAMkmD,KAChC,MAAMuC,EAAa,GAAsB5tC,GACnC6tC,EAAaD,EAAa,GAAsBzoD,GAChD9K,EAAQ,IAAI/I,WAAWu8D,EAAaxC,EAAU1nD,YAIpD,OAHA,GAAgBqc,EAAS3lB,EAAO,GAChC,GAAgB8K,EAAM9K,EAAOuzD,GAC7BvzD,EAAM1H,IAAI04D,EAAWwC,GACdxzD,GAGH,GAAY/M,OAAOkqD,IAAI,oBCnkBvB,GAAQ,IAAK,KAAiB,KAAU,KAAU,KAAW,KAAW,KAAW,KAAW,KAAW,KAAW,GCfnH,SAAS,GAAOjgC,EAAGnE,GACtB,GAAImE,IAAMnE,EACN,OAAO,EAEX,GAAImE,EAAE5T,aAAeyP,EAAEzP,WACnB,OAAO,EAEX,IAAK,IAAIvR,EAAI,EAAGA,EAAImlB,EAAE5T,WAAYvR,IAC9B,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GACX,OAAO,EAGf,OAAO,CACX,CCPA,MAAM2lB,GAAUzqB,OAAOkqD,IAAI,8BACrB+c,GAAc/+D,OACf/C,OAAO,IACPif,KAAI+7C,GAASA,EAAMpG,UAEnBnhC,QAAO,CAACtd,EAAK5S,IAAS4S,EAAIw+C,GAAGpxD,IAAO,qBAEnCw+D,GAAkB,IAClBC,GAAwC,GACxCC,GAAyC,GAC/C,MAAMC,GACF3uD,KACAqlD,UACA5G,WACAv4B,UACA1xB,OACA5D,YAAYs7B,GACRp7B,KAAKkP,KAAOksB,EAAKlsB,KACjBlP,KAAKu0D,UAAYn5B,EAAKm5B,UACtBv0D,KAAK2tD,WAAavyB,EAAKuyB,WAEvBjvD,OAAO2B,eAAeL,KAAM,SAAU,CAClCY,YAAY,EACZV,UAAU,GAElB,CACY41D,IAAPt/D,OAAOs/D,eACR,MAAO,UAAU91D,KAAK2E,aAC1B,CACA,CAAC,OAAU,EACXA,WAII,OAHmB,MAAf3E,KAAK0D,SACL1D,KAAK0D,OAAS,UAAiB1D,KAAKu0D,UAAUhxD,OAAOzK,MAAM,IAExDkH,KAAK0D,MAChB,CAGAo6D,QACI,OAAO,YAAaJ,GAAiB19D,KAAKu0D,UAC9C,CACAvK,UACI,OAAOhqD,KAAKu0D,UAAUhxD,KAC1B,CAIAie,SACI,OAAOxhB,KAAK2E,UAChB,CAIAqc,OAAOpnB,GACH,GAAIA,aAAcY,WACd,OAAO,GAAiBwF,KAAKu0D,UAAUhxD,MAAO3J,GAE7C,GAAkB,iBAAPA,EACZ,OAAOykE,GAAiBzkE,GAAIonB,OAAOhhB,MAElC,GAA4B,MAAxBpG,GAAI26D,WAAWhxD,MACpB,OAAO,GAAiBvD,KAAKu0D,UAAUhxD,MAAO3J,EAAG26D,UAAUhxD,OAG3D,MAAM,IAAIhL,MAAM,eAExB,CAaA,CAAC0oB,MACG,MAAO,UAAUjhB,KAAK2E,aAC1B,EAEJ,MAAMu5D,WAAsBL,GACxB3uD,KAAO,MACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,QACvBlP,KAAKo1B,UAAYgG,EAAKhG,SAC1B,EAEJ,MAAM4oC,WAA0BH,GAC5B3uD,KAAO,UACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,YACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EAEJ,MAAM4T,WAA4BJ,GAC9B3uD,KAAO,YACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,cACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EA0BG,SAASgU,GAAiBhjE,EAAKk1D,GAElC,GADAA,EAAUA,GAAWkN,GACC,MAAlBpiE,EAAIiP,OAAO,IAAgC,MAAlBjP,EAAIiP,OAAO,GAAY,CAGhD,MAAMiqD,EAAY,GAAc,UAAiB,IAAIl5D,MACrD,OAAIA,EAAI0iE,WAAW,OACR,IAAIC,GAAkB,CAAEzJ,cAE1Bl5D,EAAI0iE,WAAW,OACb,IAAIE,GAAoB,CAAE1J,cAG1B,IAAI2J,GAAc,CAAE3J,aAEnC,CACA,OAAO,GAAgBkJ,GAAYrxD,OAAO/Q,GAC9C,CACO,SAAS,GAAgBN,GAC5B,IACI,MAAMw5D,EAAY,GAAcx5D,GAChC,GAAIw5D,EAAUlmD,OAAS,QAAe,CAClC,GAAIkmD,EAAUlK,OAAOpzD,SAAW0mE,GAC5B,OAAO,IAAIK,GAAkB,CAAEzJ,cAE9B,GAAIA,EAAUlK,OAAOpzD,SAAW2mE,GACjC,OAAO,IAAIK,GAAoB,CAAE1J,aAEzC,CACA,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI6vD,GAAc,CAAE3J,aAEnC,CACA,MACI,OAID,SAAuBU,GAC1B,GAAW,MAAPA,GAAgC,MAAjBA,EAAIV,WAAoC,MAAfU,EAAI/rC,SAAoC,IAAhB+rC,EAAI/rC,SAAiB+rC,EAAI5mD,OAASqvD,GAClG,MAAM,IAAInlE,MAAM,kCAEpB,MAAMg8D,EAAYU,EAAIV,UACtB,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI6vD,GAAc,CAAE3J,UAAWU,EAAIV,YAEzC,GAAIA,EAAUlmD,OAAS,QAAe,CACvC,GAAIkmD,EAAUlK,OAAOpzD,SAAW0mE,GAC5B,OAAO,IAAIK,GAAkB,CAAEzJ,UAAWU,EAAIV,YAE7C,GAAIA,EAAUlK,OAAOpzD,SAAW2mE,GACjC,OAAO,IAAIK,GAAoB,CAAE1J,UAAWU,EAAIV,WAExD,CACA,MAAM,IAAIh8D,MAAM,iCACpB,CArBe4lE,CAAc,UAAWpjE,GACpC,CACA,MAAM,IAAIxC,MAAM,iCACpB,CCtIO,SAAS,GAAO8G,GAEnB,IAAI7G,EAbR,SAA8BooC,GAC1B,MAAMo/B,EAAS,OAQf,OAPAA,EAAOl9B,SAAU,EACjBk9B,EAAOj/B,MAAQ,GACfi/B,EAAOl/B,KAAO,EACdk/B,EAAOrnE,IAAM,OACbqnE,EAAOp/B,UAAYA,EACnBo/B,EAAOv1C,QAAU,KAAM,EACvBu1C,EAAO58B,OAAS,IAAM48B,EACfA,CACX,CAGgB,CAAqB,GAAG3gE,WAKpC,OAHI,UAAc,GAAGA,YAAuF,MAAtE,aAAgB0xB,GAAKA,EAAEpsB,aAAYu7D,MAAKznE,GAAKA,EAAE8oB,SAAS,cAC1F/oB,EAAQ,EAAM,GAAG6G,YAEdX,OAAO6W,OAAO,EAAMlW,GAAO,CAC9B+gB,MAAO,EAAM,GAAG/gB,WAChB7G,SAER,CAjDA,eAAsB+4B,GACN,MAALA,EAAY,YAAc,cAAqBA,GAG1D,eAAsBA,GACN,MAALA,EAAY,YAAc,cAAkBA,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAc,cAAkBA,GAGvD,eAAsBA,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,WAGvC,eAAsB4sB,GACN,MAALA,EAAY,YAAcA,EAAE5sB,2BC9BhC,MAAMoxG,GACTC,OACAC,KAAO,IAAI37F,IACX47F,aACAC,QAAU,GAEVC,kBAAoB,EAIpBt2G,YAMAk2G,EAAQK,EAAiBH,GACrBl2G,KAAKg2G,OAASA,EACdh2G,KAAKk2G,aAAeA,EACpB,IAAK,IAAI56G,EAAI,EAAGA,EAAI+6G,EAAiB/6G,IACjC0E,KAAKm2G,QAAQ76G,GAAK,EAE1B,CACI7D,WACA,OAAOuI,KAAKi2G,KAAKx+G,IACrB,CAKAyW,IAAIooG,EAAWrvF,EAAKsvF,GAAY,GAC5B,MAAM,SAAEC,GAAaF,EAErB,OAAIt2G,KAAKi2G,KAAKj7F,IAAIw7F,KAGlBx2G,KAAKi2G,KAAKp6G,IAAI26G,EAAU,CACpB3uG,QAASof,EACTsvF,YACAE,iBAAkB,IAAI/hG,IACtBgiG,YAAa,IAAIp8F,MAErBta,KAAKm2G,QAAQ,GAAGz+G,KAAK,IAAK4+G,EAAW9/D,MAAOvvB,EAAIuvB,QAC3C+/D,GACDv2G,KAAKo2G,qBAEF,EACX,CACAO,iBAAiBC,EAAOC,GACpB,MAAM/jG,EAAQ9S,KAAKi2G,KAAKt1G,IAAIi2G,GACxB9jG,IAGCA,EAAMyjG,WACPzjG,EAAM2jG,iBAAiBz+F,IAAI6+F,EAEnC,CAIAl2G,IAAIi2G,GACA,OAAO52G,KAAKi2G,KAAKt1G,IAAIX,KAAKk2G,aAAaU,KAAS/uG,OACpD,CAKAivG,kBAAkBN,EAAUj7G,GACxB,MAAM0rB,EAAMjnB,KAAKi2G,KAAKt1G,IAAI61G,GAC1B,IAAKvvF,EACD,OAAO,KAEX,MAAM3V,GAAS2V,EAAIyvF,YAAY/1G,IAAIpF,IAAM,GAAK,EAE9C,OADA0rB,EAAIyvF,YAAY76G,IAAIN,EAAG+V,GAChB,CAAE2V,IAAKA,EAAIpf,QAASyJ,QAC/B,CAIAylG,aAAaC,GACT,MAAMC,EAAgB,IAAI38F,IAC1B,IAAK,IAAIhf,EAAI,EAAGA,EAAI0E,KAAKg2G,OAAQ16G,IAC7B0E,KAAKm2G,QAAQ76G,GAAG8E,SAAS0S,IACrB,MAAMmU,EAAMjnB,KAAKi2G,KAAKt1G,IAAImS,EAAM0jG,UAChC,GAAIvvF,GAAOA,EAAIsvF,WAAaS,EAAOh8F,IAAIlI,EAAM0jC,OAAQ,CACjD,IAAI0gE,EAASD,EAAct2G,IAAImS,EAAM0jC,OAChC0gE,IACDA,EAAS,GACTD,EAAcp7G,IAAIiX,EAAM0jC,MAAO0gE,IAEnCA,EAAOx/G,KAAKob,EAAM8jG,MACtB,KAGR,OAAOK,CACX,CAMAE,SAASP,GACL,MAAM9jG,EAAQ9S,KAAKi2G,KAAKt1G,IAAIi2G,GAC5B,IAAK9jG,EACD,OAAO,KAENA,EAAMyjG,WACPv2G,KAAKo2G,oBAET,MAAM,QAAEvuG,EAAO,iBAAE4uG,GAAqB3jG,EAKtC,OAJAA,EAAMyjG,WAAY,EAGlBzjG,EAAM2jG,iBAAmB,IAAI/hG,IACtB,CAAE7M,UAAS4uG,mBACtB,CAIAr3G,QAC6BY,KAAKm2G,QAAQn2G,KAAKm2G,QAAQl/G,OAAS,GAC3CmJ,SAASg3G,IACtB,MAAMtkG,EAAQ9S,KAAKi2G,KAAKt1G,IAAIy2G,EAAWZ,UACnC1jG,IACA9S,KAAKi2G,KAAKh+F,OAAOm/F,EAAWZ,UACvB1jG,EAAMyjG,WACPv2G,KAAKo2G,oBAEb,IAEJp2G,KAAKm2G,QAAQp2E,MACb//B,KAAKm2G,QAAQlzE,QAAQ,GACzB,CACA4C,OAAO+wE,GACH,MAAM9jG,EAAQ9S,KAAKi2G,KAAKt1G,IAAIi2G,GAC5B,OAAK9jG,GAIL9S,KAAKi2G,KAAKh+F,OAAO2+F,GACV9jG,GAJI,IAKf,kBC3IG,MAAM,IAACswC,IAAO,GCCRi0D,GAAa,kBAKbC,GAAiB,iBAMjBC,GAAiB,iBA2JjBC,GAA0B,ICpKhC,SAASC,GAAQ58G,GACpB,GAAIA,EAAI5D,QAAU,EACd,OAAO4D,EAKX,IAAK,IAAIS,EAAI,EAAGA,EAAIT,EAAI5D,OAAQqE,IAAK,CACjC,MAAM8iB,EAHCnlB,KAAKiQ,MAAMjQ,KAAKy4B,SAAWz4B,KAAKiQ,MAAMrO,EAAI5D,SAI3CqzD,EAAMzvD,EAAIS,GAChBT,EAAIS,GAAKT,EAAIujB,GACbvjB,EAAIujB,GAAKksC,CACb,CACA,OAAOzvD,CACX,CCfO,SAAS,GAAaE,GACzB,OAAyB,MAArB+sB,WAAW1lB,OACJ,IAAI5H,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAEnD9R,CACX,CCOO,SAASmQ,GAAYzT,EAAO,GAC/B,OAAsC,MAAlCqwB,WAAW1lB,QAAQ8I,YACZ,GAAa4c,WAAW1lB,OAAO8I,YAAYzT,IAE/C,IAAI+C,WAAW/C,EAC1B,CCnBA,SAASw/D,GAAY53D,EAAMma,EAAQzK,EAAQ3C,GACvC,MAAO,CACH/M,OACAma,SACAq3C,QAAS,CACLxxD,OACAma,SACAzK,UAEJwhD,QAAS,CACLnkD,UAGZ,CACA,MAAM1I,GAASuzD,GAAY,OAAQ,KAAMl8D,GAE9B,IADS,IAAIg4D,YAAY,QACX3mD,OAAOrR,KAC5BM,IACgB,IAAI0d,aACLhK,OAAO1T,EAAIoE,UAAU,MAElCy3D,GAAQD,GAAY,QAAS,KAAMl8D,IACrC,IAAI2I,EAAS,IACb,IAAK,IAAIpI,EAAI,EAAGA,EAAIP,EAAI9D,OAAQqE,IAC5BoI,GAAUvM,OAAOC,aAAa2D,EAAIO,IAEtC,OAAOoI,CAAM,IACbrI,IAEA,MAAMN,EAAMmQ,IADZ7P,EAAMA,EAAIoE,UAAU,IACQxI,QAC5B,IAAK,IAAIqE,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC5BP,EAAIO,GAAKD,EAAIG,WAAWF,GAE5B,OAAOP,CAAG,IAWd,OATc,CACV6G,KAAM8B,GACN,QAASA,GACTyzD,IAAK,UACLC,OAAQF,GACRA,SACAG,OAAQH,MACL,ICpCA,SAAS,GAASr6C,EAAO5R,EAAW,QACvC,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKhE,QAAQ9hD,OAAO8N,GAAOpd,UAAU,GAHjCqoB,WAAW1lB,OAAOoE,KAAKqW,EAAMlmB,OAAQkmB,EAAMX,WAAYW,EAAMhQ,YAAYlI,SAAS,OAIjG,CCdO,SAAS+yG,GAAkBd,GAC9B,OAAO,GAASA,EAAO,SAC3B,iCCGO,SAAS,GAAWlzG,EAAQuH,EAAW,QAC1C,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKtE,QAAQnkD,OAAO,GAAGyoD,EAAKr7C,SAAS9V,KAHjC,GAAaokB,WAAW1lB,OAAOoE,KAAK9C,EAAQ,SAI3D,gBClBA,MAAM4zD,GAAyB,GACzBC,GAA0B,GAC1BC,GAAmB,GAwCzB,SAASC,GAAWC,EAAetiC,GAC/B,MAAMu4B,EAAa,IAAInzD,WAAW+8D,IAClC,IAAK,IAAIj8D,EAAI,EAAGA,EAAIk8D,GAAkBl8D,IAClCqyD,EAAWryD,GAAKo8D,EAAcp8D,GAC9BqyD,EAAW6J,GAAmBl8D,GAAK85B,EAAU95B,GAEjD,OAAOqyD,CACX,CC7CO,SAAS,GAAO9J,EAAQ5sD,GACb,MAAVA,IACAA,EAAS4sD,EAAOz0B,QAAO,CAACtd,EAAK5S,IAAS4S,EAAM5S,EAAKjI,QAAQ,IAE7D,MAAMwxC,EAASv9B,GAAYjU,GAC3B,IAAIC,EAAS,EACb,IAAK,MAAM2D,KAAOgpD,EACdpb,EAAO5sC,IAAIhB,EAAK3D,GAChBA,GAAU2D,EAAI5D,OAElB,OAAO,GAAawxC,EACxB,CCbA,QACI9nC,IAAIg3D,EAAM7vC,YACN,MAAM8vC,EAAeD,EAAI/iB,OACzB,GAAoB,MAAhBgjB,GAA+C,MAAvBA,EAAalD,OACrC,MAAMh2D,OAAO6W,OAAO,IAAIhd,MAAM,gRAI0D,CAAE8V,KAAM,2BAEpG,OAAOupD,CACX,GCDG,MAAMC,GAA0B,CAAEC,IAAK,UAAWj2C,KAAK,EAAM3O,EAAG,yBAA0B6kD,QAAS,CAAC,UAAW,WAAYC,IAAK,OCNhI/5D,eAAeg6D,GAAStK,EAAYuK,GACvC,MAAMC,EDOH,SAAgBpmB,GACnB,MAAMqmB,EAAYrmB,GAAMqmB,WAAa,UACrC,IAAIC,EAAYtmB,GAAMsmB,WAAa,GACnC,MAAMC,EAAcvmB,GAAMumB,aAAe,GACnCjO,EAAStY,GAAMsY,QAAU,UACzBkO,EAAaxmB,GAAMwmB,YAAc,GACjCC,EAAazmB,GAAMymB,YAAc,MACjC5jB,EAAS,SA0Ef,OAzEAyjB,GAAa,EAqEE,CACXjK,QAjEJnwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOjW,EAAO6jB,gBAAgB,IAAIj+D,WAAW+9D,IAC7CtK,EAAQrZ,EAAO6jB,gBAAgB,IAAIj+D,WAAW89D,IAC9CI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OAAc,CACvB2hE,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,YACtG,IACI,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,WAC1G,CACJ,KACK,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAM/J,QAAmB1Z,EAAO8f,OAAOtG,QAAQsK,EAAQE,EAAWn8C,GAClE,OAAO,GAAO,CAACouC,EAAM6N,EAAOC,GAAI,IAAIn+D,WAAW8zD,IACnD,EAsCIC,QA/BJtwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOpuC,EAAKnlB,SAAS,EAAGihE,GACxBtK,EAAQxxC,EAAKnlB,SAASihE,EAAYA,EAAaD,GAC/ChK,EAAa7xC,EAAKnlB,SAASihE,EAAaD,GACxCI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OACT,IACI,MAAM6hE,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAOhB,GAAyB,CAAEx4D,KAAM,YAAa,EAAM,CAAC,WAC1G,KAEC,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAMrK,QAAkBpZ,EAAO8f,OAAOnG,QAAQmK,EAAQE,EAAWtK,GACjE,OAAO,IAAI9zD,WAAWwzD,EAC1B,EAMJ,CCzFmB,GACTkL,QAAqBf,EAAO/J,QAAQT,EAAYuK,GACtD,OAAO,UAAcgB,EACzB,KCLWC,GAMPC,GAWOC,GAiDAC,gBAjEX,SAAWH,GACPA,EAAa,IAAI,MACjBA,EAAiB,QAAI,UACrBA,EAAmB,UAAI,WAC1B,CAJD,CAIGA,KAAYA,GAAU,CAAC,IAE1B,SAAWC,GACPA,EAAgBA,EAAqB,IAAI,GAAK,MAC9CA,EAAgBA,EAAyB,QAAI,GAAK,UAClDA,EAAgBA,EAA2B,UAAI,GAAK,WACvD,CAJD,CAIGA,KAAoBA,GAAkB,CAAC,IAC1C,SAAWD,GACPA,EAAQxC,MAAQ,KACL,SAAYyC,GAE1B,CAJD,CAIGD,KAAYA,GAAU,CAAC,IAE1B,SAAWE,GACP,IAAIE,EACJF,EAAU1C,MAAQ,KACA,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACTq2D,GAAQxC,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAOk+D,GAAQxC,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXF,EAAUtqD,OAAUzF,IACT,SAAcA,EAAK+vD,EAAU1C,SAExC0C,EAAUjtD,OAAUrR,IACT,SAAcA,EAAKs+D,EAAU1C,QAE3C,CA/CD,CA+CG0C,KAAcA,GAAY,CAAC,IAE9B,SAAWC,GACP,IAAIC,EACJD,EAAW3C,MAAQ,KACD,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACTq2D,GAAQxC,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAOk+D,GAAQxC,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXD,EAAWvqD,OAAUzF,IACV,SAAcA,EAAKgwD,EAAW3C,SAEzC2C,EAAWltD,OAAUrR,IACV,SAAcA,EAAKu+D,EAAW3C,QAE5C,CA/CD,CA+CG2C,KAAeA,GAAa,CAAC,IChHzB,MAAMI,GACT9a,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAO+a,GAAUxrD,EAAK,GAC/B,CACAlQ,aAAawe,EAAM6Z,GACf,ON0BDr4B,eAA6Bm3B,EAAWkB,EAAKrP,GAChD,OAAO,aAAUqP,EAAKrP,EAAKmO,EAC/B,CM5Be,CAAqBp1B,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMs2D,GACTjb,KACAkb,WAGAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAO+a,GAAUxrD,EAAK,IAC3BnO,KAAK85D,WAAaH,GAAUvkC,EAAW,GAC3C,CACAn3B,WAAW4J,GACP,ONPD5J,eAA2B0vD,EAAY1mC,GAC1C,MAAMywC,EAAgB/J,EAAWr2D,SAAS,EAAGkgE,IAC7C,OAAO,WAAQvwC,EAAKywC,EACxB,CMIe,CAAmB13D,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAIL,GAAiB15D,KAAK85D,WACrC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAUAtF,WACI,MAAMgN,EAAW,UAAgBjL,KAAK+5D,OAAOx2D,OAC7C,OAAO,UAAiB0H,EAAS1H,OAAO9D,UAAU,EACtD,CAIAxB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAASorD,GAA2Bz2D,GAEvC,GAAIA,EAAMtM,OAAS,GAAyB,CAExC,MAAMgjE,GADN12D,EAAQo2D,GAAUp2D,EAAO,GAA0B,KACrBjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,GAAyBiM,EAAMtM,QACrE,OAAO,IAAI4iE,GAAkBI,EAAiBC,EAClD,CAEA,MAAMD,GADN12D,EAAQo2D,GAAUp2D,EAAO,KACKjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,IACtC,OAAO,IAAIuiE,GAAkBI,EAAiBC,EAClD,CACO,SAASC,GAA0B52D,GAEtC,OADAA,EAAQo2D,GAAUp2D,EAAO,IAClB,IAAIm2D,GAAiBn2D,EAChC,CACOtF,eAAem8D,KAClB,MAAM,WAAEzM,EAAU,UAAEv4B,SNrGjBn3B,iBAEH,MAAMy5D,EAAgB,+BAChBtiC,EAAY,mBAAgBsiC,GAGlC,MAAO,CACH/J,WAFe8J,GAAWC,EAAetiC,GAGzCA,YAER,CM2F4C,GACxC,OAAO,IAAIykC,GAAkBlM,EAAYv4B,EAC7C,CACOn3B,eAAeo8D,GAAwBxM,GAC1C,MAAM,WAAEF,EAAU,UAAEv4B,SN3FjBn3B,eAAmC4vD,GACtC,GAAIA,EAAK52D,SAAWugE,GAChB,MAAM,IAAIxyD,UAAU,sCAEnB,KAAM6oD,aAAgBrzD,YACvB,MAAM,IAAIwK,UAAU,mDAGxB,MAAM0yD,EAAgB7J,EAChBz4B,EAAY,mBAAgBsiC,GAElC,MAAO,CACH/J,WAFe8J,GAAWC,EAAetiC,GAGzCA,YAER,CM4E4C,CAA2By4B,GACnE,OAAO,IAAIgM,GAAkBlM,EAAYv4B,EAC7C,CACA,SAASukC,GAAUxrD,EAAKlX,GAEpB,IADAkX,EAAM3T,WAAWgM,KAAK2H,GAAO,KACrBlX,SAAWA,EACf,MAAM,IAAI,MAAU,sCAAsCA,UAAekX,EAAIlX,SAAU,wBAE3F,OAAOkX,CACX,mBCjHO,SAASmsD,GAA0B3zB,EAAK3qC,GAE3C,IAAIjB,EAAMP,WAAWgM,KAAKmgC,EAAIxf,MAAMG,eAMpC,GADAvsB,EAAiB,IAAXA,EAAI,GAAWA,EAAIzD,SAAS,GAAKyD,EAC5B,MAAPiB,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAO,GAAmBA,EAAK,YACnC,CAEO,SAASw/D,GAAsBl/D,GAClC,MAAMN,EAGH,SAA2BM,EAAKW,GACnC,IAAIjB,EAAM,GAAqBM,EAAK,gBACpC,GAAW,MAAPW,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAOA,CACX,CAXgB,CAAkBM,GAC9B,OAAO,IAAI,mBAAsB,GAAmBN,EAAK,UAAW,GACxE,CCpBA,MAAMwH,GAAO,CACT,QAAS,IACT,QAAS,IACT,QAAS,KAEM7D,OAAO+I,KAAKlF,IACN5K,KAAK,gBCZvB,MAAM,GAA+B,iBAAfmwB,YAA2B,WAAYA,WAAaA,WAAW8sB,YAASltC,ECmBrG,KADgF,KAA5D,IAAIlN,WAAW,IAAI1D,YAAY,CAAC,YAAaH,QAAQ,IAErE,MAAM,IAAI4B,MAAM,+CClBL,SAAS,GAAYtB,GAChC,GAAIg2B,MAAMh2B,IAAWA,GAAU,EAC3B,MAAM,IAAI,MAAU,qDAAsD,sBAE9E,OD6IG,SAAqBujE,EAAc,IACtC,GAAI,IAA4C,mBAA3B,mBACjB,OAAO,mBAAuB,IAAIhgE,WAAWggE,IAEjD,MAAM,IAAIjiE,MAAM,yCACpB,CClJW,CAAMtB,EACjB,UCHA,SAASwjE,GAAQtsD,EAAKusD,GAClB,OAAOA,EAAM9/C,KAAI4kB,GAAK+6B,GAAsBpsD,EAAIqxB,KACpD,CCgBOvhC,eAAe,GAAoBkQ,GACtC,MAIM06C,EAAO,OAJY,SAAgB6L,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,eAGAs7D,GAAwBxsD,IAE5B1G,QAAamzD,GAAU,CACzBjN,WAAY9E,EAAK,GACjBzzB,UAAWyzB,EAAK,KAEpB,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CAiBAxJ,eAAe28D,GAAU/R,GACrB,GAAuB,MAAnBA,EAAK8E,YAAwC,MAAlB9E,EAAKzzB,UAChC,MAAM,IAAI,MAAU,sCAAuC,0BAE/D,OAAO5jB,QAAQQ,IAAI,CACf,SAAgB0iD,OAAOkG,UAAU,MAAO/R,EAAK8E,YAC7C,SAAgB+G,OAAOkG,UAAU,MAAO/R,EAAKzzB,YAErD,CACAn3B,eAAe08D,GAAwBE,GACnC,OAAO,SAAgBnG,OAAOmE,UAAU,MAAO,CAC3Cb,IAAK6C,EAAM7C,IACXv/D,EAAGoiE,EAAMpiE,EACTgR,EAAGoxD,EAAMpxD,GACV,CACCpK,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,UACd,CAYA,SAASy7D,GAAW3sD,EAAK4sD,EAAK9zC,EAAK+zC,GAC/B,MAAMC,EAAOF,ED7EV,SAAiB5sD,GACpB,OAAO,0BAA6BssD,GAAQtsD,EAAK,CAAC,IAAK,MAC3D,CC2EuB+sD,CAAQ/sD,GDhFxB,SAAkBA,GACrB,OAAO,2BAA8BssD,GAAQtsD,EAAK,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,OAC5F,CC8EsCgtD,CAAShtD,GAG3C,OAAO,GADO6sD,EADD,GAAmBxgE,WAAWgM,KAAKygB,GAAM,SAC3Bg0C,GACQ,QACvC,CAOO,SAASG,GAAQC,GACpB,GAAgB,QAAZA,EAAIrD,IACJ,MAAM,IAAI,MAAU,mBAAoB,wBAEvC,GAAa,MAATqD,EAAI5iE,EACT,MAAM,IAAI,MAAU,sBAAuB,2BAG/C,OAAsB,EADR,GAAqB4iE,EAAI5iE,EAAG,aAC7BxB,MACjB,CCjGO,MAAMqkE,GAAe,KACrB,MAAMC,GACT3c,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODgCDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,MAAMmO,QAAkB,SAAgBs/B,OAAOmE,UAAU,MAAO1qD,EAAK,CACjE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,WACX,OAAO,SAAgBq1D,OAAO8G,OAAO,CAAEn8D,KAAM,qBAAuB+1B,EAAWkB,EAAKrP,EACxF,CCtCe,CAAqBjnB,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OCkCD,SAAmByB,GACtB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,EACrB,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMgyD,EAAO,uBAA0B,CACnChjE,EAAG8hE,GAAsBc,EAAI5iE,GAC7BgR,EAAG8wD,GAAsBc,EAAI5xD,KAEjC,OAAO,GAAqB,cAAiBgyD,GAAMC,WAAY,QACnE,CD3Ce,CAAuB17D,KAAK4+C,KACvC,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA82D,QAAQ7qD,GACJ,ODgEGu3D,GChEmB96D,KAAK4+C,MDgER,EChEcr7C,GDgEH,CAAC0jB,EAAK9Y,IAAQA,EAAIigD,QAAQnnC,IC/D5D,CACAjG,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMo4D,GACT/c,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,CACtB,CACAwmC,YACI,OAAO,GAAuB,GAClC,CACA39D,WAAW4J,GACP,ODTD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM0mC,QAAmB,SAAgB+G,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,SACLi3B,QAAY,SAAgBo+B,OAAOnuD,KAAK,CAAElH,KAAM,qBAAuBsuD,EAAYnzD,WAAWgM,KAAKygB,IACzG,OAAO,IAAIzsB,WAAW87B,EAAK,EAAGA,EAAIzpB,WACtC,CCEe,CAAmB7M,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,GAAuB,MAAnB/5D,KAAK85D,WACL,MAAM,IAAI,MAAU,0BAA2B,2BAEnD,OAAO,IAAIyB,GAAav7D,KAAK85D,WACjC,CACAvL,QAAQhrD,GACJ,ODqCGu3D,GCrCmB96D,KAAK4+C,MDqCR,ECrCcr7C,GDqCF,CAAC0jB,EAAK9Y,IAAQA,EAAIogD,QAAQtnC,ICpC7D,CACA2yC,UACI,OCnCD,SAAoByB,GACvB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,GAAsB,MAAT4xD,EAAIt+B,GAAsB,MAATs+B,EAAI9/D,GAAsB,MAAT8/D,EAAIhe,GAAuB,MAAVge,EAAIQ,IAAwB,MAAVR,EAAIS,IAAwB,MAAVT,EAAIU,GAC7H,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMN,EAAO,wBAA2B,CACpChjE,EAAG8hE,GAAsBc,EAAI5iE,GAC7BgR,EAAG8wD,GAAsBc,EAAI5xD,GAC7BszB,EAAGw9B,GAAsBc,EAAIt+B,GAC7BxhC,EAAGg/D,GAAsBc,EAAI9/D,GAC7B8hD,EAAGkd,GAAsBc,EAAIhe,GAC7B2e,GAAIzB,GAAsBc,EAAIQ,IAC9BI,GAAI1B,GAAsBc,EAAIS,IAC9BI,KAAM3B,GAAsBc,EAAIU,MAEpC,OAAO,GAAqB,cAAiBN,GAAMC,WAAY,QACnE,CDoBe,CAAwB17D,KAAK4+C,KACxC,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,UAC5B,GAAe,WAAXA,EAAqB,CACrB,MAAMjY,EAAS,IAAI,mBAAsBqJ,KAAK45D,WACxC6B,EAAO,gBAAmB9kE,GAC1Bg3D,EAAa,0BAA6B8N,GAC1CrtD,EAAU,CACZgqD,UAAW,SACX9mD,MAAO,IACP6qD,SAAU,GACVC,aAAc,UAElB,OAAO,4BAA+BzO,EAAYuK,EAAU9pD,EAChE,CACK,GAAe,eAAXQ,EACL,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG3Q,eAAeo+D,GAAuB94D,GACzC,MAAM83D,ECxGH,SAAoB93D,GACvB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpDoqD,EAAa,0BAA6B8N,GAEhD,MAAO,CACHzD,IAAK,MACLv/D,EAAG6hE,GAA0B3M,EAAWl1D,GACxCgR,EAAG6wD,GAA0B3M,EAAWlkD,GACxCszB,EAAGu9B,GAA0B3M,EAAW5wB,GACxCxhC,EAAG++D,GAA0B3M,EAAWpyD,GACxC8hD,EAAGid,GAA0B3M,EAAWtQ,GACxCwe,GAAIvB,GAA0B3M,EAAWqO,IACzCF,GAAIxB,GAA0B3M,EAAWsO,IACzCF,GAAIzB,GAA0B3M,EAAWuO,MACzCpE,IAAK,QAEb,CDwFgB,CAAwBv0D,GACpC,GAAI,GAAe83D,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAIM,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACO,SAASknC,GAAsB/4D,GAClC,MAAM83D,EC7EH,SAAmB93D,GACtB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpD6xB,EAAY,yBAA4BqmC,GAC9C,MAAO,CACHzD,IAAK,MACLv/D,EAAG6hE,GAA0BllC,EAAU38B,GACvCgR,EAAG6wD,GAA0BllC,EAAU3rB,GAE/C,CDqEgB,CAAuBlG,GACnC,GAAI,GAAe83D,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,OAAO,IAAIC,GAAaF,EAC5B,CACOp9D,eAAes+D,GAAQlB,GAC1B,GAAI,GAAeA,GAAOC,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAIM,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACOn3B,eAAe,GAAgBsE,GAClC,GAAIA,EAAO+4D,GACP,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM7zD,QDlIHxJ,eAA2BsE,GAC9B,MAAMsmD,QAAa,SAAgB6L,OAAO8H,YAAY,CAClDn9D,KAAM,oBACNo9D,cAAel6D,EACfm6D,eAAgB,IAAIliE,WAAW,CAAC,EAAM,EAAM,IAC5C8E,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,OAAQ,WACZoI,QAAamzD,GAAU/R,GAC7B,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CCsHuB,CAAmBlF,GACtC,OAAO,IAAIo5D,GAAcl0D,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,iBE3FO,SAASunC,GAAkBxuD,GAC9B,IACI,8BAA6BA,EACjC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,yBACrC,CACJ,CCjDO,MAAMg3D,GACThe,KACA9+C,YAAYqO,GACR,GAAyBA,GACzBnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODUDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,IACI,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,OAAO,aAAYqP,EAAK+zB,EAAQl8C,EACpC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CClBe,CAAqB5F,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,ODgB0BzrD,EChBMnO,KAAK4+C,KDiB3B,8BAA6BzwC,GAAK0uD,YAAW,GADxD,IAA2B1uD,CCf9B,CACI5K,YACA,OAAO,UAA8B,CACjCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAMu5D,GACTle,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,GDmBnB,SAA0Bu4B,GAC7B,IACI,OAAO,mBAAkBA,GAAY,EACzC,CACA,MAAO/nD,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CC1BuC,CAAwBuI,GDGxD,SAA4BA,GAC/B,IACI,mBAAkBA,GAAK,EAC3B,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CCTQ,CAA0B5F,KAAK4+C,MAC/B,GAAyB5+C,KAAK85D,WAClC,CACA77D,WAAW4J,GACP,ODhCD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,IAEI,OADkB,WAAUojC,EAAQl8C,GACnB4uD,eACrB,CACA,MAAOn3D,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CCuBe,CAAmB5F,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAI6C,GAAmB58D,KAAK85D,WACvC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAA+B,CAClCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAOqpD,GAASj4D,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAASouD,GAA6Bz5D,GACzC,OAAO,IAAIu5D,GAAoBv5D,EACnC,CACO,SAAS05D,GAA4B15D,GACxC,OAAO,IAAIq5D,GAAmBr5D,EAClC,CACOtF,eAAe,KAClB,MAAMg8D,EDxFC,+BCyFP,OAAO,IAAI6C,GAAoB7C,EACnC,CChFO,MAAMiD,GAAgB,CACzBC,IAAK,EACLC,QAAS,EACTC,UAAW,GAEf,SAASC,GAAepuD,GACpB,MAAMquD,EAAY7+D,OAAO+I,KAAKy1D,IAAevlE,KAAK,OAClD,OAAO,IAAI,MAAU,mCAAmCuX,cAAiBquD,IAAa,2BAC1F,CACA,SAASo6C,GAAUzoG,GAEf,GAAa,SADbA,EAAOA,EAAK3E,gBACmB,YAAT2E,GAA+B,cAATA,EACxC,OAAOguD,GAAchuD,GAEzB,MAAMouD,GAAepuD,EACzB,CAeO,SAAS,GAAmBnU,GAC/B,MAAMyiE,EAAU,UAAyBziE,GACnC0hB,EAAO+gD,EAAQ/D,MAAQ,IAAIj/D,WACjC,OAAQgjE,EAAQviE,MACZ,KAAK,OACD,OAAOiiE,GAAcC,IAAIb,sBAAsB7/C,GACnD,KAAK,WACD,OAAOygD,GAAcE,QAAQjD,0BAA0B19C,GAC3D,KAAK,aACD,OAAOygD,GAAcG,UAAUJ,4BAA4BxgD,GAC/D,QACI,MAAM6gD,GAAeE,EAAQviE,MAAQ,WAEjD,CASOgD,eAAe,GAAoBlD,GACtC,MAAMyiE,EAAU,UAA0BziE,GACpC0hB,EAAO+gD,EAAQ/D,MAAQ,IAAIj/D,WACjC,OAAQgjE,EAAQviE,MACZ,KAAK,OACD,OAAOiiE,GAAcC,IAAId,uBAAuB5/C,GACpD,KAAK,WACD,OAAOygD,GAAcE,QAAQpD,2BAA2Bv9C,GAC5D,KAAK,aACD,OAAOygD,GAAcG,UAAUL,6BAA6BvgD,GAChE,QACI,MAAM6gD,GAAeE,EAAQviE,MAAQ,OAEjD,KChFW28G,GAuBAC,GAKAC,GAqBAC,GAoBAC,eASJ,SAASC,GAA2BC,GACvC,OAAQA,GACJ,KAAK,aACD,OAAOJ,GAAaK,OACxB,KAAK,aACD,OAAOL,GAAaM,OAEhC,EApFA,SAAWR,GASPA,EAA4B,WAAI,aAWhCA,EAA8B,aAAI,cACrC,CArBD,CAqBGA,KAAoBA,GAAkB,CAAC,IAE1C,SAAWC,GACPA,EAAkBA,EAA2B,QAAI,GAAK,UACtDA,EAAkBA,EAA6B,UAAI,GAAK,WAC3D,CAHD,CAGGA,KAAsBA,GAAoB,CAAC,IAE9C,SAAWC,GAKPA,EAAoB,MAAI,QAIxBA,EAAqB,OAAI,SAIzBA,EAAqB,OAAI,SAKzBA,EAA0B,YAAI,aACjC,CAnBD,CAmBGA,KAAiBA,GAAe,CAAC,IAEpC,SAAWC,GAEPA,EAAgC,iBAAI,oBAEpCA,EAA4B,aAAI,gBAEhCA,EAA6B,cAAI,iBAGjCA,EAAgC,iBAAI,oBAGpCA,EAA4B,aAAI,gBAGhCA,EAA2B,YAAI,eAE/BA,EAA+B,gBAAI,kBACtC,CAlBD,CAkBGA,KAAkBA,GAAgB,CAAC,IAEtC,SAAWC,GACPA,EAAyB,UAAI,YAC7BA,EAAuB,QAAI,UAC3BA,EAAqB,MAAI,OAC5B,CAJD,CAIGA,KAAkBA,GAAgB,CAAC,IC3E/B,MAAMK,GAAgC,gCCEhCC,GAAyB,CAClCtB,OAAQ,CAAC,EACTuB,cAAe,GACfC,iBAAkB,IAAM,EACxBC,kBAAmB,GACnBC,0BAA2B,EAC3BC,4BAA6B,GAC7BC,4BAA6B,IAAIlkG,IACjCmkG,wBAAyB,GACzBC,0BAA2B,EAC3BC,sBAAuB,GACvBC,cAAe,IACfC,YAAa,GACbC,YAAa,MAEJC,GAA0B,CACnCC,YAAa,GACbC,iBAAkB,EAClBC,kBAAmB,EACnBC,cAAe,KACfC,6BAA8B,EAC9BC,4BAA6B,GAC7BC,0BAA2B,IAC3BC,6BAA8B,EAC9BC,2BAA4B,GAC5BC,yBAA0B,IAC1BC,+BAAgC,GAChCC,4BAA6B,GAC7BC,gCAAiC,IACjCC,0BAA2B,EAC3BC,wBAAyB,GACzBC,gCAAiC,EACjCC,8BAA+B,IAE5B,SAASC,GAAsB9+G,EAAI,CAAC,GACvC,MAAO,IACA+8G,MACA/8G,EACHy7G,OAAQz7G,EAAEy7G,OACJt4G,OAAOmU,QAAQtX,EAAEy7G,QAAQ5nF,QAAO,CAAC4nF,GAASxgE,EAAO8jE,MAC/CtD,EAAOxgE,GAMhB,SAAgCj7C,EAAI,CAAC,GACxC,MAAO,IACA49G,MACA59G,EAEX,CAXgCg/G,CAAuBD,GAChCtD,IACR,CAAC,GACF,CAAC,EAEf,CAgDO,SAASwD,GAAyBj/G,GAErC,GAAIA,EAAE69G,YAAc,EAChB,MAAM,IAAI,MAAU,qCAAsCf,IAG9D,GAA4B,IAAxB98G,EAAE+9G,kBACF,MAAM,IAAI,MAAU,8CAA+CjB,IAEvE,GAAI98G,EAAE89G,iBAAmB,EACrB,MAAM,IAAI,MAAU,+DAAgEhB,IAExF,GAA2B,IAAvB98G,EAAE89G,kBAA0B99G,EAAE+9G,mBAAqB,EACnD,MAAM,IAAI,MAAU,8CAA+CjB,IAEvE,GAA2B,IAAvB98G,EAAE89G,kBAA0B99G,EAAEg+G,eAAiB,EAC/C,MAAM,IAAI,MAAU,0CAA2ClB,IAGnE,GAAI98G,EAAEi+G,6BAA+B,EACjC,MAAM,IAAI,MAAU,4EAA6EnB,IAErG,GAAuC,IAAnC98G,EAAEi+G,+BACDj+G,EAAEk+G,6BAA+B,GAAKl+G,EAAEk+G,6BAA+B,GACxE,MAAM,IAAI,MAAU,+DAAgEpB,IAExF,GAAuC,IAAnC98G,EAAEi+G,8BAAsCj+G,EAAEm+G,2BAA6B,EACvE,MAAM,IAAI,MAAU,sDAAuDrB,IAG/E,GAAI98G,EAAEo+G,4BAA8B,EAChC,MAAM,IAAI,MAAU,0EAA2EtB,IAEnG,GAAsC,IAAlC98G,EAAEo+G,8BAAsCp+G,EAAEq+G,4BAA8B,GAAKr+G,EAAEq+G,4BAA8B,GAC7G,MAAM,IAAI,MAAU,8DAA+DvB,IAEvF,GAAsC,IAAlC98G,EAAEo+G,6BAAqCp+G,EAAEs+G,0BAA4B,EACrE,MAAM,IAAI,MAAU,qDAAsDxB,IAE9E,GAAsC,IAAlC98G,EAAEo+G,6BAAqCp+G,EAAEu+G,gCAAkC,EAC3E,MAAM,IAAI,MAAU,2DAA4DzB,IAEpF,GAAI98G,EAAEw+G,4BAA8B,EAChC,MAAM,IAAI,MAAU,4DAA6D1B,IAErF,GAAsC,IAAlC98G,EAAEo+G,6BAAqCp+G,EAAEy+G,gCAAkC,IAC3E,MAAM,IAAI,MAAU,+DAAgE3B,IAGxF,GAAI98G,EAAE0+G,yBAA2B,EAC7B,MAAM,IAAI,MAAU,uEAAwE5B,IAEhG,GAAmC,IAA/B98G,EAAE0+G,2BAAmC1+G,EAAE2+G,yBAA2B,GAAK3+G,EAAE2+G,yBAA2B,GACpG,MAAM,IAAI,MAAU,2DAA4D7B,IAGpF,GAAI98G,EAAE4+G,+BAAiC,EACnC,MAAM,IAAI,MAAU,6EAA8E9B,IAEtG,GAAI98G,EAAE6+G,+BAAiC,GAAK7+G,EAAE6+G,+BAAiC,EAC3E,MAAM,IAAI,MAAU,iEAAkE/B,GAE9F,CC3JO,MAAMoC,GAA6B,CACtCC,iBAAkB,GAClBC,kBAAmB,GACnBC,mBAAoB,GACpBC,kBAAmB,GACnBC,4BAA6B,IAE1B,SAASC,GAA0Bx/G,EAAI,CAAC,GAC3C,MAAO,IACAk/G,MACAl/G,EAEX,CCdO,SAASy/G,GAAaC,EAAMC,EAAQvoF,EAAQwoF,GAC/C,IAAIC,EAAQ,EAEZ18G,OAAOmU,QAAQqoG,EAAOlE,QAAQ52G,SAAQ,EAAEo2C,EAAO6kE,MAE3C,MAAMC,EAAc3oF,EAAOqkF,OAAOxgE,GAClC,QAAoB9uC,IAAhB4zG,EAEA,OAEJ,IAAIC,EAAa,EAEjB,GAAIF,EAAOG,OAAQ,CACf,IAAIC,EAAKJ,EAAOK,SAAWJ,EAAYhC,kBACnCmC,EAAKH,EAAY/B,gBACjBkC,EAAKH,EAAY/B,eAErBgC,GAAcE,EAAKH,EAAYjC,gBACnC,CAEA,IAAIsC,EAAKN,EAAOO,uBAMhB,GALID,EAAKL,EAAY5B,4BACjBiC,EAAKL,EAAY5B,2BAErB6B,GAAcI,EAAKL,EAAY9B,6BAE3B6B,EAAOQ,6BACPR,EAAOS,sBAAwBR,EAAYxB,+BAAgC,CAC3E,MAAMiC,EAAUT,EAAYxB,+BAAiCuB,EAAOS,sBAEpEP,GADWQ,EAAUA,EACFT,EAAY3B,2BACnC,CAIA4B,GADYF,EAAOW,mBACCV,EAAYrB,yBAIhCsB,GADWF,EAAOY,yBAA2BZ,EAAOY,yBACjCX,EAAYnB,+BAE/BiB,GAASG,EAAaD,EAAYlC,WAAW,IAG7CzmF,EAAO4lF,cAAgB,GAAK6C,EAAQzoF,EAAO4lF,gBAC3C6C,EAAQzoF,EAAO4lF,eAGnB,MAAM2D,EAAKvpF,EAAO6lF,iBAAiByC,GAmBnC,GAlBAG,GAASc,EAAKvpF,EAAO8lF,kBAErByC,EAAOiB,SAAS/7G,SAASg8G,IACrB,GAAIzpF,EAAOimF,4BAA4B59F,IAAIohG,GACvC,OAKJ,MAAMC,EAAYlB,EAAQx6G,IAAIy7G,GACxBE,EAAeD,EAAYA,EAAU5kH,KAAO,EAClD,GAAI6kH,EAAe3pF,EAAOgmF,4BAA6B,CACnD,MAAM4D,EAAUD,EAAe3pF,EAAOgmF,4BAEtCyC,GADWmB,EAAUA,EACP5pF,EAAO+lF,wBACzB,KAGAwC,EAAOsB,iBAAmB7pF,EAAOmmF,0BAA2B,CAC5D,MAAM2D,EAASvB,EAAOsB,iBAAmB7pF,EAAOmmF,0BAEhDsC,GADWqB,EAASA,EACN9pF,EAAOkmF,sBACzB,CACA,OAAOuC,CACX,KCvEWsB,gBACX,SAAWA,GAIPA,EAAqBA,EAA8B,QAAI,GAAK,UAI5DA,EAAqBA,EAA4B,MAAI,GAAK,QAI1DA,EAAqBA,EAA8B,QAAI,GAAK,UAI5DA,EAAqBA,EAA8B,QAAI,GAAK,SAC/D,CAjBD,CAiBGA,KAAyBA,GAAuB,CAAC,IAM7C,MAAMC,GACThiB,QACAtwD,MACAvqC,cACIE,KAAK26F,QAAU,IAAIrgF,IACnBta,KAAKqqC,MAAQ,IAAI,EACrB,CACAuyE,UAAUpG,GACN,OAAOx2G,KAAK26F,QAAQh6F,IAAI61G,EAC5B,CACAqG,aAAarG,GACT,IAAIsG,EAAO98G,KAAK26F,QAAQh6F,IAAI61G,GAC5B,GAAIsG,EACA,OAAOA,EAIXA,EAAO,CACHnoG,OAAQ+nG,GAAqB/mD,QAC7BonD,cAAe7jH,KAAKm+C,MACpBk/D,UAAW,EACXnxD,MAAO,IAAI1wC,KAEf1U,KAAK26F,QAAQ9+F,IAAI26G,EAAUsG,GAE3B,MAAMhqG,EAAQ,CACV8jG,MAAOJ,EACP58D,OAAQ1gD,KAAKm+C,MhCmIQ,MgChIzB,OADAr3C,KAAKqqC,MAAM3yC,KAAKob,GACTgqG,CACX,CACAE,KACI,MAAM3lE,EAAMn+C,KAAKm+C,MAGjB,IAAI5rC,EAAOzL,KAAKqqC,MAAM7E,YACtB,KAAO/5B,GAAQA,EAAKmuC,OAASvC,GACzBr3C,KAAK26F,QAAQ1iF,OAAOxM,EAAKmrG,OACzB52G,KAAKqqC,MAAMjrC,QACXqM,EAAOzL,KAAKqqC,MAAM7E,WAE1B,CACAn2B,QACIrP,KAAK26F,QAAQtrF,QACbrP,KAAKqqC,MAAMh7B,OACf,ECrEG,SAAS4tG,GAAmBC,EAAUC,EAAOC,EAAO,MAAM,IAC7D,MAAMC,EAAS,IAAI3oG,IACnB,GAAIyoG,GAAS,EACT,OAAOE,EACX,IAAK,MAAMzjH,KAAMsjH,EAAU,CACvB,GAAIG,EAAO5lH,MAAQ0lH,EACf,MACAC,EAAKxjH,KACLyjH,EAAOrlG,IAAIpe,GACXsjH,EAASjlG,OAAOre,GAExB,CACA,OAAOyjH,CACX,CAOO,MAAMC,WAAehjG,IACxBijG,WACAz9G,YAAYy9G,GACR5qG,QACA3S,KAAKu9G,WAAaA,CACtB,CACAC,aAAarvG,GACT,IAAItP,EAAQ8T,MAAMhS,IAAIwN,GAKtB,YAJczG,IAAV7I,IACAA,EAAQmB,KAAKu9G,aACbv9G,KAAKnE,IAAIsS,EAAKtP,IAEXA,CACX,EC9BJ,MAAM,GAAM,GAAO,0BACZ,MAAM4+G,GACT9qF,OACA4yC,QAIAm4C,UAAY,IAAIpjG,IAIhB6gG,QAAU,IAAImC,IAAO,IAAM,IAAI5oG,MAI/BipG,WAAa,IAAIrjG,IAIjBsjG,gBAAkB,IAAIjB,GACtBkB,oBACAC,qBACA9C,aACAl7G,YAAY6yB,EAAQ4yC,EAASxzB,GACzB/xC,KAAK2yB,OAASA,EACd3yB,KAAKulE,QAAUA,ELwBhB,SAAiChqE,GACpC,IAAK,MAAOi7C,EAAO7jB,KAAWj0B,OAAOmU,QAAQtX,EAAEy7G,QAC3C,IACIwD,GAAyB7nF,EAC7B,CACA,MAAOlpB,GACH,MAAM,IAAI,MAAU,sCAAsC+sC,MAAU/sC,EAAE5B,UAAWwwG,GACrF,CAGJ,GAAI98G,EAAEg9G,cAAgB,EAClB,MAAM,IAAI,MAAU,8DAA+DF,IAGvF,GAA2B,OAAvB98G,EAAEi9G,uBAAoD9wG,IAAvBnM,EAAEi9G,iBACjC,MAAM,IAAI,MAAU,8CAA+CH,IAGvE,GAAI98G,EAAEm9G,yBAA2B,EAC7B,MAAM,IAAI,MAAU,uEAAwEL,IAEhG,GAAmC,IAA/B98G,EAAEm9G,0BAAkCn9G,EAAEo9G,4BAA8B,EACpE,MAAM,IAAI,MAAU,0DAA2DN,IAGnF,GAAI98G,EAAEs9G,uBAAyB,EAC3B,MAAM,IAAI,MAAU,qEAAsER,IAE9F,GAAiC,IAA7B98G,EAAEs9G,yBAAiCt9G,EAAEw9G,uBAAyB,GAAKx9G,EAAEw9G,uBAAyB,GAC9F,MAAM,IAAI,MAAU,yDAA0DV,IAGlF,GAAI98G,EAAEy9G,cAAgB,IAClB,MAAM,IAAI,MAAU,6CAA8CX,IAEtE,GAAI98G,EAAE09G,aAAe,GAAK19G,EAAE09G,aAAe,EACvC,MAAM,IAAI,MAAU,+CAAgDZ,GAG5E,CK9DQ0F,CAAwBprF,GACxB3yB,KAAK89G,qBAAuB/rE,EAAK+rE,qBACjC99G,KAAKg7G,aAAejpE,EAAKipE,cAAgBA,EAC7C,CACIvjH,WACA,OAAOuI,KAAK09G,UAAUjmH,IAC1B,CAIA+L,QACQxD,KAAK69G,oBACL,GAAI,+BAGR79G,KAAK69G,oBAAsB9L,aAAY,IAAM/xG,KAAKg+G,cAAch+G,KAAK2yB,OAAOqmF,eAC5E,GAAI,WACR,CAIAnvE,OACS7pC,KAAK69G,qBAIV3tC,cAAclwE,KAAK69G,4BACZ79G,KAAK69G,oBACZ79G,KAAKm7G,QAAQ9rG,QACbrP,KAAK09G,UAAUruG,QACfrP,KAAK49G,gBAAgBvuG,QACrB,GAAI,YARA,GAAI,6BASZ,CAIA2uG,aACIh+G,KAAKi+G,gBACLj+G,KAAK49G,gBAAgBZ,IACzB,CACAkB,qBACI,OAAOx/G,OAAOy/G,YAAYvlH,MAAM4N,KAAKxG,KAAK09G,UAAU7qG,WAAW+H,KAAI,EAAEqgG,EAAMmD,KAAW,CAACnD,EAAMmD,KACjG,CACAC,4BAA4B7H,GACxB,MAAMsG,EAAO98G,KAAK49G,gBAAgBhB,UAAUpG,GAC5C,OAAOsG,EAAOA,EAAKC,cAAgB,IACvC,CAIAkB,gBACI,MAAM5mE,EAAMn+C,KAAKm+C,MACX4hE,EAAcj5G,KAAK2yB,OAAOsmF,YAChCj5G,KAAK09G,UAAUt9G,SAAQ,CAAC86G,EAAQthH,KACvBshH,EAAOoD,WAcZ5/G,OAAOmU,QAAQqoG,EAAOlE,QAAQ52G,SAAQ,EAAEo2C,EAAO6kE,MAC3C,MAAMkD,EAAUv+G,KAAK2yB,OAAOqkF,OAAOxgE,QACnB9uC,IAAZ62G,IAMJlD,EAAOO,wBAA0B2C,EAAQ9E,4BACrC4B,EAAOO,uBAAyB3C,IAChCoC,EAAOO,uBAAyB,GAEpCP,EAAOS,uBAAyByC,EAAQ3E,2BACpCyB,EAAOS,sBAAwB7C,IAC/BoC,EAAOS,sBAAwB,GAEnCT,EAAOW,oBAAsBuC,EAAQrE,wBACjCmB,EAAOW,mBAAqB/C,IAC5BoC,EAAOW,mBAAqB,GAEhCX,EAAOY,0BAA4BsC,EAAQnE,8BACvCiB,EAAOY,yBAA2BhD,IAClCoC,EAAOY,yBAA2B,GAGlCZ,EAAOG,SACPH,EAAOK,SAAWrkE,EAAMgkE,EAAOmD,UAC3BnD,EAAOK,SAAW6C,EAAQvE,kCAC1BqB,EAAOQ,6BAA8B,IAE7C,IAGJX,EAAOsB,kBAAoBx8G,KAAK2yB,OAAOomF,sBACnCmC,EAAOsB,iBAAmBvD,IAC1BiC,EAAOsB,iBAAmB,IA/CtBnlE,EAAM6jE,EAAOthE,SAEb55C,KAAKy+G,iBAAiB7kH,EAAIshH,EAAOiB,UACjCn8G,KAAK09G,UAAUzlG,OAAOre,GACtBoG,KAAK29G,WAAW1lG,OAAOre,GA4C/B,GAER,CAIAwhH,MAAMxhH,GACFoG,KAAKulE,SAASm5C,aAAaC,MAC3B,MAAMzD,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAClC,IAAKshH,EACD,OAAO,EAEX,MAAM7jE,EAAMn+C,KAAKm+C,MACX+/D,EAAap3G,KAAK29G,WAAWh9G,IAAI/G,GAEvC,GAAIw9G,GAAcA,EAAWwH,WAAavnE,EACtC,OAAO+/D,EAAWgE,MAEtBp7G,KAAKulE,SAASs5C,YAAYF,MAC1B,MAAMvD,EAAQp7G,KAAKg7G,aAAaphH,EAAIshH,EAAQl7G,KAAK2yB,OAAQ3yB,KAAKm7G,SACxDyD,EAAavnE,EAAMr3C,KAAK89G,qBAS9B,OARI1G,GACAp3G,KAAKulE,SAASu5C,iBAAiBC,QAAQ9lH,KAAKkuB,IAAIi0F,EAAQhE,EAAWgE,QACnEhE,EAAWgE,MAAQA,EACnBhE,EAAWwH,WAAaA,GAGxB5+G,KAAK29G,WAAW9hH,IAAIjC,EAAI,CAAEwhH,QAAOwD,eAE9BxD,CACX,CAIA4D,WAAWplH,EAAI05C,EAAS2rE,GACpB,MAAM/D,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAC9BshH,IACAA,EAAOsB,kBAAoBlpE,EAC3BtzC,KAAKulE,SAAS25C,eAAeD,GAErC,CACAE,QAAQvlH,GAGJ,MAAMshH,EAAS,CACXoD,WAAW,EACX1kE,OAAQ,EACRo9D,OAAQ,CAAC,EACTmF,SAAU,IAAIznG,IACd8nG,iBAAkB,GAEtBx8G,KAAK09G,UAAU7hH,IAAIjC,EAAIshH,EAC3B,CAEAkE,MAAMxlH,EAAIwiH,GACN,MAAMlB,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAC9BshH,GACAA,EAAOiB,SAASnkG,IAAIokG,GAExBp8G,KAAKm7G,QAAQqC,aAAapB,GAAIpkG,IAAIpe,EACtC,CAEAylH,SAASzlH,EAAIwiH,GACT,MAAMlB,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAC9BshH,GACAA,EAAOiB,SAASlkG,OAAOmkG,GAE3B,MAAMkD,EAAct/G,KAAKm7G,QAAQx6G,IAAIy7G,GACjCkD,IACAA,EAAYrnG,OAAOre,GACM,IAArB0lH,EAAY7nH,MACZuI,KAAKm7G,QAAQljG,OAAOmkG,GAGhC,CACAmD,WAAW3lH,GACP,MAAMshH,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAClC,GAAKshH,EAAL,CAKA,GAAIl7G,KAAKo7G,MAAMxhH,GAAM,EAGjB,OAFAoG,KAAKy+G,iBAAiB7kH,EAAIshH,EAAOiB,eACjCn8G,KAAK09G,UAAUzlG,OAAOre,GAK1B8E,OAAOmU,QAAQqoG,EAAOlE,QAAQ52G,SAAQ,EAAEo2C,EAAO6kE,MAC3CA,EAAOO,uBAAyB,EAChC,MAAM5jC,EAAYh4E,KAAK2yB,OAAOqkF,OAAOxgE,GAAOsjE,+BAC5C,GAAIuB,EAAOG,QAAUH,EAAOQ,6BAA+BR,EAAOS,sBAAwB9jC,EAAW,CACjG,MAAM+jC,EAAU/jC,EAAYqjC,EAAOS,sBACnCT,EAAOW,oBAAsBD,EAAUA,CAC3C,CACAV,EAAOG,QAAS,EAChBH,EAAOQ,6BAA8B,CAAK,IAE9CX,EAAOoD,WAAY,EACnBpD,EAAOthE,OAAS1gD,KAAKm+C,MAAQr3C,KAAK2yB,OAAOumF,WArBzC,CAsBJ,CAEAv0D,MAAM/qD,EAAI48C,GACN,MAAM0kE,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAClC,GAAIshH,EAAQ,CACR,MAAMG,EAASr7G,KAAKw/G,eAAetE,EAAQ1kE,GACvC6kE,IAEAA,EAAOG,QAAS,EAChBH,EAAOmD,UAAYtlH,KAAKm+C,MACxBgkE,EAAOK,SAAW,EAClBL,EAAOQ,6BAA8B,EAE7C,CACJ,CAEAj3D,MAAMhrD,EAAI48C,GACN,MAAM0kE,EAASl7G,KAAK09G,UAAU/8G,IAAI/G,GAClC,GAAIshH,EAAQ,CACR,MAAMG,EAASr7G,KAAKw/G,eAAetE,EAAQ1kE,GAC3C,GAAI6kE,EAAQ,CAER,MAAMrjC,EAAYh4E,KAAK2yB,OAAOqkF,OAAOxgE,GAAOsjE,+BAC5C,GAAIuB,EAAOQ,6BAA+BR,EAAOS,sBAAwB9jC,EAAW,CAChF,MAAM+jC,EAAU/jC,EAAYqjC,EAAOS,sBACnCT,EAAOW,oBAAsBD,EAAUA,CAC3C,CACAV,EAAOQ,6BAA8B,EACrCR,EAAOG,QAAS,CAGpB,CACJ,CACJ,CACAiE,gBAAgBjJ,GACZx2G,KAAK49G,gBAAgBf,aAAarG,EACtC,CACAkJ,eAAel5G,EAAMgwG,EAAUhgE,GAC3Bx2C,KAAK2/G,yBAAyBn5G,EAAMgwC,GACpC,MAAMsmE,EAAO98G,KAAK49G,gBAAgBf,aAAarG,GACzCn/D,EAAMn+C,KAAKm+C,MAEbylE,EAAKnoG,SAAW+nG,GAAqB/mD,SAKzCmnD,EAAKnoG,OAAS+nG,GAAqB37C,MACnC+7C,EAAKvG,UAAYl/D,EACjBylE,EAAK13D,MAAMhlD,SAAS7E,IAGZA,IAAMiL,EAAK7B,YACX3E,KAAK4/G,6BAA6BrkH,EAAGi7C,EACzC,KAXA,GAAI,wFAAyFhwC,EAAM6wC,EAAMylE,EAAKC,cAAeL,GAAqBI,EAAKnoG,QAa/J,CAIAkrG,qBAAqBr5G,EAAMgwC,GACvBx2C,KAAK8/G,2BAA2Bt5G,EAAMgwC,EAC1C,CACAupE,cAAcv5G,EAAMgwG,EAAUhgE,EAAOu4B,GACjC,OAAQA,GAEJ,KAAK+oC,GAAav/G,MAEd,YADAyH,KAAK8/G,2BAA2Bt5G,EAAMgwC,GAG1C,KAAKshE,GAAakI,YACd,OAGR,MAAMlD,EAAO98G,KAAK49G,gBAAgBf,aAAarG,GAE/C,GAAIsG,EAAKnoG,SAAW+nG,GAAqB/mD,QAAzC,CAIA,GAAIoZ,IAAW+oC,GAAaK,OAIxB,OAFA2E,EAAKnoG,OAAS+nG,GAAqBuD,aACnCnD,EAAK13D,MAAM/1C,QAIfytG,EAAKnoG,OAAS+nG,GAAqBwD,QACnClgH,KAAK8/G,2BAA2Bt5G,EAAMgwC,GACtCsmE,EAAK13D,MAAMhlD,SAAS7E,IAChByE,KAAK8/G,2BAA2BvkH,EAAGi7C,EAAM,IAG7CsmE,EAAK13D,MAAM/1C,OAdX,MAFI,GAAI,yFAA0F7I,EAAMtN,KAAKm+C,MAAQylE,EAAKC,cAAeL,GAAqBI,EAAKnoG,QAiBvK,CACAwrG,iBAAiB35G,EAAMgwG,EAAUhgE,GAC7B,MAAMsmE,EAAO98G,KAAK49G,gBAAgBf,aAAarG,GAC/C,IAAIsG,EAAK13D,MAAMpqC,IAAIxU,GAInB,OAAQs2G,EAAKnoG,QACT,KAAK+nG,GAAqB/mD,QAGtBmnD,EAAK13D,MAAMptC,IAAIxR,GACf,MACJ,KAAKk2G,GAAqB37C,MAEtB+7C,EAAK13D,MAAMptC,IAAIxR,GACfxG,KAAK4/G,6BAA6Bp5G,EAAMgwC,EAAOsmE,EAAKvG,WACpD,MACJ,KAAKmG,GAAqBwD,QAEtBlgH,KAAK8/G,2BAA2Bt5G,EAAMgwC,GAE1C,KAAKkmE,GAAqBuD,SAIlC,CAIAH,2BAA2Bt5G,EAAMgwC,GAC7B,MAAM0kE,EAASl7G,KAAK09G,UAAU/8G,IAAI6F,GAClC,GAAI00G,EAAQ,CACR,MAAMG,EAASr7G,KAAKw/G,eAAetE,EAAQ1kE,GACvC6kE,IACAA,EAAOY,0BAA4B,EAE3C,CACJ,CAMA0D,yBAAyBn5G,EAAMgwC,GAC3B,MAAM0kE,EAASl7G,KAAK09G,UAAU/8G,IAAI6F,GAClC,GAAI00G,EAAQ,CACR,MAAMG,EAASr7G,KAAKw/G,eAAetE,EAAQ1kE,GAC3C,GAAI6kE,EAAQ,CACR,IAAI+E,EAAMpgH,KAAK2yB,OAAOqkF,OAAOxgE,GAAOkjE,0BACpC2B,EAAOO,uBAAyB3iH,KAAKyL,IAAI07G,EAAK/E,EAAOO,uBAAyB,GAC1EP,EAAOG,SACP4E,EAAMpgH,KAAK2yB,OAAOqkF,OAAOxgE,GAAOqjE,yBAChCwB,EAAOS,sBAAwB7iH,KAAKyL,IAAI07G,EAAK/E,EAAOS,sBAAwB,GAEpF,CACJ,CACJ,CAKA8D,6BAA6Bp5G,EAAMgwC,EAAO6pE,GACtC,MAAMnF,EAASl7G,KAAK09G,UAAU/8G,IAAI6F,GAClC,GAAI00G,EAAQ,CACR,MAAM7jE,OAAwB3vC,IAAlB24G,EAA8BnnH,KAAKm+C,MAAQ,EACjDgkE,EAASr7G,KAAKw/G,eAAetE,EAAQ1kE,GAC3C,GAAI6kE,GAAUA,EAAOG,OAAQ,CACzB,MAAM+C,EAAUv+G,KAAK2yB,OAAOqkF,OAAOxgE,GAInC,QAAsB9uC,IAAlB24G,EAA6B,CAC7B,MAAMC,EAAkBjpE,EAAMgpE,EACxBE,EAAiBD,EAAkB/B,EAAQxE,4BAEjD,GADA/5G,KAAKulE,SAASi7C,uBAAuBhqE,EAAO8pE,EAAiBC,GACzDA,EACA,MAER,CACA,MAAMH,EAAM7B,EAAQ1E,yBACpBwB,EAAOS,sBAAwB7iH,KAAKyL,IAAI07G,EAAK/E,EAAOS,sBAAwB,EAChF,CACJ,CACJ,CAIA2C,iBAAiB7kH,EAAI6mH,GACjB,IAAK,MAAMC,KAAcD,EAAa,CAClC,MAAME,EAAU3gH,KAAKm7G,QAAQx6G,IAAI+/G,GAC7BC,IACAA,EAAQ1oG,OAAOre,GACM,IAAjB+mH,EAAQlpH,MACRuI,KAAKm7G,QAAQljG,OAAOyoG,GAGhC,CACJ,CAKAlB,eAAetE,EAAQ1kE,GACnB,IAAIoqE,EAAa1F,EAAOlE,OAAOxgE,GAC/B,YAAmB9uC,IAAfk5G,EACOA,OAEuBl5G,IAA9B1H,KAAK2yB,OAAOqkF,OAAOxgE,IACnBoqE,EAAa,CACTpF,QAAQ,EACRgD,UAAW,EACX9C,SAAU,EACVE,uBAAwB,EACxBE,sBAAuB,EACvBD,6BAA6B,EAC7BG,mBAAoB,EACpBC,yBAA0B,GAE9Bf,EAAOlE,OAAOxgE,GAASoqE,EAChBA,GAEJ,IACX,EC7bG,MAAMC,GACTC,yBACA5K,aACA3wC,QAKA3wD,SAAW,IAAI0F,IAKfymG,eAAiB,IAAIzmG,IACrB0mG,qBACAlhH,YAAYghH,EAA0B5K,EAAc3wC,GAChDvlE,KAAK8gH,yBAA2BA,EAChC9gH,KAAKk2G,aAAeA,EACpBl2G,KAAKulE,QAAUA,EACfvlE,KAAKghH,qBAAuB,GAAKF,CACrC,CACIrpH,WACA,OAAOuI,KAAK4U,SAASnd,IACzB,CACIwpH,yBACA,OAAOjhH,KAAK+gH,eAAetpH,IAC/B,CAIAypH,WAAW16G,EAAM0wG,GAEb,MACMN,EAAQM,EADHj+G,KAAKiQ,MAAMjQ,KAAKy4B,SAAWwlF,EAAOjgH,SAEvCu/G,EAAWx2G,KAAKk2G,aAAaU,GACnC,IAAIuK,EAAenhH,KAAK4U,SAASjU,IAAI61G,GAChC2K,IACDA,EAAe,IAAI7mG,IACnBta,KAAK4U,SAAS/Y,IAAI26G,EAAU2K,IAEhC,MAAM9pE,EAAMn+C,KAAKm+C,MAEZ8pE,EAAanmG,IAAIxU,KAClB26G,EAAatlH,IAAI2K,EAAM6wC,EAAMr3C,KAAK8gH,0BAC9B9gH,KAAKulE,UACLvlE,KAAKulE,QAAQ67C,oBAAoBzC,IAAI,GAChC3+G,KAAK+gH,eAAe/lG,IAAIw7F,IACzBx2G,KAAK+gH,eAAellH,IAAI26G,EAAUn/D,IAIlD,CAMAgqE,oBACI,MAAMhqE,EAAMn+C,KAAKm+C,MACXz9B,EAAS,IAAIU,IACnB,IAAIgnG,EAAiB,EAmBrB,OAlBAthH,KAAK4U,SAASxU,SAAQ,CAAC+gH,EAAcvK,KACjCuK,EAAa/gH,SAAQ,CAACw5C,EAAQr+C,KAEtBq+C,EAASvC,IAETz9B,EAAO/d,IAAIN,GAAIqe,EAAOjZ,IAAIpF,IAAM,GAAK,GAErC4lH,EAAalpG,OAAO1c,GAEpB+lH,IACJ,IAGCH,EAAa1pH,MACduI,KAAK4U,SAASqD,OAAO2+F,EACzB,IAEJ52G,KAAKulE,SAASg8C,mBAAmB5C,IAAI2C,GAC9B1nG,CACX,CAIA8lG,eAAelJ,EAAUgL,GAAc,GACnCxhH,KAAKyhH,aAAajL,GAClB,MAAM2K,EAAenhH,KAAK4U,SAASjU,IAAI61G,GAEnC2K,IACAnhH,KAAK4U,SAASqD,OAAOu+F,GACjBx2G,KAAKulE,UACLvlE,KAAKulE,QAAQm8C,qBAAqB/C,IAAI,GAClC6C,GACAxhH,KAAKulE,QAAQo8C,kCAAkChD,IAAI,GACvD3+G,KAAKulE,QAAQq8C,0BAA0BjD,IAAIwC,EAAa1pH,OAGpE,CAKAsoH,cAAcvJ,EAAUznC,GACpB/uE,KAAKyhH,aAAajL,GAGVznC,IACC+oC,GAAav/G,OAGtByH,KAAK4U,SAASqD,OAAOu+F,EACzB,CACAnnG,QACIrP,KAAK4U,SAASvF,OAClB,CACAu1C,QACI,MAAMi9D,EAAQ3oH,KAAKm+C,MAAQr3C,KAAKghH,qBAChC,IAAI1vG,EAAQ,EACZ,IAAK,MAAO4B,EAAGqe,KAAMvxB,KAAK+gH,eAAeluG,UAAW,CAChD,KAAI0e,EAAIswF,GAQJ,MANA7hH,KAAK+gH,eAAe9oG,OAAO/E,GAC3B5B,GAOR,CACAtR,KAAKulE,SAASu8C,mBAAmBnD,IAAIrtG,EACzC,CACAmwG,aAAajL,GACT,GAAIx2G,KAAKulE,QAAS,CACd,MAAMw8C,EAAY/hH,KAAK+gH,eAAepgH,IAAI61G,QACxB9uG,IAAdq6G,IACA/hH,KAAKulE,QAAQy8C,yBAAyBjD,SAAS7lH,KAAKm+C,MAAQ0qE,GAAa,KACzE/hH,KAAK+gH,eAAe9oG,OAAOu+F,GAEnC,CACJ,EChJG,MAAMyL,GACTpvG,QAAU,IAAIyH,IACd4nG,WACApiH,YAAYiyC,GACR/xC,KAAKkiH,WAAanwE,EAAKmwE,UAG3B,CACIzqH,WACA,OAAOuI,KAAK6S,QAAQpb,IACxB,CAEAyW,IAAIC,EAAKtP,GACL,QAAImB,KAAK6S,QAAQmI,IAAI7M,KAQrBnO,KAAK6S,QAAQhX,IAAIsS,EAAK,CAAEtP,QAAOsjH,aAAcjpH,KAAKm+C,MAAQr3C,KAAKkiH,cACxD,EACX,CACAt9D,QACI,MAAMvN,EAAMn+C,KAAKm+C,MACjB,IAAK,MAAOnkC,EAAGqe,KAAMvxB,KAAK6S,QAAQA,UAAW,CACzC,KAAI0e,EAAE4wF,aAAe9qE,GAMjB,MALAr3C,KAAK6S,QAAQoF,OAAO/E,EAO5B,CACJ,CACA8H,IAAI7M,GACA,OAAOnO,KAAK6S,QAAQmI,IAAI7M,EAC5B,CACAxN,IAAIwN,GACA,MAAMtP,EAAQmB,KAAK6S,QAAQlS,IAAIwN,GAC/B,OAAOtP,GAASA,EAAMsjH,cAAgBjpH,KAAKm+C,MAAQx4C,EAAMA,WAAQ6I,CACrE,CACA2H,QACIrP,KAAK6S,QAAQxD,OACjB,ECjDG,IAAI+yG,GAKAC,GAgBAC,GAYAC,GAWAC,GAMAC,IAjDX,SAAWL,GACPA,EAAuB,QAAI,UAC3BA,EAAuB,QAAI,SAC9B,CAHD,CAGGA,KAAkBA,GAAgB,CAAC,IAEtC,SAAWC,GAEPA,EAAwB,OAAI,SAE5BA,EAAwB,OAAI,SAE5BA,EAA4B,WAAI,aAEhCA,EAA0B,SAAI,WAE9BA,EAA2B,UAAI,aAE/BA,EAA+B,cAAI,eACtC,CAbD,CAaGA,KAAoBA,GAAkB,CAAC,IAG1C,SAAWC,GAEPA,EAAgB,GAAI,eAEpBA,EAAsB,SAAI,YAE1BA,EAAmB,MAAI,QAEvBA,EAAoB,OAAI,QAC3B,CATD,CASGA,KAAgBA,GAAc,CAAC,IAGlC,SAAWC,GAEPA,EAA2B,aAAI,gBAE/BA,EAA4B,cAAI,iBAEhCA,EAA6B,eAAI,kBAEjCA,EAA2B,aAAI,eAClC,CATD,CASGA,KAAiBA,GAAe,CAAC,IAEpC,SAAWC,GACPA,EAA4B,SAAI,YAChCA,EAA4B,SAAI,YAChCA,EAA6B,UAAI,YACpC,CAJD,CAIGA,KAAsBA,GAAoB,CAAC,IAE9C,SAAWC,GACPA,EAAyB,SAAI,WAC7BA,EAAwB,QAAI,UAC5BA,EAAuB,OAAI,SAC3BA,EAAqB,KAAI,MAC5B,CALD,CAKGA,KAAmBA,GAAiB,CAAC,qBChDjC,MAAMC,GAAa,GAAqB,kBCLxC,SAASC,GAAkB17F,GAC9B,GAAiB,WAAbA,EAAI/X,KACJ,MAAM,IAAI3W,MAAM,gCAGpB,GAA0B,MAAtB0uB,EAAI27F,eACJ,MAAMrqH,MAAM,uBAEhB,MCGiB,EAAC4V,EAAKg2C,KACvB,MAAM0+D,EAAa,GAAqB1+D,EAAMx/C,SAAS,IAAI8yE,SAAS,GAAI,KAAM,UACxEm/B,EAAQ,IAAIp8G,WAAW2T,EAAIlX,OAAS4rH,EAAW5rH,QAGrD,OAFA2/G,EAAM/6G,IAAIsS,EAAK,GACfyoG,EAAM/6G,IAAIgnH,EAAY10G,EAAIlX,QACnB2/G,CAAK,EDRLA,CAAM3vF,EAAIzgB,KAAKwjD,UAAW/iC,EAAI27F,eACzC,CAIO3kH,eAAe6kH,GAAoB77F,GACtC,aAAa,UAAcA,EAAIxK,KACnC,CEpBO,SAASsmG,GAAoB9H,EAAMC,EAAQvoF,EAAQwoF,EAAS6H,GAC/D,IAAI5H,EAAQ,EACZ,MAAM6H,EAAU,IAAI3oG,IA8DpB,GA5DA5b,OAAOmU,QAAQqoG,EAAOlE,QAAQ52G,SAAQ,EAAEo2C,EAAO6kE,MAG3C,MAAM6H,EAAaF,EAAgBriH,IAAI61C,IAAU,UAC3C8kE,EAAc3oF,EAAOqkF,OAAOxgE,GAClC,QAAoB9uC,IAAhB4zG,EAEA,OAEJ,IAAI6H,EAAcF,EAAQtiH,IAAIuiH,GACzBC,IACDA,EAAc,CACVC,IAAK,EACLC,IAAK,EACLC,IAAK,EACLC,KAAM,EACNC,IAAK,GAETP,EAAQpnH,IAAIqnH,EAAYC,IAE5B,IAAIC,EAAM,EACNC,EAAM,EACNC,EAAM,EACNC,EAAO,EACPC,EAAM,EAEV,GAAInI,EAAOG,OAAQ,CAEf4H,GADWnqH,KAAKioB,IAAIm6F,EAAOK,SAAWJ,EAAYhC,kBAAmBgC,EAAY/B,eACrE+B,EAAYjC,gBAC5B,CAEA,IAAIsC,EAAKN,EAAOO,uBAMhB,GALID,EAAKL,EAAY5B,4BACjBiC,EAAKL,EAAY5B,2BAErB2J,GAAO1H,EAAKL,EAAY9B,6BAEpB6B,EAAOQ,6BACPR,EAAOS,sBAAwBR,EAAYxB,+BAAgC,CAC3E,MAAMiC,EAAUT,EAAYxB,+BAAiCuB,EAAOS,sBAEpEwH,GADWvH,EAAUA,EACTT,EAAY3B,2BAC5B,CAIA4J,GADYlI,EAAOW,mBACLV,EAAYrB,yBAI1BuJ,GADWnI,EAAOY,yBAA2BZ,EAAOY,yBACxCX,EAAYnB,+BAExBiB,IAAUgI,EAAMC,EAAMC,EAAMC,EAAOC,GAAOlI,EAAYlC,YACtD+J,EAAYC,KAAOA,EACnBD,EAAYE,KAAOA,EACnBF,EAAYG,KAAOA,EACnBH,EAAYI,MAAQA,EACpBJ,EAAYK,KAAOA,CAAG,IAGtB7wF,EAAO4lF,cAAgB,GAAK6C,EAAQzoF,EAAO4lF,cAAe,CAC1D6C,EAAQzoF,EAAO4lF,cAEf,MAAMkL,EAAO9wF,EAAO4lF,cAAgB6C,EACpC,IAAK,MAAMha,KAAM6hB,EAAQtnH,SACrBylG,EAAGgiB,KAAOK,EACVriB,EAAGiiB,KAAOI,EACVriB,EAAGkiB,KAAOG,EACVriB,EAAGmiB,MAAQE,EACXriB,EAAGoiB,KAAOC,CAElB,CACA,IAAIC,EAAM,EACNC,EAAM,EACNC,EAAM,EAGVF,GADW/wF,EAAO6lF,iBAAiByC,GACvBtoF,EAAO8lF,kBAEnByC,EAAOiB,SAAS/7G,SAASg8G,IACrB,GAAIzpF,EAAOimF,4BAA4B59F,IAAIohG,GACvC,OAKJ,MAAMC,EAAYlB,EAAQx6G,IAAIy7G,GACxBE,EAAeD,EAAYA,EAAU5kH,KAAO,EAClD,GAAI6kH,EAAe3pF,EAAOgmF,4BAA6B,CACnD,MAAM4D,EAAUD,EAAe3pF,EAAOgmF,4BAEtCgL,GADWpH,EAAUA,EACT5pF,EAAO+lF,wBACvB,KAMJ,OAFAkL,GADW1I,EAAOsB,iBAAmBtB,EAAOsB,iBAChC7pF,EAAOkmF,uBACnBuC,GAASsI,EAAMC,EAAMC,EACd,CACHX,UACAS,MACAC,MACAC,MACAxI,QAER,CC5GA,MAAMpsE,GACFr4C,OACAuQ,KACA4nC,IACAC,IACA1jC,KACAvL,YAAY+uC,GACR,KAAMA,EAAM,IAA4B,IAApBA,EAAM,EAAKA,GAC3B,MAAM,IAAIt2C,MAAM,qDAEpByH,KAAKrJ,OAAS,IAAIiC,MAAMi2C,GACxB7uC,KAAKkH,KAAO2nC,EAAM,EAClB7uC,KAAK8uC,IAAM,EACX9uC,KAAK+uC,IAAM,EACX/uC,KAAKqL,KAAO,IAChB,CACA3T,KAAK+kB,GACD,YAA8B/U,IAA1B1H,KAAKrJ,OAAOqJ,KAAK8uC,OAGrB9uC,KAAKrJ,OAAOqJ,KAAK8uC,KAAOryB,EACxBzc,KAAK8uC,IAAO9uC,KAAK8uC,IAAM,EAAK9uC,KAAKkH,MAC1B,EACX,CACA9H,QACI,MAAM5H,EAAOwI,KAAKrJ,OAAOqJ,KAAK+uC,KAC9B,QAAarnC,IAATlQ,EAKJ,OAFAwI,KAAKrJ,OAAOqJ,KAAK+uC,UAAOrnC,EACxB1H,KAAK+uC,IAAO/uC,KAAK+uC,IAAM,EAAK/uC,KAAKkH,KAC1B1P,CACX,CACA6uC,UACI,YAAiC3+B,IAA1B1H,KAAKrJ,OAAOqJ,KAAK+uC,IAC5B,EAEG,MAAMk5B,GACTxwE,KACAo3C,IACApjC,KACAC,KACA5L,YAAYsO,EAAU,CAAC,GACnBpO,KAAK6uC,IAAMzgC,EAAQ85D,YAAc,GACjCloE,KAAKyL,KAAO,IAAIujC,GAAUhvC,KAAK6uC,KAC/B7uC,KAAK0L,KAAO1L,KAAKyL,KACjBzL,KAAKvI,KAAO,CAChB,CACA0wE,cAAc7+D,GACV,OAAuB,MAAnBA,GAAKuD,WACEvD,EAAIuD,WAER,CACX,CACAnV,KAAK0T,GAID,GAHkB,MAAdA,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,SAEnCmB,KAAKyL,KAAK/T,KAAK0T,GAAM,CACtB,MAAM23B,EAAO/iC,KAAKyL,KAClBzL,KAAKyL,KAAOs3B,EAAK13B,KAAO,IAAI2jC,GAAU,EAAIhvC,KAAKyL,KAAK9U,OAAOM,QAC3D+I,KAAKyL,KAAK/T,KAAK0T,EACnB,CACJ,CACAhM,QACI,IAAIgM,EAAMpL,KAAK0L,KAAKtM,QACpB,QAAYsI,IAAR0D,GAAwC,MAAlBpL,KAAK0L,KAAKL,KAAe,CAC/C,MAAMA,EAAOrL,KAAK0L,KAAKL,KACvBrL,KAAK0L,KAAKL,KAAO,KACjBrL,KAAK0L,KAAOL,EACZD,EAAMpL,KAAK0L,KAAKtM,OACpB,CAIA,OAHkB,MAAdgM,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,QAEjCuM,CACX,CACAi7B,UACI,OAAOrmC,KAAKyL,KAAK46B,SACrB,EC9BG,MAAM,WAAmB9tC,MAC5B2W,KACAb,KACAvO,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EAEG,SAASi6D,GAASl6D,EAAU,CAAC,GAehC,OAAOg6D,IAdUzxE,IACb,MAAM0U,EAAO1U,EAAOyI,QACpB,GAAY,MAARiM,EACA,MAAO,CAAEgtB,MAAM,GAEnB,GAAkB,MAAdhtB,EAAK+U,MACL,MAAM/U,EAAK+U,MAEf,MAAO,CACHiY,MAAoB,IAAdhtB,EAAKgtB,KAEXx5B,MAAOwM,EAAKxM,MACf,GAEqBuP,EAC9B,CA4BA,SAASg6D,GAAUC,EAASj6D,GAExB,IAEIk6D,EACAC,EACAC,EAJAC,GADJr6D,EAAUA,GAAW,CAAC,GACFq6D,MAChB9xE,EAAS,IAAIsxE,GAIbS,GAAQ,UACZ,MAiCMC,EAAct9D,GACF,MAAVk9D,EACOA,EAAOl9D,IAElB1U,EAAOe,KAAK2T,GACLi9D,GAUL5wE,EAAQmH,IACV,GAAI2pE,EACA,OAAOF,EAGX,IAA4B,IAAxBl6D,GAASw6D,YAA4C,MAArB/pE,GAAOgO,WACvC,MAAM,IAAItU,MAAM,kEAEpB,OAAOowE,EAAW,CAAEtwC,MAAM,EAAOx5B,SAAQ,EAEvC8D,EAAOiD,GACL4iE,EACOF,GACXE,GAAQ,EACO,MAAP5iE,EAtBQ,CAACA,IACjBjP,EAAS,IAAIsxE,GACC,MAAVM,EACOA,EAAO,CAAEnoD,MAAOxa,KAE3BjP,EAAOe,KAAK,CAAE0oB,MAAOxa,IACd0iE,IAgBgBO,CAAYjjE,GAAO+iE,EAAW,CAAEtwC,MAAM,KAkDjE,GAvCAiwC,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KA3EapN,UACb,IACI,OAAKtH,EAAO0vC,UAGRmiC,EACO,CAAEnwC,MAAM,SAEN,IAAI7mB,SAAQ,CAACC,EAASC,KAC/B62D,EAAUl9D,IACNk9D,EAAS,KACT5xE,EAAOe,KAAK2T,GACZ,IACIoG,EAAQ42D,EAAQ1xE,GACpB,CACA,MAAOiP,GACH8L,EAAO9L,EACX,CACA,OAAO0iE,CAAQ,CAClB,IAhBMD,EAAQ1xE,EAkBvB,CACA,QACQA,EAAO0vC,WAGPtrB,gBAAe,KACX2tD,EAAMj3D,UACNi3D,GAAQ,SAAU,GAG9B,GA6CAv+B,OAZY,KACZxzC,EAAS,IAAIsxE,GACbtlE,IACO,CAAE01B,MAAM,IAUfywC,MARYljE,IACZjD,EAAIiD,GACG,CAAEyyB,MAAM,IAOf3gC,OACAiL,MACIomE,qBACA,OAAOpyE,EAAOc,IAClB,EACAuxE,QAAS/qE,MAAOmQ,IACZ,MAAM6Z,EAAS7Z,GAAS6Z,OAExB,GADAA,GAAQghD,iBACJtyE,EAAO0vC,UACP,OAEJ,IAAI/vB,EACAs1B,EACU,MAAV3jB,IACA3R,EAAS,IAAI9E,SAAQ,CAACC,EAASC,KAC3Bk6B,EAAW,KACPl6B,EAAO,IAAI,GAAa,EAE5BuW,EAAOE,iBAAiB,QAASyjB,EAAS,KAGlD,UACUp6B,QAAQo2D,KAAK,CACfc,EAAMn3D,QACN+E,GAER,CACA,QACoB,MAAZs1B,GAA8B,MAAV3jB,GACpBA,GAAQC,oBAAoB,QAAS0jB,EAE7C,IAGK,MAAT68B,EACA,OAAOH,EAEX,MAAMF,EAAYE,EAmClB,OAlCAA,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KAAI,IACO+8D,EAAU/8D,OAErBy9D,MAAMljE,IACFwiE,EAAUU,MAAMljE,GACH,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB8R,OAAM,KACFi+B,EAAUj+B,SACG,MAATs+B,IACAA,IACAA,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB3gC,OACAiL,IAAIiD,IACAwiE,EAAUzlE,IAAIiD,GACD,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL4gE,GAEPS,qBACA,OAAOX,EAAUW,cACrB,GAEGT,CACX,CCtQO,MAAM,WAAmB/vE,MAC5BuH,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EC6CG,SAASi5D,GAAgBnpE,EAAQ8pB,EAAQ7Z,GAC5C,MAAM2jC,EAAO3jC,GAAW,CAAC,EACnBwJ,ECpDH,SAAqBtO,GACxB,GAAW,MAAPA,EAAa,CACb,GAAoC,mBAAzBA,EAAI9S,OAAOohB,UAClB,OAAOtO,EAAI9S,OAAOohB,YAEtB,GAAyC,mBAA9BtO,EAAI9S,OAAOgc,eAClB,OAAOlJ,EAAI9S,OAAOgc,iBAEtB,GAAwB,mBAAblJ,EAAI+B,KACX,OAAO/B,CAEf,CACA,MAAM,IAAI/Q,MAAM,0CACpB,CDuCqBgvE,CAAYppE,GA+D7B,OA9DAF,kBACI,IAAIupE,EACJ,MAAMC,EAAe,KACO,MAApBD,GACAA,GAAkB,EAG1B,IADAv/C,EAAOE,iBAAiB,QAASs/C,KACpB,CACT,IAAI7tD,EACJ,IACI,GAAIqO,EAAOG,QAAS,CAChB,MAAM,aAAEs/C,EAAY,UAAEC,GAAc51B,EACpC,MAAM,IAAI,GAAW21B,EAAcC,EACvC,CACA,MAAMzvE,EAAQ,IAAIsZ,SAAQ,CAACC,EAASC,KAChC81D,EAAmB,KACf,MAAM,aAAEE,EAAY,UAAEC,GAAc51B,EACpCrgC,EAAO,IAAI,GAAWg2D,EAAcC,GAAW,CAClD,IAGL/tD,QAAepI,QAAQo2D,KAAK,CAAC1vE,EAAO0f,EAASvM,SAC7Cm8D,EAAmB,IACvB,CACA,MAAO5hE,GACHqiB,EAAOC,oBAAoB,QAASu/C,GAEpC,MAAMI,EAA8B,YAAbjiE,EAAIsJ,MAAsB+Y,EAAOG,QAMxD,GALIy/C,GAAmC,MAAhB91B,EAAK/pB,SAExB+pB,EAAK/pB,QAAQ7pB,GAGc,mBAApByZ,EAASuyB,OAChB,IACI,MAAM5uC,EAAIqc,EAASuyB,SACf5uC,aAAaiW,SACbjW,EAAEkyB,OAAM7nB,IACsB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EACvB,GAGZ,CACA,MAAOA,GACuB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EAE3B,CAEJ,GAAIiiE,IAAyC,IAAvB91B,EAAKg2B,cACvB,OAEJ,MAAMniE,CACV,CACA,IAAoB,IAAhBgU,EAAOye,KACP,YAEEze,EAAO/a,KACjB,CACAopB,EAAOC,oBAAoB,QAASu/C,EACxC,CACOO,EACX,gBEhHO,MAAM67C,GACTC,UACAx7C,SACA4F,gBACAw5B,cACA5nG,YAAYgkH,EAAWC,EAAahyE,GAChC/xC,KAAK8jH,UAAYA,EACjB9jH,KAAKsoE,SAAWA,GAAS,CAAEM,YAAY,IACvC5oE,KAAKkuE,gBAAkB,IAAInmD,gBAC3B/nB,KAAK0nG,cAAgB31D,EAAK21D,eAAiBt2F,KAC3C,QAAKk2D,GAAgBtnE,KAAKsoE,SAAUtoE,KAAKkuE,gBAAgBjmD,OAAQ,CAAE8/C,eAAe,KAAU5pE,IAAW,QAAOA,IAAS6B,KAAK8jH,WAAWr2F,MAAMs2F,EACjJ,CACI1+C,eAEA,OAAOrlE,KAAK8jH,UAAUz+C,QAC1B,CACA3tE,KAAK+kB,GACD,GAAIzc,KAAKsoE,SAASS,eAAiB/oE,KAAK0nG,cACpC,MAAMnvG,MAAM,sCAAsCyH,KAAK0nG,iBAE3D1nG,KAAKsoE,SAAS5wE,KAAK+kB,EACvB,CACAlN,QACIvP,KAAKkuE,gBAAgBh2E,QAErB8H,KAAKsoE,SAASn+B,SACdnqC,KAAK8jH,UAAUv0G,OACnB,EAEG,MAAMy0G,GACT7lH,OACA2lH,UACA51C,gBACApuE,YAAYgkH,EAAW/xE,EAAO,CAAC,GAC3B/xC,KAAK8jH,UAAYA,EACjB9jH,KAAKkuE,gBAAkB,IAAInmD,gBAC3B/nB,KAAK7B,OAASmpE,IAAgB,QAAKtnE,KAAK8jH,WAAY3lH,IAAW,QAAOA,EAAQ4zC,KAAQ/xC,KAAKkuE,gBAAgBjmD,OAAQ,CAC/G8/C,eAAe,GAEvB,CACAx4D,QACIvP,KAAKkuE,gBAAgBh2E,QACrB8H,KAAK8jH,UAAUv0G,OACnB,kBC9CG,MAAM00G,GAAyB,CAClCC,iBAAkB9yG,IAClB+yG,YAAa/yG,IACbgzG,mBAAoBhzG,IACpBizG,mBAAoBjzG,IACpBkzG,mBAAoBlzG,IACpBmzG,aAAcnzG,KAKX,SAASozG,GAAUjhH,EAAOwuC,GAG7BA,EAAO,IAAKA,GACZ,MAAMhhB,EAAI,iBAAuBxtB,GAC3BquB,EAAIruB,EAAMtM,OACVgoB,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACK/hB,EAAE4lC,eAAiB5lC,EAAE4lC,cAAcpsD,SACrCwmB,EAAE4lC,cAAgB,IAClB5lC,EAAE4lC,cAAcpsD,OAAS86C,EAAKmyE,iBAC9BzmG,EAAE4lC,cAAc3rD,KAAK+sH,GAAc1zF,EAAGA,EAAEjuB,WAExCiuB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACK/hB,EAAE+X,UAAY/X,EAAE+X,SAASv+B,SAC3BwmB,EAAE+X,SAAW,IACb/X,EAAE+X,SAASv+B,OAAS86C,EAAKoyE,YACzB1mG,EAAE+X,SAAS99B,KAAKgtH,GAAc3zF,EAAGA,EAAEjuB,WAEnCiuB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACD/hB,EAAE+lC,QAAUmhE,GAAqB5zF,EAAGA,EAAEjuB,SAAUivC,GAChD,MACJ,QACIhhB,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,CACA,SAASgnG,GAAc1zF,EAAGa,GACtB,MAAM3S,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACD/hB,EAAEumC,UAAYjzB,EAAE9tB,OAChB,MACJ,KAAK,EACDwa,EAAE+4B,MAAQzlB,EAAErtB,SACZ,MACJ,QACIqtB,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,CACA,SAASinG,GAAc3zF,EAAGa,GACtB,MAAM3S,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACD/hB,EAAEjX,KAAOuqB,EAAExtB,QACX,MACJ,KAAK,EACDka,EAAEhB,KAAOsU,EAAExtB,QACX,MACJ,KAAK,EACDka,EAAE0mC,MAAQpzB,EAAExtB,QACZ,MACJ,KAAK,EACDka,EAAE+4B,MAAQzlB,EAAErtB,SACZ,MACJ,KAAK,EACD+Z,EAAE2mC,UAAYrzB,EAAExtB,QAChB,MACJ,KAAK,EACDka,EAAEtP,IAAM4iB,EAAExtB,QACV,MACJ,QACIwtB,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,IAAK/hB,EAAE+4B,MACH,MAAMj+C,MAAM,4BAChB,OAAOklB,CACX,CACA,SAASknG,GAAqB5zF,EAAGa,EAAGmgB,GAChC,MAAM9yB,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACK/hB,EAAEgnC,OAAShnC,EAAEgnC,MAAMxtD,SACrBwmB,EAAEgnC,MAAQ,IACVhnC,EAAEgnC,MAAMxtD,OAAS86C,EAAKuyE,mBACtB7mG,EAAEgnC,MAAM/sD,KAAKktH,GAAmB7zF,EAAGA,EAAEjuB,SAAUivC,IAE/ChhB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACK/hB,EAAEinC,OAASjnC,EAAEinC,MAAMztD,SACrBwmB,EAAEinC,MAAQ,IACVjnC,EAAEinC,MAAMztD,OAAS86C,EAAKuyE,mBACtB7mG,EAAEinC,MAAMhtD,KAAKmtH,GAAmB9zF,EAAGA,EAAEjuB,SAAUivC,IAE/ChhB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACK/hB,EAAEknC,OAASlnC,EAAEknC,MAAM1tD,SACrBwmB,EAAEknC,MAAQ,IACVlnC,EAAEknC,MAAM1tD,OAAS86C,EAAKuyE,mBACtB7mG,EAAEknC,MAAMjtD,KAAKotH,GAAmB/zF,EAAGA,EAAEjuB,WAErCiuB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACK/hB,EAAEmnC,OAASnnC,EAAEmnC,MAAM3tD,SACrBwmB,EAAEmnC,MAAQ,IACVnnC,EAAEmnC,MAAM3tD,OAAS86C,EAAKuyE,mBACtB7mG,EAAEmnC,MAAMltD,KAAKqtH,GAAmBh0F,EAAGA,EAAEjuB,SAAUivC,IAE/ChhB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,QACIzO,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,CACA,SAASmnG,GAAmB7zF,EAAGa,EAAGmgB,GAC9B,MAAM9yB,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,SACd,MACJ,KAAK,EACK+Z,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,SAC/BwmB,EAAEwnC,WAAa,IACflT,EAAKqyE,sBAAuB,EAC5B3mG,EAAEwnC,WAAWvtD,KAAKq5B,EAAExtB,SAEpBwtB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,QACIzO,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,CACA,SAASonG,GAAmB9zF,EAAGa,EAAGmgB,GAC9B,MAAM9yB,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,GAAQ08B,IAAM,GACL,EACK/hB,EAAEwnC,YAAcxnC,EAAEwnC,WAAWhuD,SAC/BwmB,EAAEwnC,WAAa,IACflT,EAAKsyE,sBAAuB,EAC5B5mG,EAAEwnC,WAAWvtD,KAAKq5B,EAAExtB,SAEpBwtB,EAAEltB,SAAa,EAAJ27B,QAGfzO,EAAEltB,SAAa,EAAJ27B,EAGvB,CACA,OAAO/hB,CACX,CACA,SAASqnG,GAAmB/zF,EAAGa,GAC3B,MAAM3S,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,GAAQ08B,IAAM,GACL,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,cAGdqtB,EAAEltB,SAAa,EAAJ27B,EAGvB,CACA,OAAO/hB,CACX,CACA,SAASsnG,GAAmBh0F,EAAGa,EAAGmgB,GAC9B,MAAM9yB,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACD/hB,EAAEynC,QAAUn0B,EAAErtB,SACd,MACJ,KAAK,EACK+Z,EAAE2nC,OAAS3nC,EAAE2nC,MAAMnuD,SACrBwmB,EAAE2nC,MAAQ,IACVrT,EAAKwyE,gBAAiB,EACtB9mG,EAAE2nC,MAAM1tD,KAAKstH,GAAej0F,EAAGA,EAAEjuB,WAEjCiuB,EAAEltB,SAAa,EAAJ27B,GACf,MACJ,KAAK,EACD/hB,EAAE4nC,QAAUt0B,EAAE3sB,SACd,MACJ,QACI2sB,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,CACA,SAASunG,GAAej0F,EAAGa,GACvB,MAAM3S,OAAUvX,IAANkqB,EAAkBb,EAAE/0B,IAAM+0B,EAAE9uB,IAAM2vB,EACtCnU,EAAI,CAAC,EACX,KAAOsT,EAAE9uB,IAAMgd,GAAG,CACd,MAAMugB,EAAIzO,EAAEjuB,SACZ,OAAQ08B,IAAM,GACV,KAAK,EACD/hB,EAAEgoC,OAAS10B,EAAExtB,QACb,MACJ,KAAK,EACDka,EAAEioC,iBAAmB30B,EAAExtB,QACvB,MACJ,QACIwtB,EAAEltB,SAAa,EAAJ27B,GAGvB,CACA,OAAO/hB,CACX,yBClIA,IAAI,GArHJ,SAAemxC,EAAUvvD,GACvB,GAAIuvD,EAAS33D,QAAU,IAAO,MAAM,IAAI+N,UAAU,qBAElD,IADA,IAAI6pD,EAAW,IAAIr0D,WAAW,KACrB4jB,EAAI,EAAGA,EAAIywC,EAAS53D,OAAQmnB,IACnCywC,EAASzwC,GAAK,IAEhB,IAAK,IAAI9iB,EAAI,EAAGA,EAAIszD,EAAS33D,OAAQqE,IAAK,CACxC,IAAIge,EAAIs1C,EAAStkD,OAAOhP,GACpBwzD,EAAKx1C,EAAE9d,WAAW,GACtB,GAAqB,MAAjBqzD,EAASC,GAAe,MAAM,IAAI9pD,UAAUsU,EAAI,iBACpDu1C,EAASC,GAAMxzD,CACjB,CACA,IAAI2zC,EAAO2f,EAAS33D,OAChB83D,EAASH,EAAStkD,OAAO,GACzB0kD,EAAS/1D,KAAKN,IAAIs2C,GAAQh2C,KAAKN,IAAI,KACnCs2D,EAAUh2D,KAAKN,IAAI,KAAOM,KAAKN,IAAIs2C,GA6CvC,SAASigB,EAAc/wD,GACrB,GAAsB,iBAAXA,EAAuB,MAAM,IAAI6G,UAAU,mBACtD,GAAsB,IAAlB7G,EAAOlH,OAAgB,OAAO,IAAIuD,WACtC,IAAI20D,EAAM,EAEV,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAIA,IAFA,IAAIC,EAAS,EACTn4D,EAAS,EACNkH,EAAOgxD,KAASJ,GACrBK,IACAD,IAMF,IAHA,IAAI13D,GAAU0G,EAAOlH,OAASk4D,GAAOH,EAAU,IAAO,EAClDK,EAAO,IAAI70D,WAAW/C,GAEnB0G,EAAOgxD,IAAM,CAElB,IAAIG,EAAQT,EAAS1wD,EAAO3C,WAAW2zD,IAEvC,GAAc,MAAVG,EAAiB,OAErB,IADA,IAAIh0D,EAAI,EACCi0D,EAAM93D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAATs4D,EAAaA,IAAOj0D,IAC3Eg0D,GAAUrgB,EAAOogB,EAAKE,KAAU,EAChCF,EAAKE,GAAQD,EAAQ,MAAS,EAC9BA,EAASA,EAAQ,MAAS,EAE5B,GAAc,IAAVA,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACT6zD,GACF,CAEA,GAAoB,MAAhBhxD,EAAOgxD,GAAX,CAGA,IADA,IAAIK,EAAM/3D,EAAOR,EACVu4D,IAAQ/3D,GAAsB,IAAd43D,EAAKG,IAC1BA,IAIF,IAFA,IAAIC,EAAM,IAAIj1D,WAAW40D,GAAU33D,EAAO+3D,IACtCpxC,EAAIgxC,EACDI,IAAQ/3D,GACbg4D,EAAIrxC,KAAOixC,EAAKG,KAElB,OAAOC,CAX2B,CA5BA,CAwCpC,CAMA,MAAO,CACL1gD,OAhGF,SAAiB5Q,GAMf,GALIA,aAAkB3D,aAAuBqhB,YAAYC,OAAO3d,GAC9DA,EAAS,IAAI3D,WAAW2D,EAAOxH,OAAQwH,EAAO+d,WAAY/d,EAAO0O,YACxDjU,MAAMuJ,QAAQhE,KACvBA,EAAS3D,WAAWgM,KAAKrI,OAErBA,aAAkB3D,YAAe,MAAM,IAAIwK,UAAU,uBAC3D,GAAsB,IAAlB7G,EAAOlH,OAAgB,MAAO,GAMlC,IAJA,IAAIm4D,EAAS,EACTn4D,EAAS,EACTy4D,EAAS,EACTC,EAAOxxD,EAAOlH,OACXy4D,IAAWC,GAA2B,IAAnBxxD,EAAOuxD,IAC/BA,IACAN,IAMF,IAHA,IAAI33D,GAASk4D,EAAOD,GAAUT,EAAU,IAAO,EAC3CW,EAAM,IAAIp1D,WAAW/C,GAElBi4D,IAAWC,GAAM,CAItB,IAHA,IAAIL,EAAQnxD,EAAOuxD,GAEfp0D,EAAI,EACCu0D,EAAMp4D,EAAO,GAAc,IAAV63D,GAAeh0D,EAAIrE,KAAqB,IAAT44D,EAAaA,IAAOv0D,IAC3Eg0D,GAAU,IAAMM,EAAIC,KAAU,EAC9BD,EAAIC,GAAQP,EAAQrgB,IAAU,EAC9BqgB,EAASA,EAAQrgB,IAAU,EAE7B,GAAc,IAAVqgB,EAAe,MAAM,IAAI/2D,MAAM,kBACnCtB,EAASqE,EACTo0D,GACF,CAGA,IADA,IAAII,EAAMr4D,EAAOR,EACV64D,IAAQr4D,GAAqB,IAAbm4D,EAAIE,IACzBA,IAIF,IADA,IAAIz0D,EAAM0zD,EAAOgB,OAAOX,GACjBU,EAAMr4D,IAAQq4D,EAAOz0D,GAAOuzD,EAAStkD,OAAOslD,EAAIE,IACvD,OAAOz0D,CACT,EAsDE6zD,aAAcA,EACd9iD,OARF,SAAiB1I,GACf,IAAI/M,EAASu4D,EAAaxrD,GAC1B,GAAI/M,EAAU,OAAOA,EACrB,MAAM,IAAI4B,MAAM,OAAO8G,cACzB,EAMF,EAKA,GAFsC,GC5HxB,IAAI7E,WAAW,GAA7B,MAsCM,GAASuD,IACb,GAAIA,aAAavD,YAAqC,eAAvBuD,EAAE+B,YAAYT,KAAuB,OAAOtB,EAC3E,GAAIA,aAAa8d,YAAa,OAAO,IAAIrhB,WAAWuD,GACpD,GAAI8d,YAAYC,OAAO/d,GACrB,OAAO,IAAIvD,WAAWuD,EAAEpH,OAAQoH,EAAEme,WAAYne,EAAE8O,YAElD,MAAM,IAAItU,MAAM,oCAAmC,EC3BrD,MAAM,GAMJuH,YAAaT,EAAMma,EAAQy2C,GACzBjwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,CACpB,CAMAlhD,OAAQxL,GACN,GAAIA,aAAiB/I,WACnB,MAAO,GAAGwF,KAAKwZ,SAASxZ,KAAKiwD,WAAW1sD,KAExC,MAAMhL,MAAM,oCAEhB,EAkBF,MAAM,GAMJuH,YAAaT,EAAMma,EAAQ22C,GAIzB,GAHAnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,OAEgB9R,IAA1B8R,EAAO42C,YAAY,GACrB,MAAM,IAAI73D,MAAM,4BAGlByH,KAAKqwD,gBAAyC72C,EAAO42C,YAAY,GACjEpwD,KAAKmwD,WAAaA,CACpB,CAKA/jD,OAAQ0tB,GACN,GAAoB,iBAATA,EAAmB,CAC5B,GAAIA,EAAKs2B,YAAY,KAAOpwD,KAAKqwD,gBAC/B,MAAM93D,MAAM,qCAAqC2hC,KAAKuG,UAAU3G,OAAU95B,KAAKX,mDAAmDW,KAAKwZ,UAEzI,OAAOxZ,KAAKmwD,WAAWr2B,EAAKhhC,MAAMkH,KAAKwZ,OAAOviB,QAChD,CACE,MAAMsB,MAAM,oCAEhB,CAOA+3D,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,EAaF,MAAM,GAIJzwD,YAAa2wD,GACXzwD,KAAKywD,SAAWA,CAClB,CAOAH,GAAIC,GACF,OAAO,GAAGvwD,KAAMuwD,EAClB,CAMAnkD,OAAQrQ,GACN,MAAMyd,EAAgCzd,EAAM,GACtCw0D,EAAUvwD,KAAKywD,SAASj3C,GAC9B,GAAI+2C,EACF,OAAOA,EAAQnkD,OAAOrQ,GAEtB,MAAMiG,WAAW,qCAAqCk4B,KAAKuG,UAAU1kC,iCAAqC2C,OAAO+I,KAAKzH,KAAKywD,0BAE/H,EAUK,MAAM,GAAK,CAACC,EAAMC,IAAU,IAAI,GAA4C,IAC7ED,EAAKD,UAAY,CAAE,CAAmC,EAAOj3C,QAASk3C,MACtEC,EAAMF,UAAY,CAAE,CAAmC,EAAQj3C,QAASm3C,KAcvE,MAAM,GAOX7wD,YAAaT,EAAMma,EAAQy2C,EAAYE,GACrCnwD,KAAKX,KAAOA,EACZW,KAAKwZ,OAASA,EACdxZ,KAAKiwD,WAAaA,EAClBjwD,KAAKmwD,WAAaA,EAClBnwD,KAAK6wD,QAAU,IAAI,GAAQxxD,EAAMma,EAAQy2C,GACzCjwD,KAAKuwD,QAAU,IAAI,GAAQlxD,EAAMma,EAAQ22C,EAC3C,CAKAphD,OAAQhT,GACN,OAAOiE,KAAK6wD,QAAQ9hD,OAAOhT,EAC7B,CAKAqQ,OAAQrQ,GACN,OAAOiE,KAAKuwD,QAAQnkD,OAAOrQ,EAC7B,EAaK,MAAM,GAAO,EAAGsD,OAAMma,SAAQzK,SAAQ3C,YAC3C,IAAI,GAAM/M,EAAMma,EAAQzK,EAAQ3C,GAWrB,GAAQ,EAAGoN,SAAQna,OAAMmoB,eACpC,MAAM,OAAEzY,EAAM,OAAE3C,GAAW,GAAMob,EAAUnoB,GAC3C,OAAO,GAAK,CACVma,SACAna,OACA0P,SAIA3C,OAAQ0tB,GAAQ,GAAO1tB,EAAO0tB,KAC/B,EA4GU,GAAU,EAAGz6B,OAAMma,SAAQw3C,cAAaxpC,cAC5C,GAAK,CACVhO,SACAna,OACA0P,OAAQhT,GAjDG,EAAC0gB,EAAM+K,EAAUwpC,KAC9B,MAAMzyB,EAAwC,MAAlC/W,EAASA,EAASvwB,OAAS,GACjCiQ,GAAQ,GAAK8pD,GAAe,EAClC,IAAI/0D,EAAM,GAENsG,EAAO,EACP5L,EAAS,EACb,IAAK,IAAI2E,EAAI,EAAGA,EAAImhB,EAAKxlB,SAAUqE,EAMjC,IAJA3E,EAAUA,GAAU,EAAK8lB,EAAKnhB,GAC9BiH,GAAQ,EAGDA,EAAOyuD,GACZzuD,GAAQyuD,EACR/0D,GAAOurB,EAAStgB,EAAQvQ,GAAU4L,GAUtC,GALIA,IACFtG,GAAOurB,EAAStgB,EAAQvQ,GAAWq6D,EAAczuD,IAI/Cg8B,EACF,KAAQtiC,EAAIhF,OAAS+5D,EAAe,GAClC/0D,GAAO,IAIX,OAAOA,GAmBI,CAAOF,EAAOyrB,EAAUwpC,GAEjC5kD,OAAQrQ,GAzGG,EAAC2H,EAAQ8jB,EAAUwpC,EAAa3xD,KAG7C,MAAM4xD,EAAQ,CAAC,EACf,IAAK,IAAI31D,EAAI,EAAGA,EAAIksB,EAASvwB,SAAUqE,EACrC21D,EAAMzpC,EAASlsB,IAAMA,EAIvB,IAAIqH,EAAMe,EAAOzM,OACjB,KAA2B,MAApByM,EAAOf,EAAM,MAChBA,EAIJ,MAAM1G,EAAM,IAAIzB,WAAYmI,EAAMquD,EAAc,EAAK,GAGrD,IAAIzuD,EAAO,EACP5L,EAAS,EACTu6D,EAAU,EACd,IAAK,IAAI51D,EAAI,EAAGA,EAAIqH,IAAOrH,EAAG,CAE5B,MAAMuD,EAAQoyD,EAAMvtD,EAAOpI,IAC3B,QAAcoM,IAAV7I,EACF,MAAM,IAAIsyD,YAAY,OAAO9xD,eAI/B1I,EAAUA,GAAUq6D,EAAenyD,EACnC0D,GAAQyuD,EAGJzuD,GAAQ,IACVA,GAAQ,EACRtG,EAAIi1D,KAAa,IAAQv6D,GAAU4L,EAEvC,CAGA,GAAIA,GAAQyuD,GAAe,IAAQr6D,GAAW,EAAI4L,EAChD,MAAM,IAAI4uD,YAAY,0BAGxB,OAAOl1D,GA8DI,CAAOF,EAAOyrB,EAAUwpC,EAAa3xD,KClVrC,GAAW,GAAK,CAC3Bma,OAAQ,KACRna,KAAM,WACN0P,OAAShU,IAAQ,OFwDFuhB,EExDWvhB,GFwDN,IAAKg4D,aAAe3mD,OAAOkQ,GAAhCA,KExDe,EAC9BlQ,OAAS/Q,GFiDQA,KAAO,IAAK0d,aAAehK,OAAO1T,GEjDlC,CAAWA,KCLjB,GAAQ,GAAQ,CAC3Bme,OAAQ,IACRna,KAAM,QACNmoB,SAAU,KACVwpC,YAAa,ICJF,GAAQ,GAAQ,CAC3Bx3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,WACVwpC,YAAa,ICNF,GAAS,GAAM,CAC1Bx3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,eCDC,GAAS,GAAQ,CAC5BhO,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mBACVwpC,YAAa,IAGF,GAAc,GAAQ,CACjCx3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mBACVwpC,YAAa,ICbF,GAAS,GAAQ,CAC5Bx3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAc,GAAQ,CACjCx3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAiB,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAiB,GAAQ,CACpCx3C,OAAQ,IACRna,KAAM,iBACNmoB,SAAU,mCACVwpC,YAAa,IAGF,GAAe,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAoB,GAAQ,CACvCx3C,OAAQ,IACRna,KAAM,oBACNmoB,SAAU,oCACVwpC,YAAa,IAGF,GAAU,GAAQ,CAC7Bx3C,OAAQ,IACRna,KAAM,UACNmoB,SAAU,mCACVwpC,YAAa,IC5DF,GAAS,GAAM,CAC1Bx3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,yCAGC,GAAc,GAAM,CAC/BhO,OAAQ,IACRna,KAAM,cACNmoB,SAAU,yCCTC,GAAY,GAAM,CAC7BnoB,KAAM,YACNma,OAAQ,IACRgO,SAAU,+DAGC,GAAe,GAAM,CAChCnoB,KAAM,eACNma,OAAQ,IACRgO,SAAU,+DCPC,GAAS,GAAQ,CAC5BhO,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mEACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,oEACVwpC,YAAa,IAGF,GAAY,GAAQ,CAC/Bx3C,OAAQ,IACRna,KAAM,YACNmoB,SAAU,mEACVwpC,YAAa,IAGF,GAAe,GAAQ,CAClCx3C,OAAQ,IACRna,KAAM,eACNmoB,SAAU,oEACVwpC,YAAa,IC3BT,GAAWp4D,MAAM4N,KAAK,0eACtB,GAAgD,GAAS4oB,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAED,GAAK2jB,EAAU1jB,IAA4B,IAC5H,GAAgD,GAAS6zB,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAyB0jB,EAAEmxC,YAAY,IAAO90D,EAAUC,IAA4B,IA6BlK,MAAM,GAAe,GAAK,CAC/Bie,OAAQ,KACRna,KAAM,eACN0P,OA1BF,SAAiB0N,GACf,OAAOA,EAAK2S,QAAO,CAAC7zB,EAAG0jB,IACrB1jB,GAAK,GAAqB0jB,IAEzB,GACL,EAsBE7S,OAhBF,SAAiB/Q,GACf,MAAMs2D,EAAO,GACb,IAAK,MAAMn3C,KAAQnf,EAAK,CACtB,MAAMu2D,EAAM,GAA4Cp3C,EAAK41C,YAAY,IACzE,QAAY1oD,IAARkqD,EACF,MAAM,IAAIr5D,MAAM,+BAA+BiiB,KAEjDm3C,EAAKj6D,KAAKk6D,EACZ,CACA,OAAO,IAAIp3D,WAAWm3D,EACxB,IC/BA,IAAI,GAOJ,SAAS,EAAOhrB,EAAK1qC,EAAK/E,GACxB+E,EAAMA,GAAO,GAEb,IAAIi3D,EADJh8D,EAASA,GAAU,EAGnB,KAAMyvC,GAAO,IACX1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,GAAO,IAET,KAAMA,EAAM,IACV1qC,EAAI/E,KAAmB,IAANyvC,EAAc,GAC/BA,KAAS,EAMX,OAJA1qC,EAAI/E,GAAgB,EAANyvC,EAEd,EAAOpjC,MAAQrM,EAASg8D,EAAY,EAE7Bj3D,CACT,EAvBI,GAAM,IAEN,IAAS,IACT,GAAMhD,KAAK6qB,IAAI,EAAG,IAsBtB,IAAI,GAKJ,SAAS,EAAK/oB,EAAK7D,GACjB,IAIIolB,EAJA8C,EAAS,EAEThgB,EAAS,EACTisD,EAFAn0D,EAASA,GAAU,EAInB06B,EAAI72B,EAAI9D,OAEZ,EAAG,CACD,GAAIo0D,GAAWz5B,EAEb,MADA,EAAKruB,MAAQ,EACP,IAAIvB,WAAW,2BAEvBsa,EAAIvhB,EAAIswD,KACRjsC,GAAOhgB,EAAQ,IACVkd,EAAI,KAAWld,GACfkd,EAAI,IAAUrjB,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACX,OAASkd,GAAK,IAId,OAFA,EAAK/Y,MAAQ8nD,EAAUn0D,EAEhBkoB,CACT,EA1BI,GAAQ,IACR,GAAS,IA2Bb,IAAI,GAAKnmB,KAAK6qB,IAAI,EAAI,GAClB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IACjB,GAAK7qB,KAAK6qB,IAAI,EAAG,IAyBrB,GARa,CACT/U,OAAQ,GACR3C,OAAQ,GACR6nD,eAlBS,SAAUp1D,GACrB,OACEA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACbA,EAAQ,GAAK,EACA,EAEjB,GCzEO,MAUM,GAAW,CAACs1D,EAAK9hD,EAAQnb,EAAS,KAC7C,UAAci9D,EAAK9hD,EAAQnb,GACpBmb,GAOI,GAAkB8hD,GACtB,kBAAsBA,GCjBlB,GAAS,CAAC9lD,EAAMg8C,KAC3B,MAAM5yD,EAAO4yD,EAAOx9C,WACdunD,EAAa,GAAsB/lD,GACnCgmD,EAAeD,EAAa,GAAsB38D,GAElD8L,EAAQ,IAAI/I,WAAW65D,EAAe58D,GAK5C,OAJA,GAAgB4W,EAAM9K,EAAO,GAC7B,GAAgB9L,EAAM8L,EAAO6wD,GAC7B7wD,EAAM1H,IAAIwuD,EAAQgK,GAEX,IAAI,GAAOhmD,EAAM5W,EAAM4yD,EAAQ9mD,EAAK,EAuDtC,MAAM,GASXzD,YAAauO,EAAM5W,EAAM4yD,EAAQ9mD,GAC/BvD,KAAKqO,KAAOA,EACZrO,KAAKvI,KAAOA,EACZuI,KAAKqqD,OAASA,EACdrqD,KAAKuD,MAAQA,CACf,EC/EK,MAAM,GAAO,EAAGlE,OAAMgP,OAAMU,YAAa,IAAI,GAAO1P,EAAMgP,EAAMU,GAWhE,MAAM,GAOXjP,YAAaT,EAAMgP,EAAMU,GACvB/O,KAAKX,KAAOA,EACZW,KAAKqO,KAAOA,EACZrO,KAAK+O,OAASA,CAChB,CAMAs7C,OAAQtuD,GACN,GAAIA,aAAiBvB,WAAY,CAC/B,MAAMof,EAAS5Z,KAAK+O,OAAOhT,GAC3B,OAAO6d,aAAkBpf,WACrB,GAAcwF,KAAKqO,KAAMuL,GAEzBA,EAAO4T,MAAK68B,GAAU,GAAcrqD,KAAKqO,KAAMg8C,IACrD,CACE,MAAM9xD,MAAM,oCAGhB,EC1CF,MAAM,GAAM8G,GAIVpB,SAAc,IAAIzD,iBAAiBo6C,OAAO8f,OAAOrK,OAAOhrD,EAAMod,IAEnD,GAAS,GAAK,CACzBpd,KAAM,WACNgP,KAAM,GACNU,OAAQ,GAAI,aAGD,GAAS,GAAK,CACzB1P,KAAM,WACNgP,KAAM,GACNU,OAAQ,GAAI,aCfR,GAAS,GAQF,GAAW,CAAEV,KAZb,EAYiB,KAXjB,WAWuB,OAAQ,UAF5BtS,GAAU,GAVb,EAUiC,GAAOA,KCJxC,GAAO,MACP,GAAO,GAMP,GAAU0M,GAAS,GAAOA,GAM1B,GAAUgU,GAAS,GAAOA,GCfjC,GAAc,IAAI1D,YAClB,GAAc,IAAIg6C,YAEX,GAAO,OACP,GAAO,IAOP,GAAUtqD,GAAS,GAAYsG,OAAOmrB,KAAKuG,UAAUh4B,IAOrD,GAAUgU,GAASyd,KAAKlO,MAAM,GAAY5f,OAAOqQ,IC6BhD,IAAI6T,QAwBX,MAAM,GAQXxwB,YAAaopB,EAAS7a,EAAMkmD,EAAWhxD,GAErCvD,KAAKqO,KAAOA,EAEZrO,KAAKkpB,QAAUA,EAEflpB,KAAKu0D,UAAYA,EAEjBv0D,KAAKuD,MAAQA,EAKbvD,KAAK,KAAOuD,CACd,CAQI4xD,YACF,OAAOn1D,IACT,CAGIkc,iBACF,OAAOlc,KAAKuD,MAAM2Y,UACpB,CAGIrP,iBACF,OAAO7M,KAAKuD,MAAMsJ,UACpB,CAKAuoD,OACE,OAAQp1D,KAAKkpB,SACX,KAAK,EACH,OAA4D,KAE9D,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,UAAEkmD,GAAcv0D,KAE5B,GAAIqO,IAAS,oBACX,MAAM,IAAI9V,MAAM,4CAIlB,GAAIg8D,EAAUlmD,OAAS,qBACrB,MAAM,IAAI9V,MAAM,sDAGlB,OACE,GAAIg9D,SAC8C,EAGtD,CACA,QACE,MAAMh9D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAKAssC,OACE,OAAQx1D,KAAKkpB,SACX,KAAK,EAAG,CACN,MAAM,KAAE7a,EAAI,OAAEg8C,GAAWrqD,KAAKu0D,UACxBA,EAAYD,OAAO31D,OAAO0P,EAAMg8C,GACtC,OACE,GAAIoL,SAASz1D,KAAKqO,KAAMkmD,EAE5B,CACA,KAAK,EACH,OAAgD,KAElD,QACE,MAAMh8D,MACJ,+BAA+ByH,KAAKkpB,qDAI5C,CAMAlI,OAAQ00C,GACN,OAAO,GAAI10C,OAAOhhB,KAAM01D,EAC1B,CAWAz8C,cAAexT,EAAMiwD,GACnB,MAAMC,EACiE,EAGvE,OACEA,GACAlwD,EAAK4I,OAASsnD,EAAQtnD,MACtB5I,EAAKyjB,UAAYysC,EAAQzsC,SACzBorC,OAAOtzC,OAAOvb,EAAK8uD,UAAWoB,EAAQpB,UAE1C,CAMA5vD,SAAUkwD,GACR,OAAO,eAAO70D,KAAM60D,EACtB,CAEArzC,SACE,MAAO,CAAE,IAAK,eAAOxhB,MACvB,CAEA40D,OACE,OAAO50D,IACT,CAEY81D,IAAPt/D,OAAOs/D,eACV,MAAO,KACT,CAIA,CAACt/D,OAAOkqD,IAAI,iCACV,MAAO,OAAO1gD,KAAK2E,aACrB,CAoBAsU,aAAcld,GACZ,GAAa,MAATA,EACF,OAAO,KAGT,MAAM8C,EAA2B,EACjC,GAAIA,aAAiB,GAEnB,OAAOA,EACF,GAAmB,MAAdA,EAAM,MAAgBA,EAAM,OAASA,EAAM0E,OAAU1E,EAAMs2D,QAAUt2D,EAAO,CAMtF,MAAM,QAAEqqB,EAAO,KAAE7a,EAAI,UAAEkmD,EAAS,MAAEhxD,GAAU1E,EAC5C,OAAO,IAAI,GACTqqB,EACA7a,EACwC,EACxC9K,GAAS,kBAAU2lB,EAAS7a,EAAMkmD,EAAUhxD,OAEhD,CAAO,IAAyB,IAArB1E,EAAM,mBAAqB,CAIpC,MAAM,QAAEqqB,EAAO,UAAEqrC,EAAS,KAAElmD,GAASxP,EAC/BwrD,EAEHiK,OAAOloD,OAAOmoD,GACjB,OAAO,GAAI51D,OAAOuqB,EAAS7a,EAAMg8C,EACnC,CAGE,OAAO,IAEX,CAaApxC,cAAeiQ,EAAS7a,EAAMg8C,GAC5B,GAAoB,iBAATh8C,EACT,MAAM,IAAI9V,MAAM,yCAGlB,KAAM8xD,EAAO9mD,iBAAiB/I,YAC5B,MAAM,IAAIjC,MAAM,kBAGlB,OAAQ2wB,GACN,KAAK,EACH,GAAI7a,IAAS,oBACX,MAAM,IAAI9V,MACR,wCAAwC,uCAG1C,OAAO,IAAI,GAAI2wB,EAAS7a,EAAMg8C,EAAQA,EAAO9mD,OAGjD,KAAK,EAAG,CACN,MAAMA,EAAQ,kBAAU2lB,EAAS7a,EAAMg8C,EAAO9mD,OAC9C,OAAO,IAAI,GAAI2lB,EAAS7a,EAAMg8C,EAAQ9mD,EACxC,CACA,QACE,MAAM,IAAIhL,MAAM,mBAGtB,CASA0gB,gBAAiBoxC,GACf,OAAO,GAAI1rD,OAAO,EAAG,oBAAa0rD,EACpC,CAYApxC,gBAAiB5K,EAAMg8C,GACrB,OAAO,GAAI1rD,OAAO,EAAG0P,EAAMg8C,EAC7B,CAgBApxC,cAAe1V,GACb,MAAO0xD,EAAKgB,GAAa,GAAIC,YAAY3yD,GACzC,GAAI0yD,EAAUh/D,OACZ,MAAM,IAAIsB,MAAM,oBAElB,OAAO08D,CACT,CAkBAh8C,mBAAoB1V,GAClB,MAAM4yD,EAAQ,GAAIC,aAAa7yD,GACzB8yD,EAAaF,EAAM1+D,KAAO0+D,EAAMG,cAChCC,EAAiBvzB,OACrBz/B,EAAMjM,SAAS++D,EAAYA,EAAaF,EAAMG,gBAEhD,GAAIC,EAAe1pD,aAAespD,EAAMG,cACtC,MAAM,IAAI/9D,MAAM,oBAElB,MAAMi+D,EAAcD,EAAej/D,SACjC6+D,EAAMG,cAAgBH,EAAMM,YAExBpM,EAAS,IAAIiK,OAAOA,OACxB6B,EAAMO,cACNP,EAAMM,WACND,EACAD,GAMF,MAAO,CAHa,IAAlBJ,EAAMjtC,QACF,GAAIqsC,SAAyD,GAC7D,GAAIE,SAASU,EAAMQ,MAAOtM,GACa9mD,EAAMjM,SAAS6+D,EAAM1+D,MACpE,CAkBAwhB,oBAAqB29C,GACnB,IAAI1/D,EAAS,EACb,MAAMmU,EAAO,KACX,MAAO/P,EAAGrE,GAAUs/E,OAAOnqE,OAAOwqD,EAAat/D,SAASJ,IAExD,OADUD,EACHqE,GAGT,IAAI4tB,EAA4B7d,IAC5BsrD,EAAyB,oBAS7B,GARuC,KAAd,GAEI,EAClB,GAEiBtrD,IAGZ,IAAZ6d,GAA6B,IAAZA,EACnB,MAAM,IAAIlnB,WAAW,uBAAuBknB,KAG9C,MAAMmtC,EAAan/D,EACbw/D,EAAkCrrD,IAClCorD,EAAaprD,IACb5T,EAAOP,EAASu/D,EAGtB,MAAO,CAAEvtC,UAASytC,QAAOD,gBAAeD,aAAYH,cAF9B7+D,EAAO4+D,EAEsC5+D,OACrE,CAiBAwhB,aAAc9a,EAAQ02D,GACpB,MAAOr7C,EAAQjW,GAAS,wBAAgBpF,EAAQ02D,GAE1CI,EAAM,GAAI7oD,OAAO7I,GAEvB,GAAoB,IAAhB0xD,EAAI/rC,SAA+B,MAAd/qB,EAAO,GAC9B,MAAM5F,MAAM,0DAMd,OAFA,kBAAU08D,GAAKp5D,IAAI2d,EAAQrb,GAEpB82D,CACT,EAqGgBz+D,OAAOkqD,IAAI,oBAxF7B,MCveM,GAAQ,IAAK,KAAiB,KAAU,KAAU,KAAW,KAAW,KAAW,KAAW,KAAW,KAAW,GCJnH,SAAS,GAAYjpD,EAAO,GAC/B,OAAsC,MAAlCqwB,WAAW1lB,QAAQ8I,YCbpB,SAAsBnQ,GACzB,OAAyB,MAArB+sB,WAAW1lB,OACJ,IAAI5H,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAEnD9R,CACX,CDSe,CAAa+sB,WAAW1lB,OAAO8I,YAAYzT,IAE/C,IAAI+C,WAAW/C,EAC1B,CEnBA,SAAS,GAAY4H,EAAMma,EAAQzK,EAAQ3C,GACvC,MAAO,CACH/M,OACAma,SACAq3C,QAAS,CACLxxD,OACAma,SACAzK,UAEJwhD,QAAS,CACLnkD,UAGZ,CACA,MAAM,GAAS,GAAY,OAAQ,KAAMrR,GAE9B,IADS,IAAIg4D,YAAY,QACX3mD,OAAOrR,KAC5BM,IACgB,IAAI0d,aACLhK,OAAO1T,EAAIoE,UAAU,MAElC,GAAQ,GAAY,QAAS,KAAM1E,IACrC,IAAI2I,EAAS,IACb,IAAK,IAAIpI,EAAI,EAAGA,EAAIP,EAAI9D,OAAQqE,IAC5BoI,GAAUvM,OAAOC,aAAa2D,EAAIO,IAEtC,OAAOoI,CAAM,IACbrI,IAEA,MAAMN,EAAM,IADZM,EAAMA,EAAIoE,UAAU,IACQxI,QAC5B,IAAK,IAAIqE,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC5BP,EAAIO,GAAKD,EAAIG,WAAWF,GAE5B,OAAOP,CAAG,IAWd,OATc,CACV6G,KAAM,GACN,QAAS,GACTu1D,IAAK,UACLC,OAAQ,GACRF,MAAO,GACPG,OAAQ,MACL,ICpCA,SAAS,GAASx6C,EAAO5R,EAAW,QACvC,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKhE,QAAQ9hD,OAAO8N,GAAOpd,UAAU,GAHjCqoB,WAAW1lB,OAAOoE,KAAKqW,EAAMlmB,OAAQkmB,EAAMX,WAAYW,EAAMhQ,YAAYlI,SAAS,OAIjG,iBCfO,MAwDM,GAAW,SAAU5J,EAAK7D,EAAS,EAAGD,GAC/CC,IAAWA,EACXD,EAASA,GAAW8D,EAAI9D,OAASC,EACjC,MAAM0E,EAAO,IAAI+9B,SAAS5+B,EAAIpE,QAC9B,GAAe,IAAXM,EAAc,CACd,MAAM2iB,EAAS,GAEf,IAAK,IAAIte,EAAI,EAAGA,EAAIrE,EAAQqE,IACxBse,EAAOliB,KAAKqD,EAAI7D,EAASoE,IAE7B,OAAOse,EAAOjiB,KAAK,IACvB,CACA,GAAe,KAAXV,EAAe,CACf,MAAM2iB,EAAS,GAEf,IAAK,IAAIte,EAAI,EAAGA,EAAIrE,EAAQqE,GAAK,EAC7Bse,EAAOliB,KAAKkE,EAAK+yD,UAAUz3D,EAASoE,GAAGqJ,SAAS,KAEpD,OAAOiV,EAAOjiB,KAAK,KACd8I,QAAQ,qBAAsB,UAC9BA,QAAQ,SAAU,KAC3B,CACA,MAAO,EACX,EClFMwkH,IAAK,EACE,GAAQ,CAAC,EACT,GAAQ,CAAC,EAwEf,SAAS,GAAYhlG,GACxB,GAAqB,iBAAVA,EAAoB,CAC3B,GAAoB,MAAhB,GAAMA,GACN,OAAO,GAAMA,GAEjB,MAAM,IAAI1nB,MAAM,0BAA0B0nB,IAC9C,CACK,GAAqB,iBAAVA,EAAoB,CAChC,GAAoB,MAAhB,GAAMA,GACN,OAAO,GAAMA,GAEjB,MAAM,IAAI1nB,MAAM,0BAA0B0nB,IAC9C,CACA,MAAM,IAAI1nB,MAAM,oCAAoC0nB,EACxD,CArFqB,CACjB,CAAC,EAAG,GAAI,OACR,CAAC,EAAG,GAAI,OACR,CAAC,GAAI,GAAI,QACT,CAAC,GAAI,IAAK,OACV,CAAC,GAAIglG,GAAG,WACR,CAAC,GAAI,EAAG,UACR,CAAC,GAAIA,GAAG,OAAO,GACf,CAAC,GAAIA,GAAG,QAAQ,GAChB,CAAC,GAAIA,GAAG,QAAQ,GAChB,CAAC,GAAIA,GAAG,WAAW,GACnB,CAAC,IAAK,GAAI,QACV,CAAC,IAAK,GAAI,OACV,CAAC,IAAK,EAAG,mBACT,CAAC,IAAK,EAAG,qBACT,CAAC,IAAK,EAAG,gBACT,CAAC,IAAK,EAAG,iBACT,CAAC,IAAK,EAAG,UACT,CAAC,IAAK,EAAG,eACT,CAAC,IAAK,EAAG,OACT,CAAC,IAAK,EAAG,OACT,CAAC,IAAKA,GAAG,QAAQ,GAAO,GAIxB,CAAC,IAAKA,GAAG,QAET,CAAC,IAAKA,GAAG,OACT,CAAC,IAAK,EAAG,SACT,CAAC,IAAK,GAAI,SACV,CAAC,IAAK,IAAK,UACX,CAAC,IAAKA,GAAG,YACT,CAAC,IAAK,EAAG,OACT,CAAC,IAAKA,GAAG,OACT,CAAC,IAAK,EAAG,QACT,CAAC,IAAK,EAAG,WACT,CAAC,IAAK,EAAG,gBACT,CAAC,IAAKA,GAAG,YACT,CAAC,IAAK,EAAG,MACT,CAAC,IAAK,EAAG,OACT,CAAC,IAAK,EAAG,sBACT,CAAC,IAAK,EAAG,QACT,CAAC,IAAKA,GAAG,WAGP7kH,SAAQ28C,IACV,MAAM98B,EAIH,SAAwB5R,EAAM5W,EAAM4H,EAAM6lH,EAAYl2F,GACzD,MAAO,CACH3gB,OACA5W,OACA4H,OACA6lH,WAAYhgH,QAAQggH,GACpBl2F,KAAM9pB,QAAQ8pB,GAEtB,CAZkBm2F,IAAkBpoE,GAChC,GAAM98B,EAAM5R,MAAQ4R,EACpB,GAAMA,EAAM5gB,MAAQ4gB,CAAK,IClCT,GAAY,OACZ,GAAY,OACT,GAAY,UAY5B,SAASmlG,GAAgBnlG,EAAOllB,GAEnC,OADiB,GAAYklB,GACZ5R,MACb,KAAK,EACL,KAAK,GACD,OA0FZ,SAAkBg3G,GACd,MAAMC,EAAW,GAAYD,EAAQ,EAAGA,EAAOpuH,QAC/C,GAAgB,MAAZquH,EACA,MAAM,IAAI/sH,MAAM,sBAEpB,IAAK,MAAQ+sH,GACT,MAAM,IAAI/sH,MAAM,sBAEpB,OAAO+sH,CACX,CAnGmBC,CAASxqH,GACpB,KAAK,GAOL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,IACL,KAAK,IACL,KAAK,IACD,OAAOyqH,GAAUzqH,GAZrB,KAAK,EACL,KAAK,IACL,KAAK,GACL,KAAK,IACD,OAAO0qH,GAAW1qH,GAAK4J,WAS3B,KAAK,IACD,OAsIZ,SAAkB5J,GACd,MAAMtD,EAAO,MAAcsD,GACrBq7B,EAAUr7B,EAAIjC,MAAM,MAAsBrB,IAChD,GAAI2+B,EAAQn/B,SAAWQ,EACnB,MAAM,IAAIc,MAAM,wBAEpB,OAAO,GAAmB69B,EAAS,YACvC,CA7ImBsvF,CAAS3qH,GACpB,KAAK,IAEL,KAAK,IACD,OAAO4qH,GAAY5qH,GACvB,KAAK,IACD,OAqHZ,SAAkBA,GACd,MAAMtD,EAAO,MAAcsD,GACrBuE,EAAOvE,EAAIjC,MAAM,MAAsBrB,IAC7C,GAAI6H,EAAKrI,SAAWQ,EAChB,MAAM,IAAIc,MAAM,wBAEpB,MAAO,IAAM,GAAmB+G,EAAM,YAC1C,CA5HmBsmH,CAAS7qH,GACpB,QACI,OAAO,GAAmBA,EAAK,UAE3C,CAmDA,MAAM01D,GAAW/xD,OAAO/C,OAAO,IAAOif,KAAKqE,GAAMA,EAAEsxC,WAC5B,WACnB,IAAIz+C,EAAM2+C,GAAS,GAAGH,GAAGG,GAAS,IAClCA,GAAS33D,MAAM,GAAGsH,SAAS28B,GAAOjrB,EAAMA,EAAIw+C,GAAGvzB,IAElD,CAJsB,GA2BvB,SAAS0oF,GAAW1qH,GAEhB,OADa,IAAI4+B,SAAS5+B,EAAIpE,QAClBg4D,UAAU5zD,EAAImhB,WAC9B,CAMA,SAASspG,GAAUzqH,GACf,MAAMtD,EAAO,MAAcsD,GAE3B,IADAA,EAAMA,EAAIjC,MAAM,MAAsBrB,KAC9BR,SAAWQ,EACf,MAAM,IAAIc,MAAM,wBAEpB,OAAO,GAAmBwC,EAC9B,CAyEA,SAAS4qH,GAAY5qH,GACjB,MAAM8qH,EAAY9qH,EAAIjC,MAAM,EAAGiC,EAAI9D,OAAS,GACtC6uH,EAAY/qH,EAAIjC,MAAMiC,EAAI9D,OAAS,GAGzC,MAAO,GAFM,GAAmB4uH,EAAW,aAC9BJ,GAAWK,IAE5B,CCxOA,IAAIC,IACJ,SAAWA,GACPA,EAASA,EAAc,IAAI,GAAK,MAChCA,EAASA,EAAc,IAAI,IAAM,KACpC,CAHD,CAGGA,KAAaA,GAAW,CAAC,ICgB5B,IAAIC,IACJ,SAAWA,GACPA,EAAiBA,EAA0B,QAAI,GAAK,UACpDA,EAAiBA,EAA0B,QAAI,GAAK,SACvD,CAHD,CAGGA,KAAqBA,GAAmB,CAAC,IACrC,MAAMC,WAAkB,KAI3BC,sBACAC,YAAc,CAAC,GAA0B,IACzCC,cACAC,cAEAjhE,MAAQ,IAAI1wC,IACZ4xG,eAAiB,IAAIhsG,IACrBisG,gBAAkB,IAAIjsG,IAEtBksG,sBAAwBl+C,GAAS,CAAEM,YAAY,IAE/C69C,OAAS,IAAI/xG,IAEbgyG,cAAgB,IAAIhyG,IAEpBiyG,UAIAC,oBAAsB,IAAItsG,IAI1B08F,OAAS,IAAI18F,IAIb+oC,cAAgB,IAAI3uC,IAKpBmyG,KAAO,IAAIvsG,IAKXq3D,OAAS,IAAIr3D,IAKbwsG,cAAgB,IAAIxsG,IAKpB07F,OAAS,IAAI17F,IAKbkpC,QAAU,IAAIlpC,IAIdysG,SAAW,IAAIzsG,IAEf0sG,OAAS,IAAI1sG,IAEb+qC,QAAU,IAAI/qC,IAKd2sG,SAAW,IAAI3sG,IACf4sG,QAIAC,YACAjR,aAEAkR,eAKAC,oBAIAC,OAEAlM,MAOAmM,gBAAkB,IAAIjtG,IAItB3hB,IAKA6uH,eAAiB,EAIjBC,aACAzjC,WACA0jC,kBAAoB,KACpBzuG,kBAAoB,GAEpB84B,KACA41E,gBACApiD,QACA5wD,OAAS,CAAEtG,KAAM23G,GAAiB4B,SAClC39C,kBACAC,mBACA29C,cACAC,eAAiB,KACjBhoH,YAAYkkF,EAAY51E,EAAU,CAAC,GAC/BuE,QACA,MAAMo/B,EAAO,CACTg2E,oBAAoB,EACpBC,cAAc,EACdC,MAAM,EACNC,YAAa,GACblrF,EhFzIc,EgF0IdmrF,IhFpIgB,EgFqIhBC,IhFhIgB,GgFiIhBC,OhF3HmB,EgF4HnBC,KhFnHiB,EgFoHjBC,MhF5FkB,EgF6FlBC,kBhFvE8BC,IgFwE9BC,UhFlEsBC,IgFmEtBC,ahFjH0B,EgFkH1BC,ahFvG0B,EgFwG1BC,QhFeoB,KgFdpBhI,yBhFU8B,IgFT9BiI,WhFhEuB,GgFiEvBC,ahFxDyBL,IgFyDzBM,kBhFrD+B,IgFsD/BC,oBhFZgC,IgFahCC,wBhFlBoC,EgFmBpCC,wBhFvBoC,GgFwBpCC,mBhFnC+B,OgFoC5Bj7G,EACHk7G,YAAajP,GAAsBjsG,EAAQk7G,aAC3CC,gBAAiBxO,GAA0B3sG,EAAQm7G,kBAgBvD,GAdAvpH,KAAKgkF,WAAaA,EAClBhkF,KAAK2nH,gBAAkB51E,EAAK41E,iBAAmB1D,GAC/CjkH,KAAKkmH,sBAAwBn0E,EAAKm0E,uBAAyB,MAEvDn0E,EAAKg2E,oBACL/nH,KAAKmmH,YAAYzuH,KAAK,IAG1BsI,KAAKrH,IAAM,GAAOo5C,EAAKy3E,WAAa,oBAEpCxpH,KAAK+xC,KAAOA,EACZ/xC,KAAKymH,OAAS,IAAI/xG,IAAIq9B,EAAKm2E,YAAYttG,KAAKrf,GAAMA,EAAE3B,GAAG+K,cACvD3E,KAAK2mH,UAAY,IAAI1E,GAAgB,CAAEC,WAAYnwE,EAAK+2E,UACxD9oH,KAAKqnH,oBAAsB,IAAIpF,GAAgB,CAAEC,WAAYnwE,EAAK+2E,UAC9D16G,EAAQ84G,QAERlnH,KAAKknH,QAAU94G,EAAQ84G,aAGvB,OAAQlnH,KAAKkmH,uBACT,KAAK,MACDlmH,KAAKknH,QAAUvE,GACf,MACJ,KAAK,MACD3iH,KAAKknH,QAAUpE,GAc3B,GAVI10G,EAAQ+4G,cACRnnH,KAAKmnH,YAAc/4G,EAAQ+4G,YAC3BnnH,KAAKonH,eAAiB,IAAInF,GAAgB,CAAEC,WAAYnwE,EAAK+2E,WAGjE9oH,KAAKk2G,aAAe9nG,EAAQ8nG,cAAgBwB,GAC5C13G,KAAKsnH,OAASl5G,EAAQq7G,cAAgB,IAAI1T,GAAahkE,EAAK82E,aAAc92E,EAAK62E,aAAc5oH,KAAKk2G,cAC9F9nG,EAAQi4G,gBACRrmH,KAAKqmH,cAAgBj4G,EAAQi4G,eAE7Bj4G,EAAQs7G,gBAAiB,CACzB,IAAKt7G,EAAQu7G,uBACT,MAAMpxH,MAAM,gDAKhB,MAAMqxH,EAAmC3wH,KAAKioB,OAAOxiB,OAAO/C,OAAOo2C,EAAKu3E,YAAYtS,QAAQp8F,KAAKivG,GAAeA,EAAW9P,8BhFrBzE,KgFsB5Cx0C,E3ClKX,SAAoBn0C,EAAU4xF,EAAiBjxE,GAElD,MAAO,CAEH+3E,iBAAkB14F,EAAS24F,MAAM,CAC7B1qH,KAAM,qBACNumE,KAAM,8BACNokD,WAAY,CAAC,cAMjBC,wBAAyB74F,EAAS24F,MAAM,CACpC1qH,KAAM,sCACNumE,KAAM,2CACNokD,WAAY,CAAC,cAIjBE,gBAAiB94F,EAAS24F,MAAM,CAC5B1qH,KAAM,6BACNumE,KAAM,2CACNokD,WAAY,CAAC,cAMjBG,eAAgB/4F,EAAS24F,MAAM,CAC3B1qH,KAAM,4BACNumE,KAAM,8BACNokD,WAAY,CAAC,cAIjBI,8BAA+Bh5F,EAAS24F,MAAM,CAC1C1qH,KAAM,oDACNumE,KAAM,sEACNokD,WAAY,CAAC,WAEjBK,8BAA+Bj5F,EAAS24F,MAAM,CAC1C1qH,KAAM,oDACNumE,KAAM,sEACNokD,WAAY,CAAC,WAEjBM,kCAAmCl5F,EAAS24F,MAAM,CAC9C1qH,KAAM,wDACNumE,KAAM,0EACNokD,WAAY,CAAC,WAEjBO,gCAAiCn5F,EAAS24F,MAAM,CAC5C1qH,KAAM,sDACNumE,KAAM,wEACNokD,WAAY,CAAC,WAEjBQ,iCAAkCp5F,EAAS24F,MAAM,CAC7C1qH,KAAM,wDACNumE,KAAM,0EACNokD,WAAY,CAAC,WAEjBS,qCAAsCr5F,EAAS24F,MAAM,CACjD1qH,KAAM,2DACNumE,KAAM,6EACNokD,WAAY,CAAC,WAEjBU,+BAAgCt5F,EAAS24F,MAAM,CAC3C1qH,KAAM,qDACNumE,KAAM,uEACNokD,WAAY,CAAC,WAIjBW,gCAAiCv5F,EAAS24F,MAAM,CAC5C1qH,KAAM,iDACNumE,KAAM,2EACNokD,WAAY,CAAC,WAEjBY,4BAA6Bx5F,EAAS24F,MAAM,CACxC1qH,KAAM,8CACNumE,KAAM,wEACNokD,WAAY,CAAC,WAEjBa,yBAA0Bz5F,EAAS24F,MAAM,CACrC1qH,KAAM,0CACNumE,KAAM,oEACNokD,WAAY,CAAC,WAEjBc,0BAA2B15F,EAAS24F,MAAM,CACtC1qH,KAAM,2CACNumE,KAAM,qEACNokD,WAAY,CAAC,WAEjBe,2BAA4B35F,EAAS24F,MAAM,CACvC1qH,KAAM,4CACNumE,KAAM,sEACNokD,WAAY,CAAC,WAMjBgB,iBAAkB55F,EAAS24F,MAAM,CAC7B1qH,KAAM,qCACNumE,KAAM,iCACNokD,WAAY,CAAC,cAGjBiB,kBAAmB75F,EAAS85F,UAAU,CAClC7rH,KAAM,uCACNumE,KAAM,+DAENulD,QAAS,CAAC,IAAM,GAAK,KAGzBC,iBAAkBh6F,EAAS24F,MAAM,CAC7B1qH,KAAM,8BACNumE,KAAM,yEAKVylD,sBAAuBj6F,EAAS24F,MAAM,CAClC1qH,KAAM,oCACNumE,KAAM,yCACNokD,WAAY,CAAC,WAEjBsB,qBAAsBl6F,EAAS24F,MAAM,CACjC1qH,KAAM,mCACNumE,KAAM,wCACNokD,WAAY,CAAC,WAEjBuB,sBAAuBn6F,EAAS24F,MAAM,CAClC1qH,KAAM,oCACNumE,KAAM,yCACNokD,WAAY,CAAC,WAEjBwB,8BAA+Bp6F,EAAS24F,MAAM,CAC1C1qH,KAAM,6CACNumE,KAAM,kDACNokD,WAAY,CAAC,WAMjByB,yBAA0Br6F,EAAS24F,MAAM,CACrC1qH,KAAM,8CACNumE,KAAM,qDACNokD,WAAY,CAAC,SAEjB0B,qCAAsCt6F,EAAS85F,UAAU,CACrD7rH,KAAM,mDACNumE,KAAM,0DACNokD,WAAY,CAAC,SACbmB,QAAS,CAAC,IAAM,IAAM,GAAK,GAAK,EAAG,EAAG,MAE1CQ,gCAAiCv6F,EAAS24F,MAAM,CAC5C1qH,KAAM,4DACNumE,KAAM,iEAGVgmD,oBAAqBx6F,EAAS24F,MAAM,CAChC1qH,KAAM,6CACNumE,KAAM,2BAGVimD,aAAcz6F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EkmD,aAAc16F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EmmD,oBAAqB36F,EAAS24F,MAAM,CAAE1qH,KAAM,wCAAyCumE,KAAM,aAC3FomD,eAAgB56F,EAAS24F,MAAM,CAAE1qH,KAAM,mCAAoCumE,KAAM,aACjFqmD,eAAgB76F,EAAS24F,MAAM,CAAE1qH,KAAM,mCAAoCumE,KAAM,aACjFsmD,aAAc96F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EumD,aAAc/6F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EwmD,aAAch7F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EymD,aAAcj7F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7E0mD,aAAcl7F,EAAS24F,MAAM,CAAE1qH,KAAM,qCAAsCumE,KAAM,mBACjF2mD,aAAcn7F,EAAS24F,MAAM,CAAE1qH,KAAM,qCAAsCumE,KAAM,mBAEjF4mD,mBAAoBp7F,EAAS24F,MAAM,CAC/B1qH,KAAM,uCACNumE,KAAM,6DAGV6mD,aAAcr7F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7E8mD,aAAct7F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7E+mD,oBAAqBv7F,EAAS24F,MAAM,CAAE1qH,KAAM,wCAAyCumE,KAAM,aAC3FgnD,eAAgBx7F,EAAS24F,MAAM,CAAE1qH,KAAM,mCAAoCumE,KAAM,aACjFinD,eAAgBz7F,EAAS24F,MAAM,CAAE1qH,KAAM,mCAAoCumE,KAAM,aACjFknD,aAAc17F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EmnD,aAAc37F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EonD,aAAc57F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAC7EqnD,aAAc77F,EAAS24F,MAAM,CAAE1qH,KAAM,iCAAkCumE,KAAM,aAG7EsnD,gBAAiB97F,EAAS24F,MAAM,CAC5B1qH,KAAM,oCACNumE,KAAM,wCACNokD,WAAY,CAAC,WAGjBmD,uBAAwB/7F,EAAS24F,MAAM,CACnC1qH,KAAM,oCACNumE,KAAM,gDACNokD,WAAY,CAAC,WAGjBoD,0BAA2Bh8F,EAAS24F,MAAM,CACtC1qH,KAAM,yCACNumE,KAAM,8CACNokD,WAAY,CAAC,WAEjBqD,4BAA6Bj8F,EAAS24F,MAAM,CACxC1qH,KAAM,2CACNumE,KAAM,gDACNokD,WAAY,CAAC,WAEjBsD,wBAAyBl8F,EAAS24F,MAAM,CACpC1qH,KAAM,uCACNumE,KAAM,4CACNokD,WAAY,CAAC,WAEjBuD,0BAA2Bn8F,EAAS24F,MAAM,CACtC1qH,KAAM,yCACNumE,KAAM,8CACNokD,WAAY,CAAC,WAGjBwD,gBAAiBp8F,EAAS24F,MAAM,CAC5B1qH,KAAM,oCACNumE,KAAM,+CACNokD,WAAY,CAAC,WAGjByD,eAAgBr8F,EAAS85F,UAAU,CAC/B7rH,KAAM,gCACNumE,KAAM,6CACNulD,QAAS,CAAC,KAAO,KAAO,KAAO,IAAM,GAAK,GAAK,GAC/CnB,WAAY,CAAC,WAGjB0D,gBAAiBt8F,EAAS24F,MAAM,CAC5B1qH,KAAM,oCACNumE,KAAM,wCACNokD,WAAY,CAAC,WAGjB2D,gBAAiBv8F,EAAS24F,MAAM,CAC5B1qH,KAAM,oCACNumE,KAAM,gDACNokD,WAAY,CAAC,WAGjB4D,yBAA0Bx8F,EAAS24F,MAAM,CACrC1qH,KAAM,6CACNumE,KAAM,iDACNokD,WAAY,CAAC,WAGjB6D,iBAAkBz8F,EAAS24F,MAAM,CAC7B1qH,KAAM,qCACNumE,KAAM,iCACNokD,WAAY,CAAC,WAGjB8D,0BAA2B18F,EAAS24F,MAAM,CACtC1qH,KAAM,yCACNumE,KAAM,2CACNokD,WAAY,CAAC,WAEjB+D,wBAAyB38F,EAAS24F,MAAM,CACpC1qH,KAAM,uCACNumE,KAAM,yCACNokD,WAAY,CAAC,WAEjBgE,4BAA6B58F,EAAS24F,MAAM,CACxC1qH,KAAM,2CACNumE,KAAM,6CACNokD,WAAY,CAAC,WAEjBiE,0BAA2B78F,EAAS24F,MAAM,CACtC1qH,KAAM,gDACNumE,KAAM,kDACNokD,WAAY,CAAC,WAGjBkE,mBAAoB98F,EAAS24F,MAAM,CAC/B1qH,KAAM,uCACNumE,KAAM,oCACNokD,WAAY,CAAC,WAEjBmE,0BAA2B/8F,EAAS24F,MAAM,CACtC1qH,KAAM,gDACNumE,KAAM,2CACNokD,WAAY,CAAC,WAGjBoE,0BAA2Bh9F,EAAS85F,UAAU,CAC1C7rH,KAAM,gDACNumE,KAAM,kDACNokD,WAAY,CAAC,SACbmB,QAAS,CACL,IAAOp5E,EAAKs8E,kCACZ,GAAMt8E,EAAKs8E,kCACX,EAAIt8E,EAAKs8E,kCACT,EAAIt8E,EAAKs8E,kCACT,EAAIt8E,EAAKs8E,qCAIjBC,yBAA0Bl9F,EAAS24F,MAAM,CACrC1qH,KAAM,6CACNumE,KAAM,qFACNokD,WAAY,CAAC,WAEjBuE,oBAAqBn9F,EAAS24F,MAAM,CAChC1qH,KAAM,kDACNumE,KAAM,8DACNokD,WAAY,CAAC,WAIjBtL,aAActtF,EAAS24F,MAAM,CACzB1qH,KAAM,iCACNumE,KAAM,kCAGVi5C,YAAaztF,EAAS24F,MAAM,CACxB1qH,KAAM,gCACNumE,KAAM,wEAEVk5C,iBAAkB1tF,EAAS85F,UAAU,CACjC7rH,KAAM,8BACNumE,KAAM,oDACNulD,QAAS,CAAC,GAAI,IAAK,OAGvBqD,sBAAuBp9F,EAAS24F,MAAM,CAClC1qH,KAAM,2CACNumE,KAAM,4CACNokD,WAAY,CAAC,eAEjB5O,MAAOhqF,EAASq9F,UAAU,CACtBpvH,KAAM,kBACNumE,KAAM,iCAMV8oD,aAAct9F,EAASq9F,UAAU,CAC7BpvH,KAAM,0BACNumE,KAAM,yBACNokD,WAAY,CAAC,QAAS,OAI1B2E,aAAcv9F,EAASq9F,UAAU,CAC7BpvH,KAAM,2BACNumE,KAAM,8CACNokD,WAAY,CAAC,WAIjB4E,iBAAkBx9F,EAAS24F,MAAM,CAC7B1qH,KAAM,oCACNumE,KAAM,4DACNokD,WAAY,CAAC,aAEjBxN,iBAAkBprF,EAAS85F,UAAU,CACjC7rH,KAAM,wCACNumE,KAAM,qDACNulD,QAAS,CACL,IAAOp5E,EAAK+mE,0BACZ,GAAM/mE,EAAK+mE,0BACX,EAAI/mE,EAAK+mE,0BACT,EAAI/mE,EAAK+mE,0BACT,EAAI/mE,EAAK+mE,6BAOjB+V,gBAAiBz9F,EAAS24F,MAAM,CAC5B1qH,KAAM,oCACNumE,KAAM,+DACNokD,WAAY,CAAC,YAGjB8E,eAAgB19F,EAAS24F,MAAM,CAC3B1qH,KAAM,mCACNumE,KAAM,yCACNokD,WAAY,CAAC,WAMjB+E,sBAAuB39F,EAAS24F,MAAM,CAClC1qH,KAAM,4CACNumE,KAAM,+DACNokD,WAAY,CAAC,WAGjBgF,eAAgB59F,EAAS24F,MAAM,CAC3B1qH,KAAM,mCACNumE,KAAM,yCACNokD,WAAY,CAAC,WAGjBiF,uBAAwB79F,EAAS24F,MAAM,CACnC1qH,KAAM,6CACNumE,KAAM,mDAEVw7C,oBAAqBhwF,EAAS24F,MAAM,CAChC1qH,KAAM,qCACNumE,KAAM,0CAGV87C,qBAAsBtwF,EAAS24F,MAAM,CACjC1qH,KAAM,yCACNumE,KAAM,2CAGV+7C,kCAAmCvwF,EAAS24F,MAAM,CAC9C1qH,KAAM,wDACNumE,KAAM,mEAGVg8C,0BAA2BxwF,EAAS24F,MAAM,CACtC1qH,KAAM,yCACNumE,KAAM,wEAEV27C,mBAAoBnwF,EAAS24F,MAAM,CAC/B1qH,KAAM,iCACNumE,KAAM,yCAEVk8C,mBAAoB1wF,EAAS24F,MAAM,CAC/B1qH,KAAM,iCACNumE,KAAM,yCAGVo8C,yBAA0B5wF,EAAS85F,UAAU,CACzC7rH,KAAM,2CACNumE,KAAM,wDACNulD,QAAS,CACL,GAAMp5E,EAAKm9E,uBACX,EAAIn9E,EAAKm9E,uBACT,EAAIn9E,EAAKm9E,uBACT,EAAIn9E,EAAKm9E,0BAGjBC,sBAAuB/9F,EAAS24F,MAAM,CAClC1qH,KAAM,iCACNumE,KAAM,2CAGVwpD,yBAA0Bh+F,EAAS85F,UAAU,CACzC7rH,KAAM,4CACNumE,KAAM,0BAKNulD,QAAS,CAAC,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,OAInCkE,UAAWj+F,EAAS24F,MAAM,CACtB1qH,KAAM,uBACNumE,KAAM,wBACNokD,WAAY,CAAC,WAGjBsF,WAAYl+F,EAAS24F,MAAM,CACvB1qH,KAAM,wBACNumE,KAAM,6BAEV2pD,wBAAyBn+F,EAAS24F,MAAM,CACpC1qH,KAAM,uCACNumE,KAAM,2CAEV4pD,wBAAyBp+F,EAAS24F,MAAM,CACpC1qH,KAAM,4CACNumE,KAAM,yDAEV6pD,mBAAoBr+F,EAAS24F,MAAM,CAC/B1qH,KAAM,iCACNumE,KAAM,iCACNokD,WAAY,CAAC,YAEjBhH,gBAAiBA,EACjB0M,QAAQC,GACJ,OAAO3vH,KAAKgjH,gBAAgBriH,IAAIgvH,IAAaA,CACjD,EAEAC,OAAOD,GACH3vH,KAAKiqH,wBAAwBpuH,IAAI,CAAE8zH,YAAY,GAC/C3vH,KAAKmqH,eAAetuH,IAAI,CAAE8zH,YAAY,EAC1C,EAEAE,QAAQF,GACJ3vH,KAAKiqH,wBAAwBpuH,IAAI,CAAE8zH,YAAY,GAC/C3vH,KAAKmqH,eAAetuH,IAAI,CAAE8zH,YAAY,EAC1C,EAEAG,YAAYH,EAAU5gD,EAAQz9D,GAC1B,MAAMklC,EAAQx2C,KAAK0vH,QAAQC,GAC3B,OAAQ5gD,GACJ,KAAKszC,GAAgB0N,OACjB/vH,KAAKoqH,8BAA8BzL,IAAI,CAAEnoE,SAASllC,GAClD,MACJ,KAAK+wG,GAAgB2N,OACjBhwH,KAAKqqH,8BAA8B1L,IAAI,CAAEnoE,SAASllC,GAClD,MACJ,KAAK+wG,GAAgB4N,WACjBjwH,KAAKsqH,kCAAkC3L,IAAI,CAAEnoE,SAASllC,GACtD,MACJ,KAAK+wG,GAAgB6N,SACjBlwH,KAAKuqH,gCAAgC5L,IAAI,CAAEnoE,SAASllC,GACpD,MACJ,KAAK+wG,GAAgB8N,UACjBnwH,KAAKwqH,iCAAiC7L,IAAI,CAAEnoE,SAASllC,GACrD,MACJ,KAAK+wG,GAAgB+N,cACjBpwH,KAAKyqH,qCAAqC9L,IAAI,CAAEnoE,SAASllC,GACzD,MACJ,QACItR,KAAK0qH,+BAA+B/L,IAAI,CAAEnoE,SAASllC,GAG/D,EAMA++G,iBAAiBV,EAAU5gD,EAAQz9D,GAC/B,MAAMklC,EAAQx2C,KAAK0vH,QAAQC,GAC3B,OAAQ5gD,GACJ,KAAKuzC,GAAYgO,GACbtwH,KAAK2qH,gCAAgChM,IAAI,CAAEnoE,SAASllC,GACpD,MACJ,KAAKgxG,GAAYiO,SACbvwH,KAAK4qH,4BAA4BjM,IAAI,CAAEnoE,SAASllC,GAChD,MACJ,KAAKgxG,GAAYkO,MACbxwH,KAAK6qH,yBAAyBlM,IAAI,CAAEnoE,SAASllC,GAC7C,MACJ,KAAKgxG,GAAYmO,OACbzwH,KAAK8qH,0BAA0BnM,IAAI,CAAEnoE,SAASllC,GAC9C,MACJ,QACItR,KAAK+qH,2BAA2BpM,IAAI,CAAEnoE,SAASllC,GAG3D,EAKAo/G,mBAAmBC,EAAezY,EAAY0Y,GAE1C,GADA5wH,KAAKyrH,yBAAyB9M,IAAI,CAAEkS,IAAsB,MAAjBF,EAAwB,MAAQ,SACpD,MAAjBA,EAAuB,CACvB,MAAMn6E,EAAQx2C,KAAK0vH,QAAQiB,EAAc9oH,QAAQ2uC,OACjD,OAAQ0hE,GACJ,KAAK,aACDl4G,KAAKqrH,sBAAsB1M,IAAI,CAAEnoE,UACjC,MACJ,KAAK,aACDx2C,KAAKsrH,qBAAqB3M,IAAI,CAAEnoE,UAChC,MACJ,KAAK,aACDx2C,KAAKurH,sBAAsB5M,IAAI,CAAEnoE,UACjC,MACJ,QACIx2C,KAAKwrH,8BAA8B7M,IAAI,CAAEnoE,UAGrD,CAC4B,MAAxBo6E,EACA5wH,KAAK0rH,qCAAqC3M,SAAS7lH,KAAKm+C,MAAQu5E,GAAwB,KAGxF5wH,KAAK2rH,gCAAgChN,KAE7C,EAOAO,eAAe5rE,GAEXtzC,KAAK4uH,iBAAiBjQ,IAAI,CAAErrE,WAAW,EAC3C,EACAw9E,WAAWnB,EAAUlrE,EAAOssE,GACxB,MAAMv6E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAK8uH,eAAenQ,IAAI,CAAEnoE,SAASiO,GACnCzkD,KAAK+uH,sBAAsBpQ,IAAI,CAAEnoE,SAASu6E,EAC9C,EACAC,WAAWC,EAAcC,GACrB,IAAK,MAAOvB,EAAUjrE,KAAUusE,EAAc,CAC1C,MAAMz6E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAKgvH,eAAerQ,IAAI,CAAEnoE,SAASkO,EACvC,CACA1kD,KAAKivH,uBAAuBtQ,IAAIuS,EACpC,EACAC,aAAaxB,EAAUyB,GACnB,MAAM56E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAK0tH,gBAAgB/O,IAAI,CAAEnoE,SAAS,GACpCx2C,KAAK2tH,gBAAgBhP,IAAI,CAAEnoE,SAAS46E,EACxC,EACAC,aAAa1B,EAAU2B,EAAkBF,EAAaG,EAASpxF,GAC3D,MAAMqW,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAKktH,gBAAgBvO,IAAI,CAAEnoE,SAAS,GACpCx2C,KAAKwtH,gBAAgB7O,IAAI,CAAEnoE,SAAS46E,EAAcG,GAClDvxH,KAAKmtH,uBAAuBxO,IAAI,CAAEnoE,SAAS46E,GAC3CpxH,KAAKotH,0BAA0BzO,IAAI,CAAEnoE,SAAS86E,EAAiB7K,QAC/DzmH,KAAKqtH,4BAA4B1O,IAAI,CAAEnoE,SAAS86E,EAAiBE,UACjExxH,KAAKstH,wBAAwB3O,IAAI,CAAEnoE,SAAS86E,EAAiBzK,MAC7D7mH,KAAKutH,0BAA0B5O,IAAI,CAAEnoE,SAAS86E,EAAiB3/C,QAC/D3xE,KAAKytH,eAAe1O,QAAQ,CAAEvoE,SAASrW,EAAK,IAChD,EACAsxF,uBAAuB9B,GACnB,MAAMn5E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAK4tH,yBAAyBjP,IAAI,CAAEnoE,SAAS,EACjD,EACAk7E,eAAe/B,GACX,MAAMn5E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAK6tH,iBAAiBlP,IAAI,CAAEnoE,SAAS,EACzC,EACAm7E,sBAAsBhC,EAAUh7G,GAC5B,MAAM6hC,EAAQx2C,KAAK0vH,QAAQC,GAC3B,OAAQh7G,GACJ,KAAKqjG,GAAc4Z,UACf5xH,KAAKguH,4BAA4BrP,IAAI,CAAEnoE,UACvC,MACJ,KAAKwhE,GAAckI,QACflgH,KAAK8tH,0BAA0BnP,IAAI,CAAEnoE,UACrC,MACJ,KAAKwhE,GAAcj3C,MACf/gE,KAAK+tH,wBAAwBpP,IAAI,CAAEnoE,UACnC,MACJ,QACIx2C,KAAKiuH,0BAA0BtP,IAAI,CAAEnoE,UAGjD,EACAq7E,iBAAiBlC,EAAU5gD,GACvB,MAAMv4B,EAAQx2C,KAAK0vH,QAAQC,GACrBvvG,EAAQ2uD,EAAOA,SAAW+oC,GAAav/G,MAAQw2E,EAAO3uD,MAAQ2uD,EAAOA,OAC3E/uE,KAAKkuH,mBAAmBvP,IAAI,CAAEv+F,SAAS,GACvCpgB,KAAKmuH,0BAA0BxP,IAAI,CAAEnoE,SAAS,EAClD,EACAgqE,uBAAuBmP,EAAUrP,EAAiBC,GAE9C,GADAvgH,KAAKouH,0BAA0BrP,QAAQuB,EAAkB,KACrDC,EAAgB,CAChB,MAAM/pE,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAKsuH,yBAAyB3P,IAAI,CAAEnoE,SAAS,EACjD,CACJ,EACAs7E,sBAAsBnC,GAClB,MAAMn5E,EAAQx2C,KAAK0vH,QAAQC,GAC3B3vH,KAAKuuH,oBAAoB5P,IAAI,CAAEnoE,SAAS,EAC5C,EACAu7E,wBACI/xH,KAAK4rH,oBAAoBjN,IAAI,EACjC,EACAqT,iBACIhyH,KAAKusH,aAAa5N,IAAI,EAC1B,EACAsT,iBACIjyH,KAAKssH,aAAa3N,IAAI,EAC1B,EACAuT,UAAUzwH,EAAK0wH,GACXnyH,KAAK6rH,aAAalN,IAAIwT,GACtBnyH,KAAK8rH,aAAanN,IAAI,GAClBl9G,EAAI4hD,eACJrjD,KAAK+rH,oBAAoBpN,IAAIl9G,EAAI4hD,cAAcpsD,QAC/CwK,EAAI+zB,UACJx1B,KAAKgsH,eAAerN,IAAIl9G,EAAI+zB,SAASv+B,QACrCwK,EAAI+hD,UACJxjD,KAAKisH,eAAetN,IAAI,GACpBl9G,EAAI+hD,QAAQiB,OACZzkD,KAAKksH,aAAavN,IAAIl9G,EAAI+hD,QAAQiB,MAAMxtD,QACxCwK,EAAI+hD,QAAQkB,OACZ1kD,KAAKmsH,aAAaxN,IAAIl9G,EAAI+hD,QAAQkB,MAAMztD,QACxCwK,EAAI+hD,QAAQmB,OACZ3kD,KAAKosH,aAAazN,IAAIl9G,EAAI+hD,QAAQmB,MAAM1tD,QACxCwK,EAAI+hD,QAAQoB,OACZ5kD,KAAKqsH,aAAa1N,IAAIl9G,EAAI+hD,QAAQoB,MAAM3tD,QAEpD,EACAm7H,UAAU3wH,EAAK0wH,GAOX,GANAnyH,KAAKysH,aAAa9N,IAAIwT,GACtBnyH,KAAK0sH,aAAa/N,IAAI,GAClBl9G,EAAI4hD,eACJrjD,KAAK2sH,oBAAoBhO,IAAIl9G,EAAI4hD,cAAcpsD,QAC/CwK,EAAI+zB,UACJx1B,KAAK4sH,eAAejO,IAAIl9G,EAAI+zB,SAASv+B,QACrCwK,EAAI+hD,QAAS,CACb,MAAMiB,EAAQhjD,EAAI+hD,QAAQiB,OAAOxtD,QAAU,EACrCytD,EAAQjjD,EAAI+hD,QAAQkB,OAAOztD,QAAU,EACrC0tD,EAAQljD,EAAI+hD,QAAQmB,OAAO1tD,QAAU,EACrC2tD,EAAQnjD,EAAI+hD,QAAQoB,OAAO3tD,QAAU,EACvCwtD,EAAQ,GACRzkD,KAAK8sH,aAAanO,IAAIl6D,GACtBC,EAAQ,GACR1kD,KAAK+sH,aAAapO,IAAIj6D,GACtBC,EAAQ,GACR3kD,KAAKgtH,aAAarO,IAAIh6D,GACtBC,EAAQ,GACR5kD,KAAKitH,aAAatO,IAAI/5D,IACtBH,EAAQ,GAAKC,EAAQ,GAAKC,EAAQ,GAAKC,EAAQ,IAC/C5kD,KAAK6sH,eAAelO,IAAI,EAChC,CACJ,EACA0T,eAAeC,EAAQ/I,GACnB,IAAIgJ,EAAW,EACXx4B,EAAU,EACVic,EAAS,EACT6Q,EAAO,EACX,IAAK,MAAMzL,KAASkX,EACZlX,GAASmO,EAAgB3O,mBACzB2X,IACAnX,GAASmO,EAAgB5O,kBACzB5gB,IACAqhB,GAASmO,EAAgB7O,iBACzB1E,IACAoF,GAAS,GACTyL,IAER7mH,KAAKwuH,sBAAsB3yH,IAAI,CAAEm8E,UAAWyqC,GAAe8P,UAAYA,GACvEvyH,KAAKwuH,sBAAsB3yH,IAAI,CAAEm8E,UAAWyqC,GAAe1oB,SAAWA,GACtE/5F,KAAKwuH,sBAAsB3yH,IAAI,CAAEm8E,UAAWyqC,GAAezM,QAAUA,GACrEh2G,KAAKwuH,sBAAsB3yH,IAAI,CAAEm8E,UAAWyqC,GAAeoE,MAAQA,GAEnE7mH,KAAKo7G,MAAMv/G,IAAIy2H,EACnB,EACAE,qBAAqBC,GACjB,IAAK,MAAOj8E,EAAOk8E,KAAYD,EAAGxP,QAC9BjjH,KAAK0uH,aAAa7yH,IAAI,CAAE26C,QAAOj7C,EAAG,MAAQm3H,EAAQtP,KAClDpjH,KAAK0uH,aAAa7yH,IAAI,CAAE26C,QAAOj7C,EAAG,MAAQm3H,EAAQrP,KAClDrjH,KAAK0uH,aAAa7yH,IAAI,CAAE26C,QAAOj7C,EAAG,MAAQm3H,EAAQpP,KAClDtjH,KAAK0uH,aAAa7yH,IAAI,CAAE26C,QAAOj7C,EAAG,OAASm3H,EAAQnP,MACnDvjH,KAAK0uH,aAAa7yH,IAAI,CAAE26C,QAAOj7C,EAAG,MAAQm3H,EAAQlP,KAEtDxjH,KAAK0uH,aAAa7yH,IAAI,CAAEN,EAAG,MAAQk3H,EAAG/O,KACtC1jH,KAAK0uH,aAAa7yH,IAAI,CAAEN,EAAG,MAAQk3H,EAAG9O,KACtC3jH,KAAK0uH,aAAa7yH,IAAI,CAAEN,EAAG,MAAQk3H,EAAG7O,IAC1C,EACA+O,qBAAqB9L,EAAM+L,GACvB,MAAMC,EAAqB,IAAIv4G,IAC/BusG,EAAKzmH,SAAQ,CAACglD,EAAOuqE,KAEjB,MAAMzM,EAAaljH,KAAKgjH,gBAAgBriH,IAAIgvH,IAAa,UACzD,IAAImD,EAAcD,EAAmBlyH,IAAIuiH,GACpC4P,IACDA,EAAc,IAAIp+G,IAClBm+G,EAAmBh3H,IAAIqnH,EAAY4P,IAEvC1tE,EAAMhlD,SAAS7E,GAAMu3H,GAAa96G,IAAIzc,IAAG,IAE7C,IAAK,MAAOi7C,EAAO4O,KAAUytE,EAAoB,CAC7C,MAAME,EAAa,GACnB3tE,EAAMhlD,SAAS66G,IACX8X,EAAWr7H,KAAKk7H,EAAYjyH,IAAIs6G,IAAS,EAAE,IAE/Cj7G,KAAK2uH,aAAa9yH,IAAI,CAAE26C,SAASu8E,EACrC,CACJ,EAER,C2CrmB4BC,CAAW5kH,EAAQs7G,gBAAiBt7G,EAAQu7G,uBAAwB,CAChFuF,uBAAwBlvH,KAAK+xC,KAAK+uE,yBAA2B,IAC7DhI,0BAA2B/mE,EAAKu3E,YAAYxQ,0BAC5CuV,kCAAmCzE,EAAmC,MAE1ErkD,EAAQ+pD,WAAW2D,YAAW,IAAMjzH,KAAKkzH,gBAAgB3tD,KACzD,IAAK,MAAMF,KAAYrlE,KAAKmmH,YACxB5gD,EAAQukD,iBAAiBjuH,IAAI,CAAEwpE,YAAY,GAE/CrlE,KAAKulE,QAAUA,CACnB,MAEIvlE,KAAKulE,QAAU,KAEnBvlE,KAAKynH,aAAe,IAAI5G,GAAY7gH,KAAK+xC,KAAK+uE,yBAA0B9gH,KAAKk2G,aAAcl2G,KAAKulE,SAIhGvlE,KAAKo7G,MAAQ,IAAIqC,GAAUz9G,KAAK+xC,KAAKu3E,YAAatpH,KAAKulE,QAAS,CAC5Du4C,qBAAsB/rE,EAAKy2E,oBAE/BxoH,KAAKiqE,kBAAoB77D,EAAQ67D,kBACjCjqE,KAAKkqE,mBAAqB97D,EAAQ87D,mBAClClqE,KAAK6nH,cAAgB91E,EAAK81E,cAAgB,IAAInzG,IAAIq9B,EAAK81E,eAAiB,IAC5E,CACAsL,WACI,MAAO,IAAInzH,KAAKolD,MAAM39C,QAAQmT,KAAKvf,GAAQgjE,GAAiBhjE,IAChE,CACA25G,YACI,OAAOh1G,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,OACjD,CAMAn1H,cAEI,GAAI+B,KAAKg1G,YACL,OAEJh1G,KAAKrH,IAAI,YACTqH,KAAKomH,oBCvQNnoH,eAA0Co1H,EAAiBv0D,GAC9D,OAAQu0D,GACJ,KAAK,MAAY,CACb,IAAKv0D,EACD,MAAMvmE,MAAM,uBAEhB,GAAyB,MAArBumE,EAAOnR,WACP,MAAMp1D,MAAM,+CAEhB,GAAwB,MAApBumE,EAAO1pC,UACP,MAAM78B,MAAM,8CAGhB,MAAMo1D,QAAmB,GAAoBmR,EAAOnR,YACpD,MAAO,CACHz+C,KAAM2oG,GAAkByb,QACxBC,OAAQz0D,EACR3wD,IAAK2wD,EAAO1pC,UACZu4B,aAER,CACA,KAAK,MACD,MAAO,CACHz+C,KAAM2oG,GAAkB2b,WAEhC,QACI,MAAM,IAAIj7H,MAAM,6BAA6B86H,MAEzD,CD2OmCI,CAA2BzzH,KAAKkmH,sBAAuBlmH,KAAKgkF,WAAWllB,QAGlG9+D,KAAKwmH,sBAAwBl+C,GAAS,CAAEM,YAAY,KACpD,QAAK5oE,KAAKwmH,uBAAuBvoH,MAAOE,IACpC,UAAW,MAAM,OAAE2gE,EAAM,WAAEyF,KAAgBpmE,QACjC6B,KAAK0zH,qBAAqB50D,EAAQyF,EAC5C,IACD92C,OAAOhkB,GAAMzJ,KAAKrH,IAAIynB,MAAM,gCAAiC3W,WAE1D+H,QAAQQ,IAAIhS,KAAK+xC,KAAKm2E,YAAYttG,KAAI3c,MAAO1C,UACzCyE,KAAKgkF,WAAW2vC,UAAUzvH,MAAM3I,EAAE3B,GAAI,CACxCg6H,WAAYr4H,EAAEs4H,OAChB,KAEN,MAAMC,EAAY9zH,KAAKgkF,WAAW8vC,gBAG5BtiH,QAAQQ,IAAIhS,KAAKmmH,YAAYvrG,KAAKm5G,GAAeD,EAAU94D,OAAO+4D,EAAY/zH,KAAK2uE,iBAAiBvyE,KAAK4D,MAAO,CAClHiqE,kBAAmBjqE,KAAKiqE,kBACxBC,mBAAoBlqE,KAAKkqE,wBAoB7B,MAAM1xB,EAAW,CACbw7E,UAAWh0H,KAAKi0H,gBAAgB73H,KAAK4D,MACrCk0H,aAAcl0H,KAAKm0H,mBAAmB/3H,KAAK4D,OAEzCo0H,QAA6B5iH,QAAQQ,IAAIhS,KAAKmmH,YAAYvrG,KAAKm5G,GAAeD,EAAU1iG,SAAS2iG,EAAYv7E,MAE7G67E,EAAmBtuH,WAAW/F,KAAKs0H,ahFlOH,KgFoOtCt0H,KAAK2U,OAAS,CACVtG,KAAM23G,GAAiBoN,QACvBgB,uBACAC,iBAAkBA,EAClBE,gBAAiBr7H,KAAKm+C,MhFxOY,KgF0OtCr3C,KAAKo7G,MAAM53G,QAEXxD,KAAK0nH,kBAAoB3hH,YAAW,KAChCyL,QAAQC,UACH+b,MAAKvvB,gBACAuT,QAAQQ,IAAIpZ,MAAM4N,KAAKxG,KAAKymH,QAAQ7rG,KAAI3c,MAAOrE,SAAaoG,KAAKw0H,QAAQ56H,KAAK,IAEnF6zB,OAAO7nB,IACR5F,KAAKrH,IAAIiN,EAAI,GACf,GhF3LoC6iH,KgF6L1CzoH,KAAKrH,IAAI,UACb,CAIAsF,aAGI,GAFA+B,KAAKrH,IAAI,YAELqH,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QACtC,OAEJ,MAAM,qBAAEgB,GAAyBp0H,KAAK2U,OACtC3U,KAAK2U,OAAS,CAAEtG,KAAM23G,GAAiB4B,SAEvC,MAAMkM,EAAY9zH,KAAKgkF,WAAW8vC,gBAC5BtiH,QAAQQ,IAAIhS,KAAKmmH,YAAYvrG,KAAKm5G,GAAeD,EAAUW,SAASV,MAC1EK,EAAqBh0H,SAASxG,GAAOk6H,EAAUjjG,WAAWj3B,KAC1DoG,KAAKwmH,sBAAsB7jH,MAC3B,IAAK,MAAM+xH,KAAkB10H,KAAKumH,gBAAgB5qH,SAC9C+4H,EAAenlH,QAEnBvP,KAAKumH,gBAAgBl3G,QACrB,IAAK,MAAMslH,KAAiB30H,KAAKsmH,eAAe3qH,SAC5Cg5H,EAAcplH,QAElBvP,KAAKsmH,eAAej3G,QACpBrP,KAAKolD,MAAM/1C,QACXrP,KAAKqjD,cAAch0C,QAEfrP,KAAK8nH,iBACL9nH,KAAK8nH,eAAexxG,SACpBtW,KAAK8nH,eAAiB,MAE1B9nH,KAAKo7G,MAAMvxE,OACX7pC,KAAK6mH,KAAKx3G,QACVrP,KAAK2xE,OAAOtiE,QACZrP,KAAK8mH,cAAcz3G,QACnBrP,KAAKg2G,OAAO3mG,QACZrP,KAAKwjD,QAAQn0C,QACbrP,KAAK+mH,SAAS13G,QACdrP,KAAKgnH,OAAO33G,QACZrP,KAAKqlD,QAAQh2C,QACbrP,KAAKinH,SAAS53G,QACdrP,KAAKynH,aAAap4G,QAClBrP,KAAK2mH,UAAUt3G,QACXrP,KAAKonH,gBACLpnH,KAAKonH,eAAe/3G,QACpBrP,KAAK0nH,mBACL1jF,aAAahkC,KAAK0nH,mBACtB1nH,KAAKrH,IAAI,UACb,CAEAulH,qBACI,OAAOl+G,KAAKo7G,MAAM8C,oBACtB,CAIAvvC,kBAAiB,OAAEG,EAAM,WAAEvK,IACvB,IAAKvkE,KAAKg1G,YACN,OAEJ,MAAMl2C,EAASyF,EAAW7E,WAE1B1/D,KAAKm/G,QAAQrgD,EAAQyF,EAAW/4C,UAAW+4C,EAAWqwD,YAEtD50H,KAAK60H,oBAAoB/1D,EAAQgQ,GAEjC9uE,KAAKwmH,sBAAsB9uH,KAAK,CAAEonE,SAAQyF,cAC9C,CAIA0vD,gBAAgBn1D,EAAQyF,GACpBvkE,KAAKulE,SAASkqD,mBAAmB9Q,IAAI,CAAEhqG,OAAQ4vD,EAAW5vD,SAGrD3U,KAAKg1G,aAAqC,SAAtBzwC,EAAW5vD,SAGpC3U,KAAKm/G,QAAQrgD,EAAQyF,EAAW/4C,UAAW+4C,EAAWqwD,YACtD50H,KAAKwmH,sBAAsB9uH,KAAK,CAAEonE,SAAQyF,eAC9C,CAIA4vD,mBAAmBr1D,GACf9+D,KAAKrH,IAAI,sBAAuBmmE,GAChC9+D,KAAKu/G,WAAWzgD,EACpB,CACA7gE,2BAA2B6gE,EAAQyF,GAC/B,IAAKvkE,KAAKg1G,YACN,OAEJ,MAAMp7G,EAAKklE,EAAOn6D,WAClB,GAAK3E,KAAKolD,MAAMpqC,IAAIphB,KAMhBoG,KAAKumH,gBAAgBvrG,IAAIphB,GAG7B,IACI,MAAMk1E,EAAS,IAAI+0C,SAAqBt/C,EAAWgL,UAAUvvE,KAAKmmH,cAAe18G,GAAMzJ,KAAKrH,IAAIynB,MAAM,sBAAuB3W,IAAI,CAAEi+F,cAAe1nG,KAAK+xC,KAAK+iF,wBAC5J90H,KAAKrH,IAAI,4BAA6BmmE,GACtC9+D,KAAKumH,gBAAgB1qH,IAAIjC,EAAIk1E,GAC7B,MAAMzJ,EAAWyJ,EAAOzJ,SACpBA,IAAa,IACbrlE,KAAK0mH,cAAc1uG,IAAIpe,GAE3BoG,KAAKulE,SAASylD,iBAAiBrM,IAAI,CAAEt5C,YAAY,GAE7CrlE,KAAKqjD,cAAc5rD,KAAO,IAC1BuI,KAAKrH,IAAI,wBAAyBiB,GAClCoG,KAAK+0H,kBAAkBn7H,EAAIhB,MAAM4N,KAAKxG,KAAKqjD,gBAAgB,GAEnE,CACA,MAAO55C,GACHzJ,KAAKrH,IAAIynB,MAAM,6BAA8B3W,EACjD,CACJ,CACAxL,0BAA0B6gE,EAAQgQ,GAC9B,IAAK9uE,KAAKg1G,YACN,OAEJ,MAAMp7G,EAAKklE,EAAOn6D,WAClB,IAAK3E,KAAKolD,MAAMpqC,IAAIphB,GAChB,OAMJ,MAAMo7H,EAAqBh1H,KAAKsmH,eAAe3lH,IAAI/G,QACxB8N,IAAvBstH,IACAh1H,KAAKrH,IAAI,sCAAuCiB,GAChDo7H,EAAmBzlH,SAEvBvP,KAAKrH,IAAI,2BAA4BiB,GACrC,MAAM+6H,EAAgB,IAAI3Q,GAAcl1C,EAAQ,CAAEzI,cAAermE,KAAK+xC,KAAKkjF,uBAC3Ej1H,KAAKsmH,eAAezqH,IAAIjC,EAAI+6H,GAC5B30H,KAAKk1H,mBAAmBp2D,EAAQ61D,EAAcx2H,QAAQsvB,OAAO7nB,GAAQ5F,KAAKrH,IAAIiN,IAClF,CAIAu5G,QAAQrgD,EAAQtzC,EAAW2pG,GACvB,MAAMv7H,EAAKklE,EAAOn6D,WAClB,IAAK3E,KAAKolD,MAAMpqC,IAAIphB,GAAK,CACrBoG,KAAKrH,IAAI,cAAemmE,GACxB9+D,KAAKolD,MAAMptC,IAAIpe,GAEfoG,KAAKo7G,MAAM+D,QAAQvlH,GACnB,MAAMw7H,ED/dX,SAA0BC,GAC7B,IAAK,MAAMC,KAASD,EAAUE,SAC1B,OAAQD,EAAM,IACV,KAAKvP,GAASyP,IACd,KAAKzP,GAAS0P,IACV,OAAOrQ,GAAgBkQ,EAAM,GAAIA,EAAM,IAGnD,OAAO,IACX,CCsd8BI,CAAiBP,GACjB,OAAdC,EACAp1H,KAAKo7G,MAAMgE,MAAMxlH,EAAIw7H,GAGrBp1H,KAAKrH,IAAI,gDAAiDiB,EAAIu7H,EAAKxwH,YAGlE3E,KAAKinH,SAASjsG,IAAIphB,IACnBoG,KAAKinH,SAASprH,IAAIjC,EAAkB,aAAd4xB,EAE9B,CACJ,CAIA+zF,WAAWzgD,GACP,MAAMllE,EAAKklE,EAAOn6D,WAClB,IAAK3E,KAAKolD,MAAMpqC,IAAIphB,GAChB,OAGJoG,KAAKrH,IAAI,iBAAkBmmE,GAC3B9+D,KAAKolD,MAAMntC,OAAOre,GAClB,MAAM86H,EAAiB10H,KAAKumH,gBAAgB5lH,IAAI/G,GAC1C+6H,EAAgB30H,KAAKsmH,eAAe3lH,IAAI/G,GAC1C86H,GACA10H,KAAKulE,SAASylD,iBAAiBrM,IAAI,CAAEt5C,SAAUqvD,EAAervD,WAAa,GAG/EqvD,GAAgBnlH,QAChBolH,GAAeplH,QAEfvP,KAAKumH,gBAAgBtuG,OAAOre,GAC5BoG,KAAKsmH,eAAeruG,OAAOre,GAE3B,IAAK,MAAMwrD,KAASplD,KAAKg3G,OAAOr7G,SAC5BypD,EAAMntC,OAAOre,GAGjB,IAAK,MAAO+1H,EAAUvqE,KAAUplD,KAAK6mH,MACR,IAArBzhE,EAAMntC,OAAOre,IACboG,KAAKulE,SAAS8qD,iBAAiBV,EAAUrN,GAAYgO,GAAI,GAIjE,IAAK,MAAMlrE,KAASplD,KAAK2xE,OAAOh2E,SAC5BypD,EAAMntC,OAAOre,GAGjBoG,KAAK0mH,cAAczuG,OAAOre,GAE1BoG,KAAKg2G,OAAO/9F,OAAOre,GAEnBoG,KAAKwjD,QAAQvrC,OAAOre,GAEpBoG,KAAKinH,SAAShvG,OAAOre,GAErBoG,KAAKo7G,MAAMmE,WAAW3lH,GACtBoG,KAAK4mH,oBAAoB3uG,OAAOre,EACpC,CAEIw5H,cACA,OAAOpzH,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,OACjD,CAIAuC,aAAan/E,GACT,MAAMo/E,EAAe51H,KAAK6mH,KAAKlmH,IAAI61C,GACnC,OAAOo/E,EAAeh9H,MAAM4N,KAAKovH,GAAgB,EACrD,CAIAC,eAAer/E,GACX,MAAMo/E,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GACrC,OAAQo/E,EAAeh9H,MAAM4N,KAAKovH,GAAgB,IAAIh7G,KAAKvf,GAAQgjE,GAAiBhjE,IACxF,CAIA2+F,YACI,OAAOphG,MAAM4N,KAAKxG,KAAKqjD,cAC3B,CAMAplD,yBAAyB6gE,EAAQgQ,GAC7B,UACU,QAAKA,GAAQ7wE,MAAOE,IACtB,UAAW,MAAMse,KAAQte,EACrB,IAEI,MAAMg0H,EAAW11G,EAAKnlB,WAGhBmK,EAAM+iH,GAAU2N,EAAUnyH,KAAK2nH,iBAMrC,GALA3nH,KAAKulE,SAAS2sD,UAAUzwH,EAAK0wH,EAASl7H,QAKlC+I,KAAK+xC,KAAK+jF,gBACV,UACU91H,KAAK+1H,kBAAkBj3D,EAAQr9D,EACzC,CACA,MAAOmE,GACH5F,KAAKulE,SAASysD,iBACdhyH,KAAKrH,IAAIiN,EACb,MAGA5F,KAAK+1H,kBAAkBj3D,EAAQr9D,GAAKgsB,OAAO7nB,IACvC5F,KAAKulE,SAASysD,iBACdhyH,KAAKrH,IAAIiN,EAAI,GAGzB,CACA,MAAO6D,GACHzJ,KAAKulE,SAAS0sD,iBACdjyH,KAAKrH,IAAI8Q,EACb,CACJ,GAER,CACA,MAAO7D,GACH5F,KAAKulE,SAASwsD,wBACd/xH,KAAKg2H,0BAA0BpwH,EAAKk5D,EACxC,CACJ,CAKAk3D,0BAA0BpwH,EAAKk5D,GAC3B9+D,KAAKrH,IAAIynB,MAAMxa,GACf5F,KAAKm0H,mBAAmBr1D,EAC5B,CAIA7gE,wBAAwBuI,EAAM/E,GAE1B,IAAKzB,KAAKi2H,WAAWzvH,EAAK7B,YAGtB,OAFA3E,KAAKrH,IAAI,6CAA8C6N,QACvDxG,KAAKulE,SAASinD,mBAAmB7N,MAGrC,MAAMt7D,EAAgB5hD,EAAI4hD,cAAgB5hD,EAAI4hD,cAAcpsD,OAAS,EAC/Du+B,EAAW/zB,EAAI+zB,SAAW/zB,EAAI+zB,SAASv+B,OAAS,EACtD,IAAIwtD,EAAQ,EACRC,EAAQ,EACRC,EAAQ,EACRC,EAAQ,EAaZ,GAZInjD,EAAI+hD,UACA/hD,EAAI+hD,QAAQiB,QACZA,EAAQhjD,EAAI+hD,QAAQiB,MAAMxtD,QAC1BwK,EAAI+hD,QAAQkB,QACZA,EAAQjjD,EAAI+hD,QAAQkB,MAAMztD,QAC1BwK,EAAI+hD,QAAQmB,QACZA,EAAQljD,EAAI+hD,QAAQmB,MAAM1tD,QAC1BwK,EAAI+hD,QAAQoB,QACZA,EAAQnjD,EAAI+hD,QAAQoB,MAAM3tD,SAElC+I,KAAKrH,IAAI,YAAY6N,EAAK7B,4BAA4B0+C,cAA0B7tB,WAAkBivB,WAAeC,WAAeC,WAAeC,KAE3InjD,EAAI4hD,eAAiB5hD,EAAI4hD,cAAcpsD,OAAS,EAAG,CAEnD,MAAMosD,EAAgB,GACtB5hD,EAAI4hD,cAAcjjD,SAAS81H,IACvB,MAAM1/E,EAAQ0/E,EAAO1/E,MACfwN,GAAiC,IAArBkyE,EAAOlyE,UACzB,GAAa,MAATxN,EAAe,CACf,GAAIx2C,KAAK6nH,gBAAkB7nH,KAAK6nH,cAAc7sG,IAAIw7B,GAG9C,OAEJx2C,KAAKm2H,2BAA2B3vH,EAAMgwC,EAAOwN,GAC7CX,EAAc3rD,KAAK,CAAE8+C,QAAOwN,aAChC,KAEJhkD,KAAKo2H,cAAc,IAAI,KAAY,sBAAuB,CACtD/7B,OAAQ,CAAEv7B,OAAQt4D,EAAM68C,mBAEhC,CAGA,GAAI5hD,EAAI+zB,SACJ,IAAK,MAAM3tB,KAAWpG,EAAI+zB,SAAU,CAChC,GAAIx1B,KAAK6nH,gBAAkB7nH,KAAK6nH,cAAc7sG,IAAInT,EAAQ2uC,OAGtD,SAEJ,MAAM6/E,EAA+Br2H,KAAKs2H,sBAAsB9vH,EAAMqB,GAEjE4lB,OAAO7nB,IACR5F,KAAKulE,SAASmsD,eAAe7pH,EAAQ2uC,OACrCx2C,KAAKrH,IAAIiN,EAAI,IAEb5F,KAAK+xC,KAAKwkF,8BACJF,CAEd,CAGA50H,EAAI+hD,eACExjD,KAAKw2H,qBAAqBhwH,EAAK7B,WAAYlD,EAAI+hD,QAE7D,CAIA2yE,2BAA2B3vH,EAAMgwC,EAAOwN,GACpChkD,KAAKrH,IAAI,uCAAwC6N,EAAMgwC,GACvD,IAAIigF,EAAWz2H,KAAKg3G,OAAOr2G,IAAI61C,GACf,MAAZigF,IACAA,EAAW,IAAI/hH,IACf1U,KAAKg3G,OAAOn7G,IAAI26C,EAAOigF,IAEvBzyE,EAEAyyE,EAASz+G,IAAIxR,EAAK7B,YAIlB8xH,EAASx+G,OAAOzR,EAAK7B,WAG7B,CAKA1G,4BAA4BuI,EAAMkwH,GAC9B12H,KAAKulE,SAASksD,uBAAuBiF,EAAOlgF,OAC5C,MAAMmgF,QAAyB32H,KAAK42H,wBAAwBpwH,EAAMkwH,GAElE,OADA12H,KAAKulE,SAASosD,sBAAsB+E,EAAOlgF,MAAOmgF,EAAiBtoH,MAC3DsoH,EAAiBtoH,MACrB,KAAK2pG,GAAc4Z,UAQf,OANA5xH,KAAKo7G,MAAM+E,iBAAiB35G,EAAK7B,WAAYgyH,EAAiBngB,SAAUkgB,EAAOlgF,OAI/Ex2C,KAAKynH,aAAa/H,eAAeiX,EAAiBngB,UAAU,QAC5Dx2G,KAAKsnH,OAAO3Q,iBAAiBggB,EAAiBngB,SAAUhwG,EAAK7B,YAEjE,KAAKqzG,GAAckI,QAKf,GAAIyW,EAAiBngB,SAAU,CAC3B,MAAMA,EAAWmgB,EAAiBngB,SAClCx2G,KAAKo7G,MAAM2E,cAAcv5G,EAAK7B,WAAY6xG,EAAUkgB,EAAOlgF,MAAOmgF,EAAiB5nD,QACnF/uE,KAAKynH,aAAa1H,cAAcvJ,EAAUmgB,EAAiB5nD,OAC/D,MAEI/uE,KAAKo7G,MAAMyE,qBAAqBr5G,EAAK7B,WAAY+xH,EAAOlgF,OAG5D,YADAx2C,KAAKulE,SAASssD,iBAAiB6E,EAAOlgF,MAAOmgF,GAEjD,KAAK3e,GAAcj3C,MASf,GANA/gE,KAAKo7G,MAAMqE,gBAAgBkX,EAAiBrgB,UAAUE,UACtDx2G,KAAKynH,aAAa/H,eAAeiX,EAAiBrgB,UAAUE,UAG5Dx2G,KAAKsnH,OAAOp5G,IAAIyoH,EAAiBrgB,UAAWogB,GAAS12H,KAAK+xC,KAAK8kF,iBAE3D72H,KAAKqjD,cAAcroC,IAAI07G,EAAOlgF,OAAQ,CACnBx2C,KAAKgkF,WAAWllB,OAAO99C,OAAOxa,KAC9BxG,KAAK+xC,KAAK+kF,WACzBnkH,MAAMyjH,cAAc,IAAI,KAAY,oBAAqB,CACrD/7B,OAAQ,CACJ08B,kBAAmBvwH,EACnBowG,MAAO+f,EAAiBrgB,UAAUE,SAClCvvF,IAAK0vG,EAAiB1vG,QAI9BtU,MAAMyjH,cAAc,IAAI,KAAY,UAAW,CAAE/7B,OAAQs8B,EAAiB1vG,OAElF,CAGKjnB,KAAK+xC,KAAK8kF,iBAGX72H,KAAKg3H,eAAeL,EAAiBrgB,UAAUE,SAAUkgB,EAAQlwH,EAAK7B,YAGtF,CAKA1G,8BAA8B84H,EAAmBL,GAE7C,MAAMO,EAAej3H,KAAKmnH,cAAcuP,GAClCQ,OAA+BxvH,IAAjBuvH,EAA6Bj3H,KAAKonH,gBAAgBzmH,IAAIs2H,QAAgBvvH,EAC1F,GAAIwvH,EAEA,MAAO,CAAE7oH,KAAM2pG,GAAc4Z,UAAWpb,SAAU0gB,GAGtD,MAAMP,Q1CruBP14H,eAAoCo1H,EAAiBpsG,GAGxD,OAAQosG,GACJ,KAAK,MACD,OAAqB,MAAjBpsG,EAAIm9B,UACG,CAAE2c,OAAO,EAAO3gD,MAAO23F,GAAcof,kBAC/B,MAAblwG,EAAIk9B,MACG,CAAE4c,OAAO,EAAO3gD,MAAO23F,GAAcqf,cACjC,MAAXnwG,EAAI9Y,IACG,CAAE4yD,OAAO,EAAO3gD,MAAO23F,GAAcsf,aACzC,CAAEt2D,OAAO,EAAMl5D,QAAS,CAAEqH,KAAM,WAAYsnC,MAAOvvB,EAAIuvB,MAAO/5B,KAAMwK,EAAIxK,MAAQ,IAAIjiB,WAAW,KAC1G,KAAK,MAAY,CAEb,GAAiB,MAAbysB,EAAIk9B,MACJ,MAAO,CAAE4c,OAAO,EAAO3gD,MAAO23F,GAAcuf,cAChD,GAAyB,IAArBrwG,EAAIk9B,MAAMltD,OACV,MAAO,CAAE8pE,OAAO,EAAO3gD,MAAO23F,GAAcuf,cAEhD,GAAqB,MAAjBrwG,EAAIm9B,UACJ,MAAO,CAAE2c,OAAO,EAAO3gD,MAAO23F,GAAcwf,kBAChD,GAAgB,MAAZtwG,EAAIzgB,KACJ,MAAO,CAAEu6D,OAAO,EAAO3gD,MAAO23F,GAAcyf,eAChD,IAAIC,EAcAriG,EAbJ,IAEIqiG,EAAa,GAAgBxwG,EAAIzgB,KACrC,CACA,MAAOiD,GACH,MAAO,CAAEs3D,OAAO,EAAO3gD,MAAO23F,GAAcyf,cAChD,CAQA,GAAIvwG,EAAI9Y,KAGJ,GAFAinB,EAAY,GAAmBnO,EAAI9Y,UAENzG,IAAzB+vH,EAAWriG,YAA4B,GAAiBA,EAAU7xB,MAAOk0H,EAAWriG,WACpF,MAAO,CAAE2rC,OAAO,EAAO3gD,MAAO23F,GAAcyf,mBAG/C,CACD,GAA4B,MAAxBC,EAAWriG,UACX,MAAO,CAAE2rC,OAAO,EAAO3gD,MAAO23F,GAAcyf,eAEhDpiG,EAAY,GAAmBqiG,EAAWriG,UAC9C,CACA,MAAMsiG,EAAgB,CAClBlxH,KAAMygB,EAAIzgB,KACViW,KAAMwK,EAAIxK,KACV0nC,MAAOl9B,EAAIk9B,MACX3N,MAAOvvB,EAAIuvB,MACX4N,eAAW18C,EACXyG,SAAKzG,GAIHnE,EAAQ,GAAiB,CAACm/G,GAAYt/D,GAAIM,QAAQ30C,OAAO2oH,GAAe/xH,WAC9E,aAAYyvB,EAAUomC,OAAOj4D,EAAO0jB,EAAIm9B,WAGjC,CACH2c,OAAO,EACPl5D,QAAS,CACLqH,KAAM,SACN1I,KAAMixH,EACNh7G,KAAMwK,EAAIxK,MAAQ,IAAIjiB,WAAW,GACjCooH,eAAgB3gG,OAAO,KAAK,GAAmBgF,EAAIk9B,MAAO,aAC1D3N,MAAOvvB,EAAIuvB,MACX4N,UAAWn9B,EAAIm9B,UACfj2C,IAAK8Y,EAAI9Y,MZzEIA,EYyEoBinB,EZvEjDuiF,GADAzoG,GAAQA,GAAQ,OAAO3E,eAEhB4D,EAAI5K,SY2DQ,CAAEw9D,OAAO,EAAO3gD,MAAO23F,GAAcwf,iBAcpD,EZ5ED,IAA0BppH,EAAKe,CY8EtC,C0CspBuCyoH,CAAqB33H,KAAKkmH,sBAAuBwQ,GAChF,IAAKC,EAAiB51D,MAClB,MAAO,CAAE1yD,KAAM2pG,GAAckI,QAASnxC,OAAQ+oC,GAAav/G,MAAO6nB,MAAOu2G,EAAiBv2G,OAE9F,MAAM6G,EAAM0vG,EAAiB9uH,QAE7B,IACQ7H,KAAKqmH,gBACLp/F,EAAIxK,KAAOzc,KAAKqmH,cAAcuR,iBAAiBlB,EAAOlgF,MAAOvvB,EAAIxK,MAEzE,CACA,MAAOhT,GAEH,OADAzJ,KAAKrH,IAAI,oCAAqC8Q,GACvC,CAAE4E,KAAM2pG,GAAckI,QAASnxC,OAAQ+oC,GAAav/G,MAAO6nB,MAAO23F,GAAc8f,gBAC3F,CAMA,MAAMjhB,QAAc52G,KAAKknH,QAAQjgG,GAC3BuvF,EAAWx2G,KAAKk2G,aAAaU,GAC7BN,EAAY,CAAEM,QAAOJ,YAE3B,QAAqB9uG,IAAjBuvH,GAA8Bj3H,KAAKonH,eAAgB,CACjCpnH,KAAKonH,eAAel5G,IAAI+oH,EAAczgB,IAEpDx2G,KAAKulE,SAASiqD,wBAAwB7Q,KAE9C,CACA,GAAI3+G,KAAK2mH,UAAU3rG,IAAIw7F,GACnB,MAAO,CAAEnoG,KAAM2pG,GAAc4Z,UAAWpb,YAGxCx2G,KAAK2mH,UAAUz4G,IAAIsoG,GAKvB,MAAMshB,EAAiB93H,KAAKunH,gBAAgB5mH,IAAI+1H,EAAOlgF,OACvD,GAAsB,MAAlBshF,EAAwB,CACxB,IAAI5f,EAEJ,IACIA,QAAmB4f,EAAef,EAAmB9vG,EACzD,CACA,MAAOxd,GACH,MAAM0lE,EAAU1lE,EAAE4E,KhFtpBQ,+BgFupBtB8gE,IACA+oC,EAAa,cAEbA,EhF3pBsB,+BgF0pBtB/oC,EACa,aAEA,YACrB,CACA,GAAI+oC,IAAe,aACf,MAAO,CAAE7pG,KAAM2pG,GAAckI,QAASnxC,OAAQkpC,GAA2BC,GAAa1B,WAE9F,CACA,MAAO,CAAEnoG,KAAM2pG,GAAcj3C,MAAOu1C,YAAWrvF,MACnD,CAIA8wG,SAASj5D,GACL,OAAO9+D,KAAKo7G,MAAMA,MAAMt8C,EAC5B,CAIAi2D,kBAAkBiD,EAAQhhB,EAAQhzD,GAC9BhkD,KAAKi4H,QAAQD,EAAQ,CACjB30E,cAAe2zD,EAAOp8F,KAAK47B,IAAU,CAAGA,QAAOwN,iBAEvD,CAIA/lD,2BAA2BrE,EAAIs+H,GAC3B,QAAmBxwH,IAAfwwH,EACA,OAEJ,MAAMxzE,EAAQwzE,EAAWzzE,MAAQzkD,KAAKm4H,YAAYv+H,EAAIs+H,EAAWzzE,OAAS,GACpEA,EAAQyzE,EAAWxzE,MAAQ1kD,KAAKo4H,YAAYx+H,EAAIs+H,EAAWxzE,OAAS,GACpEE,EAAQszE,EAAWvzE,YAAc3kD,KAAKq4H,YAAYz+H,EAAIs+H,EAAWvzE,OAAS,GAEhF,GADAuzE,EAAWtzE,aAAgB5kD,KAAKs4H,YAAY1+H,EAAIs+H,EAAWtzE,QACtDF,EAAMztD,SAAWwtD,EAAMxtD,SAAW2tD,EAAM3tD,OACzC,OAEJ,MAAMshI,EAAOv4H,KAAKi4H,QAAQr+H,EAAI,CAAE47B,SAAUivB,EAAOjB,QAAS,CAAEkB,QAAOE,WAC7D4zE,EAAkB9zE,EAAM,IAAIO,WAC9BuzE,IACID,EACAv4H,KAAKynH,aAAavG,WAAWtnH,EAAI4+H,GAGjCx4H,KAAKulE,SAAS4pD,sBAAsBxQ,IAAI,GAGpD,CAIAsX,WAAWr8H,GACP,GAAIoG,KAAKymH,OAAOzrG,IAAIphB,GAChB,OAAO,EAEX,MAAMy9C,EAAMn+C,KAAKm+C,MACXvkC,EAAQ9S,KAAK4mH,oBAAoBjmH,IAAI/G,GAC3C,GAAIkZ,GAASA,EAAM2lH,iBhF1sBuB,KgF0sBkC3lH,EAAM4lH,aAAerhF,EAE7F,OADAvkC,EAAM2lH,kBAAoB,GACnB,EAEX,MAAMrd,EAAQp7G,KAAKo7G,MAAMA,MAAMxhH,GAY/B,OAXIwhH,GhFptByC,EgFutBzCp7G,KAAK4mH,oBAAoB/qH,IAAIjC,EAAI,CAC7B6+H,iBAAkB,EAClBC,YAAarhF,EhF/sBoB,MgFmtBrCr3C,KAAK4mH,oBAAoB3uG,OAAOre,GAE7BwhH,GAASp7G,KAAK+xC,KAAKw3E,gBAAgB3O,iBAC9C,CAIAud,YAAYv+H,EAAI6qD,GACZ,IAAKA,EAAMxtD,OACP,MAAO,GAGX,MAAMmkH,EAAQp7G,KAAKo7G,MAAMA,MAAMxhH,GAC/B,GAAIwhH,EAAQp7G,KAAK+xC,KAAKw3E,gBAAgB7O,gBAGlC,OAFA16G,KAAKrH,IAAI,oEAAqEiB,EAAIwhH,GAClFp7G,KAAKulE,SAASspD,gBAAgBlQ,IAAI,CAAE5vC,OAAQyzC,GAAkBmW,WACvD,GAGX,MAAM5R,GAAY/mH,KAAK+mH,SAASpmH,IAAI/G,IAAO,GAAK,EAEhD,GADAoG,KAAK+mH,SAASlrH,IAAIjC,EAAImtH,GAClBA,EhFpwB6B,GgFuwB7B,OAFA/mH,KAAKrH,IAAI,6FAA8FiB,EAAImtH,GAC3G/mH,KAAKulE,SAASspD,gBAAgBlQ,IAAI,CAAE5vC,OAAQyzC,GAAkBoW,WACvD,GAEX,MAAM5R,EAAShnH,KAAKgnH,OAAOrmH,IAAI/G,IAAO,EACtC,GAAIotH,GAAU,GAGV,OAFAhnH,KAAKrH,IAAI,yEAA0EiB,EAAIotH,GACvFhnH,KAAKulE,SAASspD,gBAAgBlQ,IAAI,CAAE5vC,OAAQyzC,GAAkBqW,YACvD,GAGX,MAAMn0E,EAAQ,IAAIpqC,IAelB,GAdAmqC,EAAMrkD,SAAQ,EAAG8kD,UAASD,iBACtB,IAAKC,IAAYD,IAAejlD,KAAK6mH,KAAK7rG,IAAIkqC,GAC1C,OAEJ,IAAI6rE,EAAY,EAChB9rE,EAAW7kD,SAASw2G,IAChB,MAAMJ,EAAWx2G,KAAKk2G,aAAaU,GAC9B52G,KAAK2mH,UAAU3rG,IAAIw7F,KACpB9xD,EAAM7oD,IAAI26G,EAAUI,GACpBma,IACJ,IAEJ/wH,KAAKulE,SAASurD,WAAW5rE,EAASD,EAAWhuD,OAAQ85H,EAAU,KAE9DrsE,EAAMjtD,KACP,MAAO,GAEX,IAAIqhI,EAAOp0E,EAAMjtD,KACbqhI,EAAO9R,EAAS,KAChB8R,EAAO,GAAoC9R,GAE/ChnH,KAAKrH,IAAI,kDAAmDmgI,EAAMp0E,EAAMjtD,KAAMmC,GAC9E,IAAIm/H,EAAYngI,MAAM4N,KAAKk+C,EAAM/oD,UAOjC,OALA87G,GAAQshB,GAERA,EAAYA,EAAUjgI,MAAM,EAAGggI,GAC/B94H,KAAKgnH,OAAOnrH,IAAIjC,EAAIotH,EAAS8R,GAEtB,CACH,CACI7zE,WAAY8zE,GAGxB,CAKAX,YAAYx+H,EAAI8qD,GACZ,IAAKA,EAAMztD,OACP,MAAO,GAGX,MAAMmkH,EAAQp7G,KAAKo7G,MAAMA,MAAMxhH,GAC/B,GAAIwhH,EAAQp7G,KAAK+xC,KAAKw3E,gBAAgB7O,gBAElC,OADA16G,KAAKrH,IAAI,kEAAmEiB,EAAIwhH,GACzE,GAEX,MAAM32D,EAAQ,IAAInqC,IACZ22G,EAAe,IAAI32G,IACzB,IAAI42G,EAAgB,EAmBpB,OAlBAxsE,EAAMtkD,SAAQ,EAAG6kD,iBACbA,GACIA,EAAW7kD,SAASw2G,IAChB,MAAMJ,EAAWx2G,KAAKk2G,aAAaU,GAC7B9jG,EAAQ9S,KAAKsnH,OAAOxQ,kBAAkBN,EAAU58G,GACzC,MAATkZ,GAIJm+G,EAAap1H,IAAIiX,EAAMmU,IAAIuvB,MAAO,GAAKy6E,EAAatwH,IAAImS,EAAMmU,IAAIuvB,QAAU,IACxE1jC,EAAMxB,MhFz6Be,EgF06BrBtR,KAAKrH,IAAI,2EAA4EiB,EAAIg9G,GAG7FnyD,EAAM5oD,IAAI26G,EAAU1jG,EAAMmU,MARtBiqG,GAQ0B,GAChC,IAEVlxH,KAAKulE,SAASyrD,WAAWC,EAAcC,GAClCzsE,EAAMhtD,MAIXuI,KAAKrH,IAAI,mCAAoC8rD,EAAMhtD,KAAMmC,GAClDhB,MAAM4N,KAAKi+C,EAAM9oD,YAJpBqE,KAAKrH,IAAI,qDAAsDiB,GACxD,GAIf,CAIAqE,kBAAkBrE,EAAI+qD,GAClB,MAAMC,EAAQ,GACRw2D,EAAQp7G,KAAKo7G,MAAMA,MAAMxhH,GACzBy9C,EAAMn+C,KAAKm+C,MACjB,IAAI4wE,EAAOjoH,KAAK+xC,KAAKk2E,KAqErB,GApEAtjE,EAAMvkD,SAAQ,EAAG8kD,cACb,IAAKA,EACD,OAEJ,MAAM4tE,EAAc9yH,KAAK6mH,KAAKlmH,IAAIukD,GAClC,IAAK4tE,EAID,YAFA7K,GAAO,GAKX,GAAI6K,EAAY93G,IAAIphB,GAChB,OAGJ,GAAIoG,KAAKymH,OAAOzrG,IAAIphB,GAMhB,OALAoG,KAAKrH,IAAI,8CAA+CiB,GAExDgrD,EAAMltD,KAAKwtD,QAEX+iE,GAAO,GAIX,MAAMruE,EAAS55C,KAAKqlD,QAAQ1kD,IAAIukD,IAAUvkD,IAAI/G,GAC9C,GAAsB,iBAAXggD,GAAuBvC,EAAMuC,EAAQ,CAC5C55C,KAAKrH,IAAI,qCAAsCiB,GAE/CoG,KAAKo7G,MAAM4D,WAAWplH,EAAI,EAAG2oH,GAAayW,cAE1C/Q,GAAO,EAEP,MAAMgR,EAAcr/E,EAAS55C,KAAK+xC,KAAKm3E,oBAAsBlpH,KAAK+xC,KAAKi3E,aAQvE,OAPI3xE,EAAM4hF,GAENj5H,KAAKo7G,MAAM4D,WAAWplH,EAAI,EAAG2oH,GAAayW,cAG9Ch5H,KAAKk5H,WAAWt/H,EAAIsrD,QACpBN,EAAMltD,KAAKwtD,EAEf,CAEA,OAAIk2D,EAAQ,GAERp7G,KAAKrH,IAAI,kEAAmEiB,EAAIwhH,EAAOl2D,GAEvFN,EAAMltD,KAAKwtD,GAEX+iE,GAAO,OAEPjoH,KAAKk5H,WAAWt/H,EAAIsrD,IAMpB4tE,EAAYr7H,MAAQuI,KAAK+xC,KAAKq2E,MAAQpoH,KAAKinH,SAAStmH,IAAI/G,IACxDgrD,EAAMltD,KAAKwtD,QACXllD,KAAKk5H,WAAWt/H,EAAIsrD,KAGxBllD,KAAKrH,IAAI,qCAAsCiB,EAAIsrD,GACnDllD,KAAKo7G,MAAMz2D,MAAM/qD,EAAIsrD,GACrB4tE,EAAY96G,IAAIpe,QAChBoG,KAAKulE,SAASuqD,YAAY5qE,EAASm9D,GAAgB4N,WAAY,GAAE,KAEhErrE,EAAM3tD,OACP,MAAO,GAGX,aAAaua,QAAQQ,IAAI4yC,EAAMhqC,KAAK47B,GAAUx2C,KAAKm5H,UAAUv/H,EAAI48C,EAAOyxE,EADlD,SAE1B,CAIAhqH,kBAAkBrE,EAAIgrD,GAClB,MAAMw2D,EAAQp7G,KAAKo7G,MAAMA,MAAMxhH,GAC/B,IAAK,MAAM,QAAEsrD,EAAO,QAAEG,EAAO,MAAED,KAAWR,EAAO,CAC7C,GAAe,MAAXM,EACA,SAEJ,MAAM4tE,EAAc9yH,KAAK6mH,KAAKlmH,IAAIukD,GAClC,IAAK4tE,EACD,OAgBJ,GAdA9yH,KAAKrH,IAAI,sCAAuCiB,EAAIsrD,GACpDllD,KAAKo7G,MAAMx2D,MAAMhrD,EAAIsrD,GACjB4tE,EAAY93G,IAAIphB,KAChBk5H,EAAY76G,OAAOre,GACnBoG,KAAKulE,SAAS8qD,iBAAiBnrE,EAASo9D,GAAYkO,MAAO,IAGxC,iBAAZnrE,GAAwBA,EAAU,EACzCrlD,KAAKo5H,aAAax/H,EAAIsrD,EAAmB,IAAVG,GAG/BrlD,KAAKk5H,WAAWt/H,EAAIsrD,GAGpBE,GAASA,EAAMnuD,OAAQ,CAEvB,GAAImkH,EAAQp7G,KAAK+xC,KAAKw3E,gBAAgB1O,kBAAmB,CACrD76G,KAAKrH,IAAI,mFAAoFiB,EAAIwhH,EAAOl2D,GACxG,QACJ,OACMllD,KAAKq5H,UAAUj0E,EACzB,CACJ,CACJ,CAIA8zE,WAAWt/H,EAAI48C,GACXx2C,KAAKo5H,aAAax/H,EAAI48C,EAAOx2C,KAAK+xC,KAAKi3E,aAC3C,CAQAoQ,aAAax/H,EAAI48C,EAAO8iF,GACpB,IAAIj0E,EAAUrlD,KAAKqlD,QAAQ1kD,IAAI61C,GAC1B6O,IACDA,EAAU,IAAI/qC,IACdta,KAAKqlD,QAAQxpD,IAAI26C,EAAO6O,IAE5B,MAAMzL,EAAS1gD,KAAKm+C,MAAQiiF,GACLj0E,EAAQ1kD,IAAI/G,IAAO,GACrBggD,GACjByL,EAAQxpD,IAAIjC,EAAIggD,EAExB,CAIA2/E,sBACIv5H,KAAKynH,aAAapG,oBAAoBjhH,SAAQ,CAACkR,EAAO/V,KAClDyE,KAAKrH,IAAI,gEAAiE4C,EAAG+V,GAC7EtR,KAAKo7G,MAAM4D,WAAWzjH,EAAG+V,EAAOixG,GAAaiX,cAAc,GAEnE,CAIAC,eAEI,GAAIz5H,KAAKwnH,ehF7iCyB,IgF6iCiC,EAC/D,OAEJ,MAAMnwE,EAAMn+C,KAAKm+C,MACjBr3C,KAAKqlD,QAAQjlD,SAAQ,CAACilD,EAAS7O,KAC3B6O,EAAQjlD,SAAQ,CAACw5C,EAAQhgD,KAEjBggD,EhFj+BS,EgFi+BgB55C,KAAK+xC,KAAKy2E,kBAAoBnxE,GACvDgO,EAAQptC,OAAOre,EACnB,IAEiB,IAAjByrD,EAAQ5tD,MACRuI,KAAKqlD,QAAQptC,OAAOu+B,EACxB,GAER,CAIAv4C,sBACI,MAAMy7H,EAAY,GAClB15H,KAAKymH,OAAOrmH,SAASxG,IACZoG,KAAKumH,gBAAgBvrG,IAAIphB,IAC1B8/H,EAAUhiI,KAAKkC,EACnB,UAEE4X,QAAQQ,IAAI0nH,EAAU9+G,KAAI3c,MAAOrE,SAAaoG,KAAKw0H,QAAQ56H,KACrE,CAIAqE,gBAAgBmnD,GACRA,EAAMnuD,OAAS+I,KAAK+xC,KAAKg3E,aACzBtR,GAAQryD,GACRA,EAAQA,EAAMtsD,MAAM,EAAGkH,KAAK+xC,KAAKg3E,aAErC,MAAM2Q,EAAY,SACZloH,QAAQQ,IAAIozC,EAAMxqC,KAAI3c,MAAO07H,IAC/B,IAAKA,EAAGl0E,OACJ,OAEJ,MAAMw1D,EAAO,GAAgB0e,EAAGl0E,QAC1BlqD,EAAI0/G,EAAKt2G,WACf,IAAI3E,KAAKolD,MAAMpqC,IAAIzf,GAGnB,GAAKo+H,EAAGj0E,iBAOR,IACI,UAAY1lD,KAAKgkF,WAAW2vC,UAAUiG,kBAAkBD,EAAGj0E,iBAAkBu1D,GAEzE,YADAj7G,KAAKrH,IAAI,oFAGb+gI,EAAUhiI,KAAK6D,EACnB,CACA,MAAOkO,GACHzJ,KAAKrH,IAAI,gFACb,MAfI+gI,EAAUhiI,KAAK6D,EAenB,KAECm+H,EAAUziI,cAGTua,QAAQQ,IAAI0nH,EAAU9+G,KAAI3c,MAAOrE,SAAaoG,KAAKw0H,QAAQ56H,KACrE,CAIAqE,cAAcrE,GACVoG,KAAKrH,IAAI,gCAAiCiB,GAC1C,MAAMklE,EAAST,GAAiBzkE,GAC1B2qE,QAAmBvkE,KAAKgkF,WAAW1nC,kBAAkBu9E,eAAe/6D,GAC1E,IAAK,MAAMi1D,KAAc/zH,KAAKmmH,YAC1B,IAAK,MAAM3tE,KAAYx4C,KAAKgkF,WAAW8vC,UAAUgG,cAAc/F,GAC3Dv7E,EAASw7E,YAAYl1D,EAAQyF,EAGzC,CAIAvgB,UAAUxN,GACN,GAAIx2C,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QACtC,MAAM,IAAI76H,MAAM,0BAEpB,IAAKyH,KAAKqjD,cAAcroC,IAAIw7B,GAAQ,CAChCx2C,KAAKqjD,cAAcrrC,IAAIw+B,GACvB,IAAK,MAAMsoB,KAAU9+D,KAAKolD,MAAM39C,OAC5BzH,KAAK+0H,kBAAkBj2D,EAAQ,CAACtoB,IAAQ,EAEhD,CACAx2C,KAAKrI,KAAK6+C,EACd,CAIA0jD,YAAY1jD,GACR,GAAIx2C,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QACtC,MAAM,IAAI76H,MAAM,yBAEpB,MAAMwhI,EAAgB/5H,KAAKqjD,cAAcprC,OAAOu+B,GAEhD,GADAx2C,KAAKrH,IAAI,yCAA0C69C,EAAOujF,GACtDA,EACA,IAAK,MAAMj7D,KAAU9+D,KAAKolD,MAAM39C,OAC5BzH,KAAK+0H,kBAAkBj2D,EAAQ,CAACtoB,IAAQ,GAGhDx2C,KAAKg6H,MAAMxjF,EACf,CAIA7+C,KAAK6+C,GACD,GAAIx2C,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QACtC,MAAM,IAAI76H,MAAM,6BAGpB,GAAIyH,KAAK6mH,KAAK7rG,IAAIw7B,GACd,OAEJx2C,KAAKrH,IAAI,UAAW69C,GACpBx2C,KAAKulE,SAASqqD,OAAOp5E,GACrB,MAAMyjF,EAAQ,IAAIvlH,IACZ2wC,EAAUrlD,KAAKqlD,QAAQ1kD,IAAI61C,GAG3B0jF,EAAcl6H,KAAK2xE,OAAOhxE,IAAI61C,GAcpC,GAbI0jF,IAEAl6H,KAAK2xE,OAAO15D,OAAOu+B,GACnBx2C,KAAK8mH,cAAc7uG,OAAOu+B,GAE1B0jF,EAAY95H,SAASxG,IACZoG,KAAKymH,OAAOzrG,IAAIphB,MAAOoG,KAAKo7G,MAAMA,MAAMxhH,IAAO,IAAOyrD,GAAYA,EAAQrqC,IAAIphB,IAC/EqgI,EAAMjiH,IAAIpe,EACd,IAEJoG,KAAKulE,SAASuqD,YAAYt5E,EAAO6rE,GAAgB0N,OAAQkK,EAAMxiI,OAG/DwiI,EAAMxiI,KAAOuI,KAAK+xC,KAAK/U,EAAG,CAC1B,MAAMm9F,EAAcF,EAAMxiI,KACTuI,KAAKo6H,qBAAqB5jF,EAAOx2C,KAAK+xC,KAAK/U,GAAIpjC,IAE/DqgI,EAAMj/G,IAAIphB,KAAQoG,KAAKymH,OAAOzrG,IAAIphB,IAAOoG,KAAKo7G,MAAMA,MAAMxhH,IAAO,KAAOyrD,IAAYA,EAAQrqC,IAAIphB,MACxFwG,SAAS66G,IACdgf,EAAMjiH,IAAIijG,EAAK,IAEnBj7G,KAAKulE,SAASuqD,YAAYt5E,EAAO6rE,GAAgB2N,OAAQiK,EAAMxiI,KAAO0iI,EAC1E,CACAn6H,KAAK6mH,KAAKhrH,IAAI26C,EAAOyjF,GACrBA,EAAM75H,SAASxG,IACXoG,KAAKrH,IAAI,kCAAmCiB,EAAI48C,GAChDx2C,KAAKq6H,UAAUzgI,EAAI48C,EAAM,GAMjC,CAIAwjF,MAAMxjF,GACF,GAAIx2C,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QACtC,MAAM,IAAI76H,MAAM,6BAEpByH,KAAKrH,IAAI,WAAY69C,GACrBx2C,KAAKulE,SAASsqD,QAAQr5E,GAEtB,MAAM8jF,EAAYt6H,KAAK6mH,KAAKlmH,IAAI61C,GAC5B8jF,IACA9oH,QAAQQ,IAAIpZ,MAAM4N,KAAK8zH,GAAW1/G,KAAI3c,MAAOrE,IACzCoG,KAAKrH,IAAI,sCAAuCiB,EAAI48C,SACvCx2C,KAAKu6H,UAAU3gI,EAAI48C,OAChC/oB,OAAO7nB,IACP5F,KAAKrH,IAAI,qCAAsCiN,EAAI,IAEvD5F,KAAK6mH,KAAK5uG,OAAOu+B,GAEzB,CACAgkF,qBAAqBhkF,EAAOugF,EAAmB0D,GAC3C,MAAMC,EAAS,IAAIhmH,IAEbkhH,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GACjCo/E,IACA51H,KAAKymH,OAAOrmH,SAAS66G,IACb2a,EAAa56G,IAAIigG,IAAS8b,IAAsB9b,IAASwf,GAAcz/G,IAAIigG,IAC3Eyf,EAAO1iH,IAAIijG,EACf,IAKJj7G,KAAK0mH,cAActmH,SAAS66G,IACpB2a,EAAa56G,IAAIigG,IACjB8b,IAAsB9b,IACrBwf,GAAcz/G,IAAIigG,IACnBj7G,KAAKo7G,MAAMA,MAAMH,IAASj7G,KAAK+xC,KAAKw3E,gBAAgB5O,kBACpD+f,EAAO1iH,IAAIijG,EACf,KAIR,MAAMqf,EAAYt6H,KAAK6mH,KAAKlmH,IAAI61C,GAQhC,OAPI8jF,GAAaA,EAAU7iI,KAAO,GAC9B6iI,EAAUl6H,SAAS66G,IACX8b,IAAsB9b,GAASwf,GAAcz/G,IAAIigG,IACjDyf,EAAO1iH,IAAIijG,EACf,IAGDyf,CACX,CACAC,qBAAqBnkF,GACjB,MAAMkkF,EAAS,IAAIhmH,IACb08G,EAAc,CAChB3K,OAAQ,EACR+K,SAAU,EACV3K,KAAM,EACNl1C,OAAQ,GAENikD,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GACrC,GAAIo/E,EAGA,GAAI51H,KAAK+xC,KAAKi2E,aACV4N,EAAax1H,SAASxG,IACdoG,KAAKymH,OAAOzrG,IAAIphB,IAChB8gI,EAAO1iH,IAAIpe,GACXw3H,EAAY3K,UAEPzmH,KAAKo7G,MAAMA,MAAMxhH,IAAOoG,KAAK+xC,KAAKw3E,gBAAgB5O,mBACvD+f,EAAO1iH,IAAIpe,GACXw3H,EAAYI,WAChB,QAGH,CAKDxxH,KAAKymH,OAAOrmH,SAASxG,IACbg8H,EAAa56G,IAAIphB,KACjB8gI,EAAO1iH,IAAIpe,GACXw3H,EAAY3K,SAChB,IAIJzmH,KAAK0mH,cAActmH,SAASxG,IACpBg8H,EAAa56G,IAAIphB,IAAOoG,KAAKo7G,MAAMA,MAAMxhH,IAAOoG,KAAK+xC,KAAKw3E,gBAAgB5O,mBAC1E+f,EAAO1iH,IAAIpe,GACXw3H,EAAYI,WAChB,IAGJ,MAAM8I,EAAYt6H,KAAK6mH,KAAKlmH,IAAI61C,GAChC,GAAI8jF,GAAaA,EAAU7iI,KAAO,EAC9B6iI,EAAUl6H,SAAS66G,IACfyf,EAAO1iH,IAAIijG,GACXmW,EAAYvK,MAAM,QAIrB,CACD,MAAMqT,EAAcl6H,KAAK2xE,OAAOhxE,IAAI61C,GACpC,GAAI0jF,GAAeA,EAAYziI,KAAO,EAClCyiI,EAAY95H,SAAS66G,IACjByf,EAAO1iH,IAAIijG,GACXmW,EAAYz/C,QAAQ,QAIvB,CAED,MAAMipD,EAAiB56H,KAAKo6H,qBAAqB5jF,EAAOx2C,KAAK+xC,KAAK/U,GAAIpjC,GAC3DoG,KAAKo7G,MAAMA,MAAMxhH,IAAOoG,KAAK+xC,KAAKw3E,gBAAgB5O,mBAEzDigB,EAAenjI,KAAO,IAEtBuI,KAAK2xE,OAAO91E,IAAI26C,EAAOokF,GACvBA,EAAex6H,SAAS66G,IAEpByf,EAAO1iH,IAAIijG,GACXmW,EAAYz/C,QAAQ,IAGhC,CAEA3xE,KAAK8mH,cAAcjrH,IAAI26C,EAAOt9C,KAAKm+C,MACvC,CACJ,CAEJ,MAAO,CAAEqjF,SAAQtJ,cACrB,CAMA4F,eAAexgB,EAAUqkB,EAAQ9D,EAAmB0D,GAE5C1D,GACA/2H,KAAKo7G,MAAMsE,eAAeqX,EAAmBvgB,EAAUqkB,EAAOrkF,OAElE,MAAMkkF,EAAS16H,KAAKw6H,qBAAqBK,EAAOrkF,MAAOugF,EAAmB0D,GAG1EC,EAAOt6H,SAASxG,IAEZoG,KAAKi4H,QAAQr+H,EAAI,CAAE47B,SAAU,CAACqlG,IAAU,IAE5C76H,KAAKulE,SAAS4rD,aAAa0J,EAAOrkF,MAAOkkF,EAAOjjI,KACpD,CAOAwG,cAAcu4C,EAAO/5B,EAAMs1B,GACvB,MAAM+oF,EAAU5hI,KAAKm+C,MACf0jF,EAAkB/6H,KAAKqmH,cAAgBrmH,KAAKqmH,cAAc2U,kBAAkBxkF,EAAO/5B,GAAQA,EACjG,GAA0B,MAAtBzc,KAAKomH,cACL,MAAM7tH,MAAM,8BAGhB,MAAQ89C,IAAKwkF,EAAM,IAAE5zG,S1C3+CtBhpB,eAA+BmoH,EAAe5vE,EAAOykF,EAAcF,GACtE,OAAQ3U,EAAcl3G,MAClB,KAAK2oG,GAAkByb,QAAS,CAC5B,MAAMoD,EAAS,CACXlwH,KAAM4/G,EAAcmN,OAAOvpE,UAC3BvtC,KAAMs+G,EACN52E,MAAO,GAAY,GACnB3N,QACA4N,eAAW18C,EACXyG,SAAKzG,GAIHnE,EAAQ,GAAiB,CAACm/G,GAAYt/D,GAAIM,QAAQ30C,OAAO2nH,GAAQ/wH,WAYvE,OAXA+wH,EAAOtyE,gBAAkBgiE,EAAcz4D,WAAWpnD,KAAKhD,GACvDmzH,EAAOvoH,IAAMi4G,EAAcj4G,IAUpB,CACHkoC,IAAKqgF,EACLzvG,IAXQ,CACR/X,KAAM,SACN1I,KAAM4/G,EAAcmN,OACpB92G,KAAMw+G,EACNrY,eAAgB3gG,OAAO,KAAK,GAAmBy0G,EAAOvyE,MAAO,aAC7D3N,QACA4N,UAAWsyE,EAAOtyE,UAClBj2C,IAAKuoH,EAAOvoH,KAMpB,CACA,KAAK0pG,GAAkB2b,UACnB,MAAO,CACHn9E,IAAK,CACD7vC,UAAMkB,EACN+U,KAAMs+G,EACN52E,WAAOz8C,EACP8uC,QACA4N,eAAW18C,EACXyG,SAAKzG,GAETuf,IAAK,CACD/X,KAAM,WACNuN,KAAMw+G,EACNzkF,UAKpB,C0C27C2C0kF,CAAgBl7H,KAAKomH,cAAe5vE,EAAO/5B,EAAMs+G,GAE9EnkB,QAAc52G,KAAKknH,QAAQjgG,GAC3BuvF,EAAWx2G,KAAKk2G,aAAaU,GAE7BukB,EAA8BppF,GAAMopF,6BAA+Bn7H,KAAK+xC,KAAKopF,4BACnF,GAAIn7H,KAAK2mH,UAAU3rG,IAAIw7F,GAAW,CAG9B,GAAI2kB,EAEA,OADAn7H,KAAKulE,SAASusD,sBAAsBt7E,GAC7B,CAAEy/C,WAAY,IAEzB,MAAM19F,MAAM,yBAChB,CACA,MAAM,OAAEmiI,EAAM,YAAEtJ,GAAgBpxH,KAAK26H,qBAAqBnkF,GACpD4kF,GAAwC,IAAvBp7H,KAAK+xC,KAAK+kF,UAAqB92H,KAAKqjD,cAAcroC,IAAIw7B,GAEvE6kF,EAA0BtpF,GAAMspF,yBAA2Br7H,KAAK+xC,KAAKspF,wBAC3E,GAAoB,IAAhBX,EAAOjjI,OAAe4jI,IAA4BD,EAClD,MAAM7iI,MAAM,kCAIhByH,KAAK2mH,UAAUz4G,IAAIsoG,GAEnBx2G,KAAKsnH,OAAOp5G,IAAI,CAAE0oG,QAAOJ,YAAYqkB,GAAQ,GAE7C76H,KAAKqnH,oBAAoBn5G,IAAIsoG,GAE7B,IAAK,MAAM58G,KAAM8gI,EAAQ,CAER16H,KAAKi4H,QAAQr+H,EAAI,CAAE47B,SAAU,CAACqlG,MAGvCH,EAAOziH,OAAOre,EAEtB,CACA,MAAM8oD,EAAaxpD,KAAKm+C,MAAQyjF,EAehC,OAdA96H,KAAKulE,SAAS8rD,aAAa76E,EAAO46E,EAAasJ,EAAOjjI,KAAqB,MAAfojI,EAAOp+G,KAAeo+G,EAAOp+G,KAAKxlB,OAAS,EAAGyrD,GAEtG04E,IACAV,EAAO1iH,IAAIhY,KAAKgkF,WAAWllB,OAAOn6D,YAClCgO,MAAMyjH,cAAc,IAAI,KAAY,oBAAqB,CACrD/7B,OAAQ,CACJ08B,kBAAmB/2H,KAAKgkF,WAAWllB,OACnC83C,MAAOJ,EACPvvF,UAIRtU,MAAMyjH,cAAc,IAAI,KAAY,UAAW,CAAE/7B,OAAQpzE,MAEtD,CACHgvE,WAAYr9F,MAAM4N,KAAKk0H,EAAO/+H,UAAUif,KAAKvf,GAAQgjE,GAAiBhjE,KAE9E,CAsBAigI,8BAA8B1kB,EAAOmgB,EAAmB7e,GACpD,IAAId,EACJ,GAAIc,IAAe,cAEf,GADAd,EAAap3G,KAAKsnH,OAAOnQ,SAASP,GAChB,MAAdQ,EAAoB,CACpB,MAAQvvG,QAASgzH,EAAM,iBAAEpkB,GAAqBW,EAE9Cp3G,KAAKo7G,MAAMsE,eAAeqX,EAAmBngB,EAAOikB,EAAOrkF,OAC3Dx2C,KAAKg3H,eAAepgB,EAAOQ,EAAWvvG,QAASkvH,EAAmBtgB,EACtE,OAMA,GADAW,EAAap3G,KAAKsnH,OAAOzhF,OAAO+wE,GAC5BQ,EAAY,CACZ,MAAMmkB,EAAetjB,GAA2BC,IACxCrwG,QAASgzH,EAAM,iBAAEpkB,GAAqBW,EAG9Cp3G,KAAKo7G,MAAM2E,cAAcgX,EAAmBngB,EAAOikB,EAAOrkF,MAAO+kF,GACjE,IAAK,MAAMtgB,KAAQxE,EACfz2G,KAAKo7G,MAAM2E,cAAc9E,EAAMrE,EAAOikB,EAAOrkF,MAAO+kF,EAE5D,CAGJ,MAAM3K,EAAuB5wH,KAAKo7G,MAAMiD,4BAA4BzH,GACpE52G,KAAKulE,SAASmrD,mBAAmBtZ,EAAYc,EAAY0Y,EAC7D,CAIAyJ,UAAUzgI,EAAI48C,GACV,MAAMmO,EAAQ,CACV,CACIO,QAAS1O,IAGjBx2C,KAAKi4H,QAAQr+H,EAAI,CAAE4pD,QAAS,CAAEmB,UAClC,CAIA1mD,gBAAgBrE,EAAI48C,GAEhB,MACMoO,EAAQ,OAAO5kD,KAAKm5H,UAAUv/H,EAAI48C,EAAOx2C,KAAK+xC,KAAKk2E,MADnC,IAEtBjoH,KAAKi4H,QAAQr+H,EAAI,CAAE4pD,QAAS,CAAEoB,UAClC,CAIAqzE,QAAQr+H,EAAI6H,GACR,MAAMizH,EAAiB10H,KAAKumH,gBAAgB5lH,IAAI/G,GAChD,IAAK86H,EAED,OADA10H,KAAKrH,IAAI,sBAAsBiB,iDACxB,EAGX,MAAM4hI,EAAOx7H,KAAKwjD,QAAQ7iD,IAAI/G,GAC1B4hI,IACAx7H,KAAKy7H,iBAAiB7hI,EAAI6H,EAAK+5H,GAC/Bx7H,KAAKwjD,QAAQvrC,OAAOre,IAGxB,MAAM6qD,EAAQzkD,KAAKg2G,OAAOr1G,IAAI/G,GAC1B6qD,IACAzkD,KAAK07H,gBAAgB9hI,EAAI6H,EAAKgjD,GAC9BzkD,KAAKg2G,OAAO/9F,OAAOre,IAEvB,MAAMu4H,EAAW/uE,GAAIr0C,OAAOtN,GAAKkE,SACjC,IACI+uH,EAAeh9H,KAAKy6H,EACxB,CACA,MAAO1oH,GASH,OARAzJ,KAAKrH,IAAIynB,MAAM,sBAAsBxmB,IAAM6P,GAEvC+xH,GACAx7H,KAAKwjD,QAAQ3nD,IAAIjC,EAAI4hI,GAErB/2E,GACAzkD,KAAKg2G,OAAOn6G,IAAIjC,EAAI6qD,IAEjB,CACX,CAEA,OADAzkD,KAAKulE,SAAS6sD,UAAU3wH,EAAK0wH,EAASl7H,SAC/B,CACX,CAEAwkI,iBAAiB7hI,EAAI+hI,EAAQH,GACzB,GAAIA,EAAK72E,MAAO,CACPg3E,EAAOn4E,UACRm4E,EAAOn4E,QAAU,CAAC,GACjBm4E,EAAOn4E,QAAQmB,QAChBg3E,EAAOn4E,QAAQmB,MAAQ,IAC3B,IAAK,MAAMA,KAAS62E,EAAK72E,MACjBA,EAAMO,SAAWllD,KAAK6mH,KAAKlmH,IAAIgkD,EAAMO,UAAUlqC,IAAIphB,IACnD+hI,EAAOn4E,QAAQmB,MAAMjtD,KAAKitD,EAGtC,CACA,GAAI62E,EAAK52E,MAAO,CACP+2E,EAAOn4E,UACRm4E,EAAOn4E,QAAU,CAAC,GACjBm4E,EAAOn4E,QAAQoB,QAChB+2E,EAAOn4E,QAAQoB,MAAQ,IAC3B,IAAK,MAAMA,KAAS42E,EAAK52E,MACjBA,EAAMM,UAAYllD,KAAK6mH,KAAKlmH,IAAIikD,EAAMM,UAAUlqC,IAAIphB,IACpD+hI,EAAOn4E,QAAQoB,MAAMltD,KAAKktD,EAGtC,CACJ,CAEA82E,gBAAgB9hI,EAAI+hI,EAAQl3E,GACnBk3E,EAAOn4E,UACRm4E,EAAOn4E,QAAU,CAAC,GACtBm4E,EAAOn4E,QAAQiB,MAAQA,CAC3B,CAOAxmD,qBAAqB29H,EAASC,EAASC,GACnC,MAAM7T,EAAOjoH,KAAK+xC,KAAKk2E,KAEvB,IAAK,MAAOruH,EAAIo9G,KAAW4kB,EAAS,CAChC,MAAMj3E,EAAQqyD,EAAOp8F,KAAKsqC,IAAY,CAAGA,cACzC,IAAIN,EAAQ,GAEZ,MAAMm3E,EAAUF,EAAQl7H,IAAI/G,GACxBmiI,IACAn3E,QAAcpzC,QAAQQ,IAAI+pH,EAAQnhH,KAAI3c,MAAOinD,SAAkBllD,KAAKm5H,UAAUv/H,EAAIsrD,EAAS+iE,IAAU6T,EAAKn7H,IAAI/G,GAPhG,UAQdiiI,EAAQ5jH,OAAOre,IAEnBoG,KAAKi4H,QAAQr+H,EAAI,CAAE4pD,QAAS,CAAEmB,QAAOC,UACzC,CACA,IAAK,MAAOhrD,EAAIo9G,KAAW6kB,EAAS,CAChC,MAAMj3E,QAAcpzC,QAAQQ,IAAIglG,EAAOp8F,KAAI3c,MAAOinD,SAAkBllD,KAAKm5H,UAAUv/H,EAAIsrD,EAAS+iE,IAAU6T,EAAKn7H,IAAI/G,GAbjG,UAclBoG,KAAKi4H,QAAQr+H,EAAI,CAAE4pD,QAAS,CAAEoB,UAClC,CACJ,CAIAo3E,WAAWC,GACP,MAAMC,EAAmBl8H,KAAKsnH,OAAOvQ,aAAa,IAAIriG,IAAIunH,EAAqBx0H,SAC/E,IAAK,MAAO+uC,EAAO2lF,KAAkBF,EACjCj8H,KAAKo8H,aAAa5lF,EAAO2lF,EAAeD,EAAiBv7H,IAAI61C,IAAU,GAE/E,CASA4lF,aAAa5lF,EAAO6lF,EAAmBp3E,GACnC,IAAKA,EAAWhuD,OACZ,OASJ,GANAwgH,GAAQxyD,GAEJA,EAAWhuD,OAAS,IAEpB+I,KAAKrH,IAAI,uEAAwEssD,EAAWhuD,SAE3FolI,EAAkB5kI,KACnB,OACJ,IAAI4a,EAASrS,KAAK+xC,KAAKw2E,MACvB,MAAM+T,EhFvqDuB,IgFuqDoBD,EAAkB5kI,KACnE,IAAI0kI,EAAgBE,EAChBC,EAASjqH,IACTA,EAASiqH,GAETjqH,EAAS8pH,EAAc1kI,KACvB4a,EAAS8pH,EAAc1kI,KAIvB0kI,EAAgB1kB,GAAQ7+G,MAAM4N,KAAK21H,IAAgBrjI,MAAM,EAAGuZ,GAGhE8pH,EAAc/7H,SAASxG,IACnB,IAAI2iI,EAAiBt3E,EACjBA,EAAWhuD,OAAS,KAIpBslI,EAAiB9kB,GAAQ8kB,EAAezjI,SAASA,MAAM,EAAG,KAE9DkH,KAAKw8H,WAAW5iI,EAAI,CAChBsrD,QAAS1O,EACTyO,WAAYs3E,GACd,GAEV,CAIAjmD,QAEI,IAAK,MAAO2kC,EAAMx2D,KAAUzkD,KAAKg2G,OAAOnjG,UACpC7S,KAAKg2G,OAAO/9F,OAAOgjG,GACnBj7G,KAAKi4H,QAAQhd,EAAM,CAAEz3D,QAAS,CAAEiB,WAGpC,IAAK,MAAOw2D,EAAMz3D,KAAYxjD,KAAKwjD,QAAQ3wC,UACvC7S,KAAKwjD,QAAQvrC,OAAOgjG,GACpBj7G,KAAKi4H,QAAQhd,EAAM,CAAEz3D,QAAS,CAAEmB,MAAOnB,EAAQmB,MAAOC,MAAOpB,EAAQoB,QAE7E,CAIA43E,WAAW5iI,EAAI6iI,GACXz8H,KAAKrH,IAAI,mBAAoBiB,GAC7B,MAAMo8G,EAASh2G,KAAKg2G,OAAOr1G,IAAI/G,IAAO,GACtCoG,KAAKg2G,OAAOn6G,IAAIjC,EAAIo8G,EAAOn8F,OAAO4iH,GACtC,CAIAx+H,gBAAgBrE,EAAI48C,EAAOyxE,EAAMyU,GAE7B,GADA18H,KAAKo7G,MAAMx2D,MAAMhrD,EAAI48C,GACjBx2C,KAAKumH,gBAAgB5lH,IAAI/G,GAAIyrE,WAAa,GAE1C,MAAO,CACHngB,QAAS1O,EACT4O,MAAO,IAMf,MAAMu3E,EAAYD,EAAgB18H,KAAK+xC,KAAKk3E,kBAAoBjpH,KAAK+xC,KAAKi3E,aACpE3jE,EAAUs3E,EAAY,IAE5B,GADA38H,KAAKo5H,aAAax/H,EAAI48C,EAAOmmF,IACxB1U,EACD,MAAO,CACH/iE,QAAS1O,EACT4O,MAAO,GACPC,QAASA,GAIjB,MAAMD,EAAQplD,KAAKo6H,qBAAqB5jF,EAAOx2C,KAAK+xC,KAAKg3E,YAAa6T,GAC3DA,IAAQhjI,GAAMoG,KAAKo7G,MAAMA,MAAMwhB,IAAQ,IAE5CC,QAAWrrH,QAAQQ,IAAIpZ,MAAM4N,KAAK4+C,GAAOxqC,KAAI3c,MAAO6gE,IAKtD,MAAMllE,EAAKykE,GAAiBS,GAC5B,IAAIg+D,EACJ,IACIA,QAAiB98H,KAAKgkF,WAAW2vC,UAAUhzH,IAAI/G,EACnD,CACA,MAAOgM,GACH,GAAiB,kBAAbA,EAAIyI,KACJ,MAAMzI,CAEd,CACA,MAAO,CACH6/C,OAAQ7rD,EAAGowD,UACXtE,iBAAkBo3E,GAAUC,mBAC/B,KAEL,MAAO,CACH73E,QAAS1O,EACT4O,MAAOy3E,EACPx3E,QAASA,EAEjB,CACAivE,aAAe,KACX,MAAM0I,EAAQh9H,KAAKulE,SAAS0lD,kBAAkBgS,aAC9Cj9H,KAAKk9H,YACAzvG,OAAO7nB,IACR5F,KAAKrH,IAAI,0BAA2BiN,EAAI,IAEvCu3H,SAAQ,KAKT,GAJa,MAATH,GACAA,IAGAh9H,KAAK2U,OAAOtG,OAAS23G,GAAiBoN,QAAS,CAE/CpvF,aAAahkC,KAAK2U,OAAO0/G,kBAGzB,IAAI+I,EAAoBp9H,KAAK+xC,KAAKy2E,mBAAsBtvH,KAAKm+C,MAAQr3C,KAAK2U,OAAO4/G,iBAAmBv0H,KAAK+xC,KAAKy2E,kBAE1G4U,EAAkD,IAA9Bp9H,KAAK+xC,KAAKy2E,oBAC9B4U,GAAqBp9H,KAAK+xC,KAAKy2E,kBAC/BxoH,KAAKulE,SAAS6lD,iBAAiBzM,OAEnC3+G,KAAK2U,OAAO0/G,iBAAmBtuH,WAAW/F,KAAKs0H,aAAc8I,EACjE,IACF,EAKNn/H,kBACI,MAAM,EAAE++B,EAAC,IAAEmrF,EAAG,IAAEC,EAAG,OAAEC,EAAM,KAAEC,EAAI,UAAEI,GAAc1oH,KAAK+xC,KACtD/xC,KAAKwnH,iBAEL,MAAM8K,EAAS,IAAIh4G,IACby9G,EAAYn+H,IACd,IAAIozB,EAAIslG,EAAO3xH,IAAI/G,GAKnB,YAJU8N,IAANslB,IACAA,EAAIhtB,KAAKo7G,MAAMA,MAAMxhH,GACrB04H,EAAOz2H,IAAIjC,EAAIozB,IAEZA,CAAC,EAGN4uG,EAAU,IAAIthH,IAEduhH,EAAU,IAAIvhH,IAEdwhH,EAAO,IAAIxhH,IAEjBta,KAAKy5H,eAELz5H,KAAK+mH,SAAS13G,QACdrP,KAAKulE,SAAS8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAKgnH,OAAOvvH,MAC7DuI,KAAKgnH,OAAO33G,QAEZrP,KAAKu5H,sBAEDv5H,KAAKwnH,eAAiBxnH,KAAK+xC,KAAKs3E,oBAAuB,SAEjDrpH,KAAKq9H,gBAGfr9H,KAAKonH,gBAAgBxiE,QACrB5kD,KAAK2mH,UAAU/hE,QACf5kD,KAAKynH,aAAa7iE,QAClB5kD,KAAKqnH,oBAAoBziE,QAUzB,MAAMq3E,EAAuB,IAAI3hH,IAEjCta,KAAK6mH,KAAKzmH,SAAQ,CAACglD,EAAO5O,KACtB,MAAMo/E,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GAC/B8mF,EAAqB,IAAI5oH,IACzBynH,EAAgB,IAAIznH,IAE1B,GADAunH,EAAqBpgI,IAAI26C,EAAO2lF,GAC5BvG,EAAc,CACd,MAAM2H,EAAgB9lB,GAAQ7+G,MAAM4N,KAAKovH,IACnCvwE,EAAUrlD,KAAKqlD,QAAQ1kD,IAAI61C,GACjC,IAAK,MAAM58C,KAAM2jI,EAAe,CAC5B,MAAMC,EAAcx9H,KAAKumH,gBAAgB5lH,IAAI/G,GAC7C,GAAI4jI,GACAx9H,KAAKmmH,YAAY5kG,SAASi8G,EAAYn4D,YACrCjgB,EAAMpqC,IAAIphB,KACVoG,KAAKymH,OAAOzrG,IAAIphB,GAAK,CACtB,MAAMwhH,EAAQ2c,EAASn+H,GACjByrD,GAAYA,EAAQrqC,IAAIphB,MAAQwhH,GAAS,IAC3CkiB,EAAmBtlH,IAAIpe,GAGvBwhH,GAASp7G,KAAK+xC,KAAKw3E,gBAAgB7O,iBACnCyhB,EAAcnkH,IAAIpe,EAC1B,CACJ,CACJ,CAEA,MAAM6jI,EAAY,CAAC7jI,EAAIm1E,KACnB/uE,KAAKrH,IAAI,0CAA2CiB,EAAI48C,GAGxDx2C,KAAKk5H,WAAWt/H,EAAI48C,GAEpB4O,EAAMntC,OAAOre,GAETm+H,EAASn+H,IAAOoG,KAAK+xC,KAAKw3E,gBAAgB7O,iBAC1CyhB,EAAcnkH,IAAIpe,GACtBoG,KAAKulE,SAAS8qD,iBAAiB75E,EAAOu4B,EAAQ,GAE9C,MAAMioC,EAAS6kB,EAAQl7H,IAAI/G,GACtBo9G,EAIDA,EAAOt/G,KAAK8+C,GAHZqlF,EAAQhgI,IAAIjC,EAAI,CAAC48C,GAIrB,EAEEknF,EAAY,CAAC9jI,EAAIm1E,KACnB/uE,KAAKrH,IAAI,uCAAwCiB,EAAI48C,GAErDx2C,KAAKo7G,MAAMz2D,MAAM/qD,EAAI48C,GAErB4O,EAAMptC,IAAIpe,GAEVuiI,EAAclkH,OAAOre,GACrBoG,KAAKulE,SAASuqD,YAAYt5E,EAAOu4B,EAAQ,GAEzC,MAAMioC,EAAS4kB,EAAQj7H,IAAI/G,GACtBo9G,EAIDA,EAAOt/G,KAAK8+C,GAHZolF,EAAQ//H,IAAIjC,EAAI,CAAC48C,GAIrB,EAaJ,GAVA4O,EAAMhlD,SAASxG,IACX,MAAMwhH,EAAQ2c,EAASn+H,GAEnBwhH,EAAQ,IACRp7G,KAAKrH,IAAI,mEAAoEiB,EAAIwhH,EAAO5kE,GACxFinF,EAAU7jI,EAAI0oH,GAAYiO,UAC1BuL,EAAKjgI,IAAIjC,GAAI,GACjB,IAGAwrD,EAAM3tD,KAAO0wH,EAAK,CAClB,MAGMwV,E/Cp+Df,SAAkCzgB,EAAUC,GAC/C,OAAOF,GAAmBC,EAAUC,GAAO,KAAM,GACrD,C+Ck+DqCygB,CAAyBN,EAHhCtgG,EAAIooB,EAAM3tD,MAIxBkmI,EAAav9H,SAAS7E,IAClBmiI,EAAUniI,EAAG8mH,GAAgB8N,UAAU,GAE/C,CAEA,GAAI/qE,EAAM3tD,KAAO2wH,EAAK,CAClB,IAAIyV,EAAajlI,MAAM4N,KAAK4+C,GAE5By4E,EAAW/3C,MAAK,CAACrlE,EAAGnE,IAAMy7G,EAASz7G,GAAKy7G,EAASt3G,KAGjDo9G,EAAaA,EAAW/kI,MAAM,EAAGuvH,GAAQxuG,OAAO49F,GAAQomB,EAAW/kI,MAAMuvH,KAEzE,IAAIpB,EAAW,EAOf,GANA4W,EAAW/kI,MAAM,EAAGkkC,GAAG58B,SAAS7E,IACxByE,KAAKinH,SAAStmH,IAAIpF,IAClB0rH,GACJ,IAGAA,EAAWqB,EAAM,CACjB,MAAMwV,EAAUxiI,IAEZ,MAAMC,EAAIsiI,EAAWviI,GACrB,IAAK,IAAI8iB,EAAI9iB,EAAG8iB,EAAI,EAAGA,IACnBy/G,EAAWz/G,GAAKy/G,EAAWz/G,EAAI,GAEnCy/G,EAAW,GAAKtiI,CAAC,EAGrB,GAAI0rH,EAAW,EAAG,CACd,IAAIxiE,EAAQwiE,EACZ,IAAK,IAAI3rH,EAAI,EAAGA,EAAI0hC,GAAKynB,EAAQ,EAAGnpD,IAC5B0E,KAAKinH,SAAStmH,IAAIk9H,EAAWviI,MAC7BwiI,EAAOxiI,GACPmpD,IAGZ,CAEA,IAAI04D,EAAQngF,EAAIiqF,EAChB,IAAK,IAAI3rH,EAAI0hC,EAAG1hC,EAAIuiI,EAAW5mI,QAAUkmH,EAAQ,EAAG7hH,IAC5C0E,KAAKinH,SAAStmH,IAAIk9H,EAAWviI,MAC7BwiI,EAAOxiI,GACP6hH,IAGZ,CAEA0gB,EAAW/kI,MAAMkkC,GAAG58B,SAAS7E,IACzBkiI,EAAUliI,EAAG+mH,GAAYmO,OAAO,GAExC,CAEA,GAAIrrE,EAAM3tD,MAAQ0wH,EAAK,CAEnB,IAAIlB,EAAW,EAOf,GANA7hE,EAAMhlD,SAAS7E,IACPyE,KAAKinH,SAAStmH,IAAIpF,IAClB0rH,GACJ,IAGAA,EAAWqB,EAAM,CAEIrL,GAAmBqgB,EAD1BhV,EAAOrB,GAC+CrtH,IAAiC,IAA1BoG,KAAKinH,SAAStmH,IAAI/G,KAChFwG,SAAS7E,IAClBmiI,EAAUniI,EAAG8mH,GAAgB6N,SAAS,GAE9C,CACJ,CAEA,GAAIlwH,KAAKwnH,eAAiBxnH,KAAK+xC,KAAKq3E,yBAA4B,GAAKhkE,EAAM3tD,KAAO,EAAG,CAQjF,MAAMsmI,EAAYnlI,MAAM4N,KAAK4+C,GAAO0gC,MAAK,CAACrlE,EAAGnE,IAAMy7G,EAASt3G,GAAKs3G,EAASz7G,KACpE0hH,EAAc/kI,KAAKiQ,MAAMk8C,EAAM3tD,KAAO,GACtCwmI,EAAclG,EAASgG,EAAUC,IAEvC,GAAIC,EAAcj+H,KAAK+xC,KAAKw3E,gBAAgBzO,4BAA6B,CACrE,MACM6iB,EAAe1gB,GAAmBqgB,EAD1Bt9H,KAAK+xC,KAAKo3E,yBAC4CvvH,GAAOm+H,EAASn+H,GAAMqkI,IAC1F,IAAK,MAAMrkI,KAAM+jI,EACb39H,KAAKrH,IAAI,yDAA0DiB,EAAI48C,GACvEknF,EAAU9jI,EAAIyoH,GAAgB+N,cAEtC,CACJ,KAGJ,MAAM/4E,EAAMn+C,KAAKm+C,MACjBr3C,KAAK8mH,cAAc1mH,SAAQ,CAAC89H,EAAQ1nF,KAC5B0nF,EAASxV,EAAYrxE,IACrBr3C,KAAK2xE,OAAO15D,OAAOu+B,GACnBx2C,KAAK8mH,cAAc7uG,OAAOu+B,GAC9B,IAGJx2C,KAAK2xE,OAAOvxE,SAAQ,CAAC85H,EAAa1jF,KAE9B,MAAM2nF,EAAan+H,KAAKg3G,OAAOr2G,IAAI61C,GACnC0jF,EAAY95H,SAASxG,MACZukI,EAAWnjH,IAAIphB,IAAOm+H,EAASn+H,GAAMoG,KAAK+xC,KAAKw3E,gBAAgB5O,mBAChEuf,EAAYjiH,OAAOre,EACvB,IAEJ,MAAMg8H,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GAC/B4nF,EAAuB,GAEvBjC,EAAgB,IAAIznH,IAE1B,GADAunH,EAAqBpgI,IAAI26C,EAAO2lF,GAC5BvG,EAAc,CACd,MAAM2H,EAAgB9lB,GAAQ7+G,MAAM4N,KAAKovH,IACzC,IAAK,MAAMh8H,KAAM2jI,EAAe,CAC5B,MAAMC,EAAcx9H,KAAKumH,gBAAgB5lH,IAAI/G,GAC7C,GAAI4jI,GACAx9H,KAAKmmH,YAAY5kG,SAASi8G,EAAYn4D,YACrC60D,EAAYl/G,IAAIphB,KAChBoG,KAAKymH,OAAOzrG,IAAIphB,GAAK,CACtB,MAAMwhH,EAAQ2c,EAASn+H,GACnBwhH,GAASp7G,KAAK+xC,KAAKw3E,gBAAgB5O,kBACnCyjB,EAAqB1mI,KAAKkC,GAG1BwhH,GAASp7G,KAAK+xC,KAAKw3E,gBAAgB7O,iBACnCyhB,EAAcnkH,IAAIpe,EAC1B,CACJ,CACJ,CAEA,GAAIsgI,EAAYziI,KAAOulC,EAAG,CACtB,MAAMmgF,EAAQngF,EAAIk9F,EAAYziI,KAC9B2mI,EAAqBtlI,MAAM,EAAGqkH,GAAO/8G,SAASxG,IAC1CsgI,EAAYliH,IAAIpe,GAChBuiI,GAAelkH,OAAOre,EAAG,GAEjC,KAEJoG,KAAKg8H,WAAWC,SAEVj8H,KAAKq+H,eAAezC,EAASC,EAASC,GAE5C97H,KAAKs2E,QAELt2E,KAAKsnH,OAAOloH,QACZY,KAAKo2H,cAAc,IAAI,KAAY,uBACvC,CASAgE,qBAAqB5jF,EAAOllC,EAAO4G,EAAS,MAAM,IAC9C,MAAM09G,EAAe51H,KAAKg3G,OAAOr2G,IAAI61C,GACrC,IAAKo/E,EACD,OAAO,IAAIlhH,IAIf,IAAI0wC,EAAQ,GAeZ,OAdAwwE,EAAax1H,SAASxG,IAClB,MAAM4jI,EAAcx9H,KAAKumH,gBAAgB5lH,IAAI/G,GACxC4jI,GAGDx9H,KAAKmmH,YAAY5kG,SAASi8G,EAAYn4D,WAAantD,EAAOte,IAC1DwrD,EAAM1tD,KAAKkC,EACf,IAGJwrD,EAAQqyD,GAAQryD,GACZ9zC,EAAQ,GAAK8zC,EAAMnuD,OAASqa,IAC5B8zC,EAAQA,EAAMtsD,MAAM,EAAGwY,IAEpB,IAAIoD,IAAI0wC,EACnB,CACA8tE,gBAAgB3tD,GAEZA,EAAQ+pD,WAAWzzH,IAAImE,KAAKsnH,OAAO7vH,MACnC8tE,EAAQgqD,wBAAwB1zH,IAAImE,KAAKsnH,OAAOlR,mBAEhD7wC,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAKymH,OAAOhvH,MACvD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,aAAera,KAAK2mH,UAAUlvH,MAC7D8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,kBAAoBra,KAAKonH,gBAAgB3vH,MAAQ,GAChF8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,uBAAyBra,KAAKqnH,oBAAoB5vH,MACjF8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAKsnH,OAAO7vH,MACvD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,SAAWra,KAAKo7G,MAAM3jH,MACrD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,yBAA2Bra,KAAKynH,aAAahwH,MAC5E8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,yBAA2Bra,KAAKynH,aAAaxG,oBAE5E17C,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAKg3G,OAAOv/G,MACvD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,iBAAmBra,KAAKqjD,cAAc5rD,MACrE8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,QAAUra,KAAK6mH,KAAKpvH,MACnD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAK2xE,OAAOl6E,MAEvD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,SAAWra,KAAKolD,MAAM3tD,MACrD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,mBAAqBra,KAAKumH,gBAAgB9uH,MACzE8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,kBAAoBra,KAAKsmH,eAAe7uH,MACvE8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,uBAAyBra,KAAK4mH,oBAAoBnvH,MACjF8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,UAAYra,KAAKg2G,OAAOv+G,MACvD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,WAAara,KAAKwjD,QAAQ/rD,MACzD8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,YAAcra,KAAK+mH,SAAStvH,MAC3D8tE,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,YAAcra,KAAKinH,SAASxvH,MAE3D,IAAI6mI,EAAc,EAClB,MAAMjnF,EAAMn+C,KAAKm+C,MACjBkuB,EAAQ6pD,yBAAyB7iH,QACjC,IAAK,MAAM84C,KAAWrlD,KAAKqlD,QAAQ1pD,SAAU,CACzC2iI,GAAej5E,EAAQ5tD,KACvB,IAAK,MAAOwjH,EAAMsjB,KAAcl5E,EAAQxyC,UAChC7S,KAAKolD,MAAMpqC,IAAIigG,IACf11C,EAAQ6pD,yBAAyBrQ,QAAQ9lH,KAAKioB,IAAI,EAAGq9G,EAAYlnF,GAAO,IAGpF,CACAkuB,EAAQ8pD,UAAUxzH,IAAI,CAAEwe,MAAO,WAAaikH,GAE5C,IAAK,MAAO3O,EAAUvqE,KAAUplD,KAAKg3G,OACjCzxC,EAAQ2kD,gBAAgBruH,IAAI,CAAE8zH,YAAYvqE,EAAM3tD,MAEpD,IAAK,MAAOk4H,EAAUvqE,KAAUplD,KAAK6mH,KACjCthD,EAAQ4kD,eAAetuH,IAAI,CAAE8zH,YAAYvqE,EAAM3tD,MAGnD,MAAM66H,EAAS,GACTM,EAAc,IAAIt4G,IACxBirD,EAAQi3C,iBAAiBjwG,QACzB,IAAK,MAAMiyH,KAAax+H,KAAKolD,MAAM39C,OAAQ,CACvC,MAAM2zG,EAAQp7G,KAAKo7G,MAAMA,MAAMojB,GAC/BlM,EAAO56H,KAAK0jH,GACZwX,EAAY/2H,IAAI2iI,EAAWpjB,GAC3B71C,EAAQi3C,iBAAiBuC,QAAQ/+G,KAAKo7G,MAAMsC,UAAU/8G,IAAI69H,IAAYhiB,kBAAoB,EAC9F,CACAj3C,EAAQ8sD,eAAeC,EAAQtyH,KAAK+xC,KAAKw3E,iBAEzChkD,EAAQotD,qBAAqB3yH,KAAK6mH,KAAM+L,GAExC,MAAMH,EvChoEP,SAAqCgM,EAAY/gB,EAAW/qF,EAAQwoF,EAAS6H,GAChF,MAAMyP,EAAK,CACPxP,QAAS,IAAI3oG,IACbopG,IAAK,GACLC,IAAK,GACLC,IAAK,GACLxI,MAAO,IAEX,IAAK,MAAMojB,KAAaC,EAAY,CAChC,MAAMvjB,EAASwC,EAAU/8G,IAAI69H,GAC7B,GAAItjB,EAAQ,CACR,MAAMwjB,EAAS3b,GAAoByb,EAAWtjB,EAAQvoF,EAAQwoF,EAAS6H,GACvE,IAAK,MAAOxsE,EAAOmoF,KAAgBD,EAAOzb,QAAS,CAC/C,IAAI2b,EAAUnM,EAAGxP,QAAQtiH,IAAI61C,GACxBooF,IACDA,EAAU,CACNxb,IAAK,GACLC,IAAK,GACLC,IAAK,GACLC,KAAM,GACNC,IAAK,IAETiP,EAAGxP,QAAQpnH,IAAI26C,EAAOooF,IAE1BA,EAAQxb,IAAI1rH,KAAKinI,EAAYvb,KAC7Bwb,EAAQvb,IAAI3rH,KAAKinI,EAAYtb,KAC7Bub,EAAQtb,IAAI5rH,KAAKinI,EAAYrb,KAC7Bsb,EAAQrb,KAAK7rH,KAAKinI,EAAYpb,MAC9Bqb,EAAQpb,IAAI9rH,KAAKinI,EAAYnb,IACjC,CACAiP,EAAG/O,IAAIhsH,KAAKgnI,EAAOhb,KACnB+O,EAAG9O,IAAIjsH,KAAKgnI,EAAO/a,KACnB8O,EAAG7O,IAAIlsH,KAAKgnI,EAAO9a,KACnB6O,EAAGrX,MAAM1jH,KAAKgnI,EAAOtjB,MACzB,MAEIqX,EAAG/O,IAAIhsH,KAAK,GACZ+6H,EAAG9O,IAAIjsH,KAAK,GACZ+6H,EAAG7O,IAAIlsH,KAAK,GACZ+6H,EAAGrX,MAAM1jH,KAAK,EAEtB,CACA,OAAO+6H,CACX,CuCqlEmBoM,CAA4B7+H,KAAKolD,MAAM39C,OAAQzH,KAAKo7G,MAAMsC,UAAW19G,KAAKo7G,MAAMzoF,OAAQ3yB,KAAKo7G,MAAMD,QAAS51C,EAAQy9C,iBAC/Hz9C,EAAQitD,qBAAqBC,EACjC,EAEG,SAASqM,GAAU1jG,EAAO,CAAC,GAC9B,OAAQ4oD,GAAe,IAAIiiC,GAAUjiC,EAAY5oD,EACrD,iEEpvEO,MAAM,WAAmB7iC,MAC5BuH,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EC6CG,SAAS,GAAgBlQ,EAAQ8pB,EAAQ7Z,GAC5C,MAAM2jC,EAAO3jC,GAAW,CAAC,EACnBwJ,ECpDH,SAAqBtO,GACxB,GAAW,MAAPA,EAAa,CACb,GAAoC,mBAAzBA,EAAI9S,OAAOohB,UAClB,OAAOtO,EAAI9S,OAAOohB,YAEtB,GAAyC,mBAA9BtO,EAAI9S,OAAOgc,eAClB,OAAOlJ,EAAI9S,OAAOgc,iBAEtB,GAAwB,mBAAblJ,EAAI+B,KACX,OAAO/B,CAEf,CACA,MAAM,IAAI/Q,MAAM,0CACpB,CDuCqB,CAAY4F,GA+D7B,OA9DAF,kBACI,IAAIupE,EACJ,MAAMC,EAAe,KACO,MAApBD,GACAA,GAAkB,EAG1B,IADAv/C,EAAOE,iBAAiB,QAASs/C,KACpB,CACT,IAAI7tD,EACJ,IACI,GAAIqO,EAAOG,QAAS,CAChB,MAAM,aAAEs/C,EAAY,UAAEC,GAAc51B,EACpC,MAAM,IAAI,GAAW21B,EAAcC,EACvC,CACA,MAAMzvE,EAAQ,IAAIsZ,SAAQ,CAACC,EAASC,KAChC81D,EAAmB,KACf,MAAM,aAAEE,EAAY,UAAEC,GAAc51B,EACpCrgC,EAAO,IAAI,GAAWg2D,EAAcC,GAAW,CAClD,IAGL/tD,QAAepI,QAAQo2D,KAAK,CAAC1vE,EAAO0f,EAASvM,SAC7Cm8D,EAAmB,IACvB,CACA,MAAO5hE,GACHqiB,EAAOC,oBAAoB,QAASu/C,GAEpC,MAAMI,EAA8B,YAAbjiE,EAAIsJ,MAAsB+Y,EAAOG,QAMxD,GALIy/C,GAAmC,MAAhB91B,EAAK/pB,SAExB+pB,EAAK/pB,QAAQ7pB,GAGc,mBAApByZ,EAASuyB,OAChB,IACI,MAAM5uC,EAAIqc,EAASuyB,SACf5uC,aAAaiW,SACbjW,EAAEkyB,OAAM7nB,IACsB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EACvB,GAGZ,CACA,MAAOA,GACuB,MAAtBmsC,EAAK+1B,eACL/1B,EAAK+1B,cAAcliE,EAE3B,CAEJ,GAAIiiE,IAAyC,IAAvB91B,EAAKg2B,cACvB,OAEJ,MAAMniE,CACV,CACA,IAAoB,IAAhBgU,EAAOye,KACP,YAEEze,EAAO/a,KACjB,CACAopB,EAAOC,oBAAoB,QAASu/C,EACxC,CACOO,EACX,CEnHA,MAAM,GACFrxE,OACAuQ,KACA4nC,IACAC,IACA1jC,KACAvL,YAAY+uC,GACR,KAAMA,EAAM,IAA4B,IAApBA,EAAM,EAAKA,GAC3B,MAAM,IAAIt2C,MAAM,qDAEpByH,KAAKrJ,OAAS,IAAIiC,MAAMi2C,GACxB7uC,KAAKkH,KAAO2nC,EAAM,EAClB7uC,KAAK8uC,IAAM,EACX9uC,KAAK+uC,IAAM,EACX/uC,KAAKqL,KAAO,IAChB,CACA3T,KAAK+kB,GACD,YAA8B/U,IAA1B1H,KAAKrJ,OAAOqJ,KAAK8uC,OAGrB9uC,KAAKrJ,OAAOqJ,KAAK8uC,KAAOryB,EACxBzc,KAAK8uC,IAAO9uC,KAAK8uC,IAAM,EAAK9uC,KAAKkH,MAC1B,EACX,CACA9H,QACI,MAAM5H,EAAOwI,KAAKrJ,OAAOqJ,KAAK+uC,KAC9B,QAAarnC,IAATlQ,EAKJ,OAFAwI,KAAKrJ,OAAOqJ,KAAK+uC,UAAOrnC,EACxB1H,KAAK+uC,IAAO/uC,KAAK+uC,IAAM,EAAK/uC,KAAKkH,KAC1B1P,CACX,CACA6uC,UACI,YAAiC3+B,IAA1B1H,KAAKrJ,OAAOqJ,KAAK+uC,IAC5B,EAEG,MAAM,GACTt3C,KACAo3C,IACApjC,KACAC,KACA5L,YAAYsO,EAAU,CAAC,GACnBpO,KAAK6uC,IAAMzgC,EAAQ85D,YAAc,GACjCloE,KAAKyL,KAAO,IAAI,GAAUzL,KAAK6uC,KAC/B7uC,KAAK0L,KAAO1L,KAAKyL,KACjBzL,KAAKvI,KAAO,CAChB,CACA0wE,cAAc7+D,GACV,OAAuB,MAAnBA,GAAKuD,WACEvD,EAAIuD,WAER,CACX,CACAnV,KAAK0T,GAID,GAHkB,MAAdA,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,SAEnCmB,KAAKyL,KAAK/T,KAAK0T,GAAM,CACtB,MAAM23B,EAAO/iC,KAAKyL,KAClBzL,KAAKyL,KAAOs3B,EAAK13B,KAAO,IAAI,GAAU,EAAIrL,KAAKyL,KAAK9U,OAAOM,QAC3D+I,KAAKyL,KAAK/T,KAAK0T,EACnB,CACJ,CACAhM,QACI,IAAIgM,EAAMpL,KAAK0L,KAAKtM,QACpB,QAAYsI,IAAR0D,GAAwC,MAAlBpL,KAAK0L,KAAKL,KAAe,CAC/C,MAAMA,EAAOrL,KAAK0L,KAAKL,KACvBrL,KAAK0L,KAAKL,KAAO,KACjBrL,KAAK0L,KAAOL,EACZD,EAAMpL,KAAK0L,KAAKtM,OACpB,CAIA,OAHkB,MAAdgM,GAAKvM,QACLmB,KAAKvI,MAAQuI,KAAKmoE,cAAc/8D,EAAIvM,QAEjCuM,CACX,CACAi7B,UACI,OAAOrmC,KAAKyL,KAAK46B,SACrB,EC9BG,MAAM,WAAmB9tC,MAC5B2W,KACAb,KACAvO,YAAY+H,EAASwG,GACjBsE,MAAM9K,GAAW,6BACjB7H,KAAKkP,KAAO,UACZlP,KAAKqO,KAAOA,GAAQ,WACxB,EA8CJ,SAAS,GAAUg6D,EAASj6D,GAExB,IAEIk6D,EACAC,EACAC,EAJAC,GADJr6D,EAAUA,GAAW,CAAC,GACFq6D,MAChB9xE,EAAS,IAAI,GAIb+xE,GAAQ,UACZ,MAiCMC,EAAct9D,GACF,MAAVk9D,EACOA,EAAOl9D,IAElB1U,EAAOe,KAAK2T,GACLi9D,GAUL5wE,EAAQmH,IACV,GAAI2pE,EACA,OAAOF,EAGX,IAA4B,IAAxBl6D,GAASw6D,YAA4C,MAArB/pE,GAAOgO,WACvC,MAAM,IAAItU,MAAM,kEAEpB,OAAOowE,EAAW,CAAEtwC,MAAM,EAAOx5B,SAAQ,EAEvC8D,EAAOiD,GACL4iE,EACOF,GACXE,GAAQ,EACO,MAAP5iE,EAtBQ,CAACA,IACjBjP,EAAS,IAAI,GACC,MAAV4xE,EACOA,EAAO,CAAEnoD,MAAOxa,KAE3BjP,EAAOe,KAAK,CAAE0oB,MAAOxa,IACd0iE,IAgBgBO,CAAYjjE,GAAO+iE,EAAW,CAAEtwC,MAAM,KAkDjE,GAvCAiwC,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KA3EapN,UACb,IACI,OAAKtH,EAAO0vC,UAGRmiC,EACO,CAAEnwC,MAAM,SAEN,IAAI7mB,SAAQ,CAACC,EAASC,KAC/B62D,EAAUl9D,IACNk9D,EAAS,KACT5xE,EAAOe,KAAK2T,GACZ,IACIoG,EAAQ42D,EAAQ1xE,GACpB,CACA,MAAOiP,GACH8L,EAAO9L,EACX,CACA,OAAO0iE,CAAQ,CAClB,IAhBMD,EAAQ1xE,EAkBvB,CACA,QACQA,EAAO0vC,WAGPtrB,gBAAe,KACX2tD,EAAMj3D,UACNi3D,GAAQ,SAAU,GAG9B,GA6CAv+B,OAZY,KACZxzC,EAAS,IAAI,GACbgM,IACO,CAAE01B,MAAM,IAUfywC,MARYljE,IACZjD,EAAIiD,GACG,CAAEyyB,MAAM,IAOf3gC,OACAiL,MACIomE,qBACA,OAAOpyE,EAAOc,IAClB,EACAuxE,QAAS/qE,MAAOmQ,IACZ,MAAM6Z,EAAS7Z,GAAS6Z,OAExB,GADAA,GAAQghD,iBACJtyE,EAAO0vC,UACP,OAEJ,IAAI/vB,EACAs1B,EACU,MAAV3jB,IACA3R,EAAS,IAAI9E,SAAQ,CAACC,EAASC,KAC3Bk6B,EAAW,KACPl6B,EAAO,IAAI,GAAa,EAE5BuW,EAAOE,iBAAiB,QAASyjB,EAAS,KAGlD,UACUp6B,QAAQo2D,KAAK,CACfc,EAAMn3D,QACN+E,GAER,CACA,QACoB,MAAZs1B,GAA8B,MAAV3jB,GACpBA,GAAQC,oBAAoB,QAAS0jB,EAE7C,IAGK,MAAT68B,EACA,OAAOH,EAEX,MAAMF,EAAYE,EAmClB,OAlCAA,EAAW,CACP,CAAC9xE,OAAOgc,iBAAmB,OAAOxS,IAAM,EACxCqL,KAAI,IACO+8D,EAAU/8D,OAErBy9D,MAAMljE,IACFwiE,EAAUU,MAAMljE,GACH,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB8R,OAAM,KACFi+B,EAAUj+B,SACG,MAATs+B,IACAA,IACAA,OAAQ/gE,GAEL,CAAE2wB,MAAM,IAEnB3gC,OACAiL,IAAIiD,IACAwiE,EAAUzlE,IAAIiD,GACD,MAAT6iE,IACAA,EAAM7iE,GACN6iE,OAAQ/gE,GAEL4gE,GAEPS,qBACA,OAAOX,EAAUW,cACrB,GAEGT,CACX,iBClQO,SAAS,GAAavtE,GACzB,OAAyB,MAArB+sB,WAAW1lB,OACJ,IAAI5H,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAEnD9R,CACX,CCPO,MAAM,GAAS+1D,GAAM,CAC1Bt3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,eCDC,GAASupC,GAAQ,CAC5Bv3C,OAAQ,IACRna,KAAM,SACNmoB,SAAU,mBACVwpC,YAAa,IAGF,GAAcD,GAAQ,CACjCv3C,OAAQ,IACRna,KAAM,cACNmoB,SAAU,mBACVwpC,YAAa,ICXF,GAAQD,GAAQ,CAC3Bv3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,KACVwpC,YAAa,ICNT,GAAWp4D,MAAM4N,KAAK,0eACtB,GAAgD,GAAS4oB,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAED,GAAK2jB,EAAU1jB,IAA4B,IAC5H,GAAgD,GAAS6zB,QAAO,CAAC7zB,EAAG0jB,EAAG3jB,KAAQC,EAAyB0jB,EAAEmxC,YAAY,IAAO90D,EAAUC,IAA4B,IA6BlK,MAAM,GAAeiL,GAAK,CAC/BgT,OAAQ,KACRna,KAAM,eACN0P,OA1BF,SAAiB0N,GACf,OAAOA,EAAK2S,QAAO,CAAC7zB,EAAG0jB,IACrB1jB,GAAK,GAAqB0jB,IAEzB,GACL,EAsBE7S,OAhBF,SAAiB/Q,GACf,MAAMs2D,EAAO,GACb,IAAK,MAAMn3C,KAAQnf,EAAK,CACtB,MAAMu2D,EAAM,GAA4Cp3C,EAAK41C,YAAY,IACzE,QAAY1oD,IAARkqD,EACF,MAAM,IAAIr5D,MAAM,+BAA+BiiB,KAEjDm3C,EAAKj6D,KAAKk6D,EACZ,CACA,OAAO,IAAIp3D,WAAWm3D,EACxB,IC3Ba,GAAQZ,GAAQ,CAC3Bv3C,OAAQ,IACRna,KAAM,QACNmoB,SAAU,WACVwpC,YAAa,ICHF,GAAWxqD,GAAK,CAC3BgT,OAAQ,KACRna,KAAM,WACN0P,OAAShU,IAAQ,O7KwDFuhB,E6KxDWvhB,G7KwDN,IAAKg4D,aAAe3mD,OAAOkQ,GAAhCA,K6KxDe,EAC9BlQ,OAAS/Q,G7KiDQA,KAAO,IAAK0d,aAAehK,OAAO1T,G6KjDlC,CAAWA,KCSxB,GAAQ,IAAK,KAAiB,KAAU,KAAU,KAAW,KAAW,KAAW,KAAW,KAAW,KAAW,GChB1H,SAAS,GAAYgE,EAAMma,EAAQzK,EAAQ3C,GACvC,MAAO,CACH/M,OACAma,SACAq3C,QAAS,CACLxxD,OACAma,SACAzK,UAEJwhD,QAAS,CACLnkD,UAGZ,CACA,MAAM,GAAS,GAAY,OAAQ,KAAMrR,GAE9B,IADS,IAAIg4D,YAAY,QACX3mD,OAAOrR,KAC5BM,IACgB,IAAI0d,aACLhK,OAAO1T,EAAIoE,UAAU,MAElC,GAAQ,GAAY,QAAS,KAAM1E,IACrC,IAAI2I,EAAS,IACb,IAAK,IAAIpI,EAAI,EAAGA,EAAIP,EAAI9D,OAAQqE,IAC5BoI,GAAUvM,OAAOC,aAAa2D,EAAIO,IAEtC,OAAOoI,CAAM,IACbrI,IAEA,MAAMN,ECfH,SAAqBtD,EAAO,GAC/B,OAAsC,MAAlCqwB,WAAW1lB,QAAQ8I,YACZ,GAAa4c,WAAW1lB,OAAO8I,YAAYzT,IAE/C,IAAI+C,WAAW/C,EAC1B,CDUgB,EADZ4D,EAAMA,EAAIoE,UAAU,IACQxI,QAC5B,IAAK,IAAIqE,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC5BP,EAAIO,GAAKD,EAAIG,WAAWF,GAE5B,OAAOP,CAAG,IAWd,OATc,CACV6G,KAAM,GACN,QAAS,GACTu1D,IAAK,UACLC,OAAQ,GACRF,MAAK,GACLG,OAAQ,MACL,IEnCA,SAAS,GAAW3zD,EAAQuH,EAAW,QAC1C,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKtE,QAAQnkD,OAAO,GAAGyoD,EAAKr7C,SAAS9V,KAHjC,GAAaokB,WAAW1lB,OAAOoE,KAAK9C,EAAQ,SAI3D,CCXO,SAAS,GAASmZ,EAAO5R,EAAW,QACvC,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKhE,QAAQ9hD,OAAO8N,GAAOpd,UAAU,GAHjCqoB,WAAW1lB,OAAOoE,KAAKqW,EAAMlmB,OAAQkmB,EAAMX,WAAYW,EAAMhQ,YAAYlI,SAAS,OAIjG,KClBWo6H,gBACX,SAAWA,GACPA,EAAaA,EAAyB,WAAI,GAAK,aAC/CA,EAAaA,EAA+B,iBAAI,GAAK,mBACrDA,EAAaA,EAAgC,kBAAI,GAAK,oBACtDA,EAAaA,EAA6B,eAAI,GAAK,iBACnDA,EAAaA,EAA8B,gBAAI,GAAK,kBACpDA,EAAaA,EAA6B,eAAI,GAAK,iBACnDA,EAAaA,EAA8B,gBAAI,GAAK,iBACvD,CARD,CAQGA,KAAiBA,GAAe,CAAC,IAC7B,MAAMC,GAAmBtgI,OAAOmK,OAAO,CAC1C,EAAG,aACH,EAAG,mBACH,EAAG,oBACH,EAAG,iBACH,EAAG,kBACH,EAAG,iBACH,EAAG,oBAEMo2H,GAAwBvgI,OAAOmK,OAAO,CAC/Cq2H,WAAYH,GAAaG,WACzBC,QAASJ,GAAaK,kBACtBC,MAAON,GAAaO,gBACpBC,MAAOR,GAAaS,kBAEXC,GAAuB/gI,OAAOmK,OAAO,CAC9Cs2H,QAASJ,GAAaW,iBACtBL,MAAON,GAAaY,eACpBJ,MAAOR,GAAaa,iBC1BXC,GAAe,GAAK,GAE1B,MAAM,GACTC,QACAC,YACAC,gBACAC,gCACAngI,YAAYuqE,EAAiBw1D,GAAcK,EANb,SAO1BlgI,KAAK8/H,QAAU,IAAI,KACnB9/H,KAAK+/H,YAAc,KACnB//H,KAAKggI,gBAAkB31D,EACvBrqE,KAAKigI,gCAAkCC,CAC3C,CACA7zH,MAAM06D,GACF,GAAa,MAATA,GAAkC,IAAjBA,EAAM9vE,OACvB,MAAO,GAGX,GADA+I,KAAK8/H,QAAQtnG,OAAOuuC,GAChB/mE,KAAK8/H,QAAQjzH,WAAa7M,KAAKigI,gCAC/B,MAAMvhI,OAAO6W,OAAO,IAAIhd,MAAM,6CAA8C,CAAE8V,KAAM,0BAExF,MAAM4nG,EAAO,GACb,KAA+B,IAAxBj2G,KAAK8/H,QAAQ7oI,QAAc,CAC9B,GAAwB,MAApB+I,KAAK+/H,YACL,IACI//H,KAAK+/H,YAAc//H,KAAKmgI,cAAcngI,KAAK8/H,QAC/C,CACA,MAAOl6H,GACH,GAAiB,oBAAbA,EAAIyI,KACJ,MAAMzI,EAEV,KACJ,CAEJ,MAAM,GAAEhM,EAAE,KAAEsV,EAAI,OAAEjY,EAAM,OAAEC,GAAW8I,KAAK+/H,YAE1C,GAD2B//H,KAAK8/H,QAAQ7oI,OAASC,EACxBD,EACrB,MAEJ,MAAMgwB,EAAM,CACRrtB,KACAsV,QAEAA,IAAS6vH,GAAaG,YAAchwH,IAAS6vH,GAAaK,mBAAqBlwH,IAAS6vH,GAAaW,mBACrGz4G,EAAIxK,KAAOzc,KAAK8/H,QAAQz0D,QAAQn0E,EAAQA,EAASD,IAErDg/G,EAAKv+G,KAAKuvB,GACVjnB,KAAK8/H,QAAQpuF,QAAQx6C,EAASD,GAC9B+I,KAAK+/H,YAAc,IACvB,CACA,OAAO9pB,CACX,CAIAkqB,cAAc1jH,GACV,MAAQ5d,MAAOqgC,EAAC,OAAEhoC,GAAWkpI,GAAW3jH,IAChC5d,MAAO5H,EAAQC,OAAQyL,GAAQy9H,GAAW3jH,EAAMvlB,GAClDgY,EAAW,EAAJgwB,EAEb,GAA8B,MAA1B8/F,GAAiB9vH,GACjB,MAAM,IAAI3W,MAAM,0BAA0B2W,KAG9C,GAAIjY,EAAS+I,KAAKggI,gBACd,MAAMthI,OAAO6W,OAAO,IAAIhd,MAAM,2BAA4B,CAAE8V,KAAM,oBAGtE,MAAO,CAAEzU,GAAIslC,GAAK,EAAGhwB,OAAMhY,OAAQA,EAASyL,EAAK1L,SACrD,EAEJ,MAAM,GAAM,IACN,GAAO,IACb,SAASmpI,GAAWrlI,EAAK7D,EAAS,GAC9B,IAGIolB,EAHA8C,EAAM,EACNhgB,EAAQ,EACRisD,EAAUn0D,EAEd,MAAM06B,EAAI72B,EAAI9D,OACd,EAAG,CACC,GAAIo0D,GAAWz5B,GAAKxyB,EAAQ,GAExB,MADAlI,EAAS,EACH,IAAI8K,WAAW,2BAEzBsa,EAAIvhB,EAAI4F,IAAI0qD,KACZjsC,GAAOhgB,EAAQ,IACRkd,EAAI,KAASld,GACbkd,EAAI,IAAQrjB,KAAK6qB,IAAI,EAAG1kB,GAC/BA,GAAS,CACb,OAASkd,GAAK,IAEd,MAAO,CACHzd,MAAOugB,EACPloB,OAHJA,EAASm0D,EAAUn0D,EAKvB,CC5FA,MAAMmpI,GAAqB,QACrBC,GAAoB,CAACvlI,EAAK4lB,KAAWA,EAAK6X,OAAOz9B,EAAI,EA2E3D,OA1EA,SAAsBoD,EAAQiQ,GAC1B,OALsC,MAKlBjQ,EALP3H,OAAOgc,eAMT,kBACH,IAAI7b,EAAS,IAAI,KACb6xE,GAAQ,EACR1f,GAAW,UACXrxD,EAAOuR,OAAOoF,GAAS3W,MAAQ4oI,IAInC,IAHIpzG,MAAMx1B,IAAkB,IAATA,GAAcA,EAAO,KACpCA,EAAO4oI,IAEP5oI,IAASwB,KAAKsmC,MAAM9nC,GACpB,MAAM,IAAIc,MAAM,iCAEpB,MAAMgoI,EAAanyH,GAASmyH,YAAc,EACpCtyG,EAAY7f,GAAS6f,WAAaqyG,GA0BxC,IAzBK9uH,QAAQC,UAAU+b,MAAKvvB,UACxB,IACI,IAAI0xE,EACJ,UAAW,MAAM50E,KAAOoD,EAEpB8vB,EAAUlzB,EAAKpE,GACXA,EAAOkW,YAAcpV,GACrBusC,aAAa2rC,GACb7mB,EAASr3C,WAGbk+D,EAAU5pE,YAAW,KACjB+iD,EAASr3C,SAAS,GACnB8uH,GAEPv8F,aAAa2rC,GACb7mB,EAASr3C,SACb,CACA,MAAO7L,GACHkjD,EAASp3C,OAAO9L,EACpB,CACA,QACI4iE,GAAQ,CACZ,MAEIA,GAGJ,SAFM1f,EAASv3C,QACfu3C,GAAW,UACPnyD,EAAOkW,WAAa,EAAG,CACvB,MAAMyP,EAAI3lB,EACVA,EAAS,IAAI,WACP2lB,EAAEhlB,UACZ,CAEP,CA/CM,GAiDJ,YACH,MAAMX,EAAS,IAAI,KACnB,IAAIc,EAAOuR,OAAOoF,GAAS3W,MAAQ4oI,IAInC,IAHIpzG,MAAMx1B,IAAkB,IAATA,GAAcA,EAAO,KACpCA,EAAO4oI,IAEP5oI,IAASwB,KAAKsmC,MAAM9nC,GACpB,MAAM,IAAIc,MAAM,iCAEpB,MAAM01B,EAAY7f,GAAS6f,WAAaqyG,GACxC,IAAK,MAAMvlI,KAAOoD,EAEd8vB,EAAUlzB,EAAKpE,GACXA,EAAOkW,YAAcpV,UACfd,EAAOW,SAAS,EAAGG,GACzBd,EAAO+6C,QAAQj6C,IAGnBd,EAAOkW,WAAa,UACdlW,EAAOW,WAEpB,CArBM,EAsBX,EChFO,SAAS,GAAYG,GACxB,OAAO,IAAI+C,WAAW/C,EAC1B,CCGA,MAAM+oI,GAAY,MAsClB,MAAM3vE,GAAU,IArChB,MACI4vE,MACAC,YACA5gI,cACIE,KAAKygI,MAAQ,GAAYD,IACzBxgI,KAAK0gI,YAAc,CACvB,CAIAr0H,MAAM4a,EAAKtG,GACP,MAAMvY,EAAOpI,KAAKygI,MAClB,IAAIvpI,EAAS8I,KAAK0gI,YAClB,MAAcz5G,EAAIrtB,IAAM,EAAIqtB,EAAI/X,KAAM9G,EAAMlR,GAC5CA,GAAU,MAAsB+vB,EAAIrtB,IAAM,EAAIqtB,EAAI/X,MAC7C+X,EAAI/X,OAAS6vH,GAAaG,YAAcj4G,EAAI/X,OAAS6vH,GAAaK,mBAAqBn4G,EAAI/X,OAAS6vH,GAAaW,kBAAiC,MAAZz4G,EAAIxK,MAK3I,MAAc,EAAGrU,EAAMlR,GACvBA,GAAU,MAAsB,KALhC,MAAc+vB,EAAIxK,KAAKxlB,OAAQmR,EAAMlR,GACrCA,GAAU,MAAsB+vB,EAAIxK,KAAKxlB,SAM7C,MAAMwhC,EAASrwB,EAAK9Q,SAAS0I,KAAK0gI,YAAaxpI,GAC3CspI,GAAYtpI,EAAS,KACrB8I,KAAKygI,MAAQ,GAAYD,IACzBxgI,KAAK0gI,YAAc,GAGnB1gI,KAAK0gI,YAAcxpI,EAEvBypB,EAAK6X,OAAOC,GACPxR,EAAI/X,OAAS6vH,GAAaG,YAAcj4G,EAAI/X,OAAS6vH,GAAaK,mBAAqBn4G,EAAI/X,OAAS6vH,GAAaW,kBAAiC,MAAZz4G,EAAIxK,MAC3IkE,EAAK6X,OAAOvR,EAAIxK,KAExB,mBCnCG,MAAMkkH,WAAoB,KAC7BthI,KACAuhI,SACA1kG,KACAw+B,MACAmmE,YACA/gI,YAAYs7B,GACRzoB,MAAMyoB,GACNp7B,KAAK06D,MAA2B,aAAnBt/B,EAAK5P,UAA2ByzG,GAAwBQ,GACrEz/H,KAAKk8B,KAAOd,EAAKc,KACjBl8B,KAAKX,KAAO+7B,EAAK/7B,KACjBW,KAAK4gI,SAAWxlG,EAAKwlG,SACrB5gI,KAAK6gI,YAAczlG,EAAKylG,WAC5B,CACA5iI,4BACU+B,KAAKk8B,KAAK,CAAEtiC,GAAIoG,KAAK4gI,SAAU1xH,KAAM+vH,GAAsBC,WAAYziH,KAAM,IAAI,KAAe,GAAqBzc,KAAKX,QACpI,CACApB,eAAewe,GAEX,IADAA,EAAOA,EAAK4uD,UACL5uD,EAAK5P,WAAa,GAAG,CACxB,MAAM2/D,EAASvzE,KAAKyL,IAAI+X,EAAK5P,WAAY7M,KAAK6gI,mBACxC7gI,KAAKk8B,KAAK,CACZtiC,GAAIoG,KAAK4gI,SACT1xH,KAAMlP,KAAK06D,MAAMykE,QACjB1iH,KAAMA,EAAK4uD,QAAQ,EAAGmB,KAE1B/vD,EAAKi1B,QAAQ86B,EACjB,CACJ,CACAvuE,wBACU+B,KAAKk8B,KAAK,CAAEtiC,GAAIoG,KAAK4gI,SAAU1xH,KAAMlP,KAAK06D,MAAM6kE,OAC1D,CACAthI,6BACU+B,KAAKk8B,KAAK,CAAEtiC,GAAIoG,KAAK4gI,SAAU1xH,KAAMlP,KAAK06D,MAAM2kE,OAC1D,CACAphI,sBAEA,EChCJ,MAAM,GAAM+hE,GAAO,gBAMnB,SAAS8gE,GAAa75G,GAClB,MAAMwhB,EAAS,IACRxhB,EACH/X,KAAM,GAAG8vH,GAAiB/3G,EAAI/X,UAAU+X,EAAI/X,SAQhD,OANI+X,EAAI/X,OAAS6vH,GAAaG,aAC1Bz2F,EAAOhsB,KAAO,GAAmBwK,EAAIxK,gBAAgBjiB,WAAaysB,EAAIxK,KAAOwK,EAAIxK,KAAKnlB,aAEtF2vB,EAAI/X,OAAS6vH,GAAaK,mBAAqBn4G,EAAI/X,OAAS6vH,GAAaW,mBACzEj3F,EAAOhsB,KAAO,GAAmBwK,EAAIxK,gBAAgBjiB,WAAaysB,EAAIxK,KAAOwK,EAAIxK,KAAKnlB,WAAY,WAE/FmxC,CACX,CACO,MAAMs4F,GACT17D,SAAW,eACXrc,KACA7qD,OACA6iI,UACA5yD,SACAL,MACAkzD,QACA/yD,gBACAn9B,YACAmwF,aACAphI,YAAYs7B,GACRA,EAAOA,GAAQ,CAAC,EAChBp7B,KAAKghI,UAAY,EACjBhhI,KAAKouE,SAAW,CAIZ+yD,WAAY,IAAI7mH,IAIhB8mH,UAAW,IAAI9mH,KAEnBta,KAAK+tE,MAAQ3yC,EACbp7B,KAAKkhI,aAAe9lG,EAAK8lG,cAvCX,IA2CdlhI,KAAKgpD,KAAOhpD,KAAKqhI,cAIjBrhI,KAAKihI,QnBaN,SAAmB7yH,EAAU,CAAC,GAyBjC,OAAO,IAxBUzX,IACb,IAAI0U,EACJ,MAAM1P,EAAS,GACf,MAAQhF,EAAO0vC,YACXh7B,EAAO1U,EAAOyI,QACF,MAARiM,IAFkB,CAKtB,GAAkB,MAAdA,EAAK+U,MACL,MAAM/U,EAAK+U,OAEG,IAAd/U,EAAKgtB,MAEL18B,EAAOjE,KAAK2T,EAAKxM,MAEzB,CACA,OAAY,MAARwM,EACO,CAAEgtB,MAAM,GAEZ,CACHA,MAAoB,IAAdhtB,EAAKgtB,KACXx5B,MAAOlD,EACV,GAEqByS,EAC9B,CmBvCuB,CAAU,CACrBw6D,YAAY,EACZH,MAAO,KAGH,IAAK,MAAMqG,KAAU9uE,KAAKouE,SAAS+yD,WAAWxlI,SAC1CmzE,EAAOrkD,UAEX,IAAK,MAAMqkD,KAAU9uE,KAAKouE,SAASgzD,UAAUzlI,SACzCmzE,EAAOrkD,SACX,IAGRzqB,KAAK7B,QAAS,QAAK6B,KAAKihI,SAAS9iI,GF7BlCF,gBAAuBE,EAAQmjI,EAAe,GACjD,GAAoB,MAAhBA,GAAyC,IAAjBA,QAYrB,GAAanjI,EAAQ,CACxB1G,KAAM6pI,EACNrzG,UAAW,CAAC3kB,EAAKqX,KACb,IAAK,MAAMlD,KAAKnU,EACZunD,GAAQxkD,MAAMoR,EAAGkD,EACrB,SAfJ,UAAW,MAAM6U,KAAYr3B,EAAQ,CACjC,MAAMwiB,EAAO,IAAI,KACjB,IAAK,MAAMsG,KAAOuO,EACdq7B,GAAQxkD,MAAM4a,EAAKtG,SAEjBA,EAAKrpB,UACf,CAYR,CEQmD,CAAO6G,EAAQ6B,KAAK+tE,MAAMuzD,gBAIrEthI,KAAKkuE,gBAAkB,IAAInmD,gBAC3B/nB,KAAK+wC,YAAc,IAAI,GAAAP,kBAAkB,CACrCsB,OAAQ1W,EAAKmmG,qBAnEI,EAoEjB/tF,SAAU,GAElB,CAII87B,cAEA,MAAMA,EAAU,GAChB,IAAK,MAAMR,KAAU9uE,KAAKouE,SAAS+yD,WAAWxlI,SAC1C2zE,EAAQ53E,KAAKo3E,GAEjB,IAAK,MAAMA,KAAU9uE,KAAKouE,SAASgzD,UAAUzlI,SACzC2zE,EAAQ53E,KAAKo3E,GAEjB,OAAOQ,CACX,CAKAC,UAAUlwE,GACN,GAAIW,KAAKkuE,gBAAgBjmD,OAAOG,QAC5B,MAAM,IAAI7vB,MAAM,wBAEpB,MAAMqB,EAAKoG,KAAKghI,YAChB3hI,EAAe,MAARA,EAAezF,EAAG+K,WAAatF,EAAKsF,WAC3C,MAAM68H,EAAWxhI,KAAKouE,SAAS+yD,WAC/B,OAAOnhI,KAAKwvE,WAAW,CAAE51E,KAAIyF,OAAM6P,KAAM,YAAasyH,YAC1D,CAIAvjI,YAAYmQ,GACR,GAAIpO,KAAKkuE,gBAAgBjmD,OAAOG,QAC5B,OAEJ,MAAMH,EAAS7Z,GAAS6Z,QAAUynD,YAAYC,QAAQ3vE,KAAKkhI,cAC3D,UAEU1vH,QAAQQ,IAAIhS,KAAKsvE,QAAQ10D,KAAI3c,MAAO+uB,GAAMA,EAAEzd,MAAM,CACpD0Y,cAEJjoB,KAAKihI,QAAQt+H,YAEP3C,KAAKihI,QAAQj4D,QAAQ,CACvB/gD,WAEJjoB,KAAKkuE,gBAAgBh2E,OACzB,CACA,MAAO0N,GACH5F,KAAK9H,MAAM0N,EACf,CACJ,CACA1N,MAAM0N,GACE5F,KAAKkuE,gBAAgBjmD,OAAOG,UAGhCpoB,KAAKsvE,QAAQlvE,SAAQ4sB,IAAOA,EAAE90B,MAAM0N,EAAI,IACxC5F,KAAKkuE,gBAAgBh2E,MAAM0N,GAC/B,CAIA67H,mBAAmBrzH,GACf,MAAM,GAAExU,EAAE,KAAEyF,GAAS+O,EACfozH,EAAWxhI,KAAKouE,SAASgzD,UAC/B,OAAOphI,KAAKwvE,WAAW,CAAE51E,KAAIyF,OAAM6P,KAAM,WAAYsyH,YACzD,CACAhyD,WAAWphE,GACP,MAAM,GAAExU,EAAE,KAAEyF,EAAI,KAAE6P,EAAI,SAAEsyH,GAAapzH,EAErC,GADA,GAAI,mBAAoBc,EAAMtV,GACjB,cAATsV,GAAwBlP,KAAKouE,SAAS+yD,WAAW1pI,QAAUuI,KAAK+tE,MAAM7D,oBA9I9B,MA+IxC,MAAM,IAAI,MAAU,iCAAkC,iCAE1D,GAAIs3D,EAASxmH,IAAIphB,GACb,MAAM,IAAIrB,MAAM,GAAG2W,YAAetV,qBAEtC,MAaMk1E,EDjIP,SAAsB1gE,GACzB,MAAM,GAAExU,EAAE,KAAEyF,EAAI,KAAE68B,EAAI,MAAEusC,EAAK,KAAEv5D,EAAO,YAAW,WAAEwyH,EAAa7B,IAAiBzxH,EACjF,OAAO,IAAIuyH,GAAY,CACnB/mI,GAAa,cAATsV,EAAuB,IAAKtV,IAAQ,IAAIA,IAC5CgnI,SAAUhnI,EACVyF,KAAM,GAAW,MAARA,EAAezF,EAAKyF,IAC7BmsB,UAAoB,cAATtc,EAAuB,WAAa,UAC/C2xH,YAAaa,EACbj5D,QACAvsC,OACAvjC,IAAKqnE,GAAO,uBAAuB9wD,KAAQtV,MAEnD,CCqHuB+nI,CAAa,CAAE/nI,KAAIyF,OAAM68B,KAb3Bj+B,MAAOgpB,IACZ,GAAI6b,SACJ,GAAItqC,MAAM,oBAAqB0W,EAAMtV,EAAIknI,GAAa75G,IAE1DjnB,KAAKihI,QAAQvpI,KAAKuvB,EAAI,EASoB/X,OAAMu5D,MAPtC,KACV,GAAI,6CAA8Cv5D,EAAMtV,EAAIk1E,EAAOzJ,UACnEm8D,EAASvpH,OAAOre,GACc,MAA1BoG,KAAK+tE,MAAMa,aACX5uE,KAAK+tE,MAAMa,YAAYE,EAC3B,EAEuD4yD,WAAY1hI,KAAK+tE,MAAM2zD,aAElF,OADAF,EAAS3lI,IAAIjC,EAAIk1E,GACVA,CACX,CAKAuyD,cAmBI,OAlBapjI,MAAOE,IAChB,IACIA,EAAS,GAAgBA,EAAQ6B,KAAKkuE,gBAAgBjmD,OAAQ,CAC1D8/C,eAAe,IAEnB,MAAMxX,EAAU,IAAI,GAAQvwD,KAAK+tE,MAAM2zD,WAAY1hI,KAAK+tE,MAAMmyD,gCAC9D,UAAW,MAAMn5D,KAAS5oE,EACtB,IAAK,MAAM8oB,KAAOspC,EAAQlkD,MAAM06D,SACtB/mE,KAAK4hI,gBAAgB36G,GAGnCjnB,KAAKihI,QAAQt+H,KACjB,CACA,MAAOiD,GACH,GAAI,gBAAiBA,GACrB5F,KAAKihI,QAAQt+H,IAAIiD,EACrB,EAGR,CACA3H,sBAAsB4J,GAClB,MAAM,GAAEjO,EAAE,KAAEsV,GAASrH,EAKrB,GAJI,GAAIi7B,SACJ,GAAItqC,MAAM,mBAAoBsoI,GAAaj5H,IAG3CA,EAAQqH,OAAS6vH,GAAaG,WAAY,CAC1C,GAAIl/H,KAAKouE,SAASgzD,UAAU3pI,QAAUuI,KAAK+tE,MAAM9D,mBAtMV,MAsM4E,CAC/G,GAAI,iCAGJjqE,KAAKihI,QAAQvpI,KAAK,CACdkC,KACAsV,KAAM6vH,GAAaa,iBAKvB,UACU5/H,KAAK+wC,YAAYW,QAAQ,aAAc,EACjD,CACA,MAII,OAHA,GAAI,mHAEJ1xC,KAAK9H,MAAM,IAAIK,MAAM,yBAEzB,CACA,MACJ,CACA,MAAMu2E,EAAS9uE,KAAKyhI,mBAAmB,CAAE7nI,KAAIyF,KAAM,GAAmBwI,EAAQ4U,gBAAgBjiB,WAAaqN,EAAQ4U,KAAO5U,EAAQ4U,KAAKnlB,cAIvI,YAHmC,MAA/B0I,KAAK+tE,MAAMY,kBACX3uE,KAAK+tE,MAAMY,iBAAiBG,GAGpC,CACA,MACMA,GADsB,IAAP,EAAP5/D,GAAkBlP,KAAKouE,SAAS+yD,WAAanhI,KAAKouE,SAASgzD,WACrDzgI,IAAI/G,GACxB,GAAc,MAAVk1E,EAAgB,CAChB,GAAI,wCAAyCl1E,EAAIolI,GAAiB9vH,IAIlE,UACUlP,KAAK+wC,YAAYW,QAAQ,iBAAkB,EACrD,CACA,MAII,OAHA,GAAI,yGAEJ1xC,KAAK9H,MAAM,IAAIK,MAAM,yCAEzB,CACA,MACJ,CACA,MAAMmvG,EAAgB1nG,KAAK+tE,MAAM8zD,qBAlPV,QAmPvB,IACI,OAAQ3yH,GACJ,KAAK6vH,GAAaK,kBAClB,KAAKL,GAAaW,iBACd,GAAI5wD,EAAOgzD,uBAAyBp6B,EAOhC,MALA1nG,KAAKihI,QAAQvpI,KAAK,CACdkC,GAAIiO,EAAQjO,GACZsV,KAAMA,IAAS6vH,GAAaK,kBAAoBL,GAAaa,eAAiBb,GAAaS,kBAGzF,IAAI,MAAU,iFAAkF,gCAG1G1wD,EAAO3B,WAAWtlE,EAAQ4U,MAC1B,MACJ,KAAKsiH,GAAaO,gBAClB,KAAKP,GAAaY,eAEd7wD,EAAOvB,mBACP,MACJ,KAAKwxD,GAAaS,gBAClB,KAAKT,GAAaa,eAEd9wD,EAAOviE,QACP,MACJ,QACI,GAAI,0BAA2B2C,GAE3C,CACA,MAAOtJ,GACH,GAAIwa,MAAM,iCAAkCxa,GAC5CkpE,EAAO52E,MAAM0N,EACjB,CACJ,EClSJ,MAAMm8H,GACF18D,SAAW,eACX0I,MACAjuE,YAAYs7B,EAAO,CAAC,GAChBp7B,KAAK+tE,MAAQ3yC,CACjB,CACA4yC,kBAAkB5yC,EAAO,CAAC,GACtB,OAAO,IAAI2lG,GAAiB,IACrB3lG,KACAp7B,KAAK+tE,OAEhB,EAEG,SAASi0D,GAAM5mG,EAAO,CAAC,GAC1B,MAAO,IAAM,IAAI2mG,GAAM3mG,EAC3B,yCCZO,SAAS,GAAargC,GACzB,OAAyB,MAArB+sB,WAAW1lB,OACJ,IAAI5H,WAAWO,EAAIpE,OAAQoE,EAAImhB,WAAYnhB,EAAI8R,YAEnD9R,CACX,CCOO,SAAS,GAAYtD,EAAO,GAC/B,OAAsC,MAAlCqwB,WAAW1lB,QAAQ8I,YACZ,GAAa4c,WAAW1lB,OAAO8I,YAAYzT,IAE/C,IAAI+C,WAAW/C,EAC1B,CCnBA,SAAS,GAAY4H,EAAMma,EAAQzK,EAAQ3C,GACvC,MAAO,CACH/M,OACAma,SACAq3C,QAAS,CACLxxD,OACAma,SACAzK,UAEJwhD,QAAS,CACLnkD,UAGZ,CACA,MAAM,GAAS,GAAY,OAAQ,KAAMrR,GAE9B,IADS,IAAIg4D,YAAY,QACX3mD,OAAOrR,KAC5BM,IACgB,IAAI0d,aACLhK,OAAO1T,EAAIoE,UAAU,MAElC,GAAQ,GAAY,QAAS,KAAM1E,IACrC,IAAI2I,EAAS,IACb,IAAK,IAAIpI,EAAI,EAAGA,EAAIP,EAAI9D,OAAQqE,IAC5BoI,GAAUvM,OAAOC,aAAa2D,EAAIO,IAEtC,OAAOoI,CAAM,IACbrI,IAEA,MAAMN,EAAM,IADZM,EAAMA,EAAIoE,UAAU,IACQxI,QAC5B,IAAK,IAAIqE,EAAI,EAAGA,EAAID,EAAIpE,OAAQqE,IAC5BP,EAAIO,GAAKD,EAAIG,WAAWF,GAE5B,OAAOP,CAAG,IAWd,OATc,CACV6G,KAAM,GACN,QAAS,GACTu1D,IAAK,UACLC,OAAQ,GACRF,MAAK,GACLG,OAAQ,MACL,ICnCA,SAAS,GAAW3zD,EAAQuH,EAAW,QAC1C,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKtE,QAAQnkD,OAAO,GAAGyoD,EAAKr7C,SAAS9V,KAHjC,GAAaokB,WAAW1lB,OAAOoE,KAAK9C,EAAQ,SAI3D,CChBO,SAAS,GAAO+c,EAAGnE,GACtB,GAAImE,IAAMnE,EACN,OAAO,EAEX,GAAImE,EAAE5T,aAAeyP,EAAEzP,WACnB,OAAO,EAEX,IAAK,IAAIvR,EAAI,EAAGA,EAAImlB,EAAE5T,WAAYvR,IAC9B,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GACX,OAAO,EAGf,OAAO,CACX,CCfA,MAAM,GAAyB,GACzB,GAA0B,GAC1B,GAAmB,GAwCzB,SAAS,GAAWo8D,EAAetiC,GAC/B,MAAMu4B,EAAa,IAAInzD,WAAW,IAClC,IAAK,IAAIc,EAAI,EAAGA,EAAI,GAAkBA,IAClCqyD,EAAWryD,GAAKo8D,EAAcp8D,GAC9BqyD,EAAW,GAAmBryD,GAAK85B,EAAU95B,GAEjD,OAAOqyD,CACX,CC7CO,SAAS,GAAO9J,EAAQ5sD,GACb,MAAVA,IACAA,EAAS4sD,EAAOz0B,QAAO,CAACtd,EAAK5S,IAAS4S,EAAM5S,EAAKjI,QAAQ,IAE7D,MAAMwxC,EAAS,GAAYxxC,GAC3B,IAAIC,EAAS,EACb,IAAK,MAAM2D,KAAOgpD,EACdpb,EAAO5sC,IAAIhB,EAAK3D,GAChBA,GAAU2D,EAAI5D,OAElB,OAAO,GAAawxC,EACxB,CCbA,QACI9nC,IAAIg3D,EAAM7vC,YACN,MAAM8vC,EAAeD,EAAI/iB,OACzB,GAAoB,MAAhBgjB,GAA+C,MAAvBA,EAAalD,OACrC,MAAMh2D,OAAO6W,OAAO,IAAIhd,MAAM,gRAI0D,CAAE8V,KAAM,2BAEpG,OAAOupD,CACX,GCDG,MAAM,GAA0B,CAAEE,IAAK,UAAWj2C,KAAK,EAAM3O,EAAG,yBAA0B6kD,QAAS,CAAC,UAAW,WAAYC,IAAK,OCNhI/5D,eAAe,GAAS0vD,EAAYuK,GACvC,MAAMC,EDOH,SAAgBpmB,GACnB,MAAMqmB,EAAYrmB,GAAMqmB,WAAa,UACrC,IAAIC,EAAYtmB,GAAMsmB,WAAa,GACnC,MAAMC,EAAcvmB,GAAMumB,aAAe,GACnCjO,EAAStY,GAAMsY,QAAU,UACzBkO,EAAaxmB,GAAMwmB,YAAc,GACjCC,EAAazmB,GAAMymB,YAAc,MACjC5jB,EAAS,SA0Ef,OAzEAyjB,GAAa,EAqEE,CACXjK,QAjEJnwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOjW,EAAO6jB,gBAAgB,IAAIj+D,WAAW+9D,IAC7CtK,EAAQrZ,EAAO6jB,gBAAgB,IAAIj+D,WAAW89D,IAC9CI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OAAc,CACvB2hE,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAO,GAAyB,CAAEx5D,KAAM,YAAa,EAAM,CAAC,YACtG,IACI,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAO,GAAyB,CAAEx5D,KAAM,YAAa,EAAM,CAAC,WAC1G,CACJ,KACK,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAM/J,QAAmB1Z,EAAO8f,OAAOtG,QAAQsK,EAAQE,EAAWn8C,GAClE,OAAO,GAAO,CAACouC,EAAM6N,EAAOC,GAAI,IAAIn+D,WAAW8zD,IACnD,EAsCIC,QA/BJtwD,eAAuBwe,EAAMy7C,GACzB,MAAMrN,EAAOpuC,EAAKnlB,SAAS,EAAGihE,GACxBtK,EAAQxxC,EAAKnlB,SAASihE,EAAYA,EAAaD,GAC/ChK,EAAa7xC,EAAKnlB,SAASihE,EAAaD,GACxCI,EAAS,CAAEr5D,KAAM+4D,EAAWO,GAAI1K,GAItC,IAAI2K,EACJ,GAJwB,iBAAbV,IACPA,EAAW,GAAWA,IAGF,IAApBA,EAASjhE,OACT,IACI,MAAM6hE,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE0O,QAAoCnkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC/Gu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcC,EAA6B,CAAE15D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACxI,CACA,MACIO,QAAkBhkB,EAAO8f,OAAOmE,UAAU,MAAO,GAAyB,CAAEx5D,KAAM,YAAa,EAAM,CAAC,WAC1G,KAEC,CAED,MAAMy5D,EAAe,CAAEz5D,KAAM,SAAUwrD,OAAM2N,aAAYl5D,KAAM,CAAED,KAAMgrD,IACjE4O,QAAerkB,EAAO8f,OAAOmE,UAAU,MAAOX,EAAU,CAAE74D,KAAM,WAAY,EAAO,CAAC,cAC1Fu5D,QAAkBhkB,EAAO8f,OAAOsE,UAAUF,EAAcG,EAAQ,CAAE55D,KAAM+4D,EAAWnhE,OAAQohE,IAAa,EAAM,CAAC,WACnH,CAEA,MAAMrK,QAAkBpZ,EAAO8f,OAAOnG,QAAQmK,EAAQE,EAAWtK,GACjE,OAAO,IAAI9zD,WAAWwzD,EAC1B,EAMJ,CCzFmB,GACTkL,QAAqBf,EAAO/J,QAAQT,EAAYuK,GACtD,OAAO,UAAcgB,EACzB,CCLO,IAAI,GAMP,GAWO,GAiDA,IAjEX,SAAWC,GACPA,EAAa,IAAI,MACjBA,EAAiB,QAAI,UACrBA,EAAmB,UAAI,WAC1B,CAJD,CAIG,KAAY,GAAU,CAAC,IAE1B,SAAWC,GACPA,EAAgBA,EAAqB,IAAI,GAAK,MAC9CA,EAAgBA,EAAyB,QAAI,GAAK,UAClDA,EAAgBA,EAA2B,UAAI,GAAK,WACvD,CAJD,CAIG,KAAoB,GAAkB,CAAC,IAC1C,SAAWD,GACPA,EAAQxC,MAAQ,KACL,SAAY,GAE1B,CAJD,CAIG,KAAY,GAAU,CAAC,IAE1B,SAAW0C,GACP,IAAIE,EACJF,EAAU1C,MAAQ,KACA,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACT,GAAQ6zD,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAO,GAAQ07D,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXF,EAAUtqD,OAAUzF,IACT,SAAcA,EAAK+vD,EAAU1C,SAExC0C,EAAUjtD,OAAUrR,IACT,SAAcA,EAAKs+D,EAAU1C,QAE3C,CA/CD,CA+CG,KAAc,GAAY,CAAC,IAE9B,SAAW2C,GACP,IAAIC,EACJD,EAAW3C,MAAQ,KACD,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEU,MAAZhD,EAAIrO,OACJglC,EAAEn9B,OAAO,GACT,GAAQ6zD,QAAQ5nD,OAAOzF,EAAIrO,KAAMglC,IAErB,MAAZ32B,EAAImwD,OACJx5B,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImwD,QAEa,IAAzB1nB,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIrO,KAAO,GAAQ07D,QAAQvqD,OAAOtK,GAClC,MACJ,KAAK,EACDwH,EAAImwD,KAAO33D,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEXD,EAAWvqD,OAAUzF,IACV,SAAcA,EAAKgwD,EAAW3C,SAEzC2C,EAAWltD,OAAUrR,IACV,SAAcA,EAAKu+D,EAAW3C,QAE5C,CA/CD,CA+CG,KAAe,GAAa,CAAC,IChHzB,MAAM,GACT/X,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAO,GAAUzwC,EAAK,GAC/B,CACAlQ,aAAawe,EAAM6Z,GACf,ON0BDr4B,eAA6Bm3B,EAAWkB,EAAKrP,GAChD,OAAO,aAAUqP,EAAKrP,EAAKmO,EAC/B,CM5Be,CAAqBp1B,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAM,GACTq7C,KACAkb,WAGAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAO,GAAUzwC,EAAK,IAC3BnO,KAAK85D,WAAa,GAAU1kC,EAAW,GAC3C,CACAn3B,WAAW4J,GACP,ONPD5J,eAA2B0vD,EAAY1mC,GAC1C,MAAMywC,EAAgB/J,EAAWr2D,SAAS,EAAG,IAC7C,OAAO,WAAQ2vB,EAAKywC,EACxB,CMIe,CAAmB13D,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAI,GAAiB/5D,KAAK85D,WACrC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,WACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAUAtF,WACI,MAAMgN,EAAW,UAAgBjL,KAAK+5D,OAAOx2D,OAC7C,OAAO,UAAiB0H,EAAS1H,OAAO9D,UAAU,EACtD,CAIAxB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAO,GAAS5O,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAAS,GAA2BrL,GAEvC,GAAIA,EAAMtM,OAAS,GAAyB,CAExC,MAAMgjE,GADN12D,EAAQ,GAAUA,EAAO,GAA0B,KACrBjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,GAAyBiM,EAAMtM,QACrE,OAAO,IAAI,GAAkBgjE,EAAiBC,EAClD,CAEA,MAAMD,GADN12D,EAAQ,GAAUA,EAAO,KACKjM,SAAS,EAAG,IACpC4iE,EAAiB32D,EAAMjM,SAAS,IACtC,OAAO,IAAI,GAAkB2iE,EAAiBC,EAClD,CACO,SAAS,GAA0B32D,GAEtC,OADAA,EAAQ,GAAUA,EAAO,IAClB,IAAI,GAAiBA,EAChC,CACOtF,eAAe,KAClB,MAAM,WAAE0vD,EAAU,UAAEv4B,SNrGjBn3B,iBAEH,MAAMy5D,EAAgB,+BAChBtiC,EAAY,mBAAgBsiC,GAGlC,MAAO,CACH/J,WAFe,GAAW+J,EAAetiC,GAGzCA,YAER,CM2F4C,GACxC,OAAO,IAAI,GAAkBu4B,EAAYv4B,EAC7C,CACOn3B,eAAe,GAAwB4vD,GAC1C,MAAM,WAAEF,EAAU,UAAEv4B,SN3FjBn3B,eAAmC4vD,GACtC,GAAIA,EAAK52D,SAAW,GAChB,MAAM,IAAI+N,UAAU,sCAEnB,KAAM6oD,aAAgBrzD,YACvB,MAAM,IAAIwK,UAAU,mDAGxB,MAAM0yD,EAAgB7J,EAChBz4B,EAAY,mBAAgBsiC,GAElC,MAAO,CACH/J,WAFe,GAAW+J,EAAetiC,GAGzCA,YAER,CM4E4C,CAA2By4B,GACnE,OAAO,IAAI,GAAkBF,EAAYv4B,EAC7C,CACA,SAAS,GAAUjnB,EAAKlX,GAEpB,IADAkX,EAAM3T,WAAWgM,KAAK2H,GAAO,KACrBlX,SAAWA,EACf,MAAM,IAAI,MAAU,sCAAsCA,UAAekX,EAAIlX,SAAU,wBAE3F,OAAOkX,CACX,CChHO,SAAS,GAAS0O,EAAO5R,EAAW,QACvC,MAAM4pD,EAAO,GAAM5pD,GACnB,GAAY,MAAR4pD,EACA,MAAM,IAAIt8D,MAAM,yBAAyB0S,MAE7C,MAAkB,SAAbA,GAAoC,UAAbA,GAA8C,MAArB6c,WAAW1lB,QAA4C,MAA1B0lB,WAAW1lB,OAAOoE,KAI7FquD,EAAKhE,QAAQ9hD,OAAO8N,GAAOpd,UAAU,GAHjCqoB,WAAW1lB,OAAOoE,KAAKqW,EAAMlmB,OAAQkmB,EAAMX,WAAYW,EAAMhQ,YAAYlI,SAAS,OAIjG,CCXO,SAAS,GAA0BgiC,EAAK3qC,GAE3C,IAAIjB,EAAMP,WAAWgM,KAAKmgC,EAAIxf,MAAMG,eAMpC,GADAvsB,EAAiB,IAAXA,EAAI,GAAWA,EAAIzD,SAAS,GAAKyD,EAC5B,MAAPiB,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAO,GAAmBA,EAAK,YACnC,CAEO,SAAS,GAAsBM,GAClC,MAAMN,EAGH,SAA2BM,EAAKW,GACnC,IAAIjB,EAAM,GAAqBM,EAAK,gBACpC,GAAW,MAAPW,EAAa,CACb,GAAIjB,EAAI9D,OAAS+E,EACb,MAAM,IAAIzD,MAAM,yCACpBwC,EAAM,GAAiB,CAAC,IAAIP,WAAWwB,EAAMjB,EAAI9D,QAAS8D,GAC9D,CACA,OAAOA,CACX,CAXgB,CAAkBM,GAC9B,OAAO,IAAI,mBAAsB,GAAmBN,EAAK,UAAW,GACxE,CCpBA,MAAM,GAAO,CACT,QAAS,IACT,QAAS,IACT,QAAS,KAEM2D,OAAO+I,KAAK,IACN9P,KAAK,OCZvB,MAAM,GAA+B,iBAAfmwB,YAA2B,WAAYA,WAAaA,WAAW8sB,YAASltC,ECmBrG,KADgF,KAA5D,IAAIlN,WAAW,IAAI1D,YAAY,CAAC,YAAaH,QAAQ,IAErE,MAAM,IAAI4B,MAAM,+CClBL,SAAS,GAAYtB,GAChC,GAAIg2B,MAAMh2B,IAAWA,GAAU,EAC3B,MAAM,IAAI,MAAU,qDAAsD,sBAE9E,OD6IG,SAAqBujE,EAAc,IACtC,GAAI,IAA4C,mBAA3B,mBACjB,OAAO,mBAAuB,IAAIhgE,WAAWggE,IAEjD,MAAM,IAAIjiE,MAAM,yCACpB,CClJW,CAAMtB,EACjB,CCHA,SAAS,GAAQkX,EAAKusD,GAClB,OAAOA,EAAM9/C,KAAI4kB,GAAK,GAAsBrxB,EAAIqxB,KACpD,CCgBOvhC,eAAe,GAAoBkQ,GACtC,MAIM06C,EAAO,OAJY,SAAgB6L,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,eAGA,GAAwB8O,IAE5B1G,QAAa,GAAU,CACzBkmD,WAAY9E,EAAK,GACjBzzB,UAAWyzB,EAAK,KAEpB,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CAiBAxJ,eAAe,GAAU4qD,GACrB,GAAuB,MAAnBA,EAAK8E,YAAwC,MAAlB9E,EAAKzzB,UAChC,MAAM,IAAI,MAAU,sCAAuC,0BAE/D,OAAO5jB,QAAQQ,IAAI,CACf,SAAgB0iD,OAAOkG,UAAU,MAAO/R,EAAK8E,YAC7C,SAAgB+G,OAAOkG,UAAU,MAAO/R,EAAKzzB,YAErD,CACAn3B,eAAe,GAAwB48D,GACnC,OAAO,SAAgBnG,OAAOmE,UAAU,MAAO,CAC3Cb,IAAK6C,EAAM7C,IACXv/D,EAAGoiE,EAAMpiE,EACTgR,EAAGoxD,EAAMpxD,GACV,CACCpK,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,UACd,CAYA,SAAS,GAAW8O,EAAK4sD,EAAK9zC,EAAK+zC,GAC/B,MAAMC,EAAOF,ED7EV,SAAiB5sD,GACpB,OAAO,0BAA6B,GAAQA,EAAK,CAAC,IAAK,MAC3D,CC2EuB,CAAQA,GDhFxB,SAAkBA,GACrB,OAAO,2BAA8B,GAAQA,EAAK,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,OAC5F,CC8EsC,CAASA,GAG3C,OAAO,GADO6sD,EADD,GAAmBxgE,WAAWgM,KAAKygB,GAAM,SAC3Bg0C,GACQ,QACvC,CAOO,SAAS,GAAQI,GACpB,GAAgB,QAAZA,EAAIrD,IACJ,MAAM,IAAI,MAAU,mBAAoB,wBAEvC,GAAa,MAATqD,EAAI5iE,EACT,MAAM,IAAI,MAAU,sBAAuB,2BAG/C,OAAsB,EADR,GAAqB4iE,EAAI5iE,EAAG,aAC7BxB,MACjB,CCjGO,MAAM,GAAe,KACrB,MAAM,GACT2nD,KACA9+C,YAAYqO,GACRnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODgCDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,MAAMmO,QAAkB,SAAgBs/B,OAAOmE,UAAU,MAAO1qD,EAAK,CACjE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,WACX,OAAO,SAAgBq1D,OAAO8G,OAAO,CAAEn8D,KAAM,qBAAuB+1B,EAAWkB,EAAKrP,EACxF,CCtCe,CAAqBjnB,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,OCkCD,SAAmByB,GACtB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,EACrB,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMgyD,EAAO,uBAA0B,CACnChjE,EAAG,GAAsB4iE,EAAI5iE,GAC7BgR,EAAG,GAAsB4xD,EAAI5xD,KAEjC,OAAO,GAAqB,cAAiBgyD,GAAMC,WAAY,QACnE,CD3Ce,CAAuB17D,KAAK4+C,KACvC,CACIr7C,YACA,OAAO,UAAqB,CACxBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA82D,QAAQ7qD,GACJ,ODgEG,GChEmBvD,KAAK4+C,MDgER,EChEcr7C,GDgEH,CAAC0jB,EAAK9Y,IAAQA,EAAIigD,QAAQnnC,IC/D5D,CACAjG,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAM,GACTq7C,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,CACtB,CACAwmC,YACI,OAAO,GAAuB,GAClC,CACA39D,WAAW4J,GACP,ODTD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM0mC,QAAmB,SAAgB+G,OAAOmE,UAAU,MAAO1qD,EAAK,CAClE9O,KAAM,oBACNC,KAAM,CAAED,KAAM,aACf,EAAO,CAAC,SACLi3B,QAAY,SAAgBo+B,OAAOnuD,KAAK,CAAElH,KAAM,qBAAuBsuD,EAAYnzD,WAAWgM,KAAKygB,IACzG,OAAO,IAAIzsB,WAAW87B,EAAK,EAAGA,EAAIzpB,WACtC,CCEe,CAAmB7M,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,GAAuB,MAAnB/5D,KAAK85D,WACL,MAAM,IAAI,MAAU,0BAA2B,2BAEnD,OAAO,IAAI,GAAa95D,KAAK85D,WACjC,CACAvL,QAAQhrD,GACJ,ODqCG,GCrCmBvD,KAAK4+C,MDqCR,ECrCcr7C,GDqCF,CAAC0jB,EAAK9Y,IAAQA,EAAIogD,QAAQtnC,ICpC7D,CACA2yC,UACI,OCnCD,SAAoByB,GACvB,GAAa,MAATA,EAAI5iE,GAAsB,MAAT4iE,EAAI5xD,GAAsB,MAAT4xD,EAAIt+B,GAAsB,MAATs+B,EAAI9/D,GAAsB,MAAT8/D,EAAIhe,GAAuB,MAAVge,EAAIQ,IAAwB,MAAVR,EAAIS,IAAwB,MAAVT,EAAIU,GAC7H,MAAM,IAAI,MAAU,6BAA8B,0BAEtD,MAAMN,EAAO,wBAA2B,CACpChjE,EAAG,GAAsB4iE,EAAI5iE,GAC7BgR,EAAG,GAAsB4xD,EAAI5xD,GAC7BszB,EAAG,GAAsBs+B,EAAIt+B,GAC7BxhC,EAAG,GAAsB8/D,EAAI9/D,GAC7B8hD,EAAG,GAAsBge,EAAIhe,GAC7B2e,GAAI,GAAsBX,EAAIQ,IAC9BI,GAAI,GAAsBZ,EAAIS,IAC9BI,KAAM,GAAsBb,EAAIU,MAEpC,OAAO,GAAqB,cAAiBN,GAAMC,WAAY,QACnE,CDoBe,CAAwB17D,KAAK4+C,KACxC,CACIr7C,YACA,OAAO,UAAsB,CACzBtI,KAAM,OACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,UAC5B,GAAe,WAAXA,EAAqB,CACrB,MAAMjY,EAAS,IAAI,mBAAsBqJ,KAAK45D,WACxC6B,EAAO,gBAAmB9kE,GAC1Bg3D,EAAa,0BAA6B8N,GAC1CrtD,EAAU,CACZgqD,UAAW,SACX9mD,MAAO,IACP6qD,SAAU,GACVC,aAAc,UAElB,OAAO,4BAA+BzO,EAAYuK,EAAU9pD,EAChE,CACK,GAAe,eAAXQ,EACL,OAAO,GAAS5O,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG3Q,eAAe,GAAuBsF,GACzC,MAAM83D,ECxGH,SAAoB93D,GACvB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpDoqD,EAAa,0BAA6B8N,GAEhD,MAAO,CACHzD,IAAK,MACLv/D,EAAG,GAA0Bk1D,EAAWl1D,GACxCgR,EAAG,GAA0BkkD,EAAWlkD,GACxCszB,EAAG,GAA0B4wB,EAAW5wB,GACxCxhC,EAAG,GAA0BoyD,EAAWpyD,GACxC8hD,EAAG,GAA0BsQ,EAAWtQ,GACxCwe,GAAI,GAA0BlO,EAAWqO,IACzCF,GAAI,GAA0BnO,EAAWsO,IACzCF,GAAI,GAA0BpO,EAAWuO,MACzCpE,IAAK,QAEb,CDwFgB,CAAwBv0D,GACpC,GAAI,GAAe83D,GAAO,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM5zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAI,GAAc5zD,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACO,SAAS,GAAsB7xB,GAClC,MAAM83D,EC7EH,SAAmB93D,GACtB,MAAMk4D,EAAO,gBAAmB,GAAmBl4D,EAAO,UACpD6xB,EAAY,yBAA4BqmC,GAC9C,MAAO,CACHzD,IAAK,MACLv/D,EAAG,GAA0B28B,EAAU38B,GACvCgR,EAAG,GAA0B2rB,EAAU3rB,GAE/C,CDqEgB,CAAuBlG,GACnC,GAAI,GAAe83D,GAAO,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,OAAO,IAAI,GAAaA,EAC5B,CACOp9D,eAAe,GAAQo9D,GAC1B,GAAI,GAAeA,GAAO,GACtB,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAM5zD,QAAa,GAA2B4zD,GAC9C,OAAO,IAAI,GAAc5zD,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CACOn3B,eAAe,GAAgBsE,GAClC,GAAIA,EAAO,GACP,MAAM,IAAI,MAAU,wBAAyB,0BAEjD,MAAMkF,QDlIHxJ,eAA2BsE,GAC9B,MAAMsmD,QAAa,SAAgB6L,OAAO8H,YAAY,CAClDn9D,KAAM,oBACNo9D,cAAel6D,EACfm6D,eAAgB,IAAIliE,WAAW,CAAC,EAAM,EAAM,IAC5C8E,KAAM,CAAED,KAAM,aACf,EAAM,CAAC,OAAQ,WACZoI,QAAa,GAAUohD,GAC7B,MAAO,CACH8E,WAAYlmD,EAAK,GACjB2tB,UAAW3tB,EAAK,GAExB,CCsHuB,CAAmBlF,GACtC,OAAO,IAAI,GAAckF,EAAKkmD,WAAYlmD,EAAK2tB,UACnD,CE3FO,SAAS,GAAkBjnB,GAC9B,IACI,8BAA6BA,EACjC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,yBACrC,CACJ,CCjDO,MAAM,GACTg5C,KACA9+C,YAAYqO,GACR,GAAyBA,GACzBnO,KAAK4+C,KAAOzwC,CAChB,CACAlQ,aAAawe,EAAM6Z,GACf,ODUDr4B,eAA6BkQ,EAAKmoB,EAAKrP,GAC1C,IACI,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,OAAO,aAAYqP,EAAK+zB,EAAQl8C,EACpC,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CClBe,CAAqB5F,KAAK4+C,KAAMtoB,EAAK7Z,EAChD,CACAm9C,UACI,ODgB0BzrD,EChBMnO,KAAK4+C,KDiB3B,8BAA6BzwC,GAAK0uD,YAAW,GADxD,IAA2B1uD,CCf9B,CACI5K,YACA,OAAO,UAA8B,CACjCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,EAEG,MAAM,GACTq7C,KACAkb,WACAh6D,YAAYqO,EAAKinB,GACbp1B,KAAK4+C,KAAOzwC,EACZnO,KAAK85D,WAAa1kC,GDmBnB,SAA0Bu4B,GAC7B,IACI,OAAO,mBAAkBA,GAAY,EACzC,CACA,MAAO/nD,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CC1BuC,CAAwBuI,GDGxD,SAA4BA,GAC/B,IACI,mBAAkBA,GAAK,EAC3B,CACA,MAAOvI,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,0BACrC,CACJ,CCTQ,CAA0B5F,KAAK4+C,MAC/B,GAAyB5+C,KAAK85D,WAClC,CACA77D,WAAW4J,GACP,ODhCD5J,eAA2BkQ,EAAK8Y,GACnC,MAAM,OAAEojC,SAAiB,UAAcpjC,GACvC,IAEI,OADkB,WAAUojC,EAAQl8C,GACnB4uD,eACrB,CACA,MAAOn3D,GACH,MAAM,IAAI,MAAUzO,OAAOyO,GAAM,oBACrC,CACJ,CCuBe,CAAmB5F,KAAK4+C,KAAM/2C,EACzC,CACIkyD,aACA,OAAO,IAAI,GAAmB/5D,KAAK85D,WACvC,CACAF,UACI,OAAO55D,KAAK4+C,IAChB,CACIr7C,YACA,OAAO,UAA+B,CAClCtI,KAAM,aACNw+D,KAAMz5D,KAAK45D,YACZtiE,UACP,CACA0pB,OAAO7S,GACH,OAAO,GAAiBnO,KAAKuD,MAAO4K,EAAI5K,MAC5C,CACAtF,aACI,MAAM,MAAEsF,SAAgB,UAAcvD,KAAKuD,OAC3C,OAAOA,CACX,CAQAtF,WAEI,OAAO,SADY+B,KAAK+5D,OAAOz6D,OACC,YACpC,CAIArB,aAAai6D,EAAUtpD,EAAS,cAC5B,GAAe,eAAXA,EACA,OAAO,GAAS5O,KAAKuD,MAAO20D,GAG5B,MAAM,IAAI,MAAU,kBAAkBtpD,sBAA4B,4BAE1E,EAEG,SAAS,GAA6BrL,GACzC,OAAO,IAAI,GAAoBA,EACnC,CACO,SAAS,GAA4BA,GACxC,OAAO,IAAI,GAAmBA,EAClC,CACOtF,eAAe,KAClB,MAAMg8D,EDxFC,+BCyFP,OAAO,IAAI,GAAoBA,EACnC,CChFO,MAAM,GAAgB,CACzBkD,IAAK,EACLC,QAAS,EACTC,UAAW,GAEf,SAAS,GAAenuD,GACpB,MAAMquD,EAAY7+D,OAAO+I,KAAK,IAAe9P,KAAK,OAClD,OAAO,IAAI,MAAU,mCAAmCuX,cAAiBquD,IAAa,2BAC1F,CAsBO,SAAS,GAAmBxiE,GAC/B,MAAMyiE,EAAU,UAAyBziE,GACnC0hB,EAAO+gD,EAAQ/D,MAAQ,IAAIj/D,WACjC,OAAQgjE,EAAQviE,MACZ,KAAK,OACD,OAAO,GAAckiE,IAAIb,sBAAsB7/C,GACnD,KAAK,WACD,OAAO,GAAc2gD,QAAQjD,0BAA0B19C,GAC3D,KAAK,aACD,OAAO,GAAc4gD,UAAUJ,4BAA4BxgD,GAC/D,QACI,MAAM,GAAe+gD,EAAQviE,MAAQ,WAEjD,CCxDO,SAAS,GAAOwlB,EAAGnE,GACtB,GAAImE,IAAMnE,EACN,OAAO,EAEX,GAAImE,EAAE5T,aAAeyP,EAAEzP,WACnB,OAAO,EAEX,IAAK,IAAIvR,EAAI,EAAGA,EAAImlB,EAAE5T,WAAYvR,IAC9B,GAAImlB,EAAEnlB,KAAOghB,EAAEhhB,GACX,OAAO,EAGf,OAAO,CACX,CCPA,MAAM,GAAU9E,OAAOkqD,IAAI,8BACrB,GAAchiD,OACf/C,OAAO,IACPif,KAAI+7C,GAASA,EAAMpG,UAEnBnhC,QAAO,CAACtd,EAAK5S,IAAS4S,EAAIw+C,GAAGpxD,IAAO,qBAEnC,GAAkB,IAClB,GAAwC,GACxC,GAAyC,GAC/C,MAAM,GACFgQ,KACAqlD,UACA5G,WACAv4B,UACA1xB,OACA5D,YAAYs7B,GACRp7B,KAAKkP,KAAOksB,EAAKlsB,KACjBlP,KAAKu0D,UAAYn5B,EAAKm5B,UACtBv0D,KAAK2tD,WAAavyB,EAAKuyB,WAEvBjvD,OAAO2B,eAAeL,KAAM,SAAU,CAClCY,YAAY,EACZV,UAAU,GAElB,CACY41D,IAAPt/D,OAAOs/D,eACR,MAAO,UAAU91D,KAAK2E,aAC1B,CACA,CAAC,OAAU,EACXA,WAII,OAHmB,MAAf3E,KAAK0D,SACL1D,KAAK0D,OAAS,UAAiB1D,KAAKu0D,UAAUhxD,OAAOzK,MAAM,IAExDkH,KAAK0D,MAChB,CAGAo6D,QACI,OAAO,YAAa,GAAiB99D,KAAKu0D,UAC9C,CACAvK,UACI,OAAOhqD,KAAKu0D,UAAUhxD,KAC1B,CAIAie,SACI,OAAOxhB,KAAK2E,UAChB,CAIAqc,OAAOpnB,GACH,GAAIA,aAAcY,WACd,OAAO,GAAiBwF,KAAKu0D,UAAUhxD,MAAO3J,GAE7C,GAAkB,iBAAPA,EACZ,OAyEL,SAA0ByB,EAAKk1D,GAElC,GADAA,EAAUA,GAAW,GACC,MAAlBl1D,EAAIiP,OAAO,IAAgC,MAAlBjP,EAAIiP,OAAO,GAAY,CAGhD,MAAMiqD,EAAY,GAAc,UAAiB,IAAIl5D,MACrD,OAAIA,EAAI0iE,WAAW,OACR,IAAI,GAAkB,CAAExJ,cAE1Bl5D,EAAI0iE,WAAW,OACb,IAAI,GAAoB,CAAExJ,cAG1B,IAAI,GAAc,CAAEA,aAEnC,CACA,OAAO,GAAgB,GAAYnoD,OAAO/Q,GAC9C,CA1FmB,CAAiBzB,GAAIonB,OAAOhhB,MAElC,GAA4B,MAAxBpG,GAAI26D,WAAWhxD,MACpB,OAAO,GAAiBvD,KAAKu0D,UAAUhxD,MAAO3J,EAAG26D,UAAUhxD,OAG3D,MAAM,IAAIhL,MAAM,eAExB,CAaA,CAAC,MACG,MAAO,UAAUyH,KAAK2E,aAC1B,EAEJ,MAAM,WAAsB,GACxBuK,KAAO,MACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,QACvBlP,KAAKo1B,UAAYgG,EAAKhG,SAC1B,EAEJ,MAAM,WAA0B,GAC5BlmB,KAAO,UACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,YACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EAEJ,MAAM,WAA4B,GAC9Bn7C,KAAO,YACPkmB,UACAt1B,YAAYs7B,GACRzoB,MAAM,IAAKyoB,EAAMlsB,KAAM,cACvBlP,KAAKo1B,UAAYgG,EAAKm5B,UAAUlK,MACpC,EA4CG,SAAS,GAAgBtvD,GAC5B,IACI,MAAMw5D,EAAY,GAAcx5D,GAChC,GAAIw5D,EAAUlmD,OAAS,QAAe,CAClC,GAAIkmD,EAAUlK,OAAOpzD,SAAW,GAC5B,OAAO,IAAI,GAAkB,CAAEs9D,cAE9B,GAAIA,EAAUlK,OAAOpzD,SAAW,GACjC,OAAO,IAAI,GAAoB,CAAEs9D,aAEzC,CACA,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI,GAAc,CAAEkmD,aAEnC,CACA,MACI,OAID,SAAuBU,GAC1B,GAAW,MAAPA,GAAgC,MAAjBA,EAAIV,WAAoC,MAAfU,EAAI/rC,SAAoC,IAAhB+rC,EAAI/rC,SAAiB+rC,EAAI5mD,OAAS,GAClG,MAAM,IAAI9V,MAAM,kCAEpB,MAAMg8D,EAAYU,EAAIV,UACtB,GAAIA,EAAUlmD,OAAS,QACnB,OAAO,IAAI,GAAc,CAAEkmD,UAAWU,EAAIV,YAEzC,GAAIA,EAAUlmD,OAAS,QAAe,CACvC,GAAIkmD,EAAUlK,OAAOpzD,SAAW,GAC5B,OAAO,IAAI,GAAkB,CAAEs9D,UAAWU,EAAIV,YAE7C,GAAIA,EAAUlK,OAAOpzD,SAAW,GACjC,OAAO,IAAI,GAAoB,CAAEs9D,UAAWU,EAAIV,WAExD,CACA,MAAM,IAAIh8D,MAAM,iCACpB,CArBe,CAAc,UAAWwC,GACpC,CACA,MAAM,IAAIxC,MAAM,iCACpB,yCCjLO,MACM0pI,GAA4B,4BAE5BC,GAA6B,6BAC7BC,GAA0B,0BAG1BC,GAA0B,0BAK1BC,GAAuB,uBCN7B,IAAI,IACX,SAAWC,GACP,IAAIC,EAIAC,EASAjpE,GAZJ,SAAWgpE,GACPA,EAAkB,IAAI,KACzB,CAFD,CAEGA,EAAeD,EAAUC,eAAiBD,EAAUC,aAAe,CAAC,IAEvE,SAAWC,GACPA,EAAqBA,EAA0B,IAAI,GAAK,KAC3D,CAFD,CAEGA,IAAyBA,EAAuB,CAAC,IACpD,SAAWD,GACPA,EAAa5rE,MAAQ,KACV,SAAY6rE,EAE1B,CAJD,CAIGD,EAAeD,EAAUC,eAAiBD,EAAUC,aAAe,CAAC,IAEvED,EAAU3rE,MAAQ,KACA,MAAV4C,IACAA,GAAS,UAAQ,CAACjwD,EAAK22B,EAAG8R,EAAO,CAAC,MACD,IAAzBA,EAAKynB,iBACLv5B,EAAE3zB,OAEW,MAAbhD,EAAIzK,QACJohC,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAIzK,QAEO,MAAnByK,EAAIm5H,cACJxiG,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAIm5H,cAEQ,MAApBn5H,EAAIo5H,eACJziG,EAAEn9B,OAAO,IACTw/H,EAAUC,aAAa5rE,QAAQ5nD,OAAOzF,EAAIo5H,aAAcziG,IAExC,MAAhB32B,EAAIq5H,WACJ1iG,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAIq5H,WAEI,MAAhBr5H,EAAI+rB,WACJ4K,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOkF,EAAI+rB,WAEF,MAAX/rB,EAAImzF,MACJx8D,EAAEn9B,OAAO,IACTm9B,EAAE77B,OAAOkF,EAAImzF,MAEC,MAAdnzF,EAAIs5H,SACJ3iG,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAIs5H,SAEO,MAAnBt5H,EAAIu5H,cACJ5iG,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAIu5H,cAEA,MAAZv5H,EAAImT,OACJwjB,EAAEn9B,OAAO,IACTm9B,EAAE18B,MAAM+F,EAAImT,QAEa,IAAzBs1B,EAAKynB,iBACLv5B,EAAEzzB,QACN,IACD,CAAC1K,EAAQ7K,KACR,MAAMqS,EAAM,CAAC,EACP3G,EAAgB,MAAV1L,EAAiB6K,EAAO9F,IAAM8F,EAAOG,IAAMhL,EACvD,KAAO6K,EAAOG,IAAMU,GAAK,CACrB,MAAM0wB,EAAMvxB,EAAOgB,SACnB,OAAQuwB,IAAQ,GACZ,KAAK,EACD/pB,EAAIzK,MAAQiD,EAAOyB,QACnB,MACJ,KAAK,EACD+F,EAAIm5H,YAAc3gI,EAAOyB,QACzB,MACJ,KAAK,EACD+F,EAAIo5H,aAAeJ,EAAUC,aAAa5rE,QAAQvqD,OAAOtK,GACzD,MACJ,KAAK,EACDwH,EAAIq5H,SAAW7gI,EAAOyB,QACtB,MACJ,KAAK,EACD+F,EAAI+rB,SAAWvzB,EAAOsC,SACtB,MACJ,KAAK,EACDkF,EAAImzF,IAAM36F,EAAOsC,SACjB,MACJ,KAAK,EACDkF,EAAIs5H,OAAS9gI,EAAOyB,QACpB,MACJ,KAAK,EACD+F,EAAIu5H,YAAc/gI,EAAOyB,QACzB,MACJ,KAAK,EACD+F,EAAImT,KAAO3a,EAAOyB,QAClB,MACJ,QACIzB,EAAO+B,SAAe,EAANwvB,GAG5B,CACA,OAAO/pB,CAAG,KAGXiwD,GAEX+oE,EAAUvzH,OAAUzF,IACT,SAAcA,EAAKg5H,EAAU3rE,SAExC2rE,EAAUl2H,OAAUrR,IACT,SAAcA,EAAKunI,EAAU3rE,QAE3C,CA7GD,CA6GG,KAAc,GAAY,CAAC,ICrG9B,MAAM,GAAMqJ,GAAO,cACb8iE,IAAc,QAAqB,UA8ClC,MAAMC,GAAmB9kI,MAAO6gE,EAAQkkE,KAC3C,GAAc,MAAVA,GAA4B,MAAVlkE,EAAgB,CAClC,MAAM1+C,EAAQ,IAAI7nB,MAAM,0DAExB,MADA,GAAI6nB,MAAMA,GACJ,GAAQA,EAAO,GACzB,CACA,IAAIwiH,EACJ,GAAqB,MAAjBI,EAAOJ,OAAgB,CACvB,IACIA,EAAS,GAAmBI,EAAOJ,OACvC,CACA,MAAOh9H,GAEH,MADA,GAAIwa,MAAMxa,GACJA,CACV,CAEA,WH0HD3H,eAA8Bm3B,EAAWu4B,GAC5C,OAAIv4B,EAAUn+B,SAAW,GACd,IAAI,GAAkB,CAAEs9D,UAAW,GAAc,QAAen/B,GAAYu4B,eAEnFv4B,EAAUn+B,SAAW,GACd,IAAI,GAAoB,CAAEs9D,UAAW,GAAc,QAAen/B,GAAYu4B,eAElF,IAAI,GAAc,CAAE4G,gBAAiB,UAAcn/B,GAAYA,YAAWu4B,cACrF,CGnI8B,CAAeq1E,EAAOJ,SAC/B5hH,OAAO89C,GAChB,MAAM,GAAQ,IAAIvmE,MAAM,4CFrEI,2BEuEpC,MAC6B,MAApBumE,EAAO1pC,YACZwtG,EAAS,GAAmB9jE,EAAO1pC,YAEvC,GAAc,MAAVwtG,EACA,OAAOA,EAEX,MAAM,GAAQ,IAAIrqI,MAAM,8BAA+B,GAA+B,EAsCnF,SAAS8iF,GAAUtgF,GACtB,MAAM8M,EAAU,UAAiB9M,GAYjC,GAVwB,MAApB8M,EAAQwtB,WACRxtB,EAAQwtB,SAAWpT,OAAOpa,EAAQwtB,WAGnB,MAAfxtB,EAAQ40F,MACR50F,EAAQ40F,IAAMx6E,OAAOpa,EAAQ40F,MAKN,MAAvB50F,EAAQg7H,aAAuC,MAAhBh7H,EAAQ4U,KACvC,MAAM,GAAQ,IAAIlkB,MAAM,+BAAgC,IAE5D,MAAMkkB,EAAOwmH,GAAcp7H,EAAQ4U,MAC7B5d,EAAQs5B,GAAe1b,EAAKymH,OAClC,IAAIP,EACJ,IACIA,EAAW,YA7GZ,SAAsBQ,GACzB,MAAMC,EAAiB,IAAIt0G,OAE3B,mEAKMrR,EAAItmB,OAAOgsI,GAAMjqH,OAAO4mB,MAAMsjG,GACpC,GAAS,MAAL3lH,EACA,MAAM,IAAIllB,MAAM,kBAEpB,MAAM8qI,EAAO38H,SAAS+W,EAAE,GAAI,IACtB6lH,EAAQ58H,SAAS+W,EAAE,GAAI,IAAM,EAC7Bif,EAAOh2B,SAAS+W,EAAE,GAAI,IACtB8lH,EAAO78H,SAAS+W,EAAE,GAAI,IACtBkrG,EAASjiH,SAAS+W,EAAE,GAAI,IACxBgrG,EAAS/hH,SAAS+W,EAAE,GAAI,IACxB+lH,EAAc98H,SAAS+W,EAAE,GAAGgmH,OAAO,EAAG,KAAK3qI,MAAM,EAAG,GAAI,IAC9D,OAAO,IAAII,KAAKA,KAAKwqI,IAAIL,EAAMC,EAAO5mG,EAAM6mG,EAAM5a,EAAQF,EAAQ+a,GACtE,CAyFqCG,EAAa,QAAmBlnH,EAAKmnH,WACtE,CACA,MAAOn6H,GAEH,MADA,GAAI2W,MAAM,wDACJ,GAAQ,IAAI7nB,MAAM,wDAAyD,GACrF,CACA,GAAqB,MAAjBsP,EAAQhJ,OAAwC,MAAvBgJ,EAAQ46H,YAGjC,OADAoB,GAA8Bh8H,GACvB,CACHhJ,QACA6jI,aAAc,oBACdC,WACAttG,SAAU5Y,EAAKqnH,SACfrnC,IAAKhgF,EAAKigF,IACVkmC,OAAQ/6H,EAAQ+6H,OAChBH,YAAa56H,EAAQ46H,YACrBI,YAAah7H,EAAQg7H,YACrBpmH,KAAM5U,EAAQ4U,MAGjB,GAA2B,MAAvB5U,EAAQg7H,YAEb,MAAO,CACHhkI,QACA6jI,aAAc,oBACdC,WACAttG,SAAU5Y,EAAKqnH,SACfrnC,IAAKhgF,EAAKigF,IACVkmC,OAAQ/6H,EAAQ+6H,OAChBC,YAAah7H,EAAQg7H,YACrBpmH,KAAM5U,EAAQ4U,MAIlB,MAAM,IAAIlkB,MAAM,8DAExB,CACO,MAMMwrI,GAAwB51H,GAC1B,GAAgBA,EAAIrV,MAAMgqI,GAAY7rI,SAmBpCgsI,GAAiBloI,IAC1B,MAAM0hB,EAAO,GAAa1hB,GAC1B,GAA0B,IAAtB0hB,EAAK8lH,aAIL,MAAM,GAAQ,IAAIhqI,MAAM,yBAA0B,IAUtD,OAbIkkB,EAAK8lH,aAAe,oBAKpBv5H,OAAOD,UAAU0T,EAAKqnH,YAEtBrnH,EAAKqnH,SAAW7hH,OAAOxF,EAAKqnH,WAE5B96H,OAAOD,UAAU0T,EAAKigF,OAEtBjgF,EAAKigF,IAAMz6E,OAAOxF,EAAKigF,MAEpBjgF,CAAI,EAOF0b,GAAkBt5B,IAC3B,GAAa,MAATA,EAAe,CAEf,IAAI,QAASA,GACT,MAAO,SAASA,EAAMi/D,QAAQn5D,SAAS2tD,MAG3C,GAAIzzD,aAAiBrE,WAAY,CAC7B,MAAMkJ,GAAS,QAAmB7E,GAC9B6E,EAAOq6D,WAAW,OAClBl/D,EAAQ6E,EAEhB,CAEA,MAAMA,EAAS7E,EAAM8F,WAAWuU,OAChC,GAAIxV,EAAOq6D,WAAW,MAAQr6D,EAAOzM,OAAS,EAC1C,OAAOyM,EAGX,MAAMuxD,EAAM,SAAUp2D,GACtB,GAAW,MAAPo2D,EAEA,OA9Oa,MA8OTA,EAAI5mD,KACG,SAAS4mD,EAAItwD,SAAS2tD,MAE1B,SAAS2C,EAAIO,OAAO7wD,aAG/B,IACI,OAAI9F,aAAiBrE,WACV,SAAS,UAAWqE,GAAO22D,OAAO7wD,aAEtC,SAAS,SAAUjB,GAAQ8xD,OAAO7wD,YAC7C,CACA,MAEA,CACJ,CACA,MAAM,GAAQ,IAAIpM,MAAM,sDFtQK,oBEsQ2E,EAEtGsrI,GAAiC/wH,IACnC,GAAkB,MAAdA,EAAM2J,KACN,MAAM,GAAQ,IAAIlkB,MAAM,0BF3QO,2BE6QnC,MAAMkkB,EAAOwmH,GAAcnwH,EAAM2J,MACjC,KAAK,QAAiBA,EAAKymH,MAAOpwH,EAAMjU,OAAS,IAAIrE,WAAW,IAC5D,MAAM,GAAQ,IAAIjC,MAAM,yDAA0D,IAEtF,KAAK,QAAiBkkB,EAAKmnH,SAAU9wH,EAAM6vH,UAAY,IAAInoI,WAAW,IAClE,MAAM,GAAQ,IAAIjC,MAAM,4DAA6D,IAEzF,GAAIkkB,EAAK8lH,eAAiBzvH,EAAM4vH,aAC5B,MAAM,GAAQ,IAAInqI,MAAM,gEAAiE,IAE7F,GAAIkkB,EAAKqnH,WAAahxH,EAAMuiB,SACxB,MAAM,GAAQ,IAAI98B,MAAM,4DAA6D,IAEzF,GAAIkkB,EAAKigF,MAAQ5pF,EAAM2pF,IACnB,MAAM,GAAQ,IAAIlkG,MAAM,uDAAwD,GACpF,ECnSG,SAASyrI,GAAa71H,EAAKsO,GAC9B,MAAM5J,EAAU4J,EAAK7B,KAAI,CAAC7f,EAAKsvB,KAAU,CACrC24G,OAAQ3nD,GAAUtgF,GAClBsvB,YA0BJ,OAxBAxX,EAAQizE,MAAK,CAACrlE,EAAGnE,KAIb,MAAM2nH,EAAOxjH,EAAEuiH,OAAO3tG,SAChB6uG,EAAO5nH,EAAE0mH,OAAO3tG,SAEtB,GAAI4uG,EAAOC,EACP,OAAQ,EAEP,GAAID,EAAOC,EACZ,OAAO,EAGX,MAAMC,EAAsB1jH,EAAEuiH,OAAOL,SAASyB,SACxCC,EAAsB/nH,EAAE0mH,OAAOL,SAASyB,SAC9C,OAAID,EAAoBlqF,UAAYoqF,EAAoBpqF,WAC5C,EAERkqF,EAAoBlqF,UAAYoqF,EAAoBpqF,UAC7C,EAEJ,CAAC,IAELpnC,EAAQ,GAAGwX,KACtB,CC1BA,MAAM,GAAM21C,GAAO,kBAIbskE,GAAkB,MAKX,GAAWrmI,MAAOm3B,EAAWr6B,KAItC,MAAMioI,EAAS3nD,GAAUtgF,GAEzB,IAAIwpI,EACJ,IACI,MAAMC,EF8EwB,CAAC/nH,IACnC,MAAMgoH,GAAY,QAAqB,mBACvC,OAAO,QAAiB,CAACA,EAAWhoH,GAAM,EEhFbioH,CAAuB1B,EAAOvmH,MACvD8nH,QAAgBnvG,EAAUomC,OAAOgpE,EAAkBxB,EAAOH,YAC9D,CACA,MAAOj9H,GACH2+H,GAAU,CACd,CACA,IAAKA,EAED,MADA,GAAInkH,MAAM,wCACJ,GAAQ,IAAI7nB,MAAM,wCAAyC,IAGrE,GAAIyqI,EAAON,eAAiB,qBACxB,GAAIM,EAAOL,SAASyB,SAASnqF,UAAY/gD,KAAKm+C,MAE1C,MADA,GAAIj3B,MAAM,sBACJ,GAAQ,IAAI7nB,MAAM,sBJpCG,gCIuC9B,GAA2B,MAAvByqI,EAAON,aAEZ,MADA,GAAItiH,MAAM,8BACJ,GAAQ,IAAI7nB,MAAM,8BAA+B,IAE3D,GAAI,8BAA+ByqI,EAAOnkI,MAAM,EAE7CZ,eAAe0mI,GAAcx2H,EAAKy2H,GACrC,GAAIA,EAAe/3H,WAAay3H,GAC5B,MAAM,GAAQ,IAAI/rI,MAAM,oBAAqB,IAEjD,MAAMumE,EAASilE,GAAqB51H,GAC9B02H,EAAiBxpD,GAAUupD,GAE3BhC,QAAeG,GAAiBjkE,EAAQ+lE,SAExC,GAASjC,EAAQgC,EAC3B,iECtDO,MAAME,GAAkB,CAC3BnkH,KAAM,CACF,kFACA,kFACA,kFACA,kFACA,oFCLD1iB,eAAe8mI,GAAah+C,EAAW34E,GAC1C,MAAMuJ,ECgBC,CACHqtH,UAAW,CACP56F,OAAQ,CACJ,YAGR22D,WAAY,EACR,QAAsB,CAClBkkC,eAAgB,KAEpB,WACA,WACA,WACA,WAEJC,qBAAsB,EAClB,WAEJC,aAAc,EACV,UACAnD,MAEJoD,cAAe,EACX,QAAUN,KAEdO,eAAgB,EACZ,QAAmB,wBAEvBC,SAAU,CACNC,UAAU,EAAAA,GAAA,MACVC,SAAS,UACTtsC,OAAQ4lC,KACR2G,OAAO,EAAAA,GAAA,KACPC,KAAK,SAAO,CACRC,YAAY,EACZC,WAAY,CACRC,KAAMlB,IAEVmB,UAAW,CACPD,KAAM7B,MAGd/zD,MAAM,EAAAA,GAAA,ODxDd,OADA7hE,EAAUA,GAAW,CAAC,GACf,QAAO,CACV24E,eACGpvE,KACAvJ,EACH5K,OAAO,GAEf,CEXO,MAAM0lB,GAAU,QACV,GAAO,QCgCd,GAAM82C,GAAO,SACZ/hE,eAAe8nI,GAAY3qG,EAAO,CAAC,GACtC,MAAM2rD,EAAY3rD,EAAK2rD,WAAa,IAAI,MAClCzT,EAAal4C,EAAKk4C,YAAc,IAAI,MAC1C,IAAIiiC,EAKAA,EAeR,SAAkBjsG,GACd,GAAW,MAAPA,EACA,OAAO,EAKX,MAFc,CAAC,OAAQ,eAAgB,SAAU,SAAU,WAAY,gBAAiB,gBAE3E+P,OAAMoE,GAAuB,mBAAXnU,EAAImU,IACvC,CA3BQuoH,CAAS5qG,EAAKm6E,QACLn6E,EAAKm6E,aAGCwvB,GAAah+C,EAAW3rD,EAAKm6E,QAEhD,MAAM1wB,EAAQ,IAAIywB,GAAU,IACrBl6E,EACH2rD,YACAzT,aACAiiC,WAOJ,OALmB,IAAfn6E,EAAK53B,aACCqhF,EAAMrhF,QAepB,SAAgCqhF,GAE5B,IAEI,GAA0E,MAD7CA,EAAM0wB,OAAO+vB,SAASC,SAASxiC,KAAKkjC,aACxCnmG,MAAM,wCAE3B,OAEJ+kD,EAAM0wB,OAAO+vB,SAASC,SAASxiC,KAAKkjC,aAAe,GAAG,MAAQ/8G,MAAW27D,EAAM0wB,OAAO+vB,SAASC,SAASxiC,KAAKkjC,cACjH,CACA,MAAOrgI,GACH,GAAIwa,MAAM,uCAAwCxa,EACtD,CACJ,CAzBIsgI,CAAuBrhD,GAChBA,CACX,8FCxDA,MAAMshD,EAAgB,CAAC5yG,EAAQ6yG,IAAiBA,EAAat5B,MAAM7tF,GAAMsU,aAAkBtU,IAE3F,IAAIonH,EACAC,EAqBJ,MAAMC,EAAmB,IAAIj2G,QACvBk2G,EAAqB,IAAIl2G,QACzBm2G,EAA2B,IAAIn2G,QAC/Bo2G,EAAiB,IAAIp2G,QACrBq2G,EAAwB,IAAIr2G,QA0DlC,IAAIs2G,EAAgB,CAChBjmI,IAAI0R,EAAQ9I,EAAMqhC,GACd,GAAIv4B,aAAkBw0H,eAAgB,CAElC,GAAa,SAATt9H,EACA,OAAOi9H,EAAmB7lI,IAAI0R,GAElC,GAAa,qBAAT9I,EACA,OAAO8I,EAAOqX,kBAAoB+8G,EAAyB9lI,IAAI0R,GAGnE,GAAa,UAAT9I,EACA,OAAOqhC,EAASlhB,iBAAiB,QAC3BhiB,EACAkjC,EAAS7gB,YAAY6gB,EAASlhB,iBAAiB,GAE7D,CAEA,OAAO7pB,EAAKwS,EAAO9I,GACvB,EACA1N,IAAG,CAACwW,EAAQ9I,EAAM1K,KACdwT,EAAO9I,GAAQ1K,GACR,GAEXmc,IAAG,CAAC3I,EAAQ9I,IACJ8I,aAAkBw0H,iBACR,SAATt9H,GAA4B,UAATA,IAGjBA,KAAQ8I,GAMvB,SAASy0H,EAAap0F,GAIlB,OAAIA,IAASq0F,YAAYluI,UAAUixB,aAC7B,qBAAsB+8G,eAAehuI,WA7GnCytI,IACHA,EAAuB,CACpBU,UAAUnuI,UAAUouI,QACpBD,UAAUnuI,UAAUuyB,SACpB47G,UAAUnuI,UAAUquI,sBAqHE3lH,SAASmxB,GAC5B,YAAa9yC,GAIhB,OADA8yC,EAAKr7C,MAAMs1C,EAAO3sC,MAAOJ,GAClBC,EAAK0mI,EAAiB5lI,IAAIX,MACrC,EAEG,YAAaJ,GAGhB,OAAOC,EAAK6yC,EAAKr7C,MAAMs1C,EAAO3sC,MAAOJ,GACzC,EAvBW,SAAUunI,KAAevnI,GAC5B,MAAMu4F,EAAKzlD,EAAK35C,KAAK4zC,EAAO3sC,MAAOmnI,KAAevnI,GAElD,OADA6mI,EAAyB5qI,IAAIs8F,EAAIgvC,EAAWrhD,KAAOqhD,EAAWrhD,OAAS,CAACqhD,IACjEtnI,EAAKs4F,EAChB,CAoBR,CACA,SAASivC,EAAuBvoI,GAC5B,MAAqB,mBAAVA,EACAioI,EAAajoI,IAGpBA,aAAiBgoI,gBAhGzB,SAAwC1uC,GAEpC,GAAIquC,EAAmBxrH,IAAIm9E,GACvB,OACJ,MAAM9/D,EAAO,IAAI7mB,SAAQ,CAACC,EAASC,KAC/B,MAAM21H,EAAW,KACblvC,EAAGjwE,oBAAoB,WAAYmD,GACnC8sE,EAAGjwE,oBAAoB,QAAS9H,GAChC+3E,EAAGjwE,oBAAoB,QAAS9H,EAAM,EAEpCiL,EAAW,KACb5Z,IACA41H,GAAU,EAERjnH,EAAQ,KACV1O,EAAOymF,EAAG/3E,OAAS,IAAIqX,aAAa,aAAc,eAClD4vG,GAAU,EAEdlvC,EAAGhwE,iBAAiB,WAAYkD,GAChC8sE,EAAGhwE,iBAAiB,QAAS/H,GAC7B+3E,EAAGhwE,iBAAiB,QAAS/H,EAAM,IAGvComH,EAAmB3qI,IAAIs8F,EAAI9/D,EAC/B,CAyEQivG,CAA+BzoI,GAC/BsnI,EAActnI,EAzJVwnI,IACHA,EAAoB,CACjBU,YACAQ,eACAC,SACAR,UACAH,kBAoJG,IAAIl2G,MAAM9xB,EAAO+nI,GAErB/nI,EACX,CACA,SAASgB,EAAKhB,GAGV,GAAIA,aAAiB4oI,WACjB,OA3IR,SAA0BliI,GACtB,MAAMgM,EAAU,IAAIC,SAAQ,CAACC,EAASC,KAClC,MAAM21H,EAAW,KACb9hI,EAAQ2iB,oBAAoB,UAAWslE,GACvCjoF,EAAQ2iB,oBAAoB,QAAS9H,EAAM,EAEzCotE,EAAU,KACZ/7E,EAAQ5R,EAAK0F,EAAQqU,SACrBytH,GAAU,EAERjnH,EAAQ,KACV1O,EAAOnM,EAAQ6a,OACfinH,GAAU,EAEd9hI,EAAQ4iB,iBAAiB,UAAWqlE,GACpCjoF,EAAQ4iB,iBAAiB,QAAS/H,EAAM,IAe5C,OAbA7O,EACKic,MAAM3uB,IAGHA,aAAiBmoI,WACjBT,EAAiB1qI,IAAIgD,EAAO0G,EAChC,IAGCkoB,OAAM,SAGXk5G,EAAsB9qI,IAAI0V,EAAShM,GAC5BgM,CACX,CA4Gem2H,CAAiB7oI,GAG5B,GAAI6nI,EAAe1rH,IAAInc,GACnB,OAAO6nI,EAAe/lI,IAAI9B,GAC9B,MAAM8oI,EAAWP,EAAuBvoI,GAOxC,OAJI8oI,IAAa9oI,IACb6nI,EAAe7qI,IAAIgD,EAAO8oI,GAC1BhB,EAAsB9qI,IAAI8rI,EAAU9oI,IAEjC8oI,CACX,CACA,MAAMh7F,EAAU9tC,GAAU8nI,EAAsBhmI,IAAI9B,GC5KpD,SAAS+oI,EAAOvoI,EAAM6pB,GAAS,QAAE2+G,EAAO,QAAEvgD,EAAO,SAAEwgD,EAAQ,WAAEC,GAAe,CAAC,GACzE,MAAMxiI,EAAU8jB,UAAU5T,KAAKpW,EAAM6pB,GAC/B8+G,EAAcnoI,EAAK0F,GAoBzB,OAnBI+hF,GACA/hF,EAAQ4iB,iBAAiB,iBAAkBoiB,IACvC+8C,EAAQznF,EAAK0F,EAAQqU,QAAS2wB,EAAM09F,WAAY19F,EAAM29F,WAAYroI,EAAK0F,EAAQukB,aAAcygB,EAAM,IAGvGs9F,GACAtiI,EAAQ4iB,iBAAiB,WAAYoiB,GAAUs9F,EAE/Ct9F,EAAM09F,WAAY19F,EAAM29F,WAAY39F,KAExCy9F,EACKx6G,MAAMzf,IACHg6H,GACAh6H,EAAGoa,iBAAiB,SAAS,IAAM4/G,MACnCD,GACA/5H,EAAGoa,iBAAiB,iBAAkBoiB,GAAUu9F,EAASv9F,EAAM09F,WAAY19F,EAAM29F,WAAY39F,IACjG,IAEC9c,OAAM,SACJu6G,CACX,CAMA,SAASG,EAAS9oI,GAAM,QAAEwoI,GAAY,CAAC,GACnC,MAAMtiI,EAAU8jB,UAAUqB,eAAerrB,GAMzC,OALIwoI,GACAtiI,EAAQ4iB,iBAAiB,WAAYoiB,GAAUs9F,EAE/Ct9F,EAAM09F,WAAY19F,KAEf1qC,EAAK0F,GAASioB,MAAK,KAAe,GAC7C,CAEA,MAAM46G,EAAc,CAAC,MAAO,SAAU,SAAU,aAAc,SACxDC,EAAe,CAAC,MAAO,MAAO,SAAU,SACxCC,EAAgB,IAAIhuH,IAC1B,SAASiuH,EAAUl2H,EAAQ9I,GACvB,KAAM8I,aAAkB00H,cAClBx9H,KAAQ8I,GACM,iBAAT9I,EACP,OAEJ,GAAI++H,EAAc3nI,IAAI4I,GAClB,OAAO++H,EAAc3nI,IAAI4I,GAC7B,MAAMi/H,EAAiBj/H,EAAK9I,QAAQ,aAAc,IAC5CgoI,EAAWl/H,IAASi/H,EACpBE,EAAUL,EAAa9mH,SAASinH,GACtC,KAEEA,KAAmBC,EAAWjB,SAAWD,gBAAgB1uI,aACrD6vI,IAAWN,EAAY7mH,SAASinH,GAClC,OAEJ,MAAMpjI,EAASnH,eAAgB0qI,KAAc/oI,GAEzC,MAAMu4F,EAAKn4F,KAAK8pB,YAAY6+G,EAAWD,EAAU,YAAc,YAC/D,IAAIr2H,EAAS8lF,EAAGjuE,MAQhB,OAPIu+G,IACAp2H,EAASA,EAAOgY,MAAMzqB,EAAKR,iBAMjBoS,QAAQQ,IAAI,CACtBK,EAAOm2H,MAAmB5oI,GAC1B8oI,GAAWvwC,EAAG9/D,QACd,EACR,EAEA,OADAiwG,EAAczsI,IAAI0N,EAAMnE,GACjBA,CACX,CDgCIwhI,EC/BS,CAACgC,IAAa,IACpBA,EACHjoI,IAAK,CAAC0R,EAAQ9I,EAAMqhC,IAAa29F,EAAUl2H,EAAQ9I,IAASq/H,EAASjoI,IAAI0R,EAAQ9I,EAAMqhC,GACvF5vB,IAAK,CAAC3I,EAAQ9I,MAAWg/H,EAAUl2H,EAAQ9I,IAASq/H,EAAS5tH,IAAI3I,EAAQ9I,KD4BzD/D,CAASohI","sources":["webpack://cyb/./node_modules/@assemblyscript/loader/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/minimal.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/index-minimal.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/reader.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/reader_buffer.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/roots.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/rpc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/rpc/service.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/util/longbits.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/util/minimal.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/writer.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/protobufjs/src/writer_buffer.js","webpack://cyb/./node_modules/@cosmjs/encoding/build/index.js","webpack://cyb/./node_modules/abstract-level/abstract-chained-batch.js","webpack://cyb/./node_modules/abstract-level/abstract-iterator.js","webpack://cyb/./node_modules/abstract-level/abstract-level.js","webpack://cyb/./node_modules/abstract-level/index.js","webpack://cyb/./node_modules/abstract-level/lib/abstract-sublevel-iterator.js","webpack://cyb/./node_modules/abstract-level/lib/abstract-sublevel.js","webpack://cyb/./node_modules/abstract-level/lib/common.js","webpack://cyb/./node_modules/abstract-level/lib/default-chained-batch.js","webpack://cyb/./node_modules/abstract-level/lib/default-kv-iterator.js","webpack://cyb/./node_modules/abstract-level/lib/deferred-iterator.js","webpack://cyb/./node_modules/abstract-level/lib/next-tick-browser.js","webpack://cyb/./node_modules/abstract-level/lib/range-options.js","webpack://cyb/./node_modules/abstract-level/node_modules/buffer/index.js","webpack://cyb/./node_modules/any-signal/index.js","webpack://cyb/./node_modules/browser-level/index.js","webpack://cyb/./node_modules/browser-level/iterator.js","webpack://cyb/./node_modules/browser-level/util/clear.js","webpack://cyb/./node_modules/browser-level/util/deserialize.js","webpack://cyb/./node_modules/browser-level/util/key-range.js","webpack://cyb/./node_modules/buffer/index.js","webpack://cyb/./node_modules/bytes/index.js","webpack://cyb/./node_modules/catering/index.js","webpack://cyb/./node_modules/catering/next-tick-browser.js","webpack://cyb/./node_modules/comlink/dist/esm/comlink.mjs","webpack://cyb/./node_modules/cosmjs-types/cosmos/bank/v1beta1/tx.js","webpack://cyb/./node_modules/cosmjs-types/cosmos/tx/v1beta1/tx.js","webpack://cyb/./node_modules/cross-fetch/dist/browser-ponyfill.js","webpack://cyb/./node_modules/dateformat/lib/dateformat.js","webpack://cyb/./node_modules/debug/node_modules/ms/index.js","webpack://cyb/./node_modules/debug/src/browser.js","webpack://cyb/./node_modules/debug/src/common.js","webpack://cyb/./node_modules/delay/index.js","webpack://cyb/./node_modules/denque/index.js","webpack://cyb/./node_modules/detect-browser/es/index.js","webpack://cyb/./node_modules/dlv/dist/dlv.umd.js","webpack://cyb/./node_modules/err-code/index.js","webpack://cyb/./node_modules/event-iterator/lib/dom.js","webpack://cyb/./node_modules/event-iterator/lib/event-iterator.js","webpack://cyb/./node_modules/events/events.js","webpack://cyb/./node_modules/extract-files/public/ReactNativeFile.js","webpack://cyb/./node_modules/extract-files/public/extractFiles.js","webpack://cyb/./node_modules/extract-files/public/isExtractableFile.js","webpack://cyb/./node_modules/fast-fifo/fixed-size.js","webpack://cyb/./node_modules/fast-fifo/index.js","webpack://cyb/./node_modules/fnv1a/index.js","webpack://cyb/./node_modules/graphql-request/node_modules/form-data/lib/browser.js","webpack://cyb/./node_modules/hashlru/index.js","webpack://cyb/./node_modules/helia/node_modules/eventemitter3/index.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/index.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/BurstyRateLimiter.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RLWrapperBlackAndWhite.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterAbstract.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterCluster.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterMemcache.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterMemory.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterMongo.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterMySQL.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterPostgres.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterQueue.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterRedis.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterRes.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterStoreAbstract.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/RateLimiterUnion.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/component/BlockedKeys/BlockedKeys.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/component/BlockedKeys/index.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/component/MemoryStorage/MemoryStorage.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/component/MemoryStorage/Record.js","webpack://cyb/./node_modules/helia/node_modules/rate-limiter-flexible/lib/component/RateLimiterQueueError.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/message/rpc.cjs","webpack://cyb/./node_modules/@apollo/client/utilities/common/canUse.js","webpack://cyb/./node_modules/@apollo/client/utilities/globals/maybe.js","webpack://cyb/./node_modules/@chainsafe/is-ip/lib/is-ip.js","webpack://cyb/./node_modules/@chainsafe/is-ip/lib/parse.js","webpack://cyb/./node_modules/@chainsafe/is-ip/lib/parser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/it-pair/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/constants.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/_assert.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/crypto.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/hmac.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/hkdf.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/_sha2.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@noble/hashes/esm/sha256.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/crypto/js.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/util/as-uint8array.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/alloc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/concat.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/encoder.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base10.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base16.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base2.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base256emoji.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base36.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/base8.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/bases/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/codecs/json.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/hashes/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/hashes/sha2-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/multiformats/src/basics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/util/bases.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/from-string.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/equals.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/ed25519-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/webcrypto.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/ciphers/aes-gcm.browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/exporter.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/keys.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/ed25519-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/uint8arrays/dist/src/to-string.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/util.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/ecdh-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/random-bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/jwk2pem.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/rsa-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/rsa-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/rsa-utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/secp256k1.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/secp256k1-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/crypto/dist/src/keys/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/peer-id/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/proto/payload.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/logger.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/nonce.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/handshakes/abstract-handshake.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/handshakes/xx.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/handshake-xx.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/noise.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/metrics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/node_modules/it-pair/dist/src/duplex.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/crypto/streaming.js","webpack://cyb/./node_modules/@chainsafe/libp2p-noise/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/abortable-iterator/dist/src/abort-error.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/abortable-iterator/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/get-iterator/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/it-pushable/dist/src/fifo.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/it-pushable/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/constants.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/config.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/frame.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/decode.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/encode.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/node_modules/it-foreach/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/stream.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/muxer.js","webpack://cyb/./node_modules/@chainsafe/libp2p-yamux/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/netmask/dist/src/ip.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-first/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-batch/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-parallel-batch/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/chunker/fixed-size.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs/dist/src/unixfs.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/hashes/sha2-browser.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/utils/persist.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dag-builder/buffer-importer.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dag-builder/dir.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dag-builder/file.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dag-builder/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dag-builder/validate-chunks.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/layout/balanced.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dir.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dir-flat.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/node_modules/@multiformats/murmur3/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/dir-sharded.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/flat-to-shard.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/utils/to-path-components.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/tree-builder.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-importer/dist/src/chunker/rabin.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/add.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-last/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/hashes/identity.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/dag-cbor.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/utils/extract-data-from-block.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/utils/validate-offset-and-length.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/identity.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/raw.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/node_modules/@multiformats/murmur3/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/utils/find-cid-in-shard.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-filter/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/it-map/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/unixfs-v1/content/directory.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/unixfs-v1/content/file.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/unixfs-v1/content/hamt-sharded-directory.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/unixfs-v1/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/resolvers/index.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/ipfs-unixfs-exporter/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/errors.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/consumable-hash.js","webpack://cyb/./node_modules/@helia/unixfs/node_modules/@multiformats/murmur3/src/index.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/hamt-constants.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/persist.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/dir-sharded.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/hamt-utils.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/is-over-shard-threshold.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/add-link.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/cid-to-directory.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/cid-to-pblink.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/resolve.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/cat.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/constants.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/chmod.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/cp.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/ls.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/mkdir.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/utils/remove-link.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/rm.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/stat.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/commands/touch.js","webpack://cyb/./node_modules/@helia/unixfs/dist/src/index.js","webpack://cyb/./node_modules/abortable-iterator/dist/src/abort-error.js","webpack://cyb/./node_modules/abortable-iterator/dist/src/index.js","webpack://cyb/./node_modules/abortable-iterator/node_modules/get-iterator/dist/src/index.js","webpack://cyb/./node_modules/array-shuffle/index.js","webpack://cyb/./node_modules/blob-to-it/dist/src/index.js","webpack://cyb/./node_modules/blockstore-core/dist/src/errors.js","webpack://cyb/./node_modules/blockstore-core/dist/src/base.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/blockstore-core/dist/src/memory.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/blockstore-core/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/blockstore-core/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/blockstore-core/node_modules/it-merge/node_modules/it-pushable/dist/src/index.js","webpack://cyb/./node_modules/blockstore-core/dist/src/tiered.js","webpack://cyb/./node_modules/blockstore-core/dist/src/index.js","webpack://cyb/./node_modules/blockstore-datastore-adapter/node_modules/blockstore-core/src/base.js","webpack://cyb/./node_modules/blockstore-datastore-adapter/node_modules/it-all/dist/src/index.js","webpack://cyb/./node_modules/blockstore-datastore-adapter/src/index.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/blockstore-idb/dist/src/index.js","webpack://cyb/./node_modules/blockstore-idb/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/browser-readablestream-to-it/dist/src/index.js","webpack://cyb/./node_modules/byte-access/dist/src/index.js","webpack://cyb/./node_modules/cborg/esm/lib/0uint.js","webpack://cyb/./node_modules/cborg/esm/lib/1negint.js","webpack://cyb/./node_modules/cborg/esm/lib/2bytes.js","webpack://cyb/./node_modules/cborg/esm/lib/3string.js","webpack://cyb/./node_modules/cborg/esm/lib/4array.js","webpack://cyb/./node_modules/cborg/esm/lib/5map.js","webpack://cyb/./node_modules/cborg/esm/lib/6tag.js","webpack://cyb/./node_modules/cborg/esm/lib/7float.js","webpack://cyb/./node_modules/cborg/esm/lib/byte-utils.js","webpack://cyb/./node_modules/cborg/esm/lib/common.js","webpack://cyb/./node_modules/cborg/esm/lib/decode.js","webpack://cyb/./node_modules/cborg/esm/lib/is.js","webpack://cyb/./node_modules/cborg/esm/lib/bl.js","webpack://cyb/./node_modules/cborg/esm/lib/encode.js","webpack://cyb/./node_modules/cborg/esm/lib/json/encode.js","webpack://cyb/./node_modules/cborg/esm/lib/json/decode.js","webpack://cyb/./node_modules/cborg/esm/lib/jump.js","webpack://cyb/./node_modules/cborg/esm/lib/token.js","webpack://cyb/./node_modules/dag-jose/lib/utils.js","webpack://cyb/./node_modules/dag-jose/lib/signing.js","webpack://cyb/./node_modules/dag-jose/lib/encryption.js","webpack://cyb/./node_modules/dag-jose/lib/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-drain/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-filter/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-all/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-sort/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-take/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/dist/src/base.js","webpack://cyb/./node_modules/datastore-core/dist/src/errors.js","webpack://cyb/./node_modules/datastore-core/dist/src/shard.js","webpack://cyb/./node_modules/datastore-core/dist/src/sharding.js","webpack://cyb/./node_modules/datastore-core/node_modules/it-merge/node_modules/it-pushable/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/datastore-core/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/datastore-core/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/datastore-core/dist/src/tiered.js","webpack://cyb/./node_modules/datastore-core/dist/src/memory.js","webpack://cyb/./node_modules/datastore-core/node_modules/interface-datastore/dist/src/key.js","webpack://cyb/./node_modules/datastore-idb/node_modules/interface-datastore/dist/src/key.js","webpack://cyb/./node_modules/datastore-idb/node_modules/it-filter/dist/src/index.js","webpack://cyb/./node_modules/datastore-idb/node_modules/it-all/dist/src/index.js","webpack://cyb/./node_modules/datastore-idb/node_modules/it-sort/dist/src/index.js","webpack://cyb/./node_modules/datastore-idb/dist/src/index.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/errors.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/shard.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/utils.js","webpack://cyb/./node_modules/datastore-level/node_modules/it-all/dist/src/index.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/base.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/sharding.js","webpack://cyb/./node_modules/datastore-level/node_modules/datastore-core/src/tiered.js","webpack://cyb/./node_modules/datastore-level/src/index.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/datastore-core/src/shard.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/datastore-core/src/utils.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/it-all/dist/src/index.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/datastore-core/src/base.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/datastore-core/src/sharding.js","webpack://cyb/./node_modules/datastore-pubsub/node_modules/datastore-core/src/tiered.js","webpack://cyb/./node_modules/datastore-pubsub/src/utils.js","webpack://cyb/./node_modules/datastore-pubsub/src/index.js","webpack://cyb/./node_modules/dns-over-http-resolver/node_modules/native-fetch/esm/src/index.js","webpack://cyb/./node_modules/dns-over-http-resolver/dist/src/utils.js","webpack://cyb/./node_modules/dns-over-http-resolver/dist/src/index.js","webpack://cyb/./node_modules/engine.io-parser/build/esm/commons.js","webpack://cyb/./node_modules/engine.io-parser/build/esm/encodePacket.browser.js","webpack://cyb/./node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","webpack://cyb/./node_modules/engine.io-parser/build/esm/decodePacket.browser.js","webpack://cyb/./node_modules/engine.io-parser/build/esm/index.js","webpack://cyb/./node_modules/engine.io-client/build/esm/globalThis.browser.js","webpack://cyb/./node_modules/engine.io-client/build/esm/util.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transport.js","webpack://cyb/./node_modules/engine.io-client/build/esm/contrib/yeast.js","webpack://cyb/./node_modules/engine.io-client/build/esm/contrib/parseqs.js","webpack://cyb/./node_modules/engine.io-client/build/esm/contrib/has-cors.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transports/polling.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transports/websocket.js","webpack://cyb/./node_modules/engine.io-client/build/esm/transports/index.js","webpack://cyb/./node_modules/engine.io-client/build/esm/contrib/parseuri.js","webpack://cyb/./node_modules/engine.io-client/build/esm/socket.js","webpack://cyb/./node_modules/engine.io-client/build/esm/index.js","webpack://cyb/./node_modules/file-type/util.js","webpack://cyb/./node_modules/file-type/core.js","webpack://cyb/./node_modules/graphql-request/build/esm/defaultJsonSerializer.js","webpack://cyb/./node_modules/graphql-request/build/esm/createRequestBody.js","webpack://cyb/./node_modules/graphql-request/build/esm/resolveRequestDocument.js","webpack://cyb/./node_modules/graphql-request/build/esm/types.js","webpack://cyb/./node_modules/graphql-request/build/esm/index.js","webpack://cyb/./node_modules/graphql-request/build/esm/helpers.js","webpack://cyb/./node_modules/graphql-request/build/esm/parseArgs.js","webpack://cyb/./node_modules/hamt-sharding/dist/src/bucket.js","webpack://cyb/./node_modules/hamt-sharding/dist/src/consumable-buffer.js","webpack://cyb/./node_modules/hamt-sharding/dist/src/consumable-hash.js","webpack://cyb/./node_modules/hamt-sharding/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/it-drain/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/hashes/identity.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/hashes/sha2-browser.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/is.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/token.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/byte-utils.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/bl.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/common.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/0uint.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/1negint.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/2bytes.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/3string.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/4array.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/5map.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/6tag.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/7float.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/jump.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/encode.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/decode.js","webpack://cyb/./node_modules/helia/node_modules/interface-datastore/dist/src/key.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base36.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/helia/node_modules/p-queue/dist/priority-queue.js","webpack://cyb/./node_modules/helia/node_modules/p-queue/dist/index.js","webpack://cyb/./node_modules/helia/node_modules/p-queue/dist/lower-bound.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/json/encode.js","webpack://cyb/./node_modules/helia/node_modules/cborg/lib/json/decode.js","webpack://cyb/./node_modules/helia/node_modules/@ipld/dag-json/src/index.js","webpack://cyb/./node_modules/helia/node_modules/@ipld/dag-pb/src/pb-decode.js","webpack://cyb/./node_modules/helia/node_modules/@ipld/dag-pb/src/pb-encode.js","webpack://cyb/./node_modules/helia/node_modules/@ipld/dag-pb/src/util.js","webpack://cyb/./node_modules/helia/node_modules/@ipld/dag-pb/src/index.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/codecs/json.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/helia/dist/src/utils/dag-walkers.js","webpack://cyb/./node_modules/helia/dist/src/pins.js","webpack://cyb/./node_modules/helia/dist/src/storage.js","webpack://cyb/./node_modules/helia/dist/src/utils/datastore-version.js","webpack://cyb/./node_modules/helia/node_modules/it-filter/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/it-foreach/dist/src/index.js","webpack://cyb/./node_modules/helia/dist/src/utils/networked-storage.js","webpack://cyb/./node_modules/helia/dist/src/helia.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base10.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base16.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base2.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base256emoji.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base36.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/base8.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/bases/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/codecs/json.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/hashes/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/hashes/sha2-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/multiformats/src/basics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/equals.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/peer-id/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/logger/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/message-cache.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/message/rpc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/constants.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/shuffle.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/util/as-uint8array.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/alloc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/util/bases.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/to-string.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/messageIdToString.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/from-string.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/ed25519-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/uint8arrays/dist/src/concat.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/webcrypto.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/ciphers/aes-gcm.browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/exporter.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/keys.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/ed25519-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/util.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/ecdh-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@noble/hashes/esm/crypto.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@noble/hashes/esm/utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/random-bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/jwk2pem.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/rsa-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/rsa-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/rsa-utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/secp256k1.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/secp256k1-class.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/crypto/dist/src/keys/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/types.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/constants.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/peer-score-params.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/peer-score-thresholds.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/compute-score.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/message-deliveries.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/set.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/peer-score.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/tracer.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/time-cache.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/metrics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/buildRawMessage.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/msgIdFn.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@libp2p/pubsub/dist/src/utils.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/score/scoreMetrics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/it-pushable/dist/src/fifo.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/it-pushable/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/abortable-iterator/dist/src/abort-error.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/abortable-iterator/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/get-iterator/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/stream.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/message/decodeRpc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/vendor/base-x.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bytes.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base2.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base8.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base10.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base16.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base32.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base36.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base58.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base64.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/bases/base256emoji.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/vendor/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/varint.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/hashes/digest.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/hashes/hasher.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/hashes/sha2-browser.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/hashes/identity.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/codecs/raw.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/codecs/json.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/cid.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/node_modules/multiformats/src/basics.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/dist/src/alloc.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/dist/src/util/as-uint8array.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/dist/src/util/bases.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/node_modules/uint8arrays/dist/src/to-string.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/dist/src/ip.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/dist/src/protocols-table.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/node_modules/@multiformats/multiaddr/dist/src/convert.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/multiaddr.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/index.js","webpack://cyb/./node_modules/@chainsafe/libp2p-gossipsub/dist/src/utils/publishConfig.js","webpack://cyb/./node_modules/helia/node_modules/abortable-iterator/dist/src/abort-error.js","webpack://cyb/./node_modules/helia/node_modules/abortable-iterator/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/get-iterator/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/it-pushable/dist/src/fifo.js","webpack://cyb/./node_modules/helia/node_modules/it-pushable/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/node_modules/uint8arrays/dist/src/util/as-uint8array.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base10.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base16.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base2.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base256emoji.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/base8.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/bases/identity.js","webpack://cyb/./node_modules/helia/node_modules/multiformats/src/basics.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/node_modules/uint8arrays/dist/src/util/bases.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/node_modules/uint8arrays/dist/src/alloc.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/node_modules/uint8arrays/dist/src/from-string.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/node_modules/uint8arrays/dist/src/to-string.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/message-types.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/decode.js","webpack://cyb/./node_modules/helia/node_modules/it-batched-bytes/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/alloc-unsafe-browser.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/encode.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/stream.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/mplex.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/mplex/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/util/as-uint8array.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/alloc.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/util/bases.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/from-string.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/equals.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/ed25519-browser.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/concat.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/webcrypto.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/ciphers/aes-gcm.browser.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/exporter.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/keys.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/ed25519-class.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/node_modules/uint8arrays/dist/src/to-string.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/util.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/ecdh-browser.js","webpack://cyb/./node_modules/helia/node_modules/@noble/hashes/esm/crypto.js","webpack://cyb/./node_modules/helia/node_modules/@noble/hashes/esm/utils.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/random-bytes.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/jwk2pem.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/rsa-browser.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/rsa-class.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/rsa-utils.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/secp256k1.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/secp256k1-class.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/crypto/dist/src/keys/index.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/peer-id/node_modules/uint8arrays/dist/src/equals.js","webpack://cyb/./node_modules/helia/node_modules/@libp2p/peer-id/dist/src/index.js","webpack://cyb/./node_modules/helia/node_modules/ipns/dist/src/errors.js","webpack://cyb/./node_modules/helia/node_modules/ipns/dist/src/pb/ipns.js","webpack://cyb/./node_modules/helia/node_modules/ipns/dist/src/utils.js","webpack://cyb/./node_modules/helia/node_modules/ipns/dist/src/selector.js","webpack://cyb/./node_modules/helia/node_modules/ipns/dist/src/validator.js","webpack://cyb/./node_modules/helia/dist/src/utils/bootstrappers.js","webpack://cyb/./node_modules/helia/dist/src/utils/libp2p.js","webpack://cyb/./node_modules/helia/dist/src/utils/libp2p-defaults.browser.js","webpack://cyb/./node_modules/helia/dist/src/version.js","webpack://cyb/./node_modules/helia/dist/src/index.js","webpack://cyb/./node_modules/idb/build/wrap-idb-value.js","webpack://cyb/./node_modules/idb/build/index.js"],"sourcesContent":["\"use strict\";\n\n// Runtime header offsets\nconst ID_OFFSET = -8;\nconst SIZE_OFFSET = -4;\n\n// Runtime ids\nconst ARRAYBUFFER_ID = 0;\nconst STRING_ID = 1;\nconst ARRAYBUFFERVIEW_ID = 2;\n\n// Runtime type information\nconst ARRAYBUFFERVIEW = 1 << 0;\nconst ARRAY = 1 << 1;\nconst SET = 1 << 2;\nconst MAP = 1 << 3;\nconst VAL_ALIGN_OFFSET = 5;\nconst VAL_ALIGN = 1 << VAL_ALIGN_OFFSET;\nconst VAL_SIGNED = 1 << 10;\nconst VAL_FLOAT = 1 << 11;\nconst VAL_NULLABLE = 1 << 12;\nconst VAL_MANAGED = 1 << 13;\nconst KEY_ALIGN_OFFSET = 14;\nconst KEY_ALIGN = 1 << KEY_ALIGN_OFFSET;\nconst KEY_SIGNED = 1 << 19;\nconst KEY_FLOAT = 1 << 20;\nconst KEY_NULLABLE = 1 << 21;\nconst KEY_MANAGED = 1 << 22;\n\n// Array(BufferView) layout\nconst ARRAYBUFFERVIEW_BUFFER_OFFSET = 0;\nconst ARRAYBUFFERVIEW_DATASTART_OFFSET = 4;\nconst ARRAYBUFFERVIEW_DATALENGTH_OFFSET = 8;\nconst ARRAYBUFFERVIEW_SIZE = 12;\nconst ARRAY_LENGTH_OFFSET = 12;\nconst ARRAY_SIZE = 16;\n\nconst BIGINT = typeof BigUint64Array !== \"undefined\";\nconst THIS = Symbol();\nconst CHUNKSIZE = 1024;\n\n/** Gets a string from an U32 and an U16 view on a memory. */\nfunction getStringImpl(buffer, ptr) {\n  const U32 = new Uint32Array(buffer);\n  const U16 = new Uint16Array(buffer);\n  var length = U32[(ptr + SIZE_OFFSET) >>> 2] >>> 1;\n  var offset = ptr >>> 1;\n  if (length <= CHUNKSIZE) return String.fromCharCode.apply(String, U16.subarray(offset, offset + length));\n  const parts = [];\n  do {\n    const last = U16[offset + CHUNKSIZE - 1];\n    const size = last >= 0xD800 && last < 0xDC00 ? CHUNKSIZE - 1 : CHUNKSIZE;\n    parts.push(String.fromCharCode.apply(String, U16.subarray(offset, offset += size)));\n    length -= size;\n  } while (length > CHUNKSIZE);\n  return parts.join(\"\") + String.fromCharCode.apply(String, U16.subarray(offset, offset + length));\n}\n\n/** Prepares the base module prior to instantiation. */\nfunction preInstantiate(imports) {\n  const baseModule = {};\n\n  function getString(memory, ptr) {\n    if (!memory) return \"<yet unknown>\";\n    return getStringImpl(memory.buffer, ptr);\n  }\n\n  // add common imports used by stdlib for convenience\n  const env = (imports.env = imports.env || {});\n  env.abort = env.abort || function abort(mesg, file, line, colm) {\n    const memory = baseModule.memory || env.memory; // prefer exported, otherwise try imported\n    throw Error(\"abort: \" + getString(memory, mesg) + \" at \" + getString(memory, file) + \":\" + line + \":\" + colm);\n  }\n  env.trace = env.trace || function trace(mesg, n) {\n    const memory = baseModule.memory || env.memory;\n    console.log(\"trace: \" + getString(memory, mesg) + (n ? \" \" : \"\") + Array.prototype.slice.call(arguments, 2, 2 + n).join(\", \"));\n  }\n  imports.Math = imports.Math || Math;\n  imports.Date = imports.Date || Date;\n\n  return baseModule;\n}\n\n/** Prepares the final module once instantiation is complete. */\nfunction postInstantiate(baseModule, instance) {\n  const rawExports = instance.exports;\n  const memory = rawExports.memory;\n  const table = rawExports.table;\n  const alloc = rawExports[\"__alloc\"];\n  const retain = rawExports[\"__retain\"];\n  const rttiBase = rawExports[\"__rtti_base\"] || ~0; // oob if not present\n\n  /** Gets the runtime type info for the given id. */\n  function getInfo(id) {\n    const U32 = new Uint32Array(memory.buffer);\n    const count = U32[rttiBase >>> 2];\n    if ((id >>>= 0) >= count) throw Error(\"invalid id: \" + id);\n    return U32[(rttiBase + 4 >>> 2) + id * 2];\n  }\n\n  /** Gets the runtime base id for the given id. */\n  function getBase(id) {\n    const U32 = new Uint32Array(memory.buffer);\n    const count = U32[rttiBase >>> 2];\n    if ((id >>>= 0) >= count) throw Error(\"invalid id: \" + id);\n    return U32[(rttiBase + 4 >>> 2) + id * 2 + 1];\n  }\n\n  /** Gets the runtime alignment of a collection's values. */\n  function getValueAlign(info) {\n    return 31 - Math.clz32((info >>> VAL_ALIGN_OFFSET) & 31); // -1 if none\n  }\n\n  /** Gets the runtime alignment of a collection's keys. */\n  function getKeyAlign(info) {\n    return 31 - Math.clz32((info >>> KEY_ALIGN_OFFSET) & 31); // -1 if none\n  }\n\n  /** Allocates a new string in the module's memory and returns its retained pointer. */\n  function __allocString(str) {\n    const length = str.length;\n    const ptr = alloc(length << 1, STRING_ID);\n    const U16 = new Uint16Array(memory.buffer);\n    for (var i = 0, p = ptr >>> 1; i < length; ++i) U16[p + i] = str.charCodeAt(i);\n    return ptr;\n  }\n\n  baseModule.__allocString = __allocString;\n\n  /** Reads a string from the module's memory by its pointer. */\n  function __getString(ptr) {\n    const buffer = memory.buffer;\n    const id = new Uint32Array(buffer)[ptr + ID_OFFSET >>> 2];\n    if (id !== STRING_ID) throw Error(\"not a string: \" + ptr);\n    return getStringImpl(buffer, ptr);\n  }\n\n  baseModule.__getString = __getString;\n\n  /** Gets the view matching the specified alignment, signedness and floatness. */\n  function getView(alignLog2, signed, float) {\n    const buffer = memory.buffer;\n    if (float) {\n      switch (alignLog2) {\n        case 2: return new Float32Array(buffer);\n        case 3: return new Float64Array(buffer);\n      }\n    } else {\n      switch (alignLog2) {\n        case 0: return new (signed ? Int8Array : Uint8Array)(buffer);\n        case 1: return new (signed ? Int16Array : Uint16Array)(buffer);\n        case 2: return new (signed ? Int32Array : Uint32Array)(buffer);\n        case 3: return new (signed ? BigInt64Array : BigUint64Array)(buffer);\n      }\n    }\n    throw Error(\"unsupported align: \" + alignLog2);\n  }\n\n  /** Allocates a new array in the module's memory and returns its retained pointer. */\n  function __allocArray(id, values) {\n    const info = getInfo(id);\n    if (!(info & (ARRAYBUFFERVIEW | ARRAY))) throw Error(\"not an array: \" + id + \" @ \" + info);\n    const align = getValueAlign(info);\n    const length = values.length;\n    const buf = alloc(length << align, ARRAYBUFFER_ID);\n    const arr = alloc(info & ARRAY ? ARRAY_SIZE : ARRAYBUFFERVIEW_SIZE, id);\n    const U32 = new Uint32Array(memory.buffer);\n    U32[arr + ARRAYBUFFERVIEW_BUFFER_OFFSET >>> 2] = retain(buf);\n    U32[arr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2] = buf;\n    U32[arr + ARRAYBUFFERVIEW_DATALENGTH_OFFSET >>> 2] = length << align;\n    if (info & ARRAY) U32[arr + ARRAY_LENGTH_OFFSET >>> 2] = length;\n    const view = getView(align, info & VAL_SIGNED, info & VAL_FLOAT);\n    if (info & VAL_MANAGED) {\n      for (let i = 0; i < length; ++i) view[(buf >>> align) + i] = retain(values[i]);\n    } else {\n      view.set(values, buf >>> align);\n    }\n    return arr;\n  }\n\n  baseModule.__allocArray = __allocArray;\n\n  /** Gets a live view on an array's values in the module's memory. Infers the array type from RTTI. */\n  function __getArrayView(arr) {\n    const U32 = new Uint32Array(memory.buffer);\n    const id = U32[arr + ID_OFFSET >>> 2];\n    const info = getInfo(id);\n    if (!(info & ARRAYBUFFERVIEW)) throw Error(\"not an array: \" + id);\n    const align = getValueAlign(info);\n    var buf = U32[arr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2];\n    const length = info & ARRAY\n      ? U32[arr + ARRAY_LENGTH_OFFSET >>> 2]\n      : U32[buf + SIZE_OFFSET >>> 2] >>> align;\n    return getView(align, info & VAL_SIGNED, info & VAL_FLOAT)\n          .subarray(buf >>>= align, buf + length);\n  }\n\n  baseModule.__getArrayView = __getArrayView;\n\n  /** Copies an array's values from the module's memory. Infers the array type from RTTI. */\n  function __getArray(arr) {\n    const input = __getArrayView(arr);\n    const len = input.length;\n    const out = new Array(len);\n    for (let i = 0; i < len; i++) out[i] = input[i];\n    return out;\n  }\n\n  baseModule.__getArray = __getArray;\n\n  /** Copies an ArrayBuffer's value from the module's memory. */\n  function __getArrayBuffer(ptr) {\n    const buffer = memory.buffer;\n    const length = new Uint32Array(buffer)[ptr + SIZE_OFFSET >>> 2];\n    return buffer.slice(ptr, ptr + length);\n  }\n\n  baseModule.__getArrayBuffer = __getArrayBuffer;\n\n  /** Copies a typed array's values from the module's memory. */\n  function getTypedArray(Type, alignLog2, ptr) {\n    return new Type(getTypedArrayView(Type, alignLog2, ptr));\n  }\n\n  /** Gets a live view on a typed array's values in the module's memory. */\n  function getTypedArrayView(Type, alignLog2, ptr) {\n    const buffer = memory.buffer;\n    const U32 = new Uint32Array(buffer);\n    const bufPtr = U32[ptr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2];\n    return new Type(buffer, bufPtr, U32[bufPtr + SIZE_OFFSET >>> 2] >>> alignLog2);\n  }\n\n  baseModule.__getInt8Array = getTypedArray.bind(null, Int8Array, 0);\n  baseModule.__getInt8ArrayView = getTypedArrayView.bind(null, Int8Array, 0);\n  baseModule.__getUint8Array = getTypedArray.bind(null, Uint8Array, 0);\n  baseModule.__getUint8ArrayView = getTypedArrayView.bind(null, Uint8Array, 0);\n  baseModule.__getUint8ClampedArray = getTypedArray.bind(null, Uint8ClampedArray, 0);\n  baseModule.__getUint8ClampedArrayView = getTypedArrayView.bind(null, Uint8ClampedArray, 0);\n  baseModule.__getInt16Array = getTypedArray.bind(null, Int16Array, 1);\n  baseModule.__getInt16ArrayView = getTypedArrayView.bind(null, Int16Array, 1);\n  baseModule.__getUint16Array = getTypedArray.bind(null, Uint16Array, 1);\n  baseModule.__getUint16ArrayView = getTypedArrayView.bind(null, Uint16Array, 1);\n  baseModule.__getInt32Array = getTypedArray.bind(null, Int32Array, 2);\n  baseModule.__getInt32ArrayView = getTypedArrayView.bind(null, Int32Array, 2);\n  baseModule.__getUint32Array = getTypedArray.bind(null, Uint32Array, 2);\n  baseModule.__getUint32ArrayView = getTypedArrayView.bind(null, Uint32Array, 2);\n  if (BIGINT) {\n    baseModule.__getInt64Array = getTypedArray.bind(null, BigInt64Array, 3);\n    baseModule.__getInt64ArrayView = getTypedArrayView.bind(null, BigInt64Array, 3);\n    baseModule.__getUint64Array = getTypedArray.bind(null, BigUint64Array, 3);\n    baseModule.__getUint64ArrayView = getTypedArrayView.bind(null, BigUint64Array, 3);\n  }\n  baseModule.__getFloat32Array = getTypedArray.bind(null, Float32Array, 2);\n  baseModule.__getFloat32ArrayView = getTypedArrayView.bind(null, Float32Array, 2);\n  baseModule.__getFloat64Array = getTypedArray.bind(null, Float64Array, 3);\n  baseModule.__getFloat64ArrayView = getTypedArrayView.bind(null, Float64Array, 3);\n\n  /** Tests whether an object is an instance of the class represented by the specified base id. */\n  function __instanceof(ptr, baseId) {\n    const U32 = new Uint32Array(memory.buffer);\n    var id = U32[(ptr + ID_OFFSET) >>> 2];\n    if (id <= U32[rttiBase >>> 2]) {\n      do if (id == baseId) return true;\n      while (id = getBase(id));\n    }\n    return false;\n  }\n\n  baseModule.__instanceof = __instanceof;\n\n  // Pull basic exports to baseModule so code in preInstantiate can use them\n  baseModule.memory = baseModule.memory || memory;\n  baseModule.table  = baseModule.table  || table;\n\n  // Demangle exports and provide the usual utility on the prototype\n  return demangle(rawExports, baseModule);\n}\n\nfunction isResponse(o) {\n  return typeof Response !== \"undefined\" && o instanceof Response;\n}\n\n/** Asynchronously instantiates an AssemblyScript module from anything that can be instantiated. */\nasync function instantiate(source, imports) {\n  if (isResponse(source = await source)) return instantiateStreaming(source, imports);\n  return postInstantiate(\n    preInstantiate(imports || (imports = {})),\n    await WebAssembly.instantiate(\n      source instanceof WebAssembly.Module\n        ? source\n        : await WebAssembly.compile(source),\n      imports\n    )\n  );\n}\n\nexports.instantiate = instantiate;\n\n/** Synchronously instantiates an AssemblyScript module from a WebAssembly.Module or binary buffer. */\nfunction instantiateSync(source, imports) {\n  return postInstantiate(\n    preInstantiate(imports || (imports = {})),\n    new WebAssembly.Instance(\n      source instanceof WebAssembly.Module\n        ? source\n        : new WebAssembly.Module(source),\n      imports\n    )\n  )\n}\n\nexports.instantiateSync = instantiateSync;\n\n/** Asynchronously instantiates an AssemblyScript module from a response, i.e. as obtained by `fetch`. */\nasync function instantiateStreaming(source, imports) {\n  if (!WebAssembly.instantiateStreaming) {\n    return instantiate(\n      isResponse(source = await source)\n        ? source.arrayBuffer()\n        : source,\n      imports\n    );\n  }\n  return postInstantiate(\n    preInstantiate(imports || (imports = {})),\n    (await WebAssembly.instantiateStreaming(source, imports)).instance\n  );\n}\n\nexports.instantiateStreaming = instantiateStreaming;\n\n/** Demangles an AssemblyScript module's exports to a friendly object structure. */\nfunction demangle(exports, baseModule) {\n  var module = baseModule ? Object.create(baseModule) : {};\n  var setArgumentsLength = exports[\"__argumentsLength\"]\n    ? function(length) { exports[\"__argumentsLength\"].value = length; }\n    : exports[\"__setArgumentsLength\"] || exports[\"__setargc\"] || function() {};\n  for (let internalName in exports) {\n    if (!Object.prototype.hasOwnProperty.call(exports, internalName)) continue;\n    const elem = exports[internalName];\n    let parts = internalName.split(\".\");\n    let curr = module;\n    while (parts.length > 1) {\n      let part = parts.shift();\n      if (!Object.prototype.hasOwnProperty.call(curr, part)) curr[part] = {};\n      curr = curr[part];\n    }\n    let name = parts[0];\n    let hash = name.indexOf(\"#\");\n    if (hash >= 0) {\n      let className = name.substring(0, hash);\n      let classElem = curr[className];\n      if (typeof classElem === \"undefined\" || !classElem.prototype) {\n        let ctor = function(...args) {\n          return ctor.wrap(ctor.prototype.constructor(0, ...args));\n        };\n        ctor.prototype = {\n          valueOf: function valueOf() {\n            return this[THIS];\n          }\n        };\n        ctor.wrap = function(thisValue) {\n          return Object.create(ctor.prototype, { [THIS]: { value: thisValue, writable: false } });\n        };\n        if (classElem) Object.getOwnPropertyNames(classElem).forEach(name =>\n          Object.defineProperty(ctor, name, Object.getOwnPropertyDescriptor(classElem, name))\n        );\n        curr[className] = ctor;\n      }\n      name = name.substring(hash + 1);\n      curr = curr[className].prototype;\n      if (/^(get|set):/.test(name)) {\n        if (!Object.prototype.hasOwnProperty.call(curr, name = name.substring(4))) {\n          let getter = exports[internalName.replace(\"set:\", \"get:\")];\n          let setter = exports[internalName.replace(\"get:\", \"set:\")];\n          Object.defineProperty(curr, name, {\n            get: function() { return getter(this[THIS]); },\n            set: function(value) { setter(this[THIS], value); },\n            enumerable: true\n          });\n        }\n      } else {\n        if (name === 'constructor') {\n          (curr[name] = (...args) => {\n            setArgumentsLength(args.length);\n            return elem(...args);\n          }).original = elem;\n        } else { // instance method\n          (curr[name] = function(...args) { // !\n            setArgumentsLength(args.length);\n            return elem(this[THIS], ...args);\n          }).original = elem;\n        }\n      }\n    } else {\n      if (/^(get|set):/.test(name)) {\n        if (!Object.prototype.hasOwnProperty.call(curr, name = name.substring(4))) {\n          Object.defineProperty(curr, name, {\n            get: exports[internalName.replace(\"set:\", \"get:\")],\n            set: exports[internalName.replace(\"get:\", \"set:\")],\n            enumerable: true\n          });\n        }\n      } else if (typeof elem === \"function\" && elem !== setArgumentsLength) {\n        (curr[name] = (...args) => {\n          setArgumentsLength(args.length);\n          return elem(...args);\n        }).original = elem;\n      } else {\n        curr[name] = elem;\n      }\n    }\n  }\n  return module;\n}\n\nexports.demangle = demangle;\n","// minimal library entry point.\n\n\"use strict\";\nmodule.exports = require(\"./src/index-minimal\");\n","\"use strict\";\nvar protobuf = exports;\n\n/**\n * Build type, one of `\"full\"`, `\"light\"` or `\"minimal\"`.\n * @name build\n * @type {string}\n * @const\n */\nprotobuf.build = \"minimal\";\n\n// Serialization\nprotobuf.Writer       = require(\"./writer\");\nprotobuf.BufferWriter = require(\"./writer_buffer\");\nprotobuf.Reader       = require(\"./reader\");\nprotobuf.BufferReader = require(\"./reader_buffer\");\n\n// Utility\nprotobuf.util         = require(\"./util/minimal\");\nprotobuf.rpc          = require(\"./rpc\");\nprotobuf.roots        = require(\"./roots\");\nprotobuf.configure    = configure;\n\n/* istanbul ignore next */\n/**\n * Reconfigures the library according to the environment.\n * @returns {undefined}\n */\nfunction configure() {\n    protobuf.util._configure();\n    protobuf.Writer._configure(protobuf.BufferWriter);\n    protobuf.Reader._configure(protobuf.BufferReader);\n}\n\n// Set up buffer utility according to the environment\nconfigure();\n","\"use strict\";\nmodule.exports = Reader;\n\nvar util      = require(\"./util/minimal\");\n\nvar BufferReader; // cyclic\n\nvar LongBits  = util.LongBits,\n    utf8      = util.utf8;\n\n/* istanbul ignore next */\nfunction indexOutOfRange(reader, writeLength) {\n    return RangeError(\"index out of range: \" + reader.pos + \" + \" + (writeLength || 1) + \" > \" + reader.len);\n}\n\n/**\n * Constructs a new reader instance using the specified buffer.\n * @classdesc Wire format reader using `Uint8Array` if available, otherwise `Array`.\n * @constructor\n * @param {Uint8Array} buffer Buffer to read from\n */\nfunction Reader(buffer) {\n\n    /**\n     * Read buffer.\n     * @type {Uint8Array}\n     */\n    this.buf = buffer;\n\n    /**\n     * Read buffer position.\n     * @type {number}\n     */\n    this.pos = 0;\n\n    /**\n     * Read buffer length.\n     * @type {number}\n     */\n    this.len = buffer.length;\n}\n\nvar create_array = typeof Uint8Array !== \"undefined\"\n    ? function create_typed_array(buffer) {\n        if (buffer instanceof Uint8Array || Array.isArray(buffer))\n            return new Reader(buffer);\n        throw Error(\"illegal buffer\");\n    }\n    /* istanbul ignore next */\n    : function create_array(buffer) {\n        if (Array.isArray(buffer))\n            return new Reader(buffer);\n        throw Error(\"illegal buffer\");\n    };\n\nvar create = function create() {\n    return util.Buffer\n        ? function create_buffer_setup(buffer) {\n            return (Reader.create = function create_buffer(buffer) {\n                return util.Buffer.isBuffer(buffer)\n                    ? new BufferReader(buffer)\n                    /* istanbul ignore next */\n                    : create_array(buffer);\n            })(buffer);\n        }\n        /* istanbul ignore next */\n        : create_array;\n};\n\n/**\n * Creates a new reader using the specified buffer.\n * @function\n * @param {Uint8Array|Buffer} buffer Buffer to read from\n * @returns {Reader|BufferReader} A {@link BufferReader} if `buffer` is a Buffer, otherwise a {@link Reader}\n * @throws {Error} If `buffer` is not a valid buffer\n */\nReader.create = create();\n\nReader.prototype._slice = util.Array.prototype.subarray || /* istanbul ignore next */ util.Array.prototype.slice;\n\n/**\n * Reads a varint as an unsigned 32 bit value.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.uint32 = (function read_uint32_setup() {\n    var value = 4294967295; // optimizer type-hint, tends to deopt otherwise (?!)\n    return function read_uint32() {\n        value = (         this.buf[this.pos] & 127       ) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) <<  7) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) << 14) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) << 21) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] &  15) << 28) >>> 0; if (this.buf[this.pos++] < 128) return value;\n\n        /* istanbul ignore if */\n        if ((this.pos += 5) > this.len) {\n            this.pos = this.len;\n            throw indexOutOfRange(this, 10);\n        }\n        return value;\n    };\n})();\n\n/**\n * Reads a varint as a signed 32 bit value.\n * @returns {number} Value read\n */\nReader.prototype.int32 = function read_int32() {\n    return this.uint32() | 0;\n};\n\n/**\n * Reads a zig-zag encoded varint as a signed 32 bit value.\n * @returns {number} Value read\n */\nReader.prototype.sint32 = function read_sint32() {\n    var value = this.uint32();\n    return value >>> 1 ^ -(value & 1) | 0;\n};\n\n/* eslint-disable no-invalid-this */\n\nfunction readLongVarint() {\n    // tends to deopt with local vars for octet etc.\n    var bits = new LongBits(0, 0);\n    var i = 0;\n    if (this.len - this.pos > 4) { // fast route (lo)\n        for (; i < 4; ++i) {\n            // 1st..4th\n            bits.lo = (bits.lo | (this.buf[this.pos] & 127) << i * 7) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n        // 5th\n        bits.lo = (bits.lo | (this.buf[this.pos] & 127) << 28) >>> 0;\n        bits.hi = (bits.hi | (this.buf[this.pos] & 127) >>  4) >>> 0;\n        if (this.buf[this.pos++] < 128)\n            return bits;\n        i = 0;\n    } else {\n        for (; i < 3; ++i) {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n            // 1st..3th\n            bits.lo = (bits.lo | (this.buf[this.pos] & 127) << i * 7) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n        // 4th\n        bits.lo = (bits.lo | (this.buf[this.pos++] & 127) << i * 7) >>> 0;\n        return bits;\n    }\n    if (this.len - this.pos > 4) { // fast route (hi)\n        for (; i < 5; ++i) {\n            // 6th..10th\n            bits.hi = (bits.hi | (this.buf[this.pos] & 127) << i * 7 + 3) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n    } else {\n        for (; i < 5; ++i) {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n            // 6th..10th\n            bits.hi = (bits.hi | (this.buf[this.pos] & 127) << i * 7 + 3) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n    }\n    /* istanbul ignore next */\n    throw Error(\"invalid varint encoding\");\n}\n\n/* eslint-enable no-invalid-this */\n\n/**\n * Reads a varint as a signed 64 bit value.\n * @name Reader#int64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a varint as an unsigned 64 bit value.\n * @name Reader#uint64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a zig-zag encoded varint as a signed 64 bit value.\n * @name Reader#sint64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a varint as a boolean.\n * @returns {boolean} Value read\n */\nReader.prototype.bool = function read_bool() {\n    return this.uint32() !== 0;\n};\n\nfunction readFixed32_end(buf, end) { // note that this uses `end`, not `pos`\n    return (buf[end - 4]\n          | buf[end - 3] << 8\n          | buf[end - 2] << 16\n          | buf[end - 1] << 24) >>> 0;\n}\n\n/**\n * Reads fixed 32 bits as an unsigned 32 bit integer.\n * @returns {number} Value read\n */\nReader.prototype.fixed32 = function read_fixed32() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    return readFixed32_end(this.buf, this.pos += 4);\n};\n\n/**\n * Reads fixed 32 bits as a signed 32 bit integer.\n * @returns {number} Value read\n */\nReader.prototype.sfixed32 = function read_sfixed32() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    return readFixed32_end(this.buf, this.pos += 4) | 0;\n};\n\n/* eslint-disable no-invalid-this */\n\nfunction readFixed64(/* this: Reader */) {\n\n    /* istanbul ignore if */\n    if (this.pos + 8 > this.len)\n        throw indexOutOfRange(this, 8);\n\n    return new LongBits(readFixed32_end(this.buf, this.pos += 4), readFixed32_end(this.buf, this.pos += 4));\n}\n\n/* eslint-enable no-invalid-this */\n\n/**\n * Reads fixed 64 bits.\n * @name Reader#fixed64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads zig-zag encoded fixed 64 bits.\n * @name Reader#sfixed64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a float (32 bit) as a number.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.float = function read_float() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    var value = util.float.readFloatLE(this.buf, this.pos);\n    this.pos += 4;\n    return value;\n};\n\n/**\n * Reads a double (64 bit float) as a number.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.double = function read_double() {\n\n    /* istanbul ignore if */\n    if (this.pos + 8 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    var value = util.float.readDoubleLE(this.buf, this.pos);\n    this.pos += 8;\n    return value;\n};\n\n/**\n * Reads a sequence of bytes preceeded by its length as a varint.\n * @returns {Uint8Array} Value read\n */\nReader.prototype.bytes = function read_bytes() {\n    var length = this.uint32(),\n        start  = this.pos,\n        end    = this.pos + length;\n\n    /* istanbul ignore if */\n    if (end > this.len)\n        throw indexOutOfRange(this, length);\n\n    this.pos += length;\n    if (Array.isArray(this.buf)) // plain array\n        return this.buf.slice(start, end);\n\n    if (start === end) { // fix for IE 10/Win8 and others' subarray returning array of size 1\n        var nativeBuffer = util.Buffer;\n        return nativeBuffer\n            ? nativeBuffer.alloc(0)\n            : new this.buf.constructor(0);\n    }\n    return this._slice.call(this.buf, start, end);\n};\n\n/**\n * Reads a string preceeded by its byte length as a varint.\n * @returns {string} Value read\n */\nReader.prototype.string = function read_string() {\n    var bytes = this.bytes();\n    return utf8.read(bytes, 0, bytes.length);\n};\n\n/**\n * Skips the specified number of bytes if specified, otherwise skips a varint.\n * @param {number} [length] Length if known, otherwise a varint is assumed\n * @returns {Reader} `this`\n */\nReader.prototype.skip = function skip(length) {\n    if (typeof length === \"number\") {\n        /* istanbul ignore if */\n        if (this.pos + length > this.len)\n            throw indexOutOfRange(this, length);\n        this.pos += length;\n    } else {\n        do {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n        } while (this.buf[this.pos++] & 128);\n    }\n    return this;\n};\n\n/**\n * Skips the next element of the specified wire type.\n * @param {number} wireType Wire type received\n * @returns {Reader} `this`\n */\nReader.prototype.skipType = function(wireType) {\n    switch (wireType) {\n        case 0:\n            this.skip();\n            break;\n        case 1:\n            this.skip(8);\n            break;\n        case 2:\n            this.skip(this.uint32());\n            break;\n        case 3:\n            while ((wireType = this.uint32() & 7) !== 4) {\n                this.skipType(wireType);\n            }\n            break;\n        case 5:\n            this.skip(4);\n            break;\n\n        /* istanbul ignore next */\n        default:\n            throw Error(\"invalid wire type \" + wireType + \" at offset \" + this.pos);\n    }\n    return this;\n};\n\nReader._configure = function(BufferReader_) {\n    BufferReader = BufferReader_;\n    Reader.create = create();\n    BufferReader._configure();\n\n    var fn = util.Long ? \"toLong\" : /* istanbul ignore next */ \"toNumber\";\n    util.merge(Reader.prototype, {\n\n        int64: function read_int64() {\n            return readLongVarint.call(this)[fn](false);\n        },\n\n        uint64: function read_uint64() {\n            return readLongVarint.call(this)[fn](true);\n        },\n\n        sint64: function read_sint64() {\n            return readLongVarint.call(this).zzDecode()[fn](false);\n        },\n\n        fixed64: function read_fixed64() {\n            return readFixed64.call(this)[fn](true);\n        },\n\n        sfixed64: function read_sfixed64() {\n            return readFixed64.call(this)[fn](false);\n        }\n\n    });\n};\n","\"use strict\";\nmodule.exports = BufferReader;\n\n// extends Reader\nvar Reader = require(\"./reader\");\n(BufferReader.prototype = Object.create(Reader.prototype)).constructor = BufferReader;\n\nvar util = require(\"./util/minimal\");\n\n/**\n * Constructs a new buffer reader instance.\n * @classdesc Wire format reader using node buffers.\n * @extends Reader\n * @constructor\n * @param {Buffer} buffer Buffer to read from\n */\nfunction BufferReader(buffer) {\n    Reader.call(this, buffer);\n\n    /**\n     * Read buffer.\n     * @name BufferReader#buf\n     * @type {Buffer}\n     */\n}\n\nBufferReader._configure = function () {\n    /* istanbul ignore else */\n    if (util.Buffer)\n        BufferReader.prototype._slice = util.Buffer.prototype.slice;\n};\n\n\n/**\n * @override\n */\nBufferReader.prototype.string = function read_string_buffer() {\n    var len = this.uint32(); // modifies pos\n    return this.buf.utf8Slice\n        ? this.buf.utf8Slice(this.pos, this.pos = Math.min(this.pos + len, this.len))\n        : this.buf.toString(\"utf-8\", this.pos, this.pos = Math.min(this.pos + len, this.len));\n};\n\n/**\n * Reads a sequence of bytes preceeded by its length as a varint.\n * @name BufferReader#bytes\n * @function\n * @returns {Buffer} Value read\n */\n\nBufferReader._configure();\n","\"use strict\";\nmodule.exports = {};\n\n/**\n * Named roots.\n * This is where pbjs stores generated structures (the option `-r, --root` specifies a name).\n * Can also be used manually to make roots available across modules.\n * @name roots\n * @type {Object.<string,Root>}\n * @example\n * // pbjs -r myroot -o compiled.js ...\n *\n * // in another module:\n * require(\"./compiled.js\");\n *\n * // in any subsequent module:\n * var root = protobuf.roots[\"myroot\"];\n */\n","\"use strict\";\n\n/**\n * Streaming RPC helpers.\n * @namespace\n */\nvar rpc = exports;\n\n/**\n * RPC implementation passed to {@link Service#create} performing a service request on network level, i.e. by utilizing http requests or websockets.\n * @typedef RPCImpl\n * @type {function}\n * @param {Method|rpc.ServiceMethod<Message<{}>,Message<{}>>} method Reflected or static method being called\n * @param {Uint8Array} requestData Request data\n * @param {RPCImplCallback} callback Callback function\n * @returns {undefined}\n * @example\n * function rpcImpl(method, requestData, callback) {\n *     if (protobuf.util.lcFirst(method.name) !== \"myMethod\") // compatible with static code\n *         throw Error(\"no such method\");\n *     asynchronouslyObtainAResponse(requestData, function(err, responseData) {\n *         callback(err, responseData);\n *     });\n * }\n */\n\n/**\n * Node-style callback as used by {@link RPCImpl}.\n * @typedef RPCImplCallback\n * @type {function}\n * @param {Error|null} error Error, if any, otherwise `null`\n * @param {Uint8Array|null} [response] Response data or `null` to signal end of stream, if there hasn't been an error\n * @returns {undefined}\n */\n\nrpc.Service = require(\"./rpc/service\");\n","\"use strict\";\nmodule.exports = Service;\n\nvar util = require(\"../util/minimal\");\n\n// Extends EventEmitter\n(Service.prototype = Object.create(util.EventEmitter.prototype)).constructor = Service;\n\n/**\n * A service method callback as used by {@link rpc.ServiceMethod|ServiceMethod}.\n *\n * Differs from {@link RPCImplCallback} in that it is an actual callback of a service method which may not return `response = null`.\n * @typedef rpc.ServiceMethodCallback\n * @template TRes extends Message<TRes>\n * @type {function}\n * @param {Error|null} error Error, if any\n * @param {TRes} [response] Response message\n * @returns {undefined}\n */\n\n/**\n * A service method part of a {@link rpc.Service} as created by {@link Service.create}.\n * @typedef rpc.ServiceMethod\n * @template TReq extends Message<TReq>\n * @template TRes extends Message<TRes>\n * @type {function}\n * @param {TReq|Properties<TReq>} request Request message or plain object\n * @param {rpc.ServiceMethodCallback<TRes>} [callback] Node-style callback called with the error, if any, and the response message\n * @returns {Promise<Message<TRes>>} Promise if `callback` has been omitted, otherwise `undefined`\n */\n\n/**\n * Constructs a new RPC service instance.\n * @classdesc An RPC service as returned by {@link Service#create}.\n * @exports rpc.Service\n * @extends util.EventEmitter\n * @constructor\n * @param {RPCImpl} rpcImpl RPC implementation\n * @param {boolean} [requestDelimited=false] Whether requests are length-delimited\n * @param {boolean} [responseDelimited=false] Whether responses are length-delimited\n */\nfunction Service(rpcImpl, requestDelimited, responseDelimited) {\n\n    if (typeof rpcImpl !== \"function\")\n        throw TypeError(\"rpcImpl must be a function\");\n\n    util.EventEmitter.call(this);\n\n    /**\n     * RPC implementation. Becomes `null` once the service is ended.\n     * @type {RPCImpl|null}\n     */\n    this.rpcImpl = rpcImpl;\n\n    /**\n     * Whether requests are length-delimited.\n     * @type {boolean}\n     */\n    this.requestDelimited = Boolean(requestDelimited);\n\n    /**\n     * Whether responses are length-delimited.\n     * @type {boolean}\n     */\n    this.responseDelimited = Boolean(responseDelimited);\n}\n\n/**\n * Calls a service method through {@link rpc.Service#rpcImpl|rpcImpl}.\n * @param {Method|rpc.ServiceMethod<TReq,TRes>} method Reflected or static method\n * @param {Constructor<TReq>} requestCtor Request constructor\n * @param {Constructor<TRes>} responseCtor Response constructor\n * @param {TReq|Properties<TReq>} request Request message or plain object\n * @param {rpc.ServiceMethodCallback<TRes>} callback Service callback\n * @returns {undefined}\n * @template TReq extends Message<TReq>\n * @template TRes extends Message<TRes>\n */\nService.prototype.rpcCall = function rpcCall(method, requestCtor, responseCtor, request, callback) {\n\n    if (!request)\n        throw TypeError(\"request must be specified\");\n\n    var self = this;\n    if (!callback)\n        return util.asPromise(rpcCall, self, method, requestCtor, responseCtor, request);\n\n    if (!self.rpcImpl) {\n        setTimeout(function() { callback(Error(\"already ended\")); }, 0);\n        return undefined;\n    }\n\n    try {\n        return self.rpcImpl(\n            method,\n            requestCtor[self.requestDelimited ? \"encodeDelimited\" : \"encode\"](request).finish(),\n            function rpcCallback(err, response) {\n\n                if (err) {\n                    self.emit(\"error\", err, method);\n                    return callback(err);\n                }\n\n                if (response === null) {\n                    self.end(/* endedByRPC */ true);\n                    return undefined;\n                }\n\n                if (!(response instanceof responseCtor)) {\n                    try {\n                        response = responseCtor[self.responseDelimited ? \"decodeDelimited\" : \"decode\"](response);\n                    } catch (err) {\n                        self.emit(\"error\", err, method);\n                        return callback(err);\n                    }\n                }\n\n                self.emit(\"data\", response, method);\n                return callback(null, response);\n            }\n        );\n    } catch (err) {\n        self.emit(\"error\", err, method);\n        setTimeout(function() { callback(err); }, 0);\n        return undefined;\n    }\n};\n\n/**\n * Ends this service and emits the `end` event.\n * @param {boolean} [endedByRPC=false] Whether the service has been ended by the RPC implementation.\n * @returns {rpc.Service} `this`\n */\nService.prototype.end = function end(endedByRPC) {\n    if (this.rpcImpl) {\n        if (!endedByRPC) // signal end to rpcImpl\n            this.rpcImpl(null, null, null);\n        this.rpcImpl = null;\n        this.emit(\"end\").off();\n    }\n    return this;\n};\n","\"use strict\";\nmodule.exports = LongBits;\n\nvar util = require(\"../util/minimal\");\n\n/**\n * Constructs new long bits.\n * @classdesc Helper class for working with the low and high bits of a 64 bit value.\n * @memberof util\n * @constructor\n * @param {number} lo Low 32 bits, unsigned\n * @param {number} hi High 32 bits, unsigned\n */\nfunction LongBits(lo, hi) {\n\n    // note that the casts below are theoretically unnecessary as of today, but older statically\n    // generated converter code might still call the ctor with signed 32bits. kept for compat.\n\n    /**\n     * Low bits.\n     * @type {number}\n     */\n    this.lo = lo >>> 0;\n\n    /**\n     * High bits.\n     * @type {number}\n     */\n    this.hi = hi >>> 0;\n}\n\n/**\n * Zero bits.\n * @memberof util.LongBits\n * @type {util.LongBits}\n */\nvar zero = LongBits.zero = new LongBits(0, 0);\n\nzero.toNumber = function() { return 0; };\nzero.zzEncode = zero.zzDecode = function() { return this; };\nzero.length = function() { return 1; };\n\n/**\n * Zero hash.\n * @memberof util.LongBits\n * @type {string}\n */\nvar zeroHash = LongBits.zeroHash = \"\\0\\0\\0\\0\\0\\0\\0\\0\";\n\n/**\n * Constructs new long bits from the specified number.\n * @param {number} value Value\n * @returns {util.LongBits} Instance\n */\nLongBits.fromNumber = function fromNumber(value) {\n    if (value === 0)\n        return zero;\n    var sign = value < 0;\n    if (sign)\n        value = -value;\n    var lo = value >>> 0,\n        hi = (value - lo) / 4294967296 >>> 0;\n    if (sign) {\n        hi = ~hi >>> 0;\n        lo = ~lo >>> 0;\n        if (++lo > 4294967295) {\n            lo = 0;\n            if (++hi > 4294967295)\n                hi = 0;\n        }\n    }\n    return new LongBits(lo, hi);\n};\n\n/**\n * Constructs new long bits from a number, long or string.\n * @param {Long|number|string} value Value\n * @returns {util.LongBits} Instance\n */\nLongBits.from = function from(value) {\n    if (typeof value === \"number\")\n        return LongBits.fromNumber(value);\n    if (util.isString(value)) {\n        /* istanbul ignore else */\n        if (util.Long)\n            value = util.Long.fromString(value);\n        else\n            return LongBits.fromNumber(parseInt(value, 10));\n    }\n    return value.low || value.high ? new LongBits(value.low >>> 0, value.high >>> 0) : zero;\n};\n\n/**\n * Converts this long bits to a possibly unsafe JavaScript number.\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {number} Possibly unsafe number\n */\nLongBits.prototype.toNumber = function toNumber(unsigned) {\n    if (!unsigned && this.hi >>> 31) {\n        var lo = ~this.lo + 1 >>> 0,\n            hi = ~this.hi     >>> 0;\n        if (!lo)\n            hi = hi + 1 >>> 0;\n        return -(lo + hi * 4294967296);\n    }\n    return this.lo + this.hi * 4294967296;\n};\n\n/**\n * Converts this long bits to a long.\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {Long} Long\n */\nLongBits.prototype.toLong = function toLong(unsigned) {\n    return util.Long\n        ? new util.Long(this.lo | 0, this.hi | 0, Boolean(unsigned))\n        /* istanbul ignore next */\n        : { low: this.lo | 0, high: this.hi | 0, unsigned: Boolean(unsigned) };\n};\n\nvar charCodeAt = String.prototype.charCodeAt;\n\n/**\n * Constructs new long bits from the specified 8 characters long hash.\n * @param {string} hash Hash\n * @returns {util.LongBits} Bits\n */\nLongBits.fromHash = function fromHash(hash) {\n    if (hash === zeroHash)\n        return zero;\n    return new LongBits(\n        ( charCodeAt.call(hash, 0)\n        | charCodeAt.call(hash, 1) << 8\n        | charCodeAt.call(hash, 2) << 16\n        | charCodeAt.call(hash, 3) << 24) >>> 0\n    ,\n        ( charCodeAt.call(hash, 4)\n        | charCodeAt.call(hash, 5) << 8\n        | charCodeAt.call(hash, 6) << 16\n        | charCodeAt.call(hash, 7) << 24) >>> 0\n    );\n};\n\n/**\n * Converts this long bits to a 8 characters long hash.\n * @returns {string} Hash\n */\nLongBits.prototype.toHash = function toHash() {\n    return String.fromCharCode(\n        this.lo        & 255,\n        this.lo >>> 8  & 255,\n        this.lo >>> 16 & 255,\n        this.lo >>> 24      ,\n        this.hi        & 255,\n        this.hi >>> 8  & 255,\n        this.hi >>> 16 & 255,\n        this.hi >>> 24\n    );\n};\n\n/**\n * Zig-zag encodes this long bits.\n * @returns {util.LongBits} `this`\n */\nLongBits.prototype.zzEncode = function zzEncode() {\n    var mask =   this.hi >> 31;\n    this.hi  = ((this.hi << 1 | this.lo >>> 31) ^ mask) >>> 0;\n    this.lo  = ( this.lo << 1                   ^ mask) >>> 0;\n    return this;\n};\n\n/**\n * Zig-zag decodes this long bits.\n * @returns {util.LongBits} `this`\n */\nLongBits.prototype.zzDecode = function zzDecode() {\n    var mask = -(this.lo & 1);\n    this.lo  = ((this.lo >>> 1 | this.hi << 31) ^ mask) >>> 0;\n    this.hi  = ( this.hi >>> 1                  ^ mask) >>> 0;\n    return this;\n};\n\n/**\n * Calculates the length of this longbits when encoded as a varint.\n * @returns {number} Length\n */\nLongBits.prototype.length = function length() {\n    var part0 =  this.lo,\n        part1 = (this.lo >>> 28 | this.hi << 4) >>> 0,\n        part2 =  this.hi >>> 24;\n    return part2 === 0\n         ? part1 === 0\n           ? part0 < 16384\n             ? part0 < 128 ? 1 : 2\n             : part0 < 2097152 ? 3 : 4\n           : part1 < 16384\n             ? part1 < 128 ? 5 : 6\n             : part1 < 2097152 ? 7 : 8\n         : part2 < 128 ? 9 : 10;\n};\n","\"use strict\";\nvar util = exports;\n\n// used to return a Promise where callback is omitted\nutil.asPromise = require(\"@protobufjs/aspromise\");\n\n// converts to / from base64 encoded strings\nutil.base64 = require(\"@protobufjs/base64\");\n\n// base class of rpc.Service\nutil.EventEmitter = require(\"@protobufjs/eventemitter\");\n\n// float handling accross browsers\nutil.float = require(\"@protobufjs/float\");\n\n// requires modules optionally and hides the call from bundlers\nutil.inquire = require(\"@protobufjs/inquire\");\n\n// converts to / from utf8 encoded strings\nutil.utf8 = require(\"@protobufjs/utf8\");\n\n// provides a node-like buffer pool in the browser\nutil.pool = require(\"@protobufjs/pool\");\n\n// utility to work with the low and high bits of a 64 bit value\nutil.LongBits = require(\"./longbits\");\n\n/**\n * Whether running within node or not.\n * @memberof util\n * @type {boolean}\n */\nutil.isNode = Boolean(typeof global !== \"undefined\"\n                   && global\n                   && global.process\n                   && global.process.versions\n                   && global.process.versions.node);\n\n/**\n * Global object reference.\n * @memberof util\n * @type {Object}\n */\nutil.global = util.isNode && global\n           || typeof window !== \"undefined\" && window\n           || typeof self   !== \"undefined\" && self\n           || this; // eslint-disable-line no-invalid-this\n\n/**\n * An immuable empty array.\n * @memberof util\n * @type {Array.<*>}\n * @const\n */\nutil.emptyArray = Object.freeze ? Object.freeze([]) : /* istanbul ignore next */ []; // used on prototypes\n\n/**\n * An immutable empty object.\n * @type {Object}\n * @const\n */\nutil.emptyObject = Object.freeze ? Object.freeze({}) : /* istanbul ignore next */ {}; // used on prototypes\n\n/**\n * Tests if the specified value is an integer.\n * @function\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is an integer\n */\nutil.isInteger = Number.isInteger || /* istanbul ignore next */ function isInteger(value) {\n    return typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\n};\n\n/**\n * Tests if the specified value is a string.\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is a string\n */\nutil.isString = function isString(value) {\n    return typeof value === \"string\" || value instanceof String;\n};\n\n/**\n * Tests if the specified value is a non-null object.\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is a non-null object\n */\nutil.isObject = function isObject(value) {\n    return value && typeof value === \"object\";\n};\n\n/**\n * Checks if a property on a message is considered to be present.\n * This is an alias of {@link util.isSet}.\n * @function\n * @param {Object} obj Plain object or message instance\n * @param {string} prop Property name\n * @returns {boolean} `true` if considered to be present, otherwise `false`\n */\nutil.isset =\n\n/**\n * Checks if a property on a message is considered to be present.\n * @param {Object} obj Plain object or message instance\n * @param {string} prop Property name\n * @returns {boolean} `true` if considered to be present, otherwise `false`\n */\nutil.isSet = function isSet(obj, prop) {\n    var value = obj[prop];\n    if (value != null && obj.hasOwnProperty(prop)) // eslint-disable-line eqeqeq, no-prototype-builtins\n        return typeof value !== \"object\" || (Array.isArray(value) ? value.length : Object.keys(value).length) > 0;\n    return false;\n};\n\n/**\n * Any compatible Buffer instance.\n * This is a minimal stand-alone definition of a Buffer instance. The actual type is that exported by node's typings.\n * @interface Buffer\n * @extends Uint8Array\n */\n\n/**\n * Node's Buffer class if available.\n * @type {Constructor<Buffer>}\n */\nutil.Buffer = (function() {\n    try {\n        var Buffer = util.inquire(\"buffer\").Buffer;\n        // refuse to use non-node buffers if not explicitly assigned (perf reasons):\n        return Buffer.prototype.utf8Write ? Buffer : /* istanbul ignore next */ null;\n    } catch (e) {\n        /* istanbul ignore next */\n        return null;\n    }\n})();\n\n// Internal alias of or polyfull for Buffer.from.\nutil._Buffer_from = null;\n\n// Internal alias of or polyfill for Buffer.allocUnsafe.\nutil._Buffer_allocUnsafe = null;\n\n/**\n * Creates a new buffer of whatever type supported by the environment.\n * @param {number|number[]} [sizeOrArray=0] Buffer size or number array\n * @returns {Uint8Array|Buffer} Buffer\n */\nutil.newBuffer = function newBuffer(sizeOrArray) {\n    /* istanbul ignore next */\n    return typeof sizeOrArray === \"number\"\n        ? util.Buffer\n            ? util._Buffer_allocUnsafe(sizeOrArray)\n            : new util.Array(sizeOrArray)\n        : util.Buffer\n            ? util._Buffer_from(sizeOrArray)\n            : typeof Uint8Array === \"undefined\"\n                ? sizeOrArray\n                : new Uint8Array(sizeOrArray);\n};\n\n/**\n * Array implementation used in the browser. `Uint8Array` if supported, otherwise `Array`.\n * @type {Constructor<Uint8Array>}\n */\nutil.Array = typeof Uint8Array !== \"undefined\" ? Uint8Array /* istanbul ignore next */ : Array;\n\n/**\n * Any compatible Long instance.\n * This is a minimal stand-alone definition of a Long instance. The actual type is that exported by long.js.\n * @interface Long\n * @property {number} low Low bits\n * @property {number} high High bits\n * @property {boolean} unsigned Whether unsigned or not\n */\n\n/**\n * Long.js's Long class if available.\n * @type {Constructor<Long>}\n */\nutil.Long = /* istanbul ignore next */ util.global.dcodeIO && /* istanbul ignore next */ util.global.dcodeIO.Long\n         || /* istanbul ignore next */ util.global.Long\n         || util.inquire(\"long\");\n\n/**\n * Regular expression used to verify 2 bit (`bool`) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key2Re = /^true|false|0|1$/;\n\n/**\n * Regular expression used to verify 32 bit (`int32` etc.) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key32Re = /^-?(?:0|[1-9][0-9]*)$/;\n\n/**\n * Regular expression used to verify 64 bit (`int64` etc.) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key64Re = /^(?:[\\\\x00-\\\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;\n\n/**\n * Converts a number or long to an 8 characters long hash string.\n * @param {Long|number} value Value to convert\n * @returns {string} Hash\n */\nutil.longToHash = function longToHash(value) {\n    return value\n        ? util.LongBits.from(value).toHash()\n        : util.LongBits.zeroHash;\n};\n\n/**\n * Converts an 8 characters long hash string to a long or number.\n * @param {string} hash Hash\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {Long|number} Original value\n */\nutil.longFromHash = function longFromHash(hash, unsigned) {\n    var bits = util.LongBits.fromHash(hash);\n    if (util.Long)\n        return util.Long.fromBits(bits.lo, bits.hi, unsigned);\n    return bits.toNumber(Boolean(unsigned));\n};\n\n/**\n * Merges the properties of the source object into the destination object.\n * @memberof util\n * @param {Object.<string,*>} dst Destination object\n * @param {Object.<string,*>} src Source object\n * @param {boolean} [ifNotSet=false] Merges only if the key is not already set\n * @returns {Object.<string,*>} Destination object\n */\nfunction merge(dst, src, ifNotSet) { // used by converters\n    for (var keys = Object.keys(src), i = 0; i < keys.length; ++i)\n        if (dst[keys[i]] === undefined || !ifNotSet)\n            dst[keys[i]] = src[keys[i]];\n    return dst;\n}\n\nutil.merge = merge;\n\n/**\n * Converts the first character of a string to lower case.\n * @param {string} str String to convert\n * @returns {string} Converted string\n */\nutil.lcFirst = function lcFirst(str) {\n    return str.charAt(0).toLowerCase() + str.substring(1);\n};\n\n/**\n * Creates a custom error constructor.\n * @memberof util\n * @param {string} name Error name\n * @returns {Constructor<Error>} Custom error constructor\n */\nfunction newError(name) {\n\n    function CustomError(message, properties) {\n\n        if (!(this instanceof CustomError))\n            return new CustomError(message, properties);\n\n        // Error.call(this, message);\n        // ^ just returns a new error instance because the ctor can be called as a function\n\n        Object.defineProperty(this, \"message\", { get: function() { return message; } });\n\n        /* istanbul ignore next */\n        if (Error.captureStackTrace) // node\n            Error.captureStackTrace(this, CustomError);\n        else\n            Object.defineProperty(this, \"stack\", { value: new Error().stack || \"\" });\n\n        if (properties)\n            merge(this, properties);\n    }\n\n    CustomError.prototype = Object.create(Error.prototype, {\n        constructor: {\n            value: CustomError,\n            writable: true,\n            enumerable: false,\n            configurable: true,\n        },\n        name: {\n            get: function get() { return name; },\n            set: undefined,\n            enumerable: false,\n            // configurable: false would accurately preserve the behavior of\n            // the original, but I'm guessing that was not intentional.\n            // For an actual error subclass, this property would\n            // be configurable.\n            configurable: true,\n        },\n        toString: {\n            value: function value() { return this.name + \": \" + this.message; },\n            writable: true,\n            enumerable: false,\n            configurable: true,\n        },\n    });\n\n    return CustomError;\n}\n\nutil.newError = newError;\n\n/**\n * Constructs a new protocol error.\n * @classdesc Error subclass indicating a protocol specifc error.\n * @memberof util\n * @extends Error\n * @template T extends Message<T>\n * @constructor\n * @param {string} message Error message\n * @param {Object.<string,*>} [properties] Additional properties\n * @example\n * try {\n *     MyMessage.decode(someBuffer); // throws if required fields are missing\n * } catch (e) {\n *     if (e instanceof ProtocolError && e.instance)\n *         console.log(\"decoded so far: \" + JSON.stringify(e.instance));\n * }\n */\nutil.ProtocolError = newError(\"ProtocolError\");\n\n/**\n * So far decoded message instance.\n * @name util.ProtocolError#instance\n * @type {Message<T>}\n */\n\n/**\n * A OneOf getter as returned by {@link util.oneOfGetter}.\n * @typedef OneOfGetter\n * @type {function}\n * @returns {string|undefined} Set field name, if any\n */\n\n/**\n * Builds a getter for a oneof's present field name.\n * @param {string[]} fieldNames Field names\n * @returns {OneOfGetter} Unbound getter\n */\nutil.oneOfGetter = function getOneOf(fieldNames) {\n    var fieldMap = {};\n    for (var i = 0; i < fieldNames.length; ++i)\n        fieldMap[fieldNames[i]] = 1;\n\n    /**\n     * @returns {string|undefined} Set field name, if any\n     * @this Object\n     * @ignore\n     */\n    return function() { // eslint-disable-line consistent-return\n        for (var keys = Object.keys(this), i = keys.length - 1; i > -1; --i)\n            if (fieldMap[keys[i]] === 1 && this[keys[i]] !== undefined && this[keys[i]] !== null)\n                return keys[i];\n    };\n};\n\n/**\n * A OneOf setter as returned by {@link util.oneOfSetter}.\n * @typedef OneOfSetter\n * @type {function}\n * @param {string|undefined} value Field name\n * @returns {undefined}\n */\n\n/**\n * Builds a setter for a oneof's present field name.\n * @param {string[]} fieldNames Field names\n * @returns {OneOfSetter} Unbound setter\n */\nutil.oneOfSetter = function setOneOf(fieldNames) {\n\n    /**\n     * @param {string} name Field name\n     * @returns {undefined}\n     * @this Object\n     * @ignore\n     */\n    return function(name) {\n        for (var i = 0; i < fieldNames.length; ++i)\n            if (fieldNames[i] !== name)\n                delete this[fieldNames[i]];\n    };\n};\n\n/**\n * Default conversion options used for {@link Message#toJSON} implementations.\n *\n * These options are close to proto3's JSON mapping with the exception that internal types like Any are handled just like messages. More precisely:\n *\n * - Longs become strings\n * - Enums become string keys\n * - Bytes become base64 encoded strings\n * - (Sub-)Messages become plain objects\n * - Maps become plain objects with all string keys\n * - Repeated fields become arrays\n * - NaN and Infinity for float and double fields become strings\n *\n * @type {IConversionOptions}\n * @see https://developers.google.com/protocol-buffers/docs/proto3?hl=en#json\n */\nutil.toJSONOptions = {\n    longs: String,\n    enums: String,\n    bytes: String,\n    json: true\n};\n\n// Sets up buffer utility according to the environment (called in index-minimal)\nutil._configure = function() {\n    var Buffer = util.Buffer;\n    /* istanbul ignore if */\n    if (!Buffer) {\n        util._Buffer_from = util._Buffer_allocUnsafe = null;\n        return;\n    }\n    // because node 4.x buffers are incompatible & immutable\n    // see: https://github.com/dcodeIO/protobuf.js/pull/665\n    util._Buffer_from = Buffer.from !== Uint8Array.from && Buffer.from ||\n        /* istanbul ignore next */\n        function Buffer_from(value, encoding) {\n            return new Buffer(value, encoding);\n        };\n    util._Buffer_allocUnsafe = Buffer.allocUnsafe ||\n        /* istanbul ignore next */\n        function Buffer_allocUnsafe(size) {\n            return new Buffer(size);\n        };\n};\n","\"use strict\";\nmodule.exports = Writer;\n\nvar util      = require(\"./util/minimal\");\n\nvar BufferWriter; // cyclic\n\nvar LongBits  = util.LongBits,\n    base64    = util.base64,\n    utf8      = util.utf8;\n\n/**\n * Constructs a new writer operation instance.\n * @classdesc Scheduled writer operation.\n * @constructor\n * @param {function(*, Uint8Array, number)} fn Function to call\n * @param {number} len Value byte length\n * @param {*} val Value to write\n * @ignore\n */\nfunction Op(fn, len, val) {\n\n    /**\n     * Function to call.\n     * @type {function(Uint8Array, number, *)}\n     */\n    this.fn = fn;\n\n    /**\n     * Value byte length.\n     * @type {number}\n     */\n    this.len = len;\n\n    /**\n     * Next operation.\n     * @type {Writer.Op|undefined}\n     */\n    this.next = undefined;\n\n    /**\n     * Value to write.\n     * @type {*}\n     */\n    this.val = val; // type varies\n}\n\n/* istanbul ignore next */\nfunction noop() {} // eslint-disable-line no-empty-function\n\n/**\n * Constructs a new writer state instance.\n * @classdesc Copied writer state.\n * @memberof Writer\n * @constructor\n * @param {Writer} writer Writer to copy state from\n * @ignore\n */\nfunction State(writer) {\n\n    /**\n     * Current head.\n     * @type {Writer.Op}\n     */\n    this.head = writer.head;\n\n    /**\n     * Current tail.\n     * @type {Writer.Op}\n     */\n    this.tail = writer.tail;\n\n    /**\n     * Current buffer length.\n     * @type {number}\n     */\n    this.len = writer.len;\n\n    /**\n     * Next state.\n     * @type {State|null}\n     */\n    this.next = writer.states;\n}\n\n/**\n * Constructs a new writer instance.\n * @classdesc Wire format writer using `Uint8Array` if available, otherwise `Array`.\n * @constructor\n */\nfunction Writer() {\n\n    /**\n     * Current length.\n     * @type {number}\n     */\n    this.len = 0;\n\n    /**\n     * Operations head.\n     * @type {Object}\n     */\n    this.head = new Op(noop, 0, 0);\n\n    /**\n     * Operations tail\n     * @type {Object}\n     */\n    this.tail = this.head;\n\n    /**\n     * Linked forked states.\n     * @type {Object|null}\n     */\n    this.states = null;\n\n    // When a value is written, the writer calculates its byte length and puts it into a linked\n    // list of operations to perform when finish() is called. This both allows us to allocate\n    // buffers of the exact required size and reduces the amount of work we have to do compared\n    // to first calculating over objects and then encoding over objects. In our case, the encoding\n    // part is just a linked list walk calling operations with already prepared values.\n}\n\nvar create = function create() {\n    return util.Buffer\n        ? function create_buffer_setup() {\n            return (Writer.create = function create_buffer() {\n                return new BufferWriter();\n            })();\n        }\n        /* istanbul ignore next */\n        : function create_array() {\n            return new Writer();\n        };\n};\n\n/**\n * Creates a new writer.\n * @function\n * @returns {BufferWriter|Writer} A {@link BufferWriter} when Buffers are supported, otherwise a {@link Writer}\n */\nWriter.create = create();\n\n/**\n * Allocates a buffer of the specified size.\n * @param {number} size Buffer size\n * @returns {Uint8Array} Buffer\n */\nWriter.alloc = function alloc(size) {\n    return new util.Array(size);\n};\n\n// Use Uint8Array buffer pool in the browser, just like node does with buffers\n/* istanbul ignore else */\nif (util.Array !== Array)\n    Writer.alloc = util.pool(Writer.alloc, util.Array.prototype.subarray);\n\n/**\n * Pushes a new operation to the queue.\n * @param {function(Uint8Array, number, *)} fn Function to call\n * @param {number} len Value byte length\n * @param {number} val Value to write\n * @returns {Writer} `this`\n * @private\n */\nWriter.prototype._push = function push(fn, len, val) {\n    this.tail = this.tail.next = new Op(fn, len, val);\n    this.len += len;\n    return this;\n};\n\nfunction writeByte(val, buf, pos) {\n    buf[pos] = val & 255;\n}\n\nfunction writeVarint32(val, buf, pos) {\n    while (val > 127) {\n        buf[pos++] = val & 127 | 128;\n        val >>>= 7;\n    }\n    buf[pos] = val;\n}\n\n/**\n * Constructs a new varint writer operation instance.\n * @classdesc Scheduled varint writer operation.\n * @extends Op\n * @constructor\n * @param {number} len Value byte length\n * @param {number} val Value to write\n * @ignore\n */\nfunction VarintOp(len, val) {\n    this.len = len;\n    this.next = undefined;\n    this.val = val;\n}\n\nVarintOp.prototype = Object.create(Op.prototype);\nVarintOp.prototype.fn = writeVarint32;\n\n/**\n * Writes an unsigned 32 bit value as a varint.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.uint32 = function write_uint32(value) {\n    // here, the call to this.push has been inlined and a varint specific Op subclass is used.\n    // uint32 is by far the most frequently used operation and benefits significantly from this.\n    this.len += (this.tail = this.tail.next = new VarintOp(\n        (value = value >>> 0)\n                < 128       ? 1\n        : value < 16384     ? 2\n        : value < 2097152   ? 3\n        : value < 268435456 ? 4\n        :                     5,\n    value)).len;\n    return this;\n};\n\n/**\n * Writes a signed 32 bit value as a varint.\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.int32 = function write_int32(value) {\n    return value < 0\n        ? this._push(writeVarint64, 10, LongBits.fromNumber(value)) // 10 bytes per spec\n        : this.uint32(value);\n};\n\n/**\n * Writes a 32 bit value as a varint, zig-zag encoded.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.sint32 = function write_sint32(value) {\n    return this.uint32((value << 1 ^ value >> 31) >>> 0);\n};\n\nfunction writeVarint64(val, buf, pos) {\n    while (val.hi) {\n        buf[pos++] = val.lo & 127 | 128;\n        val.lo = (val.lo >>> 7 | val.hi << 25) >>> 0;\n        val.hi >>>= 7;\n    }\n    while (val.lo > 127) {\n        buf[pos++] = val.lo & 127 | 128;\n        val.lo = val.lo >>> 7;\n    }\n    buf[pos++] = val.lo;\n}\n\n/**\n * Writes an unsigned 64 bit value as a varint.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.uint64 = function write_uint64(value) {\n    var bits = LongBits.from(value);\n    return this._push(writeVarint64, bits.length(), bits);\n};\n\n/**\n * Writes a signed 64 bit value as a varint.\n * @function\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.int64 = Writer.prototype.uint64;\n\n/**\n * Writes a signed 64 bit value as a varint, zig-zag encoded.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.sint64 = function write_sint64(value) {\n    var bits = LongBits.from(value).zzEncode();\n    return this._push(writeVarint64, bits.length(), bits);\n};\n\n/**\n * Writes a boolish value as a varint.\n * @param {boolean} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.bool = function write_bool(value) {\n    return this._push(writeByte, 1, value ? 1 : 0);\n};\n\nfunction writeFixed32(val, buf, pos) {\n    buf[pos    ] =  val         & 255;\n    buf[pos + 1] =  val >>> 8   & 255;\n    buf[pos + 2] =  val >>> 16  & 255;\n    buf[pos + 3] =  val >>> 24;\n}\n\n/**\n * Writes an unsigned 32 bit value as fixed 32 bits.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.fixed32 = function write_fixed32(value) {\n    return this._push(writeFixed32, 4, value >>> 0);\n};\n\n/**\n * Writes a signed 32 bit value as fixed 32 bits.\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.sfixed32 = Writer.prototype.fixed32;\n\n/**\n * Writes an unsigned 64 bit value as fixed 64 bits.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.fixed64 = function write_fixed64(value) {\n    var bits = LongBits.from(value);\n    return this._push(writeFixed32, 4, bits.lo)._push(writeFixed32, 4, bits.hi);\n};\n\n/**\n * Writes a signed 64 bit value as fixed 64 bits.\n * @function\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.sfixed64 = Writer.prototype.fixed64;\n\n/**\n * Writes a float (32 bit).\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.float = function write_float(value) {\n    return this._push(util.float.writeFloatLE, 4, value);\n};\n\n/**\n * Writes a double (64 bit float).\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.double = function write_double(value) {\n    return this._push(util.float.writeDoubleLE, 8, value);\n};\n\nvar writeBytes = util.Array.prototype.set\n    ? function writeBytes_set(val, buf, pos) {\n        buf.set(val, pos); // also works for plain array values\n    }\n    /* istanbul ignore next */\n    : function writeBytes_for(val, buf, pos) {\n        for (var i = 0; i < val.length; ++i)\n            buf[pos + i] = val[i];\n    };\n\n/**\n * Writes a sequence of bytes.\n * @param {Uint8Array|string} value Buffer or base64 encoded string to write\n * @returns {Writer} `this`\n */\nWriter.prototype.bytes = function write_bytes(value) {\n    var len = value.length >>> 0;\n    if (!len)\n        return this._push(writeByte, 1, 0);\n    if (util.isString(value)) {\n        var buf = Writer.alloc(len = base64.length(value));\n        base64.decode(value, buf, 0);\n        value = buf;\n    }\n    return this.uint32(len)._push(writeBytes, len, value);\n};\n\n/**\n * Writes a string.\n * @param {string} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.string = function write_string(value) {\n    var len = utf8.length(value);\n    return len\n        ? this.uint32(len)._push(utf8.write, len, value)\n        : this._push(writeByte, 1, 0);\n};\n\n/**\n * Forks this writer's state by pushing it to a stack.\n * Calling {@link Writer#reset|reset} or {@link Writer#ldelim|ldelim} resets the writer to the previous state.\n * @returns {Writer} `this`\n */\nWriter.prototype.fork = function fork() {\n    this.states = new State(this);\n    this.head = this.tail = new Op(noop, 0, 0);\n    this.len = 0;\n    return this;\n};\n\n/**\n * Resets this instance to the last state.\n * @returns {Writer} `this`\n */\nWriter.prototype.reset = function reset() {\n    if (this.states) {\n        this.head   = this.states.head;\n        this.tail   = this.states.tail;\n        this.len    = this.states.len;\n        this.states = this.states.next;\n    } else {\n        this.head = this.tail = new Op(noop, 0, 0);\n        this.len  = 0;\n    }\n    return this;\n};\n\n/**\n * Resets to the last state and appends the fork state's current write length as a varint followed by its operations.\n * @returns {Writer} `this`\n */\nWriter.prototype.ldelim = function ldelim() {\n    var head = this.head,\n        tail = this.tail,\n        len  = this.len;\n    this.reset().uint32(len);\n    if (len) {\n        this.tail.next = head.next; // skip noop\n        this.tail = tail;\n        this.len += len;\n    }\n    return this;\n};\n\n/**\n * Finishes the write operation.\n * @returns {Uint8Array} Finished buffer\n */\nWriter.prototype.finish = function finish() {\n    var head = this.head.next, // skip noop\n        buf  = this.constructor.alloc(this.len),\n        pos  = 0;\n    while (head) {\n        head.fn(head.val, buf, pos);\n        pos += head.len;\n        head = head.next;\n    }\n    // this.head = this.tail = null;\n    return buf;\n};\n\nWriter._configure = function(BufferWriter_) {\n    BufferWriter = BufferWriter_;\n    Writer.create = create();\n    BufferWriter._configure();\n};\n","\"use strict\";\nmodule.exports = BufferWriter;\n\n// extends Writer\nvar Writer = require(\"./writer\");\n(BufferWriter.prototype = Object.create(Writer.prototype)).constructor = BufferWriter;\n\nvar util = require(\"./util/minimal\");\n\n/**\n * Constructs a new buffer writer instance.\n * @classdesc Wire format writer using node buffers.\n * @extends Writer\n * @constructor\n */\nfunction BufferWriter() {\n    Writer.call(this);\n}\n\nBufferWriter._configure = function () {\n    /**\n     * Allocates a buffer of the specified size.\n     * @function\n     * @param {number} size Buffer size\n     * @returns {Buffer} Buffer\n     */\n    BufferWriter.alloc = util._Buffer_allocUnsafe;\n\n    BufferWriter.writeBytesBuffer = util.Buffer && util.Buffer.prototype instanceof Uint8Array && util.Buffer.prototype.set.name === \"set\"\n        ? function writeBytesBuffer_set(val, buf, pos) {\n          buf.set(val, pos); // faster than copy (requires node >= 4 where Buffers extend Uint8Array and set is properly inherited)\n          // also works for plain array values\n        }\n        /* istanbul ignore next */\n        : function writeBytesBuffer_copy(val, buf, pos) {\n          if (val.copy) // Buffer values\n            val.copy(buf, pos, 0, val.length);\n          else for (var i = 0; i < val.length;) // plain array values\n            buf[pos++] = val[i++];\n        };\n};\n\n\n/**\n * @override\n */\nBufferWriter.prototype.bytes = function write_bytes_buffer(value) {\n    if (util.isString(value))\n        value = util._Buffer_from(value, \"base64\");\n    var len = value.length >>> 0;\n    this.uint32(len);\n    if (len)\n        this._push(BufferWriter.writeBytesBuffer, len, value);\n    return this;\n};\n\nfunction writeStringBuffer(val, buf, pos) {\n    if (val.length < 40) // plain js is faster for short strings (probably due to redundant assertions)\n        util.utf8.write(val, buf, pos);\n    else if (buf.utf8Write)\n        buf.utf8Write(val, pos);\n    else\n        buf.write(val, pos);\n}\n\n/**\n * @override\n */\nBufferWriter.prototype.string = function write_string_buffer(value) {\n    var len = util.Buffer.byteLength(value);\n    this.uint32(len);\n    if (len)\n        this._push(writeStringBuffer, len, value);\n    return this;\n};\n\n\n/**\n * Finishes the write operation.\n * @name BufferWriter#finish\n * @function\n * @returns {Buffer} Finished buffer\n */\n\nBufferWriter._configure();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toUtf8 = exports.fromUtf8 = exports.toRfc3339 = exports.fromRfc3339 = exports.toHex = exports.fromHex = exports.toBech32 = exports.normalizeBech32 = exports.fromBech32 = exports.Bech32 = exports.toBase64 = exports.fromBase64 = exports.toAscii = exports.fromAscii = void 0;\nvar ascii_1 = require(\"./ascii\");\nObject.defineProperty(exports, \"fromAscii\", { enumerable: true, get: function () { return ascii_1.fromAscii; } });\nObject.defineProperty(exports, \"toAscii\", { enumerable: true, get: function () { return ascii_1.toAscii; } });\nvar base64_1 = require(\"./base64\");\nObject.defineProperty(exports, \"fromBase64\", { enumerable: true, get: function () { return base64_1.fromBase64; } });\nObject.defineProperty(exports, \"toBase64\", { enumerable: true, get: function () { return base64_1.toBase64; } });\nvar bech32_1 = require(\"./bech32\");\nObject.defineProperty(exports, \"Bech32\", { enumerable: true, get: function () { return bech32_1.Bech32; } });\nObject.defineProperty(exports, \"fromBech32\", { enumerable: true, get: function () { return bech32_1.fromBech32; } });\nObject.defineProperty(exports, \"normalizeBech32\", { enumerable: true, get: function () { return bech32_1.normalizeBech32; } });\nObject.defineProperty(exports, \"toBech32\", { enumerable: true, get: function () { return bech32_1.toBech32; } });\nvar hex_1 = require(\"./hex\");\nObject.defineProperty(exports, \"fromHex\", { enumerable: true, get: function () { return hex_1.fromHex; } });\nObject.defineProperty(exports, \"toHex\", { enumerable: true, get: function () { return hex_1.toHex; } });\nvar rfc3339_1 = require(\"./rfc3339\");\nObject.defineProperty(exports, \"fromRfc3339\", { enumerable: true, get: function () { return rfc3339_1.fromRfc3339; } });\nObject.defineProperty(exports, \"toRfc3339\", { enumerable: true, get: function () { return rfc3339_1.toRfc3339; } });\nvar utf8_1 = require(\"./utf8\");\nObject.defineProperty(exports, \"fromUtf8\", { enumerable: true, get: function () { return utf8_1.fromUtf8; } });\nObject.defineProperty(exports, \"toUtf8\", { enumerable: true, get: function () { return utf8_1.toUtf8; } });\n//# sourceMappingURL=index.js.map","'use strict'\n\nconst { fromCallback } = require('catering')\nconst ModuleError = require('module-error')\nconst { getCallback, getOptions } = require('./lib/common')\n\nconst kPromise = Symbol('promise')\nconst kStatus = Symbol('status')\nconst kOperations = Symbol('operations')\nconst kFinishClose = Symbol('finishClose')\nconst kCloseCallbacks = Symbol('closeCallbacks')\n\nclass AbstractChainedBatch {\n  constructor (db) {\n    if (typeof db !== 'object' || db === null) {\n      const hint = db === null ? 'null' : typeof db\n      throw new TypeError(`The first argument must be an abstract-level database, received ${hint}`)\n    }\n\n    this[kOperations] = []\n    this[kCloseCallbacks] = []\n    this[kStatus] = 'open'\n    this[kFinishClose] = this[kFinishClose].bind(this)\n\n    this.db = db\n    this.db.attachResource(this)\n    this.nextTick = db.nextTick\n  }\n\n  get length () {\n    return this[kOperations].length\n  }\n\n  put (key, value, options) {\n    if (this[kStatus] !== 'open') {\n      throw new ModuleError('Batch is not open: cannot call put() after write() or close()', {\n        code: 'LEVEL_BATCH_NOT_OPEN'\n      })\n    }\n\n    const err = this.db._checkKey(key) || this.db._checkValue(value)\n    if (err) throw err\n\n    const db = options && options.sublevel != null ? options.sublevel : this.db\n    const original = options\n    const keyEncoding = db.keyEncoding(options && options.keyEncoding)\n    const valueEncoding = db.valueEncoding(options && options.valueEncoding)\n    const keyFormat = keyEncoding.format\n\n    // Forward encoding options\n    options = { ...options, keyEncoding: keyFormat, valueEncoding: valueEncoding.format }\n\n    // Prevent double prefixing\n    if (db !== this.db) {\n      options.sublevel = null\n    }\n\n    const mappedKey = db.prefixKey(keyEncoding.encode(key), keyFormat)\n    const mappedValue = valueEncoding.encode(value)\n\n    this._put(mappedKey, mappedValue, options)\n    this[kOperations].push({ ...original, type: 'put', key, value })\n\n    return this\n  }\n\n  _put (key, value, options) {}\n\n  del (key, options) {\n    if (this[kStatus] !== 'open') {\n      throw new ModuleError('Batch is not open: cannot call del() after write() or close()', {\n        code: 'LEVEL_BATCH_NOT_OPEN'\n      })\n    }\n\n    const err = this.db._checkKey(key)\n    if (err) throw err\n\n    const db = options && options.sublevel != null ? options.sublevel : this.db\n    const original = options\n    const keyEncoding = db.keyEncoding(options && options.keyEncoding)\n    const keyFormat = keyEncoding.format\n\n    // Forward encoding options\n    options = { ...options, keyEncoding: keyFormat }\n\n    // Prevent double prefixing\n    if (db !== this.db) {\n      options.sublevel = null\n    }\n\n    this._del(db.prefixKey(keyEncoding.encode(key), keyFormat), options)\n    this[kOperations].push({ ...original, type: 'del', key })\n\n    return this\n  }\n\n  _del (key, options) {}\n\n  clear () {\n    if (this[kStatus] !== 'open') {\n      throw new ModuleError('Batch is not open: cannot call clear() after write() or close()', {\n        code: 'LEVEL_BATCH_NOT_OPEN'\n      })\n    }\n\n    this._clear()\n    this[kOperations] = []\n\n    return this\n  }\n\n  _clear () {}\n\n  write (options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options)\n\n    if (this[kStatus] !== 'open') {\n      this.nextTick(callback, new ModuleError('Batch is not open: cannot call write() after write() or close()', {\n        code: 'LEVEL_BATCH_NOT_OPEN'\n      }))\n    } else if (this.length === 0) {\n      this.close(callback)\n    } else {\n      this[kStatus] = 'writing'\n      this._write(options, (err) => {\n        this[kStatus] = 'closing'\n        this[kCloseCallbacks].push(() => callback(err))\n\n        // Emit after setting 'closing' status, because event may trigger a\n        // db close which in turn triggers (idempotently) closing this batch.\n        if (!err) this.db.emit('batch', this[kOperations])\n\n        this._close(this[kFinishClose])\n      })\n    }\n\n    return callback[kPromise]\n  }\n\n  _write (options, callback) {}\n\n  close (callback) {\n    callback = fromCallback(callback, kPromise)\n\n    if (this[kStatus] === 'closing') {\n      this[kCloseCallbacks].push(callback)\n    } else if (this[kStatus] === 'closed') {\n      this.nextTick(callback)\n    } else {\n      this[kCloseCallbacks].push(callback)\n\n      if (this[kStatus] !== 'writing') {\n        this[kStatus] = 'closing'\n        this._close(this[kFinishClose])\n      }\n    }\n\n    return callback[kPromise]\n  }\n\n  _close (callback) {\n    this.nextTick(callback)\n  }\n\n  [kFinishClose] () {\n    this[kStatus] = 'closed'\n    this.db.detachResource(this)\n\n    const callbacks = this[kCloseCallbacks]\n    this[kCloseCallbacks] = []\n\n    for (const cb of callbacks) {\n      cb()\n    }\n  }\n}\n\nexports.AbstractChainedBatch = AbstractChainedBatch\n","'use strict'\n\nconst { fromCallback } = require('catering')\nconst ModuleError = require('module-error')\nconst { getOptions, getCallback } = require('./lib/common')\n\nconst kPromise = Symbol('promise')\nconst kCallback = Symbol('callback')\nconst kWorking = Symbol('working')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\nconst kAutoClose = Symbol('autoClose')\nconst kFinishWork = Symbol('finishWork')\nconst kReturnMany = Symbol('returnMany')\nconst kClosing = Symbol('closing')\nconst kHandleClose = Symbol('handleClose')\nconst kClosed = Symbol('closed')\nconst kCloseCallbacks = Symbol('closeCallbacks')\nconst kKeyEncoding = Symbol('keyEncoding')\nconst kValueEncoding = Symbol('valueEncoding')\nconst kAbortOnClose = Symbol('abortOnClose')\nconst kLegacy = Symbol('legacy')\nconst kKeys = Symbol('keys')\nconst kValues = Symbol('values')\nconst kLimit = Symbol('limit')\nconst kCount = Symbol('count')\n\nconst emptyOptions = Object.freeze({})\nconst noop = () => {}\nlet warnedEnd = false\n\n// This class is an internal utility for common functionality between AbstractIterator,\n// AbstractKeyIterator and AbstractValueIterator. It's not exported.\nclass CommonIterator {\n  constructor (db, options, legacy) {\n    if (typeof db !== 'object' || db === null) {\n      const hint = db === null ? 'null' : typeof db\n      throw new TypeError(`The first argument must be an abstract-level database, received ${hint}`)\n    }\n\n    if (typeof options !== 'object' || options === null) {\n      throw new TypeError('The second argument must be an options object')\n    }\n\n    this[kClosed] = false\n    this[kCloseCallbacks] = []\n    this[kWorking] = false\n    this[kClosing] = false\n    this[kAutoClose] = false\n    this[kCallback] = null\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kHandleClose] = this[kHandleClose].bind(this)\n    this[kKeyEncoding] = options[kKeyEncoding]\n    this[kValueEncoding] = options[kValueEncoding]\n    this[kLegacy] = legacy\n    this[kLimit] = Number.isInteger(options.limit) && options.limit >= 0 ? options.limit : Infinity\n    this[kCount] = 0\n\n    // Undocumented option to abort pending work on close(). Used by the\n    // many-level module as a temporary solution to a blocked close().\n    // TODO (next major): consider making this the default behavior. Native\n    // implementations should have their own logic to safely close iterators.\n    this[kAbortOnClose] = !!options.abortOnClose\n\n    this.db = db\n    this.db.attachResource(this)\n    this.nextTick = db.nextTick\n  }\n\n  get count () {\n    return this[kCount]\n  }\n\n  get limit () {\n    return this[kLimit]\n  }\n\n  next (callback) {\n    let promise\n\n    if (callback === undefined) {\n      promise = new Promise((resolve, reject) => {\n        callback = (err, key, value) => {\n          if (err) reject(err)\n          else if (!this[kLegacy]) resolve(key)\n          else if (key === undefined && value === undefined) resolve()\n          else resolve([key, value])\n        }\n      })\n    } else if (typeof callback !== 'function') {\n      throw new TypeError('Callback must be a function')\n    }\n\n    if (this[kClosing]) {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call next() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    } else if (this[kWorking]) {\n      this.nextTick(callback, new ModuleError('Iterator is busy: cannot call next() until previous call has completed', {\n        code: 'LEVEL_ITERATOR_BUSY'\n      }))\n    } else {\n      this[kWorking] = true\n      this[kCallback] = callback\n\n      if (this[kCount] >= this[kLimit]) this.nextTick(this[kHandleOne], null)\n      else this._next(this[kHandleOne])\n    }\n\n    return promise\n  }\n\n  _next (callback) {\n    this.nextTick(callback)\n  }\n\n  nextv (size, options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, emptyOptions)\n\n    if (!Number.isInteger(size)) {\n      this.nextTick(callback, new TypeError(\"The first argument 'size' must be an integer\"))\n      return callback[kPromise]\n    }\n\n    if (this[kClosing]) {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call nextv() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    } else if (this[kWorking]) {\n      this.nextTick(callback, new ModuleError('Iterator is busy: cannot call nextv() until previous call has completed', {\n        code: 'LEVEL_ITERATOR_BUSY'\n      }))\n    } else {\n      if (size < 1) size = 1\n      if (this[kLimit] < Infinity) size = Math.min(size, this[kLimit] - this[kCount])\n\n      this[kWorking] = true\n      this[kCallback] = callback\n\n      if (size <= 0) this.nextTick(this[kHandleMany], null, [])\n      else this._nextv(size, options, this[kHandleMany])\n    }\n\n    return callback[kPromise]\n  }\n\n  _nextv (size, options, callback) {\n    const acc = []\n    const onnext = (err, key, value) => {\n      if (err) {\n        return callback(err)\n      } else if (this[kLegacy] ? key === undefined && value === undefined : key === undefined) {\n        return callback(null, acc)\n      }\n\n      acc.push(this[kLegacy] ? [key, value] : key)\n\n      if (acc.length === size) {\n        callback(null, acc)\n      } else {\n        this._next(onnext)\n      }\n    }\n\n    this._next(onnext)\n  }\n\n  all (options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, emptyOptions)\n\n    if (this[kClosing]) {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call all() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    } else if (this[kWorking]) {\n      this.nextTick(callback, new ModuleError('Iterator is busy: cannot call all() until previous call has completed', {\n        code: 'LEVEL_ITERATOR_BUSY'\n      }))\n    } else {\n      this[kWorking] = true\n      this[kCallback] = callback\n      this[kAutoClose] = true\n\n      if (this[kCount] >= this[kLimit]) this.nextTick(this[kHandleMany], null, [])\n      else this._all(options, this[kHandleMany])\n    }\n\n    return callback[kPromise]\n  }\n\n  _all (options, callback) {\n    // Must count here because we're directly calling _nextv()\n    let count = this[kCount]\n    const acc = []\n\n    const nextv = () => {\n      // Not configurable, because implementations should optimize _all().\n      const size = this[kLimit] < Infinity ? Math.min(1e3, this[kLimit] - count) : 1e3\n\n      if (size <= 0) {\n        this.nextTick(callback, null, acc)\n      } else {\n        this._nextv(size, emptyOptions, onnextv)\n      }\n    }\n\n    const onnextv = (err, items) => {\n      if (err) {\n        callback(err)\n      } else if (items.length === 0) {\n        callback(null, acc)\n      } else {\n        acc.push.apply(acc, items)\n        count += items.length\n        nextv()\n      }\n    }\n\n    nextv()\n  }\n\n  [kFinishWork] () {\n    const cb = this[kCallback]\n\n    // Callback will be null if work was aborted on close\n    if (this[kAbortOnClose] && cb === null) return noop\n\n    this[kWorking] = false\n    this[kCallback] = null\n\n    if (this[kClosing]) this._close(this[kHandleClose])\n\n    return cb\n  }\n\n  [kReturnMany] (cb, err, items) {\n    if (this[kAutoClose]) {\n      this.close(cb.bind(null, err, items))\n    } else {\n      cb(err, items)\n    }\n  }\n\n  seek (target, options) {\n    options = getOptions(options, emptyOptions)\n\n    if (this[kClosing]) {\n      // Don't throw here, to be kind to implementations that wrap\n      // another db and don't necessarily control when the db is closed\n    } else if (this[kWorking]) {\n      throw new ModuleError('Iterator is busy: cannot call seek() until next() has completed', {\n        code: 'LEVEL_ITERATOR_BUSY'\n      })\n    } else {\n      const keyEncoding = this.db.keyEncoding(options.keyEncoding || this[kKeyEncoding])\n      const keyFormat = keyEncoding.format\n\n      if (options.keyEncoding !== keyFormat) {\n        options = { ...options, keyEncoding: keyFormat }\n      }\n\n      const mapped = this.db.prefixKey(keyEncoding.encode(target), keyFormat)\n      this._seek(mapped, options)\n    }\n  }\n\n  _seek (target, options) {\n    throw new ModuleError('Iterator does not support seek()', {\n      code: 'LEVEL_NOT_SUPPORTED'\n    })\n  }\n\n  close (callback) {\n    callback = fromCallback(callback, kPromise)\n\n    if (this[kClosed]) {\n      this.nextTick(callback)\n    } else if (this[kClosing]) {\n      this[kCloseCallbacks].push(callback)\n    } else {\n      this[kClosing] = true\n      this[kCloseCallbacks].push(callback)\n\n      if (!this[kWorking]) {\n        this._close(this[kHandleClose])\n      } else if (this[kAbortOnClose]) {\n        // Don't wait for work to finish. Subsequently ignore the result.\n        const cb = this[kFinishWork]()\n\n        cb(new ModuleError('Aborted on iterator close()', {\n          code: 'LEVEL_ITERATOR_NOT_OPEN'\n        }))\n      }\n    }\n\n    return callback[kPromise]\n  }\n\n  _close (callback) {\n    this.nextTick(callback)\n  }\n\n  [kHandleClose] () {\n    this[kClosed] = true\n    this.db.detachResource(this)\n\n    const callbacks = this[kCloseCallbacks]\n    this[kCloseCallbacks] = []\n\n    for (const cb of callbacks) {\n      cb()\n    }\n  }\n\n  async * [Symbol.asyncIterator] () {\n    try {\n      let item\n\n      while ((item = (await this.next())) !== undefined) {\n        yield item\n      }\n    } finally {\n      if (!this[kClosed]) await this.close()\n    }\n  }\n}\n\n// For backwards compatibility this class is not (yet) called AbstractEntryIterator.\nclass AbstractIterator extends CommonIterator {\n  constructor (db, options) {\n    super(db, options, true)\n    this[kKeys] = options.keys !== false\n    this[kValues] = options.values !== false\n  }\n\n  [kHandleOne] (err, key, value) {\n    const cb = this[kFinishWork]()\n    if (err) return cb(err)\n\n    try {\n      key = this[kKeys] && key !== undefined ? this[kKeyEncoding].decode(key) : undefined\n      value = this[kValues] && value !== undefined ? this[kValueEncoding].decode(value) : undefined\n    } catch (err) {\n      return cb(new IteratorDecodeError('entry', err))\n    }\n\n    if (!(key === undefined && value === undefined)) {\n      this[kCount]++\n    }\n\n    cb(null, key, value)\n  }\n\n  [kHandleMany] (err, entries) {\n    const cb = this[kFinishWork]()\n    if (err) return this[kReturnMany](cb, err)\n\n    try {\n      for (const entry of entries) {\n        const key = entry[0]\n        const value = entry[1]\n\n        entry[0] = this[kKeys] && key !== undefined ? this[kKeyEncoding].decode(key) : undefined\n        entry[1] = this[kValues] && value !== undefined ? this[kValueEncoding].decode(value) : undefined\n      }\n    } catch (err) {\n      return this[kReturnMany](cb, new IteratorDecodeError('entries', err))\n    }\n\n    this[kCount] += entries.length\n    this[kReturnMany](cb, null, entries)\n  }\n\n  end (callback) {\n    if (!warnedEnd && typeof console !== 'undefined') {\n      warnedEnd = true\n      console.warn(new ModuleError(\n        'The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version',\n        { code: 'LEVEL_LEGACY' }\n      ))\n    }\n\n    return this.close(callback)\n  }\n}\n\nclass AbstractKeyIterator extends CommonIterator {\n  constructor (db, options) {\n    super(db, options, false)\n  }\n\n  [kHandleOne] (err, key) {\n    const cb = this[kFinishWork]()\n    if (err) return cb(err)\n\n    try {\n      key = key !== undefined ? this[kKeyEncoding].decode(key) : undefined\n    } catch (err) {\n      return cb(new IteratorDecodeError('key', err))\n    }\n\n    if (key !== undefined) this[kCount]++\n    cb(null, key)\n  }\n\n  [kHandleMany] (err, keys) {\n    const cb = this[kFinishWork]()\n    if (err) return this[kReturnMany](cb, err)\n\n    try {\n      for (let i = 0; i < keys.length; i++) {\n        const key = keys[i]\n        keys[i] = key !== undefined ? this[kKeyEncoding].decode(key) : undefined\n      }\n    } catch (err) {\n      return this[kReturnMany](cb, new IteratorDecodeError('keys', err))\n    }\n\n    this[kCount] += keys.length\n    this[kReturnMany](cb, null, keys)\n  }\n}\n\nclass AbstractValueIterator extends CommonIterator {\n  constructor (db, options) {\n    super(db, options, false)\n  }\n\n  [kHandleOne] (err, value) {\n    const cb = this[kFinishWork]()\n    if (err) return cb(err)\n\n    try {\n      value = value !== undefined ? this[kValueEncoding].decode(value) : undefined\n    } catch (err) {\n      return cb(new IteratorDecodeError('value', err))\n    }\n\n    if (value !== undefined) this[kCount]++\n    cb(null, value)\n  }\n\n  [kHandleMany] (err, values) {\n    const cb = this[kFinishWork]()\n    if (err) return this[kReturnMany](cb, err)\n\n    try {\n      for (let i = 0; i < values.length; i++) {\n        const value = values[i]\n        values[i] = value !== undefined ? this[kValueEncoding].decode(value) : undefined\n      }\n    } catch (err) {\n      return this[kReturnMany](cb, new IteratorDecodeError('values', err))\n    }\n\n    this[kCount] += values.length\n    this[kReturnMany](cb, null, values)\n  }\n}\n\n// Internal utility, not typed or exported\nclass IteratorDecodeError extends ModuleError {\n  constructor (subject, cause) {\n    super(`Iterator could not decode ${subject}`, {\n      code: 'LEVEL_DECODE_ERROR',\n      cause\n    })\n  }\n}\n\n// To help migrating to abstract-level\nfor (const k of ['_ended property', '_nexting property', '_end method']) {\n  Object.defineProperty(AbstractIterator.prototype, k.split(' ')[0], {\n    get () { throw new ModuleError(`The ${k} has been removed`, { code: 'LEVEL_LEGACY' }) },\n    set () { throw new ModuleError(`The ${k} has been removed`, { code: 'LEVEL_LEGACY' }) }\n  })\n}\n\n// Exposed so that AbstractLevel can set these options\nAbstractIterator.keyEncoding = kKeyEncoding\nAbstractIterator.valueEncoding = kValueEncoding\n\nexports.AbstractIterator = AbstractIterator\nexports.AbstractKeyIterator = AbstractKeyIterator\nexports.AbstractValueIterator = AbstractValueIterator\n","'use strict'\n\nconst { supports } = require('level-supports')\nconst { Transcoder } = require('level-transcoder')\nconst { EventEmitter } = require('events')\nconst { fromCallback } = require('catering')\nconst ModuleError = require('module-error')\nconst { AbstractIterator } = require('./abstract-iterator')\nconst { DefaultKeyIterator, DefaultValueIterator } = require('./lib/default-kv-iterator')\nconst { DeferredIterator, DeferredKeyIterator, DeferredValueIterator } = require('./lib/deferred-iterator')\nconst { DefaultChainedBatch } = require('./lib/default-chained-batch')\nconst { getCallback, getOptions } = require('./lib/common')\nconst rangeOptions = require('./lib/range-options')\n\nconst kPromise = Symbol('promise')\nconst kLanded = Symbol('landed')\nconst kResources = Symbol('resources')\nconst kCloseResources = Symbol('closeResources')\nconst kOperations = Symbol('operations')\nconst kUndefer = Symbol('undefer')\nconst kDeferOpen = Symbol('deferOpen')\nconst kOptions = Symbol('options')\nconst kStatus = Symbol('status')\nconst kDefaultOptions = Symbol('defaultOptions')\nconst kTranscoder = Symbol('transcoder')\nconst kKeyEncoding = Symbol('keyEncoding')\nconst kValueEncoding = Symbol('valueEncoding')\nconst noop = () => {}\n\nclass AbstractLevel extends EventEmitter {\n  constructor (manifest, options) {\n    super()\n\n    if (typeof manifest !== 'object' || manifest === null) {\n      throw new TypeError(\"The first argument 'manifest' must be an object\")\n    }\n\n    options = getOptions(options)\n    const { keyEncoding, valueEncoding, passive, ...forward } = options\n\n    this[kResources] = new Set()\n    this[kOperations] = []\n    this[kDeferOpen] = true\n    this[kOptions] = forward\n    this[kStatus] = 'opening'\n\n    this.supports = supports(manifest, {\n      status: true,\n      promises: true,\n      clear: true,\n      getMany: true,\n      deferredOpen: true,\n\n      // TODO (next major): add seek\n      snapshots: manifest.snapshots !== false,\n      permanence: manifest.permanence !== false,\n\n      // TODO: remove from level-supports because it's always supported\n      keyIterator: true,\n      valueIterator: true,\n      iteratorNextv: true,\n      iteratorAll: true,\n\n      encodings: manifest.encodings || {},\n      events: Object.assign({}, manifest.events, {\n        opening: true,\n        open: true,\n        closing: true,\n        closed: true,\n        put: true,\n        del: true,\n        batch: true,\n        clear: true\n      })\n    })\n\n    this[kTranscoder] = new Transcoder(formats(this))\n    this[kKeyEncoding] = this[kTranscoder].encoding(keyEncoding || 'utf8')\n    this[kValueEncoding] = this[kTranscoder].encoding(valueEncoding || 'utf8')\n\n    // Add custom and transcoder encodings to manifest\n    for (const encoding of this[kTranscoder].encodings()) {\n      if (!this.supports.encodings[encoding.commonName]) {\n        this.supports.encodings[encoding.commonName] = true\n      }\n    }\n\n    this[kDefaultOptions] = {\n      empty: Object.freeze({}),\n      entry: Object.freeze({\n        keyEncoding: this[kKeyEncoding].commonName,\n        valueEncoding: this[kValueEncoding].commonName\n      }),\n      key: Object.freeze({\n        keyEncoding: this[kKeyEncoding].commonName\n      })\n    }\n\n    // Let subclass finish its constructor\n    this.nextTick(() => {\n      if (this[kDeferOpen]) {\n        this.open({ passive: false }, noop)\n      }\n    })\n  }\n\n  get status () {\n    return this[kStatus]\n  }\n\n  keyEncoding (encoding) {\n    return this[kTranscoder].encoding(encoding != null ? encoding : this[kKeyEncoding])\n  }\n\n  valueEncoding (encoding) {\n    return this[kTranscoder].encoding(encoding != null ? encoding : this[kValueEncoding])\n  }\n\n  open (options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n\n    options = { ...this[kOptions], ...getOptions(options) }\n\n    options.createIfMissing = options.createIfMissing !== false\n    options.errorIfExists = !!options.errorIfExists\n\n    const maybeOpened = (err) => {\n      if (this[kStatus] === 'closing' || this[kStatus] === 'opening') {\n        // Wait until pending state changes are done\n        this.once(kLanded, err ? () => maybeOpened(err) : maybeOpened)\n      } else if (this[kStatus] !== 'open') {\n        callback(new ModuleError('Database is not open', {\n          code: 'LEVEL_DATABASE_NOT_OPEN',\n          cause: err\n        }))\n      } else {\n        callback()\n      }\n    }\n\n    if (options.passive) {\n      if (this[kStatus] === 'opening') {\n        this.once(kLanded, maybeOpened)\n      } else {\n        this.nextTick(maybeOpened)\n      }\n    } else if (this[kStatus] === 'closed' || this[kDeferOpen]) {\n      this[kDeferOpen] = false\n      this[kStatus] = 'opening'\n      this.emit('opening')\n\n      this._open(options, (err) => {\n        if (err) {\n          this[kStatus] = 'closed'\n\n          // Resources must be safe to close in any db state\n          this[kCloseResources](() => {\n            this.emit(kLanded)\n            maybeOpened(err)\n          })\n\n          this[kUndefer]()\n          return\n        }\n\n        this[kStatus] = 'open'\n        this[kUndefer]()\n        this.emit(kLanded)\n\n        // Only emit public event if pending state changes are done\n        if (this[kStatus] === 'open') this.emit('open')\n\n        // TODO (next major): remove this alias\n        if (this[kStatus] === 'open') this.emit('ready')\n\n        maybeOpened()\n      })\n    } else if (this[kStatus] === 'open') {\n      this.nextTick(maybeOpened)\n    } else {\n      this.once(kLanded, () => this.open(options, callback))\n    }\n\n    return callback[kPromise]\n  }\n\n  _open (options, callback) {\n    this.nextTick(callback)\n  }\n\n  close (callback) {\n    callback = fromCallback(callback, kPromise)\n\n    const maybeClosed = (err) => {\n      if (this[kStatus] === 'opening' || this[kStatus] === 'closing') {\n        // Wait until pending state changes are done\n        this.once(kLanded, err ? maybeClosed(err) : maybeClosed)\n      } else if (this[kStatus] !== 'closed') {\n        callback(new ModuleError('Database is not closed', {\n          code: 'LEVEL_DATABASE_NOT_CLOSED',\n          cause: err\n        }))\n      } else {\n        callback()\n      }\n    }\n\n    if (this[kStatus] === 'open') {\n      this[kStatus] = 'closing'\n      this.emit('closing')\n\n      const cancel = (err) => {\n        this[kStatus] = 'open'\n        this[kUndefer]()\n        this.emit(kLanded)\n        maybeClosed(err)\n      }\n\n      this[kCloseResources](() => {\n        this._close((err) => {\n          if (err) return cancel(err)\n\n          this[kStatus] = 'closed'\n          this[kUndefer]()\n          this.emit(kLanded)\n\n          // Only emit public event if pending state changes are done\n          if (this[kStatus] === 'closed') this.emit('closed')\n\n          maybeClosed()\n        })\n      })\n    } else if (this[kStatus] === 'closed') {\n      this.nextTick(maybeClosed)\n    } else {\n      this.once(kLanded, () => this.close(callback))\n    }\n\n    return callback[kPromise]\n  }\n\n  [kCloseResources] (callback) {\n    if (this[kResources].size === 0) {\n      return this.nextTick(callback)\n    }\n\n    let pending = this[kResources].size\n    let sync = true\n\n    const next = () => {\n      if (--pending === 0) {\n        // We don't have tests for generic resources, so dezalgo\n        if (sync) this.nextTick(callback)\n        else callback()\n      }\n    }\n\n    // In parallel so that all resources know they are closed\n    for (const resource of this[kResources]) {\n      resource.close(next)\n    }\n\n    sync = false\n    this[kResources].clear()\n  }\n\n  _close (callback) {\n    this.nextTick(callback)\n  }\n\n  get (key, options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].entry)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.get(key, options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    const err = this._checkKey(key)\n\n    if (err) {\n      this.nextTick(callback, err)\n      return callback[kPromise]\n    }\n\n    const keyEncoding = this.keyEncoding(options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options.valueEncoding)\n    const keyFormat = keyEncoding.format\n    const valueFormat = valueEncoding.format\n\n    // Forward encoding options to the underlying store\n    if (options.keyEncoding !== keyFormat || options.valueEncoding !== valueFormat) {\n      // Avoid spread operator because of https://bugs.chromium.org/p/chromium/issues/detail?id=1204540\n      options = Object.assign({}, options, { keyEncoding: keyFormat, valueEncoding: valueFormat })\n    }\n\n    this._get(this.prefixKey(keyEncoding.encode(key), keyFormat), options, (err, value) => {\n      if (err) {\n        // Normalize not found error for backwards compatibility with abstract-leveldown and level(up)\n        if (err.code === 'LEVEL_NOT_FOUND' || err.notFound || /NotFound/i.test(err)) {\n          if (!err.code) err.code = 'LEVEL_NOT_FOUND' // Preferred way going forward\n          if (!err.notFound) err.notFound = true // Same as level-errors\n          if (!err.status) err.status = 404 // Same as level-errors\n        }\n\n        return callback(err)\n      }\n\n      try {\n        value = valueEncoding.decode(value)\n      } catch (err) {\n        return callback(new ModuleError('Could not decode value', {\n          code: 'LEVEL_DECODE_ERROR',\n          cause: err\n        }))\n      }\n\n      callback(null, value)\n    })\n\n    return callback[kPromise]\n  }\n\n  _get (key, options, callback) {\n    this.nextTick(callback, new Error('NotFound'))\n  }\n\n  getMany (keys, options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].entry)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.getMany(keys, options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    if (!Array.isArray(keys)) {\n      this.nextTick(callback, new TypeError(\"The first argument 'keys' must be an array\"))\n      return callback[kPromise]\n    }\n\n    if (keys.length === 0) {\n      this.nextTick(callback, null, [])\n      return callback[kPromise]\n    }\n\n    const keyEncoding = this.keyEncoding(options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options.valueEncoding)\n    const keyFormat = keyEncoding.format\n    const valueFormat = valueEncoding.format\n\n    // Forward encoding options\n    if (options.keyEncoding !== keyFormat || options.valueEncoding !== valueFormat) {\n      options = Object.assign({}, options, { keyEncoding: keyFormat, valueEncoding: valueFormat })\n    }\n\n    const mappedKeys = new Array(keys.length)\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      const err = this._checkKey(key)\n\n      if (err) {\n        this.nextTick(callback, err)\n        return callback[kPromise]\n      }\n\n      mappedKeys[i] = this.prefixKey(keyEncoding.encode(key), keyFormat)\n    }\n\n    this._getMany(mappedKeys, options, (err, values) => {\n      if (err) return callback(err)\n\n      try {\n        for (let i = 0; i < values.length; i++) {\n          if (values[i] !== undefined) {\n            values[i] = valueEncoding.decode(values[i])\n          }\n        }\n      } catch (err) {\n        return callback(new ModuleError(`Could not decode one or more of ${values.length} value(s)`, {\n          code: 'LEVEL_DECODE_ERROR',\n          cause: err\n        }))\n      }\n\n      callback(null, values)\n    })\n\n    return callback[kPromise]\n  }\n\n  _getMany (keys, options, callback) {\n    this.nextTick(callback, null, new Array(keys.length).fill(undefined))\n  }\n\n  put (key, value, options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].entry)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.put(key, value, options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    const err = this._checkKey(key) || this._checkValue(value)\n\n    if (err) {\n      this.nextTick(callback, err)\n      return callback[kPromise]\n    }\n\n    const keyEncoding = this.keyEncoding(options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options.valueEncoding)\n    const keyFormat = keyEncoding.format\n    const valueFormat = valueEncoding.format\n\n    // Forward encoding options\n    if (options.keyEncoding !== keyFormat || options.valueEncoding !== valueFormat) {\n      options = Object.assign({}, options, { keyEncoding: keyFormat, valueEncoding: valueFormat })\n    }\n\n    const mappedKey = this.prefixKey(keyEncoding.encode(key), keyFormat)\n    const mappedValue = valueEncoding.encode(value)\n\n    this._put(mappedKey, mappedValue, options, (err) => {\n      if (err) return callback(err)\n      this.emit('put', key, value)\n      callback()\n    })\n\n    return callback[kPromise]\n  }\n\n  _put (key, value, options, callback) {\n    this.nextTick(callback)\n  }\n\n  del (key, options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].key)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.del(key, options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    const err = this._checkKey(key)\n\n    if (err) {\n      this.nextTick(callback, err)\n      return callback[kPromise]\n    }\n\n    const keyEncoding = this.keyEncoding(options.keyEncoding)\n    const keyFormat = keyEncoding.format\n\n    // Forward encoding options\n    if (options.keyEncoding !== keyFormat) {\n      options = Object.assign({}, options, { keyEncoding: keyFormat })\n    }\n\n    this._del(this.prefixKey(keyEncoding.encode(key), keyFormat), options, (err) => {\n      if (err) return callback(err)\n      this.emit('del', key)\n      callback()\n    })\n\n    return callback[kPromise]\n  }\n\n  _del (key, options, callback) {\n    this.nextTick(callback)\n  }\n\n  batch (operations, options, callback) {\n    if (!arguments.length) {\n      if (this[kStatus] === 'opening') return new DefaultChainedBatch(this)\n      if (this[kStatus] !== 'open') {\n        throw new ModuleError('Database is not open', {\n          code: 'LEVEL_DATABASE_NOT_OPEN'\n        })\n      }\n      return this._chainedBatch()\n    }\n\n    if (typeof operations === 'function') callback = operations\n    else callback = getCallback(options, callback)\n\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].empty)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.batch(operations, options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    if (!Array.isArray(operations)) {\n      this.nextTick(callback, new TypeError(\"The first argument 'operations' must be an array\"))\n      return callback[kPromise]\n    }\n\n    if (operations.length === 0) {\n      this.nextTick(callback)\n      return callback[kPromise]\n    }\n\n    const mapped = new Array(operations.length)\n    const { keyEncoding: ke, valueEncoding: ve, ...forward } = options\n\n    for (let i = 0; i < operations.length; i++) {\n      if (typeof operations[i] !== 'object' || operations[i] === null) {\n        this.nextTick(callback, new TypeError('A batch operation must be an object'))\n        return callback[kPromise]\n      }\n\n      const op = Object.assign({}, operations[i])\n\n      if (op.type !== 'put' && op.type !== 'del') {\n        this.nextTick(callback, new TypeError(\"A batch operation must have a type property that is 'put' or 'del'\"))\n        return callback[kPromise]\n      }\n\n      const err = this._checkKey(op.key)\n\n      if (err) {\n        this.nextTick(callback, err)\n        return callback[kPromise]\n      }\n\n      const db = op.sublevel != null ? op.sublevel : this\n      const keyEncoding = db.keyEncoding(op.keyEncoding || ke)\n      const keyFormat = keyEncoding.format\n\n      op.key = db.prefixKey(keyEncoding.encode(op.key), keyFormat)\n      op.keyEncoding = keyFormat\n\n      if (op.type === 'put') {\n        const valueErr = this._checkValue(op.value)\n\n        if (valueErr) {\n          this.nextTick(callback, valueErr)\n          return callback[kPromise]\n        }\n\n        const valueEncoding = db.valueEncoding(op.valueEncoding || ve)\n\n        op.value = valueEncoding.encode(op.value)\n        op.valueEncoding = valueEncoding.format\n      }\n\n      // Prevent double prefixing\n      if (db !== this) {\n        op.sublevel = null\n      }\n\n      mapped[i] = op\n    }\n\n    this._batch(mapped, forward, (err) => {\n      if (err) return callback(err)\n      this.emit('batch', operations)\n      callback()\n    })\n\n    return callback[kPromise]\n  }\n\n  _batch (operations, options, callback) {\n    this.nextTick(callback)\n  }\n\n  sublevel (name, options) {\n    return this._sublevel(name, AbstractSublevel.defaults(options))\n  }\n\n  _sublevel (name, options) {\n    return new AbstractSublevel(this, name, options)\n  }\n\n  prefixKey (key, keyFormat) {\n    return key\n  }\n\n  clear (options, callback) {\n    callback = getCallback(options, callback)\n    callback = fromCallback(callback, kPromise)\n    options = getOptions(options, this[kDefaultOptions].empty)\n\n    if (this[kStatus] === 'opening') {\n      this.defer(() => this.clear(options, callback))\n      return callback[kPromise]\n    }\n\n    if (maybeError(this, callback)) {\n      return callback[kPromise]\n    }\n\n    const original = options\n    const keyEncoding = this.keyEncoding(options.keyEncoding)\n\n    options = rangeOptions(options, keyEncoding)\n    options.keyEncoding = keyEncoding.format\n\n    if (options.limit === 0) {\n      this.nextTick(callback)\n    } else {\n      this._clear(options, (err) => {\n        if (err) return callback(err)\n        this.emit('clear', original)\n        callback()\n      })\n    }\n\n    return callback[kPromise]\n  }\n\n  _clear (options, callback) {\n    this.nextTick(callback)\n  }\n\n  iterator (options) {\n    const keyEncoding = this.keyEncoding(options && options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options && options.valueEncoding)\n\n    options = rangeOptions(options, keyEncoding)\n    options.keys = options.keys !== false\n    options.values = options.values !== false\n\n    // We need the original encoding options in AbstractIterator in order to decode data\n    options[AbstractIterator.keyEncoding] = keyEncoding\n    options[AbstractIterator.valueEncoding] = valueEncoding\n\n    // Forward encoding options to private API\n    options.keyEncoding = keyEncoding.format\n    options.valueEncoding = valueEncoding.format\n\n    if (this[kStatus] === 'opening') {\n      return new DeferredIterator(this, options)\n    } else if (this[kStatus] !== 'open') {\n      throw new ModuleError('Database is not open', {\n        code: 'LEVEL_DATABASE_NOT_OPEN'\n      })\n    }\n\n    return this._iterator(options)\n  }\n\n  _iterator (options) {\n    return new AbstractIterator(this, options)\n  }\n\n  keys (options) {\n    // Also include valueEncoding (though unused) because we may fallback to _iterator()\n    const keyEncoding = this.keyEncoding(options && options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options && options.valueEncoding)\n\n    options = rangeOptions(options, keyEncoding)\n\n    // We need the original encoding options in AbstractKeyIterator in order to decode data\n    options[AbstractIterator.keyEncoding] = keyEncoding\n    options[AbstractIterator.valueEncoding] = valueEncoding\n\n    // Forward encoding options to private API\n    options.keyEncoding = keyEncoding.format\n    options.valueEncoding = valueEncoding.format\n\n    if (this[kStatus] === 'opening') {\n      return new DeferredKeyIterator(this, options)\n    } else if (this[kStatus] !== 'open') {\n      throw new ModuleError('Database is not open', {\n        code: 'LEVEL_DATABASE_NOT_OPEN'\n      })\n    }\n\n    return this._keys(options)\n  }\n\n  _keys (options) {\n    return new DefaultKeyIterator(this, options)\n  }\n\n  values (options) {\n    const keyEncoding = this.keyEncoding(options && options.keyEncoding)\n    const valueEncoding = this.valueEncoding(options && options.valueEncoding)\n\n    options = rangeOptions(options, keyEncoding)\n\n    // We need the original encoding options in AbstractValueIterator in order to decode data\n    options[AbstractIterator.keyEncoding] = keyEncoding\n    options[AbstractIterator.valueEncoding] = valueEncoding\n\n    // Forward encoding options to private API\n    options.keyEncoding = keyEncoding.format\n    options.valueEncoding = valueEncoding.format\n\n    if (this[kStatus] === 'opening') {\n      return new DeferredValueIterator(this, options)\n    } else if (this[kStatus] !== 'open') {\n      throw new ModuleError('Database is not open', {\n        code: 'LEVEL_DATABASE_NOT_OPEN'\n      })\n    }\n\n    return this._values(options)\n  }\n\n  _values (options) {\n    return new DefaultValueIterator(this, options)\n  }\n\n  defer (fn) {\n    if (typeof fn !== 'function') {\n      throw new TypeError('The first argument must be a function')\n    }\n\n    this[kOperations].push(fn)\n  }\n\n  [kUndefer] () {\n    if (this[kOperations].length === 0) {\n      return\n    }\n\n    const operations = this[kOperations]\n    this[kOperations] = []\n\n    for (const op of operations) {\n      op()\n    }\n  }\n\n  // TODO: docs and types\n  attachResource (resource) {\n    if (typeof resource !== 'object' || resource === null ||\n      typeof resource.close !== 'function') {\n      throw new TypeError('The first argument must be a resource object')\n    }\n\n    this[kResources].add(resource)\n  }\n\n  // TODO: docs and types\n  detachResource (resource) {\n    this[kResources].delete(resource)\n  }\n\n  _chainedBatch () {\n    return new DefaultChainedBatch(this)\n  }\n\n  _checkKey (key) {\n    if (key === null || key === undefined) {\n      return new ModuleError('Key cannot be null or undefined', {\n        code: 'LEVEL_INVALID_KEY'\n      })\n    }\n  }\n\n  _checkValue (value) {\n    if (value === null || value === undefined) {\n      return new ModuleError('Value cannot be null or undefined', {\n        code: 'LEVEL_INVALID_VALUE'\n      })\n    }\n  }\n}\n\n// Expose browser-compatible nextTick for dependents\n// TODO: after we drop node 10, also use queueMicrotask in node\nAbstractLevel.prototype.nextTick = require('./lib/next-tick')\n\nconst { AbstractSublevel } = require('./lib/abstract-sublevel')({ AbstractLevel })\n\nexports.AbstractLevel = AbstractLevel\nexports.AbstractSublevel = AbstractSublevel\n\nconst maybeError = function (db, callback) {\n  if (db[kStatus] !== 'open') {\n    db.nextTick(callback, new ModuleError('Database is not open', {\n      code: 'LEVEL_DATABASE_NOT_OPEN'\n    }))\n    return true\n  }\n\n  return false\n}\n\nconst formats = function (db) {\n  return Object.keys(db.supports.encodings)\n    .filter(k => !!db.supports.encodings[k])\n}\n","'use strict'\n\nexports.AbstractLevel = require('./abstract-level').AbstractLevel\nexports.AbstractSublevel = require('./abstract-level').AbstractSublevel\nexports.AbstractIterator = require('./abstract-iterator').AbstractIterator\nexports.AbstractKeyIterator = require('./abstract-iterator').AbstractKeyIterator\nexports.AbstractValueIterator = require('./abstract-iterator').AbstractValueIterator\nexports.AbstractChainedBatch = require('./abstract-chained-batch').AbstractChainedBatch\n","'use strict'\n\nconst { AbstractIterator, AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\n\nconst kUnfix = Symbol('unfix')\nconst kIterator = Symbol('iterator')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\nconst kCallback = Symbol('callback')\n\n// TODO: unfix natively if db supports it\nclass AbstractSublevelIterator extends AbstractIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key, value) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key, value)\n  }\n\n  [kHandleMany] (err, entries) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (const entry of entries) {\n      const key = entry[0]\n      if (key !== undefined) entry[0] = this[kUnfix](key)\n    }\n\n    callback(err, entries)\n  }\n}\n\nclass AbstractSublevelKeyIterator extends AbstractKeyIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key)\n  }\n\n  [kHandleMany] (err, keys) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      if (key !== undefined) keys[i] = this[kUnfix](key)\n    }\n\n    callback(err, keys)\n  }\n}\n\nclass AbstractSublevelValueIterator extends AbstractValueIterator {\n  constructor (db, options, iterator) {\n    super(db, options)\n    this[kIterator] = iterator\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback\n    this[kIterator].next(this[kHandleOne])\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback\n    this[kIterator].nextv(size, options, this[kHandleMany])\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback\n    this[kIterator].all(options, this[kHandleMany])\n  }\n}\n\nfor (const Iterator of [AbstractSublevelValueIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kIterator].next(callback)\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kIterator].nextv(size, options, callback)\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kIterator].all(options, callback)\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator, AbstractSublevelValueIterator]) {\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options)\n  }\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback)\n  }\n}\n\nexports.AbstractSublevelIterator = AbstractSublevelIterator\nexports.AbstractSublevelKeyIterator = AbstractSublevelKeyIterator\nexports.AbstractSublevelValueIterator = AbstractSublevelValueIterator\n","'use strict'\n\nconst ModuleError = require('module-error')\nconst { Buffer } = require('buffer') || {}\nconst {\n  AbstractSublevelIterator,\n  AbstractSublevelKeyIterator,\n  AbstractSublevelValueIterator\n} = require('./abstract-sublevel-iterator')\n\nconst kPrefix = Symbol('prefix')\nconst kUpperBound = Symbol('upperBound')\nconst kPrefixRange = Symbol('prefixRange')\nconst kParent = Symbol('parent')\nconst kUnfix = Symbol('unfix')\n\nconst textEncoder = new TextEncoder()\nconst defaults = { separator: '!' }\n\n// Wrapped to avoid circular dependency\nmodule.exports = function ({ AbstractLevel }) {\n  class AbstractSublevel extends AbstractLevel {\n    static defaults (options) {\n      // To help migrating from subleveldown to abstract-level\n      if (typeof options === 'string') {\n        throw new ModuleError('The subleveldown string shorthand for { separator } has been removed', {\n          code: 'LEVEL_LEGACY'\n        })\n      } else if (options && options.open) {\n        throw new ModuleError('The subleveldown open option has been removed', {\n          code: 'LEVEL_LEGACY'\n        })\n      }\n\n      if (options == null) {\n        return defaults\n      } else if (!options.separator) {\n        return { ...options, separator: '!' }\n      } else {\n        return options\n      }\n    }\n\n    // TODO: add autoClose option, which if true, does parent.attachResource(this)\n    constructor (db, name, options) {\n      // Don't forward AbstractSublevel options to AbstractLevel\n      const { separator, manifest, ...forward } = AbstractSublevel.defaults(options)\n      name = trim(name, separator)\n\n      // Reserve one character between separator and name to give us an upper bound\n      const reserved = separator.charCodeAt(0) + 1\n      const parent = db[kParent] || db\n\n      // Keys should sort like ['!a!', '!a!!a!', '!a\"', '!aa!', '!b!'].\n      // Use ASCII for consistent length between string, Buffer and Uint8Array\n      if (!textEncoder.encode(name).every(x => x > reserved && x < 127)) {\n        throw new ModuleError(`Prefix must use bytes > ${reserved} < ${127}`, {\n          code: 'LEVEL_INVALID_PREFIX'\n        })\n      }\n\n      super(mergeManifests(parent, manifest), forward)\n\n      const prefix = (db.prefix || '') + separator + name + separator\n      const upperBound = prefix.slice(0, -1) + String.fromCharCode(reserved)\n\n      this[kParent] = parent\n      this[kPrefix] = new MultiFormat(prefix)\n      this[kUpperBound] = new MultiFormat(upperBound)\n      this[kUnfix] = new Unfixer()\n\n      this.nextTick = parent.nextTick\n    }\n\n    prefixKey (key, keyFormat) {\n      if (keyFormat === 'utf8') {\n        return this[kPrefix].utf8 + key\n      } else if (key.byteLength === 0) {\n        // Fast path for empty key (no copy)\n        return this[kPrefix][keyFormat]\n      } else if (keyFormat === 'view') {\n        const view = this[kPrefix].view\n        const result = new Uint8Array(view.byteLength + key.byteLength)\n\n        result.set(view, 0)\n        result.set(key, view.byteLength)\n\n        return result\n      } else {\n        const buffer = this[kPrefix].buffer\n        return Buffer.concat([buffer, key], buffer.byteLength + key.byteLength)\n      }\n    }\n\n    // Not exposed for now.\n    [kPrefixRange] (range, keyFormat) {\n      if (range.gte !== undefined) {\n        range.gte = this.prefixKey(range.gte, keyFormat)\n      } else if (range.gt !== undefined) {\n        range.gt = this.prefixKey(range.gt, keyFormat)\n      } else {\n        range.gte = this[kPrefix][keyFormat]\n      }\n\n      if (range.lte !== undefined) {\n        range.lte = this.prefixKey(range.lte, keyFormat)\n      } else if (range.lt !== undefined) {\n        range.lt = this.prefixKey(range.lt, keyFormat)\n      } else {\n        range.lte = this[kUpperBound][keyFormat]\n      }\n    }\n\n    get prefix () {\n      return this[kPrefix].utf8\n    }\n\n    get db () {\n      return this[kParent]\n    }\n\n    _open (options, callback) {\n      // The parent db must open itself or be (re)opened by the user because\n      // a sublevel should not initiate state changes on the rest of the db.\n      this[kParent].open({ passive: true }, callback)\n    }\n\n    _put (key, value, options, callback) {\n      this[kParent].put(key, value, options, callback)\n    }\n\n    _get (key, options, callback) {\n      this[kParent].get(key, options, callback)\n    }\n\n    _getMany (keys, options, callback) {\n      this[kParent].getMany(keys, options, callback)\n    }\n\n    _del (key, options, callback) {\n      this[kParent].del(key, options, callback)\n    }\n\n    _batch (operations, options, callback) {\n      this[kParent].batch(operations, options, callback)\n    }\n\n    _clear (options, callback) {\n      // TODO (refactor): move to AbstractLevel\n      this[kPrefixRange](options, options.keyEncoding)\n      this[kParent].clear(options, callback)\n    }\n\n    _iterator (options) {\n      // TODO (refactor): move to AbstractLevel\n      this[kPrefixRange](options, options.keyEncoding)\n      const iterator = this[kParent].iterator(options)\n      const unfix = this[kUnfix].get(this[kPrefix].utf8.length, options.keyEncoding)\n      return new AbstractSublevelIterator(this, options, iterator, unfix)\n    }\n\n    _keys (options) {\n      this[kPrefixRange](options, options.keyEncoding)\n      const iterator = this[kParent].keys(options)\n      const unfix = this[kUnfix].get(this[kPrefix].utf8.length, options.keyEncoding)\n      return new AbstractSublevelKeyIterator(this, options, iterator, unfix)\n    }\n\n    _values (options) {\n      this[kPrefixRange](options, options.keyEncoding)\n      const iterator = this[kParent].values(options)\n      return new AbstractSublevelValueIterator(this, options, iterator)\n    }\n  }\n\n  return { AbstractSublevel }\n}\n\nconst mergeManifests = function (parent, manifest) {\n  return {\n    // Inherit manifest of parent db\n    ...parent.supports,\n\n    // Disable unsupported features\n    createIfMissing: false,\n    errorIfExists: false,\n\n    // Unset additional events because we're not forwarding them\n    events: {},\n\n    // Unset additional methods (like approximateSize) which we can't support here unless\n    // the AbstractSublevel class is overridden by an implementation of `abstract-level`.\n    additionalMethods: {},\n\n    // Inherit manifest of custom AbstractSublevel subclass. Such a class is not\n    // allowed to override encodings.\n    ...manifest,\n\n    encodings: {\n      utf8: supportsEncoding(parent, 'utf8'),\n      buffer: supportsEncoding(parent, 'buffer'),\n      view: supportsEncoding(parent, 'view')\n    }\n  }\n}\n\nconst supportsEncoding = function (parent, encoding) {\n  // Prefer a non-transcoded encoding for optimal performance\n  return parent.supports.encodings[encoding]\n    ? parent.keyEncoding(encoding).name === encoding\n    : false\n}\n\nclass MultiFormat {\n  constructor (key) {\n    this.utf8 = key\n    this.view = textEncoder.encode(key)\n    this.buffer = Buffer ? Buffer.from(this.view.buffer, 0, this.view.byteLength) : {}\n  }\n}\n\nclass Unfixer {\n  constructor () {\n    this.cache = new Map()\n  }\n\n  get (prefixLength, keyFormat) {\n    let unfix = this.cache.get(keyFormat)\n\n    if (unfix === undefined) {\n      if (keyFormat === 'view') {\n        unfix = function (prefixLength, key) {\n          // Avoid Uint8Array#slice() because it copies\n          return key.subarray(prefixLength)\n        }.bind(null, prefixLength)\n      } else {\n        unfix = function (prefixLength, key) {\n          // Avoid Buffer#subarray() because it's slow\n          return key.slice(prefixLength)\n        }.bind(null, prefixLength)\n      }\n\n      this.cache.set(keyFormat, unfix)\n    }\n\n    return unfix\n  }\n}\n\nconst trim = function (str, char) {\n  let start = 0\n  let end = str.length\n\n  while (start < end && str[start] === char) start++\n  while (end > start && str[end - 1] === char) end--\n\n  return str.slice(start, end)\n}\n","'use strict'\n\nexports.getCallback = function (options, callback) {\n  return typeof options === 'function' ? options : callback\n}\n\nexports.getOptions = function (options, def) {\n  if (typeof options === 'object' && options !== null) {\n    return options\n  }\n\n  if (def !== undefined) {\n    return def\n  }\n\n  return {}\n}\n","'use strict'\n\nconst { AbstractChainedBatch } = require('../abstract-chained-batch')\nconst ModuleError = require('module-error')\nconst kEncoded = Symbol('encoded')\n\n// Functional default for chained batch, with support of deferred open\nclass DefaultChainedBatch extends AbstractChainedBatch {\n  constructor (db) {\n    super(db)\n    this[kEncoded] = []\n  }\n\n  _put (key, value, options) {\n    this[kEncoded].push({ ...options, type: 'put', key, value })\n  }\n\n  _del (key, options) {\n    this[kEncoded].push({ ...options, type: 'del', key })\n  }\n\n  _clear () {\n    this[kEncoded] = []\n  }\n\n  // Assumes this[kEncoded] cannot change after write()\n  _write (options, callback) {\n    if (this.db.status === 'opening') {\n      this.db.defer(() => this._write(options, callback))\n    } else if (this.db.status === 'open') {\n      if (this[kEncoded].length === 0) this.nextTick(callback)\n      else this.db._batch(this[kEncoded], options, callback)\n    } else {\n      this.nextTick(callback, new ModuleError('Batch is not open: cannot call write() after write() or close()', {\n        code: 'LEVEL_BATCH_NOT_OPEN'\n      }))\n    }\n  }\n}\n\nexports.DefaultChainedBatch = DefaultChainedBatch\n","'use strict'\n\nconst { AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\n\nconst kIterator = Symbol('iterator')\nconst kCallback = Symbol('callback')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\n\nclass DefaultKeyIterator extends AbstractKeyIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kIterator] = db.iterator({ ...options, keys: true, values: false })\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n  }\n}\n\nclass DefaultValueIterator extends AbstractValueIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kIterator] = db.iterator({ ...options, keys: false, values: true })\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n  }\n}\n\nfor (const Iterator of [DefaultKeyIterator, DefaultValueIterator]) {\n  const keys = Iterator === DefaultKeyIterator\n  const mapEntry = keys ? (entry) => entry[0] : (entry) => entry[1]\n\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback\n    this[kIterator].next(this[kHandleOne])\n  }\n\n  Iterator.prototype[kHandleOne] = function (err, key, value) {\n    const callback = this[kCallback]\n    if (err) callback(err)\n    else callback(null, keys ? key : value)\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback\n    this[kIterator].nextv(size, options, this[kHandleMany])\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback\n    this[kIterator].all(options, this[kHandleMany])\n  }\n\n  Iterator.prototype[kHandleMany] = function (err, entries) {\n    const callback = this[kCallback]\n    if (err) callback(err)\n    else callback(null, entries.map(mapEntry))\n  }\n\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options)\n  }\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback)\n  }\n}\n\n// Internal utilities, should be typed as AbstractKeyIterator and AbstractValueIterator\nexports.DefaultKeyIterator = DefaultKeyIterator\nexports.DefaultValueIterator = DefaultValueIterator\n","'use strict'\n\nconst { AbstractIterator, AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\nconst ModuleError = require('module-error')\n\nconst kNut = Symbol('nut')\nconst kUndefer = Symbol('undefer')\nconst kFactory = Symbol('factory')\n\nclass DeferredIterator extends AbstractIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kNut] = null\n    this[kFactory] = () => db.iterator(options)\n\n    this.db.defer(() => this[kUndefer]())\n  }\n}\n\nclass DeferredKeyIterator extends AbstractKeyIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kNut] = null\n    this[kFactory] = () => db.keys(options)\n\n    this.db.defer(() => this[kUndefer]())\n  }\n}\n\nclass DeferredValueIterator extends AbstractValueIterator {\n  constructor (db, options) {\n    super(db, options)\n\n    this[kNut] = null\n    this[kFactory] = () => db.values(options)\n\n    this.db.defer(() => this[kUndefer]())\n  }\n}\n\nfor (const Iterator of [DeferredIterator, DeferredKeyIterator, DeferredValueIterator]) {\n  Iterator.prototype[kUndefer] = function () {\n    if (this.db.status === 'open') {\n      this[kNut] = this[kFactory]()\n    }\n  }\n\n  Iterator.prototype._next = function (callback) {\n    if (this[kNut] !== null) {\n      this[kNut].next(callback)\n    } else if (this.db.status === 'opening') {\n      this.db.defer(() => this._next(callback))\n    } else {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call next() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    }\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    if (this[kNut] !== null) {\n      this[kNut].nextv(size, options, callback)\n    } else if (this.db.status === 'opening') {\n      this.db.defer(() => this._nextv(size, options, callback))\n    } else {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call nextv() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    }\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    if (this[kNut] !== null) {\n      this[kNut].all(callback)\n    } else if (this.db.status === 'opening') {\n      this.db.defer(() => this._all(options, callback))\n    } else {\n      this.nextTick(callback, new ModuleError('Iterator is not open: cannot call all() after close()', {\n        code: 'LEVEL_ITERATOR_NOT_OPEN'\n      }))\n    }\n  }\n\n  Iterator.prototype._seek = function (target, options) {\n    if (this[kNut] !== null) {\n      // TODO: explain why we need _seek() rather than seek() here\n      this[kNut]._seek(target, options)\n    } else if (this.db.status === 'opening') {\n      this.db.defer(() => this._seek(target, options))\n    }\n  }\n\n  Iterator.prototype._close = function (callback) {\n    if (this[kNut] !== null) {\n      this[kNut].close(callback)\n    } else if (this.db.status === 'opening') {\n      this.db.defer(() => this._close(callback))\n    } else {\n      this.nextTick(callback)\n    }\n  }\n}\n\nexports.DeferredIterator = DeferredIterator\nexports.DeferredKeyIterator = DeferredKeyIterator\nexports.DeferredValueIterator = DeferredValueIterator\n","'use strict'\n\nconst queueMicrotask = require('queue-microtask')\n\nmodule.exports = function (fn, ...args) {\n  if (args.length === 0) {\n    queueMicrotask(fn)\n  } else {\n    queueMicrotask(() => fn(...args))\n  }\n}\n","'use strict'\n\nconst ModuleError = require('module-error')\nconst hasOwnProperty = Object.prototype.hasOwnProperty\nconst rangeOptions = new Set(['lt', 'lte', 'gt', 'gte'])\n\nmodule.exports = function (options, keyEncoding) {\n  const result = {}\n\n  for (const k in options) {\n    if (!hasOwnProperty.call(options, k)) continue\n    if (k === 'keyEncoding' || k === 'valueEncoding') continue\n\n    if (k === 'start' || k === 'end') {\n      throw new ModuleError(`The legacy range option '${k}' has been removed`, {\n        code: 'LEVEL_LEGACY'\n      })\n    } else if (k === 'encoding') {\n      // To help migrating to abstract-level\n      throw new ModuleError(\"The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead\", {\n        code: 'LEVEL_LEGACY'\n      })\n    }\n\n    if (rangeOptions.has(k)) {\n      // Note that we don't reject nullish and empty options here. While\n      // those types are invalid as keys, they are valid as range options.\n      result[k] = keyEncoding.encode(options[k])\n    } else {\n      result[k] = options[k]\n    }\n  }\n\n  result.reverse = !!result.reverse\n  result.limit = Number.isInteger(result.limit) && result.limit >= 0 ? result.limit : -1\n\n  return result\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nconst base64 = require('base64-js')\nconst ieee754 = require('ieee754')\nconst customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nconst K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    const arr = new Uint8Array(1)\n    const proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  const buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  const valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  const b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(value[Symbol.toPrimitive]('string'), encodingOrOffset, length)\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  const length = byteLength(string, encoding) | 0\n  let buf = createBuffer(length)\n\n  const actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  const length = array.length < 0 ? 0 : checked(array.length) | 0\n  const buf = createBuffer(length)\n  for (let i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    const copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  let buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    const len = checked(obj.length) | 0\n    const buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  let x = a.length\n  let y = b.length\n\n  for (let i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  let i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  const buffer = Buffer.allocUnsafe(length)\n  let pos = 0\n  for (i = 0; i < list.length; ++i) {\n    let buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        if (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)\n        buf.copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  const len = string.length\n  const mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  let loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  const i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  const len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (let i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  const len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (let i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  const len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (let i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  const length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  let str = ''\n  const max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  let x = thisEnd - thisStart\n  let y = end - start\n  const len = Math.min(x, y)\n\n  const thisCopy = this.slice(thisStart, thisEnd)\n  const targetCopy = target.slice(start, end)\n\n  for (let i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  let indexSize = 1\n  let arrLength = arr.length\n  let valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  let i\n  if (dir) {\n    let foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      let found = true\n      for (let j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  const remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  const strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  let i\n  for (i = 0; i < length; ++i) {\n    const parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  const remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  const res = []\n\n  let i = start\n  while (i < end) {\n    const firstByte = buf[i]\n    let codePoint = null\n    let bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nconst MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  const len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  let res = ''\n  let i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  const len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  let out = ''\n  for (let i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  const bytes = buf.slice(start, end)\n  let res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (let i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  const len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  const newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  let val = this[offset + --byteLength]\n  let mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readBigUInt64LE = defineBigIntMethod(function readBigUInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const lo = first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24\n\n  const hi = this[++offset] +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    last * 2 ** 24\n\n  return BigInt(lo) + (BigInt(hi) << BigInt(32))\n})\n\nBuffer.prototype.readBigUInt64BE = defineBigIntMethod(function readBigUInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const hi = first * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  const lo = this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last\n\n  return (BigInt(hi) << BigInt(32)) + BigInt(lo)\n})\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let i = byteLength\n  let mul = 1\n  let val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readBigInt64LE = defineBigIntMethod(function readBigInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = this[offset + 4] +\n    this[offset + 5] * 2 ** 8 +\n    this[offset + 6] * 2 ** 16 +\n    (last << 24) // Overflow\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24)\n})\n\nBuffer.prototype.readBigInt64BE = defineBigIntMethod(function readBigInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = (first << 24) + // Overflow\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last)\n})\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let mul = 1\n  let i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction wrtBigUInt64LE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  return offset\n}\n\nfunction wrtBigUInt64BE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset + 7] = lo\n  lo = lo >> 8\n  buf[offset + 6] = lo\n  lo = lo >> 8\n  buf[offset + 5] = lo\n  lo = lo >> 8\n  buf[offset + 4] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset + 3] = hi\n  hi = hi >> 8\n  buf[offset + 2] = hi\n  hi = hi >> 8\n  buf[offset + 1] = hi\n  hi = hi >> 8\n  buf[offset] = hi\n  return offset + 8\n}\n\nBuffer.prototype.writeBigUInt64LE = defineBigIntMethod(function writeBigUInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeBigUInt64BE = defineBigIntMethod(function writeBigUInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = 0\n  let mul = 1\n  let sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  let sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeBigInt64LE = defineBigIntMethod(function writeBigInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nBuffer.prototype.writeBigInt64BE = defineBigIntMethod(function writeBigInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  const len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      const code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  let i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    const bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    const len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// CUSTOM ERRORS\n// =============\n\n// Simplified versions from Node, changed for Buffer-only usage\nconst errors = {}\nfunction E (sym, getMessage, Base) {\n  errors[sym] = class NodeError extends Base {\n    constructor () {\n      super()\n\n      Object.defineProperty(this, 'message', {\n        value: getMessage.apply(this, arguments),\n        writable: true,\n        configurable: true\n      })\n\n      // Add the error code to the name to include it in the stack trace.\n      this.name = `${this.name} [${sym}]`\n      // Access the stack to generate the error message including the error code\n      // from the name.\n      this.stack // eslint-disable-line no-unused-expressions\n      // Reset the name to the actual name.\n      delete this.name\n    }\n\n    get code () {\n      return sym\n    }\n\n    set code (value) {\n      Object.defineProperty(this, 'code', {\n        configurable: true,\n        enumerable: true,\n        value,\n        writable: true\n      })\n    }\n\n    toString () {\n      return `${this.name} [${sym}]: ${this.message}`\n    }\n  }\n}\n\nE('ERR_BUFFER_OUT_OF_BOUNDS',\n  function (name) {\n    if (name) {\n      return `${name} is outside of buffer bounds`\n    }\n\n    return 'Attempt to access memory outside buffer bounds'\n  }, RangeError)\nE('ERR_INVALID_ARG_TYPE',\n  function (name, actual) {\n    return `The \"${name}\" argument must be of type number. Received type ${typeof actual}`\n  }, TypeError)\nE('ERR_OUT_OF_RANGE',\n  function (str, range, input) {\n    let msg = `The value of \"${str}\" is out of range.`\n    let received = input\n    if (Number.isInteger(input) && Math.abs(input) > 2 ** 32) {\n      received = addNumericalSeparator(String(input))\n    } else if (typeof input === 'bigint') {\n      received = String(input)\n      if (input > BigInt(2) ** BigInt(32) || input < -(BigInt(2) ** BigInt(32))) {\n        received = addNumericalSeparator(received)\n      }\n      received += 'n'\n    }\n    msg += ` It must be ${range}. Received ${received}`\n    return msg\n  }, RangeError)\n\nfunction addNumericalSeparator (val) {\n  let res = ''\n  let i = val.length\n  const start = val[0] === '-' ? 1 : 0\n  for (; i >= start + 4; i -= 3) {\n    res = `_${val.slice(i - 3, i)}${res}`\n  }\n  return `${val.slice(0, i)}${res}`\n}\n\n// CHECK FUNCTIONS\n// ===============\n\nfunction checkBounds (buf, offset, byteLength) {\n  validateNumber(offset, 'offset')\n  if (buf[offset] === undefined || buf[offset + byteLength] === undefined) {\n    boundsError(offset, buf.length - (byteLength + 1))\n  }\n}\n\nfunction checkIntBI (value, min, max, buf, offset, byteLength) {\n  if (value > max || value < min) {\n    const n = typeof min === 'bigint' ? 'n' : ''\n    let range\n    if (byteLength > 3) {\n      if (min === 0 || min === BigInt(0)) {\n        range = `>= 0${n} and < 2${n} ** ${(byteLength + 1) * 8}${n}`\n      } else {\n        range = `>= -(2${n} ** ${(byteLength + 1) * 8 - 1}${n}) and < 2 ** ` +\n                `${(byteLength + 1) * 8 - 1}${n}`\n      }\n    } else {\n      range = `>= ${min}${n} and <= ${max}${n}`\n    }\n    throw new errors.ERR_OUT_OF_RANGE('value', range, value)\n  }\n  checkBounds(buf, offset, byteLength)\n}\n\nfunction validateNumber (value, name) {\n  if (typeof value !== 'number') {\n    throw new errors.ERR_INVALID_ARG_TYPE(name, 'number', value)\n  }\n}\n\nfunction boundsError (value, length, type) {\n  if (Math.floor(value) !== value) {\n    validateNumber(value, type)\n    throw new errors.ERR_OUT_OF_RANGE(type || 'offset', 'an integer', value)\n  }\n\n  if (length < 0) {\n    throw new errors.ERR_BUFFER_OUT_OF_BOUNDS()\n  }\n\n  throw new errors.ERR_OUT_OF_RANGE(type || 'offset',\n                                    `>= ${type ? 1 : 0} and <= ${length}`,\n                                    value)\n}\n\n// HELPER FUNCTIONS\n// ================\n\nconst INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  let codePoint\n  const length = string.length\n  let leadSurrogate = null\n  const bytes = []\n\n  for (let i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  let c, hi, lo\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  let i\n  for (i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nconst hexSliceLookupTable = (function () {\n  const alphabet = '0123456789abcdef'\n  const table = new Array(256)\n  for (let i = 0; i < 16; ++i) {\n    const i16 = i * 16\n    for (let j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n\n// Return not function with Error if BigInt not supported\nfunction defineBigIntMethod (fn) {\n  return typeof BigInt === 'undefined' ? BufferBigIntNotDefined : fn\n}\n\nfunction BufferBigIntNotDefined () {\n  throw new Error('BigInt not supported')\n}\n","/**\n * Takes an array of AbortSignals and returns a single signal.\n * If any signals are aborted, the returned signal will be aborted.\n * @param {Array<AbortSignal>} signals\n * @returns {AbortSignal}\n */\nfunction anySignal (signals) {\n  const controller = new globalThis.AbortController()\n\n  function onAbort () {\n    controller.abort()\n\n    for (const signal of signals) {\n      if (!signal || !signal.removeEventListener) continue\n      signal.removeEventListener('abort', onAbort)\n    }\n  }\n\n  for (const signal of signals) {\n    if (!signal || !signal.addEventListener) continue\n    if (signal.aborted) {\n      onAbort()\n      break\n    }\n    signal.addEventListener('abort', onAbort)\n  }\n\n  return controller.signal\n}\n\nmodule.exports = anySignal\nmodule.exports.anySignal = anySignal\n","/* global indexedDB */\n\n'use strict'\n\nconst { AbstractLevel } = require('abstract-level')\nconst ModuleError = require('module-error')\nconst parallel = require('run-parallel-limit')\nconst { fromCallback } = require('catering')\nconst { Iterator } = require('./iterator')\nconst deserialize = require('./util/deserialize')\nconst clear = require('./util/clear')\nconst createKeyRange = require('./util/key-range')\n\n// Keep as-is for compatibility with existing level-js databases\nconst DEFAULT_PREFIX = 'level-js-'\n\nconst kIDB = Symbol('idb')\nconst kNamePrefix = Symbol('namePrefix')\nconst kLocation = Symbol('location')\nconst kVersion = Symbol('version')\nconst kStore = Symbol('store')\nconst kOnComplete = Symbol('onComplete')\nconst kPromise = Symbol('promise')\n\nclass BrowserLevel extends AbstractLevel {\n  constructor (location, options, _) {\n    // To help migrating to abstract-level\n    if (typeof options === 'function' || typeof _ === 'function') {\n      throw new ModuleError('The levelup-style callback argument has been removed', {\n        code: 'LEVEL_LEGACY'\n      })\n    }\n\n    const { prefix, version, ...forward } = options || {}\n\n    super({\n      encodings: { view: true },\n      snapshots: false,\n      createIfMissing: false,\n      errorIfExists: false,\n      seek: true\n    }, forward)\n\n    if (typeof location !== 'string') {\n      throw new Error('constructor requires a location string argument')\n    }\n\n    // TODO (next major): remove default prefix\n    this[kLocation] = location\n    this[kNamePrefix] = prefix == null ? DEFAULT_PREFIX : prefix\n    this[kVersion] = parseInt(version || 1, 10)\n    this[kIDB] = null\n  }\n\n  get location () {\n    return this[kLocation]\n  }\n\n  get namePrefix () {\n    return this[kNamePrefix]\n  }\n\n  get version () {\n    return this[kVersion]\n  }\n\n  // Exposed for backwards compat and unit tests\n  get db () {\n    return this[kIDB]\n  }\n\n  get type () {\n    return 'browser-level'\n  }\n\n  _open (options, callback) {\n    const req = indexedDB.open(this[kNamePrefix] + this[kLocation], this[kVersion])\n\n    req.onerror = function () {\n      callback(req.error || new Error('unknown error'))\n    }\n\n    req.onsuccess = () => {\n      this[kIDB] = req.result\n      callback()\n    }\n\n    req.onupgradeneeded = (ev) => {\n      const db = ev.target.result\n\n      if (!db.objectStoreNames.contains(this[kLocation])) {\n        db.createObjectStore(this[kLocation])\n      }\n    }\n  }\n\n  [kStore] (mode) {\n    const transaction = this[kIDB].transaction([this[kLocation]], mode)\n    return transaction.objectStore(this[kLocation])\n  }\n\n  [kOnComplete] (request, callback) {\n    const transaction = request.transaction\n\n    // Take advantage of the fact that a non-canceled request error aborts\n    // the transaction. I.e. no need to listen for \"request.onerror\".\n    transaction.onabort = function () {\n      callback(transaction.error || new Error('aborted by user'))\n    }\n\n    transaction.oncomplete = function () {\n      callback(null, request.result)\n    }\n  }\n\n  _get (key, options, callback) {\n    const store = this[kStore]('readonly')\n    let req\n\n    try {\n      req = store.get(key)\n    } catch (err) {\n      return this.nextTick(callback, err)\n    }\n\n    this[kOnComplete](req, function (err, value) {\n      if (err) return callback(err)\n\n      if (value === undefined) {\n        return callback(new ModuleError('Entry not found', {\n          code: 'LEVEL_NOT_FOUND'\n        }))\n      }\n\n      callback(null, deserialize(value))\n    })\n  }\n\n  _getMany (keys, options, callback) {\n    const store = this[kStore]('readonly')\n    const tasks = keys.map((key) => (next) => {\n      let request\n\n      try {\n        request = store.get(key)\n      } catch (err) {\n        return next(err)\n      }\n\n      request.onsuccess = () => {\n        const value = request.result\n        next(null, value === undefined ? value : deserialize(value))\n      }\n\n      request.onerror = (ev) => {\n        ev.stopPropagation()\n        next(request.error)\n      }\n    })\n\n    parallel(tasks, 16, callback)\n  }\n\n  _del (key, options, callback) {\n    const store = this[kStore]('readwrite')\n    let req\n\n    try {\n      req = store.delete(key)\n    } catch (err) {\n      return this.nextTick(callback, err)\n    }\n\n    this[kOnComplete](req, callback)\n  }\n\n  _put (key, value, options, callback) {\n    const store = this[kStore]('readwrite')\n    let req\n\n    try {\n      // Will throw a DataError or DataCloneError if the environment\n      // does not support serializing the key or value respectively.\n      req = store.put(value, key)\n    } catch (err) {\n      return this.nextTick(callback, err)\n    }\n\n    this[kOnComplete](req, callback)\n  }\n\n  // TODO: implement key and value iterators\n  _iterator (options) {\n    return new Iterator(this, this[kLocation], options)\n  }\n\n  _batch (operations, options, callback) {\n    const store = this[kStore]('readwrite')\n    const transaction = store.transaction\n    let index = 0\n    let error\n\n    transaction.onabort = function () {\n      callback(error || transaction.error || new Error('aborted by user'))\n    }\n\n    transaction.oncomplete = function () {\n      callback()\n    }\n\n    // Wait for a request to complete before making the next, saving CPU.\n    function loop () {\n      const op = operations[index++]\n      const key = op.key\n\n      let req\n\n      try {\n        req = op.type === 'del' ? store.delete(key) : store.put(op.value, key)\n      } catch (err) {\n        error = err\n        transaction.abort()\n        return\n      }\n\n      if (index < operations.length) {\n        req.onsuccess = loop\n      } else if (typeof transaction.commit === 'function') {\n        // Commit now instead of waiting for auto-commit\n        transaction.commit()\n      }\n    }\n\n    loop()\n  }\n\n  _clear (options, callback) {\n    let keyRange\n    let req\n\n    try {\n      keyRange = createKeyRange(options)\n    } catch (e) {\n      // The lower key is greater than the upper key.\n      // IndexedDB throws an error, but we'll just do nothing.\n      return this.nextTick(callback)\n    }\n\n    if (options.limit >= 0) {\n      // IDBObjectStore#delete(range) doesn't have such an option.\n      // Fall back to cursor-based implementation.\n      return clear(this, this[kLocation], keyRange, options, callback)\n    }\n\n    try {\n      const store = this[kStore]('readwrite')\n      req = keyRange ? store.delete(keyRange) : store.clear()\n    } catch (err) {\n      return this.nextTick(callback, err)\n    }\n\n    this[kOnComplete](req, callback)\n  }\n\n  _close (callback) {\n    this[kIDB].close()\n    this.nextTick(callback)\n  }\n}\n\nBrowserLevel.destroy = function (location, prefix, callback) {\n  if (typeof prefix === 'function') {\n    callback = prefix\n    prefix = DEFAULT_PREFIX\n  }\n\n  callback = fromCallback(callback, kPromise)\n  const request = indexedDB.deleteDatabase(prefix + location)\n\n  request.onsuccess = function () {\n    callback()\n  }\n\n  request.onerror = function (err) {\n    callback(err)\n  }\n\n  return callback[kPromise]\n}\n\nexports.BrowserLevel = BrowserLevel\n","'use strict'\n\nconst { AbstractIterator } = require('abstract-level')\nconst createKeyRange = require('./util/key-range')\nconst deserialize = require('./util/deserialize')\n\nconst kCache = Symbol('cache')\nconst kFinished = Symbol('finished')\nconst kOptions = Symbol('options')\nconst kCurrentOptions = Symbol('currentOptions')\nconst kPosition = Symbol('position')\nconst kLocation = Symbol('location')\nconst kFirst = Symbol('first')\nconst emptyOptions = {}\n\nclass Iterator extends AbstractIterator {\n  constructor (db, location, options) {\n    super(db, options)\n\n    this[kCache] = []\n    this[kFinished] = this.limit === 0\n    this[kOptions] = options\n    this[kCurrentOptions] = { ...options }\n    this[kPosition] = undefined\n    this[kLocation] = location\n    this[kFirst] = true\n  }\n\n  // Note: if called by _all() then size can be Infinity. This is an internal\n  // detail; by design AbstractIterator.nextv() does not support Infinity.\n  _nextv (size, options, callback) {\n    this[kFirst] = false\n\n    if (this[kFinished]) {\n      return this.nextTick(callback, null, [])\n    } else if (this[kCache].length > 0) {\n      // TODO: mixing next and nextv is not covered by test suite\n      size = Math.min(size, this[kCache].length)\n      return this.nextTick(callback, null, this[kCache].splice(0, size))\n    }\n\n    // Adjust range by what we already visited\n    if (this[kPosition] !== undefined) {\n      if (this[kOptions].reverse) {\n        this[kCurrentOptions].lt = this[kPosition]\n        this[kCurrentOptions].lte = undefined\n      } else {\n        this[kCurrentOptions].gt = this[kPosition]\n        this[kCurrentOptions].gte = undefined\n      }\n    }\n\n    let keyRange\n\n    try {\n      keyRange = createKeyRange(this[kCurrentOptions])\n    } catch (_) {\n      // The lower key is greater than the upper key.\n      // IndexedDB throws an error, but we'll just return 0 results.\n      this[kFinished] = true\n      return this.nextTick(callback, null, [])\n    }\n\n    const transaction = this.db.db.transaction([this[kLocation]], 'readonly')\n    const store = transaction.objectStore(this[kLocation])\n    const entries = []\n\n    if (!this[kOptions].reverse) {\n      let keys\n      let values\n\n      const complete = () => {\n        // Wait for both requests to complete\n        if (keys === undefined || values === undefined) return\n\n        const length = Math.max(keys.length, values.length)\n\n        if (length === 0 || size === Infinity) {\n          this[kFinished] = true\n        } else {\n          this[kPosition] = keys[length - 1]\n        }\n\n        // Resize\n        entries.length = length\n\n        // Merge keys and values\n        for (let i = 0; i < length; i++) {\n          const key = keys[i]\n          const value = values[i]\n\n          entries[i] = [\n            this[kOptions].keys && key !== undefined ? deserialize(key) : undefined,\n            this[kOptions].values && value !== undefined ? deserialize(value) : undefined\n          ]\n        }\n\n        maybeCommit(transaction)\n      }\n\n      // If keys were not requested and size is Infinity, we don't have to keep\n      // track of position and can thus skip getting keys.\n      if (this[kOptions].keys || size < Infinity) {\n        store.getAllKeys(keyRange, size < Infinity ? size : undefined).onsuccess = (ev) => {\n          keys = ev.target.result\n          complete()\n        }\n      } else {\n        keys = []\n        this.nextTick(complete)\n      }\n\n      if (this[kOptions].values) {\n        store.getAll(keyRange, size < Infinity ? size : undefined).onsuccess = (ev) => {\n          values = ev.target.result\n          complete()\n        }\n      } else {\n        values = []\n        this.nextTick(complete)\n      }\n    } else {\n      // Can't use getAll() in reverse, so use a slower cursor that yields one item at a time\n      // TODO: test if all target browsers support openKeyCursor\n      const method = !this[kOptions].values && store.openKeyCursor ? 'openKeyCursor' : 'openCursor'\n\n      store[method](keyRange, 'prev').onsuccess = (ev) => {\n        const cursor = ev.target.result\n\n        if (cursor) {\n          const { key, value } = cursor\n          this[kPosition] = key\n\n          entries.push([\n            this[kOptions].keys && key !== undefined ? deserialize(key) : undefined,\n            this[kOptions].values && value !== undefined ? deserialize(value) : undefined\n          ])\n\n          if (entries.length < size) {\n            cursor.continue()\n          } else {\n            maybeCommit(transaction)\n          }\n        } else {\n          this[kFinished] = true\n        }\n      }\n    }\n\n    // If an error occurs (on the request), the transaction will abort.\n    transaction.onabort = () => {\n      callback(transaction.error || new Error('aborted by user'))\n      callback = null\n    }\n\n    transaction.oncomplete = () => {\n      callback(null, entries)\n      callback = null\n    }\n  }\n\n  _next (callback) {\n    if (this[kCache].length > 0) {\n      const [key, value] = this[kCache].shift()\n      this.nextTick(callback, null, key, value)\n    } else if (this[kFinished]) {\n      this.nextTick(callback)\n    } else {\n      let size = Math.min(100, this.limit - this.count)\n\n      if (this[kFirst]) {\n        // It's common to only want one entry initially or after a seek()\n        this[kFirst] = false\n        size = 1\n      }\n\n      this._nextv(size, emptyOptions, (err, entries) => {\n        if (err) return callback(err)\n        this[kCache] = entries\n        this._next(callback)\n      })\n    }\n  }\n\n  _all (options, callback) {\n    this[kFirst] = false\n\n    // TODO: mixing next and all is not covered by test suite\n    const cache = this[kCache].splice(0, this[kCache].length)\n    const size = this.limit - this.count - cache.length\n\n    if (size <= 0) {\n      return this.nextTick(callback, null, cache)\n    }\n\n    this._nextv(size, emptyOptions, (err, entries) => {\n      if (err) return callback(err)\n      if (cache.length > 0) entries = cache.concat(entries)\n      callback(null, entries)\n    })\n  }\n\n  _seek (target, options) {\n    this[kFirst] = true\n    this[kCache] = []\n    this[kFinished] = false\n    this[kPosition] = undefined\n\n    // TODO: not covered by test suite\n    this[kCurrentOptions] = { ...this[kOptions] }\n\n    let keyRange\n\n    try {\n      keyRange = createKeyRange(this[kOptions])\n    } catch (_) {\n      this[kFinished] = true\n      return\n    }\n\n    if (keyRange !== null && !keyRange.includes(target)) {\n      this[kFinished] = true\n    } else if (this[kOptions].reverse) {\n      this[kCurrentOptions].lte = target\n    } else {\n      this[kCurrentOptions].gte = target\n    }\n  }\n}\n\nexports.Iterator = Iterator\n\nfunction maybeCommit (transaction) {\n  // Commit (meaning close) now instead of waiting for auto-commit\n  if (typeof transaction.commit === 'function') {\n    transaction.commit()\n  }\n}\n","'use strict'\n\nmodule.exports = function clear (db, location, keyRange, options, callback) {\n  if (options.limit === 0) return db.nextTick(callback)\n\n  const transaction = db.db.transaction([location], 'readwrite')\n  const store = transaction.objectStore(location)\n  let count = 0\n\n  transaction.oncomplete = function () {\n    callback()\n  }\n\n  transaction.onabort = function () {\n    callback(transaction.error || new Error('aborted by user'))\n  }\n\n  // A key cursor is faster (skips reading values) but not supported by IE\n  // TODO: we no longer support IE. Test others\n  const method = store.openKeyCursor ? 'openKeyCursor' : 'openCursor'\n  const direction = options.reverse ? 'prev' : 'next'\n\n  store[method](keyRange, direction).onsuccess = function (ev) {\n    const cursor = ev.target.result\n\n    if (cursor) {\n      // Wait for a request to complete before continuing, saving CPU.\n      store.delete(cursor.key).onsuccess = function () {\n        if (options.limit <= 0 || ++count < options.limit) {\n          cursor.continue()\n        }\n      }\n    }\n  }\n}\n","'use strict'\n\nconst textEncoder = new TextEncoder()\n\nmodule.exports = function (data) {\n  if (data instanceof Uint8Array) {\n    return data\n  } else if (data instanceof ArrayBuffer) {\n    return new Uint8Array(data)\n  } else {\n    // Non-binary data stored with an old version (level-js < 5.0.0)\n    return textEncoder.encode(data)\n  }\n}\n","/* global IDBKeyRange */\n\n'use strict'\n\nmodule.exports = function createKeyRange (options) {\n  const lower = options.gte !== undefined ? options.gte : options.gt !== undefined ? options.gt : undefined\n  const upper = options.lte !== undefined ? options.lte : options.lt !== undefined ? options.lt : undefined\n  const lowerExclusive = options.gte === undefined\n  const upperExclusive = options.lte === undefined\n\n  if (lower !== undefined && upper !== undefined) {\n    return IDBKeyRange.bound(lower, upper, lowerExclusive, upperExclusive)\n  } else if (lower !== undefined) {\n    return IDBKeyRange.lowerBound(lower, lowerExclusive)\n  } else if (upper !== undefined) {\n    return IDBKeyRange.upperBound(upper, upperExclusive)\n  } else {\n    return null\n  }\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nvar K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    var arr = new Uint8Array(1)\n    var proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  var buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  var valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  var b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(\n      value[Symbol.toPrimitive]('string'), encodingOrOffset, length\n    )\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  var length = byteLength(string, encoding) | 0\n  var buf = createBuffer(length)\n\n  var actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  var buf = createBuffer(length)\n  for (var i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    var copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  var buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    var buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        Buffer.from(buf).copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  var len = string.length\n  var mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  var strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (var i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    var limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    var limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    var len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nvar hexSliceLookupTable = (function () {\n  var alphabet = '0123456789abcdef'\n  var table = new Array(256)\n  for (var i = 0; i < 16; ++i) {\n    var i16 = i * 16\n    for (var j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n","/*!\n * bytes\n * Copyright(c) 2012-2014 TJ Holowaychuk\n * Copyright(c) 2015 Jed Watson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = bytes;\nmodule.exports.format = format;\nmodule.exports.parse = parse;\n\n/**\n * Module variables.\n * @private\n */\n\nvar formatThousandsRegExp = /\\B(?=(\\d{3})+(?!\\d))/g;\n\nvar formatDecimalsRegExp = /(?:\\.0*|(\\.[^0]+)0+)$/;\n\nvar map = {\n  b:  1,\n  kb: 1 << 10,\n  mb: 1 << 20,\n  gb: 1 << 30,\n  tb: Math.pow(1024, 4),\n  pb: Math.pow(1024, 5),\n};\n\nvar parseRegExp = /^((-|\\+)?(\\d+(?:\\.\\d+)?)) *(kb|mb|gb|tb|pb)$/i;\n\n/**\n * Convert the given value in bytes into a string or parse to string to an integer in bytes.\n *\n * @param {string|number} value\n * @param {{\n *  case: [string],\n *  decimalPlaces: [number]\n *  fixedDecimals: [boolean]\n *  thousandsSeparator: [string]\n *  unitSeparator: [string]\n *  }} [options] bytes options.\n *\n * @returns {string|number|null}\n */\n\nfunction bytes(value, options) {\n  if (typeof value === 'string') {\n    return parse(value);\n  }\n\n  if (typeof value === 'number') {\n    return format(value, options);\n  }\n\n  return null;\n}\n\n/**\n * Format the given value in bytes into a string.\n *\n * If the value is negative, it is kept as such. If it is a float,\n * it is rounded.\n *\n * @param {number} value\n * @param {object} [options]\n * @param {number} [options.decimalPlaces=2]\n * @param {number} [options.fixedDecimals=false]\n * @param {string} [options.thousandsSeparator=]\n * @param {string} [options.unit=]\n * @param {string} [options.unitSeparator=]\n *\n * @returns {string|null}\n * @public\n */\n\nfunction format(value, options) {\n  if (!Number.isFinite(value)) {\n    return null;\n  }\n\n  var mag = Math.abs(value);\n  var thousandsSeparator = (options && options.thousandsSeparator) || '';\n  var unitSeparator = (options && options.unitSeparator) || '';\n  var decimalPlaces = (options && options.decimalPlaces !== undefined) ? options.decimalPlaces : 2;\n  var fixedDecimals = Boolean(options && options.fixedDecimals);\n  var unit = (options && options.unit) || '';\n\n  if (!unit || !map[unit.toLowerCase()]) {\n    if (mag >= map.pb) {\n      unit = 'PB';\n    } else if (mag >= map.tb) {\n      unit = 'TB';\n    } else if (mag >= map.gb) {\n      unit = 'GB';\n    } else if (mag >= map.mb) {\n      unit = 'MB';\n    } else if (mag >= map.kb) {\n      unit = 'KB';\n    } else {\n      unit = 'B';\n    }\n  }\n\n  var val = value / map[unit.toLowerCase()];\n  var str = val.toFixed(decimalPlaces);\n\n  if (!fixedDecimals) {\n    str = str.replace(formatDecimalsRegExp, '$1');\n  }\n\n  if (thousandsSeparator) {\n    str = str.split('.').map(function (s, i) {\n      return i === 0\n        ? s.replace(formatThousandsRegExp, thousandsSeparator)\n        : s\n    }).join('.');\n  }\n\n  return str + unitSeparator + unit;\n}\n\n/**\n * Parse the string value into an integer in bytes.\n *\n * If no unit is given, it is assumed the value is in bytes.\n *\n * @param {number|string} val\n *\n * @returns {number|null}\n * @public\n */\n\nfunction parse(val) {\n  if (typeof val === 'number' && !isNaN(val)) {\n    return val;\n  }\n\n  if (typeof val !== 'string') {\n    return null;\n  }\n\n  // Test if the string passed is valid\n  var results = parseRegExp.exec(val);\n  var floatValue;\n  var unit = 'b';\n\n  if (!results) {\n    // Nothing could be extracted from the given string\n    floatValue = parseInt(val, 10);\n    unit = 'b'\n  } else {\n    // Retrieve the value and the unit\n    floatValue = parseFloat(results[1]);\n    unit = results[4].toLowerCase();\n  }\n\n  if (isNaN(floatValue)) {\n    return null;\n  }\n\n  return Math.floor(map[unit] * floatValue);\n}\n","'use strict'\n\nvar nextTick = require('./next-tick')\n\nexports.fromCallback = function (callback, symbol) {\n  if (callback === undefined) {\n    var promise = new Promise(function (resolve, reject) {\n      callback = function (err, res) {\n        if (err) reject(err)\n        else resolve(res)\n      }\n    })\n\n    callback[symbol !== undefined ? symbol : 'promise'] = promise\n  } else if (typeof callback !== 'function') {\n    throw new TypeError('Callback must be a function')\n  }\n\n  return callback\n}\n\nexports.fromPromise = function (promise, callback) {\n  if (callback === undefined) return promise\n\n  promise\n    .then(function (res) { nextTick(() => callback(null, res)) })\n    .catch(function (err) { nextTick(() => callback(err)) })\n}\n","module.exports = typeof queueMicrotask === 'function' ? queueMicrotask : (fn) => Promise.resolve().then(fn)\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nconst proxyMarker = Symbol(\"Comlink.proxy\");\nconst createEndpoint = Symbol(\"Comlink.endpoint\");\nconst releaseProxy = Symbol(\"Comlink.releaseProxy\");\nconst finalizer = Symbol(\"Comlink.finalizer\");\nconst throwMarker = Symbol(\"Comlink.thrown\");\nconst isObject = (val) => (typeof val === \"object\" && val !== null) || typeof val === \"function\";\n/**\n * Internal transfer handle to handle objects marked to proxy.\n */\nconst proxyTransferHandler = {\n    canHandle: (val) => isObject(val) && val[proxyMarker],\n    serialize(obj) {\n        const { port1, port2 } = new MessageChannel();\n        expose(obj, port1);\n        return [port2, [port2]];\n    },\n    deserialize(port) {\n        port.start();\n        return wrap(port);\n    },\n};\n/**\n * Internal transfer handler to handle thrown exceptions.\n */\nconst throwTransferHandler = {\n    canHandle: (value) => isObject(value) && throwMarker in value,\n    serialize({ value }) {\n        let serialized;\n        if (value instanceof Error) {\n            serialized = {\n                isError: true,\n                value: {\n                    message: value.message,\n                    name: value.name,\n                    stack: value.stack,\n                },\n            };\n        }\n        else {\n            serialized = { isError: false, value };\n        }\n        return [serialized, []];\n    },\n    deserialize(serialized) {\n        if (serialized.isError) {\n            throw Object.assign(new Error(serialized.value.message), serialized.value);\n        }\n        throw serialized.value;\n    },\n};\n/**\n * Allows customizing the serialization of certain values.\n */\nconst transferHandlers = new Map([\n    [\"proxy\", proxyTransferHandler],\n    [\"throw\", throwTransferHandler],\n]);\nfunction isAllowedOrigin(allowedOrigins, origin) {\n    for (const allowedOrigin of allowedOrigins) {\n        if (origin === allowedOrigin || allowedOrigin === \"*\") {\n            return true;\n        }\n        if (allowedOrigin instanceof RegExp && allowedOrigin.test(origin)) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction expose(obj, ep = globalThis, allowedOrigins = [\"*\"]) {\n    ep.addEventListener(\"message\", function callback(ev) {\n        if (!ev || !ev.data) {\n            return;\n        }\n        if (!isAllowedOrigin(allowedOrigins, ev.origin)) {\n            console.warn(`Invalid origin '${ev.origin}' for comlink proxy`);\n            return;\n        }\n        const { id, type, path } = Object.assign({ path: [] }, ev.data);\n        const argumentList = (ev.data.argumentList || []).map(fromWireValue);\n        let returnValue;\n        try {\n            const parent = path.slice(0, -1).reduce((obj, prop) => obj[prop], obj);\n            const rawValue = path.reduce((obj, prop) => obj[prop], obj);\n            switch (type) {\n                case \"GET\" /* MessageType.GET */:\n                    {\n                        returnValue = rawValue;\n                    }\n                    break;\n                case \"SET\" /* MessageType.SET */:\n                    {\n                        parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\n                        returnValue = true;\n                    }\n                    break;\n                case \"APPLY\" /* MessageType.APPLY */:\n                    {\n                        returnValue = rawValue.apply(parent, argumentList);\n                    }\n                    break;\n                case \"CONSTRUCT\" /* MessageType.CONSTRUCT */:\n                    {\n                        const value = new rawValue(...argumentList);\n                        returnValue = proxy(value);\n                    }\n                    break;\n                case \"ENDPOINT\" /* MessageType.ENDPOINT */:\n                    {\n                        const { port1, port2 } = new MessageChannel();\n                        expose(obj, port2);\n                        returnValue = transfer(port1, [port1]);\n                    }\n                    break;\n                case \"RELEASE\" /* MessageType.RELEASE */:\n                    {\n                        returnValue = undefined;\n                    }\n                    break;\n                default:\n                    return;\n            }\n        }\n        catch (value) {\n            returnValue = { value, [throwMarker]: 0 };\n        }\n        Promise.resolve(returnValue)\n            .catch((value) => {\n            return { value, [throwMarker]: 0 };\n        })\n            .then((returnValue) => {\n            const [wireValue, transferables] = toWireValue(returnValue);\n            ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\n            if (type === \"RELEASE\" /* MessageType.RELEASE */) {\n                // detach and deactive after sending release response above.\n                ep.removeEventListener(\"message\", callback);\n                closeEndPoint(ep);\n                if (finalizer in obj && typeof obj[finalizer] === \"function\") {\n                    obj[finalizer]();\n                }\n            }\n        })\n            .catch((error) => {\n            // Send Serialization Error To Caller\n            const [wireValue, transferables] = toWireValue({\n                value: new TypeError(\"Unserializable return value\"),\n                [throwMarker]: 0,\n            });\n            ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\n        });\n    });\n    if (ep.start) {\n        ep.start();\n    }\n}\nfunction isMessagePort(endpoint) {\n    return endpoint.constructor.name === \"MessagePort\";\n}\nfunction closeEndPoint(endpoint) {\n    if (isMessagePort(endpoint))\n        endpoint.close();\n}\nfunction wrap(ep, target) {\n    return createProxy(ep, [], target);\n}\nfunction throwIfProxyReleased(isReleased) {\n    if (isReleased) {\n        throw new Error(\"Proxy has been released and is not useable\");\n    }\n}\nfunction releaseEndpoint(ep) {\n    return requestResponseMessage(ep, {\n        type: \"RELEASE\" /* MessageType.RELEASE */,\n    }).then(() => {\n        closeEndPoint(ep);\n    });\n}\nconst proxyCounter = new WeakMap();\nconst proxyFinalizers = \"FinalizationRegistry\" in globalThis &&\n    new FinalizationRegistry((ep) => {\n        const newCount = (proxyCounter.get(ep) || 0) - 1;\n        proxyCounter.set(ep, newCount);\n        if (newCount === 0) {\n            releaseEndpoint(ep);\n        }\n    });\nfunction registerProxy(proxy, ep) {\n    const newCount = (proxyCounter.get(ep) || 0) + 1;\n    proxyCounter.set(ep, newCount);\n    if (proxyFinalizers) {\n        proxyFinalizers.register(proxy, ep, proxy);\n    }\n}\nfunction unregisterProxy(proxy) {\n    if (proxyFinalizers) {\n        proxyFinalizers.unregister(proxy);\n    }\n}\nfunction createProxy(ep, path = [], target = function () { }) {\n    let isProxyReleased = false;\n    const proxy = new Proxy(target, {\n        get(_target, prop) {\n            throwIfProxyReleased(isProxyReleased);\n            if (prop === releaseProxy) {\n                return () => {\n                    unregisterProxy(proxy);\n                    releaseEndpoint(ep);\n                    isProxyReleased = true;\n                };\n            }\n            if (prop === \"then\") {\n                if (path.length === 0) {\n                    return { then: () => proxy };\n                }\n                const r = requestResponseMessage(ep, {\n                    type: \"GET\" /* MessageType.GET */,\n                    path: path.map((p) => p.toString()),\n                }).then(fromWireValue);\n                return r.then.bind(r);\n            }\n            return createProxy(ep, [...path, prop]);\n        },\n        set(_target, prop, rawValue) {\n            throwIfProxyReleased(isProxyReleased);\n            // FIXME: ES6 Proxy Handler `set` methods are supposed to return a\n            // boolean. To show good will, we return true asynchronously ¯\\_(ツ)_/¯\n            const [value, transferables] = toWireValue(rawValue);\n            return requestResponseMessage(ep, {\n                type: \"SET\" /* MessageType.SET */,\n                path: [...path, prop].map((p) => p.toString()),\n                value,\n            }, transferables).then(fromWireValue);\n        },\n        apply(_target, _thisArg, rawArgumentList) {\n            throwIfProxyReleased(isProxyReleased);\n            const last = path[path.length - 1];\n            if (last === createEndpoint) {\n                return requestResponseMessage(ep, {\n                    type: \"ENDPOINT\" /* MessageType.ENDPOINT */,\n                }).then(fromWireValue);\n            }\n            // We just pretend that `bind()` didn’t happen.\n            if (last === \"bind\") {\n                return createProxy(ep, path.slice(0, -1));\n            }\n            const [argumentList, transferables] = processArguments(rawArgumentList);\n            return requestResponseMessage(ep, {\n                type: \"APPLY\" /* MessageType.APPLY */,\n                path: path.map((p) => p.toString()),\n                argumentList,\n            }, transferables).then(fromWireValue);\n        },\n        construct(_target, rawArgumentList) {\n            throwIfProxyReleased(isProxyReleased);\n            const [argumentList, transferables] = processArguments(rawArgumentList);\n            return requestResponseMessage(ep, {\n                type: \"CONSTRUCT\" /* MessageType.CONSTRUCT */,\n                path: path.map((p) => p.toString()),\n                argumentList,\n            }, transferables).then(fromWireValue);\n        },\n    });\n    registerProxy(proxy, ep);\n    return proxy;\n}\nfunction myFlat(arr) {\n    return Array.prototype.concat.apply([], arr);\n}\nfunction processArguments(argumentList) {\n    const processed = argumentList.map(toWireValue);\n    return [processed.map((v) => v[0]), myFlat(processed.map((v) => v[1]))];\n}\nconst transferCache = new WeakMap();\nfunction transfer(obj, transfers) {\n    transferCache.set(obj, transfers);\n    return obj;\n}\nfunction proxy(obj) {\n    return Object.assign(obj, { [proxyMarker]: true });\n}\nfunction windowEndpoint(w, context = globalThis, targetOrigin = \"*\") {\n    return {\n        postMessage: (msg, transferables) => w.postMessage(msg, targetOrigin, transferables),\n        addEventListener: context.addEventListener.bind(context),\n        removeEventListener: context.removeEventListener.bind(context),\n    };\n}\nfunction toWireValue(value) {\n    for (const [name, handler] of transferHandlers) {\n        if (handler.canHandle(value)) {\n            const [serializedValue, transferables] = handler.serialize(value);\n            return [\n                {\n                    type: \"HANDLER\" /* WireValueType.HANDLER */,\n                    name,\n                    value: serializedValue,\n                },\n                transferables,\n            ];\n        }\n    }\n    return [\n        {\n            type: \"RAW\" /* WireValueType.RAW */,\n            value,\n        },\n        transferCache.get(value) || [],\n    ];\n}\nfunction fromWireValue(value) {\n    switch (value.type) {\n        case \"HANDLER\" /* WireValueType.HANDLER */:\n            return transferHandlers.get(value.name).deserialize(value.value);\n        case \"RAW\" /* WireValueType.RAW */:\n            return value.value;\n    }\n}\nfunction requestResponseMessage(ep, msg, transfers) {\n    return new Promise((resolve) => {\n        const id = generateUUID();\n        ep.addEventListener(\"message\", function l(ev) {\n            if (!ev.data || !ev.data.id || ev.data.id !== id) {\n                return;\n            }\n            ep.removeEventListener(\"message\", l);\n            resolve(ev.data);\n        });\n        if (ep.start) {\n            ep.start();\n        }\n        ep.postMessage(Object.assign({ id }, msg), transfers);\n    });\n}\nfunction generateUUID() {\n    return new Array(4)\n        .fill(0)\n        .map(() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16))\n        .join(\"-\");\n}\n\nexport { createEndpoint, expose, finalizer, proxy, proxyMarker, releaseProxy, transfer, transferHandlers, windowEndpoint, wrap };\n//# sourceMappingURL=comlink.mjs.map\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MsgClientImpl = exports.MsgSetSendEnabledResponse = exports.MsgSetSendEnabled = exports.MsgUpdateParamsResponse = exports.MsgUpdateParams = exports.MsgMultiSendResponse = exports.MsgMultiSend = exports.MsgSendResponse = exports.MsgSend = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst coin_1 = require(\"../../base/v1beta1/coin\");\nconst bank_1 = require(\"./bank\");\nconst binary_1 = require(\"../../../binary\");\nconst helpers_1 = require(\"../../../helpers\");\nexports.protobufPackage = \"cosmos.bank.v1beta1\";\nfunction createBaseMsgSend() {\n    return {\n        fromAddress: \"\",\n        toAddress: \"\",\n        amount: [],\n    };\n}\nexports.MsgSend = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgSend\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.fromAddress !== \"\") {\n            writer.uint32(10).string(message.fromAddress);\n        }\n        if (message.toAddress !== \"\") {\n            writer.uint32(18).string(message.toAddress);\n        }\n        for (const v of message.amount) {\n            coin_1.Coin.encode(v, writer.uint32(26).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgSend();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.fromAddress = reader.string();\n                    break;\n                case 2:\n                    message.toAddress = reader.string();\n                    break;\n                case 3:\n                    message.amount.push(coin_1.Coin.decode(reader, reader.uint32()));\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseMsgSend();\n        if ((0, helpers_1.isSet)(object.fromAddress))\n            obj.fromAddress = String(object.fromAddress);\n        if ((0, helpers_1.isSet)(object.toAddress))\n            obj.toAddress = String(object.toAddress);\n        if (Array.isArray(object?.amount))\n            obj.amount = object.amount.map((e) => coin_1.Coin.fromJSON(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.fromAddress !== undefined && (obj.fromAddress = message.fromAddress);\n        message.toAddress !== undefined && (obj.toAddress = message.toAddress);\n        if (message.amount) {\n            obj.amount = message.amount.map((e) => (e ? coin_1.Coin.toJSON(e) : undefined));\n        }\n        else {\n            obj.amount = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseMsgSend();\n        message.fromAddress = object.fromAddress ?? \"\";\n        message.toAddress = object.toAddress ?? \"\";\n        message.amount = object.amount?.map((e) => coin_1.Coin.fromPartial(e)) || [];\n        return message;\n    },\n};\nfunction createBaseMsgSendResponse() {\n    return {};\n}\nexports.MsgSendResponse = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgSendResponse\",\n    encode(_, writer = binary_1.BinaryWriter.create()) {\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgSendResponse();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(_) {\n        const obj = createBaseMsgSendResponse();\n        return obj;\n    },\n    toJSON(_) {\n        const obj = {};\n        return obj;\n    },\n    fromPartial(_) {\n        const message = createBaseMsgSendResponse();\n        return message;\n    },\n};\nfunction createBaseMsgMultiSend() {\n    return {\n        inputs: [],\n        outputs: [],\n    };\n}\nexports.MsgMultiSend = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgMultiSend\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        for (const v of message.inputs) {\n            bank_1.Input.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        for (const v of message.outputs) {\n            bank_1.Output.encode(v, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgMultiSend();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.inputs.push(bank_1.Input.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.outputs.push(bank_1.Output.decode(reader, reader.uint32()));\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseMsgMultiSend();\n        if (Array.isArray(object?.inputs))\n            obj.inputs = object.inputs.map((e) => bank_1.Input.fromJSON(e));\n        if (Array.isArray(object?.outputs))\n            obj.outputs = object.outputs.map((e) => bank_1.Output.fromJSON(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.inputs) {\n            obj.inputs = message.inputs.map((e) => (e ? bank_1.Input.toJSON(e) : undefined));\n        }\n        else {\n            obj.inputs = [];\n        }\n        if (message.outputs) {\n            obj.outputs = message.outputs.map((e) => (e ? bank_1.Output.toJSON(e) : undefined));\n        }\n        else {\n            obj.outputs = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseMsgMultiSend();\n        message.inputs = object.inputs?.map((e) => bank_1.Input.fromPartial(e)) || [];\n        message.outputs = object.outputs?.map((e) => bank_1.Output.fromPartial(e)) || [];\n        return message;\n    },\n};\nfunction createBaseMsgMultiSendResponse() {\n    return {};\n}\nexports.MsgMultiSendResponse = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgMultiSendResponse\",\n    encode(_, writer = binary_1.BinaryWriter.create()) {\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgMultiSendResponse();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(_) {\n        const obj = createBaseMsgMultiSendResponse();\n        return obj;\n    },\n    toJSON(_) {\n        const obj = {};\n        return obj;\n    },\n    fromPartial(_) {\n        const message = createBaseMsgMultiSendResponse();\n        return message;\n    },\n};\nfunction createBaseMsgUpdateParams() {\n    return {\n        authority: \"\",\n        params: bank_1.Params.fromPartial({}),\n    };\n}\nexports.MsgUpdateParams = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgUpdateParams\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.authority !== \"\") {\n            writer.uint32(10).string(message.authority);\n        }\n        if (message.params !== undefined) {\n            bank_1.Params.encode(message.params, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgUpdateParams();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.authority = reader.string();\n                    break;\n                case 2:\n                    message.params = bank_1.Params.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseMsgUpdateParams();\n        if ((0, helpers_1.isSet)(object.authority))\n            obj.authority = String(object.authority);\n        if ((0, helpers_1.isSet)(object.params))\n            obj.params = bank_1.Params.fromJSON(object.params);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.authority !== undefined && (obj.authority = message.authority);\n        message.params !== undefined && (obj.params = message.params ? bank_1.Params.toJSON(message.params) : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseMsgUpdateParams();\n        message.authority = object.authority ?? \"\";\n        if (object.params !== undefined && object.params !== null) {\n            message.params = bank_1.Params.fromPartial(object.params);\n        }\n        return message;\n    },\n};\nfunction createBaseMsgUpdateParamsResponse() {\n    return {};\n}\nexports.MsgUpdateParamsResponse = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgUpdateParamsResponse\",\n    encode(_, writer = binary_1.BinaryWriter.create()) {\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgUpdateParamsResponse();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(_) {\n        const obj = createBaseMsgUpdateParamsResponse();\n        return obj;\n    },\n    toJSON(_) {\n        const obj = {};\n        return obj;\n    },\n    fromPartial(_) {\n        const message = createBaseMsgUpdateParamsResponse();\n        return message;\n    },\n};\nfunction createBaseMsgSetSendEnabled() {\n    return {\n        authority: \"\",\n        sendEnabled: [],\n        useDefaultFor: [],\n    };\n}\nexports.MsgSetSendEnabled = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgSetSendEnabled\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.authority !== \"\") {\n            writer.uint32(10).string(message.authority);\n        }\n        for (const v of message.sendEnabled) {\n            bank_1.SendEnabled.encode(v, writer.uint32(18).fork()).ldelim();\n        }\n        for (const v of message.useDefaultFor) {\n            writer.uint32(26).string(v);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgSetSendEnabled();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.authority = reader.string();\n                    break;\n                case 2:\n                    message.sendEnabled.push(bank_1.SendEnabled.decode(reader, reader.uint32()));\n                    break;\n                case 3:\n                    message.useDefaultFor.push(reader.string());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseMsgSetSendEnabled();\n        if ((0, helpers_1.isSet)(object.authority))\n            obj.authority = String(object.authority);\n        if (Array.isArray(object?.sendEnabled))\n            obj.sendEnabled = object.sendEnabled.map((e) => bank_1.SendEnabled.fromJSON(e));\n        if (Array.isArray(object?.useDefaultFor))\n            obj.useDefaultFor = object.useDefaultFor.map((e) => String(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.authority !== undefined && (obj.authority = message.authority);\n        if (message.sendEnabled) {\n            obj.sendEnabled = message.sendEnabled.map((e) => (e ? bank_1.SendEnabled.toJSON(e) : undefined));\n        }\n        else {\n            obj.sendEnabled = [];\n        }\n        if (message.useDefaultFor) {\n            obj.useDefaultFor = message.useDefaultFor.map((e) => e);\n        }\n        else {\n            obj.useDefaultFor = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseMsgSetSendEnabled();\n        message.authority = object.authority ?? \"\";\n        message.sendEnabled = object.sendEnabled?.map((e) => bank_1.SendEnabled.fromPartial(e)) || [];\n        message.useDefaultFor = object.useDefaultFor?.map((e) => e) || [];\n        return message;\n    },\n};\nfunction createBaseMsgSetSendEnabledResponse() {\n    return {};\n}\nexports.MsgSetSendEnabledResponse = {\n    typeUrl: \"/cosmos.bank.v1beta1.MsgSetSendEnabledResponse\",\n    encode(_, writer = binary_1.BinaryWriter.create()) {\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseMsgSetSendEnabledResponse();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(_) {\n        const obj = createBaseMsgSetSendEnabledResponse();\n        return obj;\n    },\n    toJSON(_) {\n        const obj = {};\n        return obj;\n    },\n    fromPartial(_) {\n        const message = createBaseMsgSetSendEnabledResponse();\n        return message;\n    },\n};\nclass MsgClientImpl {\n    constructor(rpc) {\n        this.rpc = rpc;\n        this.Send = this.Send.bind(this);\n        this.MultiSend = this.MultiSend.bind(this);\n        this.UpdateParams = this.UpdateParams.bind(this);\n        this.SetSendEnabled = this.SetSendEnabled.bind(this);\n    }\n    Send(request) {\n        const data = exports.MsgSend.encode(request).finish();\n        const promise = this.rpc.request(\"cosmos.bank.v1beta1.Msg\", \"Send\", data);\n        return promise.then((data) => exports.MsgSendResponse.decode(new binary_1.BinaryReader(data)));\n    }\n    MultiSend(request) {\n        const data = exports.MsgMultiSend.encode(request).finish();\n        const promise = this.rpc.request(\"cosmos.bank.v1beta1.Msg\", \"MultiSend\", data);\n        return promise.then((data) => exports.MsgMultiSendResponse.decode(new binary_1.BinaryReader(data)));\n    }\n    UpdateParams(request) {\n        const data = exports.MsgUpdateParams.encode(request).finish();\n        const promise = this.rpc.request(\"cosmos.bank.v1beta1.Msg\", \"UpdateParams\", data);\n        return promise.then((data) => exports.MsgUpdateParamsResponse.decode(new binary_1.BinaryReader(data)));\n    }\n    SetSendEnabled(request) {\n        const data = exports.MsgSetSendEnabled.encode(request).finish();\n        const promise = this.rpc.request(\"cosmos.bank.v1beta1.Msg\", \"SetSendEnabled\", data);\n        return promise.then((data) => exports.MsgSetSendEnabledResponse.decode(new binary_1.BinaryReader(data)));\n    }\n}\nexports.MsgClientImpl = MsgClientImpl;\n//# sourceMappingURL=tx.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AuxSignerData = exports.Tip = exports.Fee = exports.ModeInfo_Multi = exports.ModeInfo_Single = exports.ModeInfo = exports.SignerInfo = exports.AuthInfo = exports.TxBody = exports.SignDocDirectAux = exports.SignDoc = exports.TxRaw = exports.Tx = exports.protobufPackage = void 0;\n/* eslint-disable */\nconst any_1 = require(\"../../../google/protobuf/any\");\nconst signing_1 = require(\"../signing/v1beta1/signing\");\nconst multisig_1 = require(\"../../crypto/multisig/v1beta1/multisig\");\nconst coin_1 = require(\"../../base/v1beta1/coin\");\nconst binary_1 = require(\"../../../binary\");\nconst helpers_1 = require(\"../../../helpers\");\nexports.protobufPackage = \"cosmos.tx.v1beta1\";\nfunction createBaseTx() {\n    return {\n        body: undefined,\n        authInfo: undefined,\n        signatures: [],\n    };\n}\nexports.Tx = {\n    typeUrl: \"/cosmos.tx.v1beta1.Tx\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.body !== undefined) {\n            exports.TxBody.encode(message.body, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.authInfo !== undefined) {\n            exports.AuthInfo.encode(message.authInfo, writer.uint32(18).fork()).ldelim();\n        }\n        for (const v of message.signatures) {\n            writer.uint32(26).bytes(v);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseTx();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.body = exports.TxBody.decode(reader, reader.uint32());\n                    break;\n                case 2:\n                    message.authInfo = exports.AuthInfo.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.signatures.push(reader.bytes());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseTx();\n        if ((0, helpers_1.isSet)(object.body))\n            obj.body = exports.TxBody.fromJSON(object.body);\n        if ((0, helpers_1.isSet)(object.authInfo))\n            obj.authInfo = exports.AuthInfo.fromJSON(object.authInfo);\n        if (Array.isArray(object?.signatures))\n            obj.signatures = object.signatures.map((e) => (0, helpers_1.bytesFromBase64)(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.body !== undefined && (obj.body = message.body ? exports.TxBody.toJSON(message.body) : undefined);\n        message.authInfo !== undefined &&\n            (obj.authInfo = message.authInfo ? exports.AuthInfo.toJSON(message.authInfo) : undefined);\n        if (message.signatures) {\n            obj.signatures = message.signatures.map((e) => (0, helpers_1.base64FromBytes)(e !== undefined ? e : new Uint8Array()));\n        }\n        else {\n            obj.signatures = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseTx();\n        if (object.body !== undefined && object.body !== null) {\n            message.body = exports.TxBody.fromPartial(object.body);\n        }\n        if (object.authInfo !== undefined && object.authInfo !== null) {\n            message.authInfo = exports.AuthInfo.fromPartial(object.authInfo);\n        }\n        message.signatures = object.signatures?.map((e) => e) || [];\n        return message;\n    },\n};\nfunction createBaseTxRaw() {\n    return {\n        bodyBytes: new Uint8Array(),\n        authInfoBytes: new Uint8Array(),\n        signatures: [],\n    };\n}\nexports.TxRaw = {\n    typeUrl: \"/cosmos.tx.v1beta1.TxRaw\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.bodyBytes.length !== 0) {\n            writer.uint32(10).bytes(message.bodyBytes);\n        }\n        if (message.authInfoBytes.length !== 0) {\n            writer.uint32(18).bytes(message.authInfoBytes);\n        }\n        for (const v of message.signatures) {\n            writer.uint32(26).bytes(v);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseTxRaw();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.bodyBytes = reader.bytes();\n                    break;\n                case 2:\n                    message.authInfoBytes = reader.bytes();\n                    break;\n                case 3:\n                    message.signatures.push(reader.bytes());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseTxRaw();\n        if ((0, helpers_1.isSet)(object.bodyBytes))\n            obj.bodyBytes = (0, helpers_1.bytesFromBase64)(object.bodyBytes);\n        if ((0, helpers_1.isSet)(object.authInfoBytes))\n            obj.authInfoBytes = (0, helpers_1.bytesFromBase64)(object.authInfoBytes);\n        if (Array.isArray(object?.signatures))\n            obj.signatures = object.signatures.map((e) => (0, helpers_1.bytesFromBase64)(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.bodyBytes !== undefined &&\n            (obj.bodyBytes = (0, helpers_1.base64FromBytes)(message.bodyBytes !== undefined ? message.bodyBytes : new Uint8Array()));\n        message.authInfoBytes !== undefined &&\n            (obj.authInfoBytes = (0, helpers_1.base64FromBytes)(message.authInfoBytes !== undefined ? message.authInfoBytes : new Uint8Array()));\n        if (message.signatures) {\n            obj.signatures = message.signatures.map((e) => (0, helpers_1.base64FromBytes)(e !== undefined ? e : new Uint8Array()));\n        }\n        else {\n            obj.signatures = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseTxRaw();\n        message.bodyBytes = object.bodyBytes ?? new Uint8Array();\n        message.authInfoBytes = object.authInfoBytes ?? new Uint8Array();\n        message.signatures = object.signatures?.map((e) => e) || [];\n        return message;\n    },\n};\nfunction createBaseSignDoc() {\n    return {\n        bodyBytes: new Uint8Array(),\n        authInfoBytes: new Uint8Array(),\n        chainId: \"\",\n        accountNumber: BigInt(0),\n    };\n}\nexports.SignDoc = {\n    typeUrl: \"/cosmos.tx.v1beta1.SignDoc\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.bodyBytes.length !== 0) {\n            writer.uint32(10).bytes(message.bodyBytes);\n        }\n        if (message.authInfoBytes.length !== 0) {\n            writer.uint32(18).bytes(message.authInfoBytes);\n        }\n        if (message.chainId !== \"\") {\n            writer.uint32(26).string(message.chainId);\n        }\n        if (message.accountNumber !== BigInt(0)) {\n            writer.uint32(32).uint64(message.accountNumber);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseSignDoc();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.bodyBytes = reader.bytes();\n                    break;\n                case 2:\n                    message.authInfoBytes = reader.bytes();\n                    break;\n                case 3:\n                    message.chainId = reader.string();\n                    break;\n                case 4:\n                    message.accountNumber = reader.uint64();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseSignDoc();\n        if ((0, helpers_1.isSet)(object.bodyBytes))\n            obj.bodyBytes = (0, helpers_1.bytesFromBase64)(object.bodyBytes);\n        if ((0, helpers_1.isSet)(object.authInfoBytes))\n            obj.authInfoBytes = (0, helpers_1.bytesFromBase64)(object.authInfoBytes);\n        if ((0, helpers_1.isSet)(object.chainId))\n            obj.chainId = String(object.chainId);\n        if ((0, helpers_1.isSet)(object.accountNumber))\n            obj.accountNumber = BigInt(object.accountNumber.toString());\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.bodyBytes !== undefined &&\n            (obj.bodyBytes = (0, helpers_1.base64FromBytes)(message.bodyBytes !== undefined ? message.bodyBytes : new Uint8Array()));\n        message.authInfoBytes !== undefined &&\n            (obj.authInfoBytes = (0, helpers_1.base64FromBytes)(message.authInfoBytes !== undefined ? message.authInfoBytes : new Uint8Array()));\n        message.chainId !== undefined && (obj.chainId = message.chainId);\n        message.accountNumber !== undefined &&\n            (obj.accountNumber = (message.accountNumber || BigInt(0)).toString());\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseSignDoc();\n        message.bodyBytes = object.bodyBytes ?? new Uint8Array();\n        message.authInfoBytes = object.authInfoBytes ?? new Uint8Array();\n        message.chainId = object.chainId ?? \"\";\n        if (object.accountNumber !== undefined && object.accountNumber !== null) {\n            message.accountNumber = BigInt(object.accountNumber.toString());\n        }\n        return message;\n    },\n};\nfunction createBaseSignDocDirectAux() {\n    return {\n        bodyBytes: new Uint8Array(),\n        publicKey: undefined,\n        chainId: \"\",\n        accountNumber: BigInt(0),\n        sequence: BigInt(0),\n        tip: undefined,\n    };\n}\nexports.SignDocDirectAux = {\n    typeUrl: \"/cosmos.tx.v1beta1.SignDocDirectAux\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.bodyBytes.length !== 0) {\n            writer.uint32(10).bytes(message.bodyBytes);\n        }\n        if (message.publicKey !== undefined) {\n            any_1.Any.encode(message.publicKey, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.chainId !== \"\") {\n            writer.uint32(26).string(message.chainId);\n        }\n        if (message.accountNumber !== BigInt(0)) {\n            writer.uint32(32).uint64(message.accountNumber);\n        }\n        if (message.sequence !== BigInt(0)) {\n            writer.uint32(40).uint64(message.sequence);\n        }\n        if (message.tip !== undefined) {\n            exports.Tip.encode(message.tip, writer.uint32(50).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseSignDocDirectAux();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.bodyBytes = reader.bytes();\n                    break;\n                case 2:\n                    message.publicKey = any_1.Any.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.chainId = reader.string();\n                    break;\n                case 4:\n                    message.accountNumber = reader.uint64();\n                    break;\n                case 5:\n                    message.sequence = reader.uint64();\n                    break;\n                case 6:\n                    message.tip = exports.Tip.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseSignDocDirectAux();\n        if ((0, helpers_1.isSet)(object.bodyBytes))\n            obj.bodyBytes = (0, helpers_1.bytesFromBase64)(object.bodyBytes);\n        if ((0, helpers_1.isSet)(object.publicKey))\n            obj.publicKey = any_1.Any.fromJSON(object.publicKey);\n        if ((0, helpers_1.isSet)(object.chainId))\n            obj.chainId = String(object.chainId);\n        if ((0, helpers_1.isSet)(object.accountNumber))\n            obj.accountNumber = BigInt(object.accountNumber.toString());\n        if ((0, helpers_1.isSet)(object.sequence))\n            obj.sequence = BigInt(object.sequence.toString());\n        if ((0, helpers_1.isSet)(object.tip))\n            obj.tip = exports.Tip.fromJSON(object.tip);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.bodyBytes !== undefined &&\n            (obj.bodyBytes = (0, helpers_1.base64FromBytes)(message.bodyBytes !== undefined ? message.bodyBytes : new Uint8Array()));\n        message.publicKey !== undefined &&\n            (obj.publicKey = message.publicKey ? any_1.Any.toJSON(message.publicKey) : undefined);\n        message.chainId !== undefined && (obj.chainId = message.chainId);\n        message.accountNumber !== undefined &&\n            (obj.accountNumber = (message.accountNumber || BigInt(0)).toString());\n        message.sequence !== undefined && (obj.sequence = (message.sequence || BigInt(0)).toString());\n        message.tip !== undefined && (obj.tip = message.tip ? exports.Tip.toJSON(message.tip) : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseSignDocDirectAux();\n        message.bodyBytes = object.bodyBytes ?? new Uint8Array();\n        if (object.publicKey !== undefined && object.publicKey !== null) {\n            message.publicKey = any_1.Any.fromPartial(object.publicKey);\n        }\n        message.chainId = object.chainId ?? \"\";\n        if (object.accountNumber !== undefined && object.accountNumber !== null) {\n            message.accountNumber = BigInt(object.accountNumber.toString());\n        }\n        if (object.sequence !== undefined && object.sequence !== null) {\n            message.sequence = BigInt(object.sequence.toString());\n        }\n        if (object.tip !== undefined && object.tip !== null) {\n            message.tip = exports.Tip.fromPartial(object.tip);\n        }\n        return message;\n    },\n};\nfunction createBaseTxBody() {\n    return {\n        messages: [],\n        memo: \"\",\n        timeoutHeight: BigInt(0),\n        extensionOptions: [],\n        nonCriticalExtensionOptions: [],\n    };\n}\nexports.TxBody = {\n    typeUrl: \"/cosmos.tx.v1beta1.TxBody\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        for (const v of message.messages) {\n            any_1.Any.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.memo !== \"\") {\n            writer.uint32(18).string(message.memo);\n        }\n        if (message.timeoutHeight !== BigInt(0)) {\n            writer.uint32(24).uint64(message.timeoutHeight);\n        }\n        for (const v of message.extensionOptions) {\n            any_1.Any.encode(v, writer.uint32(8186).fork()).ldelim();\n        }\n        for (const v of message.nonCriticalExtensionOptions) {\n            any_1.Any.encode(v, writer.uint32(16378).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseTxBody();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.messages.push(any_1.Any.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.memo = reader.string();\n                    break;\n                case 3:\n                    message.timeoutHeight = reader.uint64();\n                    break;\n                case 1023:\n                    message.extensionOptions.push(any_1.Any.decode(reader, reader.uint32()));\n                    break;\n                case 2047:\n                    message.nonCriticalExtensionOptions.push(any_1.Any.decode(reader, reader.uint32()));\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseTxBody();\n        if (Array.isArray(object?.messages))\n            obj.messages = object.messages.map((e) => any_1.Any.fromJSON(e));\n        if ((0, helpers_1.isSet)(object.memo))\n            obj.memo = String(object.memo);\n        if ((0, helpers_1.isSet)(object.timeoutHeight))\n            obj.timeoutHeight = BigInt(object.timeoutHeight.toString());\n        if (Array.isArray(object?.extensionOptions))\n            obj.extensionOptions = object.extensionOptions.map((e) => any_1.Any.fromJSON(e));\n        if (Array.isArray(object?.nonCriticalExtensionOptions))\n            obj.nonCriticalExtensionOptions = object.nonCriticalExtensionOptions.map((e) => any_1.Any.fromJSON(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.messages) {\n            obj.messages = message.messages.map((e) => (e ? any_1.Any.toJSON(e) : undefined));\n        }\n        else {\n            obj.messages = [];\n        }\n        message.memo !== undefined && (obj.memo = message.memo);\n        message.timeoutHeight !== undefined &&\n            (obj.timeoutHeight = (message.timeoutHeight || BigInt(0)).toString());\n        if (message.extensionOptions) {\n            obj.extensionOptions = message.extensionOptions.map((e) => (e ? any_1.Any.toJSON(e) : undefined));\n        }\n        else {\n            obj.extensionOptions = [];\n        }\n        if (message.nonCriticalExtensionOptions) {\n            obj.nonCriticalExtensionOptions = message.nonCriticalExtensionOptions.map((e) => e ? any_1.Any.toJSON(e) : undefined);\n        }\n        else {\n            obj.nonCriticalExtensionOptions = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseTxBody();\n        message.messages = object.messages?.map((e) => any_1.Any.fromPartial(e)) || [];\n        message.memo = object.memo ?? \"\";\n        if (object.timeoutHeight !== undefined && object.timeoutHeight !== null) {\n            message.timeoutHeight = BigInt(object.timeoutHeight.toString());\n        }\n        message.extensionOptions = object.extensionOptions?.map((e) => any_1.Any.fromPartial(e)) || [];\n        message.nonCriticalExtensionOptions =\n            object.nonCriticalExtensionOptions?.map((e) => any_1.Any.fromPartial(e)) || [];\n        return message;\n    },\n};\nfunction createBaseAuthInfo() {\n    return {\n        signerInfos: [],\n        fee: undefined,\n        tip: undefined,\n    };\n}\nexports.AuthInfo = {\n    typeUrl: \"/cosmos.tx.v1beta1.AuthInfo\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        for (const v of message.signerInfos) {\n            exports.SignerInfo.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.fee !== undefined) {\n            exports.Fee.encode(message.fee, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.tip !== undefined) {\n            exports.Tip.encode(message.tip, writer.uint32(26).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseAuthInfo();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.signerInfos.push(exports.SignerInfo.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.fee = exports.Fee.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.tip = exports.Tip.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseAuthInfo();\n        if (Array.isArray(object?.signerInfos))\n            obj.signerInfos = object.signerInfos.map((e) => exports.SignerInfo.fromJSON(e));\n        if ((0, helpers_1.isSet)(object.fee))\n            obj.fee = exports.Fee.fromJSON(object.fee);\n        if ((0, helpers_1.isSet)(object.tip))\n            obj.tip = exports.Tip.fromJSON(object.tip);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.signerInfos) {\n            obj.signerInfos = message.signerInfos.map((e) => (e ? exports.SignerInfo.toJSON(e) : undefined));\n        }\n        else {\n            obj.signerInfos = [];\n        }\n        message.fee !== undefined && (obj.fee = message.fee ? exports.Fee.toJSON(message.fee) : undefined);\n        message.tip !== undefined && (obj.tip = message.tip ? exports.Tip.toJSON(message.tip) : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseAuthInfo();\n        message.signerInfos = object.signerInfos?.map((e) => exports.SignerInfo.fromPartial(e)) || [];\n        if (object.fee !== undefined && object.fee !== null) {\n            message.fee = exports.Fee.fromPartial(object.fee);\n        }\n        if (object.tip !== undefined && object.tip !== null) {\n            message.tip = exports.Tip.fromPartial(object.tip);\n        }\n        return message;\n    },\n};\nfunction createBaseSignerInfo() {\n    return {\n        publicKey: undefined,\n        modeInfo: undefined,\n        sequence: BigInt(0),\n    };\n}\nexports.SignerInfo = {\n    typeUrl: \"/cosmos.tx.v1beta1.SignerInfo\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.publicKey !== undefined) {\n            any_1.Any.encode(message.publicKey, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.modeInfo !== undefined) {\n            exports.ModeInfo.encode(message.modeInfo, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.sequence !== BigInt(0)) {\n            writer.uint32(24).uint64(message.sequence);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseSignerInfo();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.publicKey = any_1.Any.decode(reader, reader.uint32());\n                    break;\n                case 2:\n                    message.modeInfo = exports.ModeInfo.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.sequence = reader.uint64();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseSignerInfo();\n        if ((0, helpers_1.isSet)(object.publicKey))\n            obj.publicKey = any_1.Any.fromJSON(object.publicKey);\n        if ((0, helpers_1.isSet)(object.modeInfo))\n            obj.modeInfo = exports.ModeInfo.fromJSON(object.modeInfo);\n        if ((0, helpers_1.isSet)(object.sequence))\n            obj.sequence = BigInt(object.sequence.toString());\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.publicKey !== undefined &&\n            (obj.publicKey = message.publicKey ? any_1.Any.toJSON(message.publicKey) : undefined);\n        message.modeInfo !== undefined &&\n            (obj.modeInfo = message.modeInfo ? exports.ModeInfo.toJSON(message.modeInfo) : undefined);\n        message.sequence !== undefined && (obj.sequence = (message.sequence || BigInt(0)).toString());\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseSignerInfo();\n        if (object.publicKey !== undefined && object.publicKey !== null) {\n            message.publicKey = any_1.Any.fromPartial(object.publicKey);\n        }\n        if (object.modeInfo !== undefined && object.modeInfo !== null) {\n            message.modeInfo = exports.ModeInfo.fromPartial(object.modeInfo);\n        }\n        if (object.sequence !== undefined && object.sequence !== null) {\n            message.sequence = BigInt(object.sequence.toString());\n        }\n        return message;\n    },\n};\nfunction createBaseModeInfo() {\n    return {\n        single: undefined,\n        multi: undefined,\n    };\n}\nexports.ModeInfo = {\n    typeUrl: \"/cosmos.tx.v1beta1.ModeInfo\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.single !== undefined) {\n            exports.ModeInfo_Single.encode(message.single, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.multi !== undefined) {\n            exports.ModeInfo_Multi.encode(message.multi, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseModeInfo();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.single = exports.ModeInfo_Single.decode(reader, reader.uint32());\n                    break;\n                case 2:\n                    message.multi = exports.ModeInfo_Multi.decode(reader, reader.uint32());\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseModeInfo();\n        if ((0, helpers_1.isSet)(object.single))\n            obj.single = exports.ModeInfo_Single.fromJSON(object.single);\n        if ((0, helpers_1.isSet)(object.multi))\n            obj.multi = exports.ModeInfo_Multi.fromJSON(object.multi);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.single !== undefined &&\n            (obj.single = message.single ? exports.ModeInfo_Single.toJSON(message.single) : undefined);\n        message.multi !== undefined &&\n            (obj.multi = message.multi ? exports.ModeInfo_Multi.toJSON(message.multi) : undefined);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseModeInfo();\n        if (object.single !== undefined && object.single !== null) {\n            message.single = exports.ModeInfo_Single.fromPartial(object.single);\n        }\n        if (object.multi !== undefined && object.multi !== null) {\n            message.multi = exports.ModeInfo_Multi.fromPartial(object.multi);\n        }\n        return message;\n    },\n};\nfunction createBaseModeInfo_Single() {\n    return {\n        mode: 0,\n    };\n}\nexports.ModeInfo_Single = {\n    typeUrl: \"/cosmos.tx.v1beta1.Single\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.mode !== 0) {\n            writer.uint32(8).int32(message.mode);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseModeInfo_Single();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.mode = reader.int32();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseModeInfo_Single();\n        if ((0, helpers_1.isSet)(object.mode))\n            obj.mode = (0, signing_1.signModeFromJSON)(object.mode);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.mode !== undefined && (obj.mode = (0, signing_1.signModeToJSON)(message.mode));\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseModeInfo_Single();\n        message.mode = object.mode ?? 0;\n        return message;\n    },\n};\nfunction createBaseModeInfo_Multi() {\n    return {\n        bitarray: undefined,\n        modeInfos: [],\n    };\n}\nexports.ModeInfo_Multi = {\n    typeUrl: \"/cosmos.tx.v1beta1.Multi\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.bitarray !== undefined) {\n            multisig_1.CompactBitArray.encode(message.bitarray, writer.uint32(10).fork()).ldelim();\n        }\n        for (const v of message.modeInfos) {\n            exports.ModeInfo.encode(v, writer.uint32(18).fork()).ldelim();\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseModeInfo_Multi();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.bitarray = multisig_1.CompactBitArray.decode(reader, reader.uint32());\n                    break;\n                case 2:\n                    message.modeInfos.push(exports.ModeInfo.decode(reader, reader.uint32()));\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseModeInfo_Multi();\n        if ((0, helpers_1.isSet)(object.bitarray))\n            obj.bitarray = multisig_1.CompactBitArray.fromJSON(object.bitarray);\n        if (Array.isArray(object?.modeInfos))\n            obj.modeInfos = object.modeInfos.map((e) => exports.ModeInfo.fromJSON(e));\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.bitarray !== undefined &&\n            (obj.bitarray = message.bitarray ? multisig_1.CompactBitArray.toJSON(message.bitarray) : undefined);\n        if (message.modeInfos) {\n            obj.modeInfos = message.modeInfos.map((e) => (e ? exports.ModeInfo.toJSON(e) : undefined));\n        }\n        else {\n            obj.modeInfos = [];\n        }\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseModeInfo_Multi();\n        if (object.bitarray !== undefined && object.bitarray !== null) {\n            message.bitarray = multisig_1.CompactBitArray.fromPartial(object.bitarray);\n        }\n        message.modeInfos = object.modeInfos?.map((e) => exports.ModeInfo.fromPartial(e)) || [];\n        return message;\n    },\n};\nfunction createBaseFee() {\n    return {\n        amount: [],\n        gasLimit: BigInt(0),\n        payer: \"\",\n        granter: \"\",\n    };\n}\nexports.Fee = {\n    typeUrl: \"/cosmos.tx.v1beta1.Fee\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        for (const v of message.amount) {\n            coin_1.Coin.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.gasLimit !== BigInt(0)) {\n            writer.uint32(16).uint64(message.gasLimit);\n        }\n        if (message.payer !== \"\") {\n            writer.uint32(26).string(message.payer);\n        }\n        if (message.granter !== \"\") {\n            writer.uint32(34).string(message.granter);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseFee();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.amount.push(coin_1.Coin.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.gasLimit = reader.uint64();\n                    break;\n                case 3:\n                    message.payer = reader.string();\n                    break;\n                case 4:\n                    message.granter = reader.string();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseFee();\n        if (Array.isArray(object?.amount))\n            obj.amount = object.amount.map((e) => coin_1.Coin.fromJSON(e));\n        if ((0, helpers_1.isSet)(object.gasLimit))\n            obj.gasLimit = BigInt(object.gasLimit.toString());\n        if ((0, helpers_1.isSet)(object.payer))\n            obj.payer = String(object.payer);\n        if ((0, helpers_1.isSet)(object.granter))\n            obj.granter = String(object.granter);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.amount) {\n            obj.amount = message.amount.map((e) => (e ? coin_1.Coin.toJSON(e) : undefined));\n        }\n        else {\n            obj.amount = [];\n        }\n        message.gasLimit !== undefined && (obj.gasLimit = (message.gasLimit || BigInt(0)).toString());\n        message.payer !== undefined && (obj.payer = message.payer);\n        message.granter !== undefined && (obj.granter = message.granter);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseFee();\n        message.amount = object.amount?.map((e) => coin_1.Coin.fromPartial(e)) || [];\n        if (object.gasLimit !== undefined && object.gasLimit !== null) {\n            message.gasLimit = BigInt(object.gasLimit.toString());\n        }\n        message.payer = object.payer ?? \"\";\n        message.granter = object.granter ?? \"\";\n        return message;\n    },\n};\nfunction createBaseTip() {\n    return {\n        amount: [],\n        tipper: \"\",\n    };\n}\nexports.Tip = {\n    typeUrl: \"/cosmos.tx.v1beta1.Tip\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        for (const v of message.amount) {\n            coin_1.Coin.encode(v, writer.uint32(10).fork()).ldelim();\n        }\n        if (message.tipper !== \"\") {\n            writer.uint32(18).string(message.tipper);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseTip();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.amount.push(coin_1.Coin.decode(reader, reader.uint32()));\n                    break;\n                case 2:\n                    message.tipper = reader.string();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseTip();\n        if (Array.isArray(object?.amount))\n            obj.amount = object.amount.map((e) => coin_1.Coin.fromJSON(e));\n        if ((0, helpers_1.isSet)(object.tipper))\n            obj.tipper = String(object.tipper);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        if (message.amount) {\n            obj.amount = message.amount.map((e) => (e ? coin_1.Coin.toJSON(e) : undefined));\n        }\n        else {\n            obj.amount = [];\n        }\n        message.tipper !== undefined && (obj.tipper = message.tipper);\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseTip();\n        message.amount = object.amount?.map((e) => coin_1.Coin.fromPartial(e)) || [];\n        message.tipper = object.tipper ?? \"\";\n        return message;\n    },\n};\nfunction createBaseAuxSignerData() {\n    return {\n        address: \"\",\n        signDoc: undefined,\n        mode: 0,\n        sig: new Uint8Array(),\n    };\n}\nexports.AuxSignerData = {\n    typeUrl: \"/cosmos.tx.v1beta1.AuxSignerData\",\n    encode(message, writer = binary_1.BinaryWriter.create()) {\n        if (message.address !== \"\") {\n            writer.uint32(10).string(message.address);\n        }\n        if (message.signDoc !== undefined) {\n            exports.SignDocDirectAux.encode(message.signDoc, writer.uint32(18).fork()).ldelim();\n        }\n        if (message.mode !== 0) {\n            writer.uint32(24).int32(message.mode);\n        }\n        if (message.sig.length !== 0) {\n            writer.uint32(34).bytes(message.sig);\n        }\n        return writer;\n    },\n    decode(input, length) {\n        const reader = input instanceof binary_1.BinaryReader ? input : new binary_1.BinaryReader(input);\n        let end = length === undefined ? reader.len : reader.pos + length;\n        const message = createBaseAuxSignerData();\n        while (reader.pos < end) {\n            const tag = reader.uint32();\n            switch (tag >>> 3) {\n                case 1:\n                    message.address = reader.string();\n                    break;\n                case 2:\n                    message.signDoc = exports.SignDocDirectAux.decode(reader, reader.uint32());\n                    break;\n                case 3:\n                    message.mode = reader.int32();\n                    break;\n                case 4:\n                    message.sig = reader.bytes();\n                    break;\n                default:\n                    reader.skipType(tag & 7);\n                    break;\n            }\n        }\n        return message;\n    },\n    fromJSON(object) {\n        const obj = createBaseAuxSignerData();\n        if ((0, helpers_1.isSet)(object.address))\n            obj.address = String(object.address);\n        if ((0, helpers_1.isSet)(object.signDoc))\n            obj.signDoc = exports.SignDocDirectAux.fromJSON(object.signDoc);\n        if ((0, helpers_1.isSet)(object.mode))\n            obj.mode = (0, signing_1.signModeFromJSON)(object.mode);\n        if ((0, helpers_1.isSet)(object.sig))\n            obj.sig = (0, helpers_1.bytesFromBase64)(object.sig);\n        return obj;\n    },\n    toJSON(message) {\n        const obj = {};\n        message.address !== undefined && (obj.address = message.address);\n        message.signDoc !== undefined &&\n            (obj.signDoc = message.signDoc ? exports.SignDocDirectAux.toJSON(message.signDoc) : undefined);\n        message.mode !== undefined && (obj.mode = (0, signing_1.signModeToJSON)(message.mode));\n        message.sig !== undefined &&\n            (obj.sig = (0, helpers_1.base64FromBytes)(message.sig !== undefined ? message.sig : new Uint8Array()));\n        return obj;\n    },\n    fromPartial(object) {\n        const message = createBaseAuxSignerData();\n        message.address = object.address ?? \"\";\n        if (object.signDoc !== undefined && object.signDoc !== null) {\n            message.signDoc = exports.SignDocDirectAux.fromPartial(object.signDoc);\n        }\n        message.mode = object.mode ?? 0;\n        message.sig = object.sig ?? new Uint8Array();\n        return message;\n    },\n};\n//# sourceMappingURL=tx.js.map","var global = typeof self !== 'undefined' ? self : this;\nvar __self__ = (function () {\nfunction F() {\nthis.fetch = false;\nthis.DOMException = global.DOMException\n}\nF.prototype = global;\nreturn new F();\n})();\n(function(self) {\n\nvar irrelevant = (function (exports) {\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n  return exports;\n\n})({});\n})(__self__);\n__self__.fetch.ponyfill = true;\n// Remove \"polyfill\" property added by whatwg-fetch\ndelete __self__.fetch.polyfill;\n// Choose between native implementation (global) or custom implementation (__self__)\n// var ctx = global.fetch ? global : __self__;\nvar ctx = __self__; // this line disable service worker support temporarily\nexports = ctx.fetch // To enable: import fetch from 'cross-fetch'\nexports.default = ctx.fetch // For TypeScript consumers without esModuleInterop.\nexports.fetch = ctx.fetch // To enable: import {fetch} from 'cross-fetch'\nexports.Headers = ctx.Headers\nexports.Request = ctx.Request\nexports.Response = ctx.Response\nmodule.exports = exports\n","/*\n * Date Format 1.2.3\n * (c) 2007-2009 Steven Levithan <stevenlevithan.com>\n * MIT license\n *\n * Includes enhancements by Scott Trenda <scott.trenda.net>\n * and Kris Kowal <cixar.com/~kris.kowal/>\n *\n * Accepts a date, a mask, or a date and a mask.\n * Returns a formatted version of the given date.\n * The date defaults to the current date/time.\n * The mask defaults to dateFormat.masks.default.\n */\n\n(function(global) {\n  'use strict';\n\n  var dateFormat = (function() {\n      var token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\\1?|[LloSZWN]|\"[^\"]*\"|'[^']*'/g;\n      var timezone = /\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b/g;\n      var timezoneClip = /[^-+\\dA-Z]/g;\n  \n      // Regexes and supporting functions are cached through closure\n      return function (date, mask, utc, gmt) {\n  \n        // You can't provide utc if you skip other args (use the 'UTC:' mask prefix)\n        if (arguments.length === 1 && kindOf(date) === 'string' && !/\\d/.test(date)) {\n          mask = date;\n          date = undefined;\n        }\n  \n        date = date || new Date;\n  \n        if(!(date instanceof Date)) {\n          date = new Date(date);\n        }\n  \n        if (isNaN(date)) {\n          throw TypeError('Invalid date');\n        }\n  \n        mask = String(dateFormat.masks[mask] || mask || dateFormat.masks['default']);\n  \n        // Allow setting the utc/gmt argument via the mask\n        var maskSlice = mask.slice(0, 4);\n        if (maskSlice === 'UTC:' || maskSlice === 'GMT:') {\n          mask = mask.slice(4);\n          utc = true;\n          if (maskSlice === 'GMT:') {\n            gmt = true;\n          }\n        }\n  \n        var _ = utc ? 'getUTC' : 'get';\n        var d = date[_ + 'Date']();\n        var D = date[_ + 'Day']();\n        var m = date[_ + 'Month']();\n        var y = date[_ + 'FullYear']();\n        var H = date[_ + 'Hours']();\n        var M = date[_ + 'Minutes']();\n        var s = date[_ + 'Seconds']();\n        var L = date[_ + 'Milliseconds']();\n        var o = utc ? 0 : date.getTimezoneOffset();\n        var W = getWeek(date);\n        var N = getDayOfWeek(date);\n        var flags = {\n          d:    d,\n          dd:   pad(d),\n          ddd:  dateFormat.i18n.dayNames[D],\n          dddd: dateFormat.i18n.dayNames[D + 7],\n          m:    m + 1,\n          mm:   pad(m + 1),\n          mmm:  dateFormat.i18n.monthNames[m],\n          mmmm: dateFormat.i18n.monthNames[m + 12],\n          yy:   String(y).slice(2),\n          yyyy: y,\n          h:    H % 12 || 12,\n          hh:   pad(H % 12 || 12),\n          H:    H,\n          HH:   pad(H),\n          M:    M,\n          MM:   pad(M),\n          s:    s,\n          ss:   pad(s),\n          l:    pad(L, 3),\n          L:    pad(Math.round(L / 10)),\n          t:    H < 12 ? dateFormat.i18n.timeNames[0] : dateFormat.i18n.timeNames[1],\n          tt:   H < 12 ? dateFormat.i18n.timeNames[2] : dateFormat.i18n.timeNames[3],\n          T:    H < 12 ? dateFormat.i18n.timeNames[4] : dateFormat.i18n.timeNames[5],\n          TT:   H < 12 ? dateFormat.i18n.timeNames[6] : dateFormat.i18n.timeNames[7],\n          Z:    gmt ? 'GMT' : utc ? 'UTC' : (String(date).match(timezone) || ['']).pop().replace(timezoneClip, ''),\n          o:    (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),\n          S:    ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10],\n          W:    W,\n          N:    N\n        };\n  \n        return mask.replace(token, function (match) {\n          if (match in flags) {\n            return flags[match];\n          }\n          return match.slice(1, match.length - 1);\n        });\n      };\n    })();\n\n  dateFormat.masks = {\n    'default':               'ddd mmm dd yyyy HH:MM:ss',\n    'shortDate':             'm/d/yy',\n    'mediumDate':            'mmm d, yyyy',\n    'longDate':              'mmmm d, yyyy',\n    'fullDate':              'dddd, mmmm d, yyyy',\n    'shortTime':             'h:MM TT',\n    'mediumTime':            'h:MM:ss TT',\n    'longTime':              'h:MM:ss TT Z',\n    'isoDate':               'yyyy-mm-dd',\n    'isoTime':               'HH:MM:ss',\n    'isoDateTime':           'yyyy-mm-dd\\'T\\'HH:MM:sso',\n    'isoUtcDateTime':        'UTC:yyyy-mm-dd\\'T\\'HH:MM:ss\\'Z\\'',\n    'expiresHeaderFormat':   'ddd, dd mmm yyyy HH:MM:ss Z'\n  };\n\n  // Internationalization strings\n  dateFormat.i18n = {\n    dayNames: [\n      'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat',\n      'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'\n    ],\n    monthNames: [\n      'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec',\n      'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'\n    ],\n    timeNames: [\n      'a', 'p', 'am', 'pm', 'A', 'P', 'AM', 'PM'\n    ]\n  };\n\nfunction pad(val, len) {\n  val = String(val);\n  len = len || 2;\n  while (val.length < len) {\n    val = '0' + val;\n  }\n  return val;\n}\n\n/**\n * Get the ISO 8601 week number\n * Based on comments from\n * http://techblog.procurios.nl/k/n618/news/view/33796/14863/Calculate-ISO-8601-week-and-year-in-javascript.html\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getWeek(date) {\n  // Remove time components of date\n  var targetThursday = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n  // Change date to Thursday same week\n  targetThursday.setDate(targetThursday.getDate() - ((targetThursday.getDay() + 6) % 7) + 3);\n\n  // Take January 4th as it is always in week 1 (see ISO 8601)\n  var firstThursday = new Date(targetThursday.getFullYear(), 0, 4);\n\n  // Change date to Thursday same week\n  firstThursday.setDate(firstThursday.getDate() - ((firstThursday.getDay() + 6) % 7) + 3);\n\n  // Check if daylight-saving-time-switch occurred and correct for it\n  var ds = targetThursday.getTimezoneOffset() - firstThursday.getTimezoneOffset();\n  targetThursday.setHours(targetThursday.getHours() - ds);\n\n  // Number of weeks between target Thursday and first Thursday\n  var weekDiff = (targetThursday - firstThursday) / (86400000*7);\n  return 1 + Math.floor(weekDiff);\n}\n\n/**\n * Get ISO-8601 numeric representation of the day of the week\n * 1 (for Monday) through 7 (for Sunday)\n * \n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getDayOfWeek(date) {\n  var dow = date.getDay();\n  if(dow === 0) {\n    dow = 7;\n  }\n  return dow;\n}\n\n/**\n * kind-of shortcut\n * @param  {*} val\n * @return {String}\n */\nfunction kindOf(val) {\n  if (val === null) {\n    return 'null';\n  }\n\n  if (val === undefined) {\n    return 'undefined';\n  }\n\n  if (typeof val !== 'object') {\n    return typeof val;\n  }\n\n  if (Array.isArray(val)) {\n    return 'array';\n  }\n\n  return {}.toString.call(val)\n    .slice(8, -1).toLowerCase();\n};\n\n\n\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return dateFormat;\n    });\n  } else if (typeof exports === 'object') {\n    module.exports = dateFormat;\n  } else {\n    global.dateFormat = dateFormat;\n  }\n})(this);\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.slice(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","'use strict';\n\n// From https://github.com/sindresorhus/random-int/blob/c37741b56f76b9160b0b63dae4e9c64875128146/index.js#L13-L15\nconst randomInteger = (minimum, maximum) => Math.floor((Math.random() * (maximum - minimum + 1)) + minimum);\n\nconst createAbortError = () => {\n\tconst error = new Error('Delay aborted');\n\terror.name = 'AbortError';\n\treturn error;\n};\n\nconst createDelay = ({clearTimeout: defaultClear, setTimeout: set, willResolve}) => (ms, {value, signal} = {}) => {\n\tif (signal && signal.aborted) {\n\t\treturn Promise.reject(createAbortError());\n\t}\n\n\tlet timeoutId;\n\tlet settle;\n\tlet rejectFn;\n\tconst clear = defaultClear || clearTimeout;\n\n\tconst signalListener = () => {\n\t\tclear(timeoutId);\n\t\trejectFn(createAbortError());\n\t};\n\n\tconst cleanup = () => {\n\t\tif (signal) {\n\t\t\tsignal.removeEventListener('abort', signalListener);\n\t\t}\n\t};\n\n\tconst delayPromise = new Promise((resolve, reject) => {\n\t\tsettle = () => {\n\t\t\tcleanup();\n\t\t\tif (willResolve) {\n\t\t\t\tresolve(value);\n\t\t\t} else {\n\t\t\t\treject(value);\n\t\t\t}\n\t\t};\n\n\t\trejectFn = reject;\n\t\ttimeoutId = (set || setTimeout)(settle, ms);\n\t});\n\n\tif (signal) {\n\t\tsignal.addEventListener('abort', signalListener, {once: true});\n\t}\n\n\tdelayPromise.clear = () => {\n\t\tclear(timeoutId);\n\t\ttimeoutId = null;\n\t\tsettle();\n\t};\n\n\treturn delayPromise;\n};\n\nconst createWithTimers = clearAndSet => {\n\tconst delay = createDelay({...clearAndSet, willResolve: true});\n\tdelay.reject = createDelay({...clearAndSet, willResolve: false});\n\tdelay.range = (minimum, maximum, options) => delay(randomInteger(minimum, maximum), options);\n\treturn delay;\n};\n\nconst delay = createWithTimers();\ndelay.createWithTimers = createWithTimers;\n\nmodule.exports = delay;\n// TODO: Remove this for the next major release\nmodule.exports.default = delay;\n","'use strict';\n\n/**\n * Custom implementation of a double ended queue.\n */\nfunction Denque(array, options) {\n  var options = options || {};\n  this._capacity = options.capacity;\n\n  this._head = 0;\n  this._tail = 0;\n\n  if (Array.isArray(array)) {\n    this._fromArray(array);\n  } else {\n    this._capacityMask = 0x3;\n    this._list = new Array(4);\n  }\n}\n\n/**\n * --------------\n *  PUBLIC API\n * -------------\n */\n\n/**\n * Returns the item at the specified index from the list.\n * 0 is the first element, 1 is the second, and so on...\n * Elements at negative values are that many from the end: -1 is one before the end\n * (the last element), -2 is two before the end (one before last), etc.\n * @param index\n * @returns {*}\n */\nDenque.prototype.peekAt = function peekAt(index) {\n  var i = index;\n  // expect a number or return undefined\n  if ((i !== (i | 0))) {\n    return void 0;\n  }\n  var len = this.size();\n  if (i >= len || i < -len) return undefined;\n  if (i < 0) i += len;\n  i = (this._head + i) & this._capacityMask;\n  return this._list[i];\n};\n\n/**\n * Alias for peekAt()\n * @param i\n * @returns {*}\n */\nDenque.prototype.get = function get(i) {\n  return this.peekAt(i);\n};\n\n/**\n * Returns the first item in the list without removing it.\n * @returns {*}\n */\nDenque.prototype.peek = function peek() {\n  if (this._head === this._tail) return undefined;\n  return this._list[this._head];\n};\n\n/**\n * Alias for peek()\n * @returns {*}\n */\nDenque.prototype.peekFront = function peekFront() {\n  return this.peek();\n};\n\n/**\n * Returns the item that is at the back of the queue without removing it.\n * Uses peekAt(-1)\n */\nDenque.prototype.peekBack = function peekBack() {\n  return this.peekAt(-1);\n};\n\n/**\n * Returns the current length of the queue\n * @return {Number}\n */\nObject.defineProperty(Denque.prototype, 'length', {\n  get: function length() {\n    return this.size();\n  }\n});\n\n/**\n * Return the number of items on the list, or 0 if empty.\n * @returns {number}\n */\nDenque.prototype.size = function size() {\n  if (this._head === this._tail) return 0;\n  if (this._head < this._tail) return this._tail - this._head;\n  else return this._capacityMask + 1 - (this._head - this._tail);\n};\n\n/**\n * Add an item at the beginning of the list.\n * @param item\n */\nDenque.prototype.unshift = function unshift(item) {\n  if (arguments.length === 0) return this.size();\n  var len = this._list.length;\n  this._head = (this._head - 1 + len) & this._capacityMask;\n  this._list[this._head] = item;\n  if (this._tail === this._head) this._growArray();\n  if (this._capacity && this.size() > this._capacity) this.pop();\n  if (this._head < this._tail) return this._tail - this._head;\n  else return this._capacityMask + 1 - (this._head - this._tail);\n};\n\n/**\n * Remove and return the first item on the list,\n * Returns undefined if the list is empty.\n * @returns {*}\n */\nDenque.prototype.shift = function shift() {\n  var head = this._head;\n  if (head === this._tail) return undefined;\n  var item = this._list[head];\n  this._list[head] = undefined;\n  this._head = (head + 1) & this._capacityMask;\n  if (head < 2 && this._tail > 10000 && this._tail <= this._list.length >>> 2) this._shrinkArray();\n  return item;\n};\n\n/**\n * Add an item to the bottom of the list.\n * @param item\n */\nDenque.prototype.push = function push(item) {\n  if (arguments.length === 0) return this.size();\n  var tail = this._tail;\n  this._list[tail] = item;\n  this._tail = (tail + 1) & this._capacityMask;\n  if (this._tail === this._head) {\n    this._growArray();\n  }\n  if (this._capacity && this.size() > this._capacity) {\n    this.shift();\n  }\n  if (this._head < this._tail) return this._tail - this._head;\n  else return this._capacityMask + 1 - (this._head - this._tail);\n};\n\n/**\n * Remove and return the last item on the list.\n * Returns undefined if the list is empty.\n * @returns {*}\n */\nDenque.prototype.pop = function pop() {\n  var tail = this._tail;\n  if (tail === this._head) return undefined;\n  var len = this._list.length;\n  this._tail = (tail - 1 + len) & this._capacityMask;\n  var item = this._list[this._tail];\n  this._list[this._tail] = undefined;\n  if (this._head < 2 && tail > 10000 && tail <= len >>> 2) this._shrinkArray();\n  return item;\n};\n\n/**\n * Remove and return the item at the specified index from the list.\n * Returns undefined if the list is empty.\n * @param index\n * @returns {*}\n */\nDenque.prototype.removeOne = function removeOne(index) {\n  var i = index;\n  // expect a number or return undefined\n  if ((i !== (i | 0))) {\n    return void 0;\n  }\n  if (this._head === this._tail) return void 0;\n  var size = this.size();\n  var len = this._list.length;\n  if (i >= size || i < -size) return void 0;\n  if (i < 0) i += size;\n  i = (this._head + i) & this._capacityMask;\n  var item = this._list[i];\n  var k;\n  if (index < size / 2) {\n    for (k = index; k > 0; k--) {\n      this._list[i] = this._list[i = (i - 1 + len) & this._capacityMask];\n    }\n    this._list[i] = void 0;\n    this._head = (this._head + 1 + len) & this._capacityMask;\n  } else {\n    for (k = size - 1 - index; k > 0; k--) {\n      this._list[i] = this._list[i = (i + 1 + len) & this._capacityMask];\n    }\n    this._list[i] = void 0;\n    this._tail = (this._tail - 1 + len) & this._capacityMask;\n  }\n  return item;\n};\n\n/**\n * Remove number of items from the specified index from the list.\n * Returns array of removed items.\n * Returns undefined if the list is empty.\n * @param index\n * @param count\n * @returns {array}\n */\nDenque.prototype.remove = function remove(index, count) {\n  var i = index;\n  var removed;\n  var del_count = count;\n  // expect a number or return undefined\n  if ((i !== (i | 0))) {\n    return void 0;\n  }\n  if (this._head === this._tail) return void 0;\n  var size = this.size();\n  var len = this._list.length;\n  if (i >= size || i < -size || count < 1) return void 0;\n  if (i < 0) i += size;\n  if (count === 1 || !count) {\n    removed = new Array(1);\n    removed[0] = this.removeOne(i);\n    return removed;\n  }\n  if (i === 0 && i + count >= size) {\n    removed = this.toArray();\n    this.clear();\n    return removed;\n  }\n  if (i + count > size) count = size - i;\n  var k;\n  removed = new Array(count);\n  for (k = 0; k < count; k++) {\n    removed[k] = this._list[(this._head + i + k) & this._capacityMask];\n  }\n  i = (this._head + i) & this._capacityMask;\n  if (index + count === size) {\n    this._tail = (this._tail - count + len) & this._capacityMask;\n    for (k = count; k > 0; k--) {\n      this._list[i = (i + 1 + len) & this._capacityMask] = void 0;\n    }\n    return removed;\n  }\n  if (index === 0) {\n    this._head = (this._head + count + len) & this._capacityMask;\n    for (k = count - 1; k > 0; k--) {\n      this._list[i = (i + 1 + len) & this._capacityMask] = void 0;\n    }\n    return removed;\n  }\n  if (i < size / 2) {\n    this._head = (this._head + index + count + len) & this._capacityMask;\n    for (k = index; k > 0; k--) {\n      this.unshift(this._list[i = (i - 1 + len) & this._capacityMask]);\n    }\n    i = (this._head - 1 + len) & this._capacityMask;\n    while (del_count > 0) {\n      this._list[i = (i - 1 + len) & this._capacityMask] = void 0;\n      del_count--;\n    }\n    if (index < 0) this._tail = i;\n  } else {\n    this._tail = i;\n    i = (i + count + len) & this._capacityMask;\n    for (k = size - (count + index); k > 0; k--) {\n      this.push(this._list[i++]);\n    }\n    i = this._tail;\n    while (del_count > 0) {\n      this._list[i = (i + 1 + len) & this._capacityMask] = void 0;\n      del_count--;\n    }\n  }\n  if (this._head < 2 && this._tail > 10000 && this._tail <= len >>> 2) this._shrinkArray();\n  return removed;\n};\n\n/**\n * Native splice implementation.\n * Remove number of items from the specified index from the list and/or add new elements.\n * Returns array of removed items or empty array if count == 0.\n * Returns undefined if the list is empty.\n *\n * @param index\n * @param count\n * @param {...*} [elements]\n * @returns {array}\n */\nDenque.prototype.splice = function splice(index, count) {\n  var i = index;\n  // expect a number or return undefined\n  if ((i !== (i | 0))) {\n    return void 0;\n  }\n  var size = this.size();\n  if (i < 0) i += size;\n  if (i > size) return void 0;\n  if (arguments.length > 2) {\n    var k;\n    var temp;\n    var removed;\n    var arg_len = arguments.length;\n    var len = this._list.length;\n    var arguments_index = 2;\n    if (!size || i < size / 2) {\n      temp = new Array(i);\n      for (k = 0; k < i; k++) {\n        temp[k] = this._list[(this._head + k) & this._capacityMask];\n      }\n      if (count === 0) {\n        removed = [];\n        if (i > 0) {\n          this._head = (this._head + i + len) & this._capacityMask;\n        }\n      } else {\n        removed = this.remove(i, count);\n        this._head = (this._head + i + len) & this._capacityMask;\n      }\n      while (arg_len > arguments_index) {\n        this.unshift(arguments[--arg_len]);\n      }\n      for (k = i; k > 0; k--) {\n        this.unshift(temp[k - 1]);\n      }\n    } else {\n      temp = new Array(size - (i + count));\n      var leng = temp.length;\n      for (k = 0; k < leng; k++) {\n        temp[k] = this._list[(this._head + i + count + k) & this._capacityMask];\n      }\n      if (count === 0) {\n        removed = [];\n        if (i != size) {\n          this._tail = (this._head + i + len) & this._capacityMask;\n        }\n      } else {\n        removed = this.remove(i, count);\n        this._tail = (this._tail - leng + len) & this._capacityMask;\n      }\n      while (arguments_index < arg_len) {\n        this.push(arguments[arguments_index++]);\n      }\n      for (k = 0; k < leng; k++) {\n        this.push(temp[k]);\n      }\n    }\n    return removed;\n  } else {\n    return this.remove(i, count);\n  }\n};\n\n/**\n * Soft clear - does not reset capacity.\n */\nDenque.prototype.clear = function clear() {\n  this._list = new Array(this._list.length);\n  this._head = 0;\n  this._tail = 0;\n};\n\n/**\n * Returns true or false whether the list is empty.\n * @returns {boolean}\n */\nDenque.prototype.isEmpty = function isEmpty() {\n  return this._head === this._tail;\n};\n\n/**\n * Returns an array of all queue items.\n * @returns {Array}\n */\nDenque.prototype.toArray = function toArray() {\n  return this._copyArray(false);\n};\n\n/**\n * -------------\n *   INTERNALS\n * -------------\n */\n\n/**\n * Fills the queue with items from an array\n * For use in the constructor\n * @param array\n * @private\n */\nDenque.prototype._fromArray = function _fromArray(array) {\n  var length = array.length;\n  var capacity = this._nextPowerOf2(length);\n\n  this._list = new Array(capacity);\n  this._capacityMask = capacity - 1;\n  this._tail = length;\n\n  for (var i = 0; i < length; i++) this._list[i] = array[i];\n};\n\n/**\n *\n * @param fullCopy\n * @param size Initialize the array with a specific size. Will default to the current list size\n * @returns {Array}\n * @private\n */\nDenque.prototype._copyArray = function _copyArray(fullCopy, size) {\n  var src = this._list;\n  var capacity = src.length;\n  var length = this.length;\n  size = size | length;\n\n  // No prealloc requested and the buffer is contiguous\n  if (size == length && this._head < this._tail) {\n    // Simply do a fast slice copy\n    return this._list.slice(this._head, this._tail);\n  }\n\n  var dest = new Array(size);\n\n  var k = 0;\n  var i;\n  if (fullCopy || this._head > this._tail) {\n    for (i = this._head; i < capacity; i++) dest[k++] = src[i];\n    for (i = 0; i < this._tail; i++) dest[k++] = src[i];\n  } else {\n    for (i = this._head; i < this._tail; i++) dest[k++] = src[i];\n  }\n\n  return dest;\n}\n\n/**\n * Grows the internal list array.\n * @private\n */\nDenque.prototype._growArray = function _growArray() {\n  if (this._head != 0) {\n    // double array size and copy existing data, head to end, then beginning to tail.\n    var newList = this._copyArray(true, this._list.length << 1);\n\n    this._tail = this._list.length;\n    this._head = 0;\n\n    this._list = newList;\n  } else {\n    this._tail = this._list.length;\n    this._list.length <<= 1;\n  }\n\n  this._capacityMask = (this._capacityMask << 1) | 1;\n};\n\n/**\n * Shrinks the internal list array.\n * @private\n */\nDenque.prototype._shrinkArray = function _shrinkArray() {\n  this._list.length >>>= 1;\n  this._capacityMask >>>= 1;\n};\n\n/**\n * Find the next power of 2, at least 4\n * @private\n * @param {number} num \n * @returns {number}\n */\nDenque.prototype._nextPowerOf2 = function _nextPowerOf2(num) {\n  var log2 = Math.log(num) / Math.log(2);\n  var nextPow2 = 1 << (log2 + 1);\n\n  return Math.max(nextPow2, 4);\n}\n\nmodule.exports = Denque;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar BrowserInfo = /** @class */ (function () {\n    function BrowserInfo(name, version, os) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.type = 'browser';\n    }\n    return BrowserInfo;\n}());\nexport { BrowserInfo };\nvar NodeInfo = /** @class */ (function () {\n    function NodeInfo(version) {\n        this.version = version;\n        this.type = 'node';\n        this.name = 'node';\n        this.os = process.platform;\n    }\n    return NodeInfo;\n}());\nexport { NodeInfo };\nvar SearchBotDeviceInfo = /** @class */ (function () {\n    function SearchBotDeviceInfo(name, version, os, bot) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.bot = bot;\n        this.type = 'bot-device';\n    }\n    return SearchBotDeviceInfo;\n}());\nexport { SearchBotDeviceInfo };\nvar BotInfo = /** @class */ (function () {\n    function BotInfo() {\n        this.type = 'bot';\n        this.bot = true; // NOTE: deprecated test name instead\n        this.name = 'bot';\n        this.version = null;\n        this.os = null;\n    }\n    return BotInfo;\n}());\nexport { BotInfo };\nvar ReactNativeInfo = /** @class */ (function () {\n    function ReactNativeInfo() {\n        this.type = 'react-native';\n        this.name = 'react-native';\n        this.version = null;\n        this.os = null;\n    }\n    return ReactNativeInfo;\n}());\nexport { ReactNativeInfo };\n// tslint:disable-next-line:max-line-length\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\\ Jeeves\\/Teoma|ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [\n    ['aol', /AOLShield\\/([0-9\\._]+)/],\n    ['edge', /Edge\\/([0-9\\._]+)/],\n    ['edge-ios', /EdgiOS\\/([0-9\\._]+)/],\n    ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/],\n    ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/],\n    ['samsung', /SamsungBrowser\\/([0-9\\.]+)/],\n    ['silk', /\\bSilk\\/([0-9._-]+)\\b/],\n    ['miui', /MiuiBrowser\\/([0-9\\.]+)$/],\n    ['beaker', /BeakerBrowser\\/([0-9\\.]+)/],\n    ['edge-chromium', /EdgA?\\/([0-9\\.]+)/],\n    [\n        'chromium-webview',\n        /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/,\n    ],\n    ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/],\n    ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/],\n    ['fxios', /FxiOS\\/([0-9\\.]+)/],\n    ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/],\n    ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/],\n    ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/],\n    ['pie', /^Microsoft Pocket Internet Explorer\\/(\\d+\\.\\d+)$/],\n    ['pie', /^Mozilla\\/\\d\\.\\d+\\s\\(compatible;\\s(?:MSP?IE|MSInternet Explorer) (\\d+\\.\\d+);.*Windows CE.*\\)$/],\n    ['netfront', /^Mozilla\\/\\d\\.\\d+.*NetFront\\/(\\d.\\d)/],\n    ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/],\n    ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/],\n    ['ie', /MSIE\\s(7\\.0)/],\n    ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/],\n    ['android', /Android\\s([0-9\\.]+)/],\n    ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/],\n    ['safari', /Version\\/([0-9\\._]+).*Safari/],\n    ['facebook', /FB[AS]V\\/([0-9\\.]+)/],\n    ['instagram', /Instagram\\s([0-9\\.]+)/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/],\n    ['curl', /^curl\\/([0-9\\.]+)$/],\n    ['searchbot', SEARCHBOX_UA_REGEX],\n];\nvar operatingSystemRules = [\n    ['iOS', /iP(hone|od|ad)/],\n    ['Android OS', /Android/],\n    ['BlackBerry OS', /BlackBerry|BB10/],\n    ['Windows Mobile', /IEMobile/],\n    ['Amazon OS', /Kindle/],\n    ['Windows 3.11', /Win16/],\n    ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/],\n    ['Windows 98', /(Windows 98)|(Win98)/],\n    ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/],\n    ['Windows XP', /(Windows NT 5.1)|(Windows XP)/],\n    ['Windows Server 2003', /(Windows NT 5.2)/],\n    ['Windows Vista', /(Windows NT 6.0)/],\n    ['Windows 7', /(Windows NT 6.1)/],\n    ['Windows 8', /(Windows NT 6.2)/],\n    ['Windows 8.1', /(Windows NT 6.3)/],\n    ['Windows 10', /(Windows NT 10.0)/],\n    ['Windows ME', /Windows ME/],\n    ['Windows CE', /Windows CE|WinCE|Microsoft Pocket Internet Explorer/],\n    ['Open BSD', /OpenBSD/],\n    ['Sun OS', /SunOS/],\n    ['Chrome OS', /CrOS/],\n    ['Linux', /(Linux)|(X11)/],\n    ['Mac OS', /(Mac_PowerPC)|(Macintosh)/],\n    ['QNX', /QNX/],\n    ['BeOS', /BeOS/],\n    ['OS/2', /OS\\/2/],\n];\nexport function detect(userAgent) {\n    if (!!userAgent) {\n        return parseUserAgent(userAgent);\n    }\n    if (typeof document === 'undefined' &&\n        typeof navigator !== 'undefined' &&\n        navigator.product === 'ReactNative') {\n        return new ReactNativeInfo();\n    }\n    if (typeof navigator !== 'undefined') {\n        return parseUserAgent(navigator.userAgent);\n    }\n    return getNodeVersion();\n}\nfunction matchUserAgent(ua) {\n    // opted for using reduce here rather than Array#first with a regex.test call\n    // this is primarily because using the reduce we only perform the regex\n    // execution once rather than once for the test and for the exec again below\n    // probably something that needs to be benchmarked though\n    return (ua !== '' &&\n        userAgentRules.reduce(function (matched, _a) {\n            var browser = _a[0], regex = _a[1];\n            if (matched) {\n                return matched;\n            }\n            var uaMatch = regex.exec(ua);\n            return !!uaMatch && [browser, uaMatch];\n        }, false));\n}\nexport function browserName(ua) {\n    var data = matchUserAgent(ua);\n    return data ? data[0] : null;\n}\nexport function parseUserAgent(ua) {\n    var matchedRule = matchUserAgent(ua);\n    if (!matchedRule) {\n        return null;\n    }\n    var name = matchedRule[0], match = matchedRule[1];\n    if (name === 'searchbot') {\n        return new BotInfo();\n    }\n    // Do not use RegExp for split operation as some browser do not support it (See: http://blog.stevenlevithan.com/archives/cross-browser-split)\n    var versionParts = match[1] && match[1].split('.').join('_').split('_').slice(0, 3);\n    if (versionParts) {\n        if (versionParts.length < REQUIRED_VERSION_PARTS) {\n            versionParts = __spreadArray(__spreadArray([], versionParts, true), createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length), true);\n        }\n    }\n    else {\n        versionParts = [];\n    }\n    var version = versionParts.join('.');\n    var os = detectOS(ua);\n    var searchBotMatch = SEARCHBOT_OS_REGEX.exec(ua);\n    if (searchBotMatch && searchBotMatch[1]) {\n        return new SearchBotDeviceInfo(name, version, os, searchBotMatch[1]);\n    }\n    return new BrowserInfo(name, version, os);\n}\nexport function detectOS(ua) {\n    for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n        var _a = operatingSystemRules[ii], os = _a[0], regex = _a[1];\n        var match = regex.exec(ua);\n        if (match) {\n            return os;\n        }\n    }\n    return null;\n}\nexport function getNodeVersion() {\n    var isNode = typeof process !== 'undefined' && process.version;\n    return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\nfunction createVersionParts(count) {\n    var output = [];\n    for (var ii = 0; ii < count; ii++) {\n        output.push('0');\n    }\n    return output;\n}\n","!function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=function(t,n,e,i,o){for(n=n.split?n.split(\".\"):n,i=0;i<n.length;i++)t=t?t[n[i]]:o;return t===o?e:t}:\"function\"==typeof define&&define.amd?define(function(){return function(t,n,e,i,o){for(n=n.split?n.split(\".\"):n,i=0;i<n.length;i++)t=t?t[n[i]]:o;return t===o?e:t}}):t.dlv=function(t,n,e,i,o){for(n=n.split?n.split(\".\"):n,i=0;i<n.length;i++)t=t?t[n[i]]:o;return t===o?e:t}}(this);\n//# sourceMappingURL=dlv.umd.js.map\n","'use strict';\n\n/**\n * @typedef {{ [key: string]: any }} Extensions\n * @typedef {Error} Err\n * @property {string} message\n */\n\n/**\n *\n * @param {Error} obj\n * @param {Extensions} props\n * @returns {Error & Extensions}\n */\nfunction assign(obj, props) {\n    for (const key in props) {\n        Object.defineProperty(obj, key, {\n            value: props[key],\n            enumerable: true,\n            configurable: true,\n        });\n    }\n\n    return obj;\n}\n\n/**\n *\n * @param {any} err - An Error\n * @param {string|Extensions} code - A string code or props to set on the error\n * @param {Extensions} [props] - Props to set on the error\n * @returns {Error & Extensions}\n */\nfunction createError(err, code, props) {\n    if (!err || typeof err === 'string') {\n        throw new TypeError('Please pass an Error to err-code');\n    }\n\n    if (!props) {\n        props = {};\n    }\n\n    if (typeof code === 'object') {\n        props = code;\n        code = '';\n    }\n\n    if (code) {\n        props.code = code;\n    }\n\n    try {\n        return assign(err, props);\n    } catch (_) {\n        props.message = err.message;\n        props.stack = err.stack;\n\n        const ErrClass = function () {};\n\n        ErrClass.prototype = Object.create(Object.getPrototypeOf(err));\n\n        // @ts-ignore\n        const output = assign(new ErrClass(), props);\n\n        return output;\n    }\n}\n\nmodule.exports = createError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst event_iterator_1 = require(\"./event-iterator\");\nexports.EventIterator = event_iterator_1.EventIterator;\nfunction subscribe(event, options, evOptions) {\n    return new event_iterator_1.EventIterator(({ push }) => {\n        this.addEventListener(event, push, options);\n        return () => this.removeEventListener(event, push, options);\n    }, evOptions);\n}\nexports.subscribe = subscribe;\nexports.default = event_iterator_1.EventIterator;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass EventQueue {\n    constructor() {\n        this.pullQueue = [];\n        this.pushQueue = [];\n        this.eventHandlers = {};\n        this.isPaused = false;\n        this.isStopped = false;\n    }\n    push(value) {\n        if (this.isStopped)\n            return;\n        const resolution = { value, done: false };\n        if (this.pullQueue.length) {\n            const placeholder = this.pullQueue.shift();\n            if (placeholder)\n                placeholder.resolve(resolution);\n        }\n        else {\n            this.pushQueue.push(Promise.resolve(resolution));\n            if (this.highWaterMark !== undefined &&\n                this.pushQueue.length >= this.highWaterMark &&\n                !this.isPaused) {\n                this.isPaused = true;\n                if (this.eventHandlers.highWater) {\n                    this.eventHandlers.highWater();\n                }\n                else if (console) {\n                    console.warn(`EventIterator queue reached ${this.pushQueue.length} items`);\n                }\n            }\n        }\n    }\n    stop() {\n        if (this.isStopped)\n            return;\n        this.isStopped = true;\n        this.remove();\n        for (const placeholder of this.pullQueue) {\n            placeholder.resolve({ value: undefined, done: true });\n        }\n        this.pullQueue.length = 0;\n    }\n    fail(error) {\n        if (this.isStopped)\n            return;\n        this.isStopped = true;\n        this.remove();\n        if (this.pullQueue.length) {\n            for (const placeholder of this.pullQueue) {\n                placeholder.reject(error);\n            }\n            this.pullQueue.length = 0;\n        }\n        else {\n            const rejection = Promise.reject(error);\n            /* Attach error handler to avoid leaking an unhandled promise rejection. */\n            rejection.catch(() => { });\n            this.pushQueue.push(rejection);\n        }\n    }\n    remove() {\n        Promise.resolve().then(() => {\n            if (this.removeCallback)\n                this.removeCallback();\n        });\n    }\n    [Symbol.asyncIterator]() {\n        return {\n            next: (value) => {\n                const result = this.pushQueue.shift();\n                if (result) {\n                    if (this.lowWaterMark !== undefined &&\n                        this.pushQueue.length <= this.lowWaterMark &&\n                        this.isPaused) {\n                        this.isPaused = false;\n                        if (this.eventHandlers.lowWater) {\n                            this.eventHandlers.lowWater();\n                        }\n                    }\n                    return result;\n                }\n                else if (this.isStopped) {\n                    return Promise.resolve({ value: undefined, done: true });\n                }\n                else {\n                    return new Promise((resolve, reject) => {\n                        this.pullQueue.push({ resolve, reject });\n                    });\n                }\n            },\n            return: () => {\n                this.isStopped = true;\n                this.pushQueue.length = 0;\n                this.remove();\n                return Promise.resolve({ value: undefined, done: true });\n            },\n        };\n    }\n}\nclass EventIterator {\n    constructor(listen, { highWaterMark = 100, lowWaterMark = 1 } = {}) {\n        const queue = new EventQueue();\n        queue.highWaterMark = highWaterMark;\n        queue.lowWaterMark = lowWaterMark;\n        queue.removeCallback =\n            listen({\n                push: value => queue.push(value),\n                stop: () => queue.stop(),\n                fail: error => queue.fail(error),\n                on: (event, fn) => {\n                    queue.eventHandlers[event] = fn;\n                },\n            }) || (() => { });\n        this[Symbol.asyncIterator] = () => queue[Symbol.asyncIterator]();\n        Object.freeze(this);\n    }\n}\nexports.EventIterator = EventIterator;\nexports.default = EventIterator;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","'use strict';\n\nmodule.exports = function ReactNativeFile(_ref) {\n  var uri = _ref.uri,\n    name = _ref.name,\n    type = _ref.type;\n  this.uri = uri;\n  this.name = name;\n  this.type = type;\n};\n","'use strict';\n\nvar defaultIsExtractableFile = require('./isExtractableFile');\n\nmodule.exports = function extractFiles(value, path, isExtractableFile) {\n  if (path === void 0) {\n    path = '';\n  }\n\n  if (isExtractableFile === void 0) {\n    isExtractableFile = defaultIsExtractableFile;\n  }\n\n  var clone;\n  var files = new Map();\n\n  function addFile(paths, file) {\n    var storedPaths = files.get(file);\n    if (storedPaths) storedPaths.push.apply(storedPaths, paths);\n    else files.set(file, paths);\n  }\n\n  if (isExtractableFile(value)) {\n    clone = null;\n    addFile([path], value);\n  } else {\n    var prefix = path ? path + '.' : '';\n    if (typeof FileList !== 'undefined' && value instanceof FileList)\n      clone = Array.prototype.map.call(value, function (file, i) {\n        addFile(['' + prefix + i], file);\n        return null;\n      });\n    else if (Array.isArray(value))\n      clone = value.map(function (child, i) {\n        var result = extractFiles(child, '' + prefix + i, isExtractableFile);\n        result.files.forEach(addFile);\n        return result.clone;\n      });\n    else if (value && value.constructor === Object) {\n      clone = {};\n\n      for (var i in value) {\n        var result = extractFiles(value[i], '' + prefix + i, isExtractableFile);\n        result.files.forEach(addFile);\n        clone[i] = result.clone;\n      }\n    } else clone = value;\n  }\n\n  return {\n    clone: clone,\n    files: files,\n  };\n};\n","'use strict';\n\nvar ReactNativeFile = require('./ReactNativeFile');\n\nmodule.exports = function isExtractableFile(value) {\n  return (\n    (typeof File !== 'undefined' && value instanceof File) ||\n    (typeof Blob !== 'undefined' && value instanceof Blob) ||\n    value instanceof ReactNativeFile\n  );\n};\n","module.exports = class FixedFIFO {\n  constructor (hwm) {\n    if (!(hwm > 0) || ((hwm - 1) & hwm) !== 0) throw new Error('Max size for a FixedFIFO should be a power of two')\n    this.buffer = new Array(hwm)\n    this.mask = hwm - 1\n    this.top = 0\n    this.btm = 0\n    this.next = null\n  }\n\n  push (data) {\n    if (this.buffer[this.top] !== undefined) return false\n    this.buffer[this.top] = data\n    this.top = (this.top + 1) & this.mask\n    return true\n  }\n\n  shift () {\n    const last = this.buffer[this.btm]\n    if (last === undefined) return undefined\n    this.buffer[this.btm] = undefined\n    this.btm = (this.btm + 1) & this.mask\n    return last\n  }\n\n  peek () {\n    return this.buffer[this.btm]\n  }\n\n  isEmpty () {\n    return this.buffer[this.btm] === undefined\n  }\n}\n","const FixedFIFO = require('./fixed-size')\n\nmodule.exports = class FastFIFO {\n  constructor (hwm) {\n    this.hwm = hwm || 16\n    this.head = new FixedFIFO(this.hwm)\n    this.tail = this.head\n  }\n\n  push (val) {\n    if (!this.head.push(val)) {\n      const prev = this.head\n      this.head = prev.next = new FixedFIFO(2 * this.head.buffer.length)\n      this.head.push(val)\n    }\n  }\n\n  shift () {\n    const val = this.tail.shift()\n    if (val === undefined && this.tail.next) {\n      const next = this.tail.next\n      this.tail.next = null\n      this.tail = next\n      return this.tail.shift()\n    }\n    return val\n  }\n\n  peek () {\n    return this.tail.peek()\n  }\n\n  isEmpty () {\n    return this.head.isEmpty()\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * FNV-1a hash generation init value.\n * It's exposed, because this allows user to override it.\n * More info: https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function#FNV_hash_parameters\n *\n * @type {number}\n */\nhash.BASE = 0x811c9dc5;\n/**\n * Generates 32 bit FNV-1a hash from the given string.\n * As explained here: http://isthe.com/chongo/tech/comp/fnv/\n *\n * @param s {string} String to generate hash from.\n * @param [h] {number} FNV-1a hash generation init value.\n * @returns {number} The result integer hash.\n */\nfunction hash(s, h = hash.BASE) {\n    const l = s.length;\n    for (let i = 0; i < l; i++) {\n        h ^= s.charCodeAt(i);\n        h += (h << 1) + (h << 4) + (h << 7) + (h << 8) + (h << 24);\n    }\n    return h >>> 0;\n}\nexports.default = hash;\nmodule.exports = hash;\n","/* eslint-env browser */\nmodule.exports = typeof self == 'object' ? self.FormData : window.FormData;\n","module.exports = function (max) {\n\n  if (!max) throw Error('hashlru must have a max value, of type number, greater than 0')\n\n  var size = 0, cache = Object.create(null), _cache = Object.create(null)\n\n  function update (key, value) {\n    cache[key] = value\n    size ++\n    if(size >= max) {\n      size = 0\n      _cache = cache\n      cache = Object.create(null)\n    }\n  }\n\n  return {\n    has: function (key) {\n      return cache[key] !== undefined || _cache[key] !== undefined\n    },\n    remove: function (key) {\n      if(cache[key] !== undefined)\n        cache[key] = undefined\n      if(_cache[key] !== undefined)\n        _cache[key] = undefined\n    },\n    get: function (key) {\n      var v = cache[key]\n      if(v !== undefined) return v\n      if((v = _cache[key]) !== undefined) {\n        update(key, v)\n        return v\n      }\n    },\n    set: function (key, value) {\n      if(cache[key] !== undefined) cache[key] = value\n      else update(key, value)\n    },\n    clear: function () {\n      cache = Object.create(null)\n      _cache = Object.create(null)\n    }\n  }\n}\n\n\n\n\n\n\n\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","const RateLimiterRedis = require('./lib/RateLimiterRedis');\nconst RateLimiterMongo = require('./lib/RateLimiterMongo');\nconst RateLimiterMySQL = require('./lib/RateLimiterMySQL');\nconst RateLimiterPostgres = require('./lib/RateLimiterPostgres');\nconst {RateLimiterClusterMaster, RateLimiterClusterMasterPM2, RateLimiterCluster} = require('./lib/RateLimiterCluster');\nconst RateLimiterMemory = require('./lib/RateLimiterMemory');\nconst RateLimiterMemcache = require('./lib/RateLimiterMemcache');\nconst RLWrapperBlackAndWhite = require('./lib/RLWrapperBlackAndWhite');\nconst RateLimiterUnion = require('./lib/RateLimiterUnion');\nconst RateLimiterQueue = require('./lib/RateLimiterQueue');\nconst BurstyRateLimiter = require('./lib/BurstyRateLimiter');\nconst RateLimiterRes = require('./lib/RateLimiterRes');\n\nmodule.exports = {\n  RateLimiterRedis,\n  RateLimiterMongo,\n  RateLimiterMySQL,\n  RateLimiterPostgres,\n  RateLimiterMemory,\n  RateLimiterMemcache,\n  RateLimiterClusterMaster,\n  RateLimiterClusterMasterPM2,\n  RateLimiterCluster,\n  RLWrapperBlackAndWhite,\n  RateLimiterUnion,\n  RateLimiterQueue,\n  BurstyRateLimiter,\n  RateLimiterRes,\n};\n","const RateLimiterRes = require(\"./RateLimiterRes\");\n\n/**\n * Bursty rate limiter exposes only msBeforeNext time and doesn't expose points from bursty limiter by default\n * @type {BurstyRateLimiter}\n */\nmodule.exports = class BurstyRateLimiter {\n  constructor(rateLimiter, burstLimiter) {\n    this._rateLimiter = rateLimiter;\n    this._burstLimiter = burstLimiter\n  }\n\n  /**\n   * Merge rate limiter response objects. Responses can be null\n   *\n   * @param {RateLimiterRes} [rlRes] Rate limiter response\n   * @param {RateLimiterRes} [blRes] Bursty limiter response\n   */\n  _combineRes(rlRes, blRes) {\n    if (!rlRes) {\n      return null\n    }\n\n    return new RateLimiterRes(\n      rlRes.remainingPoints,\n      Math.min(rlRes.msBeforeNext, blRes ? blRes.msBeforeNext : 0),\n      rlRes.consumedPoints,\n      rlRes.isFirstInDuration\n    )\n  }\n\n  /**\n   * @param key\n   * @param pointsToConsume\n   * @param options\n   * @returns {Promise<any>}\n   */\n  consume(key, pointsToConsume = 1, options = {}) {\n    return this._rateLimiter.consume(key, pointsToConsume, options)\n      .catch((rlRej) => {\n        if (rlRej instanceof RateLimiterRes) {\n          return this._burstLimiter.consume(key, pointsToConsume, options)\n            .then((blRes) => {\n              return Promise.resolve(this._combineRes(rlRej, blRes))\n            })\n            .catch((blRej) => {\n                if (blRej instanceof RateLimiterRes) {\n                  return Promise.reject(this._combineRes(rlRej, blRej))\n                } else {\n                  return Promise.reject(blRej)\n                }\n              }\n            )\n        } else {\n          return Promise.reject(rlRej)\n        }\n      })\n  }\n\n  /**\n   * It doesn't expose available points from burstLimiter\n   *\n   * @param key\n   * @returns {Promise<RateLimiterRes>}\n   */\n  get(key) {\n    return Promise.all([\n      this._rateLimiter.get(key),\n      this._burstLimiter.get(key),\n    ]).then(([rlRes, blRes]) => {\n      return this._combineRes(rlRes, blRes);\n    });\n  }\n\n  get points() {\n    return this._rateLimiter.points;\n  }\n};\n","const RateLimiterRes = require('./RateLimiterRes');\n\nmodule.exports = class RLWrapperBlackAndWhite {\n  constructor(opts = {}) {\n    this.limiter = opts.limiter;\n    this.blackList = opts.blackList;\n    this.whiteList = opts.whiteList;\n    this.isBlackListed = opts.isBlackListed;\n    this.isWhiteListed = opts.isWhiteListed;\n    this.runActionAnyway = opts.runActionAnyway;\n  }\n\n  get limiter() {\n    return this._limiter;\n  }\n\n  set limiter(value) {\n    if (typeof value === 'undefined') {\n      throw new Error('limiter is not set');\n    }\n\n    this._limiter = value;\n  }\n\n  get runActionAnyway() {\n    return this._runActionAnyway;\n  }\n\n  set runActionAnyway(value) {\n    this._runActionAnyway = typeof value === 'undefined' ? false : value;\n  }\n\n  get blackList() {\n    return this._blackList;\n  }\n\n  set blackList(value) {\n    this._blackList = Array.isArray(value) ? value : [];\n  }\n\n  get isBlackListed() {\n    return this._isBlackListed;\n  }\n\n  set isBlackListed(func) {\n    if (typeof func === 'undefined') {\n      func = () => false;\n    }\n    if (typeof func !== 'function') {\n      throw new Error('isBlackListed must be function');\n    }\n    this._isBlackListed = func;\n  }\n\n  get whiteList() {\n    return this._whiteList;\n  }\n\n  set whiteList(value) {\n    this._whiteList = Array.isArray(value) ? value : [];\n  }\n\n  get isWhiteListed() {\n    return this._isWhiteListed;\n  }\n\n  set isWhiteListed(func) {\n    if (typeof func === 'undefined') {\n      func = () => false;\n    }\n    if (typeof func !== 'function') {\n      throw new Error('isWhiteListed must be function');\n    }\n    this._isWhiteListed = func;\n  }\n\n  isBlackListedSomewhere(key) {\n    return this.blackList.indexOf(key) >= 0 || this.isBlackListed(key);\n  }\n\n  isWhiteListedSomewhere(key) {\n    return this.whiteList.indexOf(key) >= 0 || this.isWhiteListed(key);\n  }\n\n  getBlackRes() {\n    return new RateLimiterRes(0, Number.MAX_SAFE_INTEGER, 0, false);\n  }\n\n  getWhiteRes() {\n    return new RateLimiterRes(Number.MAX_SAFE_INTEGER, 0, 0, false);\n  }\n\n  rejectBlack() {\n    return Promise.reject(this.getBlackRes());\n  }\n\n  resolveBlack() {\n    return Promise.resolve(this.getBlackRes());\n  }\n\n  resolveWhite() {\n    return Promise.resolve(this.getWhiteRes());\n  }\n\n  consume(key, pointsToConsume = 1) {\n    let res;\n    if (this.isWhiteListedSomewhere(key)) {\n      res = this.resolveWhite();\n    } else if (this.isBlackListedSomewhere(key)) {\n      res = this.rejectBlack();\n    }\n\n    if (typeof res === 'undefined') {\n      return this.limiter.consume(key, pointsToConsume);\n    }\n\n    if (this.runActionAnyway) {\n      this.limiter.consume(key, pointsToConsume).catch(() => {});\n    }\n    return res;\n  }\n\n  block(key, secDuration) {\n    let res;\n    if (this.isWhiteListedSomewhere(key)) {\n      res = this.resolveWhite();\n    } else if (this.isBlackListedSomewhere(key)) {\n      res = this.resolveBlack();\n    }\n\n    if (typeof res === 'undefined') {\n      return this.limiter.block(key, secDuration);\n    }\n\n    if (this.runActionAnyway) {\n      this.limiter.block(key, secDuration).catch(() => {});\n    }\n    return res;\n  }\n\n  penalty(key, points) {\n    let res;\n    if (this.isWhiteListedSomewhere(key)) {\n      res = this.resolveWhite();\n    } else if (this.isBlackListedSomewhere(key)) {\n      res = this.resolveBlack();\n    }\n\n    if (typeof res === 'undefined') {\n      return this.limiter.penalty(key, points);\n    }\n\n    if (this.runActionAnyway) {\n      this.limiter.penalty(key, points).catch(() => {});\n    }\n    return res;\n  }\n\n  reward(key, points) {\n    let res;\n    if (this.isWhiteListedSomewhere(key)) {\n      res = this.resolveWhite();\n    } else if (this.isBlackListedSomewhere(key)) {\n      res = this.resolveBlack();\n    }\n\n    if (typeof res === 'undefined') {\n      return this.limiter.reward(key, points);\n    }\n\n    if (this.runActionAnyway) {\n      this.limiter.reward(key, points).catch(() => {});\n    }\n    return res;\n  }\n\n  get(key) {\n    let res;\n    if (this.isWhiteListedSomewhere(key)) {\n      res = this.resolveWhite();\n    } else if (this.isBlackListedSomewhere(key)) {\n      res = this.resolveBlack();\n    }\n\n    if (typeof res === 'undefined' || this.runActionAnyway) {\n      return this.limiter.get(key);\n    }\n\n    return res;\n  }\n\n  delete(key) {\n    return this.limiter.delete(key);\n  }\n};\n","module.exports = class RateLimiterAbstract {\n  /**\n   *\n   * @param opts Object Defaults {\n   *   points: 4, // Number of points\n   *   duration: 1, // Per seconds\n   *   blockDuration: 0, // Block if consumed more than points in current duration for blockDuration seconds\n   *   execEvenly: false, // Execute allowed actions evenly over duration\n   *   execEvenlyMinDelayMs: duration * 1000 / points, // ms, works with execEvenly=true option\n   *   keyPrefix: 'rlflx',\n   * }\n   */\n  constructor(opts = {}) {\n    this.points = opts.points;\n    this.duration = opts.duration;\n    this.blockDuration = opts.blockDuration;\n    this.execEvenly = opts.execEvenly;\n    this.execEvenlyMinDelayMs = opts.execEvenlyMinDelayMs;\n    this.keyPrefix = opts.keyPrefix;\n  }\n\n  get points() {\n    return this._points;\n  }\n\n  set points(value) {\n    this._points = value >= 0 ? value : 4;\n  }\n\n  get duration() {\n    return this._duration;\n  }\n\n  set duration(value) {\n    this._duration = typeof value === 'undefined' ? 1 : value;\n  }\n\n  get msDuration() {\n    return this.duration * 1000;\n  }\n\n  get blockDuration() {\n    return this._blockDuration;\n  }\n\n  set blockDuration(value) {\n    this._blockDuration = typeof value === 'undefined' ? 0 : value;\n  }\n\n  get msBlockDuration() {\n    return this.blockDuration * 1000;\n  }\n\n  get execEvenly() {\n    return this._execEvenly;\n  }\n\n  set execEvenly(value) {\n    this._execEvenly = typeof value === 'undefined' ? false : Boolean(value);\n  }\n\n  get execEvenlyMinDelayMs() {\n    return this._execEvenlyMinDelayMs;\n  }\n\n  set execEvenlyMinDelayMs(value) {\n    this._execEvenlyMinDelayMs = typeof value === 'undefined' ? Math.ceil(this.msDuration / this.points) : value;\n  }\n\n  get keyPrefix() {\n    return this._keyPrefix;\n  }\n\n  set keyPrefix(value) {\n    if (typeof value === 'undefined') {\n      value = 'rlflx';\n    }\n    if (typeof value !== 'string') {\n      throw new Error('keyPrefix must be string');\n    }\n    this._keyPrefix = value;\n  }\n\n  _getKeySecDuration(options = {}) {\n    return options && options.customDuration >= 0\n      ? options.customDuration\n      : this.duration;\n  }\n\n  getKey(key) {\n    return this.keyPrefix.length > 0 ? `${this.keyPrefix}:${key}` : key;\n  }\n\n  parseKey(rlKey) {\n    return rlKey.substring(this.keyPrefix.length);\n  }\n\n  consume() {\n    throw new Error(\"You have to implement the method 'consume'!\");\n  }\n\n  penalty() {\n    throw new Error(\"You have to implement the method 'penalty'!\");\n  }\n\n  reward() {\n    throw new Error(\"You have to implement the method 'reward'!\");\n  }\n\n  get() {\n    throw new Error(\"You have to implement the method 'get'!\");\n  }\n\n  set() {\n    throw new Error(\"You have to implement the method 'set'!\");\n  }\n\n  block() {\n    throw new Error(\"You have to implement the method 'block'!\");\n  }\n\n  delete() {\n    throw new Error(\"You have to implement the method 'delete'!\");\n  }\n};\n","/**\n * Implements rate limiting in cluster using built-in IPC\n *\n * Two classes are described here: master and worker\n * Master have to be create in the master process without any options.\n * Any number of rate limiters can be created in workers, but each rate limiter must be with unique keyPrefix\n *\n * Workflow:\n * 1. master rate limiter created in master process\n * 2. worker rate limiter sends 'init' message with necessary options during creating\n * 3. master receives options and adds new rate limiter by keyPrefix if it isn't created yet\n * 4. master sends 'init' back to worker's rate limiter\n * 5. worker can process requests immediately,\n *    but they will be postponed by 'workerWaitInit' until master sends 'init' to worker\n * 6. every request to worker rate limiter creates a promise\n * 7. if master doesn't response for 'timeout', promise is rejected\n * 8. master sends 'resolve' or 'reject' command to worker\n * 9. worker resolves or rejects promise depending on message from master\n *\n */\n\nconst cluster = require('cluster');\nconst crypto = require('crypto');\nconst RateLimiterAbstract = require('./RateLimiterAbstract');\nconst RateLimiterMemory = require('./RateLimiterMemory');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nconst channel = 'rate_limiter_flexible';\nlet masterInstance = null;\n\nconst masterSendToWorker = function (worker, msg, type, res) {\n  let data;\n  if (res === null || res === true || res === false) {\n    data = res;\n  } else {\n    data = {\n      remainingPoints: res.remainingPoints,\n      msBeforeNext: res.msBeforeNext,\n      consumedPoints: res.consumedPoints,\n      isFirstInDuration: res.isFirstInDuration,\n    };\n  }\n  worker.send({\n    channel,\n    keyPrefix: msg.keyPrefix, // which rate limiter exactly\n    promiseId: msg.promiseId,\n    type,\n    data,\n  });\n};\n\nconst workerWaitInit = function (payload) {\n  setTimeout(() => {\n    if (this._initiated) {\n      process.send(payload);\n      // Promise will be removed by timeout if too long\n    } else if (typeof this._promises[payload.promiseId] !== 'undefined') {\n      workerWaitInit.call(this, payload);\n    }\n  }, 30);\n};\n\nconst workerSendToMaster = function (func, promiseId, key, arg, opts) {\n  const payload = {\n    channel,\n    keyPrefix: this.keyPrefix,\n    func,\n    promiseId,\n    data: {\n      key,\n      arg,\n      opts,\n    },\n  };\n\n  if (!this._initiated) {\n    // Wait init before sending messages to master\n    workerWaitInit.call(this, payload);\n  } else {\n    process.send(payload);\n  }\n};\n\nconst masterProcessMsg = function (worker, msg) {\n  if (!msg || msg.channel !== channel || typeof this._rateLimiters[msg.keyPrefix] === 'undefined') {\n    return false;\n  }\n\n  let promise;\n\n  switch (msg.func) {\n    case 'consume':\n      promise = this._rateLimiters[msg.keyPrefix].consume(msg.data.key, msg.data.arg, msg.data.opts);\n      break;\n    case 'penalty':\n      promise = this._rateLimiters[msg.keyPrefix].penalty(msg.data.key, msg.data.arg, msg.data.opts);\n      break;\n    case 'reward':\n      promise = this._rateLimiters[msg.keyPrefix].reward(msg.data.key, msg.data.arg, msg.data.opts);\n      break;\n    case 'block':\n      promise = this._rateLimiters[msg.keyPrefix].block(msg.data.key, msg.data.arg, msg.data.opts);\n      break;\n    case 'get':\n      promise = this._rateLimiters[msg.keyPrefix].get(msg.data.key, msg.data.opts);\n      break;\n    case 'delete':\n      promise = this._rateLimiters[msg.keyPrefix].delete(msg.data.key, msg.data.opts);\n      break;\n    default:\n      return false;\n  }\n\n  if (promise) {\n    promise\n      .then((res) => {\n        masterSendToWorker(worker, msg, 'resolve', res);\n      })\n      .catch((rejRes) => {\n        masterSendToWorker(worker, msg, 'reject', rejRes);\n      });\n  }\n};\n\nconst workerProcessMsg = function (msg) {\n  if (!msg || msg.channel !== channel || msg.keyPrefix !== this.keyPrefix) {\n    return false;\n  }\n\n  if (this._promises[msg.promiseId]) {\n    clearTimeout(this._promises[msg.promiseId].timeoutId);\n    let res;\n    if (msg.data === null || msg.data === true || msg.data === false) {\n      res = msg.data;\n    } else {\n      res = new RateLimiterRes(\n        msg.data.remainingPoints,\n        msg.data.msBeforeNext,\n        msg.data.consumedPoints,\n        msg.data.isFirstInDuration // eslint-disable-line comma-dangle\n      );\n    }\n\n    switch (msg.type) {\n      case 'resolve':\n        this._promises[msg.promiseId].resolve(res);\n        break;\n      case 'reject':\n        this._promises[msg.promiseId].reject(res);\n        break;\n      default:\n        throw new Error(`RateLimiterCluster: no such message type '${msg.type}'`);\n    }\n\n    delete this._promises[msg.promiseId];\n  }\n};\n/**\n * Prepare options to send to master\n * Master will create rate limiter depending on options\n *\n * @returns {{points: *, duration: *, blockDuration: *, execEvenly: *, execEvenlyMinDelayMs: *, keyPrefix: *}}\n */\nconst getOpts = function () {\n  return {\n    points: this.points,\n    duration: this.duration,\n    blockDuration: this.blockDuration,\n    execEvenly: this.execEvenly,\n    execEvenlyMinDelayMs: this.execEvenlyMinDelayMs,\n    keyPrefix: this.keyPrefix,\n  };\n};\n\nconst savePromise = function (resolve, reject) {\n  const hrtime = process.hrtime();\n  let promiseId = hrtime[0].toString() + hrtime[1].toString();\n\n  if (typeof this._promises[promiseId] !== 'undefined') {\n    promiseId += crypto.randomBytes(12).toString('base64');\n  }\n\n  this._promises[promiseId] = {\n    resolve,\n    reject,\n    timeoutId: setTimeout(() => {\n      delete this._promises[promiseId];\n      reject(new Error('RateLimiterCluster timeout: no answer from master in time'));\n    }, this.timeoutMs),\n  };\n\n  return promiseId;\n};\n\nclass RateLimiterClusterMaster {\n  constructor() {\n    if (masterInstance) {\n      return masterInstance;\n    }\n\n    this._rateLimiters = {};\n\n    cluster.setMaxListeners(0);\n\n    cluster.on('message', (worker, msg) => {\n      if (msg && msg.channel === channel && msg.type === 'init') {\n        // If init request, check or create rate limiter by key prefix and send 'init' back to worker\n        if (typeof this._rateLimiters[msg.opts.keyPrefix] === 'undefined') {\n          this._rateLimiters[msg.opts.keyPrefix] = new RateLimiterMemory(msg.opts);\n        }\n\n        worker.send({\n          channel,\n          type: 'init',\n          keyPrefix: msg.opts.keyPrefix,\n        });\n      } else {\n        masterProcessMsg.call(this, worker, msg);\n      }\n    });\n\n    masterInstance = this;\n  }\n}\n\nclass RateLimiterClusterMasterPM2 {\n  constructor(pm2) {\n    if (masterInstance) {\n      return masterInstance;\n    }\n\n    this._rateLimiters = {};\n\n    pm2.launchBus((err, pm2Bus) => {\n      pm2Bus.on('process:msg', (packet) => {\n        const msg = packet.raw;\n        if (msg && msg.channel === channel && msg.type === 'init') {\n          // If init request, check or create rate limiter by key prefix and send 'init' back to worker\n          if (typeof this._rateLimiters[msg.opts.keyPrefix] === 'undefined') {\n            this._rateLimiters[msg.opts.keyPrefix] = new RateLimiterMemory(msg.opts);\n          }\n\n          pm2.sendDataToProcessId(packet.process.pm_id, {\n            data: {},\n            topic: channel,\n            channel,\n            type: 'init',\n            keyPrefix: msg.opts.keyPrefix,\n          }, (sendErr, res) => {\n            if (sendErr) {\n              console.log(sendErr, res);\n            }\n          });\n        } else {\n          const worker = {\n            send: (msgData) => {\n              const pm2Message = msgData;\n              pm2Message.topic = channel;\n              if (typeof pm2Message.data === 'undefined') {\n                pm2Message.data = {};\n              }\n              pm2.sendDataToProcessId(packet.process.pm_id, pm2Message, (sendErr, res) => {\n                if (sendErr) {\n                  console.log(sendErr, res);\n                }\n              });\n            },\n          };\n          masterProcessMsg.call(this, worker, msg);\n        }\n      });\n    });\n\n    masterInstance = this;\n  }\n}\n\nclass RateLimiterClusterWorker extends RateLimiterAbstract {\n  get timeoutMs() {\n    return this._timeoutMs;\n  }\n\n  set timeoutMs(value) {\n    this._timeoutMs = typeof value === 'undefined' ? 5000 : Math.abs(parseInt(value));\n  }\n\n  constructor(opts = {}) {\n    super(opts);\n\n    process.setMaxListeners(0);\n\n    this.timeoutMs = opts.timeoutMs;\n\n    this._initiated = false;\n\n    process.on('message', (msg) => {\n      if (msg && msg.channel === channel && msg.type === 'init' && msg.keyPrefix === this.keyPrefix) {\n        this._initiated = true;\n      } else {\n        workerProcessMsg.call(this, msg);\n      }\n    });\n\n    // Create limiter on master with specific options\n    process.send({\n      channel,\n      type: 'init',\n      opts: getOpts.call(this),\n    });\n\n    this._promises = {};\n  }\n\n  consume(key, pointsToConsume = 1, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'consume', promiseId, key, pointsToConsume, options);\n    });\n  }\n\n  penalty(key, points = 1, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'penalty', promiseId, key, points, options);\n    });\n  }\n\n  reward(key, points = 1, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'reward', promiseId, key, points, options);\n    });\n  }\n\n  block(key, secDuration, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'block', promiseId, key, secDuration, options);\n    });\n  }\n\n  get(key, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'get', promiseId, key, options);\n    });\n  }\n\n  delete(key, options = {}) {\n    return new Promise((resolve, reject) => {\n      const promiseId = savePromise.call(this, resolve, reject);\n\n      workerSendToMaster.call(this, 'delete', promiseId, key, options);\n    });\n  }\n}\n\nmodule.exports = {\n  RateLimiterClusterMaster,\n  RateLimiterClusterMasterPM2,\n  RateLimiterCluster: RateLimiterClusterWorker,\n};\n","const RateLimiterStoreAbstract = require('./RateLimiterStoreAbstract');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nclass RateLimiterMemcache extends RateLimiterStoreAbstract {\n  /**\n   *\n   * @param {Object} opts\n   * Defaults {\n   *   ... see other in RateLimiterStoreAbstract\n   *\n   *   storeClient: memcacheClient\n   * }\n   */\n  constructor(opts) {\n    super(opts);\n\n    this.client = opts.storeClient;\n  }\n\n  _getRateLimiterRes(rlKey, changedPoints, result) {\n    const res = new RateLimiterRes();\n    res.consumedPoints = parseInt(result.consumedPoints);\n    res.isFirstInDuration = result.consumedPoints === changedPoints;\n    res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    res.msBeforeNext = result.msBeforeNext;\n\n    return res;\n  }\n\n  _upsert(rlKey, points, msDuration, forceExpire = false, options = {}) {\n    return new Promise((resolve, reject) => {\n      const nowMs = Date.now();\n      const secDuration = Math.floor(msDuration / 1000);\n\n      if (forceExpire) {\n        this.client.set(rlKey, points, secDuration, (err) => {\n          if (!err) {\n            this.client.set(\n              `${rlKey}_expire`,\n              secDuration > 0 ? nowMs + (secDuration * 1000) : -1,\n              secDuration,\n              () => {\n                const res = {\n                  consumedPoints: points,\n                  msBeforeNext: secDuration > 0 ? secDuration * 1000 : -1,\n                };\n                resolve(res);\n              }\n            );\n          } else {\n            reject(err);\n          }\n        });\n      } else {\n        this.client.incr(rlKey, points, (err, consumedPoints) => {\n          if (err || consumedPoints === false) {\n            this.client.add(rlKey, points, secDuration, (errAddKey, createdNew) => {\n              if (errAddKey || !createdNew) {\n                // Try to upsert again in case of race condition\n                if (typeof options.attemptNumber === 'undefined' || options.attemptNumber < 3) {\n                  const nextOptions = Object.assign({}, options);\n                  nextOptions.attemptNumber = nextOptions.attemptNumber ? (nextOptions.attemptNumber + 1) : 1;\n\n                  this._upsert(rlKey, points, msDuration, forceExpire, nextOptions)\n                    .then(resUpsert => resolve(resUpsert))\n                    .catch(errUpsert => reject(errUpsert));\n                } else {\n                  reject(new Error('Can not add key'));\n                }\n              } else {\n                this.client.add(\n                  `${rlKey}_expire`,\n                  secDuration > 0 ? nowMs + (secDuration * 1000) : -1,\n                  secDuration,\n                  () => {\n                    const res = {\n                      consumedPoints: points,\n                      msBeforeNext: secDuration > 0 ? secDuration * 1000 : -1,\n                    };\n                    resolve(res);\n                  }\n                );\n              }\n            });\n          } else {\n            this.client.get(`${rlKey}_expire`, (errGetExpire, resGetExpireMs) => {\n              if (errGetExpire) {\n                reject(errGetExpire);\n              } else {\n                const expireMs = resGetExpireMs === false ? 0 : resGetExpireMs;\n                const res = {\n                  consumedPoints,\n                  msBeforeNext: expireMs >= 0 ? Math.max(expireMs - nowMs, 0) : -1,\n                };\n                resolve(res);\n              }\n            });\n          }\n        });\n      }\n    });\n  }\n\n  _get(rlKey) {\n    return new Promise((resolve, reject) => {\n      const nowMs = Date.now();\n\n      this.client.get(rlKey, (err, consumedPoints) => {\n        if (!consumedPoints) {\n          resolve(null);\n        } else {\n          this.client.get(`${rlKey}_expire`, (errGetExpire, resGetExpireMs) => {\n            if (errGetExpire) {\n              reject(errGetExpire);\n            } else {\n              const expireMs = resGetExpireMs === false ? 0 : resGetExpireMs;\n              const res = {\n                consumedPoints,\n                msBeforeNext: expireMs >= 0 ? Math.max(expireMs - nowMs, 0) : -1,\n              };\n              resolve(res);\n            }\n          });\n        }\n      });\n    });\n  }\n\n  _delete(rlKey) {\n    return new Promise((resolve, reject) => {\n      this.client.del(rlKey, (err, res) => {\n        if (err) {\n          reject(err);\n        } else if (res === false) {\n          resolve(res);\n        } else {\n          this.client.del(`${rlKey}_expire`, (errDelExpire) => {\n            if (errDelExpire) {\n              reject(errDelExpire);\n            } else {\n              resolve(res);\n            }\n          });\n        }\n      });\n    });\n  }\n}\n\nmodule.exports = RateLimiterMemcache;\n","const RateLimiterAbstract = require('./RateLimiterAbstract');\nconst MemoryStorage = require('./component/MemoryStorage/MemoryStorage');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nclass RateLimiterMemory extends RateLimiterAbstract {\n  constructor(opts = {}) {\n    super(opts);\n\n    this._memoryStorage = new MemoryStorage();\n  }\n  /**\n   *\n   * @param key\n   * @param pointsToConsume\n   * @param {Object} options\n   * @returns {Promise<RateLimiterRes>}\n   */\n  consume(key, pointsToConsume = 1, options = {}) {\n    return new Promise((resolve, reject) => {\n      const rlKey = this.getKey(key);\n      const secDuration = this._getKeySecDuration(options);\n      let res = this._memoryStorage.incrby(rlKey, pointsToConsume, secDuration);\n      res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n\n      if (res.consumedPoints > this.points) {\n        // Block only first time when consumed more than points\n        if (this.blockDuration > 0 && res.consumedPoints <= (this.points + pointsToConsume)) {\n          // Block key\n          res = this._memoryStorage.set(rlKey, res.consumedPoints, this.blockDuration);\n        }\n        reject(res);\n      } else if (this.execEvenly && res.msBeforeNext > 0 && !res.isFirstInDuration) {\n        // Execute evenly\n        let delay = Math.ceil(res.msBeforeNext / (res.remainingPoints + 2));\n        if (delay < this.execEvenlyMinDelayMs) {\n          delay = res.consumedPoints * this.execEvenlyMinDelayMs;\n        }\n\n        setTimeout(resolve, delay, res);\n      } else {\n        resolve(res);\n      }\n    });\n  }\n\n  penalty(key, points = 1, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve) => {\n      const secDuration = this._getKeySecDuration(options);\n      const res = this._memoryStorage.incrby(rlKey, points, secDuration);\n      res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n      resolve(res);\n    });\n  }\n\n  reward(key, points = 1, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve) => {\n      const secDuration = this._getKeySecDuration(options);\n      const res = this._memoryStorage.incrby(rlKey, -points, secDuration);\n      res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n      resolve(res);\n    });\n  }\n\n  /**\n   * Block any key for secDuration seconds\n   *\n   * @param key\n   * @param secDuration\n   */\n  block(key, secDuration) {\n    const msDuration = secDuration * 1000;\n    const initPoints = this.points + 1;\n\n    this._memoryStorage.set(this.getKey(key), initPoints, secDuration);\n    return Promise.resolve(\n      new RateLimiterRes(0, msDuration === 0 ? -1 : msDuration, initPoints)\n    );\n  }\n\n  set(key, points, secDuration) {\n    const msDuration = (secDuration >= 0 ? secDuration : this.duration) * 1000;\n\n    this._memoryStorage.set(this.getKey(key), points, secDuration);\n    return Promise.resolve(\n      new RateLimiterRes(0, msDuration === 0 ? -1 : msDuration, points)\n    );\n  }\n\n  get(key) {\n    const res = this._memoryStorage.get(this.getKey(key));\n    if (res !== null) {\n      res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    }\n\n    return Promise.resolve(res);\n  }\n\n  delete(key) {\n    return Promise.resolve(this._memoryStorage.delete(this.getKey(key)));\n  }\n}\n\nmodule.exports = RateLimiterMemory;\n\n","const RateLimiterStoreAbstract = require('./RateLimiterStoreAbstract');\nconst RateLimiterRes = require('./RateLimiterRes');\n\n/**\n * Get MongoDB driver version as upsert options differ\n * @params {Object} Client instance\n * @returns {Object} Version Object containing major, feature & minor versions.\n */\nfunction getDriverVersion(client) {\n  try {\n    const _client = client.client ? client.client : client;\n\n    const { version } = _client.topology.s.options.metadata.driver;\n    const _v = version.split('.').map(v => parseInt(v));\n\n    return {\n      major: _v[0],\n      feature: _v[1],\n      patch: _v[2],\n    };\n  } catch (err) {\n    return { major: 0, feature: 0, patch: 0 };\n  }\n}\n\nclass RateLimiterMongo extends RateLimiterStoreAbstract {\n  /**\n   *\n   * @param {Object} opts\n   * Defaults {\n   *   indexKeyPrefix: {attr1: 1, attr2: 1}\n   *   ... see other in RateLimiterStoreAbstract\n   *\n   *   mongo: MongoClient\n   * }\n   */\n  constructor(opts) {\n    super(opts);\n\n    this.dbName = opts.dbName;\n    this.tableName = opts.tableName;\n    this.indexKeyPrefix = opts.indexKeyPrefix;\n\n    if (opts.mongo) {\n      this.client = opts.mongo;\n    } else {\n      this.client = opts.storeClient;\n    }\n    if (typeof this.client.then === 'function') {\n      // If Promise\n      this.client\n        .then((conn) => {\n          this.client = conn;\n          this._initCollection();\n          this._driverVersion = getDriverVersion(this.client);\n        });\n    } else {\n      this._initCollection();\n      this._driverVersion = getDriverVersion(this.client);\n    }\n  }\n\n  get dbName() {\n    return this._dbName;\n  }\n\n  set dbName(value) {\n    this._dbName = typeof value === 'undefined' ? RateLimiterMongo.getDbName() : value;\n  }\n\n  static getDbName() {\n    return 'node-rate-limiter-flexible';\n  }\n\n  get tableName() {\n    return this._tableName;\n  }\n\n  set tableName(value) {\n    this._tableName = typeof value === 'undefined' ? this.keyPrefix : value;\n  }\n\n  get client() {\n    return this._client;\n  }\n\n  set client(value) {\n    if (typeof value === 'undefined') {\n      throw new Error('mongo is not set');\n    }\n    this._client = value;\n  }\n\n  get indexKeyPrefix() {\n    return this._indexKeyPrefix;\n  }\n\n  set indexKeyPrefix(obj) {\n    this._indexKeyPrefix = obj || {};\n  }\n\n  _initCollection() {\n    const db = typeof this.client.db === 'function'\n      ? this.client.db(this.dbName)\n      : this.client;\n\n    const collection = db.collection(this.tableName);\n    collection.createIndex({ expire: -1 }, { expireAfterSeconds: 0 });\n    collection.createIndex(Object.assign({}, this.indexKeyPrefix, { key: 1 }), { unique: true });\n\n    this._collection = collection;\n  }\n\n  _getRateLimiterRes(rlKey, changedPoints, result) {\n    const res = new RateLimiterRes();\n\n    let doc;\n    if (typeof result.value === 'undefined') {\n      doc = result;\n    } else {\n      doc = result.value;\n    }\n\n    res.isFirstInDuration = doc.points === changedPoints;\n    res.consumedPoints = doc.points;\n\n    res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    res.msBeforeNext = doc.expire !== null\n      ? Math.max(new Date(doc.expire).getTime() - Date.now(), 0)\n      : -1;\n\n    return res;\n  }\n\n  _upsert(key, points, msDuration, forceExpire = false, options = {}) {\n    if (!this._collection) {\n      return Promise.reject(Error('Mongo connection is not established'));\n    }\n\n    const docAttrs = options.attrs || {};\n\n    let where;\n    let upsertData;\n    if (forceExpire) {\n      where = { key };\n      where = Object.assign(where, docAttrs);\n      upsertData = {\n        $set: {\n          key,\n          points,\n          expire: msDuration > 0 ? new Date(Date.now() + msDuration) : null,\n        },\n      };\n      upsertData.$set = Object.assign(upsertData.$set, docAttrs);\n    } else {\n      where = {\n        $or: [\n          { expire: { $gt: new Date() } },\n          { expire: { $eq: null } },\n        ],\n        key,\n      };\n      where = Object.assign(where, docAttrs);\n      upsertData = {\n        $setOnInsert: {\n          key,\n          expire: msDuration > 0 ? new Date(Date.now() + msDuration) : null,\n        },\n        $inc: { points },\n      };\n      upsertData.$setOnInsert = Object.assign(upsertData.$setOnInsert, docAttrs);\n    }\n\n    // Options for collection updates differ between driver versions\n    const upsertOptions = {\n      upsert: true,\n    };\n    if ((this._driverVersion.major >= 4) ||\n        (this._driverVersion.major === 3 &&\n          (this._driverVersion.feature >=7) || \n          (this._driverVersion.feature >= 6 && \n              this._driverVersion.patch >= 7 ))) \n    {\n      upsertOptions.returnDocument = 'after';\n    } else {\n      upsertOptions.returnOriginal = false;\n    }\n\n    /*\n     * 1. Find actual limit and increment points\n     * 2. If limit expired, but Mongo doesn't clean doc by TTL yet, try to replace limit doc completely\n     * 3. If 2 or more Mongo threads try to insert the new limit doc, only the first succeed\n     * 4. Try to upsert from step 1. Actual limit is created now, points are incremented without problems\n     */\n    return new Promise((resolve, reject) => {\n      this._collection.findOneAndUpdate(\n        where,\n        upsertData,\n        upsertOptions\n      ).then((res) => {\n        resolve(res);\n      }).catch((errUpsert) => {\n        if (errUpsert && errUpsert.code === 11000) { // E11000 duplicate key error collection\n          const replaceWhere = Object.assign({ // try to replace OLD limit doc\n            $or: [\n              { expire: { $lte: new Date() } },\n              { expire: { $eq: null } },\n            ],\n            key,\n          }, docAttrs);\n\n          const replaceTo = {\n            $set: Object.assign({\n              key,\n              points,\n              expire: msDuration > 0 ? new Date(Date.now() + msDuration) : null,\n            }, docAttrs)\n          };\n\n          this._collection.findOneAndUpdate(\n            replaceWhere,\n            replaceTo,\n            upsertOptions\n          ).then((res) => {\n            resolve(res);\n          }).catch((errReplace) => {\n            if (errReplace && errReplace.code === 11000) { // E11000 duplicate key error collection\n              this._upsert(key, points, msDuration, forceExpire)\n                .then(res => resolve(res))\n                .catch(err => reject(err));\n            } else {\n              reject(errReplace);\n            }\n          });\n        } else {\n          reject(errUpsert);\n        }\n      });\n    });\n  }\n\n  _get(rlKey, options = {}) {\n    if (!this._collection) {\n      return Promise.reject(Error('Mongo connection is not established'));\n    }\n\n    const docAttrs = options.attrs || {};\n\n    const where = Object.assign({\n      key: rlKey,\n      $or: [\n        { expire: { $gt: new Date() } },\n        { expire: { $eq: null } },\n      ],\n    }, docAttrs);\n\n    return this._collection.findOne(where);\n  }\n\n  _delete(rlKey, options = {}) {\n    if (!this._collection) {\n      return Promise.reject(Error('Mongo connection is not established'));\n    }\n\n    const docAttrs = options.attrs || {};\n    const where = Object.assign({ key: rlKey }, docAttrs);\n\n    return this._collection.deleteOne(where)\n      .then(res => res.deletedCount > 0);\n  }\n}\n\nmodule.exports = RateLimiterMongo;\n","const RateLimiterStoreAbstract = require('./RateLimiterStoreAbstract');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nclass RateLimiterMySQL extends RateLimiterStoreAbstract {\n  /**\n   * @callback callback\n   * @param {Object} err\n   *\n   * @param {Object} opts\n   * @param {callback} cb\n   * Defaults {\n   *   ... see other in RateLimiterStoreAbstract\n   *\n   *   storeClient: anySqlClient,\n   *   storeType: 'knex', // required only for Knex instance\n   *   dbName: 'string',\n   *   tableName: 'string',\n   * }\n   */\n  constructor(opts, cb = null) {\n    super(opts);\n\n    this.client = opts.storeClient;\n    this.clientType = opts.storeType;\n\n    this.dbName = opts.dbName;\n    this.tableName = opts.tableName;\n\n    this.clearExpiredByTimeout = opts.clearExpiredByTimeout;\n\n    this.tableCreated = opts.tableCreated;\n    if (!this.tableCreated) {\n      this._createDbAndTable()\n        .then(() => {\n          this.tableCreated = true;\n          if (this.clearExpiredByTimeout) {\n            this._clearExpiredHourAgo();\n          }\n          if (typeof cb === 'function') {\n            cb();\n          }\n        })\n        .catch((err) => {\n          if (typeof cb === 'function') {\n            cb(err);\n          } else {\n            throw err;\n          }\n        });\n    } else {\n      if (this.clearExpiredByTimeout) {\n        this._clearExpiredHourAgo();\n      }\n      if (typeof cb === 'function') {\n        cb();\n      }\n    }\n  }\n\n  clearExpired(expire) {\n    return new Promise((resolve) => {\n      this._getConnection()\n        .then((conn) => {\n          conn.query(`DELETE FROM ??.?? WHERE expire < ?`, [this.dbName, this.tableName, expire], () => {\n            this._releaseConnection(conn);\n            resolve();\n          });\n        })\n        .catch(() => {\n          resolve();\n        });\n    });\n  }\n\n  _clearExpiredHourAgo() {\n    if (this._clearExpiredTimeoutId) {\n      clearTimeout(this._clearExpiredTimeoutId);\n    }\n    this._clearExpiredTimeoutId = setTimeout(() => {\n      this.clearExpired(Date.now() - 3600000) // Never rejected\n        .then(() => {\n          this._clearExpiredHourAgo();\n        });\n    }, 300000);\n    this._clearExpiredTimeoutId.unref();\n  }\n\n  /**\n   *\n   * @return Promise<any>\n   * @private\n   */\n  _getConnection() {\n    switch (this.clientType) {\n      case 'pool':\n        return new Promise((resolve, reject) => {\n          this.client.getConnection((errConn, conn) => {\n            if (errConn) {\n              return reject(errConn);\n            }\n\n            resolve(conn);\n          });\n        });\n      case 'sequelize':\n        return this.client.connectionManager.getConnection();\n      case 'knex':\n        return this.client.client.acquireConnection();\n      default:\n        return Promise.resolve(this.client);\n    }\n  }\n\n  _releaseConnection(conn) {\n    switch (this.clientType) {\n      case 'pool':\n        return conn.release();\n      case 'sequelize':\n        return this.client.connectionManager.releaseConnection(conn);\n      case 'knex':\n        return this.client.client.releaseConnection(conn);\n      default:\n        return true;\n    }\n  }\n\n  /**\n   *\n   * @returns {Promise<any>}\n   * @private\n   */\n  _createDbAndTable() {\n    return new Promise((resolve, reject) => {\n      this._getConnection()\n        .then((conn) => {\n          conn.query(`CREATE DATABASE IF NOT EXISTS \\`${this.dbName}\\`;`, (errDb) => {\n            if (errDb) {\n              this._releaseConnection(conn);\n              return reject(errDb);\n            }\n            conn.query(this._getCreateTableStmt(), (err) => {\n              if (err) {\n                this._releaseConnection(conn);\n                return reject(err);\n              }\n              this._releaseConnection(conn);\n              resolve();\n            });\n          });\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  _getCreateTableStmt() {\n    return `CREATE TABLE IF NOT EXISTS \\`${this.dbName}\\`.\\`${this.tableName}\\` (` +\n      '`key` VARCHAR(255) CHARACTER SET utf8 NOT NULL,' +\n      '`points` INT(9) NOT NULL default 0,' +\n      '`expire` BIGINT UNSIGNED,' +\n      'PRIMARY KEY (`key`)' +\n      ') ENGINE = INNODB;';\n  }\n\n  get clientType() {\n    return this._clientType;\n  }\n\n  set clientType(value) {\n    if (typeof value === 'undefined') {\n      if (this.client.constructor.name === 'Connection') {\n        value = 'connection';\n      } else if (this.client.constructor.name === 'Pool') {\n        value = 'pool';\n      } else if (this.client.constructor.name === 'Sequelize') {\n        value = 'sequelize';\n      } else {\n        throw new Error('storeType is not defined');\n      }\n    }\n    this._clientType = value.toLowerCase();\n  }\n\n  get dbName() {\n    return this._dbName;\n  }\n\n  set dbName(value) {\n    this._dbName = typeof value === 'undefined' ? 'rtlmtrflx' : value;\n  }\n\n  get tableName() {\n    return this._tableName;\n  }\n\n  set tableName(value) {\n    this._tableName = typeof value === 'undefined' ? this.keyPrefix : value;\n  }\n\n  get tableCreated() {\n    return this._tableCreated\n  }\n\n  set tableCreated(value) {\n    this._tableCreated = typeof value === 'undefined' ? false : !!value;\n  }\n\n  get clearExpiredByTimeout() {\n    return this._clearExpiredByTimeout;\n  }\n\n  set clearExpiredByTimeout(value) {\n    this._clearExpiredByTimeout = typeof value === 'undefined' ? true : Boolean(value);\n  }\n\n  _getRateLimiterRes(rlKey, changedPoints, result) {\n    const res = new RateLimiterRes();\n    const [row] = result;\n\n    res.isFirstInDuration = changedPoints === row.points;\n    res.consumedPoints = res.isFirstInDuration ? changedPoints : row.points;\n\n    res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    res.msBeforeNext = row.expire\n      ? Math.max(row.expire - Date.now(), 0)\n      : -1;\n\n    return res;\n  }\n\n  _upsertTransaction(conn, key, points, msDuration, forceExpire) {\n    return new Promise((resolve, reject) => {\n      conn.query('BEGIN', (errBegin) => {\n        if (errBegin) {\n          conn.rollback();\n\n          return reject(errBegin);\n        }\n\n        const dateNow = Date.now();\n        const newExpire = msDuration > 0 ? dateNow + msDuration : null;\n\n        let q;\n        let values;\n        if (forceExpire) {\n          q = `INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;`;\n          values = [\n            this.dbName, this.tableName, key, points, newExpire,\n            points,\n            newExpire,\n          ];\n        } else {\n          q = `INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);`;\n          values = [\n            this.dbName, this.tableName, key, points, newExpire,\n            dateNow, points, points,\n            dateNow, newExpire,\n          ];\n        }\n\n        conn.query(q, values, (errUpsert) => {\n          if (errUpsert) {\n            conn.rollback();\n\n            return reject(errUpsert);\n          }\n          conn.query('SELECT points, expire FROM ??.?? WHERE `key` = ?;', [this.dbName, this.tableName, key], (errSelect, res) => {\n            if (errSelect) {\n              conn.rollback();\n\n              return reject(errSelect);\n            }\n\n            conn.query('COMMIT', (err) => {\n              if (err) {\n                conn.rollback();\n\n                return reject(err);\n              }\n\n              resolve(res);\n            });\n          });\n        });\n      });\n    });\n  }\n\n  _upsert(key, points, msDuration, forceExpire = false) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    return new Promise((resolve, reject) => {\n      this._getConnection()\n        .then((conn) => {\n          this._upsertTransaction(conn, key, points, msDuration, forceExpire)\n            .then((res) => {\n              resolve(res);\n              this._releaseConnection(conn);\n            })\n            .catch((err) => {\n              reject(err);\n              this._releaseConnection(conn);\n            });\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  _get(rlKey) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    return new Promise((resolve, reject) => {\n      this._getConnection()\n        .then((conn) => {\n          conn.query(\n            'SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)',\n            [this.dbName, this.tableName, rlKey, Date.now()],\n            (err, res) => {\n              if (err) {\n                reject(err);\n              } else if (res.length === 0) {\n                resolve(null);\n              } else {\n                resolve(res);\n              }\n\n              this._releaseConnection(conn);\n            } // eslint-disable-line\n          );\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  _delete(rlKey) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    return new Promise((resolve, reject) => {\n      this._getConnection()\n        .then((conn) => {\n          conn.query(\n            'DELETE FROM ??.?? WHERE `key` = ?',\n            [this.dbName, this.tableName, rlKey],\n            (err, res) => {\n              if (err) {\n                reject(err);\n              } else {\n                resolve(res.affectedRows > 0);\n              }\n\n              this._releaseConnection(conn);\n            } // eslint-disable-line\n          );\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n}\n\nmodule.exports = RateLimiterMySQL;\n","const RateLimiterStoreAbstract = require('./RateLimiterStoreAbstract');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nclass RateLimiterPostgres extends RateLimiterStoreAbstract {\n  /**\n   * @callback callback\n   * @param {Object} err\n   *\n   * @param {Object} opts\n   * @param {callback} cb\n   * Defaults {\n   *   ... see other in RateLimiterStoreAbstract\n   *\n   *   storeClient: postgresClient,\n   *   storeType: 'knex', // required only for Knex instance\n   *   tableName: 'string',\n   * }\n   */\n  constructor(opts, cb = null) {\n    super(opts);\n\n    this.client = opts.storeClient;\n    this.clientType = opts.storeType;\n\n    this.tableName = opts.tableName;\n\n    this.clearExpiredByTimeout = opts.clearExpiredByTimeout;\n\n    this.tableCreated = opts.tableCreated;\n    if (!this.tableCreated) {\n      this._createTable()\n        .then(() => {\n          this.tableCreated = true;\n          if (this.clearExpiredByTimeout) {\n            this._clearExpiredHourAgo();\n          }\n          if (typeof cb === 'function') {\n            cb();\n          }\n        })\n        .catch((err) => {\n          if (typeof cb === 'function') {\n            cb(err);\n          } else {\n            throw err;\n          }\n        });\n    } else {\n      if (typeof cb === 'function') {\n        cb();\n      }\n    }\n  }\n\n  clearExpired(expire) {\n    return new Promise((resolve) => {\n      const q = {\n        name: 'rlflx-clear-expired',\n        text: `DELETE FROM ${this.tableName} WHERE expire < $1`,\n        values: [expire],\n      };\n      this._query(q)\n        .then(() => {\n          resolve();\n        })\n        .catch(() => {\n          // Deleting expired query is not critical\n          resolve();\n        });\n    });\n  }\n\n  /**\n   * Delete all rows expired 1 hour ago once per 5 minutes\n   *\n   * @private\n   */\n  _clearExpiredHourAgo() {\n    if (this._clearExpiredTimeoutId) {\n      clearTimeout(this._clearExpiredTimeoutId);\n    }\n    this._clearExpiredTimeoutId = setTimeout(() => {\n      this.clearExpired(Date.now() - 3600000) // Never rejected\n        .then(() => {\n          this._clearExpiredHourAgo();\n        });\n    }, 300000);\n    this._clearExpiredTimeoutId.unref();\n  }\n\n  /**\n   *\n   * @return Promise<any>\n   * @private\n   */\n  _getConnection() {\n    switch (this.clientType) {\n      case 'pool':\n        return Promise.resolve(this.client);\n      case 'sequelize':\n        return this.client.connectionManager.getConnection();\n      case 'knex':\n        return this.client.client.acquireConnection();\n      case 'typeorm':\n        return Promise.resolve(this.client.driver.master);\n      default:\n        return Promise.resolve(this.client);\n    }\n  }\n\n  _releaseConnection(conn) {\n    switch (this.clientType) {\n      case 'pool':\n        return true;\n      case 'sequelize':\n        return this.client.connectionManager.releaseConnection(conn);\n      case 'knex':\n        return this.client.client.releaseConnection(conn);\n      case 'typeorm':\n        return true;\n      default:\n        return true;\n    }\n  }\n\n  /**\n   *\n   * @returns {Promise<any>}\n   * @private\n   */\n  _createTable() {\n    return new Promise((resolve, reject) => {\n      this._query({\n        text: this._getCreateTableStmt(),\n      })\n        .then(() => {\n          resolve();\n        })\n        .catch((err) => {\n          if (err.code === '23505') {\n            // Error: duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\n            // Postgres doesn't handle concurrent table creation\n            // It is supposed, that table is created by another worker\n            resolve();\n          } else {\n            reject(err);\n          }\n        });\n    });\n  }\n\n  _getCreateTableStmt() {\n    return `CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`;\n  }\n\n  get clientType() {\n    return this._clientType;\n  }\n\n  set clientType(value) {\n    const constructorName = this.client.constructor.name;\n\n    if (typeof value === 'undefined') {\n      if (constructorName === 'Client') {\n        value = 'client';\n      } else if (\n        constructorName === 'Pool' ||\n        constructorName === 'BoundPool'\n      ) {\n        value = 'pool';\n      } else if (constructorName === 'Sequelize') {\n        value = 'sequelize';\n      } else {\n        throw new Error('storeType is not defined');\n      }\n    }\n\n    this._clientType = value.toLowerCase();\n  }\n\n  get tableName() {\n    return this._tableName;\n  }\n\n  set tableName(value) {\n    this._tableName = typeof value === 'undefined' ? this.keyPrefix : value;\n  }\n\n  get tableCreated() {\n    return this._tableCreated\n  }\n\n  set tableCreated(value) {\n    this._tableCreated = typeof value === 'undefined' ? false : !!value;\n  }\n\n  get clearExpiredByTimeout() {\n    return this._clearExpiredByTimeout;\n  }\n\n  set clearExpiredByTimeout(value) {\n    this._clearExpiredByTimeout = typeof value === 'undefined' ? true : Boolean(value);\n  }\n\n  _getRateLimiterRes(rlKey, changedPoints, result) {\n    const res = new RateLimiterRes();\n    const row = result.rows[0];\n\n    res.isFirstInDuration = changedPoints === row.points;\n    res.consumedPoints = res.isFirstInDuration ? changedPoints : row.points;\n\n    res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    res.msBeforeNext = row.expire\n      ? Math.max(row.expire - Date.now(), 0)\n      : -1;\n\n    return res;\n  }\n\n  _query(q) {\n    const prefix = this.tableName.toLowerCase();\n    const queryObj = { name: `${prefix}:${q.name}`, text: q.text, values: q.values };\n    return new Promise((resolve, reject) => {\n      this._getConnection()\n        .then((conn) => {\n          conn.query(queryObj)\n            .then((res) => {\n              resolve(res);\n              this._releaseConnection(conn);\n            })\n            .catch((err) => {\n              reject(err);\n              this._releaseConnection(conn);\n            });\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  _upsert(key, points, msDuration, forceExpire = false) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    const newExpire = msDuration > 0 ? Date.now() + msDuration : null;\n    const expireQ = forceExpire\n      ? ' $3 '\n      : ` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;\n\n    return this._query({\n      name: forceExpire ? 'rlflx-upsert-force' : 'rlflx-upsert',\n      text: `\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${forceExpire ? 1 : 0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${expireQ}\n            RETURNING points, expire;`,\n      values: [key, points, newExpire, Date.now()],\n    });\n  }\n\n  _get(rlKey) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    return new Promise((resolve, reject) => {\n      this._query({\n        name: 'rlflx-get',\n        text: `\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,\n        values: [rlKey, Date.now()],\n      })\n        .then((res) => {\n          if (res.rowCount === 0) {\n            res = null;\n          }\n          resolve(res);\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    });\n  }\n\n  _delete(rlKey) {\n    if (!this.tableCreated) {\n      return Promise.reject(Error('Table is not created yet'));\n    }\n\n    return this._query({\n      name: 'rlflx-delete',\n      text: `DELETE FROM ${this.tableName} WHERE key = $1`,\n      values: [rlKey],\n    })\n      .then(res => res.rowCount > 0);\n  }\n}\n\nmodule.exports = RateLimiterPostgres;\n","const RateLimiterQueueError = require('./component/RateLimiterQueueError')\nconst MAX_QUEUE_SIZE = 4294967295;\nconst KEY_DEFAULT = 'limiter';\n\nmodule.exports = class RateLimiterQueue {\n  constructor(limiterFlexible, opts = {\n    maxQueueSize: MAX_QUEUE_SIZE,\n  }) {\n    this._queueLimiters = {\n      KEY_DEFAULT: new RateLimiterQueueInternal(limiterFlexible, opts)\n    };\n    this._limiterFlexible = limiterFlexible;\n    this._maxQueueSize = opts.maxQueueSize\n  }\n\n  getTokensRemaining(key = KEY_DEFAULT) {\n    if (this._queueLimiters[key]) {\n      return this._queueLimiters[key].getTokensRemaining()\n    } else {\n      return Promise.resolve(this._limiterFlexible.points)\n    }\n  }\n\n  removeTokens(tokens, key = KEY_DEFAULT) {\n    if (!this._queueLimiters[key]) {\n      this._queueLimiters[key] = new RateLimiterQueueInternal(\n        this._limiterFlexible, {\n          key,\n          maxQueueSize: this._maxQueueSize,\n        })\n    }\n\n    return this._queueLimiters[key].removeTokens(tokens)\n  }\n};\n\nclass RateLimiterQueueInternal {\n\n  constructor(limiterFlexible, opts = {\n    maxQueueSize: MAX_QUEUE_SIZE,\n    key: KEY_DEFAULT,\n  }) {\n    this._key = opts.key;\n    this._waitTimeout = null;\n    this._queue = [];\n    this._limiterFlexible = limiterFlexible;\n\n    this._maxQueueSize = opts.maxQueueSize\n  }\n\n  getTokensRemaining() {\n    return this._limiterFlexible.get(this._key)\n      .then((rlRes) => {\n        return rlRes !== null ? rlRes.remainingPoints : this._limiterFlexible.points;\n      })\n  }\n\n  removeTokens(tokens) {\n    const _this = this;\n\n    return new Promise((resolve, reject) => {\n      if (tokens > _this._limiterFlexible.points) {\n        reject(new RateLimiterQueueError(`Requested tokens ${tokens} exceeds maximum ${_this._limiterFlexible.points} tokens per interval`));\n        return\n      }\n\n      if (_this._queue.length > 0) {\n        _this._queueRequest.call(_this, resolve, reject, tokens);\n      } else {\n        _this._limiterFlexible.consume(_this._key, tokens)\n          .then((res) => {\n            resolve(res.remainingPoints);\n          })\n          .catch((rej) => {\n            if (rej instanceof Error) {\n              reject(rej);\n            } else {\n              _this._queueRequest.call(_this, resolve, reject, tokens);\n              if (_this._waitTimeout === null) {\n                _this._waitTimeout = setTimeout(_this._processFIFO.bind(_this), rej.msBeforeNext);\n              }\n            }\n          });\n      }\n    })\n  }\n\n  _queueRequest(resolve, reject, tokens) {\n    const _this = this;\n    if (_this._queue.length < _this._maxQueueSize) {\n      _this._queue.push({resolve, reject, tokens});\n    } else {\n      reject(new RateLimiterQueueError(`Number of requests reached it's maximum ${_this._maxQueueSize}`))\n    }\n  }\n\n  _processFIFO() {\n    const _this = this;\n\n    if (_this._waitTimeout !== null) {\n      clearTimeout(_this._waitTimeout);\n      _this._waitTimeout = null;\n    }\n\n    if (_this._queue.length === 0) {\n      return;\n    }\n\n    const item = _this._queue.shift();\n    _this._limiterFlexible.consume(_this._key, item.tokens)\n      .then((res) => {\n        item.resolve(res.remainingPoints);\n        _this._processFIFO.call(_this);\n      })\n      .catch((rej) => {\n        if (rej instanceof Error) {\n          item.reject(rej);\n          _this._processFIFO.call(_this);\n        } else {\n          _this._queue.unshift(item);\n          if (_this._waitTimeout === null) {\n            _this._waitTimeout = setTimeout(_this._processFIFO.bind(_this), rej.msBeforeNext);\n          }\n        }\n      });\n  }\n}\n","const RateLimiterStoreAbstract = require('./RateLimiterStoreAbstract');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nconst incrTtlLuaScript = `redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') \\\nlocal consumed = redis.call('incrby', KEYS[1], ARGV[1]) \\\nlocal ttl = redis.call('pttl', KEYS[1]) \\\nif ttl == -1 then \\\n  redis.call('expire', KEYS[1], ARGV[2]) \\\n  ttl = 1000 * ARGV[2] \\\nend \\\nreturn {consumed, ttl} \\\n`;\n\nclass RateLimiterRedis extends RateLimiterStoreAbstract {\n  /**\n   *\n   * @param {Object} opts\n   * Defaults {\n   *   ... see other in RateLimiterStoreAbstract\n   *\n   *   redis: RedisClient\n   *   rejectIfRedisNotReady: boolean = false - reject / invoke insuranceLimiter immediately when redis connection is not \"ready\"\n   * }\n   */\n  constructor(opts) {\n    super(opts);\n    this.client = opts.storeClient;\n\n    this._rejectIfRedisNotReady = !!opts.rejectIfRedisNotReady;\n\n    this.useRedisPackage = opts.useRedisPackage;\n    this.useRedis3AndLowerPackage = opts.useRedis3AndLowerPackage;\n    if (typeof this.client.defineCommand === 'function') {\n      this.client.defineCommand(\"rlflxIncr\", {\n        numberOfKeys: 1,\n        lua: incrTtlLuaScript,\n      });\n    }\n  }\n\n  /**\n   * Prevent actual redis call if redis connection is not ready\n   * Because of different connection state checks for ioredis and node-redis, only this clients would be actually checked.\n   * For any other clients all the requests would be passed directly to redis client\n   * @return {boolean}\n   * @private\n   */\n  _isRedisReady() {\n    if (!this._rejectIfRedisNotReady) {\n      return true;\n    }\n    // ioredis client\n    if (this.client.status && this.client.status !== 'ready') {\n      return false;\n    }\n    // node-redis client\n    if (typeof this.client.isReady === 'function' && !this.client.isReady()) {\n      return false;\n    }\n    return true;\n  }\n\n  _getRateLimiterRes(rlKey, changedPoints, result) {\n    let [consumed, resTtlMs] = result;\n    // Support ioredis results format\n    if (Array.isArray(consumed)) {\n      [, consumed] = consumed;\n      [, resTtlMs] = resTtlMs;\n    }\n\n    const res = new RateLimiterRes();\n    res.consumedPoints = parseInt(consumed);\n    res.isFirstInDuration = res.consumedPoints === changedPoints;\n    res.remainingPoints = Math.max(this.points - res.consumedPoints, 0);\n    res.msBeforeNext = resTtlMs;\n\n    return res;\n  }\n\n  async _upsert(rlKey, points, msDuration, forceExpire = false) {\n    if (!this._isRedisReady()) {\n      throw new Error('Redis connection is not ready');\n    }\n\n    const secDuration = Math.floor(msDuration / 1000);\n    const multi = this.client.multi();\n\n    if (forceExpire) {\n      if (secDuration > 0) {\n        if(!this.useRedisPackage && !this.useRedis3AndLowerPackage){\n          multi.set(rlKey, points, \"EX\", secDuration);\n        }else{\n          multi.set(rlKey, points, { EX: secDuration });\n        }\n      } else {\n        multi.set(rlKey, points);\n      }\n\n      if(!this.useRedisPackage && !this.useRedis3AndLowerPackage){\n        return multi.pttl(rlKey).exec(true);\n      }\n      return multi.pTTL(rlKey).exec(true);\n    }\n\n    if (secDuration > 0) {\n      if(!this.useRedisPackage && !this.useRedis3AndLowerPackage){\n        return this.client.rlflxIncr(\n          [rlKey].concat([String(points), String(secDuration)]));\n      }\n      if (this.useRedis3AndLowerPackage) {\n        return new Promise((resolve, reject) => {\n          const incrCallback = function (err, result) {\n            if (err) {\n              return reject(err);\n            }\n\n            return resolve(result);\n          };\n\n          if (typeof this.client.rlflxIncr === 'function') {\n            this.client.rlflxIncr(rlKey, points, secDuration, incrCallback);\n          } else {\n            this.client.eval(incrTtlLuaScript, 1, rlKey, points, secDuration, incrCallback);\n          }\n        });\n      } else {\n        return this.client.eval(incrTtlLuaScript, {\n          keys: [rlKey],\n          arguments: [String(points), String(secDuration)],\n        });\n      }\n    } else {\n      if(!this.useRedisPackage && !this.useRedis3AndLowerPackage){\n        return multi.incrby(rlKey, points).pttl(rlKey).exec(true);\n      }\n\n      return multi.incrBy(rlKey, points).pTTL(rlKey).exec(true);\n    }\n  }\n\n  async _get(rlKey) {\n    if (!this._isRedisReady()) {\n      throw new Error('Redis connection is not ready');\n    }\n    if(!this.useRedisPackage && !this.useRedis3AndLowerPackage){\n      return this.client\n        .multi()\n        .get(rlKey)\n        .pttl(rlKey)\n        .exec()\n        .then((result) => {\n          const [[,points]] = result;\n          if (points === null) return null;\n          return result;\n        });\n    }\n\n    return this.client\n      .multi()\n      .get(rlKey)\n      .pTTL(rlKey)\n      .exec(true)\n      .then((result) => {\n        const [points] = result;\n        if (points === null) return null;\n        return result;\n      });\n  }\n\n  _delete(rlKey) {\n    return this.client\n      .del(rlKey)\n      .then(result => result > 0);\n  }\n}\n\nmodule.exports = RateLimiterRedis;\n","module.exports = class RateLimiterRes {\n  constructor(remainingPoints, msBeforeNext, consumedPoints, isFirstInDuration) {\n    this.remainingPoints = typeof remainingPoints === 'undefined' ? 0 : remainingPoints; // Remaining points in current duration\n    this.msBeforeNext = typeof msBeforeNext === 'undefined' ? 0 : msBeforeNext; // Milliseconds before next action\n    this.consumedPoints = typeof consumedPoints === 'undefined' ? 0 : consumedPoints; // Consumed points in current duration\n    this.isFirstInDuration = typeof isFirstInDuration === 'undefined' ? false : isFirstInDuration;\n  }\n\n  get msBeforeNext() {\n    return this._msBeforeNext;\n  }\n\n  set msBeforeNext(ms) {\n    this._msBeforeNext = ms;\n    return this;\n  }\n\n  get remainingPoints() {\n    return this._remainingPoints;\n  }\n\n  set remainingPoints(p) {\n    this._remainingPoints = p;\n    return this;\n  }\n\n  get consumedPoints() {\n    return this._consumedPoints;\n  }\n\n  set consumedPoints(p) {\n    this._consumedPoints = p;\n    return this;\n  }\n\n  get isFirstInDuration() {\n    return this._isFirstInDuration;\n  }\n\n  set isFirstInDuration(value) {\n    this._isFirstInDuration = Boolean(value);\n  }\n\n  _getDecoratedProperties() {\n    return {\n      remainingPoints: this.remainingPoints,\n      msBeforeNext: this.msBeforeNext,\n      consumedPoints: this.consumedPoints,\n      isFirstInDuration: this.isFirstInDuration,\n    };\n  }\n\n  [Symbol.for(\"nodejs.util.inspect.custom\")]() {\n    return this._getDecoratedProperties();\n  }\n\n  toString() {\n    return JSON.stringify(this._getDecoratedProperties());\n  }\n\n  toJSON() {\n    return this._getDecoratedProperties();\n  }\n};\n","const RateLimiterAbstract = require('./RateLimiterAbstract');\nconst BlockedKeys = require('./component/BlockedKeys');\nconst RateLimiterRes = require('./RateLimiterRes');\n\nmodule.exports = class RateLimiterStoreAbstract extends RateLimiterAbstract {\n  /**\n   *\n   * @param opts Object Defaults {\n   *   ... see other in RateLimiterAbstract\n   *\n   *   inMemoryBlockOnConsumed: 40, // Number of points when key is blocked\n   *   inMemoryBlockDuration: 10, // Block duration in seconds\n   *   insuranceLimiter: RateLimiterAbstract\n   * }\n   */\n  constructor(opts = {}) {\n    super(opts);\n\n    this.inMemoryBlockOnConsumed = opts.inMemoryBlockOnConsumed;\n    this.inMemoryBlockDuration = opts.inMemoryBlockDuration;\n    this.insuranceLimiter = opts.insuranceLimiter;\n    this._inMemoryBlockedKeys = new BlockedKeys();\n  }\n\n  get client() {\n    return this._client;\n  }\n\n  set client(value) {\n    if (typeof value === 'undefined') {\n      throw new Error('storeClient is not set');\n    }\n    this._client = value;\n  }\n\n  /**\n   * Have to be launched after consume\n   * It blocks key and execute evenly depending on result from store\n   *\n   * It uses _getRateLimiterRes function to prepare RateLimiterRes from store result\n   *\n   * @param resolve\n   * @param reject\n   * @param rlKey\n   * @param changedPoints\n   * @param storeResult\n   * @param {Object} options\n   * @private\n   */\n  _afterConsume(resolve, reject, rlKey, changedPoints, storeResult, options = {}) {\n    const res = this._getRateLimiterRes(rlKey, changedPoints, storeResult);\n\n    if (this.inMemoryBlockOnConsumed > 0 && !(this.inMemoryBlockDuration > 0)\n      && res.consumedPoints >= this.inMemoryBlockOnConsumed\n    ) {\n      this._inMemoryBlockedKeys.addMs(rlKey, res.msBeforeNext);\n      if (res.consumedPoints > this.points) {\n        return reject(res);\n      } else {\n        return resolve(res)\n      }\n    } else if (res.consumedPoints > this.points) {\n      let blockPromise = Promise.resolve();\n      // Block only first time when consumed more than points\n      if (this.blockDuration > 0 && res.consumedPoints <= (this.points + changedPoints)) {\n        res.msBeforeNext = this.msBlockDuration;\n        blockPromise = this._block(rlKey, res.consumedPoints, this.msBlockDuration, options);\n      }\n\n      if (this.inMemoryBlockOnConsumed > 0 && res.consumedPoints >= this.inMemoryBlockOnConsumed) {\n        // Block key for this.inMemoryBlockDuration seconds\n        this._inMemoryBlockedKeys.add(rlKey, this.inMemoryBlockDuration);\n        res.msBeforeNext = this.msInMemoryBlockDuration;\n      }\n\n      blockPromise\n        .then(() => {\n          reject(res);\n        })\n        .catch((err) => {\n          reject(err);\n        });\n    } else if (this.execEvenly && res.msBeforeNext > 0 && !res.isFirstInDuration) {\n      let delay = Math.ceil(res.msBeforeNext / (res.remainingPoints + 2));\n      if (delay < this.execEvenlyMinDelayMs) {\n        delay = res.consumedPoints * this.execEvenlyMinDelayMs;\n      }\n\n      setTimeout(resolve, delay, res);\n    } else {\n      resolve(res);\n    }\n  }\n\n  _handleError(err, funcName, resolve, reject, key, data = false, options = {}) {\n    if (!(this.insuranceLimiter instanceof RateLimiterAbstract)) {\n      reject(err);\n    } else {\n      this.insuranceLimiter[funcName](key, data, options)\n        .then((res) => {\n          resolve(res);\n        })\n        .catch((res) => {\n          reject(res);\n        });\n    }\n  }\n\n  getInMemoryBlockMsBeforeExpire(rlKey) {\n    if (this.inMemoryBlockOnConsumed > 0) {\n      return this._inMemoryBlockedKeys.msBeforeExpire(rlKey);\n    }\n\n    return 0;\n  }\n\n  get inMemoryBlockOnConsumed() {\n    return this._inMemoryBlockOnConsumed;\n  }\n\n  set inMemoryBlockOnConsumed(value) {\n    this._inMemoryBlockOnConsumed = value ? parseInt(value) : 0;\n    if (this.inMemoryBlockOnConsumed > 0 && this.points > this.inMemoryBlockOnConsumed) {\n      throw new Error('inMemoryBlockOnConsumed option must be greater or equal \"points\" option');\n    }\n  }\n\n  get inMemoryBlockDuration() {\n    return this._inMemoryBlockDuration;\n  }\n\n  set inMemoryBlockDuration(value) {\n    this._inMemoryBlockDuration = value ? parseInt(value) : 0;\n    if (this.inMemoryBlockDuration > 0 && this.inMemoryBlockOnConsumed === 0) {\n      throw new Error('inMemoryBlockOnConsumed option must be set up');\n    }\n  }\n\n  get msInMemoryBlockDuration() {\n    return this._inMemoryBlockDuration * 1000;\n  }\n\n  get insuranceLimiter() {\n    return this._insuranceLimiter;\n  }\n\n  set insuranceLimiter(value) {\n    if (typeof value !== 'undefined' && !(value instanceof RateLimiterAbstract)) {\n      throw new Error('insuranceLimiter must be instance of RateLimiterAbstract');\n    }\n    this._insuranceLimiter = value;\n    if (this._insuranceLimiter) {\n      this._insuranceLimiter.blockDuration = this.blockDuration;\n      this._insuranceLimiter.execEvenly = this.execEvenly;\n    }\n  }\n\n  /**\n   * Block any key for secDuration seconds\n   *\n   * @param key\n   * @param secDuration\n   * @param {Object} options\n   *\n   * @return Promise<RateLimiterRes>\n   */\n  block(key, secDuration, options = {}) {\n    const msDuration = secDuration * 1000;\n    return this._block(this.getKey(key), this.points + 1, msDuration, options);\n  }\n\n  /**\n   * Set points by key for any duration\n   *\n   * @param key\n   * @param points\n   * @param secDuration\n   * @param {Object} options\n   *\n   * @return Promise<RateLimiterRes>\n   */\n  set(key, points, secDuration, options = {}) {\n    const msDuration = (secDuration >= 0 ? secDuration : this.duration) * 1000;\n    return this._block(this.getKey(key), points, msDuration, options);\n  }\n\n  /**\n   *\n   * @param key\n   * @param pointsToConsume\n   * @param {Object} options\n   * @returns Promise<RateLimiterRes>\n   */\n  consume(key, pointsToConsume = 1, options = {}) {\n    return new Promise((resolve, reject) => {\n      const rlKey = this.getKey(key);\n\n      const inMemoryBlockMsBeforeExpire = this.getInMemoryBlockMsBeforeExpire(rlKey);\n      if (inMemoryBlockMsBeforeExpire > 0) {\n        return reject(new RateLimiterRes(0, inMemoryBlockMsBeforeExpire));\n      }\n\n      this._upsert(rlKey, pointsToConsume, this._getKeySecDuration(options) * 1000, false, options)\n        .then((res) => {\n          this._afterConsume(resolve, reject, rlKey, pointsToConsume, res);\n        })\n        .catch((err) => {\n          this._handleError(err, 'consume', resolve, reject, key, pointsToConsume, options);\n        });\n    });\n  }\n\n  /**\n   *\n   * @param key\n   * @param points\n   * @param {Object} options\n   * @returns Promise<RateLimiterRes>\n   */\n  penalty(key, points = 1, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve, reject) => {\n      this._upsert(rlKey, points, this._getKeySecDuration(options) * 1000, false, options)\n        .then((res) => {\n          resolve(this._getRateLimiterRes(rlKey, points, res));\n        })\n        .catch((err) => {\n          this._handleError(err, 'penalty', resolve, reject, key, points, options);\n        });\n    });\n  }\n\n  /**\n   *\n   * @param key\n   * @param points\n   * @param {Object} options\n   * @returns Promise<RateLimiterRes>\n   */\n  reward(key, points = 1, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve, reject) => {\n      this._upsert(rlKey, -points, this._getKeySecDuration(options) * 1000, false, options)\n        .then((res) => {\n          resolve(this._getRateLimiterRes(rlKey, -points, res));\n        })\n        .catch((err) => {\n          this._handleError(err, 'reward', resolve, reject, key, points, options);\n        });\n    });\n  }\n\n  /**\n   *\n   * @param key\n   * @param {Object} options\n   * @returns Promise<RateLimiterRes>|null\n   */\n  get(key, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve, reject) => {\n      this._get(rlKey, options)\n        .then((res) => {\n          if (res === null || typeof res === 'undefined') {\n            resolve(null);\n          } else {\n            resolve(this._getRateLimiterRes(rlKey, 0, res));\n          }\n        })\n        .catch((err) => {\n          this._handleError(err, 'get', resolve, reject, key, options);\n        });\n    });\n  }\n\n  /**\n   *\n   * @param key\n   * @param {Object} options\n   * @returns Promise<boolean>\n   */\n  delete(key, options = {}) {\n    const rlKey = this.getKey(key);\n    return new Promise((resolve, reject) => {\n      this._delete(rlKey, options)\n        .then((res) => {\n          this._inMemoryBlockedKeys.delete(rlKey);\n          resolve(res);\n        })\n        .catch((err) => {\n          this._handleError(err, 'delete', resolve, reject, key, options);\n        });\n    });\n  }\n\n  /**\n   * Cleanup keys no-matter expired or not.\n   */\n  deleteInMemoryBlockedAll() {\n    this._inMemoryBlockedKeys.delete();\n  }\n\n  /**\n   * Get RateLimiterRes object filled depending on storeResult, which specific for exact store\n   *\n   * @param rlKey\n   * @param changedPoints\n   * @param storeResult\n   * @private\n   */\n  _getRateLimiterRes(rlKey, changedPoints, storeResult) { // eslint-disable-line no-unused-vars\n    throw new Error(\"You have to implement the method '_getRateLimiterRes'!\");\n  }\n\n  /**\n   * Block key for this.msBlockDuration milliseconds\n   * Usually, it just prolongs lifetime of key\n   *\n   * @param rlKey\n   * @param initPoints\n   * @param msDuration\n   * @param {Object} options\n   *\n   * @return Promise<any>\n   */\n  _block(rlKey, initPoints, msDuration, options = {}) {\n    return new Promise((resolve, reject) => {\n      this._upsert(rlKey, initPoints, msDuration, true, options)\n        .then(() => {\n          resolve(new RateLimiterRes(0, msDuration > 0 ? msDuration : -1, initPoints));\n        })\n        .catch((err) => {\n          this._handleError(err, 'block', resolve, reject, this.parseKey(rlKey), msDuration / 1000, options);\n        });\n    });\n  }\n\n  /**\n   * Have to be implemented in every limiter\n   * Resolve with raw result from Store OR null if rlKey is not set\n   * or Reject with error\n   *\n   * @param rlKey\n   * @param {Object} options\n   * @private\n   *\n   * @return Promise<any>\n   */\n  _get(rlKey, options = {}) { // eslint-disable-line no-unused-vars\n    throw new Error(\"You have to implement the method '_get'!\");\n  }\n\n  /**\n   * Have to be implemented\n   * Resolve with true OR false if rlKey doesn't exist\n   * or Reject with error\n   *\n   * @param rlKey\n   * @param {Object} options\n   * @private\n   *\n   * @return Promise<any>\n   */\n  _delete(rlKey, options = {}) { // eslint-disable-line no-unused-vars\n    throw new Error(\"You have to implement the method '_delete'!\");\n  }\n\n  /**\n   * Have to be implemented\n   * Resolve with object used for {@link _getRateLimiterRes} to generate {@link RateLimiterRes}\n   *\n   * @param {string} rlKey\n   * @param {number} points\n   * @param {number} msDuration\n   * @param {boolean} forceExpire\n   * @param {Object} options\n   * @abstract\n   *\n   * @return Promise<Object>\n   */\n  _upsert(rlKey, points, msDuration, forceExpire = false, options = {}) {\n    throw new Error(\"You have to implement the method '_upsert'!\");\n  }\n};\n","const RateLimiterAbstract = require('./RateLimiterAbstract');\n\nmodule.exports = class RateLimiterUnion {\n  constructor(...limiters) {\n    if (limiters.length < 1) {\n      throw new Error('RateLimiterUnion: at least one limiter have to be passed');\n    }\n    limiters.forEach((limiter) => {\n      if (!(limiter instanceof RateLimiterAbstract)) {\n        throw new Error('RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract');\n      }\n    });\n\n    this._limiters = limiters;\n  }\n\n  consume(key, points = 1) {\n    return new Promise((resolve, reject) => {\n      const promises = [];\n      this._limiters.forEach((limiter) => {\n        promises.push(limiter.consume(key, points).catch(rej => ({ rejected: true, rej })));\n      });\n\n      Promise.all(promises)\n        .then((res) => {\n          const resObj = {};\n          let rejected = false;\n\n          res.forEach((item) => {\n            if (item.rejected === true) {\n              rejected = true;\n            }\n          });\n\n          for (let i = 0; i < res.length; i++) {\n            if (rejected && res[i].rejected === true) {\n              resObj[this._limiters[i].keyPrefix] = res[i].rej;\n            } else if (!rejected) {\n              resObj[this._limiters[i].keyPrefix] = res[i];\n            }\n          }\n\n          if (rejected) {\n            reject(resObj);\n          } else {\n            resolve(resObj);\n          }\n        });\n    });\n  }\n};\n","module.exports = class BlockedKeys {\n  constructor() {\n    this._keys = {}; // {'key': 1526279430331}\n    this._addedKeysAmount = 0;\n  }\n\n  collectExpired() {\n    const now = Date.now();\n\n    Object.keys(this._keys).forEach((key) => {\n      if (this._keys[key] <= now) {\n        delete this._keys[key];\n      }\n    });\n\n    this._addedKeysAmount = Object.keys(this._keys).length;\n  }\n\n  /**\n   * Add new blocked key\n   *\n   * @param key String\n   * @param sec Number\n   */\n  add(key, sec) {\n    this.addMs(key, sec * 1000);\n  }\n\n  /**\n   * Add new blocked key for ms\n   *\n   * @param key String\n   * @param ms Number\n   */\n  addMs(key, ms) {\n    this._keys[key] = Date.now() + ms;\n    this._addedKeysAmount++;\n    if (this._addedKeysAmount > 999) {\n      this.collectExpired();\n    }\n  }\n\n  /**\n   * 0 means not blocked\n   *\n   * @param key\n   * @returns {number}\n   */\n  msBeforeExpire(key) {\n    const expire = this._keys[key];\n\n    if (expire && expire >= Date.now()) {\n      this.collectExpired();\n      const now = Date.now();\n      return expire >= now ? expire - now : 0;\n    }\n\n    return 0;\n  }\n\n  /**\n   * If key is not given, delete all data in memory\n   * \n   * @param {string|undefined} key\n   */\n  delete(key) {\n    if (key) {\n      delete this._keys[key];\n    } else {\n      Object.keys(this._keys).forEach((key) => {\n        delete this._keys[key];\n      });\n    }\n  }\n};\n","const BlockedKeys = require('./BlockedKeys');\n\nmodule.exports = BlockedKeys;\n","const Record = require('./Record');\nconst RateLimiterRes = require('../../RateLimiterRes');\n\nmodule.exports = class MemoryStorage {\n  constructor() {\n    /**\n     * @type {Object.<string, Record>}\n     * @private\n     */\n    this._storage = {};\n  }\n\n  incrby(key, value, durationSec) {\n    if (this._storage[key]) {\n      const msBeforeExpires = this._storage[key].expiresAt\n        ? this._storage[key].expiresAt.getTime() - new Date().getTime()\n        : -1;\n      if (msBeforeExpires !== 0) {\n        // Change value\n        this._storage[key].value = this._storage[key].value + value;\n\n        return new RateLimiterRes(0, msBeforeExpires, this._storage[key].value, false);\n      }\n\n      return this.set(key, value, durationSec);\n    }\n    return this.set(key, value, durationSec);\n  }\n\n  set(key, value, durationSec) {\n    const durationMs = durationSec * 1000;\n\n    if (this._storage[key] && this._storage[key].timeoutId) {\n      clearTimeout(this._storage[key].timeoutId);\n    }\n\n    this._storage[key] = new Record(\n      value,\n      durationMs > 0 ? new Date(Date.now() + durationMs) : null\n    );\n    if (durationMs > 0) {\n      this._storage[key].timeoutId = setTimeout(() => {\n        delete this._storage[key];\n      }, durationMs);\n      if (this._storage[key].timeoutId.unref) {\n        this._storage[key].timeoutId.unref();\n      }\n    }\n\n    return new RateLimiterRes(0, durationMs === 0 ? -1 : durationMs, this._storage[key].value, true);\n  }\n\n  /**\n   *\n   * @param key\n   * @returns {*}\n   */\n  get(key) {\n    if (this._storage[key]) {\n      const msBeforeExpires = this._storage[key].expiresAt\n        ? this._storage[key].expiresAt.getTime() - new Date().getTime()\n        : -1;\n      return new RateLimiterRes(0, msBeforeExpires, this._storage[key].value, false);\n    }\n    return null;\n  }\n\n  /**\n   *\n   * @param key\n   * @returns {boolean}\n   */\n  delete(key) {\n    if (this._storage[key]) {\n      if (this._storage[key].timeoutId) {\n        clearTimeout(this._storage[key].timeoutId);\n      }\n      delete this._storage[key];\n      return true;\n    }\n    return false;\n  }\n};\n","module.exports = class Record {\n  /**\n   *\n   * @param value int\n   * @param expiresAt Date|int\n   * @param timeoutId\n   */\n  constructor(value, expiresAt, timeoutId = null) {\n    this.value = value;\n    this.expiresAt = expiresAt;\n    this.timeoutId = timeoutId;\n  }\n\n  get value() {\n    return this._value;\n  }\n\n  set value(value) {\n    this._value = parseInt(value);\n  }\n\n  get expiresAt() {\n    return this._expiresAt;\n  }\n\n  set expiresAt(value) {\n    if (!(value instanceof Date) && Number.isInteger(value)) {\n      value = new Date(value);\n    }\n    this._expiresAt = value;\n  }\n\n  get timeoutId() {\n    return this._timeoutId;\n  }\n\n  set timeoutId(value) {\n    this._timeoutId = value;\n  }\n};\n","module.exports = class RateLimiterQueueError extends Error {\n  constructor(message, extra) {\n    super();\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor);\n    }\n    this.name = 'CustomError';\n    this.message = message;\n    if (extra) {\n      this.extra = extra;\n    }\n  }\n};\n","// @ts-nocheck\n/*eslint-disable*/\n(function(global, factory) { /* global define, require, module */\n\n    /* AMD */ if (typeof define === 'function' && define.amd)\n        define([\"protobufjs/minimal\"], factory);\n\n    /* CommonJS */ else if (typeof require === 'function' && typeof module === 'object' && module && module.exports)\n        module.exports = factory(require(\"protobufjs/minimal\"));\n\n})(this, function($protobuf) {\n    \"use strict\";\n\n    // Common aliases\n    var $Reader = $protobuf.Reader, $Writer = $protobuf.Writer, $util = $protobuf.util;\n\n    // Exported root namespace\n    var $root = $protobuf.roots[\"default\"] || ($protobuf.roots[\"default\"] = {});\n\n    $root.RPC = (function() {\n\n        /**\n         * Properties of a RPC.\n         * @exports IRPC\n         * @interface IRPC\n         * @property {Array.<RPC.ISubOpts>|null} [subscriptions] RPC subscriptions\n         * @property {Array.<RPC.IMessage>|null} [messages] RPC messages\n         * @property {RPC.IControlMessage|null} [control] RPC control\n         */\n\n        /**\n         * Constructs a new RPC.\n         * @exports RPC\n         * @classdesc Represents a RPC.\n         * @implements IRPC\n         * @constructor\n         * @param {IRPC=} [p] Properties to set\n         */\n        function RPC(p) {\n            this.subscriptions = [];\n            this.messages = [];\n            if (p)\n                for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                    if (p[ks[i]] != null)\n                        this[ks[i]] = p[ks[i]];\n        }\n\n        /**\n         * RPC subscriptions.\n         * @member {Array.<RPC.ISubOpts>} subscriptions\n         * @memberof RPC\n         * @instance\n         */\n        RPC.prototype.subscriptions = $util.emptyArray;\n\n        /**\n         * RPC messages.\n         * @member {Array.<RPC.IMessage>} messages\n         * @memberof RPC\n         * @instance\n         */\n        RPC.prototype.messages = $util.emptyArray;\n\n        /**\n         * RPC control.\n         * @member {RPC.IControlMessage|null|undefined} control\n         * @memberof RPC\n         * @instance\n         */\n        RPC.prototype.control = null;\n\n        // OneOf field names bound to virtual getters and setters\n        var $oneOfFields;\n\n        /**\n         * RPC _control.\n         * @member {\"control\"|undefined} _control\n         * @memberof RPC\n         * @instance\n         */\n        Object.defineProperty(RPC.prototype, \"_control\", {\n            get: $util.oneOfGetter($oneOfFields = [\"control\"]),\n            set: $util.oneOfSetter($oneOfFields)\n        });\n\n        /**\n         * Encodes the specified RPC message. Does not implicitly {@link RPC.verify|verify} messages.\n         * @function encode\n         * @memberof RPC\n         * @static\n         * @param {IRPC} m RPC message or plain object to encode\n         * @param {$protobuf.Writer} [w] Writer to encode to\n         * @returns {$protobuf.Writer} Writer\n         */\n        RPC.encode = function encode(m, w) {\n            if (!w)\n                w = $Writer.create();\n            if (m.subscriptions != null && m.subscriptions.length) {\n                for (var i = 0; i < m.subscriptions.length; ++i)\n                    $root.RPC.SubOpts.encode(m.subscriptions[i], w.uint32(10).fork()).ldelim();\n            }\n            if (m.messages != null && m.messages.length) {\n                for (var i = 0; i < m.messages.length; ++i)\n                    $root.RPC.Message.encode(m.messages[i], w.uint32(18).fork()).ldelim();\n            }\n            if (m.control != null && Object.hasOwnProperty.call(m, \"control\"))\n                $root.RPC.ControlMessage.encode(m.control, w.uint32(26).fork()).ldelim();\n            return w;\n        };\n\n        /**\n         * Decodes a RPC message from the specified reader or buffer.\n         * @function decode\n         * @memberof RPC\n         * @static\n         * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n         * @param {number} [l] Message length if known beforehand\n         * @returns {RPC} RPC\n         * @throws {Error} If the payload is not a reader or valid buffer\n         * @throws {$protobuf.util.ProtocolError} If required fields are missing\n         */\n        RPC.decode = function decode(r, l) {\n            if (!(r instanceof $Reader))\n                r = $Reader.create(r);\n            var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC();\n            while (r.pos < c) {\n                var t = r.uint32();\n                switch (t >>> 3) {\n                case 1:\n                    if (!(m.subscriptions && m.subscriptions.length))\n                        m.subscriptions = [];\n                    m.subscriptions.push($root.RPC.SubOpts.decode(r, r.uint32()));\n                    break;\n                case 2:\n                    if (!(m.messages && m.messages.length))\n                        m.messages = [];\n                    m.messages.push($root.RPC.Message.decode(r, r.uint32()));\n                    break;\n                case 3:\n                    m.control = $root.RPC.ControlMessage.decode(r, r.uint32());\n                    break;\n                default:\n                    r.skipType(t & 7);\n                    break;\n                }\n            }\n            return m;\n        };\n\n        /**\n         * Creates a RPC message from a plain object. Also converts values to their respective internal types.\n         * @function fromObject\n         * @memberof RPC\n         * @static\n         * @param {Object.<string,*>} d Plain object\n         * @returns {RPC} RPC\n         */\n        RPC.fromObject = function fromObject(d) {\n            if (d instanceof $root.RPC)\n                return d;\n            var m = new $root.RPC();\n            if (d.subscriptions) {\n                if (!Array.isArray(d.subscriptions))\n                    throw TypeError(\".RPC.subscriptions: array expected\");\n                m.subscriptions = [];\n                for (var i = 0; i < d.subscriptions.length; ++i) {\n                    if (typeof d.subscriptions[i] !== \"object\")\n                        throw TypeError(\".RPC.subscriptions: object expected\");\n                    m.subscriptions[i] = $root.RPC.SubOpts.fromObject(d.subscriptions[i]);\n                }\n            }\n            if (d.messages) {\n                if (!Array.isArray(d.messages))\n                    throw TypeError(\".RPC.messages: array expected\");\n                m.messages = [];\n                for (var i = 0; i < d.messages.length; ++i) {\n                    if (typeof d.messages[i] !== \"object\")\n                        throw TypeError(\".RPC.messages: object expected\");\n                    m.messages[i] = $root.RPC.Message.fromObject(d.messages[i]);\n                }\n            }\n            if (d.control != null) {\n                if (typeof d.control !== \"object\")\n                    throw TypeError(\".RPC.control: object expected\");\n                m.control = $root.RPC.ControlMessage.fromObject(d.control);\n            }\n            return m;\n        };\n\n        /**\n         * Creates a plain object from a RPC message. Also converts values to other types if specified.\n         * @function toObject\n         * @memberof RPC\n         * @static\n         * @param {RPC} m RPC\n         * @param {$protobuf.IConversionOptions} [o] Conversion options\n         * @returns {Object.<string,*>} Plain object\n         */\n        RPC.toObject = function toObject(m, o) {\n            if (!o)\n                o = {};\n            var d = {};\n            if (o.arrays || o.defaults) {\n                d.subscriptions = [];\n                d.messages = [];\n            }\n            if (m.subscriptions && m.subscriptions.length) {\n                d.subscriptions = [];\n                for (var j = 0; j < m.subscriptions.length; ++j) {\n                    d.subscriptions[j] = $root.RPC.SubOpts.toObject(m.subscriptions[j], o);\n                }\n            }\n            if (m.messages && m.messages.length) {\n                d.messages = [];\n                for (var j = 0; j < m.messages.length; ++j) {\n                    d.messages[j] = $root.RPC.Message.toObject(m.messages[j], o);\n                }\n            }\n            if (m.control != null && m.hasOwnProperty(\"control\")) {\n                d.control = $root.RPC.ControlMessage.toObject(m.control, o);\n                if (o.oneofs)\n                    d._control = \"control\";\n            }\n            return d;\n        };\n\n        /**\n         * Converts this RPC to JSON.\n         * @function toJSON\n         * @memberof RPC\n         * @instance\n         * @returns {Object.<string,*>} JSON object\n         */\n        RPC.prototype.toJSON = function toJSON() {\n            return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n        };\n\n        RPC.SubOpts = (function() {\n\n            /**\n             * Properties of a SubOpts.\n             * @memberof RPC\n             * @interface ISubOpts\n             * @property {boolean|null} [subscribe] SubOpts subscribe\n             * @property {string|null} [topic] SubOpts topic\n             */\n\n            /**\n             * Constructs a new SubOpts.\n             * @memberof RPC\n             * @classdesc Represents a SubOpts.\n             * @implements ISubOpts\n             * @constructor\n             * @param {RPC.ISubOpts=} [p] Properties to set\n             */\n            function SubOpts(p) {\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * SubOpts subscribe.\n             * @member {boolean|null|undefined} subscribe\n             * @memberof RPC.SubOpts\n             * @instance\n             */\n            SubOpts.prototype.subscribe = null;\n\n            /**\n             * SubOpts topic.\n             * @member {string|null|undefined} topic\n             * @memberof RPC.SubOpts\n             * @instance\n             */\n            SubOpts.prototype.topic = null;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * SubOpts _subscribe.\n             * @member {\"subscribe\"|undefined} _subscribe\n             * @memberof RPC.SubOpts\n             * @instance\n             */\n            Object.defineProperty(SubOpts.prototype, \"_subscribe\", {\n                get: $util.oneOfGetter($oneOfFields = [\"subscribe\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * SubOpts _topic.\n             * @member {\"topic\"|undefined} _topic\n             * @memberof RPC.SubOpts\n             * @instance\n             */\n            Object.defineProperty(SubOpts.prototype, \"_topic\", {\n                get: $util.oneOfGetter($oneOfFields = [\"topic\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified SubOpts message. Does not implicitly {@link RPC.SubOpts.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.SubOpts\n             * @static\n             * @param {RPC.ISubOpts} m SubOpts message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            SubOpts.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.subscribe != null && Object.hasOwnProperty.call(m, \"subscribe\"))\n                    w.uint32(8).bool(m.subscribe);\n                if (m.topic != null && Object.hasOwnProperty.call(m, \"topic\"))\n                    w.uint32(18).string(m.topic);\n                return w;\n            };\n\n            /**\n             * Decodes a SubOpts message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.SubOpts\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.SubOpts} SubOpts\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            SubOpts.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.SubOpts();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.subscribe = r.bool();\n                        break;\n                    case 2:\n                        m.topic = r.string();\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a SubOpts message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.SubOpts\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.SubOpts} SubOpts\n             */\n            SubOpts.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.SubOpts)\n                    return d;\n                var m = new $root.RPC.SubOpts();\n                if (d.subscribe != null) {\n                    m.subscribe = Boolean(d.subscribe);\n                }\n                if (d.topic != null) {\n                    m.topic = String(d.topic);\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a SubOpts message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.SubOpts\n             * @static\n             * @param {RPC.SubOpts} m SubOpts\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            SubOpts.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (m.subscribe != null && m.hasOwnProperty(\"subscribe\")) {\n                    d.subscribe = m.subscribe;\n                    if (o.oneofs)\n                        d._subscribe = \"subscribe\";\n                }\n                if (m.topic != null && m.hasOwnProperty(\"topic\")) {\n                    d.topic = m.topic;\n                    if (o.oneofs)\n                        d._topic = \"topic\";\n                }\n                return d;\n            };\n\n            /**\n             * Converts this SubOpts to JSON.\n             * @function toJSON\n             * @memberof RPC.SubOpts\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            SubOpts.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return SubOpts;\n        })();\n\n        RPC.Message = (function() {\n\n            /**\n             * Properties of a Message.\n             * @memberof RPC\n             * @interface IMessage\n             * @property {Uint8Array|null} [from] Message from\n             * @property {Uint8Array|null} [data] Message data\n             * @property {Uint8Array|null} [seqno] Message seqno\n             * @property {string} topic Message topic\n             * @property {Uint8Array|null} [signature] Message signature\n             * @property {Uint8Array|null} [key] Message key\n             */\n\n            /**\n             * Constructs a new Message.\n             * @memberof RPC\n             * @classdesc Represents a Message.\n             * @implements IMessage\n             * @constructor\n             * @param {RPC.IMessage=} [p] Properties to set\n             */\n            function Message(p) {\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * Message from.\n             * @member {Uint8Array|null|undefined} from\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.from = null;\n\n            /**\n             * Message data.\n             * @member {Uint8Array|null|undefined} data\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.data = null;\n\n            /**\n             * Message seqno.\n             * @member {Uint8Array|null|undefined} seqno\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.seqno = null;\n\n            /**\n             * Message topic.\n             * @member {string} topic\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.topic = \"\";\n\n            /**\n             * Message signature.\n             * @member {Uint8Array|null|undefined} signature\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.signature = null;\n\n            /**\n             * Message key.\n             * @member {Uint8Array|null|undefined} key\n             * @memberof RPC.Message\n             * @instance\n             */\n            Message.prototype.key = null;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * Message _from.\n             * @member {\"from\"|undefined} _from\n             * @memberof RPC.Message\n             * @instance\n             */\n            Object.defineProperty(Message.prototype, \"_from\", {\n                get: $util.oneOfGetter($oneOfFields = [\"from\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Message _data.\n             * @member {\"data\"|undefined} _data\n             * @memberof RPC.Message\n             * @instance\n             */\n            Object.defineProperty(Message.prototype, \"_data\", {\n                get: $util.oneOfGetter($oneOfFields = [\"data\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Message _seqno.\n             * @member {\"seqno\"|undefined} _seqno\n             * @memberof RPC.Message\n             * @instance\n             */\n            Object.defineProperty(Message.prototype, \"_seqno\", {\n                get: $util.oneOfGetter($oneOfFields = [\"seqno\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Message _signature.\n             * @member {\"signature\"|undefined} _signature\n             * @memberof RPC.Message\n             * @instance\n             */\n            Object.defineProperty(Message.prototype, \"_signature\", {\n                get: $util.oneOfGetter($oneOfFields = [\"signature\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Message _key.\n             * @member {\"key\"|undefined} _key\n             * @memberof RPC.Message\n             * @instance\n             */\n            Object.defineProperty(Message.prototype, \"_key\", {\n                get: $util.oneOfGetter($oneOfFields = [\"key\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified Message message. Does not implicitly {@link RPC.Message.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.Message\n             * @static\n             * @param {RPC.IMessage} m Message message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            Message.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.from != null && Object.hasOwnProperty.call(m, \"from\"))\n                    w.uint32(10).bytes(m.from);\n                if (m.data != null && Object.hasOwnProperty.call(m, \"data\"))\n                    w.uint32(18).bytes(m.data);\n                if (m.seqno != null && Object.hasOwnProperty.call(m, \"seqno\"))\n                    w.uint32(26).bytes(m.seqno);\n                w.uint32(34).string(m.topic);\n                if (m.signature != null && Object.hasOwnProperty.call(m, \"signature\"))\n                    w.uint32(42).bytes(m.signature);\n                if (m.key != null && Object.hasOwnProperty.call(m, \"key\"))\n                    w.uint32(50).bytes(m.key);\n                return w;\n            };\n\n            /**\n             * Decodes a Message message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.Message\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.Message} Message\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            Message.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.Message();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.from = r.bytes();\n                        break;\n                    case 2:\n                        m.data = r.bytes();\n                        break;\n                    case 3:\n                        m.seqno = r.bytes();\n                        break;\n                    case 4:\n                        m.topic = r.string();\n                        break;\n                    case 5:\n                        m.signature = r.bytes();\n                        break;\n                    case 6:\n                        m.key = r.bytes();\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                if (!m.hasOwnProperty(\"topic\"))\n                    throw $util.ProtocolError(\"missing required 'topic'\", { instance: m });\n                return m;\n            };\n\n            /**\n             * Creates a Message message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.Message\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.Message} Message\n             */\n            Message.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.Message)\n                    return d;\n                var m = new $root.RPC.Message();\n                if (d.from != null) {\n                    if (typeof d.from === \"string\")\n                        $util.base64.decode(d.from, m.from = $util.newBuffer($util.base64.length(d.from)), 0);\n                    else if (d.from.length)\n                        m.from = d.from;\n                }\n                if (d.data != null) {\n                    if (typeof d.data === \"string\")\n                        $util.base64.decode(d.data, m.data = $util.newBuffer($util.base64.length(d.data)), 0);\n                    else if (d.data.length)\n                        m.data = d.data;\n                }\n                if (d.seqno != null) {\n                    if (typeof d.seqno === \"string\")\n                        $util.base64.decode(d.seqno, m.seqno = $util.newBuffer($util.base64.length(d.seqno)), 0);\n                    else if (d.seqno.length)\n                        m.seqno = d.seqno;\n                }\n                if (d.topic != null) {\n                    m.topic = String(d.topic);\n                }\n                if (d.signature != null) {\n                    if (typeof d.signature === \"string\")\n                        $util.base64.decode(d.signature, m.signature = $util.newBuffer($util.base64.length(d.signature)), 0);\n                    else if (d.signature.length)\n                        m.signature = d.signature;\n                }\n                if (d.key != null) {\n                    if (typeof d.key === \"string\")\n                        $util.base64.decode(d.key, m.key = $util.newBuffer($util.base64.length(d.key)), 0);\n                    else if (d.key.length)\n                        m.key = d.key;\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a Message message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.Message\n             * @static\n             * @param {RPC.Message} m Message\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            Message.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (o.defaults) {\n                    d.topic = \"\";\n                }\n                if (m.from != null && m.hasOwnProperty(\"from\")) {\n                    d.from = o.bytes === String ? $util.base64.encode(m.from, 0, m.from.length) : o.bytes === Array ? Array.prototype.slice.call(m.from) : m.from;\n                    if (o.oneofs)\n                        d._from = \"from\";\n                }\n                if (m.data != null && m.hasOwnProperty(\"data\")) {\n                    d.data = o.bytes === String ? $util.base64.encode(m.data, 0, m.data.length) : o.bytes === Array ? Array.prototype.slice.call(m.data) : m.data;\n                    if (o.oneofs)\n                        d._data = \"data\";\n                }\n                if (m.seqno != null && m.hasOwnProperty(\"seqno\")) {\n                    d.seqno = o.bytes === String ? $util.base64.encode(m.seqno, 0, m.seqno.length) : o.bytes === Array ? Array.prototype.slice.call(m.seqno) : m.seqno;\n                    if (o.oneofs)\n                        d._seqno = \"seqno\";\n                }\n                if (m.topic != null && m.hasOwnProperty(\"topic\")) {\n                    d.topic = m.topic;\n                }\n                if (m.signature != null && m.hasOwnProperty(\"signature\")) {\n                    d.signature = o.bytes === String ? $util.base64.encode(m.signature, 0, m.signature.length) : o.bytes === Array ? Array.prototype.slice.call(m.signature) : m.signature;\n                    if (o.oneofs)\n                        d._signature = \"signature\";\n                }\n                if (m.key != null && m.hasOwnProperty(\"key\")) {\n                    d.key = o.bytes === String ? $util.base64.encode(m.key, 0, m.key.length) : o.bytes === Array ? Array.prototype.slice.call(m.key) : m.key;\n                    if (o.oneofs)\n                        d._key = \"key\";\n                }\n                return d;\n            };\n\n            /**\n             * Converts this Message to JSON.\n             * @function toJSON\n             * @memberof RPC.Message\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            Message.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return Message;\n        })();\n\n        RPC.ControlMessage = (function() {\n\n            /**\n             * Properties of a ControlMessage.\n             * @memberof RPC\n             * @interface IControlMessage\n             * @property {Array.<RPC.IControlIHave>|null} [ihave] ControlMessage ihave\n             * @property {Array.<RPC.IControlIWant>|null} [iwant] ControlMessage iwant\n             * @property {Array.<RPC.IControlGraft>|null} [graft] ControlMessage graft\n             * @property {Array.<RPC.IControlPrune>|null} [prune] ControlMessage prune\n             */\n\n            /**\n             * Constructs a new ControlMessage.\n             * @memberof RPC\n             * @classdesc Represents a ControlMessage.\n             * @implements IControlMessage\n             * @constructor\n             * @param {RPC.IControlMessage=} [p] Properties to set\n             */\n            function ControlMessage(p) {\n                this.ihave = [];\n                this.iwant = [];\n                this.graft = [];\n                this.prune = [];\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * ControlMessage ihave.\n             * @member {Array.<RPC.IControlIHave>} ihave\n             * @memberof RPC.ControlMessage\n             * @instance\n             */\n            ControlMessage.prototype.ihave = $util.emptyArray;\n\n            /**\n             * ControlMessage iwant.\n             * @member {Array.<RPC.IControlIWant>} iwant\n             * @memberof RPC.ControlMessage\n             * @instance\n             */\n            ControlMessage.prototype.iwant = $util.emptyArray;\n\n            /**\n             * ControlMessage graft.\n             * @member {Array.<RPC.IControlGraft>} graft\n             * @memberof RPC.ControlMessage\n             * @instance\n             */\n            ControlMessage.prototype.graft = $util.emptyArray;\n\n            /**\n             * ControlMessage prune.\n             * @member {Array.<RPC.IControlPrune>} prune\n             * @memberof RPC.ControlMessage\n             * @instance\n             */\n            ControlMessage.prototype.prune = $util.emptyArray;\n\n            /**\n             * Encodes the specified ControlMessage message. Does not implicitly {@link RPC.ControlMessage.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.ControlMessage\n             * @static\n             * @param {RPC.IControlMessage} m ControlMessage message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            ControlMessage.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.ihave != null && m.ihave.length) {\n                    for (var i = 0; i < m.ihave.length; ++i)\n                        $root.RPC.ControlIHave.encode(m.ihave[i], w.uint32(10).fork()).ldelim();\n                }\n                if (m.iwant != null && m.iwant.length) {\n                    for (var i = 0; i < m.iwant.length; ++i)\n                        $root.RPC.ControlIWant.encode(m.iwant[i], w.uint32(18).fork()).ldelim();\n                }\n                if (m.graft != null && m.graft.length) {\n                    for (var i = 0; i < m.graft.length; ++i)\n                        $root.RPC.ControlGraft.encode(m.graft[i], w.uint32(26).fork()).ldelim();\n                }\n                if (m.prune != null && m.prune.length) {\n                    for (var i = 0; i < m.prune.length; ++i)\n                        $root.RPC.ControlPrune.encode(m.prune[i], w.uint32(34).fork()).ldelim();\n                }\n                return w;\n            };\n\n            /**\n             * Decodes a ControlMessage message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.ControlMessage\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.ControlMessage} ControlMessage\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            ControlMessage.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.ControlMessage();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        if (!(m.ihave && m.ihave.length))\n                            m.ihave = [];\n                        m.ihave.push($root.RPC.ControlIHave.decode(r, r.uint32()));\n                        break;\n                    case 2:\n                        if (!(m.iwant && m.iwant.length))\n                            m.iwant = [];\n                        m.iwant.push($root.RPC.ControlIWant.decode(r, r.uint32()));\n                        break;\n                    case 3:\n                        if (!(m.graft && m.graft.length))\n                            m.graft = [];\n                        m.graft.push($root.RPC.ControlGraft.decode(r, r.uint32()));\n                        break;\n                    case 4:\n                        if (!(m.prune && m.prune.length))\n                            m.prune = [];\n                        m.prune.push($root.RPC.ControlPrune.decode(r, r.uint32()));\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a ControlMessage message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.ControlMessage\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.ControlMessage} ControlMessage\n             */\n            ControlMessage.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.ControlMessage)\n                    return d;\n                var m = new $root.RPC.ControlMessage();\n                if (d.ihave) {\n                    if (!Array.isArray(d.ihave))\n                        throw TypeError(\".RPC.ControlMessage.ihave: array expected\");\n                    m.ihave = [];\n                    for (var i = 0; i < d.ihave.length; ++i) {\n                        if (typeof d.ihave[i] !== \"object\")\n                            throw TypeError(\".RPC.ControlMessage.ihave: object expected\");\n                        m.ihave[i] = $root.RPC.ControlIHave.fromObject(d.ihave[i]);\n                    }\n                }\n                if (d.iwant) {\n                    if (!Array.isArray(d.iwant))\n                        throw TypeError(\".RPC.ControlMessage.iwant: array expected\");\n                    m.iwant = [];\n                    for (var i = 0; i < d.iwant.length; ++i) {\n                        if (typeof d.iwant[i] !== \"object\")\n                            throw TypeError(\".RPC.ControlMessage.iwant: object expected\");\n                        m.iwant[i] = $root.RPC.ControlIWant.fromObject(d.iwant[i]);\n                    }\n                }\n                if (d.graft) {\n                    if (!Array.isArray(d.graft))\n                        throw TypeError(\".RPC.ControlMessage.graft: array expected\");\n                    m.graft = [];\n                    for (var i = 0; i < d.graft.length; ++i) {\n                        if (typeof d.graft[i] !== \"object\")\n                            throw TypeError(\".RPC.ControlMessage.graft: object expected\");\n                        m.graft[i] = $root.RPC.ControlGraft.fromObject(d.graft[i]);\n                    }\n                }\n                if (d.prune) {\n                    if (!Array.isArray(d.prune))\n                        throw TypeError(\".RPC.ControlMessage.prune: array expected\");\n                    m.prune = [];\n                    for (var i = 0; i < d.prune.length; ++i) {\n                        if (typeof d.prune[i] !== \"object\")\n                            throw TypeError(\".RPC.ControlMessage.prune: object expected\");\n                        m.prune[i] = $root.RPC.ControlPrune.fromObject(d.prune[i]);\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a ControlMessage message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.ControlMessage\n             * @static\n             * @param {RPC.ControlMessage} m ControlMessage\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            ControlMessage.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (o.arrays || o.defaults) {\n                    d.ihave = [];\n                    d.iwant = [];\n                    d.graft = [];\n                    d.prune = [];\n                }\n                if (m.ihave && m.ihave.length) {\n                    d.ihave = [];\n                    for (var j = 0; j < m.ihave.length; ++j) {\n                        d.ihave[j] = $root.RPC.ControlIHave.toObject(m.ihave[j], o);\n                    }\n                }\n                if (m.iwant && m.iwant.length) {\n                    d.iwant = [];\n                    for (var j = 0; j < m.iwant.length; ++j) {\n                        d.iwant[j] = $root.RPC.ControlIWant.toObject(m.iwant[j], o);\n                    }\n                }\n                if (m.graft && m.graft.length) {\n                    d.graft = [];\n                    for (var j = 0; j < m.graft.length; ++j) {\n                        d.graft[j] = $root.RPC.ControlGraft.toObject(m.graft[j], o);\n                    }\n                }\n                if (m.prune && m.prune.length) {\n                    d.prune = [];\n                    for (var j = 0; j < m.prune.length; ++j) {\n                        d.prune[j] = $root.RPC.ControlPrune.toObject(m.prune[j], o);\n                    }\n                }\n                return d;\n            };\n\n            /**\n             * Converts this ControlMessage to JSON.\n             * @function toJSON\n             * @memberof RPC.ControlMessage\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            ControlMessage.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return ControlMessage;\n        })();\n\n        RPC.ControlIHave = (function() {\n\n            /**\n             * Properties of a ControlIHave.\n             * @memberof RPC\n             * @interface IControlIHave\n             * @property {string|null} [topicID] ControlIHave topicID\n             * @property {Array.<Uint8Array>|null} [messageIDs] ControlIHave messageIDs\n             */\n\n            /**\n             * Constructs a new ControlIHave.\n             * @memberof RPC\n             * @classdesc Represents a ControlIHave.\n             * @implements IControlIHave\n             * @constructor\n             * @param {RPC.IControlIHave=} [p] Properties to set\n             */\n            function ControlIHave(p) {\n                this.messageIDs = [];\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * ControlIHave topicID.\n             * @member {string|null|undefined} topicID\n             * @memberof RPC.ControlIHave\n             * @instance\n             */\n            ControlIHave.prototype.topicID = null;\n\n            /**\n             * ControlIHave messageIDs.\n             * @member {Array.<Uint8Array>} messageIDs\n             * @memberof RPC.ControlIHave\n             * @instance\n             */\n            ControlIHave.prototype.messageIDs = $util.emptyArray;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * ControlIHave _topicID.\n             * @member {\"topicID\"|undefined} _topicID\n             * @memberof RPC.ControlIHave\n             * @instance\n             */\n            Object.defineProperty(ControlIHave.prototype, \"_topicID\", {\n                get: $util.oneOfGetter($oneOfFields = [\"topicID\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified ControlIHave message. Does not implicitly {@link RPC.ControlIHave.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.ControlIHave\n             * @static\n             * @param {RPC.IControlIHave} m ControlIHave message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            ControlIHave.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.topicID != null && Object.hasOwnProperty.call(m, \"topicID\"))\n                    w.uint32(10).string(m.topicID);\n                if (m.messageIDs != null && m.messageIDs.length) {\n                    for (var i = 0; i < m.messageIDs.length; ++i)\n                        w.uint32(18).bytes(m.messageIDs[i]);\n                }\n                return w;\n            };\n\n            /**\n             * Decodes a ControlIHave message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.ControlIHave\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.ControlIHave} ControlIHave\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            ControlIHave.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.ControlIHave();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.topicID = r.string();\n                        break;\n                    case 2:\n                        if (!(m.messageIDs && m.messageIDs.length))\n                            m.messageIDs = [];\n                        m.messageIDs.push(r.bytes());\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a ControlIHave message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.ControlIHave\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.ControlIHave} ControlIHave\n             */\n            ControlIHave.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.ControlIHave)\n                    return d;\n                var m = new $root.RPC.ControlIHave();\n                if (d.topicID != null) {\n                    m.topicID = String(d.topicID);\n                }\n                if (d.messageIDs) {\n                    if (!Array.isArray(d.messageIDs))\n                        throw TypeError(\".RPC.ControlIHave.messageIDs: array expected\");\n                    m.messageIDs = [];\n                    for (var i = 0; i < d.messageIDs.length; ++i) {\n                        if (typeof d.messageIDs[i] === \"string\")\n                            $util.base64.decode(d.messageIDs[i], m.messageIDs[i] = $util.newBuffer($util.base64.length(d.messageIDs[i])), 0);\n                        else if (d.messageIDs[i].length)\n                            m.messageIDs[i] = d.messageIDs[i];\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a ControlIHave message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.ControlIHave\n             * @static\n             * @param {RPC.ControlIHave} m ControlIHave\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            ControlIHave.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (o.arrays || o.defaults) {\n                    d.messageIDs = [];\n                }\n                if (m.topicID != null && m.hasOwnProperty(\"topicID\")) {\n                    d.topicID = m.topicID;\n                    if (o.oneofs)\n                        d._topicID = \"topicID\";\n                }\n                if (m.messageIDs && m.messageIDs.length) {\n                    d.messageIDs = [];\n                    for (var j = 0; j < m.messageIDs.length; ++j) {\n                        d.messageIDs[j] = o.bytes === String ? $util.base64.encode(m.messageIDs[j], 0, m.messageIDs[j].length) : o.bytes === Array ? Array.prototype.slice.call(m.messageIDs[j]) : m.messageIDs[j];\n                    }\n                }\n                return d;\n            };\n\n            /**\n             * Converts this ControlIHave to JSON.\n             * @function toJSON\n             * @memberof RPC.ControlIHave\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            ControlIHave.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return ControlIHave;\n        })();\n\n        RPC.ControlIWant = (function() {\n\n            /**\n             * Properties of a ControlIWant.\n             * @memberof RPC\n             * @interface IControlIWant\n             * @property {Array.<Uint8Array>|null} [messageIDs] ControlIWant messageIDs\n             */\n\n            /**\n             * Constructs a new ControlIWant.\n             * @memberof RPC\n             * @classdesc Represents a ControlIWant.\n             * @implements IControlIWant\n             * @constructor\n             * @param {RPC.IControlIWant=} [p] Properties to set\n             */\n            function ControlIWant(p) {\n                this.messageIDs = [];\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * ControlIWant messageIDs.\n             * @member {Array.<Uint8Array>} messageIDs\n             * @memberof RPC.ControlIWant\n             * @instance\n             */\n            ControlIWant.prototype.messageIDs = $util.emptyArray;\n\n            /**\n             * Encodes the specified ControlIWant message. Does not implicitly {@link RPC.ControlIWant.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.ControlIWant\n             * @static\n             * @param {RPC.IControlIWant} m ControlIWant message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            ControlIWant.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.messageIDs != null && m.messageIDs.length) {\n                    for (var i = 0; i < m.messageIDs.length; ++i)\n                        w.uint32(10).bytes(m.messageIDs[i]);\n                }\n                return w;\n            };\n\n            /**\n             * Decodes a ControlIWant message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.ControlIWant\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.ControlIWant} ControlIWant\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            ControlIWant.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.ControlIWant();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        if (!(m.messageIDs && m.messageIDs.length))\n                            m.messageIDs = [];\n                        m.messageIDs.push(r.bytes());\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a ControlIWant message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.ControlIWant\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.ControlIWant} ControlIWant\n             */\n            ControlIWant.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.ControlIWant)\n                    return d;\n                var m = new $root.RPC.ControlIWant();\n                if (d.messageIDs) {\n                    if (!Array.isArray(d.messageIDs))\n                        throw TypeError(\".RPC.ControlIWant.messageIDs: array expected\");\n                    m.messageIDs = [];\n                    for (var i = 0; i < d.messageIDs.length; ++i) {\n                        if (typeof d.messageIDs[i] === \"string\")\n                            $util.base64.decode(d.messageIDs[i], m.messageIDs[i] = $util.newBuffer($util.base64.length(d.messageIDs[i])), 0);\n                        else if (d.messageIDs[i].length)\n                            m.messageIDs[i] = d.messageIDs[i];\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a ControlIWant message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.ControlIWant\n             * @static\n             * @param {RPC.ControlIWant} m ControlIWant\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            ControlIWant.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (o.arrays || o.defaults) {\n                    d.messageIDs = [];\n                }\n                if (m.messageIDs && m.messageIDs.length) {\n                    d.messageIDs = [];\n                    for (var j = 0; j < m.messageIDs.length; ++j) {\n                        d.messageIDs[j] = o.bytes === String ? $util.base64.encode(m.messageIDs[j], 0, m.messageIDs[j].length) : o.bytes === Array ? Array.prototype.slice.call(m.messageIDs[j]) : m.messageIDs[j];\n                    }\n                }\n                return d;\n            };\n\n            /**\n             * Converts this ControlIWant to JSON.\n             * @function toJSON\n             * @memberof RPC.ControlIWant\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            ControlIWant.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return ControlIWant;\n        })();\n\n        RPC.ControlGraft = (function() {\n\n            /**\n             * Properties of a ControlGraft.\n             * @memberof RPC\n             * @interface IControlGraft\n             * @property {string|null} [topicID] ControlGraft topicID\n             */\n\n            /**\n             * Constructs a new ControlGraft.\n             * @memberof RPC\n             * @classdesc Represents a ControlGraft.\n             * @implements IControlGraft\n             * @constructor\n             * @param {RPC.IControlGraft=} [p] Properties to set\n             */\n            function ControlGraft(p) {\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * ControlGraft topicID.\n             * @member {string|null|undefined} topicID\n             * @memberof RPC.ControlGraft\n             * @instance\n             */\n            ControlGraft.prototype.topicID = null;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * ControlGraft _topicID.\n             * @member {\"topicID\"|undefined} _topicID\n             * @memberof RPC.ControlGraft\n             * @instance\n             */\n            Object.defineProperty(ControlGraft.prototype, \"_topicID\", {\n                get: $util.oneOfGetter($oneOfFields = [\"topicID\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified ControlGraft message. Does not implicitly {@link RPC.ControlGraft.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.ControlGraft\n             * @static\n             * @param {RPC.IControlGraft} m ControlGraft message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            ControlGraft.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.topicID != null && Object.hasOwnProperty.call(m, \"topicID\"))\n                    w.uint32(10).string(m.topicID);\n                return w;\n            };\n\n            /**\n             * Decodes a ControlGraft message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.ControlGraft\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.ControlGraft} ControlGraft\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            ControlGraft.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.ControlGraft();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.topicID = r.string();\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a ControlGraft message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.ControlGraft\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.ControlGraft} ControlGraft\n             */\n            ControlGraft.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.ControlGraft)\n                    return d;\n                var m = new $root.RPC.ControlGraft();\n                if (d.topicID != null) {\n                    m.topicID = String(d.topicID);\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a ControlGraft message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.ControlGraft\n             * @static\n             * @param {RPC.ControlGraft} m ControlGraft\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            ControlGraft.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (m.topicID != null && m.hasOwnProperty(\"topicID\")) {\n                    d.topicID = m.topicID;\n                    if (o.oneofs)\n                        d._topicID = \"topicID\";\n                }\n                return d;\n            };\n\n            /**\n             * Converts this ControlGraft to JSON.\n             * @function toJSON\n             * @memberof RPC.ControlGraft\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            ControlGraft.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return ControlGraft;\n        })();\n\n        RPC.ControlPrune = (function() {\n\n            /**\n             * Properties of a ControlPrune.\n             * @memberof RPC\n             * @interface IControlPrune\n             * @property {string|null} [topicID] ControlPrune topicID\n             * @property {Array.<RPC.IPeerInfo>|null} [peers] ControlPrune peers\n             * @property {number|null} [backoff] ControlPrune backoff\n             */\n\n            /**\n             * Constructs a new ControlPrune.\n             * @memberof RPC\n             * @classdesc Represents a ControlPrune.\n             * @implements IControlPrune\n             * @constructor\n             * @param {RPC.IControlPrune=} [p] Properties to set\n             */\n            function ControlPrune(p) {\n                this.peers = [];\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * ControlPrune topicID.\n             * @member {string|null|undefined} topicID\n             * @memberof RPC.ControlPrune\n             * @instance\n             */\n            ControlPrune.prototype.topicID = null;\n\n            /**\n             * ControlPrune peers.\n             * @member {Array.<RPC.IPeerInfo>} peers\n             * @memberof RPC.ControlPrune\n             * @instance\n             */\n            ControlPrune.prototype.peers = $util.emptyArray;\n\n            /**\n             * ControlPrune backoff.\n             * @member {number|null|undefined} backoff\n             * @memberof RPC.ControlPrune\n             * @instance\n             */\n            ControlPrune.prototype.backoff = null;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * ControlPrune _topicID.\n             * @member {\"topicID\"|undefined} _topicID\n             * @memberof RPC.ControlPrune\n             * @instance\n             */\n            Object.defineProperty(ControlPrune.prototype, \"_topicID\", {\n                get: $util.oneOfGetter($oneOfFields = [\"topicID\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * ControlPrune _backoff.\n             * @member {\"backoff\"|undefined} _backoff\n             * @memberof RPC.ControlPrune\n             * @instance\n             */\n            Object.defineProperty(ControlPrune.prototype, \"_backoff\", {\n                get: $util.oneOfGetter($oneOfFields = [\"backoff\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified ControlPrune message. Does not implicitly {@link RPC.ControlPrune.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.ControlPrune\n             * @static\n             * @param {RPC.IControlPrune} m ControlPrune message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            ControlPrune.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.topicID != null && Object.hasOwnProperty.call(m, \"topicID\"))\n                    w.uint32(10).string(m.topicID);\n                if (m.peers != null && m.peers.length) {\n                    for (var i = 0; i < m.peers.length; ++i)\n                        $root.RPC.PeerInfo.encode(m.peers[i], w.uint32(18).fork()).ldelim();\n                }\n                if (m.backoff != null && Object.hasOwnProperty.call(m, \"backoff\"))\n                    w.uint32(24).uint64(m.backoff);\n                return w;\n            };\n\n            /**\n             * Decodes a ControlPrune message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.ControlPrune\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.ControlPrune} ControlPrune\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            ControlPrune.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.ControlPrune();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.topicID = r.string();\n                        break;\n                    case 2:\n                        if (!(m.peers && m.peers.length))\n                            m.peers = [];\n                        m.peers.push($root.RPC.PeerInfo.decode(r, r.uint32()));\n                        break;\n                    case 3:\n                        m.backoff = r.uint64();\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a ControlPrune message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.ControlPrune\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.ControlPrune} ControlPrune\n             */\n            ControlPrune.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.ControlPrune)\n                    return d;\n                var m = new $root.RPC.ControlPrune();\n                if (d.topicID != null) {\n                    m.topicID = String(d.topicID);\n                }\n                if (d.peers) {\n                    if (!Array.isArray(d.peers))\n                        throw TypeError(\".RPC.ControlPrune.peers: array expected\");\n                    m.peers = [];\n                    for (var i = 0; i < d.peers.length; ++i) {\n                        if (typeof d.peers[i] !== \"object\")\n                            throw TypeError(\".RPC.ControlPrune.peers: object expected\");\n                        m.peers[i] = $root.RPC.PeerInfo.fromObject(d.peers[i]);\n                    }\n                }\n                if (d.backoff != null) {\n                    if ($util.Long)\n                        (m.backoff = $util.Long.fromValue(d.backoff)).unsigned = true;\n                    else if (typeof d.backoff === \"string\")\n                        m.backoff = parseInt(d.backoff, 10);\n                    else if (typeof d.backoff === \"number\")\n                        m.backoff = d.backoff;\n                    else if (typeof d.backoff === \"object\")\n                        m.backoff = new $util.LongBits(d.backoff.low >>> 0, d.backoff.high >>> 0).toNumber(true);\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a ControlPrune message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.ControlPrune\n             * @static\n             * @param {RPC.ControlPrune} m ControlPrune\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            ControlPrune.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (o.arrays || o.defaults) {\n                    d.peers = [];\n                }\n                if (m.topicID != null && m.hasOwnProperty(\"topicID\")) {\n                    d.topicID = m.topicID;\n                    if (o.oneofs)\n                        d._topicID = \"topicID\";\n                }\n                if (m.peers && m.peers.length) {\n                    d.peers = [];\n                    for (var j = 0; j < m.peers.length; ++j) {\n                        d.peers[j] = $root.RPC.PeerInfo.toObject(m.peers[j], o);\n                    }\n                }\n                if (m.backoff != null && m.hasOwnProperty(\"backoff\")) {\n                    if (typeof m.backoff === \"number\")\n                        d.backoff = o.longs === String ? String(m.backoff) : m.backoff;\n                    else\n                        d.backoff = o.longs === String ? $util.Long.prototype.toString.call(m.backoff) : o.longs === Number ? new $util.LongBits(m.backoff.low >>> 0, m.backoff.high >>> 0).toNumber(true) : m.backoff;\n                    if (o.oneofs)\n                        d._backoff = \"backoff\";\n                }\n                return d;\n            };\n\n            /**\n             * Converts this ControlPrune to JSON.\n             * @function toJSON\n             * @memberof RPC.ControlPrune\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            ControlPrune.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return ControlPrune;\n        })();\n\n        RPC.PeerInfo = (function() {\n\n            /**\n             * Properties of a PeerInfo.\n             * @memberof RPC\n             * @interface IPeerInfo\n             * @property {Uint8Array|null} [peerID] PeerInfo peerID\n             * @property {Uint8Array|null} [signedPeerRecord] PeerInfo signedPeerRecord\n             */\n\n            /**\n             * Constructs a new PeerInfo.\n             * @memberof RPC\n             * @classdesc Represents a PeerInfo.\n             * @implements IPeerInfo\n             * @constructor\n             * @param {RPC.IPeerInfo=} [p] Properties to set\n             */\n            function PeerInfo(p) {\n                if (p)\n                    for (var ks = Object.keys(p), i = 0; i < ks.length; ++i)\n                        if (p[ks[i]] != null)\n                            this[ks[i]] = p[ks[i]];\n            }\n\n            /**\n             * PeerInfo peerID.\n             * @member {Uint8Array|null|undefined} peerID\n             * @memberof RPC.PeerInfo\n             * @instance\n             */\n            PeerInfo.prototype.peerID = null;\n\n            /**\n             * PeerInfo signedPeerRecord.\n             * @member {Uint8Array|null|undefined} signedPeerRecord\n             * @memberof RPC.PeerInfo\n             * @instance\n             */\n            PeerInfo.prototype.signedPeerRecord = null;\n\n            // OneOf field names bound to virtual getters and setters\n            var $oneOfFields;\n\n            /**\n             * PeerInfo _peerID.\n             * @member {\"peerID\"|undefined} _peerID\n             * @memberof RPC.PeerInfo\n             * @instance\n             */\n            Object.defineProperty(PeerInfo.prototype, \"_peerID\", {\n                get: $util.oneOfGetter($oneOfFields = [\"peerID\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * PeerInfo _signedPeerRecord.\n             * @member {\"signedPeerRecord\"|undefined} _signedPeerRecord\n             * @memberof RPC.PeerInfo\n             * @instance\n             */\n            Object.defineProperty(PeerInfo.prototype, \"_signedPeerRecord\", {\n                get: $util.oneOfGetter($oneOfFields = [\"signedPeerRecord\"]),\n                set: $util.oneOfSetter($oneOfFields)\n            });\n\n            /**\n             * Encodes the specified PeerInfo message. Does not implicitly {@link RPC.PeerInfo.verify|verify} messages.\n             * @function encode\n             * @memberof RPC.PeerInfo\n             * @static\n             * @param {RPC.IPeerInfo} m PeerInfo message or plain object to encode\n             * @param {$protobuf.Writer} [w] Writer to encode to\n             * @returns {$protobuf.Writer} Writer\n             */\n            PeerInfo.encode = function encode(m, w) {\n                if (!w)\n                    w = $Writer.create();\n                if (m.peerID != null && Object.hasOwnProperty.call(m, \"peerID\"))\n                    w.uint32(10).bytes(m.peerID);\n                if (m.signedPeerRecord != null && Object.hasOwnProperty.call(m, \"signedPeerRecord\"))\n                    w.uint32(18).bytes(m.signedPeerRecord);\n                return w;\n            };\n\n            /**\n             * Decodes a PeerInfo message from the specified reader or buffer.\n             * @function decode\n             * @memberof RPC.PeerInfo\n             * @static\n             * @param {$protobuf.Reader|Uint8Array} r Reader or buffer to decode from\n             * @param {number} [l] Message length if known beforehand\n             * @returns {RPC.PeerInfo} PeerInfo\n             * @throws {Error} If the payload is not a reader or valid buffer\n             * @throws {$protobuf.util.ProtocolError} If required fields are missing\n             */\n            PeerInfo.decode = function decode(r, l) {\n                if (!(r instanceof $Reader))\n                    r = $Reader.create(r);\n                var c = l === undefined ? r.len : r.pos + l, m = new $root.RPC.PeerInfo();\n                while (r.pos < c) {\n                    var t = r.uint32();\n                    switch (t >>> 3) {\n                    case 1:\n                        m.peerID = r.bytes();\n                        break;\n                    case 2:\n                        m.signedPeerRecord = r.bytes();\n                        break;\n                    default:\n                        r.skipType(t & 7);\n                        break;\n                    }\n                }\n                return m;\n            };\n\n            /**\n             * Creates a PeerInfo message from a plain object. Also converts values to their respective internal types.\n             * @function fromObject\n             * @memberof RPC.PeerInfo\n             * @static\n             * @param {Object.<string,*>} d Plain object\n             * @returns {RPC.PeerInfo} PeerInfo\n             */\n            PeerInfo.fromObject = function fromObject(d) {\n                if (d instanceof $root.RPC.PeerInfo)\n                    return d;\n                var m = new $root.RPC.PeerInfo();\n                if (d.peerID != null) {\n                    if (typeof d.peerID === \"string\")\n                        $util.base64.decode(d.peerID, m.peerID = $util.newBuffer($util.base64.length(d.peerID)), 0);\n                    else if (d.peerID.length)\n                        m.peerID = d.peerID;\n                }\n                if (d.signedPeerRecord != null) {\n                    if (typeof d.signedPeerRecord === \"string\")\n                        $util.base64.decode(d.signedPeerRecord, m.signedPeerRecord = $util.newBuffer($util.base64.length(d.signedPeerRecord)), 0);\n                    else if (d.signedPeerRecord.length)\n                        m.signedPeerRecord = d.signedPeerRecord;\n                }\n                return m;\n            };\n\n            /**\n             * Creates a plain object from a PeerInfo message. Also converts values to other types if specified.\n             * @function toObject\n             * @memberof RPC.PeerInfo\n             * @static\n             * @param {RPC.PeerInfo} m PeerInfo\n             * @param {$protobuf.IConversionOptions} [o] Conversion options\n             * @returns {Object.<string,*>} Plain object\n             */\n            PeerInfo.toObject = function toObject(m, o) {\n                if (!o)\n                    o = {};\n                var d = {};\n                if (m.peerID != null && m.hasOwnProperty(\"peerID\")) {\n                    d.peerID = o.bytes === String ? $util.base64.encode(m.peerID, 0, m.peerID.length) : o.bytes === Array ? Array.prototype.slice.call(m.peerID) : m.peerID;\n                    if (o.oneofs)\n                        d._peerID = \"peerID\";\n                }\n                if (m.signedPeerRecord != null && m.hasOwnProperty(\"signedPeerRecord\")) {\n                    d.signedPeerRecord = o.bytes === String ? $util.base64.encode(m.signedPeerRecord, 0, m.signedPeerRecord.length) : o.bytes === Array ? Array.prototype.slice.call(m.signedPeerRecord) : m.signedPeerRecord;\n                    if (o.oneofs)\n                        d._signedPeerRecord = \"signedPeerRecord\";\n                }\n                return d;\n            };\n\n            /**\n             * Converts this PeerInfo to JSON.\n             * @function toJSON\n             * @memberof RPC.PeerInfo\n             * @instance\n             * @returns {Object.<string,*>} JSON object\n             */\n            PeerInfo.prototype.toJSON = function toJSON() {\n                return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\n            };\n\n            return PeerInfo;\n        })();\n\n        return RPC;\n    })();\n\n    return $root;\n});\n","import { maybe } from \"../globals/index.js\";\nexport var canUseWeakMap = typeof WeakMap === \"function\" &&\n    !maybe(function () { return navigator.product == \"ReactNative\" && !global.HermesInternal; });\nexport var canUseWeakSet = typeof WeakSet === \"function\";\nexport var canUseSymbol = typeof Symbol === \"function\" && typeof Symbol.for === \"function\";\nexport var canUseAsyncIteratorSymbol = canUseSymbol && Symbol.asyncIterator;\nexport var canUseDOM = typeof maybe(function () { return window.document.createElement; }) === \"function\";\nvar usingJSDOM = \n// Following advice found in this comment from @domenic (maintainer of jsdom):\n// https://github.com/jsdom/jsdom/issues/1537#issuecomment-229405327\n//\n// Since we control the version of Jest and jsdom used when running Apollo\n// Client tests, and that version is recent enought to include \" jsdom/x.y.z\"\n// at the end of the user agent string, I believe this case is all we need to\n// check. Testing for \"Node.js\" was recommended for backwards compatibility\n// with older version of jsdom, but we don't have that problem.\nmaybe(function () { return navigator.userAgent.indexOf(\"jsdom\") >= 0; }) || false;\n// Our tests should all continue to pass if we remove this !usingJSDOM\n// condition, thereby allowing useLayoutEffect when using jsdom. Unfortunately,\n// if we allow useLayoutEffect, then useSyncExternalStore generates many\n// warnings about useLayoutEffect doing nothing on the server. While these\n// warnings are harmless, this !usingJSDOM condition seems to be the best way to\n// prevent them (i.e. skipping useLayoutEffect when using jsdom).\nexport var canUseLayoutEffect = canUseDOM && !usingJSDOM;\n//# sourceMappingURL=canUse.js.map","export function maybe(thunk) {\n    try {\n        return thunk();\n    }\n    catch (_a) { }\n}\n//# sourceMappingURL=maybe.js.map","import { parseIP, parseIPv4, parseIPv6 } from \"./parse.js\";\n/** Check if `input` is IPv4. */\nexport function isIPv4(input) {\n    return Boolean(parseIPv4(input));\n}\n/** Check if `input` is IPv6. */\nexport function isIPv6(input) {\n    return Boolean(parseIPv6(input));\n}\n/** Check if `input` is IPv4 or IPv6. */\nexport function isIP(input) {\n    return Boolean(parseIP(input));\n}\n/**\n * @returns `6` if `input` is IPv6, `4` if `input` is IPv4, or `undefined` if `input` is neither.\n */\nexport function ipVersion(input) {\n    if (isIPv4(input)) {\n        return 4;\n    }\n    else if (isIPv6(input)) {\n        return 6;\n    }\n    else {\n        return undefined;\n    }\n}\n//# sourceMappingURL=is-ip.js.map","import { Parser } from \"./parser.js\";\n// See https://stackoverflow.com/questions/166132/maximum-length-of-the-textual-representation-of-an-ipv6-address\nconst MAX_IPV6_LENGTH = 45;\nconst MAX_IPV4_LENGTH = 15;\nconst parser = new Parser();\n/** Parse `input` into IPv4 bytes. */\nexport function parseIPv4(input) {\n    if (input.length > MAX_IPV4_LENGTH) {\n        return undefined;\n    }\n    return parser.new(input).parseWith(() => parser.readIPv4Addr());\n}\n/** Parse `input` into IPv6 bytes. */\nexport function parseIPv6(input) {\n    if (input.length > MAX_IPV6_LENGTH) {\n        return undefined;\n    }\n    return parser.new(input).parseWith(() => parser.readIPv6Addr());\n}\n/** Parse `input` into IPv4 or IPv6 bytes. */\nexport function parseIP(input) {\n    if (input.length > MAX_IPV6_LENGTH) {\n        return undefined;\n    }\n    return parser.new(input).parseWith(() => parser.readIPAddr());\n}\n//# sourceMappingURL=parse.js.map","/* eslint-disable @typescript-eslint/no-unsafe-return */\nexport class Parser {\n    index = 0;\n    input = \"\";\n    new(input) {\n        this.index = 0;\n        this.input = input;\n        return this;\n    }\n    /** Run a parser, and restore the pre-parse state if it fails. */\n    readAtomically(fn) {\n        const index = this.index;\n        const result = fn();\n        if (result === undefined) {\n            this.index = index;\n        }\n        return result;\n    }\n    /** Run a parser, but fail if the entire input wasn't consumed. Doesn't run atomically. */\n    parseWith(fn) {\n        const result = fn();\n        if (this.index !== this.input.length) {\n            return undefined;\n        }\n        return result;\n    }\n    /** Peek the next character from the input */\n    peekChar() {\n        if (this.index >= this.input.length) {\n            return undefined;\n        }\n        return this.input[this.index];\n    }\n    /** Read the next character from the input */\n    readChar() {\n        if (this.index >= this.input.length) {\n            return undefined;\n        }\n        return this.input[this.index++];\n    }\n    /** Read the next character from the input if it matches the target. */\n    readGivenChar(target) {\n        return this.readAtomically(() => {\n            const char = this.readChar();\n            if (char !== target) {\n                return undefined;\n            }\n            return char;\n        });\n    }\n    /**\n     * Helper for reading separators in an indexed loop. Reads the separator\n     * character iff index > 0, then runs the parser. When used in a loop,\n     * the separator character will only be read on index > 0 (see\n     * readIPv4Addr for an example)\n     */\n    readSeparator(sep, index, inner) {\n        return this.readAtomically(() => {\n            if (index > 0) {\n                if (this.readGivenChar(sep) === undefined) {\n                    return undefined;\n                }\n            }\n            return inner();\n        });\n    }\n    /**\n     * Read a number off the front of the input in the given radix, stopping\n     * at the first non-digit character or eof. Fails if the number has more\n     * digits than max_digits or if there is no number.\n     */\n    readNumber(radix, maxDigits, allowZeroPrefix, maxBytes) {\n        return this.readAtomically(() => {\n            let result = 0;\n            let digitCount = 0;\n            const leadingChar = this.peekChar();\n            if (leadingChar === undefined) {\n                return undefined;\n            }\n            const hasLeadingZero = leadingChar === \"0\";\n            const maxValue = 2 ** (8 * maxBytes) - 1;\n            // eslint-disable-next-line no-constant-condition\n            while (true) {\n                const digit = this.readAtomically(() => {\n                    const char = this.readChar();\n                    if (char === undefined) {\n                        return undefined;\n                    }\n                    const num = Number.parseInt(char, radix);\n                    if (Number.isNaN(num)) {\n                        return undefined;\n                    }\n                    return num;\n                });\n                if (digit === undefined) {\n                    break;\n                }\n                result *= radix;\n                result += digit;\n                if (result > maxValue) {\n                    return undefined;\n                }\n                digitCount += 1;\n                if (maxDigits !== undefined) {\n                    if (digitCount > maxDigits) {\n                        return undefined;\n                    }\n                }\n            }\n            if (digitCount === 0) {\n                return undefined;\n            }\n            else if (!allowZeroPrefix && hasLeadingZero && digitCount > 1) {\n                return undefined;\n            }\n            else {\n                return result;\n            }\n        });\n    }\n    /** Read an IPv4 address. */\n    readIPv4Addr() {\n        return this.readAtomically(() => {\n            const out = new Uint8Array(4);\n            for (let i = 0; i < out.length; i++) {\n                const ix = this.readSeparator(\".\", i, () => this.readNumber(10, 3, false, 1));\n                if (ix === undefined) {\n                    return undefined;\n                }\n                out[i] = ix;\n            }\n            return out;\n        });\n    }\n    /** Read an IPv6 Address. */\n    readIPv6Addr() {\n        /**\n         * Read a chunk of an IPv6 address into `groups`. Returns the number\n         * of groups read, along with a bool indicating if an embedded\n         * trailing IPv4 address was read. Specifically, read a series of\n         * colon-separated IPv6 groups (0x0000 - 0xFFFF), with an optional\n         * trailing embedded IPv4 address.\n         */\n        const readGroups = (groups) => {\n            for (let i = 0; i < groups.length / 2; i++) {\n                const ix = i * 2;\n                // Try to read a trailing embedded IPv4 address. There must be at least 4 groups left.\n                if (i < groups.length - 3) {\n                    const ipv4 = this.readSeparator(\":\", i, () => this.readIPv4Addr());\n                    if (ipv4 !== undefined) {\n                        groups[ix] = ipv4[0];\n                        groups[ix + 1] = ipv4[1];\n                        groups[ix + 2] = ipv4[2];\n                        groups[ix + 3] = ipv4[3];\n                        return [ix + 4, true];\n                    }\n                }\n                const group = this.readSeparator(\":\", i, () => this.readNumber(16, 4, true, 2));\n                if (group === undefined) {\n                    return [ix, false];\n                }\n                groups[ix] = group >> 8;\n                groups[ix + 1] = group & 255;\n            }\n            return [groups.length, false];\n        };\n        return this.readAtomically(() => {\n            // Read the front part of the address; either the whole thing, or up to the first ::\n            const head = new Uint8Array(16);\n            const [headSize, headIp4] = readGroups(head);\n            if (headSize === 16) {\n                return head;\n            }\n            // IPv4 part is not allowed before `::`\n            if (headIp4) {\n                return undefined;\n            }\n            // Read `::` if previous code parsed less than 8 groups.\n            // `::` indicates one or more groups of 16 bits of zeros.\n            if (this.readGivenChar(\":\") === undefined) {\n                return undefined;\n            }\n            if (this.readGivenChar(\":\") === undefined) {\n                return undefined;\n            }\n            // Read the back part of the address. The :: must contain at least one\n            // set of zeroes, so our max length is 7.\n            const tail = new Uint8Array(14);\n            const limit = 16 - (headSize + 2);\n            const [tailSize] = readGroups(tail.subarray(0, limit));\n            // Concat the head and tail of the IP address\n            head.set(tail.subarray(0, tailSize), 16 - tailSize);\n            return head;\n        });\n    }\n    /** Read an IP Address, either IPv4 or IPv6. */\n    readIPAddr() {\n        return this.readIPv4Addr() ?? this.readIPv6Addr();\n    }\n}\n//# sourceMappingURL=parser.js.map","import defer from 'p-defer';\n/**\n * A pair of streams where one drains from the other\n */\nexport function pair() {\n    const deferred = defer();\n    let piped = false;\n    return {\n        sink: async (source) => {\n            if (piped) {\n                throw new Error('already piped');\n            }\n            piped = true;\n            deferred.resolve(source);\n        },\n        source: (async function* () {\n            const source = await deferred.promise;\n            yield* source;\n        }())\n    };\n}\n//# sourceMappingURL=index.js.map","export const NOISE_MSG_MAX_LENGTH_BYTES = 65535;\nexport const NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG = NOISE_MSG_MAX_LENGTH_BYTES - 16;\nexport const DUMP_SESSION_KEYS = Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);\n//# sourceMappingURL=constants.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nfunction bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import { hash as assertHash, number as assertNumber } from './_assert.js';\nimport { toBytes } from './utils.js';\nimport { hmac } from './hmac.js';\n// HKDF (RFC 5869)\n// https://soatok.blog/2021/11/17/understanding-hkdf/\n/**\n * HKDF-Extract(IKM, salt) -> PRK\n * Arguments position differs from spec (IKM is first one, since it is not optional)\n * @param hash\n * @param ikm\n * @param salt\n * @returns\n */\nexport function extract(hash, ikm, salt) {\n    assertHash(hash);\n    // NOTE: some libraries treat zero-length array as 'not provided';\n    // we don't, since we have undefined as 'not provided'\n    // https://github.com/RustCrypto/KDFs/issues/15\n    if (salt === undefined)\n        salt = new Uint8Array(hash.outputLen); // if not provided, it is set to a string of HashLen zeros\n    return hmac(hash, toBytes(salt), toBytes(ikm));\n}\n// HKDF-Expand(PRK, info, L) -> OKM\nconst HKDF_COUNTER = /* @__PURE__ */ new Uint8Array([0]);\nconst EMPTY_BUFFER = /* @__PURE__ */ new Uint8Array();\n/**\n * HKDF-expand from the spec.\n * @param prk - a pseudorandom key of at least HashLen octets (usually, the output from the extract step)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in octets\n */\nexport function expand(hash, prk, info, length = 32) {\n    assertHash(hash);\n    assertNumber(length);\n    if (length > 255 * hash.outputLen)\n        throw new Error('Length should be <= 255*HashLen');\n    const blocks = Math.ceil(length / hash.outputLen);\n    if (info === undefined)\n        info = EMPTY_BUFFER;\n    // first L(ength) octets of T\n    const okm = new Uint8Array(blocks * hash.outputLen);\n    // Re-use HMAC instance between blocks\n    const HMAC = hmac.create(hash, prk);\n    const HMACTmp = HMAC._cloneInto();\n    const T = new Uint8Array(HMAC.outputLen);\n    for (let counter = 0; counter < blocks; counter++) {\n        HKDF_COUNTER[0] = counter + 1;\n        // T(0) = empty string (zero length)\n        // T(N) = HMAC-Hash(PRK, T(N-1) | info | N)\n        HMACTmp.update(counter === 0 ? EMPTY_BUFFER : T)\n            .update(info)\n            .update(HKDF_COUNTER)\n            .digestInto(T);\n        okm.set(T, hash.outputLen * counter);\n        HMAC._cloneInto(HMACTmp);\n    }\n    HMAC.destroy();\n    HMACTmp.destroy();\n    T.fill(0);\n    HKDF_COUNTER.fill(0);\n    return okm.slice(0, length);\n}\n/**\n * HKDF (RFC 5869): extract + expand in one step.\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n * @param info - optional context and application specific information\n * @param length - length of output keying material in octets\n */\nexport const hkdf = (hash, ikm, salt, info, length) => expand(hash, extract(hash, ikm, salt), info, length);\n//# sourceMappingURL=hkdf.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","import { chacha20poly1305 } from '@noble/ciphers/chacha';\nimport { x25519 } from '@noble/curves/ed25519';\nimport { extract, expand } from '@noble/hashes/hkdf';\nimport { sha256 } from '@noble/hashes/sha256';\nexport const pureJsCrypto = {\n    hashSHA256(data) {\n        return sha256(data);\n    },\n    getHKDF(ck, ikm) {\n        const prk = extract(sha256, ikm, ck);\n        const okmU8Array = expand(sha256, prk, undefined, 96);\n        const okm = okmU8Array;\n        const k1 = okm.subarray(0, 32);\n        const k2 = okm.subarray(32, 64);\n        const k3 = okm.subarray(64, 96);\n        return [k1, k2, k3];\n    },\n    generateX25519KeyPair() {\n        const secretKey = x25519.utils.randomPrivateKey();\n        const publicKey = x25519.getPublicKey(secretKey);\n        return {\n            publicKey,\n            privateKey: secretKey\n        };\n    },\n    generateX25519KeyPairFromSeed(seed) {\n        const publicKey = x25519.getPublicKey(seed);\n        return {\n            publicKey,\n            privateKey: seed\n        };\n    },\n    generateX25519SharedKey(privateKey, publicKey) {\n        return x25519.getSharedSecret(privateKey, publicKey);\n    },\n    chaCha20Poly1305Encrypt(plaintext, nonce, ad, k) {\n        return chacha20poly1305(k, nonce, ad).encrypt(plaintext);\n    },\n    chaCha20Poly1305Decrypt(ciphertext, nonce, ad, k, dst) {\n        return chacha20poly1305(k, nonce, ad).decrypt(ciphertext, dst);\n    }\n};\n//# sourceMappingURL=js.js.map","/**\n * To guarantee Uint8Array semantics, convert nodejs Buffers\n * into vanilla Uint8Arrays\n */\nexport function asUint8Array(buf) {\n    if (globalThis.Buffer != null) {\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    return buf;\n}\n//# sourceMappingURL=as-uint8array.js.map","import { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc(size = 0) {\n    if (globalThis.Buffer?.alloc != null) {\n        return asUint8Array(globalThis.Buffer.alloc(size));\n    }\n    return new Uint8Array(size);\n}\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe(size = 0) {\n    if (globalThis.Buffer?.allocUnsafe != null) {\n        return asUint8Array(globalThis.Buffer.allocUnsafe(size));\n    }\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc.js.map","import { allocUnsafe } from './alloc.js';\nimport { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a new Uint8Array created by concatenating the passed ArrayLikes\n */\nexport function concat(arrays, length) {\n    if (length == null) {\n        length = arrays.reduce((acc, curr) => acc + curr.length, 0);\n    }\n    const output = allocUnsafe(length);\n    let offset = 0;\n    for (const arr of arrays) {\n        output.set(arr, offset);\n        offset += arr.length;\n    }\n    return asUint8Array(output);\n}\n//# sourceMappingURL=concat.js.map","import { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nconst allocUnsafe = (len) => {\n    if (globalThis.Buffer) {\n        return globalThis.Buffer.allocUnsafe(len);\n    }\n    return new Uint8Array(len);\n};\nexport const uint16BEEncode = (value) => {\n    const target = allocUnsafe(2);\n    new DataView(target.buffer, target.byteOffset, target.byteLength).setUint16(0, value, false);\n    return target;\n};\nuint16BEEncode.bytes = 2;\nexport const uint16BEDecode = (data) => {\n    if (data.length < 2)\n        throw RangeError('Could not decode int16BE');\n    if (data instanceof Uint8Array) {\n        return new DataView(data.buffer, data.byteOffset, data.byteLength).getUint16(0, false);\n    }\n    return data.getUint16(0);\n};\nuint16BEDecode.bytes = 2;\n// Note: IK and XX encoder usage is opposite (XX uses in stages encode0 where IK uses encode1)\nexport function encode0(message) {\n    return uint8ArrayConcat([message.ne, message.ciphertext], message.ne.length + message.ciphertext.length);\n}\nexport function encode1(message) {\n    return uint8ArrayConcat([message.ne, message.ns, message.ciphertext], message.ne.length + message.ns.length + message.ciphertext.length);\n}\nexport function encode2(message) {\n    return uint8ArrayConcat([message.ns, message.ciphertext], message.ns.length + message.ciphertext.length);\n}\nexport function decode0(input) {\n    if (input.length < 32) {\n        throw new Error('Cannot decode stage 0 MessageBuffer: length less than 32 bytes.');\n    }\n    return {\n        ne: input.subarray(0, 32),\n        ciphertext: input.subarray(32, input.length),\n        ns: new Uint8Array(0)\n    };\n}\nexport function decode1(input) {\n    if (input.length < 80) {\n        throw new Error('Cannot decode stage 1 MessageBuffer: length less than 80 bytes.');\n    }\n    return {\n        ne: input.subarray(0, 32),\n        ns: input.subarray(32, 80),\n        ciphertext: input.subarray(80, input.length)\n    };\n}\nexport function decode2(input) {\n    if (input.length < 48) {\n        throw new Error('Cannot decode stage 2 MessageBuffer: length less than 48 bytes.');\n    }\n    return {\n        ne: new Uint8Array(0),\n        ns: input.subarray(0, 48),\n        ciphertext: input.subarray(48, input.length)\n    };\n}\n//# sourceMappingURL=encoder.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { baseX } from './base.js'\n\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n})\n\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n})\n","import { from } from './base.js'\n\nconst alphabet = Array.from('🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂')\nconst alphabetBytesToChars = /** @type {string[]} */ (alphabet.reduce((p, c, i) => { p[i] = c; return p }, /** @type {string[]} */([])))\nconst alphabetCharsToBytes = /** @type {number[]} */ (alphabet.reduce((p, c, i) => { p[/** @type {number} */ (c.codePointAt(0))] = i; return p }, /** @type {number[]} */([])))\n\n/**\n * @param {Uint8Array} data\n * @returns {string}\n */\nfunction encode (data) {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c]\n    return p\n  }, '')\n}\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction decode (str) {\n  const byts = []\n  for (const char of str) {\n    const byt = alphabetCharsToBytes[/** @type {number} */ (char.codePointAt(0))]\n    if (byt === undefined) {\n      throw new Error(`Non-base256emoji character: ${char}`)\n    }\n    byts.push(byt)\n  }\n  return new Uint8Array(byts)\n}\n\nexport const base256emoji = from({\n  prefix: '🚀',\n  name: 'base256emoji',\n  encode,\n  decode\n})\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n})\n\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n})\n","// @ts-check\n\nimport { fromString, toString } from '../bytes.js'\nimport { from } from './base.js'\n\nexport const identity = from({\n  prefix: '\\x00',\n  name: 'identity',\n  encode: (buf) => toString(buf),\n  decode: (str) => fromString(str)\n})\n","// @ts-check\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nconst textEncoder = new TextEncoder()\nconst textDecoder = new TextDecoder()\n\nexport const name = 'json'\nexport const code = 0x0200\n\n/**\n * @template T\n * @param {T} node\n * @returns {ByteView<T>}\n */\nexport const encode = (node) => textEncoder.encode(JSON.stringify(node))\n\n/**\n * @template T\n * @param {ByteView<T>} data\n * @returns {T}\n */\nexport const decode = (data) => JSON.parse(textDecoder.decode(data))\n","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code = 0x0\nconst name = 'identity'\n\n/** @type {(input:Uint8Array) => Uint8Array} */\nconst encode = coerce\n\n/**\n * @param {Uint8Array} input\n * @returns {Digest.Digest<typeof code, number>}\n */\nconst digest = (input) => Digest.create(code, encode(input))\n\nexport const identity = { code, name, encode, digest }\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","/* global crypto */\n\nimport { from } from './hasher.js'\n\n/**\n * @param {AlgorithmIdentifier} name\n */\nconst sha = name =>\n  /**\n   * @param {Uint8Array} data\n   */\n  async data => new Uint8Array(await crypto.subtle.digest(name, data))\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","// @ts-check\n\nimport * as base10 from './bases/base10.js'\nimport * as base16 from './bases/base16.js'\nimport * as base2 from './bases/base2.js'\nimport * as base256emoji from './bases/base256emoji.js'\nimport * as base32 from './bases/base32.js'\nimport * as base36 from './bases/base36.js'\nimport * as base58 from './bases/base58.js'\nimport * as base64 from './bases/base64.js'\nimport * as base8 from './bases/base8.js'\nimport * as identityBase from './bases/identity.js'\nimport * as json from './codecs/json.js'\nimport * as raw from './codecs/raw.js'\nimport * as identity from './hashes/identity.js'\nimport * as sha2 from './hashes/sha2.js'\nimport { CID, hasher, digest, varint, bytes } from './index.js'\n\nconst bases = { ...identityBase, ...base2, ...base8, ...base10, ...base16, ...base32, ...base36, ...base58, ...base64, ...base256emoji }\nconst hashes = { ...sha2, ...identity }\nconst codecs = { raw, json }\n\nexport { CID, hasher, digest, varint, bytes, hashes, bases, codecs }\n","import { bases } from 'multiformats/basics';\nimport { allocUnsafe } from '../alloc.js';\nfunction createCodec(name, prefix, encode, decode) {\n    return {\n        name,\n        prefix,\n        encoder: {\n            name,\n            prefix,\n            encode\n        },\n        decoder: {\n            decode\n        }\n    };\n}\nconst string = createCodec('utf8', 'u', (buf) => {\n    const decoder = new TextDecoder('utf8');\n    return 'u' + decoder.decode(buf);\n}, (str) => {\n    const encoder = new TextEncoder();\n    return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', (buf) => {\n    let string = 'a';\n    for (let i = 0; i < buf.length; i++) {\n        string += String.fromCharCode(buf[i]);\n    }\n    return string;\n}, (str) => {\n    str = str.substring(1);\n    const buf = allocUnsafe(str.length);\n    for (let i = 0; i < str.length; i++) {\n        buf[i] = str.charCodeAt(i);\n    }\n    return buf;\n});\nconst BASES = {\n    utf8: string,\n    'utf-8': string,\n    hex: bases.base16,\n    latin1: ascii,\n    ascii,\n    binary: ascii,\n    ...bases\n};\nexport default BASES;\n//# sourceMappingURL=bases.js.map","import { asUint8Array } from './util/as-uint8array.js';\nimport bases, {} from './util/bases.js';\n/**\n * Create a `Uint8Array` from the passed string\n *\n * Supports `utf8`, `utf-8`, `hex`, and any encoding supported by the multiformats module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function fromString(string, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return asUint8Array(globalThis.Buffer.from(string, 'utf-8'));\n    }\n    // add multibase prefix\n    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions\n}\n//# sourceMappingURL=from-string.js.map","/**\n * Returns true if the two passed Uint8Arrays have the same content\n */\nexport function equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a.byteLength !== b.byteLength) {\n        return false;\n    }\n    for (let i = 0; i < a.byteLength; i++) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=equals.js.map","import { ed25519 as ed } from '@noble/curves/ed25519';\nconst PUBLIC_KEY_BYTE_LENGTH = 32;\nconst PRIVATE_KEY_BYTE_LENGTH = 64; // private key is actually 32 bytes but for historical reasons we concat private and public keys\nconst KEYS_BYTE_LENGTH = 32;\nexport { PUBLIC_KEY_BYTE_LENGTH as publicKeyLength };\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport async function generateKey() {\n    // the actual private key (32 bytes)\n    const privateKeyRaw = ed.utils.randomPrivateKey();\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    // concatenated the public key to the private key\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\n/**\n * Generate keypair from a 32 byte uint8array\n */\nexport async function generateKeyFromSeed(seed) {\n    if (seed.length !== KEYS_BYTE_LENGTH) {\n        throw new TypeError('\"seed\" must be 32 bytes in length.');\n    }\n    else if (!(seed instanceof Uint8Array)) {\n        throw new TypeError('\"seed\" must be a node.js Buffer, or Uint8Array.');\n    }\n    // based on node forges algorithm, the seed is used directly as private key\n    const privateKeyRaw = seed;\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\nexport async function hashAndSign(privateKey, msg) {\n    const privateKeyRaw = privateKey.subarray(0, KEYS_BYTE_LENGTH);\n    return ed.sign(msg, privateKeyRaw);\n}\nexport async function hashAndVerify(publicKey, sig, msg) {\n    return ed.verify(sig, msg, publicKey);\n}\nfunction concatKeys(privateKeyRaw, publicKey) {\n    const privateKey = new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);\n    for (let i = 0; i < KEYS_BYTE_LENGTH; i++) {\n        privateKey[i] = privateKeyRaw[i];\n        privateKey[KEYS_BYTE_LENGTH + i] = publicKey[i];\n    }\n    return privateKey;\n}\n//# sourceMappingURL=ed25519-browser.js.map","/* eslint-env browser */\n// Check native crypto exists and is enabled (In insecure context `self.crypto`\n// exists but `self.crypto.subtle` does not).\nexport default {\n    get(win = globalThis) {\n        const nativeCrypto = win.crypto;\n        if (nativeCrypto == null || nativeCrypto.subtle == null) {\n            throw Object.assign(new Error('Missing Web Crypto API. ' +\n                'The most likely cause of this error is that this page is being accessed ' +\n                'from an insecure context (i.e. not HTTPS). For more information and ' +\n                'possible resolutions see ' +\n                'https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api'), { code: 'ERR_MISSING_WEB_CRYPTO' });\n        }\n        return nativeCrypto;\n    }\n};\n//# sourceMappingURL=webcrypto.js.map","import { concat } from 'uint8arrays/concat';\nimport { fromString } from 'uint8arrays/from-string';\nimport webcrypto from '../webcrypto.js';\n// WebKit on Linux does not support deriving a key from an empty PBKDF2 key.\n// So, as a workaround, we provide the generated key as a constant. We test that\n// this generated key is accurate in test/workaround.spec.ts\n// Generated via:\n// await crypto.subtle.exportKey('jwk',\n//   await crypto.subtle.deriveKey(\n//     { name: 'PBKDF2', salt: new Uint8Array(16), iterations: 32767, hash: { name: 'SHA-256' } },\n//     await crypto.subtle.importKey('raw', new Uint8Array(0), { name: 'PBKDF2' }, false, ['deriveKey']),\n//     { name: 'AES-GCM', length: 128 }, true, ['encrypt', 'decrypt'])\n// )\nexport const derivedEmptyPasswordKey = { alg: 'A128GCM', ext: true, k: 'scm9jmO_4BJAgdwWGVulLg', key_ops: ['encrypt', 'decrypt'], kty: 'oct' };\n// Based off of code from https://github.com/luke-park/SecureCompatibleEncryptionExamples\nexport function create(opts) {\n    const algorithm = opts?.algorithm ?? 'AES-GCM';\n    let keyLength = opts?.keyLength ?? 16;\n    const nonceLength = opts?.nonceLength ?? 12;\n    const digest = opts?.digest ?? 'SHA-256';\n    const saltLength = opts?.saltLength ?? 16;\n    const iterations = opts?.iterations ?? 32767;\n    const crypto = webcrypto.get();\n    keyLength *= 8; // Browser crypto uses bits instead of bytes\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to encrypt the data.\n     */\n    async function encrypt(data, password) {\n        const salt = crypto.getRandomValues(new Uint8Array(saltLength));\n        const nonce = crypto.getRandomValues(new Uint8Array(nonceLength));\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['encrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            }\n        }\n        else {\n            // Derive a key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['encrypt']);\n        }\n        // Encrypt the string.\n        const ciphertext = await crypto.subtle.encrypt(aesGcm, cryptoKey, data);\n        return concat([salt, aesGcm.iv, new Uint8Array(ciphertext)]);\n    }\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to decrypt the data. The options used to create\n     * this decryption cipher must be the same as those used to create\n     * the encryption cipher.\n     */\n    async function decrypt(data, password) {\n        const salt = data.subarray(0, saltLength);\n        const nonce = data.subarray(saltLength, saltLength + nonceLength);\n        const ciphertext = data.subarray(saltLength + nonceLength);\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['decrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['decrypt']);\n            }\n        }\n        else {\n            // Derive the key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['decrypt']);\n        }\n        // Decrypt the string.\n        const plaintext = await crypto.subtle.decrypt(aesGcm, cryptoKey, ciphertext);\n        return new Uint8Array(plaintext);\n    }\n    const cipher = {\n        encrypt,\n        decrypt\n    };\n    return cipher;\n}\n//# sourceMappingURL=aes-gcm.browser.js.map","import { base64 } from 'multiformats/bases/base64';\nimport * as ciphers from '../ciphers/aes-gcm.js';\n/**\n * Exports the given PrivateKey as a base64 encoded string.\n * The PrivateKey is encrypted via a password derived PBKDF2 key\n * leveraging the aes-gcm cipher algorithm.\n */\nexport async function exporter(privateKey, password) {\n    const cipher = ciphers.create();\n    const encryptedKey = await cipher.encrypt(privateKey, password);\n    return base64.encode(encryptedKey);\n}\n//# sourceMappingURL=exporter.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { enumeration, encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var KeyType;\n(function (KeyType) {\n    KeyType[\"RSA\"] = \"RSA\";\n    KeyType[\"Ed25519\"] = \"Ed25519\";\n    KeyType[\"Secp256k1\"] = \"Secp256k1\";\n})(KeyType || (KeyType = {}));\nvar __KeyTypeValues;\n(function (__KeyTypeValues) {\n    __KeyTypeValues[__KeyTypeValues[\"RSA\"] = 0] = \"RSA\";\n    __KeyTypeValues[__KeyTypeValues[\"Ed25519\"] = 1] = \"Ed25519\";\n    __KeyTypeValues[__KeyTypeValues[\"Secp256k1\"] = 2] = \"Secp256k1\";\n})(__KeyTypeValues || (__KeyTypeValues = {}));\n(function (KeyType) {\n    KeyType.codec = () => {\n        return enumeration(__KeyTypeValues);\n    };\n})(KeyType || (KeyType = {}));\nexport var PublicKey;\n(function (PublicKey) {\n    let _codec;\n    PublicKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PublicKey.encode = (obj) => {\n        return encodeMessage(obj, PublicKey.codec());\n    };\n    PublicKey.decode = (buf) => {\n        return decodeMessage(buf, PublicKey.codec());\n    };\n})(PublicKey || (PublicKey = {}));\nexport var PrivateKey;\n(function (PrivateKey) {\n    let _codec;\n    PrivateKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PrivateKey.encode = (obj) => {\n        return encodeMessage(obj, PrivateKey.codec());\n    };\n    PrivateKey.decode = (buf) => {\n        return decodeMessage(buf, PrivateKey.codec());\n    };\n})(PrivateKey || (PrivateKey = {}));\n//# sourceMappingURL=keys.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport * as crypto from './ed25519.js';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nexport class Ed25519PublicKey {\n    _key;\n    constructor(key) {\n        this._key = ensureKey(key, crypto.publicKeyLength);\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Ed25519PrivateKey {\n    _key;\n    _publicKey;\n    // key       - 64 byte Uint8Array containing private key\n    // publicKey - 32 byte Uint8Array containing public key\n    constructor(key, publicKey) {\n        this._key = ensureKey(key, crypto.privateKeyLength);\n        this._publicKey = ensureKey(publicKey, crypto.publicKeyLength);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Ed25519PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the identity multihash containing its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     *\n     * @returns {Promise<string>}\n     */\n    async id() {\n        const encoding = identity.digest(this.public.bytes);\n        return base58btc.encode(encoding.bytes).substring(1);\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalEd25519PrivateKey(bytes) {\n    // Try the old, redundant public key version\n    if (bytes.length > crypto.privateKeyLength) {\n        bytes = ensureKey(bytes, crypto.privateKeyLength + crypto.publicKeyLength);\n        const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n        const publicKeyBytes = bytes.subarray(crypto.privateKeyLength, bytes.length);\n        return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n    }\n    bytes = ensureKey(bytes, crypto.privateKeyLength);\n    const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n    const publicKeyBytes = bytes.subarray(crypto.publicKeyLength);\n    return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n}\nexport function unmarshalEd25519PublicKey(bytes) {\n    bytes = ensureKey(bytes, crypto.publicKeyLength);\n    return new Ed25519PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const { privateKey, publicKey } = await crypto.generateKey();\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nexport async function generateKeyPairFromSeed(seed) {\n    const { privateKey, publicKey } = await crypto.generateKeyFromSeed(seed);\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nfunction ensureKey(key, length) {\n    key = Uint8Array.from(key ?? []);\n    if (key.length !== length) {\n        throw new CodeError(`Key must be a Uint8Array of length ${length}, got ${key.length}`, 'ERR_INVALID_KEY_TYPE');\n    }\n    return key;\n}\n//# sourceMappingURL=ed25519-class.js.map","import bases, {} from './util/bases.js';\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString(array, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return globalThis.Buffer.from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');\n    }\n    // strip multibase prefix\n    return base.encoder.encode(array).substring(1);\n}\n//# sourceMappingURL=to-string.js.map","import 'node-forge/lib/util.js';\nimport 'node-forge/lib/jsbn.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nexport function bigIntegerToUintBase64url(num, len) {\n    // Call `.abs()` to convert to unsigned\n    let buf = Uint8Array.from(num.abs().toByteArray()); // toByteArray converts to big endian\n    // toByteArray() gives us back a signed array, which will include a leading 0\n    // byte if the most significant bit of the number is 1:\n    // https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-integer\n    // Our number will always be positive so we should remove the leading padding.\n    buf = buf[0] === 0 ? buf.subarray(1) : buf;\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return uint8ArrayToString(buf, 'base64url');\n}\n// Convert a base64url encoded string to a BigInteger\nexport function base64urlToBigInteger(str) {\n    const buf = base64urlToBuffer(str);\n    return new forge.jsbn.BigInteger(uint8ArrayToString(buf, 'base16'), 16);\n}\nexport function base64urlToBuffer(str, len) {\n    let buf = uint8ArrayFromString(str, 'base64urlpad');\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return buf;\n}\n//# sourceMappingURL=util.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { base64urlToBuffer } from '../util.js';\nimport webcrypto from '../webcrypto.js';\nconst bits = {\n    'P-256': 256,\n    'P-384': 384,\n    'P-521': 521\n};\nconst curveTypes = Object.keys(bits);\nconst names = curveTypes.join(' / ');\nexport async function generateEphmeralKeyPair(curve) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'ECDH',\n        namedCurve: curve\n    }, true, ['deriveBits']);\n    // forcePrivate is used for testing only\n    const genSharedKey = async (theirPub, forcePrivate) => {\n        let privateKey;\n        if (forcePrivate != null) {\n            privateKey = await webcrypto.get().subtle.importKey('jwk', unmarshalPrivateKey(curve, forcePrivate), {\n                name: 'ECDH',\n                namedCurve: curve\n            }, false, ['deriveBits']);\n        }\n        else {\n            privateKey = pair.privateKey;\n        }\n        const key = await webcrypto.get().subtle.importKey('jwk', unmarshalPublicKey(curve, theirPub), {\n            name: 'ECDH',\n            namedCurve: curve\n        }, false, []);\n        const buffer = await webcrypto.get().subtle.deriveBits({\n            name: 'ECDH',\n            // @ts-expect-error namedCurve is missing from the types\n            namedCurve: curve,\n            public: key\n        }, privateKey, bits[curve]);\n        return new Uint8Array(buffer, 0, buffer.byteLength);\n    };\n    const publicKey = await webcrypto.get().subtle.exportKey('jwk', pair.publicKey);\n    const ecdhKey = {\n        key: marshalPublicKey(publicKey),\n        genSharedKey\n    };\n    return ecdhKey;\n}\nconst curveLengths = {\n    'P-256': 32,\n    'P-384': 48,\n    'P-521': 66\n};\n// Marshal converts a jwk encoded ECDH public key into the\n// form specified in section 4.3.6 of ANSI X9.62. (This is the format\n// go-ipfs uses)\nfunction marshalPublicKey(jwk) {\n    if (jwk.crv == null || jwk.x == null || jwk.y == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    if (jwk.crv !== 'P-256' && jwk.crv !== 'P-384' && jwk.crv !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${jwk.crv}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[jwk.crv];\n    return uint8ArrayConcat([\n        Uint8Array.from([4]),\n        base64urlToBuffer(jwk.x, byteLen),\n        base64urlToBuffer(jwk.y, byteLen)\n    ], 1 + byteLen * 2);\n}\n// Unmarshal converts a point, serialized by Marshal, into an jwk encoded key\nfunction unmarshalPublicKey(curve, key) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[curve];\n    if (!uint8ArrayEquals(key.subarray(0, 1), Uint8Array.from([4]))) {\n        throw new CodeError('Cannot unmarshal public key - invalid key format', 'ERR_INVALID_KEY_FORMAT');\n    }\n    return {\n        kty: 'EC',\n        crv: curve,\n        x: uint8ArrayToString(key.subarray(1, byteLen + 1), 'base64url'),\n        y: uint8ArrayToString(key.subarray(1 + byteLen), 'base64url'),\n        ext: true\n    };\n}\nconst unmarshalPrivateKey = (curve, key) => ({\n    ...unmarshalPublicKey(curve, key.public),\n    d: uint8ArrayToString(key.private, 'base64url')\n});\n//# sourceMappingURL=ecdh-browser.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { randomBytes as randB } from '@noble/hashes/utils';\nexport default function randomBytes(length) {\n    if (isNaN(length) || length <= 0) {\n        throw new CodeError('random bytes length must be a Number bigger than 0', 'ERR_INVALID_LENGTH');\n    }\n    return randB(length);\n}\n//# sourceMappingURL=random-bytes.js.map","import 'node-forge/lib/rsa.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { base64urlToBigInteger } from '../util.js';\nfunction convert(key, types) {\n    return types.map(t => base64urlToBigInteger(key[t]));\n}\nexport function jwk2priv(key) {\n    return forge.pki.setRsaPrivateKey(...convert(key, ['n', 'e', 'd', 'p', 'q', 'dp', 'dq', 'qi']));\n}\nexport function jwk2pub(key) {\n    return forge.pki.setRsaPublicKey(...convert(key, ['n', 'e']));\n}\n//# sourceMappingURL=jwk2pem.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport randomBytes from '../random-bytes.js';\nimport webcrypto from '../webcrypto.js';\nimport { jwk2pub, jwk2priv } from './jwk2pem.js';\nimport * as utils from './rsa-utils.js';\nexport { utils };\nexport async function generateKey(bits) {\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'RSASSA-PKCS1-v1_5',\n        modulusLength: bits,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        hash: { name: 'SHA-256' }\n    }, true, ['sign', 'verify']);\n    const keys = await exportKey(pair);\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\n// Takes a jwk key\nexport async function unmarshalPrivateKey(key) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['sign']);\n    const pair = [\n        privateKey,\n        await derivePublicFromPrivate(key)\n    ];\n    const keys = await exportKey({\n        privateKey: pair[0],\n        publicKey: pair[1]\n    });\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\nexport { randomBytes as getRandomValues };\nexport async function hashAndSign(key, msg) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['sign']);\n    const sig = await webcrypto.get().subtle.sign({ name: 'RSASSA-PKCS1-v1_5' }, privateKey, Uint8Array.from(msg));\n    return new Uint8Array(sig, 0, sig.byteLength);\n}\nexport async function hashAndVerify(key, sig, msg) {\n    const publicKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['verify']);\n    return webcrypto.get().subtle.verify({ name: 'RSASSA-PKCS1-v1_5' }, publicKey, sig, msg);\n}\nasync function exportKey(pair) {\n    if (pair.privateKey == null || pair.publicKey == null) {\n        throw new CodeError('Private and public key are required', 'ERR_INVALID_PARAMETERS');\n    }\n    return Promise.all([\n        webcrypto.get().subtle.exportKey('jwk', pair.privateKey),\n        webcrypto.get().subtle.exportKey('jwk', pair.publicKey)\n    ]);\n}\nasync function derivePublicFromPrivate(jwKey) {\n    return webcrypto.get().subtle.importKey('jwk', {\n        kty: jwKey.kty,\n        n: jwKey.n,\n        e: jwKey.e\n    }, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['verify']);\n}\n/*\n\nRSA encryption/decryption for the browser with webcrypto workaround\n\"bloody dark magic. webcrypto's why.\"\n\nExplanation:\n  - Convert JWK to nodeForge\n  - Convert msg Uint8Array to nodeForge buffer: ByteBuffer is a \"binary-string backed buffer\", so let's make our Uint8Array a binary string\n  - Convert resulting nodeForge buffer to Uint8Array: it returns a binary string, turn that into a Uint8Array\n\n*/\nfunction convertKey(key, pub, msg, handle) {\n    const fkey = pub ? jwk2pub(key) : jwk2priv(key);\n    const fmsg = uint8ArrayToString(Uint8Array.from(msg), 'ascii');\n    const fomsg = handle(fmsg, fkey);\n    return uint8ArrayFromString(fomsg, 'ascii');\n}\nexport function encrypt(key, msg) {\n    return convertKey(key, true, msg, (msg, key) => key.encrypt(msg));\n}\nexport function decrypt(key, msg) {\n    return convertKey(key, false, msg, (msg, key) => key.decrypt(msg));\n}\nexport function keySize(jwk) {\n    if (jwk.kty !== 'RSA') {\n        throw new CodeError('invalid key type', 'ERR_INVALID_KEY_TYPE');\n    }\n    else if (jwk.n == null) {\n        throw new CodeError('invalid key modulus', 'ERR_INVALID_KEY_MODULUS');\n    }\n    const bytes = uint8ArrayFromString(jwk.n, 'base64url');\n    return bytes.length * 8;\n}\n//# sourceMappingURL=rsa-browser.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport 'node-forge/lib/sha512.js';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nimport * as crypto from './rsa.js';\nexport const MAX_KEY_SIZE = 8192;\nexport class RsaPublicKey {\n    _key;\n    constructor(key) {\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkix(this._key);\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    encrypt(bytes) {\n        return crypto.encrypt(this._key, bytes);\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class RsaPrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey;\n    }\n    genSecret() {\n        return crypto.getRandomValues(16);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        if (this._publicKey == null) {\n            throw new CodeError('public key not provided', 'ERR_PUBKEY_NOT_PROVIDED');\n        }\n        return new RsaPublicKey(this._publicKey);\n    }\n    decrypt(bytes) {\n        return crypto.decrypt(this._key, bytes);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkcs1(this._key);\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected PEM format\n     */\n    async export(password, format = 'pkcs-8') {\n        if (format === 'pkcs-8') {\n            const buffer = new forge.util.ByteBuffer(this.marshal());\n            const asn1 = forge.asn1.fromDer(buffer);\n            const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n            const options = {\n                algorithm: 'aes256',\n                count: 10000,\n                saltSize: 128 / 8,\n                prfAlgorithm: 'sha512'\n            };\n            return forge.pki.encryptRsaPrivateKey(privateKey, password, options);\n        }\n        else if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport async function unmarshalRsaPrivateKey(bytes) {\n    const jwk = crypto.utils.pkcs1ToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport function unmarshalRsaPublicKey(bytes) {\n    const jwk = crypto.utils.pkixToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    return new RsaPublicKey(jwk);\n}\nexport async function fromJwk(jwk) {\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport async function generateKeyPair(bits) {\n    if (bits > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.generateKey(bits);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\n//# sourceMappingURL=rsa-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/rsa.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { bigIntegerToUintBase64url, base64urlToBigInteger } from './../util.js';\n// Convert a PKCS#1 in ASN1 DER format to a JWK key\nexport function pkcs1ToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n    // https://tools.ietf.org/html/rfc7518#section-6.3.1\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(privateKey.n),\n        e: bigIntegerToUintBase64url(privateKey.e),\n        d: bigIntegerToUintBase64url(privateKey.d),\n        p: bigIntegerToUintBase64url(privateKey.p),\n        q: bigIntegerToUintBase64url(privateKey.q),\n        dp: bigIntegerToUintBase64url(privateKey.dP),\n        dq: bigIntegerToUintBase64url(privateKey.dQ),\n        qi: bigIntegerToUintBase64url(privateKey.qInv),\n        alg: 'RS256'\n    };\n}\n// Convert a JWK key into PKCS#1 in ASN1 DER format\nexport function jwkToPkcs1(jwk) {\n    if (jwk.n == null || jwk.e == null || jwk.d == null || jwk.p == null || jwk.q == null || jwk.dp == null || jwk.dq == null || jwk.qi == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.privateKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e),\n        d: base64urlToBigInteger(jwk.d),\n        p: base64urlToBigInteger(jwk.p),\n        q: base64urlToBigInteger(jwk.q),\n        dP: base64urlToBigInteger(jwk.dp),\n        dQ: base64urlToBigInteger(jwk.dq),\n        qInv: base64urlToBigInteger(jwk.qi)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n// Convert a PKCIX in ASN1 DER format to a JWK key\nexport function pkixToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const publicKey = forge.pki.publicKeyFromAsn1(asn1);\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(publicKey.n),\n        e: bigIntegerToUintBase64url(publicKey.e)\n    };\n}\n// Convert a JWK key to PKCIX in ASN1 DER format\nexport function jwkToPkix(jwk) {\n    if (jwk.n == null || jwk.e == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.publicKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n//# sourceMappingURL=rsa-utils.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { secp256k1 as secp } from '@noble/curves/secp256k1';\nimport { sha256 } from 'multiformats/hashes/sha2';\nconst PRIVATE_KEY_BYTE_LENGTH = 32;\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport function generateKey() {\n    return secp.utils.randomPrivateKey();\n}\n/**\n * Hash and sign message with private key\n */\nexport async function hashAndSign(key, msg) {\n    const { digest } = await sha256.digest(msg);\n    try {\n        const signature = secp.sign(digest, key);\n        return signature.toDERRawBytes();\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\n/**\n * Hash message and verify signature with public key\n */\nexport async function hashAndVerify(key, sig, msg) {\n    try {\n        const { digest } = await sha256.digest(msg);\n        return secp.verify(sig, digest, key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\nexport function compressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(true);\n    return point;\n}\nexport function decompressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(false);\n    return point;\n}\nexport function validatePrivateKey(key) {\n    try {\n        secp.getPublicKey(key, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\nexport function validatePublicKey(key) {\n    try {\n        secp.ProjectivePoint.fromHex(key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PUBLIC_KEY');\n    }\n}\nexport function computePublicKey(privateKey) {\n    try {\n        return secp.getPublicKey(privateKey, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\n//# sourceMappingURL=secp256k1.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as keysProtobuf from './keys.js';\nimport * as crypto from './secp256k1.js';\nexport class Secp256k1PublicKey {\n    _key;\n    constructor(key) {\n        crypto.validatePublicKey(key);\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.compressPublicKey(this._key);\n    }\n    get bytes() {\n        return keysProtobuf.PublicKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Secp256k1PrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey ?? crypto.computePublicKey(key);\n        crypto.validatePrivateKey(this._key);\n        crypto.validatePublicKey(this._publicKey);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Secp256k1PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return keysProtobuf.PrivateKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalSecp256k1PrivateKey(bytes) {\n    return new Secp256k1PrivateKey(bytes);\n}\nexport function unmarshalSecp256k1PublicKey(bytes) {\n    return new Secp256k1PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const privateKeyBytes = crypto.generateKey();\n    return new Secp256k1PrivateKey(privateKeyBytes);\n}\n//# sourceMappingURL=secp256k1-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/pbe.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport * as Ed25519 from './ed25519-class.js';\nimport generateEphemeralKeyPair from './ephemeral-keys.js';\nimport { importer } from './importer.js';\nimport { keyStretcher } from './key-stretcher.js';\nimport * as keysPBM from './keys.js';\nimport * as RSA from './rsa-class.js';\nimport * as Secp256k1 from './secp256k1-class.js';\nexport { keyStretcher };\nexport { generateEphemeralKeyPair };\nexport { keysPBM };\nexport const supportedKeys = {\n    rsa: RSA,\n    ed25519: Ed25519,\n    secp256k1: Secp256k1\n};\nfunction unsupportedKey(type) {\n    const supported = Object.keys(supportedKeys).join(' / ');\n    return new CodeError(`invalid or unsupported key type ${type}. Must be ${supported}`, 'ERR_UNSUPPORTED_KEY_TYPE');\n}\nfunction typeToKey(type) {\n    type = type.toLowerCase();\n    if (type === 'rsa' || type === 'ed25519' || type === 'secp256k1') {\n        return supportedKeys[type];\n    }\n    throw unsupportedKey(type);\n}\n// Generates a keypair of the given type and bitsize\nexport async function generateKeyPair(type, bits) {\n    return typeToKey(type).generateKeyPair(bits ?? 2048);\n}\n// Generates a keypair of the given type and bitsize\n// seed is a 32 byte uint8array\nexport async function generateKeyPairFromSeed(type, seed, bits) {\n    if (type.toLowerCase() !== 'ed25519') {\n        throw new CodeError('Seed key derivation is unimplemented for RSA or secp256k1', 'ERR_UNSUPPORTED_KEY_DERIVATION_TYPE');\n    }\n    return Ed25519.generateKeyPairFromSeed(seed);\n}\n// Converts a protobuf serialized public key into its\n// representative object\nexport function unmarshalPublicKey(buf) {\n    const decoded = keysPBM.PublicKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPublicKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PublicKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'unknown');\n    }\n}\n// Converts a public key object into a protobuf serialized public key\nexport function marshalPublicKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n// Converts a protobuf serialized private key into its\n// representative object\nexport async function unmarshalPrivateKey(buf) {\n    const decoded = keysPBM.PrivateKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPrivateKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PrivateKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'RSA');\n    }\n}\n// Converts a private key object into a protobuf serialized private key\nexport function marshalPrivateKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n/**\n *\n * @param {string} encryptedKey\n * @param {string} password\n */\nexport async function importKey(encryptedKey, password) {\n    try {\n        const key = await importer(encryptedKey, password);\n        return await unmarshalPrivateKey(key);\n    }\n    catch (_) {\n        // Ignore and try the old pem decrypt\n    }\n    // Only rsa supports pem right now\n    const key = forge.pki.decryptRsaPrivateKey(encryptedKey, password);\n    if (key === null) {\n        throw new CodeError('Cannot read the key, most likely the password is wrong or not a RSA key', 'ERR_CANNOT_DECRYPT_PEM');\n    }\n    let der = forge.asn1.toDer(forge.pki.privateKeyToAsn1(key));\n    der = uint8ArrayFromString(der.getBytes(), 'ascii');\n    return supportedKeys.rsa.unmarshalRsaPrivateKey(der);\n}\n//# sourceMappingURL=index.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { symbol } from '@libp2p/interface/peer-id';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { bases } from 'multiformats/basics';\nimport { CID } from 'multiformats/cid';\nimport * as Digest from 'multiformats/hashes/digest';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nconst inspect = Symbol.for('nodejs.util.inspect.custom');\nconst baseDecoder = Object\n    .values(bases)\n    .map(codec => codec.decoder)\n    // @ts-expect-error https://github.com/multiformats/js-multiformats/issues/141\n    .reduce((acc, curr) => acc.or(curr), bases.identity.decoder);\n// these values are from https://github.com/multiformats/multicodec/blob/master/table.csv\nconst LIBP2P_KEY_CODE = 0x72;\nconst MARSHALLED_ED225519_PUBLIC_KEY_LENGTH = 36;\nconst MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH = 37;\nclass PeerIdImpl {\n    type;\n    multihash;\n    privateKey;\n    publicKey;\n    string;\n    constructor(init) {\n        this.type = init.type;\n        this.multihash = init.multihash;\n        this.privateKey = init.privateKey;\n        // mark string cache as non-enumerable\n        Object.defineProperty(this, 'string', {\n            enumerable: false,\n            writable: true\n        });\n    }\n    get [Symbol.toStringTag]() {\n        return `PeerId(${this.toString()})`;\n    }\n    [symbol] = true;\n    toString() {\n        if (this.string == null) {\n            this.string = base58btc.encode(this.multihash.bytes).slice(1);\n        }\n        return this.string;\n    }\n    // return self-describing String representation\n    // in default format from RFC 0001: https://github.com/libp2p/specs/pull/209\n    toCID() {\n        return CID.createV1(LIBP2P_KEY_CODE, this.multihash);\n    }\n    toBytes() {\n        return this.multihash.bytes;\n    }\n    /**\n     * Returns Multiaddr as a JSON string\n     */\n    toJSON() {\n        return this.toString();\n    }\n    /**\n     * Checks the equality of `this` peer against a given PeerId\n     */\n    equals(id) {\n        if (id instanceof Uint8Array) {\n            return uint8ArrayEquals(this.multihash.bytes, id);\n        }\n        else if (typeof id === 'string') {\n            return peerIdFromString(id).equals(this);\n        }\n        else if (id?.multihash?.bytes != null) {\n            return uint8ArrayEquals(this.multihash.bytes, id.multihash.bytes);\n        }\n        else {\n            throw new Error('not valid Id');\n        }\n    }\n    /**\n     * Returns PeerId as a human-readable string\n     * https://nodejs.org/api/util.html#utilinspectcustom\n     *\n     * @example\n     * ```js\n     * import { peerIdFromString } from '@libp2p/peer-id'\n     *\n     * console.info(peerIdFromString('QmFoo'))\n     * // 'PeerId(QmFoo)'\n     * ```\n     */\n    [inspect]() {\n        return `PeerId(${this.toString()})`;\n    }\n}\nclass RSAPeerIdImpl extends PeerIdImpl {\n    type = 'RSA';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'RSA' });\n        this.publicKey = init.publicKey;\n    }\n}\nclass Ed25519PeerIdImpl extends PeerIdImpl {\n    type = 'Ed25519';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'Ed25519' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nclass Secp256k1PeerIdImpl extends PeerIdImpl {\n    type = 'secp256k1';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'secp256k1' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nexport function createPeerId(init) {\n    if (init.type === 'RSA') {\n        return new RSAPeerIdImpl(init);\n    }\n    if (init.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(init);\n    }\n    if (init.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(init);\n    }\n    throw new CodeError('Type must be \"RSA\", \"Ed25519\" or \"secp256k1\"', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromPeerId(other) {\n    if (other.type === 'RSA') {\n        return new RSAPeerIdImpl(other);\n    }\n    if (other.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(other);\n    }\n    if (other.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(other);\n    }\n    throw new CodeError('Not a PeerId', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromString(str, decoder) {\n    decoder = decoder ?? baseDecoder;\n    if (str.charAt(0) === '1' || str.charAt(0) === 'Q') {\n        // identity hash ed25519/secp256k1 key or sha2-256 hash of\n        // rsa public key - base58btc encoded either way\n        const multihash = Digest.decode(base58btc.decode(`z${str}`));\n        if (str.startsWith('12D')) {\n            return new Ed25519PeerIdImpl({ multihash });\n        }\n        else if (str.startsWith('16U')) {\n            return new Secp256k1PeerIdImpl({ multihash });\n        }\n        else {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    return peerIdFromBytes(baseDecoder.decode(str));\n}\nexport function peerIdFromBytes(buf) {\n    try {\n        const multihash = Digest.decode(buf);\n        if (multihash.code === identity.code) {\n            if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n                return new Ed25519PeerIdImpl({ multihash });\n            }\n            else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n                return new Secp256k1PeerIdImpl({ multihash });\n            }\n        }\n        if (multihash.code === sha256.code) {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    catch {\n        return peerIdFromCID(CID.decode(buf));\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\nexport function peerIdFromCID(cid) {\n    if (cid == null || cid.multihash == null || cid.version == null || (cid.version === 1 && cid.code !== LIBP2P_KEY_CODE)) {\n        throw new Error('Supplied PeerID CID is invalid');\n    }\n    const multihash = cid.multihash;\n    if (multihash.code === sha256.code) {\n        return new RSAPeerIdImpl({ multihash: cid.multihash });\n    }\n    else if (multihash.code === identity.code) {\n        if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n            return new Ed25519PeerIdImpl({ multihash: cid.multihash });\n        }\n        else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n            return new Secp256k1PeerIdImpl({ multihash: cid.multihash });\n        }\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\n/**\n * @param publicKey - A marshalled public key\n * @param privateKey - A marshalled private key\n */\nexport async function peerIdFromKeys(publicKey, privateKey) {\n    if (publicKey.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n        return new Ed25519PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    if (publicKey.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n        return new Secp256k1PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    return new RSAPeerIdImpl({ multihash: await sha256.digest(publicKey), publicKey, privateKey });\n}\n//# sourceMappingURL=index.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var NoiseExtensions;\n(function (NoiseExtensions) {\n    let _codec;\n    NoiseExtensions.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.webtransportCerthashes != null) {\n                    for (const value of obj.webtransportCerthashes) {\n                        w.uint32(10);\n                        w.bytes(value);\n                    }\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {\n                    webtransportCerthashes: []\n                };\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.webtransportCerthashes.push(reader.bytes());\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    NoiseExtensions.encode = (obj) => {\n        return encodeMessage(obj, NoiseExtensions.codec());\n    };\n    NoiseExtensions.decode = (buf) => {\n        return decodeMessage(buf, NoiseExtensions.codec());\n    };\n})(NoiseExtensions || (NoiseExtensions = {}));\nexport var NoiseHandshakePayload;\n(function (NoiseHandshakePayload) {\n    let _codec;\n    NoiseHandshakePayload.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (opts.writeDefaults === true || (obj.identityKey != null && obj.identityKey.byteLength > 0)) {\n                    w.uint32(10);\n                    w.bytes(obj.identityKey ?? new Uint8Array(0));\n                }\n                if (opts.writeDefaults === true || (obj.identitySig != null && obj.identitySig.byteLength > 0)) {\n                    w.uint32(18);\n                    w.bytes(obj.identitySig ?? new Uint8Array(0));\n                }\n                if (obj.extensions != null) {\n                    w.uint32(34);\n                    NoiseExtensions.codec().encode(obj.extensions, w, {\n                        writeDefaults: false\n                    });\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {\n                    identityKey: new Uint8Array(0),\n                    identitySig: new Uint8Array(0)\n                };\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.identityKey = reader.bytes();\n                            break;\n                        case 2:\n                            obj.identitySig = reader.bytes();\n                            break;\n                        case 4:\n                            obj.extensions = NoiseExtensions.codec().decode(reader, reader.uint32());\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    NoiseHandshakePayload.encode = (obj) => {\n        return encodeMessage(obj, NoiseHandshakePayload.codec());\n    };\n    NoiseHandshakePayload.decode = (buf) => {\n        return decodeMessage(buf, NoiseHandshakePayload.codec());\n    };\n})(NoiseHandshakePayload || (NoiseHandshakePayload = {}));\n//# sourceMappingURL=payload.js.map","import { unmarshalPublicKey, unmarshalPrivateKey } from '@libp2p/crypto/keys';\nimport { peerIdFromKeys } from '@libp2p/peer-id';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { NoiseHandshakePayload } from './proto/payload.js';\nexport async function getPayload(localPeer, staticPublicKey, extensions) {\n    const signedPayload = await signPayload(localPeer, getHandshakePayload(staticPublicKey));\n    if (localPeer.publicKey == null) {\n        throw new Error('PublicKey was missing from local PeerId');\n    }\n    return createHandshakePayload(localPeer.publicKey, signedPayload, extensions);\n}\nexport function createHandshakePayload(libp2pPublicKey, signedPayload, extensions) {\n    return NoiseHandshakePayload.encode({\n        identityKey: libp2pPublicKey,\n        identitySig: signedPayload,\n        extensions: extensions ?? { webtransportCerthashes: [] }\n    }).subarray();\n}\nexport async function signPayload(peerId, payload) {\n    if (peerId.privateKey == null) {\n        throw new Error('PrivateKey was missing from PeerId');\n    }\n    const privateKey = await unmarshalPrivateKey(peerId.privateKey);\n    return privateKey.sign(payload);\n}\nexport async function getPeerIdFromPayload(payload) {\n    return peerIdFromKeys(payload.identityKey);\n}\nexport function decodePayload(payload) {\n    return NoiseHandshakePayload.decode(payload);\n}\nexport function getHandshakePayload(publicKey) {\n    const prefix = uint8ArrayFromString('noise-libp2p-static-key:');\n    return uint8ArrayConcat([prefix, publicKey], prefix.length + publicKey.length);\n}\n/**\n * Verifies signed payload, throws on any irregularities.\n *\n * @param {bytes} noiseStaticKey - owner's noise static key\n * @param {bytes} payload - decoded payload\n * @param {PeerId} remotePeer - owner's libp2p peer ID\n * @returns {Promise<PeerId>} - peer ID of payload owner\n */\nexport async function verifySignedPayload(noiseStaticKey, payload, remotePeer) {\n    // Unmarshaling from PublicKey protobuf\n    const payloadPeerId = await peerIdFromKeys(payload.identityKey);\n    if (!payloadPeerId.equals(remotePeer)) {\n        throw new Error(`Payload identity key ${payloadPeerId.toString()} does not match expected remote peer ${remotePeer.toString()}`);\n    }\n    const generatedPayload = getHandshakePayload(noiseStaticKey);\n    if (payloadPeerId.publicKey == null) {\n        throw new Error('PublicKey was missing from PeerId');\n    }\n    if (payload.identitySig == null) {\n        throw new Error('Signature was missing from message');\n    }\n    const publicKey = unmarshalPublicKey(payloadPeerId.publicKey);\n    const valid = await publicKey.verify(generatedPayload, payload.identitySig);\n    if (!valid) {\n        throw new Error(\"Static key doesn't match to peer that signed payload!\");\n    }\n    return payloadPeerId;\n}\nexport function isValidPublicKey(pk) {\n    if (!(pk instanceof Uint8Array)) {\n        return false;\n    }\n    if (pk.length !== 32) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=utils.js.map","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","import { logger } from '@libp2p/logger';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { DUMP_SESSION_KEYS } from './constants.js';\nconst log = logger('libp2p:noise');\nexport { log as logger };\nlet keyLogger;\nif (DUMP_SESSION_KEYS) {\n    keyLogger = log;\n}\nelse {\n    keyLogger = Object.assign(() => { }, {\n        enabled: false,\n        trace: () => { },\n        error: () => { }\n    });\n}\nexport function logLocalStaticKeys(s) {\n    keyLogger(`LOCAL_STATIC_PUBLIC_KEY ${uint8ArrayToString(s.publicKey, 'hex')}`);\n    keyLogger(`LOCAL_STATIC_PRIVATE_KEY ${uint8ArrayToString(s.privateKey, 'hex')}`);\n}\nexport function logLocalEphemeralKeys(e) {\n    if (e) {\n        keyLogger(`LOCAL_PUBLIC_EPHEMERAL_KEY ${uint8ArrayToString(e.publicKey, 'hex')}`);\n        keyLogger(`LOCAL_PRIVATE_EPHEMERAL_KEY ${uint8ArrayToString(e.privateKey, 'hex')}`);\n    }\n    else {\n        keyLogger('Missing local ephemeral keys.');\n    }\n}\nexport function logRemoteStaticKey(rs) {\n    keyLogger(`REMOTE_STATIC_PUBLIC_KEY ${uint8ArrayToString(rs, 'hex')}`);\n}\nexport function logRemoteEphemeralKey(re) {\n    keyLogger(`REMOTE_EPHEMERAL_PUBLIC_KEY ${uint8ArrayToString(re, 'hex')}`);\n}\nexport function logCipherState(session) {\n    if (session.cs1 && session.cs2) {\n        keyLogger(`CIPHER_STATE_1 ${session.cs1.n.getUint64()} ${uint8ArrayToString(session.cs1.k, 'hex')}`);\n        keyLogger(`CIPHER_STATE_2 ${session.cs2.n.getUint64()} ${uint8ArrayToString(session.cs2.k, 'hex')}`);\n    }\n    else {\n        keyLogger('Missing cipher state.');\n    }\n}\n//# sourceMappingURL=logger.js.map","export const MIN_NONCE = 0;\n// For performance reasons, the nonce is represented as a JS `number`\n// Although JS `number` can safely represent integers up to 2 ** 53 - 1, we choose to only use\n// 4 bytes to store the data for performance reason.\n// This is a slight deviation from the noise spec, which describes the max nonce as 2 ** 64 - 2\n// The effect is that this implementation will need a new handshake to be performed after fewer messages are exchanged than other implementations with full uint64 nonces.\n// this MAX_NONCE is still a large number of messages, so the practical effect of this is negligible.\nexport const MAX_NONCE = 0xffffffff;\nconst ERR_MAX_NONCE = 'Cipherstate has reached maximum n, a new handshake must be performed';\n/**\n * The nonce is an uint that's increased over time.\n * Maintaining different representations help improve performance.\n */\nexport class Nonce {\n    n;\n    bytes;\n    view;\n    constructor(n = MIN_NONCE) {\n        this.n = n;\n        this.bytes = new Uint8Array(12);\n        this.view = new DataView(this.bytes.buffer, this.bytes.byteOffset, this.bytes.byteLength);\n        this.view.setUint32(4, n, true);\n    }\n    increment() {\n        this.n++;\n        // Even though we're treating the nonce as 8 bytes, RFC7539 specifies 12 bytes for a nonce.\n        this.view.setUint32(4, this.n, true);\n    }\n    getBytes() {\n        return this.bytes;\n    }\n    getUint64() {\n        return this.n;\n    }\n    assertValue() {\n        if (this.n > MAX_NONCE) {\n            throw new Error(ERR_MAX_NONCE);\n        }\n    }\n}\n//# sourceMappingURL=nonce.js.map","import { fromString as uint8ArrayFromString } from 'uint8arrays';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { logger } from '../logger.js';\nimport { Nonce } from '../nonce.js';\nexport class AbstractHandshake {\n    crypto;\n    constructor(crypto) {\n        this.crypto = crypto;\n    }\n    encryptWithAd(cs, ad, plaintext) {\n        const e = this.encrypt(cs.k, cs.n, ad, plaintext);\n        cs.n.increment();\n        return e;\n    }\n    decryptWithAd(cs, ad, ciphertext, dst) {\n        const { plaintext, valid } = this.decrypt(cs.k, cs.n, ad, ciphertext, dst);\n        if (valid)\n            cs.n.increment();\n        return { plaintext, valid };\n    }\n    // Cipher state related\n    hasKey(cs) {\n        return !this.isEmptyKey(cs.k);\n    }\n    createEmptyKey() {\n        return new Uint8Array(32);\n    }\n    isEmptyKey(k) {\n        const emptyKey = this.createEmptyKey();\n        return uint8ArrayEquals(emptyKey, k);\n    }\n    encrypt(k, n, ad, plaintext) {\n        n.assertValue();\n        return this.crypto.chaCha20Poly1305Encrypt(plaintext, n.getBytes(), ad, k);\n    }\n    encryptAndHash(ss, plaintext) {\n        let ciphertext;\n        if (this.hasKey(ss.cs)) {\n            ciphertext = this.encryptWithAd(ss.cs, ss.h, plaintext);\n        }\n        else {\n            ciphertext = plaintext;\n        }\n        this.mixHash(ss, ciphertext);\n        return ciphertext;\n    }\n    decrypt(k, n, ad, ciphertext, dst) {\n        n.assertValue();\n        const encryptedMessage = this.crypto.chaCha20Poly1305Decrypt(ciphertext, n.getBytes(), ad, k, dst);\n        if (encryptedMessage) {\n            return {\n                plaintext: encryptedMessage,\n                valid: true\n            };\n        }\n        else {\n            return {\n                plaintext: new Uint8Array(0),\n                valid: false\n            };\n        }\n    }\n    decryptAndHash(ss, ciphertext) {\n        let plaintext;\n        let valid = true;\n        if (this.hasKey(ss.cs)) {\n            ({ plaintext, valid } = this.decryptWithAd(ss.cs, ss.h, ciphertext));\n        }\n        else {\n            plaintext = ciphertext;\n        }\n        this.mixHash(ss, ciphertext);\n        return { plaintext, valid };\n    }\n    dh(privateKey, publicKey) {\n        try {\n            const derivedU8 = this.crypto.generateX25519SharedKey(privateKey, publicKey);\n            if (derivedU8.length === 32) {\n                return derivedU8;\n            }\n            return derivedU8.subarray(0, 32);\n        }\n        catch (e) {\n            const err = e;\n            logger.error(err);\n            return new Uint8Array(32);\n        }\n    }\n    mixHash(ss, data) {\n        ss.h = this.getHash(ss.h, data);\n    }\n    getHash(a, b) {\n        const u = this.crypto.hashSHA256(uint8ArrayConcat([a, b], a.length + b.length));\n        return u;\n    }\n    mixKey(ss, ikm) {\n        const [ck, tempK] = this.crypto.getHKDF(ss.ck, ikm);\n        ss.cs = this.initializeKey(tempK);\n        ss.ck = ck;\n    }\n    initializeKey(k) {\n        return { k, n: new Nonce() };\n    }\n    // Symmetric state related\n    initializeSymmetric(protocolName) {\n        const protocolNameBytes = uint8ArrayFromString(protocolName, 'utf-8');\n        const h = this.hashProtocolName(protocolNameBytes);\n        const ck = h;\n        const key = this.createEmptyKey();\n        const cs = this.initializeKey(key);\n        return { cs, ck, h };\n    }\n    hashProtocolName(protocolName) {\n        if (protocolName.length <= 32) {\n            const h = new Uint8Array(32);\n            h.set(protocolName);\n            return h;\n        }\n        else {\n            return this.getHash(protocolName, new Uint8Array(0));\n        }\n    }\n    split(ss) {\n        const [tempk1, tempk2] = this.crypto.getHKDF(ss.ck, new Uint8Array(0));\n        const cs1 = this.initializeKey(tempk1);\n        const cs2 = this.initializeKey(tempk2);\n        return { cs1, cs2 };\n    }\n    writeMessageRegular(cs, payload) {\n        const ciphertext = this.encryptWithAd(cs, new Uint8Array(0), payload);\n        const ne = this.createEmptyKey();\n        const ns = new Uint8Array(0);\n        return { ne, ns, ciphertext };\n    }\n    readMessageRegular(cs, message) {\n        return this.decryptWithAd(cs, new Uint8Array(0), message.ciphertext);\n    }\n}\n//# sourceMappingURL=abstract-handshake.js.map","import { isValidPublicKey } from '../utils.js';\nimport { AbstractHandshake } from './abstract-handshake.js';\nexport class XX extends AbstractHandshake {\n    initializeInitiator(prologue, s, rs, psk) {\n        const name = 'Noise_XX_25519_ChaChaPoly_SHA256';\n        const ss = this.initializeSymmetric(name);\n        this.mixHash(ss, prologue);\n        const re = new Uint8Array(32);\n        return { ss, s, rs, psk, re };\n    }\n    initializeResponder(prologue, s, rs, psk) {\n        const name = 'Noise_XX_25519_ChaChaPoly_SHA256';\n        const ss = this.initializeSymmetric(name);\n        this.mixHash(ss, prologue);\n        const re = new Uint8Array(32);\n        return { ss, s, rs, psk, re };\n    }\n    writeMessageA(hs, payload, e) {\n        const ns = new Uint8Array(0);\n        if (e !== undefined) {\n            hs.e = e;\n        }\n        else {\n            hs.e = this.crypto.generateX25519KeyPair();\n        }\n        const ne = hs.e.publicKey;\n        this.mixHash(hs.ss, ne);\n        const ciphertext = this.encryptAndHash(hs.ss, payload);\n        return { ne, ns, ciphertext };\n    }\n    writeMessageB(hs, payload) {\n        hs.e = this.crypto.generateX25519KeyPair();\n        const ne = hs.e.publicKey;\n        this.mixHash(hs.ss, ne);\n        this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.re));\n        const spk = hs.s.publicKey;\n        const ns = this.encryptAndHash(hs.ss, spk);\n        this.mixKey(hs.ss, this.dh(hs.s.privateKey, hs.re));\n        const ciphertext = this.encryptAndHash(hs.ss, payload);\n        return { ne, ns, ciphertext };\n    }\n    writeMessageC(hs, payload) {\n        const spk = hs.s.publicKey;\n        const ns = this.encryptAndHash(hs.ss, spk);\n        this.mixKey(hs.ss, this.dh(hs.s.privateKey, hs.re));\n        const ciphertext = this.encryptAndHash(hs.ss, payload);\n        const ne = this.createEmptyKey();\n        const messageBuffer = { ne, ns, ciphertext };\n        const { cs1, cs2 } = this.split(hs.ss);\n        return { h: hs.ss.h, messageBuffer, cs1, cs2 };\n    }\n    readMessageA(hs, message) {\n        if (isValidPublicKey(message.ne)) {\n            hs.re = message.ne;\n        }\n        this.mixHash(hs.ss, hs.re);\n        return this.decryptAndHash(hs.ss, message.ciphertext);\n    }\n    readMessageB(hs, message) {\n        if (isValidPublicKey(message.ne)) {\n            hs.re = message.ne;\n        }\n        this.mixHash(hs.ss, hs.re);\n        if (!hs.e) {\n            throw new Error('Handshake state `e` param is missing.');\n        }\n        this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.re));\n        const { plaintext: ns, valid: valid1 } = this.decryptAndHash(hs.ss, message.ns);\n        if (valid1 && isValidPublicKey(ns)) {\n            hs.rs = ns;\n        }\n        this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.rs));\n        const { plaintext, valid: valid2 } = this.decryptAndHash(hs.ss, message.ciphertext);\n        return { plaintext, valid: (valid1 && valid2) };\n    }\n    readMessageC(hs, message) {\n        const { plaintext: ns, valid: valid1 } = this.decryptAndHash(hs.ss, message.ns);\n        if (valid1 && isValidPublicKey(ns)) {\n            hs.rs = ns;\n        }\n        if (!hs.e) {\n            throw new Error('Handshake state `e` param is missing.');\n        }\n        this.mixKey(hs.ss, this.dh(hs.e.privateKey, hs.rs));\n        const { plaintext, valid: valid2 } = this.decryptAndHash(hs.ss, message.ciphertext);\n        const { cs1, cs2 } = this.split(hs.ss);\n        return { h: hs.ss.h, plaintext, valid: (valid1 && valid2), cs1, cs2 };\n    }\n    initSession(initiator, prologue, s) {\n        const psk = this.createEmptyKey();\n        const rs = new Uint8Array(32); // no static key yet\n        let hs;\n        if (initiator) {\n            hs = this.initializeInitiator(prologue, s, rs, psk);\n        }\n        else {\n            hs = this.initializeResponder(prologue, s, rs, psk);\n        }\n        return {\n            hs,\n            i: initiator,\n            mc: 0\n        };\n    }\n    sendMessage(session, message, ephemeral) {\n        let messageBuffer;\n        if (session.mc === 0) {\n            messageBuffer = this.writeMessageA(session.hs, message, ephemeral);\n        }\n        else if (session.mc === 1) {\n            messageBuffer = this.writeMessageB(session.hs, message);\n        }\n        else if (session.mc === 2) {\n            const { h, messageBuffer: resultingBuffer, cs1, cs2 } = this.writeMessageC(session.hs, message);\n            messageBuffer = resultingBuffer;\n            session.h = h;\n            session.cs1 = cs1;\n            session.cs2 = cs2;\n        }\n        else if (session.mc > 2) {\n            if (session.i) {\n                if (!session.cs1) {\n                    throw new Error('CS1 (cipher state) is not defined');\n                }\n                messageBuffer = this.writeMessageRegular(session.cs1, message);\n            }\n            else {\n                if (!session.cs2) {\n                    throw new Error('CS2 (cipher state) is not defined');\n                }\n                messageBuffer = this.writeMessageRegular(session.cs2, message);\n            }\n        }\n        else {\n            throw new Error('Session invalid.');\n        }\n        session.mc++;\n        return messageBuffer;\n    }\n    recvMessage(session, message) {\n        let plaintext = new Uint8Array(0);\n        let valid = false;\n        if (session.mc === 0) {\n            ({ plaintext, valid } = this.readMessageA(session.hs, message));\n        }\n        else if (session.mc === 1) {\n            ({ plaintext, valid } = this.readMessageB(session.hs, message));\n        }\n        else if (session.mc === 2) {\n            const { h, plaintext: resultingPlaintext, valid: resultingValid, cs1, cs2 } = this.readMessageC(session.hs, message);\n            plaintext = resultingPlaintext;\n            valid = resultingValid;\n            session.h = h;\n            session.cs1 = cs1;\n            session.cs2 = cs2;\n        }\n        session.mc++;\n        return { plaintext, valid };\n    }\n}\n//# sourceMappingURL=xx.js.map","import { InvalidCryptoExchangeError, UnexpectedPeerError } from '@libp2p/interface/errors';\nimport { decode0, decode1, decode2, encode0, encode1, encode2 } from './encoder.js';\nimport { XX } from './handshakes/xx.js';\nimport { logger, logLocalStaticKeys, logLocalEphemeralKeys, logRemoteEphemeralKey, logRemoteStaticKey, logCipherState } from './logger.js';\nimport { decodePayload, getPeerIdFromPayload, verifySignedPayload } from './utils.js';\nexport class XXHandshake {\n    isInitiator;\n    session;\n    remotePeer;\n    remoteExtensions = { webtransportCerthashes: [] };\n    payload;\n    connection;\n    xx;\n    staticKeypair;\n    prologue;\n    constructor(isInitiator, payload, prologue, crypto, staticKeypair, connection, remotePeer, handshake) {\n        this.isInitiator = isInitiator;\n        this.payload = payload;\n        this.prologue = prologue;\n        this.staticKeypair = staticKeypair;\n        this.connection = connection;\n        if (remotePeer) {\n            this.remotePeer = remotePeer;\n        }\n        this.xx = handshake ?? new XX(crypto);\n        this.session = this.xx.initSession(this.isInitiator, this.prologue, this.staticKeypair);\n    }\n    // stage 0\n    async propose() {\n        logLocalStaticKeys(this.session.hs.s);\n        if (this.isInitiator) {\n            logger.trace('Stage 0 - Initiator starting to send first message.');\n            const messageBuffer = this.xx.sendMessage(this.session, new Uint8Array(0));\n            await this.connection.write(encode0(messageBuffer));\n            logger.trace('Stage 0 - Initiator finished sending first message.');\n            logLocalEphemeralKeys(this.session.hs.e);\n        }\n        else {\n            logger.trace('Stage 0 - Responder waiting to receive first message...');\n            const receivedMessageBuffer = decode0((await this.connection.read()).subarray());\n            const { valid } = this.xx.recvMessage(this.session, receivedMessageBuffer);\n            if (!valid) {\n                throw new InvalidCryptoExchangeError('xx handshake stage 0 validation fail');\n            }\n            logger.trace('Stage 0 - Responder received first message.');\n            logRemoteEphemeralKey(this.session.hs.re);\n        }\n    }\n    // stage 1\n    async exchange() {\n        if (this.isInitiator) {\n            logger.trace('Stage 1 - Initiator waiting to receive first message from responder...');\n            const receivedMessageBuffer = decode1((await this.connection.read()).subarray());\n            const { plaintext, valid } = this.xx.recvMessage(this.session, receivedMessageBuffer);\n            if (!valid) {\n                throw new InvalidCryptoExchangeError('xx handshake stage 1 validation fail');\n            }\n            logger.trace('Stage 1 - Initiator received the message.');\n            logRemoteEphemeralKey(this.session.hs.re);\n            logRemoteStaticKey(this.session.hs.rs);\n            logger.trace(\"Initiator going to check remote's signature...\");\n            try {\n                const decodedPayload = decodePayload(plaintext);\n                this.remotePeer = this.remotePeer || await getPeerIdFromPayload(decodedPayload);\n                await verifySignedPayload(this.session.hs.rs, decodedPayload, this.remotePeer);\n                this.setRemoteNoiseExtension(decodedPayload.extensions);\n            }\n            catch (e) {\n                const err = e;\n                throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${err.message}`);\n            }\n            logger.trace('All good with the signature!');\n        }\n        else {\n            logger.trace('Stage 1 - Responder sending out first message with signed payload and static key.');\n            const messageBuffer = this.xx.sendMessage(this.session, this.payload);\n            await this.connection.write(encode1(messageBuffer));\n            logger.trace('Stage 1 - Responder sent the second handshake message with signed payload.');\n            logLocalEphemeralKeys(this.session.hs.e);\n        }\n    }\n    // stage 2\n    async finish() {\n        if (this.isInitiator) {\n            logger.trace('Stage 2 - Initiator sending third handshake message.');\n            const messageBuffer = this.xx.sendMessage(this.session, this.payload);\n            await this.connection.write(encode2(messageBuffer));\n            logger.trace('Stage 2 - Initiator sent message with signed payload.');\n        }\n        else {\n            logger.trace('Stage 2 - Responder waiting for third handshake message...');\n            const receivedMessageBuffer = decode2((await this.connection.read()).subarray());\n            const { plaintext, valid } = this.xx.recvMessage(this.session, receivedMessageBuffer);\n            if (!valid) {\n                throw new InvalidCryptoExchangeError('xx handshake stage 2 validation fail');\n            }\n            logger.trace('Stage 2 - Responder received the message, finished handshake.');\n            try {\n                const decodedPayload = decodePayload(plaintext);\n                this.remotePeer = this.remotePeer || await getPeerIdFromPayload(decodedPayload);\n                await verifySignedPayload(this.session.hs.rs, decodedPayload, this.remotePeer);\n                this.setRemoteNoiseExtension(decodedPayload.extensions);\n            }\n            catch (e) {\n                const err = e;\n                throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${err.message}`);\n            }\n        }\n        logCipherState(this.session);\n    }\n    encrypt(plaintext, session) {\n        const cs = this.getCS(session);\n        return this.xx.encryptWithAd(cs, new Uint8Array(0), plaintext);\n    }\n    decrypt(ciphertext, session, dst) {\n        const cs = this.getCS(session, false);\n        return this.xx.decryptWithAd(cs, new Uint8Array(0), ciphertext, dst);\n    }\n    getRemoteStaticKey() {\n        return this.session.hs.rs;\n    }\n    getCS(session, encryption = true) {\n        if (!session.cs1 || !session.cs2) {\n            throw new InvalidCryptoExchangeError('Handshake not completed properly, cipher state does not exist.');\n        }\n        if (this.isInitiator) {\n            return encryption ? session.cs1 : session.cs2;\n        }\n        else {\n            return encryption ? session.cs2 : session.cs1;\n        }\n    }\n    setRemoteNoiseExtension(e) {\n        if (e) {\n            this.remoteExtensions = e;\n        }\n    }\n}\n//# sourceMappingURL=handshake-xx.js.map","import { decode } from 'it-length-prefixed';\nimport { lpStream } from 'it-length-prefixed-stream';\nimport { duplexPair } from 'it-pair/duplex';\nimport { pipe } from 'it-pipe';\nimport { NOISE_MSG_MAX_LENGTH_BYTES } from './constants.js';\nimport { pureJsCrypto } from './crypto/js.js';\nimport { decryptStream, encryptStream } from './crypto/streaming.js';\nimport { uint16BEDecode, uint16BEEncode } from './encoder.js';\nimport { XXHandshake } from './handshake-xx.js';\nimport { registerMetrics } from './metrics.js';\nimport { getPayload } from './utils.js';\nexport class Noise {\n    protocol = '/noise';\n    crypto;\n    prologue;\n    staticKeys;\n    extensions;\n    metrics;\n    constructor(init = {}) {\n        const { staticNoiseKey, extensions, crypto, prologueBytes, metrics } = init;\n        this.crypto = crypto ?? pureJsCrypto;\n        this.extensions = extensions;\n        this.metrics = metrics ? registerMetrics(metrics) : undefined;\n        if (staticNoiseKey) {\n            // accepts x25519 private key of length 32\n            this.staticKeys = this.crypto.generateX25519KeyPairFromSeed(staticNoiseKey);\n        }\n        else {\n            this.staticKeys = this.crypto.generateX25519KeyPair();\n        }\n        this.prologue = prologueBytes ?? new Uint8Array(0);\n    }\n    /**\n     * Encrypt outgoing data to the remote party (handshake as initiator)\n     *\n     * @param {PeerId} localPeer - PeerId of the receiving peer\n     * @param {Duplex<AsyncGenerator<Uint8Array>, AsyncIterable<Uint8Array>, Promise<void>>} connection - streaming iterable duplex that will be encrypted\n     * @param {PeerId} remotePeer - PeerId of the remote peer. Used to validate the integrity of the remote peer.\n     * @returns {Promise<SecuredConnection>}\n     */\n    async secureOutbound(localPeer, connection, remotePeer) {\n        const wrappedConnection = lpStream(connection, {\n            lengthEncoder: uint16BEEncode,\n            lengthDecoder: uint16BEDecode,\n            maxDataLength: NOISE_MSG_MAX_LENGTH_BYTES\n        });\n        const handshake = await this.performHandshake({\n            connection: wrappedConnection,\n            isInitiator: true,\n            localPeer,\n            remotePeer\n        });\n        const conn = await this.createSecureConnection(wrappedConnection, handshake);\n        return {\n            conn,\n            remoteExtensions: handshake.remoteExtensions,\n            remotePeer: handshake.remotePeer\n        };\n    }\n    /**\n     * Decrypt incoming data (handshake as responder).\n     *\n     * @param {PeerId} localPeer - PeerId of the receiving peer.\n     * @param {Duplex<AsyncGenerator<Uint8Array>, AsyncIterable<Uint8Array>, Promise<void>>} connection - streaming iterable duplex that will be encryption.\n     * @param {PeerId} remotePeer - optional PeerId of the initiating peer, if known. This may only exist during transport upgrades.\n     * @returns {Promise<SecuredConnection>}\n     */\n    async secureInbound(localPeer, connection, remotePeer) {\n        const wrappedConnection = lpStream(connection, {\n            lengthEncoder: uint16BEEncode,\n            lengthDecoder: uint16BEDecode,\n            maxDataLength: NOISE_MSG_MAX_LENGTH_BYTES\n        });\n        const handshake = await this.performHandshake({\n            connection: wrappedConnection,\n            isInitiator: false,\n            localPeer,\n            remotePeer\n        });\n        const conn = await this.createSecureConnection(wrappedConnection, handshake);\n        return {\n            conn,\n            remotePeer: handshake.remotePeer,\n            remoteExtensions: handshake.remoteExtensions\n        };\n    }\n    /**\n     * If Noise pipes supported, tries IK handshake first with XX as fallback if it fails.\n     * If noise pipes disabled or remote peer static key is unknown, use XX.\n     *\n     * @param {HandshakeParams} params\n     */\n    async performHandshake(params) {\n        const payload = await getPayload(params.localPeer, this.staticKeys.publicKey, this.extensions);\n        // run XX handshake\n        return this.performXXHandshake(params, payload);\n    }\n    async performXXHandshake(params, payload) {\n        const { isInitiator, remotePeer, connection } = params;\n        const handshake = new XXHandshake(isInitiator, payload, this.prologue, this.crypto, this.staticKeys, connection, remotePeer);\n        try {\n            await handshake.propose();\n            await handshake.exchange();\n            await handshake.finish();\n            this.metrics?.xxHandshakeSuccesses.increment();\n        }\n        catch (e) {\n            this.metrics?.xxHandshakeErrors.increment();\n            if (e instanceof Error) {\n                e.message = `Error occurred during XX handshake: ${e.message}`;\n                throw e;\n            }\n        }\n        return handshake;\n    }\n    async createSecureConnection(connection, handshake) {\n        // Create encryption box/unbox wrapper\n        const [secure, user] = duplexPair();\n        const network = connection.unwrap();\n        await pipe(secure, // write to wrapper\n        encryptStream(handshake, this.metrics), // encrypt data + prefix with message length\n        network, // send to the remote peer\n        (source) => decode(source, { lengthDecoder: uint16BEDecode }), // read message length prefix\n        decryptStream(handshake, this.metrics), // decrypt the incoming data\n        secure // pipe to the wrapper\n        );\n        return user;\n    }\n}\n//# sourceMappingURL=noise.js.map","export function registerMetrics(metrics) {\n    return {\n        xxHandshakeSuccesses: metrics.registerCounter('libp2p_noise_xxhandshake_successes_total', {\n            help: 'Total count of noise xxHandshakes successes_'\n        }),\n        xxHandshakeErrors: metrics.registerCounter('libp2p_noise_xxhandshake_error_total', {\n            help: 'Total count of noise xxHandshakes errors'\n        }),\n        encryptedPackets: metrics.registerCounter('libp2p_noise_encrypted_packets_total', {\n            help: 'Total count of noise encrypted packets successfully'\n        }),\n        decryptedPackets: metrics.registerCounter('libp2p_noise_decrypted_packets_total', {\n            help: 'Total count of noise decrypted packets'\n        }),\n        decryptErrors: metrics.registerCounter('libp2p_noise_decrypt_errors_total', {\n            help: 'Total count of noise decrypt errors'\n        })\n    };\n}\n//# sourceMappingURL=metrics.js.map","import { pair } from './index.js';\n/**\n * Two duplex streams that are attached to each other\n */\nexport function duplexPair() {\n    const a = pair();\n    const b = pair();\n    return [\n        {\n            source: a.source,\n            sink: b.sink\n        },\n        {\n            source: b.source,\n            sink: a.sink\n        }\n    ];\n}\n//# sourceMappingURL=duplex.js.map","import { NOISE_MSG_MAX_LENGTH_BYTES, NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG } from '../constants.js';\nimport { uint16BEEncode } from '../encoder.js';\nconst CHACHA_TAG_LENGTH = 16;\n// Returns generator that encrypts payload from the user\nexport function encryptStream(handshake, metrics) {\n    return async function* (source) {\n        for await (const chunk of source) {\n            for (let i = 0; i < chunk.length; i += NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG) {\n                let end = i + NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;\n                if (end > chunk.length) {\n                    end = chunk.length;\n                }\n                const data = handshake.encrypt(chunk.subarray(i, end), handshake.session);\n                metrics?.encryptedPackets.increment();\n                yield uint16BEEncode(data.byteLength);\n                yield data;\n            }\n        }\n    };\n}\n// Decrypt received payload to the user\nexport function decryptStream(handshake, metrics) {\n    return async function* (source) {\n        for await (const chunk of source) {\n            for (let i = 0; i < chunk.length; i += NOISE_MSG_MAX_LENGTH_BYTES) {\n                let end = i + NOISE_MSG_MAX_LENGTH_BYTES;\n                if (end > chunk.length) {\n                    end = chunk.length;\n                }\n                if (end - CHACHA_TAG_LENGTH < i) {\n                    throw new Error('Invalid chunk');\n                }\n                const encrypted = chunk.subarray(i, end);\n                // memory allocation is not cheap so reuse the encrypted Uint8Array\n                // see https://github.com/ChainSafe/js-libp2p-noise/pull/242#issue-1422126164\n                // this is ok because chacha20 reads bytes one by one and don't reread after that\n                // it's also tested in https://github.com/ChainSafe/as-chacha20poly1305/pull/1/files#diff-25252846b58979dcaf4e41d47b3eadd7e4f335e7fb98da6c049b1f9cd011f381R48\n                const dst = chunk.subarray(i, end - CHACHA_TAG_LENGTH);\n                const { plaintext: decrypted, valid } = handshake.decrypt(encrypted, handshake.session, dst);\n                if (!valid) {\n                    metrics?.decryptErrors.increment();\n                    throw new Error('Failed to validate decrypted chunk');\n                }\n                metrics?.decryptedPackets.increment();\n                yield decrypted;\n            }\n        }\n    };\n}\n//# sourceMappingURL=streaming.js.map","import { Noise } from './noise.js';\nexport { pureJsCrypto } from './crypto/js.js';\nexport function noise(init = {}) {\n    return () => new Noise(init);\n}\n//# sourceMappingURL=index.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","export class AbortError extends Error {\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\n//# sourceMappingURL=abort-error.js.map","/**\n * @packageDocumentation\n *\n * @example\n *\n * ```js\n * import { abortableSource } from 'abortable-iterator'\n *\n * async function main () {\n *   // An example function that creates an async iterator that yields an increasing\n *   // number every x milliseconds and NEVER ENDS!\n *   const asyncCounter = async function * (start, delay) {\n *     let i = start\n *     while (true) {\n *       yield new Promise(resolve => setTimeout(() => resolve(i++), delay))\n *     }\n *   }\n *\n *   // Create a counter that'll yield numbers from 0 upwards every second\n *   const everySecond = asyncCounter(0, 1000)\n *\n *   // Make everySecond abortable!\n *   const controller = new AbortController()\n *   const abortableEverySecond = abortableSource(everySecond, controller.signal)\n *\n *   // Abort after 5 seconds\n *   setTimeout(() => controller.abort(), 5000)\n *\n *   try {\n *     // Start the iteration, which will throw after 5 seconds when it is aborted\n *     for await (const n of abortableEverySecond) {\n *       console.log(n)\n *     }\n *   } catch (err) {\n *     if (err.code === 'ERR_ABORTED') {\n *       // Expected - all ok :D\n *     } else {\n *       throw err\n *     }\n *   }\n * }\n *\n * main()\n * ```\n */\nimport { AbortError } from './abort-error.js';\nimport { getIterator } from 'get-iterator';\n/**\n * Wrap an iterator to make it abortable, allow cleanup when aborted via onAbort\n */\nexport function abortableSource(source, signal, options) {\n    const opts = options ?? {};\n    const iterator = getIterator(source);\n    async function* abortable() {\n        let nextAbortHandler;\n        const abortHandler = () => {\n            if (nextAbortHandler != null)\n                nextAbortHandler();\n        };\n        signal.addEventListener('abort', abortHandler);\n        while (true) {\n            let result;\n            try {\n                if (signal.aborted) {\n                    const { abortMessage, abortCode } = opts;\n                    throw new AbortError(abortMessage, abortCode);\n                }\n                const abort = new Promise((resolve, reject) => {\n                    nextAbortHandler = () => {\n                        const { abortMessage, abortCode } = opts;\n                        reject(new AbortError(abortMessage, abortCode));\n                    };\n                });\n                // Race the iterator and the abort signals\n                result = await Promise.race([abort, iterator.next()]);\n                nextAbortHandler = null;\n            }\n            catch (err) {\n                signal.removeEventListener('abort', abortHandler);\n                // Might not have been aborted by a known signal\n                const isKnownAborter = err.type === 'aborted' && signal.aborted;\n                if (isKnownAborter && (opts.onAbort != null)) {\n                    // Do any custom abort handling for the iterator\n                    opts.onAbort(source);\n                }\n                // End the iterator if it is a generator\n                if (typeof iterator.return === 'function') {\n                    try {\n                        const p = iterator.return();\n                        if (p instanceof Promise) { // eslint-disable-line max-depth\n                            p.catch(err => {\n                                if (opts.onReturnError != null) {\n                                    opts.onReturnError(err);\n                                }\n                            });\n                        }\n                    }\n                    catch (err) {\n                        if (opts.onReturnError != null) { // eslint-disable-line max-depth\n                            opts.onReturnError(err);\n                        }\n                    }\n                }\n                if (isKnownAborter && opts.returnOnAbort === true) {\n                    return;\n                }\n                throw err;\n            }\n            if (result.done === true) {\n                break;\n            }\n            yield result.value;\n        }\n        signal.removeEventListener('abort', abortHandler);\n    }\n    return abortable();\n}\nexport function abortableSink(sink, signal, options) {\n    return (source) => sink(abortableSource(source, signal, options));\n}\nexport function abortableDuplex(duplex, signal, options) {\n    return {\n        sink: abortableSink(duplex.sink, signal, {\n            ...options,\n            onAbort: undefined\n        }),\n        source: abortableSource(duplex.source, signal, options)\n    };\n}\nexport { AbortError };\nexport { abortableSink as abortableTransform };\n//# sourceMappingURL=index.js.map","export function getIterator(obj) {\n    if (obj != null) {\n        if (typeof obj[Symbol.iterator] === 'function') {\n            return obj[Symbol.iterator]();\n        }\n        if (typeof obj[Symbol.asyncIterator] === 'function') {\n            return obj[Symbol.asyncIterator]();\n        }\n        if (typeof obj.next === 'function') {\n            return obj; // probably an iterator\n        }\n    }\n    throw new Error('argument is not an iterator or iterable');\n}\n//# sourceMappingURL=index.js.map","// ported from https://www.npmjs.com/package/fast-fifo\nclass FixedFIFO {\n    buffer;\n    mask;\n    top;\n    btm;\n    next;\n    constructor(hwm) {\n        if (!(hwm > 0) || ((hwm - 1) & hwm) !== 0) {\n            throw new Error('Max size for a FixedFIFO should be a power of two');\n        }\n        this.buffer = new Array(hwm);\n        this.mask = hwm - 1;\n        this.top = 0;\n        this.btm = 0;\n        this.next = null;\n    }\n    push(data) {\n        if (this.buffer[this.top] !== undefined) {\n            return false;\n        }\n        this.buffer[this.top] = data;\n        this.top = (this.top + 1) & this.mask;\n        return true;\n    }\n    shift() {\n        const last = this.buffer[this.btm];\n        if (last === undefined) {\n            return undefined;\n        }\n        this.buffer[this.btm] = undefined;\n        this.btm = (this.btm + 1) & this.mask;\n        return last;\n    }\n    isEmpty() {\n        return this.buffer[this.btm] === undefined;\n    }\n}\nexport class FIFO {\n    size;\n    hwm;\n    head;\n    tail;\n    constructor(options = {}) {\n        this.hwm = options.splitLimit ?? 16;\n        this.head = new FixedFIFO(this.hwm);\n        this.tail = this.head;\n        this.size = 0;\n    }\n    calculateSize(obj) {\n        if (obj?.byteLength != null) {\n            return obj.byteLength;\n        }\n        return 1;\n    }\n    push(val) {\n        if (val?.value != null) {\n            this.size += this.calculateSize(val.value);\n        }\n        if (!this.head.push(val)) {\n            const prev = this.head;\n            this.head = prev.next = new FixedFIFO(2 * this.head.buffer.length);\n            this.head.push(val);\n        }\n    }\n    shift() {\n        let val = this.tail.shift();\n        if (val === undefined && (this.tail.next != null)) {\n            const next = this.tail.next;\n            this.tail.next = null;\n            this.tail = next;\n            val = this.tail.shift();\n        }\n        if (val?.value != null) {\n            this.size -= this.calculateSize(val.value);\n        }\n        return val;\n    }\n    isEmpty() {\n        return this.head.isEmpty();\n    }\n}\n//# sourceMappingURL=fifo.js.map","/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\nimport deferred from 'p-defer';\nimport { FIFO } from './fifo.js';\nexport class AbortError extends Error {\n    type;\n    code;\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\nexport function pushable(options = {}) {\n    const getNext = (buffer) => {\n        const next = buffer.shift();\n        if (next == null) {\n            return { done: true };\n        }\n        if (next.error != null) {\n            throw next.error;\n        }\n        return {\n            done: next.done === true,\n            // @ts-expect-error if done is false, value will be present\n            value: next.value\n        };\n    };\n    return _pushable(getNext, options);\n}\nexport function pushableV(options = {}) {\n    const getNext = (buffer) => {\n        let next;\n        const values = [];\n        while (!buffer.isEmpty()) {\n            next = buffer.shift();\n            if (next == null) {\n                break;\n            }\n            if (next.error != null) {\n                throw next.error;\n            }\n            if (next.done === false) {\n                // @ts-expect-error if done is false value should be pushed\n                values.push(next.value);\n            }\n        }\n        if (next == null) {\n            return { done: true };\n        }\n        return {\n            done: next.done === true,\n            value: values\n        };\n    };\n    return _pushable(getNext, options);\n}\nfunction _pushable(getNext, options) {\n    options = options ?? {};\n    let onEnd = options.onEnd;\n    let buffer = new FIFO();\n    let pushable;\n    let onNext;\n    let ended;\n    let drain = deferred();\n    const waitNext = async () => {\n        try {\n            if (!buffer.isEmpty()) {\n                return getNext(buffer);\n            }\n            if (ended) {\n                return { done: true };\n            }\n            return await new Promise((resolve, reject) => {\n                onNext = (next) => {\n                    onNext = null;\n                    buffer.push(next);\n                    try {\n                        resolve(getNext(buffer));\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                    return pushable;\n                };\n            });\n        }\n        finally {\n            if (buffer.isEmpty()) {\n                // settle promise in the microtask queue to give consumers a chance to\n                // await after calling .push\n                queueMicrotask(() => {\n                    drain.resolve();\n                    drain = deferred();\n                });\n            }\n        }\n    };\n    const bufferNext = (next) => {\n        if (onNext != null) {\n            return onNext(next);\n        }\n        buffer.push(next);\n        return pushable;\n    };\n    const bufferError = (err) => {\n        buffer = new FIFO();\n        if (onNext != null) {\n            return onNext({ error: err });\n        }\n        buffer.push({ error: err });\n        return pushable;\n    };\n    const push = (value) => {\n        if (ended) {\n            return pushable;\n        }\n        // @ts-expect-error `byteLength` is not declared on PushType\n        if (options?.objectMode !== true && value?.byteLength == null) {\n            throw new Error('objectMode was not true but tried to push non-Uint8Array value');\n        }\n        return bufferNext({ done: false, value });\n    };\n    const end = (err) => {\n        if (ended)\n            return pushable;\n        ended = true;\n        return (err != null) ? bufferError(err) : bufferNext({ done: true });\n    };\n    const _return = () => {\n        buffer = new FIFO();\n        end();\n        return { done: true };\n    };\n    const _throw = (err) => {\n        end(err);\n        return { done: true };\n    };\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next: waitNext,\n        return: _return,\n        throw: _throw,\n        push,\n        end,\n        get readableLength() {\n            return buffer.size;\n        },\n        onEmpty: async (options) => {\n            const signal = options?.signal;\n            signal?.throwIfAborted();\n            if (buffer.isEmpty()) {\n                return;\n            }\n            let cancel;\n            let listener;\n            if (signal != null) {\n                cancel = new Promise((resolve, reject) => {\n                    listener = () => {\n                        reject(new AbortError());\n                    };\n                    signal.addEventListener('abort', listener);\n                });\n            }\n            try {\n                await Promise.race([\n                    drain.promise,\n                    cancel\n                ]);\n            }\n            finally {\n                if (listener != null && signal != null) {\n                    signal?.removeEventListener('abort', listener);\n                }\n            }\n        }\n    };\n    if (onEnd == null) {\n        return pushable;\n    }\n    const _pushable = pushable;\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next() {\n            return _pushable.next();\n        },\n        throw(err) {\n            _pushable.throw(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        return() {\n            _pushable.return();\n            if (onEnd != null) {\n                onEnd();\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        push,\n        end(err) {\n            _pushable.end(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return pushable;\n        },\n        get readableLength() {\n            return _pushable.readableLength;\n        }\n    };\n    return pushable;\n}\n//# sourceMappingURL=index.js.map","// Protocol violation errors\nexport const ERR_INVALID_FRAME = 'ERR_INVALID_FRAME';\nexport const ERR_UNREQUESTED_PING = 'ERR_UNREQUESTED_PING';\nexport const ERR_NOT_MATCHING_PING = 'ERR_NOT_MATCHING_PING';\nexport const ERR_STREAM_ALREADY_EXISTS = 'ERR_STREAM_ALREADY_EXISTS';\nexport const ERR_DECODE_INVALID_VERSION = 'ERR_DECODE_INVALID_VERSION';\nexport const ERR_BOTH_CLIENTS = 'ERR_BOTH_CLIENTS';\nexport const ERR_RECV_WINDOW_EXCEEDED = 'ERR_RECV_WINDOW_EXCEEDED';\nexport const PROTOCOL_ERRORS = new Set([\n    ERR_INVALID_FRAME,\n    ERR_UNREQUESTED_PING,\n    ERR_NOT_MATCHING_PING,\n    ERR_STREAM_ALREADY_EXISTS,\n    ERR_DECODE_INVALID_VERSION,\n    ERR_BOTH_CLIENTS,\n    ERR_RECV_WINDOW_EXCEEDED\n]);\n// local errors\nexport const ERR_INVALID_CONFIG = 'ERR_INVALID_CONFIG';\nexport const ERR_MUXER_LOCAL_CLOSED = 'ERR_MUXER_LOCAL_CLOSED';\nexport const ERR_MUXER_REMOTE_CLOSED = 'ERR_MUXER_REMOTE_CLOSED';\nexport const ERR_STREAM_RESET = 'ERR_STREAM_RESET';\nexport const ERR_STREAM_ABORT = 'ERR_STREAM_ABORT';\nexport const ERR_MAX_OUTBOUND_STREAMS_EXCEEDED = 'ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED';\nexport const ERR_DECODE_IN_PROGRESS = 'ERR_DECODE_IN_PROGRESS';\n/**\n * INITIAL_STREAM_WINDOW is the initial stream window size.\n *\n * Not an implementation choice, this is defined in the specification\n */\nexport const INITIAL_STREAM_WINDOW = 256 * 1024;\n/**\n * Default max stream window\n */\nexport const MAX_STREAM_WINDOW = 16 * 1024 * 1024;\n//# sourceMappingURL=constants.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { logger } from '@libp2p/logger';\nimport { ERR_INVALID_CONFIG, INITIAL_STREAM_WINDOW, MAX_STREAM_WINDOW } from './constants.js';\nexport const defaultConfig = {\n    log: logger('libp2p:yamux'),\n    enableKeepAlive: true,\n    keepAliveInterval: 30000,\n    maxInboundStreams: 1000,\n    maxOutboundStreams: 1000,\n    initialStreamWindowSize: INITIAL_STREAM_WINDOW,\n    maxStreamWindowSize: MAX_STREAM_WINDOW,\n    maxMessageSize: 64 * 1024\n};\nexport function verifyConfig(config) {\n    if (config.keepAliveInterval <= 0) {\n        throw new CodeError('keep-alive interval must be positive', ERR_INVALID_CONFIG);\n    }\n    if (config.maxInboundStreams < 0) {\n        throw new CodeError('max inbound streams must be larger or equal 0', ERR_INVALID_CONFIG);\n    }\n    if (config.maxOutboundStreams < 0) {\n        throw new CodeError('max outbound streams must be larger or equal 0', ERR_INVALID_CONFIG);\n    }\n    if (config.initialStreamWindowSize < INITIAL_STREAM_WINDOW) {\n        throw new CodeError('InitialStreamWindowSize must be larger or equal 256 kB', ERR_INVALID_CONFIG);\n    }\n    if (config.maxStreamWindowSize < config.initialStreamWindowSize) {\n        throw new CodeError('MaxStreamWindowSize must be larger than the InitialStreamWindowSize', ERR_INVALID_CONFIG);\n    }\n    if (config.maxStreamWindowSize > 2 ** 32 - 1) {\n        throw new CodeError('MaxStreamWindowSize must be less than equal MAX_UINT32', ERR_INVALID_CONFIG);\n    }\n    if (config.maxMessageSize < 1024) {\n        throw new CodeError('MaxMessageSize must be greater than a kilobyte', ERR_INVALID_CONFIG);\n    }\n}\n//# sourceMappingURL=config.js.map","export var FrameType;\n(function (FrameType) {\n    /** Used to transmit data. May transmit zero length payloads depending on the flags. */\n    FrameType[FrameType[\"Data\"] = 0] = \"Data\";\n    /** Used to updated the senders receive window size. This is used to implement per-session flow control. */\n    FrameType[FrameType[\"WindowUpdate\"] = 1] = \"WindowUpdate\";\n    /** Used to measure RTT. It can also be used to heart-beat and do keep-alives over TCP. */\n    FrameType[FrameType[\"Ping\"] = 2] = \"Ping\";\n    /** Used to close a session. */\n    FrameType[FrameType[\"GoAway\"] = 3] = \"GoAway\";\n})(FrameType || (FrameType = {}));\nexport var Flag;\n(function (Flag) {\n    /** Signals the start of a new stream. May be sent with a data or window update message. Also sent with a ping to indicate outbound. */\n    Flag[Flag[\"SYN\"] = 1] = \"SYN\";\n    /** Acknowledges the start of a new stream. May be sent with a data or window update message. Also sent with a ping to indicate response. */\n    Flag[Flag[\"ACK\"] = 2] = \"ACK\";\n    /** Performs a half-close of a stream. May be sent with a data message or window update. */\n    Flag[Flag[\"FIN\"] = 4] = \"FIN\";\n    /** Reset a stream immediately. May be sent with a data or window update message. */\n    Flag[Flag[\"RST\"] = 8] = \"RST\";\n})(Flag || (Flag = {}));\nconst flagCodes = Object.values(Flag).filter((x) => typeof x !== 'string');\nexport const YAMUX_VERSION = 0;\nexport var GoAwayCode;\n(function (GoAwayCode) {\n    GoAwayCode[GoAwayCode[\"NormalTermination\"] = 0] = \"NormalTermination\";\n    GoAwayCode[GoAwayCode[\"ProtocolError\"] = 1] = \"ProtocolError\";\n    GoAwayCode[GoAwayCode[\"InternalError\"] = 2] = \"InternalError\";\n})(GoAwayCode || (GoAwayCode = {}));\nexport const HEADER_LENGTH = 12;\nexport function stringifyHeader(header) {\n    const flags = flagCodes.filter(f => (header.flag & f) === f).map(f => Flag[f]).join('|');\n    return `streamID=${header.streamID} type=${FrameType[header.type]} flag=${flags} length=${header.length}`;\n}\n//# sourceMappingURL=frame.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { Uint8ArrayList } from 'uint8arraylist';\nimport { ERR_DECODE_INVALID_VERSION, ERR_DECODE_IN_PROGRESS } from './constants.js';\nimport { FrameType, HEADER_LENGTH, YAMUX_VERSION } from './frame.js';\n// used to bitshift in decoding\n// native bitshift can overflow into a negative number, so we bitshift by multiplying by a power of 2\nconst twoPow24 = 2 ** 24;\n/**\n * Decode a header from the front of a buffer\n *\n * @param data - Assumed to have enough bytes for a header\n */\nexport function decodeHeader(data) {\n    if (data[0] !== YAMUX_VERSION) {\n        throw new CodeError('Invalid frame version', ERR_DECODE_INVALID_VERSION);\n    }\n    return {\n        type: data[1],\n        flag: (data[2] << 8) + data[3],\n        streamID: (data[4] * twoPow24) + (data[5] << 16) + (data[6] << 8) + data[7],\n        length: (data[8] * twoPow24) + (data[9] << 16) + (data[10] << 8) + data[11]\n    };\n}\n/**\n * Decodes yamux frames from a source\n */\nexport class Decoder {\n    source;\n    /** Buffer for in-progress frames */\n    buffer;\n    /** Used to sanity check against decoding while in an inconsistent state */\n    frameInProgress;\n    constructor(source) {\n        // Normally, when entering a for-await loop with an iterable/async iterable, the only ways to exit the loop are:\n        // 1. exhaust the iterable\n        // 2. throw an error - slow, undesirable if there's not actually an error\n        // 3. break or return - calls the iterable's `return` method, finalizing the iterable, no more iteration possible\n        //\n        // In this case, we want to enter (and exit) a for-await loop per chunked data frame and continue processing the iterable.\n        // To do this, we strip the `return` method from the iterator and can now `break` early and continue iterating.\n        // Exiting the main for-await is still possible via 1. and 2.\n        this.source = returnlessSource(source);\n        this.buffer = new Uint8ArrayList();\n        this.frameInProgress = false;\n    }\n    /**\n     * Emits frames from the decoder source.\n     *\n     * Note: If `readData` is emitted, it _must_ be called before the next iteration\n     * Otherwise an error is thrown\n     */\n    async *emitFrames() {\n        for await (const chunk of this.source) {\n            this.buffer.append(chunk);\n            // Loop to consume as many bytes from the buffer as possible\n            // Eg: when a single chunk contains several frames\n            while (true) {\n                const header = this.readHeader();\n                if (header === undefined) {\n                    break;\n                }\n                const { type, length } = header;\n                if (type === FrameType.Data) {\n                    // This is a data frame, the frame body must still be read\n                    // `readData` must be called before the next iteration here\n                    this.frameInProgress = true;\n                    yield {\n                        header,\n                        readData: this.readBytes.bind(this, length)\n                    };\n                }\n                else {\n                    yield { header };\n                }\n            }\n        }\n    }\n    readHeader() {\n        // Sanity check to ensure a header isn't read when another frame is partially decoded\n        // In practice this shouldn't happen\n        if (this.frameInProgress) {\n            throw new CodeError('decoding frame already in progress', ERR_DECODE_IN_PROGRESS);\n        }\n        if (this.buffer.length < HEADER_LENGTH) {\n            // not enough data yet\n            return;\n        }\n        const header = decodeHeader(this.buffer.subarray(0, HEADER_LENGTH));\n        this.buffer.consume(HEADER_LENGTH);\n        return header;\n    }\n    async readBytes(length) {\n        if (this.buffer.length < length) {\n            for await (const chunk of this.source) {\n                this.buffer.append(chunk);\n                if (this.buffer.length >= length) {\n                    // see note above, the iterator is not `return`ed here\n                    break;\n                }\n            }\n        }\n        const out = this.buffer.sublist(0, length);\n        this.buffer.consume(length);\n        // The next frame can now be decoded\n        this.frameInProgress = false;\n        return out;\n    }\n}\n/**\n * Strip the `return` method from a `Source`\n */\nexport function returnlessSource(source) {\n    if (source[Symbol.iterator] !== undefined) {\n        const iterator = source[Symbol.iterator]();\n        iterator.return = undefined;\n        return {\n            [Symbol.iterator]() { return iterator; }\n        };\n    }\n    else if (source[Symbol.asyncIterator] !== undefined) {\n        const iterator = source[Symbol.asyncIterator]();\n        iterator.return = undefined;\n        return {\n            [Symbol.asyncIterator]() { return iterator; }\n        };\n    }\n    else {\n        throw new Error('a source must be either an iterable or an async iterable');\n    }\n}\n//# sourceMappingURL=decode.js.map","import { HEADER_LENGTH } from './frame.js';\nexport function encodeHeader(header) {\n    const frame = new Uint8Array(HEADER_LENGTH);\n    // always assume version 0\n    // frameView.setUint8(0, header.version)\n    frame[1] = header.type;\n    frame[2] = header.flag >>> 8;\n    frame[3] = header.flag;\n    frame[4] = header.streamID >>> 24;\n    frame[5] = header.streamID >>> 16;\n    frame[6] = header.streamID >>> 8;\n    frame[7] = header.streamID;\n    frame[8] = header.length >>> 24;\n    frame[9] = header.length >>> 16;\n    frame[10] = header.length >>> 8;\n    frame[11] = header.length;\n    return frame;\n}\n//# sourceMappingURL=encode.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction forEach(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const thing of source) {\n                await fn(thing);\n                yield thing;\n            }\n        })();\n    }\n    // if fn function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    if (typeof res?.then === 'function') {\n        return (async function* () {\n            yield value;\n            for await (const val of peekable) {\n                await fn(val);\n                yield val;\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        yield value;\n        for (const val of peekable) {\n            func(val);\n            yield val;\n        }\n    })();\n}\nexport default forEach;\n//# sourceMappingURL=index.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { AbstractStream } from '@libp2p/interface/stream-muxer/stream';\nimport each from 'it-foreach';\nimport { ERR_RECV_WINDOW_EXCEEDED, ERR_STREAM_ABORT, INITIAL_STREAM_WINDOW } from './constants.js';\nimport { Flag, FrameType, HEADER_LENGTH } from './frame.js';\nexport var StreamState;\n(function (StreamState) {\n    StreamState[StreamState[\"Init\"] = 0] = \"Init\";\n    StreamState[StreamState[\"SYNSent\"] = 1] = \"SYNSent\";\n    StreamState[StreamState[\"SYNReceived\"] = 2] = \"SYNReceived\";\n    StreamState[StreamState[\"Established\"] = 3] = \"Established\";\n    StreamState[StreamState[\"Finished\"] = 4] = \"Finished\";\n})(StreamState || (StreamState = {}));\n/** YamuxStream is used to represent a logical stream within a session */\nexport class YamuxStream extends AbstractStream {\n    name;\n    state;\n    config;\n    _id;\n    /** The number of available bytes to send */\n    sendWindowCapacity;\n    /** Callback to notify that the sendWindowCapacity has been updated */\n    sendWindowCapacityUpdate;\n    /** The number of bytes available to receive in a full window */\n    recvWindow;\n    /** The number of available bytes to receive */\n    recvWindowCapacity;\n    /**\n     * An 'epoch' is the time it takes to process and read data\n     *\n     * Used in conjunction with RTT to determine whether to increase the recvWindow\n     */\n    epochStart;\n    getRTT;\n    sendFrame;\n    constructor(init) {\n        super({\n            ...init,\n            onEnd: (err) => {\n                this.state = StreamState.Finished;\n                init.onEnd?.(err);\n            }\n        });\n        this.config = init.config;\n        this._id = parseInt(init.id, 10);\n        this.name = init.name;\n        this.state = init.state;\n        this.sendWindowCapacity = INITIAL_STREAM_WINDOW;\n        this.recvWindow = this.config.initialStreamWindowSize;\n        this.recvWindowCapacity = this.recvWindow;\n        this.epochStart = Date.now();\n        this.getRTT = init.getRTT;\n        this.sendFrame = init.sendFrame;\n        this.source = each(this.source, () => {\n            this.sendWindowUpdate();\n        });\n    }\n    /**\n     * Send a message to the remote muxer informing them a new stream is being\n     * opened.\n     *\n     * This is a noop for Yamux because the first window update is sent when\n     * .newStream is called on the muxer which opens the stream on the remote.\n     */\n    async sendNewStream() {\n    }\n    /**\n     * Send a data message to the remote muxer\n     */\n    async sendData(buf, options = {}) {\n        buf = buf.sublist();\n        // send in chunks, waiting for window updates\n        while (buf.byteLength !== 0) {\n            // wait for the send window to refill\n            if (this.sendWindowCapacity === 0) {\n                await this.waitForSendWindowCapacity(options);\n            }\n            // check we didn't close while waiting for send window capacity\n            if (this.status !== 'open') {\n                return;\n            }\n            // send as much as we can\n            const toSend = Math.min(this.sendWindowCapacity, this.config.maxMessageSize - HEADER_LENGTH, buf.length);\n            const flags = this.getSendFlags();\n            this.sendFrame({\n                type: FrameType.Data,\n                flag: flags,\n                streamID: this._id,\n                length: toSend\n            }, buf.subarray(0, toSend));\n            this.sendWindowCapacity -= toSend;\n            buf.consume(toSend);\n        }\n    }\n    /**\n     * Send a reset message to the remote muxer\n     */\n    async sendReset() {\n        this.sendFrame({\n            type: FrameType.WindowUpdate,\n            flag: Flag.RST,\n            streamID: this._id,\n            length: 0\n        });\n    }\n    /**\n     * Send a message to the remote muxer, informing them no more data messages\n     * will be sent by this end of the stream\n     */\n    async sendCloseWrite() {\n        const flags = this.getSendFlags() | Flag.FIN;\n        this.sendFrame({\n            type: FrameType.WindowUpdate,\n            flag: flags,\n            streamID: this._id,\n            length: 0\n        });\n    }\n    /**\n     * Send a message to the remote muxer, informing them no more data messages\n     * will be read by this end of the stream\n     */\n    async sendCloseRead() {\n    }\n    /**\n     * Wait for the send window to be non-zero\n     *\n     * Will throw with ERR_STREAM_ABORT if the stream gets aborted\n     */\n    async waitForSendWindowCapacity(options = {}) {\n        if (this.sendWindowCapacity > 0) {\n            return;\n        }\n        let resolve;\n        let reject;\n        const abort = () => {\n            if (this.status === 'open') {\n                reject(new CodeError('stream aborted', ERR_STREAM_ABORT));\n            }\n            else {\n                // the stream was closed already, ignore the failure to send\n                resolve();\n            }\n        };\n        options.signal?.addEventListener('abort', abort);\n        try {\n            await new Promise((_resolve, _reject) => {\n                this.sendWindowCapacityUpdate = () => {\n                    _resolve();\n                };\n                reject = _reject;\n                resolve = _resolve;\n            });\n        }\n        finally {\n            options.signal?.removeEventListener('abort', abort);\n        }\n    }\n    /**\n     * handleWindowUpdate is called when the stream receives a window update frame\n     */\n    handleWindowUpdate(header) {\n        this.log?.trace('stream received window update id=%s', this._id);\n        this.processFlags(header.flag);\n        // increase send window\n        const available = this.sendWindowCapacity;\n        this.sendWindowCapacity += header.length;\n        // if the update increments a 0 availability, notify the stream that sending can resume\n        if (available === 0 && header.length > 0) {\n            this.sendWindowCapacityUpdate?.();\n        }\n    }\n    /**\n     * handleData is called when the stream receives a data frame\n     */\n    async handleData(header, readData) {\n        this.log?.trace('stream received data id=%s', this._id);\n        this.processFlags(header.flag);\n        // check that our recv window is not exceeded\n        if (this.recvWindowCapacity < header.length) {\n            throw new CodeError('receive window exceeded', ERR_RECV_WINDOW_EXCEEDED, { available: this.recvWindowCapacity, recv: header.length });\n        }\n        const data = await readData();\n        this.recvWindowCapacity -= header.length;\n        this.sourcePush(data);\n    }\n    /**\n     * processFlags is used to update the state of the stream based on set flags, if any.\n     */\n    processFlags(flags) {\n        if ((flags & Flag.ACK) === Flag.ACK) {\n            if (this.state === StreamState.SYNSent) {\n                this.state = StreamState.Established;\n            }\n        }\n        if ((flags & Flag.FIN) === Flag.FIN) {\n            this.remoteCloseWrite();\n        }\n        if ((flags & Flag.RST) === Flag.RST) {\n            this.reset();\n        }\n    }\n    /**\n     * getSendFlags determines any flags that are appropriate\n     * based on the current stream state.\n     *\n     * The state is updated as a side-effect.\n     */\n    getSendFlags() {\n        switch (this.state) {\n            case StreamState.Init:\n                this.state = StreamState.SYNSent;\n                return Flag.SYN;\n            case StreamState.SYNReceived:\n                this.state = StreamState.Established;\n                return Flag.ACK;\n            default:\n                return 0;\n        }\n    }\n    /**\n     * potentially sends a window update enabling further writes to take place.\n     */\n    sendWindowUpdate() {\n        // determine the flags if any\n        const flags = this.getSendFlags();\n        // If the stream has already been established\n        // and we've processed data within the time it takes for 4 round trips\n        // then we (up to) double the recvWindow\n        const now = Date.now();\n        const rtt = this.getRTT();\n        if (flags === 0 && rtt > 0 && now - this.epochStart < rtt * 4) {\n            // we've already validated that maxStreamWindowSize can't be more than MAX_UINT32\n            this.recvWindow = Math.min(this.recvWindow * 2, this.config.maxStreamWindowSize);\n        }\n        if (this.recvWindowCapacity >= this.recvWindow && flags === 0) {\n            // a window update isn't needed\n            return;\n        }\n        // update the receive window\n        const delta = this.recvWindow - this.recvWindowCapacity;\n        this.recvWindowCapacity = this.recvWindow;\n        // update the epoch start\n        this.epochStart = now;\n        // send window update\n        this.sendFrame({\n            type: FrameType.WindowUpdate,\n            flag: flags,\n            streamID: this._id,\n            length: delta\n        });\n    }\n}\n//# sourceMappingURL=stream.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { logger } from '@libp2p/logger';\nimport { abortableSource } from 'abortable-iterator';\nimport { pipe } from 'it-pipe';\nimport { pushable } from 'it-pushable';\nimport { defaultConfig, verifyConfig } from './config.js';\nimport { ERR_BOTH_CLIENTS, ERR_INVALID_FRAME, ERR_MAX_OUTBOUND_STREAMS_EXCEEDED, ERR_MUXER_LOCAL_CLOSED, ERR_MUXER_REMOTE_CLOSED, ERR_NOT_MATCHING_PING, ERR_STREAM_ALREADY_EXISTS, ERR_UNREQUESTED_PING, PROTOCOL_ERRORS } from './constants.js';\nimport { Decoder } from './decode.js';\nimport { encodeHeader } from './encode.js';\nimport { Flag, FrameType, GoAwayCode, stringifyHeader } from './frame.js';\nimport { StreamState, YamuxStream } from './stream.js';\nconst YAMUX_PROTOCOL_ID = '/yamux/1.0.0';\nconst CLOSE_TIMEOUT = 500;\nexport class Yamux {\n    protocol = YAMUX_PROTOCOL_ID;\n    _init;\n    constructor(init = {}) {\n        this._init = init;\n    }\n    createStreamMuxer(init) {\n        return new YamuxMuxer({\n            ...this._init,\n            ...init\n        });\n    }\n}\nexport class YamuxMuxer {\n    protocol = YAMUX_PROTOCOL_ID;\n    source;\n    sink;\n    config;\n    log;\n    /** Used to close the muxer from either the sink or source */\n    closeController;\n    /** The next stream id to be used when initiating a new stream */\n    nextStreamID;\n    /** Primary stream mapping, streamID => stream */\n    _streams;\n    /** The next ping id to be used when pinging */\n    nextPingID;\n    /** Tracking info for the currently active ping */\n    activePing;\n    /** Round trip time */\n    rtt;\n    /** True if client, false if server */\n    client;\n    localGoAway;\n    remoteGoAway;\n    /** Number of tracked inbound streams */\n    numInboundStreams;\n    /** Number of tracked outbound streams */\n    numOutboundStreams;\n    onIncomingStream;\n    onStreamEnd;\n    constructor(init) {\n        this.client = init.direction === 'outbound';\n        this.config = { ...defaultConfig, ...init };\n        this.log = this.config.log;\n        verifyConfig(this.config);\n        this.closeController = new AbortController();\n        this.onIncomingStream = init.onIncomingStream;\n        this.onStreamEnd = init.onStreamEnd;\n        this._streams = new Map();\n        this.source = pushable({\n            onEnd: () => {\n                this.log?.trace('muxer source ended');\n                this._streams.forEach(stream => {\n                    stream.destroy();\n                });\n            }\n        });\n        this.sink = async (source) => {\n            source = abortableSource(source, this.closeController.signal, { returnOnAbort: true });\n            let reason, error;\n            try {\n                const decoder = new Decoder(source);\n                await pipe(decoder.emitFrames.bind(decoder), async (source) => {\n                    for await (const { header, readData } of source) {\n                        await this.handleFrame(header, readData);\n                    }\n                });\n                reason = GoAwayCode.NormalTermination;\n            }\n            catch (err) {\n                // either a protocol or internal error\n                const errCode = err.code;\n                if (PROTOCOL_ERRORS.has(errCode)) {\n                    this.log?.error('protocol error in sink', err);\n                    reason = GoAwayCode.ProtocolError;\n                }\n                else {\n                    this.log?.error('internal error in sink', err);\n                    reason = GoAwayCode.InternalError;\n                }\n                error = err;\n            }\n            this.log?.trace('muxer sink ended');\n            if (error != null) {\n                this.abort(error, reason);\n            }\n            else {\n                await this.close({ reason });\n            }\n        };\n        this.numInboundStreams = 0;\n        this.numOutboundStreams = 0;\n        // client uses odd streamIDs, server uses even streamIDs\n        this.nextStreamID = this.client ? 1 : 2;\n        this.nextPingID = 0;\n        this.rtt = 0;\n        this.log?.trace('muxer created');\n        if (this.config.enableKeepAlive) {\n            this.keepAliveLoop().catch(e => this.log?.error('keepalive error: %s', e));\n        }\n    }\n    get streams() {\n        return Array.from(this._streams.values());\n    }\n    newStream(name) {\n        if (this.remoteGoAway !== undefined) {\n            throw new CodeError('muxer closed remotely', ERR_MUXER_REMOTE_CLOSED);\n        }\n        if (this.localGoAway !== undefined) {\n            throw new CodeError('muxer closed locally', ERR_MUXER_LOCAL_CLOSED);\n        }\n        const id = this.nextStreamID;\n        this.nextStreamID += 2;\n        // check against our configured maximum number of outbound streams\n        if (this.numOutboundStreams >= this.config.maxOutboundStreams) {\n            throw new CodeError('max outbound streams exceeded', ERR_MAX_OUTBOUND_STREAMS_EXCEEDED);\n        }\n        this.log?.trace('new outgoing stream id=%s', id);\n        const stream = this._newStream(id, name, StreamState.Init, 'outbound');\n        this._streams.set(id, stream);\n        this.numOutboundStreams++;\n        // send a window update to open the stream on the receiver end\n        stream.sendWindowUpdate();\n        return stream;\n    }\n    /**\n     * Initiate a ping and wait for a response\n     *\n     * Note: only a single ping will be initiated at a time.\n     * If a ping is already in progress, a new ping will not be initiated.\n     *\n     * @returns the round-trip-time in milliseconds\n     */\n    async ping() {\n        if (this.remoteGoAway !== undefined) {\n            throw new CodeError('muxer closed remotely', ERR_MUXER_REMOTE_CLOSED);\n        }\n        if (this.localGoAway !== undefined) {\n            throw new CodeError('muxer closed locally', ERR_MUXER_LOCAL_CLOSED);\n        }\n        // An active ping does not yet exist, handle the process here\n        if (this.activePing === undefined) {\n            // create active ping\n            let _resolve = () => { };\n            this.activePing = {\n                id: this.nextPingID++,\n                // this promise awaits resolution or the close controller aborting\n                promise: new Promise((resolve, reject) => {\n                    const closed = () => {\n                        reject(new CodeError('muxer closed locally', ERR_MUXER_LOCAL_CLOSED));\n                    };\n                    this.closeController.signal.addEventListener('abort', closed, { once: true });\n                    _resolve = () => {\n                        this.closeController.signal.removeEventListener('abort', closed);\n                        resolve();\n                    };\n                }),\n                resolve: _resolve\n            };\n            // send ping\n            const start = Date.now();\n            this.sendPing(this.activePing.id);\n            // await pong\n            try {\n                await this.activePing.promise;\n            }\n            finally {\n                // clean-up active ping\n                delete this.activePing;\n            }\n            // update rtt\n            const end = Date.now();\n            this.rtt = end - start;\n        }\n        else {\n            // an active ping is already in progress, piggyback off that\n            await this.activePing.promise;\n        }\n        return this.rtt;\n    }\n    /**\n     * Get the ping round trip time\n     *\n     * Note: Will return 0 if no successful ping has yet been completed\n     *\n     * @returns the round-trip-time in milliseconds\n     */\n    getRTT() {\n        return this.rtt;\n    }\n    /**\n     * Close the muxer\n     */\n    async close(options = {}) {\n        if (this.closeController.signal.aborted) {\n            // already closed\n            return;\n        }\n        const reason = options?.reason ?? GoAwayCode.NormalTermination;\n        this.log?.trace('muxer close reason=%s', reason);\n        options.signal = options.signal ?? AbortSignal.timeout(CLOSE_TIMEOUT);\n        try {\n            await Promise.all([...this._streams.values()].map(async (s) => s.close(options)));\n            // send reason to the other side, allow the other side to close gracefully\n            this.sendGoAway(reason);\n            this._closeMuxer();\n        }\n        catch (err) {\n            this.abort(err);\n        }\n    }\n    abort(err, reason) {\n        if (this.closeController.signal.aborted) {\n            // already closed\n            return;\n        }\n        reason = reason ?? GoAwayCode.InternalError;\n        // If reason was provided, use that, otherwise use the presence of `err` to determine the reason\n        this.log?.error('muxer abort reason=%s error=%s', reason, err);\n        // Abort all underlying streams\n        for (const stream of this._streams.values()) {\n            stream.abort(err);\n        }\n        // send reason to the other side, allow the other side to close gracefully\n        this.sendGoAway(reason);\n        this._closeMuxer();\n    }\n    isClosed() {\n        return this.closeController.signal.aborted;\n    }\n    /**\n     * Called when either the local or remote shuts down the muxer\n     */\n    _closeMuxer() {\n        // stop the sink and any other processes\n        this.closeController.abort();\n        // stop the source\n        this.source.end();\n    }\n    /** Create a new stream */\n    _newStream(id, name, state, direction) {\n        if (this._streams.get(id) != null) {\n            throw new CodeError('Stream already exists', ERR_STREAM_ALREADY_EXISTS, { id });\n        }\n        const stream = new YamuxStream({\n            id: id.toString(),\n            name,\n            state,\n            direction,\n            sendFrame: this.sendFrame.bind(this),\n            onEnd: () => {\n                this.closeStream(id);\n                this.onStreamEnd?.(stream);\n            },\n            log: logger(`libp2p:yamux:${direction}:${id}`),\n            config: this.config,\n            getRTT: this.getRTT.bind(this)\n        });\n        return stream;\n    }\n    /**\n     * closeStream is used to close a stream once both sides have\n     * issued a close.\n     */\n    closeStream(id) {\n        if (this.client === (id % 2 === 0)) {\n            this.numInboundStreams--;\n        }\n        else {\n            this.numOutboundStreams--;\n        }\n        this._streams.delete(id);\n    }\n    async keepAliveLoop() {\n        const abortPromise = new Promise((_resolve, reject) => { this.closeController.signal.addEventListener('abort', reject, { once: true }); });\n        this.log?.trace('muxer keepalive enabled interval=%s', this.config.keepAliveInterval);\n        while (true) {\n            let timeoutId;\n            try {\n                await Promise.race([\n                    abortPromise,\n                    new Promise((resolve) => {\n                        timeoutId = setTimeout(resolve, this.config.keepAliveInterval);\n                    })\n                ]);\n                this.ping().catch(e => this.log?.error('ping error: %s', e));\n            }\n            catch (e) {\n                // closed\n                clearInterval(timeoutId);\n                return;\n            }\n        }\n    }\n    async handleFrame(header, readData) {\n        const { streamID, type, length } = header;\n        this.log?.trace('received frame %s', stringifyHeader(header));\n        if (streamID === 0) {\n            switch (type) {\n                case FrameType.Ping:\n                    {\n                        this.handlePing(header);\n                        return;\n                    }\n                case FrameType.GoAway:\n                    {\n                        this.handleGoAway(length);\n                        return;\n                    }\n                default:\n                    // Invalid state\n                    throw new CodeError('Invalid frame type', ERR_INVALID_FRAME, { header });\n            }\n        }\n        else {\n            switch (header.type) {\n                case FrameType.Data:\n                case FrameType.WindowUpdate:\n                    {\n                        await this.handleStreamMessage(header, readData);\n                        return;\n                    }\n                default:\n                    // Invalid state\n                    throw new CodeError('Invalid frame type', ERR_INVALID_FRAME, { header });\n            }\n        }\n    }\n    handlePing(header) {\n        // If the ping  is initiated by the sender, send a response\n        if (header.flag === Flag.SYN) {\n            this.log?.trace('received ping request pingId=%s', header.length);\n            this.sendPing(header.length, Flag.ACK);\n        }\n        else if (header.flag === Flag.ACK) {\n            this.log?.trace('received ping response pingId=%s', header.length);\n            this.handlePingResponse(header.length);\n        }\n        else {\n            // Invalid state\n            throw new CodeError('Invalid frame flag', ERR_INVALID_FRAME, { header });\n        }\n    }\n    handlePingResponse(pingId) {\n        if (this.activePing === undefined) {\n            // this ping was not requested\n            throw new CodeError('ping not requested', ERR_UNREQUESTED_PING);\n        }\n        if (this.activePing.id !== pingId) {\n            // this ping doesn't match our active ping request\n            throw new CodeError('ping doesn\\'t match our id', ERR_NOT_MATCHING_PING);\n        }\n        // valid ping response\n        this.activePing.resolve();\n    }\n    handleGoAway(reason) {\n        this.log?.trace('received GoAway reason=%s', GoAwayCode[reason] ?? 'unknown');\n        this.remoteGoAway = reason;\n        // If the other side is friendly, they would have already closed all streams before sending a GoAway\n        // In case they weren't, reset all streams\n        for (const stream of this._streams.values()) {\n            stream.reset();\n        }\n        this._closeMuxer();\n    }\n    async handleStreamMessage(header, readData) {\n        const { streamID, flag, type } = header;\n        if ((flag & Flag.SYN) === Flag.SYN) {\n            this.incomingStream(streamID);\n        }\n        const stream = this._streams.get(streamID);\n        if (stream === undefined) {\n            if (type === FrameType.Data) {\n                this.log?.('discarding data for stream id=%s', streamID);\n                if (readData === undefined) {\n                    throw new Error('unreachable');\n                }\n                await readData();\n            }\n            else {\n                this.log?.('frame for missing stream id=%s', streamID);\n            }\n            return;\n        }\n        switch (type) {\n            case FrameType.WindowUpdate: {\n                stream.handleWindowUpdate(header);\n                return;\n            }\n            case FrameType.Data: {\n                if (readData === undefined) {\n                    throw new Error('unreachable');\n                }\n                await stream.handleData(header, readData);\n                return;\n            }\n            default:\n                throw new Error('unreachable');\n        }\n    }\n    incomingStream(id) {\n        if (this.client !== (id % 2 === 0)) {\n            throw new CodeError('both endpoints are clients', ERR_BOTH_CLIENTS);\n        }\n        if (this._streams.has(id)) {\n            return;\n        }\n        this.log?.trace('new incoming stream id=%s', id);\n        if (this.localGoAway !== undefined) {\n            // reject (reset) immediately if we are doing a go away\n            this.sendFrame({\n                type: FrameType.WindowUpdate,\n                flag: Flag.RST,\n                streamID: id,\n                length: 0\n            });\n            return;\n        }\n        // check against our configured maximum number of inbound streams\n        if (this.numInboundStreams >= this.config.maxInboundStreams) {\n            this.log?.('maxIncomingStreams exceeded, forcing stream reset');\n            this.sendFrame({\n                type: FrameType.WindowUpdate,\n                flag: Flag.RST,\n                streamID: id,\n                length: 0\n            });\n            return;\n        }\n        // allocate a new stream\n        const stream = this._newStream(id, undefined, StreamState.SYNReceived, 'inbound');\n        this.numInboundStreams++;\n        // the stream should now be tracked\n        this._streams.set(id, stream);\n        this.onIncomingStream?.(stream);\n    }\n    sendFrame(header, data) {\n        this.log?.trace('sending frame %s', stringifyHeader(header));\n        if (header.type === FrameType.Data) {\n            if (data === undefined) {\n                throw new CodeError('invalid frame', ERR_INVALID_FRAME);\n            }\n            this.source.push(encodeHeader(header));\n            this.source.push(data);\n        }\n        else {\n            this.source.push(encodeHeader(header));\n        }\n    }\n    sendPing(pingId, flag = Flag.SYN) {\n        if (flag === Flag.SYN) {\n            this.log?.trace('sending ping request pingId=%s', pingId);\n        }\n        else {\n            this.log?.trace('sending ping response pingId=%s', pingId);\n        }\n        this.sendFrame({\n            type: FrameType.Ping,\n            flag,\n            streamID: 0,\n            length: pingId\n        });\n    }\n    sendGoAway(reason = GoAwayCode.NormalTermination) {\n        this.log?.('sending GoAway reason=%s', GoAwayCode[reason]);\n        this.localGoAway = reason;\n        this.sendFrame({\n            type: FrameType.GoAway,\n            flag: 0,\n            streamID: 0,\n            length: reason\n        });\n    }\n}\n//# sourceMappingURL=muxer.js.map","import { Yamux } from './muxer.js';\nexport { GoAwayCode } from './frame.js';\nexport function yamux(init = {}) {\n    return () => new Yamux(init);\n}\n//# sourceMappingURL=index.js.map","import { parseIP } from \"@chainsafe/is-ip/parse\";\nimport { allFF, deepEqual } from \"./util.js\";\nexport const IPv4Len = 4;\nexport const IPv6Len = 16;\nexport const maxIPv6Octet = parseInt(\"0xFFFF\", 16);\nexport const ipv4Prefix = new Uint8Array([\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255,\n]);\nexport function maskIp(ip, mask) {\n    if (mask.length === IPv6Len && ip.length === IPv4Len && allFF(mask, 0, 11)) {\n        mask = mask.slice(12);\n    }\n    if (mask.length === IPv4Len &&\n        ip.length === IPv6Len &&\n        deepEqual(ip, ipv4Prefix, 0, 11)) {\n        ip = ip.slice(12);\n    }\n    const n = ip.length;\n    if (n != mask.length) {\n        throw new Error(\"Failed to mask ip\");\n    }\n    const out = new Uint8Array(n);\n    for (let i = 0; i < n; i++) {\n        out[i] = ip[i] & mask[i];\n    }\n    return out;\n}\nexport function containsIp(net, ip) {\n    if (typeof ip === \"string\") {\n        ip = parseIP(ip);\n    }\n    if (ip == null)\n        throw new Error(\"Invalid ip\");\n    if (ip.length !== net.network.length) {\n        return false;\n    }\n    for (let i = 0; i < ip.length; i++) {\n        if ((net.network[i] & net.mask[i]) !== (ip[i] & net.mask[i])) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function iPv4FromIPv6(ip) {\n    if (!isIPv4mappedIPv6(ip)) {\n        throw new Error(\"Must have 0xffff prefix\");\n    }\n    return ip.slice(12);\n}\nexport function isIPv4mappedIPv6(ip) {\n    return deepEqual(ip, ipv4Prefix, 0, 11);\n}\n//# sourceMappingURL=ip.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction first(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            for await (const entry of source) { // eslint-disable-line no-unreachable-loop\n                return entry;\n            }\n            return undefined;\n        })();\n    }\n    for (const entry of source) { // eslint-disable-line no-unreachable-loop\n        return entry;\n    }\n    return undefined;\n}\nexport default first;\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction batch(source, size = 1) {\n    size = Number(size);\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            let things = [];\n            if (size < 1) {\n                size = 1;\n            }\n            if (size !== Math.round(size)) {\n                throw new Error('Batch size must be an integer');\n            }\n            for await (const thing of source) {\n                things.push(thing);\n                while (things.length >= size) {\n                    yield things.slice(0, size);\n                    things = things.slice(size);\n                }\n            }\n            while (things.length > 0) {\n                yield things.slice(0, size);\n                things = things.slice(size);\n            }\n        }());\n    }\n    return (function* () {\n        let things = [];\n        if (size < 1) {\n            size = 1;\n        }\n        if (size !== Math.round(size)) {\n            throw new Error('Batch size must be an integer');\n        }\n        for (const thing of source) {\n            things.push(thing);\n            while (things.length >= size) {\n                yield things.slice(0, size);\n                things = things.slice(size);\n            }\n        }\n        while (things.length > 0) {\n            yield things.slice(0, size);\n            things = things.slice(size);\n        }\n    }());\n}\nexport default batch;\n//# sourceMappingURL=index.js.map","import batch from 'it-batch';\n/**\n * Takes an (async) iterator that emits promise-returning functions,\n * invokes them in parallel and emits the results as they become available but\n * in the same order as the input\n */\nexport default async function* parallelBatch(source, size = 1) {\n    for await (const tasks of batch(source, size)) {\n        const things = tasks.map(async (p) => {\n            return p().then(value => ({ ok: true, value }), err => ({ ok: false, err }));\n        });\n        for (let i = 0; i < things.length; i++) {\n            const result = await things[i];\n            if (result.ok) {\n                yield result.value;\n            }\n            else {\n                throw result.err;\n            }\n        }\n    }\n}\n//# sourceMappingURL=index.js.map","import { Uint8ArrayList } from 'uint8arraylist';\nconst DEFAULT_CHUNK_SIZE = 262144;\nexport const fixedSize = (options = {}) => {\n    const chunkSize = options.chunkSize ?? DEFAULT_CHUNK_SIZE;\n    return async function* fixedSizeChunker(source) {\n        let list = new Uint8ArrayList();\n        let currentLength = 0;\n        let emitted = false;\n        for await (const buffer of source) {\n            list.append(buffer);\n            currentLength += buffer.length;\n            while (currentLength >= chunkSize) {\n                yield list.slice(0, chunkSize);\n                emitted = true;\n                // throw away consumed bytes\n                if (chunkSize === list.length) {\n                    list = new Uint8ArrayList();\n                    currentLength = 0;\n                }\n                else {\n                    const newBl = new Uint8ArrayList();\n                    newBl.append(list.sublist(chunkSize));\n                    list = newBl;\n                    // update our offset\n                    currentLength -= chunkSize;\n                }\n            }\n        }\n        if (!emitted || currentLength > 0) {\n            // return any remaining bytes\n            yield list.subarray(0, currentLength);\n        }\n    };\n};\n//# sourceMappingURL=fixed-size.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { enumeration, encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var Data;\n(function (Data) {\n    let DataType;\n    (function (DataType) {\n        DataType[\"Raw\"] = \"Raw\";\n        DataType[\"Directory\"] = \"Directory\";\n        DataType[\"File\"] = \"File\";\n        DataType[\"Metadata\"] = \"Metadata\";\n        DataType[\"Symlink\"] = \"Symlink\";\n        DataType[\"HAMTShard\"] = \"HAMTShard\";\n    })(DataType = Data.DataType || (Data.DataType = {}));\n    let __DataTypeValues;\n    (function (__DataTypeValues) {\n        __DataTypeValues[__DataTypeValues[\"Raw\"] = 0] = \"Raw\";\n        __DataTypeValues[__DataTypeValues[\"Directory\"] = 1] = \"Directory\";\n        __DataTypeValues[__DataTypeValues[\"File\"] = 2] = \"File\";\n        __DataTypeValues[__DataTypeValues[\"Metadata\"] = 3] = \"Metadata\";\n        __DataTypeValues[__DataTypeValues[\"Symlink\"] = 4] = \"Symlink\";\n        __DataTypeValues[__DataTypeValues[\"HAMTShard\"] = 5] = \"HAMTShard\";\n    })(__DataTypeValues || (__DataTypeValues = {}));\n    (function (DataType) {\n        DataType.codec = () => {\n            return enumeration(__DataTypeValues);\n        };\n    })(DataType = Data.DataType || (Data.DataType = {}));\n    let _codec;\n    Data.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    Data.DataType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (obj.filesize != null) {\n                    w.uint32(24);\n                    w.uint64(obj.filesize);\n                }\n                if (obj.blocksizes != null) {\n                    for (const value of obj.blocksizes) {\n                        w.uint32(32);\n                        w.uint64(value);\n                    }\n                }\n                if (obj.hashType != null) {\n                    w.uint32(40);\n                    w.uint64(obj.hashType);\n                }\n                if (obj.fanout != null) {\n                    w.uint32(48);\n                    w.uint64(obj.fanout);\n                }\n                if (obj.mode != null) {\n                    w.uint32(56);\n                    w.uint32(obj.mode);\n                }\n                if (obj.mtime != null) {\n                    w.uint32(66);\n                    UnixTime.codec().encode(obj.mtime, w);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {\n                    blocksizes: []\n                };\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = Data.DataType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        case 3:\n                            obj.filesize = reader.uint64();\n                            break;\n                        case 4:\n                            obj.blocksizes.push(reader.uint64());\n                            break;\n                        case 5:\n                            obj.hashType = reader.uint64();\n                            break;\n                        case 6:\n                            obj.fanout = reader.uint64();\n                            break;\n                        case 7:\n                            obj.mode = reader.uint32();\n                            break;\n                        case 8:\n                            obj.mtime = UnixTime.codec().decode(reader, reader.uint32());\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    Data.encode = (obj) => {\n        return encodeMessage(obj, Data.codec());\n    };\n    Data.decode = (buf) => {\n        return decodeMessage(buf, Data.codec());\n    };\n})(Data || (Data = {}));\nexport var UnixTime;\n(function (UnixTime) {\n    let _codec;\n    UnixTime.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Seconds != null) {\n                    w.uint32(8);\n                    w.int64(obj.Seconds);\n                }\n                if (obj.FractionalNanoseconds != null) {\n                    w.uint32(21);\n                    w.fixed32(obj.FractionalNanoseconds);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Seconds = reader.int64();\n                            break;\n                        case 2:\n                            obj.FractionalNanoseconds = reader.fixed32();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    UnixTime.encode = (obj) => {\n        return encodeMessage(obj, UnixTime.codec());\n    };\n    UnixTime.decode = (buf) => {\n        return decodeMessage(buf, UnixTime.codec());\n    };\n})(UnixTime || (UnixTime = {}));\nexport var Metadata;\n(function (Metadata) {\n    let _codec;\n    Metadata.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.MimeType != null) {\n                    w.uint32(10);\n                    w.string(obj.MimeType);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.MimeType = reader.string();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    Metadata.encode = (obj) => {\n        return encodeMessage(obj, Metadata.codec());\n    };\n    Metadata.decode = (buf) => {\n        return decodeMessage(buf, Metadata.codec());\n    };\n})(Metadata || (Metadata = {}));\n//# sourceMappingURL=unixfs.js.map","import errcode from 'err-code';\nimport { Data as PBData } from './unixfs.js';\nconst types = {\n    Raw: 'raw',\n    Directory: 'directory',\n    File: 'file',\n    Metadata: 'metadata',\n    Symlink: 'symlink',\n    HAMTShard: 'hamt-sharded-directory'\n};\nconst dirTypes = [\n    'directory',\n    'hamt-sharded-directory'\n];\nconst DEFAULT_FILE_MODE = parseInt('0644', 8);\nconst DEFAULT_DIRECTORY_MODE = parseInt('0755', 8);\nclass UnixFS {\n    /**\n     * Decode from protobuf https://github.com/ipfs/specs/blob/master/UNIXFS.md\n     */\n    static unmarshal(marshaled) {\n        const message = PBData.decode(marshaled);\n        const data = new UnixFS({\n            type: types[message.Type != null ? message.Type.toString() : 'File'],\n            data: message.Data,\n            blockSizes: message.blocksizes,\n            mode: message.mode,\n            mtime: message.mtime != null\n                ? {\n                    secs: message.mtime.Seconds ?? 0n,\n                    nsecs: message.mtime.FractionalNanoseconds\n                }\n                : undefined,\n            fanout: message.fanout\n        });\n        // make sure we honour the original mode\n        data._originalMode = message.mode ?? 0;\n        return data;\n    }\n    type;\n    data;\n    blockSizes;\n    hashType;\n    fanout;\n    mtime;\n    _mode;\n    _originalMode;\n    constructor(options = {\n        type: 'file'\n    }) {\n        const { type, data, blockSizes, hashType, fanout, mtime, mode } = options;\n        if (type != null && !Object.values(types).includes(type)) {\n            throw errcode(new Error('Type: ' + type + ' is not valid'), 'ERR_INVALID_TYPE');\n        }\n        this.type = type ?? 'file';\n        this.data = data;\n        this.hashType = hashType;\n        this.fanout = fanout;\n        this.blockSizes = blockSizes ?? [];\n        this._originalMode = 0;\n        this.mode = mode;\n        this.mtime = mtime;\n    }\n    set mode(mode) {\n        if (mode == null) {\n            this._mode = this.isDirectory() ? DEFAULT_DIRECTORY_MODE : DEFAULT_FILE_MODE;\n        }\n        else {\n            this._mode = (mode & 0xFFF);\n        }\n    }\n    get mode() {\n        return this._mode;\n    }\n    isDirectory() {\n        return dirTypes.includes(this.type);\n    }\n    addBlockSize(size) {\n        this.blockSizes.push(size);\n    }\n    removeBlockSize(index) {\n        this.blockSizes.splice(index, 1);\n    }\n    /**\n     * Returns `0n` for directories or `data.length + sum(blockSizes)` for everything else\n     */\n    fileSize() {\n        if (this.isDirectory()) {\n            // dirs don't have file size\n            return 0n;\n        }\n        let sum = 0n;\n        this.blockSizes.forEach((size) => {\n            sum += size;\n        });\n        if (this.data != null) {\n            sum += BigInt(this.data.length);\n        }\n        return sum;\n    }\n    /**\n     * encode to protobuf Uint8Array\n     */\n    marshal() {\n        let type;\n        switch (this.type) {\n            case 'raw':\n                type = PBData.DataType.Raw;\n                break;\n            case 'directory':\n                type = PBData.DataType.Directory;\n                break;\n            case 'file':\n                type = PBData.DataType.File;\n                break;\n            case 'metadata':\n                type = PBData.DataType.Metadata;\n                break;\n            case 'symlink':\n                type = PBData.DataType.Symlink;\n                break;\n            case 'hamt-sharded-directory':\n                type = PBData.DataType.HAMTShard;\n                break;\n            default:\n                throw errcode(new Error(`Type: ${type} is not valid`), 'ERR_INVALID_TYPE');\n        }\n        let data = this.data;\n        if (this.data == null || this.data.length === 0) {\n            data = undefined;\n        }\n        let mode;\n        if (this.mode != null) {\n            mode = (this._originalMode & 0xFFFFF000) | (this.mode ?? 0);\n            if (mode === DEFAULT_FILE_MODE && !this.isDirectory()) {\n                mode = undefined;\n            }\n            if (mode === DEFAULT_DIRECTORY_MODE && this.isDirectory()) {\n                mode = undefined;\n            }\n        }\n        let mtime;\n        if (this.mtime != null) {\n            mtime = {\n                Seconds: this.mtime.secs,\n                FractionalNanoseconds: this.mtime.nsecs\n            };\n        }\n        return PBData.encode({\n            Type: type,\n            Data: data,\n            filesize: this.isDirectory() ? undefined : this.fileSize(),\n            blocksizes: this.blockSizes,\n            hashType: this.hashType,\n            fanout: this.fanout,\n            mode,\n            mtime\n        });\n    }\n}\nexport { UnixFS };\n//# sourceMappingURL=index.js.map","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","/* global crypto */\n\nimport { from } from './hasher.js'\n\n/**\n * @param {AlgorithmIdentifier} name\n */\nconst sha = name =>\n  /**\n   * @param {Uint8Array} data\n   */\n  async data => new Uint8Array(await crypto.subtle.digest(name, data))\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n","import * as dagPb from '@ipld/dag-pb';\nimport { CID } from 'multiformats/cid';\nimport { sha256 } from 'multiformats/hashes/sha2';\nexport const persist = async (buffer, blockstore, options) => {\n    if (options.codec == null) {\n        options.codec = dagPb;\n    }\n    const multihash = await sha256.digest(buffer);\n    const cid = CID.create(options.cidVersion, options.codec.code, multihash);\n    await blockstore.put(cid, buffer, options);\n    return cid;\n};\n//# sourceMappingURL=persist.js.map","import * as dagPb from '@ipld/dag-pb';\nimport { UnixFS } from 'ipfs-unixfs';\nimport * as raw from 'multiformats/codecs/raw';\nimport { CustomProgressEvent } from 'progress-events';\nimport { persist } from '../utils/persist.js';\nexport function defaultBufferImporter(options) {\n    return async function* bufferImporter(file, blockstore) {\n        let bytesWritten = 0n;\n        for await (let block of file.content) {\n            yield async () => {\n                let unixfs;\n                const opts = {\n                    codec: dagPb,\n                    cidVersion: options.cidVersion,\n                    onProgress: options.onProgress\n                };\n                if (options.rawLeaves) {\n                    opts.codec = raw;\n                    opts.cidVersion = 1;\n                }\n                else {\n                    unixfs = new UnixFS({\n                        type: options.leafType,\n                        data: block\n                    });\n                    block = dagPb.encode({\n                        Data: unixfs.marshal(),\n                        Links: []\n                    });\n                }\n                const cid = await persist(block, blockstore, opts);\n                bytesWritten += BigInt(block.byteLength);\n                options.onProgress?.(new CustomProgressEvent('unixfs:importer:progress:file:write', {\n                    bytesWritten,\n                    cid,\n                    path: file.path\n                }));\n                return {\n                    cid,\n                    unixfs,\n                    size: BigInt(block.length),\n                    block\n                };\n            };\n        }\n    };\n}\n//# sourceMappingURL=buffer-importer.js.map","import { encode, prepare } from '@ipld/dag-pb';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { persist } from '../utils/persist.js';\nexport const dirBuilder = async (dir, blockstore, options) => {\n    const unixfs = new UnixFS({\n        type: 'directory',\n        mtime: dir.mtime,\n        mode: dir.mode\n    });\n    const block = encode(prepare({ Data: unixfs.marshal() }));\n    const cid = await persist(block, blockstore, options);\n    const path = dir.path;\n    return {\n        cid,\n        path,\n        unixfs,\n        size: BigInt(block.length),\n        originalPath: dir.originalPath,\n        block\n    };\n};\n//# sourceMappingURL=dir.js.map","import { encode, prepare } from '@ipld/dag-pb';\nimport { UnixFS } from 'ipfs-unixfs';\nimport parallelBatch from 'it-parallel-batch';\nimport * as rawCodec from 'multiformats/codecs/raw';\nimport { CustomProgressEvent } from 'progress-events';\nimport { persist } from '../utils/persist.js';\nasync function* buildFileBatch(file, blockstore, options) {\n    let count = -1;\n    let previous;\n    for await (const entry of parallelBatch(options.bufferImporter(file, blockstore), options.blockWriteConcurrency)) {\n        count++;\n        if (count === 0) {\n            // cache the first entry if case there aren't any more\n            previous = {\n                ...entry,\n                single: true\n            };\n            continue;\n        }\n        else if (count === 1 && (previous != null)) {\n            // we have the second block of a multiple block import so yield the first\n            yield {\n                ...previous,\n                block: undefined,\n                single: undefined\n            };\n            previous = undefined;\n        }\n        // yield the second or later block of a multiple block import\n        yield {\n            ...entry,\n            block: undefined\n        };\n    }\n    if (previous != null) {\n        yield previous;\n    }\n}\nfunction isSingleBlockImport(result) {\n    return result.single === true;\n}\nconst reduce = (file, blockstore, options) => {\n    const reducer = async function (leaves) {\n        if (leaves.length === 1 && isSingleBlockImport(leaves[0]) && options.reduceSingleLeafToSelf) {\n            const leaf = leaves[0];\n            let node = leaf.block;\n            if (isSingleBlockImport(leaf) && (file.mtime !== undefined || file.mode !== undefined)) {\n                // only one leaf node which is a raw leaf - we have metadata so convert it into a\n                // UnixFS entry otherwise we'll have nowhere to store the metadata\n                leaf.unixfs = new UnixFS({\n                    type: 'file',\n                    mtime: file.mtime,\n                    mode: file.mode,\n                    data: leaf.block\n                });\n                node = { Data: leaf.unixfs.marshal(), Links: [] };\n                leaf.block = encode(prepare(node));\n                leaf.cid = await persist(leaf.block, blockstore, {\n                    ...options,\n                    cidVersion: options.cidVersion\n                });\n                leaf.size = BigInt(leaf.block.length);\n            }\n            options.onProgress?.(new CustomProgressEvent('unixfs:importer:progress:file:layout', {\n                cid: leaf.cid,\n                path: leaf.originalPath\n            }));\n            return {\n                cid: leaf.cid,\n                path: file.path,\n                unixfs: leaf.unixfs,\n                size: leaf.size,\n                originalPath: leaf.originalPath\n            };\n        }\n        // create a parent node and add all the leaves\n        const f = new UnixFS({\n            type: 'file',\n            mtime: file.mtime,\n            mode: file.mode\n        });\n        const links = leaves\n            .filter(leaf => {\n            if (leaf.cid.code === rawCodec.code && leaf.size > 0) {\n                return true;\n            }\n            if ((leaf.unixfs != null) && (leaf.unixfs.data == null) && leaf.unixfs.fileSize() > 0n) {\n                return true;\n            }\n            return Boolean(leaf.unixfs?.data?.length);\n        })\n            .map((leaf) => {\n            if (leaf.cid.code === rawCodec.code) {\n                // node is a leaf buffer\n                f.addBlockSize(leaf.size);\n                return {\n                    Name: '',\n                    Tsize: Number(leaf.size),\n                    Hash: leaf.cid\n                };\n            }\n            if ((leaf.unixfs == null) || (leaf.unixfs.data == null)) {\n                // node is an intermediate node\n                f.addBlockSize(leaf.unixfs?.fileSize() ?? 0n);\n            }\n            else {\n                // node is a unixfs 'file' leaf node\n                f.addBlockSize(BigInt(leaf.unixfs.data.length));\n            }\n            return {\n                Name: '',\n                Tsize: Number(leaf.size),\n                Hash: leaf.cid\n            };\n        });\n        const node = {\n            Data: f.marshal(),\n            Links: links\n        };\n        const block = encode(prepare(node));\n        const cid = await persist(block, blockstore, options);\n        options.onProgress?.(new CustomProgressEvent('unixfs:importer:progress:file:layout', {\n            cid,\n            path: file.originalPath\n        }));\n        return {\n            cid,\n            path: file.path,\n            unixfs: f,\n            size: BigInt(block.length + node.Links.reduce((acc, curr) => acc + (curr.Tsize ?? 0), 0)),\n            originalPath: file.originalPath,\n            block\n        };\n    };\n    return reducer;\n};\nexport const fileBuilder = async (file, block, options) => {\n    return options.layout(buildFileBatch(file, block, options), reduce(file, block, options));\n};\n//# sourceMappingURL=file.js.map","import errCode from 'err-code';\nimport { CustomProgressEvent } from 'progress-events';\nimport { dirBuilder } from './dir.js';\nimport { fileBuilder } from './file.js';\nfunction isIterable(thing) {\n    return Symbol.iterator in thing;\n}\nfunction isAsyncIterable(thing) {\n    return Symbol.asyncIterator in thing;\n}\nfunction contentAsAsyncIterable(content) {\n    try {\n        if (content instanceof Uint8Array) {\n            return (async function* () {\n                yield content;\n            }());\n        }\n        else if (isIterable(content)) {\n            return (async function* () {\n                yield* content;\n            }());\n        }\n        else if (isAsyncIterable(content)) {\n            return content;\n        }\n    }\n    catch {\n        throw errCode(new Error('Content was invalid'), 'ERR_INVALID_CONTENT');\n    }\n    throw errCode(new Error('Content was invalid'), 'ERR_INVALID_CONTENT');\n}\nexport function defaultDagBuilder(options) {\n    return async function* dagBuilder(source, blockstore) {\n        for await (const entry of source) {\n            let originalPath;\n            if (entry.path != null) {\n                originalPath = entry.path;\n                entry.path = entry.path\n                    .split('/')\n                    .filter(path => path != null && path !== '.')\n                    .join('/');\n            }\n            if (isFileCandidate(entry)) {\n                const file = {\n                    path: entry.path,\n                    mtime: entry.mtime,\n                    mode: entry.mode,\n                    content: (async function* () {\n                        let bytesRead = 0n;\n                        for await (const chunk of options.chunker(options.chunkValidator(contentAsAsyncIterable(entry.content)))) {\n                            const currentChunkSize = BigInt(chunk.byteLength);\n                            bytesRead += currentChunkSize;\n                            options.onProgress?.(new CustomProgressEvent('unixfs:importer:progress:file:read', {\n                                bytesRead,\n                                chunkSize: currentChunkSize,\n                                path: entry.path\n                            }));\n                            yield chunk;\n                        }\n                    })(),\n                    originalPath\n                };\n                yield async () => fileBuilder(file, blockstore, options);\n            }\n            else if (entry.path != null) {\n                const dir = {\n                    path: entry.path,\n                    mtime: entry.mtime,\n                    mode: entry.mode,\n                    originalPath\n                };\n                yield async () => dirBuilder(dir, blockstore, options);\n            }\n            else {\n                throw new Error('Import candidate must have content or path or both');\n            }\n        }\n    };\n}\nfunction isFileCandidate(entry) {\n    return entry.content != null;\n}\n//# sourceMappingURL=index.js.map","import errCode from 'err-code';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nexport const defaultChunkValidator = () => {\n    return async function* validateChunks(source) {\n        for await (const content of source) {\n            if (content.length === undefined) {\n                throw errCode(new Error('Content was invalid'), 'ERR_INVALID_CONTENT');\n            }\n            if (typeof content === 'string' || content instanceof String) {\n                yield uint8ArrayFromString(content.toString());\n            }\n            else if (Array.isArray(content)) {\n                yield Uint8Array.from(content);\n            }\n            else if (content instanceof Uint8Array) {\n                yield content;\n            }\n            else {\n                throw errCode(new Error('Content was invalid'), 'ERR_INVALID_CONTENT');\n            }\n        }\n    };\n};\n//# sourceMappingURL=validate-chunks.js.map","import batch from 'it-batch';\nconst DEFAULT_MAX_CHILDREN_PER_NODE = 174;\nexport function balanced(options) {\n    const maxChildrenPerNode = options?.maxChildrenPerNode ?? DEFAULT_MAX_CHILDREN_PER_NODE;\n    return async function balancedLayout(source, reduce) {\n        const roots = [];\n        for await (const chunked of batch(source, maxChildrenPerNode)) {\n            roots.push(await reduce(chunked));\n        }\n        if (roots.length > 1) {\n            return balancedLayout(roots, reduce);\n        }\n        return roots[0];\n    };\n}\n//# sourceMappingURL=balanced.js.map","import { CID } from 'multiformats/cid';\nexport class Dir {\n    options;\n    root;\n    dir;\n    path;\n    dirty;\n    flat;\n    parent;\n    parentKey;\n    unixfs;\n    mode;\n    mtime;\n    cid;\n    size;\n    nodeSize;\n    constructor(props, options) {\n        this.options = options ?? {};\n        this.root = props.root;\n        this.dir = props.dir;\n        this.path = props.path;\n        this.dirty = props.dirty;\n        this.flat = props.flat;\n        this.parent = props.parent;\n        this.parentKey = props.parentKey;\n        this.unixfs = props.unixfs;\n        this.mode = props.mode;\n        this.mtime = props.mtime;\n    }\n}\n// we use these to calculate the node size to use as a check for whether a directory\n// should be sharded or not. Since CIDs have a constant length and We're only\n// interested in the data length and not the actual content identifier we can use\n// any old CID instead of having to hash the data which is expensive.\nexport const CID_V0 = CID.parse('QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn');\nexport const CID_V1 = CID.parse('zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi');\n//# sourceMappingURL=dir.js.map","import { encode, prepare } from '@ipld/dag-pb';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { Dir, CID_V0, CID_V1 } from './dir.js';\nimport { persist } from './utils/persist.js';\nexport class DirFlat extends Dir {\n    _children;\n    constructor(props, options) {\n        super(props, options);\n        this._children = new Map();\n    }\n    async put(name, value) {\n        this.cid = undefined;\n        this.size = undefined;\n        this.nodeSize = undefined;\n        this._children.set(name, value);\n    }\n    async get(name) {\n        return Promise.resolve(this._children.get(name));\n    }\n    childCount() {\n        return this._children.size;\n    }\n    directChildrenCount() {\n        return this.childCount();\n    }\n    onlyChild() {\n        return this._children.values().next().value;\n    }\n    async *eachChildSeries() {\n        for (const [key, child] of this._children.entries()) {\n            yield {\n                key,\n                child\n            };\n        }\n    }\n    estimateNodeSize() {\n        if (this.nodeSize !== undefined) {\n            return this.nodeSize;\n        }\n        this.nodeSize = 0;\n        // estimate size only based on DAGLink name and CID byte lengths\n        // https://github.com/ipfs/go-unixfsnode/blob/37b47f1f917f1b2f54c207682f38886e49896ef9/data/builder/directory.go#L81-L96\n        for (const [name, child] of this._children.entries()) {\n            if (child.size != null && (child.cid != null)) {\n                this.nodeSize += name.length + (this.options.cidVersion === 1 ? CID_V1.bytes.byteLength : CID_V0.bytes.byteLength);\n            }\n        }\n        return this.nodeSize;\n    }\n    async *flush(block) {\n        const links = [];\n        for (const [name, child] of this._children.entries()) {\n            let result = child;\n            if (child instanceof Dir) {\n                for await (const entry of child.flush(block)) {\n                    result = entry;\n                    yield entry;\n                }\n            }\n            if (result.size != null && (result.cid != null)) {\n                links.push({\n                    Name: name,\n                    Tsize: Number(result.size),\n                    Hash: result.cid\n                });\n            }\n        }\n        const unixfs = new UnixFS({\n            type: 'directory',\n            mtime: this.mtime,\n            mode: this.mode\n        });\n        const node = { Data: unixfs.marshal(), Links: links };\n        const buffer = encode(prepare(node));\n        const cid = await persist(buffer, block, this.options);\n        const size = buffer.length + node.Links.reduce(\n        /**\n         * @param {number} acc\n         * @param {PBLink} curr\n         */\n        (acc, curr) => acc + (curr.Tsize == null ? 0 : curr.Tsize), 0);\n        this.cid = cid;\n        this.size = size;\n        yield {\n            cid,\n            unixfs,\n            path: this.path,\n            size: BigInt(size)\n        };\n    }\n}\n//# sourceMappingURL=dir-flat.js.map","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import * as varint from './varint.js'\nimport * as Digest from './hashes/digest.js'\nimport { base58btc } from './bases/base58.js'\nimport { base32 } from './bases/base32.js'\nimport { coerce } from './bytes.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   *\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","import { from } from 'multiformats/hashes/hasher'\nimport { bytes } from 'multiformats'\n// @ts-expect-error no types\nimport mur from 'murmurhash3js-revisited'\n\n/**\n * @param {number} number\n * @returns {Uint8Array}\n */\nfunction fromNumberTo32BitBuf (number) {\n  const bytes = new Array(4)\n  for (let i = 0; i < 4; i++) {\n    bytes[i] = number & 0xff\n    number = number >> 8\n  }\n  return new Uint8Array(bytes)\n}\n\nexport const murmur332 = from({\n  name: 'murmur3-32',\n  code: 0x23,\n  encode: (input) => fromNumberTo32BitBuf(mur.x86.hash32(input))\n})\n\nexport const murmur3128 = from({\n  name: 'murmur3-128',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input))\n})\n\n// A special-use 0x22 that truncates 64 bits, specifically for use in the UnixFS HAMT\nexport const murmur364 = from({\n  name: 'murmur3-x64-64',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input)).subarray(0, 8)\n})\n","import { encode, prepare } from '@ipld/dag-pb';\nimport { murmur3128 } from '@multiformats/murmur3';\nimport { createHAMT, Bucket } from 'hamt-sharding';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { Dir, CID_V0, CID_V1 } from './dir.js';\nimport { persist } from './utils/persist.js';\nasync function hamtHashFn(buf) {\n    return (await murmur3128.encode(buf))\n        // Murmur3 outputs 128 bit but, accidentally, IPFS Go's\n        // implementation only uses the first 64, so we must do the same\n        // for parity..\n        .slice(0, 8)\n        // Invert buffer because that's how Go impl does it\n        .reverse();\n}\nconst HAMT_HASH_CODE = BigInt(0x22);\nconst DEFAULT_FANOUT_BITS = 8;\nclass DirSharded extends Dir {\n    _bucket;\n    constructor(props, options) {\n        super(props, options);\n        this._bucket = createHAMT({\n            hashFn: hamtHashFn,\n            bits: options.shardFanoutBits ?? DEFAULT_FANOUT_BITS\n        });\n    }\n    async put(name, value) {\n        this.cid = undefined;\n        this.size = undefined;\n        this.nodeSize = undefined;\n        await this._bucket.put(name, value);\n    }\n    async get(name) {\n        return this._bucket.get(name);\n    }\n    childCount() {\n        return this._bucket.leafCount();\n    }\n    directChildrenCount() {\n        return this._bucket.childrenCount();\n    }\n    onlyChild() {\n        return this._bucket.onlyChild();\n    }\n    async *eachChildSeries() {\n        for await (const { key, value } of this._bucket.eachLeafSeries()) {\n            yield {\n                key,\n                child: value\n            };\n        }\n    }\n    estimateNodeSize() {\n        if (this.nodeSize !== undefined) {\n            return this.nodeSize;\n        }\n        this.nodeSize = calculateSize(this._bucket, this, this.options);\n        return this.nodeSize;\n    }\n    async *flush(blockstore) {\n        for await (const entry of flush(this._bucket, blockstore, this, this.options)) {\n            yield {\n                ...entry,\n                path: this.path\n            };\n        }\n    }\n}\nexport default DirSharded;\nasync function* flush(bucket, blockstore, shardRoot, options) {\n    const children = bucket._children;\n    const padLength = (bucket.tableSize() - 1).toString(16).length;\n    const links = [];\n    let childrenSize = 0n;\n    for (let i = 0; i < children.length; i++) {\n        const child = children.get(i);\n        if (child == null) {\n            continue;\n        }\n        const labelPrefix = i.toString(16).toUpperCase().padStart(padLength, '0');\n        if (child instanceof Bucket) {\n            let shard;\n            for await (const subShard of flush(child, blockstore, null, options)) {\n                shard = subShard;\n            }\n            if (shard == null) {\n                throw new Error('Could not flush sharded directory, no subshard found');\n            }\n            links.push({\n                Name: labelPrefix,\n                Tsize: Number(shard.size),\n                Hash: shard.cid\n            });\n            childrenSize += shard.size;\n        }\n        else if (isDir(child.value)) {\n            const dir = child.value;\n            let flushedDir;\n            for await (const entry of dir.flush(blockstore)) {\n                flushedDir = entry;\n                yield flushedDir;\n            }\n            if (flushedDir == null) {\n                throw new Error('Did not flush dir');\n            }\n            const label = labelPrefix + child.key;\n            links.push({\n                Name: label,\n                Tsize: Number(flushedDir.size),\n                Hash: flushedDir.cid\n            });\n            childrenSize += flushedDir.size;\n        }\n        else {\n            const value = child.value;\n            if (value.cid == null) {\n                continue;\n            }\n            const label = labelPrefix + child.key;\n            const size = value.size;\n            links.push({\n                Name: label,\n                Tsize: Number(size),\n                Hash: value.cid\n            });\n            childrenSize += BigInt(size ?? 0);\n        }\n    }\n    // go-ipfs uses little endian, that's why we have to\n    // reverse the bit field before storing it\n    const data = Uint8Array.from(children.bitField().reverse());\n    const dir = new UnixFS({\n        type: 'hamt-sharded-directory',\n        data,\n        fanout: BigInt(bucket.tableSize()),\n        hashType: HAMT_HASH_CODE,\n        mtime: shardRoot?.mtime,\n        mode: shardRoot?.mode\n    });\n    const node = {\n        Data: dir.marshal(),\n        Links: links\n    };\n    const buffer = encode(prepare(node));\n    const cid = await persist(buffer, blockstore, options);\n    const size = BigInt(buffer.byteLength) + childrenSize;\n    yield {\n        cid,\n        unixfs: dir,\n        size\n    };\n}\nfunction isDir(obj) {\n    return typeof obj.flush === 'function';\n}\nfunction calculateSize(bucket, shardRoot, options) {\n    const children = bucket._children;\n    const padLength = (bucket.tableSize() - 1).toString(16).length;\n    const links = [];\n    for (let i = 0; i < children.length; i++) {\n        const child = children.get(i);\n        if (child == null) {\n            continue;\n        }\n        const labelPrefix = i.toString(16).toUpperCase().padStart(padLength, '0');\n        if (child instanceof Bucket) {\n            const size = calculateSize(child, null, options);\n            links.push({\n                Name: labelPrefix,\n                Tsize: Number(size),\n                Hash: options.cidVersion === 0 ? CID_V0 : CID_V1\n            });\n        }\n        else if (typeof child.value.flush === 'function') {\n            const dir = child.value;\n            const size = dir.nodeSize();\n            links.push({\n                Name: labelPrefix + child.key,\n                Tsize: Number(size),\n                Hash: options.cidVersion === 0 ? CID_V0 : CID_V1\n            });\n        }\n        else {\n            const value = child.value;\n            if (value.cid == null) {\n                continue;\n            }\n            const label = labelPrefix + child.key;\n            const size = value.size;\n            links.push({\n                Name: label,\n                Tsize: Number(size),\n                Hash: value.cid\n            });\n        }\n    }\n    // go-ipfs uses little endian, that's why we have to\n    // reverse the bit field before storing it\n    const data = Uint8Array.from(children.bitField().reverse());\n    const dir = new UnixFS({\n        type: 'hamt-sharded-directory',\n        data,\n        fanout: BigInt(bucket.tableSize()),\n        hashType: HAMT_HASH_CODE,\n        mtime: shardRoot?.mtime,\n        mode: shardRoot?.mode\n    });\n    const buffer = encode(prepare({\n        Data: dir.marshal(),\n        Links: links\n    }));\n    return buffer.length;\n}\n//# sourceMappingURL=dir-sharded.js.map","import { DirFlat } from './dir-flat.js';\nimport DirSharded, {} from './dir-sharded.js';\nexport async function flatToShard(child, dir, threshold, options) {\n    let newDir = dir;\n    if (dir instanceof DirFlat && dir.estimateNodeSize() > threshold) {\n        newDir = await convertToShard(dir, options);\n    }\n    const parent = newDir.parent;\n    if (parent != null) {\n        if (newDir !== dir) {\n            if (child != null) {\n                child.parent = newDir;\n            }\n            if (newDir.parentKey == null) {\n                throw new Error('No parent key found');\n            }\n            await parent.put(newDir.parentKey, newDir);\n        }\n        return flatToShard(newDir, parent, threshold, options);\n    }\n    return newDir;\n}\nasync function convertToShard(oldDir, options) {\n    const newDir = new DirSharded({\n        root: oldDir.root,\n        dir: true,\n        parent: oldDir.parent,\n        parentKey: oldDir.parentKey,\n        path: oldDir.path,\n        dirty: oldDir.dirty,\n        flat: false,\n        mtime: oldDir.mtime,\n        mode: oldDir.mode\n    }, options);\n    for await (const { key, child } of oldDir.eachChildSeries()) {\n        await newDir.put(key, child);\n    }\n    return newDir;\n}\n//# sourceMappingURL=flat-to-shard.js.map","export const toPathComponents = (path = '') => {\n    // split on / unless escaped with \\\n    return path.split(/(?<!\\\\)\\//).filter(Boolean);\n};\n//# sourceMappingURL=to-path-components.js.map","import { DirFlat } from './dir-flat.js';\nimport { Dir } from './dir.js';\nimport { flatToShard } from './flat-to-shard.js';\nimport { toPathComponents } from './utils/to-path-components.js';\nasync function addToTree(elem, tree, options) {\n    const pathElems = toPathComponents(elem.path ?? '');\n    const lastIndex = pathElems.length - 1;\n    let parent = tree;\n    let currentPath = '';\n    for (let i = 0; i < pathElems.length; i++) {\n        const pathElem = pathElems[i];\n        currentPath += `${currentPath !== '' ? '/' : ''}${pathElem}`;\n        const last = (i === lastIndex);\n        parent.dirty = true;\n        parent.cid = undefined;\n        parent.size = undefined;\n        if (last) {\n            await parent.put(pathElem, elem);\n            tree = await flatToShard(null, parent, options.shardSplitThresholdBytes, options);\n        }\n        else {\n            let dir = await parent.get(pathElem);\n            if ((dir == null) || !(dir instanceof Dir)) {\n                dir = new DirFlat({\n                    root: false,\n                    dir: true,\n                    parent,\n                    parentKey: pathElem,\n                    path: currentPath,\n                    dirty: true,\n                    flat: true,\n                    mtime: dir?.unixfs?.mtime,\n                    mode: dir?.unixfs?.mode\n                }, options);\n            }\n            await parent.put(pathElem, dir);\n            parent = dir;\n        }\n    }\n    return tree;\n}\nasync function* flushAndYield(tree, blockstore) {\n    if (!(tree instanceof Dir)) {\n        if (tree.unixfs?.isDirectory() === true) {\n            yield tree;\n        }\n        return;\n    }\n    yield* tree.flush(blockstore);\n}\nexport function defaultTreeBuilder(options) {\n    return async function* treeBuilder(source, block) {\n        let tree = new DirFlat({\n            root: true,\n            dir: true,\n            path: '',\n            dirty: true,\n            flat: true\n        }, options);\n        let rootDir;\n        let singleRoot = false;\n        for await (const entry of source) {\n            if (entry == null) {\n                continue;\n            }\n            // if all paths are from the same root directory, we should\n            // wrap them all in that root directory\n            const dir = `${entry.originalPath ?? ''}`.split('/')[0];\n            if (dir != null && dir !== '') {\n                if (rootDir == null) {\n                    rootDir = dir;\n                    singleRoot = true;\n                }\n                else if (rootDir !== dir) {\n                    singleRoot = false;\n                }\n            }\n            tree = await addToTree(entry, tree, options);\n            if (entry.unixfs == null || !entry.unixfs.isDirectory()) {\n                yield entry;\n            }\n        }\n        if (options.wrapWithDirectory || (singleRoot && tree.childCount() > 1)) {\n            yield* flushAndYield(tree, block);\n        }\n        else {\n            for await (const unwrapped of tree.eachChildSeries()) {\n                if (unwrapped == null) {\n                    continue;\n                }\n                yield* flushAndYield(unwrapped.child, block);\n            }\n        }\n    };\n}\n//# sourceMappingURL=tree-builder.js.map","import errcode from 'err-code';\nimport first from 'it-first';\nimport parallelBatch from 'it-parallel-batch';\nimport { fixedSize } from './chunker/fixed-size.js';\nimport { defaultBufferImporter } from './dag-builder/buffer-importer.js';\nimport { defaultDagBuilder } from './dag-builder/index.js';\nimport { defaultChunkValidator } from './dag-builder/validate-chunks.js';\nimport { balanced } from './layout/index.js';\nimport { defaultTreeBuilder } from './tree-builder.js';\n/**\n * The importer creates UnixFS DAGs and stores the blocks that make\n * them up in the passed blockstore.\n *\n * @example\n *\n * ```typescript\n * import { importer } from 'ipfs-unixfs-importer'\n * import { MemoryBlockstore } from 'blockstore-core'\n *\n * // store blocks in memory, other blockstores are available\n * const blockstore = new MemoryBlockstore()\n *\n * const input = [{\n *   path: './foo.txt',\n *   content: Uint8Array.from([0, 1, 2, 3, 4])\n * }, {\n *   path: './bar.txt',\n *   content: Uint8Array.from([0, 1, 2, 3, 4])\n * }]\n *\n * for await (const entry of importer(input, blockstore)) {\n *   console.info(entry)\n *   // { cid: CID(), ... }\n * }\n * ```\n */\nexport async function* importer(source, blockstore, options = {}) {\n    let candidates;\n    if (Symbol.asyncIterator in source || Symbol.iterator in source) {\n        candidates = source;\n    }\n    else {\n        candidates = [source];\n    }\n    const wrapWithDirectory = options.wrapWithDirectory ?? false;\n    const shardSplitThresholdBytes = options.shardSplitThresholdBytes ?? 262144;\n    const shardFanoutBits = options.shardFanoutBits ?? 8;\n    const cidVersion = options.cidVersion ?? 1;\n    const rawLeaves = options.rawLeaves ?? true;\n    const leafType = options.leafType ?? 'file';\n    const fileImportConcurrency = options.fileImportConcurrency ?? 50;\n    const blockWriteConcurrency = options.blockWriteConcurrency ?? 10;\n    const reduceSingleLeafToSelf = options.reduceSingleLeafToSelf ?? true;\n    const chunker = options.chunker ?? fixedSize();\n    const chunkValidator = options.chunkValidator ?? defaultChunkValidator();\n    const buildDag = options.dagBuilder ?? defaultDagBuilder({\n        chunker,\n        chunkValidator,\n        wrapWithDirectory,\n        layout: options.layout ?? balanced(),\n        bufferImporter: options.bufferImporter ?? defaultBufferImporter({\n            cidVersion,\n            rawLeaves,\n            leafType,\n            onProgress: options.onProgress\n        }),\n        blockWriteConcurrency,\n        reduceSingleLeafToSelf,\n        cidVersion,\n        onProgress: options.onProgress\n    });\n    const buildTree = options.treeBuilder ?? defaultTreeBuilder({\n        wrapWithDirectory,\n        shardSplitThresholdBytes,\n        shardFanoutBits,\n        cidVersion,\n        onProgress: options.onProgress\n    });\n    for await (const entry of buildTree(parallelBatch(buildDag(candidates, blockstore), fileImportConcurrency), blockstore)) {\n        yield {\n            cid: entry.cid,\n            path: entry.path,\n            unixfs: entry.unixfs,\n            size: entry.size\n        };\n    }\n}\n/**\n * `importFile` is similar to `importer` except it accepts a single\n * `FileCandidate` and returns a promise of a single `ImportResult`\n * instead of a stream of results.\n *\n * @example\n *\n * ```typescript\n * import { importFile } from 'ipfs-unixfs-importer'\n * import { MemoryBlockstore } from 'blockstore-core'\n *\n * // store blocks in memory, other blockstores are available\n * const blockstore = new MemoryBlockstore()\n *\n * const input: FileCandidate = {\n *   path: './foo.txt',\n *   content: Uint8Array.from([0, 1, 2, 3, 4])\n * }\n *\n * const entry = await importFile(input, blockstore)\n * ```\n */\nexport async function importFile(content, blockstore, options = {}) {\n    const result = await first(importer([content], blockstore, options));\n    if (result == null) {\n        throw errcode(new Error('Nothing imported'), 'ERR_INVALID_PARAMS');\n    }\n    return result;\n}\n/**\n * `importDir` is similar to `importer` except it accepts a single\n * `DirectoryCandidate` and returns a promise of a single `ImportResult`\n * instead of a stream of results.\n *\n * @example\n *\n * ```typescript\n * import { importDirectory } from 'ipfs-unixfs-importer'\n * import { MemoryBlockstore } from 'blockstore-core'\n *\n * // store blocks in memory, other blockstores are available\n * const blockstore = new MemoryBlockstore()\n *\n * const input: DirectoryCandidate = {\n *   path: './foo.txt'\n * }\n *\n * const entry = await importDirectory(input, blockstore)\n * ```\n */\nexport async function importDirectory(content, blockstore, options = {}) {\n    const result = await first(importer([content], blockstore, options));\n    if (result == null) {\n        throw errcode(new Error('Nothing imported'), 'ERR_INVALID_PARAMS');\n    }\n    return result;\n}\n/**\n * `importBytes` accepts a single Uint8Array and returns a promise\n * of a single `ImportResult`.\n *\n * @example\n *\n * ```typescript\n * import { importBytes } from 'ipfs-unixfs-importer'\n * import { MemoryBlockstore } from 'blockstore-core'\n *\n * // store blocks in memory, other blockstores are available\n * const blockstore = new MemoryBlockstore()\n *\n * const input = Uint8Array.from([0, 1, 2, 3, 4])\n *\n * const entry = await importBytes(input, blockstore)\n * ```\n */\nexport async function importBytes(buf, blockstore, options = {}) {\n    return importFile({\n        content: buf\n    }, blockstore, options);\n}\n/**\n * `importByteStream` accepts a single stream of Uint8Arrays and\n * returns a promise of a single `ImportResult`.\n *\n * @example\n *\n * ```typescript\n * import { importByteStream } from 'ipfs-unixfs-importer'\n * import { MemoryBlockstore } from 'blockstore-core'\n *\n * // store blocks in memory, other blockstores are available\n * const blockstore = new MemoryBlockstore()\n *\n * const input = [\n *   Uint8Array.from([0, 1, 2, 3, 4]),\n *   Uint8Array.from([5, 6, 7, 8, 9])\n * ]\n *\n * const entry = await importByteStream(input, blockstore)\n * ```\n */\nexport async function importByteStream(bufs, blockstore, options = {}) {\n    return importFile({\n        content: bufs\n    }, blockstore, options);\n}\n//# sourceMappingURL=index.js.map","import errcode from 'err-code';\n// @ts-expect-error no types\nimport { create } from 'rabin-wasm';\nimport { Uint8ArrayList } from 'uint8arraylist';\nconst DEFAULT_MIN_CHUNK_SIZE = 262144;\nconst DEFAULT_MAX_CHUNK_SIZE = 262144;\nconst DEFAULT_AVG_CHUNK_SIZE = 262144;\nconst DEFAULT_WINDOW = 16;\nasync function* chunker(source, r) {\n    const buffers = new Uint8ArrayList();\n    for await (const chunk of source) {\n        buffers.append(chunk);\n        const sizes = r.fingerprint(chunk);\n        for (let i = 0; i < sizes.length; i++) {\n            const size = sizes[i];\n            const buf = buffers.slice(0, size);\n            buffers.consume(size);\n            yield buf;\n        }\n    }\n    if (buffers.length > 0) {\n        yield buffers.subarray(0);\n    }\n}\nexport const rabin = (options = {}) => {\n    let min = options.minChunkSize ?? DEFAULT_MIN_CHUNK_SIZE;\n    let max = options.maxChunkSize ?? DEFAULT_MAX_CHUNK_SIZE;\n    let avg = options.avgChunkSize ?? DEFAULT_AVG_CHUNK_SIZE;\n    const window = options.window ?? DEFAULT_WINDOW;\n    // if only avg was passed, calculate min/max from that\n    if (options.avgChunkSize != null && options.minChunkSize == null && options.maxChunkSize == null) {\n        min = avg / 3;\n        max = avg + (avg / 2);\n    }\n    const isInvalidChunkSizes = [min, avg, max].some((size) => size == null || isNaN(size));\n    if (isInvalidChunkSizes) {\n        if (options.avgChunkSize != null) {\n            throw errcode(new Error('please specify a valid average chunk size number'), 'ERR_INVALID_AVG_CHUNK_SIZE');\n        }\n        throw errcode(new Error('please specify valid numbers for (min|max|avg)ChunkSize'), 'ERR_INVALID_CHUNK_SIZE');\n    }\n    // validate min/max/avg in the same way as go\n    if (min < 16) {\n        throw errcode(new Error('rabin min must be greater than 16'), 'ERR_INVALID_MIN_CHUNK_SIZE');\n    }\n    if (max < min) {\n        max = min;\n    }\n    if (avg < min) {\n        avg = min;\n    }\n    const sizepow = Math.floor(Math.log2(avg));\n    return async function* rabinChunker(source) {\n        const r = await create(sizepow, min, max, window);\n        for await (const chunk of chunker(source, r)) {\n            yield chunk;\n        }\n    };\n};\n//# sourceMappingURL=rabin.js.map","import { importBytes, importByteStream, importDirectory, importer, importFile } from 'ipfs-unixfs-importer';\nimport { fixedSize } from 'ipfs-unixfs-importer/chunker';\nimport { balanced } from 'ipfs-unixfs-importer/layout';\n/**\n * Default importer settings match Filecoin\n */\nconst defaultImporterSettings = {\n    cidVersion: 1,\n    rawLeaves: true,\n    layout: balanced({\n        maxChildrenPerNode: 1024\n    }),\n    chunker: fixedSize({\n        chunkSize: 1048576\n    })\n};\nexport async function* addAll(source, blockstore, options = {}) {\n    yield* importer(source, blockstore, {\n        ...defaultImporterSettings,\n        ...options\n    });\n}\nexport async function addBytes(bytes, blockstore, options = {}) {\n    const { cid } = await importBytes(bytes, blockstore, {\n        ...defaultImporterSettings,\n        ...options\n    });\n    return cid;\n}\nexport async function addByteStream(bytes, blockstore, options = {}) {\n    const { cid } = await importByteStream(bytes, blockstore, {\n        ...defaultImporterSettings,\n        ...options\n    });\n    return cid;\n}\nexport async function addFile(file, blockstore, options = {}) {\n    const { cid } = await importFile(file, blockstore, {\n        ...defaultImporterSettings,\n        ...options\n    });\n    return cid;\n}\nexport async function addDirectory(dir, blockstore, options = {}) {\n    const { cid } = await importDirectory({\n        ...dir,\n        path: dir.path ?? '-'\n    }, blockstore, {\n        ...defaultImporterSettings,\n        ...options\n    });\n    return cid;\n}\n//# sourceMappingURL=add.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction last(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            let res;\n            for await (const entry of source) {\n                res = entry;\n            }\n            return res;\n        })();\n    }\n    let res;\n    for (const entry of source) {\n        res = entry;\n    }\n    return res;\n}\nexport default last;\n//# sourceMappingURL=index.js.map","import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code = 0x0\nconst name = 'identity'\n\n/** @type {(input:Uint8Array) => Uint8Array} */\nconst encode = coerce\n\n/**\n * @param {Uint8Array} input\n * @returns {Digest.Digest<typeof code, number>}\n */\nconst digest = (input) => Digest.create(code, encode(input))\n\nexport const identity = { code, name, encode, digest }\n","import * as dagCbor from '@ipld/dag-cbor';\nimport errCode from 'err-code';\nimport { CID } from 'multiformats/cid';\nconst resolve = async (cid, name, path, toResolve, resolve, depth, blockstore, options) => {\n    const block = await blockstore.get(cid, options);\n    const object = dagCbor.decode(block);\n    let subObject = object;\n    let subPath = path;\n    while (toResolve.length > 0) {\n        const prop = toResolve[0];\n        if (prop in subObject) {\n            // remove the bit of the path we have resolved\n            toResolve.shift();\n            subPath = `${subPath}/${prop}`;\n            const subObjectCid = CID.asCID(subObject[prop]);\n            if (subObjectCid != null) {\n                return {\n                    entry: {\n                        type: 'object',\n                        name,\n                        path,\n                        cid,\n                        node: block,\n                        depth,\n                        size: BigInt(block.length),\n                        content: async function* () {\n                            yield object;\n                        }\n                    },\n                    next: {\n                        cid: subObjectCid,\n                        name: prop,\n                        path: subPath,\n                        toResolve\n                    }\n                };\n            }\n            subObject = subObject[prop];\n        }\n        else {\n            // cannot resolve further\n            throw errCode(new Error(`No property named ${prop} found in cbor node ${cid}`), 'ERR_NO_PROP');\n        }\n    }\n    return {\n        entry: {\n            type: 'object',\n            name,\n            path,\n            cid,\n            node: block,\n            depth,\n            size: BigInt(block.length),\n            content: async function* () {\n                yield object;\n            }\n        }\n    };\n};\nexport default resolve;\n//# sourceMappingURL=dag-cbor.js.map","function extractDataFromBlock(block, blockStart, requestedStart, requestedEnd) {\n    const blockLength = BigInt(block.length);\n    const blockEnd = BigInt(blockStart + blockLength);\n    if (requestedStart >= blockEnd || requestedEnd < blockStart) {\n        // If we are looking for a byte range that is starts after the start of the block,\n        // return an empty block.  This can happen when internal nodes contain data\n        return new Uint8Array(0);\n    }\n    if (requestedEnd >= blockStart && requestedEnd < blockEnd) {\n        // If the end byte is in the current block, truncate the block to the end byte\n        block = block.subarray(0, Number(requestedEnd - blockStart));\n    }\n    if (requestedStart >= blockStart && requestedStart < blockEnd) {\n        // If the start byte is in the current block, skip to the start byte\n        block = block.subarray(Number(requestedStart - blockStart));\n    }\n    return block;\n}\nexport default extractDataFromBlock;\n//# sourceMappingURL=extract-data-from-block.js.map","import errCode from 'err-code';\nconst validateOffsetAndLength = (size, offset = 0, length = size) => {\n    const fileSize = BigInt(size);\n    const start = BigInt(offset ?? 0);\n    let end = BigInt(length);\n    if (end !== fileSize) {\n        end = start + end;\n    }\n    if (end > fileSize) {\n        end = fileSize;\n    }\n    if (start < 0n) {\n        throw errCode(new Error('Offset must be greater than or equal to 0'), 'ERR_INVALID_PARAMS');\n    }\n    if (start > fileSize) {\n        throw errCode(new Error('Offset must be less than the file size'), 'ERR_INVALID_PARAMS');\n    }\n    if (end < 0n) {\n        throw errCode(new Error('Length must be greater than or equal to 0'), 'ERR_INVALID_PARAMS');\n    }\n    if (end > fileSize) {\n        throw errCode(new Error('Length must be less than the file size'), 'ERR_INVALID_PARAMS');\n    }\n    return {\n        start,\n        end\n    };\n};\nexport default validateOffsetAndLength;\n//# sourceMappingURL=validate-offset-and-length.js.map","import errCode from 'err-code';\nimport * as mh from 'multiformats/hashes/digest';\nimport { CustomProgressEvent } from 'progress-events';\nimport extractDataFromBlock from '../utils/extract-data-from-block.js';\nimport validateOffsetAndLength from '../utils/validate-offset-and-length.js';\nconst rawContent = (node) => {\n    async function* contentGenerator(options = {}) {\n        const { start, end } = validateOffsetAndLength(node.length, options.offset, options.length);\n        const buf = extractDataFromBlock(node, 0n, start, end);\n        options.onProgress?.(new CustomProgressEvent('unixfs:exporter:progress:identity', {\n            bytesRead: BigInt(buf.byteLength),\n            totalBytes: end - start,\n            fileSize: BigInt(node.byteLength)\n        }));\n        yield buf;\n    }\n    return contentGenerator;\n};\nconst resolve = async (cid, name, path, toResolve, resolve, depth, blockstore, options) => {\n    if (toResolve.length > 0) {\n        throw errCode(new Error(`No link named ${path} found in raw node ${cid}`), 'ERR_NOT_FOUND');\n    }\n    const buf = mh.decode(cid.multihash.bytes);\n    return {\n        entry: {\n            type: 'identity',\n            name,\n            path,\n            cid,\n            content: rawContent(buf.digest),\n            depth,\n            size: BigInt(buf.digest.length),\n            node: buf.digest\n        }\n    };\n};\nexport default resolve;\n//# sourceMappingURL=identity.js.map","import errCode from 'err-code';\nimport { CustomProgressEvent } from 'progress-events';\nimport extractDataFromBlock from '../utils/extract-data-from-block.js';\nimport validateOffsetAndLength from '../utils/validate-offset-and-length.js';\nconst rawContent = (node) => {\n    async function* contentGenerator(options = {}) {\n        const { start, end } = validateOffsetAndLength(node.length, options.offset, options.length);\n        const buf = extractDataFromBlock(node, 0n, start, end);\n        options.onProgress?.(new CustomProgressEvent('unixfs:exporter:progress:raw', {\n            bytesRead: BigInt(buf.byteLength),\n            totalBytes: end - start,\n            fileSize: BigInt(node.byteLength)\n        }));\n        yield buf;\n    }\n    return contentGenerator;\n};\nconst resolve = async (cid, name, path, toResolve, resolve, depth, blockstore, options) => {\n    if (toResolve.length > 0) {\n        throw errCode(new Error(`No link named ${path} found in raw node ${cid}`), 'ERR_NOT_FOUND');\n    }\n    const block = await blockstore.get(cid, options);\n    return {\n        entry: {\n            type: 'raw',\n            name,\n            path,\n            cid,\n            content: rawContent(block),\n            depth,\n            size: BigInt(block.length),\n            node: block\n        }\n    };\n};\nexport default resolve;\n//# sourceMappingURL=raw.js.map","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import * as varint from './varint.js'\nimport * as Digest from './hashes/digest.js'\nimport { base58btc } from './bases/base58.js'\nimport { base32 } from './bases/base32.js'\nimport { coerce } from './bytes.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   *\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","import { from } from 'multiformats/hashes/hasher'\nimport { bytes } from 'multiformats'\n// @ts-expect-error no types\nimport mur from 'murmurhash3js-revisited'\n\n/**\n * @param {number} number\n * @returns {Uint8Array}\n */\nfunction fromNumberTo32BitBuf (number) {\n  const bytes = new Array(4)\n  for (let i = 0; i < 4; i++) {\n    bytes[i] = number & 0xff\n    number = number >> 8\n  }\n  return new Uint8Array(bytes)\n}\n\nexport const murmur332 = from({\n  name: 'murmur3-32',\n  code: 0x23,\n  encode: (input) => fromNumberTo32BitBuf(mur.x86.hash32(input))\n})\n\nexport const murmur3128 = from({\n  name: 'murmur3-128',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input))\n})\n\n// A special-use 0x22 that truncates 64 bits, specifically for use in the UnixFS HAMT\nexport const murmur364 = from({\n  name: 'murmur3-x64-64',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input)).subarray(0, 8)\n})\n","import { decode } from '@ipld/dag-pb';\nimport { murmur3128 } from '@multiformats/murmur3';\nimport errCode from 'err-code';\nimport { Bucket, createHAMT } from 'hamt-sharding';\nimport { UnixFS } from 'ipfs-unixfs';\n// FIXME: this is copy/pasted from ipfs-unixfs-importer/src/options.js\nconst hashFn = async function (buf) {\n    return (await murmur3128.encode(buf))\n        // Murmur3 outputs 128 bit but, accidentally, IPFS Go's\n        // implementation only uses the first 64, so we must do the same\n        // for parity..\n        .slice(0, 8)\n        // Invert buffer because that's how Go impl does it\n        .reverse();\n};\nconst addLinksToHamtBucket = async (links, bucket, rootBucket) => {\n    const padLength = (bucket.tableSize() - 1).toString(16).length;\n    await Promise.all(links.map(async (link) => {\n        if (link.Name == null) {\n            // TODO(@rvagg): what do? this is technically possible\n            throw new Error('Unexpected Link without a Name');\n        }\n        if (link.Name.length === padLength) {\n            const pos = parseInt(link.Name, 16);\n            bucket._putObjectAt(pos, new Bucket({\n                hash: rootBucket._options.hash,\n                bits: rootBucket._options.bits\n            }, bucket, pos));\n            return;\n        }\n        await rootBucket.put(link.Name.substring(2), true);\n    }));\n};\nconst toPrefix = (position, padLength) => {\n    return position\n        .toString(16)\n        .toUpperCase()\n        .padStart(padLength, '0')\n        .substring(0, padLength);\n};\nconst toBucketPath = (position) => {\n    let bucket = position.bucket;\n    const path = [];\n    while (bucket._parent != null) {\n        path.push(bucket);\n        bucket = bucket._parent;\n    }\n    path.push(bucket);\n    return path.reverse();\n};\nconst findShardCid = async (node, name, blockstore, context, options) => {\n    if (context == null) {\n        if (node.Data == null) {\n            throw errCode(new Error('no data in PBNode'), 'ERR_NOT_UNIXFS');\n        }\n        let dir;\n        try {\n            dir = UnixFS.unmarshal(node.Data);\n        }\n        catch (err) {\n            throw errCode(err, 'ERR_NOT_UNIXFS');\n        }\n        if (dir.type !== 'hamt-sharded-directory') {\n            throw errCode(new Error('not a HAMT'), 'ERR_NOT_UNIXFS');\n        }\n        if (dir.fanout == null) {\n            throw errCode(new Error('missing fanout'), 'ERR_NOT_UNIXFS');\n        }\n        const rootBucket = createHAMT({\n            hashFn,\n            bits: Math.log2(Number(dir.fanout))\n        });\n        context = {\n            rootBucket,\n            hamtDepth: 1,\n            lastBucket: rootBucket\n        };\n    }\n    const padLength = (context.lastBucket.tableSize() - 1).toString(16).length;\n    await addLinksToHamtBucket(node.Links, context.lastBucket, context.rootBucket);\n    const position = await context.rootBucket._findNewBucketAndPos(name);\n    let prefix = toPrefix(position.pos, padLength);\n    const bucketPath = toBucketPath(position);\n    if (bucketPath.length > context.hamtDepth) {\n        context.lastBucket = bucketPath[context.hamtDepth];\n        prefix = toPrefix(context.lastBucket._posAtParent, padLength);\n    }\n    const link = node.Links.find(link => {\n        if (link.Name == null) {\n            return false;\n        }\n        const entryPrefix = link.Name.substring(0, padLength);\n        const entryName = link.Name.substring(padLength);\n        if (entryPrefix !== prefix) {\n            // not the entry or subshard we're looking for\n            return false;\n        }\n        if (entryName !== '' && entryName !== name) {\n            // not the entry we're looking for\n            return false;\n        }\n        return true;\n    });\n    if (link == null) {\n        return;\n    }\n    if (link.Name != null && link.Name.substring(padLength) === name) {\n        return link.Hash;\n    }\n    context.hamtDepth++;\n    const block = await blockstore.get(link.Hash, options);\n    node = decode(block);\n    return findShardCid(node, name, blockstore, context, options);\n};\nexport default findShardCid;\n//# sourceMappingURL=find-cid-in-shard.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction filter(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const entry of source) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    // if mapping function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    // @ts-expect-error .then is not present on O\n    if (typeof res.then === 'function') {\n        return (async function* () {\n            if (await res) {\n                yield value;\n            }\n            for await (const entry of peekable) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        if (res === true) {\n            yield value;\n        }\n        for (const entry of peekable) {\n            if (func(entry)) {\n                yield entry;\n            }\n        }\n    })();\n}\nexport default filter;\n//# sourceMappingURL=index.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction map(source, func) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const val of source) {\n                yield func(val);\n            }\n        })();\n    }\n    // if mapping function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = func(value);\n    // @ts-expect-error .then is not present on O\n    if (typeof res.then === 'function') {\n        return (async function* () {\n            yield await res;\n            for await (const val of peekable) {\n                yield func(val);\n            }\n        })();\n    }\n    const fn = func;\n    return (function* () {\n        yield res;\n        for (const val of peekable) {\n            yield fn(val);\n        }\n    })();\n}\nexport default map;\n//# sourceMappingURL=index.js.map","import filter from 'it-filter';\nimport map from 'it-map';\nimport parallel from 'it-parallel';\nimport { pipe } from 'it-pipe';\nimport { CustomProgressEvent } from 'progress-events';\nconst directoryContent = (cid, node, unixfs, path, resolve, depth, blockstore) => {\n    async function* yieldDirectoryContent(options = {}) {\n        const offset = options.offset ?? 0;\n        const length = options.length ?? node.Links.length;\n        const links = node.Links.slice(offset, length);\n        options.onProgress?.(new CustomProgressEvent('unixfs:exporter:walk:directory', {\n            cid\n        }));\n        yield* pipe(links, source => map(source, link => {\n            return async () => {\n                const linkName = link.Name ?? '';\n                const linkPath = `${path}/${linkName}`;\n                const result = await resolve(link.Hash, linkName, linkPath, [], depth + 1, blockstore, options);\n                return result.entry;\n            };\n        }), source => parallel(source, { ordered: true }), source => filter(source, entry => entry != null));\n    }\n    return yieldDirectoryContent;\n};\nexport default directoryContent;\n//# sourceMappingURL=directory.js.map","import * as dagPb from '@ipld/dag-pb';\nimport errCode from 'err-code';\nimport { UnixFS } from 'ipfs-unixfs';\nimport map from 'it-map';\nimport parallel from 'it-parallel';\nimport { pipe } from 'it-pipe';\nimport { pushable } from 'it-pushable';\nimport * as raw from 'multiformats/codecs/raw';\nimport PQueue from 'p-queue';\nimport { CustomProgressEvent } from 'progress-events';\nimport extractDataFromBlock from '../../../utils/extract-data-from-block.js';\nimport validateOffsetAndLength from '../../../utils/validate-offset-and-length.js';\nasync function walkDAG(blockstore, node, queue, streamPosition, start, end, options) {\n    // a `raw` node\n    if (node instanceof Uint8Array) {\n        const buf = extractDataFromBlock(node, streamPosition, start, end);\n        queue.push(buf);\n        return;\n    }\n    if (node.Data == null) {\n        throw errCode(new Error('no data in PBNode'), 'ERR_NOT_UNIXFS');\n    }\n    let file;\n    try {\n        file = UnixFS.unmarshal(node.Data);\n    }\n    catch (err) {\n        throw errCode(err, 'ERR_NOT_UNIXFS');\n    }\n    // might be a unixfs `raw` node or have data on intermediate nodes\n    if (file.data != null) {\n        const data = file.data;\n        const buf = extractDataFromBlock(data, streamPosition, start, end);\n        queue.push(buf);\n        streamPosition += BigInt(buf.byteLength);\n    }\n    const childOps = [];\n    if (node.Links.length !== file.blockSizes.length) {\n        throw errCode(new Error('Inconsistent block sizes and dag links'), 'ERR_NOT_UNIXFS');\n    }\n    for (let i = 0; i < node.Links.length; i++) {\n        const childLink = node.Links[i];\n        const childStart = streamPosition; // inclusive\n        const childEnd = childStart + file.blockSizes[i]; // exclusive\n        if ((start >= childStart && start < childEnd) || // child has offset byte\n            (end >= childStart && end <= childEnd) || // child has end byte\n            (start < childStart && end > childEnd)) { // child is between offset and end bytes\n            childOps.push({\n                link: childLink,\n                blockStart: streamPosition\n            });\n        }\n        streamPosition = childEnd;\n        if (streamPosition > end) {\n            break;\n        }\n    }\n    await pipe(childOps, (source) => map(source, (op) => {\n        return async () => {\n            const block = await blockstore.get(op.link.Hash, options);\n            return {\n                ...op,\n                block\n            };\n        };\n    }), (source) => parallel(source, {\n        ordered: true\n    }), async (source) => {\n        for await (const { link, block, blockStart } of source) {\n            let child;\n            switch (link.Hash.code) {\n                case dagPb.code:\n                    child = dagPb.decode(block);\n                    break;\n                case raw.code:\n                    child = block;\n                    break;\n                default:\n                    queue.end(errCode(new Error(`Unsupported codec: ${link.Hash.code}`), 'ERR_NOT_UNIXFS'));\n                    return;\n            }\n            // create a queue for this child - we use a queue instead of recursion\n            // to avoid overflowing the stack\n            const childQueue = new PQueue({\n                concurrency: 1\n            });\n            // if any of the child jobs error, end the read queue with the error\n            childQueue.on('error', error => {\n                queue.end(error);\n            });\n            // if the job rejects the 'error' event will be emitted on the child queue\n            void childQueue.add(async () => {\n                options.onProgress?.(new CustomProgressEvent('unixfs:exporter:walk:file', {\n                    cid: link.Hash\n                }));\n                await walkDAG(blockstore, child, queue, blockStart, start, end, options);\n            });\n            // wait for this child to complete before moving on to the next\n            await childQueue.onIdle();\n        }\n    });\n    if (streamPosition >= end) {\n        queue.end();\n    }\n}\nconst fileContent = (cid, node, unixfs, path, resolve, depth, blockstore) => {\n    async function* yieldFileContent(options = {}) {\n        const fileSize = unixfs.fileSize();\n        if (fileSize === undefined) {\n            throw new Error('File was a directory');\n        }\n        const { start, end } = validateOffsetAndLength(fileSize, options.offset, options.length);\n        if (end === 0n) {\n            return;\n        }\n        let read = 0n;\n        const wanted = end - start;\n        const queue = pushable();\n        options.onProgress?.(new CustomProgressEvent('unixfs:exporter:walk:file', {\n            cid\n        }));\n        void walkDAG(blockstore, node, queue, 0n, start, end, options)\n            .catch(err => {\n            queue.end(err);\n        });\n        for await (const buf of queue) {\n            if (buf == null) {\n                continue;\n            }\n            read += BigInt(buf.byteLength);\n            if (read > wanted) {\n                queue.end();\n                throw errCode(new Error('Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect'), 'ERR_OVER_READ');\n            }\n            if (read === wanted) {\n                queue.end();\n            }\n            options.onProgress?.(new CustomProgressEvent('unixfs:exporter:progress:unixfs:file', {\n                bytesRead: read,\n                totalBytes: wanted,\n                fileSize\n            }));\n            yield buf;\n        }\n        if (read < wanted) {\n            throw errCode(new Error('Traversed entire DAG but did not read enough bytes'), 'ERR_UNDER_READ');\n        }\n    }\n    return yieldFileContent;\n};\nexport default fileContent;\n//# sourceMappingURL=file.js.map","import { decode } from '@ipld/dag-pb';\nimport errCode from 'err-code';\nimport { UnixFS } from 'ipfs-unixfs';\nimport map from 'it-map';\nimport parallel from 'it-parallel';\nimport { pipe } from 'it-pipe';\nimport { CustomProgressEvent } from 'progress-events';\nconst hamtShardedDirectoryContent = (cid, node, unixfs, path, resolve, depth, blockstore) => {\n    function yieldHamtDirectoryContent(options = {}) {\n        options.onProgress?.(new CustomProgressEvent('unixfs:exporter:walk:hamt-sharded-directory', {\n            cid\n        }));\n        return listDirectory(node, path, resolve, depth, blockstore, options);\n    }\n    return yieldHamtDirectoryContent;\n};\nasync function* listDirectory(node, path, resolve, depth, blockstore, options) {\n    const links = node.Links;\n    if (node.Data == null) {\n        throw errCode(new Error('no data in PBNode'), 'ERR_NOT_UNIXFS');\n    }\n    let dir;\n    try {\n        dir = UnixFS.unmarshal(node.Data);\n    }\n    catch (err) {\n        throw errCode(err, 'ERR_NOT_UNIXFS');\n    }\n    if (dir.fanout == null) {\n        throw errCode(new Error('missing fanout'), 'ERR_NOT_UNIXFS');\n    }\n    const padLength = (dir.fanout - 1n).toString(16).length;\n    const results = pipe(links, source => map(source, link => {\n        return async () => {\n            const name = link.Name != null ? link.Name.substring(padLength) : null;\n            if (name != null && name !== '') {\n                const result = await resolve(link.Hash, name, `${path}/${name}`, [], depth + 1, blockstore, options);\n                return { entries: result.entry == null ? [] : [result.entry] };\n            }\n            else {\n                // descend into subshard\n                const block = await blockstore.get(link.Hash, options);\n                node = decode(block);\n                options.onProgress?.(new CustomProgressEvent('unixfs:exporter:walk:hamt-sharded-directory', {\n                    cid: link.Hash\n                }));\n                return { entries: listDirectory(node, path, resolve, depth, blockstore, options) };\n            }\n        };\n    }), source => parallel(source, { ordered: true }));\n    for await (const { entries } of results) {\n        yield* entries;\n    }\n}\nexport default hamtShardedDirectoryContent;\n//# sourceMappingURL=hamt-sharded-directory.js.map","import { decode } from '@ipld/dag-pb';\nimport errCode from 'err-code';\nimport { UnixFS } from 'ipfs-unixfs';\nimport findShardCid from '../../utils/find-cid-in-shard.js';\nimport contentDirectory from './content/directory.js';\nimport contentFile from './content/file.js';\nimport contentHamtShardedDirectory from './content/hamt-sharded-directory.js';\nconst findLinkCid = (node, name) => {\n    const link = node.Links.find(link => link.Name === name);\n    return link?.Hash;\n};\nconst contentExporters = {\n    raw: contentFile,\n    file: contentFile,\n    directory: contentDirectory,\n    'hamt-sharded-directory': contentHamtShardedDirectory,\n    metadata: (cid, node, unixfs, path, resolve, depth, blockstore) => {\n        return () => [];\n    },\n    symlink: (cid, node, unixfs, path, resolve, depth, blockstore) => {\n        return () => [];\n    }\n};\n// @ts-expect-error types are wrong\nconst unixFsResolver = async (cid, name, path, toResolve, resolve, depth, blockstore, options) => {\n    const block = await blockstore.get(cid, options);\n    const node = decode(block);\n    let unixfs;\n    let next;\n    if (name == null) {\n        name = cid.toString();\n    }\n    if (node.Data == null) {\n        throw errCode(new Error('no data in PBNode'), 'ERR_NOT_UNIXFS');\n    }\n    try {\n        unixfs = UnixFS.unmarshal(node.Data);\n    }\n    catch (err) {\n        // non-UnixFS dag-pb node? It could happen.\n        throw errCode(err, 'ERR_NOT_UNIXFS');\n    }\n    if (path == null) {\n        path = name;\n    }\n    if (toResolve.length > 0) {\n        let linkCid;\n        if (unixfs?.type === 'hamt-sharded-directory') {\n            // special case - unixfs v1 hamt shards\n            linkCid = await findShardCid(node, toResolve[0], blockstore);\n        }\n        else {\n            linkCid = findLinkCid(node, toResolve[0]);\n        }\n        if (linkCid == null) {\n            throw errCode(new Error('file does not exist'), 'ERR_NOT_FOUND');\n        }\n        // remove the path component we have resolved\n        const nextName = toResolve.shift();\n        const nextPath = `${path}/${nextName}`;\n        next = {\n            cid: linkCid,\n            toResolve,\n            name: nextName ?? '',\n            path: nextPath\n        };\n    }\n    const content = contentExporters[unixfs.type](cid, node, unixfs, path, resolve, depth, blockstore);\n    if (content == null) {\n        throw errCode(new Error('could not find content exporter'), 'ERR_NOT_FOUND');\n    }\n    if (unixfs.isDirectory()) {\n        return {\n            entry: {\n                type: 'directory',\n                name,\n                path,\n                cid,\n                content,\n                unixfs,\n                depth,\n                node,\n                size: unixfs.fileSize()\n            },\n            next\n        };\n    }\n    return {\n        entry: {\n            type: 'file',\n            name,\n            path,\n            cid,\n            content,\n            unixfs,\n            depth,\n            node,\n            size: unixfs.fileSize()\n        },\n        next\n    };\n};\nexport default unixFsResolver;\n//# sourceMappingURL=index.js.map","import * as dagCbor from '@ipld/dag-cbor';\nimport * as dagPb from '@ipld/dag-pb';\nimport errCode from 'err-code';\nimport * as raw from 'multiformats/codecs/raw';\nimport { identity } from 'multiformats/hashes/identity';\nimport dagCborResolver from './dag-cbor.js';\nimport identifyResolver from './identity.js';\nimport rawResolver from './raw.js';\nimport dagPbResolver from './unixfs-v1/index.js';\nconst resolvers = {\n    [dagPb.code]: dagPbResolver,\n    [raw.code]: rawResolver,\n    [dagCbor.code]: dagCborResolver,\n    [identity.code]: identifyResolver\n};\nconst resolve = async (cid, name, path, toResolve, depth, blockstore, options) => {\n    const resolver = resolvers[cid.code];\n    if (resolver == null) {\n        throw errCode(new Error(`No resolver for code ${cid.code}`), 'ERR_NO_RESOLVER');\n    }\n    return resolver(cid, name, path, toResolve, resolve, depth, blockstore, options);\n};\nexport default resolve;\n//# sourceMappingURL=index.js.map","import errCode from 'err-code';\nimport last from 'it-last';\nimport { CID } from 'multiformats/cid';\nimport resolve from './resolvers/index.js';\nconst toPathComponents = (path = '') => {\n    // split on / unless escaped with \\\n    return (path\n        .trim()\n        .match(/([^\\\\^/]|\\\\\\/)+/g) ?? [])\n        .filter(Boolean);\n};\nconst cidAndRest = (path) => {\n    if (path instanceof Uint8Array) {\n        return {\n            cid: CID.decode(path),\n            toResolve: []\n        };\n    }\n    const cid = CID.asCID(path);\n    if (cid != null) {\n        return {\n            cid,\n            toResolve: []\n        };\n    }\n    if (typeof path === 'string') {\n        if (path.indexOf('/ipfs/') === 0) {\n            path = path.substring(6);\n        }\n        const output = toPathComponents(path);\n        return {\n            cid: CID.parse(output[0]),\n            toResolve: output.slice(1)\n        };\n    }\n    throw errCode(new Error(`Unknown path type ${path}`), 'ERR_BAD_PATH');\n};\nexport async function* walkPath(path, blockstore, options = {}) {\n    let { cid, toResolve } = cidAndRest(path);\n    let name = cid.toString();\n    let entryPath = name;\n    const startingDepth = toResolve.length;\n    while (true) {\n        const result = await resolve(cid, name, entryPath, toResolve, startingDepth, blockstore, options);\n        if (result.entry == null && result.next == null) {\n            throw errCode(new Error(`Could not resolve ${path}`), 'ERR_NOT_FOUND');\n        }\n        if (result.entry != null) {\n            yield result.entry;\n        }\n        if (result.next == null) {\n            return;\n        }\n        // resolve further parts\n        toResolve = result.next.toResolve;\n        cid = result.next.cid;\n        name = result.next.name;\n        entryPath = result.next.path;\n    }\n}\nexport async function exporter(path, blockstore, options = {}) {\n    const result = await last(walkPath(path, blockstore, options));\n    if (result == null) {\n        throw errCode(new Error(`Could not resolve ${path}`), 'ERR_NOT_FOUND');\n    }\n    return result;\n}\nexport async function* recursive(path, blockstore, options = {}) {\n    const node = await exporter(path, blockstore, options);\n    if (node == null) {\n        return;\n    }\n    yield node;\n    if (node.type === 'directory') {\n        for await (const child of recurse(node, options)) {\n            yield child;\n        }\n    }\n    async function* recurse(node, options) {\n        for await (const file of node.content(options)) {\n            yield file;\n            if (file instanceof Uint8Array) {\n                continue;\n            }\n            if (file.type === 'directory') {\n                yield* recurse(file, options);\n            }\n        }\n    }\n}\n//# sourceMappingURL=index.js.map","export class UnixFSError extends Error {\n    name;\n    code;\n    constructor(message, name, code) {\n        super(message);\n        this.name = name;\n        this.code = code;\n    }\n}\nexport class NotUnixFSError extends UnixFSError {\n    constructor(message = 'not a Unixfs node') {\n        super(message, 'NotUnixFSError', 'ERR_NOT_UNIXFS');\n    }\n}\nexport class InvalidPBNodeError extends UnixFSError {\n    constructor(message = 'invalid PBNode') {\n        super(message, 'InvalidPBNodeError', 'ERR_INVALID_PBNODE');\n    }\n}\nexport class UnknownError extends UnixFSError {\n    constructor(message = 'unknown error') {\n        super(message, 'InvalidPBNodeError', 'ERR_UNKNOWN_ERROR');\n    }\n}\nexport class AlreadyExistsError extends UnixFSError {\n    constructor(message = 'path already exists') {\n        super(message, 'AlreadyExistsError', 'ERR_ALREADY_EXISTS');\n    }\n}\nexport class DoesNotExistError extends UnixFSError {\n    constructor(message = 'path does not exist') {\n        super(message, 'DoesNotExistError', 'ERR_DOES_NOT_EXIST');\n    }\n}\nexport class NoContentError extends UnixFSError {\n    constructor(message = 'no content') {\n        super(message, 'NoContentError', 'ERR_NO_CONTENT');\n    }\n}\nexport class NotAFileError extends UnixFSError {\n    constructor(message = 'not a file') {\n        super(message, 'NotAFileError', 'ERR_NOT_A_FILE');\n    }\n}\nexport class NotADirectoryError extends UnixFSError {\n    constructor(message = 'not a directory') {\n        super(message, 'NotADirectoryError', 'ERR_NOT_A_DIRECTORY');\n    }\n}\nexport class InvalidParametersError extends UnixFSError {\n    constructor(message = 'invalid parameters') {\n        super(message, 'InvalidParametersError', 'ERR_INVALID_PARAMETERS');\n    }\n}\n//# sourceMappingURL=errors.js.map","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","import { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nexport function wrapHash(hashFn) {\n    function hashing(value) {\n        if (value instanceof InfiniteHash) {\n            // already a hash. return it\n            return value;\n        }\n        else {\n            return new InfiniteHash(value, hashFn);\n        }\n    }\n    return hashing;\n}\nexport class InfiniteHash {\n    _value;\n    _hashFn;\n    _depth;\n    _availableBits;\n    _currentBufferIndex;\n    _buffers;\n    constructor(value, hashFn) {\n        if (!(value instanceof Uint8Array)) {\n            throw new Error('can only hash Uint8Arrays');\n        }\n        this._value = value;\n        this._hashFn = hashFn;\n        this._depth = -1;\n        this._availableBits = 0;\n        this._currentBufferIndex = 0;\n        this._buffers = [];\n    }\n    async take(bits) {\n        let pendingBits = bits;\n        while (this._availableBits < pendingBits) {\n            await this._produceMoreBits();\n        }\n        let result = 0;\n        while (pendingBits > 0) {\n            const hash = this._buffers[this._currentBufferIndex];\n            const available = Math.min(hash.availableBits(), pendingBits);\n            const took = hash.take(available);\n            result = (result << available) + took;\n            pendingBits -= available;\n            this._availableBits -= available;\n            if (hash.availableBits() === 0) {\n                this._currentBufferIndex++;\n            }\n        }\n        return result;\n    }\n    untake(bits) {\n        let pendingBits = bits;\n        while (pendingBits > 0) {\n            const hash = this._buffers[this._currentBufferIndex];\n            const availableForUntake = Math.min(hash.totalBits() - hash.availableBits(), pendingBits);\n            hash.untake(availableForUntake);\n            pendingBits -= availableForUntake;\n            this._availableBits += availableForUntake;\n            if (this._currentBufferIndex > 0 && hash.totalBits() === hash.availableBits()) {\n                this._depth--;\n                this._currentBufferIndex--;\n            }\n        }\n    }\n    async _produceMoreBits() {\n        this._depth++;\n        const value = this._depth > 0 ? uint8ArrayConcat([this._value, Uint8Array.from([this._depth])]) : this._value;\n        const hashValue = await this._hashFn(value);\n        const buffer = new ConsumableBuffer(hashValue);\n        this._buffers.push(buffer);\n        this._availableBits += buffer.availableBits();\n    }\n}\nconst START_MASKS = [\n    0b11111111,\n    0b11111110,\n    0b11111100,\n    0b11111000,\n    0b11110000,\n    0b11100000,\n    0b11000000,\n    0b10000000\n];\nconst STOP_MASKS = [\n    0b00000001,\n    0b00000011,\n    0b00000111,\n    0b00001111,\n    0b00011111,\n    0b00111111,\n    0b01111111,\n    0b11111111\n];\nexport class ConsumableBuffer {\n    _value;\n    _currentBytePos;\n    _currentBitPos;\n    constructor(value) {\n        this._value = value;\n        this._currentBytePos = value.length - 1;\n        this._currentBitPos = 7;\n    }\n    availableBits() {\n        return this._currentBitPos + 1 + this._currentBytePos * 8;\n    }\n    totalBits() {\n        return this._value.length * 8;\n    }\n    take(bits) {\n        let pendingBits = bits;\n        let result = 0;\n        while (pendingBits > 0 && this._haveBits()) {\n            const byte = this._value[this._currentBytePos];\n            const availableBits = this._currentBitPos + 1;\n            const taking = Math.min(availableBits, pendingBits);\n            const value = byteBitsToInt(byte, availableBits - taking, taking);\n            result = (result << taking) + value;\n            pendingBits -= taking;\n            this._currentBitPos -= taking;\n            if (this._currentBitPos < 0) {\n                this._currentBitPos = 7;\n                this._currentBytePos--;\n            }\n        }\n        return result;\n    }\n    untake(bits) {\n        this._currentBitPos += bits;\n        while (this._currentBitPos > 7) {\n            this._currentBitPos -= 8;\n            this._currentBytePos += 1;\n        }\n    }\n    _haveBits() {\n        return this._currentBytePos >= 0;\n    }\n}\nfunction byteBitsToInt(byte, start, length) {\n    const mask = maskFor(start, length);\n    return (byte & mask) >>> start;\n}\nfunction maskFor(start, length) {\n    return START_MASKS[start] & STOP_MASKS[Math.min(length + start - 1, 7)];\n}\n//# sourceMappingURL=consumable-hash.js.map","import { bytes } from 'multiformats'\nimport { from } from 'multiformats/hashes/hasher'\n// @ts-expect-error no types\nimport mur from 'murmurhash3js-revisited'\n\n/**\n * @param {number} number\n * @returns {Uint8Array}\n */\nfunction fromNumberTo32BitBuf (number) {\n  const bytes = new Array(4)\n  for (let i = 0; i < 4; i++) {\n    bytes[i] = number & 0xff\n    number = number >> 8\n  }\n  return new Uint8Array(bytes)\n}\n\nexport const murmur332 = from({\n  name: 'murmur3-32',\n  code: 0x23,\n  encode: (input) => fromNumberTo32BitBuf(mur.x86.hash32(input))\n})\n\nexport const murmur3128 = from({\n  name: 'murmur3-128',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input))\n})\n\n// A special-use 0x22 that truncates 64 bits, specifically for use in the UnixFS HAMT\nexport const murmur364 = from({\n  name: 'murmur3-x64-64',\n  code: 0x22,\n  encode: (input) => bytes.fromHex(mur.x64.hash128(input)).subarray(0, 8)\n})\n","import { murmur3128 } from '@multiformats/murmur3';\nexport const hamtHashCode = BigInt(murmur3128.code);\nexport const hamtBucketBits = 8;\nexport async function hamtHashFn(buf) {\n    return (await murmur3128.encode(buf))\n        // Murmur3 outputs 128 bit but, accidentally, IPFS Go's\n        // implementation only uses the first 64, so we must do the same\n        // for parity..\n        .subarray(0, 8)\n        // Invert buffer because that's how Go impl does it\n        .reverse();\n}\n//# sourceMappingURL=hamt-constants.js.map","import * as dagPb from '@ipld/dag-pb';\nimport { CID } from 'multiformats/cid';\nimport { sha256 } from 'multiformats/hashes/sha2';\nexport const persist = async (buffer, blockstore, options) => {\n    if (options.codec == null) {\n        options.codec = dagPb;\n    }\n    const multihash = await sha256.digest(buffer);\n    const cid = CID.create(options.cidVersion, options.codec.code, multihash);\n    await blockstore.put(cid, buffer, {\n        ...options,\n        signal: options.signal\n    });\n    return cid;\n};\n//# sourceMappingURL=persist.js.map","import { encode, prepare } from '@ipld/dag-pb';\nimport { createHAMT, Bucket } from 'hamt-sharding';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { CID } from 'multiformats/cid';\nimport { hamtHashCode, hamtHashFn } from './hamt-constants.js';\nimport { persist } from './persist.js';\nclass Dir {\n    options;\n    root;\n    dir;\n    path;\n    dirty;\n    flat;\n    parent;\n    parentKey;\n    unixfs;\n    mode;\n    mtime;\n    cid;\n    size;\n    nodeSize;\n    constructor(props, options) {\n        this.options = options ?? {};\n        this.root = props.root;\n        this.dir = props.dir;\n        this.path = props.path;\n        this.dirty = props.dirty;\n        this.flat = props.flat;\n        this.parent = props.parent;\n        this.parentKey = props.parentKey;\n        this.unixfs = props.unixfs;\n        this.mode = props.mode;\n        this.mtime = props.mtime;\n    }\n}\nexport class DirSharded extends Dir {\n    _bucket;\n    constructor(props, options) {\n        super(props, options);\n        this._bucket = createHAMT({\n            hashFn: hamtHashFn,\n            bits: 8\n        });\n    }\n    async put(name, value) {\n        this.cid = undefined;\n        this.size = undefined;\n        this.nodeSize = undefined;\n        await this._bucket.put(name, value);\n    }\n    async get(name) {\n        return this._bucket.get(name);\n    }\n    childCount() {\n        return this._bucket.leafCount();\n    }\n    directChildrenCount() {\n        return this._bucket.childrenCount();\n    }\n    onlyChild() {\n        return this._bucket.onlyChild();\n    }\n    async *eachChildSeries() {\n        for await (const { key, value } of this._bucket.eachLeafSeries()) {\n            yield {\n                key,\n                child: value\n            };\n        }\n    }\n    estimateNodeSize() {\n        if (this.nodeSize !== undefined) {\n            return this.nodeSize;\n        }\n        this.nodeSize = calculateSize(this._bucket, this, this.options);\n        return this.nodeSize;\n    }\n    async *flush(blockstore) {\n        for await (const entry of flush(this._bucket, blockstore, this, this.options)) {\n            yield {\n                ...entry,\n                path: this.path\n            };\n        }\n    }\n}\nasync function* flush(bucket, blockstore, shardRoot, options) {\n    const children = bucket._children;\n    const links = [];\n    let childrenSize = 0n;\n    for (let i = 0; i < children.length; i++) {\n        const child = children.get(i);\n        if (child == null) {\n            continue;\n        }\n        const labelPrefix = i.toString(16).toUpperCase().padStart(2, '0');\n        if (child instanceof Bucket) {\n            let shard;\n            for await (const subShard of flush(child, blockstore, null, options)) {\n                shard = subShard;\n            }\n            if (shard == null) {\n                throw new Error('Could not flush sharded directory, no subshard found');\n            }\n            links.push({\n                Name: labelPrefix,\n                Tsize: Number(shard.size),\n                Hash: shard.cid\n            });\n            childrenSize += shard.size;\n        }\n        else if (isDir(child.value)) {\n            const dir = child.value;\n            let flushedDir;\n            for await (const entry of dir.flush(blockstore)) {\n                flushedDir = entry;\n                yield flushedDir;\n            }\n            if (flushedDir == null) {\n                throw new Error('Did not flush dir');\n            }\n            const label = labelPrefix + child.key;\n            links.push({\n                Name: label,\n                Tsize: Number(flushedDir.size),\n                Hash: flushedDir.cid\n            });\n            childrenSize += flushedDir.size;\n        }\n        else {\n            const value = child.value;\n            if (value.cid == null) {\n                continue;\n            }\n            const label = labelPrefix + child.key;\n            const size = value.size;\n            links.push({\n                Name: label,\n                Tsize: Number(size),\n                Hash: value.cid\n            });\n            childrenSize += BigInt(size ?? 0);\n        }\n    }\n    // go-ipfs uses little endian, that's why we have to\n    // reverse the bit field before storing it\n    const data = Uint8Array.from(children.bitField().reverse());\n    const dir = new UnixFS({\n        type: 'hamt-sharded-directory',\n        data,\n        fanout: BigInt(bucket.tableSize()),\n        hashType: hamtHashCode,\n        mtime: shardRoot?.mtime,\n        mode: shardRoot?.mode\n    });\n    const node = {\n        Data: dir.marshal(),\n        Links: links\n    };\n    const buffer = encode(prepare(node));\n    const cid = await persist(buffer, blockstore, options);\n    const size = BigInt(buffer.byteLength) + childrenSize;\n    yield {\n        cid,\n        unixfs: dir,\n        size\n    };\n}\nfunction isDir(obj) {\n    return typeof obj.flush === 'function';\n}\nfunction calculateSize(bucket, shardRoot, options) {\n    const children = bucket._children;\n    const links = [];\n    for (let i = 0; i < children.length; i++) {\n        const child = children.get(i);\n        if (child == null) {\n            continue;\n        }\n        const labelPrefix = i.toString(16).toUpperCase().padStart(2, '0');\n        if (child instanceof Bucket) {\n            const size = calculateSize(child, null, options);\n            links.push({\n                Name: labelPrefix,\n                Tsize: Number(size),\n                Hash: options.cidVersion === 0 ? CID_V0 : CID_V1\n            });\n        }\n        else if (typeof child.value.flush === 'function') {\n            const dir = child.value;\n            const size = dir.nodeSize();\n            links.push({\n                Name: labelPrefix + child.key,\n                Tsize: Number(size),\n                Hash: options.cidVersion === 0 ? CID_V0 : CID_V1\n            });\n        }\n        else {\n            const value = child.value;\n            if (value.cid == null) {\n                continue;\n            }\n            const label = labelPrefix + child.key;\n            const size = value.size;\n            links.push({\n                Name: label,\n                Tsize: Number(size),\n                Hash: value.cid\n            });\n        }\n    }\n    // go-ipfs uses little endian, that's why we have to\n    // reverse the bit field before storing it\n    const data = Uint8Array.from(children.bitField().reverse());\n    const dir = new UnixFS({\n        type: 'hamt-sharded-directory',\n        data,\n        fanout: BigInt(bucket.tableSize()),\n        hashType: hamtHashCode,\n        mtime: shardRoot?.mtime,\n        mode: shardRoot?.mode\n    });\n    const buffer = encode(prepare({\n        Data: dir.marshal(),\n        Links: links\n    }));\n    return buffer.length;\n}\n// we use these to calculate the node size to use as a check for whether a directory\n// should be sharded or not. Since CIDs have a constant length and We're only\n// interested in the data length and not the actual content identifier we can use\n// any old CID instead of having to hash the data which is expensive.\nexport const CID_V0 = CID.parse('QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn');\nexport const CID_V1 = CID.parse('zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi');\n//# sourceMappingURL=dir-sharded.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport last from 'it-last';\n// @ts-expect-error no types\nimport SparseArray from 'sparse-array';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { wrapHash } from './consumable-hash.js';\nimport { DirSharded } from './dir-sharded.js';\nimport { hamtHashCode, hamtHashFn, hamtBucketBits } from './hamt-constants.js';\nimport { persist } from './persist.js';\nconst log = logger('helia:unixfs:commands:utils:hamt-utils');\nexport const toPrefix = (position) => {\n    return position\n        .toString(16)\n        .toUpperCase()\n        .padStart(2, '0')\n        .substring(0, 2);\n};\nexport const createShard = async (blockstore, contents, options) => {\n    const shard = new DirSharded({\n        root: true,\n        dir: true,\n        parent: undefined,\n        parentKey: undefined,\n        path: '',\n        dirty: true,\n        flat: false,\n        mtime: options.mtime,\n        mode: options.mode\n    }, options);\n    for (let i = 0; i < contents.length; i++) {\n        await shard._bucket.put(contents[i].name, {\n            size: contents[i].size,\n            cid: contents[i].cid\n        });\n    }\n    const res = await last(shard.flush(blockstore));\n    if (res == null) {\n        throw new Error('Flushing shard yielded no result');\n    }\n    return res;\n};\nexport const updateShardedDirectory = async (path, blockstore, options) => {\n    // persist any metadata on the shard root\n    const shardRoot = UnixFS.unmarshal(path[0].node.Data ?? new Uint8Array(0));\n    // this is always the same\n    const fanout = BigInt(Math.pow(2, hamtBucketBits));\n    // start from the leaf and ascend to the root\n    path.reverse();\n    let cid;\n    let node;\n    for (let i = 0; i < path.length; i++) {\n        const isRoot = i === path.length - 1;\n        const segment = path[i];\n        // go-ipfs uses little endian, that's why we have to\n        // reverse the bit field before storing it\n        const data = Uint8Array.from(segment.children.bitField().reverse());\n        const dir = new UnixFS({\n            type: 'hamt-sharded-directory',\n            data,\n            fanout,\n            hashType: hamtHashCode\n        });\n        if (isRoot) {\n            dir.mtime = shardRoot.mtime;\n            dir.mode = shardRoot.mode;\n        }\n        node = {\n            Data: dir.marshal(),\n            Links: segment.node.Links\n        };\n        const block = dagPB.encode(dagPB.prepare(node));\n        cid = await persist(block, blockstore, options);\n        if (!isRoot) {\n            // update link in parent sub-shard\n            const nextSegment = path[i + 1];\n            if (nextSegment == null) {\n                throw new Error('Was not operating on shard root but also had no parent?');\n            }\n            log('updating link in parent sub-shard with prefix %s', nextSegment.prefix);\n            nextSegment.node.Links = nextSegment.node.Links.filter(l => l.Name !== nextSegment.prefix);\n            nextSegment.node.Links.push({\n                Name: nextSegment.prefix,\n                Hash: cid,\n                Tsize: segment.node.Links.reduce((acc, curr) => acc + (curr.Tsize ?? 0), block.byteLength)\n            });\n        }\n    }\n    if (cid == null || node == null) {\n        throw new Error('Noting persisted');\n    }\n    return { cid, node };\n};\nexport const recreateShardedDirectory = async (cid, fileName, blockstore, options) => {\n    const wrapped = wrapHash(hamtHashFn);\n    const hash = wrapped(uint8ArrayFromString(fileName));\n    const path = [];\n    // descend the HAMT, loading each layer as we head towards the target child\n    while (true) {\n        const block = await blockstore.get(cid, options);\n        const node = dagPB.decode(block);\n        const children = new SparseArray();\n        const index = await hash.take(hamtBucketBits);\n        const prefix = toPrefix(index);\n        path.push({\n            prefix,\n            children,\n            node\n        });\n        let childLink;\n        // update sparsearray child layout - the bitfield is used as the data field for the\n        // intermediate DAG node so this is required to generate consistent hashes\n        for (const link of node.Links) {\n            const linkName = link.Name ?? '';\n            if (linkName.length < 2) {\n                throw new Error('Invalid HAMT - link name was too short');\n            }\n            const position = parseInt(linkName.substring(0, 2), 16);\n            children.set(position, true);\n            // we found the child we are looking for\n            if (linkName.startsWith(prefix)) {\n                childLink = link;\n            }\n        }\n        if (childLink == null) {\n            log('no link found with prefix %s for %s', prefix, fileName);\n            // hash.untake(hamtBucketBits)\n            break;\n        }\n        const linkName = childLink.Name ?? '';\n        if (linkName.length < 2) {\n            throw new Error('Invalid HAMT - link name was too short');\n        }\n        if (linkName.length === 2) {\n            // found sub-shard\n            cid = childLink.Hash;\n            log('descend into sub-shard with prefix %s', linkName);\n            continue;\n        }\n        break;\n    }\n    return { path, hash };\n};\n//# sourceMappingURL=hamt-utils.js.map","import * as dagPb from '@ipld/dag-pb';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { CID_V0, CID_V1 } from './dir-sharded.js';\n/**\n * Estimate node size only based on DAGLink name and CID byte lengths\n * https://github.com/ipfs/go-unixfsnode/blob/37b47f1f917f1b2f54c207682f38886e49896ef9/data/builder/directory.go#L81-L96\n *\n * If the node is a hamt sharded directory the calculation is based on if it was a regular directory.\n */\nexport async function isOverShardThreshold(node, blockstore, threshold, options) {\n    if (node.Data == null) {\n        throw new Error('DagPB node had no data');\n    }\n    const unixfs = UnixFS.unmarshal(node.Data);\n    let size;\n    if (unixfs.type === 'directory') {\n        size = estimateNodeSize(node);\n    }\n    else if (unixfs.type === 'hamt-sharded-directory') {\n        size = await estimateShardSize(node, 0, threshold, blockstore, options);\n    }\n    else {\n        throw new Error('Can only estimate the size of directories or shards');\n    }\n    return size > threshold;\n}\nfunction estimateNodeSize(node) {\n    let size = 0;\n    // estimate size only based on DAGLink name and CID byte lengths\n    // https://github.com/ipfs/go-unixfsnode/blob/37b47f1f917f1b2f54c207682f38886e49896ef9/data/builder/directory.go#L81-L96\n    for (const link of node.Links) {\n        size += (link.Name ?? '').length;\n        size += link.Hash.version === 1 ? CID_V1.bytes.byteLength : CID_V0.bytes.byteLength;\n    }\n    return size;\n}\nasync function estimateShardSize(node, current, max, blockstore, options) {\n    if (current > max) {\n        return max;\n    }\n    if (node.Data == null) {\n        return current;\n    }\n    const unixfs = UnixFS.unmarshal(node.Data);\n    if (!unixfs.isDirectory()) {\n        return current;\n    }\n    for (const link of node.Links) {\n        let name = link.Name ?? '';\n        // remove hamt hash prefix from name\n        name = name.substring(2);\n        current += name.length;\n        current += link.Hash.bytes.byteLength;\n        if (link.Hash.code === dagPb.code) {\n            const block = await blockstore.get(link.Hash, options);\n            const node = dagPb.decode(block);\n            current += await estimateShardSize(node, current, max, blockstore, options);\n        }\n    }\n    return current;\n}\n//# sourceMappingURL=is-over-shard-threshold.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { CID } from 'multiformats/cid';\nimport { sha256 } from 'multiformats/hashes/sha2';\n// @ts-expect-error no types\nimport SparseArray from 'sparse-array';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { AlreadyExistsError, InvalidParametersError, InvalidPBNodeError } from '../../errors.js';\nimport { wrapHash } from './consumable-hash.js';\nimport { hamtBucketBits, hamtHashFn } from './hamt-constants.js';\nimport { createShard, recreateShardedDirectory, toPrefix, updateShardedDirectory } from './hamt-utils.js';\nimport { isOverShardThreshold } from './is-over-shard-threshold.js';\nconst log = logger('helia:unixfs:components:utils:add-link');\nexport async function addLink(parent, child, blockstore, options) {\n    if (parent.node.Data == null) {\n        throw new InvalidParametersError('Invalid parent passed to addLink');\n    }\n    const meta = UnixFS.unmarshal(parent.node.Data);\n    if (meta.type === 'hamt-sharded-directory') {\n        log('adding link to sharded directory');\n        return addToShardedDirectory(parent, child, blockstore, options);\n    }\n    log(`adding ${child.Name} (${child.Hash}) to regular directory`);\n    const result = await addToDirectory(parent, child, blockstore, options);\n    if (await isOverShardThreshold(result.node, blockstore, options.shardSplitThresholdBytes, options)) {\n        log('converting directory to sharded directory');\n        const converted = await convertToShardedDirectory(result, blockstore);\n        result.cid = converted.cid;\n        result.node = dagPB.decode(await blockstore.get(converted.cid, options));\n    }\n    return result;\n}\nconst convertToShardedDirectory = async (parent, blockstore) => {\n    if (parent.node.Data == null) {\n        throw new InvalidParametersError('Invalid parent passed to convertToShardedDirectory');\n    }\n    const unixfs = UnixFS.unmarshal(parent.node.Data);\n    const result = await createShard(blockstore, parent.node.Links.map(link => ({\n        name: (link.Name ?? ''),\n        size: BigInt(link.Tsize ?? 0),\n        cid: link.Hash\n    })), {\n        mode: unixfs.mode,\n        mtime: unixfs.mtime,\n        cidVersion: parent.cid.version\n    });\n    log(`converted directory to sharded directory ${result.cid}`);\n    return result;\n};\nconst addToDirectory = async (parent, child, blockstore, options) => {\n    // Remove existing link if it exists\n    const parentLinks = parent.node.Links.filter((link) => {\n        const matches = link.Name === child.Name;\n        if (matches && !options.allowOverwriting) {\n            throw new AlreadyExistsError();\n        }\n        return !matches;\n    });\n    parentLinks.push(child);\n    if (parent.node.Data == null) {\n        throw new InvalidPBNodeError('Parent node with no data passed to addToDirectory');\n    }\n    const node = UnixFS.unmarshal(parent.node.Data);\n    let data;\n    if (node.mtime != null) {\n        // Update mtime if previously set\n        const ms = Date.now();\n        const secs = Math.floor(ms / 1000);\n        node.mtime = {\n            secs: BigInt(secs),\n            nsecs: (ms - (secs * 1000)) * 1000\n        };\n        data = node.marshal();\n    }\n    else {\n        data = parent.node.Data;\n    }\n    parent.node = dagPB.prepare({\n        Data: data,\n        Links: parentLinks\n    });\n    // Persist the new parent PbNode\n    const buf = dagPB.encode(parent.node);\n    const hash = await sha256.digest(buf);\n    const cid = CID.create(parent.cid.version, dagPB.code, hash);\n    await blockstore.put(cid, buf);\n    return {\n        node: parent.node,\n        cid\n    };\n};\nconst addToShardedDirectory = async (parent, child, blockstore, options) => {\n    const { path, hash } = await recreateShardedDirectory(parent.cid, child.Name, blockstore, options);\n    const finalSegment = path[path.length - 1];\n    if (finalSegment == null) {\n        throw new Error('Invalid HAMT, could not generate path');\n    }\n    // find the next prefix\n    // const index = await hash.take(hamtBucketBits)\n    const prefix = finalSegment.prefix;\n    const index = parseInt(prefix, 16);\n    log('next prefix for %s is %s', child.Name, prefix);\n    const linkName = `${prefix}${child.Name}`;\n    const existingLink = finalSegment.node.Links.find(l => (l.Name ?? '').startsWith(prefix));\n    if (existingLink != null) {\n        log('link %s was present in shard', linkName);\n        // link is already present in shard\n        if (existingLink.Name === linkName) {\n            // file with same name is already present in shard\n            if (!options.allowOverwriting) {\n                throw new AlreadyExistsError();\n            }\n            log('overwriting %s in subshard', child.Name);\n            finalSegment.node.Links = finalSegment.node.Links.filter(l => l.Name !== linkName);\n            finalSegment.node.Links.push({\n                Name: linkName,\n                Hash: child.Hash,\n                Tsize: child.Tsize\n            });\n        }\n        else if (existingLink.Name?.length === 2) {\n            throw new Error('Existing link was subshard?!');\n        }\n        else {\n            // conflict, add a new HAMT segment\n            log('prefix %s already exists, creating new subshard', prefix);\n            // find the sibling we are going to replace\n            const index = finalSegment.node.Links.findIndex(l => l.Name?.startsWith(prefix));\n            const sibling = finalSegment.node.Links.splice(index, 1)[0];\n            // give the sibling a new HAMT prefix\n            const siblingName = (sibling.Name ?? '').substring(2);\n            const wrapped = wrapHash(hamtHashFn);\n            const siblingHash = wrapped(uint8ArrayFromString(siblingName));\n            // discard hash bits until we reach the subshard depth\n            for (let i = 0; i < path.length; i++) {\n                await siblingHash.take(hamtBucketBits);\n            }\n            while (true) {\n                const siblingIndex = await siblingHash.take(hamtBucketBits);\n                const siblingPrefix = toPrefix(siblingIndex);\n                sibling.Name = `${siblingPrefix}${siblingName}`;\n                // calculate the target file's HAMT prefix in the new sub-shard\n                const newIndex = await hash.take(hamtBucketBits);\n                const newPrefix = toPrefix(newIndex);\n                if (siblingPrefix === newPrefix) {\n                    // the two sibling names have caused another conflict - add an intermediate node to\n                    // the HAMT and try again\n                    // create the child locations\n                    const children = new SparseArray();\n                    children.set(newIndex, true);\n                    path.push({\n                        prefix: newPrefix,\n                        children,\n                        node: {\n                            Links: []\n                        }\n                    });\n                    continue;\n                }\n                // create the child locations\n                const children = new SparseArray();\n                children.set(newIndex, true);\n                children.set(siblingIndex, true);\n                // add our new segment\n                path.push({\n                    prefix,\n                    children,\n                    node: {\n                        Links: [\n                            sibling, {\n                                Name: `${newPrefix}${child.Name}`,\n                                Hash: child.Hash,\n                                Tsize: child.Tsize\n                            }\n                        ]\n                    }\n                });\n                break;\n            }\n        }\n    }\n    else {\n        log('link %s was not present in sub-shard', linkName);\n        // add new link to shard\n        child.Name = linkName;\n        finalSegment.node.Links.push(child);\n        finalSegment.children.set(index, true);\n        log('adding %s to existing sub-shard', linkName);\n    }\n    return updateShardedDirectory(path, blockstore, options);\n};\n//# sourceMappingURL=add-link.js.map","import { exporter } from 'ipfs-unixfs-exporter';\nimport { NotADirectoryError } from '../../errors.js';\nexport async function cidToDirectory(cid, blockstore, options = {}) {\n    const entry = await exporter(cid, blockstore, options);\n    if (entry.type !== 'directory') {\n        throw new NotADirectoryError(`${cid.toString()} was not a UnixFS directory`);\n    }\n    return {\n        cid,\n        node: entry.node\n    };\n}\n//# sourceMappingURL=cid-to-directory.js.map","import * as dagPb from '@ipld/dag-pb';\nimport { exporter } from 'ipfs-unixfs-exporter';\nimport { NotUnixFSError } from '../../errors.js';\nexport async function cidToPBLink(cid, name, blockstore, options) {\n    const sourceEntry = await exporter(cid, blockstore, options);\n    if (sourceEntry.type !== 'directory' && sourceEntry.type !== 'file' && sourceEntry.type !== 'raw') {\n        throw new NotUnixFSError(`${cid.toString()} was not a UnixFS node`);\n    }\n    return {\n        Name: name,\n        Tsize: sourceEntry.node instanceof Uint8Array ? sourceEntry.node.byteLength : dagNodeTsize(sourceEntry.node),\n        Hash: cid\n    };\n}\nfunction dagNodeTsize(node) {\n    const linkSizes = node.Links.reduce((acc, curr) => acc + (curr.Tsize ?? 0), 0);\n    return dagPb.encode(node).byteLength + linkSizes;\n}\n//# sourceMappingURL=cid-to-pblink.js.map","import { logger } from '@libp2p/logger';\nimport { exporter } from 'ipfs-unixfs-exporter';\nimport { DoesNotExistError, InvalidParametersError } from '../../errors.js';\nimport { addLink } from './add-link.js';\nimport { cidToDirectory } from './cid-to-directory.js';\nimport { cidToPBLink } from './cid-to-pblink.js';\nconst log = logger('helia:unixfs:components:utils:resolve');\nexport async function resolve(cid, path, blockstore, options) {\n    if (path == null || path === '') {\n        return { cid };\n    }\n    log('resolve \"%s\" under %c', path, cid);\n    const parts = path.split('/').filter(Boolean);\n    const segments = [{\n            name: '',\n            cid,\n            size: 0n\n        }];\n    for (let i = 0; i < parts.length; i++) {\n        const part = parts[i];\n        const result = await exporter(cid, blockstore, options);\n        log('resolving \"%s\"', part, result);\n        if (result.type === 'file') {\n            if (i < parts.length - 1) {\n                throw new InvalidParametersError('Path was invalid');\n            }\n            cid = result.cid;\n        }\n        else if (result.type === 'directory') {\n            let dirCid;\n            for await (const entry of result.content()) {\n                if (entry.name === part) {\n                    dirCid = entry.cid;\n                    break;\n                }\n            }\n            if (dirCid == null) {\n                throw new DoesNotExistError('Could not find path in directory');\n            }\n            cid = dirCid;\n            segments.push({\n                name: part,\n                cid,\n                size: result.size\n            });\n        }\n        else {\n            throw new InvalidParametersError('Could not resolve path');\n        }\n    }\n    log('resolved %s to %c', path, cid);\n    return {\n        cid,\n        path,\n        segments\n    };\n}\n/**\n * Where we have descended into a DAG to update a child node, ascend up the DAG creating\n * new hashes and blocks for the changed content\n */\nexport async function updatePathCids(cid, result, blockstore, options) {\n    if (result.segments == null || result.segments.length === 0) {\n        return cid;\n    }\n    let child = result.segments.pop();\n    if (child == null) {\n        throw new Error('Insufficient segments');\n    }\n    child.cid = cid;\n    result.segments.reverse();\n    for (const parent of result.segments) {\n        const [directory, pblink] = await Promise.all([\n            cidToDirectory(parent.cid, blockstore, options),\n            cidToPBLink(child.cid, child.name, blockstore, options)\n        ]);\n        const result = await addLink(directory, pblink, blockstore, {\n            ...options,\n            allowOverwriting: true,\n            cidVersion: cid.version\n        });\n        cid = result.cid;\n        parent.cid = cid;\n        child = parent;\n    }\n    return cid;\n}\n//# sourceMappingURL=resolve.js.map","import { exporter } from 'ipfs-unixfs-exporter';\nimport mergeOpts from 'merge-options';\nimport { NoContentError, NotAFileError } from '../errors.js';\nimport { resolve } from './utils/resolve.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst defaultOptions = {};\nexport async function* cat(cid, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    const resolved = await resolve(cid, opts.path, blockstore, opts);\n    const result = await exporter(resolved.cid, blockstore, opts);\n    if (result.type !== 'file' && result.type !== 'raw') {\n        throw new NotAFileError();\n    }\n    if (result.content == null) {\n        throw new NoContentError();\n    }\n    yield* result.content(opts);\n}\n//# sourceMappingURL=cat.js.map","export const SHARD_SPLIT_THRESHOLD_BYTES = 262144;\n//# sourceMappingURL=constants.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { recursive } from 'ipfs-unixfs-exporter';\nimport { importer } from 'ipfs-unixfs-importer';\nimport last from 'it-last';\nimport { pipe } from 'it-pipe';\nimport mergeOpts from 'merge-options';\nimport { CID } from 'multiformats/cid';\nimport * as raw from 'multiformats/codecs/raw';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { InvalidPBNodeError, NotUnixFSError, UnknownError } from '../errors.js';\nimport { SHARD_SPLIT_THRESHOLD_BYTES } from './utils/constants.js';\nimport { persist } from './utils/persist.js';\nimport { resolve, updatePathCids } from './utils/resolve.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:chmod');\nconst defaultOptions = {\n    recursive: false,\n    shardSplitThresholdBytes: SHARD_SPLIT_THRESHOLD_BYTES\n};\nexport async function chmod(cid, mode, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    const resolved = await resolve(cid, opts.path, blockstore, options);\n    log('chmod %c %d', resolved.cid, mode);\n    if (opts.recursive) {\n        // recursively export from root CID, change perms of each entry then reimport\n        // but do not reimport files, only manipulate dag-pb nodes\n        const root = await pipe(async function* () {\n            for await (const entry of recursive(resolved.cid, blockstore, options)) {\n                let metadata;\n                let links = [];\n                if (entry.type === 'raw') {\n                    // convert to UnixFS\n                    metadata = new UnixFS({ type: 'file', data: entry.node });\n                }\n                else if (entry.type === 'file' || entry.type === 'directory') {\n                    metadata = entry.unixfs;\n                    links = entry.node.Links;\n                }\n                else {\n                    throw new NotUnixFSError();\n                }\n                metadata.mode = mode;\n                const node = {\n                    Data: metadata.marshal(),\n                    Links: links\n                };\n                yield {\n                    path: entry.path,\n                    content: node\n                };\n            }\n        }, \n        // @ts-expect-error cannot combine progress types\n        (source) => importer(source, blockstore, {\n            ...opts,\n            dagBuilder: async function* (source, block) {\n                for await (const entry of source) {\n                    yield async function () {\n                        // @ts-expect-error cannot derive type\n                        const node = entry.content;\n                        const buf = dagPB.encode(node);\n                        const updatedCid = await persist(buf, block, {\n                            ...opts,\n                            cidVersion: cid.version\n                        });\n                        if (node.Data == null) {\n                            throw new InvalidPBNodeError(`${updatedCid} had no data`);\n                        }\n                        const unixfs = UnixFS.unmarshal(node.Data);\n                        return {\n                            cid: updatedCid,\n                            size: BigInt(buf.length),\n                            path: entry.path,\n                            unixfs\n                        };\n                    };\n                }\n            }\n        }), async (nodes) => last(nodes));\n        if (root == null) {\n            throw new UnknownError(`Could not chmod ${resolved.cid.toString()}`);\n        }\n        return updatePathCids(root.cid, resolved, blockstore, opts);\n    }\n    const block = await blockstore.get(resolved.cid, options);\n    let metadata;\n    let links = [];\n    if (resolved.cid.code === raw.code) {\n        // convert to UnixFS\n        metadata = new UnixFS({ type: 'file', data: block });\n    }\n    else {\n        const node = dagPB.decode(block);\n        if (node.Data == null) {\n            throw new InvalidPBNodeError(`${resolved.cid.toString()} had no data`);\n        }\n        links = node.Links;\n        metadata = UnixFS.unmarshal(node.Data);\n    }\n    metadata.mode = mode;\n    const updatedBlock = dagPB.encode({\n        Data: metadata.marshal(),\n        Links: links\n    });\n    const hash = await sha256.digest(updatedBlock);\n    const updatedCid = CID.create(resolved.cid.version, dagPB.code, hash);\n    await blockstore.put(updatedCid, updatedBlock);\n    return updatePathCids(updatedCid, resolved, blockstore, opts);\n}\n//# sourceMappingURL=chmod.js.map","import { logger } from '@libp2p/logger';\nimport mergeOpts from 'merge-options';\nimport { InvalidParametersError } from '../errors.js';\nimport { addLink } from './utils/add-link.js';\nimport { cidToDirectory } from './utils/cid-to-directory.js';\nimport { cidToPBLink } from './utils/cid-to-pblink.js';\nimport { SHARD_SPLIT_THRESHOLD_BYTES } from './utils/constants.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:cp');\nconst defaultOptions = {\n    force: false,\n    shardSplitThresholdBytes: SHARD_SPLIT_THRESHOLD_BYTES\n};\nexport async function cp(source, target, name, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    if (name.includes('/')) {\n        throw new InvalidParametersError('Name must not have slashes');\n    }\n    const [directory, pblink] = await Promise.all([\n        cidToDirectory(target, blockstore, opts),\n        cidToPBLink(source, name, blockstore, opts)\n    ]);\n    log('Adding %c as \"%s\" to %c', source, name, target);\n    const result = await addLink(directory, pblink, blockstore, {\n        allowOverwriting: opts.force,\n        cidVersion: target.version,\n        ...opts\n    });\n    return result.cid;\n}\n//# sourceMappingURL=cp.js.map","import { exporter } from 'ipfs-unixfs-exporter';\nimport mergeOpts from 'merge-options';\nimport { NoContentError, NotADirectoryError } from '../errors.js';\nimport { resolve } from './utils/resolve.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst defaultOptions = {};\nexport async function* ls(cid, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    const resolved = await resolve(cid, opts.path, blockstore, opts);\n    const result = await exporter(resolved.cid, blockstore);\n    if (result.type === 'file' || result.type === 'raw') {\n        yield result;\n        return;\n    }\n    if (result.content == null) {\n        throw new NoContentError();\n    }\n    if (result.type !== 'directory') {\n        throw new NotADirectoryError();\n    }\n    yield* result.content({\n        offset: options.offset,\n        length: options.length\n    });\n}\n//# sourceMappingURL=ls.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { exporter } from 'ipfs-unixfs-exporter';\nimport mergeOpts from 'merge-options';\nimport { CID } from 'multiformats/cid';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { InvalidParametersError, NotADirectoryError } from '../errors.js';\nimport { addLink } from './utils/add-link.js';\nimport { cidToDirectory } from './utils/cid-to-directory.js';\nimport { cidToPBLink } from './utils/cid-to-pblink.js';\nimport { SHARD_SPLIT_THRESHOLD_BYTES } from './utils/constants.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:mkdir');\nconst defaultOptions = {\n    cidVersion: 1,\n    force: false,\n    shardSplitThresholdBytes: SHARD_SPLIT_THRESHOLD_BYTES\n};\nexport async function mkdir(parentCid, dirname, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    if (dirname.includes('/')) {\n        throw new InvalidParametersError('Path must not have slashes');\n    }\n    const entry = await exporter(parentCid, blockstore, options);\n    if (entry.type !== 'directory') {\n        throw new NotADirectoryError(`${parentCid.toString()} was not a UnixFS directory`);\n    }\n    log('creating %s', dirname);\n    const metadata = new UnixFS({\n        type: 'directory',\n        mode: opts.mode,\n        mtime: opts.mtime\n    });\n    // Persist the new parent PBNode\n    const node = {\n        Data: metadata.marshal(),\n        Links: []\n    };\n    const buf = dagPB.encode(node);\n    const hash = await sha256.digest(buf);\n    const emptyDirCid = CID.create(opts.cidVersion, dagPB.code, hash);\n    await blockstore.put(emptyDirCid, buf);\n    const [directory, pblink] = await Promise.all([\n        cidToDirectory(parentCid, blockstore, opts),\n        cidToPBLink(emptyDirCid, dirname, blockstore, opts)\n    ]);\n    log('adding empty dir called %s to %c', dirname, parentCid);\n    const result = await addLink(directory, pblink, blockstore, {\n        ...opts,\n        allowOverwriting: opts.force\n    });\n    return result.cid;\n}\n//# sourceMappingURL=mkdir.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { exporter } from 'ipfs-unixfs-exporter';\nimport { InvalidParametersError, InvalidPBNodeError } from '../../errors.js';\nimport { recreateShardedDirectory, updateShardedDirectory } from './hamt-utils.js';\nimport { isOverShardThreshold } from './is-over-shard-threshold.js';\nimport { persist } from './persist.js';\nconst log = logger('helia:unixfs:utils:remove-link');\nexport async function removeLink(parent, name, blockstore, options) {\n    if (parent.node.Data == null) {\n        throw new InvalidPBNodeError('Parent node had no data');\n    }\n    const meta = UnixFS.unmarshal(parent.node.Data);\n    if (meta.type === 'hamt-sharded-directory') {\n        log(`removing ${name} from sharded directory`);\n        const result = await removeFromShardedDirectory(parent, name, blockstore, options);\n        if (!(await isOverShardThreshold(result.node, blockstore, options.shardSplitThresholdBytes, options))) {\n            log('converting shard to flat directory %c', parent.cid);\n            return convertToFlatDirectory(result, blockstore, options);\n        }\n        return result;\n    }\n    log(`removing link ${name} regular directory`);\n    return removeFromDirectory(parent, name, blockstore, options);\n}\nconst removeFromDirectory = async (parent, name, blockstore, options) => {\n    // Remove existing link if it exists\n    parent.node.Links = parent.node.Links.filter((link) => {\n        return link.Name !== name;\n    });\n    const parentBlock = dagPB.encode(parent.node);\n    const parentCid = await persist(parentBlock, blockstore, {\n        ...options,\n        cidVersion: parent.cid.version\n    });\n    log(`Updated regular directory ${parentCid}`);\n    return {\n        node: parent.node,\n        cid: parentCid\n    };\n};\nconst removeFromShardedDirectory = async (parent, name, blockstore, options) => {\n    const { path } = await recreateShardedDirectory(parent.cid, name, blockstore, options);\n    const finalSegment = path[path.length - 1];\n    if (finalSegment == null) {\n        throw new Error('Invalid HAMT, could not generate path');\n    }\n    const linkName = finalSegment.node.Links.filter(l => (l.Name ?? '').substring(2) === name).map(l => l.Name).pop();\n    if (linkName == null) {\n        throw new Error('File not found');\n    }\n    const prefix = linkName.substring(0, 2);\n    const index = parseInt(prefix, 16);\n    // remove the file from the shard\n    finalSegment.node.Links = finalSegment.node.Links.filter(link => link.Name !== linkName);\n    finalSegment.children.unset(index);\n    if (finalSegment.node.Links.length === 1) {\n        // replace the subshard with the last remaining file in the parent\n        while (true) {\n            if (path.length === 1) {\n                break;\n            }\n            const segment = path[path.length - 1];\n            if (segment == null || segment.node.Links.length > 1) {\n                break;\n            }\n            // remove final segment\n            path.pop();\n            const nextSegment = path[path.length - 1];\n            if (nextSegment == null) {\n                break;\n            }\n            const link = segment.node.Links[0];\n            nextSegment.node.Links = nextSegment.node.Links.filter(l => !(l.Name ?? '').startsWith(nextSegment.prefix));\n            nextSegment.node.Links.push({\n                Hash: link.Hash,\n                Name: `${nextSegment.prefix}${(link.Name ?? '').substring(2)}`,\n                Tsize: link.Tsize\n            });\n        }\n    }\n    return updateShardedDirectory(path, blockstore, options);\n};\nconst convertToFlatDirectory = async (parent, blockstore, options) => {\n    if (parent.node.Data == null) {\n        throw new InvalidParametersError('Invalid parent passed to convertToFlatDirectory');\n    }\n    const rootNode = {\n        Links: []\n    };\n    const dir = await exporter(parent.cid, blockstore);\n    if (dir.type !== 'directory') {\n        throw new Error('Unexpected node type');\n    }\n    for await (const entry of dir.content()) {\n        let tsize = 0;\n        if (entry.node instanceof Uint8Array) {\n            tsize = entry.node.byteLength;\n        }\n        else {\n            tsize = dagPB.encode(entry.node).length;\n        }\n        rootNode.Links.push({\n            Hash: entry.cid,\n            Name: entry.name,\n            Tsize: tsize\n        });\n    }\n    // copy mode/mtime over if set\n    const oldUnixfs = UnixFS.unmarshal(parent.node.Data);\n    rootNode.Data = new UnixFS({ type: 'directory', mode: oldUnixfs.mode, mtime: oldUnixfs.mtime }).marshal();\n    const block = dagPB.encode(dagPB.prepare(rootNode));\n    const cid = await persist(block, blockstore, {\n        codec: dagPB,\n        cidVersion: parent.cid.version,\n        signal: options.signal\n    });\n    return {\n        cid,\n        node: rootNode\n    };\n};\n//# sourceMappingURL=remove-link.js.map","import { logger } from '@libp2p/logger';\nimport mergeOpts from 'merge-options';\nimport { InvalidParametersError } from '../errors.js';\nimport { cidToDirectory } from './utils/cid-to-directory.js';\nimport { SHARD_SPLIT_THRESHOLD_BYTES } from './utils/constants.js';\nimport { removeLink } from './utils/remove-link.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:rm');\nconst defaultOptions = {\n    shardSplitThresholdBytes: SHARD_SPLIT_THRESHOLD_BYTES\n};\nexport async function rm(target, name, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    if (name.includes('/')) {\n        throw new InvalidParametersError('Name must not have slashes');\n    }\n    const directory = await cidToDirectory(target, blockstore, opts);\n    log('Removing %s from %c', name, target);\n    const result = await removeLink(directory, name, blockstore, {\n        ...opts,\n        cidVersion: target.version\n    });\n    return result.cid;\n}\n//# sourceMappingURL=rm.js.map","import * as dagPb from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { exporter } from 'ipfs-unixfs-exporter';\nimport mergeOpts from 'merge-options';\nimport * as raw from 'multiformats/codecs/raw';\nimport { InvalidPBNodeError, NotUnixFSError, UnknownError } from '../errors.js';\nimport { resolve } from './utils/resolve.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:stat');\nconst defaultOptions = {};\nexport async function stat(cid, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    const resolved = await resolve(cid, options.path, blockstore, opts);\n    log('stat %c', resolved.cid);\n    const result = await exporter(resolved.cid, blockstore, opts);\n    if (result.type !== 'file' && result.type !== 'directory' && result.type !== 'raw') {\n        throw new NotUnixFSError();\n    }\n    let fileSize = 0n;\n    let dagSize = 0n;\n    let localFileSize = 0n;\n    let localDagSize = 0n;\n    let blocks = 0;\n    let mode;\n    let mtime;\n    const type = result.type;\n    let unixfs;\n    if (result.type === 'raw') {\n        fileSize = BigInt(result.node.byteLength);\n        dagSize = BigInt(result.node.byteLength);\n        localFileSize = BigInt(result.node.byteLength);\n        localDagSize = BigInt(result.node.byteLength);\n        blocks = 1;\n    }\n    if (result.type === 'directory') {\n        fileSize = 0n;\n        dagSize = BigInt(result.unixfs.marshal().byteLength);\n        localFileSize = 0n;\n        localDagSize = dagSize;\n        blocks = 1;\n        mode = result.unixfs.mode;\n        mtime = result.unixfs.mtime;\n        unixfs = result.unixfs;\n    }\n    if (result.type === 'file') {\n        const results = await inspectDag(resolved.cid, blockstore, opts);\n        fileSize = result.unixfs.fileSize();\n        dagSize = BigInt((result.node.Data?.byteLength ?? 0) + result.node.Links.reduce((acc, curr) => acc + (curr.Tsize ?? 0), 0));\n        localFileSize = BigInt(results.localFileSize);\n        localDagSize = BigInt(results.localDagSize);\n        blocks = results.blocks;\n        mode = result.unixfs.mode;\n        mtime = result.unixfs.mtime;\n        unixfs = result.unixfs;\n    }\n    return {\n        cid: resolved.cid,\n        mode,\n        mtime,\n        fileSize,\n        dagSize,\n        localFileSize,\n        localDagSize,\n        blocks,\n        type,\n        unixfs\n    };\n}\nasync function inspectDag(cid, blockstore, options) {\n    const results = {\n        localFileSize: 0,\n        localDagSize: 0,\n        blocks: 0\n    };\n    if (await blockstore.has(cid, options)) {\n        const block = await blockstore.get(cid, options);\n        results.blocks++;\n        results.localDagSize += block.byteLength;\n        if (cid.code === raw.code) {\n            results.localFileSize += block.byteLength;\n        }\n        else if (cid.code === dagPb.code) {\n            const pbNode = dagPb.decode(block);\n            if (pbNode.Links.length > 0) {\n                // intermediate node\n                for (const link of pbNode.Links) {\n                    const linkResult = await inspectDag(link.Hash, blockstore, options);\n                    results.localFileSize += linkResult.localFileSize;\n                    results.localDagSize += linkResult.localDagSize;\n                    results.blocks += linkResult.blocks;\n                }\n            }\n            else {\n                // leaf node\n                if (pbNode.Data == null) {\n                    throw new InvalidPBNodeError(`PBNode ${cid.toString()} had no data`);\n                }\n                const unixfs = UnixFS.unmarshal(pbNode.Data);\n                if (unixfs.data == null) {\n                    throw new InvalidPBNodeError(`UnixFS node ${cid.toString()} had no data`);\n                }\n                results.localFileSize += unixfs.data.byteLength ?? 0;\n            }\n        }\n        else {\n            throw new UnknownError(`${cid.toString()} was neither DAG_PB nor RAW`);\n        }\n    }\n    return results;\n}\n//# sourceMappingURL=stat.js.map","import * as dagPB from '@ipld/dag-pb';\nimport { logger } from '@libp2p/logger';\nimport { UnixFS } from 'ipfs-unixfs';\nimport { recursive } from 'ipfs-unixfs-exporter';\nimport { importer } from 'ipfs-unixfs-importer';\nimport last from 'it-last';\nimport { pipe } from 'it-pipe';\nimport mergeOpts from 'merge-options';\nimport { CID } from 'multiformats/cid';\nimport * as raw from 'multiformats/codecs/raw';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { InvalidPBNodeError, NotUnixFSError, UnknownError } from '../errors.js';\nimport { SHARD_SPLIT_THRESHOLD_BYTES } from './utils/constants.js';\nimport { persist } from './utils/persist.js';\nimport { resolve, updatePathCids } from './utils/resolve.js';\nconst mergeOptions = mergeOpts.bind({ ignoreUndefined: true });\nconst log = logger('helia:unixfs:touch');\nconst defaultOptions = {\n    recursive: false,\n    shardSplitThresholdBytes: SHARD_SPLIT_THRESHOLD_BYTES\n};\nexport async function touch(cid, blockstore, options = {}) {\n    const opts = mergeOptions(defaultOptions, options);\n    const resolved = await resolve(cid, opts.path, blockstore, opts);\n    const mtime = opts.mtime ?? {\n        secs: BigInt(Math.round(Date.now() / 1000)),\n        nsecs: 0\n    };\n    log('touch %c %o', resolved.cid, mtime);\n    if (opts.recursive) {\n        // recursively export from root CID, change perms of each entry then reimport\n        // but do not reimport files, only manipulate dag-pb nodes\n        const root = await pipe(async function* () {\n            for await (const entry of recursive(resolved.cid, blockstore)) {\n                let metadata;\n                let links;\n                if (entry.type === 'raw') {\n                    metadata = new UnixFS({ data: entry.node });\n                    links = [];\n                }\n                else if (entry.type === 'file' || entry.type === 'directory') {\n                    metadata = entry.unixfs;\n                    links = entry.node.Links;\n                }\n                else {\n                    throw new NotUnixFSError();\n                }\n                metadata.mtime = mtime;\n                const node = {\n                    Data: metadata.marshal(),\n                    Links: links\n                };\n                yield {\n                    path: entry.path,\n                    content: node\n                };\n            }\n        }, \n        // @ts-expect-error blockstore types are incompatible\n        (source) => importer(source, blockstore, {\n            ...opts,\n            dagBuilder: async function* (source, block) {\n                for await (const entry of source) {\n                    yield async function () {\n                        // @ts-expect-error cannot derive type\n                        const node = entry.content;\n                        const buf = dagPB.encode(node);\n                        const updatedCid = await persist(buf, block, {\n                            ...opts,\n                            cidVersion: cid.version\n                        });\n                        if (node.Data == null) {\n                            throw new InvalidPBNodeError(`${updatedCid} had no data`);\n                        }\n                        const unixfs = UnixFS.unmarshal(node.Data);\n                        return {\n                            cid: updatedCid,\n                            size: BigInt(buf.length),\n                            path: entry.path,\n                            unixfs\n                        };\n                    };\n                }\n            }\n        }), async (nodes) => last(nodes));\n        if (root == null) {\n            throw new UnknownError(`Could not chmod ${resolved.cid.toString()}`);\n        }\n        return updatePathCids(root.cid, resolved, blockstore, opts);\n    }\n    const block = await blockstore.get(resolved.cid, options);\n    let metadata;\n    let links = [];\n    if (resolved.cid.code === raw.code) {\n        metadata = new UnixFS({ data: block });\n    }\n    else {\n        const node = dagPB.decode(block);\n        links = node.Links;\n        if (node.Data == null) {\n            throw new InvalidPBNodeError(`${resolved.cid.toString()} had no data`);\n        }\n        metadata = UnixFS.unmarshal(node.Data);\n    }\n    metadata.mtime = mtime;\n    const updatedBlock = dagPB.encode({\n        Data: metadata.marshal(),\n        Links: links\n    });\n    const hash = await sha256.digest(updatedBlock);\n    const updatedCid = CID.create(resolved.cid.version, dagPB.code, hash);\n    await blockstore.put(updatedCid, updatedBlock);\n    return updatePathCids(updatedCid, resolved, blockstore, opts);\n}\n//# sourceMappingURL=touch.js.map","/**\n * @packageDocumentation\n *\n * `@helia/unixfs` is an implementation of a {@link https://github.com/ipfs/specs/blob/main/UNIXFS.md UnixFS filesystem} compatible with {@link https://github.com/ipfs/helia Helia}.\n *\n * See the {@link UnixFS UnixFS interface} for all available operations.\n *\n * @example\n *\n * ```typescript\n * import { createHelia } from 'helia'\n * import { unixfs } from '@helia/unixfs'\n *\n * const helia = createHelia({\n *   // ... helia config\n * })\n * const fs = unixfs(helia)\n *\n * // create an empty dir and a file, then add the file to the dir\n * const emptyDirCid = await fs.addDirectory()\n * const fileCid = await fs.addBytes(Uint8Array.from([0, 1, 2, 3]))\n * const updateDirCid = await fs.cp(fileCid, emptyDirCid, 'foo.txt')\n *\n * // or doing the same thing as a stream\n * for await (const entry of fs.addAll([{\n *   path: 'foo.txt',\n *   content: Uint8Array.from([0, 1, 2, 3])\n * }])) {\n *   console.info(entry)\n * }\n * ```\n *\n * @example\n *\n * Recursively adding a directory (Node.js-compatibly environments only):\n *\n * ```typescript\n * import { globSource } from '@helia/unixfs'\n *\n * for await (const entry of fs.addAll(globSource('path/to/containing/dir', 'glob-pattern'))) {\n *   console.info(entry)\n * }\n * ```\n */\nimport { addAll, addBytes, addByteStream, addDirectory, addFile } from './commands/add.js';\nimport { cat } from './commands/cat.js';\nimport { chmod } from './commands/chmod.js';\nimport { cp } from './commands/cp.js';\nimport { ls } from './commands/ls.js';\nimport { mkdir } from './commands/mkdir.js';\nimport { rm } from './commands/rm.js';\nimport { stat } from './commands/stat.js';\nimport { touch } from './commands/touch.js';\nclass DefaultUnixFS {\n    components;\n    constructor(components) {\n        this.components = components;\n    }\n    async *addAll(source, options = {}) {\n        yield* addAll(source, this.components.blockstore, options);\n    }\n    async addBytes(bytes, options = {}) {\n        return addBytes(bytes, this.components.blockstore, options);\n    }\n    async addByteStream(bytes, options = {}) {\n        return addByteStream(bytes, this.components.blockstore, options);\n    }\n    async addFile(file, options = {}) {\n        return addFile(file, this.components.blockstore, options);\n    }\n    async addDirectory(dir = {}, options = {}) {\n        return addDirectory(dir, this.components.blockstore, options);\n    }\n    async *cat(cid, options = {}) {\n        yield* cat(cid, this.components.blockstore, options);\n    }\n    async chmod(cid, mode, options = {}) {\n        return chmod(cid, mode, this.components.blockstore, options);\n    }\n    async cp(source, target, name, options = {}) {\n        return cp(source, target, name, this.components.blockstore, options);\n    }\n    async *ls(cid, options = {}) {\n        yield* ls(cid, this.components.blockstore, options);\n    }\n    async mkdir(cid, dirname, options = {}) {\n        return mkdir(cid, dirname, this.components.blockstore, options);\n    }\n    async rm(cid, path, options = {}) {\n        return rm(cid, path, this.components.blockstore, options);\n    }\n    async stat(cid, options = {}) {\n        return stat(cid, this.components.blockstore, options);\n    }\n    async touch(cid, options = {}) {\n        return touch(cid, this.components.blockstore, options);\n    }\n}\n/**\n * Create a {@link UnixFS} instance for use with {@link https://github.com/ipfs/helia Helia}\n */\nexport function unixfs(helia) {\n    return new DefaultUnixFS(helia);\n}\nexport { globSource } from './utils/glob-source.js';\nexport { urlSource } from './utils/url-source.js';\n//# sourceMappingURL=index.js.map","export class AbortError extends Error {\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\n//# sourceMappingURL=abort-error.js.map","import { AbortError } from './abort-error.js';\nimport { getIterator } from 'get-iterator';\n// Wrap an iterator to make it abortable, allow cleanup when aborted via onAbort\nexport function abortableSource(source, signal, options) {\n    const opts = options ?? {};\n    const iterator = getIterator(source);\n    async function* abortable() {\n        let nextAbortHandler;\n        const abortHandler = () => {\n            if (nextAbortHandler != null)\n                nextAbortHandler();\n        };\n        signal.addEventListener('abort', abortHandler);\n        while (true) {\n            let result;\n            try {\n                if (signal.aborted) {\n                    const { abortMessage, abortCode } = opts;\n                    throw new AbortError(abortMessage, abortCode);\n                }\n                const abort = new Promise((resolve, reject) => {\n                    nextAbortHandler = () => {\n                        const { abortMessage, abortCode } = opts;\n                        reject(new AbortError(abortMessage, abortCode));\n                    };\n                });\n                // Race the iterator and the abort signals\n                result = await Promise.race([abort, iterator.next()]);\n                nextAbortHandler = null;\n            }\n            catch (err) {\n                signal.removeEventListener('abort', abortHandler);\n                // Might not have been aborted by a known signal\n                const isKnownAborter = err.type === 'aborted' && signal.aborted;\n                if (isKnownAborter && (opts.onAbort != null)) {\n                    // Do any custom abort handling for the iterator\n                    await opts.onAbort(source);\n                }\n                // End the iterator if it is a generator\n                if (typeof iterator.return === 'function') {\n                    try {\n                        const p = iterator.return();\n                        if (p instanceof Promise) { // eslint-disable-line max-depth\n                            p.catch(err => {\n                                if (opts.onReturnError != null) {\n                                    opts.onReturnError(err);\n                                }\n                            });\n                        }\n                    }\n                    catch (err) {\n                        if (opts.onReturnError != null) { // eslint-disable-line max-depth\n                            opts.onReturnError(err);\n                        }\n                    }\n                }\n                if (isKnownAborter && opts.returnOnAbort === true) {\n                    return;\n                }\n                throw err;\n            }\n            if (result.done === true) {\n                break;\n            }\n            yield result.value;\n        }\n        signal.removeEventListener('abort', abortHandler);\n    }\n    return abortable();\n}\nexport function abortableSink(sink, signal, options) {\n    return (source) => sink(abortableSource(source, signal, options));\n}\nexport function abortableDuplex(duplex, signal, options) {\n    return {\n        sink: abortableSink(duplex.sink, signal, {\n            ...options,\n            onAbort: undefined\n        }),\n        source: abortableSource(duplex.source, signal, options)\n    };\n}\nexport { AbortError };\nexport { abortableSink as abortableTransform };\n//# sourceMappingURL=index.js.map","export function getIterator(obj) {\n    if (obj != null) {\n        if (typeof obj[Symbol.iterator] === 'function') {\n            return obj[Symbol.iterator]();\n        }\n        if (typeof obj[Symbol.asyncIterator] === 'function') {\n            return obj[Symbol.asyncIterator]();\n        }\n        if (typeof obj.next === 'function') {\n            return obj; // probably an iterator\n        }\n    }\n    throw new Error('argument is not an iterator or iterable');\n}\n//# sourceMappingURL=index.js.map","export default function arrayShuffle(array) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new TypeError(`Expected an array, got ${typeof array}`);\n\t}\n\n\tarray = [...array];\n\n\tfor (let index = array.length - 1; index > 0; index--) {\n\t\tconst newIndex = Math.floor(Math.random() * (index + 1));\n\t\t[array[index], array[newIndex]] = [array[newIndex], array[index]];\n\t}\n\n\treturn array;\n}\n","/* eslint-env browser */\nimport browserReadableStreamToIt from 'browser-readablestream-to-it';\nexport default function blobToIt(blob) {\n    if (typeof blob.stream === 'function') {\n        return browserReadableStreamToIt(blob.stream());\n    }\n    // firefox < 69 does not support blob.stream()\n    // @ts-expect-error - response.body is optional, but in practice it's a stream.\n    return browserReadableStreamToIt(new Response(blob).body);\n}\n//# sourceMappingURL=index.js.map","import errCode from 'err-code';\nexport function openFailedError(err) {\n    err = err ?? new Error('Open failed');\n    return errCode(err, 'ERR_OPEN_FAILED');\n}\nexport function closeFailedError(err) {\n    err = err ?? new Error('Close failed');\n    return errCode(err, 'ERR_CLOSE_FAILED');\n}\nexport function putFailedError(err) {\n    err = err ?? new Error('Put failed');\n    return errCode(err, 'ERR_PUT_FAILED');\n}\nexport function getFailedError(err) {\n    err = err ?? new Error('Get failed');\n    return errCode(err, 'ERR_GET_FAILED');\n}\nexport function deleteFailedError(err) {\n    err = err ?? new Error('Delete failed');\n    return errCode(err, 'ERR_DELETE_FAILED');\n}\nexport function hasFailedError(err) {\n    err = err ?? new Error('Has failed');\n    return errCode(err, 'ERR_HAS_FAILED');\n}\nexport function notFoundError(err) {\n    err = err ?? new Error('Not Found');\n    return errCode(err, 'ERR_NOT_FOUND');\n}\nexport function abortedError(err) {\n    err = err ?? new Error('Aborted');\n    return errCode(err, 'ERR_ABORTED');\n}\n//# sourceMappingURL=errors.js.map","export class BaseBlockstore {\n    has(key, options) {\n        return Promise.reject(new Error('.has is not implemented'));\n    }\n    put(key, val, options) {\n        return Promise.reject(new Error('.put is not implemented'));\n    }\n    async *putMany(source, options) {\n        for await (const { cid, block } of source) {\n            await this.put(cid, block, options);\n            yield cid;\n        }\n    }\n    get(key, options) {\n        return Promise.reject(new Error('.get is not implemented'));\n    }\n    async *getMany(source, options) {\n        for await (const key of source) {\n            yield {\n                cid: key,\n                block: await this.get(key, options)\n            };\n        }\n    }\n    async delete(key, options) {\n        await Promise.reject(new Error('.delete is not implemented'));\n    }\n    async *deleteMany(source, options) {\n        for await (const key of source) {\n            await this.delete(key, options);\n            yield key;\n        }\n    }\n    /**\n     * Extending classes should override `query` or implement this method\n     */\n    async *getAll(options) {\n        throw new Error('.getAll is not implemented');\n    }\n}\n//# sourceMappingURL=base.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","import { base32 } from 'multiformats/bases/base32';\nimport { CID } from 'multiformats/cid';\nimport * as raw from 'multiformats/codecs/raw';\nimport * as Digest from 'multiformats/hashes/digest';\nimport { BaseBlockstore } from './base.js';\nimport * as Errors from './errors.js';\nexport class MemoryBlockstore extends BaseBlockstore {\n    data;\n    constructor() {\n        super();\n        this.data = new Map();\n    }\n    put(key, val) {\n        this.data.set(base32.encode(key.multihash.bytes), val);\n        return key;\n    }\n    get(key) {\n        const buf = this.data.get(base32.encode(key.multihash.bytes));\n        if (buf == null) {\n            throw Errors.notFoundError();\n        }\n        return buf;\n    }\n    has(key) {\n        return this.data.has(base32.encode(key.multihash.bytes));\n    }\n    async delete(key) {\n        this.data.delete(base32.encode(key.multihash.bytes));\n    }\n    async *getAll() {\n        for (const [key, value] of this.data.entries()) {\n            yield {\n                cid: CID.createV1(raw.code, Digest.decode(base32.decode(key))),\n                block: value\n            };\n        }\n    }\n}\n//# sourceMappingURL=memory.js.map","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\nimport deferred from 'p-defer';\nimport { FIFO } from './fifo.js';\nexport class AbortError extends Error {\n    type;\n    code;\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\nexport function pushable(options = {}) {\n    const getNext = (buffer) => {\n        const next = buffer.shift();\n        if (next == null) {\n            return { done: true };\n        }\n        if (next.error != null) {\n            throw next.error;\n        }\n        return {\n            done: next.done === true,\n            // @ts-expect-error if done is false, value will be present\n            value: next.value\n        };\n    };\n    return _pushable(getNext, options);\n}\nexport function pushableV(options = {}) {\n    const getNext = (buffer) => {\n        let next;\n        const values = [];\n        while (!buffer.isEmpty()) {\n            next = buffer.shift();\n            if (next == null) {\n                break;\n            }\n            if (next.error != null) {\n                throw next.error;\n            }\n            if (next.done === false) {\n                // @ts-expect-error if done is false value should be pushed\n                values.push(next.value);\n            }\n        }\n        if (next == null) {\n            return { done: true };\n        }\n        return {\n            done: next.done === true,\n            value: values\n        };\n    };\n    return _pushable(getNext, options);\n}\nfunction _pushable(getNext, options) {\n    options = options ?? {};\n    let onEnd = options.onEnd;\n    let buffer = new FIFO();\n    let pushable;\n    let onNext;\n    let ended;\n    let drain = deferred();\n    const waitNext = async () => {\n        try {\n            if (!buffer.isEmpty()) {\n                return getNext(buffer);\n            }\n            if (ended) {\n                return { done: true };\n            }\n            return await new Promise((resolve, reject) => {\n                onNext = (next) => {\n                    onNext = null;\n                    buffer.push(next);\n                    try {\n                        resolve(getNext(buffer));\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                    return pushable;\n                };\n            });\n        }\n        finally {\n            if (buffer.isEmpty()) {\n                // settle promise in the microtask queue to give consumers a chance to\n                // await after calling .push\n                queueMicrotask(() => {\n                    drain.resolve();\n                    drain = deferred();\n                });\n            }\n        }\n    };\n    const bufferNext = (next) => {\n        if (onNext != null) {\n            return onNext(next);\n        }\n        buffer.push(next);\n        return pushable;\n    };\n    const bufferError = (err) => {\n        buffer = new FIFO();\n        if (onNext != null) {\n            return onNext({ error: err });\n        }\n        buffer.push({ error: err });\n        return pushable;\n    };\n    const push = (value) => {\n        if (ended) {\n            return pushable;\n        }\n        // @ts-expect-error `byteLength` is not declared on PushType\n        if (options?.objectMode !== true && value?.byteLength == null) {\n            throw new Error('objectMode was not true but tried to push non-Uint8Array value');\n        }\n        return bufferNext({ done: false, value });\n    };\n    const end = (err) => {\n        if (ended)\n            return pushable;\n        ended = true;\n        return (err != null) ? bufferError(err) : bufferNext({ done: true });\n    };\n    const _return = () => {\n        buffer = new FIFO();\n        end();\n        return { done: true };\n    };\n    const _throw = (err) => {\n        end(err);\n        return { done: true };\n    };\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next: waitNext,\n        return: _return,\n        throw: _throw,\n        push,\n        end,\n        get readableLength() {\n            return buffer.size;\n        },\n        onEmpty: async (options) => {\n            const signal = options?.signal;\n            signal?.throwIfAborted();\n            if (buffer.isEmpty()) {\n                return;\n            }\n            let cancel;\n            let listener;\n            if (signal != null) {\n                cancel = new Promise((resolve, reject) => {\n                    listener = () => {\n                        reject(new AbortError());\n                    };\n                    signal.addEventListener('abort', listener);\n                });\n            }\n            try {\n                await Promise.race([\n                    drain.promise,\n                    cancel\n                ]);\n            }\n            finally {\n                if (listener != null && signal != null) {\n                    signal?.removeEventListener('abort', listener);\n                }\n            }\n        }\n    };\n    if (onEnd == null) {\n        return pushable;\n    }\n    const _pushable = pushable;\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next() {\n            return _pushable.next();\n        },\n        throw(err) {\n            _pushable.throw(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        return() {\n            _pushable.return();\n            if (onEnd != null) {\n                onEnd();\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        push,\n        end(err) {\n            _pushable.end(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return pushable;\n        },\n        get readableLength() {\n            return _pushable.readableLength;\n        }\n    };\n    return pushable;\n}\n//# sourceMappingURL=index.js.map","import { logger } from '@libp2p/logger';\nimport drain from 'it-drain';\nimport filter from 'it-filter';\nimport merge from 'it-merge';\nimport { pushable } from 'it-pushable';\nimport { BaseBlockstore } from './base.js';\nimport * as Errors from './errors.js';\nconst log = logger('blockstore:core:tiered');\n/**\n * A blockstore that can combine multiple stores. Puts and deletes\n * will write through to all blockstores. Has and get will\n * try each store sequentially. getAll will use every store but also\n * deduplicate any yielded pairs.\n */\nexport class TieredBlockstore extends BaseBlockstore {\n    stores;\n    constructor(stores) {\n        super();\n        this.stores = stores.slice();\n    }\n    async put(key, value, options) {\n        try {\n            await Promise.all(this.stores.map(async (store) => { await store.put(key, value, options); }));\n            return key;\n        }\n        catch (err) {\n            throw Errors.putFailedError(err);\n        }\n    }\n    async get(key, options) {\n        for (const store of this.stores) {\n            try {\n                const res = await store.get(key, options);\n                if (res != null)\n                    return res;\n            }\n            catch (err) {\n                log.error(err);\n            }\n        }\n        throw Errors.notFoundError();\n    }\n    async has(key, options) {\n        for (const s of this.stores) {\n            if (await s.has(key, options)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    async delete(key, options) {\n        try {\n            await Promise.all(this.stores.map(async (store) => { await store.delete(key, options); }));\n        }\n        catch (err) {\n            throw Errors.deleteFailedError(err);\n        }\n    }\n    async *putMany(source, options = {}) {\n        let error;\n        const pushables = this.stores.map(store => {\n            const source = pushable({\n                objectMode: true\n            });\n            drain(store.putMany(source, options))\n                .catch(err => {\n                // store threw while putting, make sure we bubble the error up\n                error = err;\n            });\n            return source;\n        });\n        try {\n            for await (const pair of source) {\n                if (error != null) {\n                    throw error;\n                }\n                pushables.forEach(p => p.push(pair));\n                yield pair.cid;\n            }\n        }\n        finally {\n            pushables.forEach(p => p.end());\n        }\n    }\n    async *deleteMany(source, options = {}) {\n        let error;\n        const pushables = this.stores.map(store => {\n            const source = pushable({\n                objectMode: true\n            });\n            drain(store.deleteMany(source, options))\n                .catch(err => {\n                // store threw while deleting, make sure we bubble the error up\n                error = err;\n            });\n            return source;\n        });\n        try {\n            for await (const key of source) {\n                if (error != null) {\n                    throw error;\n                }\n                pushables.forEach(p => p.push(key));\n                yield key;\n            }\n        }\n        finally {\n            pushables.forEach(p => p.end());\n        }\n    }\n    async *getAll(options) {\n        // deduplicate yielded pairs\n        const seen = new Set();\n        yield* filter(merge(...this.stores.map(s => s.getAll(options))), (pair) => {\n            const cidStr = pair.cid.toString();\n            if (seen.has(cidStr)) {\n                return false;\n            }\n            seen.add(cidStr);\n            return true;\n        });\n    }\n}\n//# sourceMappingURL=tiered.js.map","import * as ErrorsImport from './errors.js';\nexport { BaseBlockstore } from './base.js';\nexport { MemoryBlockstore } from './memory.js';\nexport { BlackHoleBlockstore } from './black-hole.js';\nexport { TieredBlockstore } from './tiered.js';\nexport const Errors = {\n    ...ErrorsImport\n};\n//# sourceMappingURL=index.js.map","import drain from 'it-drain'\nimport filter from 'it-filter'\nimport take from 'it-take'\nimport all from 'it-all'\n\n/**\n * Collect all values from the iterable and sort them using\n * the passed sorter function\n *\n * @template T\n * @param {AsyncIterable<T> | Iterable<T>} iterable\n * @param {(a: T, b: T) => -1 | 0 | 1} sorter\n * @returns {AsyncIterable<T>}\n */\nconst sortAll = (iterable, sorter) => {\n  return (async function * () {\n    const values = await all(iterable)\n    yield * values.sort(sorter)\n  })()\n}\n\n/**\n * @typedef {import('interface-blockstore').Options} Options\n * @typedef {import('interface-blockstore').Pair} Pair\n * @typedef {import('interface-blockstore').Blockstore} Blockstore\n * @typedef {import('interface-blockstore').Query} Query\n * @typedef {import('interface-blockstore').KeyQuery} KeyQuery\n * @typedef {import('interface-blockstore').Batch} Batch\n *\n * @typedef {import('multiformats').CID} CID\n */\n\n/**\n * @template O\n * @typedef {import('interface-store').AwaitIterable<O>} AwaitIterable\n */\n\n/**\n * @implements {Blockstore}\n */\nexport class BaseBlockstore {\n  /**\n   * @returns {Promise<void>}\n   */\n  open () {\n    return Promise.reject(new Error('.open is not implemented'))\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  close () {\n    return Promise.reject(new Error('.close is not implemented'))\n  }\n\n  /**\n   * @param {CID} key\n   * @param {Uint8Array} val\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  put (key, val, options) {\n    return Promise.reject(new Error('.put is not implemented'))\n  }\n\n  /**\n   * @param {CID} key\n   * @param {Options} [options]\n   * @returns {Promise<Uint8Array>}\n   */\n  get (key, options) {\n    return Promise.reject(new Error('.get is not implemented'))\n  }\n\n  /**\n   * @param {CID} key\n   * @param {Options} [options]\n   * @returns {Promise<boolean>}\n   */\n  has (key, options) {\n    return Promise.reject(new Error('.has is not implemented'))\n  }\n\n  /**\n   * @param {CID} key\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  delete (key, options) {\n    return Promise.reject(new Error('.delete is not implemented'))\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    for await (const { key, value } of source) {\n      await this.put(key, value, options)\n      yield { key, value }\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<CID>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Uint8Array>}\n   */\n  async * getMany (source, options = {}) {\n    for await (const key of source) {\n      yield this.get(key, options)\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<CID>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<CID>}\n   */\n  async * deleteMany (source, options = {}) {\n    for await (const key of source) {\n      await this.delete(key, options)\n      yield key\n    }\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    /** @type {Pair[]} */\n    let puts = []\n    /** @type {CID[]} */\n    let dels = []\n\n    return {\n      put (key, value) {\n        puts.push({ key, value })\n      },\n\n      delete (key) {\n        dels.push(key)\n      },\n      commit: async (options) => {\n        await drain(this.putMany(puts, options))\n        puts = []\n        await drain(this.deleteMany(dels, options))\n        dels = []\n      }\n    }\n  }\n\n  /**\n   * Extending classes should override `query` or implement this method\n   *\n   * @param {Query} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _all (q, options) {\n    throw new Error('._all is not implemented')\n  }\n\n  /**\n   * Extending classes should override `queryKeys` or implement this method\n   *\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<CID>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _allKeys (q, options) {\n    throw new Error('._allKeys is not implemented')\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    let it = this._all(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (/** @type {Pair} */ e) =>\n        e.key.toString().startsWith(q.prefix || '')\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= (q.offset || 0))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    let it = this._allKeys(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (/** @type {CID} */ cid) => cid.toString().startsWith(q.prefix || ''))\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= /** @type {number} */ (q.offset))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n}\n","/**\n * Collects all values from an (async) iterable and returns them as an array\n */\nexport default async function all(source) {\n    const arr = [];\n    for await (const entry of source) {\n        arr.push(entry);\n    }\n    return arr;\n}\n//# sourceMappingURL=index.js.map","import drain from 'it-drain'\nimport { pushable } from 'it-pushable'\nimport { Key } from 'interface-datastore/key'\nimport { CID } from 'multiformats/cid'\nimport * as raw from 'multiformats/codecs/raw'\nimport * as Digest from 'multiformats/hashes/digest'\nimport { base32, base32pad } from 'multiformats/bases/base32'\nimport { base58btc } from 'multiformats/bases/base58'\nimport errcode from 'err-code'\nimport { BaseBlockstore } from 'blockstore-core/base'\n\n/**\n * Transform a cid to the appropriate datastore key.\n *\n * @param {CID} cid\n * @returns {Key}\n */\nfunction cidToKey (cid) {\n  const c = CID.asCID(cid)\n\n  if (!c) {\n    throw errcode(new Error('Not a valid cid'), 'ERR_INVALID_CID')\n  }\n\n  return new Key('/' + base32.encode(c.multihash.bytes).slice(1).toUpperCase(), false)\n}\n\n/**\n * Transform a datastore Key instance to a CID\n * As Key is a multihash of the CID, it is reconstructed using IPLD's RAW codec.\n * Hence it is highly probable that stored CID will differ from a CID retrieved from blockstore.\n *\n * @param {Key} key\n * @returns {CID}\n */\nfunction keyToCid (key) {\n  // Block key is of the form <base32 encoded string>\n  return CID.createV1(raw.code, Digest.decode(base32.decode('b' + key.toString().slice(1).toLowerCase())))\n}\n\n/**\n * Tries to decode a prefix as the first part of a CID and then\n * strip off the version and codec bytes to just leave part of\n * the multihash.\n *\n * Only really works if the prefix length aligns with the byte\n * boundaries of the encoding.\n *\n * @param {string} prefix\n * @returns {string}\n */\nfunction convertPrefix (prefix) {\n  const firstChar = prefix.substring(0, 1)\n\n  if (firstChar === '/') {\n    return convertPrefix(prefix.substring(1))\n  }\n\n  /** @type {(input: string) => Uint8Array } */\n  let decoder\n\n  if (firstChar.toLowerCase() === 'b') {\n    // v1 cid prefix, remove version and codec bytes\n    decoder = (input) => base32.decode(input.toLowerCase()).subarray(2)\n  } else if (firstChar.toLowerCase() === 'c') {\n    // v1 cid prefix, remove version and codec bytes\n    decoder = (input) => base32pad.decode(input.toLowerCase()).subarray(2)\n  } else if (firstChar === 'z') {\n    // v1 cid\n    decoder = (input) => base58btc.decode(input).subarray(2)\n  } else if (firstChar === 'Q') {\n    // v0 cid prefix\n    decoder = (input) => base58btc.decode('z' + input)\n  } else {\n    decoder = (input) => base32.decode('b' + input.toLowerCase()).subarray(2)\n  }\n\n  let bytes\n\n  // find the longest prefix that we can safely decode\n  for (let i = 1; i < prefix.length; i++) {\n    try {\n      bytes = decoder(prefix.substring(0, i))\n    } catch (/** @type {any} */ err) {\n      if (err.message !== 'Unexpected end of data') {\n        throw err\n      }\n    }\n  }\n\n  let str = '/C'\n\n  if (bytes) {\n    // slice one character from the end of the string to ensure we don't end up\n    // with a padded value which could have a non-matching string at the end\n    str = `/${base32.encode(bytes).slice(1, -1).toUpperCase() || 'C'}`\n  }\n\n  return str\n}\n\n/**\n * @param {import('interface-blockstore').Query} query\n * @returns {import('interface-datastore').Query}\n */\nfunction convertQuery (query) {\n  return {\n    ...query,\n    prefix: query.prefix ? convertPrefix(query.prefix) : undefined,\n    filters: query.filters\n      ? query.filters.map(\n        filter => (pair) => {\n          return filter({ key: keyToCid(pair.key), value: pair.value })\n        }\n      )\n      : undefined,\n    orders: query.orders\n      ? query.orders.map(\n        order => (a, b) => {\n          return order({ key: keyToCid(a.key), value: a.value }, { key: keyToCid(b.key), value: b.value })\n        }\n      )\n      : undefined\n  }\n}\n\n/**\n * @param {import('interface-blockstore').KeyQuery} query\n * @returns {import('interface-datastore').KeyQuery}\n */\nfunction convertKeyQuery (query) {\n  return {\n    ...query,\n    prefix: query.prefix ? convertPrefix(query.prefix) : undefined,\n    filters: query.filters\n      ? query.filters.map(\n        filter => (key) => {\n          return filter(keyToCid(key))\n        }\n      )\n      : undefined,\n    orders: query.orders\n      ? query.orders.map(\n        order => (a, b) => {\n          return order(keyToCid(a), keyToCid(b))\n        }\n      )\n      : undefined\n  }\n}\n\n/**\n * @typedef {import('interface-blockstore').Query} Query\n * @typedef {import('interface-blockstore').KeyQuery} KeyQuery\n * @typedef {import('interface-blockstore').Pair} Pair\n * @typedef {import('interface-blockstore').Options} Options\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-blockstore').Blockstore} Blockstore\n */\n\n/**\n * @implements {Blockstore}\n */\nexport class BlockstoreDatastoreAdapter extends BaseBlockstore {\n  /**\n   * @param {Datastore} datastore\n   */\n  constructor (datastore) {\n    super()\n\n    this.child = datastore\n  }\n\n  open () {\n    return this.child.open()\n  }\n\n  close () {\n    return this.child.close()\n  }\n\n  /**\n   * @param {Query} query\n   * @param {Options} [options]\n   */\n  async * query (query, options) {\n    for await (const { key, value } of this.child.query(convertQuery(query), options)) {\n      yield { key: keyToCid(key), value }\n    }\n  }\n\n  /**\n   * @param {KeyQuery} query\n   * @param {Options} [options]\n   */\n  async * queryKeys (query, options) {\n    for await (const key of this.child.queryKeys(convertKeyQuery(query), options)) {\n      yield keyToCid(key)\n    }\n  }\n\n  /**\n   * @param {CID} cid\n   * @param {Options} [options]\n   * @returns\n   */\n  async get (cid, options) {\n    return this.child.get(cidToKey(cid), options)\n  }\n\n  /**\n   * @param {AsyncIterable<CID> | Iterable<CID>} cids\n   * @param {Options} [options]\n   */\n  async * getMany (cids, options) {\n    for await (const cid of cids) {\n      yield this.get(cid, options)\n    }\n  }\n\n  /**\n   * @param {CID} cid\n   * @param {Uint8Array} value\n   * @param {Options} [options]\n   */\n  async put (cid, value, options) {\n    await this.child.put(cidToKey(cid), value, options)\n  }\n\n  /**\n   * @param {AsyncIterable<Pair> | Iterable<Pair>} blocks\n   * @param {Options} [options]\n   */\n  async * putMany (blocks, options) { // eslint-disable-line require-await\n    // we cannot simply chain to `store.putMany` because we convert a CID into\n    // a key based on the multihash only, so we lose the version & codec and\n    // cannot give the user back the CID they used to create the block, so yield\n    // to `store.putMany` but return the actual block the user passed in.\n    //\n    // nb. we want to use `store.putMany` here so bitswap can control batching\n    // up block HAVEs to send to the network - if we use multiple `store.put`s\n    // it will not be able to guess we are about to `store.put` more blocks\n    const output = pushable({\n      objectMode: true\n    })\n\n    // process.nextTick runs on the microtask queue, setImmediate runs on the next\n    // event loop iteration so is slower. Use process.nextTick if it is available.\n    const runner = globalThis.process && globalThis.process.nextTick ? globalThis.process.nextTick : (globalThis.setImmediate || globalThis.setTimeout)\n\n    runner(async () => {\n      try {\n        const store = this.child\n\n        await drain(this.child.putMany(async function * () {\n          for await (const block of blocks) {\n            const key = cidToKey(block.key)\n            const exists = await store.has(key, options)\n\n            if (!exists) {\n              yield { key, value: block.value }\n            }\n\n            // there is an assumption here that after the yield has completed\n            // the underlying datastore has finished writing the block\n            output.push(block)\n          }\n        }()))\n\n        output.end()\n      } catch (/** @type {any} */ err) {\n        output.end(err)\n      }\n    })\n\n    yield * output\n  }\n\n  /**\n   * @param {CID} cid\n   * @param {Options} [options]\n   */\n  has (cid, options) {\n    return this.child.has(cidToKey(cid), options)\n  }\n\n  /**\n   * @param {CID} cid\n   * @param {Options} [options]\n   */\n  delete (cid, options) {\n    return this.child.delete(cidToKey(cid), options)\n  }\n\n  /**\n   * @param {AsyncIterable<CID> | Iterable<CID>} cids\n   * @param {Options} [options]\n   */\n  deleteMany (cids, options) {\n    const out = pushable({\n      objectMode: true\n    })\n\n    drain(this.child.deleteMany((async function * () {\n      for await (const cid of cids) {\n        yield cidToKey(cid)\n\n        out.push(cid)\n      }\n\n      out.end()\n    }()), options)).catch(err => {\n      out.end(err)\n    })\n\n    return out\n  }\n}\n","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","import { BaseBlockstore, Errors } from 'blockstore-core';\nimport { openDB, deleteDB } from 'idb';\nimport { base32upper } from 'multiformats/bases/base32';\nimport { CID } from 'multiformats/cid';\nimport * as raw from 'multiformats/codecs/raw';\nimport * as Digest from 'multiformats/hashes/digest';\nexport class IDBBlockstore extends BaseBlockstore {\n    location;\n    version;\n    db;\n    base;\n    constructor(location, init = {}) {\n        super();\n        this.location = `${init.prefix ?? ''}${location}`;\n        this.version = init.version ?? 1;\n        // this.transactionQueue = new PQueue({ concurrency: 1 })\n        this.base = init.base ?? base32upper;\n    }\n    #encode(cid) {\n        return `/${this.base.encoder.encode(cid.multihash.bytes)}`;\n    }\n    #decode(key) {\n        return CID.createV1(raw.code, Digest.decode(this.base.decoder.decode(key.substring(1))));\n    }\n    async open() {\n        try {\n            const location = this.location;\n            this.db = await openDB(location, this.version, {\n                upgrade(db) {\n                    db.createObjectStore(location);\n                }\n            });\n        }\n        catch (err) {\n            throw Errors.openFailedError(err);\n        }\n    }\n    async close() {\n        this.db?.close();\n    }\n    async put(key, val) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        try {\n            await this.db.put(this.location, val, this.#encode(key));\n            return key;\n        }\n        catch (err) {\n            throw Errors.putFailedError(err);\n        }\n    }\n    async get(key) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        let val;\n        try {\n            val = await this.db.get(this.location, this.#encode(key));\n        }\n        catch (err) {\n            throw Errors.putFailedError(err);\n        }\n        if (val === undefined) {\n            throw Errors.notFoundError();\n        }\n        return val;\n    }\n    async delete(key) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        try {\n            await this.db.delete(this.location, this.#encode(key));\n        }\n        catch (err) {\n            throw Errors.putFailedError(err);\n        }\n    }\n    async has(key) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        try {\n            return Boolean(await this.db.getKey(this.location, this.#encode(key)));\n        }\n        catch (err) {\n            throw Errors.putFailedError(err);\n        }\n    }\n    async *getAll(options) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        for (const key of await this.db.getAllKeys(this.location)) {\n            const cid = this.#decode(key.toString()); // eslint-disable-line @typescript-eslint/no-base-to-string\n            const block = await this.get(cid);\n            yield { cid, block };\n        }\n    }\n    async destroy() {\n        await deleteDB(this.location);\n    }\n}\n//# sourceMappingURL=index.js.map","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","/**\n * Turns a browser readable stream into an async iterable. Async iteration over\n * returned iterable will lock give stream, preventing any other consumer from\n * acquiring a reader. The lock will be released if iteration loop is broken. To\n * prevent stream cancelling optional `{ preventCancel: true }` could be passed\n * as a second argument.\n */\nexport default async function* browserReadableStreamToIt(stream, options = {}) {\n    const reader = stream.getReader();\n    try {\n        while (true) {\n            const result = await reader.read();\n            if (result.done) {\n                return;\n            }\n            yield result.value;\n        }\n    }\n    finally {\n        if (options.preventCancel !== true) {\n            await reader.cancel();\n        }\n        reader.releaseLock();\n    }\n}\n//# sourceMappingURL=index.js.map","export default function accessor(buf) {\n    if (buf instanceof Uint8Array) {\n        return {\n            get(index) {\n                return buf[index];\n            },\n            set(index, value) {\n                buf[index] = value;\n            }\n        };\n    }\n    return {\n        get(index) {\n            return buf.get(index);\n        },\n        set(index, value) {\n            buf.set(index, value);\n        }\n    };\n}\n//# sourceMappingURL=index.js.map","import {\n  Token,\n  Type\n} from './token.js';\nimport {\n  decodeErrPrefix,\n  assertEnoughData\n} from './common.js';\nexport const uintBoundaries = [\n  24,\n  256,\n  65536,\n  4294967296,\n  BigInt('18446744073709551616')\n];\nexport function readUint8(data, offset, options) {\n  assertEnoughData(data, offset, 1);\n  const value = data[offset];\n  if (options.strict === true && value < uintBoundaries[0]) {\n    throw new Error(`${ decodeErrPrefix } integer encoded in more bytes than necessary (strict decode)`);\n  }\n  return value;\n}\nexport function readUint16(data, offset, options) {\n  assertEnoughData(data, offset, 2);\n  const value = data[offset] << 8 | data[offset + 1];\n  if (options.strict === true && value < uintBoundaries[1]) {\n    throw new Error(`${ decodeErrPrefix } integer encoded in more bytes than necessary (strict decode)`);\n  }\n  return value;\n}\nexport function readUint32(data, offset, options) {\n  assertEnoughData(data, offset, 4);\n  const value = data[offset] * 16777216 + (data[offset + 1] << 16) + (data[offset + 2] << 8) + data[offset + 3];\n  if (options.strict === true && value < uintBoundaries[2]) {\n    throw new Error(`${ decodeErrPrefix } integer encoded in more bytes than necessary (strict decode)`);\n  }\n  return value;\n}\nexport function readUint64(data, offset, options) {\n  assertEnoughData(data, offset, 8);\n  const hi = data[offset] * 16777216 + (data[offset + 1] << 16) + (data[offset + 2] << 8) + data[offset + 3];\n  const lo = data[offset + 4] * 16777216 + (data[offset + 5] << 16) + (data[offset + 6] << 8) + data[offset + 7];\n  const value = (BigInt(hi) << BigInt(32)) + BigInt(lo);\n  if (options.strict === true && value < uintBoundaries[3]) {\n    throw new Error(`${ decodeErrPrefix } integer encoded in more bytes than necessary (strict decode)`);\n  }\n  if (value <= Number.MAX_SAFE_INTEGER) {\n    return Number(value);\n  }\n  if (options.allowBigInt === true) {\n    return value;\n  }\n  throw new Error(`${ decodeErrPrefix } integers outside of the safe integer range are not supported`);\n}\nexport function decodeUint8(data, pos, _minor, options) {\n  return new Token(Type.uint, readUint8(data, pos + 1, options), 2);\n}\nexport function decodeUint16(data, pos, _minor, options) {\n  return new Token(Type.uint, readUint16(data, pos + 1, options), 3);\n}\nexport function decodeUint32(data, pos, _minor, options) {\n  return new Token(Type.uint, readUint32(data, pos + 1, options), 5);\n}\nexport function decodeUint64(data, pos, _minor, options) {\n  return new Token(Type.uint, readUint64(data, pos + 1, options), 9);\n}\nexport function encodeUint(buf, token) {\n  return encodeUintValue(buf, 0, token.value);\n}\nexport function encodeUintValue(buf, major, uint) {\n  if (uint < uintBoundaries[0]) {\n    const nuint = Number(uint);\n    buf.push([major | nuint]);\n  } else if (uint < uintBoundaries[1]) {\n    const nuint = Number(uint);\n    buf.push([\n      major | 24,\n      nuint\n    ]);\n  } else if (uint < uintBoundaries[2]) {\n    const nuint = Number(uint);\n    buf.push([\n      major | 25,\n      nuint >>> 8,\n      nuint & 255\n    ]);\n  } else if (uint < uintBoundaries[3]) {\n    const nuint = Number(uint);\n    buf.push([\n      major | 26,\n      nuint >>> 24 & 255,\n      nuint >>> 16 & 255,\n      nuint >>> 8 & 255,\n      nuint & 255\n    ]);\n  } else {\n    const buint = BigInt(uint);\n    if (buint < uintBoundaries[4]) {\n      const set = [\n        major | 27,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0\n      ];\n      let lo = Number(buint & BigInt(4294967295));\n      let hi = Number(buint >> BigInt(32) & BigInt(4294967295));\n      set[8] = lo & 255;\n      lo = lo >> 8;\n      set[7] = lo & 255;\n      lo = lo >> 8;\n      set[6] = lo & 255;\n      lo = lo >> 8;\n      set[5] = lo & 255;\n      set[4] = hi & 255;\n      hi = hi >> 8;\n      set[3] = hi & 255;\n      hi = hi >> 8;\n      set[2] = hi & 255;\n      hi = hi >> 8;\n      set[1] = hi & 255;\n      buf.push(set);\n    } else {\n      throw new Error(`${ decodeErrPrefix } encountered BigInt larger than allowable range`);\n    }\n  }\n}\nencodeUint.encodedSize = function encodedSize(token) {\n  return encodeUintValue.encodedSize(token.value);\n};\nencodeUintValue.encodedSize = function encodedSize(uint) {\n  if (uint < uintBoundaries[0]) {\n    return 1;\n  }\n  if (uint < uintBoundaries[1]) {\n    return 2;\n  }\n  if (uint < uintBoundaries[2]) {\n    return 3;\n  }\n  if (uint < uintBoundaries[3]) {\n    return 5;\n  }\n  return 9;\n};\nencodeUint.compareTokens = function compareTokens(tok1, tok2) {\n  return tok1.value < tok2.value ? -1 : tok1.value > tok2.value ? 1 : 0;\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport * as uint from './0uint.js';\nimport { decodeErrPrefix } from './common.js';\nexport function decodeNegint8(data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint8(data, pos + 1, options), 2);\n}\nexport function decodeNegint16(data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint16(data, pos + 1, options), 3);\n}\nexport function decodeNegint32(data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint32(data, pos + 1, options), 5);\n}\nconst neg1b = BigInt(-1);\nconst pos1b = BigInt(1);\nexport function decodeNegint64(data, pos, _minor, options) {\n  const int = uint.readUint64(data, pos + 1, options);\n  if (typeof int !== 'bigint') {\n    const value = -1 - int;\n    if (value >= Number.MIN_SAFE_INTEGER) {\n      return new Token(Type.negint, value, 9);\n    }\n  }\n  if (options.allowBigInt !== true) {\n    throw new Error(`${ decodeErrPrefix } integers outside of the safe integer range are not supported`);\n  }\n  return new Token(Type.negint, neg1b - BigInt(int), 9);\n}\nexport function encodeNegint(buf, token) {\n  const negint = token.value;\n  const unsigned = typeof negint === 'bigint' ? negint * neg1b - pos1b : negint * -1 - 1;\n  uint.encodeUintValue(buf, token.type.majorEncoded, unsigned);\n}\nencodeNegint.encodedSize = function encodedSize(token) {\n  const negint = token.value;\n  const unsigned = typeof negint === 'bigint' ? negint * neg1b - pos1b : negint * -1 - 1;\n  if (unsigned < uint.uintBoundaries[0]) {\n    return 1;\n  }\n  if (unsigned < uint.uintBoundaries[1]) {\n    return 2;\n  }\n  if (unsigned < uint.uintBoundaries[2]) {\n    return 3;\n  }\n  if (unsigned < uint.uintBoundaries[3]) {\n    return 5;\n  }\n  return 9;\n};\nencodeNegint.compareTokens = function compareTokens(tok1, tok2) {\n  return tok1.value < tok2.value ? 1 : tok1.value > tok2.value ? -1 : 0;\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport {\n  assertEnoughData,\n  decodeErrPrefix\n} from './common.js';\nimport * as uint from './0uint.js';\nimport {\n  compare,\n  fromString,\n  slice\n} from './byte-utils.js';\nfunction toToken(data, pos, prefix, length) {\n  assertEnoughData(data, pos, prefix + length);\n  const buf = slice(data, pos + prefix, pos + prefix + length);\n  return new Token(Type.bytes, buf, prefix + length);\n}\nexport function decodeBytesCompact(data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor);\n}\nexport function decodeBytes8(data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options));\n}\nexport function decodeBytes16(data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options));\n}\nexport function decodeBytes32(data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options));\n}\nexport function decodeBytes64(data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options);\n  if (typeof l === 'bigint') {\n    throw new Error(`${ decodeErrPrefix } 64-bit integer bytes lengths not supported`);\n  }\n  return toToken(data, pos, 9, l);\n}\nfunction tokenBytes(token) {\n  if (token.encodedBytes === undefined) {\n    token.encodedBytes = token.type === Type.string ? fromString(token.value) : token.value;\n  }\n  return token.encodedBytes;\n}\nexport function encodeBytes(buf, token) {\n  const bytes = tokenBytes(token);\n  uint.encodeUintValue(buf, token.type.majorEncoded, bytes.length);\n  buf.push(bytes);\n}\nencodeBytes.encodedSize = function encodedSize(token) {\n  const bytes = tokenBytes(token);\n  return uint.encodeUintValue.encodedSize(bytes.length) + bytes.length;\n};\nencodeBytes.compareTokens = function compareTokens(tok1, tok2) {\n  return compareBytes(tokenBytes(tok1), tokenBytes(tok2));\n};\nexport function compareBytes(b1, b2) {\n  return b1.length < b2.length ? -1 : b1.length > b2.length ? 1 : compare(b1, b2);\n}","import {\n  Token,\n  Type\n} from './token.js';\nimport {\n  assertEnoughData,\n  decodeErrPrefix\n} from './common.js';\nimport * as uint from './0uint.js';\nimport { encodeBytes } from './2bytes.js';\nimport {\n  toString,\n  slice\n} from './byte-utils.js';\nfunction toToken(data, pos, prefix, length, options) {\n  const totLength = prefix + length;\n  assertEnoughData(data, pos, totLength);\n  const tok = new Token(Type.string, toString(data, pos + prefix, pos + totLength), totLength);\n  if (options.retainStringBytes === true) {\n    tok.byteValue = slice(data, pos + prefix, pos + totLength);\n  }\n  return tok;\n}\nexport function decodeStringCompact(data, pos, minor, options) {\n  return toToken(data, pos, 1, minor, options);\n}\nexport function decodeString8(data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options), options);\n}\nexport function decodeString16(data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options), options);\n}\nexport function decodeString32(data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options), options);\n}\nexport function decodeString64(data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options);\n  if (typeof l === 'bigint') {\n    throw new Error(`${ decodeErrPrefix } 64-bit integer string lengths not supported`);\n  }\n  return toToken(data, pos, 9, l, options);\n}\nexport const encodeString = encodeBytes;","import {\n  Token,\n  Type\n} from './token.js';\nimport * as uint from './0uint.js';\nimport { decodeErrPrefix } from './common.js';\nfunction toToken(_data, _pos, prefix, length) {\n  return new Token(Type.array, length, prefix);\n}\nexport function decodeArrayCompact(data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor);\n}\nexport function decodeArray8(data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options));\n}\nexport function decodeArray16(data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options));\n}\nexport function decodeArray32(data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options));\n}\nexport function decodeArray64(data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options);\n  if (typeof l === 'bigint') {\n    throw new Error(`${ decodeErrPrefix } 64-bit integer array lengths not supported`);\n  }\n  return toToken(data, pos, 9, l);\n}\nexport function decodeArrayIndefinite(data, pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${ decodeErrPrefix } indefinite length items not allowed`);\n  }\n  return toToken(data, pos, 1, Infinity);\n}\nexport function encodeArray(buf, token) {\n  uint.encodeUintValue(buf, Type.array.majorEncoded, token.value);\n}\nencodeArray.compareTokens = uint.encodeUint.compareTokens;\nencodeArray.encodedSize = function encodedSize(token) {\n  return uint.encodeUintValue.encodedSize(token.value);\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport * as uint from './0uint.js';\nimport { decodeErrPrefix } from './common.js';\nfunction toToken(_data, _pos, prefix, length) {\n  return new Token(Type.map, length, prefix);\n}\nexport function decodeMapCompact(data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor);\n}\nexport function decodeMap8(data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options));\n}\nexport function decodeMap16(data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options));\n}\nexport function decodeMap32(data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options));\n}\nexport function decodeMap64(data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options);\n  if (typeof l === 'bigint') {\n    throw new Error(`${ decodeErrPrefix } 64-bit integer map lengths not supported`);\n  }\n  return toToken(data, pos, 9, l);\n}\nexport function decodeMapIndefinite(data, pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${ decodeErrPrefix } indefinite length items not allowed`);\n  }\n  return toToken(data, pos, 1, Infinity);\n}\nexport function encodeMap(buf, token) {\n  uint.encodeUintValue(buf, Type.map.majorEncoded, token.value);\n}\nencodeMap.compareTokens = uint.encodeUint.compareTokens;\nencodeMap.encodedSize = function encodedSize(token) {\n  return uint.encodeUintValue.encodedSize(token.value);\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport * as uint from './0uint.js';\nexport function decodeTagCompact(_data, _pos, minor, _options) {\n  return new Token(Type.tag, minor, 1);\n}\nexport function decodeTag8(data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint8(data, pos + 1, options), 2);\n}\nexport function decodeTag16(data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint16(data, pos + 1, options), 3);\n}\nexport function decodeTag32(data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint32(data, pos + 1, options), 5);\n}\nexport function decodeTag64(data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint64(data, pos + 1, options), 9);\n}\nexport function encodeTag(buf, token) {\n  uint.encodeUintValue(buf, Type.tag.majorEncoded, token.value);\n}\nencodeTag.compareTokens = uint.encodeUint.compareTokens;\nencodeTag.encodedSize = function encodedSize(token) {\n  return uint.encodeUintValue.encodedSize(token.value);\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport { decodeErrPrefix } from './common.js';\nimport { encodeUint } from './0uint.js';\nconst MINOR_FALSE = 20;\nconst MINOR_TRUE = 21;\nconst MINOR_NULL = 22;\nconst MINOR_UNDEFINED = 23;\nexport function decodeUndefined(_data, _pos, _minor, options) {\n  if (options.allowUndefined === false) {\n    throw new Error(`${ decodeErrPrefix } undefined values are not supported`);\n  } else if (options.coerceUndefinedToNull === true) {\n    return new Token(Type.null, null, 1);\n  }\n  return new Token(Type.undefined, undefined, 1);\n}\nexport function decodeBreak(_data, _pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${ decodeErrPrefix } indefinite length items not allowed`);\n  }\n  return new Token(Type.break, undefined, 1);\n}\nfunction createToken(value, bytes, options) {\n  if (options) {\n    if (options.allowNaN === false && Number.isNaN(value)) {\n      throw new Error(`${ decodeErrPrefix } NaN values are not supported`);\n    }\n    if (options.allowInfinity === false && (value === Infinity || value === -Infinity)) {\n      throw new Error(`${ decodeErrPrefix } Infinity values are not supported`);\n    }\n  }\n  return new Token(Type.float, value, bytes);\n}\nexport function decodeFloat16(data, pos, _minor, options) {\n  return createToken(readFloat16(data, pos + 1), 3, options);\n}\nexport function decodeFloat32(data, pos, _minor, options) {\n  return createToken(readFloat32(data, pos + 1), 5, options);\n}\nexport function decodeFloat64(data, pos, _minor, options) {\n  return createToken(readFloat64(data, pos + 1), 9, options);\n}\nexport function encodeFloat(buf, token, options) {\n  const float = token.value;\n  if (float === false) {\n    buf.push([Type.float.majorEncoded | MINOR_FALSE]);\n  } else if (float === true) {\n    buf.push([Type.float.majorEncoded | MINOR_TRUE]);\n  } else if (float === null) {\n    buf.push([Type.float.majorEncoded | MINOR_NULL]);\n  } else if (float === undefined) {\n    buf.push([Type.float.majorEncoded | MINOR_UNDEFINED]);\n  } else {\n    let decoded;\n    let success = false;\n    if (!options || options.float64 !== true) {\n      encodeFloat16(float);\n      decoded = readFloat16(ui8a, 1);\n      if (float === decoded || Number.isNaN(float)) {\n        ui8a[0] = 249;\n        buf.push(ui8a.slice(0, 3));\n        success = true;\n      } else {\n        encodeFloat32(float);\n        decoded = readFloat32(ui8a, 1);\n        if (float === decoded) {\n          ui8a[0] = 250;\n          buf.push(ui8a.slice(0, 5));\n          success = true;\n        }\n      }\n    }\n    if (!success) {\n      encodeFloat64(float);\n      decoded = readFloat64(ui8a, 1);\n      ui8a[0] = 251;\n      buf.push(ui8a.slice(0, 9));\n    }\n  }\n}\nencodeFloat.encodedSize = function encodedSize(token, options) {\n  const float = token.value;\n  if (float === false || float === true || float === null || float === undefined) {\n    return 1;\n  }\n  if (!options || options.float64 !== true) {\n    encodeFloat16(float);\n    let decoded = readFloat16(ui8a, 1);\n    if (float === decoded || Number.isNaN(float)) {\n      return 3;\n    }\n    encodeFloat32(float);\n    decoded = readFloat32(ui8a, 1);\n    if (float === decoded) {\n      return 5;\n    }\n  }\n  return 9;\n};\nconst buffer = new ArrayBuffer(9);\nconst dataView = new DataView(buffer, 1);\nconst ui8a = new Uint8Array(buffer, 0);\nfunction encodeFloat16(inp) {\n  if (inp === Infinity) {\n    dataView.setUint16(0, 31744, false);\n  } else if (inp === -Infinity) {\n    dataView.setUint16(0, 64512, false);\n  } else if (Number.isNaN(inp)) {\n    dataView.setUint16(0, 32256, false);\n  } else {\n    dataView.setFloat32(0, inp);\n    const valu32 = dataView.getUint32(0);\n    const exponent = (valu32 & 2139095040) >> 23;\n    const mantissa = valu32 & 8388607;\n    if (exponent === 255) {\n      dataView.setUint16(0, 31744, false);\n    } else if (exponent === 0) {\n      dataView.setUint16(0, (inp & 2147483648) >> 16 | mantissa >> 13, false);\n    } else {\n      const logicalExponent = exponent - 127;\n      if (logicalExponent < -24) {\n        dataView.setUint16(0, 0);\n      } else if (logicalExponent < -14) {\n        dataView.setUint16(0, (valu32 & 2147483648) >> 16 | 1 << 24 + logicalExponent, false);\n      } else {\n        dataView.setUint16(0, (valu32 & 2147483648) >> 16 | logicalExponent + 15 << 10 | mantissa >> 13, false);\n      }\n    }\n  }\n}\nfunction readFloat16(ui8a, pos) {\n  if (ui8a.length - pos < 2) {\n    throw new Error(`${ decodeErrPrefix } not enough data for float16`);\n  }\n  const half = (ui8a[pos] << 8) + ui8a[pos + 1];\n  if (half === 31744) {\n    return Infinity;\n  }\n  if (half === 64512) {\n    return -Infinity;\n  }\n  if (half === 32256) {\n    return NaN;\n  }\n  const exp = half >> 10 & 31;\n  const mant = half & 1023;\n  let val;\n  if (exp === 0) {\n    val = mant * 2 ** -24;\n  } else if (exp !== 31) {\n    val = (mant + 1024) * 2 ** (exp - 25);\n  } else {\n    val = mant === 0 ? Infinity : NaN;\n  }\n  return half & 32768 ? -val : val;\n}\nfunction encodeFloat32(inp) {\n  dataView.setFloat32(0, inp, false);\n}\nfunction readFloat32(ui8a, pos) {\n  if (ui8a.length - pos < 4) {\n    throw new Error(`${ decodeErrPrefix } not enough data for float32`);\n  }\n  const offset = (ui8a.byteOffset || 0) + pos;\n  return new DataView(ui8a.buffer, offset, 4).getFloat32(0, false);\n}\nfunction encodeFloat64(inp) {\n  dataView.setFloat64(0, inp, false);\n}\nfunction readFloat64(ui8a, pos) {\n  if (ui8a.length - pos < 8) {\n    throw new Error(`${ decodeErrPrefix } not enough data for float64`);\n  }\n  const offset = (ui8a.byteOffset || 0) + pos;\n  return new DataView(ui8a.buffer, offset, 8).getFloat64(0, false);\n}\nencodeFloat.compareTokens = encodeUint.compareTokens;","export const useBuffer = globalThis.process && !globalThis.process.browser && globalThis.Buffer && typeof globalThis.Buffer.isBuffer === 'function';\nconst textDecoder = new TextDecoder();\nconst textEncoder = new TextEncoder();\nfunction isBuffer(buf) {\n  return useBuffer && globalThis.Buffer.isBuffer(buf);\n}\nexport function asU8A(buf) {\n  if (!(buf instanceof Uint8Array)) {\n    return Uint8Array.from(buf);\n  }\n  return isBuffer(buf) ? new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength) : buf;\n}\nexport const toString = useBuffer ? (bytes, start, end) => {\n  return end - start > 64 ? globalThis.Buffer.from(bytes.subarray(start, end)).toString('utf8') : utf8Slice(bytes, start, end);\n} : (bytes, start, end) => {\n  return end - start > 64 ? textDecoder.decode(bytes.subarray(start, end)) : utf8Slice(bytes, start, end);\n};\nexport const fromString = useBuffer ? string => {\n  return string.length > 64 ? globalThis.Buffer.from(string) : utf8ToBytes(string);\n} : string => {\n  return string.length > 64 ? textEncoder.encode(string) : utf8ToBytes(string);\n};\nexport const fromArray = arr => {\n  return Uint8Array.from(arr);\n};\nexport const slice = useBuffer ? (bytes, start, end) => {\n  if (isBuffer(bytes)) {\n    return new Uint8Array(bytes.subarray(start, end));\n  }\n  return bytes.slice(start, end);\n} : (bytes, start, end) => {\n  return bytes.slice(start, end);\n};\nexport const concat = useBuffer ? (chunks, length) => {\n  chunks = chunks.map(c => c instanceof Uint8Array ? c : globalThis.Buffer.from(c));\n  return asU8A(globalThis.Buffer.concat(chunks, length));\n} : (chunks, length) => {\n  const out = new Uint8Array(length);\n  let off = 0;\n  for (let b of chunks) {\n    if (off + b.length > out.length) {\n      b = b.subarray(0, out.length - off);\n    }\n    out.set(b, off);\n    off += b.length;\n  }\n  return out;\n};\nexport const alloc = useBuffer ? size => {\n  return globalThis.Buffer.allocUnsafe(size);\n} : size => {\n  return new Uint8Array(size);\n};\nexport const toHex = useBuffer ? d => {\n  if (typeof d === 'string') {\n    return d;\n  }\n  return globalThis.Buffer.from(toBytes(d)).toString('hex');\n} : d => {\n  if (typeof d === 'string') {\n    return d;\n  }\n  return Array.prototype.reduce.call(toBytes(d), (p, c) => `${ p }${ c.toString(16).padStart(2, '0') }`, '');\n};\nexport const fromHex = useBuffer ? hex => {\n  if (hex instanceof Uint8Array) {\n    return hex;\n  }\n  return globalThis.Buffer.from(hex, 'hex');\n} : hex => {\n  if (hex instanceof Uint8Array) {\n    return hex;\n  }\n  if (!hex.length) {\n    return new Uint8Array(0);\n  }\n  return new Uint8Array(hex.split('').map((c, i, d) => i % 2 === 0 ? `0x${ c }${ d[i + 1] }` : '').filter(Boolean).map(e => parseInt(e, 16)));\n};\nfunction toBytes(obj) {\n  if (obj instanceof Uint8Array && obj.constructor.name === 'Uint8Array') {\n    return obj;\n  }\n  if (obj instanceof ArrayBuffer) {\n    return new Uint8Array(obj);\n  }\n  if (ArrayBuffer.isView(obj)) {\n    return new Uint8Array(obj.buffer, obj.byteOffset, obj.byteLength);\n  }\n  throw new Error('Unknown type, must be binary type');\n}\nexport function compare(b1, b2) {\n  if (isBuffer(b1) && isBuffer(b2)) {\n    return b1.compare(b2);\n  }\n  for (let i = 0; i < b1.length; i++) {\n    if (b1[i] === b2[i]) {\n      continue;\n    }\n    return b1[i] < b2[i] ? -1 : 1;\n  }\n  return 0;\n}\nfunction utf8ToBytes(string, units = Infinity) {\n  let codePoint;\n  const length = string.length;\n  let leadSurrogate = null;\n  const bytes = [];\n  for (let i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i);\n    if (codePoint > 55295 && codePoint < 57344) {\n      if (!leadSurrogate) {\n        if (codePoint > 56319) {\n          if ((units -= 3) > -1)\n            bytes.push(239, 191, 189);\n          continue;\n        } else if (i + 1 === length) {\n          if ((units -= 3) > -1)\n            bytes.push(239, 191, 189);\n          continue;\n        }\n        leadSurrogate = codePoint;\n        continue;\n      }\n      if (codePoint < 56320) {\n        if ((units -= 3) > -1)\n          bytes.push(239, 191, 189);\n        leadSurrogate = codePoint;\n        continue;\n      }\n      codePoint = (leadSurrogate - 55296 << 10 | codePoint - 56320) + 65536;\n    } else if (leadSurrogate) {\n      if ((units -= 3) > -1)\n        bytes.push(239, 191, 189);\n    }\n    leadSurrogate = null;\n    if (codePoint < 128) {\n      if ((units -= 1) < 0)\n        break;\n      bytes.push(codePoint);\n    } else if (codePoint < 2048) {\n      if ((units -= 2) < 0)\n        break;\n      bytes.push(codePoint >> 6 | 192, codePoint & 63 | 128);\n    } else if (codePoint < 65536) {\n      if ((units -= 3) < 0)\n        break;\n      bytes.push(codePoint >> 12 | 224, codePoint >> 6 & 63 | 128, codePoint & 63 | 128);\n    } else if (codePoint < 1114112) {\n      if ((units -= 4) < 0)\n        break;\n      bytes.push(codePoint >> 18 | 240, codePoint >> 12 & 63 | 128, codePoint >> 6 & 63 | 128, codePoint & 63 | 128);\n    } else {\n      throw new Error('Invalid code point');\n    }\n  }\n  return bytes;\n}\nfunction utf8Slice(buf, offset, end) {\n  const res = [];\n  while (offset < end) {\n    const firstByte = buf[offset];\n    let codePoint = null;\n    let bytesPerSequence = firstByte > 239 ? 4 : firstByte > 223 ? 3 : firstByte > 191 ? 2 : 1;\n    if (offset + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint;\n      switch (bytesPerSequence) {\n      case 1:\n        if (firstByte < 128) {\n          codePoint = firstByte;\n        }\n        break;\n      case 2:\n        secondByte = buf[offset + 1];\n        if ((secondByte & 192) === 128) {\n          tempCodePoint = (firstByte & 31) << 6 | secondByte & 63;\n          if (tempCodePoint > 127) {\n            codePoint = tempCodePoint;\n          }\n        }\n        break;\n      case 3:\n        secondByte = buf[offset + 1];\n        thirdByte = buf[offset + 2];\n        if ((secondByte & 192) === 128 && (thirdByte & 192) === 128) {\n          tempCodePoint = (firstByte & 15) << 12 | (secondByte & 63) << 6 | thirdByte & 63;\n          if (tempCodePoint > 2047 && (tempCodePoint < 55296 || tempCodePoint > 57343)) {\n            codePoint = tempCodePoint;\n          }\n        }\n        break;\n      case 4:\n        secondByte = buf[offset + 1];\n        thirdByte = buf[offset + 2];\n        fourthByte = buf[offset + 3];\n        if ((secondByte & 192) === 128 && (thirdByte & 192) === 128 && (fourthByte & 192) === 128) {\n          tempCodePoint = (firstByte & 15) << 18 | (secondByte & 63) << 12 | (thirdByte & 63) << 6 | fourthByte & 63;\n          if (tempCodePoint > 65535 && tempCodePoint < 1114112) {\n            codePoint = tempCodePoint;\n          }\n        }\n      }\n    }\n    if (codePoint === null) {\n      codePoint = 65533;\n      bytesPerSequence = 1;\n    } else if (codePoint > 65535) {\n      codePoint -= 65536;\n      res.push(codePoint >>> 10 & 1023 | 55296);\n      codePoint = 56320 | codePoint & 1023;\n    }\n    res.push(codePoint);\n    offset += bytesPerSequence;\n  }\n  return decodeCodePointsArray(res);\n}\nconst MAX_ARGUMENTS_LENGTH = 4096;\nexport function decodeCodePointsArray(codePoints) {\n  const len = codePoints.length;\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints);\n  }\n  let res = '';\n  let i = 0;\n  while (i < len) {\n    res += String.fromCharCode.apply(String, codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH));\n  }\n  return res;\n}","const decodeErrPrefix = 'CBOR decode error:';\nconst encodeErrPrefix = 'CBOR encode error:';\nconst uintMinorPrefixBytes = [];\nuintMinorPrefixBytes[23] = 1;\nuintMinorPrefixBytes[24] = 2;\nuintMinorPrefixBytes[25] = 3;\nuintMinorPrefixBytes[26] = 5;\nuintMinorPrefixBytes[27] = 9;\nfunction assertEnoughData(data, pos, need) {\n  if (data.length - pos < need) {\n    throw new Error(`${ decodeErrPrefix } not enough data for type`);\n  }\n}\nexport {\n  decodeErrPrefix,\n  encodeErrPrefix,\n  uintMinorPrefixBytes,\n  assertEnoughData\n};","import { decodeErrPrefix } from './common.js';\nimport { Type } from './token.js';\nimport {\n  jump,\n  quick\n} from './jump.js';\nconst defaultDecodeOptions = {\n  strict: false,\n  allowIndefinite: true,\n  allowUndefined: true,\n  allowBigInt: true\n};\nclass Tokeniser {\n  constructor(data, options = {}) {\n    this.pos = 0;\n    this.data = data;\n    this.options = options;\n  }\n  done() {\n    return this.pos >= this.data.length;\n  }\n  next() {\n    const byt = this.data[this.pos];\n    let token = quick[byt];\n    if (token === undefined) {\n      const decoder = jump[byt];\n      if (!decoder) {\n        throw new Error(`${ decodeErrPrefix } no decoder for major type ${ byt >>> 5 } (byte 0x${ byt.toString(16).padStart(2, '0') })`);\n      }\n      const minor = byt & 31;\n      token = decoder(this.data, this.pos, minor, this.options);\n    }\n    this.pos += token.encodedLength;\n    return token;\n  }\n}\nconst DONE = Symbol.for('DONE');\nconst BREAK = Symbol.for('BREAK');\nfunction tokenToArray(token, tokeniser, options) {\n  const arr = [];\n  for (let i = 0; i < token.value; i++) {\n    const value = tokensToObject(tokeniser, options);\n    if (value === BREAK) {\n      if (token.value === Infinity) {\n        break;\n      }\n      throw new Error(`${ decodeErrPrefix } got unexpected break to lengthed array`);\n    }\n    if (value === DONE) {\n      throw new Error(`${ decodeErrPrefix } found array but not enough entries (got ${ i }, expected ${ token.value })`);\n    }\n    arr[i] = value;\n  }\n  return arr;\n}\nfunction tokenToMap(token, tokeniser, options) {\n  const useMaps = options.useMaps === true;\n  const obj = useMaps ? undefined : {};\n  const m = useMaps ? new Map() : undefined;\n  for (let i = 0; i < token.value; i++) {\n    const key = tokensToObject(tokeniser, options);\n    if (key === BREAK) {\n      if (token.value === Infinity) {\n        break;\n      }\n      throw new Error(`${ decodeErrPrefix } got unexpected break to lengthed map`);\n    }\n    if (key === DONE) {\n      throw new Error(`${ decodeErrPrefix } found map but not enough entries (got ${ i } [no key], expected ${ token.value })`);\n    }\n    if (useMaps !== true && typeof key !== 'string') {\n      throw new Error(`${ decodeErrPrefix } non-string keys not supported (got ${ typeof key })`);\n    }\n    if (options.rejectDuplicateMapKeys === true) {\n      if (useMaps && m.has(key) || !useMaps && key in obj) {\n        throw new Error(`${ decodeErrPrefix } found repeat map key \"${ key }\"`);\n      }\n    }\n    const value = tokensToObject(tokeniser, options);\n    if (value === DONE) {\n      throw new Error(`${ decodeErrPrefix } found map but not enough entries (got ${ i } [no value], expected ${ token.value })`);\n    }\n    if (useMaps) {\n      m.set(key, value);\n    } else {\n      obj[key] = value;\n    }\n  }\n  return useMaps ? m : obj;\n}\nfunction tokensToObject(tokeniser, options) {\n  if (tokeniser.done()) {\n    return DONE;\n  }\n  const token = tokeniser.next();\n  if (token.type === Type.break) {\n    return BREAK;\n  }\n  if (token.type.terminal) {\n    return token.value;\n  }\n  if (token.type === Type.array) {\n    return tokenToArray(token, tokeniser, options);\n  }\n  if (token.type === Type.map) {\n    return tokenToMap(token, tokeniser, options);\n  }\n  if (token.type === Type.tag) {\n    if (options.tags && typeof options.tags[token.value] === 'function') {\n      const tagged = tokensToObject(tokeniser, options);\n      return options.tags[token.value](tagged);\n    }\n    throw new Error(`${ decodeErrPrefix } tag not supported (${ token.value })`);\n  }\n  throw new Error('unsupported');\n}\nfunction decode(data, options) {\n  if (!(data instanceof Uint8Array)) {\n    throw new Error(`${ decodeErrPrefix } data to decode must be a Uint8Array`);\n  }\n  options = Object.assign({}, defaultDecodeOptions, options);\n  const tokeniser = options.tokenizer || new Tokeniser(data, options);\n  const decoded = tokensToObject(tokeniser, options);\n  if (decoded === DONE) {\n    throw new Error(`${ decodeErrPrefix } did not find any content to decode`);\n  }\n  if (decoded === BREAK) {\n    throw new Error(`${ decodeErrPrefix } got unexpected break`);\n  }\n  if (!tokeniser.done()) {\n    throw new Error(`${ decodeErrPrefix } too many terminals, data makes no sense`);\n  }\n  return decoded;\n}\nexport {\n  Tokeniser,\n  tokensToObject,\n  decode\n};","const typeofs = [\n  'string',\n  'number',\n  'bigint',\n  'symbol'\n];\nconst objectTypeNames = [\n  'Function',\n  'Generator',\n  'AsyncGenerator',\n  'GeneratorFunction',\n  'AsyncGeneratorFunction',\n  'AsyncFunction',\n  'Observable',\n  'Array',\n  'Buffer',\n  'Object',\n  'RegExp',\n  'Date',\n  'Error',\n  'Map',\n  'Set',\n  'WeakMap',\n  'WeakSet',\n  'ArrayBuffer',\n  'SharedArrayBuffer',\n  'DataView',\n  'Promise',\n  'URL',\n  'HTMLElement',\n  'Int8Array',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Int16Array',\n  'Uint16Array',\n  'Int32Array',\n  'Uint32Array',\n  'Float32Array',\n  'Float64Array',\n  'BigInt64Array',\n  'BigUint64Array'\n];\nexport function is(value) {\n  if (value === null) {\n    return 'null';\n  }\n  if (value === undefined) {\n    return 'undefined';\n  }\n  if (value === true || value === false) {\n    return 'boolean';\n  }\n  const typeOf = typeof value;\n  if (typeofs.includes(typeOf)) {\n    return typeOf;\n  }\n  if (typeOf === 'function') {\n    return 'Function';\n  }\n  if (Array.isArray(value)) {\n    return 'Array';\n  }\n  if (isBuffer(value)) {\n    return 'Buffer';\n  }\n  const objectType = getObjectType(value);\n  if (objectType) {\n    return objectType;\n  }\n  return 'Object';\n}\nfunction isBuffer(value) {\n  return value && value.constructor && value.constructor.isBuffer && value.constructor.isBuffer.call(null, value);\n}\nfunction getObjectType(value) {\n  const objectTypeName = Object.prototype.toString.call(value).slice(8, -1);\n  if (objectTypeNames.includes(objectTypeName)) {\n    return objectTypeName;\n  }\n  return undefined;\n}","import {\n  alloc,\n  concat,\n  slice\n} from './byte-utils.js';\nconst defaultChunkSize = 256;\nexport class Bl {\n  constructor(chunkSize = defaultChunkSize) {\n    this.chunkSize = chunkSize;\n    this.cursor = 0;\n    this.maxCursor = -1;\n    this.chunks = [];\n    this._initReuseChunk = null;\n  }\n  reset() {\n    this.cursor = 0;\n    this.maxCursor = -1;\n    if (this.chunks.length) {\n      this.chunks = [];\n    }\n    if (this._initReuseChunk !== null) {\n      this.chunks.push(this._initReuseChunk);\n      this.maxCursor = this._initReuseChunk.length - 1;\n    }\n  }\n  push(bytes) {\n    let topChunk = this.chunks[this.chunks.length - 1];\n    const newMax = this.cursor + bytes.length;\n    if (newMax <= this.maxCursor + 1) {\n      const chunkPos = topChunk.length - (this.maxCursor - this.cursor) - 1;\n      topChunk.set(bytes, chunkPos);\n    } else {\n      if (topChunk) {\n        const chunkPos = topChunk.length - (this.maxCursor - this.cursor) - 1;\n        if (chunkPos < topChunk.length) {\n          this.chunks[this.chunks.length - 1] = topChunk.subarray(0, chunkPos);\n          this.maxCursor = this.cursor - 1;\n        }\n      }\n      if (bytes.length < 64 && bytes.length < this.chunkSize) {\n        topChunk = alloc(this.chunkSize);\n        this.chunks.push(topChunk);\n        this.maxCursor += topChunk.length;\n        if (this._initReuseChunk === null) {\n          this._initReuseChunk = topChunk;\n        }\n        topChunk.set(bytes, 0);\n      } else {\n        this.chunks.push(bytes);\n        this.maxCursor += bytes.length;\n      }\n    }\n    this.cursor += bytes.length;\n  }\n  toBytes(reset = false) {\n    let byts;\n    if (this.chunks.length === 1) {\n      const chunk = this.chunks[0];\n      if (reset && this.cursor > chunk.length / 2) {\n        byts = this.cursor === chunk.length ? chunk : chunk.subarray(0, this.cursor);\n        this._initReuseChunk = null;\n        this.chunks = [];\n      } else {\n        byts = slice(chunk, 0, this.cursor);\n      }\n    } else {\n      byts = concat(this.chunks, this.cursor);\n    }\n    if (reset) {\n      this.reset();\n    }\n    return byts;\n  }\n}","import { is } from './is.js';\nimport {\n  Token,\n  Type\n} from './token.js';\nimport { Bl } from './bl.js';\nimport { encodeErrPrefix } from './common.js';\nimport { quickEncodeToken } from './jump.js';\nimport { asU8A } from './byte-utils.js';\nimport { encodeUint } from './0uint.js';\nimport { encodeNegint } from './1negint.js';\nimport { encodeBytes } from './2bytes.js';\nimport { encodeString } from './3string.js';\nimport { encodeArray } from './4array.js';\nimport { encodeMap } from './5map.js';\nimport { encodeTag } from './6tag.js';\nimport { encodeFloat } from './7float.js';\nconst defaultEncodeOptions = {\n  float64: false,\n  mapSorter,\n  quickEncodeToken\n};\nexport function makeCborEncoders() {\n  const encoders = [];\n  encoders[Type.uint.major] = encodeUint;\n  encoders[Type.negint.major] = encodeNegint;\n  encoders[Type.bytes.major] = encodeBytes;\n  encoders[Type.string.major] = encodeString;\n  encoders[Type.array.major] = encodeArray;\n  encoders[Type.map.major] = encodeMap;\n  encoders[Type.tag.major] = encodeTag;\n  encoders[Type.float.major] = encodeFloat;\n  return encoders;\n}\nconst cborEncoders = makeCborEncoders();\nconst buf = new Bl();\nclass Ref {\n  constructor(obj, parent) {\n    this.obj = obj;\n    this.parent = parent;\n  }\n  includes(obj) {\n    let p = this;\n    do {\n      if (p.obj === obj) {\n        return true;\n      }\n    } while (p = p.parent);\n    return false;\n  }\n  static createCheck(stack, obj) {\n    if (stack && stack.includes(obj)) {\n      throw new Error(`${ encodeErrPrefix } object contains circular references`);\n    }\n    return new Ref(obj, stack);\n  }\n}\nconst simpleTokens = {\n  null: new Token(Type.null, null),\n  undefined: new Token(Type.undefined, undefined),\n  true: new Token(Type.true, true),\n  false: new Token(Type.false, false),\n  emptyArray: new Token(Type.array, 0),\n  emptyMap: new Token(Type.map, 0)\n};\nconst typeEncoders = {\n  number(obj, _typ, _options, _refStack) {\n    if (!Number.isInteger(obj) || !Number.isSafeInteger(obj)) {\n      return new Token(Type.float, obj);\n    } else if (obj >= 0) {\n      return new Token(Type.uint, obj);\n    } else {\n      return new Token(Type.negint, obj);\n    }\n  },\n  bigint(obj, _typ, _options, _refStack) {\n    if (obj >= BigInt(0)) {\n      return new Token(Type.uint, obj);\n    } else {\n      return new Token(Type.negint, obj);\n    }\n  },\n  Uint8Array(obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, obj);\n  },\n  string(obj, _typ, _options, _refStack) {\n    return new Token(Type.string, obj);\n  },\n  boolean(obj, _typ, _options, _refStack) {\n    return obj ? simpleTokens.true : simpleTokens.false;\n  },\n  null(_obj, _typ, _options, _refStack) {\n    return simpleTokens.null;\n  },\n  undefined(_obj, _typ, _options, _refStack) {\n    return simpleTokens.undefined;\n  },\n  ArrayBuffer(obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, new Uint8Array(obj));\n  },\n  DataView(obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, new Uint8Array(obj.buffer, obj.byteOffset, obj.byteLength));\n  },\n  Array(obj, _typ, options, refStack) {\n    if (!obj.length) {\n      if (options.addBreakTokens === true) {\n        return [\n          simpleTokens.emptyArray,\n          new Token(Type.break)\n        ];\n      }\n      return simpleTokens.emptyArray;\n    }\n    refStack = Ref.createCheck(refStack, obj);\n    const entries = [];\n    let i = 0;\n    for (const e of obj) {\n      entries[i++] = objectToTokens(e, options, refStack);\n    }\n    if (options.addBreakTokens) {\n      return [\n        new Token(Type.array, obj.length),\n        entries,\n        new Token(Type.break)\n      ];\n    }\n    return [\n      new Token(Type.array, obj.length),\n      entries\n    ];\n  },\n  Object(obj, typ, options, refStack) {\n    const isMap = typ !== 'Object';\n    const keys = isMap ? obj.keys() : Object.keys(obj);\n    const length = isMap ? obj.size : keys.length;\n    if (!length) {\n      if (options.addBreakTokens === true) {\n        return [\n          simpleTokens.emptyMap,\n          new Token(Type.break)\n        ];\n      }\n      return simpleTokens.emptyMap;\n    }\n    refStack = Ref.createCheck(refStack, obj);\n    const entries = [];\n    let i = 0;\n    for (const key of keys) {\n      entries[i++] = [\n        objectToTokens(key, options, refStack),\n        objectToTokens(isMap ? obj.get(key) : obj[key], options, refStack)\n      ];\n    }\n    sortMapEntries(entries, options);\n    if (options.addBreakTokens) {\n      return [\n        new Token(Type.map, length),\n        entries,\n        new Token(Type.break)\n      ];\n    }\n    return [\n      new Token(Type.map, length),\n      entries\n    ];\n  }\n};\ntypeEncoders.Map = typeEncoders.Object;\ntypeEncoders.Buffer = typeEncoders.Uint8Array;\nfor (const typ of 'Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64'.split(' ')) {\n  typeEncoders[`${ typ }Array`] = typeEncoders.DataView;\n}\nfunction objectToTokens(obj, options = {}, refStack) {\n  const typ = is(obj);\n  const customTypeEncoder = options && options.typeEncoders && options.typeEncoders[typ] || typeEncoders[typ];\n  if (typeof customTypeEncoder === 'function') {\n    const tokens = customTypeEncoder(obj, typ, options, refStack);\n    if (tokens != null) {\n      return tokens;\n    }\n  }\n  const typeEncoder = typeEncoders[typ];\n  if (!typeEncoder) {\n    throw new Error(`${ encodeErrPrefix } unsupported type: ${ typ }`);\n  }\n  return typeEncoder(obj, typ, options, refStack);\n}\nfunction sortMapEntries(entries, options) {\n  if (options.mapSorter) {\n    entries.sort(options.mapSorter);\n  }\n}\nfunction mapSorter(e1, e2) {\n  const keyToken1 = Array.isArray(e1[0]) ? e1[0][0] : e1[0];\n  const keyToken2 = Array.isArray(e2[0]) ? e2[0][0] : e2[0];\n  if (keyToken1.type !== keyToken2.type) {\n    return keyToken1.type.compare(keyToken2.type);\n  }\n  const major = keyToken1.type.major;\n  const tcmp = cborEncoders[major].compareTokens(keyToken1, keyToken2);\n  if (tcmp === 0) {\n    console.warn('WARNING: complex key types used, CBOR key sorting guarantees are gone');\n  }\n  return tcmp;\n}\nfunction tokensToEncoded(buf, tokens, encoders, options) {\n  if (Array.isArray(tokens)) {\n    for (const token of tokens) {\n      tokensToEncoded(buf, token, encoders, options);\n    }\n  } else {\n    encoders[tokens.type.major](buf, tokens, options);\n  }\n}\nfunction encodeCustom(data, encoders, options) {\n  const tokens = objectToTokens(data, options);\n  if (!Array.isArray(tokens) && options.quickEncodeToken) {\n    const quickBytes = options.quickEncodeToken(tokens);\n    if (quickBytes) {\n      return quickBytes;\n    }\n    const encoder = encoders[tokens.type.major];\n    if (encoder.encodedSize) {\n      const size = encoder.encodedSize(tokens, options);\n      const buf = new Bl(size);\n      encoder(buf, tokens, options);\n      if (buf.chunks.length !== 1) {\n        throw new Error(`Unexpected error: pre-calculated length for ${ tokens } was wrong`);\n      }\n      return asU8A(buf.chunks[0]);\n    }\n  }\n  buf.reset();\n  tokensToEncoded(buf, tokens, encoders, options);\n  return buf.toBytes(true);\n}\nfunction encode(data, options) {\n  options = Object.assign({}, defaultEncodeOptions, options);\n  return encodeCustom(data, cborEncoders, options);\n}\nexport {\n  objectToTokens,\n  encode,\n  encodeCustom,\n  Ref\n};","import { Type } from '../token.js';\nimport { encodeCustom } from '../encode.js';\nimport { encodeErrPrefix } from '../common.js';\nimport {\n  asU8A,\n  fromString\n} from '../byte-utils.js';\nclass JSONEncoder extends Array {\n  constructor() {\n    super();\n    this.inRecursive = [];\n  }\n  prefix(buf) {\n    const recurs = this.inRecursive[this.inRecursive.length - 1];\n    if (recurs) {\n      if (recurs.type === Type.array) {\n        recurs.elements++;\n        if (recurs.elements !== 1) {\n          buf.push([44]);\n        }\n      }\n      if (recurs.type === Type.map) {\n        recurs.elements++;\n        if (recurs.elements !== 1) {\n          if (recurs.elements % 2 === 1) {\n            buf.push([44]);\n          } else {\n            buf.push([58]);\n          }\n        }\n      }\n    }\n  }\n  [Type.uint.major](buf, token) {\n    this.prefix(buf);\n    const is = String(token.value);\n    const isa = [];\n    for (let i = 0; i < is.length; i++) {\n      isa[i] = is.charCodeAt(i);\n    }\n    buf.push(isa);\n  }\n  [Type.negint.major](buf, token) {\n    this[Type.uint.major](buf, token);\n  }\n  [Type.bytes.major](_buf, _token) {\n    throw new Error(`${ encodeErrPrefix } unsupported type: Uint8Array`);\n  }\n  [Type.string.major](buf, token) {\n    this.prefix(buf);\n    const byts = fromString(JSON.stringify(token.value));\n    buf.push(byts.length > 32 ? asU8A(byts) : byts);\n  }\n  [Type.array.major](buf, _token) {\n    this.prefix(buf);\n    this.inRecursive.push({\n      type: Type.array,\n      elements: 0\n    });\n    buf.push([91]);\n  }\n  [Type.map.major](buf, _token) {\n    this.prefix(buf);\n    this.inRecursive.push({\n      type: Type.map,\n      elements: 0\n    });\n    buf.push([123]);\n  }\n  [Type.tag.major](_buf, _token) {\n  }\n  [Type.float.major](buf, token) {\n    if (token.type.name === 'break') {\n      const recurs = this.inRecursive.pop();\n      if (recurs) {\n        if (recurs.type === Type.array) {\n          buf.push([93]);\n        } else if (recurs.type === Type.map) {\n          buf.push([125]);\n        } else {\n          throw new Error('Unexpected recursive type; this should not happen!');\n        }\n        return;\n      }\n      throw new Error('Unexpected break; this should not happen!');\n    }\n    if (token.value === undefined) {\n      throw new Error(`${ encodeErrPrefix } unsupported type: undefined`);\n    }\n    this.prefix(buf);\n    if (token.type.name === 'true') {\n      buf.push([\n        116,\n        114,\n        117,\n        101\n      ]);\n      return;\n    } else if (token.type.name === 'false') {\n      buf.push([\n        102,\n        97,\n        108,\n        115,\n        101\n      ]);\n      return;\n    } else if (token.type.name === 'null') {\n      buf.push([\n        110,\n        117,\n        108,\n        108\n      ]);\n      return;\n    }\n    const is = String(token.value);\n    const isa = [];\n    let dp = false;\n    for (let i = 0; i < is.length; i++) {\n      isa[i] = is.charCodeAt(i);\n      if (!dp && (isa[i] === 46 || isa[i] === 101 || isa[i] === 69)) {\n        dp = true;\n      }\n    }\n    if (!dp) {\n      isa.push(46);\n      isa.push(48);\n    }\n    buf.push(isa);\n  }\n}\nfunction mapSorter(e1, e2) {\n  if (Array.isArray(e1[0]) || Array.isArray(e2[0])) {\n    throw new Error(`${ encodeErrPrefix } complex map keys are not supported`);\n  }\n  const keyToken1 = e1[0];\n  const keyToken2 = e2[0];\n  if (keyToken1.type !== Type.string || keyToken2.type !== Type.string) {\n    throw new Error(`${ encodeErrPrefix } non-string map keys are not supported`);\n  }\n  if (keyToken1 < keyToken2) {\n    return -1;\n  }\n  if (keyToken1 > keyToken2) {\n    return 1;\n  }\n  throw new Error(`${ encodeErrPrefix } unexpected duplicate map keys, this is not supported`);\n}\nconst defaultEncodeOptions = {\n  addBreakTokens: true,\n  mapSorter\n};\nfunction encode(data, options) {\n  options = Object.assign({}, defaultEncodeOptions, options);\n  return encodeCustom(data, new JSONEncoder(), options);\n}\nexport {\n  encode\n};","import { decode as _decode } from '../decode.js';\nimport {\n  Token,\n  Type\n} from '../token.js';\nimport { decodeCodePointsArray } from '../byte-utils.js';\nimport { decodeErrPrefix } from '../common.js';\nclass Tokenizer {\n  constructor(data, options = {}) {\n    this.pos = 0;\n    this.data = data;\n    this.options = options;\n    this.modeStack = ['value'];\n    this.lastToken = '';\n  }\n  done() {\n    return this.pos >= this.data.length;\n  }\n  ch() {\n    return this.data[this.pos];\n  }\n  currentMode() {\n    return this.modeStack[this.modeStack.length - 1];\n  }\n  skipWhitespace() {\n    let c = this.ch();\n    while (c === 32 || c === 9 || c === 13 || c === 10) {\n      c = this.data[++this.pos];\n    }\n  }\n  expect(str) {\n    if (this.data.length - this.pos < str.length) {\n      throw new Error(`${ decodeErrPrefix } unexpected end of input at position ${ this.pos }`);\n    }\n    for (let i = 0; i < str.length; i++) {\n      if (this.data[this.pos++] !== str[i]) {\n        throw new Error(`${ decodeErrPrefix } unexpected token at position ${ this.pos }, expected to find '${ String.fromCharCode(...str) }'`);\n      }\n    }\n  }\n  parseNumber() {\n    const startPos = this.pos;\n    let negative = false;\n    let float = false;\n    const swallow = chars => {\n      while (!this.done()) {\n        const ch = this.ch();\n        if (chars.includes(ch)) {\n          this.pos++;\n        } else {\n          break;\n        }\n      }\n    };\n    if (this.ch() === 45) {\n      negative = true;\n      this.pos++;\n    }\n    if (this.ch() === 48) {\n      this.pos++;\n      if (this.ch() === 46) {\n        this.pos++;\n        float = true;\n      } else {\n        return new Token(Type.uint, 0, this.pos - startPos);\n      }\n    }\n    swallow([\n      48,\n      49,\n      50,\n      51,\n      52,\n      53,\n      54,\n      55,\n      56,\n      57\n    ]);\n    if (negative && this.pos === startPos + 1) {\n      throw new Error(`${ decodeErrPrefix } unexpected token at position ${ this.pos }`);\n    }\n    if (!this.done() && this.ch() === 46) {\n      if (float) {\n        throw new Error(`${ decodeErrPrefix } unexpected token at position ${ this.pos }`);\n      }\n      float = true;\n      this.pos++;\n      swallow([\n        48,\n        49,\n        50,\n        51,\n        52,\n        53,\n        54,\n        55,\n        56,\n        57\n      ]);\n    }\n    if (!this.done() && (this.ch() === 101 || this.ch() === 69)) {\n      float = true;\n      this.pos++;\n      if (!this.done() && (this.ch() === 43 || this.ch() === 45)) {\n        this.pos++;\n      }\n      swallow([\n        48,\n        49,\n        50,\n        51,\n        52,\n        53,\n        54,\n        55,\n        56,\n        57\n      ]);\n    }\n    const numStr = String.fromCharCode.apply(null, this.data.subarray(startPos, this.pos));\n    const num = parseFloat(numStr);\n    if (float) {\n      return new Token(Type.float, num, this.pos - startPos);\n    }\n    if (this.options.allowBigInt !== true || Number.isSafeInteger(num)) {\n      return new Token(num >= 0 ? Type.uint : Type.negint, num, this.pos - startPos);\n    }\n    return new Token(num >= 0 ? Type.uint : Type.negint, BigInt(numStr), this.pos - startPos);\n  }\n  parseString() {\n    if (this.ch() !== 34) {\n      throw new Error(`${ decodeErrPrefix } unexpected character at position ${ this.pos }; this shouldn't happen`);\n    }\n    this.pos++;\n    for (let i = this.pos, l = 0; i < this.data.length && l < 65536; i++, l++) {\n      const ch = this.data[i];\n      if (ch === 92 || ch < 32 || ch >= 128) {\n        break;\n      }\n      if (ch === 34) {\n        const str = String.fromCharCode.apply(null, this.data.subarray(this.pos, i));\n        this.pos = i + 1;\n        return new Token(Type.string, str, l);\n      }\n    }\n    const startPos = this.pos;\n    const chars = [];\n    const readu4 = () => {\n      if (this.pos + 4 >= this.data.length) {\n        throw new Error(`${ decodeErrPrefix } unexpected end of unicode escape sequence at position ${ this.pos }`);\n      }\n      let u4 = 0;\n      for (let i = 0; i < 4; i++) {\n        let ch = this.ch();\n        if (ch >= 48 && ch <= 57) {\n          ch -= 48;\n        } else if (ch >= 97 && ch <= 102) {\n          ch = ch - 97 + 10;\n        } else if (ch >= 65 && ch <= 70) {\n          ch = ch - 65 + 10;\n        } else {\n          throw new Error(`${ decodeErrPrefix } unexpected unicode escape character at position ${ this.pos }`);\n        }\n        u4 = u4 * 16 + ch;\n        this.pos++;\n      }\n      return u4;\n    };\n    const readUtf8Char = () => {\n      const firstByte = this.ch();\n      let codePoint = null;\n      let bytesPerSequence = firstByte > 239 ? 4 : firstByte > 223 ? 3 : firstByte > 191 ? 2 : 1;\n      if (this.pos + bytesPerSequence > this.data.length) {\n        throw new Error(`${ decodeErrPrefix } unexpected unicode sequence at position ${ this.pos }`);\n      }\n      let secondByte, thirdByte, fourthByte, tempCodePoint;\n      switch (bytesPerSequence) {\n      case 1:\n        if (firstByte < 128) {\n          codePoint = firstByte;\n        }\n        break;\n      case 2:\n        secondByte = this.data[this.pos + 1];\n        if ((secondByte & 192) === 128) {\n          tempCodePoint = (firstByte & 31) << 6 | secondByte & 63;\n          if (tempCodePoint > 127) {\n            codePoint = tempCodePoint;\n          }\n        }\n        break;\n      case 3:\n        secondByte = this.data[this.pos + 1];\n        thirdByte = this.data[this.pos + 2];\n        if ((secondByte & 192) === 128 && (thirdByte & 192) === 128) {\n          tempCodePoint = (firstByte & 15) << 12 | (secondByte & 63) << 6 | thirdByte & 63;\n          if (tempCodePoint > 2047 && (tempCodePoint < 55296 || tempCodePoint > 57343)) {\n            codePoint = tempCodePoint;\n          }\n        }\n        break;\n      case 4:\n        secondByte = this.data[this.pos + 1];\n        thirdByte = this.data[this.pos + 2];\n        fourthByte = this.data[this.pos + 3];\n        if ((secondByte & 192) === 128 && (thirdByte & 192) === 128 && (fourthByte & 192) === 128) {\n          tempCodePoint = (firstByte & 15) << 18 | (secondByte & 63) << 12 | (thirdByte & 63) << 6 | fourthByte & 63;\n          if (tempCodePoint > 65535 && tempCodePoint < 1114112) {\n            codePoint = tempCodePoint;\n          }\n        }\n      }\n      if (codePoint === null) {\n        codePoint = 65533;\n        bytesPerSequence = 1;\n      } else if (codePoint > 65535) {\n        codePoint -= 65536;\n        chars.push(codePoint >>> 10 & 1023 | 55296);\n        codePoint = 56320 | codePoint & 1023;\n      }\n      chars.push(codePoint);\n      this.pos += bytesPerSequence;\n    };\n    while (!this.done()) {\n      const ch = this.ch();\n      let ch1;\n      switch (ch) {\n      case 92:\n        this.pos++;\n        if (this.done()) {\n          throw new Error(`${ decodeErrPrefix } unexpected string termination at position ${ this.pos }`);\n        }\n        ch1 = this.ch();\n        this.pos++;\n        switch (ch1) {\n        case 34:\n        case 39:\n        case 92:\n        case 47:\n          chars.push(ch1);\n          break;\n        case 98:\n          chars.push(8);\n          break;\n        case 116:\n          chars.push(9);\n          break;\n        case 110:\n          chars.push(10);\n          break;\n        case 102:\n          chars.push(12);\n          break;\n        case 114:\n          chars.push(13);\n          break;\n        case 117:\n          chars.push(readu4());\n          break;\n        default:\n          throw new Error(`${ decodeErrPrefix } unexpected string escape character at position ${ this.pos }`);\n        }\n        break;\n      case 34:\n        this.pos++;\n        return new Token(Type.string, decodeCodePointsArray(chars), this.pos - startPos);\n      default:\n        if (ch < 32) {\n          throw new Error(`${ decodeErrPrefix } invalid control character at position ${ this.pos }`);\n        } else if (ch < 128) {\n          chars.push(ch);\n          this.pos++;\n        } else {\n          readUtf8Char();\n        }\n      }\n    }\n    throw new Error(`${ decodeErrPrefix } unexpected end of string at position ${ this.pos }`);\n  }\n  parseValue() {\n    switch (this.ch()) {\n    case 123:\n      this.modeStack.push('obj-start');\n      this.pos++;\n      return new Token(Type.map, Infinity, 1);\n    case 91:\n      this.modeStack.push('array-start');\n      this.pos++;\n      return new Token(Type.array, Infinity, 1);\n    case 34: {\n        return this.parseString();\n      }\n    case 110:\n      this.expect([\n        110,\n        117,\n        108,\n        108\n      ]);\n      return new Token(Type.null, null, 4);\n    case 102:\n      this.expect([\n        102,\n        97,\n        108,\n        115,\n        101\n      ]);\n      return new Token(Type.false, false, 5);\n    case 116:\n      this.expect([\n        116,\n        114,\n        117,\n        101\n      ]);\n      return new Token(Type.true, true, 4);\n    case 45:\n    case 48:\n    case 49:\n    case 50:\n    case 51:\n    case 52:\n    case 53:\n    case 54:\n    case 55:\n    case 56:\n    case 57:\n      return this.parseNumber();\n    default:\n      throw new Error(`${ decodeErrPrefix } unexpected character at position ${ this.pos }`);\n    }\n  }\n  next() {\n    this.skipWhitespace();\n    switch (this.currentMode()) {\n    case 'value':\n      this.modeStack.pop();\n      return this.parseValue();\n    case 'array-value': {\n        this.modeStack.pop();\n        if (this.ch() === 93) {\n          this.pos++;\n          this.skipWhitespace();\n          return new Token(Type.break, undefined, 1);\n        }\n        if (this.ch() !== 44) {\n          throw new Error(`${ decodeErrPrefix } unexpected character at position ${ this.pos }, was expecting array delimiter but found '${ String.fromCharCode(this.ch()) }'`);\n        }\n        this.pos++;\n        this.modeStack.push('array-value');\n        this.skipWhitespace();\n        return this.parseValue();\n      }\n    case 'array-start': {\n        this.modeStack.pop();\n        if (this.ch() === 93) {\n          this.pos++;\n          this.skipWhitespace();\n          return new Token(Type.break, undefined, 1);\n        }\n        this.modeStack.push('array-value');\n        this.skipWhitespace();\n        return this.parseValue();\n      }\n    case 'obj-key':\n      if (this.ch() === 125) {\n        this.modeStack.pop();\n        this.pos++;\n        this.skipWhitespace();\n        return new Token(Type.break, undefined, 1);\n      }\n      if (this.ch() !== 44) {\n        throw new Error(`${ decodeErrPrefix } unexpected character at position ${ this.pos }, was expecting object delimiter but found '${ String.fromCharCode(this.ch()) }'`);\n      }\n      this.pos++;\n      this.skipWhitespace();\n    case 'obj-start': {\n        this.modeStack.pop();\n        if (this.ch() === 125) {\n          this.pos++;\n          this.skipWhitespace();\n          return new Token(Type.break, undefined, 1);\n        }\n        const token = this.parseString();\n        this.skipWhitespace();\n        if (this.ch() !== 58) {\n          throw new Error(`${ decodeErrPrefix } unexpected character at position ${ this.pos }, was expecting key/value delimiter ':' but found '${ String.fromCharCode(this.ch()) }'`);\n        }\n        this.pos++;\n        this.modeStack.push('obj-value');\n        return token;\n      }\n    case 'obj-value': {\n        this.modeStack.pop();\n        this.modeStack.push('obj-key');\n        this.skipWhitespace();\n        return this.parseValue();\n      }\n    default:\n      throw new Error(`${ decodeErrPrefix } unexpected parse state at position ${ this.pos }; this shouldn't happen`);\n    }\n  }\n}\nfunction decode(data, options) {\n  options = Object.assign({ tokenizer: new Tokenizer(data, options) }, options);\n  return _decode(data, options);\n}\nexport {\n  decode,\n  Tokenizer\n};","import {\n  Token,\n  Type\n} from './token.js';\nimport * as uint from './0uint.js';\nimport * as negint from './1negint.js';\nimport * as bytes from './2bytes.js';\nimport * as string from './3string.js';\nimport * as array from './4array.js';\nimport * as map from './5map.js';\nimport * as tag from './6tag.js';\nimport * as float from './7float.js';\nimport { decodeErrPrefix } from './common.js';\nimport { fromArray } from './byte-utils.js';\nfunction invalidMinor(data, pos, minor) {\n  throw new Error(`${ decodeErrPrefix } encountered invalid minor (${ minor }) for major ${ data[pos] >>> 5 }`);\n}\nfunction errorer(msg) {\n  return () => {\n    throw new Error(`${ decodeErrPrefix } ${ msg }`);\n  };\n}\nexport const jump = [];\nfor (let i = 0; i <= 23; i++) {\n  jump[i] = invalidMinor;\n}\njump[24] = uint.decodeUint8;\njump[25] = uint.decodeUint16;\njump[26] = uint.decodeUint32;\njump[27] = uint.decodeUint64;\njump[28] = invalidMinor;\njump[29] = invalidMinor;\njump[30] = invalidMinor;\njump[31] = invalidMinor;\nfor (let i = 32; i <= 55; i++) {\n  jump[i] = invalidMinor;\n}\njump[56] = negint.decodeNegint8;\njump[57] = negint.decodeNegint16;\njump[58] = negint.decodeNegint32;\njump[59] = negint.decodeNegint64;\njump[60] = invalidMinor;\njump[61] = invalidMinor;\njump[62] = invalidMinor;\njump[63] = invalidMinor;\nfor (let i = 64; i <= 87; i++) {\n  jump[i] = bytes.decodeBytesCompact;\n}\njump[88] = bytes.decodeBytes8;\njump[89] = bytes.decodeBytes16;\njump[90] = bytes.decodeBytes32;\njump[91] = bytes.decodeBytes64;\njump[92] = invalidMinor;\njump[93] = invalidMinor;\njump[94] = invalidMinor;\njump[95] = errorer('indefinite length bytes/strings are not supported');\nfor (let i = 96; i <= 119; i++) {\n  jump[i] = string.decodeStringCompact;\n}\njump[120] = string.decodeString8;\njump[121] = string.decodeString16;\njump[122] = string.decodeString32;\njump[123] = string.decodeString64;\njump[124] = invalidMinor;\njump[125] = invalidMinor;\njump[126] = invalidMinor;\njump[127] = errorer('indefinite length bytes/strings are not supported');\nfor (let i = 128; i <= 151; i++) {\n  jump[i] = array.decodeArrayCompact;\n}\njump[152] = array.decodeArray8;\njump[153] = array.decodeArray16;\njump[154] = array.decodeArray32;\njump[155] = array.decodeArray64;\njump[156] = invalidMinor;\njump[157] = invalidMinor;\njump[158] = invalidMinor;\njump[159] = array.decodeArrayIndefinite;\nfor (let i = 160; i <= 183; i++) {\n  jump[i] = map.decodeMapCompact;\n}\njump[184] = map.decodeMap8;\njump[185] = map.decodeMap16;\njump[186] = map.decodeMap32;\njump[187] = map.decodeMap64;\njump[188] = invalidMinor;\njump[189] = invalidMinor;\njump[190] = invalidMinor;\njump[191] = map.decodeMapIndefinite;\nfor (let i = 192; i <= 215; i++) {\n  jump[i] = tag.decodeTagCompact;\n}\njump[216] = tag.decodeTag8;\njump[217] = tag.decodeTag16;\njump[218] = tag.decodeTag32;\njump[219] = tag.decodeTag64;\njump[220] = invalidMinor;\njump[221] = invalidMinor;\njump[222] = invalidMinor;\njump[223] = invalidMinor;\nfor (let i = 224; i <= 243; i++) {\n  jump[i] = errorer('simple values are not supported');\n}\njump[244] = invalidMinor;\njump[245] = invalidMinor;\njump[246] = invalidMinor;\njump[247] = float.decodeUndefined;\njump[248] = errorer('simple values are not supported');\njump[249] = float.decodeFloat16;\njump[250] = float.decodeFloat32;\njump[251] = float.decodeFloat64;\njump[252] = invalidMinor;\njump[253] = invalidMinor;\njump[254] = invalidMinor;\njump[255] = float.decodeBreak;\nexport const quick = [];\nfor (let i = 0; i < 24; i++) {\n  quick[i] = new Token(Type.uint, i, 1);\n}\nfor (let i = -1; i >= -24; i--) {\n  quick[31 - i] = new Token(Type.negint, i, 1);\n}\nquick[64] = new Token(Type.bytes, new Uint8Array(0), 1);\nquick[96] = new Token(Type.string, '', 1);\nquick[128] = new Token(Type.array, 0, 1);\nquick[160] = new Token(Type.map, 0, 1);\nquick[244] = new Token(Type.false, false, 1);\nquick[245] = new Token(Type.true, true, 1);\nquick[246] = new Token(Type.null, null, 1);\nexport function quickEncodeToken(token) {\n  switch (token.type) {\n  case Type.false:\n    return fromArray([244]);\n  case Type.true:\n    return fromArray([245]);\n  case Type.null:\n    return fromArray([246]);\n  case Type.bytes:\n    if (!token.value.length) {\n      return fromArray([64]);\n    }\n    return;\n  case Type.string:\n    if (token.value === '') {\n      return fromArray([96]);\n    }\n    return;\n  case Type.array:\n    if (token.value === 0) {\n      return fromArray([128]);\n    }\n    return;\n  case Type.map:\n    if (token.value === 0) {\n      return fromArray([160]);\n    }\n    return;\n  case Type.uint:\n    if (token.value < 24) {\n      return fromArray([Number(token.value)]);\n    }\n    return;\n  case Type.negint:\n    if (token.value >= -24) {\n      return fromArray([31 - Number(token.value)]);\n    }\n  }\n}","class Type {\n  constructor(major, name, terminal) {\n    this.major = major;\n    this.majorEncoded = major << 5;\n    this.name = name;\n    this.terminal = terminal;\n  }\n  toString() {\n    return `Type[${ this.major }].${ this.name }`;\n  }\n  compare(typ) {\n    return this.major < typ.major ? -1 : this.major > typ.major ? 1 : 0;\n  }\n}\nType.uint = new Type(0, 'uint', true);\nType.negint = new Type(1, 'negint', true);\nType.bytes = new Type(2, 'bytes', true);\nType.string = new Type(3, 'string', true);\nType.array = new Type(4, 'array', false);\nType.map = new Type(5, 'map', false);\nType.tag = new Type(6, 'tag', false);\nType.float = new Type(7, 'float', true);\nType.false = new Type(7, 'false', true);\nType.true = new Type(7, 'true', true);\nType.null = new Type(7, 'null', true);\nType.undefined = new Type(7, 'undefined', true);\nType.break = new Type(7, 'break', true);\nclass Token {\n  constructor(type, value, encodedLength) {\n    this.type = type;\n    this.value = value;\n    this.encodedLength = encodedLength;\n    this.encodedBytes = undefined;\n    this.byteValue = undefined;\n  }\n  toString() {\n    return `Token[${ this.type }].${ this.value }`;\n  }\n}\nexport {\n  Type,\n  Token\n};","import { base64url } from 'multiformats/bases/base64';\nexport function toBase64url(b) {\n    return base64url.encode(b).slice(1);\n}\nexport function fromBase64url(s) {\n    return base64url.decode(`u${s}`);\n}\n//# sourceMappingURL=utils.js.map","import { fromBase64url, toBase64url } from './utils.js';\nimport { CID } from 'multiformats/cid';\nexport function fromSplit(split) {\n    const [protectedHeader, payload, signature] = split;\n    return {\n        payload,\n        signatures: [{ protected: protectedHeader, signature }],\n        link: CID.decode(fromBase64url(payload)),\n    };\n}\nfunction encodeSignature(signature) {\n    const encoded = {\n        signature: fromBase64url(signature.signature),\n    };\n    if (signature.header)\n        encoded.header = signature.header;\n    if (signature.protected)\n        encoded.protected = fromBase64url(signature.protected);\n    return encoded;\n}\nexport function encode(jws) {\n    const payload = fromBase64url(jws.payload);\n    try {\n        CID.decode(payload);\n    }\n    catch (e) {\n        throw new Error('Not a valid DagJWS');\n    }\n    return {\n        payload,\n        signatures: jws.signatures.map(encodeSignature),\n    };\n}\nfunction decodeSignature(encoded) {\n    const sign = {\n        signature: toBase64url(encoded.signature),\n    };\n    if (encoded.header)\n        sign.header = encoded.header;\n    if (encoded.protected)\n        sign.protected = toBase64url(encoded.protected);\n    return sign;\n}\nexport function decode(encoded) {\n    const decoded = {\n        payload: toBase64url(encoded.payload),\n        signatures: encoded.signatures.map(decodeSignature),\n    };\n    decoded.link = CID.decode(new Uint8Array(encoded.payload));\n    return decoded;\n}\n//# sourceMappingURL=signing.js.map","import { fromBase64url, toBase64url } from './utils.js';\nexport function fromSplit(split) {\n    const [protectedHeader, encrypted_key, iv, ciphertext, tag] = split;\n    const jwe = {\n        ciphertext,\n        iv,\n        protected: protectedHeader,\n        tag,\n    };\n    if (encrypted_key)\n        jwe.recipients = [{ encrypted_key }];\n    return jwe;\n}\nfunction encodeRecipient(recipient) {\n    const encRec = {};\n    if (recipient.encrypted_key)\n        encRec.encrypted_key = fromBase64url(recipient.encrypted_key);\n    if (recipient.header)\n        encRec.header = recipient.header;\n    return encRec;\n}\nexport function encode(jwe) {\n    const encJwe = {\n        ciphertext: fromBase64url(jwe.ciphertext),\n        protected: fromBase64url(jwe.protected),\n        iv: fromBase64url(jwe.iv),\n        tag: fromBase64url(jwe.tag),\n    };\n    if (jwe.aad)\n        encJwe.aad = fromBase64url(jwe.aad);\n    if (jwe.recipients)\n        encJwe.recipients = jwe.recipients.map(encodeRecipient);\n    if (jwe.unprotected)\n        encJwe.unprotected = jwe.unprotected;\n    return encJwe;\n}\nfunction decodeRecipient(encoded) {\n    const recipient = {};\n    if (encoded.encrypted_key)\n        recipient.encrypted_key = toBase64url(encoded.encrypted_key);\n    if (encoded.header)\n        recipient.header = encoded.header;\n    return recipient;\n}\nexport function decode(encoded) {\n    const jwe = {\n        ciphertext: toBase64url(encoded.ciphertext),\n        protected: toBase64url(encoded.protected),\n        iv: toBase64url(encoded.iv),\n        tag: toBase64url(encoded.tag),\n    };\n    if (encoded.aad)\n        jwe.aad = toBase64url(encoded.aad);\n    if (encoded.recipients)\n        jwe.recipients = encoded.recipients.map(decodeRecipient);\n    if (encoded.unprotected)\n        jwe.unprotected = encoded.unprotected;\n    return jwe;\n}\n//# sourceMappingURL=encryption.js.map","import * as signing from './signing.js';\nimport * as encryption from './encryption.js';\nimport * as cbor from '@ipld/dag-cbor';\nexport const name = 'dag-jose';\nexport const code = 133;\nfunction isDagJWS(jose) {\n    return ('payload' in jose &&\n        typeof jose.payload === 'string' &&\n        'signatures' in jose &&\n        Array.isArray(jose.signatures));\n}\nfunction isEncodedJWS(jose) {\n    return ('payload' in jose &&\n        jose.payload instanceof Uint8Array &&\n        'signatures' in jose &&\n        Array.isArray(jose.signatures));\n}\nfunction isEncodedJWE(jose) {\n    return ('ciphertext' in jose &&\n        jose.ciphertext instanceof Uint8Array &&\n        'iv' in jose &&\n        jose.iv instanceof Uint8Array &&\n        'protected' in jose &&\n        jose.protected instanceof Uint8Array &&\n        'tag' in jose &&\n        jose.tag instanceof Uint8Array);\n}\nfunction isDagJWE(jose) {\n    return ('ciphertext' in jose &&\n        typeof jose.ciphertext === 'string' &&\n        'iv' in jose &&\n        typeof jose.iv === 'string' &&\n        'protected' in jose &&\n        typeof jose.protected === 'string' &&\n        'tag' in jose &&\n        typeof jose.tag === 'string');\n}\nexport function toGeneral(jose) {\n    if (typeof jose === 'string') {\n        const split = jose.split('.');\n        if (split.length === 3) {\n            return signing.fromSplit(split);\n        }\n        else if (split.length === 5) {\n            return encryption.fromSplit(split);\n        }\n        throw new Error('Not a valid JOSE string');\n    }\n    if (isDagJWS(jose) || isDagJWE(jose)) {\n        return jose;\n    }\n    throw new Error('Not a valid unencoded JOSE object');\n}\nexport function encode(obj) {\n    if (typeof obj === 'string') {\n        obj = toGeneral(obj);\n    }\n    let encodedJose;\n    if (isDagJWS(obj)) {\n        encodedJose = signing.encode(obj);\n    }\n    else if (isDagJWE(obj)) {\n        encodedJose = encryption.encode(obj);\n    }\n    else {\n        throw new Error('Not a valid JOSE object');\n    }\n    return new Uint8Array(cbor.encode(encodedJose));\n}\nexport function decode(data) {\n    let encoded;\n    try {\n        encoded = cbor.decode(data);\n    }\n    catch (e) {\n        throw new Error('Not a valid DAG-JOSE object');\n    }\n    if (isEncodedJWS(encoded)) {\n        return signing.decode(encoded);\n    }\n    else if (isEncodedJWE(encoded)) {\n        return encryption.decode(encoded);\n    }\n    else {\n        throw new Error('Not a valid DAG-JOSE object');\n    }\n}\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction drain(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            for await (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n        })();\n    }\n    else {\n        for (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n    }\n}\nexport default drain;\n//# sourceMappingURL=index.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction filter(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const entry of source) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    // if mapping function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    // @ts-expect-error .then is not present on O\n    if (typeof res.then === 'function') {\n        return (async function* () {\n            if (await res) {\n                yield value;\n            }\n            for await (const entry of peekable) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        if (res === true) {\n            yield value;\n        }\n        for (const entry of peekable) {\n            if (func(entry)) {\n                yield entry;\n            }\n        }\n    })();\n}\nexport default filter;\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction all(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            const arr = [];\n            for await (const entry of source) {\n                arr.push(entry);\n            }\n            return arr;\n        })();\n    }\n    const arr = [];\n    for (const entry of source) {\n        arr.push(entry);\n    }\n    return arr;\n}\nexport default all;\n//# sourceMappingURL=index.js.map","import all from 'it-all';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction sort(source, sorter) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            const arr = await all(source);\n            yield* arr.sort(sorter);\n        })();\n    }\n    return (function* () {\n        const arr = all(source);\n        yield* arr.sort(sorter);\n    })();\n}\nexport default sort;\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction take(source, limit) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            let items = 0;\n            if (limit < 1) {\n                return;\n            }\n            for await (const entry of source) {\n                yield entry;\n                items++;\n                if (items === limit) {\n                    return;\n                }\n            }\n        })();\n    }\n    return (function* () {\n        let items = 0;\n        if (limit < 1) {\n            return;\n        }\n        for (const entry of source) {\n            yield entry;\n            items++;\n            if (items === limit) {\n                return;\n            }\n        }\n    })();\n}\nexport default take;\n//# sourceMappingURL=index.js.map","import drain from 'it-drain';\nimport filter from 'it-filter';\nimport sort from 'it-sort';\nimport take from 'it-take';\nexport class BaseDatastore {\n    put(key, val, options) {\n        return Promise.reject(new Error('.put is not implemented'));\n    }\n    get(key, options) {\n        return Promise.reject(new Error('.get is not implemented'));\n    }\n    has(key, options) {\n        return Promise.reject(new Error('.has is not implemented'));\n    }\n    delete(key, options) {\n        return Promise.reject(new Error('.delete is not implemented'));\n    }\n    async *putMany(source, options = {}) {\n        for await (const { key, value } of source) {\n            await this.put(key, value, options);\n            yield key;\n        }\n    }\n    async *getMany(source, options = {}) {\n        for await (const key of source) {\n            yield {\n                key,\n                value: await this.get(key, options)\n            };\n        }\n    }\n    async *deleteMany(source, options = {}) {\n        for await (const key of source) {\n            await this.delete(key, options);\n            yield key;\n        }\n    }\n    batch() {\n        let puts = [];\n        let dels = [];\n        return {\n            put(key, value) {\n                puts.push({ key, value });\n            },\n            delete(key) {\n                dels.push(key);\n            },\n            commit: async (options) => {\n                await drain(this.putMany(puts, options));\n                puts = [];\n                await drain(this.deleteMany(dels, options));\n                dels = [];\n            }\n        };\n    }\n    /**\n     * Extending classes should override `query` or implement this method\n     */\n    // eslint-disable-next-line require-yield\n    async *_all(q, options) {\n        throw new Error('._all is not implemented');\n    }\n    /**\n     * Extending classes should override `queryKeys` or implement this method\n     */\n    // eslint-disable-next-line require-yield\n    async *_allKeys(q, options) {\n        throw new Error('._allKeys is not implemented');\n    }\n    query(q, options) {\n        let it = this._all(q, options);\n        if (q.prefix != null) {\n            const prefix = q.prefix;\n            it = filter(it, (e) => e.key.toString().startsWith(prefix));\n        }\n        if (Array.isArray(q.filters)) {\n            it = q.filters.reduce((it, f) => filter(it, f), it);\n        }\n        if (Array.isArray(q.orders)) {\n            it = q.orders.reduce((it, f) => sort(it, f), it);\n        }\n        if (q.offset != null) {\n            let i = 0;\n            const offset = q.offset;\n            it = filter(it, () => i++ >= offset);\n        }\n        if (q.limit != null) {\n            it = take(it, q.limit);\n        }\n        return it;\n    }\n    queryKeys(q, options) {\n        let it = this._allKeys(q, options);\n        if (q.prefix != null) {\n            const prefix = q.prefix;\n            it = filter(it, (key) => key.toString().startsWith(prefix));\n        }\n        if (Array.isArray(q.filters)) {\n            it = q.filters.reduce((it, f) => filter(it, f), it);\n        }\n        if (Array.isArray(q.orders)) {\n            it = q.orders.reduce((it, f) => sort(it, f), it);\n        }\n        if (q.offset != null) {\n            const offset = q.offset;\n            let i = 0;\n            it = filter(it, () => i++ >= offset);\n        }\n        if (q.limit != null) {\n            it = take(it, q.limit);\n        }\n        return it;\n    }\n}\n//# sourceMappingURL=base.js.map","import errCode from 'err-code';\nexport function dbOpenFailedError(err) {\n    err = err ?? new Error('Cannot open database');\n    return errCode(err, 'ERR_DB_OPEN_FAILED');\n}\nexport function dbDeleteFailedError(err) {\n    err = err ?? new Error('Delete failed');\n    return errCode(err, 'ERR_DB_DELETE_FAILED');\n}\nexport function dbWriteFailedError(err) {\n    err = err ?? new Error('Write failed');\n    return errCode(err, 'ERR_DB_WRITE_FAILED');\n}\nexport function dbReadFailedError(err) {\n    err = err ?? new Error('Read failed');\n    return errCode(err, 'ERR_DB_READ_FAILED');\n}\nexport function notFoundError(err) {\n    err = err ?? new Error('Not Found');\n    return errCode(err, 'ERR_NOT_FOUND');\n}\nexport function abortedError(err) {\n    err = err ?? new Error('Aborted');\n    return errCode(err, 'ERR_ABORTED');\n}\n//# sourceMappingURL=errors.js.map","import { Key } from 'interface-datastore/key';\nexport const PREFIX = '/repo/flatfs/shard/';\nexport const SHARDING_FN = 'SHARDING';\nexport class ShardBase {\n    param;\n    name;\n    _padding;\n    constructor(param) {\n        this.param = param;\n        this.name = 'base';\n        this._padding = '';\n    }\n    fun(s) {\n        return 'implement me';\n    }\n    toString() {\n        return `${PREFIX}v1/${this.name}/${this.param}`;\n    }\n}\nexport class Prefix extends ShardBase {\n    constructor(prefixLen) {\n        super(prefixLen);\n        this._padding = ''.padStart(prefixLen, '_');\n        this.name = 'prefix';\n    }\n    fun(noslash) {\n        return (noslash + this._padding).slice(0, this.param);\n    }\n}\nexport class Suffix extends ShardBase {\n    constructor(suffixLen) {\n        super(suffixLen);\n        this._padding = ''.padStart(suffixLen, '_');\n        this.name = 'suffix';\n    }\n    fun(noslash) {\n        const s = this._padding + noslash;\n        return s.slice(s.length - this.param);\n    }\n}\nexport class NextToLast extends ShardBase {\n    constructor(suffixLen) {\n        super(suffixLen);\n        this._padding = ''.padStart(suffixLen + 1, '_');\n        this.name = 'next-to-last';\n    }\n    fun(noslash) {\n        const s = this._padding + noslash;\n        const offset = s.length - this.param - 1;\n        return s.slice(offset, offset + this.param);\n    }\n}\n/**\n * Convert a given string to the matching sharding function\n */\nexport function parseShardFun(str) {\n    str = str.trim();\n    if (str.length === 0) {\n        throw new Error('empty shard string');\n    }\n    if (!str.startsWith(PREFIX)) {\n        throw new Error(`invalid or no path prefix: ${str}`);\n    }\n    const parts = str.slice(PREFIX.length).split('/');\n    const version = parts[0];\n    if (version !== 'v1') {\n        throw new Error(`expect 'v1' version, got '${version}'`);\n    }\n    const name = parts[1];\n    if (parts[2] == null || parts[2] === '') {\n        throw new Error('missing param');\n    }\n    const param = parseInt(parts[2], 10);\n    switch (name) {\n        case 'prefix':\n            return new Prefix(param);\n        case 'suffix':\n            return new Suffix(param);\n        case 'next-to-last':\n            return new NextToLast(param);\n        default:\n            throw new Error(`unkown sharding function: ${name}`);\n    }\n}\nexport const readShardFun = async (path, store) => {\n    const key = new Key(path).child(new Key(SHARDING_FN));\n    // @ts-expect-error not all stores have this\n    const get = typeof store.getRaw === 'function' ? store.getRaw.bind(store) : store.get.bind(store);\n    const res = await get(key);\n    return parseShardFun(new TextDecoder().decode(res ?? '').trim());\n};\n//# sourceMappingURL=shard.js.map","import { Key } from 'interface-datastore';\nimport { BaseDatastore } from './base.js';\nimport * as Errors from './errors.js';\nimport { KeyTransformDatastore } from './keytransform.js';\nimport { readShardFun, SHARDING_FN } from './shard.js';\nconst shardKey = new Key(SHARDING_FN);\n/**\n * Backend independent abstraction of go-ds-flatfs.\n *\n * Wraps another datastore such that all values are stored\n * sharded according to the given sharding function.\n */\nexport class ShardingDatastore extends BaseDatastore {\n    child;\n    shard;\n    constructor(store, shard) {\n        super();\n        this.child = new KeyTransformDatastore(store, {\n            convert: this._convertKey.bind(this),\n            invert: this._invertKey.bind(this)\n        });\n        this.shard = shard;\n    }\n    async open() {\n        this.shard = await ShardingDatastore.create(this.child, this.shard);\n    }\n    _convertKey(key) {\n        const s = key.toString();\n        if (s === shardKey.toString()) {\n            return key;\n        }\n        const parent = new Key(this.shard.fun(s));\n        return parent.child(key);\n    }\n    _invertKey(key) {\n        const s = key.toString();\n        if (s === shardKey.toString()) {\n            return key;\n        }\n        return Key.withNamespaces(key.list().slice(1));\n    }\n    static async create(store, shard) {\n        const hasShard = await store.has(shardKey);\n        if (!hasShard) {\n            if (shard == null) {\n                throw Errors.dbOpenFailedError(Error('Shard is required when datastore doesn\\'t have a shard key already.'));\n            }\n            await store.put(shardKey, new TextEncoder().encode(shard.toString() + '\\n'));\n        }\n        if (shard == null) {\n            shard = await readShardFun('/', store);\n        }\n        // test shards\n        const diskShard = await readShardFun('/', store);\n        const a = diskShard.toString();\n        const b = shard.toString();\n        if (a !== b) {\n            throw new Error(`specified fun ${b} does not match repo shard fun ${a}`);\n        }\n        return diskShard;\n    }\n    async put(key, val, options) {\n        await this.child.put(key, val, options);\n        return key;\n    }\n    async get(key, options) {\n        return this.child.get(key, options);\n    }\n    async has(key, options) {\n        return this.child.has(key, options);\n    }\n    async delete(key, options) {\n        await this.child.delete(key, options);\n    }\n    async *putMany(source, options = {}) {\n        yield* this.child.putMany(source, options);\n    }\n    async *getMany(source, options = {}) {\n        yield* this.child.getMany(source, options);\n    }\n    async *deleteMany(source, options = {}) {\n        yield* this.child.deleteMany(source, options);\n    }\n    batch() {\n        return this.child.batch();\n    }\n    query(q, options) {\n        const omitShard = ({ key }) => key.toString() !== shardKey.toString();\n        const tq = {\n            ...q,\n            filters: [\n                omitShard\n            ].concat(q.filters ?? [])\n        };\n        return this.child.query(tq, options);\n    }\n    queryKeys(q, options) {\n        const omitShard = (key) => key.toString() !== shardKey.toString();\n        const tq = {\n            ...q,\n            filters: [\n                omitShard\n            ].concat(q.filters ?? [])\n        };\n        return this.child.queryKeys(tq, options);\n    }\n}\n//# sourceMappingURL=sharding.js.map","/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\nimport deferred from 'p-defer';\nimport { FIFO } from './fifo.js';\nexport class AbortError extends Error {\n    type;\n    code;\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\nexport function pushable(options = {}) {\n    const getNext = (buffer) => {\n        const next = buffer.shift();\n        if (next == null) {\n            return { done: true };\n        }\n        if (next.error != null) {\n            throw next.error;\n        }\n        return {\n            done: next.done === true,\n            // @ts-expect-error if done is false, value will be present\n            value: next.value\n        };\n    };\n    return _pushable(getNext, options);\n}\nexport function pushableV(options = {}) {\n    const getNext = (buffer) => {\n        let next;\n        const values = [];\n        while (!buffer.isEmpty()) {\n            next = buffer.shift();\n            if (next == null) {\n                break;\n            }\n            if (next.error != null) {\n                throw next.error;\n            }\n            if (next.done === false) {\n                // @ts-expect-error if done is false value should be pushed\n                values.push(next.value);\n            }\n        }\n        if (next == null) {\n            return { done: true };\n        }\n        return {\n            done: next.done === true,\n            value: values\n        };\n    };\n    return _pushable(getNext, options);\n}\nfunction _pushable(getNext, options) {\n    options = options ?? {};\n    let onEnd = options.onEnd;\n    let buffer = new FIFO();\n    let pushable;\n    let onNext;\n    let ended;\n    let drain = deferred();\n    const waitNext = async () => {\n        try {\n            if (!buffer.isEmpty()) {\n                return getNext(buffer);\n            }\n            if (ended) {\n                return { done: true };\n            }\n            return await new Promise((resolve, reject) => {\n                onNext = (next) => {\n                    onNext = null;\n                    buffer.push(next);\n                    try {\n                        resolve(getNext(buffer));\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                    return pushable;\n                };\n            });\n        }\n        finally {\n            if (buffer.isEmpty()) {\n                // settle promise in the microtask queue to give consumers a chance to\n                // await after calling .push\n                queueMicrotask(() => {\n                    drain.resolve();\n                    drain = deferred();\n                });\n            }\n        }\n    };\n    const bufferNext = (next) => {\n        if (onNext != null) {\n            return onNext(next);\n        }\n        buffer.push(next);\n        return pushable;\n    };\n    const bufferError = (err) => {\n        buffer = new FIFO();\n        if (onNext != null) {\n            return onNext({ error: err });\n        }\n        buffer.push({ error: err });\n        return pushable;\n    };\n    const push = (value) => {\n        if (ended) {\n            return pushable;\n        }\n        // @ts-expect-error `byteLength` is not declared on PushType\n        if (options?.objectMode !== true && value?.byteLength == null) {\n            throw new Error('objectMode was not true but tried to push non-Uint8Array value');\n        }\n        return bufferNext({ done: false, value });\n    };\n    const end = (err) => {\n        if (ended)\n            return pushable;\n        ended = true;\n        return (err != null) ? bufferError(err) : bufferNext({ done: true });\n    };\n    const _return = () => {\n        buffer = new FIFO();\n        end();\n        return { done: true };\n    };\n    const _throw = (err) => {\n        end(err);\n        return { done: true };\n    };\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next: waitNext,\n        return: _return,\n        throw: _throw,\n        push,\n        end,\n        get readableLength() {\n            return buffer.size;\n        },\n        onEmpty: async (options) => {\n            const signal = options?.signal;\n            signal?.throwIfAborted();\n            if (buffer.isEmpty()) {\n                return;\n            }\n            let cancel;\n            let listener;\n            if (signal != null) {\n                cancel = new Promise((resolve, reject) => {\n                    listener = () => {\n                        reject(new AbortError());\n                    };\n                    signal.addEventListener('abort', listener);\n                });\n            }\n            try {\n                await Promise.race([\n                    drain.promise,\n                    cancel\n                ]);\n            }\n            finally {\n                if (listener != null && signal != null) {\n                    signal?.removeEventListener('abort', listener);\n                }\n            }\n        }\n    };\n    if (onEnd == null) {\n        return pushable;\n    }\n    const _pushable = pushable;\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next() {\n            return _pushable.next();\n        },\n        throw(err) {\n            _pushable.throw(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        return() {\n            _pushable.return();\n            if (onEnd != null) {\n                onEnd();\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        push,\n        end(err) {\n            _pushable.end(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return pushable;\n        },\n        get readableLength() {\n            return _pushable.readableLength;\n        }\n    };\n    return pushable;\n}\n//# sourceMappingURL=index.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","import { logger } from '@libp2p/logger';\nimport drain from 'it-drain';\nimport { pushable } from 'it-pushable';\nimport { BaseDatastore } from './base.js';\nimport * as Errors from './errors.js';\nconst log = logger('datastore:core:tiered');\n/**\n * A datastore that can combine multiple stores. Puts and deletes\n * will write through to all datastores. Has and get will\n * try each store sequentially. Query will always try the\n * last one first.\n *\n */\nexport class TieredDatastore extends BaseDatastore {\n    stores;\n    constructor(stores) {\n        super();\n        this.stores = stores.slice();\n    }\n    async put(key, value, options) {\n        try {\n            await Promise.all(this.stores.map(async (store) => { await store.put(key, value, options); }));\n            return key;\n        }\n        catch (err) {\n            throw Errors.dbWriteFailedError(err);\n        }\n    }\n    async get(key, options) {\n        for (const store of this.stores) {\n            try {\n                const res = await store.get(key, options);\n                if (res != null)\n                    return res;\n            }\n            catch (err) {\n                log.error(err);\n            }\n        }\n        throw Errors.notFoundError();\n    }\n    async has(key, options) {\n        for (const s of this.stores) {\n            if (await s.has(key, options)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    async delete(key, options) {\n        try {\n            await Promise.all(this.stores.map(async (store) => { await store.delete(key, options); }));\n        }\n        catch (err) {\n            throw Errors.dbDeleteFailedError(err);\n        }\n    }\n    async *putMany(source, options = {}) {\n        let error;\n        const pushables = this.stores.map(store => {\n            const source = pushable({\n                objectMode: true\n            });\n            drain(store.putMany(source, options))\n                .catch(err => {\n                // store threw while putting, make sure we bubble the error up\n                error = err;\n            });\n            return source;\n        });\n        try {\n            for await (const pair of source) {\n                if (error != null) {\n                    throw error;\n                }\n                pushables.forEach(p => p.push(pair));\n                yield pair.key;\n            }\n        }\n        finally {\n            pushables.forEach(p => p.end());\n        }\n    }\n    async *deleteMany(source, options = {}) {\n        let error;\n        const pushables = this.stores.map(store => {\n            const source = pushable({\n                objectMode: true\n            });\n            drain(store.deleteMany(source, options))\n                .catch(err => {\n                // store threw while deleting, make sure we bubble the error up\n                error = err;\n            });\n            return source;\n        });\n        try {\n            for await (const key of source) {\n                if (error != null) {\n                    throw error;\n                }\n                pushables.forEach(p => p.push(key));\n                yield key;\n            }\n        }\n        finally {\n            pushables.forEach(p => p.end());\n        }\n    }\n    batch() {\n        const batches = this.stores.map(store => store.batch());\n        return {\n            put: (key, value) => {\n                batches.forEach(b => { b.put(key, value); });\n            },\n            delete: (key) => {\n                batches.forEach(b => { b.delete(key); });\n            },\n            commit: async (options) => {\n                for (const batch of batches) {\n                    await batch.commit(options);\n                }\n            }\n        };\n    }\n    query(q, options) {\n        return this.stores[this.stores.length - 1].query(q, options);\n    }\n    queryKeys(q, options) {\n        return this.stores[this.stores.length - 1].queryKeys(q, options);\n    }\n}\n//# sourceMappingURL=tiered.js.map","import { Key } from 'interface-datastore/key';\nimport { BaseDatastore } from './base.js';\nimport * as Errors from './errors.js';\nexport class MemoryDatastore extends BaseDatastore {\n    data;\n    constructor() {\n        super();\n        this.data = new Map();\n    }\n    put(key, val) {\n        this.data.set(key.toString(), val);\n        return key;\n    }\n    get(key) {\n        const result = this.data.get(key.toString());\n        if (result == null) {\n            throw Errors.notFoundError();\n        }\n        return result;\n    }\n    has(key) {\n        return this.data.has(key.toString());\n    }\n    delete(key) {\n        this.data.delete(key.toString());\n    }\n    *_all() {\n        for (const [key, value] of this.data.entries()) {\n            yield { key: new Key(key), value };\n        }\n    }\n    *_allKeys() {\n        for (const key of this.data.keys()) {\n            yield new Key(key);\n        }\n    }\n}\n//# sourceMappingURL=memory.js.map","import { nanoid } from 'nanoid';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nconst pathSepS = '/';\nconst pathSepB = new TextEncoder().encode(pathSepS);\nconst pathSep = pathSepB[0];\n/**\n * A Key represents the unique identifier of an object.\n * Our Key scheme is inspired by file systems and Google App Engine key model.\n * Keys are meant to be unique across a system. Keys are hierarchical,\n * incorporating more and more specific namespaces. Thus keys can be deemed\n * 'children' or 'ancestors' of other keys:\n * - `new Key('/Comedy')`\n * - `new Key('/Comedy/MontyPython')`\n * Also, every namespace can be parametrized to embed relevant object\n * information. For example, the Key `name` (most specific namespace) could\n * include the object type:\n * - `new Key('/Comedy/MontyPython/Actor:JohnCleese')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop/Character:Mousebender')`\n *\n */\nexport class Key {\n    _buf;\n    /**\n     * @param {string | Uint8Array} s\n     * @param {boolean} [clean]\n     */\n    constructor(s, clean) {\n        if (typeof s === 'string') {\n            this._buf = uint8ArrayFromString(s);\n        }\n        else if (s instanceof Uint8Array) {\n            this._buf = s;\n        }\n        else {\n            throw new Error('Invalid key, should be String of Uint8Array');\n        }\n        if (clean == null) {\n            clean = true;\n        }\n        if (clean) {\n            this.clean();\n        }\n        if (this._buf.byteLength === 0 || this._buf[0] !== pathSep) {\n            throw new Error('Invalid key');\n        }\n    }\n    /**\n     * Convert to the string representation\n     *\n     * @param {import('uint8arrays/to-string').SupportedEncodings} [encoding='utf8'] - The encoding to use.\n     * @returns {string}\n     */\n    toString(encoding = 'utf8') {\n        return uint8ArrayToString(this._buf, encoding);\n    }\n    /**\n     * Return the Uint8Array representation of the key\n     *\n     * @returns {Uint8Array}\n     */\n    uint8Array() {\n        return this._buf;\n    }\n    /**\n     * Return string representation of the key\n     *\n     * @returns {string}\n     */\n    get [Symbol.toStringTag]() {\n        return `Key(${this.toString()})`;\n    }\n    /**\n     * Constructs a key out of a namespace array.\n     *\n     * @param {Array<string>} list - The array of namespaces\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.withNamespaces(['one', 'two'])\n     * // => Key('/one/two')\n     * ```\n     */\n    static withNamespaces(list) {\n        return new Key(list.join(pathSepS));\n    }\n    /**\n     * Returns a randomly (uuid) generated key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.random()\n     * // => Key('/f98719ea086343f7b71f32ea9d9d521d')\n     * ```\n     */\n    static random() {\n        return new Key(nanoid().replace(/-/g, ''));\n    }\n    /**\n     * @param {*} other\n     */\n    static asKey(other) {\n        if (other instanceof Uint8Array || typeof other === 'string') {\n            // we can create a key from this\n            return new Key(other);\n        }\n        if (typeof other.uint8Array === 'function') {\n            // this is an older version or may have crossed the esm/cjs boundary\n            return new Key(other.uint8Array());\n        }\n        return null;\n    }\n    /**\n     * Cleanup the current key\n     *\n     * @returns {void}\n     */\n    clean() {\n        if (this._buf == null || this._buf.byteLength === 0) {\n            this._buf = pathSepB;\n        }\n        if (this._buf[0] !== pathSep) {\n            const bytes = new Uint8Array(this._buf.byteLength + 1);\n            bytes.fill(pathSep, 0, 1);\n            bytes.set(this._buf, 1);\n            this._buf = bytes;\n        }\n        // normalize does not remove trailing slashes\n        while (this._buf.byteLength > 1 && this._buf[this._buf.byteLength - 1] === pathSep) {\n            this._buf = this._buf.subarray(0, -1);\n        }\n    }\n    /**\n     * Check if the given key is sorted lower than ourself.\n     *\n     * @param {Key} key - The other Key to check against\n     * @returns {boolean}\n     */\n    less(key) {\n        const list1 = this.list();\n        const list2 = key.list();\n        for (let i = 0; i < list1.length; i++) {\n            if (list2.length < i + 1) {\n                return false;\n            }\n            const c1 = list1[i];\n            const c2 = list2[i];\n            if (c1 < c2) {\n                return true;\n            }\n            else if (c1 > c2) {\n                return false;\n            }\n        }\n        return list1.length < list2.length;\n    }\n    /**\n     * Returns the key with all parts in reversed order.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').reverse()\n     * // => Key('/Actor:JohnCleese/MontyPython/Comedy')\n     * ```\n     */\n    reverse() {\n        return Key.withNamespaces(this.list().slice().reverse());\n    }\n    /**\n     * Returns the `namespaces` making up this Key.\n     *\n     * @returns {Array<string>}\n     */\n    namespaces() {\n        return this.list();\n    }\n    /** Returns the \"base\" namespace of this key.\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').baseNamespace()\n     * // => 'Actor:JohnCleese'\n     * ```\n     */\n    baseNamespace() {\n        const ns = this.namespaces();\n        return ns[ns.length - 1];\n    }\n    /**\n     * Returns the `list` representation of this key.\n     *\n     * @returns {Array<string>}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').list()\n     * // => ['Comedy', 'MontyPythong', 'Actor:JohnCleese']\n     * ```\n     */\n    list() {\n        return this.toString().split(pathSepS).slice(1);\n    }\n    /**\n     * Returns the \"type\" of this key (value of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').type()\n     * // => 'Actor'\n     * ```\n     */\n    type() {\n        return namespaceType(this.baseNamespace());\n    }\n    /**\n     * Returns the \"name\" of this key (field of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').name()\n     * // => 'JohnCleese'\n     * ```\n     */\n    name() {\n        return namespaceValue(this.baseNamespace());\n    }\n    /**\n     * Returns an \"instance\" of this type key (appends value to namespace).\n     *\n     * @param {string} s - The string to append.\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor').instance('JohnClesse')\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    instance(s) {\n        return new Key(this.toString() + ':' + s);\n    }\n    /**\n     * Returns the \"path\" of this key (parent + type).\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').path()\n     * // => Key('/Comedy/MontyPython/Actor')\n     * ```\n     */\n    path() {\n        let p = this.parent().toString();\n        if (!p.endsWith(pathSepS)) {\n            p += pathSepS;\n        }\n        p += this.type();\n        return new Key(p);\n    }\n    /**\n     * Returns the `parent` Key of this Key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key(\"/Comedy/MontyPython/Actor:JohnCleese\").parent()\n     * // => Key(\"/Comedy/MontyPython\")\n     * ```\n     */\n    parent() {\n        const list = this.list();\n        if (list.length === 1) {\n            return new Key(pathSepS);\n        }\n        return new Key(list.slice(0, -1).join(pathSepS));\n    }\n    /**\n     * Returns the `child` Key of this Key.\n     *\n     * @param {Key} key - The child Key to add\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').child(new Key('Actor:JohnCleese'))\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    child(key) {\n        if (this.toString() === pathSepS) {\n            return key;\n        }\n        else if (key.toString() === pathSepS) {\n            return this;\n        }\n        return new Key(this.toString() + key.toString(), false);\n    }\n    /**\n     * Returns whether this key is a prefix of `other`\n     *\n     * @param {Key} other - The other key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy').isAncestorOf('/Comedy/MontyPython')\n     * // => true\n     * ```\n     */\n    isAncestorOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return other.toString().startsWith(this.toString());\n    }\n    /**\n     * Returns whether this key is a contains another as prefix.\n     *\n     * @param {Key} other - The other Key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').isDecendantOf('/Comedy')\n     * // => true\n     * ```\n     */\n    isDecendantOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return this.toString().startsWith(other.toString());\n    }\n    /**\n     * Checks if this key has only one namespace.\n     *\n     * @returns {boolean}\n     */\n    isTopLevel() {\n        return this.list().length === 1;\n    }\n    /**\n     * Concats one or more Keys into one new Key.\n     *\n     * @param {Array<Key>} keys - The array of keys to concatenate\n     * @returns {Key}\n     */\n    concat(...keys) {\n        return Key.withNamespaces([...this.namespaces(), ...flatten(keys.map(key => key.namespaces()))]);\n    }\n}\n/**\n * The first component of a namespace. `foo` in `foo:bar`\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceType(ns) {\n    const parts = ns.split(':');\n    if (parts.length < 2) {\n        return '';\n    }\n    return parts.slice(0, -1).join(':');\n}\n/**\n * The last component of a namespace, `baz` in `foo:bar:baz`.\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceValue(ns) {\n    const parts = ns.split(':');\n    return parts[parts.length - 1];\n}\n/**\n * Flatten array of arrays (only one level)\n *\n * @template T\n * @param {Array<any>} arr\n * @returns {T[]}\n */\nfunction flatten(arr) {\n    return ([]).concat(...arr);\n}\n//# sourceMappingURL=key.js.map","import { nanoid } from 'nanoid';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nconst pathSepS = '/';\nconst pathSepB = new TextEncoder().encode(pathSepS);\nconst pathSep = pathSepB[0];\n/**\n * A Key represents the unique identifier of an object.\n * Our Key scheme is inspired by file systems and Google App Engine key model.\n * Keys are meant to be unique across a system. Keys are hierarchical,\n * incorporating more and more specific namespaces. Thus keys can be deemed\n * 'children' or 'ancestors' of other keys:\n * - `new Key('/Comedy')`\n * - `new Key('/Comedy/MontyPython')`\n * Also, every namespace can be parametrized to embed relevant object\n * information. For example, the Key `name` (most specific namespace) could\n * include the object type:\n * - `new Key('/Comedy/MontyPython/Actor:JohnCleese')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop/Character:Mousebender')`\n *\n */\nexport class Key {\n    /**\n     * @param {string | Uint8Array} s\n     * @param {boolean} [clean]\n     */\n    constructor(s, clean) {\n        if (typeof s === 'string') {\n            this._buf = uint8ArrayFromString(s);\n        }\n        else if (s instanceof Uint8Array) {\n            this._buf = s;\n        }\n        else {\n            throw new Error('Invalid key, should be String of Uint8Array');\n        }\n        if (clean == null) {\n            clean = true;\n        }\n        if (clean) {\n            this.clean();\n        }\n        if (this._buf.byteLength === 0 || this._buf[0] !== pathSep) {\n            throw new Error('Invalid key');\n        }\n    }\n    /**\n     * Convert to the string representation\n     *\n     * @param {import('uint8arrays/to-string').SupportedEncodings} [encoding='utf8'] - The encoding to use.\n     * @returns {string}\n     */\n    toString(encoding = 'utf8') {\n        return uint8ArrayToString(this._buf, encoding);\n    }\n    /**\n     * Return the Uint8Array representation of the key\n     *\n     * @returns {Uint8Array}\n     */\n    uint8Array() {\n        return this._buf;\n    }\n    /**\n     * Return string representation of the key\n     *\n     * @returns {string}\n     */\n    get [Symbol.toStringTag]() {\n        return `Key(${this.toString()})`;\n    }\n    /**\n     * Constructs a key out of a namespace array.\n     *\n     * @param {Array<string>} list - The array of namespaces\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.withNamespaces(['one', 'two'])\n     * // => Key('/one/two')\n     * ```\n     */\n    static withNamespaces(list) {\n        return new Key(list.join(pathSepS));\n    }\n    /**\n     * Returns a randomly (uuid) generated key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.random()\n     * // => Key('/f98719ea086343f7b71f32ea9d9d521d')\n     * ```\n     */\n    static random() {\n        return new Key(nanoid().replace(/-/g, ''));\n    }\n    /**\n     * @param {*} other\n     */\n    static asKey(other) {\n        if (other instanceof Uint8Array || typeof other === 'string') {\n            // we can create a key from this\n            return new Key(other);\n        }\n        if (typeof other.uint8Array === 'function') {\n            // this is an older version or may have crossed the esm/cjs boundary\n            return new Key(other.uint8Array());\n        }\n        return null;\n    }\n    /**\n     * Cleanup the current key\n     *\n     * @returns {void}\n     */\n    clean() {\n        if (this._buf == null || this._buf.byteLength === 0) {\n            this._buf = pathSepB;\n        }\n        if (this._buf[0] !== pathSep) {\n            const bytes = new Uint8Array(this._buf.byteLength + 1);\n            bytes.fill(pathSep, 0, 1);\n            bytes.set(this._buf, 1);\n            this._buf = bytes;\n        }\n        // normalize does not remove trailing slashes\n        while (this._buf.byteLength > 1 && this._buf[this._buf.byteLength - 1] === pathSep) {\n            this._buf = this._buf.subarray(0, -1);\n        }\n    }\n    /**\n     * Check if the given key is sorted lower than ourself.\n     *\n     * @param {Key} key - The other Key to check against\n     * @returns {boolean}\n     */\n    less(key) {\n        const list1 = this.list();\n        const list2 = key.list();\n        for (let i = 0; i < list1.length; i++) {\n            if (list2.length < i + 1) {\n                return false;\n            }\n            const c1 = list1[i];\n            const c2 = list2[i];\n            if (c1 < c2) {\n                return true;\n            }\n            else if (c1 > c2) {\n                return false;\n            }\n        }\n        return list1.length < list2.length;\n    }\n    /**\n     * Returns the key with all parts in reversed order.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').reverse()\n     * // => Key('/Actor:JohnCleese/MontyPython/Comedy')\n     * ```\n     */\n    reverse() {\n        return Key.withNamespaces(this.list().slice().reverse());\n    }\n    /**\n     * Returns the `namespaces` making up this Key.\n     *\n     * @returns {Array<string>}\n     */\n    namespaces() {\n        return this.list();\n    }\n    /** Returns the \"base\" namespace of this key.\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').baseNamespace()\n     * // => 'Actor:JohnCleese'\n     * ```\n     */\n    baseNamespace() {\n        const ns = this.namespaces();\n        return ns[ns.length - 1];\n    }\n    /**\n     * Returns the `list` representation of this key.\n     *\n     * @returns {Array<string>}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').list()\n     * // => ['Comedy', 'MontyPythong', 'Actor:JohnCleese']\n     * ```\n     */\n    list() {\n        return this.toString().split(pathSepS).slice(1);\n    }\n    /**\n     * Returns the \"type\" of this key (value of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').type()\n     * // => 'Actor'\n     * ```\n     */\n    type() {\n        return namespaceType(this.baseNamespace());\n    }\n    /**\n     * Returns the \"name\" of this key (field of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').name()\n     * // => 'JohnCleese'\n     * ```\n     */\n    name() {\n        return namespaceValue(this.baseNamespace());\n    }\n    /**\n     * Returns an \"instance\" of this type key (appends value to namespace).\n     *\n     * @param {string} s - The string to append.\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor').instance('JohnClesse')\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    instance(s) {\n        return new Key(this.toString() + ':' + s);\n    }\n    /**\n     * Returns the \"path\" of this key (parent + type).\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').path()\n     * // => Key('/Comedy/MontyPython/Actor')\n     * ```\n     */\n    path() {\n        let p = this.parent().toString();\n        if (!p.endsWith(pathSepS)) {\n            p += pathSepS;\n        }\n        p += this.type();\n        return new Key(p);\n    }\n    /**\n     * Returns the `parent` Key of this Key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key(\"/Comedy/MontyPython/Actor:JohnCleese\").parent()\n     * // => Key(\"/Comedy/MontyPython\")\n     * ```\n     */\n    parent() {\n        const list = this.list();\n        if (list.length === 1) {\n            return new Key(pathSepS);\n        }\n        return new Key(list.slice(0, -1).join(pathSepS));\n    }\n    /**\n     * Returns the `child` Key of this Key.\n     *\n     * @param {Key} key - The child Key to add\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').child(new Key('Actor:JohnCleese'))\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    child(key) {\n        if (this.toString() === pathSepS) {\n            return key;\n        }\n        else if (key.toString() === pathSepS) {\n            return this;\n        }\n        return new Key(this.toString() + key.toString(), false);\n    }\n    /**\n     * Returns whether this key is a prefix of `other`\n     *\n     * @param {Key} other - The other key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy').isAncestorOf('/Comedy/MontyPython')\n     * // => true\n     * ```\n     */\n    isAncestorOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return other.toString().startsWith(this.toString());\n    }\n    /**\n     * Returns whether this key is a contains another as prefix.\n     *\n     * @param {Key} other - The other Key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').isDecendantOf('/Comedy')\n     * // => true\n     * ```\n     */\n    isDecendantOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return this.toString().startsWith(other.toString());\n    }\n    /**\n     * Checks if this key has only one namespace.\n     *\n     * @returns {boolean}\n     *\n     */\n    isTopLevel() {\n        return this.list().length === 1;\n    }\n    /**\n     * Concats one or more Keys into one new Key.\n     *\n     * @param {Array<Key>} keys - The array of keys to concatenate\n     * @returns {Key}\n     */\n    concat(...keys) {\n        return Key.withNamespaces([...this.namespaces(), ...flatten(keys.map(key => key.namespaces()))]);\n    }\n}\n/**\n * The first component of a namespace. `foo` in `foo:bar`\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceType(ns) {\n    const parts = ns.split(':');\n    if (parts.length < 2) {\n        return '';\n    }\n    return parts.slice(0, -1).join(':');\n}\n/**\n * The last component of a namespace, `baz` in `foo:bar:baz`.\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceValue(ns) {\n    const parts = ns.split(':');\n    return parts[parts.length - 1];\n}\n/**\n * Flatten array of arrays (only one level)\n *\n * @template T\n * @param {Array<any>} arr\n * @returns {T[]}\n */\nfunction flatten(arr) {\n    return ([]).concat(...arr);\n}\n//# sourceMappingURL=key.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction filter(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const entry of source) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    // if mapping function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    // @ts-expect-error .then is not present on O\n    if (typeof res.then === 'function') {\n        return (async function* () {\n            if (await res) {\n                yield value;\n            }\n            for await (const entry of peekable) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        if (res === true) {\n            yield value;\n        }\n        for (const entry of peekable) {\n            if (func(entry)) {\n                yield entry;\n            }\n        }\n    })();\n}\nexport default filter;\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction all(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            const arr = [];\n            for await (const entry of source) {\n                arr.push(entry);\n            }\n            return arr;\n        })();\n    }\n    const arr = [];\n    for (const entry of source) {\n        arr.push(entry);\n    }\n    return arr;\n}\nexport default all;\n//# sourceMappingURL=index.js.map","import all from 'it-all';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction sort(source, sorter) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            const arr = await all(source);\n            yield* arr.sort(sorter);\n        })();\n    }\n    return (function* () {\n        const arr = all(source);\n        yield* arr.sort(sorter);\n    })();\n}\nexport default sort;\n//# sourceMappingURL=index.js.map","import { Errors, BaseDatastore } from 'datastore-core';\nimport { openDB, deleteDB } from 'idb';\nimport { Key } from 'interface-datastore';\nimport filter from 'it-filter';\nimport sort from 'it-sort';\nexport class IDBDatastore extends BaseDatastore {\n    location;\n    version;\n    db;\n    constructor(location, init = {}) {\n        super();\n        this.location = `${init.prefix ?? ''}${location}`;\n        this.version = init.version ?? 1;\n    }\n    async open() {\n        try {\n            const location = this.location;\n            this.db = await openDB(location, this.version, {\n                upgrade(db) {\n                    db.createObjectStore(location);\n                }\n            });\n        }\n        catch (err) {\n            throw Errors.dbOpenFailedError(err);\n        }\n    }\n    async close() {\n        this.db?.close();\n    }\n    async put(key, val) {\n        if (this.db == null) {\n            throw new Error('Datastore needs to be opened.');\n        }\n        try {\n            await this.db.put(this.location, val, key.toString());\n            return key;\n        }\n        catch (err) {\n            throw Errors.dbWriteFailedError(err);\n        }\n    }\n    async get(key) {\n        if (this.db == null) {\n            throw new Error('Datastore needs to be opened.');\n        }\n        let val;\n        try {\n            val = await this.db.get(this.location, key.toString());\n        }\n        catch (err) {\n            throw Errors.dbReadFailedError(err);\n        }\n        if (val === undefined) {\n            throw Errors.notFoundError();\n        }\n        return val;\n    }\n    async has(key) {\n        if (this.db == null) {\n            throw new Error('Blockstore needs to be opened.');\n        }\n        try {\n            return Boolean(await this.db.getKey(this.location, key.toString()));\n        }\n        catch (err) {\n            throw Errors.dbReadFailedError(err);\n        }\n    }\n    async delete(key) {\n        if (this.db == null) {\n            throw new Error('Datastore needs to be opened.');\n        }\n        try {\n            await this.db.delete(this.location, key.toString());\n        }\n        catch (err) {\n            throw Errors.dbWriteFailedError(err);\n        }\n    }\n    batch() {\n        const puts = [];\n        const dels = [];\n        return {\n            put(key, value) {\n                puts.push({ key, value });\n            },\n            delete(key) {\n                dels.push(key);\n            },\n            commit: async () => {\n                if (this.db == null) {\n                    throw new Error('Datastore needs to be opened.');\n                }\n                const tx = this.db.transaction(this.location, 'readwrite');\n                try {\n                    const ops = puts.filter(({ key }) => {\n                        // don't put a key we are about to delete\n                        return dels.find(delKey => delKey.toString() === key.toString()) == null;\n                    })\n                        .map(put => {\n                        return async () => {\n                            await tx.store.put(put.value, put.key.toString());\n                        };\n                    })\n                        .concat(dels.map(key => {\n                        return async () => {\n                            await tx.store.delete(key.toString());\n                        };\n                    }))\n                        .concat(async () => {\n                        await tx.done;\n                    });\n                    await Promise.all(ops.map(async (op) => { await op(); }));\n                }\n                catch {\n                    tx.abort();\n                }\n            }\n        };\n    }\n    async *query(q) {\n        let it = this.#queryIt(q, (key, value) => {\n            return { key, value };\n        });\n        if (Array.isArray(q.filters)) {\n            it = q.filters.reduce((it, f) => filter(it, f), it);\n        }\n        if (Array.isArray(q.orders)) {\n            it = q.orders.reduce((it, f) => sort(it, f), it);\n        }\n        yield* it;\n    }\n    async *queryKeys(q) {\n        let it = this.#queryIt(q, (key) => key);\n        if (Array.isArray(q.filters)) {\n            it = q.filters.reduce((it, f) => filter(it, f), it);\n        }\n        if (Array.isArray(q.orders)) {\n            it = q.orders.reduce((it, f) => sort(it, f), it);\n        }\n        yield* it;\n    }\n    async *#queryIt(q, transform) {\n        if (this.db == null) {\n            throw new Error('Datastore needs to be opened.');\n        }\n        let yielded = 0;\n        let index = -1;\n        for (const key of await this.db.getAllKeys(this.location)) {\n            if (q.prefix != null && !key.toString().startsWith(q.prefix)) { // eslint-disable-line @typescript-eslint/no-base-to-string\n                continue;\n            }\n            if (q.limit != null && yielded === q.limit) {\n                return;\n            }\n            index++;\n            if (q.offset != null && index < q.offset) {\n                continue;\n            }\n            const k = new Key(key.toString()); // eslint-disable-line @typescript-eslint/no-base-to-string\n            let value;\n            try {\n                value = await this.get(k);\n            }\n            catch (err) {\n                if (err.code !== 'ERR_NOT_FOUND') {\n                    throw err;\n                }\n                continue;\n            }\n            if (value == null) {\n                continue;\n            }\n            yield transform(k, value);\n            yielded++;\n        }\n    }\n    async destroy() {\n        await deleteDB(this.location);\n    }\n}\n//# sourceMappingURL=index.js.map","import errCode from 'err-code'\n\n/**\n * @param {Error} [err]\n */\nexport function dbOpenFailedError (err) {\n  err = err || new Error('Cannot open database')\n  return errCode(err, 'ERR_DB_OPEN_FAILED')\n}\n\n/**\n * @param {Error} [err]\n */\nexport function dbDeleteFailedError (err) {\n  err = err || new Error('Delete failed')\n  return errCode(err, 'ERR_DB_DELETE_FAILED')\n}\n\n/**\n * @param {Error} [err]\n */\nexport function dbWriteFailedError (err) {\n  err = err || new Error('Write failed')\n  return errCode(err, 'ERR_DB_WRITE_FAILED')\n}\n\n/**\n * @param {Error} [err]\n */\nexport function notFoundError (err) {\n  err = err || new Error('Not Found')\n  return errCode(err, 'ERR_NOT_FOUND')\n}\n\n/**\n * @param {Error} [err]\n */\nexport function abortedError (err) {\n  err = err || new Error('Aborted')\n  return errCode(err, 'ERR_ABORTED')\n}\n","import { Key } from 'interface-datastore/key'\n// @ts-expect-error readme is unused\n// eslint-disable-next-line no-unused-vars\nimport readme from './shard-readme.js'\n\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('./types').Shard} Shard\n */\n\nexport const PREFIX = '/repo/flatfs/shard/'\nexport const SHARDING_FN = 'SHARDING'\nexport const README_FN = '_README'\n\n/**\n * @implements {Shard}\n */\nexport class ShardBase {\n  /**\n   * @param {any} param\n   */\n  constructor (param) {\n    this.param = param\n    this.name = 'base'\n    this._padding = ''\n  }\n\n  /**\n   * @param {string} s\n   */\n  fun (s) {\n    return 'implement me'\n  }\n\n  toString () {\n    return `${PREFIX}v1/${this.name}/${this.param}`\n  }\n}\n/**\n * @implements {Shard}\n */\nexport class Prefix extends ShardBase {\n  /**\n   * @param {number} prefixLen\n   */\n  constructor (prefixLen) {\n    super(prefixLen)\n    this._padding = ''.padStart(prefixLen, '_')\n    this.name = 'prefix'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    return (noslash + this._padding).slice(0, this.param)\n  }\n}\n\nexport class Suffix extends ShardBase {\n  /**\n   * @param {number} suffixLen\n   */\n  constructor (suffixLen) {\n    super(suffixLen)\n    this._padding = ''.padStart(suffixLen, '_')\n    this.name = 'suffix'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    const s = this._padding + noslash\n    return s.slice(s.length - this.param)\n  }\n}\n\nexport class NextToLast extends ShardBase {\n  /**\n   * @param {number} suffixLen\n   */\n  constructor (suffixLen) {\n    super(suffixLen)\n    this._padding = ''.padStart(suffixLen + 1, '_')\n    this.name = 'next-to-last'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    const s = this._padding + noslash\n    const offset = s.length - this.param - 1\n    return s.slice(offset, offset + this.param)\n  }\n}\n\n/**\n * Convert a given string to the matching sharding function.\n *\n * @param {string} str\n * @returns {Shard}\n */\nexport function parseShardFun (str) {\n  str = str.trim()\n\n  if (str.length === 0) {\n    throw new Error('empty shard string')\n  }\n\n  if (!str.startsWith(PREFIX)) {\n    throw new Error(`invalid or no path prefix: ${str}`)\n  }\n\n  const parts = str.slice(PREFIX.length).split('/')\n  const version = parts[0]\n\n  if (version !== 'v1') {\n    throw new Error(`expect 'v1' version, got '${version}'`)\n  }\n\n  const name = parts[1]\n\n  if (!parts[2]) {\n    throw new Error('missing param')\n  }\n\n  const param = parseInt(parts[2], 10)\n\n  switch (name) {\n    case 'prefix':\n      return new Prefix(param)\n    case 'suffix':\n      return new Suffix(param)\n    case 'next-to-last':\n      return new NextToLast(param)\n    default:\n      throw new Error(`unkown sharding function: ${name}`)\n  }\n}\n\n/**\n * @param {string | Uint8Array} path\n * @param {Datastore} store\n */\nexport const readShardFun = async (path, store) => {\n  const key = new Key(path).child(new Key(SHARDING_FN))\n  // @ts-ignore\n  const get = typeof store.getRaw === 'function' ? store.getRaw.bind(store) : store.get.bind(store)\n  const res = await get(key)\n  return parseShardFun(new TextDecoder().decode(res || '').trim())\n}\n\nexport { default as readme } from './shard-readme.js'\n","\nimport all from 'it-all'\n\n/**\n * Collect all values from the iterable and sort them using\n * the passed sorter function\n *\n * @template T\n * @param {AsyncIterable<T> | Iterable<T>} iterable\n * @param {(a: T, b: T) => -1 | 0 | 1} sorter\n * @returns {AsyncIterable<T>}\n */\nexport const sortAll = (iterable, sorter) => {\n  return (async function * () {\n    const values = await all(iterable)\n    yield * values.sort(sorter)\n  })()\n}\n\n/**\n * @param {string} s\n * @param {string} r\n */\nexport const replaceStartWith = (s, r) => {\n  const matcher = new RegExp('^' + r)\n  return s.replace(matcher, '')\n}\n","/**\n * Collects all values from an (async) iterable and returns them as an array\n */\nexport default async function all(source) {\n    const arr = [];\n    for await (const entry of source) {\n        arr.push(entry);\n    }\n    return arr;\n}\n//# sourceMappingURL=index.js.map","import { sortAll } from './utils.js'\nimport drain from 'it-drain'\nimport filter from 'it-filter'\nimport take from 'it-take'\n\n/**\n * @typedef {import('interface-store').Options} Options\n * @typedef {import('interface-datastore').Key} Key\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').Batch} Batch\n */\n\n/**\n * @template O\n * @typedef {import('interface-store').AwaitIterable<O>} AwaitIterable\n */\n\n/**\n * @implements {Datastore}\n */\nexport class BaseDatastore {\n  /**\n   * @returns {Promise<void>}\n   */\n  open () {\n    return Promise.reject(new Error('.open is not implemented'))\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  close () {\n    return Promise.reject(new Error('.close is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} val\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  put (key, val, options) {\n    return Promise.reject(new Error('.put is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<Uint8Array>}\n   */\n  get (key, options) {\n    return Promise.reject(new Error('.get is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<boolean>}\n   */\n  has (key, options) {\n    return Promise.reject(new Error('.has is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  delete (key, options) {\n    return Promise.reject(new Error('.delete is not implemented'))\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    for await (const { key, value } of source) {\n      await this.put(key, value, options)\n      yield { key, value }\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Uint8Array>}\n   */\n  async * getMany (source, options = {}) {\n    for await (const key of source) {\n      yield this.get(key, options)\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    for await (const key of source) {\n      await this.delete(key, options)\n      yield key\n    }\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    /** @type {Pair[]} */\n    let puts = []\n    /** @type {Key[]} */\n    let dels = []\n\n    return {\n      put (key, value) {\n        puts.push({ key, value })\n      },\n\n      delete (key) {\n        dels.push(key)\n      },\n      commit: async (options) => {\n        await drain(this.putMany(puts, options))\n        puts = []\n        await drain(this.deleteMany(dels, options))\n        dels = []\n      }\n    }\n  }\n\n  /**\n   * Extending classes should override `query` or implement this method\n   *\n   * @param {Query} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _all (q, options) {\n    throw new Error('._all is not implemented')\n  }\n\n  /**\n   * Extending classes should override `queryKeys` or implement this method\n   *\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _allKeys (q, options) {\n    throw new Error('._allKeys is not implemented')\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    let it = this._all(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (e) =>\n        e.key.toString().startsWith(/** @type {string} */ (q.prefix))\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= /** @type {number} */ (q.offset))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    let it = this._allKeys(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (key) =>\n        key.toString().startsWith(/** @type {string} */ (q.prefix))\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= /** @type {number} */ (q.offset))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n}\n","import { Key } from 'interface-datastore'\nimport {\n  readShardFun,\n  SHARDING_FN,\n  README_FN,\n  readme\n} from './shard.js'\nimport { BaseDatastore } from './base.js'\nimport { KeyTransformDatastore } from './keytransform.js'\nimport * as Errors from './errors.js'\n\nconst shardKey = new Key(SHARDING_FN)\nconst shardReadmeKey = new Key(README_FN)\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Options} Options\n * @typedef {import('interface-datastore').Batch} Batch\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').QueryFilter} QueryFilter\n * @typedef {import('interface-datastore').QueryOrder} QueryOrder\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').KeyQueryFilter} KeyQueryFilter\n * @typedef {import('interface-datastore').KeyQueryOrder} KeyQueryOrder\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('./types').Shard} Shard\n *\n */\n/**\n * @template TValue\n * @typedef {import('interface-store').Await<TValue> } Await\n */\n\n/**\n * @template TEntry\n * @typedef {import('interface-store').AwaitIterable<TEntry>} AwaitIterable\n */\n\n/**\n * Backend independent abstraction of go-ds-flatfs.\n *\n * Wraps another datastore such that all values are stored\n * sharded according to the given sharding function.\n */\nexport class ShardingDatastore extends BaseDatastore {\n  /**\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  constructor (store, shard) {\n    super()\n\n    this.child = new KeyTransformDatastore(store, {\n      convert: this._convertKey.bind(this),\n      invert: this._invertKey.bind(this)\n    })\n    this.shard = shard\n  }\n\n  async open () {\n    await this.child.open()\n\n    this.shard = await ShardingDatastore.create(this.child, this.shard)\n  }\n\n  /**\n   * @param {Key} key\n   */\n  _convertKey (key) {\n    const s = key.toString()\n    if (s === shardKey.toString() || s === shardReadmeKey.toString()) {\n      return key\n    }\n\n    const parent = new Key(this.shard.fun(s))\n    return parent.child(key)\n  }\n\n  /**\n   * @param {Key} key\n   */\n  _invertKey (key) {\n    const s = key.toString()\n    if (s === shardKey.toString() || s === shardReadmeKey.toString()) {\n      return key\n    }\n    return Key.withNamespaces(key.list().slice(1))\n  }\n\n  /**\n   * @deprecated\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  static async createOrOpen (store, shard) {\n    try {\n      await ShardingDatastore.create(store, shard)\n    } catch (/** @type {any} */ err) {\n      if (err && err.message !== 'datastore exists') throw err\n    }\n    return ShardingDatastore.open(store)\n  }\n\n  /**\n   * @deprecated\n   * @param {Datastore} store\n   */\n  static async open (store) {\n    const shard = await readShardFun('/', store)\n    return new ShardingDatastore(store, shard)\n  }\n\n  /**\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  static async create (store, shard) {\n    const hasShard = await store.has(shardKey)\n    if (!hasShard && !shard) {\n      throw Errors.dbOpenFailedError(Error('Shard is required when datastore doesn\\'t have a shard key already.'))\n    }\n    if (!hasShard) {\n      // @ts-ignore i have no idea what putRaw is or saw any implementation\n      const put = typeof store.putRaw === 'function' ? store.putRaw.bind(store) : store.put.bind(store)\n      await Promise.all([\n        put(shardKey, new TextEncoder().encode(shard.toString() + '\\n')),\n        put(shardReadmeKey, new TextEncoder().encode(readme))\n      ])\n\n      return shard\n    }\n\n    // test shards\n    const diskShard = await readShardFun('/', store)\n    const a = (diskShard || '').toString()\n    const b = shard.toString()\n    if (a !== b) {\n      throw new Error(`specified fun ${b} does not match repo shard fun ${a}`)\n    }\n    return diskShard\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} val\n   * @param {Options} [options]\n   */\n  put (key, val, options) {\n    return this.child.put(key, val, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  get (key, options) {\n    return this.child.get(key, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  has (key, options) {\n    return this.child.has(key, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  delete (key, options) {\n    return this.child.delete(key, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    yield * this.child.putMany(source, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Uint8Array>}\n   */\n  async * getMany (source, options = {}) {\n    yield * this.child.getMany(source, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    yield * this.child.deleteMany(source, options)\n  }\n\n  batch () {\n    return this.child.batch()\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    /** @type {Query} */\n    const tq = {\n      ...q,\n      filters: [\n        /** @type {QueryFilter} */\n        ({ key }) => key.toString() !== shardKey.toString(),\n        /** @type {QueryFilter} */\n        ({ key }) => key.toString() !== shardReadmeKey.toString()\n      ].concat(q.filters || [])\n    }\n\n    return this.child.query(tq, options)\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    /** @type {KeyQuery} */\n    const tq = {\n      ...q,\n      filters: [\n        /** @type {KeyQueryFilter} */\n        key => key.toString() !== shardKey.toString(),\n        /** @type {KeyQueryFilter} */\n        key => key.toString() !== shardReadmeKey.toString()\n      ].concat(q.filters || [])\n    }\n\n    return this.child.queryKeys(tq, options)\n  }\n\n  close () {\n    return this.child.close()\n  }\n}\n","import { BaseDatastore } from './base.js'\nimport * as Errors from './errors.js'\nimport { logger } from '@libp2p/logger'\nimport { pushable } from 'it-pushable'\nimport drain from 'it-drain'\n\nconst log = logger('datastore:core:tiered')\n\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Options} Options\n * @typedef {import('interface-datastore').Batch} Batch\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').Key} Key\n * @typedef {import('interface-datastore').Pair} Pair\n */\n\n/**\n * @template TEntry\n * @typedef {import('interface-store').AwaitIterable<TEntry>} AwaitIterable\n */\n\n/**\n * A datastore that can combine multiple stores. Puts and deletes\n * will write through to all datastores. Has and get will\n * try each store sequentially. Query will always try the\n * last one first.\n *\n */\nexport class TieredDatastore extends BaseDatastore {\n  /**\n   * @param {Datastore[]} stores\n   */\n  constructor (stores) {\n    super()\n\n    this.stores = stores.slice()\n  }\n\n  async open () {\n    try {\n      await Promise.all(this.stores.map((store) => store.open()))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbOpenFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} value\n   * @param {Options} [options]\n   */\n  async put (key, value, options) {\n    try {\n      await Promise.all(this.stores.map(store => store.put(key, value, options)))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbWriteFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async get (key, options) {\n    for (const store of this.stores) {\n      try {\n        const res = await store.get(key, options)\n        if (res) return res\n      } catch (err) {\n        log.error(err)\n      }\n    }\n    throw Errors.notFoundError()\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async has (key, options) {\n    for (const s of this.stores) {\n      if (await s.has(key, options)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async delete (key, options) {\n    try {\n      await Promise.all(this.stores.map(store => store.delete(key, options)))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbDeleteFailedError(err)\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    let error\n    const pushables = this.stores.map(store => {\n      const source = pushable({\n        objectMode: true\n      })\n\n      drain(store.putMany(source, options))\n        .catch(err => {\n          // store threw while putting, make sure we bubble the error up\n          error = err\n        })\n\n      return source\n    })\n\n    try {\n      for await (const pair of source) {\n        if (error) {\n          throw error\n        }\n\n        pushables.forEach(p => p.push(pair))\n\n        yield pair\n      }\n    } finally {\n      pushables.forEach(p => p.end())\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    let error\n    const pushables = this.stores.map(store => {\n      const source = pushable({\n        objectMode: true\n      })\n\n      drain(store.deleteMany(source, options))\n        .catch(err => {\n          // store threw while deleting, make sure we bubble the error up\n          error = err\n        })\n\n      return source\n    })\n\n    try {\n      for await (const key of source) {\n        if (error) {\n          throw error\n        }\n\n        pushables.forEach(p => p.push(key))\n\n        yield key\n      }\n    } finally {\n      pushables.forEach(p => p.end())\n    }\n  }\n\n  async close () {\n    await Promise.all(this.stores.map(store => store.close()))\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    const batches = this.stores.map(store => store.batch())\n\n    return {\n      put: (key, value) => {\n        batches.forEach(b => b.put(key, value))\n      },\n      delete: (key) => {\n        batches.forEach(b => b.delete(key))\n      },\n      commit: async (options) => {\n        for (const batch of batches) {\n          await batch.commit(options)\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    return this.stores[this.stores.length - 1].query(q, options)\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    return this.stores[this.stores.length - 1].queryKeys(q, options)\n  }\n}\n","import { Key } from 'interface-datastore'\nimport { BaseDatastore, Errors } from 'datastore-core'\nimport filter from 'it-filter'\nimport map from 'it-map'\nimport take from 'it-take'\nimport sort from 'it-sort'\nimport { Level } from 'level'\n\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('interface-datastore').Batch} Batch\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').Options} QueryOptions\n * @typedef {import('abstract-level').AbstractLevel<any, string, Uint8Array>} LevelDb\n */\n\n/**\n * A datastore backed by leveldb\n */\nexport class LevelDatastore extends BaseDatastore {\n  /**\n   * @param {string | LevelDb} path\n   * @param {import('level').DatabaseOptions<string, Uint8Array> & import('level').OpenOptions} [opts]\n   */\n  constructor (path, opts = {}) {\n    super()\n\n    /** @type {LevelDb} */\n    this.db = typeof path === 'string'\n      ? new Level(path, {\n        ...opts,\n        keyEncoding: 'utf8',\n        valueEncoding: 'view'\n      })\n      : path\n\n    /** @type {import('level').OpenOptions} */\n    this.opts = {\n      createIfMissing: true,\n      compression: false, // same default as go\n      ...opts\n    }\n  }\n\n  async open () {\n    try {\n      await this.db.open(this.opts)\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbOpenFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} value\n   */\n  async put (key, value) {\n    try {\n      await this.db.put(key.toString(), value)\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbWriteFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @returns {Promise<Uint8Array>}\n   */\n  async get (key) {\n    let data\n    try {\n      data = await this.db.get(key.toString())\n    } catch (/** @type {any} */ err) {\n      if (err.notFound) throw Errors.notFoundError(err)\n      throw Errors.dbWriteFailedError(err)\n    }\n    return data\n  }\n\n  /**\n   * @param {Key} key\n   * @returns {Promise<boolean>}\n   */\n  async has (key) {\n    try {\n      await this.db.get(key.toString())\n    } catch (/** @type {any} */ err) {\n      if (err.notFound) return false\n      throw err\n    }\n    return true\n  }\n\n  /**\n   * @param {Key} key\n   * @returns {Promise<void>}\n   */\n  async delete (key) {\n    try {\n      await this.db.del(key.toString())\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbDeleteFailedError(err)\n    }\n  }\n\n  close () {\n    return this.db && this.db.close()\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    /** @type {Array<{ type: 'put', key: string, value: Uint8Array; } | { type: 'del', key: string }>} */\n    const ops = []\n    return {\n      put: (key, value) => {\n        ops.push({\n          type: 'put',\n          key: key.toString(),\n          value: value\n        })\n      },\n      delete: (key) => {\n        ops.push({\n          type: 'del',\n          key: key.toString()\n        })\n      },\n      commit: () => {\n        return this.db.batch(ops)\n      }\n    }\n  }\n\n  /**\n   * @param {Query} q\n   */\n  query (q) {\n    let it = this._query({\n      values: true,\n      prefix: q.prefix\n    })\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sort(it, f), it)\n    }\n\n    const { offset, limit } = q\n    if (offset) {\n      let i = 0\n      it = filter(it, () => i++ >= offset)\n    }\n\n    if (limit) {\n      it = take(it, limit)\n    }\n\n    return it\n  }\n\n  /**\n   * @param {KeyQuery} q\n   */\n  queryKeys (q) {\n    let it = map(this._query({\n      values: false,\n      prefix: q.prefix\n    }), ({ key }) => key)\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sort(it, f), it)\n    }\n\n    const { offset, limit } = q\n    if (offset) {\n      let i = 0\n      it = filter(it, () => i++ >= offset)\n    }\n\n    if (limit) {\n      it = take(it, limit)\n    }\n\n    return it\n  }\n\n  /**\n   * @param {object} opts\n   * @param {boolean} opts.values\n   * @param {string} [opts.prefix]\n   * @returns {AsyncIterable<Pair>}\n   */\n  _query (opts) {\n    /** @type {import('level').IteratorOptions<string, Uint8Array>} */\n    const iteratorOpts = {\n      keys: true,\n      keyEncoding: 'buffer',\n      values: opts.values\n    }\n\n    // Let the db do the prefix matching\n    if (opts.prefix != null) {\n      const prefix = opts.prefix.toString()\n      // Match keys greater than or equal to `prefix` and\n      iteratorOpts.gte = prefix\n      // less than `prefix` + \\xFF (hex escape sequence)\n      iteratorOpts.lt = prefix + '\\xFF'\n    }\n\n    const iterator = this.db.iterator(iteratorOpts)\n\n    if (iterator[Symbol.asyncIterator]) {\n      return levelIteratorToIterator(iterator)\n    }\n\n    // @ts-expect-error support older level\n    if (iterator.next != null && iterator.end != null) {\n      // @ts-expect-error support older level\n      return oldLevelIteratorToIterator(iterator)\n    }\n\n    throw new Error('Level returned incompatible iterator')\n  }\n}\n\n/**\n * @param {import('level').Iterator<LevelDb, string, Uint8Array>} li - Level iterator\n * @returns {AsyncIterable<Pair>}\n */\nasync function * levelIteratorToIterator (li) {\n  for await (const [key, value] of li) {\n    yield { key: new Key(key, false), value }\n  }\n\n  await li.close()\n}\n\n/**\n * @typedef {object} LevelIterator\n * @property {(cb: (err: Error, key: string | Uint8Array | null, value: any)=> void)=>void} next\n * @property {(cb: (err: Error) => void) => void } end\n */\n\n/**\n * @param {LevelIterator} li - Level iterator\n * @returns {AsyncIterable<Pair>}\n */\nfunction oldLevelIteratorToIterator (li) {\n  return {\n    [Symbol.asyncIterator] () {\n      return {\n        next: () => new Promise((resolve, reject) => {\n          li.next((err, key, value) => {\n            if (err) return reject(err)\n            if (key == null) {\n              return li.end(err => {\n                if (err) return reject(err)\n                resolve({ done: true, value: undefined })\n              })\n            }\n            resolve({ done: false, value: { key: new Key(key, false), value } })\n          })\n        }),\n        return: () => new Promise((resolve, reject) => {\n          li.end(err => {\n            if (err) return reject(err)\n            resolve({ done: true, value: undefined })\n          })\n        })\n      }\n    }\n  }\n}\n","import { Key } from 'interface-datastore/key'\n// @ts-expect-error readme is unused\n// eslint-disable-next-line no-unused-vars\nimport readme from './shard-readme.js'\n\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('./types').Shard} Shard\n */\n\nexport const PREFIX = '/repo/flatfs/shard/'\nexport const SHARDING_FN = 'SHARDING'\nexport const README_FN = '_README'\n\n/**\n * @implements {Shard}\n */\nexport class ShardBase {\n  /**\n   * @param {any} param\n   */\n  constructor (param) {\n    this.param = param\n    this.name = 'base'\n    this._padding = ''\n  }\n\n  /**\n   * @param {string} s\n   */\n  fun (s) {\n    return 'implement me'\n  }\n\n  toString () {\n    return `${PREFIX}v1/${this.name}/${this.param}`\n  }\n}\n/**\n * @implements {Shard}\n */\nexport class Prefix extends ShardBase {\n  /**\n   * @param {number} prefixLen\n   */\n  constructor (prefixLen) {\n    super(prefixLen)\n    this._padding = ''.padStart(prefixLen, '_')\n    this.name = 'prefix'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    return (noslash + this._padding).slice(0, this.param)\n  }\n}\n\nexport class Suffix extends ShardBase {\n  /**\n   * @param {number} suffixLen\n   */\n  constructor (suffixLen) {\n    super(suffixLen)\n    this._padding = ''.padStart(suffixLen, '_')\n    this.name = 'suffix'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    const s = this._padding + noslash\n    return s.slice(s.length - this.param)\n  }\n}\n\nexport class NextToLast extends ShardBase {\n  /**\n   * @param {number} suffixLen\n   */\n  constructor (suffixLen) {\n    super(suffixLen)\n    this._padding = ''.padStart(suffixLen + 1, '_')\n    this.name = 'next-to-last'\n  }\n\n  /**\n   * @param {string} noslash\n   */\n  fun (noslash) {\n    const s = this._padding + noslash\n    const offset = s.length - this.param - 1\n    return s.slice(offset, offset + this.param)\n  }\n}\n\n/**\n * Convert a given string to the matching sharding function.\n *\n * @param {string} str\n * @returns {Shard}\n */\nexport function parseShardFun (str) {\n  str = str.trim()\n\n  if (str.length === 0) {\n    throw new Error('empty shard string')\n  }\n\n  if (!str.startsWith(PREFIX)) {\n    throw new Error(`invalid or no path prefix: ${str}`)\n  }\n\n  const parts = str.slice(PREFIX.length).split('/')\n  const version = parts[0]\n\n  if (version !== 'v1') {\n    throw new Error(`expect 'v1' version, got '${version}'`)\n  }\n\n  const name = parts[1]\n\n  if (!parts[2]) {\n    throw new Error('missing param')\n  }\n\n  const param = parseInt(parts[2], 10)\n\n  switch (name) {\n    case 'prefix':\n      return new Prefix(param)\n    case 'suffix':\n      return new Suffix(param)\n    case 'next-to-last':\n      return new NextToLast(param)\n    default:\n      throw new Error(`unkown sharding function: ${name}`)\n  }\n}\n\n/**\n * @param {string | Uint8Array} path\n * @param {Datastore} store\n */\nexport const readShardFun = async (path, store) => {\n  const key = new Key(path).child(new Key(SHARDING_FN))\n  // @ts-ignore\n  const get = typeof store.getRaw === 'function' ? store.getRaw.bind(store) : store.get.bind(store)\n  const res = await get(key)\n  return parseShardFun(new TextDecoder().decode(res || '').trim())\n}\n\nexport { default as readme } from './shard-readme.js'\n","\nimport all from 'it-all'\n\n/**\n * Collect all values from the iterable and sort them using\n * the passed sorter function\n *\n * @template T\n * @param {AsyncIterable<T> | Iterable<T>} iterable\n * @param {(a: T, b: T) => -1 | 0 | 1} sorter\n * @returns {AsyncIterable<T>}\n */\nexport const sortAll = (iterable, sorter) => {\n  return (async function * () {\n    const values = await all(iterable)\n    yield * values.sort(sorter)\n  })()\n}\n\n/**\n * @param {string} s\n * @param {string} r\n */\nexport const replaceStartWith = (s, r) => {\n  const matcher = new RegExp('^' + r)\n  return s.replace(matcher, '')\n}\n","/**\n * Collects all values from an (async) iterable and returns them as an array\n */\nexport default async function all(source) {\n    const arr = [];\n    for await (const entry of source) {\n        arr.push(entry);\n    }\n    return arr;\n}\n//# sourceMappingURL=index.js.map","import { sortAll } from './utils.js'\nimport drain from 'it-drain'\nimport filter from 'it-filter'\nimport take from 'it-take'\n\n/**\n * @typedef {import('interface-store').Options} Options\n * @typedef {import('interface-datastore').Key} Key\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').Batch} Batch\n */\n\n/**\n * @template O\n * @typedef {import('interface-store').AwaitIterable<O>} AwaitIterable\n */\n\n/**\n * @implements {Datastore}\n */\nexport class BaseDatastore {\n  /**\n   * @returns {Promise<void>}\n   */\n  open () {\n    return Promise.reject(new Error('.open is not implemented'))\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  close () {\n    return Promise.reject(new Error('.close is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} val\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  put (key, val, options) {\n    return Promise.reject(new Error('.put is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<Uint8Array>}\n   */\n  get (key, options) {\n    return Promise.reject(new Error('.get is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<boolean>}\n   */\n  has (key, options) {\n    return Promise.reject(new Error('.has is not implemented'))\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   * @returns {Promise<void>}\n   */\n  delete (key, options) {\n    return Promise.reject(new Error('.delete is not implemented'))\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    for await (const { key, value } of source) {\n      await this.put(key, value, options)\n      yield { key, value }\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Uint8Array>}\n   */\n  async * getMany (source, options = {}) {\n    for await (const key of source) {\n      yield this.get(key, options)\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    for await (const key of source) {\n      await this.delete(key, options)\n      yield key\n    }\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    /** @type {Pair[]} */\n    let puts = []\n    /** @type {Key[]} */\n    let dels = []\n\n    return {\n      put (key, value) {\n        puts.push({ key, value })\n      },\n\n      delete (key) {\n        dels.push(key)\n      },\n      commit: async (options) => {\n        await drain(this.putMany(puts, options))\n        puts = []\n        await drain(this.deleteMany(dels, options))\n        dels = []\n      }\n    }\n  }\n\n  /**\n   * Extending classes should override `query` or implement this method\n   *\n   * @param {Query} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _all (q, options) {\n    throw new Error('._all is not implemented')\n  }\n\n  /**\n   * Extending classes should override `queryKeys` or implement this method\n   *\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  // eslint-disable-next-line require-yield\n  async * _allKeys (q, options) {\n    throw new Error('._allKeys is not implemented')\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    let it = this._all(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (e) =>\n        e.key.toString().startsWith(/** @type {string} */ (q.prefix))\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= /** @type {number} */ (q.offset))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    let it = this._allKeys(q, options)\n\n    if (q.prefix != null) {\n      it = filter(it, (key) =>\n        key.toString().startsWith(/** @type {string} */ (q.prefix))\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sortAll(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      it = filter(it, () => i++ >= /** @type {number} */ (q.offset))\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n}\n","import { Key } from 'interface-datastore'\nimport {\n  readShardFun,\n  SHARDING_FN,\n  README_FN,\n  readme\n} from './shard.js'\nimport { BaseDatastore } from './base.js'\nimport { KeyTransformDatastore } from './keytransform.js'\nimport * as Errors from './errors.js'\n\nconst shardKey = new Key(SHARDING_FN)\nconst shardReadmeKey = new Key(README_FN)\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Options} Options\n * @typedef {import('interface-datastore').Batch} Batch\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').QueryFilter} QueryFilter\n * @typedef {import('interface-datastore').QueryOrder} QueryOrder\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').KeyQueryFilter} KeyQueryFilter\n * @typedef {import('interface-datastore').KeyQueryOrder} KeyQueryOrder\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('./types').Shard} Shard\n *\n */\n/**\n * @template TValue\n * @typedef {import('interface-store').Await<TValue> } Await\n */\n\n/**\n * @template TEntry\n * @typedef {import('interface-store').AwaitIterable<TEntry>} AwaitIterable\n */\n\n/**\n * Backend independent abstraction of go-ds-flatfs.\n *\n * Wraps another datastore such that all values are stored\n * sharded according to the given sharding function.\n */\nexport class ShardingDatastore extends BaseDatastore {\n  /**\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  constructor (store, shard) {\n    super()\n\n    this.child = new KeyTransformDatastore(store, {\n      convert: this._convertKey.bind(this),\n      invert: this._invertKey.bind(this)\n    })\n    this.shard = shard\n  }\n\n  async open () {\n    await this.child.open()\n\n    this.shard = await ShardingDatastore.create(this.child, this.shard)\n  }\n\n  /**\n   * @param {Key} key\n   */\n  _convertKey (key) {\n    const s = key.toString()\n    if (s === shardKey.toString() || s === shardReadmeKey.toString()) {\n      return key\n    }\n\n    const parent = new Key(this.shard.fun(s))\n    return parent.child(key)\n  }\n\n  /**\n   * @param {Key} key\n   */\n  _invertKey (key) {\n    const s = key.toString()\n    if (s === shardKey.toString() || s === shardReadmeKey.toString()) {\n      return key\n    }\n    return Key.withNamespaces(key.list().slice(1))\n  }\n\n  /**\n   * @deprecated\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  static async createOrOpen (store, shard) {\n    try {\n      await ShardingDatastore.create(store, shard)\n    } catch (/** @type {any} */ err) {\n      if (err && err.message !== 'datastore exists') throw err\n    }\n    return ShardingDatastore.open(store)\n  }\n\n  /**\n   * @deprecated\n   * @param {Datastore} store\n   */\n  static async open (store) {\n    const shard = await readShardFun('/', store)\n    return new ShardingDatastore(store, shard)\n  }\n\n  /**\n   * @param {Datastore} store\n   * @param {Shard} shard\n   */\n  static async create (store, shard) {\n    const hasShard = await store.has(shardKey)\n    if (!hasShard && !shard) {\n      throw Errors.dbOpenFailedError(Error('Shard is required when datastore doesn\\'t have a shard key already.'))\n    }\n    if (!hasShard) {\n      // @ts-ignore i have no idea what putRaw is or saw any implementation\n      const put = typeof store.putRaw === 'function' ? store.putRaw.bind(store) : store.put.bind(store)\n      await Promise.all([\n        put(shardKey, new TextEncoder().encode(shard.toString() + '\\n')),\n        put(shardReadmeKey, new TextEncoder().encode(readme))\n      ])\n\n      return shard\n    }\n\n    // test shards\n    const diskShard = await readShardFun('/', store)\n    const a = (diskShard || '').toString()\n    const b = shard.toString()\n    if (a !== b) {\n      throw new Error(`specified fun ${b} does not match repo shard fun ${a}`)\n    }\n    return diskShard\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} val\n   * @param {Options} [options]\n   */\n  put (key, val, options) {\n    return this.child.put(key, val, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  get (key, options) {\n    return this.child.get(key, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  has (key, options) {\n    return this.child.has(key, options)\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  delete (key, options) {\n    return this.child.delete(key, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    yield * this.child.putMany(source, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Uint8Array>}\n   */\n  async * getMany (source, options = {}) {\n    yield * this.child.getMany(source, options)\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    yield * this.child.deleteMany(source, options)\n  }\n\n  batch () {\n    return this.child.batch()\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    /** @type {Query} */\n    const tq = {\n      ...q,\n      filters: [\n        /** @type {QueryFilter} */\n        ({ key }) => key.toString() !== shardKey.toString(),\n        /** @type {QueryFilter} */\n        ({ key }) => key.toString() !== shardReadmeKey.toString()\n      ].concat(q.filters || [])\n    }\n\n    return this.child.query(tq, options)\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    /** @type {KeyQuery} */\n    const tq = {\n      ...q,\n      filters: [\n        /** @type {KeyQueryFilter} */\n        key => key.toString() !== shardKey.toString(),\n        /** @type {KeyQueryFilter} */\n        key => key.toString() !== shardReadmeKey.toString()\n      ].concat(q.filters || [])\n    }\n\n    return this.child.queryKeys(tq, options)\n  }\n\n  close () {\n    return this.child.close()\n  }\n}\n","import { BaseDatastore } from './base.js'\nimport * as Errors from './errors.js'\nimport { logger } from '@libp2p/logger'\nimport { pushable } from 'it-pushable'\nimport drain from 'it-drain'\n\nconst log = logger('datastore:core:tiered')\n\n/**\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-datastore').Options} Options\n * @typedef {import('interface-datastore').Batch} Batch\n * @typedef {import('interface-datastore').Query} Query\n * @typedef {import('interface-datastore').KeyQuery} KeyQuery\n * @typedef {import('interface-datastore').Key} Key\n * @typedef {import('interface-datastore').Pair} Pair\n */\n\n/**\n * @template TEntry\n * @typedef {import('interface-store').AwaitIterable<TEntry>} AwaitIterable\n */\n\n/**\n * A datastore that can combine multiple stores. Puts and deletes\n * will write through to all datastores. Has and get will\n * try each store sequentially. Query will always try the\n * last one first.\n *\n */\nexport class TieredDatastore extends BaseDatastore {\n  /**\n   * @param {Datastore[]} stores\n   */\n  constructor (stores) {\n    super()\n\n    this.stores = stores.slice()\n  }\n\n  async open () {\n    try {\n      await Promise.all(this.stores.map((store) => store.open()))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbOpenFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} value\n   * @param {Options} [options]\n   */\n  async put (key, value, options) {\n    try {\n      await Promise.all(this.stores.map(store => store.put(key, value, options)))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbWriteFailedError(err)\n    }\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async get (key, options) {\n    for (const store of this.stores) {\n      try {\n        const res = await store.get(key, options)\n        if (res) return res\n      } catch (err) {\n        log.error(err)\n      }\n    }\n    throw Errors.notFoundError()\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async has (key, options) {\n    for (const s of this.stores) {\n      if (await s.has(key, options)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async delete (key, options) {\n    try {\n      await Promise.all(this.stores.map(store => store.delete(key, options)))\n    } catch (/** @type {any} */ err) {\n      throw Errors.dbDeleteFailedError(err)\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Pair>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Pair>}\n   */\n  async * putMany (source, options = {}) {\n    let error\n    const pushables = this.stores.map(store => {\n      const source = pushable({\n        objectMode: true\n      })\n\n      drain(store.putMany(source, options))\n        .catch(err => {\n          // store threw while putting, make sure we bubble the error up\n          error = err\n        })\n\n      return source\n    })\n\n    try {\n      for await (const pair of source) {\n        if (error) {\n          throw error\n        }\n\n        pushables.forEach(p => p.push(pair))\n\n        yield pair\n      }\n    } finally {\n      pushables.forEach(p => p.end())\n    }\n  }\n\n  /**\n   * @param {AwaitIterable<Key>} source\n   * @param {Options} [options]\n   * @returns {AsyncIterable<Key>}\n   */\n  async * deleteMany (source, options = {}) {\n    let error\n    const pushables = this.stores.map(store => {\n      const source = pushable({\n        objectMode: true\n      })\n\n      drain(store.deleteMany(source, options))\n        .catch(err => {\n          // store threw while deleting, make sure we bubble the error up\n          error = err\n        })\n\n      return source\n    })\n\n    try {\n      for await (const key of source) {\n        if (error) {\n          throw error\n        }\n\n        pushables.forEach(p => p.push(key))\n\n        yield key\n      }\n    } finally {\n      pushables.forEach(p => p.end())\n    }\n  }\n\n  async close () {\n    await Promise.all(this.stores.map(store => store.close()))\n  }\n\n  /**\n   * @returns {Batch}\n   */\n  batch () {\n    const batches = this.stores.map(store => store.batch())\n\n    return {\n      put: (key, value) => {\n        batches.forEach(b => b.put(key, value))\n      },\n      delete: (key) => {\n        batches.forEach(b => b.delete(key))\n      },\n      commit: async (options) => {\n        for (const batch of batches) {\n          await batch.commit(options)\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Query} q\n   * @param {Options} [options]\n   */\n  query (q, options) {\n    return this.stores[this.stores.length - 1].query(q, options)\n  }\n\n  /**\n   * @param {KeyQuery} q\n   * @param {Options} [options]\n   */\n  queryKeys (q, options) {\n    return this.stores[this.stores.length - 1].queryKeys(q, options)\n  }\n}\n","import { CodeError } from '@libp2p/interfaces/errors'\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string'\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string'\n\n/**\n * @typedef {import('interface-datastore').Key} Key\n */\n\nconst namespace = '/record/'\n\n/**\n * @param {Uint8Array} buf\n */\nexport function encodeBase32 (buf) {\n  return uint8ArrayToString(buf, 'base32')\n}\n\n/**\n * converts a binary record key to a pubsub topic key\n *\n * @param {Uint8Array | string} key\n */\nexport function keyToTopic (key) {\n  // Record-store keys are arbitrary binary. However, pubsub requires UTF-8 string topic IDs\n  // Encodes to \"/record/base64url(key)\"\n  if (typeof key === 'string' || key instanceof String) {\n    key = uint8ArrayFromString(key.toString())\n  }\n\n  const b64url = uint8ArrayToString(key, 'base64url')\n\n  return `${namespace}${b64url}`\n}\n\n/**\n * converts a pubsub topic key to a binary record key\n *\n * @param {string} topic\n */\nexport function topicToKey (topic) {\n  if (topic.substring(0, namespace.length) !== namespace) {\n    throw new CodeError('topic received is not from a record', 'ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE')\n  }\n\n  const key = topic.substring(namespace.length)\n\n  return uint8ArrayFromString(key, 'base64url')\n}\n","import { Key } from 'interface-datastore'\nimport { BaseDatastore } from 'datastore-core'\nimport { encodeBase32, keyToTopic, topicToKey } from './utils.js'\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals'\nimport { CodeError } from '@libp2p/interfaces/errors'\nimport { logger } from '@libp2p/logger'\n\nconst log = logger('datastore-pubsub:publisher')\n\n/**\n * @typedef {import('@libp2p/interface-peer-id').PeerId} PeerId\n * @typedef {import('./types').SubscriptionKeyFn} SubscriptionKeyFn\n * @typedef {import('@libp2p/interface-pubsub').Message} PubSubMessage\n * @typedef {import('@libp2p/interfaces').AbortOptions} AbortOptions\n */\n\n// DatastorePubsub is responsible for providing an api for pubsub to be used as a datastore with\n// [TieredDatastore]{@link https://github.com/ipfs/js-datastore-core/blob/master/src/tiered.js}\nexport class PubSubDatastore extends BaseDatastore {\n  /**\n   * Creates an instance of DatastorePubsub.\n   *\n   * @param {import('@libp2p/interface-pubsub').PubSub} pubsub - pubsub implementation\n   * @param {import('interface-datastore').Datastore} datastore - datastore instance\n   * @param {PeerId} peerId - peer-id instance\n   * @param {import('@libp2p/interface-dht').ValidateFn} validator - validator function\n   * @param {import('@libp2p/interface-dht').SelectFn} selector - selector function\n   * @param {SubscriptionKeyFn} [subscriptionKeyFn] - function to manipulate the key topic received before processing it\n   * @memberof DatastorePubsub\n   */\n  constructor (pubsub, datastore, peerId, validator, selector, subscriptionKeyFn) {\n    super()\n\n    if (!validator) {\n      throw new CodeError('missing validator', 'ERR_INVALID_PARAMETERS')\n    }\n\n    if (typeof validator !== 'function') {\n      throw new CodeError('missing validate function', 'ERR_INVALID_PARAMETERS')\n    }\n\n    if (typeof selector !== 'function') {\n      throw new CodeError('missing select function', 'ERR_INVALID_PARAMETERS')\n    }\n\n    if (subscriptionKeyFn && typeof subscriptionKeyFn !== 'function') {\n      throw new CodeError('invalid subscriptionKeyFn received', 'ERR_INVALID_PARAMETERS')\n    }\n\n    this._pubsub = pubsub\n    this._datastore = datastore\n    this._peerId = peerId\n    this._validator = validator\n    this._selector = selector\n    this._handleSubscriptionKeyFn = subscriptionKeyFn\n\n    // Bind _onMessage function, which is called by pubsub.\n    this._onMessage = this._onMessage.bind(this)\n    this._pubsub.addEventListener('message', this._onMessage)\n  }\n\n  /**\n   * Publishes a value through pubsub.\n   *\n   * @param {Uint8Array} key - identifier of the value to be published.\n   * @param {Uint8Array} val - value to be propagated.\n   * @param {AbortOptions} [options]\n   */\n  // @ts-ignore Datastores take keys as Keys, this one takes Uint8Arrays\n  async put (key, val, options) {\n    if (!(key instanceof Uint8Array)) {\n      const errMsg = 'datastore key does not have a valid format'\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_INVALID_DATASTORE_KEY')\n    }\n\n    if (!(val instanceof Uint8Array)) {\n      const errMsg = 'received value is not a Uint8Array'\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_INVALID_VALUE_RECEIVED')\n    }\n\n    const stringifiedTopic = keyToTopic(key)\n\n    log(`publish value for topic ${stringifiedTopic}`)\n\n    // Publish record to pubsub\n    await this._pubsub.publish(stringifiedTopic, val)\n  }\n\n  /**\n   * Try to subscribe a topic with Pubsub and returns the local value if available.\n   *\n   * @param {Uint8Array} key - identifier of the value to be subscribed.\n   * @param {AbortOptions} [options]\n   */\n  // @ts-ignore Datastores take keys as Keys, this one takes Uint8Arrays\n  async get (key, options) {\n    if (!(key instanceof Uint8Array)) {\n      const errMsg = 'datastore key does not have a valid format'\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_INVALID_DATASTORE_KEY')\n    }\n\n    const stringifiedTopic = keyToTopic(key)\n    const subscriptions = await this._pubsub.getTopics()\n\n    // If already subscribed, just try to get it\n    if (subscriptions && Array.isArray(subscriptions) && subscriptions.indexOf(stringifiedTopic) > -1) {\n      return this._getLocal(key, options)\n    }\n\n    // subscribe\n    try {\n      await this._pubsub.subscribe(stringifiedTopic)\n    } catch (/** @type {any} */ err) {\n      const errMsg = `cannot subscribe topic ${stringifiedTopic}`\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_SUBSCRIBING_TOPIC')\n    }\n    log(`subscribed values for key ${stringifiedTopic}`)\n\n    return this._getLocal(key)\n  }\n\n  /**\n   * Unsubscribe topic.\n   *\n   * @param {Uint8Array} key - identifier of the value to unsubscribe.\n   * @returns {void}\n   */\n  unsubscribe (key) {\n    const stringifiedTopic = keyToTopic(key)\n\n    return this._pubsub.unsubscribe(stringifiedTopic)\n  }\n\n  /**\n   * Get record from local datastore\n   *\n   * @private\n   * @param {Uint8Array} key\n   * @param {AbortOptions} [options]\n   */\n  async _getLocal (key, options) {\n    // encode key - base32(/ipns/{cid})\n    const routingKey = new Key('/' + encodeBase32(key), false)\n    let dsVal\n\n    try {\n      dsVal = await this._datastore.get(routingKey, options)\n    } catch (/** @type {any} */ err) {\n      if (err.code !== 'ERR_NOT_FOUND') {\n        const errMsg = `unexpected error getting the ipns record for ${routingKey.toString()}`\n\n        log.error(errMsg)\n        throw new CodeError(errMsg, 'ERR_UNEXPECTED_ERROR_GETTING_RECORD')\n      }\n      const errMsg = `local record requested was not found for ${routingKey.toString()}`\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_NOT_FOUND')\n    }\n\n    if (!(dsVal instanceof Uint8Array)) {\n      const errMsg = 'found record that we couldn\\'t convert to a value'\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_INVALID_RECORD_RECEIVED')\n    }\n\n    return dsVal\n  }\n\n  /**\n   * handles pubsub subscription messages\n   *\n   * @param {CustomEvent<PubSubMessage>} evt\n   */\n  async _onMessage (evt) {\n    const msg = evt.detail\n\n    if (msg.type !== 'signed') {\n      log.error('unsigned message received, this module can only work with signed messages')\n      return\n    }\n\n    const { data, from, topic } = msg\n    let key\n    try {\n      key = topicToKey(topic)\n    } catch (/** @type {any} */ err) {\n      log.error(err)\n      return\n    }\n\n    log(`message received for topic ${topic}`)\n\n    // Stop if the message is from the peer (it already stored it while publishing to pubsub)\n    if (this._peerId.equals(from)) {\n      log('message discarded as it is from the same peer')\n      return\n    }\n\n    if (this._handleSubscriptionKeyFn) {\n      let res\n\n      try {\n        res = await this._handleSubscriptionKeyFn(key)\n      } catch (/** @type {any} */ err) {\n        log.error('message discarded by the subscriptionKeyFn')\n        return\n      }\n\n      key = res\n    }\n\n    try {\n      await this._storeIfSubscriptionIsBetter(key, data)\n    } catch (/** @type {any} */ err) {\n      log.error(err)\n    }\n  }\n\n  /**\n   * Store the received record if it is better than the current stored\n   *\n   * @param {Uint8Array} key\n   * @param {Uint8Array} data\n   * @param {AbortOptions} [options]\n   */\n  async _storeIfSubscriptionIsBetter (key, data, options) {\n    let isBetter = false\n\n    try {\n      isBetter = await this._isBetter(key, data)\n    } catch (/** @type {any} */ err) {\n      if (err.code !== 'ERR_NOT_VALID_RECORD') {\n        throw err\n      }\n    }\n\n    if (isBetter) {\n      await this._storeRecord(key, data, options)\n    }\n  }\n\n  /**\n   * Validate record according to the received validation function\n   *\n   * @param {Uint8Array} key\n   * @param {Uint8Array} value\n   */\n  async _validateRecord (key, value) { // eslint-disable-line require-await\n    return this._validator(key, value)\n  }\n\n  /**\n   * Select the best record according to the received select function\n   *\n   * @param {Uint8Array} key\n   * @param {Uint8Array[]} records\n   */\n  async _selectRecord (key, records) {\n    const res = await this._selector(key, records)\n\n    // If the selected was the first (0), it should be stored (true)\n    return res === 0\n  }\n\n  /**\n   * Verify if the record received through pubsub is valid and better than the one currently stored\n   *\n   * @param {Uint8Array} key\n   * @param {Uint8Array} val\n   */\n  async _isBetter (key, val) {\n    try {\n      await this._validateRecord(key, val)\n    } catch (/** @type {any} */ err) {\n      // If not valid, it is not better than the one currently available\n      const errMsg = 'record received through pubsub is not valid'\n\n      log.error(errMsg)\n      throw new CodeError(errMsg, 'ERR_NOT_VALID_RECORD')\n    }\n\n    // Get Local record\n    const dsKey = new Key(key)\n    let currentRecord\n\n    try {\n      currentRecord = await this._getLocal(dsKey.uint8Array())\n    } catch (/** @type {any} */ err) {\n      // if the old one is invalid, the new one is *always* better\n      return true\n    }\n\n    // if the same record, do not need to store\n    if (uint8ArrayEquals(currentRecord, val)) {\n      return false\n    }\n\n    // verify if the received record should replace the current one\n    return this._selectRecord(key, [currentRecord, val])\n  }\n\n  /**\n   * add record to datastore\n   *\n   * @param {Uint8Array} key\n   * @param {Uint8Array} data\n   * @param {AbortOptions} [options]\n   */\n  async _storeRecord (key, data, options) {\n    // encode key - base32(/ipns/{cid})\n    const routingKey = new Key('/' + encodeBase32(key), false)\n\n    await this._datastore.put(routingKey, data, options)\n    log(`record for ${keyToTopic(key)} was stored in the datastore`)\n  }\n}\n","const globalFetch = globalThis.fetch;\nconst globalHeaders = globalThis.Headers;\nconst globalRequest = globalThis.Request;\nconst globalResponse = globalThis.Response;\nexport {\n  globalFetch as fetch\n};\nexport {\n  globalHeaders as Headers\n};\nexport {\n  globalRequest as Request\n};\nexport {\n  globalResponse as Response\n};","import { fetch as nativeFetch, Headers } from 'native-fetch';\n/**\n * Build fetch resource for request\n */\nexport function buildResource(serverResolver, hostname, recordType) {\n    return `${serverResolver}?name=${hostname}&type=${recordType}`;\n}\n/**\n * Use fetch to find the record\n */\nexport async function request(resource, signal) {\n    const req = await nativeFetch(resource, {\n        headers: new Headers({\n            accept: 'application/dns-json'\n        }),\n        signal\n    });\n    const res = await req.json();\n    return res;\n}\n/**\n * Creates cache key composed by recordType and hostname\n *\n * @param {string} hostname\n * @param {string} recordType\n */\nexport function getCacheKey(hostname, recordType) {\n    return `${recordType}_${hostname}`;\n}\n//# sourceMappingURL=utils.js.map","import debug from 'debug';\nimport Receptacle from 'receptacle';\nimport * as utils from './utils.js';\nconst log = Object.assign(debug('dns-over-http-resolver'), {\n    error: debug('dns-over-http-resolver:error')\n});\n/**\n * DNS over HTTP resolver.\n * Uses a list of servers to resolve DNS records with HTTP requests.\n */\nclass Resolver {\n    /**\n     * @class\n     * @param {object} [options]\n     * @param {number} [options.maxCache = 100] - maximum number of cached dns records\n     * @param {Request} [options.request] - function to return DNSJSON\n     */\n    constructor(options = {}) {\n        this._cache = new Receptacle({ max: options?.maxCache ?? 100 });\n        this._TXTcache = new Receptacle({ max: options?.maxCache ?? 100 });\n        this._servers = [\n            'https://cloudflare-dns.com/dns-query',\n            'https://dns.google/resolve'\n        ];\n        this._request = options.request ?? utils.request;\n        this._abortControllers = [];\n    }\n    /**\n     * Cancel all outstanding DNS queries made by this resolver. Any outstanding\n     * requests will be aborted and promises rejected.\n     */\n    cancel() {\n        this._abortControllers.forEach(controller => controller.abort());\n    }\n    /**\n     * Get an array of the IP addresses currently configured for DNS resolution.\n     * These addresses are formatted according to RFC 5952. It can include a custom port.\n     */\n    getServers() {\n        return this._servers;\n    }\n    /**\n     * Get a shuffled array of the IP addresses currently configured for DNS resolution.\n     * These addresses are formatted according to RFC 5952. It can include a custom port.\n     */\n    _getShuffledServers() {\n        const newServers = [...this._servers];\n        for (let i = newServers.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * i);\n            const temp = newServers[i];\n            newServers[i] = newServers[j];\n            newServers[j] = temp;\n        }\n        return newServers;\n    }\n    /**\n     * Sets the IP address and port of servers to be used when performing DNS resolution.\n     *\n     * @param {string[]} servers - array of RFC 5952 formatted addresses.\n     */\n    setServers(servers) {\n        this._servers = servers;\n    }\n    /**\n     * Uses the DNS protocol to resolve the given host name into the appropriate DNS record\n     *\n     * @param {string} hostname - host name to resolve\n     * @param {string} [rrType = 'A'] - resource record type\n     */\n    async resolve(hostname, rrType = 'A') {\n        switch (rrType) {\n            case 'A':\n                return await this.resolve4(hostname);\n            case 'AAAA':\n                return await this.resolve6(hostname);\n            case 'TXT':\n                return await this.resolveTxt(hostname);\n            default:\n                throw new Error(`${rrType} is not supported`);\n        }\n    }\n    /**\n     * Uses the DNS protocol to resolve the given host name into IPv4 addresses\n     *\n     * @param {string} hostname - host name to resolve\n     */\n    async resolve4(hostname) {\n        const recordType = 'A';\n        const cached = this._cache.get(utils.getCacheKey(hostname, recordType));\n        if (cached != null) {\n            return cached;\n        }\n        let aborted = false;\n        for (const server of this._getShuffledServers()) {\n            const controller = new AbortController();\n            this._abortControllers.push(controller);\n            try {\n                const response = await this._request(utils.buildResource(server, hostname, recordType), controller.signal);\n                const data = response.Answer.map(a => a.data);\n                const ttl = Math.min(...response.Answer.map(a => a.TTL));\n                this._cache.set(utils.getCacheKey(hostname, recordType), data, { ttl });\n                return data;\n            }\n            catch (err) {\n                if (controller.signal.aborted) {\n                    aborted = true;\n                }\n                log.error(`${server} could not resolve ${hostname} record ${recordType}`);\n            }\n            finally {\n                this._abortControllers = this._abortControllers.filter(c => c !== controller);\n            }\n        }\n        if (aborted) {\n            throw Object.assign(new Error('queryA ECANCELLED'), {\n                code: 'ECANCELLED'\n            });\n        }\n        throw new Error(`Could not resolve ${hostname} record ${recordType}`);\n    }\n    /**\n     * Uses the DNS protocol to resolve the given host name into IPv6 addresses\n     *\n     * @param {string} hostname - host name to resolve\n     */\n    async resolve6(hostname) {\n        const recordType = 'AAAA';\n        const cached = this._cache.get(utils.getCacheKey(hostname, recordType));\n        if (cached != null) {\n            return cached;\n        }\n        let aborted = false;\n        for (const server of this._getShuffledServers()) {\n            const controller = new AbortController();\n            this._abortControllers.push(controller);\n            try {\n                const response = await this._request(utils.buildResource(server, hostname, recordType), controller.signal);\n                const data = response.Answer.map(a => a.data);\n                const ttl = Math.min(...response.Answer.map(a => a.TTL));\n                this._cache.set(utils.getCacheKey(hostname, recordType), data, { ttl });\n                return data;\n            }\n            catch (err) {\n                if (controller.signal.aborted) {\n                    aborted = true;\n                }\n                log.error(`${server} could not resolve ${hostname} record ${recordType}`);\n            }\n            finally {\n                this._abortControllers = this._abortControllers.filter(c => c !== controller);\n            }\n        }\n        if (aborted) {\n            throw Object.assign(new Error('queryAaaa ECANCELLED'), {\n                code: 'ECANCELLED'\n            });\n        }\n        throw new Error(`Could not resolve ${hostname} record ${recordType}`);\n    }\n    /**\n     * Uses the DNS protocol to resolve the given host name into a Text record\n     *\n     * @param {string} hostname - host name to resolve\n     */\n    async resolveTxt(hostname) {\n        const recordType = 'TXT';\n        const cached = this._TXTcache.get(utils.getCacheKey(hostname, recordType));\n        if (cached != null) {\n            return cached;\n        }\n        let aborted = false;\n        for (const server of this._getShuffledServers()) {\n            const controller = new AbortController();\n            this._abortControllers.push(controller);\n            try {\n                const response = await this._request(utils.buildResource(server, hostname, recordType), controller.signal);\n                const data = response.Answer.map(a => [a.data.replace(/['\"]+/g, '')]);\n                const ttl = Math.min(...response.Answer.map(a => a.TTL));\n                this._TXTcache.set(utils.getCacheKey(hostname, recordType), data, { ttl });\n                return data;\n            }\n            catch (err) {\n                if (controller.signal.aborted) {\n                    aborted = true;\n                }\n                log.error(`${server} could not resolve ${hostname} record ${recordType}`);\n            }\n            finally {\n                this._abortControllers = this._abortControllers.filter(c => c !== controller);\n            }\n        }\n        if (aborted) {\n            throw Object.assign(new Error('queryTxt ECANCELLED'), {\n                code: 'ECANCELLED'\n            });\n        }\n        throw new Error(`Could not resolve ${hostname} record ${recordType}`);\n    }\n    clearCache() {\n        this._cache.clear();\n        this._TXTcache.clear();\n    }\n}\nexport default Resolver;\n//# sourceMappingURL=index.js.map","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach(key => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = obj => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nexport default encodePacket;\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType)\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType)\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1)\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type]\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            return data instanceof ArrayBuffer ? new Blob([data]) : data;\n        case \"arraybuffer\":\n        default:\n            return data; // assuming the data is already an ArrayBuffer\n    }\n};\nexport default decodePacket;\n","import encodePacket from \"./encodePacket.js\";\nimport decodePacket from \"./decodePacket.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, encodedPacket => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload };\n","export const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\n","import { globalThisShim as globalThis } from \"./globalThis.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nclass TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n}\n","// imported from https://github.com/unshiftio/yeast\n'use strict';\nconst alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''), length = 64, map = {};\nlet seed = 0, i = 0, prev;\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nexport function encode(num) {\n    let encoded = '';\n    do {\n        encoded = alphabet[num % length] + encoded;\n        num = Math.floor(num / length);\n    } while (num > 0);\n    return encoded;\n}\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nexport function decode(str) {\n    let decoded = 0;\n    for (i = 0; i < str.length; i++) {\n        decoded = decoded * length + map[str.charAt(i)];\n    }\n    return decoded;\n}\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nexport function yeast() {\n    const now = encode(+new Date());\n    if (now !== prev)\n        return seed = 0, prev = now;\n    return now + '.' + encode(seed++);\n}\n//\n// Map each character to its index.\n//\nfor (; i < length; i++)\n    map[alphabet[i]] = i;\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","// browser shim for xmlhttprequest module\nimport { hasCORS } from \"../contrib/has-cors.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nexport function XHR(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { encode } from \"../contrib/parseqs.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nimport { XHR as XMLHttpRequest } from \"./xmlhttprequest.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nfunction empty() { }\nconst hasXHR2 = (function () {\n    const xhr = new XMLHttpRequest({\n        xdomain: false,\n    });\n    return null != xhr.responseType;\n})();\nexport class Polling extends Transport {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        this.polling = false;\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n            this.xs = opts.secure !== isSSL;\n        }\n        /**\n         * XHR supports binary\n         */\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this.poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this.polling || !this.writable) {\n            let total = 0;\n            if (this.polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    poll() {\n        this.polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this.polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this.poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        let query = this.query || {};\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        let port = \"\";\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        // avoid port if default for schema\n        if (this.opts.port &&\n            ((\"https\" === schema && Number(this.opts.port) !== 443) ||\n                (\"http\" === schema && Number(this.opts.port) !== 80))) {\n            port = \":\" + this.opts.port;\n        }\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\":\") !== -1;\n        return (schema +\n            \"://\" +\n            (ipv6 ? \"[\" + this.opts.hostname + \"]\" : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \"?\" + encodedQuery : \"\"));\n    }\n    /**\n     * Creates a request.\n     *\n     * @param {String} method\n     * @private\n     */\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd, xs: this.xs }, this.opts);\n        return new Request(this.uri(), opts);\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(uri, opts) {\n        super();\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.method = opts.method || \"GET\";\n        this.uri = uri;\n        this.async = false !== opts.async;\n        this.data = undefined !== opts.data ? opts.data : null;\n        this.create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    create() {\n        const opts = pick(this.opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this.opts.xd;\n        opts.xscheme = !!this.opts.xs;\n        const xhr = (this.xhr = new XMLHttpRequest(opts));\n        try {\n            xhr.open(this.method, this.uri, this.async);\n            try {\n                if (this.opts.extraHeaders) {\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this.opts.extraHeaders) {\n                        if (this.opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this.opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this.method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this.opts.withCredentials;\n            }\n            if (this.opts.requestTimeout) {\n                xhr.timeout = this.opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this.onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this.onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this.data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this.onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this.index = Request.requestsCount++;\n            Request.requests[this.index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    onError(err) {\n        this.emitReserved(\"error\", err, this.xhr);\n        this.cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    cleanup(fromError) {\n        if (\"undefined\" === typeof this.xhr || null === this.xhr) {\n            return;\n        }\n        this.xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this.xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this.index];\n        }\n        this.xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    onLoad() {\n        const data = this.xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this.cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this.cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\n","import { globalThisShim as globalThis } from \"../globalThis.js\";\nexport const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const WebSocket = globalThis.WebSocket || globalThis.MozWebSocket;\nexport const usingBrowserWebSocket = true;\nexport const defaultBinaryType = \"arraybuffer\";\n","import { Transport } from \"../transport.js\";\nimport { encode } from \"../contrib/parseqs.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { pick } from \"../util.js\";\nimport { defaultBinaryType, nextTick, usingBrowserWebSocket, WebSocket, } from \"./websocket-constructor.js\";\nimport { encodePacket } from \"engine.io-parser\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class WS extends Transport {\n    /**\n     * WebSocket transport constructor.\n     *\n     * @param {Object} opts - connection options\n     * @protected\n     */\n    constructor(opts) {\n        super(opts);\n        this.supportsBinary = !opts.forceBase64;\n    }\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        if (!this.check()) {\n            // let probe timeout\n            return;\n        }\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws =\n                usingBrowserWebSocket && !isReactNative\n                    ? protocols\n                        ? new WebSocket(uri, protocols)\n                        : new WebSocket(uri)\n                    : new WebSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType || defaultBinaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // always create a new object (GH-437)\n                const opts = {};\n                if (!usingBrowserWebSocket) {\n                    if (packet.options) {\n                        opts.compress = packet.options.compress;\n                    }\n                    if (this.opts.perMessageDeflate) {\n                        const len = \n                        // @ts-ignore\n                        \"string\" === typeof data ? Buffer.byteLength(data) : data.length;\n                        if (len < this.opts.perMessageDeflate.threshold) {\n                            opts.compress = false;\n                        }\n                    }\n                }\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    if (usingBrowserWebSocket) {\n                        // TypeError is thrown when passing the second argument on Safari\n                        this.ws.send(data);\n                    }\n                    else {\n                        this.ws.send(data, opts);\n                    }\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        let query = this.query || {};\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        let port = \"\";\n        // avoid port if default for schema\n        if (this.opts.port &&\n            ((\"wss\" === schema && Number(this.opts.port) !== 443) ||\n                (\"ws\" === schema && Number(this.opts.port) !== 80))) {\n            port = \":\" + this.opts.port;\n        }\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\":\") !== -1;\n        return (schema +\n            \"://\" +\n            (ipv6 ? \"[\" + this.opts.hostname + \"]\" : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \"?\" + encodedQuery : \"\"));\n    }\n    /**\n     * Feature detection for WebSocket.\n     *\n     * @return {Boolean} whether this transport is available.\n     * @private\n     */\n    check() {\n        return !!WebSocket;\n    }\n}\n","import { Polling } from \"./polling.js\";\nimport { WS } from \"./websocket.js\";\nexport const transports = {\n    websocket: WS,\n    polling: Polling,\n};\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nexport class Socket extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts = {}) {\n        super();\n        this.writeBuffer = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            uri = parse(uri);\n            opts.hostname = uri.host;\n            opts.secure = uri.protocol === \"https\" || uri.protocol === \"wss\";\n            opts.port = uri.port;\n            if (uri.query)\n                opts.query = uri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = opts.transports || [\"polling\", \"websocket\"];\n        this.writeBuffer = [];\n        this.prevBufferLen = 0;\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: true,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        // set on handshake\n        this.id = null;\n        this.upgrades = null;\n        this.pingInterval = null;\n        this.pingTimeout = null;\n        // set on heartbeat\n        this.pingTimeoutTimer = null;\n        if (typeof addEventListener === \"function\") {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this.beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this.offlineEventListener = () => {\n                    this.onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                addEventListener(\"offline\", this.offlineEventListener, false);\n            }\n        }\n        this.open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts.transportOptions[name], this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        });\n        return new transports[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    open() {\n        let transport;\n        if (this.opts.rememberUpgrade &&\n            Socket.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1) {\n            transport = \"websocket\";\n        }\n        else if (0 === this.transports.length) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        else {\n            transport = this.transports[0];\n        }\n        this.readyState = \"opening\";\n        // Retry with the next transport if the transport is disabled (jsonp: false)\n        try {\n            transport = this.createTransport(transport);\n        }\n        catch (e) {\n            this.transports.shift();\n            this.open();\n            return;\n        }\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this.onDrain.bind(this))\n            .on(\"packet\", this.onPacket.bind(this))\n            .on(\"error\", this.onError.bind(this))\n            .on(\"close\", (reason) => this.onClose(\"transport close\", reason));\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        Socket.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    Socket.priorWebsocketSuccess = \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        transport.open();\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        Socket.priorWebsocketSuccess = \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n        // we check for `readyState` in case an `open`\n        // listener already closed the socket\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            let i = 0;\n            const l = this.upgrades.length;\n            for (; i < l; i++) {\n                this.probe(this.upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this.resetPingTimeout();\n                    this.sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this.onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this.upgrades = this.filterUpgrades(data.upgrades);\n        this.pingInterval = data.pingInterval;\n        this.pingTimeout = data.pingTimeout;\n        this.maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this.resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    resetPingTimeout() {\n        this.clearTimeoutFn(this.pingTimeoutTimer);\n        this.pingTimeoutTimer = this.setTimeoutFn(() => {\n            this.onClose(\"ping timeout\");\n        }, this.pingInterval + this.pingTimeout);\n        if (this.opts.autoUnref) {\n            this.pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    onDrain() {\n        this.writeBuffer.splice(0, this.prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this.prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this.getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this.prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    getWritablePackets() {\n        const shouldCheckPayloadSize = this.maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this.maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    send(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this.onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    onError(err) {\n        Socket.priorWebsocketSuccess = false;\n        this.emitReserved(\"error\", err);\n        this.onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this.pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (typeof removeEventListener === \"function\") {\n                removeEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n                removeEventListener(\"offline\", this.offlineEventListener, false);\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this.prevBufferLen = 0;\n        }\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        let i = 0;\n        const j = upgrades.length;\n        for (; i < j; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\nSocket.protocol = protocol;\n","import { Socket } from \"./socket.js\";\nexport { Socket };\nexport const protocol = Socket.protocol;\nexport { Transport } from \"./transport.js\";\nexport { transports } from \"./transports/index.js\";\nexport { installTimerFunctions } from \"./util.js\";\nexport { parse } from \"./contrib/parseuri.js\";\nexport { nextTick } from \"./transports/websocket-constructor.js\";\n","export function stringToBytes(string) {\n\treturn [...string].map(character => character.charCodeAt(0)); // eslint-disable-line unicorn/prefer-code-point\n}\n\n/**\nChecks whether the TAR checksum is valid.\n\n@param {Buffer} buffer - The TAR header `[offset ... offset + 512]`.\n@param {number} offset - TAR header offset.\n@returns {boolean} `true` if the TAR checksum is valid, otherwise `false`.\n*/\nexport function tarHeaderChecksumMatches(buffer, offset = 0) {\n\tconst readSum = Number.parseInt(buffer.toString('utf8', 148, 154).replace(/\\0.*$/, '').trim(), 8); // Read sum in header\n\tif (Number.isNaN(readSum)) {\n\t\treturn false;\n\t}\n\n\tlet sum = 8 * 0x20; // Initialize signed bit sum\n\n\tfor (let index = offset; index < offset + 148; index++) {\n\t\tsum += buffer[index];\n\t}\n\n\tfor (let index = offset + 156; index < offset + 512; index++) {\n\t\tsum += buffer[index];\n\t}\n\n\treturn readSum === sum;\n}\n\n/**\nID3 UINT32 sync-safe tokenizer token.\n28 bits (representing up to 256MB) integer, the msb is 0 to avoid \"false syncsignals\".\n*/\nexport const uint32SyncSafeToken = {\n\tget: (buffer, offset) => (buffer[offset + 3] & 0x7F) | ((buffer[offset + 2]) << 7) | ((buffer[offset + 1]) << 14) | ((buffer[offset]) << 21),\n\tlen: 4,\n};\n","import {Buffer} from 'node:buffer';\nimport * as Token from 'token-types';\nimport * as strtok3 from 'strtok3/core'; // eslint-disable-line n/file-extension-in-import\nimport {\n\tstringToBytes,\n\ttarHeaderChecksumMatches,\n\tuint32SyncSafeToken,\n} from './util.js';\nimport {extensions, mimeTypes} from './supported.js';\n\nconst minimumBytes = 4100; // A fair amount of file-types are detectable within this range.\n\nexport async function fileTypeFromStream(stream) {\n\tconst tokenizer = await strtok3.fromStream(stream);\n\ttry {\n\t\treturn await fileTypeFromTokenizer(tokenizer);\n\t} finally {\n\t\tawait tokenizer.close();\n\t}\n}\n\nexport async function fileTypeFromBuffer(input) {\n\tif (!(input instanceof Uint8Array || input instanceof ArrayBuffer)) {\n\t\tthrow new TypeError(`Expected the \\`input\\` argument to be of type \\`Uint8Array\\` or \\`Buffer\\` or \\`ArrayBuffer\\`, got \\`${typeof input}\\``);\n\t}\n\n\tconst buffer = input instanceof Uint8Array ? input : new Uint8Array(input);\n\n\tif (!(buffer?.length > 1)) {\n\t\treturn;\n\t}\n\n\treturn fileTypeFromTokenizer(strtok3.fromBuffer(buffer));\n}\n\nexport async function fileTypeFromBlob(blob) {\n\tconst buffer = await blob.arrayBuffer();\n\treturn fileTypeFromBuffer(new Uint8Array(buffer));\n}\n\nfunction _check(buffer, headers, options) {\n\toptions = {\n\t\toffset: 0,\n\t\t...options,\n\t};\n\n\tfor (const [index, header] of headers.entries()) {\n\t\t// If a bitmask is set\n\t\tif (options.mask) {\n\t\t\t// If header doesn't equal `buf` with bits masked off\n\t\t\tif (header !== (options.mask[index] & buffer[index + options.offset])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else if (header !== buffer[index + options.offset]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport async function fileTypeFromTokenizer(tokenizer) {\n\ttry {\n\t\treturn new FileTypeParser().parse(tokenizer);\n\t} catch (error) {\n\t\tif (!(error instanceof strtok3.EndOfStreamError)) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nclass FileTypeParser {\n\tcheck(header, options) {\n\t\treturn _check(this.buffer, header, options);\n\t}\n\n\tcheckString(header, options) {\n\t\treturn this.check(stringToBytes(header), options);\n\t}\n\n\tasync parse(tokenizer) {\n\t\tthis.buffer = Buffer.alloc(minimumBytes);\n\n\t\t// Keep reading until EOF if the file size is unknown.\n\t\tif (tokenizer.fileInfo.size === undefined) {\n\t\t\ttokenizer.fileInfo.size = Number.MAX_SAFE_INTEGER;\n\t\t}\n\n\t\tthis.tokenizer = tokenizer;\n\n\t\tawait tokenizer.peekBuffer(this.buffer, {length: 12, mayBeLess: true});\n\n\t\t// -- 2-byte signatures --\n\n\t\tif (this.check([0x42, 0x4D])) {\n\t\t\treturn {\n\t\t\t\text: 'bmp',\n\t\t\t\tmime: 'image/bmp',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x0B, 0x77])) {\n\t\t\treturn {\n\t\t\t\text: 'ac3',\n\t\t\t\tmime: 'audio/vnd.dolby.dd-raw',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x78, 0x01])) {\n\t\t\treturn {\n\t\t\t\text: 'dmg',\n\t\t\t\tmime: 'application/x-apple-diskimage',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x4D, 0x5A])) {\n\t\t\treturn {\n\t\t\t\text: 'exe',\n\t\t\t\tmime: 'application/x-msdownload',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x25, 0x21])) {\n\t\t\tawait tokenizer.peekBuffer(this.buffer, {length: 24, mayBeLess: true});\n\n\t\t\tif (\n\t\t\t\tthis.checkString('PS-Adobe-', {offset: 2})\n\t\t\t\t&& this.checkString(' EPSF-', {offset: 14})\n\t\t\t) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'eps',\n\t\t\t\t\tmime: 'application/eps',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\text: 'ps',\n\t\t\t\tmime: 'application/postscript',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.check([0x1F, 0xA0])\n\t\t\t|| this.check([0x1F, 0x9D])\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'Z',\n\t\t\t\tmime: 'application/x-compress',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xC7, 0x71])) {\n\t\t\treturn {\n\t\t\t\text: 'cpio',\n\t\t\t\tmime: 'application/x-cpio',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x60, 0xEA])) {\n\t\t\treturn {\n\t\t\t\text: 'arj',\n\t\t\t\tmime: 'application/x-arj',\n\t\t\t};\n\t\t}\n\n\t\t// -- 3-byte signatures --\n\n\t\tif (this.check([0xEF, 0xBB, 0xBF])) { // UTF-8-BOM\n\t\t\t// Strip off UTF-8-BOM\n\t\t\tthis.tokenizer.ignore(3);\n\t\t\treturn this.parse(tokenizer);\n\t\t}\n\n\t\tif (this.check([0x47, 0x49, 0x46])) {\n\t\t\treturn {\n\t\t\t\text: 'gif',\n\t\t\t\tmime: 'image/gif',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x49, 0x49, 0xBC])) {\n\t\t\treturn {\n\t\t\t\text: 'jxr',\n\t\t\t\tmime: 'image/vnd.ms-photo',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x1F, 0x8B, 0x8])) {\n\t\t\treturn {\n\t\t\t\text: 'gz',\n\t\t\t\tmime: 'application/gzip',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x42, 0x5A, 0x68])) {\n\t\t\treturn {\n\t\t\t\text: 'bz2',\n\t\t\t\tmime: 'application/x-bzip2',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('ID3')) {\n\t\t\tawait tokenizer.ignore(6); // Skip ID3 header until the header size\n\t\t\tconst id3HeaderLength = await tokenizer.readToken(uint32SyncSafeToken);\n\t\t\tif (tokenizer.position + id3HeaderLength > tokenizer.fileInfo.size) {\n\t\t\t\t// Guess file type based on ID3 header for backward compatibility\n\t\t\t\treturn {\n\t\t\t\t\text: 'mp3',\n\t\t\t\t\tmime: 'audio/mpeg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tawait tokenizer.ignore(id3HeaderLength);\n\t\t\treturn fileTypeFromTokenizer(tokenizer); // Skip ID3 header, recursion\n\t\t}\n\n\t\t// Musepack, SV7\n\t\tif (this.checkString('MP+')) {\n\t\t\treturn {\n\t\t\t\text: 'mpc',\n\t\t\t\tmime: 'audio/x-musepack',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\t(this.buffer[0] === 0x43 || this.buffer[0] === 0x46)\n\t\t\t&& this.check([0x57, 0x53], {offset: 1})\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'swf',\n\t\t\t\tmime: 'application/x-shockwave-flash',\n\t\t\t};\n\t\t}\n\n\t\t// -- 4-byte signatures --\n\n\t\t// Requires a sample size of 4 bytes\n\t\tif (this.check([0xFF, 0xD8, 0xFF])) {\n\t\t\tif (this.check([0xF7], {offset: 3})) { // JPG7/SOF55, indicating a ISO/IEC 14495 / JPEG-LS file\n\t\t\t\treturn {\n\t\t\t\t\text: 'jls',\n\t\t\t\t\tmime: 'image/jls',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\text: 'jpg',\n\t\t\t\tmime: 'image/jpeg',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('FLIF')) {\n\t\t\treturn {\n\t\t\t\text: 'flif',\n\t\t\t\tmime: 'image/flif',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('8BPS')) {\n\t\t\treturn {\n\t\t\t\text: 'psd',\n\t\t\t\tmime: 'image/vnd.adobe.photoshop',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('WEBP', {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'webp',\n\t\t\t\tmime: 'image/webp',\n\t\t\t};\n\t\t}\n\n\t\t// Musepack, SV8\n\t\tif (this.checkString('MPCK')) {\n\t\t\treturn {\n\t\t\t\text: 'mpc',\n\t\t\t\tmime: 'audio/x-musepack',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('FORM')) {\n\t\t\treturn {\n\t\t\t\text: 'aif',\n\t\t\t\tmime: 'audio/aiff',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('icns', {offset: 0})) {\n\t\t\treturn {\n\t\t\t\text: 'icns',\n\t\t\t\tmime: 'image/icns',\n\t\t\t};\n\t\t}\n\n\t\t// Zip-based file formats\n\t\t// Need to be before the `zip` check\n\t\tif (this.check([0x50, 0x4B, 0x3, 0x4])) { // Local file header signature\n\t\t\ttry {\n\t\t\t\twhile (tokenizer.position + 30 < tokenizer.fileInfo.size) {\n\t\t\t\t\tawait tokenizer.readBuffer(this.buffer, {length: 30});\n\n\t\t\t\t\t// https://en.wikipedia.org/wiki/Zip_(file_format)#File_headers\n\t\t\t\t\tconst zipHeader = {\n\t\t\t\t\t\tcompressedSize: this.buffer.readUInt32LE(18),\n\t\t\t\t\t\tuncompressedSize: this.buffer.readUInt32LE(22),\n\t\t\t\t\t\tfilenameLength: this.buffer.readUInt16LE(26),\n\t\t\t\t\t\textraFieldLength: this.buffer.readUInt16LE(28),\n\t\t\t\t\t};\n\n\t\t\t\t\tzipHeader.filename = await tokenizer.readToken(new Token.StringType(zipHeader.filenameLength, 'utf-8'));\n\t\t\t\t\tawait tokenizer.ignore(zipHeader.extraFieldLength);\n\n\t\t\t\t\t// Assumes signed `.xpi` from addons.mozilla.org\n\t\t\t\t\tif (zipHeader.filename === 'META-INF/mozilla.rsa') {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'xpi',\n\t\t\t\t\t\t\tmime: 'application/x-xpinstall',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (zipHeader.filename.endsWith('.rels') || zipHeader.filename.endsWith('.xml')) {\n\t\t\t\t\t\tconst type = zipHeader.filename.split('/')[0];\n\t\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\t\tcase '_rels':\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'word':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'docx',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase 'ppt':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'pptx',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase 'xl':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'xlsx',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (zipHeader.filename.startsWith('xl/')) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'xlsx',\n\t\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (zipHeader.filename.startsWith('3D/') && zipHeader.filename.endsWith('.model')) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: '3mf',\n\t\t\t\t\t\t\tmime: 'model/3mf',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t// The docx, xlsx and pptx file types extend the Office Open XML file format:\n\t\t\t\t\t// https://en.wikipedia.org/wiki/Office_Open_XML_file_formats\n\t\t\t\t\t// We look for:\n\t\t\t\t\t// - one entry named '[Content_Types].xml' or '_rels/.rels',\n\t\t\t\t\t// - one entry indicating specific type of file.\n\t\t\t\t\t// MS Office, OpenOffice and LibreOffice may put the parts in different order, so the check should not rely on it.\n\t\t\t\t\tif (zipHeader.filename === 'mimetype' && zipHeader.compressedSize === zipHeader.uncompressedSize) {\n\t\t\t\t\t\tlet mimeType = await tokenizer.readToken(new Token.StringType(zipHeader.compressedSize, 'utf-8'));\n\t\t\t\t\t\tmimeType = mimeType.trim();\n\n\t\t\t\t\t\tswitch (mimeType) {\n\t\t\t\t\t\t\tcase 'application/epub+zip':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'epub',\n\t\t\t\t\t\t\t\t\tmime: 'application/epub+zip',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase 'application/vnd.oasis.opendocument.text':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'odt',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.oasis.opendocument.text',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase 'application/vnd.oasis.opendocument.spreadsheet':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'ods',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.oasis.opendocument.spreadsheet',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase 'application/vnd.oasis.opendocument.presentation':\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\text: 'odp',\n\t\t\t\t\t\t\t\t\tmime: 'application/vnd.oasis.opendocument.presentation',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Try to find next header manually when current one is corrupted\n\t\t\t\t\tif (zipHeader.compressedSize === 0) {\n\t\t\t\t\t\tlet nextHeaderIndex = -1;\n\n\t\t\t\t\t\twhile (nextHeaderIndex < 0 && (tokenizer.position < tokenizer.fileInfo.size)) {\n\t\t\t\t\t\t\tawait tokenizer.peekBuffer(this.buffer, {mayBeLess: true});\n\n\t\t\t\t\t\t\tnextHeaderIndex = this.buffer.indexOf('504B0304', 0, 'hex');\n\t\t\t\t\t\t\t// Move position to the next header if found, skip the whole buffer otherwise\n\t\t\t\t\t\t\tawait tokenizer.ignore(nextHeaderIndex >= 0 ? nextHeaderIndex : this.buffer.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait tokenizer.ignore(zipHeader.compressedSize);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tif (!(error instanceof strtok3.EndOfStreamError)) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\text: 'zip',\n\t\t\t\tmime: 'application/zip',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('OggS')) {\n\t\t\t// This is an OGG container\n\t\t\tawait tokenizer.ignore(28);\n\t\t\tconst type = Buffer.alloc(8);\n\t\t\tawait tokenizer.readBuffer(type);\n\n\t\t\t// Needs to be before `ogg` check\n\t\t\tif (_check(type, [0x4F, 0x70, 0x75, 0x73, 0x48, 0x65, 0x61, 0x64])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'opus',\n\t\t\t\t\tmime: 'audio/opus',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If ' theora' in header.\n\t\t\tif (_check(type, [0x80, 0x74, 0x68, 0x65, 0x6F, 0x72, 0x61])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'ogv',\n\t\t\t\t\tmime: 'video/ogg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If '\\x01video' in header.\n\t\t\tif (_check(type, [0x01, 0x76, 0x69, 0x64, 0x65, 0x6F, 0x00])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'ogm',\n\t\t\t\t\tmime: 'video/ogg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If ' FLAC' in header  https://xiph.org/flac/faq.html\n\t\t\tif (_check(type, [0x7F, 0x46, 0x4C, 0x41, 0x43])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'oga',\n\t\t\t\t\tmime: 'audio/ogg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// 'Speex  ' in header https://en.wikipedia.org/wiki/Speex\n\t\t\tif (_check(type, [0x53, 0x70, 0x65, 0x65, 0x78, 0x20, 0x20])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'spx',\n\t\t\t\t\tmime: 'audio/ogg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If '\\x01vorbis' in header\n\t\t\tif (_check(type, [0x01, 0x76, 0x6F, 0x72, 0x62, 0x69, 0x73])) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'ogg',\n\t\t\t\t\tmime: 'audio/ogg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Default OGG container https://www.iana.org/assignments/media-types/application/ogg\n\t\t\treturn {\n\t\t\t\text: 'ogx',\n\t\t\t\tmime: 'application/ogg',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.check([0x50, 0x4B])\n\t\t\t&& (this.buffer[2] === 0x3 || this.buffer[2] === 0x5 || this.buffer[2] === 0x7)\n\t\t\t&& (this.buffer[3] === 0x4 || this.buffer[3] === 0x6 || this.buffer[3] === 0x8)\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'zip',\n\t\t\t\tmime: 'application/zip',\n\t\t\t};\n\t\t}\n\n\t\t//\n\n\t\t// File Type Box (https://en.wikipedia.org/wiki/ISO_base_media_file_format)\n\t\t// It's not required to be first, but it's recommended to be. Almost all ISO base media files start with `ftyp` box.\n\t\t// `ftyp` box must contain a brand major identifier, which must consist of ISO 8859-1 printable characters.\n\t\t// Here we check for 8859-1 printable characters (for simplicity, it's a mask which also catches one non-printable character).\n\t\tif (\n\t\t\tthis.checkString('ftyp', {offset: 4})\n\t\t\t&& (this.buffer[8] & 0x60) !== 0x00 // Brand major, first character ASCII?\n\t\t) {\n\t\t\t// They all can have MIME `video/mp4` except `application/mp4` special-case which is hard to detect.\n\t\t\t// For some cases, we're specific, everything else falls to `video/mp4` with `mp4` extension.\n\t\t\tconst brandMajor = this.buffer.toString('binary', 8, 12).replace('\\0', ' ').trim();\n\t\t\tswitch (brandMajor) {\n\t\t\t\tcase 'avif':\n\t\t\t\tcase 'avis':\n\t\t\t\t\treturn {ext: 'avif', mime: 'image/avif'};\n\t\t\t\tcase 'mif1':\n\t\t\t\t\treturn {ext: 'heic', mime: 'image/heif'};\n\t\t\t\tcase 'msf1':\n\t\t\t\t\treturn {ext: 'heic', mime: 'image/heif-sequence'};\n\t\t\t\tcase 'heic':\n\t\t\t\tcase 'heix':\n\t\t\t\t\treturn {ext: 'heic', mime: 'image/heic'};\n\t\t\t\tcase 'hevc':\n\t\t\t\tcase 'hevx':\n\t\t\t\t\treturn {ext: 'heic', mime: 'image/heic-sequence'};\n\t\t\t\tcase 'qt':\n\t\t\t\t\treturn {ext: 'mov', mime: 'video/quicktime'};\n\t\t\t\tcase 'M4V':\n\t\t\t\tcase 'M4VH':\n\t\t\t\tcase 'M4VP':\n\t\t\t\t\treturn {ext: 'm4v', mime: 'video/x-m4v'};\n\t\t\t\tcase 'M4P':\n\t\t\t\t\treturn {ext: 'm4p', mime: 'video/mp4'};\n\t\t\t\tcase 'M4B':\n\t\t\t\t\treturn {ext: 'm4b', mime: 'audio/mp4'};\n\t\t\t\tcase 'M4A':\n\t\t\t\t\treturn {ext: 'm4a', mime: 'audio/x-m4a'};\n\t\t\t\tcase 'F4V':\n\t\t\t\t\treturn {ext: 'f4v', mime: 'video/mp4'};\n\t\t\t\tcase 'F4P':\n\t\t\t\t\treturn {ext: 'f4p', mime: 'video/mp4'};\n\t\t\t\tcase 'F4A':\n\t\t\t\t\treturn {ext: 'f4a', mime: 'audio/mp4'};\n\t\t\t\tcase 'F4B':\n\t\t\t\t\treturn {ext: 'f4b', mime: 'audio/mp4'};\n\t\t\t\tcase 'crx':\n\t\t\t\t\treturn {ext: 'cr3', mime: 'image/x-canon-cr3'};\n\t\t\t\tdefault:\n\t\t\t\t\tif (brandMajor.startsWith('3g')) {\n\t\t\t\t\t\tif (brandMajor.startsWith('3g2')) {\n\t\t\t\t\t\t\treturn {ext: '3g2', mime: 'video/3gpp2'};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {ext: '3gp', mime: 'video/3gpp'};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {ext: 'mp4', mime: 'video/mp4'};\n\t\t\t}\n\t\t}\n\n\t\tif (this.checkString('MThd')) {\n\t\t\treturn {\n\t\t\t\text: 'mid',\n\t\t\t\tmime: 'audio/midi',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.checkString('wOFF')\n\t\t\t&& (\n\t\t\t\tthis.check([0x00, 0x01, 0x00, 0x00], {offset: 4})\n\t\t\t\t|| this.checkString('OTTO', {offset: 4})\n\t\t\t)\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'woff',\n\t\t\t\tmime: 'font/woff',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.checkString('wOF2')\n\t\t\t&& (\n\t\t\t\tthis.check([0x00, 0x01, 0x00, 0x00], {offset: 4})\n\t\t\t\t|| this.checkString('OTTO', {offset: 4})\n\t\t\t)\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'woff2',\n\t\t\t\tmime: 'font/woff2',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xD4, 0xC3, 0xB2, 0xA1]) || this.check([0xA1, 0xB2, 0xC3, 0xD4])) {\n\t\t\treturn {\n\t\t\t\text: 'pcap',\n\t\t\t\tmime: 'application/vnd.tcpdump.pcap',\n\t\t\t};\n\t\t}\n\n\t\t// Sony DSD Stream File (DSF)\n\t\tif (this.checkString('DSD ')) {\n\t\t\treturn {\n\t\t\t\text: 'dsf',\n\t\t\t\tmime: 'audio/x-dsf', // Non-standard\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('LZIP')) {\n\t\t\treturn {\n\t\t\t\text: 'lz',\n\t\t\t\tmime: 'application/x-lzip',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('fLaC')) {\n\t\t\treturn {\n\t\t\t\text: 'flac',\n\t\t\t\tmime: 'audio/x-flac',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x42, 0x50, 0x47, 0xFB])) {\n\t\t\treturn {\n\t\t\t\text: 'bpg',\n\t\t\t\tmime: 'image/bpg',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('wvpk')) {\n\t\t\treturn {\n\t\t\t\text: 'wv',\n\t\t\t\tmime: 'audio/wavpack',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('%PDF')) {\n\t\t\ttry {\n\t\t\t\tawait tokenizer.ignore(1350);\n\t\t\t\tconst maxBufferSize = 10 * 1024 * 1024;\n\t\t\t\tconst buffer = Buffer.alloc(Math.min(maxBufferSize, tokenizer.fileInfo.size));\n\t\t\t\tawait tokenizer.readBuffer(buffer, {mayBeLess: true});\n\n\t\t\t\t// Check if this is an Adobe Illustrator file\n\t\t\t\tif (buffer.includes(Buffer.from('AIPrivateData'))) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'ai',\n\t\t\t\t\t\tmime: 'application/postscript',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Swallow end of stream error if file is too small for the Adobe AI check\n\t\t\t\tif (!(error instanceof strtok3.EndOfStreamError)) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Assume this is just a normal PDF\n\t\t\treturn {\n\t\t\t\text: 'pdf',\n\t\t\t\tmime: 'application/pdf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x00, 0x61, 0x73, 0x6D])) {\n\t\t\treturn {\n\t\t\t\text: 'wasm',\n\t\t\t\tmime: 'application/wasm',\n\t\t\t};\n\t\t}\n\n\t\t// TIFF, little-endian type\n\t\tif (this.check([0x49, 0x49])) {\n\t\t\tconst fileType = await this.readTiffHeader(false);\n\t\t\tif (fileType) {\n\t\t\t\treturn fileType;\n\t\t\t}\n\t\t}\n\n\t\t// TIFF, big-endian type\n\t\tif (this.check([0x4D, 0x4D])) {\n\t\t\tconst fileType = await this.readTiffHeader(true);\n\t\t\tif (fileType) {\n\t\t\t\treturn fileType;\n\t\t\t}\n\t\t}\n\n\t\tif (this.checkString('MAC ')) {\n\t\t\treturn {\n\t\t\t\text: 'ape',\n\t\t\t\tmime: 'audio/ape',\n\t\t\t};\n\t\t}\n\n\t\t// https://github.com/threatstack/libmagic/blob/master/magic/Magdir/matroska\n\t\tif (this.check([0x1A, 0x45, 0xDF, 0xA3])) { // Root element: EBML\n\t\t\tasync function readField() {\n\t\t\t\tconst msb = await tokenizer.peekNumber(Token.UINT8);\n\t\t\t\tlet mask = 0x80;\n\t\t\t\tlet ic = 0; // 0 = A, 1 = B, 2 = C, 3\n\t\t\t\t// = D\n\n\t\t\t\twhile ((msb & mask) === 0 && mask !== 0) {\n\t\t\t\t\t++ic;\n\t\t\t\t\tmask >>= 1;\n\t\t\t\t}\n\n\t\t\t\tconst id = Buffer.alloc(ic + 1);\n\t\t\t\tawait tokenizer.readBuffer(id);\n\t\t\t\treturn id;\n\t\t\t}\n\n\t\t\tasync function readElement() {\n\t\t\t\tconst id = await readField();\n\t\t\t\tconst lengthField = await readField();\n\t\t\t\tlengthField[0] ^= 0x80 >> (lengthField.length - 1);\n\t\t\t\tconst nrLength = Math.min(6, lengthField.length); // JavaScript can max read 6 bytes integer\n\t\t\t\treturn {\n\t\t\t\t\tid: id.readUIntBE(0, id.length),\n\t\t\t\t\tlen: lengthField.readUIntBE(lengthField.length - nrLength, nrLength),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tasync function readChildren(children) {\n\t\t\t\twhile (children > 0) {\n\t\t\t\t\tconst element = await readElement();\n\t\t\t\t\tif (element.id === 0x42_82) {\n\t\t\t\t\t\tconst rawValue = await tokenizer.readToken(new Token.StringType(element.len, 'utf-8'));\n\t\t\t\t\t\treturn rawValue.replace(/\\00.*$/g, ''); // Return DocType\n\t\t\t\t\t}\n\n\t\t\t\t\tawait tokenizer.ignore(element.len); // ignore payload\n\t\t\t\t\t--children;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst re = await readElement();\n\t\t\tconst docType = await readChildren(re.len);\n\n\t\t\tswitch (docType) {\n\t\t\t\tcase 'webm':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'webm',\n\t\t\t\t\t\tmime: 'video/webm',\n\t\t\t\t\t};\n\n\t\t\t\tcase 'matroska':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'mkv',\n\t\t\t\t\t\tmime: 'video/x-matroska',\n\t\t\t\t\t};\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// RIFF file format which might be AVI, WAV, QCP, etc\n\t\tif (this.check([0x52, 0x49, 0x46, 0x46])) {\n\t\t\tif (this.check([0x41, 0x56, 0x49], {offset: 8})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'avi',\n\t\t\t\t\tmime: 'video/vnd.avi',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.check([0x57, 0x41, 0x56, 0x45], {offset: 8})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'wav',\n\t\t\t\t\tmime: 'audio/vnd.wave',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// QLCM, QCP file\n\t\t\tif (this.check([0x51, 0x4C, 0x43, 0x4D], {offset: 8})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'qcp',\n\t\t\t\t\tmime: 'audio/qcelp',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (this.checkString('SQLi')) {\n\t\t\treturn {\n\t\t\t\text: 'sqlite',\n\t\t\t\tmime: 'application/x-sqlite3',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x4E, 0x45, 0x53, 0x1A])) {\n\t\t\treturn {\n\t\t\t\text: 'nes',\n\t\t\t\tmime: 'application/x-nintendo-nes-rom',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('Cr24')) {\n\t\t\treturn {\n\t\t\t\text: 'crx',\n\t\t\t\tmime: 'application/x-google-chrome-extension',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.checkString('MSCF')\n\t\t\t|| this.checkString('ISc(')\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'cab',\n\t\t\t\tmime: 'application/vnd.ms-cab-compressed',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xED, 0xAB, 0xEE, 0xDB])) {\n\t\t\treturn {\n\t\t\t\text: 'rpm',\n\t\t\t\tmime: 'application/x-rpm',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xC5, 0xD0, 0xD3, 0xC6])) {\n\t\t\treturn {\n\t\t\t\text: 'eps',\n\t\t\t\tmime: 'application/eps',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x28, 0xB5, 0x2F, 0xFD])) {\n\t\t\treturn {\n\t\t\t\text: 'zst',\n\t\t\t\tmime: 'application/zstd',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x7F, 0x45, 0x4C, 0x46])) {\n\t\t\treturn {\n\t\t\t\text: 'elf',\n\t\t\t\tmime: 'application/x-elf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x21, 0x42, 0x44, 0x4E])) {\n\t\t\treturn {\n\t\t\t\text: 'pst',\n\t\t\t\tmime: 'application/vnd.ms-outlook',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('PAR1')) {\n\t\t\treturn {\n\t\t\t\text: 'parquet',\n\t\t\t\tmime: 'application/x-parquet',\n\t\t\t};\n\t\t}\n\n\t\t// -- 5-byte signatures --\n\n\t\tif (this.check([0x4F, 0x54, 0x54, 0x4F, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'otf',\n\t\t\t\tmime: 'font/otf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('#!AMR')) {\n\t\t\treturn {\n\t\t\t\text: 'amr',\n\t\t\t\tmime: 'audio/amr',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('{\\\\rtf')) {\n\t\t\treturn {\n\t\t\t\text: 'rtf',\n\t\t\t\tmime: 'application/rtf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x46, 0x4C, 0x56, 0x01])) {\n\t\t\treturn {\n\t\t\t\text: 'flv',\n\t\t\t\tmime: 'video/x-flv',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('IMPM')) {\n\t\t\treturn {\n\t\t\t\text: 'it',\n\t\t\t\tmime: 'audio/x-it',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.checkString('-lh0-', {offset: 2})\n\t\t\t|| this.checkString('-lh1-', {offset: 2})\n\t\t\t|| this.checkString('-lh2-', {offset: 2})\n\t\t\t|| this.checkString('-lh3-', {offset: 2})\n\t\t\t|| this.checkString('-lh4-', {offset: 2})\n\t\t\t|| this.checkString('-lh5-', {offset: 2})\n\t\t\t|| this.checkString('-lh6-', {offset: 2})\n\t\t\t|| this.checkString('-lh7-', {offset: 2})\n\t\t\t|| this.checkString('-lzs-', {offset: 2})\n\t\t\t|| this.checkString('-lz4-', {offset: 2})\n\t\t\t|| this.checkString('-lz5-', {offset: 2})\n\t\t\t|| this.checkString('-lhd-', {offset: 2})\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'lzh',\n\t\t\t\tmime: 'application/x-lzh-compressed',\n\t\t\t};\n\t\t}\n\n\t\t// MPEG program stream (PS or MPEG-PS)\n\t\tif (this.check([0x00, 0x00, 0x01, 0xBA])) {\n\t\t\t//  MPEG-PS, MPEG-1 Part 1\n\t\t\tif (this.check([0x21], {offset: 4, mask: [0xF1]})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mpg', // May also be .ps, .mpeg\n\t\t\t\t\tmime: 'video/MP1S',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// MPEG-PS, MPEG-2 Part 1\n\t\t\tif (this.check([0x44], {offset: 4, mask: [0xC4]})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mpg', // May also be .mpg, .m2p, .vob or .sub\n\t\t\t\t\tmime: 'video/MP2P',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (this.checkString('ITSF')) {\n\t\t\treturn {\n\t\t\t\text: 'chm',\n\t\t\t\tmime: 'application/vnd.ms-htmlhelp',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xCA, 0xFE, 0xBA, 0xBE])) {\n\t\t\treturn {\n\t\t\t\text: 'class',\n\t\t\t\tmime: 'application/java-vm',\n\t\t\t};\n\t\t}\n\n\t\t// -- 6-byte signatures --\n\n\t\tif (this.check([0xFD, 0x37, 0x7A, 0x58, 0x5A, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'xz',\n\t\t\t\tmime: 'application/x-xz',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('<?xml ')) {\n\t\t\treturn {\n\t\t\t\text: 'xml',\n\t\t\t\tmime: 'application/xml',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x37, 0x7A, 0xBC, 0xAF, 0x27, 0x1C])) {\n\t\t\treturn {\n\t\t\t\text: '7z',\n\t\t\t\tmime: 'application/x-7z-compressed',\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.check([0x52, 0x61, 0x72, 0x21, 0x1A, 0x7])\n\t\t\t&& (this.buffer[6] === 0x0 || this.buffer[6] === 0x1)\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'rar',\n\t\t\t\tmime: 'application/x-rar-compressed',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('solid ')) {\n\t\t\treturn {\n\t\t\t\text: 'stl',\n\t\t\t\tmime: 'model/stl',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('AC')) {\n\t\t\tconst version = this.buffer.toString('binary', 2, 6);\n\t\t\tif (version.match('^d*') && version >= 1000 && version <= 1050) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'dwg',\n\t\t\t\t\tmime: 'image/vnd.dwg',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (this.checkString('070707')) {\n\t\t\treturn {\n\t\t\t\text: 'cpio',\n\t\t\t\tmime: 'application/x-cpio',\n\t\t\t};\n\t\t}\n\n\t\t// -- 7-byte signatures --\n\n\t\tif (this.checkString('BLENDER')) {\n\t\t\treturn {\n\t\t\t\text: 'blend',\n\t\t\t\tmime: 'application/x-blender',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('!<arch>')) {\n\t\t\tawait tokenizer.ignore(8);\n\t\t\tconst string = await tokenizer.readToken(new Token.StringType(13, 'ascii'));\n\t\t\tif (string === 'debian-binary') {\n\t\t\t\treturn {\n\t\t\t\t\text: 'deb',\n\t\t\t\t\tmime: 'application/x-deb',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\text: 'ar',\n\t\t\t\tmime: 'application/x-unix-archive',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('**ACE', {offset: 7})) {\n\t\t\tawait tokenizer.peekBuffer(this.buffer, {length: 14, mayBeLess: true});\n\t\t\tif (this.checkString('**', {offset: 12})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'ace',\n\t\t\t\t\tmime: 'application/x-ace-compressed',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// -- 8-byte signatures --\n\n\t\tif (this.check([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A])) {\n\t\t\t// APNG format (https://wiki.mozilla.org/APNG_Specification)\n\t\t\t// 1. Find the first IDAT (image data) chunk (49 44 41 54)\n\t\t\t// 2. Check if there is an \"acTL\" chunk before the IDAT one (61 63 54 4C)\n\n\t\t\t// Offset calculated as follows:\n\t\t\t// - 8 bytes: PNG signature\n\t\t\t// - 4 (length) + 4 (chunk type) + 13 (chunk data) + 4 (CRC): IHDR chunk\n\n\t\t\tawait tokenizer.ignore(8); // ignore PNG signature\n\n\t\t\tasync function readChunkHeader() {\n\t\t\t\treturn {\n\t\t\t\t\tlength: await tokenizer.readToken(Token.INT32_BE),\n\t\t\t\t\ttype: await tokenizer.readToken(new Token.StringType(4, 'binary')),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tdo {\n\t\t\t\tconst chunk = await readChunkHeader();\n\t\t\t\tif (chunk.length < 0) {\n\t\t\t\t\treturn; // Invalid chunk length\n\t\t\t\t}\n\n\t\t\t\tswitch (chunk.type) {\n\t\t\t\t\tcase 'IDAT':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'png',\n\t\t\t\t\t\t\tmime: 'image/png',\n\t\t\t\t\t\t};\n\t\t\t\t\tcase 'acTL':\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'apng',\n\t\t\t\t\t\t\tmime: 'image/apng',\n\t\t\t\t\t\t};\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tawait tokenizer.ignore(chunk.length + 4); // Ignore chunk-data + CRC\n\t\t\t\t}\n\t\t\t} while (tokenizer.position + 8 < tokenizer.fileInfo.size);\n\n\t\t\treturn {\n\t\t\t\text: 'png',\n\t\t\t\tmime: 'image/png',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x41, 0x52, 0x52, 0x4F, 0x57, 0x31, 0x00, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'arrow',\n\t\t\t\tmime: 'application/x-apache-arrow',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x67, 0x6C, 0x54, 0x46, 0x02, 0x00, 0x00, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'glb',\n\t\t\t\tmime: 'model/gltf-binary',\n\t\t\t};\n\t\t}\n\n\t\t// `mov` format variants\n\t\tif (\n\t\t\tthis.check([0x66, 0x72, 0x65, 0x65], {offset: 4}) // `free`\n\t\t\t|| this.check([0x6D, 0x64, 0x61, 0x74], {offset: 4}) // `mdat` MJPEG\n\t\t\t|| this.check([0x6D, 0x6F, 0x6F, 0x76], {offset: 4}) // `moov`\n\t\t\t|| this.check([0x77, 0x69, 0x64, 0x65], {offset: 4}) // `wide`\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mov',\n\t\t\t\tmime: 'video/quicktime',\n\t\t\t};\n\t\t}\n\n\t\t// -- 9-byte signatures --\n\n\t\tif (this.check([0x49, 0x49, 0x52, 0x4F, 0x08, 0x00, 0x00, 0x00, 0x18])) {\n\t\t\treturn {\n\t\t\t\text: 'orf',\n\t\t\t\tmime: 'image/x-olympus-orf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('gimp xcf ')) {\n\t\t\treturn {\n\t\t\t\text: 'xcf',\n\t\t\t\tmime: 'image/x-xcf',\n\t\t\t};\n\t\t}\n\n\t\t// -- 12-byte signatures --\n\n\t\tif (this.check([0x49, 0x49, 0x55, 0x00, 0x18, 0x00, 0x00, 0x00, 0x88, 0xE7, 0x74, 0xD8])) {\n\t\t\treturn {\n\t\t\t\text: 'rw2',\n\t\t\t\tmime: 'image/x-panasonic-rw2',\n\t\t\t};\n\t\t}\n\n\t\t// ASF_Header_Object first 80 bytes\n\t\tif (this.check([0x30, 0x26, 0xB2, 0x75, 0x8E, 0x66, 0xCF, 0x11, 0xA6, 0xD9])) {\n\t\t\tasync function readHeader() {\n\t\t\t\tconst guid = Buffer.alloc(16);\n\t\t\t\tawait tokenizer.readBuffer(guid);\n\t\t\t\treturn {\n\t\t\t\t\tid: guid,\n\t\t\t\t\tsize: Number(await tokenizer.readToken(Token.UINT64_LE)),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tawait tokenizer.ignore(30);\n\t\t\t// Search for header should be in first 1KB of file.\n\t\t\twhile (tokenizer.position + 24 < tokenizer.fileInfo.size) {\n\t\t\t\tconst header = await readHeader();\n\t\t\t\tlet payload = header.size - 24;\n\t\t\t\tif (_check(header.id, [0x91, 0x07, 0xDC, 0xB7, 0xB7, 0xA9, 0xCF, 0x11, 0x8E, 0xE6, 0x00, 0xC0, 0x0C, 0x20, 0x53, 0x65])) {\n\t\t\t\t\t// Sync on Stream-Properties-Object (B7DC0791-A9B7-11CF-8EE6-00C00C205365)\n\t\t\t\t\tconst typeId = Buffer.alloc(16);\n\t\t\t\t\tpayload -= await tokenizer.readBuffer(typeId);\n\n\t\t\t\t\tif (_check(typeId, [0x40, 0x9E, 0x69, 0xF8, 0x4D, 0x5B, 0xCF, 0x11, 0xA8, 0xFD, 0x00, 0x80, 0x5F, 0x5C, 0x44, 0x2B])) {\n\t\t\t\t\t\t// Found audio:\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'asf',\n\t\t\t\t\t\t\tmime: 'audio/x-ms-asf',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_check(typeId, [0xC0, 0xEF, 0x19, 0xBC, 0x4D, 0x5B, 0xCF, 0x11, 0xA8, 0xFD, 0x00, 0x80, 0x5F, 0x5C, 0x44, 0x2B])) {\n\t\t\t\t\t\t// Found video:\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'asf',\n\t\t\t\t\t\t\tmime: 'video/x-ms-asf',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tawait tokenizer.ignore(payload);\n\t\t\t}\n\n\t\t\t// Default to ASF generic extension\n\t\t\treturn {\n\t\t\t\text: 'asf',\n\t\t\t\tmime: 'application/vnd.ms-asf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xAB, 0x4B, 0x54, 0x58, 0x20, 0x31, 0x31, 0xBB, 0x0D, 0x0A, 0x1A, 0x0A])) {\n\t\t\treturn {\n\t\t\t\text: 'ktx',\n\t\t\t\tmime: 'image/ktx',\n\t\t\t};\n\t\t}\n\n\t\tif ((this.check([0x7E, 0x10, 0x04]) || this.check([0x7E, 0x18, 0x04])) && this.check([0x30, 0x4D, 0x49, 0x45], {offset: 4})) {\n\t\t\treturn {\n\t\t\t\text: 'mie',\n\t\t\t\tmime: 'application/x-mie',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x27, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], {offset: 2})) {\n\t\t\treturn {\n\t\t\t\text: 'shp',\n\t\t\t\tmime: 'application/x-esri-shape',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xFF, 0x4F, 0xFF, 0x51])) {\n\t\t\treturn {\n\t\t\t\text: 'j2c',\n\t\t\t\tmime: 'image/j2c',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x00, 0x00, 0x00, 0x0C, 0x6A, 0x50, 0x20, 0x20, 0x0D, 0x0A, 0x87, 0x0A])) {\n\t\t\t// JPEG-2000 family\n\n\t\t\tawait tokenizer.ignore(20);\n\t\t\tconst type = await tokenizer.readToken(new Token.StringType(4, 'ascii'));\n\t\t\tswitch (type) {\n\t\t\t\tcase 'jp2 ':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'jp2',\n\t\t\t\t\t\tmime: 'image/jp2',\n\t\t\t\t\t};\n\t\t\t\tcase 'jpx ':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'jpx',\n\t\t\t\t\t\tmime: 'image/jpx',\n\t\t\t\t\t};\n\t\t\t\tcase 'jpm ':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'jpm',\n\t\t\t\t\t\tmime: 'image/jpm',\n\t\t\t\t\t};\n\t\t\t\tcase 'mjp2':\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'mj2',\n\t\t\t\t\t\tmime: 'image/mj2',\n\t\t\t\t\t};\n\t\t\t\tdefault:\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tthis.check([0xFF, 0x0A])\n\t\t\t|| this.check([0x00, 0x00, 0x00, 0x0C, 0x4A, 0x58, 0x4C, 0x20, 0x0D, 0x0A, 0x87, 0x0A])\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'jxl',\n\t\t\t\tmime: 'image/jxl',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xFE, 0xFF])) { // UTF-16-BOM-LE\n\t\t\tif (this.check([0, 60, 0, 63, 0, 120, 0, 109, 0, 108], {offset: 2})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'xml',\n\t\t\t\t\tmime: 'application/xml',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn undefined; // Some unknown text based format\n\t\t}\n\n\t\t// -- Unsafe signatures --\n\n\t\tif (\n\t\t\tthis.check([0x0, 0x0, 0x1, 0xBA])\n\t\t\t|| this.check([0x0, 0x0, 0x1, 0xB3])\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mpg',\n\t\t\t\tmime: 'video/mpeg',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x00, 0x01, 0x00, 0x00, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'ttf',\n\t\t\t\tmime: 'font/ttf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x00, 0x00, 0x01, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'ico',\n\t\t\t\tmime: 'image/x-icon',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x00, 0x00, 0x02, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'cur',\n\t\t\t\tmime: 'image/x-icon',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1])) {\n\t\t\t// Detected Microsoft Compound File Binary File (MS-CFB) Format.\n\t\t\treturn {\n\t\t\t\text: 'cfb',\n\t\t\t\tmime: 'application/x-cfb',\n\t\t\t};\n\t\t}\n\n\t\t// Increase sample size from 12 to 256.\n\t\tawait tokenizer.peekBuffer(this.buffer, {length: Math.min(256, tokenizer.fileInfo.size), mayBeLess: true});\n\n\t\t// -- 15-byte signatures --\n\n\t\tif (this.checkString('BEGIN:')) {\n\t\t\tif (this.checkString('VCARD', {offset: 6})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'vcf',\n\t\t\t\t\tmime: 'text/vcard',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.checkString('VCALENDAR', {offset: 6})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'ics',\n\t\t\t\t\tmime: 'text/calendar',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// `raf` is here just to keep all the raw image detectors together.\n\t\tif (this.checkString('FUJIFILMCCD-RAW')) {\n\t\t\treturn {\n\t\t\t\text: 'raf',\n\t\t\t\tmime: 'image/x-fujifilm-raf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('Extended Module:')) {\n\t\t\treturn {\n\t\t\t\text: 'xm',\n\t\t\t\tmime: 'audio/x-xm',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('Creative Voice File')) {\n\t\t\treturn {\n\t\t\t\text: 'voc',\n\t\t\t\tmime: 'audio/x-voc',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x04, 0x00, 0x00, 0x00]) && this.buffer.length >= 16) { // Rough & quick check Pickle/ASAR\n\t\t\tconst jsonSize = this.buffer.readUInt32LE(12);\n\t\t\tif (jsonSize > 12 && this.buffer.length >= jsonSize + 16) {\n\t\t\t\ttry {\n\t\t\t\t\tconst header = this.buffer.slice(16, jsonSize + 16).toString();\n\t\t\t\t\tconst json = JSON.parse(header);\n\t\t\t\t\t// Check if Pickle is ASAR\n\t\t\t\t\tif (json.files) { // Final check, assuring Pickle/ASAR format\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\text: 'asar',\n\t\t\t\t\t\t\tmime: 'application/x-asar',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} catch {}\n\t\t\t}\n\t\t}\n\n\t\tif (this.check([0x06, 0x0E, 0x2B, 0x34, 0x02, 0x05, 0x01, 0x01, 0x0D, 0x01, 0x02, 0x01, 0x01, 0x02])) {\n\t\t\treturn {\n\t\t\t\text: 'mxf',\n\t\t\t\tmime: 'application/mxf',\n\t\t\t};\n\t\t}\n\n\t\tif (this.checkString('SCRM', {offset: 44})) {\n\t\t\treturn {\n\t\t\t\text: 's3m',\n\t\t\t\tmime: 'audio/x-s3m',\n\t\t\t};\n\t\t}\n\n\t\t// Raw MPEG-2 transport stream (188-byte packets)\n\t\tif (this.check([0x47]) && this.check([0x47], {offset: 188})) {\n\t\t\treturn {\n\t\t\t\text: 'mts',\n\t\t\t\tmime: 'video/mp2t',\n\t\t\t};\n\t\t}\n\n\t\t// Blu-ray Disc Audio-Video (BDAV) MPEG-2 transport stream has 4-byte TP_extra_header before each 188-byte packet\n\t\tif (this.check([0x47], {offset: 4}) && this.check([0x47], {offset: 196})) {\n\t\t\treturn {\n\t\t\t\text: 'mts',\n\t\t\t\tmime: 'video/mp2t',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x42, 0x4F, 0x4F, 0x4B, 0x4D, 0x4F, 0x42, 0x49], {offset: 60})) {\n\t\t\treturn {\n\t\t\t\text: 'mobi',\n\t\t\t\tmime: 'application/x-mobipocket-ebook',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x44, 0x49, 0x43, 0x4D], {offset: 128})) {\n\t\t\treturn {\n\t\t\t\text: 'dcm',\n\t\t\t\tmime: 'application/dicom',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x4C, 0x00, 0x00, 0x00, 0x01, 0x14, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46])) {\n\t\t\treturn {\n\t\t\t\text: 'lnk',\n\t\t\t\tmime: 'application/x.ms.shortcut', // Invented by us\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x62, 0x6F, 0x6F, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x6D, 0x61, 0x72, 0x6B, 0x00, 0x00, 0x00, 0x00])) {\n\t\t\treturn {\n\t\t\t\text: 'alias',\n\t\t\t\tmime: 'application/x.apple.alias', // Invented by us\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tthis.check([0x4C, 0x50], {offset: 34})\n\t\t\t&& (\n\t\t\t\tthis.check([0x00, 0x00, 0x01], {offset: 8})\n\t\t\t\t|| this.check([0x01, 0x00, 0x02], {offset: 8})\n\t\t\t\t|| this.check([0x02, 0x00, 0x02], {offset: 8})\n\t\t\t)\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'eot',\n\t\t\t\tmime: 'application/vnd.ms-fontobject',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0x06, 0x06, 0xED, 0xF5, 0xD8, 0x1D, 0x46, 0xE5, 0xBD, 0x31, 0xEF, 0xE7, 0xFE, 0x74, 0xB7, 0x1D])) {\n\t\t\treturn {\n\t\t\t\text: 'indd',\n\t\t\t\tmime: 'application/x-indesign',\n\t\t\t};\n\t\t}\n\n\t\t// Increase sample size from 256 to 512\n\t\tawait tokenizer.peekBuffer(this.buffer, {length: Math.min(512, tokenizer.fileInfo.size), mayBeLess: true});\n\n\t\t// Requires a buffer size of 512 bytes\n\t\tif (tarHeaderChecksumMatches(this.buffer)) {\n\t\t\treturn {\n\t\t\t\text: 'tar',\n\t\t\t\tmime: 'application/x-tar',\n\t\t\t};\n\t\t}\n\n\t\tif (this.check([0xFF, 0xFE])) { // UTF-16-BOM-BE\n\t\t\tif (this.check([60, 0, 63, 0, 120, 0, 109, 0, 108, 0], {offset: 2})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'xml',\n\t\t\t\t\tmime: 'application/xml',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.check([0xFF, 0x0E, 0x53, 0x00, 0x6B, 0x00, 0x65, 0x00, 0x74, 0x00, 0x63, 0x00, 0x68, 0x00, 0x55, 0x00, 0x70, 0x00, 0x20, 0x00, 0x4D, 0x00, 0x6F, 0x00, 0x64, 0x00, 0x65, 0x00, 0x6C, 0x00], {offset: 2})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'skp',\n\t\t\t\t\tmime: 'application/vnd.sketchup.skp',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn undefined; // Some text based format\n\t\t}\n\n\t\tif (this.checkString('-----BEGIN PGP MESSAGE-----')) {\n\t\t\treturn {\n\t\t\t\text: 'pgp',\n\t\t\t\tmime: 'application/pgp-encrypted',\n\t\t\t};\n\t\t}\n\n\t\t// Check MPEG 1 or 2 Layer 3 header, or 'layer 0' for ADTS (MPEG sync-word 0xFFE)\n\t\tif (this.buffer.length >= 2 && this.check([0xFF, 0xE0], {offset: 0, mask: [0xFF, 0xE0]})) {\n\t\t\tif (this.check([0x10], {offset: 1, mask: [0x16]})) {\n\t\t\t\t// Check for (ADTS) MPEG-2\n\t\t\t\tif (this.check([0x08], {offset: 1, mask: [0x08]})) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'aac',\n\t\t\t\t\t\tmime: 'audio/aac',\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// Must be (ADTS) MPEG-4\n\t\t\t\treturn {\n\t\t\t\t\text: 'aac',\n\t\t\t\t\tmime: 'audio/aac',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// MPEG 1 or 2 Layer 3 header\n\t\t\t// Check for MPEG layer 3\n\t\t\tif (this.check([0x02], {offset: 1, mask: [0x06]})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mp3',\n\t\t\t\t\tmime: 'audio/mpeg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Check for MPEG layer 2\n\t\t\tif (this.check([0x04], {offset: 1, mask: [0x06]})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mp2',\n\t\t\t\t\tmime: 'audio/mpeg',\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Check for MPEG layer 1\n\t\t\tif (this.check([0x06], {offset: 1, mask: [0x06]})) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mp1',\n\t\t\t\t\tmime: 'audio/mpeg',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\tasync readTiffTag(bigEndian) {\n\t\tconst tagId = await this.tokenizer.readToken(bigEndian ? Token.UINT16_BE : Token.UINT16_LE);\n\t\tthis.tokenizer.ignore(10);\n\t\tswitch (tagId) {\n\t\t\tcase 50_341:\n\t\t\t\treturn {\n\t\t\t\t\text: 'arw',\n\t\t\t\t\tmime: 'image/x-sony-arw',\n\t\t\t\t};\n\t\t\tcase 50_706:\n\t\t\t\treturn {\n\t\t\t\t\text: 'dng',\n\t\t\t\t\tmime: 'image/x-adobe-dng',\n\t\t\t\t};\n\t\t\tdefault:\n\t\t}\n\t}\n\n\tasync readTiffIFD(bigEndian) {\n\t\tconst numberOfTags = await this.tokenizer.readToken(bigEndian ? Token.UINT16_BE : Token.UINT16_LE);\n\t\tfor (let n = 0; n < numberOfTags; ++n) {\n\t\t\tconst fileType = await this.readTiffTag(bigEndian);\n\t\t\tif (fileType) {\n\t\t\t\treturn fileType;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync readTiffHeader(bigEndian) {\n\t\tconst version = (bigEndian ? Token.UINT16_BE : Token.UINT16_LE).get(this.buffer, 2);\n\t\tconst ifdOffset = (bigEndian ? Token.UINT32_BE : Token.UINT32_LE).get(this.buffer, 4);\n\n\t\tif (version === 42) {\n\t\t\t// TIFF file header\n\t\t\tif (ifdOffset >= 6) {\n\t\t\t\tif (this.checkString('CR', {offset: 8})) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'cr2',\n\t\t\t\t\t\tmime: 'image/x-canon-cr2',\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (ifdOffset >= 8 && (this.check([0x1C, 0x00, 0xFE, 0x00], {offset: 8}) || this.check([0x1F, 0x00, 0x0B, 0x00], {offset: 8}))) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'nef',\n\t\t\t\t\t\tmime: 'image/x-nikon-nef',\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait this.tokenizer.ignore(ifdOffset);\n\t\t\tconst fileType = await this.readTiffIFD(bigEndian);\n\t\t\treturn fileType ?? {\n\t\t\t\text: 'tif',\n\t\t\t\tmime: 'image/tiff',\n\t\t\t};\n\t\t}\n\n\t\tif (version === 43) {\t// Big TIFF file header\n\t\t\treturn {\n\t\t\t\text: 'tif',\n\t\t\t\tmime: 'image/tiff',\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport async function fileTypeStream(readableStream, {sampleSize = minimumBytes} = {}) {\n\tconst {default: stream} = await import('node:stream');\n\n\treturn new Promise((resolve, reject) => {\n\t\treadableStream.on('error', reject);\n\n\t\treadableStream.once('readable', () => {\n\t\t\t(async () => {\n\t\t\t\ttry {\n\t\t\t\t\t// Set up output stream\n\t\t\t\t\tconst pass = new stream.PassThrough();\n\t\t\t\t\tconst outputStream = stream.pipeline ? stream.pipeline(readableStream, pass, () => {}) : readableStream.pipe(pass);\n\n\t\t\t\t\t// Read the input stream and detect the filetype\n\t\t\t\t\tconst chunk = readableStream.read(sampleSize) ?? readableStream.read() ?? Buffer.alloc(0);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst fileType = await fileTypeFromBuffer(chunk);\n\t\t\t\t\t\tpass.fileType = fileType;\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tif (error instanceof strtok3.EndOfStreamError) {\n\t\t\t\t\t\t\tpass.fileType = undefined;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(outputStream);\n\t\t\t\t} catch (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t}\n\t\t\t})();\n\t\t});\n\t});\n}\n\nexport const supportedExtensions = new Set(extensions);\nexport const supportedMimeTypes = new Set(mimeTypes);\n","export const defaultJsonSerializer = {\n    parse: JSON.parse,\n    stringify: JSON.stringify,\n};\n//# sourceMappingURL=defaultJsonSerializer.js.map","import { defaultJsonSerializer } from './defaultJsonSerializer.js';\nimport { extractFiles, isExtractableFile } from 'extract-files';\nimport FormDataNode from 'form-data';\n/**\n * Duck type if NodeJS stream\n * https://github.com/sindresorhus/is-stream/blob/3750505b0727f6df54324784fe369365ef78841e/index.js#L3\n */\nconst isExtractableFileEnhanced = (value) => isExtractableFile(value) ||\n    (value !== null && typeof value === `object` && typeof value.pipe === `function`);\n/**\n * Returns Multipart Form if body contains files\n * (https://github.com/jaydenseric/graphql-multipart-request-spec)\n * Otherwise returns JSON\n */\nconst createRequestBody = (query, variables, operationName, jsonSerializer = defaultJsonSerializer) => {\n    const { clone, files } = extractFiles({ query, variables, operationName }, ``, isExtractableFileEnhanced);\n    if (files.size === 0) {\n        if (!Array.isArray(query)) {\n            return jsonSerializer.stringify(clone);\n        }\n        if (typeof variables !== `undefined` && !Array.isArray(variables)) {\n            throw new Error(`Cannot create request body with given variable type, array expected`);\n        }\n        // Batch support\n        const payload = query.reduce((accu, currentQuery, index) => {\n            accu.push({ query: currentQuery, variables: variables ? variables[index] : undefined });\n            return accu;\n        }, []);\n        return jsonSerializer.stringify(payload);\n    }\n    const Form = typeof FormData === `undefined` ? FormDataNode : FormData;\n    const form = new Form();\n    form.append(`operations`, jsonSerializer.stringify(clone));\n    const map = {};\n    let i = 0;\n    files.forEach((paths) => {\n        map[++i] = paths;\n    });\n    form.append(`map`, jsonSerializer.stringify(map));\n    i = 0;\n    files.forEach((paths, file) => {\n        form.append(`${++i}`, file);\n    });\n    return form;\n};\nexport default createRequestBody;\n//# sourceMappingURL=createRequestBody.js.map","import { parse, print } from 'graphql';\n/**\n * helpers\n */\nconst extractOperationName = (document) => {\n    let operationName = undefined;\n    const operationDefinitions = document.definitions.filter((definition) => definition.kind === `OperationDefinition`);\n    if (operationDefinitions.length === 1) {\n        operationName = operationDefinitions[0]?.name?.value;\n    }\n    return operationName;\n};\nexport const resolveRequestDocument = (document) => {\n    if (typeof document === `string`) {\n        let operationName = undefined;\n        try {\n            const parsedDocument = parse(document);\n            operationName = extractOperationName(parsedDocument);\n        }\n        catch (err) {\n            // Failed parsing the document, the operationName will be undefined\n        }\n        return { query: document, operationName };\n    }\n    const operationName = extractOperationName(document);\n    return { query: print(document), operationName };\n};\n//# sourceMappingURL=resolveRequestDocument.js.map","export class ClientError extends Error {\n    constructor(response, request) {\n        const message = `${ClientError.extractMessage(response)}: ${JSON.stringify({\n            response,\n            request,\n        })}`;\n        super(message);\n        Object.setPrototypeOf(this, ClientError.prototype);\n        this.response = response;\n        this.request = request;\n        // this is needed as Safari doesn't support .captureStackTrace\n        if (typeof Error.captureStackTrace === `function`) {\n            Error.captureStackTrace(this, ClientError);\n        }\n    }\n    static extractMessage(response) {\n        return response.errors?.[0]?.message ?? `GraphQL Error (Code: ${response.status})`;\n    }\n}\n//# sourceMappingURL=types.js.map","import createRequestBody from './createRequestBody.js';\nimport { defaultJsonSerializer } from './defaultJsonSerializer.js';\nimport { HeadersInstanceToPlainObject, uppercase } from './helpers.js';\nimport { parseBatchRequestArgs, parseRawRequestArgs, parseRawRequestExtendedArgs, parseRequestArgs, parseRequestExtendedArgs, } from './parseArgs.js';\nimport { resolveRequestDocument } from './resolveRequestDocument.js';\nimport { ClientError, } from './types.js';\nimport crossFetch, * as CrossFetch from 'cross-fetch';\nexport { ClientError, };\n/**\n * Convert the given headers configuration into a plain object.\n */\nconst resolveHeaders = (headers) => {\n    let oHeaders = {};\n    if (headers) {\n        if ((typeof Headers !== `undefined` && headers instanceof Headers) ||\n            (CrossFetch && CrossFetch.Headers && headers instanceof CrossFetch.Headers)) {\n            oHeaders = HeadersInstanceToPlainObject(headers);\n        }\n        else if (Array.isArray(headers)) {\n            headers.forEach(([name, value]) => {\n                if (name && value !== undefined) {\n                    oHeaders[name] = value;\n                }\n            });\n        }\n        else {\n            oHeaders = headers;\n        }\n    }\n    return oHeaders;\n};\n/**\n * Clean a GraphQL document to send it via a GET query\n */\nconst cleanQuery = (str) => str.replace(/([\\s,]|#[^\\n\\r]+)+/g, ` `).trim();\n/**\n * Create query string for GraphQL request\n */\nconst buildRequestConfig = (params) => {\n    if (!Array.isArray(params.query)) {\n        const params_ = params;\n        const search = [`query=${encodeURIComponent(cleanQuery(params_.query))}`];\n        if (params.variables) {\n            search.push(`variables=${encodeURIComponent(params_.jsonSerializer.stringify(params_.variables))}`);\n        }\n        if (params_.operationName) {\n            search.push(`operationName=${encodeURIComponent(params_.operationName)}`);\n        }\n        return search.join(`&`);\n    }\n    if (typeof params.variables !== `undefined` && !Array.isArray(params.variables)) {\n        throw new Error(`Cannot create query with given variable type, array expected`);\n    }\n    // Batch support\n    const params_ = params;\n    const payload = params.query.reduce((acc, currentQuery, index) => {\n        acc.push({\n            query: cleanQuery(currentQuery),\n            variables: params_.variables ? params_.jsonSerializer.stringify(params_.variables[index]) : undefined,\n        });\n        return acc;\n    }, []);\n    return `query=${encodeURIComponent(params_.jsonSerializer.stringify(payload))}`;\n};\nconst createHttpMethodFetcher = (method) => async (params) => {\n    const { url, query, variables, operationName, fetch, fetchOptions, middleware } = params;\n    const headers = { ...params.headers };\n    let queryParams = ``;\n    let body = undefined;\n    if (method === `POST`) {\n        body = createRequestBody(query, variables, operationName, fetchOptions.jsonSerializer);\n        if (typeof body === `string`) {\n            // @ts-expect-error todo\n            headers[`Content-Type`] = `application/json`;\n        }\n    }\n    else {\n        // @ts-expect-error todo needs ADT for TS to understand the different states\n        queryParams = buildRequestConfig({\n            query,\n            variables,\n            operationName,\n            jsonSerializer: fetchOptions.jsonSerializer ?? defaultJsonSerializer,\n        });\n    }\n    const init = {\n        method,\n        headers,\n        body,\n        ...fetchOptions,\n    };\n    let urlResolved = url;\n    let initResolved = init;\n    if (middleware) {\n        const result = await Promise.resolve(middleware({ ...init, url, operationName, variables }));\n        const { url: urlNew, ...initNew } = result;\n        urlResolved = urlNew;\n        initResolved = initNew;\n    }\n    if (queryParams) {\n        urlResolved = `${urlResolved}?${queryParams}`;\n    }\n    return await fetch(urlResolved, initResolved);\n};\n/**\n * GraphQL Client.\n */\nexport class GraphQLClient {\n    constructor(url, requestConfig = {}) {\n        this.url = url;\n        this.requestConfig = requestConfig;\n        /**\n         * Send a GraphQL query to the server.\n         */\n        this.rawRequest = async (...args) => {\n            const [queryOrOptions, variables, requestHeaders] = args;\n            const rawRequestOptions = parseRawRequestArgs(queryOrOptions, variables, requestHeaders);\n            const { headers, fetch = crossFetch, method = `POST`, requestMiddleware, responseMiddleware, ...fetchOptions } = this.requestConfig;\n            const { url } = this;\n            if (rawRequestOptions.signal !== undefined) {\n                fetchOptions.signal = rawRequestOptions.signal;\n            }\n            const { operationName } = resolveRequestDocument(rawRequestOptions.query);\n            return makeRequest({\n                url,\n                query: rawRequestOptions.query,\n                variables: rawRequestOptions.variables,\n                headers: {\n                    ...resolveHeaders(callOrIdentity(headers)),\n                    ...resolveHeaders(rawRequestOptions.requestHeaders),\n                },\n                operationName,\n                fetch,\n                method,\n                fetchOptions,\n                middleware: requestMiddleware,\n            })\n                .then((response) => {\n                if (responseMiddleware) {\n                    responseMiddleware(response);\n                }\n                return response;\n            })\n                .catch((error) => {\n                if (responseMiddleware) {\n                    responseMiddleware(error);\n                }\n                throw error;\n            });\n        };\n    }\n    async request(documentOrOptions, ...variablesAndRequestHeaders) {\n        const [variables, requestHeaders] = variablesAndRequestHeaders;\n        const requestOptions = parseRequestArgs(documentOrOptions, variables, requestHeaders);\n        const { headers, fetch = crossFetch, method = `POST`, requestMiddleware, responseMiddleware, ...fetchOptions } = this.requestConfig;\n        const { url } = this;\n        if (requestOptions.signal !== undefined) {\n            fetchOptions.signal = requestOptions.signal;\n        }\n        const { query, operationName } = resolveRequestDocument(requestOptions.document);\n        return makeRequest({\n            url,\n            query,\n            variables: requestOptions.variables,\n            headers: {\n                ...resolveHeaders(callOrIdentity(headers)),\n                ...resolveHeaders(requestOptions.requestHeaders),\n            },\n            operationName,\n            fetch,\n            method,\n            fetchOptions,\n            middleware: requestMiddleware,\n        })\n            .then((response) => {\n            if (responseMiddleware) {\n                responseMiddleware(response);\n            }\n            return response.data;\n        })\n            .catch((error) => {\n            if (responseMiddleware) {\n                responseMiddleware(error);\n            }\n            throw error;\n        });\n    }\n    // prettier-ignore\n    batchRequests(documentsOrOptions, requestHeaders) {\n        const batchRequestOptions = parseBatchRequestArgs(documentsOrOptions, requestHeaders);\n        const { headers, ...fetchOptions } = this.requestConfig;\n        if (batchRequestOptions.signal !== undefined) {\n            fetchOptions.signal = batchRequestOptions.signal;\n        }\n        const queries = batchRequestOptions.documents.map(({ document }) => resolveRequestDocument(document).query);\n        const variables = batchRequestOptions.documents.map(({ variables }) => variables);\n        return makeRequest({\n            url: this.url,\n            query: queries,\n            // @ts-expect-error TODO reconcile batch variables into system.\n            variables,\n            headers: {\n                ...resolveHeaders(callOrIdentity(headers)),\n                ...resolveHeaders(batchRequestOptions.requestHeaders),\n            },\n            operationName: undefined,\n            fetch: this.requestConfig.fetch ?? crossFetch,\n            method: this.requestConfig.method || `POST`,\n            fetchOptions,\n            middleware: this.requestConfig.requestMiddleware,\n        })\n            .then((response) => {\n            if (this.requestConfig.responseMiddleware) {\n                this.requestConfig.responseMiddleware(response);\n            }\n            return response.data;\n        })\n            .catch((error) => {\n            if (this.requestConfig.responseMiddleware) {\n                this.requestConfig.responseMiddleware(error);\n            }\n            throw error;\n        });\n    }\n    setHeaders(headers) {\n        this.requestConfig.headers = headers;\n        return this;\n    }\n    /**\n     * Attach a header to the client. All subsequent requests will have this header.\n     */\n    setHeader(key, value) {\n        const { headers } = this.requestConfig;\n        if (headers) {\n            // todo what if headers is in nested array form... ?\n            //@ts-ignore\n            headers[key] = value;\n        }\n        else {\n            this.requestConfig.headers = { [key]: value };\n        }\n        return this;\n    }\n    /**\n     * Change the client endpoint. All subsequent requests will send to this endpoint.\n     */\n    setEndpoint(value) {\n        this.url = value;\n        return this;\n    }\n}\nconst makeRequest = async (params) => {\n    const { query, variables, fetchOptions } = params;\n    const fetcher = createHttpMethodFetcher(uppercase(params.method ?? `post`));\n    const isBatchingQuery = Array.isArray(params.query);\n    const response = await fetcher(params);\n    const result = await getResult(response, fetchOptions.jsonSerializer ?? defaultJsonSerializer);\n    const successfullyReceivedData = Array.isArray(result)\n        ? !result.some(({ data }) => !data)\n        : Boolean(result.data);\n    const successfullyPassedErrorPolicy = Array.isArray(result) ||\n        !result.errors ||\n        (Array.isArray(result.errors) && !result.errors.length) ||\n        fetchOptions.errorPolicy === `all` ||\n        fetchOptions.errorPolicy === `ignore`;\n    if (response.ok && successfullyPassedErrorPolicy && successfullyReceivedData) {\n        // @ts-expect-error TODO fixme\n        const { errors, ...rest } = Array.isArray(result) ? result : result;\n        const data = fetchOptions.errorPolicy === `ignore` ? rest : result;\n        const dataEnvelope = isBatchingQuery ? { data } : data;\n        // @ts-expect-error TODO\n        return {\n            ...dataEnvelope,\n            headers: response.headers,\n            status: response.status,\n        };\n    }\n    else {\n        const errorResult = typeof result === `string`\n            ? {\n                error: result,\n            }\n            : result;\n        throw new ClientError(\n        // @ts-expect-error TODO\n        { ...errorResult, status: response.status, headers: response.headers }, { query, variables });\n    }\n};\n/**\n * Send a GraphQL Query to the GraphQL server for execution.\n */\nexport const rawRequest = async (...args) => {\n    const [urlOrOptions, query, ...variablesAndRequestHeaders] = args;\n    const requestOptions = parseRawRequestExtendedArgs(urlOrOptions, query, ...variablesAndRequestHeaders);\n    const client = new GraphQLClient(requestOptions.url);\n    return client.rawRequest({\n        ...requestOptions,\n    });\n};\nexport async function request(urlOrOptions, \n// @ts-ignore\ndocument, ...variablesAndRequestHeaders) {\n    // @ts-ignore\n    const requestOptions = parseRequestExtendedArgs(urlOrOptions, document, ...variablesAndRequestHeaders);\n    const client = new GraphQLClient(requestOptions.url);\n    return client.request({\n        ...requestOptions,\n    });\n}\n/**\n * Send a batch of GraphQL Document to the GraphQL server for execution.\n *\n * @example\n *\n * ```ts\n * // You can pass a raw string\n *\n * await batchRequests('https://foo.bar/graphql', [\n * {\n *  query: `\n *   {\n *     query {\n *       users\n *     }\n *   }`\n * },\n * {\n *   query: `\n *   {\n *     query {\n *       users\n *     }\n *   }`\n * }])\n *\n * // You can also pass a GraphQL DocumentNode as query. Convenient if you\n * // are using graphql-tag package.\n *\n * import gql from 'graphql-tag'\n *\n * await batchRequests('https://foo.bar/graphql', [{ query: gql`...` }])\n * ```\n */\nexport const batchRequests = async (...args) => {\n    const params = parseBatchRequestsArgsExtended(args);\n    const client = new GraphQLClient(params.url);\n    return client.batchRequests(params);\n};\nconst parseBatchRequestsArgsExtended = (args) => {\n    if (args.length === 1) {\n        return args[0];\n    }\n    else {\n        return {\n            url: args[0],\n            documents: args[1],\n            requestHeaders: args[2],\n            signal: undefined,\n        };\n    }\n};\nexport default request;\nconst getResult = async (response, jsonSerializer) => {\n    let contentType;\n    response.headers.forEach((value, key) => {\n        if (key.toLowerCase() === `content-type`) {\n            contentType = value;\n        }\n    });\n    if (contentType &&\n        (contentType.toLowerCase().startsWith(`application/json`) ||\n            contentType.toLowerCase().startsWith(`application/graphql+json`) ||\n            contentType.toLowerCase().startsWith(`application/graphql-response+json`))) {\n        return jsonSerializer.parse(await response.text());\n    }\n    else {\n        return response.text();\n    }\n};\nconst callOrIdentity = (value) => {\n    return typeof value === `function` ? value() : value;\n};\n/**\n * Convenience passthrough template tag to get the benefits of tooling for the gql template tag. This does not actually parse the input into a GraphQL DocumentNode like graphql-tag package does. It just returns the string with any variables given interpolated. Can save you a bit of performance and having to install another package.\n *\n * @example\n *\n * import { gql } from 'graphql-request'\n *\n * await request('https://foo.bar/graphql', gql`...`)\n *\n * @remarks\n *\n * Several tools in the Node GraphQL ecosystem are hardcoded to specially treat any template tag named \"gql\". For example see this prettier issue: https://github.com/prettier/prettier/issues/4360. Using this template tag has no runtime effect beyond variable interpolation.\n */\nexport const gql = (chunks, ...variables) => {\n    return chunks.reduce((accumulator, chunk, index) => `${accumulator}${chunk}${index in variables ? variables[index] : ``}`, ``);\n};\nexport { GraphQLWebSocketClient } from './graphql-ws.js';\nexport { resolveRequestDocument } from './resolveRequestDocument.js';\n//# sourceMappingURL=index.js.map","export const uppercase = (str) => str.toUpperCase();\n/**\n * Convert Headers instance into regular object\n */\nexport const HeadersInstanceToPlainObject = (headers) => {\n    const o = {};\n    headers.forEach((v, k) => {\n        o[k] = v;\n    });\n    return o;\n};\n//# sourceMappingURL=helpers.js.map","export const parseRequestArgs = (documentOrOptions, variables, requestHeaders) => {\n    return documentOrOptions.document\n        ? documentOrOptions\n        : {\n            document: documentOrOptions,\n            variables: variables,\n            requestHeaders: requestHeaders,\n            signal: undefined,\n        };\n};\nexport const parseRawRequestArgs = (queryOrOptions, variables, requestHeaders) => {\n    return queryOrOptions.query\n        ? queryOrOptions\n        : {\n            query: queryOrOptions,\n            variables: variables,\n            requestHeaders: requestHeaders,\n            signal: undefined,\n        };\n};\nexport const parseBatchRequestArgs = (documentsOrOptions, requestHeaders) => {\n    return documentsOrOptions.documents\n        ? documentsOrOptions\n        : {\n            documents: documentsOrOptions,\n            requestHeaders: requestHeaders,\n            signal: undefined,\n        };\n};\nexport const parseRequestExtendedArgs = (urlOrOptions, document, ...variablesAndRequestHeaders) => {\n    const [variables, requestHeaders] = variablesAndRequestHeaders;\n    return urlOrOptions.document\n        ? urlOrOptions\n        : {\n            url: urlOrOptions,\n            document: document,\n            variables,\n            requestHeaders,\n            signal: undefined,\n        };\n};\nexport const parseRawRequestExtendedArgs = (urlOrOptions, query, ...variablesAndRequestHeaders) => {\n    const [variables, requestHeaders] = variablesAndRequestHeaders;\n    return urlOrOptions.query\n        ? urlOrOptions\n        : {\n            url: urlOrOptions,\n            query: query,\n            variables,\n            requestHeaders,\n            signal: undefined,\n        };\n};\n//# sourceMappingURL=parseArgs.js.map","// @ts-expect-error\nimport SparseArray from 'sparse-array';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nexport class Bucket {\n    constructor(options, parent, posAtParent = 0) {\n        this._options = options;\n        this._popCount = 0;\n        this._parent = parent;\n        this._posAtParent = posAtParent;\n        this._children = new SparseArray();\n        this.key = null;\n    }\n    async put(key, value) {\n        const place = await this._findNewBucketAndPos(key);\n        await place.bucket._putAt(place, key, value);\n    }\n    async get(key) {\n        const child = await this._findChild(key);\n        if (child != null) {\n            return child.value;\n        }\n    }\n    async del(key) {\n        const place = await this._findPlace(key);\n        const child = place.bucket._at(place.pos);\n        if (child != null && child.key === key) {\n            place.bucket._delAt(place.pos);\n        }\n    }\n    leafCount() {\n        const children = this._children.compactArray();\n        return children.reduce((acc, child) => {\n            if (child instanceof Bucket) {\n                return acc + child.leafCount();\n            }\n            return acc + 1;\n        }, 0);\n    }\n    childrenCount() {\n        return this._children.length;\n    }\n    onlyChild() {\n        return this._children.get(0);\n    }\n    *eachLeafSeries() {\n        const children = this._children.compactArray();\n        for (const child of children) {\n            if (child instanceof Bucket) {\n                yield* child.eachLeafSeries();\n            }\n            else {\n                yield child;\n            }\n        }\n    }\n    serialize(map, reduce) {\n        const acc = [];\n        // serialize to a custom non-sparse representation\n        return reduce(this._children.reduce((acc, child, index) => {\n            if (child != null) {\n                if (child instanceof Bucket) {\n                    acc.push(child.serialize(map, reduce));\n                }\n                else {\n                    acc.push(map(child, index));\n                }\n            }\n            return acc;\n        }, acc));\n    }\n    async asyncTransform(asyncMap, asyncReduce) {\n        return await asyncTransformBucket(this, asyncMap, asyncReduce);\n    }\n    toJSON() {\n        return this.serialize(mapNode, reduceNodes);\n    }\n    prettyPrint() {\n        return JSON.stringify(this.toJSON(), null, '  ');\n    }\n    tableSize() {\n        return Math.pow(2, this._options.bits);\n    }\n    async _findChild(key) {\n        const result = await this._findPlace(key);\n        const child = result.bucket._at(result.pos);\n        if (child instanceof Bucket) {\n            // should not be possible, this._findPlace should always\n            // return a location for a child, not a bucket\n            return undefined;\n        }\n        if (child != null && child.key === key) {\n            return child;\n        }\n    }\n    async _findPlace(key) {\n        const hashValue = this._options.hash(typeof key === 'string' ? uint8ArrayFromString(key) : key);\n        const index = await hashValue.take(this._options.bits);\n        const child = this._children.get(index);\n        if (child instanceof Bucket) {\n            return await child._findPlace(hashValue);\n        }\n        return {\n            bucket: this,\n            pos: index,\n            hash: hashValue,\n            existingChild: child\n        };\n    }\n    async _findNewBucketAndPos(key) {\n        const place = await this._findPlace(key);\n        if ((place.existingChild != null) && place.existingChild.key !== key) {\n            // conflict\n            const bucket = new Bucket(this._options, place.bucket, place.pos);\n            place.bucket._putObjectAt(place.pos, bucket);\n            // put the previous value\n            const newPlace = await bucket._findPlace(place.existingChild.hash);\n            newPlace.bucket._putAt(newPlace, place.existingChild.key, place.existingChild.value);\n            return await bucket._findNewBucketAndPos(place.hash);\n        }\n        // no conflict, we found the place\n        return place;\n    }\n    _putAt(place, key, value) {\n        this._putObjectAt(place.pos, {\n            key: key,\n            value: value,\n            hash: place.hash\n        });\n    }\n    _putObjectAt(pos, object) {\n        if (this._children.get(pos) == null) {\n            this._popCount++;\n        }\n        this._children.set(pos, object);\n    }\n    _delAt(pos) {\n        if (pos === -1) {\n            throw new Error('Invalid position');\n        }\n        if (this._children.get(pos) != null) {\n            this._popCount--;\n        }\n        this._children.unset(pos);\n        this._level();\n    }\n    _level() {\n        if (this._parent != null && this._popCount <= 1) {\n            if (this._popCount === 1) {\n                // remove myself from parent, replacing me with my only child\n                const onlyChild = this._children.find(exists);\n                if ((onlyChild != null) && !(onlyChild instanceof Bucket)) {\n                    const hash = onlyChild.hash;\n                    hash.untake(this._options.bits);\n                    const place = {\n                        pos: this._posAtParent,\n                        hash: hash,\n                        bucket: this._parent\n                    };\n                    this._parent._putAt(place, onlyChild.key, onlyChild.value);\n                }\n            }\n            else {\n                this._parent._delAt(this._posAtParent);\n            }\n        }\n    }\n    _at(index) {\n        return this._children.get(index);\n    }\n}\nfunction exists(o) {\n    return Boolean(o);\n}\nfunction mapNode(node, _) {\n    return node.key;\n}\nfunction reduceNodes(nodes) {\n    return nodes;\n}\nasync function asyncTransformBucket(bucket, asyncMap, asyncReduce) {\n    const output = [];\n    for (const child of bucket._children.compactArray()) {\n        if (child instanceof Bucket) {\n            await asyncTransformBucket(child, asyncMap, asyncReduce);\n        }\n        else {\n            const mappedChildren = await asyncMap(child);\n            output.push({\n                bitField: bucket._children.bitField(),\n                children: mappedChildren\n            });\n        }\n    }\n    return await asyncReduce(output);\n}\n//# sourceMappingURL=bucket.js.map","const START_MASKS = [\n    0b11111111,\n    0b11111110,\n    0b11111100,\n    0b11111000,\n    0b11110000,\n    0b11100000,\n    0b11000000,\n    0b10000000\n];\nconst STOP_MASKS = [\n    0b00000001,\n    0b00000011,\n    0b00000111,\n    0b00001111,\n    0b00011111,\n    0b00111111,\n    0b01111111,\n    0b11111111\n];\nexport class ConsumableBuffer {\n    constructor(value) {\n        this._value = value;\n        this._currentBytePos = value.length - 1;\n        this._currentBitPos = 7;\n    }\n    availableBits() {\n        return this._currentBitPos + 1 + this._currentBytePos * 8;\n    }\n    totalBits() {\n        return this._value.length * 8;\n    }\n    take(bits) {\n        let pendingBits = bits;\n        let result = 0;\n        while (pendingBits > 0 && this._haveBits()) {\n            const byte = this._value[this._currentBytePos];\n            const availableBits = this._currentBitPos + 1;\n            const taking = Math.min(availableBits, pendingBits);\n            const value = byteBitsToInt(byte, availableBits - taking, taking);\n            result = (result << taking) + value;\n            pendingBits -= taking;\n            this._currentBitPos -= taking;\n            if (this._currentBitPos < 0) {\n                this._currentBitPos = 7;\n                this._currentBytePos--;\n            }\n        }\n        return result;\n    }\n    untake(bits) {\n        this._currentBitPos += bits;\n        while (this._currentBitPos > 7) {\n            this._currentBitPos -= 8;\n            this._currentBytePos += 1;\n        }\n    }\n    _haveBits() {\n        return this._currentBytePos >= 0;\n    }\n}\nfunction byteBitsToInt(byte, start, length) {\n    const mask = maskFor(start, length);\n    return (byte & mask) >>> start;\n}\nfunction maskFor(start, length) {\n    return START_MASKS[start] & STOP_MASKS[Math.min(length + start - 1, 7)];\n}\n//# sourceMappingURL=consumable-buffer.js.map","import { ConsumableBuffer } from './consumable-buffer.js';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nexport function wrapHash(hashFn) {\n    function hashing(value) {\n        if (value instanceof InfiniteHash) {\n            // already a hash. return it\n            return value;\n        }\n        else {\n            return new InfiniteHash(value, hashFn);\n        }\n    }\n    return hashing;\n}\nexport class InfiniteHash {\n    constructor(value, hashFn) {\n        if (!(value instanceof Uint8Array)) {\n            throw new Error('can only hash Uint8Arrays');\n        }\n        this._value = value;\n        this._hashFn = hashFn;\n        this._depth = -1;\n        this._availableBits = 0;\n        this._currentBufferIndex = 0;\n        this._buffers = [];\n    }\n    async take(bits) {\n        let pendingBits = bits;\n        while (this._availableBits < pendingBits) {\n            await this._produceMoreBits();\n        }\n        let result = 0;\n        while (pendingBits > 0) {\n            const hash = this._buffers[this._currentBufferIndex];\n            const available = Math.min(hash.availableBits(), pendingBits);\n            const took = hash.take(available);\n            result = (result << available) + took;\n            pendingBits -= available;\n            this._availableBits -= available;\n            if (hash.availableBits() === 0) {\n                this._currentBufferIndex++;\n            }\n        }\n        return result;\n    }\n    untake(bits) {\n        let pendingBits = bits;\n        while (pendingBits > 0) {\n            const hash = this._buffers[this._currentBufferIndex];\n            const availableForUntake = Math.min(hash.totalBits() - hash.availableBits(), pendingBits);\n            hash.untake(availableForUntake);\n            pendingBits -= availableForUntake;\n            this._availableBits += availableForUntake;\n            if (this._currentBufferIndex > 0 && hash.totalBits() === hash.availableBits()) {\n                this._depth--;\n                this._currentBufferIndex--;\n            }\n        }\n    }\n    async _produceMoreBits() {\n        this._depth++;\n        const value = this._depth > 0 ? uint8ArrayConcat([this._value, Uint8Array.from([this._depth])]) : this._value;\n        const hashValue = await this._hashFn(value);\n        const buffer = new ConsumableBuffer(hashValue);\n        this._buffers.push(buffer);\n        this._availableBits += buffer.availableBits();\n    }\n}\n//# sourceMappingURL=consumable-hash.js.map","import { Bucket } from './bucket.js';\nimport { wrapHash } from './consumable-hash.js';\nexport function createHAMT(options) {\n    if (options == null || options.hashFn == null) {\n        throw new Error('please define an options.hashFn');\n    }\n    const bucketOptions = {\n        bits: options.bits ?? 8,\n        hash: wrapHash(options.hashFn)\n    };\n    return new Bucket(bucketOptions);\n}\nexport { Bucket };\n//# sourceMappingURL=index.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","function isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction drain(source) {\n    if (isAsyncIterable(source)) {\n        return (async () => {\n            for await (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n        })();\n    }\n    else {\n        for (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n    }\n}\nexport default drain;\n//# sourceMappingURL=index.js.map","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code = 0x0\nconst name = 'identity'\n\n/** @type {(input:Uint8Array) => Uint8Array} */\nconst encode = coerce\n\n/**\n * @param {Uint8Array} input\n * @returns {Digest.Digest<typeof code, number>}\n */\nconst digest = (input) => Digest.create(code, encode(input))\n\nexport const identity = { code, name, encode, digest }\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","/* global crypto */\n\nimport { from } from './hasher.js'\n\n/**\n * @param {AlgorithmIdentifier} name\n */\nconst sha = name =>\n  /**\n   * @param {Uint8Array} data\n   */\n  async data => new Uint8Array(await crypto.subtle.digest(name, data))\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n","// This is an unfortunate replacement for @sindresorhus/is that we need to\n// re-implement for performance purposes. In particular the is.observable()\n// check is expensive, and unnecessary for our purposes. The values returned\n// are compatible with @sindresorhus/is, however.\n\nconst typeofs = [\n  'string',\n  'number',\n  'bigint',\n  'symbol'\n]\n\nconst objectTypeNames = [\n  'Function',\n  'Generator',\n  'AsyncGenerator',\n  'GeneratorFunction',\n  'AsyncGeneratorFunction',\n  'AsyncFunction',\n  'Observable',\n  'Array',\n  'Buffer',\n  'Object',\n  'RegExp',\n  'Date',\n  'Error',\n  'Map',\n  'Set',\n  'WeakMap',\n  'WeakSet',\n  'ArrayBuffer',\n  'SharedArrayBuffer',\n  'DataView',\n  'Promise',\n  'URL',\n  'HTMLElement',\n  'Int8Array',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Int16Array',\n  'Uint16Array',\n  'Int32Array',\n  'Uint32Array',\n  'Float32Array',\n  'Float64Array',\n  'BigInt64Array',\n  'BigUint64Array'\n]\n\n/**\n * @param {any} value\n * @returns {string}\n */\nexport function is (value) {\n  if (value === null) {\n    return 'null'\n  }\n  if (value === undefined) {\n    return 'undefined'\n  }\n  if (value === true || value === false) {\n    return 'boolean'\n  }\n  const typeOf = typeof value\n  if (typeofs.includes(typeOf)) {\n    return typeOf\n  }\n  /* c8 ignore next 4 */\n  // not going to bother testing this, it's not going to be valid anyway\n  if (typeOf === 'function') {\n    return 'Function'\n  }\n  if (Array.isArray(value)) {\n    return 'Array'\n  }\n  if (isBuffer(value)) {\n    return 'Buffer'\n  }\n  const objectType = getObjectType(value)\n  if (objectType) {\n    return objectType\n  }\n  /* c8 ignore next */\n  return 'Object'\n}\n\n/**\n * @param {any} value\n * @returns {boolean}\n */\nfunction isBuffer (value) {\n  return value && value.constructor && value.constructor.isBuffer && value.constructor.isBuffer.call(null, value)\n}\n\n/**\n * @param {any} value\n * @returns {string|undefined}\n */\nfunction getObjectType (value) {\n  const objectTypeName = Object.prototype.toString.call(value).slice(8, -1)\n  if (objectTypeNames.includes(objectTypeName)) {\n    return objectTypeName\n  }\n  /* c8 ignore next */\n  return undefined\n}\n","class Type {\n  /**\n   * @param {number} major\n   * @param {string} name\n   * @param {boolean} terminal\n   */\n  constructor (major, name, terminal) {\n    this.major = major\n    this.majorEncoded = major << 5\n    this.name = name\n    this.terminal = terminal\n  }\n\n  /* c8 ignore next 3 */\n  toString () {\n    return `Type[${this.major}].${this.name}`\n  }\n\n  /**\n   * @param {Type} typ\n   * @returns {number}\n   */\n  compare (typ) {\n    /* c8 ignore next 1 */\n    return this.major < typ.major ? -1 : this.major > typ.major ? 1 : 0\n  }\n}\n\n// convert to static fields when better supported\nType.uint = new Type(0, 'uint', true)\nType.negint = new Type(1, 'negint', true)\nType.bytes = new Type(2, 'bytes', true)\nType.string = new Type(3, 'string', true)\nType.array = new Type(4, 'array', false)\nType.map = new Type(5, 'map', false)\nType.tag = new Type(6, 'tag', false) // terminal?\nType.float = new Type(7, 'float', true)\nType.false = new Type(7, 'false', true)\nType.true = new Type(7, 'true', true)\nType.null = new Type(7, 'null', true)\nType.undefined = new Type(7, 'undefined', true)\nType.break = new Type(7, 'break', true)\n// Type.indefiniteLength = new Type(0, 'indefiniteLength', true)\n\nclass Token {\n  /**\n   * @param {Type} type\n   * @param {any} [value]\n   * @param {number} [encodedLength]\n   */\n  constructor (type, value, encodedLength) {\n    this.type = type\n    this.value = value\n    this.encodedLength = encodedLength\n    /** @type {Uint8Array|undefined} */\n    this.encodedBytes = undefined\n    /** @type {Uint8Array|undefined} */\n    this.byteValue = undefined\n  }\n\n  /* c8 ignore next 3 */\n  toString () {\n    return `Token[${this.type}].${this.value}`\n  }\n}\n\nexport { Type, Token }\n","// Use Uint8Array directly in the browser, use Buffer in Node.js but don't\n// speak its name directly to avoid bundlers pulling in the `Buffer` polyfill\n\n// @ts-ignore\nexport const useBuffer = globalThis.process &&\n  // @ts-ignore\n  !globalThis.process.browser &&\n  // @ts-ignore\n  globalThis.Buffer &&\n  // @ts-ignore\n  typeof globalThis.Buffer.isBuffer === 'function'\n\nconst textDecoder = new TextDecoder()\nconst textEncoder = new TextEncoder()\n\n/**\n * @param {Uint8Array} buf\n * @returns {boolean}\n */\nfunction isBuffer (buf) {\n  // @ts-ignore\n  return useBuffer && globalThis.Buffer.isBuffer(buf)\n}\n\n/**\n * @param {Uint8Array|number[]} buf\n * @returns {Uint8Array}\n */\nexport function asU8A (buf) {\n  /* c8 ignore next */\n  if (!(buf instanceof Uint8Array)) {\n    return Uint8Array.from(buf)\n  }\n  return isBuffer(buf) ? new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength) : buf\n}\n\nexport const toString = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} bytes\n     * @param {number} start\n     * @param {number} end\n     */\n    (bytes, start, end) => {\n      return end - start > 64\n        ? // eslint-disable-line operator-linebreak\n      // @ts-ignore\n        globalThis.Buffer.from(bytes.subarray(start, end)).toString('utf8')\n        : utf8Slice(bytes, start, end)\n    }\n  /* c8 ignore next 11 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} bytes\n     * @param {number} start\n     * @param {number} end\n     */\n    (bytes, start, end) => {\n      return end - start > 64\n        ? textDecoder.decode(bytes.subarray(start, end))\n        : utf8Slice(bytes, start, end)\n    }\n\nexport const fromString = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {string} string\n     */\n    (string) => {\n      return string.length > 64\n        ? // eslint-disable-line operator-linebreak\n      // @ts-ignore\n        globalThis.Buffer.from(string)\n        : utf8ToBytes(string)\n    }\n  /* c8 ignore next 7 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {string} string\n     */\n    (string) => {\n      return string.length > 64 ? textEncoder.encode(string) : utf8ToBytes(string)\n    }\n\n/**\n * Buffer variant not fast enough for what we need\n * @param {number[]} arr\n * @returns {Uint8Array}\n */\nexport const fromArray = (arr) => {\n  return Uint8Array.from(arr)\n}\n\nexport const slice = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} bytes\n     * @param {number} start\n     * @param {number} end\n     */\n    (bytes, start, end) => {\n      if (isBuffer(bytes)) {\n        return new Uint8Array(bytes.subarray(start, end))\n      }\n      return bytes.slice(start, end)\n    }\n  /* c8 ignore next 9 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} bytes\n     * @param {number} start\n     * @param {number} end\n     */\n    (bytes, start, end) => {\n      return bytes.slice(start, end)\n    }\n\nexport const concat = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array[]} chunks\n     * @param {number} length\n     * @returns {Uint8Array}\n     */\n    (chunks, length) => {\n      // might get a stray plain Array here\n      /* c8 ignore next 1 */\n      chunks = chunks.map((c) => c instanceof Uint8Array\n        ? c\n        // this case is occasionally missed during test runs so becomes coverage-flaky\n        /* c8 ignore next 4 */\n        : // eslint-disable-line operator-linebreak\n        // @ts-ignore\n        globalThis.Buffer.from(c))\n      // @ts-ignore\n      return asU8A(globalThis.Buffer.concat(chunks, length))\n    }\n  /* c8 ignore next 19 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array[]} chunks\n     * @param {number} length\n     * @returns {Uint8Array}\n     */\n    (chunks, length) => {\n      const out = new Uint8Array(length)\n      let off = 0\n      for (let b of chunks) {\n        if (off + b.length > out.length) {\n          // final chunk that's bigger than we need\n          b = b.subarray(0, out.length - off)\n        }\n        out.set(b, off)\n        off += b.length\n      }\n      return out\n    }\n\nexport const alloc = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {number} size\n     * @returns {Uint8Array}\n     */\n    (size) => {\n      // we always write over the contents we expose so this should be safe\n      // @ts-ignore\n      return globalThis.Buffer.allocUnsafe(size)\n    }\n  /* c8 ignore next 8 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {number} size\n     * @returns {Uint8Array}\n     */\n    (size) => {\n      return new Uint8Array(size)\n    }\n\nexport const toHex = useBuffer\n  ? // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} d\n     * @returns {string}\n     */\n    (d) => {\n      if (typeof d === 'string') {\n        return d\n      }\n      // @ts-ignore\n      return globalThis.Buffer.from(toBytes(d)).toString('hex')\n    }\n  /* c8 ignore next 12 */\n  : // eslint-disable-line operator-linebreak\n    /**\n     * @param {Uint8Array} d\n     * @returns {string}\n     */\n    (d) => {\n      if (typeof d === 'string') {\n        return d\n      }\n      // @ts-ignore not smart enough to figure this out\n      return Array.prototype.reduce.call(toBytes(d), (p, c) => `${p}${c.toString(16).padStart(2, '0')}`, '')\n    }\n\nexport const fromHex = useBuffer\n  ? // eslint-disable-line operator-linebreak\n  /**\n   * @param {string|Uint8Array} hex\n   * @returns {Uint8Array}\n   */\n    (hex) => {\n      if (hex instanceof Uint8Array) {\n        return hex\n      }\n      // @ts-ignore\n      return globalThis.Buffer.from(hex, 'hex')\n    }\n  /* c8 ignore next 17 */\n  : // eslint-disable-line operator-linebreak\n  /**\n   * @param {string|Uint8Array} hex\n   * @returns {Uint8Array}\n   */\n    (hex) => {\n      if (hex instanceof Uint8Array) {\n        return hex\n      }\n      if (!hex.length) {\n        return new Uint8Array(0)\n      }\n      return new Uint8Array(hex.split('')\n        .map((/** @type {string} */ c, /** @type {number} */ i, /** @type {string[]} */ d) => i % 2 === 0 ? `0x${c}${d[i + 1]}` : '')\n        .filter(Boolean)\n        .map((/** @type {string} */ e) => parseInt(e, 16)))\n    }\n\n/**\n * @param {Uint8Array|ArrayBuffer|ArrayBufferView} obj\n * @returns {Uint8Array}\n */\nfunction toBytes (obj) {\n  if (obj instanceof Uint8Array && obj.constructor.name === 'Uint8Array') {\n    return obj\n  }\n  if (obj instanceof ArrayBuffer) {\n    return new Uint8Array(obj)\n  }\n  if (ArrayBuffer.isView(obj)) {\n    return new Uint8Array(obj.buffer, obj.byteOffset, obj.byteLength)\n  }\n  /* c8 ignore next */\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {Uint8Array} b1\n * @param {Uint8Array} b2\n * @returns {number}\n */\nexport function compare (b1, b2) {\n  /* c8 ignore next 5 */\n  if (isBuffer(b1) && isBuffer(b2)) {\n    // probably not possible to get here in the current API\n    // @ts-ignore Buffer\n    return b1.compare(b2)\n  }\n  for (let i = 0; i < b1.length; i++) {\n    if (b1[i] === b2[i]) {\n      continue\n    }\n    return b1[i] < b2[i] ? -1 : 1\n  } /* c8 ignore next 3 */\n  return 0\n}\n\n// The below code is taken from https://github.com/google/closure-library/blob/8598d87242af59aac233270742c8984e2b2bdbe0/closure/goog/crypt/crypt.js#L117-L143\n// Licensed Apache-2.0.\n\n/**\n * @param {string} str\n * @returns {number[]}\n */\nfunction utf8ToBytes (str) {\n  const out = []\n  let p = 0\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i)\n    if (c < 128) {\n      out[p++] = c\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192\n      out[p++] = (c & 63) | 128\n    } else if (\n      ((c & 0xFC00) === 0xD800) && (i + 1) < str.length &&\n      ((str.charCodeAt(i + 1) & 0xFC00) === 0xDC00)) {\n      // Surrogate Pair\n      c = 0x10000 + ((c & 0x03FF) << 10) + (str.charCodeAt(++i) & 0x03FF)\n      out[p++] = (c >> 18) | 240\n      out[p++] = ((c >> 12) & 63) | 128\n      out[p++] = ((c >> 6) & 63) | 128\n      out[p++] = (c & 63) | 128\n    } else {\n      out[p++] = (c >> 12) | 224\n      out[p++] = ((c >> 6) & 63) | 128\n      out[p++] = (c & 63) | 128\n    }\n  }\n  return out\n}\n\n// The below code is mostly taken from https://github.com/feross/buffer\n// Licensed MIT. Copyright (c) Feross Aboukhadijeh\n\n/**\n * @param {Uint8Array} buf\n * @param {number} offset\n * @param {number} end\n * @returns {string}\n */\nfunction utf8Slice (buf, offset, end) {\n  const res = []\n\n  while (offset < end) {\n    const firstByte = buf[offset]\n    let codePoint = null\n    let bytesPerSequence = (firstByte > 0xef) ? 4 : (firstByte > 0xdf) ? 3 : (firstByte > 0xbf) ? 2 : 1\n\n    if (offset + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[offset + 1]\n          if ((secondByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1f) << 0x6 | (secondByte & 0x3f)\n            if (tempCodePoint > 0x7f) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[offset + 1]\n          thirdByte = buf[offset + 2]\n          if ((secondByte & 0xc0) === 0x80 && (thirdByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0xf) << 0xc | (secondByte & 0x3f) << 0x6 | (thirdByte & 0x3f)\n            /* c8 ignore next 3 */\n            if (tempCodePoint > 0x7ff && (tempCodePoint < 0xd800 || tempCodePoint > 0xdfff)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[offset + 1]\n          thirdByte = buf[offset + 2]\n          fourthByte = buf[offset + 3]\n          if ((secondByte & 0xc0) === 0x80 && (thirdByte & 0xc0) === 0x80 && (fourthByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0xf) << 0x12 | (secondByte & 0x3f) << 0xc | (thirdByte & 0x3f) << 0x6 | (fourthByte & 0x3f)\n            if (tempCodePoint > 0xffff && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    /* c8 ignore next 5 */\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xfffd\n      bytesPerSequence = 1\n    } else if (codePoint > 0xffff) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3ff | 0xd800)\n      codePoint = 0xdc00 | codePoint & 0x3ff\n    }\n\n    res.push(codePoint)\n    offset += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nconst MAX_ARGUMENTS_LENGTH = 0x1000\n\n/**\n * @param {number[]} codePoints\n * @returns {string}\n */\nexport function decodeCodePointsArray (codePoints) {\n  const len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n  /* c8 ignore next 10 */\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  let res = ''\n  let i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n","/**\n * Bl is a list of byte chunks, similar to https://github.com/rvagg/bl but for\n * writing rather than reading.\n * A Bl object accepts set() operations for individual bytes and copyTo() for\n * inserting byte arrays. These write operations don't automatically increment\n * the internal cursor so its \"length\" won't be changed. Instead, increment()\n * must be called to extend its length to cover the inserted data.\n * The toBytes() call will convert all internal memory to a single Uint8Array of\n * the correct length, truncating any data that is stored but hasn't been\n * included by an increment().\n * get() can retrieve a single byte.\n * All operations (except toBytes()) take an \"offset\" argument that will perform\n * the write at the offset _from the current cursor_. For most operations this\n * will be `0` to write at the current cursor position but it can be ahead of\n * the current cursor. Negative offsets probably work but are untested.\n */\n\n// TODO: ipjs doesn't support this, only for test files: https://github.com/mikeal/ipjs/blob/master/src/package/testFile.js#L39\nimport { alloc, concat, slice } from './byte-utils.js'\n\n// the ts-ignores in this file are almost all for the `Uint8Array|number[]` duality that exists\n// for perf reasons. Consider better approaches to this or removing it entirely, it is quite\n// risky because of some assumptions about small chunks === number[] and everything else === Uint8Array.\n\nconst defaultChunkSize = 256\n\nexport class Bl {\n  /**\n   * @param {number} [chunkSize]\n   */\n  constructor (chunkSize = defaultChunkSize) {\n    this.chunkSize = chunkSize\n    /** @type {number} */\n    this.cursor = 0\n    /** @type {number} */\n    this.maxCursor = -1\n    /** @type {(Uint8Array|number[])[]} */\n    this.chunks = []\n    // keep the first chunk around if we can to save allocations for future encodes\n    /** @type {Uint8Array|number[]|null} */\n    this._initReuseChunk = null\n  }\n\n  reset () {\n    this.cursor = 0\n    this.maxCursor = -1\n    if (this.chunks.length) {\n      this.chunks = []\n    }\n    if (this._initReuseChunk !== null) {\n      this.chunks.push(this._initReuseChunk)\n      this.maxCursor = this._initReuseChunk.length - 1\n    }\n  }\n\n  /**\n   * @param {Uint8Array|number[]} bytes\n   */\n  push (bytes) {\n    let topChunk = this.chunks[this.chunks.length - 1]\n    const newMax = this.cursor + bytes.length\n    if (newMax <= this.maxCursor + 1) {\n      // we have at least one chunk and we can fit these bytes into that chunk\n      const chunkPos = topChunk.length - (this.maxCursor - this.cursor) - 1\n      // @ts-ignore\n      topChunk.set(bytes, chunkPos)\n    } else {\n      // can't fit it in\n      if (topChunk) {\n        // trip the last chunk to `cursor` if we need to\n        const chunkPos = topChunk.length - (this.maxCursor - this.cursor) - 1\n        if (chunkPos < topChunk.length) {\n          // @ts-ignore\n          this.chunks[this.chunks.length - 1] = topChunk.subarray(0, chunkPos)\n          this.maxCursor = this.cursor - 1\n        }\n      }\n      if (bytes.length < 64 && bytes.length < this.chunkSize) {\n        // make a new chunk and copy the new one into it\n        topChunk = alloc(this.chunkSize)\n        this.chunks.push(topChunk)\n        this.maxCursor += topChunk.length\n        if (this._initReuseChunk === null) {\n          this._initReuseChunk = topChunk\n        }\n        // @ts-ignore\n        topChunk.set(bytes, 0)\n      } else {\n        // push the new bytes in as its own chunk\n        this.chunks.push(bytes)\n        this.maxCursor += bytes.length\n      }\n    }\n    this.cursor += bytes.length\n  }\n\n  /**\n   * @param {boolean} [reset]\n   * @returns {Uint8Array}\n   */\n  toBytes (reset = false) {\n    let byts\n    if (this.chunks.length === 1) {\n      const chunk = this.chunks[0]\n      if (reset && this.cursor > chunk.length / 2) {\n        /* c8 ignore next 2 */\n        // @ts-ignore\n        byts = this.cursor === chunk.length ? chunk : chunk.subarray(0, this.cursor)\n        this._initReuseChunk = null\n        this.chunks = []\n      } else {\n        // @ts-ignore\n        byts = slice(chunk, 0, this.cursor)\n      }\n    } else {\n      // @ts-ignore\n      byts = concat(this.chunks, this.cursor)\n    }\n    if (reset) {\n      this.reset()\n    }\n    return byts\n  }\n}\n","const decodeErrPrefix = 'CBOR decode error:'\nconst encodeErrPrefix = 'CBOR encode error:'\n\nconst uintMinorPrefixBytes = []\nuintMinorPrefixBytes[23] = 1\nuintMinorPrefixBytes[24] = 2\nuintMinorPrefixBytes[25] = 3\nuintMinorPrefixBytes[26] = 5\nuintMinorPrefixBytes[27] = 9\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} need\n */\nfunction assertEnoughData (data, pos, need) {\n  if (data.length - pos < need) {\n    throw new Error(`${decodeErrPrefix} not enough data for type`)\n  }\n}\n\nexport {\n  decodeErrPrefix,\n  encodeErrPrefix,\n  uintMinorPrefixBytes,\n  assertEnoughData\n}\n","/* globals BigInt */\n\nimport { Token, Type } from './token.js'\nimport { decodeErrPrefix, assertEnoughData } from './common.js'\n\nexport const uintBoundaries = [24, 256, 65536, 4294967296, BigInt('18446744073709551616')]\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} data\n * @param {number} offset\n * @param {DecodeOptions} options\n * @returns {number}\n */\nexport function readUint8 (data, offset, options) {\n  assertEnoughData(data, offset, 1)\n  const value = data[offset]\n  if (options.strict === true && value < uintBoundaries[0]) {\n    throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`)\n  }\n  return value\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} offset\n * @param {DecodeOptions} options\n * @returns {number}\n */\nexport function readUint16 (data, offset, options) {\n  assertEnoughData(data, offset, 2)\n  const value = (data[offset] << 8) | data[offset + 1]\n  if (options.strict === true && value < uintBoundaries[1]) {\n    throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`)\n  }\n  return value\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} offset\n * @param {DecodeOptions} options\n * @returns {number}\n */\nexport function readUint32 (data, offset, options) {\n  assertEnoughData(data, offset, 4)\n  const value = (data[offset] * 16777216 /* 2 ** 24 */) + (data[offset + 1] << 16) + (data[offset + 2] << 8) + data[offset + 3]\n  if (options.strict === true && value < uintBoundaries[2]) {\n    throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`)\n  }\n  return value\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} offset\n * @param {DecodeOptions} options\n * @returns {number|bigint}\n */\nexport function readUint64 (data, offset, options) {\n  // assume BigInt, convert back to Number if within safe range\n  assertEnoughData(data, offset, 8)\n  const hi = (data[offset] * 16777216 /* 2 ** 24 */) + (data[offset + 1] << 16) + (data[offset + 2] << 8) + data[offset + 3]\n  const lo = (data[offset + 4] * 16777216 /* 2 ** 24 */) + (data[offset + 5] << 16) + (data[offset + 6] << 8) + data[offset + 7]\n  const value = (BigInt(hi) << BigInt(32)) + BigInt(lo)\n  if (options.strict === true && value < uintBoundaries[3]) {\n    throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`)\n  }\n  if (value <= Number.MAX_SAFE_INTEGER) {\n    return Number(value)\n  }\n  if (options.allowBigInt === true) {\n    return value\n  }\n  throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)\n}\n\n/* not required thanks to quick[] list\nconst oneByteTokens = new Array(24).fill(0).map((v, i) => new Token(Type.uint, i, 1))\nexport function decodeUintCompact (data, pos, minor, options) {\n  return oneByteTokens[minor]\n}\n*/\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeUint8 (data, pos, _minor, options) {\n  return new Token(Type.uint, readUint8(data, pos + 1, options), 2)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeUint16 (data, pos, _minor, options) {\n  return new Token(Type.uint, readUint16(data, pos + 1, options), 3)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeUint32 (data, pos, _minor, options) {\n  return new Token(Type.uint, readUint32(data, pos + 1, options), 5)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeUint64 (data, pos, _minor, options) {\n  return new Token(Type.uint, readUint64(data, pos + 1, options), 9)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeUint (buf, token) {\n  return encodeUintValue(buf, 0, token.value)\n}\n\n/**\n * @param {Bl} buf\n * @param {number} major\n * @param {number|bigint} uint\n */\nexport function encodeUintValue (buf, major, uint) {\n  if (uint < uintBoundaries[0]) {\n    const nuint = Number(uint)\n    // pack into one byte, minor=0, additional=value\n    buf.push([major | nuint])\n  } else if (uint < uintBoundaries[1]) {\n    const nuint = Number(uint)\n    // pack into two byte, minor=0, additional=24\n    buf.push([major | 24, nuint])\n  } else if (uint < uintBoundaries[2]) {\n    const nuint = Number(uint)\n    // pack into three byte, minor=0, additional=25\n    buf.push([major | 25, nuint >>> 8, nuint & 0xff])\n  } else if (uint < uintBoundaries[3]) {\n    const nuint = Number(uint)\n    // pack into five byte, minor=0, additional=26\n    buf.push([major | 26, (nuint >>> 24) & 0xff, (nuint >>> 16) & 0xff, (nuint >>> 8) & 0xff, nuint & 0xff])\n  } else {\n    const buint = BigInt(uint)\n    if (buint < uintBoundaries[4]) {\n      // pack into nine byte, minor=0, additional=27\n      const set = [major | 27, 0, 0, 0, 0, 0, 0, 0]\n      // simulate bitwise above 32 bits\n      let lo = Number(buint & BigInt(0xffffffff))\n      let hi = Number(buint >> BigInt(32) & BigInt(0xffffffff))\n      set[8] = lo & 0xff\n      lo = lo >> 8\n      set[7] = lo & 0xff\n      lo = lo >> 8\n      set[6] = lo & 0xff\n      lo = lo >> 8\n      set[5] = lo & 0xff\n      set[4] = hi & 0xff\n      hi = hi >> 8\n      set[3] = hi & 0xff\n      hi = hi >> 8\n      set[2] = hi & 0xff\n      hi = hi >> 8\n      set[1] = hi & 0xff\n      buf.push(set)\n    } else {\n      throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)\n    }\n  }\n}\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeUint.encodedSize = function encodedSize (token) {\n  return encodeUintValue.encodedSize(token.value)\n}\n\n/**\n * @param {number} uint\n * @returns {number}\n */\nencodeUintValue.encodedSize = function encodedSize (uint) {\n  if (uint < uintBoundaries[0]) {\n    return 1\n  }\n  if (uint < uintBoundaries[1]) {\n    return 2\n  }\n  if (uint < uintBoundaries[2]) {\n    return 3\n  }\n  if (uint < uintBoundaries[3]) {\n    return 5\n  }\n  return 9\n}\n\n/**\n * @param {Token} tok1\n * @param {Token} tok2\n * @returns {number}\n */\nencodeUint.compareTokens = function compareTokens (tok1, tok2) {\n  return tok1.value < tok2.value ? -1 : tok1.value > tok2.value ? 1 : /* c8 ignore next */ 0\n}\n","/* eslint-env es2020 */\n\nimport { Token, Type } from './token.js'\nimport * as uint from './0uint.js'\nimport { decodeErrPrefix } from './common.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeNegint8 (data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint8(data, pos + 1, options), 2)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeNegint16 (data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint16(data, pos + 1, options), 3)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeNegint32 (data, pos, _minor, options) {\n  return new Token(Type.negint, -1 - uint.readUint32(data, pos + 1, options), 5)\n}\n\nconst neg1b = BigInt(-1)\nconst pos1b = BigInt(1)\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeNegint64 (data, pos, _minor, options) {\n  const int = uint.readUint64(data, pos + 1, options)\n  if (typeof int !== 'bigint') {\n    const value = -1 - int\n    if (value >= Number.MIN_SAFE_INTEGER) {\n      return new Token(Type.negint, value, 9)\n    }\n  }\n  if (options.allowBigInt !== true) {\n    throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)\n  }\n  return new Token(Type.negint, neg1b - BigInt(int), 9)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeNegint (buf, token) {\n  const negint = token.value\n  const unsigned = (typeof negint === 'bigint' ? (negint * neg1b - pos1b) : (negint * -1 - 1))\n  uint.encodeUintValue(buf, token.type.majorEncoded, unsigned)\n}\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeNegint.encodedSize = function encodedSize (token) {\n  const negint = token.value\n  const unsigned = (typeof negint === 'bigint' ? (negint * neg1b - pos1b) : (negint * -1 - 1))\n  /* c8 ignore next 4 */\n  // handled by quickEncode, we shouldn't get here but it's included for completeness\n  if (unsigned < uint.uintBoundaries[0]) {\n    return 1\n  }\n  if (unsigned < uint.uintBoundaries[1]) {\n    return 2\n  }\n  if (unsigned < uint.uintBoundaries[2]) {\n    return 3\n  }\n  if (unsigned < uint.uintBoundaries[3]) {\n    return 5\n  }\n  return 9\n}\n\n/**\n * @param {Token} tok1\n * @param {Token} tok2\n * @returns {number}\n */\nencodeNegint.compareTokens = function compareTokens (tok1, tok2) {\n  // opposite of the uint comparison since we store the uint version in bytes\n  return tok1.value < tok2.value ? 1 : tok1.value > tok2.value ? -1 : /* c8 ignore next */ 0\n}\n","import { Token, Type } from './token.js'\nimport { assertEnoughData, decodeErrPrefix } from './common.js'\nimport * as uint from './0uint.js'\nimport { compare, fromString, slice } from './byte-utils.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} prefix\n * @param {number} length\n * @returns {Token}\n */\nfunction toToken (data, pos, prefix, length) {\n  assertEnoughData(data, pos, prefix + length)\n  const buf = slice(data, pos + prefix, pos + prefix + length)\n  return new Token(Type.bytes, buf, prefix + length)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} minor\n * @param {DecodeOptions} _options\n * @returns {Token}\n */\nexport function decodeBytesCompact (data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeBytes8 (data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeBytes16 (data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeBytes32 (data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options))\n}\n\n// TODO: maybe we shouldn't support this ..\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeBytes64 (data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options)\n  if (typeof l === 'bigint') {\n    throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`)\n  }\n  return toToken(data, pos, 9, l)\n}\n\n/**\n * `encodedBytes` allows for caching when we do a byte version of a string\n * for key sorting purposes\n * @param {Token} token\n * @returns {Uint8Array}\n */\nfunction tokenBytes (token) {\n  if (token.encodedBytes === undefined) {\n    token.encodedBytes = token.type === Type.string ? fromString(token.value) : token.value\n  }\n  // @ts-ignore c'mon\n  return token.encodedBytes\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeBytes (buf, token) {\n  const bytes = tokenBytes(token)\n  uint.encodeUintValue(buf, token.type.majorEncoded, bytes.length)\n  buf.push(bytes)\n}\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeBytes.encodedSize = function encodedSize (token) {\n  const bytes = tokenBytes(token)\n  return uint.encodeUintValue.encodedSize(bytes.length) + bytes.length\n}\n\n/**\n * @param {Token} tok1\n * @param {Token} tok2\n * @returns {number}\n */\nencodeBytes.compareTokens = function compareTokens (tok1, tok2) {\n  return compareBytes(tokenBytes(tok1), tokenBytes(tok2))\n}\n\n/**\n * @param {Uint8Array} b1\n * @param {Uint8Array} b2\n * @returns {number}\n */\nexport function compareBytes (b1, b2) {\n  return b1.length < b2.length ? -1 : b1.length > b2.length ? 1 : compare(b1, b2)\n}\n","import { Token, Type } from './token.js'\nimport { assertEnoughData, decodeErrPrefix } from './common.js'\nimport * as uint from './0uint.js'\nimport { encodeBytes } from './2bytes.js'\nimport { toString, slice } from './byte-utils.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} prefix\n * @param {number} length\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nfunction toToken (data, pos, prefix, length, options) {\n  const totLength = prefix + length\n  assertEnoughData(data, pos, totLength)\n  const tok = new Token(Type.string, toString(data, pos + prefix, pos + totLength), totLength)\n  if (options.retainStringBytes === true) {\n    tok.byteValue = slice(data, pos + prefix, pos + totLength)\n  }\n  return tok\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeStringCompact (data, pos, minor, options) {\n  return toToken(data, pos, 1, minor, options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeString8 (data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options), options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeString16 (data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options), options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeString32 (data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options), options)\n}\n\n// TODO: maybe we shouldn't support this ..\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeString64 (data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options)\n  if (typeof l === 'bigint') {\n    throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`)\n  }\n  return toToken(data, pos, 9, l, options)\n}\n\nexport const encodeString = encodeBytes\n","import { Token, Type } from './token.js'\nimport * as uint from './0uint.js'\nimport { decodeErrPrefix } from './common.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} _data\n * @param {number} _pos\n * @param {number} prefix\n * @param {number} length\n * @returns {Token}\n */\nfunction toToken (_data, _pos, prefix, length) {\n  return new Token(Type.array, length, prefix)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} minor\n * @param {DecodeOptions} _options\n * @returns {Token}\n */\nexport function decodeArrayCompact (data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeArray8 (data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeArray16 (data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeArray32 (data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options))\n}\n\n// TODO: maybe we shouldn't support this ..\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeArray64 (data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options)\n  if (typeof l === 'bigint') {\n    throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`)\n  }\n  return toToken(data, pos, 9, l)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeArrayIndefinite (data, pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${decodeErrPrefix} indefinite length items not allowed`)\n  }\n  return toToken(data, pos, 1, Infinity)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeArray (buf, token) {\n  uint.encodeUintValue(buf, Type.array.majorEncoded, token.value)\n}\n\n// using an array as a map key, are you sure about this? we can only sort\n// by map length here, it's up to the encoder to decide to look deeper\nencodeArray.compareTokens = uint.encodeUint.compareTokens\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeArray.encodedSize = function encodedSize (token) {\n  return uint.encodeUintValue.encodedSize(token.value)\n}\n","import { Token, Type } from './token.js'\nimport * as uint from './0uint.js'\nimport { decodeErrPrefix } from './common.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} _data\n * @param {number} _pos\n * @param {number} prefix\n * @param {number} length\n * @returns {Token}\n */\nfunction toToken (_data, _pos, prefix, length) {\n  return new Token(Type.map, length, prefix)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} minor\n * @param {DecodeOptions} _options\n * @returns {Token}\n */\nexport function decodeMapCompact (data, pos, minor, _options) {\n  return toToken(data, pos, 1, minor)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeMap8 (data, pos, _minor, options) {\n  return toToken(data, pos, 2, uint.readUint8(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeMap16 (data, pos, _minor, options) {\n  return toToken(data, pos, 3, uint.readUint16(data, pos + 1, options))\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeMap32 (data, pos, _minor, options) {\n  return toToken(data, pos, 5, uint.readUint32(data, pos + 1, options))\n}\n\n// TODO: maybe we shouldn't support this ..\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeMap64 (data, pos, _minor, options) {\n  const l = uint.readUint64(data, pos + 1, options)\n  if (typeof l === 'bigint') {\n    throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`)\n  }\n  return toToken(data, pos, 9, l)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeMapIndefinite (data, pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${decodeErrPrefix} indefinite length items not allowed`)\n  }\n  return toToken(data, pos, 1, Infinity)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeMap (buf, token) {\n  uint.encodeUintValue(buf, Type.map.majorEncoded, token.value)\n}\n\n// using a map as a map key, are you sure about this? we can only sort\n// by map length here, it's up to the encoder to decide to look deeper\nencodeMap.compareTokens = uint.encodeUint.compareTokens\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeMap.encodedSize = function encodedSize (token) {\n  return uint.encodeUintValue.encodedSize(token.value)\n}\n","import { Token, Type } from './token.js'\nimport * as uint from './0uint.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} _data\n * @param {number} _pos\n * @param {number} minor\n * @param {DecodeOptions} _options\n * @returns {Token}\n */\nexport function decodeTagCompact (_data, _pos, minor, _options) {\n  return new Token(Type.tag, minor, 1)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeTag8 (data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint8(data, pos + 1, options), 2)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeTag16 (data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint16(data, pos + 1, options), 3)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeTag32 (data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint32(data, pos + 1, options), 5)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeTag64 (data, pos, _minor, options) {\n  return new Token(Type.tag, uint.readUint64(data, pos + 1, options), 9)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n */\nexport function encodeTag (buf, token) {\n  uint.encodeUintValue(buf, Type.tag.majorEncoded, token.value)\n}\n\nencodeTag.compareTokens = uint.encodeUint.compareTokens\n\n/**\n * @param {Token} token\n * @returns {number}\n */\nencodeTag.encodedSize = function encodedSize (token) {\n  return uint.encodeUintValue.encodedSize(token.value)\n}\n","// TODO: shift some of the bytes logic to bytes-utils so we can use Buffer\n// where possible\n\nimport { Token, Type } from './token.js'\nimport { decodeErrPrefix } from './common.js'\nimport { encodeUint } from './0uint.js'\n\n/**\n * @typedef {import('./bl.js').Bl} Bl\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n * @typedef {import('../interface').EncodeOptions} EncodeOptions\n */\n\nconst MINOR_FALSE = 20\nconst MINOR_TRUE = 21\nconst MINOR_NULL = 22\nconst MINOR_UNDEFINED = 23\n\n/**\n * @param {Uint8Array} _data\n * @param {number} _pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeUndefined (_data, _pos, _minor, options) {\n  if (options.allowUndefined === false) {\n    throw new Error(`${decodeErrPrefix} undefined values are not supported`)\n  } else if (options.coerceUndefinedToNull === true) {\n    return new Token(Type.null, null, 1)\n  }\n  return new Token(Type.undefined, undefined, 1)\n}\n\n/**\n * @param {Uint8Array} _data\n * @param {number} _pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeBreak (_data, _pos, _minor, options) {\n  if (options.allowIndefinite === false) {\n    throw new Error(`${decodeErrPrefix} indefinite length items not allowed`)\n  }\n  return new Token(Type.break, undefined, 1)\n}\n\n/**\n * @param {number} value\n * @param {number} bytes\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nfunction createToken (value, bytes, options) {\n  if (options) {\n    if (options.allowNaN === false && Number.isNaN(value)) {\n      throw new Error(`${decodeErrPrefix} NaN values are not supported`)\n    }\n    if (options.allowInfinity === false && (value === Infinity || value === -Infinity)) {\n      throw new Error(`${decodeErrPrefix} Infinity values are not supported`)\n    }\n  }\n  return new Token(Type.float, value, bytes)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeFloat16 (data, pos, _minor, options) {\n  return createToken(readFloat16(data, pos + 1), 3, options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeFloat32 (data, pos, _minor, options) {\n  return createToken(readFloat32(data, pos + 1), 5, options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} _minor\n * @param {DecodeOptions} options\n * @returns {Token}\n */\nexport function decodeFloat64 (data, pos, _minor, options) {\n  return createToken(readFloat64(data, pos + 1), 9, options)\n}\n\n/**\n * @param {Bl} buf\n * @param {Token} token\n * @param {EncodeOptions} options\n */\nexport function encodeFloat (buf, token, options) {\n  const float = token.value\n\n  if (float === false) {\n    buf.push([Type.float.majorEncoded | MINOR_FALSE])\n  } else if (float === true) {\n    buf.push([Type.float.majorEncoded | MINOR_TRUE])\n  } else if (float === null) {\n    buf.push([Type.float.majorEncoded | MINOR_NULL])\n  } else if (float === undefined) {\n    buf.push([Type.float.majorEncoded | MINOR_UNDEFINED])\n  } else {\n    let decoded\n    let success = false\n    if (!options || options.float64 !== true) {\n      encodeFloat16(float)\n      decoded = readFloat16(ui8a, 1)\n      if (float === decoded || Number.isNaN(float)) {\n        ui8a[0] = 0xf9\n        buf.push(ui8a.slice(0, 3))\n        success = true\n      } else {\n        encodeFloat32(float)\n        decoded = readFloat32(ui8a, 1)\n        if (float === decoded) {\n          ui8a[0] = 0xfa\n          buf.push(ui8a.slice(0, 5))\n          success = true\n        }\n      }\n    }\n    if (!success) {\n      encodeFloat64(float)\n      decoded = readFloat64(ui8a, 1)\n      ui8a[0] = 0xfb\n      buf.push(ui8a.slice(0, 9))\n    }\n  }\n}\n\n/**\n * @param {Token} token\n * @param {EncodeOptions} options\n * @returns {number}\n */\nencodeFloat.encodedSize = function encodedSize (token, options) {\n  const float = token.value\n\n  if (float === false || float === true || float === null || float === undefined) {\n    return 1\n  }\n\n  if (!options || options.float64 !== true) {\n    encodeFloat16(float)\n    let decoded = readFloat16(ui8a, 1)\n    if (float === decoded || Number.isNaN(float)) {\n      return 3\n    }\n    encodeFloat32(float)\n    decoded = readFloat32(ui8a, 1)\n    if (float === decoded) {\n      return 5\n    }\n  }\n  return 9\n}\n\nconst buffer = new ArrayBuffer(9)\nconst dataView = new DataView(buffer, 1)\nconst ui8a = new Uint8Array(buffer, 0)\n\n/**\n * @param {number} inp\n */\nfunction encodeFloat16 (inp) {\n  if (inp === Infinity) {\n    dataView.setUint16(0, 0x7c00, false)\n  } else if (inp === -Infinity) {\n    dataView.setUint16(0, 0xfc00, false)\n  } else if (Number.isNaN(inp)) {\n    dataView.setUint16(0, 0x7e00, false)\n  } else {\n    dataView.setFloat32(0, inp)\n    const valu32 = dataView.getUint32(0)\n    const exponent = (valu32 & 0x7f800000) >> 23\n    const mantissa = valu32 & 0x7fffff\n\n    /* c8 ignore next 6 */\n    if (exponent === 0xff) {\n      // too big, Infinity, but this should be hard (impossible?) to trigger\n      dataView.setUint16(0, 0x7c00, false)\n    } else if (exponent === 0x00) {\n      // 0.0, -0.0 and subnormals, shouldn't be possible to get here because 0.0 should be counted as an int\n      dataView.setUint16(0, ((inp & 0x80000000) >> 16) | (mantissa >> 13), false)\n    } else { // standard numbers\n      // chunks of logic here borrowed from https://github.com/PJK/libcbor/blob/c78f437182533e3efa8d963ff4b945bb635c2284/src/cbor/encoding.c#L127\n      const logicalExponent = exponent - 127\n      // Now we know that 2^exponent <= 0 logically\n      /* c8 ignore next 6 */\n      if (logicalExponent < -24) {\n        /* No unambiguous representation exists, this float is not a half float\n          and is too small to be represented using a half, round off to zero.\n          Consistent with the reference implementation. */\n        // should be difficult (impossible?) to get here in JS\n        dataView.setUint16(0, 0)\n      } else if (logicalExponent < -14) {\n        /* Offset the remaining decimal places by shifting the significand, the\n          value is lost. This is an implementation decision that works around the\n          absence of standard half-float in the language. */\n        dataView.setUint16(0, ((valu32 & 0x80000000) >> 16) | /* sign bit */ (1 << (24 + logicalExponent)), false)\n      } else {\n        dataView.setUint16(0, ((valu32 & 0x80000000) >> 16) | ((logicalExponent + 15) << 10) | (mantissa >> 13), false)\n      }\n    }\n  }\n}\n\n/**\n * @param {Uint8Array} ui8a\n * @param {number} pos\n * @returns {number}\n */\nfunction readFloat16 (ui8a, pos) {\n  if (ui8a.length - pos < 2) {\n    throw new Error(`${decodeErrPrefix} not enough data for float16`)\n  }\n\n  const half = (ui8a[pos] << 8) + ui8a[pos + 1]\n  if (half === 0x7c00) {\n    return Infinity\n  }\n  if (half === 0xfc00) {\n    return -Infinity\n  }\n  if (half === 0x7e00) {\n    return NaN\n  }\n  const exp = (half >> 10) & 0x1f\n  const mant = half & 0x3ff\n  let val\n  if (exp === 0) {\n    val = mant * (2 ** -24)\n  } else if (exp !== 31) {\n    val = (mant + 1024) * (2 ** (exp - 25))\n  /* c8 ignore next 4 */\n  } else {\n    // may not be possible to get here\n    val = mant === 0 ? Infinity : NaN\n  }\n  return (half & 0x8000) ? -val : val\n}\n\n/**\n * @param {number} inp\n */\nfunction encodeFloat32 (inp) {\n  dataView.setFloat32(0, inp, false)\n}\n\n/**\n * @param {Uint8Array} ui8a\n * @param {number} pos\n * @returns {number}\n */\nfunction readFloat32 (ui8a, pos) {\n  if (ui8a.length - pos < 4) {\n    throw new Error(`${decodeErrPrefix} not enough data for float32`)\n  }\n  const offset = (ui8a.byteOffset || 0) + pos\n  return new DataView(ui8a.buffer, offset, 4).getFloat32(0, false)\n}\n\n/**\n * @param {number} inp\n */\nfunction encodeFloat64 (inp) {\n  dataView.setFloat64(0, inp, false)\n}\n\n/**\n * @param {Uint8Array} ui8a\n * @param {number} pos\n * @returns {number}\n */\nfunction readFloat64 (ui8a, pos) {\n  if (ui8a.length - pos < 8) {\n    throw new Error(`${decodeErrPrefix} not enough data for float64`)\n  }\n  const offset = (ui8a.byteOffset || 0) + pos\n  return new DataView(ui8a.buffer, offset, 8).getFloat64(0, false)\n}\n\n/**\n * @param {Token} _tok1\n * @param {Token} _tok2\n * @returns {number}\n */\nencodeFloat.compareTokens = encodeUint.compareTokens\n/*\nencodeFloat.compareTokens = function compareTokens (_tok1, _tok2) {\n  return _tok1\n  throw new Error(`${encodeErrPrefix} cannot use floats as map keys`)\n}\n*/\n","import { Token, Type } from './token.js'\nimport * as uint from './0uint.js'\nimport * as negint from './1negint.js'\nimport * as bytes from './2bytes.js'\nimport * as string from './3string.js'\nimport * as array from './4array.js'\nimport * as map from './5map.js'\nimport * as tag from './6tag.js'\nimport * as float from './7float.js'\nimport { decodeErrPrefix } from './common.js'\nimport { fromArray } from './byte-utils.js'\n\n/**\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n */\n\n/**\n * @param {Uint8Array} data\n * @param {number} pos\n * @param {number} minor\n */\nfunction invalidMinor (data, pos, minor) {\n  throw new Error(`${decodeErrPrefix} encountered invalid minor (${minor}) for major ${data[pos] >>> 5}`)\n}\n\n/**\n * @param {string} msg\n * @returns {()=>any}\n */\nfunction errorer (msg) {\n  return () => { throw new Error(`${decodeErrPrefix} ${msg}`) }\n}\n\n/** @type {((data:Uint8Array, pos:number, minor:number, options?:DecodeOptions) => any)[]} */\nexport const jump = []\n\n// unsigned integer, 0x00..0x17 (0..23)\nfor (let i = 0; i <= 0x17; i++) {\n  jump[i] = invalidMinor // uint.decodeUintCompact, handled by quick[]\n}\njump[0x18] = uint.decodeUint8 // unsigned integer, one-byte uint8_t follows\njump[0x19] = uint.decodeUint16 // unsigned integer, two-byte uint16_t follows\njump[0x1a] = uint.decodeUint32 // unsigned integer, four-byte uint32_t follows\njump[0x1b] = uint.decodeUint64 // unsigned integer, eight-byte uint64_t follows\njump[0x1c] = invalidMinor\njump[0x1d] = invalidMinor\njump[0x1e] = invalidMinor\njump[0x1f] = invalidMinor\n// negative integer, -1-0x00..-1-0x17 (-1..-24)\nfor (let i = 0x20; i <= 0x37; i++) {\n  jump[i] = invalidMinor // negintDecode, handled by quick[]\n}\njump[0x38] = negint.decodeNegint8 // negative integer, -1-n one-byte uint8_t for n follows\njump[0x39] = negint.decodeNegint16 // negative integer, -1-n two-byte uint16_t for n follows\njump[0x3a] = negint.decodeNegint32 // negative integer, -1-n four-byte uint32_t for follows\njump[0x3b] = negint.decodeNegint64 // negative integer, -1-n eight-byte uint64_t for follows\njump[0x3c] = invalidMinor\njump[0x3d] = invalidMinor\njump[0x3e] = invalidMinor\njump[0x3f] = invalidMinor\n// byte string, 0x00..0x17 bytes follow\nfor (let i = 0x40; i <= 0x57; i++) {\n  jump[i] = bytes.decodeBytesCompact\n}\njump[0x58] = bytes.decodeBytes8 // byte string, one-byte uint8_t for n, and then n bytes follow\njump[0x59] = bytes.decodeBytes16 // byte string, two-byte uint16_t for n, and then n bytes follow\njump[0x5a] = bytes.decodeBytes32 // byte string, four-byte uint32_t for n, and then n bytes follow\njump[0x5b] = bytes.decodeBytes64 // byte string, eight-byte uint64_t for n, and then n bytes follow\njump[0x5c] = invalidMinor\njump[0x5d] = invalidMinor\njump[0x5e] = invalidMinor\njump[0x5f] = errorer('indefinite length bytes/strings are not supported') // byte string, byte strings follow, terminated by \"break\"\n// UTF-8 string 0x00..0x17 bytes follow\nfor (let i = 0x60; i <= 0x77; i++) {\n  jump[i] = string.decodeStringCompact\n}\njump[0x78] = string.decodeString8 // UTF-8 string, one-byte uint8_t for n, and then n bytes follow\njump[0x79] = string.decodeString16 // UTF-8 string, two-byte uint16_t for n, and then n bytes follow\njump[0x7a] = string.decodeString32 // UTF-8 string, four-byte uint32_t for n, and then n bytes follow\njump[0x7b] = string.decodeString64 // UTF-8 string, eight-byte uint64_t for n, and then n bytes follow\njump[0x7c] = invalidMinor\njump[0x7d] = invalidMinor\njump[0x7e] = invalidMinor\njump[0x7f] = errorer('indefinite length bytes/strings are not supported') // UTF-8 strings follow, terminated by \"break\"\n// array, 0x00..0x17 data items follow\nfor (let i = 0x80; i <= 0x97; i++) {\n  jump[i] = array.decodeArrayCompact\n}\njump[0x98] = array.decodeArray8 // array, one-byte uint8_t for n, and then n data items follow\njump[0x99] = array.decodeArray16 // array, two-byte uint16_t for n, and then n data items follow\njump[0x9a] = array.decodeArray32 // array, four-byte uint32_t for n, and then n data items follow\njump[0x9b] = array.decodeArray64 // array, eight-byte uint64_t for n, and then n data items follow\njump[0x9c] = invalidMinor\njump[0x9d] = invalidMinor\njump[0x9e] = invalidMinor\njump[0x9f] = array.decodeArrayIndefinite // array, data items follow, terminated by \"break\"\n// map, 0x00..0x17 pairs of data items follow\nfor (let i = 0xa0; i <= 0xb7; i++) {\n  jump[i] = map.decodeMapCompact\n}\njump[0xb8] = map.decodeMap8 // map, one-byte uint8_t for n, and then n pairs of data items follow\njump[0xb9] = map.decodeMap16 // map, two-byte uint16_t for n, and then n pairs of data items follow\njump[0xba] = map.decodeMap32 // map, four-byte uint32_t for n, and then n pairs of data items follow\njump[0xbb] = map.decodeMap64 // map, eight-byte uint64_t for n, and then n pairs of data items follow\njump[0xbc] = invalidMinor\njump[0xbd] = invalidMinor\njump[0xbe] = invalidMinor\njump[0xbf] = map.decodeMapIndefinite // map, pairs of data items follow, terminated by \"break\"\n// tags\nfor (let i = 0xc0; i <= 0xd7; i++) {\n  jump[i] = tag.decodeTagCompact\n}\njump[0xd8] = tag.decodeTag8\njump[0xd9] = tag.decodeTag16\njump[0xda] = tag.decodeTag32\njump[0xdb] = tag.decodeTag64\njump[0xdc] = invalidMinor\njump[0xdd] = invalidMinor\njump[0xde] = invalidMinor\njump[0xdf] = invalidMinor\n// 0xe0..0xf3 simple values, unsupported\nfor (let i = 0xe0; i <= 0xf3; i++) {\n  jump[i] = errorer('simple values are not supported')\n}\njump[0xf4] = invalidMinor // false, handled by quick[]\njump[0xf5] = invalidMinor // true, handled by quick[]\njump[0xf6] = invalidMinor // null, handled by quick[]\njump[0xf7] = float.decodeUndefined // undefined\njump[0xf8] = errorer('simple values are not supported') // simple value, one byte follows, unsupported\njump[0xf9] = float.decodeFloat16 // half-precision float (two-byte IEEE 754)\njump[0xfa] = float.decodeFloat32 // single-precision float (four-byte IEEE 754)\njump[0xfb] = float.decodeFloat64 // double-precision float (eight-byte IEEE 754)\njump[0xfc] = invalidMinor\njump[0xfd] = invalidMinor\njump[0xfe] = invalidMinor\njump[0xff] = float.decodeBreak // \"break\" stop code\n\n/** @type {Token[]} */\nexport const quick = []\n// ints <24\nfor (let i = 0; i < 24; i++) {\n  quick[i] = new Token(Type.uint, i, 1)\n}\n// negints >= -24\nfor (let i = -1; i >= -24; i--) {\n  quick[31 - i] = new Token(Type.negint, i, 1)\n}\n// empty bytes\nquick[0x40] = new Token(Type.bytes, new Uint8Array(0), 1)\n// empty string\nquick[0x60] = new Token(Type.string, '', 1)\n// empty list\nquick[0x80] = new Token(Type.array, 0, 1)\n// empty map\nquick[0xa0] = new Token(Type.map, 0, 1)\n// false\nquick[0xf4] = new Token(Type.false, false, 1)\n// true\nquick[0xf5] = new Token(Type.true, true, 1)\n// null\nquick[0xf6] = new Token(Type.null, null, 1)\n\n/**\n * @param {Token} token\n * @returns {Uint8Array|undefined}\n */\nexport function quickEncodeToken (token) {\n  switch (token.type) {\n    case Type.false:\n      return fromArray([0xf4])\n    case Type.true:\n      return fromArray([0xf5])\n    case Type.null:\n      return fromArray([0xf6])\n    case Type.bytes:\n      if (!token.value.length) {\n        return fromArray([0x40])\n      }\n      return\n    case Type.string:\n      if (token.value === '') {\n        return fromArray([0x60])\n      }\n      return\n    case Type.array:\n      if (token.value === 0) {\n        return fromArray([0x80])\n      }\n      /* c8 ignore next 2 */\n      // shouldn't be possible if this were called when there was only one token\n      return\n    case Type.map:\n      if (token.value === 0) {\n        return fromArray([0xa0])\n      }\n      /* c8 ignore next 2 */\n      // shouldn't be possible if this were called when there was only one token\n      return\n    case Type.uint:\n      if (token.value < 24) {\n        return fromArray([Number(token.value)])\n      }\n      return\n    case Type.negint:\n      if (token.value >= -24) {\n        return fromArray([31 - Number(token.value)])\n      }\n  }\n}\n","import { is } from './is.js'\nimport { Token, Type } from './token.js'\nimport { Bl } from './bl.js'\nimport { encodeErrPrefix } from './common.js'\nimport { quickEncodeToken } from './jump.js'\nimport { asU8A } from './byte-utils.js'\n\nimport { encodeUint } from './0uint.js'\nimport { encodeNegint } from './1negint.js'\nimport { encodeBytes } from './2bytes.js'\nimport { encodeString } from './3string.js'\nimport { encodeArray } from './4array.js'\nimport { encodeMap } from './5map.js'\nimport { encodeTag } from './6tag.js'\nimport { encodeFloat } from './7float.js'\n\n/**\n * @typedef {import('../interface').EncodeOptions} EncodeOptions\n * @typedef {import('../interface').OptionalTypeEncoder} OptionalTypeEncoder\n * @typedef {import('../interface').Reference} Reference\n * @typedef {import('../interface').StrictTypeEncoder} StrictTypeEncoder\n * @typedef {import('../interface').TokenTypeEncoder} TokenTypeEncoder\n * @typedef {import('../interface').TokenOrNestedTokens} TokenOrNestedTokens\n */\n\n/** @type {EncodeOptions} */\nconst defaultEncodeOptions = {\n  float64: false,\n  mapSorter,\n  quickEncodeToken\n}\n\n/** @returns {TokenTypeEncoder[]} */\nexport function makeCborEncoders () {\n  const encoders = []\n  encoders[Type.uint.major] = encodeUint\n  encoders[Type.negint.major] = encodeNegint\n  encoders[Type.bytes.major] = encodeBytes\n  encoders[Type.string.major] = encodeString\n  encoders[Type.array.major] = encodeArray\n  encoders[Type.map.major] = encodeMap\n  encoders[Type.tag.major] = encodeTag\n  encoders[Type.float.major] = encodeFloat\n  return encoders\n}\n\nconst cborEncoders = makeCborEncoders()\n\nconst buf = new Bl()\n\n/** @implements {Reference} */\nclass Ref {\n  /**\n   * @param {object|any[]} obj\n   * @param {Reference|undefined} parent\n   */\n  constructor (obj, parent) {\n    this.obj = obj\n    this.parent = parent\n  }\n\n  /**\n   * @param {object|any[]} obj\n   * @returns {boolean}\n   */\n  includes (obj) {\n    /** @type {Reference|undefined} */\n    let p = this\n    do {\n      if (p.obj === obj) {\n        return true\n      }\n    } while (p = p.parent) // eslint-disable-line\n    return false\n  }\n\n  /**\n   * @param {Reference|undefined} stack\n   * @param {object|any[]} obj\n   * @returns {Reference}\n   */\n  static createCheck (stack, obj) {\n    if (stack && stack.includes(obj)) {\n      throw new Error(`${encodeErrPrefix} object contains circular references`)\n    }\n    return new Ref(obj, stack)\n  }\n}\n\nconst simpleTokens = {\n  null: new Token(Type.null, null),\n  undefined: new Token(Type.undefined, undefined),\n  true: new Token(Type.true, true),\n  false: new Token(Type.false, false),\n  emptyArray: new Token(Type.array, 0),\n  emptyMap: new Token(Type.map, 0)\n}\n\n/** @type {{[typeName: string]: StrictTypeEncoder}} */\nconst typeEncoders = {\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  number (obj, _typ, _options, _refStack) {\n    if (!Number.isInteger(obj) || !Number.isSafeInteger(obj)) {\n      return new Token(Type.float, obj)\n    } else if (obj >= 0) {\n      return new Token(Type.uint, obj)\n    } else {\n      return new Token(Type.negint, obj)\n    }\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  bigint (obj, _typ, _options, _refStack) {\n    if (obj >= BigInt(0)) {\n      return new Token(Type.uint, obj)\n    } else {\n      return new Token(Type.negint, obj)\n    }\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  Uint8Array (obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, obj)\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  string (obj, _typ, _options, _refStack) {\n    return new Token(Type.string, obj)\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  boolean (obj, _typ, _options, _refStack) {\n    return obj ? simpleTokens.true : simpleTokens.false\n  },\n\n  /**\n   * @param {any} _obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  null (_obj, _typ, _options, _refStack) {\n    return simpleTokens.null\n  },\n\n  /**\n   * @param {any} _obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  undefined (_obj, _typ, _options, _refStack) {\n    return simpleTokens.undefined\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  ArrayBuffer (obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, new Uint8Array(obj))\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} _options\n   * @param {Reference} [_refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  DataView (obj, _typ, _options, _refStack) {\n    return new Token(Type.bytes, new Uint8Array(obj.buffer, obj.byteOffset, obj.byteLength))\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} _typ\n   * @param {EncodeOptions} options\n   * @param {Reference} [refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  Array (obj, _typ, options, refStack) {\n    if (!obj.length) {\n      if (options.addBreakTokens === true) {\n        return [simpleTokens.emptyArray, new Token(Type.break)]\n      }\n      return simpleTokens.emptyArray\n    }\n    refStack = Ref.createCheck(refStack, obj)\n    const entries = []\n    let i = 0\n    for (const e of obj) {\n      entries[i++] = objectToTokens(e, options, refStack)\n    }\n    if (options.addBreakTokens) {\n      return [new Token(Type.array, obj.length), entries, new Token(Type.break)]\n    }\n    return [new Token(Type.array, obj.length), entries]\n  },\n\n  /**\n   * @param {any} obj\n   * @param {string} typ\n   * @param {EncodeOptions} options\n   * @param {Reference} [refStack]\n   * @returns {TokenOrNestedTokens}\n   */\n  Object (obj, typ, options, refStack) {\n    // could be an Object or a Map\n    const isMap = typ !== 'Object'\n    // it's slightly quicker to use Object.keys() than Object.entries()\n    const keys = isMap ? obj.keys() : Object.keys(obj)\n    const length = isMap ? obj.size : keys.length\n    if (!length) {\n      if (options.addBreakTokens === true) {\n        return [simpleTokens.emptyMap, new Token(Type.break)]\n      }\n      return simpleTokens.emptyMap\n    }\n    refStack = Ref.createCheck(refStack, obj)\n    /** @type {TokenOrNestedTokens[]} */\n    const entries = []\n    let i = 0\n    for (const key of keys) {\n      entries[i++] = [\n        objectToTokens(key, options, refStack),\n        objectToTokens(isMap ? obj.get(key) : obj[key], options, refStack)\n      ]\n    }\n    sortMapEntries(entries, options)\n    if (options.addBreakTokens) {\n      return [new Token(Type.map, length), entries, new Token(Type.break)]\n    }\n    return [new Token(Type.map, length), entries]\n  }\n}\n\ntypeEncoders.Map = typeEncoders.Object\ntypeEncoders.Buffer = typeEncoders.Uint8Array\nfor (const typ of 'Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64'.split(' ')) {\n  typeEncoders[`${typ}Array`] = typeEncoders.DataView\n}\n\n/**\n * @param {any} obj\n * @param {EncodeOptions} [options]\n * @param {Reference} [refStack]\n * @returns {TokenOrNestedTokens}\n */\nfunction objectToTokens (obj, options = {}, refStack) {\n  const typ = is(obj)\n  const customTypeEncoder = (options && options.typeEncoders && /** @type {OptionalTypeEncoder} */ options.typeEncoders[typ]) || typeEncoders[typ]\n  if (typeof customTypeEncoder === 'function') {\n    const tokens = customTypeEncoder(obj, typ, options, refStack)\n    if (tokens != null) {\n      return tokens\n    }\n  }\n  const typeEncoder = typeEncoders[typ]\n  if (!typeEncoder) {\n    throw new Error(`${encodeErrPrefix} unsupported type: ${typ}`)\n  }\n  return typeEncoder(obj, typ, options, refStack)\n}\n\n/*\nCBOR key sorting is a mess.\n\nThe canonicalisation recommendation from https://tools.ietf.org/html/rfc7049#section-3.9\nincludes the wording:\n\n> The keys in every map must be sorted lowest value to highest.\n> Sorting is performed on the bytes of the representation of the key\n> data items without paying attention to the 3/5 bit splitting for\n> major types.\n> ...\n>  *  If two keys have different lengths, the shorter one sorts\n      earlier;\n>  *  If two keys have the same length, the one with the lower value\n      in (byte-wise) lexical order sorts earlier.\n\n1. It is not clear what \"bytes of the representation of the key\" means: is it\n   the CBOR representation, or the binary representation of the object itself?\n   Consider the int and uint difference here.\n2. It is not clear what \"without paying attention to\" means: do we include it\n   and compare on that? Or do we omit the special prefix byte, (mostly) treating\n   the key in its plain binary representation form.\n\nThe FIDO 2.0: Client To Authenticator Protocol spec takes the original CBOR\nwording and clarifies it according to their understanding.\nhttps://fidoalliance.org/specs/fido-v2.0-rd-20170927/fido-client-to-authenticator-protocol-v2.0-rd-20170927.html#message-encoding\n\n> The keys in every map must be sorted lowest value to highest. Sorting is\n> performed on the bytes of the representation of the key data items without\n> paying attention to the 3/5 bit splitting for major types. The sorting rules\n> are:\n>  * If the major types are different, the one with the lower value in numerical\n>    order sorts earlier.\n>  * If two keys have different lengths, the shorter one sorts earlier;\n>  * If two keys have the same length, the one with the lower value in\n>    (byte-wise) lexical order sorts earlier.\n\nSome other implementations, such as borc, do a full encode then do a\nlength-first, byte-wise-second comparison:\nhttps://github.com/dignifiedquire/borc/blob/b6bae8b0bcde7c3976b0f0f0957208095c392a36/src/encoder.js#L358\nhttps://github.com/dignifiedquire/borc/blob/b6bae8b0bcde7c3976b0f0f0957208095c392a36/src/utils.js#L143-L151\n\nThis has the benefit of being able to easily handle arbitrary keys, including\ncomplex types (maps and arrays).\n\nWe'll opt for the FIDO approach, since it affords some efficies since we don't\nneed a full encode of each key to determine order and can defer to the types\nto determine how to most efficiently order their values (i.e. int and uint\nordering can be done on the numbers, no need for byte-wise, for example).\n\nRecommendation: stick to single key types or you'll get into trouble, and prefer\nstring keys because it's much simpler that way.\n*/\n\n/*\n(UPDATE, Dec 2020)\nhttps://tools.ietf.org/html/rfc8949 is the updated CBOR spec and clarifies some\nof the questions above with a new recommendation for sorting order being much\ncloser to what would be expected in other environments (i.e. no length-first\nweirdness).\nThis new sorting order is not yet implemented here but could be added as an\noption. \"Determinism\" (canonicity) is system dependent and it's difficult to\nchange existing systems that are built with existing expectations. So if a new\nordering is introduced here, the old needs to be kept as well with the user\nhaving the option.\n*/\n\n/**\n * @param {TokenOrNestedTokens[]} entries\n * @param {EncodeOptions} options\n */\nfunction sortMapEntries (entries, options) {\n  if (options.mapSorter) {\n    entries.sort(options.mapSorter)\n  }\n}\n\n/**\n * @param {(Token|Token[])[]} e1\n * @param {(Token|Token[])[]} e2\n * @returns {number}\n */\nfunction mapSorter (e1, e2) {\n  // the key position ([0]) could have a single token or an array\n  // almost always it'll be a single token but complex key might get involved\n  /* c8 ignore next 2 */\n  const keyToken1 = Array.isArray(e1[0]) ? e1[0][0] : e1[0]\n  const keyToken2 = Array.isArray(e2[0]) ? e2[0][0] : e2[0]\n\n  // different key types\n  if (keyToken1.type !== keyToken2.type) {\n    return keyToken1.type.compare(keyToken2.type)\n  }\n\n  const major = keyToken1.type.major\n  // TODO: handle case where cmp === 0 but there are more keyToken e. complex type)\n  const tcmp = cborEncoders[major].compareTokens(keyToken1, keyToken2)\n  /* c8 ignore next 5 */\n  if (tcmp === 0) {\n    // duplicate key or complex type where the first token matched,\n    // i.e. a map or array and we're only comparing the opening token\n    console.warn('WARNING: complex key types used, CBOR key sorting guarantees are gone')\n  }\n  return tcmp\n}\n\n/**\n * @param {Bl} buf\n * @param {TokenOrNestedTokens} tokens\n * @param {TokenTypeEncoder[]} encoders\n * @param {EncodeOptions} options\n */\nfunction tokensToEncoded (buf, tokens, encoders, options) {\n  if (Array.isArray(tokens)) {\n    for (const token of tokens) {\n      tokensToEncoded(buf, token, encoders, options)\n    }\n  } else {\n    encoders[tokens.type.major](buf, tokens, options)\n  }\n}\n\n/**\n * @param {any} data\n * @param {TokenTypeEncoder[]} encoders\n * @param {EncodeOptions} options\n * @returns {Uint8Array}\n */\nfunction encodeCustom (data, encoders, options) {\n  const tokens = objectToTokens(data, options)\n  if (!Array.isArray(tokens) && options.quickEncodeToken) {\n    const quickBytes = options.quickEncodeToken(tokens)\n    if (quickBytes) {\n      return quickBytes\n    }\n    const encoder = encoders[tokens.type.major]\n    if (encoder.encodedSize) {\n      const size = encoder.encodedSize(tokens, options)\n      const buf = new Bl(size)\n      encoder(buf, tokens, options)\n      /* c8 ignore next 4 */\n      // this would be a problem with encodedSize() functions\n      if (buf.chunks.length !== 1) {\n        throw new Error(`Unexpected error: pre-calculated length for ${tokens} was wrong`)\n      }\n      return asU8A(buf.chunks[0])\n    }\n  }\n  buf.reset()\n  tokensToEncoded(buf, tokens, encoders, options)\n  return buf.toBytes(true)\n}\n\n/**\n * @param {any} data\n * @param {EncodeOptions} [options]\n * @returns {Uint8Array}\n */\nfunction encode (data, options) {\n  options = Object.assign({}, defaultEncodeOptions, options)\n  return encodeCustom(data, cborEncoders, options)\n}\n\nexport { objectToTokens, encode, encodeCustom, Ref }\n","import { decodeErrPrefix } from './common.js'\nimport { Type } from './token.js'\nimport { jump, quick } from './jump.js'\n\n/**\n * @typedef {import('./token.js').Token} Token\n * @typedef {import('../interface').DecodeOptions} DecodeOptions\n * @typedef {import('../interface').DecodeTokenizer} DecodeTokenizer\n */\n\nconst defaultDecodeOptions = {\n  strict: false,\n  allowIndefinite: true,\n  allowUndefined: true,\n  allowBigInt: true\n}\n\n/**\n * @implements {DecodeTokenizer}\n */\nclass Tokeniser {\n  /**\n   * @param {Uint8Array} data\n   * @param {DecodeOptions} options\n   */\n  constructor (data, options = {}) {\n    this._pos = 0\n    this.data = data\n    this.options = options\n  }\n\n  pos () {\n    return this._pos\n  }\n\n  done () {\n    return this._pos >= this.data.length\n  }\n\n  next () {\n    const byt = this.data[this._pos]\n    let token = quick[byt]\n    if (token === undefined) {\n      const decoder = jump[byt]\n      /* c8 ignore next 4 */\n      // if we're here then there's something wrong with our jump or quick lists!\n      if (!decoder) {\n        throw new Error(`${decodeErrPrefix} no decoder for major type ${byt >>> 5} (byte 0x${byt.toString(16).padStart(2, '0')})`)\n      }\n      const minor = byt & 31\n      token = decoder(this.data, this._pos, minor, this.options)\n    }\n    // @ts-ignore we get to assume encodedLength is set (crossing fingers slightly)\n    this._pos += token.encodedLength\n    return token\n  }\n}\n\nconst DONE = Symbol.for('DONE')\nconst BREAK = Symbol.for('BREAK')\n\n/**\n * @param {Token} token\n * @param {DecodeTokenizer} tokeniser\n * @param {DecodeOptions} options\n * @returns {any|BREAK|DONE}\n */\nfunction tokenToArray (token, tokeniser, options) {\n  const arr = []\n  for (let i = 0; i < token.value; i++) {\n    const value = tokensToObject(tokeniser, options)\n    if (value === BREAK) {\n      if (token.value === Infinity) {\n        // normal end to indefinite length array\n        break\n      }\n      throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)\n    }\n    if (value === DONE) {\n      throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${i}, expected ${token.value})`)\n    }\n    arr[i] = value\n  }\n  return arr\n}\n\n/**\n * @param {Token} token\n * @param {DecodeTokenizer} tokeniser\n * @param {DecodeOptions} options\n * @returns {any|BREAK|DONE}\n */\nfunction tokenToMap (token, tokeniser, options) {\n  const useMaps = options.useMaps === true\n  const obj = useMaps ? undefined : {}\n  const m = useMaps ? new Map() : undefined\n  for (let i = 0; i < token.value; i++) {\n    const key = tokensToObject(tokeniser, options)\n    if (key === BREAK) {\n      if (token.value === Infinity) {\n        // normal end to indefinite length map\n        break\n      }\n      throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)\n    }\n    if (key === DONE) {\n      throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${i} [no key], expected ${token.value})`)\n    }\n    if (useMaps !== true && typeof key !== 'string') {\n      throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof key})`)\n    }\n    if (options.rejectDuplicateMapKeys === true) {\n      // @ts-ignore\n      if ((useMaps && m.has(key)) || (!useMaps && (key in obj))) {\n        throw new Error(`${decodeErrPrefix} found repeat map key \"${key}\"`)\n      }\n    }\n    const value = tokensToObject(tokeniser, options)\n    if (value === DONE) {\n      throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${i} [no value], expected ${token.value})`)\n    }\n    if (useMaps) {\n      // @ts-ignore TODO reconsider this .. maybe needs to be strict about key types\n      m.set(key, value)\n    } else {\n      // @ts-ignore TODO reconsider this .. maybe needs to be strict about key types\n      obj[key] = value\n    }\n  }\n  // @ts-ignore c'mon man\n  return useMaps ? m : obj\n}\n\n/**\n * @param {DecodeTokenizer} tokeniser\n * @param {DecodeOptions} options\n * @returns {any|BREAK|DONE}\n */\nfunction tokensToObject (tokeniser, options) {\n  // should we support array as an argument?\n  // check for tokenIter[Symbol.iterator] and replace tokenIter with what that returns?\n  if (tokeniser.done()) {\n    return DONE\n  }\n\n  const token = tokeniser.next()\n\n  if (token.type === Type.break) {\n    return BREAK\n  }\n\n  if (token.type.terminal) {\n    return token.value\n  }\n\n  if (token.type === Type.array) {\n    return tokenToArray(token, tokeniser, options)\n  }\n\n  if (token.type === Type.map) {\n    return tokenToMap(token, tokeniser, options)\n  }\n\n  if (token.type === Type.tag) {\n    if (options.tags && typeof options.tags[token.value] === 'function') {\n      const tagged = tokensToObject(tokeniser, options)\n      return options.tags[token.value](tagged)\n    }\n    throw new Error(`${decodeErrPrefix} tag not supported (${token.value})`)\n  }\n  /* c8 ignore next */\n  throw new Error('unsupported')\n}\n\n/**\n * @param {Uint8Array} data\n * @param {DecodeOptions} [options]\n * @returns {[any, Uint8Array]}\n */\nfunction decodeFirst (data, options) {\n  if (!(data instanceof Uint8Array)) {\n    throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`)\n  }\n  options = Object.assign({}, defaultDecodeOptions, options)\n  const tokeniser = options.tokenizer || new Tokeniser(data, options)\n  const decoded = tokensToObject(tokeniser, options)\n  if (decoded === DONE) {\n    throw new Error(`${decodeErrPrefix} did not find any content to decode`)\n  }\n  if (decoded === BREAK) {\n    throw new Error(`${decodeErrPrefix} got unexpected break`)\n  }\n  return [decoded, data.subarray(tokeniser.pos())]\n}\n\n/**\n * @param {Uint8Array} data\n * @param {DecodeOptions} [options]\n * @returns {any}\n */\nfunction decode (data, options) {\n  const [decoded, remainder] = decodeFirst(data, options)\n  if (remainder.length > 0) {\n    throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`)\n  }\n  return decoded\n}\n\nexport { Tokeniser, tokensToObject, decode, decodeFirst }\n","import { nanoid } from 'nanoid';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nconst pathSepS = '/';\nconst pathSepB = new TextEncoder().encode(pathSepS);\nconst pathSep = pathSepB[0];\n/**\n * A Key represents the unique identifier of an object.\n * Our Key scheme is inspired by file systems and Google App Engine key model.\n * Keys are meant to be unique across a system. Keys are hierarchical,\n * incorporating more and more specific namespaces. Thus keys can be deemed\n * 'children' or 'ancestors' of other keys:\n * - `new Key('/Comedy')`\n * - `new Key('/Comedy/MontyPython')`\n * Also, every namespace can be parametrized to embed relevant object\n * information. For example, the Key `name` (most specific namespace) could\n * include the object type:\n * - `new Key('/Comedy/MontyPython/Actor:JohnCleese')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop/Character:Mousebender')`\n *\n */\nexport class Key {\n    /**\n     * @param {string | Uint8Array} s\n     * @param {boolean} [clean]\n     */\n    constructor(s, clean) {\n        if (typeof s === 'string') {\n            this._buf = uint8ArrayFromString(s);\n        }\n        else if (s instanceof Uint8Array) {\n            this._buf = s;\n        }\n        else {\n            throw new Error('Invalid key, should be String of Uint8Array');\n        }\n        if (clean == null) {\n            clean = true;\n        }\n        if (clean) {\n            this.clean();\n        }\n        if (this._buf.byteLength === 0 || this._buf[0] !== pathSep) {\n            throw new Error('Invalid key');\n        }\n    }\n    /**\n     * Convert to the string representation\n     *\n     * @param {import('uint8arrays/to-string').SupportedEncodings} [encoding='utf8'] - The encoding to use.\n     * @returns {string}\n     */\n    toString(encoding = 'utf8') {\n        return uint8ArrayToString(this._buf, encoding);\n    }\n    /**\n     * Return the Uint8Array representation of the key\n     *\n     * @returns {Uint8Array}\n     */\n    uint8Array() {\n        return this._buf;\n    }\n    /**\n     * Return string representation of the key\n     *\n     * @returns {string}\n     */\n    get [Symbol.toStringTag]() {\n        return `Key(${this.toString()})`;\n    }\n    /**\n     * Constructs a key out of a namespace array.\n     *\n     * @param {Array<string>} list - The array of namespaces\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.withNamespaces(['one', 'two'])\n     * // => Key('/one/two')\n     * ```\n     */\n    static withNamespaces(list) {\n        return new Key(list.join(pathSepS));\n    }\n    /**\n     * Returns a randomly (uuid) generated key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * Key.random()\n     * // => Key('/f98719ea086343f7b71f32ea9d9d521d')\n     * ```\n     */\n    static random() {\n        return new Key(nanoid().replace(/-/g, ''));\n    }\n    /**\n     * @param {*} other\n     */\n    static asKey(other) {\n        if (other instanceof Uint8Array || typeof other === 'string') {\n            // we can create a key from this\n            return new Key(other);\n        }\n        if (typeof other.uint8Array === 'function') {\n            // this is an older version or may have crossed the esm/cjs boundary\n            return new Key(other.uint8Array());\n        }\n        return null;\n    }\n    /**\n     * Cleanup the current key\n     *\n     * @returns {void}\n     */\n    clean() {\n        if (this._buf == null || this._buf.byteLength === 0) {\n            this._buf = pathSepB;\n        }\n        if (this._buf[0] !== pathSep) {\n            const bytes = new Uint8Array(this._buf.byteLength + 1);\n            bytes.fill(pathSep, 0, 1);\n            bytes.set(this._buf, 1);\n            this._buf = bytes;\n        }\n        // normalize does not remove trailing slashes\n        while (this._buf.byteLength > 1 && this._buf[this._buf.byteLength - 1] === pathSep) {\n            this._buf = this._buf.subarray(0, -1);\n        }\n    }\n    /**\n     * Check if the given key is sorted lower than ourself.\n     *\n     * @param {Key} key - The other Key to check against\n     * @returns {boolean}\n     */\n    less(key) {\n        const list1 = this.list();\n        const list2 = key.list();\n        for (let i = 0; i < list1.length; i++) {\n            if (list2.length < i + 1) {\n                return false;\n            }\n            const c1 = list1[i];\n            const c2 = list2[i];\n            if (c1 < c2) {\n                return true;\n            }\n            else if (c1 > c2) {\n                return false;\n            }\n        }\n        return list1.length < list2.length;\n    }\n    /**\n     * Returns the key with all parts in reversed order.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').reverse()\n     * // => Key('/Actor:JohnCleese/MontyPython/Comedy')\n     * ```\n     */\n    reverse() {\n        return Key.withNamespaces(this.list().slice().reverse());\n    }\n    /**\n     * Returns the `namespaces` making up this Key.\n     *\n     * @returns {Array<string>}\n     */\n    namespaces() {\n        return this.list();\n    }\n    /** Returns the \"base\" namespace of this key.\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').baseNamespace()\n     * // => 'Actor:JohnCleese'\n     * ```\n     */\n    baseNamespace() {\n        const ns = this.namespaces();\n        return ns[ns.length - 1];\n    }\n    /**\n     * Returns the `list` representation of this key.\n     *\n     * @returns {Array<string>}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').list()\n     * // => ['Comedy', 'MontyPythong', 'Actor:JohnCleese']\n     * ```\n     */\n    list() {\n        return this.toString().split(pathSepS).slice(1);\n    }\n    /**\n     * Returns the \"type\" of this key (value of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').type()\n     * // => 'Actor'\n     * ```\n     */\n    type() {\n        return namespaceType(this.baseNamespace());\n    }\n    /**\n     * Returns the \"name\" of this key (field of last namespace).\n     *\n     * @returns {string}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').name()\n     * // => 'JohnCleese'\n     * ```\n     */\n    name() {\n        return namespaceValue(this.baseNamespace());\n    }\n    /**\n     * Returns an \"instance\" of this type key (appends value to namespace).\n     *\n     * @param {string} s - The string to append.\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor').instance('JohnClesse')\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    instance(s) {\n        return new Key(this.toString() + ':' + s);\n    }\n    /**\n     * Returns the \"path\" of this key (parent + type).\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython/Actor:JohnCleese').path()\n     * // => Key('/Comedy/MontyPython/Actor')\n     * ```\n     */\n    path() {\n        let p = this.parent().toString();\n        if (!p.endsWith(pathSepS)) {\n            p += pathSepS;\n        }\n        p += this.type();\n        return new Key(p);\n    }\n    /**\n     * Returns the `parent` Key of this Key.\n     *\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key(\"/Comedy/MontyPython/Actor:JohnCleese\").parent()\n     * // => Key(\"/Comedy/MontyPython\")\n     * ```\n     */\n    parent() {\n        const list = this.list();\n        if (list.length === 1) {\n            return new Key(pathSepS);\n        }\n        return new Key(list.slice(0, -1).join(pathSepS));\n    }\n    /**\n     * Returns the `child` Key of this Key.\n     *\n     * @param {Key} key - The child Key to add\n     * @returns {Key}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').child(new Key('Actor:JohnCleese'))\n     * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n     * ```\n     */\n    child(key) {\n        if (this.toString() === pathSepS) {\n            return key;\n        }\n        else if (key.toString() === pathSepS) {\n            return this;\n        }\n        return new Key(this.toString() + key.toString(), false);\n    }\n    /**\n     * Returns whether this key is a prefix of `other`\n     *\n     * @param {Key} other - The other key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy').isAncestorOf('/Comedy/MontyPython')\n     * // => true\n     * ```\n     */\n    isAncestorOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return other.toString().startsWith(this.toString());\n    }\n    /**\n     * Returns whether this key is a contains another as prefix.\n     *\n     * @param {Key} other - The other Key to test against\n     * @returns {boolean}\n     *\n     * @example\n     * ```js\n     * new Key('/Comedy/MontyPython').isDecendantOf('/Comedy')\n     * // => true\n     * ```\n     */\n    isDecendantOf(other) {\n        if (other.toString() === this.toString()) {\n            return false;\n        }\n        return this.toString().startsWith(other.toString());\n    }\n    /**\n     * Checks if this key has only one namespace.\n     *\n     * @returns {boolean}\n     *\n     */\n    isTopLevel() {\n        return this.list().length === 1;\n    }\n    /**\n     * Concats one or more Keys into one new Key.\n     *\n     * @param {Array<Key>} keys - The array of keys to concatenate\n     * @returns {Key}\n     */\n    concat(...keys) {\n        return Key.withNamespaces([...this.namespaces(), ...flatten(keys.map(key => key.namespaces()))]);\n    }\n}\n/**\n * The first component of a namespace. `foo` in `foo:bar`\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceType(ns) {\n    const parts = ns.split(':');\n    if (parts.length < 2) {\n        return '';\n    }\n    return parts.slice(0, -1).join(':');\n}\n/**\n * The last component of a namespace, `baz` in `foo:bar:baz`.\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceValue(ns) {\n    const parts = ns.split(':');\n    return parts[parts.length - 1];\n}\n/**\n * Flatten array of arrays (only one level)\n *\n * @template T\n * @param {Array<any>} arr\n * @returns {T[]}\n */\nfunction flatten(arr) {\n    return ([]).concat(...arr);\n}\n//# sourceMappingURL=key.js.map","import { baseX } from './base.js'\n\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n})\n\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n})\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _PriorityQueue_queue;\nimport lowerBound from './lower-bound.js';\nclass PriorityQueue {\n    constructor() {\n        _PriorityQueue_queue.set(this, []);\n    }\n    enqueue(run, options) {\n        options = {\n            priority: 0,\n            ...options,\n        };\n        const element = {\n            priority: options.priority,\n            run,\n        };\n        if (this.size && __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\")[this.size - 1].priority >= options.priority) {\n            __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\").push(element);\n            return;\n        }\n        const index = lowerBound(__classPrivateFieldGet(this, _PriorityQueue_queue, \"f\"), element, (a, b) => b.priority - a.priority);\n        __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\").splice(index, 0, element);\n    }\n    dequeue() {\n        const item = __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\").shift();\n        return item === null || item === void 0 ? void 0 : item.run;\n    }\n    filter(options) {\n        return __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\").filter((element) => element.priority === options.priority).map((element) => element.run);\n    }\n    get size() {\n        return __classPrivateFieldGet(this, _PriorityQueue_queue, \"f\").length;\n    }\n}\n_PriorityQueue_queue = new WeakMap();\nexport default PriorityQueue;\n","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _PQueue_instances, _PQueue_carryoverConcurrencyCount, _PQueue_isIntervalIgnored, _PQueue_intervalCount, _PQueue_intervalCap, _PQueue_interval, _PQueue_intervalEnd, _PQueue_intervalId, _PQueue_timeoutId, _PQueue_queue, _PQueue_queueClass, _PQueue_pending, _PQueue_concurrency, _PQueue_isPaused, _PQueue_throwOnTimeout, _PQueue_doesIntervalAllowAnother_get, _PQueue_doesConcurrentAllowAnother_get, _PQueue_next, _PQueue_onResumeInterval, _PQueue_isIntervalPaused_get, _PQueue_tryToStartAnother, _PQueue_initializeIntervalIfNeeded, _PQueue_onInterval, _PQueue_processQueue, _PQueue_throwOnAbort, _PQueue_onEvent;\nimport { EventEmitter } from 'eventemitter3';\nimport pTimeout, { TimeoutError } from 'p-timeout';\nimport PriorityQueue from './priority-queue.js';\n/**\nThe error thrown by `queue.add()` when a job is aborted before it is run. See `signal`.\n*/\nexport class AbortError extends Error {\n}\n/**\nPromise queue with concurrency control.\n*/\nclass PQueue extends EventEmitter {\n    // TODO: The `throwOnTimeout` option should affect the return types of `add()` and `addAll()`\n    constructor(options) {\n        var _a, _b, _c, _d;\n        super();\n        _PQueue_instances.add(this);\n        _PQueue_carryoverConcurrencyCount.set(this, void 0);\n        _PQueue_isIntervalIgnored.set(this, void 0);\n        _PQueue_intervalCount.set(this, 0);\n        _PQueue_intervalCap.set(this, void 0);\n        _PQueue_interval.set(this, void 0);\n        _PQueue_intervalEnd.set(this, 0);\n        _PQueue_intervalId.set(this, void 0);\n        _PQueue_timeoutId.set(this, void 0);\n        _PQueue_queue.set(this, void 0);\n        _PQueue_queueClass.set(this, void 0);\n        _PQueue_pending.set(this, 0);\n        // The `!` is needed because of https://github.com/microsoft/TypeScript/issues/32194\n        _PQueue_concurrency.set(this, void 0);\n        _PQueue_isPaused.set(this, void 0);\n        _PQueue_throwOnTimeout.set(this, void 0);\n        /**\n        Per-operation timeout in milliseconds. Operations fulfill once `timeout` elapses if they haven't already.\n    \n        Applies to each future operation.\n        */\n        Object.defineProperty(this, \"timeout\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        options = {\n            carryoverConcurrencyCount: false,\n            intervalCap: Number.POSITIVE_INFINITY,\n            interval: 0,\n            concurrency: Number.POSITIVE_INFINITY,\n            autoStart: true,\n            queueClass: PriorityQueue,\n            ...options,\n        };\n        if (!(typeof options.intervalCap === 'number' && options.intervalCap >= 1)) {\n            throw new TypeError(`Expected \\`intervalCap\\` to be a number from 1 and up, got \\`${(_b = (_a = options.intervalCap) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : ''}\\` (${typeof options.intervalCap})`);\n        }\n        if (options.interval === undefined || !(Number.isFinite(options.interval) && options.interval >= 0)) {\n            throw new TypeError(`Expected \\`interval\\` to be a finite number >= 0, got \\`${(_d = (_c = options.interval) === null || _c === void 0 ? void 0 : _c.toString()) !== null && _d !== void 0 ? _d : ''}\\` (${typeof options.interval})`);\n        }\n        __classPrivateFieldSet(this, _PQueue_carryoverConcurrencyCount, options.carryoverConcurrencyCount, \"f\");\n        __classPrivateFieldSet(this, _PQueue_isIntervalIgnored, options.intervalCap === Number.POSITIVE_INFINITY || options.interval === 0, \"f\");\n        __classPrivateFieldSet(this, _PQueue_intervalCap, options.intervalCap, \"f\");\n        __classPrivateFieldSet(this, _PQueue_interval, options.interval, \"f\");\n        __classPrivateFieldSet(this, _PQueue_queue, new options.queueClass(), \"f\");\n        __classPrivateFieldSet(this, _PQueue_queueClass, options.queueClass, \"f\");\n        this.concurrency = options.concurrency;\n        this.timeout = options.timeout;\n        __classPrivateFieldSet(this, _PQueue_throwOnTimeout, options.throwOnTimeout === true, \"f\");\n        __classPrivateFieldSet(this, _PQueue_isPaused, options.autoStart === false, \"f\");\n    }\n    get concurrency() {\n        return __classPrivateFieldGet(this, _PQueue_concurrency, \"f\");\n    }\n    set concurrency(newConcurrency) {\n        if (!(typeof newConcurrency === 'number' && newConcurrency >= 1)) {\n            throw new TypeError(`Expected \\`concurrency\\` to be a number from 1 and up, got \\`${newConcurrency}\\` (${typeof newConcurrency})`);\n        }\n        __classPrivateFieldSet(this, _PQueue_concurrency, newConcurrency, \"f\");\n        __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_processQueue).call(this);\n    }\n    async add(function_, options = {}) {\n        options = {\n            timeout: this.timeout,\n            throwOnTimeout: __classPrivateFieldGet(this, _PQueue_throwOnTimeout, \"f\"),\n            ...options,\n        };\n        return new Promise((resolve, reject) => {\n            __classPrivateFieldGet(this, _PQueue_queue, \"f\").enqueue(async () => {\n                var _a;\n                var _b, _c;\n                __classPrivateFieldSet(this, _PQueue_pending, (_b = __classPrivateFieldGet(this, _PQueue_pending, \"f\"), _b++, _b), \"f\");\n                __classPrivateFieldSet(this, _PQueue_intervalCount, (_c = __classPrivateFieldGet(this, _PQueue_intervalCount, \"f\"), _c++, _c), \"f\");\n                try {\n                    // TODO: Use options.signal?.throwIfAborted() when targeting Node.js 18\n                    if ((_a = options.signal) === null || _a === void 0 ? void 0 : _a.aborted) {\n                        // TODO: Use ABORT_ERR code when targeting Node.js 16 (https://nodejs.org/docs/latest-v16.x/api/errors.html#abort_err)\n                        throw new AbortError('The task was aborted.');\n                    }\n                    let operation = function_({ signal: options.signal });\n                    if (options.timeout) {\n                        operation = pTimeout(Promise.resolve(operation), options.timeout);\n                    }\n                    if (options.signal) {\n                        operation = Promise.race([operation, __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_throwOnAbort).call(this, options.signal)]);\n                    }\n                    const result = await operation;\n                    resolve(result);\n                    this.emit('completed', result);\n                }\n                catch (error) {\n                    if (error instanceof TimeoutError && !options.throwOnTimeout) {\n                        resolve();\n                        return;\n                    }\n                    reject(error);\n                    this.emit('error', error);\n                }\n                finally {\n                    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_next).call(this);\n                }\n            }, options);\n            this.emit('add');\n            __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_tryToStartAnother).call(this);\n        });\n    }\n    async addAll(functions, options) {\n        return Promise.all(functions.map(async (function_) => this.add(function_, options)));\n    }\n    /**\n    Start (or resume) executing enqueued tasks within concurrency limit. No need to call this if queue is not paused (via `options.autoStart = false` or by `.pause()` method.)\n    */\n    start() {\n        if (!__classPrivateFieldGet(this, _PQueue_isPaused, \"f\")) {\n            return this;\n        }\n        __classPrivateFieldSet(this, _PQueue_isPaused, false, \"f\");\n        __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_processQueue).call(this);\n        return this;\n    }\n    /**\n    Put queue execution on hold.\n    */\n    pause() {\n        __classPrivateFieldSet(this, _PQueue_isPaused, true, \"f\");\n    }\n    /**\n    Clear the queue.\n    */\n    clear() {\n        __classPrivateFieldSet(this, _PQueue_queue, new (__classPrivateFieldGet(this, _PQueue_queueClass, \"f\"))(), \"f\");\n    }\n    /**\n    Can be called multiple times. Useful if you for example add additional items at a later time.\n\n    @returns A promise that settles when the queue becomes empty.\n    */\n    async onEmpty() {\n        // Instantly resolve if the queue is empty\n        if (__classPrivateFieldGet(this, _PQueue_queue, \"f\").size === 0) {\n            return;\n        }\n        await __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onEvent).call(this, 'empty');\n    }\n    /**\n    @returns A promise that settles when the queue size is less than the given limit: `queue.size < limit`.\n\n    If you want to avoid having the queue grow beyond a certain size you can `await queue.onSizeLessThan()` before adding a new item.\n\n    Note that this only limits the number of items waiting to start. There could still be up to `concurrency` jobs already running that this call does not include in its calculation.\n    */\n    async onSizeLessThan(limit) {\n        // Instantly resolve if the queue is empty.\n        if (__classPrivateFieldGet(this, _PQueue_queue, \"f\").size < limit) {\n            return;\n        }\n        await __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onEvent).call(this, 'next', () => __classPrivateFieldGet(this, _PQueue_queue, \"f\").size < limit);\n    }\n    /**\n    The difference with `.onEmpty` is that `.onIdle` guarantees that all work from the queue has finished. `.onEmpty` merely signals that the queue is empty, but it could mean that some promises haven't completed yet.\n\n    @returns A promise that settles when the queue becomes empty, and all promises have completed; `queue.size === 0 && queue.pending === 0`.\n    */\n    async onIdle() {\n        // Instantly resolve if none pending and if nothing else is queued\n        if (__classPrivateFieldGet(this, _PQueue_pending, \"f\") === 0 && __classPrivateFieldGet(this, _PQueue_queue, \"f\").size === 0) {\n            return;\n        }\n        await __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onEvent).call(this, 'idle');\n    }\n    /**\n    Size of the queue, the number of queued items waiting to run.\n    */\n    get size() {\n        return __classPrivateFieldGet(this, _PQueue_queue, \"f\").size;\n    }\n    /**\n    Size of the queue, filtered by the given options.\n\n    For example, this can be used to find the number of items remaining in the queue with a specific priority level.\n    */\n    sizeBy(options) {\n        // eslint-disable-next-line unicorn/no-array-callback-reference\n        return __classPrivateFieldGet(this, _PQueue_queue, \"f\").filter(options).length;\n    }\n    /**\n    Number of running items (no longer in the queue).\n    */\n    get pending() {\n        return __classPrivateFieldGet(this, _PQueue_pending, \"f\");\n    }\n    /**\n    Whether the queue is currently paused.\n    */\n    get isPaused() {\n        return __classPrivateFieldGet(this, _PQueue_isPaused, \"f\");\n    }\n}\n_PQueue_carryoverConcurrencyCount = new WeakMap(), _PQueue_isIntervalIgnored = new WeakMap(), _PQueue_intervalCount = new WeakMap(), _PQueue_intervalCap = new WeakMap(), _PQueue_interval = new WeakMap(), _PQueue_intervalEnd = new WeakMap(), _PQueue_intervalId = new WeakMap(), _PQueue_timeoutId = new WeakMap(), _PQueue_queue = new WeakMap(), _PQueue_queueClass = new WeakMap(), _PQueue_pending = new WeakMap(), _PQueue_concurrency = new WeakMap(), _PQueue_isPaused = new WeakMap(), _PQueue_throwOnTimeout = new WeakMap(), _PQueue_instances = new WeakSet(), _PQueue_doesIntervalAllowAnother_get = function _PQueue_doesIntervalAllowAnother_get() {\n    return __classPrivateFieldGet(this, _PQueue_isIntervalIgnored, \"f\") || __classPrivateFieldGet(this, _PQueue_intervalCount, \"f\") < __classPrivateFieldGet(this, _PQueue_intervalCap, \"f\");\n}, _PQueue_doesConcurrentAllowAnother_get = function _PQueue_doesConcurrentAllowAnother_get() {\n    return __classPrivateFieldGet(this, _PQueue_pending, \"f\") < __classPrivateFieldGet(this, _PQueue_concurrency, \"f\");\n}, _PQueue_next = function _PQueue_next() {\n    var _a;\n    __classPrivateFieldSet(this, _PQueue_pending, (_a = __classPrivateFieldGet(this, _PQueue_pending, \"f\"), _a--, _a), \"f\");\n    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_tryToStartAnother).call(this);\n    this.emit('next');\n}, _PQueue_onResumeInterval = function _PQueue_onResumeInterval() {\n    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onInterval).call(this);\n    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_initializeIntervalIfNeeded).call(this);\n    __classPrivateFieldSet(this, _PQueue_timeoutId, undefined, \"f\");\n}, _PQueue_isIntervalPaused_get = function _PQueue_isIntervalPaused_get() {\n    const now = Date.now();\n    if (__classPrivateFieldGet(this, _PQueue_intervalId, \"f\") === undefined) {\n        const delay = __classPrivateFieldGet(this, _PQueue_intervalEnd, \"f\") - now;\n        if (delay < 0) {\n            // Act as the interval was done\n            // We don't need to resume it here because it will be resumed on line 160\n            __classPrivateFieldSet(this, _PQueue_intervalCount, (__classPrivateFieldGet(this, _PQueue_carryoverConcurrencyCount, \"f\")) ? __classPrivateFieldGet(this, _PQueue_pending, \"f\") : 0, \"f\");\n        }\n        else {\n            // Act as the interval is pending\n            if (__classPrivateFieldGet(this, _PQueue_timeoutId, \"f\") === undefined) {\n                __classPrivateFieldSet(this, _PQueue_timeoutId, setTimeout(() => {\n                    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onResumeInterval).call(this);\n                }, delay), \"f\");\n            }\n            return true;\n        }\n    }\n    return false;\n}, _PQueue_tryToStartAnother = function _PQueue_tryToStartAnother() {\n    if (__classPrivateFieldGet(this, _PQueue_queue, \"f\").size === 0) {\n        // We can clear the interval (\"pause\")\n        // Because we can redo it later (\"resume\")\n        if (__classPrivateFieldGet(this, _PQueue_intervalId, \"f\")) {\n            clearInterval(__classPrivateFieldGet(this, _PQueue_intervalId, \"f\"));\n        }\n        __classPrivateFieldSet(this, _PQueue_intervalId, undefined, \"f\");\n        this.emit('empty');\n        if (__classPrivateFieldGet(this, _PQueue_pending, \"f\") === 0) {\n            this.emit('idle');\n        }\n        return false;\n    }\n    if (!__classPrivateFieldGet(this, _PQueue_isPaused, \"f\")) {\n        const canInitializeInterval = !__classPrivateFieldGet(this, _PQueue_instances, \"a\", _PQueue_isIntervalPaused_get);\n        if (__classPrivateFieldGet(this, _PQueue_instances, \"a\", _PQueue_doesIntervalAllowAnother_get) && __classPrivateFieldGet(this, _PQueue_instances, \"a\", _PQueue_doesConcurrentAllowAnother_get)) {\n            const job = __classPrivateFieldGet(this, _PQueue_queue, \"f\").dequeue();\n            if (!job) {\n                return false;\n            }\n            this.emit('active');\n            job();\n            if (canInitializeInterval) {\n                __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_initializeIntervalIfNeeded).call(this);\n            }\n            return true;\n        }\n    }\n    return false;\n}, _PQueue_initializeIntervalIfNeeded = function _PQueue_initializeIntervalIfNeeded() {\n    if (__classPrivateFieldGet(this, _PQueue_isIntervalIgnored, \"f\") || __classPrivateFieldGet(this, _PQueue_intervalId, \"f\") !== undefined) {\n        return;\n    }\n    __classPrivateFieldSet(this, _PQueue_intervalId, setInterval(() => {\n        __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_onInterval).call(this);\n    }, __classPrivateFieldGet(this, _PQueue_interval, \"f\")), \"f\");\n    __classPrivateFieldSet(this, _PQueue_intervalEnd, Date.now() + __classPrivateFieldGet(this, _PQueue_interval, \"f\"), \"f\");\n}, _PQueue_onInterval = function _PQueue_onInterval() {\n    if (__classPrivateFieldGet(this, _PQueue_intervalCount, \"f\") === 0 && __classPrivateFieldGet(this, _PQueue_pending, \"f\") === 0 && __classPrivateFieldGet(this, _PQueue_intervalId, \"f\")) {\n        clearInterval(__classPrivateFieldGet(this, _PQueue_intervalId, \"f\"));\n        __classPrivateFieldSet(this, _PQueue_intervalId, undefined, \"f\");\n    }\n    __classPrivateFieldSet(this, _PQueue_intervalCount, __classPrivateFieldGet(this, _PQueue_carryoverConcurrencyCount, \"f\") ? __classPrivateFieldGet(this, _PQueue_pending, \"f\") : 0, \"f\");\n    __classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_processQueue).call(this);\n}, _PQueue_processQueue = function _PQueue_processQueue() {\n    // eslint-disable-next-line no-empty\n    while (__classPrivateFieldGet(this, _PQueue_instances, \"m\", _PQueue_tryToStartAnother).call(this)) { }\n}, _PQueue_throwOnAbort = async function _PQueue_throwOnAbort(signal) {\n    return new Promise((_resolve, reject) => {\n        signal.addEventListener('abort', () => {\n            // TODO: Reject with signal.throwIfAborted() when targeting Node.js 18\n            // TODO: Use ABORT_ERR code when targeting Node.js 16 (https://nodejs.org/docs/latest-v16.x/api/errors.html#abort_err)\n            reject(new AbortError('The task was aborted.'));\n        }, { once: true });\n    });\n}, _PQueue_onEvent = async function _PQueue_onEvent(event, filter) {\n    return new Promise(resolve => {\n        const listener = () => {\n            if (filter && !filter()) {\n                return;\n            }\n            this.off(event, listener);\n            resolve();\n        };\n        this.on(event, listener);\n    });\n};\nexport default PQueue;\n","// Port of lower_bound from https://en.cppreference.com/w/cpp/algorithm/lower_bound\n// Used to compute insertion index to keep queue sorted after insertion\nexport default function lowerBound(array, value, comparator) {\n    let first = 0;\n    let count = array.length;\n    while (count > 0) {\n        const step = Math.trunc(count / 2);\n        let it = first + step;\n        if (comparator(array[it], value) <= 0) {\n            first = ++it;\n            count -= step + 1;\n        }\n        else {\n            count = step;\n        }\n    }\n    return first;\n}\n","import { Type } from '../token.js'\nimport { encodeCustom } from '../encode.js'\nimport { encodeErrPrefix } from '../common.js'\nimport { asU8A, fromString } from '../byte-utils.js'\n\n/**\n * @typedef {import('../../interface').EncodeOptions} EncodeOptions\n * @typedef {import('../token').Token} Token\n * @typedef {import('../bl').Bl} Bl\n */\n\nclass JSONEncoder extends Array {\n  constructor () {\n    super()\n    /** @type {{type:Type,elements:number}[]} */\n    this.inRecursive = []\n  }\n\n  /**\n   * @param {Bl} buf\n   */\n  prefix (buf) {\n    const recurs = this.inRecursive[this.inRecursive.length - 1]\n    if (recurs) {\n      if (recurs.type === Type.array) {\n        recurs.elements++\n        if (recurs.elements !== 1) { // >first\n          buf.push([44]) // ','\n        }\n      }\n      if (recurs.type === Type.map) {\n        recurs.elements++\n        if (recurs.elements !== 1) { // >first\n          if (recurs.elements % 2 === 1) { // key\n            buf.push([44]) // ','\n          } else {\n            buf.push([58]) // ':'\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} token\n   */\n  [Type.uint.major] (buf, token) {\n    this.prefix(buf)\n    const is = String(token.value)\n    const isa = []\n    for (let i = 0; i < is.length; i++) {\n      isa[i] = is.charCodeAt(i)\n    }\n    buf.push(isa)\n  }\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} token\n   */\n  [Type.negint.major] (buf, token) {\n    // @ts-ignore hack\n    this[Type.uint.major](buf, token)\n  }\n\n  /**\n   * @param {Bl} _buf\n   * @param {Token} _token\n   */\n  [Type.bytes.major] (_buf, _token) {\n    throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)\n  }\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} token\n   */\n  [Type.string.major] (buf, token) {\n    this.prefix(buf)\n    // buf.push(34) // '\"'\n    // encodeUtf8(token.value, byts)\n    // buf.push(34) // '\"'\n    const byts = fromString(JSON.stringify(token.value))\n    buf.push(byts.length > 32 ? asU8A(byts) : byts)\n  }\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} _token\n   */\n  [Type.array.major] (buf, _token) {\n    this.prefix(buf)\n    this.inRecursive.push({ type: Type.array, elements: 0 })\n    buf.push([91]) // '['\n  }\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} _token\n   */\n  [Type.map.major] (buf, _token) {\n    this.prefix(buf)\n    this.inRecursive.push({ type: Type.map, elements: 0 })\n    buf.push([123]) // '{'\n  }\n\n  /**\n   * @param {Bl} _buf\n   * @param {Token} _token\n   */\n  [Type.tag.major] (_buf, _token) {}\n\n  /**\n   * @param {Bl} buf\n   * @param {Token} token\n   */\n  [Type.float.major] (buf, token) {\n    if (token.type.name === 'break') {\n      const recurs = this.inRecursive.pop()\n      if (recurs) {\n        if (recurs.type === Type.array) {\n          buf.push([93]) // ']'\n        } else if (recurs.type === Type.map) {\n          buf.push([125]) // '}'\n        /* c8 ignore next 3 */\n        } else {\n          throw new Error('Unexpected recursive type; this should not happen!')\n        }\n        return\n      }\n      /* c8 ignore next 2 */\n      throw new Error('Unexpected break; this should not happen!')\n    }\n    if (token.value === undefined) {\n      throw new Error(`${encodeErrPrefix} unsupported type: undefined`)\n    }\n\n    this.prefix(buf)\n    if (token.type.name === 'true') {\n      buf.push([116, 114, 117, 101]) // 'true'\n      return\n    } else if (token.type.name === 'false') {\n      buf.push([102, 97, 108, 115, 101]) // 'false'\n      return\n    } else if (token.type.name === 'null') {\n      buf.push([110, 117, 108, 108]) // 'null'\n      return\n    }\n\n    // number\n    const is = String(token.value)\n    const isa = []\n    let dp = false\n    for (let i = 0; i < is.length; i++) {\n      isa[i] = is.charCodeAt(i)\n      if (!dp && (isa[i] === 46 || isa[i] === 101 || isa[i] === 69)) { // '[.eE]'\n        dp = true\n      }\n    }\n    if (!dp) { // need a decimal point for floats\n      isa.push(46) // '.'\n      isa.push(48) // '0'\n    }\n    buf.push(isa)\n  }\n}\n\n// The below code is mostly taken and modified from https://github.com/feross/buffer\n// Licensed MIT. Copyright (c) Feross Aboukhadijeh\n// function encodeUtf8 (string, byts) {\n//   let codePoint\n//   const length = string.length\n//   let leadSurrogate = null\n\n//   for (let i = 0; i < length; ++i) {\n//     codePoint = string.charCodeAt(i)\n\n//     // is surrogate component\n//     if (codePoint > 0xd7ff && codePoint < 0xe000) {\n//       // last char was a lead\n//       if (!leadSurrogate) {\n//         // no lead yet\n//         /* c8 ignore next 9 */\n//         if (codePoint > 0xdbff) {\n//           // unexpected trail\n//           byts.push(0xef, 0xbf, 0xbd)\n//           continue\n//         } else if (i + 1 === length) {\n//           // unpaired lead\n//           byts.push(0xef, 0xbf, 0xbd)\n//           continue\n//         }\n\n//         // valid lead\n//         leadSurrogate = codePoint\n\n//         continue\n//       }\n\n//       // 2 leads in a row\n//       /* c8 ignore next 5 */\n//       if (codePoint < 0xdc00) {\n//         byts.push(0xef, 0xbf, 0xbd)\n//         leadSurrogate = codePoint\n//         continue\n//       }\n\n//       // valid surrogate pair\n//       codePoint = (leadSurrogate - 0xd800 << 10 | codePoint - 0xdc00) + 0x10000\n//     /* c8 ignore next 4 */\n//     } else if (leadSurrogate) {\n//       // valid bmp char, but last char was a lead\n//       byts.push(0xef, 0xbf, 0xbd)\n//     }\n\n//     leadSurrogate = null\n\n//     // encode utf8\n//     if (codePoint < 0x80) {\n//       // special JSON escapes\n//       switch (codePoint) {\n//         case 8: // '\\b'\n//           byts.push(92, 98) // '\\\\b'\n//           continue\n//         case 9: // '\\t'\n//           byts.push(92, 116) // '\\\\t'\n//           continue\n//         case 10: // '\\n'\n//           byts.push(92, 110) // '\\\\n'\n//           continue\n//         case 12: // '\\f'\n//           byts.push(92, 102) // '\\\\f'\n//           continue\n//         case 13: // '\\r'\n//           byts.push(92, 114) // '\\\\r'\n//           continue\n//         case 34: // '\"'\n//           byts.push(92, 34) // '\\\\\"'\n//           continue\n//         case 92: // '\\\\'\n//           byts.push(92, 92) // '\\\\\\\\'\n//           continue\n//       }\n\n//       byts.push(codePoint)\n//     } else if (codePoint < 0x800) {\n//       /* c8 ignore next 1 */\n//       byts.push(\n//         codePoint >> 0x6 | 0xc0,\n//         codePoint & 0x3f | 0x80\n//       )\n//     } else if (codePoint < 0x10000) {\n//       /* c8 ignore next 1 */\n//       byts.push(\n//         codePoint >> 0xc | 0xe0,\n//         codePoint >> 0x6 & 0x3f | 0x80,\n//         codePoint & 0x3f | 0x80\n//       )\n//     /* c8 ignore next 9 */\n//     } else if (codePoint < 0x110000) {\n//       byts.push(\n//         codePoint >> 0x12 | 0xf0,\n//         codePoint >> 0xc & 0x3f | 0x80,\n//         codePoint >> 0x6 & 0x3f | 0x80,\n//         codePoint & 0x3f | 0x80\n//       )\n//     } else {\n//       /* c8 ignore next 2 */\n//       throw new Error('Invalid code point')\n//     }\n//   }\n// }\n\n/**\n * @param {(Token|Token[])[]} e1\n * @param {(Token|Token[])[]} e2\n * @returns {number}\n */\nfunction mapSorter (e1, e2) {\n  if (Array.isArray(e1[0]) || Array.isArray(e2[0])) {\n    throw new Error(`${encodeErrPrefix} complex map keys are not supported`)\n  }\n  const keyToken1 = e1[0]\n  const keyToken2 = e2[0]\n  if (keyToken1.type !== Type.string || keyToken2.type !== Type.string) {\n    throw new Error(`${encodeErrPrefix} non-string map keys are not supported`)\n  }\n  if (keyToken1 < keyToken2) {\n    return -1\n  }\n  if (keyToken1 > keyToken2) {\n    return 1\n  }\n  /* c8 ignore next 1 */\n  throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)\n}\n\nconst defaultEncodeOptions = { addBreakTokens: true, mapSorter }\n\n/**\n * @param {any} data\n * @param {EncodeOptions} [options]\n * @returns {Uint8Array}\n */\nfunction encode (data, options) {\n  options = Object.assign({}, defaultEncodeOptions, options)\n  return encodeCustom(data, new JSONEncoder(), options)\n}\n\nexport { encode }\n","import { decode as _decode, decodeFirst as _decodeFirst } from '../decode.js'\nimport { Token, Type } from '../token.js'\nimport { decodeCodePointsArray } from '../byte-utils.js'\nimport { decodeErrPrefix } from '../common.js'\n\n/**\n * @typedef {import('../../interface').DecodeOptions} DecodeOptions\n * @typedef {import('../../interface').DecodeTokenizer} DecodeTokenizer\n */\n\n/**\n * @implements {DecodeTokenizer}\n */\nclass Tokenizer {\n  /**\n   * @param {Uint8Array} data\n   * @param {DecodeOptions} options\n   */\n  constructor (data, options = {}) {\n    this._pos = 0\n    this.data = data\n    this.options = options\n    /** @type {string[]} */\n    this.modeStack = ['value']\n    this.lastToken = ''\n  }\n\n  pos () {\n    return this._pos\n  }\n\n  /**\n   * @returns {boolean}\n   */\n  done () {\n    return this._pos >= this.data.length\n  }\n\n  /**\n   * @returns {number}\n   */\n  ch () {\n    return this.data[this._pos]\n  }\n\n  /**\n   * @returns {string}\n   */\n  currentMode () {\n    return this.modeStack[this.modeStack.length - 1]\n  }\n\n  skipWhitespace () {\n    let c = this.ch()\n    // @ts-ignore\n    while (c === 32 /* ' ' */ || c === 9 /* '\\t' */ || c === 13 /* '\\r' */ || c === 10 /* '\\n' */) {\n      c = this.data[++this._pos]\n    }\n  }\n\n  /**\n   * @param {number[]} str\n   */\n  expect (str) {\n    if (this.data.length - this._pos < str.length) {\n      throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this._pos}`)\n    }\n    for (let i = 0; i < str.length; i++) {\n      if (this.data[this._pos++] !== str[i]) {\n        throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...str)}'`)\n      }\n    }\n  }\n\n  parseNumber () {\n    const startPos = this._pos\n    let negative = false\n    let float = false\n\n    /**\n     * @param {number[]} chars\n     */\n    const swallow = (chars) => {\n      while (!this.done()) {\n        const ch = this.ch()\n        if (chars.includes(ch)) {\n          this._pos++\n        } else {\n          break\n        }\n      }\n    }\n\n    // lead\n    if (this.ch() === 45) { // '-'\n      negative = true\n      this._pos++\n    }\n    if (this.ch() === 48) { // '0'\n      this._pos++\n      if (this.ch() === 46) { // '.'\n        this._pos++\n        float = true\n      } else {\n        return new Token(Type.uint, 0, this._pos - startPos)\n      }\n    }\n    swallow([48, 49, 50, 51, 52, 53, 54, 55, 56, 57]) // DIGIT\n    if (negative && this._pos === startPos + 1) {\n      throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`)\n    }\n    if (!this.done() && this.ch() === 46) { // '.'\n      if (float) {\n        throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`)\n      }\n      float = true\n      this._pos++\n      swallow([48, 49, 50, 51, 52, 53, 54, 55, 56, 57]) // DIGIT\n    }\n    if (!this.done() && (this.ch() === 101 || this.ch() === 69)) { // '[eE]'\n      float = true\n      this._pos++\n      if (!this.done() && (this.ch() === 43 || this.ch() === 45)) { // '+', '-'\n        this._pos++\n      }\n      swallow([48, 49, 50, 51, 52, 53, 54, 55, 56, 57]) // DIGIT\n    }\n    // @ts-ignore\n    const numStr = String.fromCharCode.apply(null, this.data.subarray(startPos, this._pos))\n    const num = parseFloat(numStr)\n    if (float) {\n      return new Token(Type.float, num, this._pos - startPos)\n    }\n    if (this.options.allowBigInt !== true || Number.isSafeInteger(num)) {\n      return new Token(num >= 0 ? Type.uint : Type.negint, num, this._pos - startPos)\n    }\n    return new Token(num >= 0 ? Type.uint : Type.negint, BigInt(numStr), this._pos - startPos)\n  }\n\n  /**\n   * @returns {Token}\n   */\n  parseString () {\n    /* c8 ignore next 4 */\n    if (this.ch() !== 34) { // '\"'\n      // this would be a programming error\n      throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`)\n    }\n    this._pos++\n\n    // check for simple fast-path, all printable ascii, no escapes\n    // >0x10000 elements may fail fn.apply() (http://stackoverflow.com/a/22747272/680742)\n    for (let i = this._pos, l = 0; i < this.data.length && l < 0x10000; i++, l++) {\n      const ch = this.data[i]\n      if (ch === 92 || ch < 32 || ch >= 128) { // '\\', ' ', control-chars or non-trivial\n        break\n      }\n      if (ch === 34) { // '\"'\n        // @ts-ignore\n        const str = String.fromCharCode.apply(null, this.data.subarray(this._pos, i))\n        this._pos = i + 1\n        return new Token(Type.string, str, l)\n      }\n    }\n\n    const startPos = this._pos\n    const chars = []\n\n    const readu4 = () => {\n      if (this._pos + 4 >= this.data.length) {\n        throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`)\n      }\n      let u4 = 0\n      for (let i = 0; i < 4; i++) {\n        let ch = this.ch()\n        if (ch >= 48 && ch <= 57) { // '0' && '9'\n          ch -= 48\n        } else if (ch >= 97 && ch <= 102) { // 'a' && 'f'\n          ch = ch - 97 + 10\n        } else if (ch >= 65 && ch <= 70) { // 'A' && 'F'\n          ch = ch - 65 + 10\n        } else {\n          throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`)\n        }\n        u4 = u4 * 16 + ch\n        this._pos++\n      }\n      return u4\n    }\n\n    // mostly taken from feross/buffer and adjusted to fit\n    const readUtf8Char = () => {\n      const firstByte = this.ch()\n      let codePoint = null\n      /* c8 ignore next 1 */\n      let bytesPerSequence = (firstByte > 0xef) ? 4 : (firstByte > 0xdf) ? 3 : (firstByte > 0xbf) ? 2 : 1\n\n      if (this._pos + bytesPerSequence > this.data.length) {\n        throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`)\n      }\n\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        /* c8 ignore next 6 */\n        // this case is dealt with by the caller function\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = this.data[this._pos + 1]\n          if ((secondByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1f) << 0x6 | (secondByte & 0x3f)\n            if (tempCodePoint > 0x7f) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = this.data[this._pos + 1]\n          thirdByte = this.data[this._pos + 2]\n          if ((secondByte & 0xc0) === 0x80 && (thirdByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0xf) << 0xc | (secondByte & 0x3f) << 0x6 | (thirdByte & 0x3f)\n            /* c8 ignore next 3 */\n            if (tempCodePoint > 0x7ff && (tempCodePoint < 0xd800 || tempCodePoint > 0xdfff)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = this.data[this._pos + 1]\n          thirdByte = this.data[this._pos + 2]\n          fourthByte = this.data[this._pos + 3]\n          if ((secondByte & 0xc0) === 0x80 && (thirdByte & 0xc0) === 0x80 && (fourthByte & 0xc0) === 0x80) {\n            tempCodePoint = (firstByte & 0xf) << 0x12 | (secondByte & 0x3f) << 0xc | (thirdByte & 0x3f) << 0x6 | (fourthByte & 0x3f)\n            if (tempCodePoint > 0xffff && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n\n      /* c8 ignore next 5 */\n      if (codePoint === null) {\n        // we did not generate a valid codePoint so insert a\n        // replacement char (U+FFFD) and advance only 1 byte\n        codePoint = 0xfffd\n        bytesPerSequence = 1\n      } else if (codePoint > 0xffff) {\n        // encode to utf16 (surrogate pair dance)\n        codePoint -= 0x10000\n        chars.push(codePoint >>> 10 & 0x3ff | 0xd800)\n        codePoint = 0xdc00 | codePoint & 0x3ff\n      }\n\n      chars.push(codePoint)\n      this._pos += bytesPerSequence\n    }\n\n    // TODO: could take the approach of a quick first scan for special chars like encoding/json/decode.go#unquoteBytes\n    // and converting all of the ascii chars from the base array in bulk\n    while (!this.done()) {\n      const ch = this.ch()\n      let ch1\n      switch (ch) {\n        case 92: // '\\'\n          this._pos++\n          if (this.done()) {\n            throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this._pos}`)\n          }\n          ch1 = this.ch()\n          this._pos++\n          switch (ch1) {\n            case 34: // '\"'\n            case 39: // '\\''\n            case 92: // '\\'\n            case 47: // '/'\n              chars.push(ch1)\n              break\n            case 98: // 'b'\n              chars.push(8)\n              break\n            case 116: // 't'\n              chars.push(9)\n              break\n            case 110: // 'n'\n              chars.push(10)\n              break\n            case 102: // 'f'\n              chars.push(12)\n              break\n            case 114: // 'r'\n              chars.push(13)\n              break\n            case 117: // 'u'\n              chars.push(readu4())\n              break\n            default:\n              throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this._pos}`)\n          }\n          break\n        case 34: // '\"'\n          this._pos++\n          return new Token(Type.string, decodeCodePointsArray(chars), this._pos - startPos)\n        default:\n          if (ch < 32) { // ' '\n            throw new Error(`${decodeErrPrefix} invalid control character at position ${this._pos}`)\n          } else if (ch < 0x80) {\n            chars.push(ch)\n            this._pos++\n          } else {\n            readUtf8Char()\n          }\n      }\n    }\n\n    throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this._pos}`)\n  }\n\n  /**\n   * @returns {Token}\n   */\n  parseValue () {\n    switch (this.ch()) {\n      case 123: // '{'\n        this.modeStack.push('obj-start')\n        this._pos++\n        return new Token(Type.map, Infinity, 1)\n      case 91: // '['\n        this.modeStack.push('array-start')\n        this._pos++\n        return new Token(Type.array, Infinity, 1)\n      case 34: { // '\"'\n        return this.parseString()\n      }\n      case 110: // 'n' / null\n        this.expect([110, 117, 108, 108]) // 'null'\n        return new Token(Type.null, null, 4)\n      case 102: // 'f' / // false\n        this.expect([102, 97, 108, 115, 101]) // 'false'\n        return new Token(Type.false, false, 5)\n      case 116: // 't' / // true\n        this.expect([116, 114, 117, 101]) // 'true'\n        return new Token(Type.true, true, 4)\n      case 45: // '-'\n      case 48: // '0'\n      case 49: // '1'\n      case 50: // '2'\n      case 51: // '3'\n      case 52: // '4'\n      case 53: // '5'\n      case 54: // '6'\n      case 55: // '7'\n      case 56: // '8'\n      case 57: // '9'\n        return this.parseNumber()\n      default:\n        throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}`)\n    }\n  }\n\n  /**\n   * @returns {Token}\n   */\n  next () {\n    this.skipWhitespace()\n    switch (this.currentMode()) {\n      case 'value':\n        this.modeStack.pop()\n        return this.parseValue()\n      case 'array-value': {\n        this.modeStack.pop()\n        if (this.ch() === 93) { // ']'\n          this._pos++\n          this.skipWhitespace()\n          return new Token(Type.break, undefined, 1)\n        }\n        if (this.ch() !== 44) { // ','\n          throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`)\n        }\n        this._pos++\n        this.modeStack.push('array-value')\n        this.skipWhitespace()\n        return this.parseValue()\n      }\n      case 'array-start': {\n        this.modeStack.pop()\n        if (this.ch() === 93) { // ']'\n          this._pos++\n          this.skipWhitespace()\n          return new Token(Type.break, undefined, 1)\n        }\n        this.modeStack.push('array-value')\n        this.skipWhitespace()\n        return this.parseValue()\n      }\n      // @ts-ignore\n      case 'obj-key':\n        if (this.ch() === 125) { // '}'\n          this.modeStack.pop()\n          this._pos++\n          this.skipWhitespace()\n          return new Token(Type.break, undefined, 1)\n        }\n        if (this.ch() !== 44) { // ','\n          throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`)\n        }\n        this._pos++\n        this.skipWhitespace()\n      case 'obj-start': { // eslint-disable-line no-fallthrough\n        this.modeStack.pop()\n        if (this.ch() === 125) { // '}'\n          this._pos++\n          this.skipWhitespace()\n          return new Token(Type.break, undefined, 1)\n        }\n        const token = this.parseString()\n        this.skipWhitespace()\n        if (this.ch() !== 58) { // ':'\n          throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`)\n        }\n        this._pos++\n        this.modeStack.push('obj-value')\n        return token\n      }\n      case 'obj-value': {\n        this.modeStack.pop()\n        this.modeStack.push('obj-key')\n        this.skipWhitespace()\n        return this.parseValue()\n      }\n      /* c8 ignore next 2 */\n      default:\n        throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)\n    }\n  }\n}\n\n/**\n * @param {Uint8Array} data\n * @param {DecodeOptions} [options]\n * @returns {any}\n */\nfunction decode (data, options) {\n  options = Object.assign({ tokenizer: new Tokenizer(data, options) }, options)\n  return _decode(data, options)\n}\n\n/**\n * @param {Uint8Array} data\n * @param {DecodeOptions} [options]\n * @returns {[any, Uint8Array]}\n */\nfunction decodeFirst (data, options) {\n  options = Object.assign({ tokenizer: new Tokenizer(data, options) }, options)\n  return _decodeFirst(data, options)\n}\n\nexport { decode, decodeFirst, Tokenizer }\n","/* eslint max-depth: [\"error\", 7] */\nimport { Token, Type } from 'cborg'\nimport * as cborgJson from 'cborg/json'\nimport { CID } from 'multiformats'\nimport { base64 } from 'multiformats/bases/base64'\n\n/**\n * @template T\n * @typedef {import('multiformats/codecs/interface').ByteView<T>} ByteView\n */\n/**\n * @template T\n * @typedef {import('multiformats').ToString<T>} ToString\n */\n/**\n * @typedef {import('cborg/interface').DecodeTokenizer} DecodeTokenizer\n */\n\n/**\n * cidEncoder will receive all Objects during encode, it needs to filter out\n * anything that's not a CID and return `null` for that so it's encoded as\n * normal. Encoding a CID means replacing it with a `{\"/\":\"<CidString>}`\n * object as per the DAG-JSON spec.\n *\n * @param {any} obj\n * @returns {Token[]|null}\n */\nfunction cidEncoder (obj) {\n  if (obj.asCID !== obj && obj['/'] !== obj.bytes) {\n    return null // any other kind of object\n  }\n  const cid = CID.asCID(obj)\n  /* c8 ignore next 4 */\n  // very unlikely case, and it'll probably throw a recursion error in cborg\n  if (!cid) {\n    return null\n  }\n  const cidString = cid.toString()\n\n  return [\n    new Token(Type.map, Infinity, 1),\n    new Token(Type.string, '/', 1), // key\n    new Token(Type.string, cidString, cidString.length), // value\n    new Token(Type.break, undefined, 1)\n  ]\n}\n\n/**\n * bytesEncoder will receive all Uint8Arrays (and friends) during encode, it\n * needs to replace it with a `{\"/\":{\"bytes\":\"Base64ByteString\"}}` object as\n * per the DAG-JSON spec.\n *\n * @param {Uint8Array} bytes\n * @returns {Token[]|null}\n */\nfunction bytesEncoder (bytes) {\n  const bytesString = base64.encode(bytes).slice(1) // no mbase prefix\n  return [\n    new Token(Type.map, Infinity, 1),\n    new Token(Type.string, '/', 1), // key\n    new Token(Type.map, Infinity, 1), // value\n    new Token(Type.string, 'bytes', 5), // inner key\n    new Token(Type.string, bytesString, bytesString.length), // inner value\n    new Token(Type.break, undefined, 1),\n    new Token(Type.break, undefined, 1)\n  ]\n}\n\n/**\n * taBytesEncoder wraps bytesEncoder() but for the more exotic typed arrays so\n * that we access the underlying ArrayBuffer data\n *\n * @param {Int8Array|Uint16Array|Int16Array|Uint32Array|Int32Array|Float32Array|Float64Array|Uint8ClampedArray|BigInt64Array|BigUint64Array} obj\n * @returns {Token[]|null}\n */\nfunction taBytesEncoder (obj) {\n  return bytesEncoder(new Uint8Array(obj.buffer, obj.byteOffset, obj.byteLength))\n}\n\n/**\n * abBytesEncoder wraps bytesEncoder() but for plain ArrayBuffers\n *\n * @param {ArrayBuffer} ab\n * @returns {Token[]|null}\n */\nfunction abBytesEncoder (ab) {\n  return bytesEncoder(new Uint8Array(ab))\n}\n\n// eslint-disable-next-line jsdoc/require-returns-check\n/**\n * Intercept all `undefined` values from an object walk and reject the entire\n * object if we find one.\n *\n * @returns {null}\n */\nfunction undefinedEncoder () {\n  throw new Error('`undefined` is not supported by the IPLD Data Model and cannot be encoded')\n}\n\n/**\n * Intercept all `number` values from an object walk and reject the entire\n * object if we find something that doesn't fit the IPLD data model (NaN &\n * Infinity).\n *\n * @param {number} num\n * @returns {null}\n */\nfunction numberEncoder (num) {\n  if (Number.isNaN(num)) {\n    throw new Error('`NaN` is not supported by the IPLD Data Model and cannot be encoded')\n  }\n  if (num === Infinity || num === -Infinity) {\n    throw new Error('`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded')\n  }\n  return null // process with standard number encoder\n}\n\nconst encodeOptions = {\n  typeEncoders: {\n    Object: cidEncoder,\n    Buffer: bytesEncoder,\n    Uint8Array: bytesEncoder,\n    Int8Array: taBytesEncoder,\n    Uint16Array: taBytesEncoder,\n    Int16Array: taBytesEncoder,\n    Uint32Array: taBytesEncoder,\n    Int32Array: taBytesEncoder,\n    Float32Array: taBytesEncoder,\n    Float64Array: taBytesEncoder,\n    Uint8ClampedArray: taBytesEncoder,\n    BigInt64Array: taBytesEncoder,\n    BigUint64Array: taBytesEncoder,\n    DataView: taBytesEncoder,\n    ArrayBuffer: abBytesEncoder,\n    undefined: undefinedEncoder,\n    number: numberEncoder\n  }\n}\n\n/**\n * @implements {DecodeTokenizer}\n */\nclass DagJsonTokenizer extends cborgJson.Tokenizer {\n  /**\n   * @param {Uint8Array} data\n   * @param {object} [options]\n   */\n  constructor (data, options) {\n    super(data, options)\n    /** @type {Token[]} */\n    this.tokenBuffer = []\n  }\n\n  /**\n   * @returns {boolean}\n   */\n  done () {\n    return this.tokenBuffer.length === 0 && super.done()\n  }\n\n  /**\n   * @returns {Token}\n   */\n  _next () {\n    if (this.tokenBuffer.length > 0) {\n      // @ts-ignore https://github.com/Microsoft/TypeScript/issues/30406\n      return this.tokenBuffer.pop()\n    }\n    return super.next()\n  }\n\n  /**\n   * Implements rules outlined in https://github.com/ipld/specs/pull/356\n   *\n   * @returns {Token}\n   */\n  next () {\n    const token = this._next()\n\n    if (token.type === Type.map) {\n      const keyToken = this._next()\n      if (keyToken.type === Type.string && keyToken.value === '/') {\n        const valueToken = this._next()\n        if (valueToken.type === Type.string) { // *must* be a CID\n          const breakToken = this._next() // swallow the end-of-map token\n          if (breakToken.type !== Type.break) {\n            throw new Error('Invalid encoded CID form')\n          }\n          this.tokenBuffer.push(valueToken) // CID.parse will pick this up after our tag token\n          return new Token(Type.tag, 42, 0)\n        }\n        if (valueToken.type === Type.map) {\n          const innerKeyToken = this._next()\n          if (innerKeyToken.type === Type.string && innerKeyToken.value === 'bytes') {\n            const innerValueToken = this._next()\n            if (innerValueToken.type === Type.string) { // *must* be Bytes\n              for (let i = 0; i < 2; i++) {\n                const breakToken = this._next() // swallow two end-of-map tokens\n                if (breakToken.type !== Type.break) {\n                  throw new Error('Invalid encoded Bytes form')\n                }\n              }\n              const bytes = base64.decode(`m${innerValueToken.value}`)\n              return new Token(Type.bytes, bytes, innerValueToken.value.length)\n            }\n            this.tokenBuffer.push(innerValueToken) // bail\n          }\n          this.tokenBuffer.push(innerKeyToken) // bail\n        }\n        this.tokenBuffer.push(valueToken) // bail\n      }\n      this.tokenBuffer.push(keyToken) // bail\n    }\n    return token\n  }\n}\n\nconst decodeOptions = {\n  allowIndefinite: false,\n  allowUndefined: false,\n  allowNaN: false,\n  allowInfinity: false,\n  allowBigInt: true, // this will lead to BigInt for ints outside of\n  // safe-integer range, which may surprise users\n  strict: true,\n  useMaps: false,\n  rejectDuplicateMapKeys: true,\n  /** @type {import('cborg').TagDecoder[]} */\n  tags: []\n}\n\n// we're going to get TAG(42)STRING(\"bafy...\") from the tokenizer so we only need\n// to deal with the STRING(\"bafy...\") at this point\ndecodeOptions.tags[42] = CID.parse\n\nexport const name = 'dag-json'\nexport const code = 0x0129\n\n/**\n * @template T\n * @param {T} node\n * @returns {ByteView<T>}\n */\nexport const encode = (node) => cborgJson.encode(node, encodeOptions)\n\n/**\n * @template T\n * @param {ByteView<T>} data\n * @returns {T}\n */\nexport const decode = (data) => {\n  // the tokenizer is stateful so we need a single instance of it\n  const options = Object.assign(decodeOptions, { tokenizer: new DagJsonTokenizer(data, decodeOptions) })\n  return cborgJson.decode(data, options)\n}\n\n/**\n * @template T\n * @param {T} node\n * @returns {ToString<T>}\n */\nexport const format = (node) => utf8Decoder.decode(encode(node))\nexport { format as stringify }\nconst utf8Decoder = new TextDecoder()\n\n/**\n * @template T\n * @param {ToString<T>} data\n * @returns {T}\n */\nexport const parse = (data) => decode(utf8Encoder.encode(data))\nconst utf8Encoder = new TextEncoder()\n","const textDecoder = new TextDecoder()\n\n/**\n * @typedef {import('./interface.js').RawPBLink} RawPBLink\n */\n\n/**\n * @typedef {import('./interface.js').RawPBNode} RawPBNode\n */\n\n/**\n * @param {Uint8Array} bytes\n * @param {number} offset\n * @returns {[number, number]}\n */\nfunction decodeVarint (bytes, offset) {\n  let v = 0\n\n  for (let shift = 0; ; shift += 7) {\n    /* c8 ignore next 3 */\n    if (shift >= 64) {\n      throw new Error('protobuf: varint overflow')\n    }\n    /* c8 ignore next 3 */\n    if (offset >= bytes.length) {\n      throw new Error('protobuf: unexpected end of data')\n    }\n\n    const b = bytes[offset++]\n    v += shift < 28 ? (b & 0x7f) << shift : (b & 0x7f) * (2 ** shift)\n    if (b < 0x80) {\n      break\n    }\n  }\n  return [v, offset]\n}\n\n/**\n * @param {Uint8Array} bytes\n * @param {number} offset\n * @returns {[Uint8Array, number]}\n */\nfunction decodeBytes (bytes, offset) {\n  let byteLen\n  ;[byteLen, offset] = decodeVarint(bytes, offset)\n  const postOffset = offset + byteLen\n\n  /* c8 ignore next 3 */\n  if (byteLen < 0 || postOffset < 0) {\n    throw new Error('protobuf: invalid length')\n  }\n  /* c8 ignore next 3 */\n  if (postOffset > bytes.length) {\n    throw new Error('protobuf: unexpected end of data')\n  }\n\n  return [bytes.subarray(offset, postOffset), postOffset]\n}\n\n/**\n * @param {Uint8Array} bytes\n * @param {number} index\n * @returns {[number, number, number]}\n */\nfunction decodeKey (bytes, index) {\n  let wire\n  ;[wire, index] = decodeVarint(bytes, index)\n  // [wireType, fieldNum, newIndex]\n  return [wire & 0x7, wire >> 3, index]\n}\n\n/**\n * @param {Uint8Array} bytes\n * @returns {RawPBLink}\n */\nfunction decodeLink (bytes) {\n  /** @type {RawPBLink} */\n  const link = {}\n  const l = bytes.length\n  let index = 0\n\n  while (index < l) {\n    let wireType, fieldNum\n    ;[wireType, fieldNum, index] = decodeKey(bytes, index)\n\n    if (fieldNum === 1) {\n      if (link.Hash) {\n        throw new Error('protobuf: (PBLink) duplicate Hash section')\n      }\n      if (wireType !== 2) {\n        throw new Error(`protobuf: (PBLink) wrong wireType (${wireType}) for Hash`)\n      }\n      if (link.Name !== undefined) {\n        throw new Error('protobuf: (PBLink) invalid order, found Name before Hash')\n      }\n      if (link.Tsize !== undefined) {\n        throw new Error('protobuf: (PBLink) invalid order, found Tsize before Hash')\n      }\n\n      [link.Hash, index] = decodeBytes(bytes, index)\n    } else if (fieldNum === 2) {\n      if (link.Name !== undefined) {\n        throw new Error('protobuf: (PBLink) duplicate Name section')\n      }\n      if (wireType !== 2) {\n        throw new Error(`protobuf: (PBLink) wrong wireType (${wireType}) for Name`)\n      }\n      if (link.Tsize !== undefined) {\n        throw new Error('protobuf: (PBLink) invalid order, found Tsize before Name')\n      }\n\n      let byts\n      ;[byts, index] = decodeBytes(bytes, index)\n      link.Name = textDecoder.decode(byts)\n    } else if (fieldNum === 3) {\n      if (link.Tsize !== undefined) {\n        throw new Error('protobuf: (PBLink) duplicate Tsize section')\n      }\n      if (wireType !== 0) {\n        throw new Error(`protobuf: (PBLink) wrong wireType (${wireType}) for Tsize`)\n      }\n\n      [link.Tsize, index] = decodeVarint(bytes, index)\n    } else {\n      throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${fieldNum}`)\n    }\n  }\n\n  /* c8 ignore next 3 */\n  if (index > l) {\n    throw new Error('protobuf: (PBLink) unexpected end of data')\n  }\n\n  return link\n}\n\n/**\n * @param {Uint8Array} bytes\n * @returns {RawPBNode}\n */\nexport function decodeNode (bytes) {\n  const l = bytes.length\n  let index = 0\n  /** @type {RawPBLink[]|void} */\n  let links = undefined // eslint-disable-line no-undef-init\n  let linksBeforeData = false\n  /** @type {Uint8Array|void} */\n  let data = undefined // eslint-disable-line no-undef-init\n\n  while (index < l) {\n    let wireType, fieldNum\n    ;[wireType, fieldNum, index] = decodeKey(bytes, index)\n\n    if (wireType !== 2) {\n      throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${wireType}`)\n    }\n\n    if (fieldNum === 1) {\n      if (data) {\n        throw new Error('protobuf: (PBNode) duplicate Data section')\n      }\n\n      [data, index] = decodeBytes(bytes, index)\n      if (links) {\n        linksBeforeData = true\n      }\n    } else if (fieldNum === 2) {\n      if (linksBeforeData) { // interleaved Links/Data/Links\n        throw new Error('protobuf: (PBNode) duplicate Links section')\n      } else if (!links) {\n        links = []\n      }\n      let byts\n      ;[byts, index] = decodeBytes(bytes, index)\n      links.push(decodeLink(byts))\n    } else {\n      throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${fieldNum}`)\n    }\n  }\n\n  /* c8 ignore next 3 */\n  if (index > l) {\n    throw new Error('protobuf: (PBNode) unexpected end of data')\n  }\n\n  /** @type {RawPBNode} */\n  const node = {}\n  if (data) {\n    node.Data = data\n  }\n  node.Links = links || []\n  return node\n}\n","const textEncoder = new TextEncoder()\nconst maxInt32 = 2 ** 32\nconst maxUInt32 = 2 ** 31\n\n/**\n * @typedef {import('./interface.js').RawPBLink} RawPBLink\n */\n\n/**\n * @typedef {import('./interface.js').RawPBNode} RawPBNode\n */\n\n// the encoders work backward from the end of the bytes array\n\n/**\n * encodeLink() is passed a slice of the parent byte array that ends where this\n * link needs to end, so it packs to the right-most part of the passed `bytes`\n *\n * @param {RawPBLink} link\n * @param {Uint8Array} bytes\n * @returns {number}\n */\nfunction encodeLink (link, bytes) {\n  let i = bytes.length\n\n  if (typeof link.Tsize === 'number') {\n    if (link.Tsize < 0) {\n      throw new Error('Tsize cannot be negative')\n    }\n    if (!Number.isSafeInteger(link.Tsize)) {\n      throw new Error('Tsize too large for encoding')\n    }\n    i = encodeVarint(bytes, i, link.Tsize) - 1\n    bytes[i] = 0x18\n  }\n\n  if (typeof link.Name === 'string') {\n    const nameBytes = textEncoder.encode(link.Name)\n    i -= nameBytes.length\n    bytes.set(nameBytes, i)\n    i = encodeVarint(bytes, i, nameBytes.length) - 1\n    bytes[i] = 0x12\n  }\n\n  if (link.Hash) {\n    i -= link.Hash.length\n    bytes.set(link.Hash, i)\n    i = encodeVarint(bytes, i, link.Hash.length) - 1\n    bytes[i] = 0xa\n  }\n\n  return bytes.length - i\n}\n\n/**\n * Encodes a PBNode into a new byte array of precisely the correct size\n *\n * @param {RawPBNode} node\n * @returns {Uint8Array}\n */\nexport function encodeNode (node) {\n  const size = sizeNode(node)\n  const bytes = new Uint8Array(size)\n  let i = size\n\n  if (node.Data) {\n    i -= node.Data.length\n    bytes.set(node.Data, i)\n    i = encodeVarint(bytes, i, node.Data.length) - 1\n    bytes[i] = 0xa\n  }\n\n  if (node.Links) {\n    for (let index = node.Links.length - 1; index >= 0; index--) {\n      const size = encodeLink(node.Links[index], bytes.subarray(0, i))\n      i -= size\n      i = encodeVarint(bytes, i, size) - 1\n      bytes[i] = 0x12\n    }\n  }\n\n  return bytes\n}\n\n/**\n * work out exactly how many bytes this link takes up\n *\n * @param {RawPBLink} link\n * @returns\n */\nfunction sizeLink (link) {\n  let n = 0\n\n  if (link.Hash) {\n    const l = link.Hash.length\n    n += 1 + l + sov(l)\n  }\n\n  if (typeof link.Name === 'string') {\n    const l = textEncoder.encode(link.Name).length\n    n += 1 + l + sov(l)\n  }\n\n  if (typeof link.Tsize === 'number') {\n    n += 1 + sov(link.Tsize)\n  }\n\n  return n\n}\n\n/**\n * Work out exactly how many bytes this node takes up\n *\n * @param {RawPBNode} node\n * @returns {number}\n */\nfunction sizeNode (node) {\n  let n = 0\n\n  if (node.Data) {\n    const l = node.Data.length\n    n += 1 + l + sov(l)\n  }\n\n  if (node.Links) {\n    for (const link of node.Links) {\n      const l = sizeLink(link)\n      n += 1 + l + sov(l)\n    }\n  }\n\n  return n\n}\n\n/**\n * @param {Uint8Array} bytes\n * @param {number} offset\n * @param {number} v\n * @returns {number}\n */\nfunction encodeVarint (bytes, offset, v) {\n  offset -= sov(v)\n  const base = offset\n\n  while (v >= maxUInt32) {\n    bytes[offset++] = (v & 0x7f) | 0x80\n    v /= 128\n  }\n\n  while (v >= 128) {\n    bytes[offset++] = (v & 0x7f) | 0x80\n    v >>>= 7\n  }\n\n  bytes[offset] = v\n\n  return base\n}\n\n/**\n * size of varint\n *\n * @param {number} x\n * @returns {number}\n */\nfunction sov (x) {\n  if (x % 2 === 0) {\n    x++\n  }\n  return Math.floor((len64(x) + 6) / 7)\n}\n\n/**\n * golang math/bits, how many bits does it take to represent this integer?\n *\n * @param {number} x\n * @returns {number}\n */\nfunction len64 (x) {\n  let n = 0\n  if (x >= maxInt32) {\n    x = Math.floor(x / maxInt32)\n    n = 32\n  }\n  if (x >= (1 << 16)) {\n    x >>>= 16\n    n += 16\n  }\n  if (x >= (1 << 8)) {\n    x >>>= 8\n    n += 8\n  }\n  return n + len8tab[x]\n}\n\n// golang math/bits\nconst len8tab = [\n  0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,\n  5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,\n  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,\n  6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,\n  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,\n  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,\n  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,\n  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,\n  8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8\n]\n","import { CID } from 'multiformats/cid'\n\n/**\n * @typedef {import('./interface.js').PBLink} PBLink\n * @typedef {import('./interface.js').PBNode} PBNode\n */\n\nconst pbNodeProperties = ['Data', 'Links']\nconst pbLinkProperties = ['Hash', 'Name', 'Tsize']\n\nconst textEncoder = new TextEncoder()\n\n/**\n * @param {PBLink} a\n * @param {PBLink} b\n * @returns {number}\n */\nfunction linkComparator (a, b) {\n  if (a === b) {\n    return 0\n  }\n\n  const abuf = a.Name ? textEncoder.encode(a.Name) : []\n  const bbuf = b.Name ? textEncoder.encode(b.Name) : []\n\n  let x = abuf.length\n  let y = bbuf.length\n\n  for (let i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (abuf[i] !== bbuf[i]) {\n      x = abuf[i]\n      y = bbuf[i]\n      break\n    }\n  }\n\n  return x < y ? -1 : y < x ? 1 : 0\n}\n\n/**\n * @param {any} node\n * @param {string[]} properties\n * @returns {boolean}\n */\nfunction hasOnlyProperties (node, properties) {\n  return !Object.keys(node).some((p) => !properties.includes(p))\n}\n\n/**\n * Converts a CID, or a PBLink-like object to a PBLink\n *\n * @param {any} link\n * @returns {PBLink}\n */\nfunction asLink (link) {\n  if (typeof link.asCID === 'object') {\n    const Hash = CID.asCID(link)\n    if (!Hash) {\n      throw new TypeError('Invalid DAG-PB form')\n    }\n    return { Hash }\n  }\n\n  if (typeof link !== 'object' || Array.isArray(link)) {\n    throw new TypeError('Invalid DAG-PB form')\n  }\n\n  const pbl = {}\n\n  if (link.Hash) {\n    let cid = CID.asCID(link.Hash)\n    try {\n      if (!cid) {\n        if (typeof link.Hash === 'string') {\n          cid = CID.parse(link.Hash)\n        } else if (link.Hash instanceof Uint8Array) {\n          cid = CID.decode(link.Hash)\n        }\n      }\n    } catch (/** @type {any} */ e) {\n      throw new TypeError(`Invalid DAG-PB form: ${e.message}`)\n    }\n\n    if (cid) {\n      pbl.Hash = cid\n    }\n  }\n\n  if (!pbl.Hash) {\n    throw new TypeError('Invalid DAG-PB form')\n  }\n\n  if (typeof link.Name === 'string') {\n    pbl.Name = link.Name\n  }\n\n  if (typeof link.Tsize === 'number') {\n    pbl.Tsize = link.Tsize\n  }\n\n  return pbl\n}\n\n/**\n * @param {any} node\n * @returns {PBNode}\n */\nexport function prepare (node) {\n  if (node instanceof Uint8Array || typeof node === 'string') {\n    node = { Data: node }\n  }\n\n  if (typeof node !== 'object' || Array.isArray(node)) {\n    throw new TypeError('Invalid DAG-PB form')\n  }\n\n  /** @type {PBNode} */\n  const pbn = {}\n\n  if (node.Data !== undefined) {\n    if (typeof node.Data === 'string') {\n      pbn.Data = textEncoder.encode(node.Data)\n    } else if (node.Data instanceof Uint8Array) {\n      pbn.Data = node.Data\n    } else {\n      throw new TypeError('Invalid DAG-PB form')\n    }\n  }\n\n  if (node.Links !== undefined) {\n    if (Array.isArray(node.Links)) {\n      pbn.Links = node.Links.map(asLink)\n      pbn.Links.sort(linkComparator)\n    } else {\n      throw new TypeError('Invalid DAG-PB form')\n    }\n  } else {\n    pbn.Links = []\n  }\n\n  return pbn\n}\n\n/**\n * @param {PBNode} node\n */\nexport function validate (node) {\n  /*\n  type PBLink struct {\n    Hash optional Link\n    Name optional String\n    Tsize optional Int\n  }\n\n  type PBNode struct {\n    Links [PBLink]\n    Data optional Bytes\n  }\n  */\n  // @ts-ignore private property for TS\n  if (!node || typeof node !== 'object' || Array.isArray(node) || node instanceof Uint8Array || (node['/'] && node['/'] === node.bytes)) {\n    throw new TypeError('Invalid DAG-PB form')\n  }\n\n  if (!hasOnlyProperties(node, pbNodeProperties)) {\n    throw new TypeError('Invalid DAG-PB form (extraneous properties)')\n  }\n\n  if (node.Data !== undefined && !(node.Data instanceof Uint8Array)) {\n    throw new TypeError('Invalid DAG-PB form (Data must be bytes)')\n  }\n\n  if (!Array.isArray(node.Links)) {\n    throw new TypeError('Invalid DAG-PB form (Links must be a list)')\n  }\n\n  for (let i = 0; i < node.Links.length; i++) {\n    const link = node.Links[i]\n    // @ts-ignore private property for TS\n    if (!link || typeof link !== 'object' || Array.isArray(link) || link instanceof Uint8Array || (link['/'] && link['/'] === link.bytes)) {\n      throw new TypeError('Invalid DAG-PB form (bad link)')\n    }\n\n    if (!hasOnlyProperties(link, pbLinkProperties)) {\n      throw new TypeError('Invalid DAG-PB form (extraneous properties on link)')\n    }\n\n    if (link.Hash === undefined) {\n      throw new TypeError('Invalid DAG-PB form (link must have a Hash)')\n    }\n\n    // @ts-ignore private property for TS\n    if (link.Hash == null || !link.Hash['/'] || link.Hash['/'] !== link.Hash.bytes) {\n      throw new TypeError('Invalid DAG-PB form (link Hash must be a CID)')\n    }\n\n    if (link.Name !== undefined && typeof link.Name !== 'string') {\n      throw new TypeError('Invalid DAG-PB form (link Name must be a string)')\n    }\n\n    if (link.Tsize !== undefined) {\n      if (typeof link.Tsize !== 'number' || link.Tsize % 1 !== 0) {\n        throw new TypeError('Invalid DAG-PB form (link Tsize must be an integer)')\n      }\n      if (link.Tsize < 0) {\n        throw new TypeError('Invalid DAG-PB form (link Tsize cannot be negative)')\n      }\n    }\n\n    if (i > 0 && linkComparator(link, node.Links[i - 1]) === -1) {\n      throw new TypeError('Invalid DAG-PB form (links must be sorted by Name bytes)')\n    }\n  }\n}\n\n/**\n * @param {Uint8Array} data\n * @param {PBLink[]} [links=[]]\n * @returns {PBNode}\n */\nexport function createNode (data, links = []) {\n  return prepare({ Data: data, Links: links })\n}\n\n/**\n * @param {string} name\n * @param {number} size\n * @param {CID} cid\n * @returns {PBLink}\n */\nexport function createLink (name, size, cid) {\n  return asLink({ Hash: cid, Name: name, Tsize: size })\n}\n","import { CID } from 'multiformats/cid'\nimport { decodeNode } from './pb-decode.js'\nimport { encodeNode } from './pb-encode.js'\nimport { prepare, validate, createNode, createLink } from './util.js'\n\n/**\n * @template T\n * @typedef {import('multiformats/codecs/interface').ByteView<T>} ByteView\n */\n\n/**\n * @typedef {import('./interface.js').PBLink} PBLink\n * @typedef {import('./interface.js').PBNode} PBNode\n */\n\nexport const name = 'dag-pb'\nexport const code = 0x70\n\n/**\n * @param {PBNode} node\n * @returns {ByteView<PBNode>}\n */\nexport function encode (node) {\n  validate(node)\n\n  const pbn = {}\n  if (node.Links) {\n    pbn.Links = node.Links.map((l) => {\n      const link = {}\n      if (l.Hash) {\n        link.Hash = l.Hash.bytes // cid -> bytes\n      }\n      if (l.Name !== undefined) {\n        link.Name = l.Name\n      }\n      if (l.Tsize !== undefined) {\n        link.Tsize = l.Tsize\n      }\n      return link\n    })\n  }\n  if (node.Data) {\n    pbn.Data = node.Data\n  }\n\n  return encodeNode(pbn)\n}\n\n/**\n * @param {ByteView<PBNode>} bytes\n * @returns {PBNode}\n */\nexport function decode (bytes) {\n  const pbn = decodeNode(bytes)\n\n  const node = {}\n\n  if (pbn.Data) {\n    node.Data = pbn.Data\n  }\n\n  if (pbn.Links) {\n    node.Links = pbn.Links.map((l) => {\n      const link = {}\n      try {\n        link.Hash = CID.decode(l.Hash)\n      } catch (e) {}\n      if (!link.Hash) {\n        throw new Error('Invalid Hash field found in link, expected CID')\n      }\n      if (l.Name !== undefined) {\n        link.Name = l.Name\n      }\n      if (l.Tsize !== undefined) {\n        link.Tsize = l.Tsize\n      }\n      return link\n    })\n  }\n\n  return node\n}\n\nexport { prepare, validate, createNode, createLink }\n","// @ts-check\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nconst textEncoder = new TextEncoder()\nconst textDecoder = new TextDecoder()\n\nexport const name = 'json'\nexport const code = 0x0200\n\n/**\n * @template T\n * @param {T} node\n * @returns {ByteView<T>}\n */\nexport const encode = (node) => textEncoder.encode(JSON.stringify(node))\n\n/**\n * @template T\n * @param {ByteView<T>} data\n * @returns {T}\n */\nexport const decode = (data) => JSON.parse(textDecoder.decode(data))\n","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","/* eslint max-depth: [\"error\", 7] */\nimport * as dagCbor from '@ipld/dag-cbor';\nimport * as dagJson from '@ipld/dag-json';\nimport * as dagPb from '@ipld/dag-pb';\nimport * as cborg from 'cborg';\nimport { Type, Token } from 'cborg';\nimport * as cborgJson from 'cborg/json';\nimport { CID } from 'multiformats';\nimport { base64 } from 'multiformats/bases/base64';\nimport * as json from 'multiformats/codecs/json';\nimport * as raw from 'multiformats/codecs/raw';\n/**\n * Dag walker for dag-pb CIDs\n */\nexport const dagPbWalker = {\n    codec: dagPb.code,\n    async *walk(block) {\n        const node = dagPb.decode(block);\n        yield* node.Links.map(l => l.Hash);\n    }\n};\n/**\n * Dag walker for raw CIDs\n */\nexport const rawWalker = {\n    codec: raw.code,\n    async *walk() {\n        // no embedded CIDs in a raw block\n    }\n};\n// https://github.com/ipfs/go-ipfs/issues/3570#issuecomment-273931692\nconst CID_TAG = 42;\n/**\n * Dag walker for dag-cbor CIDs. Does not actually use dag-cbor since\n * all we are interested in is extracting the the CIDs from the block\n * so we can just use cborg for that.\n */\nexport const dagCborWalker = {\n    codec: dagCbor.code,\n    async *walk(block) {\n        const cids = [];\n        const tags = [];\n        tags[CID_TAG] = (bytes) => {\n            if (bytes[0] !== 0) {\n                throw new Error('Invalid CID for CBOR tag 42; expected leading 0x00');\n            }\n            const cid = CID.decode(bytes.subarray(1)); // ignore leading 0x00\n            cids.push(cid);\n            return cid;\n        };\n        cborg.decode(block, {\n            tags\n        });\n        yield* cids;\n    }\n};\n/**\n * Borrowed from @ipld/dag-json\n */\nclass DagJsonTokenizer extends cborgJson.Tokenizer {\n    tokenBuffer;\n    constructor(data, options) {\n        super(data, options);\n        this.tokenBuffer = [];\n    }\n    done() {\n        return this.tokenBuffer.length === 0 && super.done();\n    }\n    _next() {\n        if (this.tokenBuffer.length > 0) {\n            // @ts-expect-error https://github.com/Microsoft/TypeScript/issues/30406\n            return this.tokenBuffer.pop();\n        }\n        return super.next();\n    }\n    /**\n     * Implements rules outlined in https://github.com/ipld/specs/pull/356\n     */\n    next() {\n        const token = this._next();\n        if (token.type === Type.map) {\n            const keyToken = this._next();\n            if (keyToken.type === Type.string && keyToken.value === '/') {\n                const valueToken = this._next();\n                if (valueToken.type === Type.string) { // *must* be a CID\n                    const breakToken = this._next(); // swallow the end-of-map token\n                    if (breakToken.type !== Type.break) {\n                        throw new Error('Invalid encoded CID form');\n                    }\n                    this.tokenBuffer.push(valueToken); // CID.parse will pick this up after our tag token\n                    return new Token(Type.tag, 42, 0);\n                }\n                if (valueToken.type === Type.map) {\n                    const innerKeyToken = this._next();\n                    if (innerKeyToken.type === Type.string && innerKeyToken.value === 'bytes') {\n                        const innerValueToken = this._next();\n                        if (innerValueToken.type === Type.string) { // *must* be Bytes\n                            for (let i = 0; i < 2; i++) {\n                                const breakToken = this._next(); // swallow two end-of-map tokens\n                                if (breakToken.type !== Type.break) {\n                                    throw new Error('Invalid encoded Bytes form');\n                                }\n                            }\n                            const bytes = base64.decode(`m${innerValueToken.value}`);\n                            return new Token(Type.bytes, bytes, innerValueToken.value.length);\n                        }\n                        this.tokenBuffer.push(innerValueToken); // bail\n                    }\n                    this.tokenBuffer.push(innerKeyToken); // bail\n                }\n                this.tokenBuffer.push(valueToken); // bail\n            }\n            this.tokenBuffer.push(keyToken); // bail\n        }\n        return token;\n    }\n}\n/**\n * Dag walker for dag-json CIDs. Does not actually use dag-json since\n * all we are interested in is extracting the the CIDs from the block\n * so we can just use cborg/json for that.\n */\nexport const dagJsonWalker = {\n    codec: dagJson.code,\n    async *walk(block) {\n        const cids = [];\n        const tags = [];\n        tags[CID_TAG] = (string) => {\n            const cid = CID.parse(string);\n            cids.push(cid);\n            return cid;\n        };\n        cborgJson.decode(block, {\n            tags,\n            tokenizer: new DagJsonTokenizer(block, {\n                tags,\n                allowIndefinite: true,\n                allowUndefined: true,\n                allowNaN: true,\n                allowInfinity: true,\n                allowBigInt: true,\n                strict: false,\n                rejectDuplicateMapKeys: false\n            })\n        });\n        yield* cids;\n    }\n};\n/**\n * Dag walker for json CIDs. JSON has no facility for linking to\n * external blocks so the walker is a no-op.\n */\nexport const jsonWalker = {\n    codec: json.code,\n    async *walk() { }\n};\n//# sourceMappingURL=dag-walkers.js.map","import * as cborg from 'cborg';\nimport { Key } from 'interface-datastore';\nimport { base36 } from 'multiformats/bases/base36';\nimport { CID } from 'multiformats/cid';\nimport defer from 'p-defer';\nimport PQueue from 'p-queue';\nimport { CustomProgressEvent } from 'progress-events';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { dagCborWalker, dagJsonWalker, dagPbWalker, jsonWalker, rawWalker } from './utils/dag-walkers.js';\nconst DEFAULT_DAG_WALKERS = [\n    rawWalker,\n    dagPbWalker,\n    dagCborWalker,\n    dagJsonWalker,\n    jsonWalker\n];\nconst DATASTORE_PIN_PREFIX = '/pin/';\nconst DATASTORE_BLOCK_PREFIX = '/pinned-block/';\nconst DATASTORE_ENCODING = base36;\n// const DAG_WALK_MAX_QUEUE_LENGTH = 10\nconst DAG_WALK_QUEUE_CONCURRENCY = 1;\nfunction toDSKey(cid) {\n    if (cid.version === 0) {\n        cid = cid.toV1();\n    }\n    return new Key(`${DATASTORE_PIN_PREFIX}${cid.toString(DATASTORE_ENCODING)}`);\n}\nexport class PinsImpl {\n    datastore;\n    blockstore;\n    dagWalkers;\n    constructor(datastore, blockstore, dagWalkers) {\n        this.datastore = datastore;\n        this.blockstore = blockstore;\n        this.dagWalkers = {};\n        [...DEFAULT_DAG_WALKERS, ...dagWalkers].forEach(dagWalker => {\n            this.dagWalkers[dagWalker.codec] = dagWalker;\n        });\n    }\n    async add(cid, options = {}) {\n        const pinKey = toDSKey(cid);\n        if (await this.datastore.has(pinKey)) {\n            throw new Error('Already pinned');\n        }\n        const depth = Math.round(options.depth ?? Infinity);\n        if (depth < 0) {\n            throw new Error('Depth must be greater than or equal to 0');\n        }\n        // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs\n        const queue = new PQueue({\n            concurrency: DAG_WALK_QUEUE_CONCURRENCY\n        });\n        void queue.add(async () => {\n            await this.#walkDag(cid, queue, (pinnedBlock) => {\n                // do not update pinned block if this block is already pinned by this CID\n                if (pinnedBlock.pinnedBy.find(c => uint8ArrayEquals(c, cid.bytes)) != null) {\n                    return;\n                }\n                pinnedBlock.pinCount++;\n                pinnedBlock.pinnedBy.push(cid.bytes);\n            }, {\n                ...options,\n                depth\n            });\n        });\n        // if a job in the queue errors, throw that error\n        const deferred = defer();\n        queue.on('error', (err) => {\n            queue.clear();\n            deferred.reject(err);\n        });\n        // wait for the queue to complete or error\n        await Promise.race([\n            queue.onIdle(),\n            deferred.promise\n        ]);\n        const pin = {\n            depth,\n            metadata: options.metadata ?? {}\n        };\n        await this.datastore.put(pinKey, cborg.encode(pin), options);\n        return {\n            cid,\n            ...pin\n        };\n    }\n    /**\n     * Walk the DAG behind the passed CID, ensure all blocks are present in the blockstore\n     * and update the pin count for them\n     */\n    async #walkDag(cid, queue, withPinnedBlock, options) {\n        if (options.depth === -1) {\n            return;\n        }\n        const dagWalker = this.dagWalkers[cid.code];\n        if (dagWalker == null) {\n            throw new Error(`No dag walker found for cid codec ${cid.code}`);\n        }\n        const block = await this.blockstore.get(cid, options);\n        await this.#updatePinnedBlock(cid, withPinnedBlock, options);\n        // walk dag, ensure all blocks are present\n        for await (const cid of dagWalker.walk(block)) {\n            void queue.add(async () => {\n                await this.#walkDag(cid, queue, withPinnedBlock, {\n                    ...options,\n                    depth: options.depth - 1\n                });\n            });\n        }\n    }\n    /**\n     * Update the pin count for the CID\n     */\n    async #updatePinnedBlock(cid, withPinnedBlock, options) {\n        const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`);\n        let pinnedBlock = {\n            pinCount: 0,\n            pinnedBy: []\n        };\n        try {\n            pinnedBlock = cborg.decode(await this.datastore.get(blockKey, options));\n        }\n        catch (err) {\n            if (err.code !== 'ERR_NOT_FOUND') {\n                throw err;\n            }\n        }\n        withPinnedBlock(pinnedBlock);\n        if (pinnedBlock.pinCount === 0) {\n            if (await this.datastore.has(blockKey)) {\n                await this.datastore.delete(blockKey);\n                return;\n            }\n        }\n        await this.datastore.put(blockKey, cborg.encode(pinnedBlock), options);\n        options.onProgress?.(new CustomProgressEvent('helia:pin:add', { detail: cid }));\n    }\n    async rm(cid, options = {}) {\n        const pinKey = toDSKey(cid);\n        const buf = await this.datastore.get(pinKey, options);\n        const pin = cborg.decode(buf);\n        await this.datastore.delete(pinKey, options);\n        // use a queue to walk the DAG instead of recursion so we can traverse very large DAGs\n        const queue = new PQueue({\n            concurrency: DAG_WALK_QUEUE_CONCURRENCY\n        });\n        void queue.add(async () => {\n            await this.#walkDag(cid, queue, (pinnedBlock) => {\n                pinnedBlock.pinCount--;\n                pinnedBlock.pinnedBy = pinnedBlock.pinnedBy.filter(c => uint8ArrayEquals(c, cid.bytes));\n            }, {\n                ...options,\n                depth: pin.depth\n            });\n        });\n        await queue.onIdle();\n        return {\n            cid,\n            ...pin\n        };\n    }\n    async *ls(options = {}) {\n        for await (const { key, value } of this.datastore.query({\n            prefix: DATASTORE_PIN_PREFIX + (options.cid != null ? `${options.cid.toString(base36)}` : '')\n        }, options)) {\n            const cid = CID.parse(key.toString().substring(5), base36);\n            const pin = cborg.decode(value);\n            yield {\n                cid,\n                ...pin\n            };\n        }\n    }\n    async isPinned(cid, options = {}) {\n        const blockKey = new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(cid.multihash.bytes)}`);\n        return this.datastore.has(blockKey, options);\n    }\n}\n//# sourceMappingURL=pins.js.map","import createMortice from 'mortice';\n/**\n * BlockStorage is a hybrid blockstore that puts/gets blocks from a configured\n * blockstore (that may be on disk, s3, or something else). If the blocks are\n * not present Bitswap will be used to fetch them from network peers.\n */\nexport class BlockStorage {\n    lock;\n    child;\n    pins;\n    /**\n     * Create a new BlockStorage\n     */\n    constructor(blockstore, pins, options = {}) {\n        this.child = blockstore;\n        this.pins = pins;\n        this.lock = createMortice({\n            singleProcess: options.holdGcLock\n        });\n    }\n    unwrap() {\n        return this.child;\n    }\n    /**\n     * Put a block to the underlying datastore\n     */\n    async put(cid, block, options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            return await this.child.put(cid, block, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    /**\n     * Put a multiple blocks to the underlying datastore\n     */\n    async *putMany(blocks, options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            yield* this.child.putMany(blocks, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    /**\n     * Get a block by cid\n     */\n    async get(cid, options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            return await this.child.get(cid, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    /**\n     * Get multiple blocks back from an (async) iterable of cids\n     */\n    async *getMany(cids, options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            yield* this.child.getMany(cids, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    /**\n     * Delete a block from the blockstore\n     */\n    async delete(cid, options = {}) {\n        const releaseLock = await this.lock.writeLock();\n        try {\n            if (await this.pins.isPinned(cid)) {\n                throw new Error('CID was pinned');\n            }\n            await this.child.delete(cid, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    /**\n     * Delete multiple blocks from the blockstore\n     */\n    async *deleteMany(cids, options = {}) {\n        const releaseLock = await this.lock.writeLock();\n        try {\n            const storage = this;\n            yield* this.child.deleteMany((async function* () {\n                for await (const cid of cids) {\n                    if (await storage.pins.isPinned(cid)) {\n                        throw new Error('CID was pinned');\n                    }\n                    yield cid;\n                }\n            }()), options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    async has(cid, options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            return await this.child.has(cid, options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n    async *getAll(options = {}) {\n        const releaseLock = await this.lock.readLock();\n        try {\n            yield* this.child.getAll(options);\n        }\n        finally {\n            releaseLock();\n        }\n    }\n}\n//# sourceMappingURL=storage.js.map","import { Key } from 'interface-datastore';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nconst DS_VERSION_KEY = new Key('/version');\nconst CURRENT_VERSION = 1;\nexport async function assertDatastoreVersionIsCurrent(datastore) {\n    if (!(await datastore.has(DS_VERSION_KEY))) {\n        await datastore.put(DS_VERSION_KEY, uint8ArrayFromString(`${CURRENT_VERSION}`));\n        return;\n    }\n    const buf = await datastore.get(DS_VERSION_KEY);\n    const str = uint8ArrayToString(buf);\n    const version = parseInt(str, 10);\n    if (version !== CURRENT_VERSION) {\n        // TODO: write migrations when we break compatibility - for an example, see https://github.com/ipfs/js-ipfs-repo/tree/master/packages/ipfs-repo-migrations\n        throw new Error('Unknown datastore version, a datastore migration may be required');\n    }\n}\n//# sourceMappingURL=datastore-version.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction filter(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const entry of source) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    // if mapping function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    // @ts-expect-error .then is not present on O\n    if (typeof res.then === 'function') {\n        return (async function* () {\n            if (await res) {\n                yield value;\n            }\n            for await (const entry of peekable) {\n                if (await fn(entry)) {\n                    yield entry;\n                }\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        if (res === true) {\n            yield value;\n        }\n        for (const entry of peekable) {\n            if (func(entry)) {\n                yield entry;\n            }\n        }\n    })();\n}\nexport default filter;\n//# sourceMappingURL=index.js.map","import peek from 'it-peekable';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nfunction forEach(source, fn) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            for await (const thing of source) {\n                await fn(thing);\n                yield thing;\n            }\n        })();\n    }\n    // if fn function returns a promise we have to return an async generator\n    const peekable = peek(source);\n    const { value, done } = peekable.next();\n    if (done === true) {\n        return (function* () { }());\n    }\n    const res = fn(value);\n    if (typeof res?.then === 'function') {\n        return (async function* () {\n            yield value;\n            for await (const val of peekable) {\n                await fn(val);\n                yield val;\n            }\n        })();\n    }\n    const func = fn;\n    return (function* () {\n        yield value;\n        for (const val of peekable) {\n            func(val);\n            yield val;\n        }\n    })();\n}\nexport default forEach;\n//# sourceMappingURL=index.js.map","import filter from 'it-filter';\nimport forEach from 'it-foreach';\nimport { CustomProgressEvent } from 'progress-events';\n/**\n * Networked storage wraps a regular blockstore - when getting blocks if the\n * blocks are not present Bitswap will be used to fetch them from network peers.\n */\nexport class NetworkedStorage {\n    child;\n    bitswap;\n    /**\n     * Create a new BlockStorage\n     */\n    constructor(blockstore, options = {}) {\n        this.child = blockstore;\n        this.bitswap = options.bitswap;\n    }\n    unwrap() {\n        return this.child;\n    }\n    /**\n     * Put a block to the underlying datastore\n     */\n    async put(cid, block, options = {}) {\n        if (await this.child.has(cid)) {\n            options.onProgress?.(new CustomProgressEvent('blocks:put:duplicate', cid));\n            return cid;\n        }\n        if (this.bitswap?.isStarted() === true) {\n            options.onProgress?.(new CustomProgressEvent('blocks:put:bitswap:notify', cid));\n            this.bitswap.notify(cid, block, options);\n        }\n        options.onProgress?.(new CustomProgressEvent('blocks:put:blockstore:put', cid));\n        return this.child.put(cid, block, options);\n    }\n    /**\n     * Put a multiple blocks to the underlying datastore\n     */\n    async *putMany(blocks, options = {}) {\n        const missingBlocks = filter(blocks, async ({ cid }) => {\n            const has = await this.child.has(cid);\n            if (has) {\n                options.onProgress?.(new CustomProgressEvent('blocks:put-many:duplicate', cid));\n            }\n            return !has;\n        });\n        const notifyEach = forEach(missingBlocks, ({ cid, block }) => {\n            options.onProgress?.(new CustomProgressEvent('blocks:put-many:bitswap:notify', cid));\n            this.bitswap?.notify(cid, block, options);\n        });\n        options.onProgress?.(new CustomProgressEvent('blocks:put-many:blockstore:put-many'));\n        yield* this.child.putMany(notifyEach, options);\n    }\n    /**\n     * Get a block by cid\n     */\n    async get(cid, options = {}) {\n        if (options.offline !== true && this.bitswap?.isStarted() != null && !(await this.child.has(cid))) {\n            options.onProgress?.(new CustomProgressEvent('blocks:get:bitswap:get', cid));\n            const block = await this.bitswap.want(cid, options);\n            options.onProgress?.(new CustomProgressEvent('blocks:get:blockstore:put', cid));\n            await this.child.put(cid, block, options);\n            return block;\n        }\n        options.onProgress?.(new CustomProgressEvent('blocks:get:blockstore:get', cid));\n        return this.child.get(cid, options);\n    }\n    /**\n     * Get multiple blocks back from an (async) iterable of cids\n     */\n    async *getMany(cids, options = {}) {\n        options.onProgress?.(new CustomProgressEvent('blocks:get-many:blockstore:get-many'));\n        yield* this.child.getMany(forEach(cids, async (cid) => {\n            if (options.offline !== true && this.bitswap?.isStarted() === true && !(await this.child.has(cid))) {\n                options.onProgress?.(new CustomProgressEvent('blocks:get-many:bitswap:get', cid));\n                const block = await this.bitswap.want(cid, options);\n                options.onProgress?.(new CustomProgressEvent('blocks:get-many:blockstore:put', cid));\n                await this.child.put(cid, block, options);\n            }\n        }));\n    }\n    /**\n     * Delete a block from the blockstore\n     */\n    async delete(cid, options = {}) {\n        options.onProgress?.(new CustomProgressEvent('blocks:delete:blockstore:delete', cid));\n        await this.child.delete(cid, options);\n    }\n    /**\n     * Delete multiple blocks from the blockstore\n     */\n    async *deleteMany(cids, options = {}) {\n        options.onProgress?.(new CustomProgressEvent('blocks:delete-many:blockstore:delete-many'));\n        yield* this.child.deleteMany((async function* () {\n            for await (const cid of cids) {\n                yield cid;\n            }\n        }()), options);\n    }\n    async has(cid, options = {}) {\n        return this.child.has(cid, options);\n    }\n    async *getAll(options = {}) {\n        options.onProgress?.(new CustomProgressEvent('blocks:get-all:blockstore:get-many'));\n        yield* this.child.getAll(options);\n    }\n}\n//# sourceMappingURL=networked-storage.js.map","import { logger } from '@libp2p/logger';\nimport { createBitswap } from 'ipfs-bitswap';\nimport drain from 'it-drain';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256, sha512 } from 'multiformats/hashes/sha2';\nimport { CustomProgressEvent } from 'progress-events';\nimport { PinsImpl } from './pins.js';\nimport { BlockStorage } from './storage.js';\nimport { assertDatastoreVersionIsCurrent } from './utils/datastore-version.js';\nimport { NetworkedStorage } from './utils/networked-storage.js';\nconst log = logger('helia');\nexport class HeliaImpl {\n    libp2p;\n    blockstore;\n    datastore;\n    pins;\n    #bitswap;\n    constructor(init) {\n        const hashers = [\n            sha256,\n            sha512,\n            identity,\n            ...(init.hashers ?? [])\n        ];\n        this.#bitswap = createBitswap(init.libp2p, init.blockstore, {\n            hashLoader: {\n                getHasher: async (codecOrName) => {\n                    const hasher = hashers.find(hasher => {\n                        return hasher.code === codecOrName || hasher.name === codecOrName;\n                    });\n                    if (hasher != null) {\n                        return hasher;\n                    }\n                    throw new Error(`Could not load hasher for code/name \"${codecOrName}\"`);\n                }\n            }\n        });\n        const networkedStorage = new NetworkedStorage(init.blockstore, {\n            bitswap: this.#bitswap\n        });\n        this.pins = new PinsImpl(init.datastore, networkedStorage, init.dagWalkers ?? []);\n        this.libp2p = init.libp2p;\n        this.blockstore = new BlockStorage(networkedStorage, this.pins, {\n            holdGcLock: init.holdGcLock\n        });\n        this.datastore = init.datastore;\n    }\n    async start() {\n        await assertDatastoreVersionIsCurrent(this.datastore);\n        await this.#bitswap?.start();\n        await this.libp2p.start();\n    }\n    async stop() {\n        await this.libp2p.stop();\n        await this.#bitswap?.stop();\n    }\n    async gc(options = {}) {\n        const releaseLock = await this.blockstore.lock.writeLock();\n        try {\n            const helia = this;\n            const blockstore = this.blockstore.unwrap();\n            log('gc start');\n            await drain(blockstore.deleteMany((async function* () {\n                for await (const { cid } of blockstore.getAll()) {\n                    try {\n                        if (await helia.pins.isPinned(cid, options)) {\n                            continue;\n                        }\n                        yield cid;\n                        options.onProgress?.(new CustomProgressEvent('helia:gc:deleted', cid));\n                    }\n                    catch (err) {\n                        log.error('Error during gc', err);\n                        options.onProgress?.(new CustomProgressEvent('helia:gc:error', err));\n                    }\n                }\n            }())));\n        }\n        finally {\n            releaseLock();\n        }\n        log('gc finished');\n    }\n}\n//# sourceMappingURL=helia.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","import { baseX } from './base.js'\n\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n})\n\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n})\n","import { from } from './base.js'\n\nconst alphabet = Array.from('🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂')\nconst alphabetBytesToChars = /** @type {string[]} */ (alphabet.reduce((p, c, i) => { p[i] = c; return p }, /** @type {string[]} */([])))\nconst alphabetCharsToBytes = /** @type {number[]} */ (alphabet.reduce((p, c, i) => { p[/** @type {number} */ (c.codePointAt(0))] = i; return p }, /** @type {number[]} */([])))\n\n/**\n * @param {Uint8Array} data\n * @returns {string}\n */\nfunction encode (data) {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c]\n    return p\n  }, '')\n}\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction decode (str) {\n  const byts = []\n  for (const char of str) {\n    const byt = alphabetCharsToBytes[/** @type {number} */ (char.codePointAt(0))]\n    if (byt === undefined) {\n      throw new Error(`Non-base256emoji character: ${char}`)\n    }\n    byts.push(byt)\n  }\n  return new Uint8Array(byts)\n}\n\nexport const base256emoji = from({\n  prefix: '🚀',\n  name: 'base256emoji',\n  encode,\n  decode\n})\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n})\n\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n})\n","// @ts-check\n\nimport { fromString, toString } from '../bytes.js'\nimport { from } from './base.js'\n\nexport const identity = from({\n  prefix: '\\x00',\n  name: 'identity',\n  encode: (buf) => toString(buf),\n  decode: (str) => fromString(str)\n})\n","// @ts-check\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nconst textEncoder = new TextEncoder()\nconst textDecoder = new TextDecoder()\n\nexport const name = 'json'\nexport const code = 0x0200\n\n/**\n * @template T\n * @param {T} node\n * @returns {ByteView<T>}\n */\nexport const encode = (node) => textEncoder.encode(JSON.stringify(node))\n\n/**\n * @template T\n * @param {ByteView<T>} data\n * @returns {T}\n */\nexport const decode = (data) => JSON.parse(textDecoder.decode(data))\n","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code = 0x0\nconst name = 'identity'\n\n/** @type {(input:Uint8Array) => Uint8Array} */\nconst encode = coerce\n\n/**\n * @param {Uint8Array} input\n * @returns {Digest.Digest<typeof code, number>}\n */\nconst digest = (input) => Digest.create(code, encode(input))\n\nexport const identity = { code, name, encode, digest }\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","/* global crypto */\n\nimport { from } from './hasher.js'\n\n/**\n * @param {AlgorithmIdentifier} name\n */\nconst sha = name =>\n  /**\n   * @param {Uint8Array} data\n   */\n  async data => new Uint8Array(await crypto.subtle.digest(name, data))\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n","import { base32 } from './bases/base32.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\nimport * as varint from './varint.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  /**\n   * @returns {API.LinkJSON<this>}\n   */\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","// @ts-check\n\nimport * as base10 from './bases/base10.js'\nimport * as base16 from './bases/base16.js'\nimport * as base2 from './bases/base2.js'\nimport * as base256emoji from './bases/base256emoji.js'\nimport * as base32 from './bases/base32.js'\nimport * as base36 from './bases/base36.js'\nimport * as base58 from './bases/base58.js'\nimport * as base64 from './bases/base64.js'\nimport * as base8 from './bases/base8.js'\nimport * as identityBase from './bases/identity.js'\nimport * as json from './codecs/json.js'\nimport * as raw from './codecs/raw.js'\nimport * as identity from './hashes/identity.js'\nimport * as sha2 from './hashes/sha2.js'\nimport { CID, hasher, digest, varint, bytes } from './index.js'\n\nconst bases = { ...identityBase, ...base2, ...base8, ...base10, ...base16, ...base32, ...base36, ...base58, ...base64, ...base256emoji }\nconst hashes = { ...sha2, ...identity }\nconst codecs = { raw, json }\n\nexport { CID, hasher, digest, varint, bytes, hashes, bases, codecs }\n","/**\n * Returns true if the two passed Uint8Arrays have the same content\n */\nexport function equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a.byteLength !== b.byteLength) {\n        return false;\n    }\n    for (let i = 0; i < a.byteLength; i++) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=equals.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { symbol } from '@libp2p/interface/peer-id';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { bases } from 'multiformats/basics';\nimport { CID } from 'multiformats/cid';\nimport * as Digest from 'multiformats/hashes/digest';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nconst inspect = Symbol.for('nodejs.util.inspect.custom');\nconst baseDecoder = Object\n    .values(bases)\n    .map(codec => codec.decoder)\n    // @ts-expect-error https://github.com/multiformats/js-multiformats/issues/141\n    .reduce((acc, curr) => acc.or(curr), bases.identity.decoder);\n// these values are from https://github.com/multiformats/multicodec/blob/master/table.csv\nconst LIBP2P_KEY_CODE = 0x72;\nconst MARSHALLED_ED225519_PUBLIC_KEY_LENGTH = 36;\nconst MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH = 37;\nclass PeerIdImpl {\n    type;\n    multihash;\n    privateKey;\n    publicKey;\n    string;\n    constructor(init) {\n        this.type = init.type;\n        this.multihash = init.multihash;\n        this.privateKey = init.privateKey;\n        // mark string cache as non-enumerable\n        Object.defineProperty(this, 'string', {\n            enumerable: false,\n            writable: true\n        });\n    }\n    get [Symbol.toStringTag]() {\n        return `PeerId(${this.toString()})`;\n    }\n    [symbol] = true;\n    toString() {\n        if (this.string == null) {\n            this.string = base58btc.encode(this.multihash.bytes).slice(1);\n        }\n        return this.string;\n    }\n    // return self-describing String representation\n    // in default format from RFC 0001: https://github.com/libp2p/specs/pull/209\n    toCID() {\n        return CID.createV1(LIBP2P_KEY_CODE, this.multihash);\n    }\n    toBytes() {\n        return this.multihash.bytes;\n    }\n    /**\n     * Returns Multiaddr as a JSON string\n     */\n    toJSON() {\n        return this.toString();\n    }\n    /**\n     * Checks the equality of `this` peer against a given PeerId\n     */\n    equals(id) {\n        if (id instanceof Uint8Array) {\n            return uint8ArrayEquals(this.multihash.bytes, id);\n        }\n        else if (typeof id === 'string') {\n            return peerIdFromString(id).equals(this);\n        }\n        else if (id?.multihash?.bytes != null) {\n            return uint8ArrayEquals(this.multihash.bytes, id.multihash.bytes);\n        }\n        else {\n            throw new Error('not valid Id');\n        }\n    }\n    /**\n     * Returns PeerId as a human-readable string\n     * https://nodejs.org/api/util.html#utilinspectcustom\n     *\n     * @example\n     * ```js\n     * import { peerIdFromString } from '@libp2p/peer-id'\n     *\n     * console.info(peerIdFromString('QmFoo'))\n     * // 'PeerId(QmFoo)'\n     * ```\n     */\n    [inspect]() {\n        return `PeerId(${this.toString()})`;\n    }\n}\nclass RSAPeerIdImpl extends PeerIdImpl {\n    type = 'RSA';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'RSA' });\n        this.publicKey = init.publicKey;\n    }\n}\nclass Ed25519PeerIdImpl extends PeerIdImpl {\n    type = 'Ed25519';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'Ed25519' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nclass Secp256k1PeerIdImpl extends PeerIdImpl {\n    type = 'secp256k1';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'secp256k1' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nexport function createPeerId(init) {\n    if (init.type === 'RSA') {\n        return new RSAPeerIdImpl(init);\n    }\n    if (init.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(init);\n    }\n    if (init.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(init);\n    }\n    throw new CodeError('Type must be \"RSA\", \"Ed25519\" or \"secp256k1\"', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromPeerId(other) {\n    if (other.type === 'RSA') {\n        return new RSAPeerIdImpl(other);\n    }\n    if (other.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(other);\n    }\n    if (other.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(other);\n    }\n    throw new CodeError('Not a PeerId', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromString(str, decoder) {\n    decoder = decoder ?? baseDecoder;\n    if (str.charAt(0) === '1' || str.charAt(0) === 'Q') {\n        // identity hash ed25519/secp256k1 key or sha2-256 hash of\n        // rsa public key - base58btc encoded either way\n        const multihash = Digest.decode(base58btc.decode(`z${str}`));\n        if (str.startsWith('12D')) {\n            return new Ed25519PeerIdImpl({ multihash });\n        }\n        else if (str.startsWith('16U')) {\n            return new Secp256k1PeerIdImpl({ multihash });\n        }\n        else {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    return peerIdFromBytes(baseDecoder.decode(str));\n}\nexport function peerIdFromBytes(buf) {\n    try {\n        const multihash = Digest.decode(buf);\n        if (multihash.code === identity.code) {\n            if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n                return new Ed25519PeerIdImpl({ multihash });\n            }\n            else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n                return new Secp256k1PeerIdImpl({ multihash });\n            }\n        }\n        if (multihash.code === sha256.code) {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    catch {\n        return peerIdFromCID(CID.decode(buf));\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\nexport function peerIdFromCID(cid) {\n    if (cid == null || cid.multihash == null || cid.version == null || (cid.version === 1 && cid.code !== LIBP2P_KEY_CODE)) {\n        throw new Error('Supplied PeerID CID is invalid');\n    }\n    const multihash = cid.multihash;\n    if (multihash.code === sha256.code) {\n        return new RSAPeerIdImpl({ multihash: cid.multihash });\n    }\n    else if (multihash.code === identity.code) {\n        if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n            return new Ed25519PeerIdImpl({ multihash: cid.multihash });\n        }\n        else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n            return new Secp256k1PeerIdImpl({ multihash: cid.multihash });\n        }\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\n/**\n * @param publicKey - A marshalled public key\n * @param privateKey - A marshalled private key\n */\nexport async function peerIdFromKeys(publicKey, privateKey) {\n    if (publicKey.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n        return new Ed25519PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    if (publicKey.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n        return new Secp256k1PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    return new RSAPeerIdImpl({ multihash: await sha256.digest(publicKey), publicKey, privateKey });\n}\n//# sourceMappingURL=index.js.map","import debug from 'debug';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { base64 } from 'multiformats/bases/base64';\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v) => {\n    return v == null ? 'undefined' : base58btc.baseEncode(v);\n};\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v) => {\n    return v == null ? 'undefined' : base32.baseEncode(v);\n};\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v) => {\n    return v == null ? 'undefined' : base64.baseEncode(v);\n};\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v) => {\n    return v == null ? 'undefined' : v.toString();\n};\nfunction createDisabledLogger(namespace) {\n    const logger = () => { };\n    logger.enabled = false;\n    logger.color = '';\n    logger.diff = 0;\n    logger.log = () => { };\n    logger.namespace = namespace;\n    logger.destroy = () => true;\n    logger.extend = () => logger;\n    return logger;\n}\nexport function logger(name) {\n    // trace logging is a no-op by default\n    let trace = createDisabledLogger(`${name}:trace`);\n    // look at all the debug names and see if trace logging has explicitly been enabled\n    if (debug.enabled(`${name}:trace`) && debug.names.map(r => r.toString()).find(n => n.includes(':trace')) != null) {\n        trace = debug(`${name}:trace`);\n    }\n    return Object.assign(debug(name), {\n        error: debug(`${name}:error`),\n        trace\n    });\n}\nexport function disable() {\n    debug.disable();\n}\nexport function enable(namespaces) {\n    debug.enable(namespaces);\n}\nexport function enabled(namespaces) {\n    return debug.enabled(namespaces);\n}\n//# sourceMappingURL=index.js.map","export class MessageCache {\n    gossip;\n    msgs = new Map();\n    msgIdToStrFn;\n    history = [];\n    /** Track with accounting of messages in the mcache that are not yet validated */\n    notValidatedCount = 0;\n    /**\n     * Holds history of messages in timebounded history arrays\n     */\n    constructor(\n    /**\n     * The number of indices in the cache history used for gossiping. That means that a message\n     * won't get gossiped anymore when shift got called `gossip` many times after inserting the\n     * message in the cache.\n     */\n    gossip, historyCapacity, msgIdToStrFn) {\n        this.gossip = gossip;\n        this.msgIdToStrFn = msgIdToStrFn;\n        for (let i = 0; i < historyCapacity; i++) {\n            this.history[i] = [];\n        }\n    }\n    get size() {\n        return this.msgs.size;\n    }\n    /**\n     * Adds a message to the current window and the cache\n     * Returns true if the message is not known and is inserted in the cache\n     */\n    put(messageId, msg, validated = false) {\n        const { msgIdStr } = messageId;\n        // Don't add duplicate entries to the cache.\n        if (this.msgs.has(msgIdStr)) {\n            return false;\n        }\n        this.msgs.set(msgIdStr, {\n            message: msg,\n            validated,\n            originatingPeers: new Set(),\n            iwantCounts: new Map()\n        });\n        this.history[0].push({ ...messageId, topic: msg.topic });\n        if (!validated) {\n            this.notValidatedCount++;\n        }\n        return true;\n    }\n    observeDuplicate(msgId, fromPeerIdStr) {\n        const entry = this.msgs.get(msgId);\n        if (entry &&\n            // if the message is already validated, we don't need to store extra peers sending us\n            // duplicates as the message has already been forwarded\n            !entry.validated) {\n            entry.originatingPeers.add(fromPeerIdStr);\n        }\n    }\n    /**\n     * Retrieves a message from the cache by its ID, if it is still present\n     */\n    get(msgId) {\n        return this.msgs.get(this.msgIdToStrFn(msgId))?.message;\n    }\n    /**\n     * Increases the iwant count for the given message by one and returns the message together\n     * with the iwant if the message exists.\n     */\n    getWithIWantCount(msgIdStr, p) {\n        const msg = this.msgs.get(msgIdStr);\n        if (!msg) {\n            return null;\n        }\n        const count = (msg.iwantCounts.get(p) ?? 0) + 1;\n        msg.iwantCounts.set(p, count);\n        return { msg: msg.message, count };\n    }\n    /**\n     * Retrieves a list of message IDs for a set of topics\n     */\n    getGossipIDs(topics) {\n        const msgIdsByTopic = new Map();\n        for (let i = 0; i < this.gossip; i++) {\n            this.history[i].forEach((entry) => {\n                const msg = this.msgs.get(entry.msgIdStr);\n                if (msg && msg.validated && topics.has(entry.topic)) {\n                    let msgIds = msgIdsByTopic.get(entry.topic);\n                    if (!msgIds) {\n                        msgIds = [];\n                        msgIdsByTopic.set(entry.topic, msgIds);\n                    }\n                    msgIds.push(entry.msgId);\n                }\n            });\n        }\n        return msgIdsByTopic;\n    }\n    /**\n     * Gets a message with msgId and tags it as validated.\n     * This function also returns the known peers that have sent us this message. This is used to\n     * prevent us sending redundant messages to peers who have already propagated it.\n     */\n    validate(msgId) {\n        const entry = this.msgs.get(msgId);\n        if (!entry) {\n            return null;\n        }\n        if (!entry.validated) {\n            this.notValidatedCount--;\n        }\n        const { message, originatingPeers } = entry;\n        entry.validated = true;\n        // Clear the known peers list (after a message is validated, it is forwarded and we no\n        // longer need to store the originating peers).\n        entry.originatingPeers = new Set();\n        return { message, originatingPeers };\n    }\n    /**\n     * Shifts the current window, discarding messages older than this.history.length of the cache\n     */\n    shift() {\n        const lastCacheEntries = this.history[this.history.length - 1];\n        lastCacheEntries.forEach((cacheEntry) => {\n            const entry = this.msgs.get(cacheEntry.msgIdStr);\n            if (entry) {\n                this.msgs.delete(cacheEntry.msgIdStr);\n                if (!entry.validated) {\n                    this.notValidatedCount--;\n                }\n            }\n        });\n        this.history.pop();\n        this.history.unshift([]);\n    }\n    remove(msgId) {\n        const entry = this.msgs.get(msgId);\n        if (!entry) {\n            return null;\n        }\n        // Keep the message on the history vector, it will be dropped on a shift()\n        this.msgs.delete(msgId);\n        return entry;\n    }\n}\n//# sourceMappingURL=message-cache.js.map","import cjs from \"./rpc.cjs\"\n\nexport const {RPC} = cjs\n","export const second = 1000;\nexport const minute = 60 * second;\n// Protocol identifiers\nexport const FloodsubID = '/floodsub/1.0.0';\n/**\n * The protocol ID for version 1.0.0 of the Gossipsub protocol\n * It is advertised along with GossipsubIDv11 for backwards compatability\n */\nexport const GossipsubIDv10 = '/meshsub/1.0.0';\n/**\n * The protocol ID for version 1.1.0 of the Gossipsub protocol\n * See the spec for details about how v1.1.0 compares to v1.0.0:\n * https://github.com/libp2p/specs/blob/master/pubsub/gossipsub/gossipsub-v1.1.md\n */\nexport const GossipsubIDv11 = '/meshsub/1.1.0';\n// Overlay parameters\n/**\n * GossipsubD sets the optimal degree for a Gossipsub topic mesh. For example, if GossipsubD == 6,\n * each peer will want to have about six peers in their mesh for each topic they're subscribed to.\n * GossipsubD should be set somewhere between GossipsubDlo and GossipsubDhi.\n */\nexport const GossipsubD = 6;\n/**\n * GossipsubDlo sets the lower bound on the number of peers we keep in a Gossipsub topic mesh.\n * If we have fewer than GossipsubDlo peers, we will attempt to graft some more into the mesh at\n * the next heartbeat.\n */\nexport const GossipsubDlo = 4;\n/**\n * GossipsubDhi sets the upper bound on the number of peers we keep in a Gossipsub topic mesh.\n * If we have more than GossipsubDhi peers, we will select some to prune from the mesh at the next heartbeat.\n */\nexport const GossipsubDhi = 12;\n/**\n * GossipsubDscore affects how peers are selected when pruning a mesh due to over subscription.\n * At least GossipsubDscore of the retained peers will be high-scoring, while the remainder are\n * chosen randomly.\n */\nexport const GossipsubDscore = 4;\n/**\n * GossipsubDout sets the quota for the number of outbound connections to maintain in a topic mesh.\n * When the mesh is pruned due to over subscription, we make sure that we have outbound connections\n * to at least GossipsubDout of the survivor peers. This prevents sybil attackers from overwhelming\n * our mesh with incoming connections.\n *\n * GossipsubDout must be set below GossipsubDlo, and must not exceed GossipsubD / 2.\n */\nexport const GossipsubDout = 2;\n// Gossip parameters\n/**\n * GossipsubHistoryLength controls the size of the message cache used for gossip.\n * The message cache will remember messages for GossipsubHistoryLength heartbeats.\n */\nexport const GossipsubHistoryLength = 5;\n/**\n * GossipsubHistoryGossip controls how many cached message ids we will advertise in\n * IHAVE gossip messages. When asked for our seen message IDs, we will return\n * only those from the most recent GossipsubHistoryGossip heartbeats. The slack between\n * GossipsubHistoryGossip and GossipsubHistoryLength allows us to avoid advertising messages\n * that will be expired by the time they're requested.\n *\n * GossipsubHistoryGossip must be less than or equal to GossipsubHistoryLength to\n * avoid a runtime panic.\n */\nexport const GossipsubHistoryGossip = 3;\n/**\n * GossipsubDlazy affects how many peers we will emit gossip to at each heartbeat.\n * We will send gossip to at least GossipsubDlazy peers outside our mesh. The actual\n * number may be more, depending on GossipsubGossipFactor and how many peers we're\n * connected to.\n */\nexport const GossipsubDlazy = 6;\n/**\n * GossipsubGossipFactor affects how many peers we will emit gossip to at each heartbeat.\n * We will send gossip to GossipsubGossipFactor * (total number of non-mesh peers), or\n * GossipsubDlazy, whichever is greater.\n */\nexport const GossipsubGossipFactor = 0.25;\n/**\n * GossipsubGossipRetransmission controls how many times we will allow a peer to request\n * the same message id through IWANT gossip before we start ignoring them. This is designed\n * to prevent peers from spamming us with requests and wasting our resources.\n */\nexport const GossipsubGossipRetransmission = 3;\n// Heartbeat interval\n/**\n * GossipsubHeartbeatInitialDelay is the short delay before the heartbeat timer begins\n * after the router is initialized.\n */\nexport const GossipsubHeartbeatInitialDelay = 100;\n/**\n * GossipsubHeartbeatInterval controls the time between heartbeats.\n */\nexport const GossipsubHeartbeatInterval = second;\n/**\n * GossipsubFanoutTTL controls how long we keep track of the fanout state. If it's been\n * GossipsubFanoutTTL since we've published to a topic that we're not subscribed to,\n * we'll delete the fanout map for that topic.\n */\nexport const GossipsubFanoutTTL = minute;\n/**\n * GossipsubPrunePeers controls the number of peers to include in prune Peer eXchange.\n * When we prune a peer that's eligible for PX (has a good score, etc), we will try to\n * send them signed peer records for up to GossipsubPrunePeers other peers that we\n * know of.\n */\nexport const GossipsubPrunePeers = 16;\n/**\n * GossipsubPruneBackoff controls the backoff time for pruned peers. This is how long\n * a peer must wait before attempting to graft into our mesh again after being pruned.\n * When pruning a peer, we send them our value of GossipsubPruneBackoff so they know\n * the minimum time to wait. Peers running older versions may not send a backoff time,\n * so if we receive a prune message without one, we will wait at least GossipsubPruneBackoff\n * before attempting to re-graft.\n */\nexport const GossipsubPruneBackoff = minute;\n/**\n * Backoff to use when unsuscribing from a topic. Should not resubscribe to this topic before it expired.\n */\nexport const GossipsubUnsubscribeBackoff = 10 * second;\n/**\n * GossipsubPruneBackoffTicks is the number of heartbeat ticks for attempting to prune expired\n * backoff timers.\n */\nexport const GossipsubPruneBackoffTicks = 15;\n/**\n * GossipsubConnectors controls the number of active connection attempts for peers obtained through PX.\n */\nexport const GossipsubConnectors = 8;\n/**\n * GossipsubMaxPendingConnections sets the maximum number of pending connections for peers attempted through px.\n */\nexport const GossipsubMaxPendingConnections = 128;\n/**\n * GossipsubConnectionTimeout controls the timeout for connection attempts.\n */\nexport const GossipsubConnectionTimeout = 30 * second;\n/**\n * GossipsubDirectConnectTicks is the number of heartbeat ticks for attempting to reconnect direct peers\n * that are not currently connected.\n */\nexport const GossipsubDirectConnectTicks = 300;\n/**\n * GossipsubDirectConnectInitialDelay is the initial delay before opening connections to direct peers\n */\nexport const GossipsubDirectConnectInitialDelay = second;\n/**\n * GossipsubOpportunisticGraftTicks is the number of heartbeat ticks for attempting to improve the mesh\n * with opportunistic grafting. Every GossipsubOpportunisticGraftTicks we will attempt to select some\n * high-scoring mesh peers to replace lower-scoring ones, if the median score of our mesh peers falls\n * below a threshold\n */\nexport const GossipsubOpportunisticGraftTicks = 60;\n/**\n * GossipsubOpportunisticGraftPeers is the number of peers to opportunistically graft.\n */\nexport const GossipsubOpportunisticGraftPeers = 2;\n/**\n * If a GRAFT comes before GossipsubGraftFloodThreshold has elapsed since the last PRUNE,\n * then there is an extra score penalty applied to the peer through P7.\n */\nexport const GossipsubGraftFloodThreshold = 10 * second;\n/**\n * GossipsubMaxIHaveLength is the maximum number of messages to include in an IHAVE message.\n * Also controls the maximum number of IHAVE ids we will accept and request with IWANT from a\n * peer within a heartbeat, to protect from IHAVE floods. You should adjust this value from the\n * default if your system is pushing more than 5000 messages in GossipsubHistoryGossip heartbeats;\n * with the defaults this is 1666 messages/s.\n */\nexport const GossipsubMaxIHaveLength = 5000;\n/**\n * GossipsubMaxIHaveMessages is the maximum number of IHAVE messages to accept from a peer within a heartbeat.\n */\nexport const GossipsubMaxIHaveMessages = 10;\n/**\n * Time to wait for a message requested through IWANT following an IHAVE advertisement.\n * If the message is not received within this window, a broken promise is declared and\n * the router may apply bahavioural penalties.\n */\nexport const GossipsubIWantFollowupTime = 3 * second;\n/**\n * Time in milliseconds to keep message ids in the seen cache\n */\nexport const GossipsubSeenTTL = 2 * minute;\nexport const TimeCacheDuration = 120 * 1000;\nexport const ERR_TOPIC_VALIDATOR_REJECT = 'ERR_TOPIC_VALIDATOR_REJECT';\nexport const ERR_TOPIC_VALIDATOR_IGNORE = 'ERR_TOPIC_VALIDATOR_IGNORE';\n/**\n * If peer score is better than this, we accept messages from this peer\n * within ACCEPT_FROM_WHITELIST_DURATION_MS from the last time computing score.\n **/\nexport const ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE = 0;\n/**\n * If peer score >= ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE, accept up to this\n * number of messages from that peer.\n */\nexport const ACCEPT_FROM_WHITELIST_MAX_MESSAGES = 128;\n/**\n * If peer score >= ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE, accept messages from\n * this peer up to this time duration.\n */\nexport const ACCEPT_FROM_WHITELIST_DURATION_MS = 1000;\n/**\n * The default MeshMessageDeliveriesWindow to be used in metrics.\n */\nexport const DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS = 1000;\n/** Wait for 1 more heartbeats before clearing a backoff */\nexport const BACKOFF_SLACK = 1;\n//# sourceMappingURL=constants.js.map","/**\n * Pseudo-randomly shuffles an array\n *\n * Mutates the input array\n */\nexport function shuffle(arr) {\n    if (arr.length <= 1) {\n        return arr;\n    }\n    const randInt = () => {\n        return Math.floor(Math.random() * Math.floor(arr.length));\n    };\n    for (let i = 0; i < arr.length; i++) {\n        const j = randInt();\n        const tmp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = tmp;\n    }\n    return arr;\n}\n//# sourceMappingURL=shuffle.js.map","/**\n * To guarantee Uint8Array semantics, convert nodejs Buffers\n * into vanilla Uint8Arrays\n */\nexport function asUint8Array(buf) {\n    if (globalThis.Buffer != null) {\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    return buf;\n}\n//# sourceMappingURL=as-uint8array.js.map","import { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc(size = 0) {\n    if (globalThis.Buffer?.alloc != null) {\n        return asUint8Array(globalThis.Buffer.alloc(size));\n    }\n    return new Uint8Array(size);\n}\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe(size = 0) {\n    if (globalThis.Buffer?.allocUnsafe != null) {\n        return asUint8Array(globalThis.Buffer.allocUnsafe(size));\n    }\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc.js.map","import { bases } from 'multiformats/basics';\nimport { allocUnsafe } from '../alloc.js';\nfunction createCodec(name, prefix, encode, decode) {\n    return {\n        name,\n        prefix,\n        encoder: {\n            name,\n            prefix,\n            encode\n        },\n        decoder: {\n            decode\n        }\n    };\n}\nconst string = createCodec('utf8', 'u', (buf) => {\n    const decoder = new TextDecoder('utf8');\n    return 'u' + decoder.decode(buf);\n}, (str) => {\n    const encoder = new TextEncoder();\n    return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', (buf) => {\n    let string = 'a';\n    for (let i = 0; i < buf.length; i++) {\n        string += String.fromCharCode(buf[i]);\n    }\n    return string;\n}, (str) => {\n    str = str.substring(1);\n    const buf = allocUnsafe(str.length);\n    for (let i = 0; i < str.length; i++) {\n        buf[i] = str.charCodeAt(i);\n    }\n    return buf;\n});\nconst BASES = {\n    utf8: string,\n    'utf-8': string,\n    hex: bases.base16,\n    latin1: ascii,\n    ascii,\n    binary: ascii,\n    ...bases\n};\nexport default BASES;\n//# sourceMappingURL=bases.js.map","import bases, {} from './util/bases.js';\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString(array, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return globalThis.Buffer.from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');\n    }\n    // strip multibase prefix\n    return base.encoder.encode(array).substring(1);\n}\n//# sourceMappingURL=to-string.js.map","import { toString } from 'uint8arrays/to-string';\n/**\n * Browser friendly function to convert Uint8Array message id to base64 string.\n */\nexport function messageIdToString(msgId) {\n    return toString(msgId, 'base64');\n}\n//# sourceMappingURL=messageIdToString.js.map","import { asUint8Array } from './util/as-uint8array.js';\nimport bases, {} from './util/bases.js';\n/**\n * Create a `Uint8Array` from the passed string\n *\n * Supports `utf8`, `utf-8`, `hex`, and any encoding supported by the multiformats module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function fromString(string, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return asUint8Array(globalThis.Buffer.from(string, 'utf-8'));\n    }\n    // add multibase prefix\n    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions\n}\n//# sourceMappingURL=from-string.js.map","import { ed25519 as ed } from '@noble/curves/ed25519';\nconst PUBLIC_KEY_BYTE_LENGTH = 32;\nconst PRIVATE_KEY_BYTE_LENGTH = 64; // private key is actually 32 bytes but for historical reasons we concat private and public keys\nconst KEYS_BYTE_LENGTH = 32;\nexport { PUBLIC_KEY_BYTE_LENGTH as publicKeyLength };\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport async function generateKey() {\n    // the actual private key (32 bytes)\n    const privateKeyRaw = ed.utils.randomPrivateKey();\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    // concatenated the public key to the private key\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\n/**\n * Generate keypair from a 32 byte uint8array\n */\nexport async function generateKeyFromSeed(seed) {\n    if (seed.length !== KEYS_BYTE_LENGTH) {\n        throw new TypeError('\"seed\" must be 32 bytes in length.');\n    }\n    else if (!(seed instanceof Uint8Array)) {\n        throw new TypeError('\"seed\" must be a node.js Buffer, or Uint8Array.');\n    }\n    // based on node forges algorithm, the seed is used directly as private key\n    const privateKeyRaw = seed;\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\nexport async function hashAndSign(privateKey, msg) {\n    const privateKeyRaw = privateKey.subarray(0, KEYS_BYTE_LENGTH);\n    return ed.sign(msg, privateKeyRaw);\n}\nexport async function hashAndVerify(publicKey, sig, msg) {\n    return ed.verify(sig, msg, publicKey);\n}\nfunction concatKeys(privateKeyRaw, publicKey) {\n    const privateKey = new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);\n    for (let i = 0; i < KEYS_BYTE_LENGTH; i++) {\n        privateKey[i] = privateKeyRaw[i];\n        privateKey[KEYS_BYTE_LENGTH + i] = publicKey[i];\n    }\n    return privateKey;\n}\n//# sourceMappingURL=ed25519-browser.js.map","import { allocUnsafe } from './alloc.js';\nimport { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a new Uint8Array created by concatenating the passed ArrayLikes\n */\nexport function concat(arrays, length) {\n    if (length == null) {\n        length = arrays.reduce((acc, curr) => acc + curr.length, 0);\n    }\n    const output = allocUnsafe(length);\n    let offset = 0;\n    for (const arr of arrays) {\n        output.set(arr, offset);\n        offset += arr.length;\n    }\n    return asUint8Array(output);\n}\n//# sourceMappingURL=concat.js.map","/* eslint-env browser */\n// Check native crypto exists and is enabled (In insecure context `self.crypto`\n// exists but `self.crypto.subtle` does not).\nexport default {\n    get(win = globalThis) {\n        const nativeCrypto = win.crypto;\n        if (nativeCrypto == null || nativeCrypto.subtle == null) {\n            throw Object.assign(new Error('Missing Web Crypto API. ' +\n                'The most likely cause of this error is that this page is being accessed ' +\n                'from an insecure context (i.e. not HTTPS). For more information and ' +\n                'possible resolutions see ' +\n                'https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api'), { code: 'ERR_MISSING_WEB_CRYPTO' });\n        }\n        return nativeCrypto;\n    }\n};\n//# sourceMappingURL=webcrypto.js.map","import { concat } from 'uint8arrays/concat';\nimport { fromString } from 'uint8arrays/from-string';\nimport webcrypto from '../webcrypto.js';\n// WebKit on Linux does not support deriving a key from an empty PBKDF2 key.\n// So, as a workaround, we provide the generated key as a constant. We test that\n// this generated key is accurate in test/workaround.spec.ts\n// Generated via:\n// await crypto.subtle.exportKey('jwk',\n//   await crypto.subtle.deriveKey(\n//     { name: 'PBKDF2', salt: new Uint8Array(16), iterations: 32767, hash: { name: 'SHA-256' } },\n//     await crypto.subtle.importKey('raw', new Uint8Array(0), { name: 'PBKDF2' }, false, ['deriveKey']),\n//     { name: 'AES-GCM', length: 128 }, true, ['encrypt', 'decrypt'])\n// )\nexport const derivedEmptyPasswordKey = { alg: 'A128GCM', ext: true, k: 'scm9jmO_4BJAgdwWGVulLg', key_ops: ['encrypt', 'decrypt'], kty: 'oct' };\n// Based off of code from https://github.com/luke-park/SecureCompatibleEncryptionExamples\nexport function create(opts) {\n    const algorithm = opts?.algorithm ?? 'AES-GCM';\n    let keyLength = opts?.keyLength ?? 16;\n    const nonceLength = opts?.nonceLength ?? 12;\n    const digest = opts?.digest ?? 'SHA-256';\n    const saltLength = opts?.saltLength ?? 16;\n    const iterations = opts?.iterations ?? 32767;\n    const crypto = webcrypto.get();\n    keyLength *= 8; // Browser crypto uses bits instead of bytes\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to encrypt the data.\n     */\n    async function encrypt(data, password) {\n        const salt = crypto.getRandomValues(new Uint8Array(saltLength));\n        const nonce = crypto.getRandomValues(new Uint8Array(nonceLength));\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['encrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            }\n        }\n        else {\n            // Derive a key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['encrypt']);\n        }\n        // Encrypt the string.\n        const ciphertext = await crypto.subtle.encrypt(aesGcm, cryptoKey, data);\n        return concat([salt, aesGcm.iv, new Uint8Array(ciphertext)]);\n    }\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to decrypt the data. The options used to create\n     * this decryption cipher must be the same as those used to create\n     * the encryption cipher.\n     */\n    async function decrypt(data, password) {\n        const salt = data.subarray(0, saltLength);\n        const nonce = data.subarray(saltLength, saltLength + nonceLength);\n        const ciphertext = data.subarray(saltLength + nonceLength);\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['decrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['decrypt']);\n            }\n        }\n        else {\n            // Derive the key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['decrypt']);\n        }\n        // Decrypt the string.\n        const plaintext = await crypto.subtle.decrypt(aesGcm, cryptoKey, ciphertext);\n        return new Uint8Array(plaintext);\n    }\n    const cipher = {\n        encrypt,\n        decrypt\n    };\n    return cipher;\n}\n//# sourceMappingURL=aes-gcm.browser.js.map","import { base64 } from 'multiformats/bases/base64';\nimport * as ciphers from '../ciphers/aes-gcm.js';\n/**\n * Exports the given PrivateKey as a base64 encoded string.\n * The PrivateKey is encrypted via a password derived PBKDF2 key\n * leveraging the aes-gcm cipher algorithm.\n */\nexport async function exporter(privateKey, password) {\n    const cipher = ciphers.create();\n    const encryptedKey = await cipher.encrypt(privateKey, password);\n    return base64.encode(encryptedKey);\n}\n//# sourceMappingURL=exporter.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { enumeration, encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var KeyType;\n(function (KeyType) {\n    KeyType[\"RSA\"] = \"RSA\";\n    KeyType[\"Ed25519\"] = \"Ed25519\";\n    KeyType[\"Secp256k1\"] = \"Secp256k1\";\n})(KeyType || (KeyType = {}));\nvar __KeyTypeValues;\n(function (__KeyTypeValues) {\n    __KeyTypeValues[__KeyTypeValues[\"RSA\"] = 0] = \"RSA\";\n    __KeyTypeValues[__KeyTypeValues[\"Ed25519\"] = 1] = \"Ed25519\";\n    __KeyTypeValues[__KeyTypeValues[\"Secp256k1\"] = 2] = \"Secp256k1\";\n})(__KeyTypeValues || (__KeyTypeValues = {}));\n(function (KeyType) {\n    KeyType.codec = () => {\n        return enumeration(__KeyTypeValues);\n    };\n})(KeyType || (KeyType = {}));\nexport var PublicKey;\n(function (PublicKey) {\n    let _codec;\n    PublicKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PublicKey.encode = (obj) => {\n        return encodeMessage(obj, PublicKey.codec());\n    };\n    PublicKey.decode = (buf) => {\n        return decodeMessage(buf, PublicKey.codec());\n    };\n})(PublicKey || (PublicKey = {}));\nexport var PrivateKey;\n(function (PrivateKey) {\n    let _codec;\n    PrivateKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PrivateKey.encode = (obj) => {\n        return encodeMessage(obj, PrivateKey.codec());\n    };\n    PrivateKey.decode = (buf) => {\n        return decodeMessage(buf, PrivateKey.codec());\n    };\n})(PrivateKey || (PrivateKey = {}));\n//# sourceMappingURL=keys.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport * as crypto from './ed25519.js';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nexport class Ed25519PublicKey {\n    _key;\n    constructor(key) {\n        this._key = ensureKey(key, crypto.publicKeyLength);\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Ed25519PrivateKey {\n    _key;\n    _publicKey;\n    // key       - 64 byte Uint8Array containing private key\n    // publicKey - 32 byte Uint8Array containing public key\n    constructor(key, publicKey) {\n        this._key = ensureKey(key, crypto.privateKeyLength);\n        this._publicKey = ensureKey(publicKey, crypto.publicKeyLength);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Ed25519PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the identity multihash containing its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     *\n     * @returns {Promise<string>}\n     */\n    async id() {\n        const encoding = identity.digest(this.public.bytes);\n        return base58btc.encode(encoding.bytes).substring(1);\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalEd25519PrivateKey(bytes) {\n    // Try the old, redundant public key version\n    if (bytes.length > crypto.privateKeyLength) {\n        bytes = ensureKey(bytes, crypto.privateKeyLength + crypto.publicKeyLength);\n        const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n        const publicKeyBytes = bytes.subarray(crypto.privateKeyLength, bytes.length);\n        return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n    }\n    bytes = ensureKey(bytes, crypto.privateKeyLength);\n    const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n    const publicKeyBytes = bytes.subarray(crypto.publicKeyLength);\n    return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n}\nexport function unmarshalEd25519PublicKey(bytes) {\n    bytes = ensureKey(bytes, crypto.publicKeyLength);\n    return new Ed25519PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const { privateKey, publicKey } = await crypto.generateKey();\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nexport async function generateKeyPairFromSeed(seed) {\n    const { privateKey, publicKey } = await crypto.generateKeyFromSeed(seed);\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nfunction ensureKey(key, length) {\n    key = Uint8Array.from(key ?? []);\n    if (key.length !== length) {\n        throw new CodeError(`Key must be a Uint8Array of length ${length}, got ${key.length}`, 'ERR_INVALID_KEY_TYPE');\n    }\n    return key;\n}\n//# sourceMappingURL=ed25519-class.js.map","import 'node-forge/lib/util.js';\nimport 'node-forge/lib/jsbn.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nexport function bigIntegerToUintBase64url(num, len) {\n    // Call `.abs()` to convert to unsigned\n    let buf = Uint8Array.from(num.abs().toByteArray()); // toByteArray converts to big endian\n    // toByteArray() gives us back a signed array, which will include a leading 0\n    // byte if the most significant bit of the number is 1:\n    // https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-integer\n    // Our number will always be positive so we should remove the leading padding.\n    buf = buf[0] === 0 ? buf.subarray(1) : buf;\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return uint8ArrayToString(buf, 'base64url');\n}\n// Convert a base64url encoded string to a BigInteger\nexport function base64urlToBigInteger(str) {\n    const buf = base64urlToBuffer(str);\n    return new forge.jsbn.BigInteger(uint8ArrayToString(buf, 'base16'), 16);\n}\nexport function base64urlToBuffer(str, len) {\n    let buf = uint8ArrayFromString(str, 'base64urlpad');\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return buf;\n}\n//# sourceMappingURL=util.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { base64urlToBuffer } from '../util.js';\nimport webcrypto from '../webcrypto.js';\nconst bits = {\n    'P-256': 256,\n    'P-384': 384,\n    'P-521': 521\n};\nconst curveTypes = Object.keys(bits);\nconst names = curveTypes.join(' / ');\nexport async function generateEphmeralKeyPair(curve) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'ECDH',\n        namedCurve: curve\n    }, true, ['deriveBits']);\n    // forcePrivate is used for testing only\n    const genSharedKey = async (theirPub, forcePrivate) => {\n        let privateKey;\n        if (forcePrivate != null) {\n            privateKey = await webcrypto.get().subtle.importKey('jwk', unmarshalPrivateKey(curve, forcePrivate), {\n                name: 'ECDH',\n                namedCurve: curve\n            }, false, ['deriveBits']);\n        }\n        else {\n            privateKey = pair.privateKey;\n        }\n        const key = await webcrypto.get().subtle.importKey('jwk', unmarshalPublicKey(curve, theirPub), {\n            name: 'ECDH',\n            namedCurve: curve\n        }, false, []);\n        const buffer = await webcrypto.get().subtle.deriveBits({\n            name: 'ECDH',\n            // @ts-expect-error namedCurve is missing from the types\n            namedCurve: curve,\n            public: key\n        }, privateKey, bits[curve]);\n        return new Uint8Array(buffer, 0, buffer.byteLength);\n    };\n    const publicKey = await webcrypto.get().subtle.exportKey('jwk', pair.publicKey);\n    const ecdhKey = {\n        key: marshalPublicKey(publicKey),\n        genSharedKey\n    };\n    return ecdhKey;\n}\nconst curveLengths = {\n    'P-256': 32,\n    'P-384': 48,\n    'P-521': 66\n};\n// Marshal converts a jwk encoded ECDH public key into the\n// form specified in section 4.3.6 of ANSI X9.62. (This is the format\n// go-ipfs uses)\nfunction marshalPublicKey(jwk) {\n    if (jwk.crv == null || jwk.x == null || jwk.y == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    if (jwk.crv !== 'P-256' && jwk.crv !== 'P-384' && jwk.crv !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${jwk.crv}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[jwk.crv];\n    return uint8ArrayConcat([\n        Uint8Array.from([4]),\n        base64urlToBuffer(jwk.x, byteLen),\n        base64urlToBuffer(jwk.y, byteLen)\n    ], 1 + byteLen * 2);\n}\n// Unmarshal converts a point, serialized by Marshal, into an jwk encoded key\nfunction unmarshalPublicKey(curve, key) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[curve];\n    if (!uint8ArrayEquals(key.subarray(0, 1), Uint8Array.from([4]))) {\n        throw new CodeError('Cannot unmarshal public key - invalid key format', 'ERR_INVALID_KEY_FORMAT');\n    }\n    return {\n        kty: 'EC',\n        crv: curve,\n        x: uint8ArrayToString(key.subarray(1, byteLen + 1), 'base64url'),\n        y: uint8ArrayToString(key.subarray(1 + byteLen), 'base64url'),\n        ext: true\n    };\n}\nconst unmarshalPrivateKey = (curve, key) => ({\n    ...unmarshalPublicKey(curve, key.public),\n    d: uint8ArrayToString(key.private, 'base64url')\n});\n//# sourceMappingURL=ecdh-browser.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { randomBytes as randB } from '@noble/hashes/utils';\nexport default function randomBytes(length) {\n    if (isNaN(length) || length <= 0) {\n        throw new CodeError('random bytes length must be a Number bigger than 0', 'ERR_INVALID_LENGTH');\n    }\n    return randB(length);\n}\n//# sourceMappingURL=random-bytes.js.map","import 'node-forge/lib/rsa.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { base64urlToBigInteger } from '../util.js';\nfunction convert(key, types) {\n    return types.map(t => base64urlToBigInteger(key[t]));\n}\nexport function jwk2priv(key) {\n    return forge.pki.setRsaPrivateKey(...convert(key, ['n', 'e', 'd', 'p', 'q', 'dp', 'dq', 'qi']));\n}\nexport function jwk2pub(key) {\n    return forge.pki.setRsaPublicKey(...convert(key, ['n', 'e']));\n}\n//# sourceMappingURL=jwk2pem.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport randomBytes from '../random-bytes.js';\nimport webcrypto from '../webcrypto.js';\nimport { jwk2pub, jwk2priv } from './jwk2pem.js';\nimport * as utils from './rsa-utils.js';\nexport { utils };\nexport async function generateKey(bits) {\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'RSASSA-PKCS1-v1_5',\n        modulusLength: bits,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        hash: { name: 'SHA-256' }\n    }, true, ['sign', 'verify']);\n    const keys = await exportKey(pair);\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\n// Takes a jwk key\nexport async function unmarshalPrivateKey(key) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['sign']);\n    const pair = [\n        privateKey,\n        await derivePublicFromPrivate(key)\n    ];\n    const keys = await exportKey({\n        privateKey: pair[0],\n        publicKey: pair[1]\n    });\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\nexport { randomBytes as getRandomValues };\nexport async function hashAndSign(key, msg) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['sign']);\n    const sig = await webcrypto.get().subtle.sign({ name: 'RSASSA-PKCS1-v1_5' }, privateKey, Uint8Array.from(msg));\n    return new Uint8Array(sig, 0, sig.byteLength);\n}\nexport async function hashAndVerify(key, sig, msg) {\n    const publicKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['verify']);\n    return webcrypto.get().subtle.verify({ name: 'RSASSA-PKCS1-v1_5' }, publicKey, sig, msg);\n}\nasync function exportKey(pair) {\n    if (pair.privateKey == null || pair.publicKey == null) {\n        throw new CodeError('Private and public key are required', 'ERR_INVALID_PARAMETERS');\n    }\n    return Promise.all([\n        webcrypto.get().subtle.exportKey('jwk', pair.privateKey),\n        webcrypto.get().subtle.exportKey('jwk', pair.publicKey)\n    ]);\n}\nasync function derivePublicFromPrivate(jwKey) {\n    return webcrypto.get().subtle.importKey('jwk', {\n        kty: jwKey.kty,\n        n: jwKey.n,\n        e: jwKey.e\n    }, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['verify']);\n}\n/*\n\nRSA encryption/decryption for the browser with webcrypto workaround\n\"bloody dark magic. webcrypto's why.\"\n\nExplanation:\n  - Convert JWK to nodeForge\n  - Convert msg Uint8Array to nodeForge buffer: ByteBuffer is a \"binary-string backed buffer\", so let's make our Uint8Array a binary string\n  - Convert resulting nodeForge buffer to Uint8Array: it returns a binary string, turn that into a Uint8Array\n\n*/\nfunction convertKey(key, pub, msg, handle) {\n    const fkey = pub ? jwk2pub(key) : jwk2priv(key);\n    const fmsg = uint8ArrayToString(Uint8Array.from(msg), 'ascii');\n    const fomsg = handle(fmsg, fkey);\n    return uint8ArrayFromString(fomsg, 'ascii');\n}\nexport function encrypt(key, msg) {\n    return convertKey(key, true, msg, (msg, key) => key.encrypt(msg));\n}\nexport function decrypt(key, msg) {\n    return convertKey(key, false, msg, (msg, key) => key.decrypt(msg));\n}\nexport function keySize(jwk) {\n    if (jwk.kty !== 'RSA') {\n        throw new CodeError('invalid key type', 'ERR_INVALID_KEY_TYPE');\n    }\n    else if (jwk.n == null) {\n        throw new CodeError('invalid key modulus', 'ERR_INVALID_KEY_MODULUS');\n    }\n    const bytes = uint8ArrayFromString(jwk.n, 'base64url');\n    return bytes.length * 8;\n}\n//# sourceMappingURL=rsa-browser.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport 'node-forge/lib/sha512.js';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nimport * as crypto from './rsa.js';\nexport const MAX_KEY_SIZE = 8192;\nexport class RsaPublicKey {\n    _key;\n    constructor(key) {\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkix(this._key);\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    encrypt(bytes) {\n        return crypto.encrypt(this._key, bytes);\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class RsaPrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey;\n    }\n    genSecret() {\n        return crypto.getRandomValues(16);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        if (this._publicKey == null) {\n            throw new CodeError('public key not provided', 'ERR_PUBKEY_NOT_PROVIDED');\n        }\n        return new RsaPublicKey(this._publicKey);\n    }\n    decrypt(bytes) {\n        return crypto.decrypt(this._key, bytes);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkcs1(this._key);\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected PEM format\n     */\n    async export(password, format = 'pkcs-8') {\n        if (format === 'pkcs-8') {\n            const buffer = new forge.util.ByteBuffer(this.marshal());\n            const asn1 = forge.asn1.fromDer(buffer);\n            const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n            const options = {\n                algorithm: 'aes256',\n                count: 10000,\n                saltSize: 128 / 8,\n                prfAlgorithm: 'sha512'\n            };\n            return forge.pki.encryptRsaPrivateKey(privateKey, password, options);\n        }\n        else if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport async function unmarshalRsaPrivateKey(bytes) {\n    const jwk = crypto.utils.pkcs1ToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport function unmarshalRsaPublicKey(bytes) {\n    const jwk = crypto.utils.pkixToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    return new RsaPublicKey(jwk);\n}\nexport async function fromJwk(jwk) {\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport async function generateKeyPair(bits) {\n    if (bits > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.generateKey(bits);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\n//# sourceMappingURL=rsa-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/rsa.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { bigIntegerToUintBase64url, base64urlToBigInteger } from './../util.js';\n// Convert a PKCS#1 in ASN1 DER format to a JWK key\nexport function pkcs1ToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n    // https://tools.ietf.org/html/rfc7518#section-6.3.1\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(privateKey.n),\n        e: bigIntegerToUintBase64url(privateKey.e),\n        d: bigIntegerToUintBase64url(privateKey.d),\n        p: bigIntegerToUintBase64url(privateKey.p),\n        q: bigIntegerToUintBase64url(privateKey.q),\n        dp: bigIntegerToUintBase64url(privateKey.dP),\n        dq: bigIntegerToUintBase64url(privateKey.dQ),\n        qi: bigIntegerToUintBase64url(privateKey.qInv),\n        alg: 'RS256'\n    };\n}\n// Convert a JWK key into PKCS#1 in ASN1 DER format\nexport function jwkToPkcs1(jwk) {\n    if (jwk.n == null || jwk.e == null || jwk.d == null || jwk.p == null || jwk.q == null || jwk.dp == null || jwk.dq == null || jwk.qi == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.privateKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e),\n        d: base64urlToBigInteger(jwk.d),\n        p: base64urlToBigInteger(jwk.p),\n        q: base64urlToBigInteger(jwk.q),\n        dP: base64urlToBigInteger(jwk.dp),\n        dQ: base64urlToBigInteger(jwk.dq),\n        qInv: base64urlToBigInteger(jwk.qi)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n// Convert a PKCIX in ASN1 DER format to a JWK key\nexport function pkixToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const publicKey = forge.pki.publicKeyFromAsn1(asn1);\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(publicKey.n),\n        e: bigIntegerToUintBase64url(publicKey.e)\n    };\n}\n// Convert a JWK key to PKCIX in ASN1 DER format\nexport function jwkToPkix(jwk) {\n    if (jwk.n == null || jwk.e == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.publicKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n//# sourceMappingURL=rsa-utils.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { secp256k1 as secp } from '@noble/curves/secp256k1';\nimport { sha256 } from 'multiformats/hashes/sha2';\nconst PRIVATE_KEY_BYTE_LENGTH = 32;\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport function generateKey() {\n    return secp.utils.randomPrivateKey();\n}\n/**\n * Hash and sign message with private key\n */\nexport async function hashAndSign(key, msg) {\n    const { digest } = await sha256.digest(msg);\n    try {\n        const signature = secp.sign(digest, key);\n        return signature.toDERRawBytes();\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\n/**\n * Hash message and verify signature with public key\n */\nexport async function hashAndVerify(key, sig, msg) {\n    try {\n        const { digest } = await sha256.digest(msg);\n        return secp.verify(sig, digest, key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\nexport function compressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(true);\n    return point;\n}\nexport function decompressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(false);\n    return point;\n}\nexport function validatePrivateKey(key) {\n    try {\n        secp.getPublicKey(key, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\nexport function validatePublicKey(key) {\n    try {\n        secp.ProjectivePoint.fromHex(key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PUBLIC_KEY');\n    }\n}\nexport function computePublicKey(privateKey) {\n    try {\n        return secp.getPublicKey(privateKey, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\n//# sourceMappingURL=secp256k1.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as keysProtobuf from './keys.js';\nimport * as crypto from './secp256k1.js';\nexport class Secp256k1PublicKey {\n    _key;\n    constructor(key) {\n        crypto.validatePublicKey(key);\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.compressPublicKey(this._key);\n    }\n    get bytes() {\n        return keysProtobuf.PublicKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Secp256k1PrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey ?? crypto.computePublicKey(key);\n        crypto.validatePrivateKey(this._key);\n        crypto.validatePublicKey(this._publicKey);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Secp256k1PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return keysProtobuf.PrivateKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalSecp256k1PrivateKey(bytes) {\n    return new Secp256k1PrivateKey(bytes);\n}\nexport function unmarshalSecp256k1PublicKey(bytes) {\n    return new Secp256k1PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const privateKeyBytes = crypto.generateKey();\n    return new Secp256k1PrivateKey(privateKeyBytes);\n}\n//# sourceMappingURL=secp256k1-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/pbe.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport * as Ed25519 from './ed25519-class.js';\nimport generateEphemeralKeyPair from './ephemeral-keys.js';\nimport { importer } from './importer.js';\nimport { keyStretcher } from './key-stretcher.js';\nimport * as keysPBM from './keys.js';\nimport * as RSA from './rsa-class.js';\nimport * as Secp256k1 from './secp256k1-class.js';\nexport { keyStretcher };\nexport { generateEphemeralKeyPair };\nexport { keysPBM };\nexport const supportedKeys = {\n    rsa: RSA,\n    ed25519: Ed25519,\n    secp256k1: Secp256k1\n};\nfunction unsupportedKey(type) {\n    const supported = Object.keys(supportedKeys).join(' / ');\n    return new CodeError(`invalid or unsupported key type ${type}. Must be ${supported}`, 'ERR_UNSUPPORTED_KEY_TYPE');\n}\nfunction typeToKey(type) {\n    type = type.toLowerCase();\n    if (type === 'rsa' || type === 'ed25519' || type === 'secp256k1') {\n        return supportedKeys[type];\n    }\n    throw unsupportedKey(type);\n}\n// Generates a keypair of the given type and bitsize\nexport async function generateKeyPair(type, bits) {\n    return typeToKey(type).generateKeyPair(bits ?? 2048);\n}\n// Generates a keypair of the given type and bitsize\n// seed is a 32 byte uint8array\nexport async function generateKeyPairFromSeed(type, seed, bits) {\n    if (type.toLowerCase() !== 'ed25519') {\n        throw new CodeError('Seed key derivation is unimplemented for RSA or secp256k1', 'ERR_UNSUPPORTED_KEY_DERIVATION_TYPE');\n    }\n    return Ed25519.generateKeyPairFromSeed(seed);\n}\n// Converts a protobuf serialized public key into its\n// representative object\nexport function unmarshalPublicKey(buf) {\n    const decoded = keysPBM.PublicKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPublicKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PublicKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'unknown');\n    }\n}\n// Converts a public key object into a protobuf serialized public key\nexport function marshalPublicKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n// Converts a protobuf serialized private key into its\n// representative object\nexport async function unmarshalPrivateKey(buf) {\n    const decoded = keysPBM.PrivateKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPrivateKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PrivateKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'RSA');\n    }\n}\n// Converts a private key object into a protobuf serialized private key\nexport function marshalPrivateKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n/**\n *\n * @param {string} encryptedKey\n * @param {string} password\n */\nexport async function importKey(encryptedKey, password) {\n    try {\n        const key = await importer(encryptedKey, password);\n        return await unmarshalPrivateKey(key);\n    }\n    catch (_) {\n        // Ignore and try the old pem decrypt\n    }\n    // Only rsa supports pem right now\n    const key = forge.pki.decryptRsaPrivateKey(encryptedKey, password);\n    if (key === null) {\n        throw new CodeError('Cannot read the key, most likely the password is wrong or not a RSA key', 'ERR_CANNOT_DECRYPT_PEM');\n    }\n    let der = forge.asn1.toDer(forge.pki.privateKeyToAsn1(key));\n    der = uint8ArrayFromString(der.getBytes(), 'ascii');\n    return supportedKeys.rsa.unmarshalRsaPrivateKey(der);\n}\n//# sourceMappingURL=index.js.map","import { TopicValidatorResult } from '@libp2p/interface/pubsub';\nexport var SignaturePolicy;\n(function (SignaturePolicy) {\n    /**\n     * On the producing side:\n     * - Build messages with the signature, key (from may be enough for certain inlineable public key types), from and seqno fields.\n     *\n     * On the consuming side:\n     * - Enforce the fields to be present, reject otherwise.\n     * - Propagate only if the fields are valid and signature can be verified, reject otherwise.\n     */\n    SignaturePolicy[\"StrictSign\"] = \"StrictSign\";\n    /**\n     * On the producing side:\n     * - Build messages without the signature, key, from and seqno fields.\n     * - The corresponding protobuf key-value pairs are absent from the marshalled message, not just empty.\n     *\n     * On the consuming side:\n     * - Enforce the fields to be absent, reject otherwise.\n     * - Propagate only if the fields are absent, reject otherwise.\n     * - A message_id function will not be able to use the above fields, and should instead rely on the data field. A commonplace strategy is to calculate a hash.\n     */\n    SignaturePolicy[\"StrictNoSign\"] = \"StrictNoSign\";\n})(SignaturePolicy || (SignaturePolicy = {}));\nexport var PublishConfigType;\n(function (PublishConfigType) {\n    PublishConfigType[PublishConfigType[\"Signing\"] = 0] = \"Signing\";\n    PublishConfigType[PublishConfigType[\"Anonymous\"] = 1] = \"Anonymous\";\n})(PublishConfigType || (PublishConfigType = {}));\nexport var RejectReason;\n(function (RejectReason) {\n    /**\n     * The message failed the configured validation during decoding.\n     * SelfOrigin is considered a ValidationError\n     */\n    RejectReason[\"Error\"] = \"error\";\n    /**\n     * Custom validator fn reported status IGNORE.\n     */\n    RejectReason[\"Ignore\"] = \"ignore\";\n    /**\n     * Custom validator fn reported status REJECT.\n     */\n    RejectReason[\"Reject\"] = \"reject\";\n    /**\n     * The peer that sent the message OR the source from field is blacklisted.\n     * Causes messages to be ignored, not penalized, neither do score record creation.\n     */\n    RejectReason[\"Blacklisted\"] = \"blacklisted\";\n})(RejectReason || (RejectReason = {}));\nexport var ValidateError;\n(function (ValidateError) {\n    /// The message has an invalid signature,\n    ValidateError[\"InvalidSignature\"] = \"invalid_signature\";\n    /// The sequence number was the incorrect size\n    ValidateError[\"InvalidSeqno\"] = \"invalid_seqno\";\n    /// The PeerId was invalid\n    ValidateError[\"InvalidPeerId\"] = \"invalid_peerid\";\n    /// Signature existed when validation has been sent to\n    /// [`crate::behaviour::MessageAuthenticity::Anonymous`].\n    ValidateError[\"SignaturePresent\"] = \"signature_present\";\n    /// Sequence number existed when validation has been sent to\n    /// [`crate::behaviour::MessageAuthenticity::Anonymous`].\n    ValidateError[\"SeqnoPresent\"] = \"seqno_present\";\n    /// Message source existed when validation has been sent to\n    /// [`crate::behaviour::MessageAuthenticity::Anonymous`].\n    ValidateError[\"FromPresent\"] = \"from_present\";\n    /// The data transformation failed.\n    ValidateError[\"TransformFailed\"] = \"transform_failed\";\n})(ValidateError || (ValidateError = {}));\nexport var MessageStatus;\n(function (MessageStatus) {\n    MessageStatus[\"duplicate\"] = \"duplicate\";\n    MessageStatus[\"invalid\"] = \"invalid\";\n    MessageStatus[\"valid\"] = \"valid\";\n})(MessageStatus || (MessageStatus = {}));\n/**\n * Typesafe conversion of MessageAcceptance -> RejectReason. TS ensures all values covered\n */\nexport function rejectReasonFromAcceptance(acceptance) {\n    switch (acceptance) {\n        case TopicValidatorResult.Ignore:\n            return RejectReason.Ignore;\n        case TopicValidatorResult.Reject:\n            return RejectReason.Reject;\n    }\n}\n//# sourceMappingURL=types.js.map","export const ERR_INVALID_PEER_SCORE_PARAMS = 'ERR_INVALID_PEER_SCORE_PARAMS';\nexport const ERR_INVALID_PEER_SCORE_THRESHOLDS = 'ERR_INVALID_PEER_SCORE_THRESHOLDS';\n//# sourceMappingURL=constants.js.map","import { ERR_INVALID_PEER_SCORE_PARAMS } from './constants.js';\nimport { CodeError } from '@libp2p/interface/errors';\nexport const defaultPeerScoreParams = {\n    topics: {},\n    topicScoreCap: 10.0,\n    appSpecificScore: () => 0.0,\n    appSpecificWeight: 10.0,\n    IPColocationFactorWeight: -5.0,\n    IPColocationFactorThreshold: 10.0,\n    IPColocationFactorWhitelist: new Set(),\n    behaviourPenaltyWeight: -10.0,\n    behaviourPenaltyThreshold: 0.0,\n    behaviourPenaltyDecay: 0.2,\n    decayInterval: 1000.0,\n    decayToZero: 0.1,\n    retainScore: 3600 * 1000\n};\nexport const defaultTopicScoreParams = {\n    topicWeight: 0.5,\n    timeInMeshWeight: 1,\n    timeInMeshQuantum: 1,\n    timeInMeshCap: 3600,\n    firstMessageDeliveriesWeight: 1,\n    firstMessageDeliveriesDecay: 0.5,\n    firstMessageDeliveriesCap: 2000,\n    meshMessageDeliveriesWeight: -1,\n    meshMessageDeliveriesDecay: 0.5,\n    meshMessageDeliveriesCap: 100,\n    meshMessageDeliveriesThreshold: 20,\n    meshMessageDeliveriesWindow: 10,\n    meshMessageDeliveriesActivation: 5000,\n    meshFailurePenaltyWeight: -1,\n    meshFailurePenaltyDecay: 0.5,\n    invalidMessageDeliveriesWeight: -1,\n    invalidMessageDeliveriesDecay: 0.3\n};\nexport function createPeerScoreParams(p = {}) {\n    return {\n        ...defaultPeerScoreParams,\n        ...p,\n        topics: p.topics\n            ? Object.entries(p.topics).reduce((topics, [topic, topicScoreParams]) => {\n                topics[topic] = createTopicScoreParams(topicScoreParams);\n                return topics;\n            }, {})\n            : {}\n    };\n}\nexport function createTopicScoreParams(p = {}) {\n    return {\n        ...defaultTopicScoreParams,\n        ...p\n    };\n}\n// peer score parameter validation\nexport function validatePeerScoreParams(p) {\n    for (const [topic, params] of Object.entries(p.topics)) {\n        try {\n            validateTopicScoreParams(params);\n        }\n        catch (e) {\n            throw new CodeError(`invalid score parameters for topic ${topic}: ${e.message}`, ERR_INVALID_PEER_SCORE_PARAMS);\n        }\n    }\n    // check that the topic score is 0 or something positive\n    if (p.topicScoreCap < 0) {\n        throw new CodeError('invalid topic score cap; must be positive (or 0 for no cap)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check that we have an app specific score; the weight can be anything (but expected positive)\n    if (p.appSpecificScore === null || p.appSpecificScore === undefined) {\n        throw new CodeError('missing application specific score function', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check the IP colocation factor\n    if (p.IPColocationFactorWeight > 0) {\n        throw new CodeError('invalid IPColocationFactorWeight; must be negative (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.IPColocationFactorWeight !== 0 && p.IPColocationFactorThreshold < 1) {\n        throw new CodeError('invalid IPColocationFactorThreshold; must be at least 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check the behaviour penalty\n    if (p.behaviourPenaltyWeight > 0) {\n        throw new CodeError('invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.behaviourPenaltyWeight !== 0 && (p.behaviourPenaltyDecay <= 0 || p.behaviourPenaltyDecay >= 1)) {\n        throw new CodeError('invalid BehaviourPenaltyDecay; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check the decay parameters\n    if (p.decayInterval < 1000) {\n        throw new CodeError('invalid DecayInterval; must be at least 1s', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.decayToZero <= 0 || p.decayToZero >= 1) {\n        throw new CodeError('invalid DecayToZero; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // no need to check the score retention; a value of 0 means that we don't retain scores\n}\nexport function validateTopicScoreParams(p) {\n    // make sure we have a sane topic weight\n    if (p.topicWeight < 0) {\n        throw new CodeError('invalid topic weight; must be >= 0', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check P1\n    if (p.timeInMeshQuantum === 0) {\n        throw new CodeError('invalid TimeInMeshQuantum; must be non zero', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.timeInMeshWeight < 0) {\n        throw new CodeError('invalid TimeInMeshWeight; must be positive (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.timeInMeshWeight !== 0 && p.timeInMeshQuantum <= 0) {\n        throw new CodeError('invalid TimeInMeshQuantum; must be positive', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.timeInMeshWeight !== 0 && p.timeInMeshCap <= 0) {\n        throw new CodeError('invalid TimeInMeshCap; must be positive', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check P2\n    if (p.firstMessageDeliveriesWeight < 0) {\n        throw new CodeError('invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.firstMessageDeliveriesWeight !== 0 &&\n        (p.firstMessageDeliveriesDecay <= 0 || p.firstMessageDeliveriesDecay >= 1)) {\n        throw new CodeError('invalid FirstMessageDeliveriesDecay; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.firstMessageDeliveriesWeight !== 0 && p.firstMessageDeliveriesCap <= 0) {\n        throw new CodeError('invalid FirstMessageDeliveriesCap; must be positive', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check P3\n    if (p.meshMessageDeliveriesWeight > 0) {\n        throw new CodeError('invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshMessageDeliveriesWeight !== 0 && (p.meshMessageDeliveriesDecay <= 0 || p.meshMessageDeliveriesDecay >= 1)) {\n        throw new CodeError('invalid MeshMessageDeliveriesDecay; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshMessageDeliveriesWeight !== 0 && p.meshMessageDeliveriesCap <= 0) {\n        throw new CodeError('invalid MeshMessageDeliveriesCap; must be positive', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshMessageDeliveriesWeight !== 0 && p.meshMessageDeliveriesThreshold <= 0) {\n        throw new CodeError('invalid MeshMessageDeliveriesThreshold; must be positive', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshMessageDeliveriesWindow < 0) {\n        throw new CodeError('invalid MeshMessageDeliveriesWindow; must be non-negative', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshMessageDeliveriesWeight !== 0 && p.meshMessageDeliveriesActivation < 1000) {\n        throw new CodeError('invalid MeshMessageDeliveriesActivation; must be at least 1s', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check P3b\n    if (p.meshFailurePenaltyWeight > 0) {\n        throw new CodeError('invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.meshFailurePenaltyWeight !== 0 && (p.meshFailurePenaltyDecay <= 0 || p.meshFailurePenaltyDecay >= 1)) {\n        throw new CodeError('invalid MeshFailurePenaltyDecay; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    // check P4\n    if (p.invalidMessageDeliveriesWeight > 0) {\n        throw new CodeError('invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n    if (p.invalidMessageDeliveriesDecay <= 0 || p.invalidMessageDeliveriesDecay >= 1) {\n        throw new CodeError('invalid InvalidMessageDeliveriesDecay; must be between 0 and 1', ERR_INVALID_PEER_SCORE_PARAMS);\n    }\n}\n//# sourceMappingURL=peer-score-params.js.map","import { ERR_INVALID_PEER_SCORE_THRESHOLDS } from './constants.js';\nimport { CodeError } from '@libp2p/interface/errors';\nexport const defaultPeerScoreThresholds = {\n    gossipThreshold: -10,\n    publishThreshold: -50,\n    graylistThreshold: -80,\n    acceptPXThreshold: 10,\n    opportunisticGraftThreshold: 20\n};\nexport function createPeerScoreThresholds(p = {}) {\n    return {\n        ...defaultPeerScoreThresholds,\n        ...p\n    };\n}\nexport function validatePeerScoreThresholds(p) {\n    if (p.gossipThreshold > 0) {\n        throw new CodeError('invalid gossip threshold; it must be <= 0', ERR_INVALID_PEER_SCORE_THRESHOLDS);\n    }\n    if (p.publishThreshold > 0 || p.publishThreshold > p.gossipThreshold) {\n        throw new CodeError('invalid publish threshold; it must be <= 0 and <= gossip threshold', ERR_INVALID_PEER_SCORE_THRESHOLDS);\n    }\n    if (p.graylistThreshold > 0 || p.graylistThreshold > p.publishThreshold) {\n        throw new CodeError('invalid graylist threshold; it must be <= 0 and <= publish threshold', ERR_INVALID_PEER_SCORE_THRESHOLDS);\n    }\n    if (p.acceptPXThreshold < 0) {\n        throw new CodeError('invalid accept PX threshold; it must be >= 0', ERR_INVALID_PEER_SCORE_THRESHOLDS);\n    }\n    if (p.opportunisticGraftThreshold < 0) {\n        throw new CodeError('invalid opportunistic grafting threshold; it must be >= 0', ERR_INVALID_PEER_SCORE_THRESHOLDS);\n    }\n}\n//# sourceMappingURL=peer-score-thresholds.js.map","export function computeScore(peer, pstats, params, peerIPs) {\n    let score = 0;\n    // topic stores\n    Object.entries(pstats.topics).forEach(([topic, tstats]) => {\n        // the topic parameters\n        const topicParams = params.topics[topic];\n        if (topicParams === undefined) {\n            // we are not scoring this topic\n            return;\n        }\n        let topicScore = 0;\n        // P1: time in Mesh\n        if (tstats.inMesh) {\n            let p1 = tstats.meshTime / topicParams.timeInMeshQuantum;\n            if (p1 > topicParams.timeInMeshCap) {\n                p1 = topicParams.timeInMeshCap;\n            }\n            topicScore += p1 * topicParams.timeInMeshWeight;\n        }\n        // P2: first message deliveries\n        let p2 = tstats.firstMessageDeliveries;\n        if (p2 > topicParams.firstMessageDeliveriesCap) {\n            p2 = topicParams.firstMessageDeliveriesCap;\n        }\n        topicScore += p2 * topicParams.firstMessageDeliveriesWeight;\n        // P3: mesh message deliveries\n        if (tstats.meshMessageDeliveriesActive &&\n            tstats.meshMessageDeliveries < topicParams.meshMessageDeliveriesThreshold) {\n            const deficit = topicParams.meshMessageDeliveriesThreshold - tstats.meshMessageDeliveries;\n            const p3 = deficit * deficit;\n            topicScore += p3 * topicParams.meshMessageDeliveriesWeight;\n        }\n        // P3b:\n        // NOTE: the weight of P3b is negative (validated in validateTopicScoreParams) so this detracts\n        const p3b = tstats.meshFailurePenalty;\n        topicScore += p3b * topicParams.meshFailurePenaltyWeight;\n        // P4: invalid messages\n        // NOTE: the weight of P4 is negative (validated in validateTopicScoreParams) so this detracts\n        const p4 = tstats.invalidMessageDeliveries * tstats.invalidMessageDeliveries;\n        topicScore += p4 * topicParams.invalidMessageDeliveriesWeight;\n        // update score, mixing with topic weight\n        score += topicScore * topicParams.topicWeight;\n    });\n    // apply the topic score cap, if any\n    if (params.topicScoreCap > 0 && score > params.topicScoreCap) {\n        score = params.topicScoreCap;\n    }\n    // P5: application-specific score\n    const p5 = params.appSpecificScore(peer);\n    score += p5 * params.appSpecificWeight;\n    // P6: IP colocation factor\n    pstats.knownIPs.forEach((ip) => {\n        if (params.IPColocationFactorWhitelist.has(ip)) {\n            return;\n        }\n        // P6 has a cliff (IPColocationFactorThreshold)\n        // It's only applied if at least that many peers are connected to us from that source IP addr.\n        // It is quadratic, and the weight is negative (validated in validatePeerScoreParams)\n        const peersInIP = peerIPs.get(ip);\n        const numPeersInIP = peersInIP ? peersInIP.size : 0;\n        if (numPeersInIP > params.IPColocationFactorThreshold) {\n            const surplus = numPeersInIP - params.IPColocationFactorThreshold;\n            const p6 = surplus * surplus;\n            score += p6 * params.IPColocationFactorWeight;\n        }\n    });\n    // P7: behavioural pattern penalty\n    if (pstats.behaviourPenalty > params.behaviourPenaltyThreshold) {\n        const excess = pstats.behaviourPenalty - params.behaviourPenaltyThreshold;\n        const p7 = excess * excess;\n        score += p7 * params.behaviourPenaltyWeight;\n    }\n    return score;\n}\n//# sourceMappingURL=compute-score.js.map","import { TimeCacheDuration } from '../constants.js';\nimport Denque from 'denque';\nexport var DeliveryRecordStatus;\n(function (DeliveryRecordStatus) {\n    /**\n     * we don't know (yet) if the message is valid\n     */\n    DeliveryRecordStatus[DeliveryRecordStatus[\"unknown\"] = 0] = \"unknown\";\n    /**\n     * we know the message is valid\n     */\n    DeliveryRecordStatus[DeliveryRecordStatus[\"valid\"] = 1] = \"valid\";\n    /**\n     * we know the message is invalid\n     */\n    DeliveryRecordStatus[DeliveryRecordStatus[\"invalid\"] = 2] = \"invalid\";\n    /**\n     * we were instructed by the validator to ignore the message\n     */\n    DeliveryRecordStatus[DeliveryRecordStatus[\"ignored\"] = 3] = \"ignored\";\n})(DeliveryRecordStatus || (DeliveryRecordStatus = {}));\n/**\n * Map of canonical message ID to DeliveryRecord\n *\n * Maintains an internal queue for efficient gc of old messages\n */\nexport class MessageDeliveries {\n    records;\n    queue;\n    constructor() {\n        this.records = new Map();\n        this.queue = new Denque();\n    }\n    getRecord(msgIdStr) {\n        return this.records.get(msgIdStr);\n    }\n    ensureRecord(msgIdStr) {\n        let drec = this.records.get(msgIdStr);\n        if (drec) {\n            return drec;\n        }\n        // record doesn't exist yet\n        // create record\n        drec = {\n            status: DeliveryRecordStatus.unknown,\n            firstSeenTsMs: Date.now(),\n            validated: 0,\n            peers: new Set()\n        };\n        this.records.set(msgIdStr, drec);\n        // and add msgId to the queue\n        const entry = {\n            msgId: msgIdStr,\n            expire: Date.now() + TimeCacheDuration\n        };\n        this.queue.push(entry);\n        return drec;\n    }\n    gc() {\n        const now = Date.now();\n        // queue is sorted by expiry time\n        // remove expired messages, remove from queue until first un-expired message found\n        let head = this.queue.peekFront();\n        while (head && head.expire < now) {\n            this.records.delete(head.msgId);\n            this.queue.shift();\n            head = this.queue.peekFront();\n        }\n    }\n    clear() {\n        this.records.clear();\n        this.queue.clear();\n    }\n}\n//# sourceMappingURL=message-deliveries.js.map","/**\n * Exclude up to `ineed` items from a set if item meets condition `cond`\n */\nexport function removeItemsFromSet(superSet, ineed, cond = () => true) {\n    const subset = new Set();\n    if (ineed <= 0)\n        return subset;\n    for (const id of superSet) {\n        if (subset.size >= ineed)\n            break;\n        if (cond(id)) {\n            subset.add(id);\n            superSet.delete(id);\n        }\n    }\n    return subset;\n}\n/**\n * Exclude up to `ineed` items from a set\n */\nexport function removeFirstNItemsFromSet(superSet, ineed) {\n    return removeItemsFromSet(superSet, ineed, () => true);\n}\nexport class MapDef extends Map {\n    getDefault;\n    constructor(getDefault) {\n        super();\n        this.getDefault = getDefault;\n    }\n    getOrDefault(key) {\n        let value = super.get(key);\n        if (value === undefined) {\n            value = this.getDefault();\n            this.set(key, value);\n        }\n        return value;\n    }\n}\n//# sourceMappingURL=set.js.map","import { validatePeerScoreParams } from './peer-score-params.js';\nimport { computeScore } from './compute-score.js';\nimport { MessageDeliveries, DeliveryRecordStatus } from './message-deliveries.js';\nimport { logger } from '@libp2p/logger';\nimport { RejectReason } from '../types.js';\nimport { MapDef } from '../utils/set.js';\nconst log = logger('libp2p:gossipsub:score');\nexport class PeerScore {\n    params;\n    metrics;\n    /**\n     * Per-peer stats for score calculation\n     */\n    peerStats = new Map();\n    /**\n     * IP colocation tracking; maps IP => set of peers.\n     */\n    peerIPs = new MapDef(() => new Set());\n    /**\n     * Cache score up to decayInterval if topic stats are unchanged.\n     */\n    scoreCache = new Map();\n    /**\n     * Recent message delivery timing/participants\n     */\n    deliveryRecords = new MessageDeliveries();\n    _backgroundInterval;\n    scoreCacheValidityMs;\n    computeScore;\n    constructor(params, metrics, opts) {\n        this.params = params;\n        this.metrics = metrics;\n        validatePeerScoreParams(params);\n        this.scoreCacheValidityMs = opts.scoreCacheValidityMs;\n        this.computeScore = opts.computeScore ?? computeScore;\n    }\n    get size() {\n        return this.peerStats.size;\n    }\n    /**\n     * Start PeerScore instance\n     */\n    start() {\n        if (this._backgroundInterval) {\n            log('Peer score already running');\n            return;\n        }\n        this._backgroundInterval = setInterval(() => this.background(), this.params.decayInterval);\n        log('started');\n    }\n    /**\n     * Stop PeerScore instance\n     */\n    stop() {\n        if (!this._backgroundInterval) {\n            log('Peer score already stopped');\n            return;\n        }\n        clearInterval(this._backgroundInterval);\n        delete this._backgroundInterval;\n        this.peerIPs.clear();\n        this.peerStats.clear();\n        this.deliveryRecords.clear();\n        log('stopped');\n    }\n    /**\n     * Periodic maintenance\n     */\n    background() {\n        this.refreshScores();\n        this.deliveryRecords.gc();\n    }\n    dumpPeerScoreStats() {\n        return Object.fromEntries(Array.from(this.peerStats.entries()).map(([peer, stats]) => [peer, stats]));\n    }\n    messageFirstSeenTimestampMs(msgIdStr) {\n        const drec = this.deliveryRecords.getRecord(msgIdStr);\n        return drec ? drec.firstSeenTsMs : null;\n    }\n    /**\n     * Decays scores, and purges score records for disconnected peers once their expiry has elapsed.\n     */\n    refreshScores() {\n        const now = Date.now();\n        const decayToZero = this.params.decayToZero;\n        this.peerStats.forEach((pstats, id) => {\n            if (!pstats.connected) {\n                // has the retention period expired?\n                if (now > pstats.expire) {\n                    // yes, throw it away (but clean up the IP tracking first)\n                    this.removeIPsForPeer(id, pstats.knownIPs);\n                    this.peerStats.delete(id);\n                    this.scoreCache.delete(id);\n                }\n                // we don't decay retained scores, as the peer is not active.\n                // this way the peer cannot reset a negative score by simply disconnecting and reconnecting,\n                // unless the retention period has elapsed.\n                // similarly, a well behaved peer does not lose its score by getting disconnected.\n                return;\n            }\n            Object.entries(pstats.topics).forEach(([topic, tstats]) => {\n                const tparams = this.params.topics[topic];\n                if (tparams === undefined) {\n                    // we are not scoring this topic\n                    // should be unreachable, we only add scored topics to pstats\n                    return;\n                }\n                // decay counters\n                tstats.firstMessageDeliveries *= tparams.firstMessageDeliveriesDecay;\n                if (tstats.firstMessageDeliveries < decayToZero) {\n                    tstats.firstMessageDeliveries = 0;\n                }\n                tstats.meshMessageDeliveries *= tparams.meshMessageDeliveriesDecay;\n                if (tstats.meshMessageDeliveries < decayToZero) {\n                    tstats.meshMessageDeliveries = 0;\n                }\n                tstats.meshFailurePenalty *= tparams.meshFailurePenaltyDecay;\n                if (tstats.meshFailurePenalty < decayToZero) {\n                    tstats.meshFailurePenalty = 0;\n                }\n                tstats.invalidMessageDeliveries *= tparams.invalidMessageDeliveriesDecay;\n                if (tstats.invalidMessageDeliveries < decayToZero) {\n                    tstats.invalidMessageDeliveries = 0;\n                }\n                // update mesh time and activate mesh message delivery parameter if need be\n                if (tstats.inMesh) {\n                    tstats.meshTime = now - tstats.graftTime;\n                    if (tstats.meshTime > tparams.meshMessageDeliveriesActivation) {\n                        tstats.meshMessageDeliveriesActive = true;\n                    }\n                }\n            });\n            // decay P7 counter\n            pstats.behaviourPenalty *= this.params.behaviourPenaltyDecay;\n            if (pstats.behaviourPenalty < decayToZero) {\n                pstats.behaviourPenalty = 0;\n            }\n        });\n    }\n    /**\n     * Return the score for a peer\n     */\n    score(id) {\n        this.metrics?.scoreFnCalls.inc();\n        const pstats = this.peerStats.get(id);\n        if (!pstats) {\n            return 0;\n        }\n        const now = Date.now();\n        const cacheEntry = this.scoreCache.get(id);\n        // Found cached score within validity period\n        if (cacheEntry && cacheEntry.cacheUntil > now) {\n            return cacheEntry.score;\n        }\n        this.metrics?.scoreFnRuns.inc();\n        const score = this.computeScore(id, pstats, this.params, this.peerIPs);\n        const cacheUntil = now + this.scoreCacheValidityMs;\n        if (cacheEntry) {\n            this.metrics?.scoreCachedDelta.observe(Math.abs(score - cacheEntry.score));\n            cacheEntry.score = score;\n            cacheEntry.cacheUntil = cacheUntil;\n        }\n        else {\n            this.scoreCache.set(id, { score, cacheUntil });\n        }\n        return score;\n    }\n    /**\n     * Apply a behavioural penalty to a peer\n     */\n    addPenalty(id, penalty, penaltyLabel) {\n        const pstats = this.peerStats.get(id);\n        if (pstats) {\n            pstats.behaviourPenalty += penalty;\n            this.metrics?.onScorePenalty(penaltyLabel);\n        }\n    }\n    addPeer(id) {\n        // create peer stats (not including topic stats for each topic to be scored)\n        // topic stats will be added as needed\n        const pstats = {\n            connected: true,\n            expire: 0,\n            topics: {},\n            knownIPs: new Set(),\n            behaviourPenalty: 0\n        };\n        this.peerStats.set(id, pstats);\n    }\n    /** Adds a new IP to a peer, if the peer is not known the update is ignored */\n    addIP(id, ip) {\n        const pstats = this.peerStats.get(id);\n        if (pstats) {\n            pstats.knownIPs.add(ip);\n        }\n        this.peerIPs.getOrDefault(ip).add(id);\n    }\n    /** Remove peer association with IP */\n    removeIP(id, ip) {\n        const pstats = this.peerStats.get(id);\n        if (pstats) {\n            pstats.knownIPs.delete(ip);\n        }\n        const peersWithIP = this.peerIPs.get(ip);\n        if (peersWithIP) {\n            peersWithIP.delete(id);\n            if (peersWithIP.size === 0) {\n                this.peerIPs.delete(ip);\n            }\n        }\n    }\n    removePeer(id) {\n        const pstats = this.peerStats.get(id);\n        if (!pstats) {\n            return;\n        }\n        // decide whether to retain the score; this currently only retains non-positive scores\n        // to dissuade attacks on the score function.\n        if (this.score(id) > 0) {\n            this.removeIPsForPeer(id, pstats.knownIPs);\n            this.peerStats.delete(id);\n            return;\n        }\n        // furthermore, when we decide to retain the score, the firstMessageDelivery counters are\n        // reset to 0 and mesh delivery penalties applied.\n        Object.entries(pstats.topics).forEach(([topic, tstats]) => {\n            tstats.firstMessageDeliveries = 0;\n            const threshold = this.params.topics[topic].meshMessageDeliveriesThreshold;\n            if (tstats.inMesh && tstats.meshMessageDeliveriesActive && tstats.meshMessageDeliveries < threshold) {\n                const deficit = threshold - tstats.meshMessageDeliveries;\n                tstats.meshFailurePenalty += deficit * deficit;\n            }\n            tstats.inMesh = false;\n            tstats.meshMessageDeliveriesActive = false;\n        });\n        pstats.connected = false;\n        pstats.expire = Date.now() + this.params.retainScore;\n    }\n    /** Handles scoring functionality as a peer GRAFTs to a topic. */\n    graft(id, topic) {\n        const pstats = this.peerStats.get(id);\n        if (pstats) {\n            const tstats = this.getPtopicStats(pstats, topic);\n            if (tstats) {\n                // if we are scoring the topic, update the mesh status.\n                tstats.inMesh = true;\n                tstats.graftTime = Date.now();\n                tstats.meshTime = 0;\n                tstats.meshMessageDeliveriesActive = false;\n            }\n        }\n    }\n    /** Handles scoring functionality as a peer PRUNEs from a topic. */\n    prune(id, topic) {\n        const pstats = this.peerStats.get(id);\n        if (pstats) {\n            const tstats = this.getPtopicStats(pstats, topic);\n            if (tstats) {\n                // sticky mesh delivery rate failure penalty\n                const threshold = this.params.topics[topic].meshMessageDeliveriesThreshold;\n                if (tstats.meshMessageDeliveriesActive && tstats.meshMessageDeliveries < threshold) {\n                    const deficit = threshold - tstats.meshMessageDeliveries;\n                    tstats.meshFailurePenalty += deficit * deficit;\n                }\n                tstats.meshMessageDeliveriesActive = false;\n                tstats.inMesh = false;\n                // TODO: Consider clearing score cache on important penalties\n                // this.scoreCache.delete(id)\n            }\n        }\n    }\n    validateMessage(msgIdStr) {\n        this.deliveryRecords.ensureRecord(msgIdStr);\n    }\n    deliverMessage(from, msgIdStr, topic) {\n        this.markFirstMessageDelivery(from, topic);\n        const drec = this.deliveryRecords.ensureRecord(msgIdStr);\n        const now = Date.now();\n        // defensive check that this is the first delivery trace -- delivery status should be unknown\n        if (drec.status !== DeliveryRecordStatus.unknown) {\n            log('unexpected delivery: message from %s was first seen %s ago and has delivery status %s', from, now - drec.firstSeenTsMs, DeliveryRecordStatus[drec.status]);\n            return;\n        }\n        // mark the message as valid and reward mesh peers that have already forwarded it to us\n        drec.status = DeliveryRecordStatus.valid;\n        drec.validated = now;\n        drec.peers.forEach((p) => {\n            // this check is to make sure a peer can't send us a message twice and get a double count\n            // if it is a first delivery.\n            if (p !== from.toString()) {\n                this.markDuplicateMessageDelivery(p, topic);\n            }\n        });\n    }\n    /**\n     * Similar to `rejectMessage` except does not require the message id or reason for an invalid message.\n     */\n    rejectInvalidMessage(from, topic) {\n        this.markInvalidMessageDelivery(from, topic);\n    }\n    rejectMessage(from, msgIdStr, topic, reason) {\n        switch (reason) {\n            // these messages are not tracked, but the peer is penalized as they are invalid\n            case RejectReason.Error:\n                this.markInvalidMessageDelivery(from, topic);\n                return;\n            // we ignore those messages, so do nothing.\n            case RejectReason.Blacklisted:\n                return;\n            // the rest are handled after record creation\n        }\n        const drec = this.deliveryRecords.ensureRecord(msgIdStr);\n        // defensive check that this is the first rejection -- delivery status should be unknown\n        if (drec.status !== DeliveryRecordStatus.unknown) {\n            log('unexpected rejection: message from %s was first seen %s ago and has delivery status %d', from, Date.now() - drec.firstSeenTsMs, DeliveryRecordStatus[drec.status]);\n            return;\n        }\n        if (reason === RejectReason.Ignore) {\n            // we were explicitly instructed by the validator to ignore the message but not penalize the peer\n            drec.status = DeliveryRecordStatus.ignored;\n            drec.peers.clear();\n            return;\n        }\n        // mark the message as invalid and penalize peers that have already forwarded it.\n        drec.status = DeliveryRecordStatus.invalid;\n        this.markInvalidMessageDelivery(from, topic);\n        drec.peers.forEach((p) => {\n            this.markInvalidMessageDelivery(p, topic);\n        });\n        // release the delivery time tracking map to free some memory early\n        drec.peers.clear();\n    }\n    duplicateMessage(from, msgIdStr, topic) {\n        const drec = this.deliveryRecords.ensureRecord(msgIdStr);\n        if (drec.peers.has(from)) {\n            // we have already seen this duplicate\n            return;\n        }\n        switch (drec.status) {\n            case DeliveryRecordStatus.unknown:\n                // the message is being validated; track the peer delivery and wait for\n                // the Deliver/Reject/Ignore notification.\n                drec.peers.add(from);\n                break;\n            case DeliveryRecordStatus.valid:\n                // mark the peer delivery time to only count a duplicate delivery once.\n                drec.peers.add(from);\n                this.markDuplicateMessageDelivery(from, topic, drec.validated);\n                break;\n            case DeliveryRecordStatus.invalid:\n                // we no longer track delivery time\n                this.markInvalidMessageDelivery(from, topic);\n                break;\n            case DeliveryRecordStatus.ignored:\n                // the message was ignored; do nothing (we don't know if it was valid)\n                break;\n        }\n    }\n    /**\n     * Increments the \"invalid message deliveries\" counter for all scored topics the message is published in.\n     */\n    markInvalidMessageDelivery(from, topic) {\n        const pstats = this.peerStats.get(from);\n        if (pstats) {\n            const tstats = this.getPtopicStats(pstats, topic);\n            if (tstats) {\n                tstats.invalidMessageDeliveries += 1;\n            }\n        }\n    }\n    /**\n     * Increments the \"first message deliveries\" counter for all scored topics the message is published in,\n     * as well as the \"mesh message deliveries\" counter, if the peer is in the mesh for the topic.\n     * Messages already known (with the seenCache) are counted with markDuplicateMessageDelivery()\n     */\n    markFirstMessageDelivery(from, topic) {\n        const pstats = this.peerStats.get(from);\n        if (pstats) {\n            const tstats = this.getPtopicStats(pstats, topic);\n            if (tstats) {\n                let cap = this.params.topics[topic].firstMessageDeliveriesCap;\n                tstats.firstMessageDeliveries = Math.min(cap, tstats.firstMessageDeliveries + 1);\n                if (tstats.inMesh) {\n                    cap = this.params.topics[topic].meshMessageDeliveriesCap;\n                    tstats.meshMessageDeliveries = Math.min(cap, tstats.meshMessageDeliveries + 1);\n                }\n            }\n        }\n    }\n    /**\n     * Increments the \"mesh message deliveries\" counter for messages we've seen before,\n     * as long the message was received within the P3 window.\n     */\n    markDuplicateMessageDelivery(from, topic, validatedTime) {\n        const pstats = this.peerStats.get(from);\n        if (pstats) {\n            const now = validatedTime !== undefined ? Date.now() : 0;\n            const tstats = this.getPtopicStats(pstats, topic);\n            if (tstats && tstats.inMesh) {\n                const tparams = this.params.topics[topic];\n                // check against the mesh delivery window -- if the validated time is passed as 0, then\n                // the message was received before we finished validation and thus falls within the mesh\n                // delivery window.\n                if (validatedTime !== undefined) {\n                    const deliveryDelayMs = now - validatedTime;\n                    const isLateDelivery = deliveryDelayMs > tparams.meshMessageDeliveriesWindow;\n                    this.metrics?.onDuplicateMsgDelivery(topic, deliveryDelayMs, isLateDelivery);\n                    if (isLateDelivery) {\n                        return;\n                    }\n                }\n                const cap = tparams.meshMessageDeliveriesCap;\n                tstats.meshMessageDeliveries = Math.min(cap, tstats.meshMessageDeliveries + 1);\n            }\n        }\n    }\n    /**\n     * Removes an IP list from the tracking list for a peer.\n     */\n    removeIPsForPeer(id, ipsToRemove) {\n        for (const ipToRemove of ipsToRemove) {\n            const peerSet = this.peerIPs.get(ipToRemove);\n            if (peerSet) {\n                peerSet.delete(id);\n                if (peerSet.size === 0) {\n                    this.peerIPs.delete(ipToRemove);\n                }\n            }\n        }\n    }\n    /**\n     * Returns topic stats if they exist, otherwise if the supplied parameters score the\n     * topic, inserts the default stats and returns a reference to those. If neither apply, returns None.\n     */\n    getPtopicStats(pstats, topic) {\n        let topicStats = pstats.topics[topic];\n        if (topicStats !== undefined) {\n            return topicStats;\n        }\n        if (this.params.topics[topic] !== undefined) {\n            topicStats = {\n                inMesh: false,\n                graftTime: 0,\n                meshTime: 0,\n                firstMessageDeliveries: 0,\n                meshMessageDeliveries: 0,\n                meshMessageDeliveriesActive: false,\n                meshFailurePenalty: 0,\n                invalidMessageDeliveries: 0\n            };\n            pstats.topics[topic] = topicStats;\n            return topicStats;\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=peer-score.js.map","import { RejectReason } from './types.js';\n/**\n * IWantTracer is an internal tracer that tracks IWANT requests in order to penalize\n * peers who don't follow up on IWANT requests after an IHAVE advertisement.\n * The tracking of promises is probabilistic to avoid using too much memory.\n *\n * Note: Do not confuse these 'promises' with JS Promise objects.\n * These 'promises' are merely expectations of a peer's behavior.\n */\nexport class IWantTracer {\n    gossipsubIWantFollowupMs;\n    msgIdToStrFn;\n    metrics;\n    /**\n     * Promises to deliver a message\n     * Map per message id, per peer, promise expiration time\n     */\n    promises = new Map();\n    /**\n     * First request time by msgId. Used for metrics to track expire times.\n     * Necessary to know if peers are actually breaking promises or simply sending them a bit later\n     */\n    requestMsByMsg = new Map();\n    requestMsByMsgExpire;\n    constructor(gossipsubIWantFollowupMs, msgIdToStrFn, metrics) {\n        this.gossipsubIWantFollowupMs = gossipsubIWantFollowupMs;\n        this.msgIdToStrFn = msgIdToStrFn;\n        this.metrics = metrics;\n        this.requestMsByMsgExpire = 10 * gossipsubIWantFollowupMs;\n    }\n    get size() {\n        return this.promises.size;\n    }\n    get requestMsByMsgSize() {\n        return this.requestMsByMsg.size;\n    }\n    /**\n     * Track a promise to deliver a message from a list of msgIds we are requesting\n     */\n    addPromise(from, msgIds) {\n        // pick msgId randomly from the list\n        const ix = Math.floor(Math.random() * msgIds.length);\n        const msgId = msgIds[ix];\n        const msgIdStr = this.msgIdToStrFn(msgId);\n        let expireByPeer = this.promises.get(msgIdStr);\n        if (!expireByPeer) {\n            expireByPeer = new Map();\n            this.promises.set(msgIdStr, expireByPeer);\n        }\n        const now = Date.now();\n        // If a promise for this message id and peer already exists we don't update the expiry\n        if (!expireByPeer.has(from)) {\n            expireByPeer.set(from, now + this.gossipsubIWantFollowupMs);\n            if (this.metrics) {\n                this.metrics.iwantPromiseStarted.inc(1);\n                if (!this.requestMsByMsg.has(msgIdStr)) {\n                    this.requestMsByMsg.set(msgIdStr, now);\n                }\n            }\n        }\n    }\n    /**\n     * Returns the number of broken promises for each peer who didn't follow up on an IWANT request.\n     *\n     * This should be called not too often relative to the expire times, since it iterates over the whole data.\n     */\n    getBrokenPromises() {\n        const now = Date.now();\n        const result = new Map();\n        let brokenPromises = 0;\n        this.promises.forEach((expireByPeer, msgId) => {\n            expireByPeer.forEach((expire, p) => {\n                // the promise has been broken\n                if (expire < now) {\n                    // add 1 to result\n                    result.set(p, (result.get(p) ?? 0) + 1);\n                    // delete from tracked promises\n                    expireByPeer.delete(p);\n                    // for metrics\n                    brokenPromises++;\n                }\n            });\n            // clean up empty promises for a msgId\n            if (!expireByPeer.size) {\n                this.promises.delete(msgId);\n            }\n        });\n        this.metrics?.iwantPromiseBroken.inc(brokenPromises);\n        return result;\n    }\n    /**\n     * Someone delivered a message, stop tracking promises for it\n     */\n    deliverMessage(msgIdStr, isDuplicate = false) {\n        this.trackMessage(msgIdStr);\n        const expireByPeer = this.promises.get(msgIdStr);\n        // Expired promise, check requestMsByMsg\n        if (expireByPeer) {\n            this.promises.delete(msgIdStr);\n            if (this.metrics) {\n                this.metrics.iwantPromiseResolved.inc(1);\n                if (isDuplicate)\n                    this.metrics.iwantPromiseResolvedFromDuplicate.inc(1);\n                this.metrics.iwantPromiseResolvedPeers.inc(expireByPeer.size);\n            }\n        }\n    }\n    /**\n     * A message got rejected, so we can stop tracking promises and let the score penalty apply from invalid message delivery,\n     * unless its an obviously invalid message.\n     */\n    rejectMessage(msgIdStr, reason) {\n        this.trackMessage(msgIdStr);\n        // A message got rejected, so we can stop tracking promises and let the score penalty apply.\n        // With the expection of obvious invalid messages\n        switch (reason) {\n            case RejectReason.Error:\n                return;\n        }\n        this.promises.delete(msgIdStr);\n    }\n    clear() {\n        this.promises.clear();\n    }\n    prune() {\n        const maxMs = Date.now() - this.requestMsByMsgExpire;\n        let count = 0;\n        for (const [k, v] of this.requestMsByMsg.entries()) {\n            if (v < maxMs) {\n                // messages that stay too long in the requestMsByMsg map, delete\n                this.requestMsByMsg.delete(k);\n                count++;\n            }\n            else {\n                // recent messages, keep them\n                // sort by insertion order\n                break;\n            }\n        }\n        this.metrics?.iwantMessagePruned.inc(count);\n    }\n    trackMessage(msgIdStr) {\n        if (this.metrics) {\n            const requestMs = this.requestMsByMsg.get(msgIdStr);\n            if (requestMs !== undefined) {\n                this.metrics.iwantPromiseDeliveryTime.observe((Date.now() - requestMs) / 1000);\n                this.requestMsByMsg.delete(msgIdStr);\n            }\n        }\n    }\n}\n//# sourceMappingURL=tracer.js.map","/**\n * This is similar to https://github.com/daviddias/time-cache/blob/master/src/index.js\n * for our own need, we don't use lodash throttle to improve performance.\n * This gives 4x - 5x performance gain compared to npm TimeCache\n */\nexport class SimpleTimeCache {\n    entries = new Map();\n    validityMs;\n    constructor(opts) {\n        this.validityMs = opts.validityMs;\n        // allow negative validityMs so that this does not cache anything, spec test compliance.spec.js\n        // sends duplicate messages and expect peer to receive all. Application likely uses positive validityMs\n    }\n    get size() {\n        return this.entries.size;\n    }\n    /** Returns true if there was a key collision and the entry is dropped */\n    put(key, value) {\n        if (this.entries.has(key)) {\n            // Key collisions break insertion order in the entries cache, which break prune logic.\n            // prune relies on each iterated entry to have strictly ascending validUntilMs, else it\n            // won't prune expired entries and SimpleTimeCache will grow unexpectedly.\n            // As of Oct 2022 NodeJS v16, inserting the same key twice with different value does not\n            // change the key position in the iterator stream. A unit test asserts this behaviour.\n            return true;\n        }\n        this.entries.set(key, { value, validUntilMs: Date.now() + this.validityMs });\n        return false;\n    }\n    prune() {\n        const now = Date.now();\n        for (const [k, v] of this.entries.entries()) {\n            if (v.validUntilMs < now) {\n                this.entries.delete(k);\n            }\n            else {\n                // Entries are inserted with strictly ascending validUntilMs.\n                // Stop early to save iterations\n                break;\n            }\n        }\n    }\n    has(key) {\n        return this.entries.has(key);\n    }\n    get(key) {\n        const value = this.entries.get(key);\n        return value && value.validUntilMs >= Date.now() ? value.value : undefined;\n    }\n    clear() {\n        this.entries.clear();\n    }\n}\n//# sourceMappingURL=time-cache.js.map","import { TopicValidatorResult } from '@libp2p/interface/pubsub';\nimport { MessageStatus, RejectReason, ValidateError } from './types.js';\nexport var MessageSource;\n(function (MessageSource) {\n    MessageSource[\"forward\"] = \"forward\";\n    MessageSource[\"publish\"] = \"publish\";\n})(MessageSource || (MessageSource = {}));\nexport var InclusionReason;\n(function (InclusionReason) {\n    /** Peer was a fanaout peer. */\n    InclusionReason[\"Fanout\"] = \"fanout\";\n    /** Included from random selection. */\n    InclusionReason[\"Random\"] = \"random\";\n    /** Peer subscribed. */\n    InclusionReason[\"Subscribed\"] = \"subscribed\";\n    /** On heartbeat, peer was included to fill the outbound quota. */\n    InclusionReason[\"Outbound\"] = \"outbound\";\n    /** On heartbeat, not enough peers in mesh */\n    InclusionReason[\"NotEnough\"] = \"not_enough\";\n    /** On heartbeat opportunistic grafting due to low mesh score */\n    InclusionReason[\"Opportunistic\"] = \"opportunistic\";\n})(InclusionReason || (InclusionReason = {}));\n/// Reasons why a peer was removed from the mesh.\nexport var ChurnReason;\n(function (ChurnReason) {\n    /// Peer disconnected.\n    ChurnReason[\"Dc\"] = \"disconnected\";\n    /// Peer had a bad score.\n    ChurnReason[\"BadScore\"] = \"bad_score\";\n    /// Peer sent a PRUNE.\n    ChurnReason[\"Prune\"] = \"prune\";\n    /// Too many peers.\n    ChurnReason[\"Excess\"] = \"excess\";\n})(ChurnReason || (ChurnReason = {}));\n/// Kinds of reasons a peer's score has been penalized\nexport var ScorePenalty;\n(function (ScorePenalty) {\n    /// A peer grafted before waiting the back-off time.\n    ScorePenalty[\"GraftBackoff\"] = \"graft_backoff\";\n    /// A Peer did not respond to an IWANT request in time.\n    ScorePenalty[\"BrokenPromise\"] = \"broken_promise\";\n    /// A Peer did not send enough messages as expected.\n    ScorePenalty[\"MessageDeficit\"] = \"message_deficit\";\n    /// Too many peers under one IP address.\n    ScorePenalty[\"IPColocation\"] = \"IP_colocation\";\n})(ScorePenalty || (ScorePenalty = {}));\nexport var IHaveIgnoreReason;\n(function (IHaveIgnoreReason) {\n    IHaveIgnoreReason[\"LowScore\"] = \"low_score\";\n    IHaveIgnoreReason[\"MaxIhave\"] = \"max_ihave\";\n    IHaveIgnoreReason[\"MaxIasked\"] = \"max_iasked\";\n})(IHaveIgnoreReason || (IHaveIgnoreReason = {}));\nexport var ScoreThreshold;\n(function (ScoreThreshold) {\n    ScoreThreshold[\"graylist\"] = \"graylist\";\n    ScoreThreshold[\"publish\"] = \"publish\";\n    ScoreThreshold[\"gossip\"] = \"gossip\";\n    ScoreThreshold[\"mesh\"] = \"mesh\";\n})(ScoreThreshold || (ScoreThreshold = {}));\n/**\n * A collection of metrics used throughout the Gossipsub behaviour.\n * NOTE: except for special reasons, do not add more than 1 label for frequent metrics,\n * there's a performance penalty as of June 2023.\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function getMetrics(register, topicStrToLabel, opts) {\n    // Using function style instead of class to prevent having to re-declare all MetricsPrometheus types.\n    return {\n        /* Metrics for static config */\n        protocolsEnabled: register.gauge({\n            name: 'gossipsub_protocol',\n            help: 'Status of enabled protocols',\n            labelNames: ['protocol']\n        }),\n        /* Metrics per known topic */\n        /** Status of our subscription to this topic. This metric allows analyzing other topic metrics\n         *  filtered by our current subscription status.\n         *  = rust-libp2p `topic_subscription_status` */\n        topicSubscriptionStatus: register.gauge({\n            name: 'gossipsub_topic_subscription_status',\n            help: 'Status of our subscription to this topic',\n            labelNames: ['topicStr']\n        }),\n        /** Number of peers subscribed to each topic. This allows us to analyze a topic's behaviour\n         * regardless of our subscription status. */\n        topicPeersCount: register.gauge({\n            name: 'gossipsub_topic_peer_count',\n            help: 'Number of peers subscribed to each topic',\n            labelNames: ['topicStr']\n        }),\n        /* Metrics regarding mesh state */\n        /** Number of peers in our mesh. This metric should be updated with the count of peers for a\n         *  topic in the mesh regardless of inclusion and churn events.\n         *  = rust-libp2p `mesh_peer_counts` */\n        meshPeerCounts: register.gauge({\n            name: 'gossipsub_mesh_peer_count',\n            help: 'Number of peers in our mesh',\n            labelNames: ['topicStr']\n        }),\n        /** Number of times we include peers in a topic mesh for different reasons.\n         *  = rust-libp2p `mesh_peer_inclusion_events` */\n        meshPeerInclusionEventsFanout: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_fanout_total',\n            help: 'Number of times we include peers in a topic mesh for fanout reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsRandom: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_random_total',\n            help: 'Number of times we include peers in a topic mesh for random reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsSubscribed: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_subscribed_total',\n            help: 'Number of times we include peers in a topic mesh for subscribed reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsOutbound: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_outbound_total',\n            help: 'Number of times we include peers in a topic mesh for outbound reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsNotEnough: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_not_enough_total',\n            help: 'Number of times we include peers in a topic mesh for not_enough reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsOpportunistic: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_opportunistic_total',\n            help: 'Number of times we include peers in a topic mesh for opportunistic reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerInclusionEventsUnknown: register.gauge({\n            name: 'gossipsub_mesh_peer_inclusion_events_unknown_total',\n            help: 'Number of times we include peers in a topic mesh for unknown reasons',\n            labelNames: ['topic']\n        }),\n        /** Number of times we remove peers in a topic mesh for different reasons.\n         *  = rust-libp2p `mesh_peer_churn_events` */\n        meshPeerChurnEventsDisconnected: register.gauge({\n            name: 'gossipsub_peer_churn_events_disconnected_total',\n            help: 'Number of times we remove peers in a topic mesh for disconnected reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerChurnEventsBadScore: register.gauge({\n            name: 'gossipsub_peer_churn_events_bad_score_total',\n            help: 'Number of times we remove peers in a topic mesh for bad_score reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerChurnEventsPrune: register.gauge({\n            name: 'gossipsub_peer_churn_events_prune_total',\n            help: 'Number of times we remove peers in a topic mesh for prune reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerChurnEventsExcess: register.gauge({\n            name: 'gossipsub_peer_churn_events_excess_total',\n            help: 'Number of times we remove peers in a topic mesh for excess reasons',\n            labelNames: ['topic']\n        }),\n        meshPeerChurnEventsUnknown: register.gauge({\n            name: 'gossipsub_peer_churn_events_unknown_total',\n            help: 'Number of times we remove peers in a topic mesh for unknown reasons',\n            labelNames: ['topic']\n        }),\n        /* General Metrics */\n        /** Gossipsub supports floodsub, gossipsub v1.0 and gossipsub v1.1. Peers are classified based\n         *  on which protocol they support. This metric keeps track of the number of peers that are\n         *  connected of each type. */\n        peersPerProtocol: register.gauge({\n            name: 'gossipsub_peers_per_protocol_count',\n            help: 'Peers connected for each topic',\n            labelNames: ['protocol']\n        }),\n        /** The time it takes to complete one iteration of the heartbeat. */\n        heartbeatDuration: register.histogram({\n            name: 'gossipsub_heartbeat_duration_seconds',\n            help: 'The time it takes to complete one iteration of the heartbeat',\n            // Should take <10ms, over 1s it's a huge issue that needs debugging, since a heartbeat will be cancelled\n            buckets: [0.01, 0.1, 1]\n        }),\n        /** Heartbeat run took longer than heartbeat interval so next is skipped */\n        heartbeatSkipped: register.gauge({\n            name: 'gossipsub_heartbeat_skipped',\n            help: 'Heartbeat run took longer than heartbeat interval so next is skipped'\n        }),\n        /** Message validation results for each topic.\n         *  Invalid == Reject?\n         *  = rust-libp2p `invalid_messages`, `accepted_messages`, `ignored_messages`, `rejected_messages` */\n        acceptedMessagesTotal: register.gauge({\n            name: 'gossipsub_accepted_messages_total',\n            help: 'Total accepted messages for each topic',\n            labelNames: ['topic']\n        }),\n        ignoredMessagesTotal: register.gauge({\n            name: 'gossipsub_ignored_messages_total',\n            help: 'Total ignored messages for each topic',\n            labelNames: ['topic']\n        }),\n        rejectedMessagesTotal: register.gauge({\n            name: 'gossipsub_rejected_messages_total',\n            help: 'Total rejected messages for each topic',\n            labelNames: ['topic']\n        }),\n        unknownValidationResultsTotal: register.gauge({\n            name: 'gossipsub_unknown_validation_results_total',\n            help: 'Total unknown validation results for each topic',\n            labelNames: ['topic']\n        }),\n        /** When the user validates a message, it tries to re propagate it to its mesh peers. If the\n         *  message expires from the memcache before it can be validated, we count this a cache miss\n         *  and it is an indicator that the memcache size should be increased.\n         *  = rust-libp2p `mcache_misses` */\n        asyncValidationMcacheHit: register.gauge({\n            name: 'gossipsub_async_validation_mcache_hit_total',\n            help: 'Async validation result reported by the user layer',\n            labelNames: ['hit']\n        }),\n        asyncValidationDelayFromFirstSeenSec: register.histogram({\n            name: 'gossipsub_async_validation_delay_from_first_seen',\n            help: 'Async validation report delay from first seen in second',\n            labelNames: ['topic'],\n            buckets: [0.01, 0.03, 0.1, 0.3, 1, 3, 10]\n        }),\n        asyncValidationUnknownFirstSeen: register.gauge({\n            name: 'gossipsub_async_validation_unknown_first_seen_count_total',\n            help: 'Async validation report unknown first seen value for message'\n        }),\n        // peer stream\n        peerReadStreamError: register.gauge({\n            name: 'gossipsub_peer_read_stream_err_count_total',\n            help: 'Peer read stream error'\n        }),\n        // RPC outgoing. Track byte length + data structure sizes\n        rpcRecvBytes: register.gauge({ name: 'gossipsub_rpc_recv_bytes_total', help: 'RPC recv' }),\n        rpcRecvCount: register.gauge({ name: 'gossipsub_rpc_recv_count_total', help: 'RPC recv' }),\n        rpcRecvSubscription: register.gauge({ name: 'gossipsub_rpc_recv_subscription_total', help: 'RPC recv' }),\n        rpcRecvMessage: register.gauge({ name: 'gossipsub_rpc_recv_message_total', help: 'RPC recv' }),\n        rpcRecvControl: register.gauge({ name: 'gossipsub_rpc_recv_control_total', help: 'RPC recv' }),\n        rpcRecvIHave: register.gauge({ name: 'gossipsub_rpc_recv_ihave_total', help: 'RPC recv' }),\n        rpcRecvIWant: register.gauge({ name: 'gossipsub_rpc_recv_iwant_total', help: 'RPC recv' }),\n        rpcRecvGraft: register.gauge({ name: 'gossipsub_rpc_recv_graft_total', help: 'RPC recv' }),\n        rpcRecvPrune: register.gauge({ name: 'gossipsub_rpc_recv_prune_total', help: 'RPC recv' }),\n        rpcDataError: register.gauge({ name: 'gossipsub_rpc_data_err_count_total', help: 'RPC data error' }),\n        rpcRecvError: register.gauge({ name: 'gossipsub_rpc_recv_err_count_total', help: 'RPC recv error' }),\n        /** Total count of RPC dropped because acceptFrom() == false */\n        rpcRecvNotAccepted: register.gauge({\n            name: 'gossipsub_rpc_rcv_not_accepted_total',\n            help: 'Total count of RPC dropped because acceptFrom() == false'\n        }),\n        // RPC incoming. Track byte length + data structure sizes\n        rpcSentBytes: register.gauge({ name: 'gossipsub_rpc_sent_bytes_total', help: 'RPC sent' }),\n        rpcSentCount: register.gauge({ name: 'gossipsub_rpc_sent_count_total', help: 'RPC sent' }),\n        rpcSentSubscription: register.gauge({ name: 'gossipsub_rpc_sent_subscription_total', help: 'RPC sent' }),\n        rpcSentMessage: register.gauge({ name: 'gossipsub_rpc_sent_message_total', help: 'RPC sent' }),\n        rpcSentControl: register.gauge({ name: 'gossipsub_rpc_sent_control_total', help: 'RPC sent' }),\n        rpcSentIHave: register.gauge({ name: 'gossipsub_rpc_sent_ihave_total', help: 'RPC sent' }),\n        rpcSentIWant: register.gauge({ name: 'gossipsub_rpc_sent_iwant_total', help: 'RPC sent' }),\n        rpcSentGraft: register.gauge({ name: 'gossipsub_rpc_sent_graft_total', help: 'RPC sent' }),\n        rpcSentPrune: register.gauge({ name: 'gossipsub_rpc_sent_prune_total', help: 'RPC sent' }),\n        // publish message. Track peers sent to and bytes\n        /** Total count of msg published by topic */\n        msgPublishCount: register.gauge({\n            name: 'gossipsub_msg_publish_count_total',\n            help: 'Total count of msg published by topic',\n            labelNames: ['topic']\n        }),\n        /** Total count of peers that we publish a msg to */\n        msgPublishPeersByTopic: register.gauge({\n            name: 'gossipsub_msg_publish_peers_total',\n            help: 'Total count of peers that we publish a msg to',\n            labelNames: ['topic']\n        }),\n        /** Total count of peers (by group) that we publish a msg to */\n        directPeersPublishedTotal: register.gauge({\n            name: 'gossipsub_direct_peers_published_total',\n            help: 'Total direct peers that we publish a msg to',\n            labelNames: ['topic']\n        }),\n        floodsubPeersPublishedTotal: register.gauge({\n            name: 'gossipsub_floodsub_peers_published_total',\n            help: 'Total floodsub peers that we publish a msg to',\n            labelNames: ['topic']\n        }),\n        meshPeersPublishedTotal: register.gauge({\n            name: 'gossipsub_mesh_peers_published_total',\n            help: 'Total mesh peers that we publish a msg to',\n            labelNames: ['topic']\n        }),\n        fanoutPeersPublishedTotal: register.gauge({\n            name: 'gossipsub_fanout_peers_published_total',\n            help: 'Total fanout peers that we publish a msg to',\n            labelNames: ['topic']\n        }),\n        /** Total count of msg publish data.length bytes */\n        msgPublishBytes: register.gauge({\n            name: 'gossipsub_msg_publish_bytes_total',\n            help: 'Total count of msg publish data.length bytes',\n            labelNames: ['topic']\n        }),\n        /** Total time in seconds to publish a message */\n        msgPublishTime: register.histogram({\n            name: 'gossipsub_msg_publish_seconds',\n            help: 'Total time in seconds to publish a message',\n            buckets: [0.001, 0.002, 0.005, 0.01, 0.1, 0.5, 1],\n            labelNames: ['topic']\n        }),\n        /** Total count of msg forwarded by topic */\n        msgForwardCount: register.gauge({\n            name: 'gossipsub_msg_forward_count_total',\n            help: 'Total count of msg forwarded by topic',\n            labelNames: ['topic']\n        }),\n        /** Total count of peers that we forward a msg to */\n        msgForwardPeers: register.gauge({\n            name: 'gossipsub_msg_forward_peers_total',\n            help: 'Total count of peers that we forward a msg to',\n            labelNames: ['topic']\n        }),\n        /** Total count of recv msgs before any validation */\n        msgReceivedPreValidation: register.gauge({\n            name: 'gossipsub_msg_received_prevalidation_total',\n            help: 'Total count of recv msgs before any validation',\n            labelNames: ['topic']\n        }),\n        /** Total count of recv msgs error */\n        msgReceivedError: register.gauge({\n            name: 'gossipsub_msg_received_error_total',\n            help: 'Total count of recv msgs error',\n            labelNames: ['topic']\n        }),\n        /** Tracks distribution of recv msgs by duplicate, invalid, valid */\n        prevalidationInvalidTotal: register.gauge({\n            name: 'gossipsub_pre_validation_invalid_total',\n            help: 'Total count of invalid messages received',\n            labelNames: ['topic']\n        }),\n        prevalidationValidTotal: register.gauge({\n            name: 'gossipsub_pre_validation_valid_total',\n            help: 'Total count of valid messages received',\n            labelNames: ['topic']\n        }),\n        prevalidationDuplicateTotal: register.gauge({\n            name: 'gossipsub_pre_validation_duplicate_total',\n            help: 'Total count of duplicate messages received',\n            labelNames: ['topic']\n        }),\n        prevalidationUnknownTotal: register.gauge({\n            name: 'gossipsub_pre_validation_unknown_status_total',\n            help: 'Total count of unknown_status messages received',\n            labelNames: ['topic']\n        }),\n        /** Tracks specific reason of invalid */\n        msgReceivedInvalid: register.gauge({\n            name: 'gossipsub_msg_received_invalid_total',\n            help: 'Tracks specific reason of invalid',\n            labelNames: ['error']\n        }),\n        msgReceivedInvalidByTopic: register.gauge({\n            name: 'gossipsub_msg_received_invalid_by_topic_total',\n            help: 'Tracks specific invalid message by topic',\n            labelNames: ['topic']\n        }),\n        /** Track duplicate message delivery time */\n        duplicateMsgDeliveryDelay: register.histogram({\n            name: 'gossisub_duplicate_msg_delivery_delay_seconds',\n            help: 'Time since the 1st duplicated message validated',\n            labelNames: ['topic'],\n            buckets: [\n                0.25 * opts.maxMeshMessageDeliveriesWindowSec,\n                0.5 * opts.maxMeshMessageDeliveriesWindowSec,\n                1 * opts.maxMeshMessageDeliveriesWindowSec,\n                2 * opts.maxMeshMessageDeliveriesWindowSec,\n                4 * opts.maxMeshMessageDeliveriesWindowSec\n            ]\n        }),\n        /** Total count of late msg delivery total by topic */\n        duplicateMsgLateDelivery: register.gauge({\n            name: 'gossisub_duplicate_msg_late_delivery_total',\n            help: 'Total count of late duplicate message delivery by topic, which triggers P3 penalty',\n            labelNames: ['topic']\n        }),\n        duplicateMsgIgnored: register.gauge({\n            name: 'gossisub_ignored_published_duplicate_msgs_total',\n            help: 'Total count of published duplicate message ignored by topic',\n            labelNames: ['topic']\n        }),\n        /* Metrics related to scoring */\n        /** Total times score() is called */\n        scoreFnCalls: register.gauge({\n            name: 'gossipsub_score_fn_calls_total',\n            help: 'Total times score() is called'\n        }),\n        /** Total times score() call actually computed computeScore(), no cache */\n        scoreFnRuns: register.gauge({\n            name: 'gossipsub_score_fn_runs_total',\n            help: 'Total times score() call actually computed computeScore(), no cache'\n        }),\n        scoreCachedDelta: register.histogram({\n            name: 'gossipsub_score_cache_delta',\n            help: 'Delta of score between cached values that expired',\n            buckets: [10, 100, 1000]\n        }),\n        /** Current count of peers by score threshold */\n        peersByScoreThreshold: register.gauge({\n            name: 'gossipsub_peers_by_score_threshold_count',\n            help: 'Current count of peers by score threshold',\n            labelNames: ['threshold']\n        }),\n        score: register.avgMinMax({\n            name: 'gossipsub_score',\n            help: 'Avg min max of gossip scores'\n        }),\n        /**\n         * Separate score weights\n         * Need to use 2-label metrics in this case to debug the score weights\n         **/\n        scoreWeights: register.avgMinMax({\n            name: 'gossipsub_score_weights',\n            help: 'Separate score weights',\n            labelNames: ['topic', 'p']\n        }),\n        /** Histogram of the scores for each mesh topic. */\n        // TODO: Not implemented\n        scorePerMesh: register.avgMinMax({\n            name: 'gossipsub_score_per_mesh',\n            help: 'Histogram of the scores for each mesh topic',\n            labelNames: ['topic']\n        }),\n        /** A counter of the kind of penalties being applied to peers. */\n        // TODO: Not fully implemented\n        scoringPenalties: register.gauge({\n            name: 'gossipsub_scoring_penalties_total',\n            help: 'A counter of the kind of penalties being applied to peers',\n            labelNames: ['penalty']\n        }),\n        behaviourPenalty: register.histogram({\n            name: 'gossipsub_peer_stat_behaviour_penalty',\n            help: 'Current peer stat behaviour_penalty at each scrape',\n            buckets: [\n                0.25 * opts.behaviourPenaltyThreshold,\n                0.5 * opts.behaviourPenaltyThreshold,\n                1 * opts.behaviourPenaltyThreshold,\n                2 * opts.behaviourPenaltyThreshold,\n                4 * opts.behaviourPenaltyThreshold\n            ]\n        }),\n        // TODO:\n        // - iasked per peer (on heartbeat)\n        // - when promise is resolved, track messages from promises\n        /** Total received IHAVE messages that we ignore for some reason */\n        ihaveRcvIgnored: register.gauge({\n            name: 'gossipsub_ihave_rcv_ignored_total',\n            help: 'Total received IHAVE messages that we ignore for some reason',\n            labelNames: ['reason']\n        }),\n        /** Total received IHAVE messages by topic */\n        ihaveRcvMsgids: register.gauge({\n            name: 'gossipsub_ihave_rcv_msgids_total',\n            help: 'Total received IHAVE messages by topic',\n            labelNames: ['topic']\n        }),\n        /** Total messages per topic we don't have. Not actual requests.\n         *  The number of times we have decided that an IWANT control message is required for this\n         *  topic. A very high metric might indicate an underperforming network.\n         *  = rust-libp2p `topic_iwant_msgs` */\n        ihaveRcvNotSeenMsgids: register.gauge({\n            name: 'gossipsub_ihave_rcv_not_seen_msgids_total',\n            help: 'Total messages per topic we do not have, not actual requests',\n            labelNames: ['topic']\n        }),\n        /** Total received IWANT messages by topic */\n        iwantRcvMsgids: register.gauge({\n            name: 'gossipsub_iwant_rcv_msgids_total',\n            help: 'Total received IWANT messages by topic',\n            labelNames: ['topic']\n        }),\n        /** Total requested messageIDs that we don't have */\n        iwantRcvDonthaveMsgids: register.gauge({\n            name: 'gossipsub_iwant_rcv_dont_have_msgids_total',\n            help: 'Total requested messageIDs that we do not have'\n        }),\n        iwantPromiseStarted: register.gauge({\n            name: 'gossipsub_iwant_promise_sent_total',\n            help: 'Total count of started IWANT promises'\n        }),\n        /** Total count of resolved IWANT promises */\n        iwantPromiseResolved: register.gauge({\n            name: 'gossipsub_iwant_promise_resolved_total',\n            help: 'Total count of resolved IWANT promises'\n        }),\n        /** Total count of resolved IWANT promises from duplicate messages */\n        iwantPromiseResolvedFromDuplicate: register.gauge({\n            name: 'gossipsub_iwant_promise_resolved_from_duplicate_total',\n            help: 'Total count of resolved IWANT promises from duplicate messages'\n        }),\n        /** Total count of peers we have asked IWANT promises that are resolved */\n        iwantPromiseResolvedPeers: register.gauge({\n            name: 'gossipsub_iwant_promise_resolved_peers',\n            help: 'Total count of peers we have asked IWANT promises that are resolved'\n        }),\n        iwantPromiseBroken: register.gauge({\n            name: 'gossipsub_iwant_promise_broken',\n            help: 'Total count of broken IWANT promises'\n        }),\n        iwantMessagePruned: register.gauge({\n            name: 'gossipsub_iwant_message_pruned',\n            help: 'Total count of pruned IWANT messages'\n        }),\n        /** Histogram of delivery time of resolved IWANT promises */\n        iwantPromiseDeliveryTime: register.histogram({\n            name: 'gossipsub_iwant_promise_delivery_seconds',\n            help: 'Histogram of delivery time of resolved IWANT promises',\n            buckets: [\n                0.5 * opts.gossipPromiseExpireSec,\n                1 * opts.gossipPromiseExpireSec,\n                2 * opts.gossipPromiseExpireSec,\n                4 * opts.gossipPromiseExpireSec\n            ]\n        }),\n        iwantPromiseUntracked: register.gauge({\n            name: 'gossip_iwant_promise_untracked',\n            help: 'Total count of untracked IWANT promise'\n        }),\n        /** Backoff time */\n        connectedPeersBackoffSec: register.histogram({\n            name: 'gossipsub_connected_peers_backoff_seconds',\n            help: 'Backoff time in seconds',\n            // Using 1 seconds as minimum as that's close to the heartbeat duration, no need for more resolution.\n            // As per spec, backoff times are 10 seconds for UnsubscribeBackoff and 60 seconds for PruneBackoff.\n            // Higher values of 60 seconds should not occur, but we add 120 seconds just in case\n            // https://github.com/libp2p/specs/blob/master/pubsub/gossipsub/gossipsub-v1.1.md#overview-of-new-parameters\n            buckets: [1, 2, 4, 10, 20, 60, 120]\n        }),\n        /* Data structure sizes */\n        /** Unbounded cache sizes */\n        cacheSize: register.gauge({\n            name: 'gossipsub_cache_size',\n            help: 'Unbounded cache sizes',\n            labelNames: ['cache']\n        }),\n        /** Current mcache msg count */\n        mcacheSize: register.gauge({\n            name: 'gossipsub_mcache_size',\n            help: 'Current mcache msg count'\n        }),\n        mcacheNotValidatedCount: register.gauge({\n            name: 'gossipsub_mcache_not_validated_count',\n            help: 'Current mcache msg count not validated'\n        }),\n        fastMsgIdCacheCollision: register.gauge({\n            name: 'gossipsub_fastmsgid_cache_collision_total',\n            help: 'Total count of key collisions on fastmsgid cache put'\n        }),\n        newConnectionCount: register.gauge({\n            name: 'gossipsub_new_connection_total',\n            help: 'Total new connection by status',\n            labelNames: ['status']\n        }),\n        topicStrToLabel: topicStrToLabel,\n        toTopic(topicStr) {\n            return this.topicStrToLabel.get(topicStr) ?? topicStr;\n        },\n        /** We joined a topic */\n        onJoin(topicStr) {\n            this.topicSubscriptionStatus.set({ topicStr }, 1);\n            this.meshPeerCounts.set({ topicStr }, 0); // Reset count\n        },\n        /** We left a topic */\n        onLeave(topicStr) {\n            this.topicSubscriptionStatus.set({ topicStr }, 0);\n            this.meshPeerCounts.set({ topicStr }, 0); // Reset count\n        },\n        /** Register the inclusion of peers in our mesh due to some reason. */\n        onAddToMesh(topicStr, reason, count) {\n            const topic = this.toTopic(topicStr);\n            switch (reason) {\n                case InclusionReason.Fanout:\n                    this.meshPeerInclusionEventsFanout.inc({ topic }, count);\n                    break;\n                case InclusionReason.Random:\n                    this.meshPeerInclusionEventsRandom.inc({ topic }, count);\n                    break;\n                case InclusionReason.Subscribed:\n                    this.meshPeerInclusionEventsSubscribed.inc({ topic }, count);\n                    break;\n                case InclusionReason.Outbound:\n                    this.meshPeerInclusionEventsOutbound.inc({ topic }, count);\n                    break;\n                case InclusionReason.NotEnough:\n                    this.meshPeerInclusionEventsNotEnough.inc({ topic }, count);\n                    break;\n                case InclusionReason.Opportunistic:\n                    this.meshPeerInclusionEventsOpportunistic.inc({ topic }, count);\n                    break;\n                default:\n                    this.meshPeerInclusionEventsUnknown.inc({ topic }, count);\n                    break;\n            }\n        },\n        /** Register the removal of peers in our mesh due to some reason */\n        // - remove_peer_from_mesh()\n        // - heartbeat() Churn::BadScore\n        // - heartbeat() Churn::Excess\n        // - on_disconnect() Churn::Ds\n        onRemoveFromMesh(topicStr, reason, count) {\n            const topic = this.toTopic(topicStr);\n            switch (reason) {\n                case ChurnReason.Dc:\n                    this.meshPeerChurnEventsDisconnected.inc({ topic }, count);\n                    break;\n                case ChurnReason.BadScore:\n                    this.meshPeerChurnEventsBadScore.inc({ topic }, count);\n                    break;\n                case ChurnReason.Prune:\n                    this.meshPeerChurnEventsPrune.inc({ topic }, count);\n                    break;\n                case ChurnReason.Excess:\n                    this.meshPeerChurnEventsExcess.inc({ topic }, count);\n                    break;\n                default:\n                    this.meshPeerChurnEventsUnknown.inc({ topic }, count);\n                    break;\n            }\n        },\n        /**\n         * Update validation result to metrics\n         * @param messageRecord null means the message's mcache record was not known at the time of acceptance report\n         */\n        onReportValidation(messageRecord, acceptance, firstSeenTimestampMs) {\n            this.asyncValidationMcacheHit.inc({ hit: messageRecord != null ? 'hit' : 'miss' });\n            if (messageRecord != null) {\n                const topic = this.toTopic(messageRecord.message.topic);\n                switch (acceptance) {\n                    case TopicValidatorResult.Accept:\n                        this.acceptedMessagesTotal.inc({ topic });\n                        break;\n                    case TopicValidatorResult.Ignore:\n                        this.ignoredMessagesTotal.inc({ topic });\n                        break;\n                    case TopicValidatorResult.Reject:\n                        this.rejectedMessagesTotal.inc({ topic });\n                        break;\n                    default:\n                        this.unknownValidationResultsTotal.inc({ topic });\n                        break;\n                }\n            }\n            if (firstSeenTimestampMs != null) {\n                this.asyncValidationDelayFromFirstSeenSec.observe((Date.now() - firstSeenTimestampMs) / 1000);\n            }\n            else {\n                this.asyncValidationUnknownFirstSeen.inc();\n            }\n        },\n        /**\n         * - in handle_graft() Penalty::GraftBackoff\n         * - in apply_iwant_penalties() Penalty::BrokenPromise\n         * - in metric_score() P3 Penalty::MessageDeficit\n         * - in metric_score() P6 Penalty::IPColocation\n         */\n        onScorePenalty(penalty) {\n            // Can this be labeled by topic too?\n            this.scoringPenalties.inc({ penalty }, 1);\n        },\n        onIhaveRcv(topicStr, ihave, idonthave) {\n            const topic = this.toTopic(topicStr);\n            this.ihaveRcvMsgids.inc({ topic }, ihave);\n            this.ihaveRcvNotSeenMsgids.inc({ topic }, idonthave);\n        },\n        onIwantRcv(iwantByTopic, iwantDonthave) {\n            for (const [topicStr, iwant] of iwantByTopic) {\n                const topic = this.toTopic(topicStr);\n                this.iwantRcvMsgids.inc({ topic }, iwant);\n            }\n            this.iwantRcvDonthaveMsgids.inc(iwantDonthave);\n        },\n        onForwardMsg(topicStr, tosendCount) {\n            const topic = this.toTopic(topicStr);\n            this.msgForwardCount.inc({ topic }, 1);\n            this.msgForwardPeers.inc({ topic }, tosendCount);\n        },\n        onPublishMsg(topicStr, tosendGroupCount, tosendCount, dataLen, ms) {\n            const topic = this.toTopic(topicStr);\n            this.msgPublishCount.inc({ topic }, 1);\n            this.msgPublishBytes.inc({ topic }, tosendCount * dataLen);\n            this.msgPublishPeersByTopic.inc({ topic }, tosendCount);\n            this.directPeersPublishedTotal.inc({ topic }, tosendGroupCount.direct);\n            this.floodsubPeersPublishedTotal.inc({ topic }, tosendGroupCount.floodsub);\n            this.meshPeersPublishedTotal.inc({ topic }, tosendGroupCount.mesh);\n            this.fanoutPeersPublishedTotal.inc({ topic }, tosendGroupCount.fanout);\n            this.msgPublishTime.observe({ topic }, ms / 1000);\n        },\n        onMsgRecvPreValidation(topicStr) {\n            const topic = this.toTopic(topicStr);\n            this.msgReceivedPreValidation.inc({ topic }, 1);\n        },\n        onMsgRecvError(topicStr) {\n            const topic = this.toTopic(topicStr);\n            this.msgReceivedError.inc({ topic }, 1);\n        },\n        onPrevalidationResult(topicStr, status) {\n            const topic = this.toTopic(topicStr);\n            switch (status) {\n                case MessageStatus.duplicate:\n                    this.prevalidationDuplicateTotal.inc({ topic });\n                    break;\n                case MessageStatus.invalid:\n                    this.prevalidationInvalidTotal.inc({ topic });\n                    break;\n                case MessageStatus.valid:\n                    this.prevalidationValidTotal.inc({ topic });\n                    break;\n                default:\n                    this.prevalidationUnknownTotal.inc({ topic });\n                    break;\n            }\n        },\n        onMsgRecvInvalid(topicStr, reason) {\n            const topic = this.toTopic(topicStr);\n            const error = reason.reason === RejectReason.Error ? reason.error : reason.reason;\n            this.msgReceivedInvalid.inc({ error }, 1);\n            this.msgReceivedInvalidByTopic.inc({ topic }, 1);\n        },\n        onDuplicateMsgDelivery(topicStr, deliveryDelayMs, isLateDelivery) {\n            this.duplicateMsgDeliveryDelay.observe(deliveryDelayMs / 1000);\n            if (isLateDelivery) {\n                const topic = this.toTopic(topicStr);\n                this.duplicateMsgLateDelivery.inc({ topic }, 1);\n            }\n        },\n        onPublishDuplicateMsg(topicStr) {\n            const topic = this.toTopic(topicStr);\n            this.duplicateMsgIgnored.inc({ topic }, 1);\n        },\n        onPeerReadStreamError() {\n            this.peerReadStreamError.inc(1);\n        },\n        onRpcRecvError() {\n            this.rpcRecvError.inc(1);\n        },\n        onRpcDataError() {\n            this.rpcDataError.inc(1);\n        },\n        onRpcRecv(rpc, rpcBytes) {\n            this.rpcRecvBytes.inc(rpcBytes);\n            this.rpcRecvCount.inc(1);\n            if (rpc.subscriptions)\n                this.rpcRecvSubscription.inc(rpc.subscriptions.length);\n            if (rpc.messages)\n                this.rpcRecvMessage.inc(rpc.messages.length);\n            if (rpc.control) {\n                this.rpcRecvControl.inc(1);\n                if (rpc.control.ihave)\n                    this.rpcRecvIHave.inc(rpc.control.ihave.length);\n                if (rpc.control.iwant)\n                    this.rpcRecvIWant.inc(rpc.control.iwant.length);\n                if (rpc.control.graft)\n                    this.rpcRecvGraft.inc(rpc.control.graft.length);\n                if (rpc.control.prune)\n                    this.rpcRecvPrune.inc(rpc.control.prune.length);\n            }\n        },\n        onRpcSent(rpc, rpcBytes) {\n            this.rpcSentBytes.inc(rpcBytes);\n            this.rpcSentCount.inc(1);\n            if (rpc.subscriptions)\n                this.rpcSentSubscription.inc(rpc.subscriptions.length);\n            if (rpc.messages)\n                this.rpcSentMessage.inc(rpc.messages.length);\n            if (rpc.control) {\n                const ihave = rpc.control.ihave?.length ?? 0;\n                const iwant = rpc.control.iwant?.length ?? 0;\n                const graft = rpc.control.graft?.length ?? 0;\n                const prune = rpc.control.prune?.length ?? 0;\n                if (ihave > 0)\n                    this.rpcSentIHave.inc(ihave);\n                if (iwant > 0)\n                    this.rpcSentIWant.inc(iwant);\n                if (graft > 0)\n                    this.rpcSentGraft.inc(graft);\n                if (prune > 0)\n                    this.rpcSentPrune.inc(prune);\n                if (ihave > 0 || iwant > 0 || graft > 0 || prune > 0)\n                    this.rpcSentControl.inc(1);\n            }\n        },\n        registerScores(scores, scoreThresholds) {\n            let graylist = 0;\n            let publish = 0;\n            let gossip = 0;\n            let mesh = 0;\n            for (const score of scores) {\n                if (score >= scoreThresholds.graylistThreshold)\n                    graylist++;\n                if (score >= scoreThresholds.publishThreshold)\n                    publish++;\n                if (score >= scoreThresholds.gossipThreshold)\n                    gossip++;\n                if (score >= 0)\n                    mesh++;\n            }\n            this.peersByScoreThreshold.set({ threshold: ScoreThreshold.graylist }, graylist);\n            this.peersByScoreThreshold.set({ threshold: ScoreThreshold.publish }, publish);\n            this.peersByScoreThreshold.set({ threshold: ScoreThreshold.gossip }, gossip);\n            this.peersByScoreThreshold.set({ threshold: ScoreThreshold.mesh }, mesh);\n            // Register full score too\n            this.score.set(scores);\n        },\n        registerScoreWeights(sw) {\n            for (const [topic, wsTopic] of sw.byTopic) {\n                this.scoreWeights.set({ topic, p: 'p1' }, wsTopic.p1w);\n                this.scoreWeights.set({ topic, p: 'p2' }, wsTopic.p2w);\n                this.scoreWeights.set({ topic, p: 'p3' }, wsTopic.p3w);\n                this.scoreWeights.set({ topic, p: 'p3b' }, wsTopic.p3bw);\n                this.scoreWeights.set({ topic, p: 'p4' }, wsTopic.p4w);\n            }\n            this.scoreWeights.set({ p: 'p5' }, sw.p5w);\n            this.scoreWeights.set({ p: 'p6' }, sw.p6w);\n            this.scoreWeights.set({ p: 'p7' }, sw.p7w);\n        },\n        registerScorePerMesh(mesh, scoreByPeer) {\n            const peersPerTopicLabel = new Map();\n            mesh.forEach((peers, topicStr) => {\n                // Aggregate by known topicLabel or throw to 'unknown'. This prevent too high cardinality\n                const topicLabel = this.topicStrToLabel.get(topicStr) ?? 'unknown';\n                let peersInMesh = peersPerTopicLabel.get(topicLabel);\n                if (!peersInMesh) {\n                    peersInMesh = new Set();\n                    peersPerTopicLabel.set(topicLabel, peersInMesh);\n                }\n                peers.forEach((p) => peersInMesh?.add(p));\n            });\n            for (const [topic, peers] of peersPerTopicLabel) {\n                const meshScores = [];\n                peers.forEach((peer) => {\n                    meshScores.push(scoreByPeer.get(peer) ?? 0);\n                });\n                this.scorePerMesh.set({ topic }, meshScores);\n            }\n        }\n    };\n}\n//# sourceMappingURL=metrics.js.map","import { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { marshalPublicKey, unmarshalPublicKey } from '@libp2p/crypto/keys';\nimport { randomBytes } from '@libp2p/crypto';\nimport { peerIdFromBytes } from '@libp2p/peer-id';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { RPC } from '../message/rpc.js';\nimport { PublishConfigType, ValidateError } from '../types.js';\nimport { StrictSign, StrictNoSign } from '@libp2p/interface/pubsub';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nexport const SignPrefix = uint8ArrayFromString('libp2p-pubsub:');\nexport async function buildRawMessage(publishConfig, topic, originalData, transformedData) {\n    switch (publishConfig.type) {\n        case PublishConfigType.Signing: {\n            const rpcMsg = {\n                from: publishConfig.author.toBytes(),\n                data: transformedData,\n                seqno: randomBytes(8),\n                topic,\n                signature: undefined,\n                key: undefined // Exclude key field for signing\n            };\n            // Get the message in bytes, and prepend with the pubsub prefix\n            // the signature is over the bytes \"libp2p-pubsub:<protobuf-message>\"\n            const bytes = uint8ArrayConcat([SignPrefix, RPC.Message.encode(rpcMsg).finish()]);\n            rpcMsg.signature = await publishConfig.privateKey.sign(bytes);\n            rpcMsg.key = publishConfig.key;\n            const msg = {\n                type: 'signed',\n                from: publishConfig.author,\n                data: originalData,\n                sequenceNumber: BigInt(`0x${uint8ArrayToString(rpcMsg.seqno, 'base16')}`),\n                topic,\n                signature: rpcMsg.signature,\n                key: rpcMsg.key\n            };\n            return {\n                raw: rpcMsg,\n                msg: msg\n            };\n        }\n        case PublishConfigType.Anonymous: {\n            return {\n                raw: {\n                    from: undefined,\n                    data: transformedData,\n                    seqno: undefined,\n                    topic,\n                    signature: undefined,\n                    key: undefined\n                },\n                msg: {\n                    type: 'unsigned',\n                    data: originalData,\n                    topic\n                }\n            };\n        }\n    }\n}\nexport async function validateToRawMessage(signaturePolicy, msg) {\n    // If strict-sign, verify all\n    // If anonymous (no-sign), ensure no preven\n    switch (signaturePolicy) {\n        case StrictNoSign:\n            if (msg.signature != null)\n                return { valid: false, error: ValidateError.SignaturePresent };\n            if (msg.seqno != null)\n                return { valid: false, error: ValidateError.SeqnoPresent };\n            if (msg.key != null)\n                return { valid: false, error: ValidateError.FromPresent };\n            return { valid: true, message: { type: 'unsigned', topic: msg.topic, data: msg.data ?? new Uint8Array(0) } };\n        case StrictSign: {\n            // Verify seqno\n            if (msg.seqno == null)\n                return { valid: false, error: ValidateError.InvalidSeqno };\n            if (msg.seqno.length !== 8) {\n                return { valid: false, error: ValidateError.InvalidSeqno };\n            }\n            if (msg.signature == null)\n                return { valid: false, error: ValidateError.InvalidSignature };\n            if (msg.from == null)\n                return { valid: false, error: ValidateError.InvalidPeerId };\n            let fromPeerId;\n            try {\n                // TODO: Fix PeerId types\n                fromPeerId = peerIdFromBytes(msg.from);\n            }\n            catch (e) {\n                return { valid: false, error: ValidateError.InvalidPeerId };\n            }\n            // - check from defined\n            // - transform source to PeerId\n            // - parse signature\n            // - get .key, else from source\n            // - check key == source if present\n            // - verify sig\n            let publicKey;\n            if (msg.key) {\n                publicKey = unmarshalPublicKey(msg.key);\n                // TODO: Should `fromPeerId.pubKey` be optional?\n                if (fromPeerId.publicKey !== undefined && !uint8ArrayEquals(publicKey.bytes, fromPeerId.publicKey)) {\n                    return { valid: false, error: ValidateError.InvalidPeerId };\n                }\n            }\n            else {\n                if (fromPeerId.publicKey == null) {\n                    return { valid: false, error: ValidateError.InvalidPeerId };\n                }\n                publicKey = unmarshalPublicKey(fromPeerId.publicKey);\n            }\n            const rpcMsgPreSign = {\n                from: msg.from,\n                data: msg.data,\n                seqno: msg.seqno,\n                topic: msg.topic,\n                signature: undefined,\n                key: undefined // Exclude key field for signing\n            };\n            // Get the message in bytes, and prepend with the pubsub prefix\n            // the signature is over the bytes \"libp2p-pubsub:<protobuf-message>\"\n            const bytes = uint8ArrayConcat([SignPrefix, RPC.Message.encode(rpcMsgPreSign).finish()]);\n            if (!(await publicKey.verify(bytes, msg.signature))) {\n                return { valid: false, error: ValidateError.InvalidSignature };\n            }\n            return {\n                valid: true,\n                message: {\n                    type: 'signed',\n                    from: fromPeerId,\n                    data: msg.data ?? new Uint8Array(0),\n                    sequenceNumber: BigInt(`0x${uint8ArrayToString(msg.seqno, 'base16')}`),\n                    topic: msg.topic,\n                    signature: msg.signature,\n                    key: msg.key ?? marshalPublicKey(publicKey)\n                }\n            };\n        }\n    }\n}\n//# sourceMappingURL=buildRawMessage.js.map","import { sha256 } from 'multiformats/hashes/sha2';\nimport { msgId } from '@libp2p/pubsub/utils';\n/**\n * Generate a message id, based on the `key` and `seqno`\n */\nexport function msgIdFnStrictSign(msg) {\n    if (msg.type !== 'signed') {\n        throw new Error('expected signed message type');\n    }\n    // Should never happen\n    if (msg.sequenceNumber == null)\n        throw Error('missing seqno field');\n    // TODO: Should use .from here or key?\n    return msgId(msg.from.toBytes(), msg.sequenceNumber);\n}\n/**\n * Generate a message id, based on message `data`\n */\nexport async function msgIdFnStrictNoSign(msg) {\n    return await sha256.encode(msg.data);\n}\n//# sourceMappingURL=msgIdFn.js.map","import { randomBytes } from '@libp2p/crypto';\nimport { CodeError } from '@libp2p/interface/errors';\nimport { peerIdFromBytes, peerIdFromKeys } from '@libp2p/peer-id';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { codes } from './errors.js';\n/**\n * Generate a random sequence number\n */\nexport function randomSeqno() {\n    return BigInt(`0x${uint8ArrayToString(randomBytes(8), 'base16')}`);\n}\n/**\n * Generate a message id, based on the `key` and `seqno`\n */\nexport const msgId = (key, seqno) => {\n    const seqnoBytes = uint8ArrayFromString(seqno.toString(16).padStart(16, '0'), 'base16');\n    const msgId = new Uint8Array(key.length + seqnoBytes.length);\n    msgId.set(key, 0);\n    msgId.set(seqnoBytes, key.length);\n    return msgId;\n};\n/**\n * Generate a message id, based on message `data`\n */\nexport const noSignMsgId = (data) => {\n    return sha256.encode(data);\n};\n/**\n * Check if any member of the first set is also a member\n * of the second set\n */\nexport const anyMatch = (a, b) => {\n    let bHas;\n    if (Array.isArray(b)) {\n        bHas = (val) => b.includes(val);\n    }\n    else {\n        bHas = (val) => b.has(val);\n    }\n    for (const val of a) {\n        if (bHas(val)) {\n            return true;\n        }\n    }\n    return false;\n};\n/**\n * Make everything an array\n */\nexport const ensureArray = function (maybeArray) {\n    if (!Array.isArray(maybeArray)) {\n        return [maybeArray];\n    }\n    return maybeArray;\n};\nconst isSigned = async (message) => {\n    if ((message.sequenceNumber == null) || (message.from == null) || (message.signature == null)) {\n        return false;\n    }\n    // if a public key is present in the `from` field, the message should be signed\n    const fromID = peerIdFromBytes(message.from);\n    if (fromID.publicKey != null) {\n        return true;\n    }\n    if (message.key != null) {\n        const signingID = await peerIdFromKeys(message.key);\n        return signingID.equals(fromID);\n    }\n    return false;\n};\nexport const toMessage = async (message) => {\n    if (message.from == null) {\n        throw new CodeError('RPC message was missing from', codes.ERR_MISSING_FROM);\n    }\n    if (!await isSigned(message)) {\n        return {\n            type: 'unsigned',\n            topic: message.topic ?? '',\n            data: message.data ?? new Uint8Array(0)\n        };\n    }\n    const from = peerIdFromBytes(message.from);\n    const msg = {\n        type: 'signed',\n        from: peerIdFromBytes(message.from),\n        topic: message.topic ?? '',\n        sequenceNumber: bigIntFromBytes(message.sequenceNumber ?? new Uint8Array(0)),\n        data: message.data ?? new Uint8Array(0),\n        signature: message.signature ?? new Uint8Array(0),\n        key: message.key ?? from.publicKey ?? new Uint8Array(0)\n    };\n    if (msg.key.length === 0) {\n        throw new CodeError('Signed RPC message was missing key', codes.ERR_MISSING_KEY);\n    }\n    return msg;\n};\nexport const toRpcMessage = (message) => {\n    if (message.type === 'signed') {\n        return {\n            from: message.from.multihash.bytes,\n            data: message.data,\n            sequenceNumber: bigIntToBytes(message.sequenceNumber),\n            topic: message.topic,\n            signature: message.signature,\n            key: message.key\n        };\n    }\n    return {\n        data: message.data,\n        topic: message.topic\n    };\n};\nexport const bigIntToBytes = (num) => {\n    let str = num.toString(16);\n    if (str.length % 2 !== 0) {\n        str = `0${str}`;\n    }\n    return uint8ArrayFromString(str, 'base16');\n};\nexport const bigIntFromBytes = (num) => {\n    return BigInt(`0x${uint8ArrayToString(num, 'base16')}`);\n};\n//# sourceMappingURL=utils.js.map","export function computeScoreWeights(peer, pstats, params, peerIPs, topicStrToLabel) {\n    let score = 0;\n    const byTopic = new Map();\n    // topic stores\n    Object.entries(pstats.topics).forEach(([topic, tstats]) => {\n        // the topic parameters\n        // Aggregate by known topicLabel or throw to 'unknown'. This prevent too high cardinality\n        const topicLabel = topicStrToLabel.get(topic) ?? 'unknown';\n        const topicParams = params.topics[topic];\n        if (topicParams === undefined) {\n            // we are not scoring this topic\n            return;\n        }\n        let topicScores = byTopic.get(topicLabel);\n        if (!topicScores) {\n            topicScores = {\n                p1w: 0,\n                p2w: 0,\n                p3w: 0,\n                p3bw: 0,\n                p4w: 0\n            };\n            byTopic.set(topicLabel, topicScores);\n        }\n        let p1w = 0;\n        let p2w = 0;\n        let p3w = 0;\n        let p3bw = 0;\n        let p4w = 0;\n        // P1: time in Mesh\n        if (tstats.inMesh) {\n            const p1 = Math.max(tstats.meshTime / topicParams.timeInMeshQuantum, topicParams.timeInMeshCap);\n            p1w += p1 * topicParams.timeInMeshWeight;\n        }\n        // P2: first message deliveries\n        let p2 = tstats.firstMessageDeliveries;\n        if (p2 > topicParams.firstMessageDeliveriesCap) {\n            p2 = topicParams.firstMessageDeliveriesCap;\n        }\n        p2w += p2 * topicParams.firstMessageDeliveriesWeight;\n        // P3: mesh message deliveries\n        if (tstats.meshMessageDeliveriesActive &&\n            tstats.meshMessageDeliveries < topicParams.meshMessageDeliveriesThreshold) {\n            const deficit = topicParams.meshMessageDeliveriesThreshold - tstats.meshMessageDeliveries;\n            const p3 = deficit * deficit;\n            p3w += p3 * topicParams.meshMessageDeliveriesWeight;\n        }\n        // P3b:\n        // NOTE: the weight of P3b is negative (validated in validateTopicScoreParams) so this detracts\n        const p3b = tstats.meshFailurePenalty;\n        p3bw += p3b * topicParams.meshFailurePenaltyWeight;\n        // P4: invalid messages\n        // NOTE: the weight of P4 is negative (validated in validateTopicScoreParams) so this detracts\n        const p4 = tstats.invalidMessageDeliveries * tstats.invalidMessageDeliveries;\n        p4w += p4 * topicParams.invalidMessageDeliveriesWeight;\n        // update score, mixing with topic weight\n        score += (p1w + p2w + p3w + p3bw + p4w) * topicParams.topicWeight;\n        topicScores.p1w += p1w;\n        topicScores.p2w += p2w;\n        topicScores.p3w += p3w;\n        topicScores.p3bw += p3bw;\n        topicScores.p4w += p4w;\n    });\n    // apply the topic score cap, if any\n    if (params.topicScoreCap > 0 && score > params.topicScoreCap) {\n        score = params.topicScoreCap;\n        // Proportionally apply cap to all individual contributions\n        const capF = params.topicScoreCap / score;\n        for (const ws of byTopic.values()) {\n            ws.p1w *= capF;\n            ws.p2w *= capF;\n            ws.p3w *= capF;\n            ws.p3bw *= capF;\n            ws.p4w *= capF;\n        }\n    }\n    let p5w = 0;\n    let p6w = 0;\n    let p7w = 0;\n    // P5: application-specific score\n    const p5 = params.appSpecificScore(peer);\n    p5w += p5 * params.appSpecificWeight;\n    // P6: IP colocation factor\n    pstats.knownIPs.forEach((ip) => {\n        if (params.IPColocationFactorWhitelist.has(ip)) {\n            return;\n        }\n        // P6 has a cliff (IPColocationFactorThreshold)\n        // It's only applied if at least that many peers are connected to us from that source IP addr.\n        // It is quadratic, and the weight is negative (validated in validatePeerScoreParams)\n        const peersInIP = peerIPs.get(ip);\n        const numPeersInIP = peersInIP ? peersInIP.size : 0;\n        if (numPeersInIP > params.IPColocationFactorThreshold) {\n            const surplus = numPeersInIP - params.IPColocationFactorThreshold;\n            const p6 = surplus * surplus;\n            p6w += p6 * params.IPColocationFactorWeight;\n        }\n    });\n    // P7: behavioural pattern penalty\n    const p7 = pstats.behaviourPenalty * pstats.behaviourPenalty;\n    p7w += p7 * params.behaviourPenaltyWeight;\n    score += p5w + p6w + p7w;\n    return {\n        byTopic,\n        p5w,\n        p6w,\n        p7w,\n        score\n    };\n}\nexport function computeAllPeersScoreWeights(peerIdStrs, peerStats, params, peerIPs, topicStrToLabel) {\n    const sw = {\n        byTopic: new Map(),\n        p5w: [],\n        p6w: [],\n        p7w: [],\n        score: []\n    };\n    for (const peerIdStr of peerIdStrs) {\n        const pstats = peerStats.get(peerIdStr);\n        if (pstats) {\n            const swPeer = computeScoreWeights(peerIdStr, pstats, params, peerIPs, topicStrToLabel);\n            for (const [topic, swPeerTopic] of swPeer.byTopic) {\n                let swTopic = sw.byTopic.get(topic);\n                if (!swTopic) {\n                    swTopic = {\n                        p1w: [],\n                        p2w: [],\n                        p3w: [],\n                        p3bw: [],\n                        p4w: []\n                    };\n                    sw.byTopic.set(topic, swTopic);\n                }\n                swTopic.p1w.push(swPeerTopic.p1w);\n                swTopic.p2w.push(swPeerTopic.p2w);\n                swTopic.p3w.push(swPeerTopic.p3w);\n                swTopic.p3bw.push(swPeerTopic.p3bw);\n                swTopic.p4w.push(swPeerTopic.p4w);\n            }\n            sw.p5w.push(swPeer.p5w);\n            sw.p6w.push(swPeer.p6w);\n            sw.p7w.push(swPeer.p7w);\n            sw.score.push(swPeer.score);\n        }\n        else {\n            sw.p5w.push(0);\n            sw.p6w.push(0);\n            sw.p7w.push(0);\n            sw.score.push(0);\n        }\n    }\n    return sw;\n}\n//# sourceMappingURL=scoreMetrics.js.map","// ported from https://www.npmjs.com/package/fast-fifo\nclass FixedFIFO {\n    buffer;\n    mask;\n    top;\n    btm;\n    next;\n    constructor(hwm) {\n        if (!(hwm > 0) || ((hwm - 1) & hwm) !== 0) {\n            throw new Error('Max size for a FixedFIFO should be a power of two');\n        }\n        this.buffer = new Array(hwm);\n        this.mask = hwm - 1;\n        this.top = 0;\n        this.btm = 0;\n        this.next = null;\n    }\n    push(data) {\n        if (this.buffer[this.top] !== undefined) {\n            return false;\n        }\n        this.buffer[this.top] = data;\n        this.top = (this.top + 1) & this.mask;\n        return true;\n    }\n    shift() {\n        const last = this.buffer[this.btm];\n        if (last === undefined) {\n            return undefined;\n        }\n        this.buffer[this.btm] = undefined;\n        this.btm = (this.btm + 1) & this.mask;\n        return last;\n    }\n    isEmpty() {\n        return this.buffer[this.btm] === undefined;\n    }\n}\nexport class FIFO {\n    size;\n    hwm;\n    head;\n    tail;\n    constructor(options = {}) {\n        this.hwm = options.splitLimit ?? 16;\n        this.head = new FixedFIFO(this.hwm);\n        this.tail = this.head;\n        this.size = 0;\n    }\n    calculateSize(obj) {\n        if (obj?.byteLength != null) {\n            return obj.byteLength;\n        }\n        return 1;\n    }\n    push(val) {\n        if (val?.value != null) {\n            this.size += this.calculateSize(val.value);\n        }\n        if (!this.head.push(val)) {\n            const prev = this.head;\n            this.head = prev.next = new FixedFIFO(2 * this.head.buffer.length);\n            this.head.push(val);\n        }\n    }\n    shift() {\n        let val = this.tail.shift();\n        if (val === undefined && (this.tail.next != null)) {\n            const next = this.tail.next;\n            this.tail.next = null;\n            this.tail = next;\n            val = this.tail.shift();\n        }\n        if (val?.value != null) {\n            this.size -= this.calculateSize(val.value);\n        }\n        return val;\n    }\n    isEmpty() {\n        return this.head.isEmpty();\n    }\n}\n//# sourceMappingURL=fifo.js.map","/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\nimport deferred from 'p-defer';\nimport { FIFO } from './fifo.js';\nexport class AbortError extends Error {\n    type;\n    code;\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\nexport function pushable(options = {}) {\n    const getNext = (buffer) => {\n        const next = buffer.shift();\n        if (next == null) {\n            return { done: true };\n        }\n        if (next.error != null) {\n            throw next.error;\n        }\n        return {\n            done: next.done === true,\n            // @ts-expect-error if done is false, value will be present\n            value: next.value\n        };\n    };\n    return _pushable(getNext, options);\n}\nexport function pushableV(options = {}) {\n    const getNext = (buffer) => {\n        let next;\n        const values = [];\n        while (!buffer.isEmpty()) {\n            next = buffer.shift();\n            if (next == null) {\n                break;\n            }\n            if (next.error != null) {\n                throw next.error;\n            }\n            if (next.done === false) {\n                // @ts-expect-error if done is false value should be pushed\n                values.push(next.value);\n            }\n        }\n        if (next == null) {\n            return { done: true };\n        }\n        return {\n            done: next.done === true,\n            value: values\n        };\n    };\n    return _pushable(getNext, options);\n}\nfunction _pushable(getNext, options) {\n    options = options ?? {};\n    let onEnd = options.onEnd;\n    let buffer = new FIFO();\n    let pushable;\n    let onNext;\n    let ended;\n    let drain = deferred();\n    const waitNext = async () => {\n        try {\n            if (!buffer.isEmpty()) {\n                return getNext(buffer);\n            }\n            if (ended) {\n                return { done: true };\n            }\n            return await new Promise((resolve, reject) => {\n                onNext = (next) => {\n                    onNext = null;\n                    buffer.push(next);\n                    try {\n                        resolve(getNext(buffer));\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                    return pushable;\n                };\n            });\n        }\n        finally {\n            if (buffer.isEmpty()) {\n                // settle promise in the microtask queue to give consumers a chance to\n                // await after calling .push\n                queueMicrotask(() => {\n                    drain.resolve();\n                    drain = deferred();\n                });\n            }\n        }\n    };\n    const bufferNext = (next) => {\n        if (onNext != null) {\n            return onNext(next);\n        }\n        buffer.push(next);\n        return pushable;\n    };\n    const bufferError = (err) => {\n        buffer = new FIFO();\n        if (onNext != null) {\n            return onNext({ error: err });\n        }\n        buffer.push({ error: err });\n        return pushable;\n    };\n    const push = (value) => {\n        if (ended) {\n            return pushable;\n        }\n        // @ts-expect-error `byteLength` is not declared on PushType\n        if (options?.objectMode !== true && value?.byteLength == null) {\n            throw new Error('objectMode was not true but tried to push non-Uint8Array value');\n        }\n        return bufferNext({ done: false, value });\n    };\n    const end = (err) => {\n        if (ended)\n            return pushable;\n        ended = true;\n        return (err != null) ? bufferError(err) : bufferNext({ done: true });\n    };\n    const _return = () => {\n        buffer = new FIFO();\n        end();\n        return { done: true };\n    };\n    const _throw = (err) => {\n        end(err);\n        return { done: true };\n    };\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next: waitNext,\n        return: _return,\n        throw: _throw,\n        push,\n        end,\n        get readableLength() {\n            return buffer.size;\n        },\n        onEmpty: async (options) => {\n            const signal = options?.signal;\n            signal?.throwIfAborted();\n            if (buffer.isEmpty()) {\n                return;\n            }\n            let cancel;\n            let listener;\n            if (signal != null) {\n                cancel = new Promise((resolve, reject) => {\n                    listener = () => {\n                        reject(new AbortError());\n                    };\n                    signal.addEventListener('abort', listener);\n                });\n            }\n            try {\n                await Promise.race([\n                    drain.promise,\n                    cancel\n                ]);\n            }\n            finally {\n                if (listener != null && signal != null) {\n                    signal?.removeEventListener('abort', listener);\n                }\n            }\n        }\n    };\n    if (onEnd == null) {\n        return pushable;\n    }\n    const _pushable = pushable;\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next() {\n            return _pushable.next();\n        },\n        throw(err) {\n            _pushable.throw(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        return() {\n            _pushable.return();\n            if (onEnd != null) {\n                onEnd();\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        push,\n        end(err) {\n            _pushable.end(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return pushable;\n        },\n        get readableLength() {\n            return _pushable.readableLength;\n        }\n    };\n    return pushable;\n}\n//# sourceMappingURL=index.js.map","export class AbortError extends Error {\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\n//# sourceMappingURL=abort-error.js.map","/**\n * @packageDocumentation\n *\n * @example\n *\n * ```js\n * import { abortableSource } from 'abortable-iterator'\n *\n * async function main () {\n *   // An example function that creates an async iterator that yields an increasing\n *   // number every x milliseconds and NEVER ENDS!\n *   const asyncCounter = async function * (start, delay) {\n *     let i = start\n *     while (true) {\n *       yield new Promise(resolve => setTimeout(() => resolve(i++), delay))\n *     }\n *   }\n *\n *   // Create a counter that'll yield numbers from 0 upwards every second\n *   const everySecond = asyncCounter(0, 1000)\n *\n *   // Make everySecond abortable!\n *   const controller = new AbortController()\n *   const abortableEverySecond = abortableSource(everySecond, controller.signal)\n *\n *   // Abort after 5 seconds\n *   setTimeout(() => controller.abort(), 5000)\n *\n *   try {\n *     // Start the iteration, which will throw after 5 seconds when it is aborted\n *     for await (const n of abortableEverySecond) {\n *       console.log(n)\n *     }\n *   } catch (err) {\n *     if (err.code === 'ERR_ABORTED') {\n *       // Expected - all ok :D\n *     } else {\n *       throw err\n *     }\n *   }\n * }\n *\n * main()\n * ```\n */\nimport { AbortError } from './abort-error.js';\nimport { getIterator } from 'get-iterator';\n/**\n * Wrap an iterator to make it abortable, allow cleanup when aborted via onAbort\n */\nexport function abortableSource(source, signal, options) {\n    const opts = options ?? {};\n    const iterator = getIterator(source);\n    async function* abortable() {\n        let nextAbortHandler;\n        const abortHandler = () => {\n            if (nextAbortHandler != null)\n                nextAbortHandler();\n        };\n        signal.addEventListener('abort', abortHandler);\n        while (true) {\n            let result;\n            try {\n                if (signal.aborted) {\n                    const { abortMessage, abortCode } = opts;\n                    throw new AbortError(abortMessage, abortCode);\n                }\n                const abort = new Promise((resolve, reject) => {\n                    nextAbortHandler = () => {\n                        const { abortMessage, abortCode } = opts;\n                        reject(new AbortError(abortMessage, abortCode));\n                    };\n                });\n                // Race the iterator and the abort signals\n                result = await Promise.race([abort, iterator.next()]);\n                nextAbortHandler = null;\n            }\n            catch (err) {\n                signal.removeEventListener('abort', abortHandler);\n                // Might not have been aborted by a known signal\n                const isKnownAborter = err.type === 'aborted' && signal.aborted;\n                if (isKnownAborter && (opts.onAbort != null)) {\n                    // Do any custom abort handling for the iterator\n                    opts.onAbort(source);\n                }\n                // End the iterator if it is a generator\n                if (typeof iterator.return === 'function') {\n                    try {\n                        const p = iterator.return();\n                        if (p instanceof Promise) { // eslint-disable-line max-depth\n                            p.catch(err => {\n                                if (opts.onReturnError != null) {\n                                    opts.onReturnError(err);\n                                }\n                            });\n                        }\n                    }\n                    catch (err) {\n                        if (opts.onReturnError != null) { // eslint-disable-line max-depth\n                            opts.onReturnError(err);\n                        }\n                    }\n                }\n                if (isKnownAborter && opts.returnOnAbort === true) {\n                    return;\n                }\n                throw err;\n            }\n            if (result.done === true) {\n                break;\n            }\n            yield result.value;\n        }\n        signal.removeEventListener('abort', abortHandler);\n    }\n    return abortable();\n}\nexport function abortableSink(sink, signal, options) {\n    return (source) => sink(abortableSource(source, signal, options));\n}\nexport function abortableDuplex(duplex, signal, options) {\n    return {\n        sink: abortableSink(duplex.sink, signal, {\n            ...options,\n            onAbort: undefined\n        }),\n        source: abortableSource(duplex.source, signal, options)\n    };\n}\nexport { AbortError };\nexport { abortableSink as abortableTransform };\n//# sourceMappingURL=index.js.map","export function getIterator(obj) {\n    if (obj != null) {\n        if (typeof obj[Symbol.iterator] === 'function') {\n            return obj[Symbol.iterator]();\n        }\n        if (typeof obj[Symbol.asyncIterator] === 'function') {\n            return obj[Symbol.asyncIterator]();\n        }\n        if (typeof obj.next === 'function') {\n            return obj; // probably an iterator\n        }\n    }\n    throw new Error('argument is not an iterator or iterable');\n}\n//# sourceMappingURL=index.js.map","import { abortableSource } from 'abortable-iterator';\nimport { pipe } from 'it-pipe';\nimport { pushable } from 'it-pushable';\nimport { encode, decode } from 'it-length-prefixed';\nexport class OutboundStream {\n    rawStream;\n    pushable;\n    closeController;\n    maxBufferSize;\n    constructor(rawStream, errCallback, opts) {\n        this.rawStream = rawStream;\n        this.pushable = pushable({ objectMode: false });\n        this.closeController = new AbortController();\n        this.maxBufferSize = opts.maxBufferSize ?? Infinity;\n        pipe(abortableSource(this.pushable, this.closeController.signal, { returnOnAbort: true }), (source) => encode(source), this.rawStream).catch(errCallback);\n    }\n    get protocol() {\n        // TODO remove this non-nullish assertion after https://github.com/libp2p/js-libp2p-interfaces/pull/265 is incorporated\n        return this.rawStream.protocol;\n    }\n    push(data) {\n        if (this.pushable.readableLength > this.maxBufferSize) {\n            throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);\n        }\n        this.pushable.push(data);\n    }\n    close() {\n        this.closeController.abort();\n        // similar to pushable.end() but clear the internal buffer\n        this.pushable.return();\n        this.rawStream.close();\n    }\n}\nexport class InboundStream {\n    source;\n    rawStream;\n    closeController;\n    constructor(rawStream, opts = {}) {\n        this.rawStream = rawStream;\n        this.closeController = new AbortController();\n        this.source = abortableSource(pipe(this.rawStream, (source) => decode(source, opts)), this.closeController.signal, {\n            returnOnAbort: true\n        });\n    }\n    close() {\n        this.closeController.abort();\n        this.rawStream.close();\n    }\n}\n//# sourceMappingURL=stream.js.map","import protobuf from 'protobufjs/minimal.js';\nexport const defaultDecodeRpcLimits = {\n    maxSubscriptions: Infinity,\n    maxMessages: Infinity,\n    maxIhaveMessageIDs: Infinity,\n    maxIwantMessageIDs: Infinity,\n    maxControlMessages: Infinity,\n    maxPeerInfos: Infinity\n};\n/**\n * Copied code from src/message/rpc.cjs but with decode limits to prevent OOM attacks\n */\nexport function decodeRpc(bytes, opts) {\n    // Mutate to use the option as stateful counter. Must limit the total count of messageIDs across all IWANT, IHAVE\n    // else one count put 100 messageIDs into each 100 IWANT and \"get around\" the limit\n    opts = { ...opts };\n    const r = protobuf.Reader.create(bytes);\n    const l = bytes.length;\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                if (!(m.subscriptions && m.subscriptions.length))\n                    m.subscriptions = [];\n                if (m.subscriptions.length < opts.maxSubscriptions)\n                    m.subscriptions.push(decodeSubOpts(r, r.uint32()));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 2:\n                if (!(m.messages && m.messages.length))\n                    m.messages = [];\n                if (m.messages.length < opts.maxMessages)\n                    m.messages.push(decodeMessage(r, r.uint32()));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 3:\n                m.control = decodeControlMessage(r, r.uint32(), opts);\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeSubOpts(r, l) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.subscribe = r.bool();\n                break;\n            case 2:\n                m.topic = r.string();\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeMessage(r, l) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.from = r.bytes();\n                break;\n            case 2:\n                m.data = r.bytes();\n                break;\n            case 3:\n                m.seqno = r.bytes();\n                break;\n            case 4:\n                m.topic = r.string();\n                break;\n            case 5:\n                m.signature = r.bytes();\n                break;\n            case 6:\n                m.key = r.bytes();\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    if (!m.topic)\n        throw Error(\"missing required 'topic'\");\n    return m;\n}\nfunction decodeControlMessage(r, l, opts) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                if (!(m.ihave && m.ihave.length))\n                    m.ihave = [];\n                if (m.ihave.length < opts.maxControlMessages)\n                    m.ihave.push(decodeControlIHave(r, r.uint32(), opts));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 2:\n                if (!(m.iwant && m.iwant.length))\n                    m.iwant = [];\n                if (m.iwant.length < opts.maxControlMessages)\n                    m.iwant.push(decodeControlIWant(r, r.uint32(), opts));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 3:\n                if (!(m.graft && m.graft.length))\n                    m.graft = [];\n                if (m.graft.length < opts.maxControlMessages)\n                    m.graft.push(decodeControlGraft(r, r.uint32()));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 4:\n                if (!(m.prune && m.prune.length))\n                    m.prune = [];\n                if (m.prune.length < opts.maxControlMessages)\n                    m.prune.push(decodeControlPrune(r, r.uint32(), opts));\n                else\n                    r.skipType(t & 7);\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeControlIHave(r, l, opts) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.topicID = r.string();\n                break;\n            case 2:\n                if (!(m.messageIDs && m.messageIDs.length))\n                    m.messageIDs = [];\n                if (opts.maxIhaveMessageIDs-- > 0)\n                    m.messageIDs.push(r.bytes());\n                else\n                    r.skipType(t & 7);\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeControlIWant(r, l, opts) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                if (!(m.messageIDs && m.messageIDs.length))\n                    m.messageIDs = [];\n                if (opts.maxIwantMessageIDs-- > 0)\n                    m.messageIDs.push(r.bytes());\n                else\n                    r.skipType(t & 7);\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeControlGraft(r, l) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.topicID = r.string();\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodeControlPrune(r, l, opts) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.topicID = r.string();\n                break;\n            case 2:\n                if (!(m.peers && m.peers.length))\n                    m.peers = [];\n                if (opts.maxPeerInfos-- > 0)\n                    m.peers.push(decodePeerInfo(r, r.uint32()));\n                else\n                    r.skipType(t & 7);\n                break;\n            case 3:\n                m.backoff = r.uint64();\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\nfunction decodePeerInfo(r, l) {\n    const c = l === undefined ? r.len : r.pos + l;\n    const m = {};\n    while (r.pos < c) {\n        const t = r.uint32();\n        switch (t >>> 3) {\n            case 1:\n                m.peerID = r.bytes();\n                break;\n            case 2:\n                m.signedPeerRecord = r.bytes();\n                break;\n            default:\n                r.skipType(t & 7);\n                break;\n        }\n    }\n    return m;\n}\n//# sourceMappingURL=decodeRpc.js.map","// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n","const empty = new Uint8Array(0)\n\n/**\n * @param {Uint8Array} d\n */\nconst toHex = d => d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n\n/**\n * @param {string} hex\n */\nconst fromHex = hex => {\n  const hexes = hex.match(/../g)\n  return hexes ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\n/**\n * @param {Uint8Array} aa\n * @param {Uint8Array} bb\n */\nconst equals = (aa, bb) => {\n  if (aa === bb) return true\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * @param {ArrayBufferView|ArrayBuffer|Uint8Array} o\n * @returns {Uint8Array}\n */\nconst coerce = o => {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') return o\n  if (o instanceof ArrayBuffer) return new Uint8Array(o)\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\n/**\n * @param {any} o\n * @returns {o is ArrayBuffer|ArrayBufferView}\n */\nconst isBinary = o =>\n  o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nconst fromString = str => (new TextEncoder()).encode(str)\n\n/**\n * @param {Uint8Array} b\n * @returns {string}\n */\nconst toString = b => (new TextDecoder()).decode(b)\n\nexport { equals, coerce, isBinary, fromHex, toHex, fromString, toString, empty }\n","import basex from '../../vendor/base-x.js'\nimport { coerce } from '../bytes.js'\n// Linter can't see that API is used in types.\n// eslint-disable-next-line\nimport * as API from './interface.js'\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.BaseEncoder}\n */\nclass Encoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   */\n  constructor (name, prefix, baseEncode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  /**\n   * @param {Uint8Array} bytes\n   * @returns {API.Multibase<Prefix>}\n   */\n  encode (bytes) {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * @template {string} Prefix\n */\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n *\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.UnibaseDecoder<Prefix>}\n * @implements {API.BaseDecoder}\n */\nclass Decoder {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    /* c8 ignore next 3 */\n    if (prefix.codePointAt(0) === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    /** @private */\n    this.prefixCodePoint = /** @type {number} */ (prefix.codePointAt(0))\n    this.baseDecode = baseDecode\n  }\n\n  /**\n   * @param {string} text\n   */\n  decode (text) {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n}\n\n/**\n * @template {string} Prefix\n * @typedef {Record<Prefix, API.UnibaseDecoder<Prefix>>} Decoders\n */\n\n/**\n * @template {string} Prefix\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.CombobaseDecoder<Prefix>}\n */\nclass ComposedDecoder {\n  /**\n   * @param {Decoders<Prefix>} decoders\n   */\n  constructor (decoders) {\n    this.decoders = decoders\n  }\n\n  /**\n   * @template {string} OtherPrefix\n   * @param {API.UnibaseDecoder<OtherPrefix>|ComposedDecoder<OtherPrefix>} decoder\n   * @returns {ComposedDecoder<Prefix|OtherPrefix>}\n   */\n  or (decoder) {\n    return or(this, decoder)\n  }\n\n  /**\n   * @param {string} input\n   * @returns {Uint8Array}\n   */\n  decode (input) {\n    const prefix = /** @type {Prefix} */ (input[0])\n    const decoder = this.decoders[prefix]\n    if (decoder) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\n/**\n * @template {string} L\n * @template {string} R\n * @param {API.UnibaseDecoder<L>|API.CombobaseDecoder<L>} left\n * @param {API.UnibaseDecoder<R>|API.CombobaseDecoder<R>} right\n * @returns {ComposedDecoder<L|R>}\n */\nexport const or = (left, right) => new ComposedDecoder(/** @type {Decoders<L|R>} */({\n  ...(left.decoders || { [/** @type API.UnibaseDecoder<L> */(left).prefix]: left }),\n  ...(right.decoders || { [/** @type API.UnibaseDecoder<R> */(right).prefix]: right })\n}))\n\n/**\n * @class\n * @template {string} Base\n * @template {string} Prefix\n * @implements {API.MultibaseCodec<Prefix>}\n * @implements {API.MultibaseEncoder<Prefix>}\n * @implements {API.MultibaseDecoder<Prefix>}\n * @implements {API.BaseCodec}\n * @implements {API.BaseEncoder}\n * @implements {API.BaseDecoder}\n */\nexport class Codec {\n  /**\n   * @param {Base} name\n   * @param {Prefix} prefix\n   * @param {(bytes:Uint8Array) => string} baseEncode\n   * @param {(text:string) => Uint8Array} baseDecode\n   */\n  constructor (name, prefix, baseEncode, baseDecode) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  /**\n   * @param {Uint8Array} input\n   */\n  encode (input) {\n    return this.encoder.encode(input)\n  }\n\n  /**\n   * @param {string} input\n   */\n  decode (input) {\n    return this.decoder.decode(input)\n  }\n}\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {(bytes:Uint8Array) => string} options.encode\n * @param {(input:string) => Uint8Array} options.decode\n * @returns {Codec<Base, Prefix>}\n */\nexport const from = ({ name, prefix, encode, decode }) =>\n  new Codec(name, prefix, encode, decode)\n\n/**\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @returns {Codec<Base, Prefix>}\n */\nexport const baseX = ({ prefix, name, alphabet }) => {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    /**\n     * @param {string} text\n     */\n    decode: text => coerce(decode(text))\n  })\n}\n\n/**\n * @param {string} string\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @param {string} name\n * @returns {Uint8Array}\n */\nconst decode = (string, alphabet, bitsPerChar, name) => {\n  // Build the character lookup table:\n  /** @type {Record<string, number>} */\n  const codes = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    codes[alphabet[i]] = i\n  }\n\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = codes[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || 0xff & (buffer << (8 - bits))) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\n/**\n * @param {Uint8Array} data\n * @param {string} alphabet\n * @param {number} bitsPerChar\n * @returns {string}\n */\nconst encode = (data, alphabet, bitsPerChar) => {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while ((out.length * bitsPerChar) & 7) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\n/**\n * RFC4648 Factory\n *\n * @template {string} Base\n * @template {string} Prefix\n * @param {object} options\n * @param {Base} options.name\n * @param {Prefix} options.prefix\n * @param {string} options.alphabet\n * @param {number} options.bitsPerChar\n */\nexport const rfc4648 = ({ name, prefix, bitsPerChar, alphabet }) => {\n  return from({\n    prefix,\n    name,\n    encode (input) {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input) {\n      return decode(input, alphabet, bitsPerChar, name)\n    }\n  })\n}\n","// @ts-check\n\nimport { from } from './base.js'\nimport { fromString, toString } from '../bytes.js'\n\nexport const identity = from({\n  prefix: '\\x00',\n  name: 'identity',\n  encode: (buf) => toString(buf),\n  decode: (str) => fromString(str)\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n})\n","import { baseX } from './base.js'\n\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n})\n\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n})\n","import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n","import { baseX } from './base.js'\n\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n})\n\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n})\n","import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n","import { from } from './base.js'\n\nconst alphabet = Array.from('🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂')\nconst alphabetBytesToChars = /** @type {string[]} */ (alphabet.reduce((p, c, i) => { p[i] = c; return p }, /** @type {string[]} */([])))\nconst alphabetCharsToBytes = /** @type {number[]} */ (alphabet.reduce((p, c, i) => { p[/** @type {number} */ (c.codePointAt(0))] = i; return p }, /** @type {number[]} */([])))\n\n/**\n * @param {Uint8Array} data\n * @returns {string}\n */\nfunction encode (data) {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c]\n    return p\n  }, '')\n}\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction decode (str) {\n  const byts = []\n  for (const char of str) {\n    const byt = alphabetCharsToBytes[/** @type {number} */ (char.codePointAt(0))]\n    if (byt === undefined) {\n      throw new Error(`Non-base256emoji character: ${char}`)\n    }\n    byts.push(byt)\n  }\n  return new Uint8Array(byts)\n}\n\nexport const base256emoji = from({\n  prefix: '🚀',\n  name: 'base256emoji',\n  encode,\n  decode\n})\n","var encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n","import varint from '../vendor/varint.js'\n\n/**\n * @param {Uint8Array} data\n * @param {number} [offset=0]\n * @returns {[number, number]}\n */\nexport const decode = (data, offset = 0) => {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\n/**\n * @param {number} int\n * @param {Uint8Array} target\n * @param {number} [offset=0]\n */\nexport const encodeTo = (int, target, offset = 0) => {\n  varint.encode(int, target, offset)\n  return target\n}\n\n/**\n * @param {number} int\n * @returns {number}\n */\nexport const encodingLength = (int) => {\n  return varint.encodingLength(int)\n}\n","import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\n\n/**\n * Creates a multihash digest.\n *\n * @template {number} Code\n * @param {Code} code\n * @param {Uint8Array} digest\n */\nexport const create = (code, digest) => {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n *\n * @param {Uint8Array} multihash\n * @returns {MultihashDigest}\n */\nexport const decode = (multihash) => {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * @param {MultihashDigest} a\n * @param {unknown} b\n * @returns {b is MultihashDigest}\n */\nexport const equals = (a, b) => {\n  if (a === b) {\n    return true\n  } else {\n    const data = /** @type {{code?:unknown, size?:unknown, bytes?:unknown}} */(b)\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * @typedef {import('./interface.js').MultihashDigest} MultihashDigest\n */\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n *\n * @template {number} Code\n * @template {number} Size\n * @class\n * @implements {MultihashDigest}\n */\nexport class Digest {\n  /**\n   * Creates a multihash digest.\n   *\n   * @param {Code} code\n   * @param {Size} size\n   * @param {Uint8Array} digest\n   * @param {Uint8Array} bytes\n   */\n  constructor (code, size, digest, bytes) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n","import * as Digest from './digest.js'\n\n/**\n * @template {string} Name\n * @template {number} Code\n * @param {object} options\n * @param {Name} options.name\n * @param {Code} options.code\n * @param {(input: Uint8Array) => Await<Uint8Array>} options.encode\n */\nexport const from = ({ name, code, encode }) => new Hasher(name, code, encode)\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n *\n * @template {string} Name\n * @template {number} Code\n * @class\n * @implements {MultihashHasher<Code>}\n */\nexport class Hasher {\n  /**\n   *\n   * @param {Name} name\n   * @param {Code} code\n   * @param {(input: Uint8Array) => Await<Uint8Array>} encode\n   */\n  constructor (name, code, encode) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  /**\n   * @param {Uint8Array} input\n   * @returns {Await<Digest.Digest<Code, number>>}\n   */\n  digest (input) {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n\n/**\n * @template {number} Alg\n * @typedef {import('./interface.js').MultihashHasher} MultihashHasher\n */\n\n/**\n * @template T\n * @typedef {Promise<T>|T} Await\n */\n","/* global crypto */\n\nimport { from } from './hasher.js'\n\n/**\n * @param {AlgorithmIdentifier} name\n */\nconst sha = name =>\n  /**\n   * @param {Uint8Array} data\n   */\n  async data => new Uint8Array(await crypto.subtle.digest(name, data))\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n","import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code = 0x0\nconst name = 'identity'\n\n/** @type {(input:Uint8Array) => Uint8Array} */\nconst encode = coerce\n\n/**\n * @param {Uint8Array} input\n * @returns {Digest.Digest<typeof code, number>}\n */\nconst digest = (input) => Digest.create(code, encode(input))\n\nexport const identity = { code, name, encode, digest }\n","// @ts-check\n\nimport { coerce } from '../bytes.js'\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nexport const name = 'raw'\nexport const code = 0x55\n\n/**\n * @param {Uint8Array} node\n * @returns {ByteView<Uint8Array>}\n */\nexport const encode = (node) => coerce(node)\n\n/**\n * @param {ByteView<Uint8Array>} data\n * @returns {Uint8Array}\n */\nexport const decode = (data) => coerce(data)\n","// @ts-check\n\n/**\n * @template T\n * @typedef {import('./interface.js').ByteView<T>} ByteView\n */\n\nconst textEncoder = new TextEncoder()\nconst textDecoder = new TextDecoder()\n\nexport const name = 'json'\nexport const code = 0x0200\n\n/**\n * @template T\n * @param {T} node\n * @returns {ByteView<T>}\n */\nexport const encode = (node) => textEncoder.encode(JSON.stringify(node))\n\n/**\n * @template T\n * @param {ByteView<T>} data\n * @returns {T}\n */\nexport const decode = (data) => JSON.parse(textDecoder.decode(data))\n","import * as varint from './varint.js'\nimport * as Digest from './hashes/digest.js'\nimport { base58btc } from './bases/base58.js'\nimport { base32 } from './bases/base32.js'\nimport { coerce } from './bytes.js'\n// Linter can see that API is used in types.\n// eslint-disable-next-line\nimport * as API from \"./link/interface.js\"\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\n/**\n * @template {API.Link<unknown, number, number, API.Version>} T\n * @template {string} Prefix\n * @param {T} link\n * @param {API.MultibaseEncoder<Prefix>} [base]\n * @returns {API.ToString<T, Prefix>}\n */\nexport const format = (link, base) => {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<\"z\">} */ (base) || base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        /** @type {API.MultibaseEncoder<Prefix>} */ (base || base32.encoder)\n      )\n  }\n}\n\n/**\n * @template {API.UnknownLink} Link\n * @param {Link} link\n * @returns {API.LinkJSON<Link>}\n */\nexport const toJSON = (link) => ({\n  '/': format(link)\n})\n\n/**\n * @template {API.UnknownLink} Link\n * @param {API.LinkJSON<Link>} json\n */\nexport const fromJSON = (json) =>\n  CID.parse(json['/'])\n\n/** @type {WeakMap<API.UnknownLink, Map<string, string>>} */\nconst cache = new WeakMap()\n\n/**\n * @param {API.UnknownLink} cid\n * @returns {Map<string, string>}\n */\nconst baseCache = cid => {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\n/**\n * @template {unknown} [Data=unknown]\n * @template {number} [Format=number]\n * @template {number} [Alg=number]\n * @template {API.Version} [Version=API.Version]\n * @implements {API.Link<Data, Format, Alg, Version>}\n */\n\nexport class CID {\n  /**\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} multihash - (Multi)hash of the of the content.\n   * @param {Uint8Array} bytes\n   *\n   */\n  constructor (version, code, multihash, bytes) {\n    /** @readonly */\n    this.code = code\n    /** @readonly */\n    this.version = version\n    /** @readonly */\n    this.multihash = multihash\n    /** @readonly */\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    /** @readonly */\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID () {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset () {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength () {\n    return this.bytes.byteLength\n  }\n\n  /**\n   * @returns {CID<Data, API.DAG_PB, API.SHA_256, 0>}\n   */\n  toV0 () {\n    switch (this.version) {\n      case 0: {\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (this)\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return /** @type {CID<Data, API.DAG_PB, API.SHA_256, 0>} */ (\n          CID.createV0(\n            /** @type {API.MultihashDigest<API.SHA_256>} */ (multihash)\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @returns {CID<Data, Format, Alg, 1>}\n   */\n  toV1 () {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return /** @type {CID<Data, Format, Alg, 1>} */ (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return /** @type {CID<Data, Format, Alg, 1>} */ (this)\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  /**\n   * @param {unknown} other\n   * @returns {other is CID<Data, Format, Alg, Version>}\n   */\n  equals (other) {\n    return CID.equals(this, other)\n  }\n\n  /**\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {API.Link<Data, Format, Alg, Version>} self\n   * @param {unknown} other\n   * @returns {other is CID}\n   */\n  static equals (self, other) {\n    const unknown =\n      /** @type {{code?:unknown, version?:unknown, multihash?:unknown}} */ (\n        other\n      )\n    return (\n      unknown &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  /**\n   * @param {API.MultibaseEncoder<string>} [base]\n   * @returns {string}\n   */\n  toString (base) {\n    return format(this, base)\n  }\n\n  toJSON () {\n    return { '/': format(this) }\n  }\n\n  link () {\n    return this\n  }\n\n  get [Symbol.toStringTag] () {\n    return 'CID'\n  }\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] () {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @template {unknown} U\n   * @param {API.Link<Data, Format, Alg, Version>|U} input\n   * @returns {CID<Data, Format, Alg, Version>|null}\n   */\n  static asCID (input) {\n    if (input == null) {\n      return null\n    }\n\n    const value = /** @type {any} */ (input)\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        /** @type {API.MultihashDigest<Alg>} */ (multihash),\n        bytes || encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest =\n        /** @type {API.MultihashDigest<Alg>} */\n        (Digest.decode(multihash))\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   *\n   * @template {unknown} Data\n   * @template {number} Format\n   * @template {number} Alg\n   * @template {API.Version} Version\n   * @param {Version} version - Version of the CID\n   * @param {Format} code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param {API.MultihashDigest<Alg>} digest - (Multi)hash of the of the content.\n   * @returns {CID<Data, Format, Alg, Version>}\n   */\n  static create (version, code, digest) {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   *\n   * @template {unknown} [T=unknown]\n   * @param {API.MultihashDigest<typeof SHA_256_CODE>} digest - Multihash.\n   * @returns {CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0>}\n   */\n  static createV0 (digest) {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @param {Code} code - Content encoding format code.\n   * @param {API.MultihashDigest<Alg>} digest - Miltihash of the content.\n   * @returns {CID<Data, Code, Alg, 1>}\n   */\n  static createV1 (code, digest) {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   *\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ByteView<API.Link<Data, Code, Alg, Ver>>} bytes\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static decode (bytes) {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} bytes\n   * @returns {[CID<T, C, A, V>, Uint8Array]}\n   */\n  static decodeFirst (bytes) {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(/** @type {API.MultihashDigest<API.SHA_256>} */ (digest))\n        : CID.createV1(specs.codec, digest)\n    return [/** @type {CID<T, C, A, V>} */(cid), bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   *\n   * @template {unknown} T\n   * @template {number} C\n   * @template {number} A\n   * @template {API.Version} V\n   * @param {API.ByteView<API.Link<T, C, A, V>>} initialBytes\n   * @returns {{ version:V, codec:C, multihashCode:A, digestSize:number, multihashSize:number, size:number }}\n   */\n  static inspectBytes (initialBytes) {\n    let offset = 0\n    const next = () => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = /** @type {V} */ (next())\n    let codec = /** @type {C} */ (DAG_PB_CODE)\n    if (/** @type {number} */(version) === 18) {\n      // CIDv0\n      version = /** @type {V} */ (0)\n      offset = 0\n    } else {\n      codec = /** @type {C} */ (next())\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = /** @type {A} */ (next()) // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   *\n   * @template {string} Prefix\n   * @template {unknown} Data\n   * @template {number} Code\n   * @template {number} Alg\n   * @template {API.Version} Ver\n   * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n   * @param {API.MultibaseDecoder<Prefix>} [base]\n   * @returns {CID<Data, Code, Alg, Ver>}\n   */\n  static parse (source, base) {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @template {unknown} Data\n * @template {number} Code\n * @template {number} Alg\n * @template {API.Version} Ver\n * @param {API.ToString<API.Link<Data, Code, Alg, Ver>, Prefix>} source\n * @param {API.MultibaseDecoder<Prefix>} [base]\n * @returns {[Prefix, API.ByteView<API.Link<Data, Code, Alg, Ver>>]}\n */\nconst parseCIDtoBytes = (source, base) => {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base || base58btc\n      return [\n        /** @type {Prefix} */ (base58btc.prefix),\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base || base58btc\n      return [/** @type {Prefix} */(base58btc.prefix), decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base || base32\n      return [/** @type {Prefix} */(base32.prefix), decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [/** @type {Prefix} */(source[0]), base.decode(source)]\n    }\n  }\n}\n\n/**\n *\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<'z'>} base\n */\nconst toStringV0 = (bytes, cache, base) => {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\n/**\n * @template {string} Prefix\n * @param {Uint8Array} bytes\n * @param {Map<string, string>} cache\n * @param {API.MultibaseEncoder<Prefix>} base\n */\nconst toStringV1 = (bytes, cache, base) => {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\n/**\n * @param {API.Version} version\n * @param {number} code\n * @param {Uint8Array} multihash\n * @returns {Uint8Array}\n */\nconst encodeCID = (version, code, multihash) => {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n","// @ts-check\n\nimport * as identityBase from './bases/identity.js'\nimport * as base2 from './bases/base2.js'\nimport * as base8 from './bases/base8.js'\nimport * as base10 from './bases/base10.js'\nimport * as base16 from './bases/base16.js'\nimport * as base32 from './bases/base32.js'\nimport * as base36 from './bases/base36.js'\nimport * as base58 from './bases/base58.js'\nimport * as base64 from './bases/base64.js'\nimport * as base256emoji from './bases/base256emoji.js'\nimport * as sha2 from './hashes/sha2.js'\nimport * as identity from './hashes/identity.js'\n\nimport * as raw from './codecs/raw.js'\nimport * as json from './codecs/json.js'\n\nimport { CID, hasher, digest, varint, bytes } from './index.js'\n\nconst bases = { ...identityBase, ...base2, ...base8, ...base10, ...base16, ...base32, ...base36, ...base58, ...base64, ...base256emoji }\nconst hashes = { ...sha2, ...identity }\nconst codecs = { raw, json }\n\nexport { CID, hasher, digest, varint, bytes, hashes, bases, codecs }\n","import { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc(size = 0) {\n    if (globalThis.Buffer?.alloc != null) {\n        return asUint8Array(globalThis.Buffer.alloc(size));\n    }\n    return new Uint8Array(size);\n}\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe(size = 0) {\n    if (globalThis.Buffer?.allocUnsafe != null) {\n        return asUint8Array(globalThis.Buffer.allocUnsafe(size));\n    }\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc.js.map","/**\n * To guarantee Uint8Array semantics, convert nodejs Buffers\n * into vanilla Uint8Arrays\n */\nexport function asUint8Array(buf) {\n    if (globalThis.Buffer != null) {\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    return buf;\n}\n//# sourceMappingURL=as-uint8array.js.map","import { bases } from 'multiformats/basics';\nimport { allocUnsafe } from '../alloc.js';\nfunction createCodec(name, prefix, encode, decode) {\n    return {\n        name,\n        prefix,\n        encoder: {\n            name,\n            prefix,\n            encode\n        },\n        decoder: {\n            decode\n        }\n    };\n}\nconst string = createCodec('utf8', 'u', (buf) => {\n    const decoder = new TextDecoder('utf8');\n    return 'u' + decoder.decode(buf);\n}, (str) => {\n    const encoder = new TextEncoder();\n    return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', (buf) => {\n    let string = 'a';\n    for (let i = 0; i < buf.length; i++) {\n        string += String.fromCharCode(buf[i]);\n    }\n    return string;\n}, (str) => {\n    str = str.substring(1);\n    const buf = allocUnsafe(str.length);\n    for (let i = 0; i < str.length; i++) {\n        buf[i] = str.charCodeAt(i);\n    }\n    return buf;\n});\nconst BASES = {\n    utf8: string,\n    'utf-8': string,\n    hex: bases.base16,\n    latin1: ascii,\n    ascii: ascii,\n    binary: ascii,\n    ...bases\n};\nexport default BASES;\n//# sourceMappingURL=bases.js.map","import bases from './util/bases.js';\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString(array, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return globalThis.Buffer.from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');\n    }\n    // strip multibase prefix\n    return base.encoder.encode(array).substring(1);\n}\n//# sourceMappingURL=to-string.js.map","import { isIPv4, isIPv6 } from '@chainsafe/is-ip';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nexport { isIP } from '@chainsafe/is-ip';\nexport const isV4 = isIPv4;\nexport const isV6 = isIPv6;\n// Copied from https://github.com/indutny/node-ip/blob/master/lib/ip.js#L7\n// but with buf/offset args removed because we don't use them\nexport const toBytes = function (ip) {\n    let offset = 0;\n    ip = ip.toString().trim();\n    if (isV4(ip)) {\n        const bytes = new Uint8Array(offset + 4);\n        ip.split(/\\./g).forEach((byte) => {\n            bytes[offset++] = parseInt(byte, 10) & 0xff;\n        });\n        return bytes;\n    }\n    if (isV6(ip)) {\n        const sections = ip.split(':', 8);\n        let i;\n        for (i = 0; i < sections.length; i++) {\n            const isv4 = isV4(sections[i]);\n            let v4Buffer;\n            if (isv4) {\n                v4Buffer = toBytes(sections[i]);\n                sections[i] = uint8ArrayToString(v4Buffer.slice(0, 2), 'base16');\n            }\n            if (v4Buffer != null && ++i < 8) {\n                sections.splice(i, 0, uint8ArrayToString(v4Buffer.slice(2, 4), 'base16'));\n            }\n        }\n        if (sections[0] === '') {\n            while (sections.length < 8)\n                sections.unshift('0');\n        }\n        else if (sections[sections.length - 1] === '') {\n            while (sections.length < 8)\n                sections.push('0');\n        }\n        else if (sections.length < 8) {\n            for (i = 0; i < sections.length && sections[i] !== ''; i++)\n                ;\n            const argv = [i, 1];\n            for (i = 9 - sections.length; i > 0; i--) {\n                argv.push('0');\n            }\n            sections.splice.apply(sections, argv);\n        }\n        const bytes = new Uint8Array(offset + 16);\n        for (i = 0; i < sections.length; i++) {\n            const word = parseInt(sections[i], 16);\n            bytes[offset++] = (word >> 8) & 0xff;\n            bytes[offset++] = word & 0xff;\n        }\n        return bytes;\n    }\n    throw new Error('invalid ip address');\n};\n// Copied from https://github.com/indutny/node-ip/blob/master/lib/ip.js#L63\nexport const toString = function (buf, offset = 0, length) {\n    offset = ~~offset;\n    length = length ?? (buf.length - offset);\n    const view = new DataView(buf.buffer);\n    if (length === 4) {\n        const result = [];\n        // IPv4\n        for (let i = 0; i < length; i++) {\n            result.push(buf[offset + i]);\n        }\n        return result.join('.');\n    }\n    if (length === 16) {\n        const result = [];\n        // IPv6\n        for (let i = 0; i < length; i += 2) {\n            result.push(view.getUint16(offset + i).toString(16));\n        }\n        return result.join(':')\n            .replace(/(^|:)0(:0)*:0(:|$)/, '$1::$3')\n            .replace(/:{3,4}/, '::');\n    }\n    return '';\n};\n//# sourceMappingURL=ip.js.map","const V = -1;\nexport const names = {};\nexport const codes = {};\nexport const table = [\n    [4, 32, 'ip4'],\n    [6, 16, 'tcp'],\n    [33, 16, 'dccp'],\n    [41, 128, 'ip6'],\n    [42, V, 'ip6zone'],\n    [43, 8, 'ipcidr'],\n    [53, V, 'dns', true],\n    [54, V, 'dns4', true],\n    [55, V, 'dns6', true],\n    [56, V, 'dnsaddr', true],\n    [132, 16, 'sctp'],\n    [273, 16, 'udp'],\n    [275, 0, 'p2p-webrtc-star'],\n    [276, 0, 'p2p-webrtc-direct'],\n    [277, 0, 'p2p-stardust'],\n    [280, 0, 'webrtc-direct'],\n    [281, 0, 'webrtc'],\n    [290, 0, 'p2p-circuit'],\n    [301, 0, 'udt'],\n    [302, 0, 'utp'],\n    [400, V, 'unix', false, true],\n    // `ipfs` is added before `p2p` for legacy support.\n    // All text representations will default to `p2p`, but `ipfs` will\n    // still be supported\n    [421, V, 'ipfs'],\n    // `p2p` is the preferred name for 421, and is now the default\n    [421, V, 'p2p'],\n    [443, 0, 'https'],\n    [444, 96, 'onion'],\n    [445, 296, 'onion3'],\n    [446, V, 'garlic64'],\n    [448, 0, 'tls'],\n    [449, V, 'sni'],\n    [460, 0, 'quic'],\n    [461, 0, 'quic-v1'],\n    [465, 0, 'webtransport'],\n    [466, V, 'certhash'],\n    [477, 0, 'ws'],\n    [478, 0, 'wss'],\n    [479, 0, 'p2p-websocket-star'],\n    [480, 0, 'http'],\n    [777, V, 'memory']\n];\n// populate tables\ntable.forEach(row => {\n    const proto = createProtocol(...row);\n    codes[proto.code] = proto;\n    names[proto.name] = proto;\n});\nexport function createProtocol(code, size, name, resolvable, path) {\n    return {\n        code,\n        size,\n        name,\n        resolvable: Boolean(resolvable),\n        path: Boolean(path)\n    };\n}\n/**\n * For the passed proto string or number, return a {@link Protocol}\n *\n * @example\n *\n * ```js\n * import { protocol } from '@multiformats/multiaddr'\n *\n * console.info(protocol(4))\n * // { code: 4, size: 32, name: 'ip4', resolvable: false, path: false }\n * ```\n */\nexport function getProtocol(proto) {\n    if (typeof proto === 'number') {\n        if (codes[proto] != null) {\n            return codes[proto];\n        }\n        throw new Error(`no protocol with code: ${proto}`);\n    }\n    else if (typeof proto === 'string') {\n        if (names[proto] != null) {\n            return names[proto];\n        }\n        throw new Error(`no protocol with name: ${proto}`);\n    }\n    throw new Error(`invalid protocol id type: ${typeof proto}`);\n}\n//# sourceMappingURL=protocols-table.js.map","/**\n * @packageDocumentation\n *\n * Provides methods for converting\n */\nimport { IpNet } from '@chainsafe/netmask';\nimport { base32 } from 'multiformats/bases/base32';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { bases } from 'multiformats/basics';\nimport { CID } from 'multiformats/cid';\nimport * as Digest from 'multiformats/hashes/digest';\nimport * as varint from 'uint8-varint';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport * as ip from './ip.js';\nimport { getProtocol } from './protocols-table.js';\nconst ip4Protocol = getProtocol('ip4');\nconst ip6Protocol = getProtocol('ip6');\nconst ipcidrProtocol = getProtocol('ipcidr');\nexport function convert(proto, a) {\n    if (a instanceof Uint8Array) {\n        return convertToString(proto, a);\n    }\n    else {\n        return convertToBytes(proto, a);\n    }\n}\n/**\n * Convert [code,Uint8Array] to string\n */\nexport function convertToString(proto, buf) {\n    const protocol = getProtocol(proto);\n    switch (protocol.code) {\n        case 4: // ipv4\n        case 41: // ipv6\n            return bytes2ip(buf);\n        case 42: // ipv6zone\n            return bytes2str(buf);\n        case 6: // tcp\n        case 273: // udp\n        case 33: // dccp\n        case 132: // sctp\n            return bytes2port(buf).toString();\n        case 53: // dns\n        case 54: // dns4\n        case 55: // dns6\n        case 56: // dnsaddr\n        case 400: // unix\n        case 449: // sni\n        case 777: // memory\n            return bytes2str(buf);\n        case 421: // ipfs\n            return bytes2mh(buf);\n        case 444: // onion\n            return bytes2onion(buf);\n        case 445: // onion3\n            return bytes2onion(buf);\n        case 466: // certhash\n            return bytes2mb(buf);\n        default:\n            return uint8ArrayToString(buf, 'base16'); // no clue. convert to hex\n    }\n}\nexport function convertToBytes(proto, str) {\n    const protocol = getProtocol(proto);\n    switch (protocol.code) {\n        case 4: // ipv4\n            return ip2bytes(str);\n        case 41: // ipv6\n            return ip2bytes(str);\n        case 42: // ipv6zone\n            return str2bytes(str);\n        case 6: // tcp\n        case 273: // udp\n        case 33: // dccp\n        case 132: // sctp\n            return port2bytes(parseInt(str, 10));\n        case 53: // dns\n        case 54: // dns4\n        case 55: // dns6\n        case 56: // dnsaddr\n        case 400: // unix\n        case 449: // sni\n        case 777: // memory\n            return str2bytes(str);\n        case 421: // ipfs\n            return mh2bytes(str);\n        case 444: // onion\n            return onion2bytes(str);\n        case 445: // onion3\n            return onion32bytes(str);\n        case 466: // certhash\n            return mb2bytes(str);\n        default:\n            return uint8ArrayFromString(str, 'base16'); // no clue. convert from hex\n    }\n}\nexport function convertToIpNet(multiaddr) {\n    let mask;\n    let addr;\n    multiaddr.stringTuples().forEach(([code, value]) => {\n        if (code === ip4Protocol.code || code === ip6Protocol.code) {\n            addr = value;\n        }\n        if (code === ipcidrProtocol.code) {\n            mask = value;\n        }\n    });\n    if (mask == null || addr == null) {\n        throw new Error('Invalid multiaddr');\n    }\n    return new IpNet(addr, mask);\n}\nconst decoders = Object.values(bases).map((c) => c.decoder);\nconst anybaseDecoder = (function () {\n    let acc = decoders[0].or(decoders[1]);\n    decoders.slice(2).forEach((d) => (acc = acc.or(d)));\n    return acc;\n})();\nfunction ip2bytes(ipString) {\n    if (!ip.isIP(ipString)) {\n        throw new Error('invalid ip address');\n    }\n    return ip.toBytes(ipString);\n}\nfunction bytes2ip(ipBuff) {\n    const ipString = ip.toString(ipBuff, 0, ipBuff.length);\n    if (ipString == null) {\n        throw new Error('ipBuff is required');\n    }\n    if (!ip.isIP(ipString)) {\n        throw new Error('invalid ip address');\n    }\n    return ipString;\n}\nfunction port2bytes(port) {\n    const buf = new ArrayBuffer(2);\n    const view = new DataView(buf);\n    view.setUint16(0, port);\n    return new Uint8Array(buf);\n}\nfunction bytes2port(buf) {\n    const view = new DataView(buf.buffer);\n    return view.getUint16(buf.byteOffset);\n}\nfunction str2bytes(str) {\n    const buf = uint8ArrayFromString(str);\n    const size = Uint8Array.from(varint.encode(buf.length));\n    return uint8ArrayConcat([size, buf], size.length + buf.length);\n}\nfunction bytes2str(buf) {\n    const size = varint.decode(buf);\n    buf = buf.slice(varint.encodingLength(size));\n    if (buf.length !== size) {\n        throw new Error('inconsistent lengths');\n    }\n    return uint8ArrayToString(buf);\n}\nfunction mh2bytes(hash) {\n    let mh;\n    if (hash[0] === 'Q' || hash[0] === '1') {\n        mh = Digest.decode(base58btc.decode(`z${hash}`)).bytes;\n    }\n    else {\n        mh = CID.parse(hash).multihash.bytes;\n    }\n    // the address is a varint prefixed multihash string representation\n    const size = Uint8Array.from(varint.encode(mh.length));\n    return uint8ArrayConcat([size, mh], size.length + mh.length);\n}\nfunction mb2bytes(mbstr) {\n    const mb = anybaseDecoder.decode(mbstr);\n    const size = Uint8Array.from(varint.encode(mb.length));\n    return uint8ArrayConcat([size, mb], size.length + mb.length);\n}\nfunction bytes2mb(buf) {\n    const size = varint.decode(buf);\n    const hash = buf.slice(varint.encodingLength(size));\n    if (hash.length !== size) {\n        throw new Error('inconsistent lengths');\n    }\n    return 'u' + uint8ArrayToString(hash, 'base64url');\n}\n/**\n * Converts bytes to bas58btc string\n */\nfunction bytes2mh(buf) {\n    const size = varint.decode(buf);\n    const address = buf.slice(varint.encodingLength(size));\n    if (address.length !== size) {\n        throw new Error('inconsistent lengths');\n    }\n    return uint8ArrayToString(address, 'base58btc');\n}\nfunction onion2bytes(str) {\n    const addr = str.split(':');\n    if (addr.length !== 2) {\n        throw new Error(`failed to parse onion addr: [\"'${addr.join('\", \"')}'\"]' does not contain a port number`);\n    }\n    if (addr[0].length !== 16) {\n        throw new Error(`failed to parse onion addr: ${addr[0]} not a Tor onion address.`);\n    }\n    // onion addresses do not include the multibase prefix, add it before decoding\n    const buf = base32.decode('b' + addr[0]);\n    // onion port number\n    const port = parseInt(addr[1], 10);\n    if (port < 1 || port > 65536) {\n        throw new Error('Port number is not in range(1, 65536)');\n    }\n    const portBuf = port2bytes(port);\n    return uint8ArrayConcat([buf, portBuf], buf.length + portBuf.length);\n}\nfunction onion32bytes(str) {\n    const addr = str.split(':');\n    if (addr.length !== 2) {\n        throw new Error(`failed to parse onion addr: [\"'${addr.join('\", \"')}'\"]' does not contain a port number`);\n    }\n    if (addr[0].length !== 56) {\n        throw new Error(`failed to parse onion addr: ${addr[0]} not a Tor onion3 address.`);\n    }\n    // onion addresses do not include the multibase prefix, add it before decoding\n    const buf = base32.decode(`b${addr[0]}`);\n    // onion port number\n    const port = parseInt(addr[1], 10);\n    if (port < 1 || port > 65536) {\n        throw new Error('Port number is not in range(1, 65536)');\n    }\n    const portBuf = port2bytes(port);\n    return uint8ArrayConcat([buf, portBuf], buf.length + portBuf.length);\n}\nfunction bytes2onion(buf) {\n    const addrBytes = buf.slice(0, buf.length - 2);\n    const portBytes = buf.slice(buf.length - 2);\n    const addr = uint8ArrayToString(addrBytes, 'base32');\n    const port = bytes2port(portBytes);\n    return `${addr}:${port}`;\n}\n//# sourceMappingURL=convert.js.map","import { convertToString } from '@multiformats/multiaddr/convert';\n// Protocols https://github.com/multiformats/multiaddr/blob/master/protocols.csv\n// code  size  name\n// 4     32    ip4\n// 41    128   ip6\nvar Protocol;\n(function (Protocol) {\n    Protocol[Protocol[\"ip4\"] = 4] = \"ip4\";\n    Protocol[Protocol[\"ip6\"] = 41] = \"ip6\";\n})(Protocol || (Protocol = {}));\nexport function multiaddrToIPStr(multiaddr) {\n    for (const tuple of multiaddr.tuples()) {\n        switch (tuple[0]) {\n            case Protocol.ip4:\n            case Protocol.ip6:\n                return convertToString(tuple[0], tuple[1]);\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=multiaddr.js.map","import { pipe } from 'it-pipe';\nimport { peerIdFromBytes, peerIdFromString } from '@libp2p/peer-id';\nimport { logger } from '@libp2p/logger';\nimport { CustomEvent, EventEmitter } from '@libp2p/interface/events';\nimport { MessageCache } from './message-cache.js';\nimport { RPC } from './message/rpc.js';\nimport * as constants from './constants.js';\nimport { shuffle, messageIdToString } from './utils/index.js';\nimport { PeerScore, createPeerScoreParams, createPeerScoreThresholds } from './score/index.js';\nimport { IWantTracer } from './tracer.js';\nimport { SimpleTimeCache } from './utils/time-cache.js';\nimport { ACCEPT_FROM_WHITELIST_DURATION_MS, ACCEPT_FROM_WHITELIST_MAX_MESSAGES, ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE, BACKOFF_SLACK } from './constants.js';\nimport { ChurnReason, getMetrics, IHaveIgnoreReason, InclusionReason, ScorePenalty } from './metrics.js';\nimport { ValidateError, MessageStatus, RejectReason, rejectReasonFromAcceptance } from './types.js';\nimport { buildRawMessage, validateToRawMessage } from './utils/buildRawMessage.js';\nimport { msgIdFnStrictNoSign, msgIdFnStrictSign } from './utils/msgIdFn.js';\nimport { computeAllPeersScoreWeights } from './score/scoreMetrics.js';\nimport { getPublishConfigFromPeerId } from './utils/publishConfig.js';\nimport { StrictSign, StrictNoSign, TopicValidatorResult } from '@libp2p/interface/pubsub';\nimport { removeFirstNItemsFromSet, removeItemsFromSet } from './utils/set.js';\nimport { pushable } from 'it-pushable';\nimport { InboundStream, OutboundStream } from './stream.js';\nimport { decodeRpc, defaultDecodeRpcLimits } from './message/decodeRpc.js';\nimport { multiaddrToIPStr } from './utils/multiaddr.js';\nexport const multicodec = constants.GossipsubIDv11;\nvar GossipStatusCode;\n(function (GossipStatusCode) {\n    GossipStatusCode[GossipStatusCode[\"started\"] = 0] = \"started\";\n    GossipStatusCode[GossipStatusCode[\"stopped\"] = 1] = \"stopped\";\n})(GossipStatusCode || (GossipStatusCode = {}));\nexport class GossipSub extends EventEmitter {\n    /**\n     * The signature policy to follow by default\n     */\n    globalSignaturePolicy;\n    multicodecs = [constants.GossipsubIDv11, constants.GossipsubIDv10];\n    publishConfig;\n    dataTransform;\n    // State\n    peers = new Set();\n    streamsInbound = new Map();\n    streamsOutbound = new Map();\n    /** Ensures outbound streams are created sequentially */\n    outboundInflightQueue = pushable({ objectMode: true });\n    /** Direct peers */\n    direct = new Set();\n    /** Floodsub peers */\n    floodsubPeers = new Set();\n    /** Cache of seen messages */\n    seenCache;\n    /**\n     * Map of peer id and AcceptRequestWhileListEntry\n     */\n    acceptFromWhitelist = new Map();\n    /**\n     * Map of topics to which peers are subscribed to\n     */\n    topics = new Map();\n    /**\n     * List of our subscriptions\n     */\n    subscriptions = new Set();\n    /**\n     * Map of topic meshes\n     * topic => peer id set\n     */\n    mesh = new Map();\n    /**\n     * Map of topics to set of peers. These mesh peers are the ones to which we are publishing without a topic membership\n     * topic => peer id set\n     */\n    fanout = new Map();\n    /**\n     * Map of last publish time for fanout topics\n     * topic => last publish time\n     */\n    fanoutLastpub = new Map();\n    /**\n     * Map of pending messages to gossip\n     * peer id => control messages\n     */\n    gossip = new Map();\n    /**\n     * Map of control messages\n     * peer id => control message\n     */\n    control = new Map();\n    /**\n     * Number of IHAVEs received from peer in the last heartbeat\n     */\n    peerhave = new Map();\n    /** Number of messages we have asked from peer in the last heartbeat */\n    iasked = new Map();\n    /** Prune backoff map */\n    backoff = new Map();\n    /**\n     * Connection direction cache, marks peers with outbound connections\n     * peer id => direction\n     */\n    outbound = new Map();\n    msgIdFn;\n    /**\n     * A fast message id function used for internal message de-duplication\n     */\n    fastMsgIdFn;\n    msgIdToStrFn;\n    /** Maps fast message-id to canonical message-id */\n    fastMsgIdCache;\n    /**\n     * Short term cache for published message ids. This is used for penalizing peers sending\n     * our own messages back if the messages are anonymous or use a random author.\n     */\n    publishedMessageIds;\n    /**\n     * A message cache that contains the messages for last few heartbeat ticks\n     */\n    mcache;\n    /** Peer score tracking */\n    score;\n    /**\n     * Custom validator function per topic.\n     * Must return or resolve quickly (< 100ms) to prevent causing penalties for late messages.\n     * If you need to apply validation that may require longer times use `asyncValidation` option and callback the\n     * validation result through `Gossipsub.reportValidationResult`\n     */\n    topicValidators = new Map();\n    /**\n     * Make this protected so child class may want to redirect to its own log.\n     */\n    log;\n    /**\n     * Number of heartbeats since the beginning of time\n     * This allows us to amortize some resource cleanup -- eg: backoff cleanup\n     */\n    heartbeatTicks = 0;\n    /**\n     * Tracks IHAVE/IWANT promises broken by peers\n     */\n    gossipTracer;\n    components;\n    directPeerInitial = null;\n    static multicodec = constants.GossipsubIDv11;\n    // Options\n    opts;\n    decodeRpcLimits;\n    metrics;\n    status = { code: GossipStatusCode.stopped };\n    maxInboundStreams;\n    maxOutboundStreams;\n    allowedTopics;\n    heartbeatTimer = null;\n    constructor(components, options = {}) {\n        super();\n        const opts = {\n            fallbackToFloodsub: true,\n            floodPublish: true,\n            doPX: false,\n            directPeers: [],\n            D: constants.GossipsubD,\n            Dlo: constants.GossipsubDlo,\n            Dhi: constants.GossipsubDhi,\n            Dscore: constants.GossipsubDscore,\n            Dout: constants.GossipsubDout,\n            Dlazy: constants.GossipsubDlazy,\n            heartbeatInterval: constants.GossipsubHeartbeatInterval,\n            fanoutTTL: constants.GossipsubFanoutTTL,\n            mcacheLength: constants.GossipsubHistoryLength,\n            mcacheGossip: constants.GossipsubHistoryGossip,\n            seenTTL: constants.GossipsubSeenTTL,\n            gossipsubIWantFollowupMs: constants.GossipsubIWantFollowupTime,\n            prunePeers: constants.GossipsubPrunePeers,\n            pruneBackoff: constants.GossipsubPruneBackoff,\n            unsubcribeBackoff: constants.GossipsubUnsubscribeBackoff,\n            graftFloodThreshold: constants.GossipsubGraftFloodThreshold,\n            opportunisticGraftPeers: constants.GossipsubOpportunisticGraftPeers,\n            opportunisticGraftTicks: constants.GossipsubOpportunisticGraftTicks,\n            directConnectTicks: constants.GossipsubDirectConnectTicks,\n            ...options,\n            scoreParams: createPeerScoreParams(options.scoreParams),\n            scoreThresholds: createPeerScoreThresholds(options.scoreThresholds)\n        };\n        this.components = components;\n        this.decodeRpcLimits = opts.decodeRpcLimits ?? defaultDecodeRpcLimits;\n        this.globalSignaturePolicy = opts.globalSignaturePolicy ?? StrictSign;\n        // Also wants to get notified of peers connected using floodsub\n        if (opts.fallbackToFloodsub) {\n            this.multicodecs.push(constants.FloodsubID);\n        }\n        // From pubsub\n        this.log = logger(opts.debugName ?? 'libp2p:gossipsub');\n        // Gossipsub\n        this.opts = opts;\n        this.direct = new Set(opts.directPeers.map((p) => p.id.toString()));\n        this.seenCache = new SimpleTimeCache({ validityMs: opts.seenTTL });\n        this.publishedMessageIds = new SimpleTimeCache({ validityMs: opts.seenTTL });\n        if (options.msgIdFn) {\n            // Use custom function\n            this.msgIdFn = options.msgIdFn;\n        }\n        else {\n            switch (this.globalSignaturePolicy) {\n                case StrictSign:\n                    this.msgIdFn = msgIdFnStrictSign;\n                    break;\n                case StrictNoSign:\n                    this.msgIdFn = msgIdFnStrictNoSign;\n                    break;\n            }\n        }\n        if (options.fastMsgIdFn) {\n            this.fastMsgIdFn = options.fastMsgIdFn;\n            this.fastMsgIdCache = new SimpleTimeCache({ validityMs: opts.seenTTL });\n        }\n        // By default, gossipsub only provide a browser friendly function to convert Uint8Array message id to string.\n        this.msgIdToStrFn = options.msgIdToStrFn ?? messageIdToString;\n        this.mcache = options.messageCache || new MessageCache(opts.mcacheGossip, opts.mcacheLength, this.msgIdToStrFn);\n        if (options.dataTransform) {\n            this.dataTransform = options.dataTransform;\n        }\n        if (options.metricsRegister) {\n            if (!options.metricsTopicStrToLabel) {\n                throw Error('Must set metricsTopicStrToLabel with metrics');\n            }\n            // in theory, each topic has its own meshMessageDeliveriesWindow param\n            // however in lodestar, we configure it mostly the same so just pick the max of positive ones\n            // (some topics have meshMessageDeliveriesWindow as 0)\n            const maxMeshMessageDeliveriesWindowMs = Math.max(...Object.values(opts.scoreParams.topics).map((topicParam) => topicParam.meshMessageDeliveriesWindow), constants.DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS);\n            const metrics = getMetrics(options.metricsRegister, options.metricsTopicStrToLabel, {\n                gossipPromiseExpireSec: this.opts.gossipsubIWantFollowupMs / 1000,\n                behaviourPenaltyThreshold: opts.scoreParams.behaviourPenaltyThreshold,\n                maxMeshMessageDeliveriesWindowSec: maxMeshMessageDeliveriesWindowMs / 1000\n            });\n            metrics.mcacheSize.addCollect(() => this.onScrapeMetrics(metrics));\n            for (const protocol of this.multicodecs) {\n                metrics.protocolsEnabled.set({ protocol }, 1);\n            }\n            this.metrics = metrics;\n        }\n        else {\n            this.metrics = null;\n        }\n        this.gossipTracer = new IWantTracer(this.opts.gossipsubIWantFollowupMs, this.msgIdToStrFn, this.metrics);\n        /**\n         * libp2p\n         */\n        this.score = new PeerScore(this.opts.scoreParams, this.metrics, {\n            scoreCacheValidityMs: opts.heartbeatInterval\n        });\n        this.maxInboundStreams = options.maxInboundStreams;\n        this.maxOutboundStreams = options.maxOutboundStreams;\n        this.allowedTopics = opts.allowedTopics ? new Set(opts.allowedTopics) : null;\n    }\n    getPeers() {\n        return [...this.peers.keys()].map((str) => peerIdFromString(str));\n    }\n    isStarted() {\n        return this.status.code === GossipStatusCode.started;\n    }\n    // LIFECYCLE METHODS\n    /**\n     * Mounts the gossipsub protocol onto the libp2p node and sends our\n     * our subscriptions to every peer connected\n     */\n    async start() {\n        // From pubsub\n        if (this.isStarted()) {\n            return;\n        }\n        this.log('starting');\n        this.publishConfig = await getPublishConfigFromPeerId(this.globalSignaturePolicy, this.components.peerId);\n        // Create the outbound inflight queue\n        // This ensures that outbound stream creation happens sequentially\n        this.outboundInflightQueue = pushable({ objectMode: true });\n        pipe(this.outboundInflightQueue, async (source) => {\n            for await (const { peerId, connection } of source) {\n                await this.createOutboundStream(peerId, connection);\n            }\n        }).catch((e) => this.log.error('outbound inflight queue error', e));\n        // set direct peer addresses in the address book\n        await Promise.all(this.opts.directPeers.map(async (p) => {\n            await this.components.peerStore.merge(p.id, {\n                multiaddrs: p.addrs\n            });\n        }));\n        const registrar = this.components.registrar;\n        // Incoming streams\n        // Called after a peer dials us\n        await Promise.all(this.multicodecs.map((multicodec) => registrar.handle(multicodec, this.onIncomingStream.bind(this), {\n            maxInboundStreams: this.maxInboundStreams,\n            maxOutboundStreams: this.maxOutboundStreams\n        })));\n        // # How does Gossipsub interact with libp2p? Rough guide from Mar 2022\n        //\n        // ## Setup:\n        // Gossipsub requests libp2p to callback, TBD\n        //\n        // `this.libp2p.handle()` registers a handler for `/meshsub/1.1.0` and other Gossipsub protocols\n        // The handler callback is registered in libp2p Upgrader.protocols map.\n        //\n        // Upgrader receives an inbound connection from some transport and (`Upgrader.upgradeInbound`):\n        // - Adds encryption (NOISE in our case)\n        // - Multiplex stream\n        // - Create a muxer and register that for each new stream call Upgrader.protocols handler\n        //\n        // ## Topology\n        // - new instance of Topology (unlinked to libp2p) with handlers\n        // - registar.register(topology)\n        // register protocol with topology\n        // Topology callbacks called on connection manager changes\n        const topology = {\n            onConnect: this.onPeerConnected.bind(this),\n            onDisconnect: this.onPeerDisconnected.bind(this)\n        };\n        const registrarTopologyIds = await Promise.all(this.multicodecs.map((multicodec) => registrar.register(multicodec, topology)));\n        // Schedule to start heartbeat after `GossipsubHeartbeatInitialDelay`\n        const heartbeatTimeout = setTimeout(this.runHeartbeat, constants.GossipsubHeartbeatInitialDelay);\n        // Then, run heartbeat every `heartbeatInterval` offset by `GossipsubHeartbeatInitialDelay`\n        this.status = {\n            code: GossipStatusCode.started,\n            registrarTopologyIds,\n            heartbeatTimeout: heartbeatTimeout,\n            hearbeatStartMs: Date.now() + constants.GossipsubHeartbeatInitialDelay\n        };\n        this.score.start();\n        // connect to direct peers\n        this.directPeerInitial = setTimeout(() => {\n            Promise.resolve()\n                .then(async () => {\n                await Promise.all(Array.from(this.direct).map(async (id) => await this.connect(id)));\n            })\n                .catch((err) => {\n                this.log(err);\n            });\n        }, constants.GossipsubDirectConnectInitialDelay);\n        this.log('started');\n    }\n    /**\n     * Unmounts the gossipsub protocol and shuts down every connection\n     */\n    async stop() {\n        this.log('stopping');\n        // From pubsub\n        if (this.status.code !== GossipStatusCode.started) {\n            return;\n        }\n        const { registrarTopologyIds } = this.status;\n        this.status = { code: GossipStatusCode.stopped };\n        // unregister protocol and handlers\n        const registrar = this.components.registrar;\n        await Promise.all(this.multicodecs.map((multicodec) => registrar.unhandle(multicodec)));\n        registrarTopologyIds.forEach((id) => registrar.unregister(id));\n        this.outboundInflightQueue.end();\n        for (const outboundStream of this.streamsOutbound.values()) {\n            outboundStream.close();\n        }\n        this.streamsOutbound.clear();\n        for (const inboundStream of this.streamsInbound.values()) {\n            inboundStream.close();\n        }\n        this.streamsInbound.clear();\n        this.peers.clear();\n        this.subscriptions.clear();\n        // Gossipsub\n        if (this.heartbeatTimer) {\n            this.heartbeatTimer.cancel();\n            this.heartbeatTimer = null;\n        }\n        this.score.stop();\n        this.mesh.clear();\n        this.fanout.clear();\n        this.fanoutLastpub.clear();\n        this.gossip.clear();\n        this.control.clear();\n        this.peerhave.clear();\n        this.iasked.clear();\n        this.backoff.clear();\n        this.outbound.clear();\n        this.gossipTracer.clear();\n        this.seenCache.clear();\n        if (this.fastMsgIdCache)\n            this.fastMsgIdCache.clear();\n        if (this.directPeerInitial)\n            clearTimeout(this.directPeerInitial);\n        this.log('stopped');\n    }\n    /** FOR DEBUG ONLY - Dump peer stats for all peers. Data is cloned, safe to mutate */\n    dumpPeerScoreStats() {\n        return this.score.dumpPeerScoreStats();\n    }\n    /**\n     * On an inbound stream opened\n     */\n    onIncomingStream({ stream, connection }) {\n        if (!this.isStarted()) {\n            return;\n        }\n        const peerId = connection.remotePeer;\n        // add peer to router\n        this.addPeer(peerId, connection.direction, connection.remoteAddr);\n        // create inbound stream\n        this.createInboundStream(peerId, stream);\n        // attempt to create outbound stream\n        this.outboundInflightQueue.push({ peerId, connection });\n    }\n    /**\n     * Registrar notifies an established connection with pubsub protocol\n     */\n    onPeerConnected(peerId, connection) {\n        this.metrics?.newConnectionCount.inc({ status: connection.status });\n        // libp2p may emit a closed connection and never issue peer:disconnect event\n        // see https://github.com/ChainSafe/js-libp2p-gossipsub/issues/398\n        if (!this.isStarted() || connection.status !== 'open') {\n            return;\n        }\n        this.addPeer(peerId, connection.direction, connection.remoteAddr);\n        this.outboundInflightQueue.push({ peerId, connection });\n    }\n    /**\n     * Registrar notifies a closing connection with pubsub protocol\n     */\n    onPeerDisconnected(peerId) {\n        this.log('connection ended %p', peerId);\n        this.removePeer(peerId);\n    }\n    async createOutboundStream(peerId, connection) {\n        if (!this.isStarted()) {\n            return;\n        }\n        const id = peerId.toString();\n        if (!this.peers.has(id)) {\n            return;\n        }\n        // TODO make this behavior more robust\n        // This behavior is different than for inbound streams\n        // If an outbound stream already exists, don't create a new stream\n        if (this.streamsOutbound.has(id)) {\n            return;\n        }\n        try {\n            const stream = new OutboundStream(await connection.newStream(this.multicodecs), (e) => this.log.error('outbound pipe error', e), { maxBufferSize: this.opts.maxOutboundBufferSize });\n            this.log('create outbound stream %p', peerId);\n            this.streamsOutbound.set(id, stream);\n            const protocol = stream.protocol;\n            if (protocol === constants.FloodsubID) {\n                this.floodsubPeers.add(id);\n            }\n            this.metrics?.peersPerProtocol.inc({ protocol }, 1);\n            // Immediately send own subscriptions via the newly attached stream\n            if (this.subscriptions.size > 0) {\n                this.log('send subscriptions to', id);\n                this.sendSubscriptions(id, Array.from(this.subscriptions), true);\n            }\n        }\n        catch (e) {\n            this.log.error('createOutboundStream error', e);\n        }\n    }\n    async createInboundStream(peerId, stream) {\n        if (!this.isStarted()) {\n            return;\n        }\n        const id = peerId.toString();\n        if (!this.peers.has(id)) {\n            return;\n        }\n        // TODO make this behavior more robust\n        // This behavior is different than for outbound streams\n        // If a peer initiates a new inbound connection\n        // we assume that one is the new canonical inbound stream\n        const priorInboundStream = this.streamsInbound.get(id);\n        if (priorInboundStream !== undefined) {\n            this.log('replacing existing inbound steam %s', id);\n            priorInboundStream.close();\n        }\n        this.log('create inbound stream %s', id);\n        const inboundStream = new InboundStream(stream, { maxDataLength: this.opts.maxInboundDataLength });\n        this.streamsInbound.set(id, inboundStream);\n        this.pipePeerReadStream(peerId, inboundStream.source).catch((err) => this.log(err));\n    }\n    /**\n     * Add a peer to the router\n     */\n    addPeer(peerId, direction, addr) {\n        const id = peerId.toString();\n        if (!this.peers.has(id)) {\n            this.log('new peer %p', peerId);\n            this.peers.add(id);\n            // Add to peer scoring\n            this.score.addPeer(id);\n            const currentIP = multiaddrToIPStr(addr);\n            if (currentIP !== null) {\n                this.score.addIP(id, currentIP);\n            }\n            else {\n                this.log('Added peer has no IP in current address %s %s', id, addr.toString());\n            }\n            // track the connection direction. Don't allow to unset outbound\n            if (!this.outbound.has(id)) {\n                this.outbound.set(id, direction === 'outbound');\n            }\n        }\n    }\n    /**\n     * Removes a peer from the router\n     */\n    removePeer(peerId) {\n        const id = peerId.toString();\n        if (!this.peers.has(id)) {\n            return;\n        }\n        // delete peer\n        this.log('delete peer %p', peerId);\n        this.peers.delete(id);\n        const outboundStream = this.streamsOutbound.get(id);\n        const inboundStream = this.streamsInbound.get(id);\n        if (outboundStream) {\n            this.metrics?.peersPerProtocol.inc({ protocol: outboundStream.protocol }, -1);\n        }\n        // close streams\n        outboundStream?.close();\n        inboundStream?.close();\n        // remove streams\n        this.streamsOutbound.delete(id);\n        this.streamsInbound.delete(id);\n        // remove peer from topics map\n        for (const peers of this.topics.values()) {\n            peers.delete(id);\n        }\n        // Remove this peer from the mesh\n        for (const [topicStr, peers] of this.mesh) {\n            if (peers.delete(id) === true) {\n                this.metrics?.onRemoveFromMesh(topicStr, ChurnReason.Dc, 1);\n            }\n        }\n        // Remove this peer from the fanout\n        for (const peers of this.fanout.values()) {\n            peers.delete(id);\n        }\n        // Remove from floodsubPeers\n        this.floodsubPeers.delete(id);\n        // Remove from gossip mapping\n        this.gossip.delete(id);\n        // Remove from control mapping\n        this.control.delete(id);\n        // Remove from backoff mapping\n        this.outbound.delete(id);\n        // Remove from peer scoring\n        this.score.removePeer(id);\n        this.acceptFromWhitelist.delete(id);\n    }\n    // API METHODS\n    get started() {\n        return this.status.code === GossipStatusCode.started;\n    }\n    /**\n     * Get a the peer-ids in a topic mesh\n     */\n    getMeshPeers(topic) {\n        const peersInTopic = this.mesh.get(topic);\n        return peersInTopic ? Array.from(peersInTopic) : [];\n    }\n    /**\n     * Get a list of the peer-ids that are subscribed to one topic.\n     */\n    getSubscribers(topic) {\n        const peersInTopic = this.topics.get(topic);\n        return (peersInTopic ? Array.from(peersInTopic) : []).map((str) => peerIdFromString(str));\n    }\n    /**\n     * Get the list of topics which the peer is subscribed to.\n     */\n    getTopics() {\n        return Array.from(this.subscriptions);\n    }\n    // TODO: Reviewing Pubsub API\n    // MESSAGE METHODS\n    /**\n     * Responsible for processing each RPC message received by other peers.\n     */\n    async pipePeerReadStream(peerId, stream) {\n        try {\n            await pipe(stream, async (source) => {\n                for await (const data of source) {\n                    try {\n                        // TODO: Check max gossip message size, before decodeRpc()\n                        const rpcBytes = data.subarray();\n                        // Note: This function may throw, it must be wrapped in a try {} catch {} to prevent closing the stream.\n                        // TODO: What should we do if the entire RPC is invalid?\n                        const rpc = decodeRpc(rpcBytes, this.decodeRpcLimits);\n                        this.metrics?.onRpcRecv(rpc, rpcBytes.length);\n                        // Since processRpc may be overridden entirely in unsafe ways,\n                        // the simplest/safest option here is to wrap in a function and capture all errors\n                        // to prevent a top-level unhandled exception\n                        // This processing of rpc messages should happen without awaiting full validation/execution of prior messages\n                        if (this.opts.awaitRpcHandler) {\n                            try {\n                                await this.handleReceivedRpc(peerId, rpc);\n                            }\n                            catch (err) {\n                                this.metrics?.onRpcRecvError();\n                                this.log(err);\n                            }\n                        }\n                        else {\n                            this.handleReceivedRpc(peerId, rpc).catch((err) => {\n                                this.metrics?.onRpcRecvError();\n                                this.log(err);\n                            });\n                        }\n                    }\n                    catch (e) {\n                        this.metrics?.onRpcDataError();\n                        this.log(e);\n                    }\n                }\n            });\n        }\n        catch (err) {\n            this.metrics?.onPeerReadStreamError();\n            this.handlePeerReadStreamError(err, peerId);\n        }\n    }\n    /**\n     * Handle error when read stream pipe throws, less of the functional use but more\n     * to for testing purposes to spy on the error handling\n     * */\n    handlePeerReadStreamError(err, peerId) {\n        this.log.error(err);\n        this.onPeerDisconnected(peerId);\n    }\n    /**\n     * Handles an rpc request from a peer\n     */\n    async handleReceivedRpc(from, rpc) {\n        // Check if peer is graylisted in which case we ignore the event\n        if (!this.acceptFrom(from.toString())) {\n            this.log('received message from unacceptable peer %p', from);\n            this.metrics?.rpcRecvNotAccepted.inc();\n            return;\n        }\n        const subscriptions = rpc.subscriptions ? rpc.subscriptions.length : 0;\n        const messages = rpc.messages ? rpc.messages.length : 0;\n        let ihave = 0;\n        let iwant = 0;\n        let graft = 0;\n        let prune = 0;\n        if (rpc.control) {\n            if (rpc.control.ihave)\n                ihave = rpc.control.ihave.length;\n            if (rpc.control.iwant)\n                iwant = rpc.control.iwant.length;\n            if (rpc.control.graft)\n                graft = rpc.control.graft.length;\n            if (rpc.control.prune)\n                prune = rpc.control.prune.length;\n        }\n        this.log(`rpc.from ${from.toString()} subscriptions ${subscriptions} messages ${messages} ihave ${ihave} iwant ${iwant} graft ${graft} prune ${prune}`);\n        // Handle received subscriptions\n        if (rpc.subscriptions && rpc.subscriptions.length > 0) {\n            // update peer subscriptions\n            const subscriptions = [];\n            rpc.subscriptions.forEach((subOpt) => {\n                const topic = subOpt.topic;\n                const subscribe = subOpt.subscribe === true;\n                if (topic != null) {\n                    if (this.allowedTopics && !this.allowedTopics.has(topic)) {\n                        // Not allowed: subscription data-structures are not bounded by topic count\n                        // TODO: Should apply behaviour penalties?\n                        return;\n                    }\n                    this.handleReceivedSubscription(from, topic, subscribe);\n                    subscriptions.push({ topic, subscribe });\n                }\n            });\n            this.dispatchEvent(new CustomEvent('subscription-change', {\n                detail: { peerId: from, subscriptions }\n            }));\n        }\n        // Handle messages\n        // TODO: (up to limit)\n        if (rpc.messages) {\n            for (const message of rpc.messages) {\n                if (this.allowedTopics && !this.allowedTopics.has(message.topic)) {\n                    // Not allowed: message cache data-structures are not bounded by topic count\n                    // TODO: Should apply behaviour penalties?\n                    continue;\n                }\n                const handleReceivedMessagePromise = this.handleReceivedMessage(from, message)\n                    // Should never throw, but handle just in case\n                    .catch((err) => {\n                    this.metrics?.onMsgRecvError(message.topic);\n                    this.log(err);\n                });\n                if (this.opts.awaitRpcMessageHandler) {\n                    await handleReceivedMessagePromise;\n                }\n            }\n        }\n        // Handle control messages\n        if (rpc.control) {\n            await this.handleControlMessage(from.toString(), rpc.control);\n        }\n    }\n    /**\n     * Handles a subscription change from a peer\n     */\n    handleReceivedSubscription(from, topic, subscribe) {\n        this.log('subscription update from %p topic %s', from, topic);\n        let topicSet = this.topics.get(topic);\n        if (topicSet == null) {\n            topicSet = new Set();\n            this.topics.set(topic, topicSet);\n        }\n        if (subscribe) {\n            // subscribe peer to new topic\n            topicSet.add(from.toString());\n        }\n        else {\n            // unsubscribe from existing topic\n            topicSet.delete(from.toString());\n        }\n        // TODO: rust-libp2p has A LOT more logic here\n    }\n    /**\n     * Handles a newly received message from an RPC.\n     * May forward to all peers in the mesh.\n     */\n    async handleReceivedMessage(from, rpcMsg) {\n        this.metrics?.onMsgRecvPreValidation(rpcMsg.topic);\n        const validationResult = await this.validateReceivedMessage(from, rpcMsg);\n        this.metrics?.onPrevalidationResult(rpcMsg.topic, validationResult.code);\n        switch (validationResult.code) {\n            case MessageStatus.duplicate:\n                // Report the duplicate\n                this.score.duplicateMessage(from.toString(), validationResult.msgIdStr, rpcMsg.topic);\n                // due to the collision of fastMsgIdFn, 2 different messages may end up the same fastMsgId\n                // so we need to also mark the duplicate message as delivered or the promise is not resolved\n                // and peer gets penalized. See https://github.com/ChainSafe/js-libp2p-gossipsub/pull/385\n                this.gossipTracer.deliverMessage(validationResult.msgIdStr, true);\n                this.mcache.observeDuplicate(validationResult.msgIdStr, from.toString());\n                return;\n            case MessageStatus.invalid:\n                // invalid messages received\n                // metrics.register_invalid_message(&raw_message.topic)\n                // Tell peer_score about reject\n                // Reject the original source, and any duplicates we've seen from other peers.\n                if (validationResult.msgIdStr) {\n                    const msgIdStr = validationResult.msgIdStr;\n                    this.score.rejectMessage(from.toString(), msgIdStr, rpcMsg.topic, validationResult.reason);\n                    this.gossipTracer.rejectMessage(msgIdStr, validationResult.reason);\n                }\n                else {\n                    this.score.rejectInvalidMessage(from.toString(), rpcMsg.topic);\n                }\n                this.metrics?.onMsgRecvInvalid(rpcMsg.topic, validationResult);\n                return;\n            case MessageStatus.valid:\n                // Tells score that message arrived (but is maybe not fully validated yet).\n                // Consider the message as delivered for gossip promises.\n                this.score.validateMessage(validationResult.messageId.msgIdStr);\n                this.gossipTracer.deliverMessage(validationResult.messageId.msgIdStr);\n                // Add the message to our memcache\n                // if no validation is required, mark the message as validated\n                this.mcache.put(validationResult.messageId, rpcMsg, !this.opts.asyncValidation);\n                // Dispatch the message to the user if we are subscribed to the topic\n                if (this.subscriptions.has(rpcMsg.topic)) {\n                    const isFromSelf = this.components.peerId.equals(from);\n                    if (!isFromSelf || this.opts.emitSelf) {\n                        super.dispatchEvent(new CustomEvent('gossipsub:message', {\n                            detail: {\n                                propagationSource: from,\n                                msgId: validationResult.messageId.msgIdStr,\n                                msg: validationResult.msg\n                            }\n                        }));\n                        // TODO: Add option to switch between emit per topic or all messages in one\n                        super.dispatchEvent(new CustomEvent('message', { detail: validationResult.msg }));\n                    }\n                }\n                // Forward the message to mesh peers, if no validation is required\n                // If asyncValidation is ON, expect the app layer to call reportMessageValidationResult(), then forward\n                if (!this.opts.asyncValidation) {\n                    // TODO: in rust-libp2p\n                    // .forward_msg(&msg_id, raw_message, Some(propagation_source))\n                    this.forwardMessage(validationResult.messageId.msgIdStr, rpcMsg, from.toString());\n                }\n        }\n    }\n    /**\n     * Handles a newly received message from an RPC.\n     * May forward to all peers in the mesh.\n     */\n    async validateReceivedMessage(propagationSource, rpcMsg) {\n        // Fast message ID stuff\n        const fastMsgIdStr = this.fastMsgIdFn?.(rpcMsg);\n        const msgIdCached = fastMsgIdStr !== undefined ? this.fastMsgIdCache?.get(fastMsgIdStr) : undefined;\n        if (msgIdCached) {\n            // This message has been seen previously. Ignore it\n            return { code: MessageStatus.duplicate, msgIdStr: msgIdCached };\n        }\n        // Perform basic validation on message and convert to RawGossipsubMessage for fastMsgIdFn()\n        const validationResult = await validateToRawMessage(this.globalSignaturePolicy, rpcMsg);\n        if (!validationResult.valid) {\n            return { code: MessageStatus.invalid, reason: RejectReason.Error, error: validationResult.error };\n        }\n        const msg = validationResult.message;\n        // Try and perform the data transform to the message. If it fails, consider it invalid.\n        try {\n            if (this.dataTransform) {\n                msg.data = this.dataTransform.inboundTransform(rpcMsg.topic, msg.data);\n            }\n        }\n        catch (e) {\n            this.log('Invalid message, transform failed', e);\n            return { code: MessageStatus.invalid, reason: RejectReason.Error, error: ValidateError.TransformFailed };\n        }\n        // TODO: Check if message is from a blacklisted source or propagation origin\n        // - Reject any message from a blacklisted peer\n        // - Also reject any message that originated from a blacklisted peer\n        // - reject messages claiming to be from ourselves but not locally published\n        // Calculate the message id on the transformed data.\n        const msgId = await this.msgIdFn(msg);\n        const msgIdStr = this.msgIdToStrFn(msgId);\n        const messageId = { msgId, msgIdStr };\n        // Add the message to the duplicate caches\n        if (fastMsgIdStr !== undefined && this.fastMsgIdCache) {\n            const collision = this.fastMsgIdCache.put(fastMsgIdStr, msgIdStr);\n            if (collision) {\n                this.metrics?.fastMsgIdCacheCollision.inc();\n            }\n        }\n        if (this.seenCache.has(msgIdStr)) {\n            return { code: MessageStatus.duplicate, msgIdStr };\n        }\n        else {\n            this.seenCache.put(msgIdStr);\n        }\n        // (Optional) Provide custom validation here with dynamic validators per topic\n        // NOTE: This custom topicValidator() must resolve fast (< 100ms) to allow scores\n        // to not penalize peers for long validation times.\n        const topicValidator = this.topicValidators.get(rpcMsg.topic);\n        if (topicValidator != null) {\n            let acceptance;\n            // Use try {} catch {} in case topicValidator() is synchronous\n            try {\n                acceptance = await topicValidator(propagationSource, msg);\n            }\n            catch (e) {\n                const errCode = e.code;\n                if (errCode === constants.ERR_TOPIC_VALIDATOR_IGNORE)\n                    acceptance = TopicValidatorResult.Ignore;\n                if (errCode === constants.ERR_TOPIC_VALIDATOR_REJECT)\n                    acceptance = TopicValidatorResult.Reject;\n                else\n                    acceptance = TopicValidatorResult.Ignore;\n            }\n            if (acceptance !== TopicValidatorResult.Accept) {\n                return { code: MessageStatus.invalid, reason: rejectReasonFromAcceptance(acceptance), msgIdStr };\n            }\n        }\n        return { code: MessageStatus.valid, messageId, msg };\n    }\n    /**\n     * Return score of a peer.\n     */\n    getScore(peerId) {\n        return this.score.score(peerId);\n    }\n    /**\n     * Send an rpc object to a peer with subscriptions\n     */\n    sendSubscriptions(toPeer, topics, subscribe) {\n        this.sendRpc(toPeer, {\n            subscriptions: topics.map((topic) => ({ topic, subscribe }))\n        });\n    }\n    /**\n     * Handles an rpc control message from a peer\n     */\n    async handleControlMessage(id, controlMsg) {\n        if (controlMsg === undefined) {\n            return;\n        }\n        const iwant = controlMsg.ihave ? this.handleIHave(id, controlMsg.ihave) : [];\n        const ihave = controlMsg.iwant ? this.handleIWant(id, controlMsg.iwant) : [];\n        const prune = controlMsg.graft ? await this.handleGraft(id, controlMsg.graft) : [];\n        controlMsg.prune && (await this.handlePrune(id, controlMsg.prune));\n        if (!iwant.length && !ihave.length && !prune.length) {\n            return;\n        }\n        const sent = this.sendRpc(id, { messages: ihave, control: { iwant, prune } });\n        const iwantMessageIds = iwant[0]?.messageIDs;\n        if (iwantMessageIds) {\n            if (sent) {\n                this.gossipTracer.addPromise(id, iwantMessageIds);\n            }\n            else {\n                this.metrics?.iwantPromiseUntracked.inc(1);\n            }\n        }\n    }\n    /**\n     * Whether to accept a message from a peer\n     */\n    acceptFrom(id) {\n        if (this.direct.has(id)) {\n            return true;\n        }\n        const now = Date.now();\n        const entry = this.acceptFromWhitelist.get(id);\n        if (entry && entry.messagesAccepted < ACCEPT_FROM_WHITELIST_MAX_MESSAGES && entry.acceptUntil >= now) {\n            entry.messagesAccepted += 1;\n            return true;\n        }\n        const score = this.score.score(id);\n        if (score >= ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE) {\n            // peer is unlikely to be able to drop its score to `graylistThreshold`\n            // after 128 messages or 1s\n            this.acceptFromWhitelist.set(id, {\n                messagesAccepted: 0,\n                acceptUntil: now + ACCEPT_FROM_WHITELIST_DURATION_MS\n            });\n        }\n        else {\n            this.acceptFromWhitelist.delete(id);\n        }\n        return score >= this.opts.scoreThresholds.graylistThreshold;\n    }\n    /**\n     * Handles IHAVE messages\n     */\n    handleIHave(id, ihave) {\n        if (!ihave.length) {\n            return [];\n        }\n        // we ignore IHAVE gossip from any peer whose score is below the gossips threshold\n        const score = this.score.score(id);\n        if (score < this.opts.scoreThresholds.gossipThreshold) {\n            this.log('IHAVE: ignoring peer %s with score below threshold [ score = %d ]', id, score);\n            this.metrics?.ihaveRcvIgnored.inc({ reason: IHaveIgnoreReason.LowScore });\n            return [];\n        }\n        // IHAVE flood protection\n        const peerhave = (this.peerhave.get(id) ?? 0) + 1;\n        this.peerhave.set(id, peerhave);\n        if (peerhave > constants.GossipsubMaxIHaveMessages) {\n            this.log('IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring', id, peerhave);\n            this.metrics?.ihaveRcvIgnored.inc({ reason: IHaveIgnoreReason.MaxIhave });\n            return [];\n        }\n        const iasked = this.iasked.get(id) ?? 0;\n        if (iasked >= constants.GossipsubMaxIHaveLength) {\n            this.log('IHAVE: peer %s has already advertised too many messages (%d); ignoring', id, iasked);\n            this.metrics?.ihaveRcvIgnored.inc({ reason: IHaveIgnoreReason.MaxIasked });\n            return [];\n        }\n        // string msgId => msgId\n        const iwant = new Map();\n        ihave.forEach(({ topicID, messageIDs }) => {\n            if (!topicID || !messageIDs || !this.mesh.has(topicID)) {\n                return;\n            }\n            let idonthave = 0;\n            messageIDs.forEach((msgId) => {\n                const msgIdStr = this.msgIdToStrFn(msgId);\n                if (!this.seenCache.has(msgIdStr)) {\n                    iwant.set(msgIdStr, msgId);\n                    idonthave++;\n                }\n            });\n            this.metrics?.onIhaveRcv(topicID, messageIDs.length, idonthave);\n        });\n        if (!iwant.size) {\n            return [];\n        }\n        let iask = iwant.size;\n        if (iask + iasked > constants.GossipsubMaxIHaveLength) {\n            iask = constants.GossipsubMaxIHaveLength - iasked;\n        }\n        this.log('IHAVE: Asking for %d out of %d messages from %s', iask, iwant.size, id);\n        let iwantList = Array.from(iwant.values());\n        // ask in random order\n        shuffle(iwantList);\n        // truncate to the messages we are actually asking for and update the iasked counter\n        iwantList = iwantList.slice(0, iask);\n        this.iasked.set(id, iasked + iask);\n        // do not add gossipTracer promise here until a successful sendRpc()\n        return [\n            {\n                messageIDs: iwantList\n            }\n        ];\n    }\n    /**\n     * Handles IWANT messages\n     * Returns messages to send back to peer\n     */\n    handleIWant(id, iwant) {\n        if (!iwant.length) {\n            return [];\n        }\n        // we don't respond to IWANT requests from any per whose score is below the gossip threshold\n        const score = this.score.score(id);\n        if (score < this.opts.scoreThresholds.gossipThreshold) {\n            this.log('IWANT: ignoring peer %s with score below threshold [score = %d]', id, score);\n            return [];\n        }\n        const ihave = new Map();\n        const iwantByTopic = new Map();\n        let iwantDonthave = 0;\n        iwant.forEach(({ messageIDs }) => {\n            messageIDs &&\n                messageIDs.forEach((msgId) => {\n                    const msgIdStr = this.msgIdToStrFn(msgId);\n                    const entry = this.mcache.getWithIWantCount(msgIdStr, id);\n                    if (entry == null) {\n                        iwantDonthave++;\n                        return;\n                    }\n                    iwantByTopic.set(entry.msg.topic, 1 + (iwantByTopic.get(entry.msg.topic) ?? 0));\n                    if (entry.count > constants.GossipsubGossipRetransmission) {\n                        this.log('IWANT: Peer %s has asked for message %s too many times: ignoring request', id, msgId);\n                        return;\n                    }\n                    ihave.set(msgIdStr, entry.msg);\n                });\n        });\n        this.metrics?.onIwantRcv(iwantByTopic, iwantDonthave);\n        if (!ihave.size) {\n            this.log('IWANT: Could not provide any wanted messages to %s', id);\n            return [];\n        }\n        this.log('IWANT: Sending %d messages to %s', ihave.size, id);\n        return Array.from(ihave.values());\n    }\n    /**\n     * Handles Graft messages\n     */\n    async handleGraft(id, graft) {\n        const prune = [];\n        const score = this.score.score(id);\n        const now = Date.now();\n        let doPX = this.opts.doPX;\n        graft.forEach(({ topicID }) => {\n            if (!topicID) {\n                return;\n            }\n            const peersInMesh = this.mesh.get(topicID);\n            if (!peersInMesh) {\n                // don't do PX when there is an unknown topic to avoid leaking our peers\n                doPX = false;\n                // spam hardening: ignore GRAFTs for unknown topics\n                return;\n            }\n            // check if peer is already in the mesh; if so do nothing\n            if (peersInMesh.has(id)) {\n                return;\n            }\n            // we don't GRAFT to/from direct peers; complain loudly if this happens\n            if (this.direct.has(id)) {\n                this.log('GRAFT: ignoring request from direct peer %s', id);\n                // this is possibly a bug from a non-reciprical configuration; send a PRUNE\n                prune.push(topicID);\n                // but don't px\n                doPX = false;\n                return;\n            }\n            // make sure we are not backing off that peer\n            const expire = this.backoff.get(topicID)?.get(id);\n            if (typeof expire === 'number' && now < expire) {\n                this.log('GRAFT: ignoring backed off peer %s', id);\n                // add behavioral penalty\n                this.score.addPenalty(id, 1, ScorePenalty.GraftBackoff);\n                // no PX\n                doPX = false;\n                // check the flood cutoff -- is the GRAFT coming too fast?\n                const floodCutoff = expire + this.opts.graftFloodThreshold - this.opts.pruneBackoff;\n                if (now < floodCutoff) {\n                    // extra penalty\n                    this.score.addPenalty(id, 1, ScorePenalty.GraftBackoff);\n                }\n                // refresh the backoff\n                this.addBackoff(id, topicID);\n                prune.push(topicID);\n                return;\n            }\n            // check the score\n            if (score < 0) {\n                // we don't GRAFT peers with negative score\n                this.log('GRAFT: ignoring peer %s with negative score: score=%d, topic=%s', id, score, topicID);\n                // we do send them PRUNE however, because it's a matter of protocol correctness\n                prune.push(topicID);\n                // but we won't PX to them\n                doPX = false;\n                // add/refresh backoff so that we don't reGRAFT too early even if the score decays\n                this.addBackoff(id, topicID);\n                return;\n            }\n            // check the number of mesh peers; if it is at (or over) Dhi, we only accept grafts\n            // from peers with outbound connections; this is a defensive check to restrict potential\n            // mesh takeover attacks combined with love bombing\n            if (peersInMesh.size >= this.opts.Dhi && !this.outbound.get(id)) {\n                prune.push(topicID);\n                this.addBackoff(id, topicID);\n                return;\n            }\n            this.log('GRAFT: Add mesh link from %s in %s', id, topicID);\n            this.score.graft(id, topicID);\n            peersInMesh.add(id);\n            this.metrics?.onAddToMesh(topicID, InclusionReason.Subscribed, 1);\n        });\n        if (!prune.length) {\n            return [];\n        }\n        const onUnsubscribe = false;\n        return await Promise.all(prune.map((topic) => this.makePrune(id, topic, doPX, onUnsubscribe)));\n    }\n    /**\n     * Handles Prune messages\n     */\n    async handlePrune(id, prune) {\n        const score = this.score.score(id);\n        for (const { topicID, backoff, peers } of prune) {\n            if (topicID == null) {\n                continue;\n            }\n            const peersInMesh = this.mesh.get(topicID);\n            if (!peersInMesh) {\n                return;\n            }\n            this.log('PRUNE: Remove mesh link to %s in %s', id, topicID);\n            this.score.prune(id, topicID);\n            if (peersInMesh.has(id)) {\n                peersInMesh.delete(id);\n                this.metrics?.onRemoveFromMesh(topicID, ChurnReason.Prune, 1);\n            }\n            // is there a backoff specified by the peer? if so obey it\n            if (typeof backoff === 'number' && backoff > 0) {\n                this.doAddBackoff(id, topicID, backoff * 1000);\n            }\n            else {\n                this.addBackoff(id, topicID);\n            }\n            // PX\n            if (peers && peers.length) {\n                // we ignore PX from peers with insufficient scores\n                if (score < this.opts.scoreThresholds.acceptPXThreshold) {\n                    this.log('PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]', id, score, topicID);\n                    continue;\n                }\n                await this.pxConnect(peers);\n            }\n        }\n    }\n    /**\n     * Add standard backoff log for a peer in a topic\n     */\n    addBackoff(id, topic) {\n        this.doAddBackoff(id, topic, this.opts.pruneBackoff);\n    }\n    /**\n     * Add backoff expiry interval for a peer in a topic\n     *\n     * @param id\n     * @param topic\n     * @param intervalMs - backoff duration in milliseconds\n     */\n    doAddBackoff(id, topic, intervalMs) {\n        let backoff = this.backoff.get(topic);\n        if (!backoff) {\n            backoff = new Map();\n            this.backoff.set(topic, backoff);\n        }\n        const expire = Date.now() + intervalMs;\n        const existingExpire = backoff.get(id) ?? 0;\n        if (existingExpire < expire) {\n            backoff.set(id, expire);\n        }\n    }\n    /**\n     * Apply penalties from broken IHAVE/IWANT promises\n     */\n    applyIwantPenalties() {\n        this.gossipTracer.getBrokenPromises().forEach((count, p) => {\n            this.log(\"peer %s didn't follow up in %d IWANT requests; adding penalty\", p, count);\n            this.score.addPenalty(p, count, ScorePenalty.BrokenPromise);\n        });\n    }\n    /**\n     * Clear expired backoff expiries\n     */\n    clearBackoff() {\n        // we only clear once every GossipsubPruneBackoffTicks ticks to avoid iterating over the maps too much\n        if (this.heartbeatTicks % constants.GossipsubPruneBackoffTicks !== 0) {\n            return;\n        }\n        const now = Date.now();\n        this.backoff.forEach((backoff, topic) => {\n            backoff.forEach((expire, id) => {\n                // add some slack time to the expiration, see https://github.com/libp2p/specs/pull/289\n                if (expire + BACKOFF_SLACK * this.opts.heartbeatInterval < now) {\n                    backoff.delete(id);\n                }\n            });\n            if (backoff.size === 0) {\n                this.backoff.delete(topic);\n            }\n        });\n    }\n    /**\n     * Maybe reconnect to direct peers\n     */\n    async directConnect() {\n        const toconnect = [];\n        this.direct.forEach((id) => {\n            if (!this.streamsOutbound.has(id)) {\n                toconnect.push(id);\n            }\n        });\n        await Promise.all(toconnect.map(async (id) => await this.connect(id)));\n    }\n    /**\n     * Maybe attempt connection given signed peer records\n     */\n    async pxConnect(peers) {\n        if (peers.length > this.opts.prunePeers) {\n            shuffle(peers);\n            peers = peers.slice(0, this.opts.prunePeers);\n        }\n        const toconnect = [];\n        await Promise.all(peers.map(async (pi) => {\n            if (!pi.peerID) {\n                return;\n            }\n            const peer = peerIdFromBytes(pi.peerID);\n            const p = peer.toString();\n            if (this.peers.has(p)) {\n                return;\n            }\n            if (!pi.signedPeerRecord) {\n                toconnect.push(p);\n                return;\n            }\n            // The peer sent us a signed record\n            // This is not a record from the peer who sent the record, but another peer who is connected with it\n            // Ensure that it is valid\n            try {\n                if (!(await this.components.peerStore.consumePeerRecord(pi.signedPeerRecord, peer))) {\n                    this.log('bogus peer record obtained through px: could not add peer record to address book');\n                    return;\n                }\n                toconnect.push(p);\n            }\n            catch (e) {\n                this.log('bogus peer record obtained through px: invalid signature or not a peer record');\n            }\n        }));\n        if (!toconnect.length) {\n            return;\n        }\n        await Promise.all(toconnect.map(async (id) => await this.connect(id)));\n    }\n    /**\n     * Connect to a peer using the gossipsub protocol\n     */\n    async connect(id) {\n        this.log('Initiating connection with %s', id);\n        const peerId = peerIdFromString(id);\n        const connection = await this.components.connectionManager.openConnection(peerId);\n        for (const multicodec of this.multicodecs) {\n            for (const topology of this.components.registrar.getTopologies(multicodec)) {\n                topology.onConnect?.(peerId, connection);\n            }\n        }\n    }\n    /**\n     * Subscribes to a topic\n     */\n    subscribe(topic) {\n        if (this.status.code !== GossipStatusCode.started) {\n            throw new Error('Pubsub has not started');\n        }\n        if (!this.subscriptions.has(topic)) {\n            this.subscriptions.add(topic);\n            for (const peerId of this.peers.keys()) {\n                this.sendSubscriptions(peerId, [topic], true);\n            }\n        }\n        this.join(topic);\n    }\n    /**\n     * Unsubscribe to a topic\n     */\n    unsubscribe(topic) {\n        if (this.status.code !== GossipStatusCode.started) {\n            throw new Error('Pubsub is not started');\n        }\n        const wasSubscribed = this.subscriptions.delete(topic);\n        this.log('unsubscribe from %s - am subscribed %s', topic, wasSubscribed);\n        if (wasSubscribed) {\n            for (const peerId of this.peers.keys()) {\n                this.sendSubscriptions(peerId, [topic], false);\n            }\n        }\n        this.leave(topic);\n    }\n    /**\n     * Join topic\n     */\n    join(topic) {\n        if (this.status.code !== GossipStatusCode.started) {\n            throw new Error('Gossipsub has not started');\n        }\n        // if we are already in the mesh, return\n        if (this.mesh.has(topic)) {\n            return;\n        }\n        this.log('JOIN %s', topic);\n        this.metrics?.onJoin(topic);\n        const toAdd = new Set();\n        const backoff = this.backoff.get(topic);\n        // check if we have mesh_n peers in fanout[topic] and add them to the mesh if we do,\n        // removing the fanout entry.\n        const fanoutPeers = this.fanout.get(topic);\n        if (fanoutPeers) {\n            // Remove fanout entry and the last published time\n            this.fanout.delete(topic);\n            this.fanoutLastpub.delete(topic);\n            // remove explicit peers, peers with negative scores, and backoffed peers\n            fanoutPeers.forEach((id) => {\n                if (!this.direct.has(id) && this.score.score(id) >= 0 && (!backoff || !backoff.has(id))) {\n                    toAdd.add(id);\n                }\n            });\n            this.metrics?.onAddToMesh(topic, InclusionReason.Fanout, toAdd.size);\n        }\n        // check if we need to get more peers, which we randomly select\n        if (toAdd.size < this.opts.D) {\n            const fanoutCount = toAdd.size;\n            const newPeers = this.getRandomGossipPeers(topic, this.opts.D, (id) => \n            // filter direct peers and peers with negative score\n            !toAdd.has(id) && !this.direct.has(id) && this.score.score(id) >= 0 && (!backoff || !backoff.has(id)));\n            newPeers.forEach((peer) => {\n                toAdd.add(peer);\n            });\n            this.metrics?.onAddToMesh(topic, InclusionReason.Random, toAdd.size - fanoutCount);\n        }\n        this.mesh.set(topic, toAdd);\n        toAdd.forEach((id) => {\n            this.log('JOIN: Add mesh link to %s in %s', id, topic);\n            this.sendGraft(id, topic);\n            // rust-libp2p\n            // - peer_score.graft()\n            // - Self::control_pool_add()\n            // - peer_added_to_mesh()\n        });\n    }\n    /**\n     * Leave topic\n     */\n    leave(topic) {\n        if (this.status.code !== GossipStatusCode.started) {\n            throw new Error('Gossipsub has not started');\n        }\n        this.log('LEAVE %s', topic);\n        this.metrics?.onLeave(topic);\n        // Send PRUNE to mesh peers\n        const meshPeers = this.mesh.get(topic);\n        if (meshPeers) {\n            Promise.all(Array.from(meshPeers).map(async (id) => {\n                this.log('LEAVE: Remove mesh link to %s in %s', id, topic);\n                return await this.sendPrune(id, topic);\n            })).catch((err) => {\n                this.log('Error sending prunes to mesh peers', err);\n            });\n            this.mesh.delete(topic);\n        }\n    }\n    selectPeersToForward(topic, propagationSource, excludePeers) {\n        const tosend = new Set();\n        // Add explicit peers\n        const peersInTopic = this.topics.get(topic);\n        if (peersInTopic) {\n            this.direct.forEach((peer) => {\n                if (peersInTopic.has(peer) && propagationSource !== peer && !excludePeers?.has(peer)) {\n                    tosend.add(peer);\n                }\n            });\n            // As of Mar 2022, spec + golang-libp2p include this while rust-libp2p does not\n            // rust-libp2p: https://github.com/libp2p/rust-libp2p/blob/6cc3b4ec52c922bfcf562a29b5805c3150e37c75/protocols/gossipsub/src/behaviour.rs#L2693\n            // spec: https://github.com/libp2p/specs/blob/10712c55ab309086a52eec7d25f294df4fa96528/pubsub/gossipsub/gossipsub-v1.0.md?plain=1#L361\n            this.floodsubPeers.forEach((peer) => {\n                if (peersInTopic.has(peer) &&\n                    propagationSource !== peer &&\n                    !excludePeers?.has(peer) &&\n                    this.score.score(peer) >= this.opts.scoreThresholds.publishThreshold) {\n                    tosend.add(peer);\n                }\n            });\n        }\n        // add mesh peers\n        const meshPeers = this.mesh.get(topic);\n        if (meshPeers && meshPeers.size > 0) {\n            meshPeers.forEach((peer) => {\n                if (propagationSource !== peer && !excludePeers?.has(peer)) {\n                    tosend.add(peer);\n                }\n            });\n        }\n        return tosend;\n    }\n    selectPeersToPublish(topic) {\n        const tosend = new Set();\n        const tosendCount = {\n            direct: 0,\n            floodsub: 0,\n            mesh: 0,\n            fanout: 0\n        };\n        const peersInTopic = this.topics.get(topic);\n        if (peersInTopic) {\n            // flood-publish behavior\n            // send to direct peers and _all_ peers meeting the publishThreshold\n            if (this.opts.floodPublish) {\n                peersInTopic.forEach((id) => {\n                    if (this.direct.has(id)) {\n                        tosend.add(id);\n                        tosendCount.direct++;\n                    }\n                    else if (this.score.score(id) >= this.opts.scoreThresholds.publishThreshold) {\n                        tosend.add(id);\n                        tosendCount.floodsub++;\n                    }\n                });\n            }\n            else {\n                // non-flood-publish behavior\n                // send to direct peers, subscribed floodsub peers\n                // and some mesh peers above publishThreshold\n                // direct peers (if subscribed)\n                this.direct.forEach((id) => {\n                    if (peersInTopic.has(id)) {\n                        tosend.add(id);\n                        tosendCount.direct++;\n                    }\n                });\n                // floodsub peers\n                // Note: if there are no floodsub peers, we save a loop through peersInTopic Map\n                this.floodsubPeers.forEach((id) => {\n                    if (peersInTopic.has(id) && this.score.score(id) >= this.opts.scoreThresholds.publishThreshold) {\n                        tosend.add(id);\n                        tosendCount.floodsub++;\n                    }\n                });\n                // Gossipsub peers handling\n                const meshPeers = this.mesh.get(topic);\n                if (meshPeers && meshPeers.size > 0) {\n                    meshPeers.forEach((peer) => {\n                        tosend.add(peer);\n                        tosendCount.mesh++;\n                    });\n                }\n                // We are not in the mesh for topic, use fanout peers\n                else {\n                    const fanoutPeers = this.fanout.get(topic);\n                    if (fanoutPeers && fanoutPeers.size > 0) {\n                        fanoutPeers.forEach((peer) => {\n                            tosend.add(peer);\n                            tosendCount.fanout++;\n                        });\n                    }\n                    // We have no fanout peers, select mesh_n of them and add them to the fanout\n                    else {\n                        // If we are not in the fanout, then pick peers in topic above the publishThreshold\n                        const newFanoutPeers = this.getRandomGossipPeers(topic, this.opts.D, (id) => {\n                            return this.score.score(id) >= this.opts.scoreThresholds.publishThreshold;\n                        });\n                        if (newFanoutPeers.size > 0) {\n                            // eslint-disable-line max-depth\n                            this.fanout.set(topic, newFanoutPeers);\n                            newFanoutPeers.forEach((peer) => {\n                                // eslint-disable-line max-depth\n                                tosend.add(peer);\n                                tosendCount.fanout++;\n                            });\n                        }\n                    }\n                    // We are publishing to fanout peers - update the time we published\n                    this.fanoutLastpub.set(topic, Date.now());\n                }\n            }\n        }\n        return { tosend, tosendCount };\n    }\n    /**\n     * Forwards a message from our peers.\n     *\n     * For messages published by us (the app layer), this class uses `publish`\n     */\n    forwardMessage(msgIdStr, rawMsg, propagationSource, excludePeers) {\n        // message is fully validated inform peer_score\n        if (propagationSource) {\n            this.score.deliverMessage(propagationSource, msgIdStr, rawMsg.topic);\n        }\n        const tosend = this.selectPeersToForward(rawMsg.topic, propagationSource, excludePeers);\n        // Note: Don't throw if tosend is empty, we can have a mesh with a single peer\n        // forward the message to peers\n        tosend.forEach((id) => {\n            // sendRpc may mutate RPC message on piggyback, create a new message for each peer\n            this.sendRpc(id, { messages: [rawMsg] });\n        });\n        this.metrics?.onForwardMsg(rawMsg.topic, tosend.size);\n    }\n    /**\n     * App layer publishes a message to peers, return number of peers this message is published to\n     * Note: `async` due to crypto only if `StrictSign`, otherwise it's a sync fn.\n     *\n     * For messages not from us, this class uses `forwardMessage`.\n     */\n    async publish(topic, data, opts) {\n        const startMs = Date.now();\n        const transformedData = this.dataTransform ? this.dataTransform.outboundTransform(topic, data) : data;\n        if (this.publishConfig == null) {\n            throw Error('PublishError.Uninitialized');\n        }\n        // Prepare raw message with user's publishConfig\n        const { raw: rawMsg, msg } = await buildRawMessage(this.publishConfig, topic, data, transformedData);\n        // calculate the message id from the un-transformed data\n        const msgId = await this.msgIdFn(msg);\n        const msgIdStr = this.msgIdToStrFn(msgId);\n        // Current publish opt takes precedence global opts, while preserving false value\n        const ignoreDuplicatePublishError = opts?.ignoreDuplicatePublishError ?? this.opts.ignoreDuplicatePublishError;\n        if (this.seenCache.has(msgIdStr)) {\n            // This message has already been seen. We don't re-publish messages that have already\n            // been published on the network.\n            if (ignoreDuplicatePublishError) {\n                this.metrics?.onPublishDuplicateMsg(topic);\n                return { recipients: [] };\n            }\n            throw Error('PublishError.Duplicate');\n        }\n        const { tosend, tosendCount } = this.selectPeersToPublish(topic);\n        const willSendToSelf = this.opts.emitSelf === true && this.subscriptions.has(topic);\n        // Current publish opt takes precedence global opts, while preserving false value\n        const allowPublishToZeroPeers = opts?.allowPublishToZeroPeers ?? this.opts.allowPublishToZeroPeers;\n        if (tosend.size === 0 && !allowPublishToZeroPeers && !willSendToSelf) {\n            throw Error('PublishError.InsufficientPeers');\n        }\n        // If the message isn't a duplicate and we have sent it to some peers add it to the\n        // duplicate cache and memcache.\n        this.seenCache.put(msgIdStr);\n        // all published messages are valid\n        this.mcache.put({ msgId, msgIdStr }, rawMsg, true);\n        // If the message is anonymous or has a random author add it to the published message ids cache.\n        this.publishedMessageIds.put(msgIdStr);\n        // Send to set of peers aggregated from direct, mesh, fanout\n        for (const id of tosend) {\n            // sendRpc may mutate RPC message on piggyback, create a new message for each peer\n            const sent = this.sendRpc(id, { messages: [rawMsg] });\n            // did not actually send the message\n            if (!sent) {\n                tosend.delete(id);\n            }\n        }\n        const durationMs = Date.now() - startMs;\n        this.metrics?.onPublishMsg(topic, tosendCount, tosend.size, rawMsg.data != null ? rawMsg.data.length : 0, durationMs);\n        // Dispatch the message to the user if we are subscribed to the topic\n        if (willSendToSelf) {\n            tosend.add(this.components.peerId.toString());\n            super.dispatchEvent(new CustomEvent('gossipsub:message', {\n                detail: {\n                    propagationSource: this.components.peerId,\n                    msgId: msgIdStr,\n                    msg\n                }\n            }));\n            // TODO: Add option to switch between emit per topic or all messages in one\n            super.dispatchEvent(new CustomEvent('message', { detail: msg }));\n        }\n        return {\n            recipients: Array.from(tosend.values()).map((str) => peerIdFromString(str))\n        };\n    }\n    /**\n     * This function should be called when `asyncValidation` is `true` after\n     * the message got validated by the caller. Messages are stored in the `mcache` and\n     * validation is expected to be fast enough that the messages should still exist in the cache.\n     * There are three possible validation outcomes and the outcome is given in acceptance.\n     *\n     * If acceptance = `MessageAcceptance.Accept` the message will get propagated to the\n     * network. The `propagation_source` parameter indicates who the message was received by and\n     * will not be forwarded back to that peer.\n     *\n     * If acceptance = `MessageAcceptance.Reject` the message will be deleted from the memcache\n     * and the P₄ penalty will be applied to the `propagationSource`.\n     *\n     * If acceptance = `MessageAcceptance.Ignore` the message will be deleted from the memcache\n     * but no P₄ penalty will be applied.\n     *\n     * This function will return true if the message was found in the cache and false if was not\n     * in the cache anymore.\n     *\n     * This should only be called once per message.\n     */\n    reportMessageValidationResult(msgId, propagationSource, acceptance) {\n        let cacheEntry;\n        if (acceptance === TopicValidatorResult.Accept) {\n            cacheEntry = this.mcache.validate(msgId);\n            if (cacheEntry != null) {\n                const { message: rawMsg, originatingPeers } = cacheEntry;\n                // message is fully validated inform peer_score\n                this.score.deliverMessage(propagationSource, msgId, rawMsg.topic);\n                this.forwardMessage(msgId, cacheEntry.message, propagationSource, originatingPeers);\n            }\n            // else, Message not in cache. Ignoring forwarding\n        }\n        // Not valid\n        else {\n            cacheEntry = this.mcache.remove(msgId);\n            if (cacheEntry) {\n                const rejectReason = rejectReasonFromAcceptance(acceptance);\n                const { message: rawMsg, originatingPeers } = cacheEntry;\n                // Tell peer_score about reject\n                // Reject the original source, and any duplicates we've seen from other peers.\n                this.score.rejectMessage(propagationSource, msgId, rawMsg.topic, rejectReason);\n                for (const peer of originatingPeers) {\n                    this.score.rejectMessage(peer, msgId, rawMsg.topic, rejectReason);\n                }\n            }\n            // else, Message not in cache. Ignoring forwarding\n        }\n        const firstSeenTimestampMs = this.score.messageFirstSeenTimestampMs(msgId);\n        this.metrics?.onReportValidation(cacheEntry, acceptance, firstSeenTimestampMs);\n    }\n    /**\n     * Sends a GRAFT message to a peer\n     */\n    sendGraft(id, topic) {\n        const graft = [\n            {\n                topicID: topic\n            }\n        ];\n        this.sendRpc(id, { control: { graft } });\n    }\n    /**\n     * Sends a PRUNE message to a peer\n     */\n    async sendPrune(id, topic) {\n        // this is only called from leave() function\n        const onUnsubscribe = true;\n        const prune = [await this.makePrune(id, topic, this.opts.doPX, onUnsubscribe)];\n        this.sendRpc(id, { control: { prune } });\n    }\n    /**\n     * Send an rpc object to a peer\n     */\n    sendRpc(id, rpc) {\n        const outboundStream = this.streamsOutbound.get(id);\n        if (!outboundStream) {\n            this.log(`Cannot send RPC to ${id} as there is no open stream to it available`);\n            return false;\n        }\n        // piggyback control message retries\n        const ctrl = this.control.get(id);\n        if (ctrl) {\n            this.piggybackControl(id, rpc, ctrl);\n            this.control.delete(id);\n        }\n        // piggyback gossip\n        const ihave = this.gossip.get(id);\n        if (ihave) {\n            this.piggybackGossip(id, rpc, ihave);\n            this.gossip.delete(id);\n        }\n        const rpcBytes = RPC.encode(rpc).finish();\n        try {\n            outboundStream.push(rpcBytes);\n        }\n        catch (e) {\n            this.log.error(`Cannot send rpc to ${id}`, e);\n            // if the peer had control messages or gossip, re-attach\n            if (ctrl) {\n                this.control.set(id, ctrl);\n            }\n            if (ihave) {\n                this.gossip.set(id, ihave);\n            }\n            return false;\n        }\n        this.metrics?.onRpcSent(rpc, rpcBytes.length);\n        return true;\n    }\n    /** Mutates `outRpc` adding graft and prune control messages */\n    piggybackControl(id, outRpc, ctrl) {\n        if (ctrl.graft) {\n            if (!outRpc.control)\n                outRpc.control = {};\n            if (!outRpc.control.graft)\n                outRpc.control.graft = [];\n            for (const graft of ctrl.graft) {\n                if (graft.topicID && this.mesh.get(graft.topicID)?.has(id)) {\n                    outRpc.control.graft.push(graft);\n                }\n            }\n        }\n        if (ctrl.prune) {\n            if (!outRpc.control)\n                outRpc.control = {};\n            if (!outRpc.control.prune)\n                outRpc.control.prune = [];\n            for (const prune of ctrl.prune) {\n                if (prune.topicID && !this.mesh.get(prune.topicID)?.has(id)) {\n                    outRpc.control.prune.push(prune);\n                }\n            }\n        }\n    }\n    /** Mutates `outRpc` adding ihave control messages */\n    piggybackGossip(id, outRpc, ihave) {\n        if (!outRpc.control)\n            outRpc.control = {};\n        outRpc.control.ihave = ihave;\n    }\n    /**\n     * Send graft and prune messages\n     *\n     * @param tograft - peer id => topic[]\n     * @param toprune - peer id => topic[]\n     */\n    async sendGraftPrune(tograft, toprune, noPX) {\n        const doPX = this.opts.doPX;\n        const onUnsubscribe = false;\n        for (const [id, topics] of tograft) {\n            const graft = topics.map((topicID) => ({ topicID }));\n            let prune = [];\n            // If a peer also has prunes, process them now\n            const pruning = toprune.get(id);\n            if (pruning) {\n                prune = await Promise.all(pruning.map(async (topicID) => await this.makePrune(id, topicID, doPX && !(noPX.get(id) ?? false), onUnsubscribe)));\n                toprune.delete(id);\n            }\n            this.sendRpc(id, { control: { graft, prune } });\n        }\n        for (const [id, topics] of toprune) {\n            const prune = await Promise.all(topics.map(async (topicID) => await this.makePrune(id, topicID, doPX && !(noPX.get(id) ?? false), onUnsubscribe)));\n            this.sendRpc(id, { control: { prune } });\n        }\n    }\n    /**\n     * Emits gossip - Send IHAVE messages to a random set of gossip peers\n     */\n    emitGossip(peersToGossipByTopic) {\n        const gossipIDsByTopic = this.mcache.getGossipIDs(new Set(peersToGossipByTopic.keys()));\n        for (const [topic, peersToGossip] of peersToGossipByTopic) {\n            this.doEmitGossip(topic, peersToGossip, gossipIDsByTopic.get(topic) ?? []);\n        }\n    }\n    /**\n     * Send gossip messages to GossipFactor peers above threshold with a minimum of D_lazy\n     * Peers are randomly selected from the heartbeat which exclude mesh + fanout peers\n     * We also exclude direct peers, as there is no reason to emit gossip to them\n     * @param topic\n     * @param candidateToGossip - peers to gossip\n     * @param messageIDs - message ids to gossip\n     */\n    doEmitGossip(topic, candidateToGossip, messageIDs) {\n        if (!messageIDs.length) {\n            return;\n        }\n        // shuffle to emit in random order\n        shuffle(messageIDs);\n        // if we are emitting more than GossipsubMaxIHaveLength ids, truncate the list\n        if (messageIDs.length > constants.GossipsubMaxIHaveLength) {\n            // we do the truncation (with shuffling) per peer below\n            this.log('too many messages for gossip; will truncate IHAVE list (%d messages)', messageIDs.length);\n        }\n        if (!candidateToGossip.size)\n            return;\n        let target = this.opts.Dlazy;\n        const factor = constants.GossipsubGossipFactor * candidateToGossip.size;\n        let peersToGossip = candidateToGossip;\n        if (factor > target) {\n            target = factor;\n        }\n        if (target > peersToGossip.size) {\n            target = peersToGossip.size;\n        }\n        else {\n            // only shuffle if needed\n            peersToGossip = shuffle(Array.from(peersToGossip)).slice(0, target);\n        }\n        // Emit the IHAVE gossip to the selected peers up to the target\n        peersToGossip.forEach((id) => {\n            let peerMessageIDs = messageIDs;\n            if (messageIDs.length > constants.GossipsubMaxIHaveLength) {\n                // shuffle and slice message IDs per peer so that we emit a different set for each peer\n                // we have enough reduncancy in the system that this will significantly increase the message\n                // coverage when we do truncate\n                peerMessageIDs = shuffle(peerMessageIDs.slice()).slice(0, constants.GossipsubMaxIHaveLength);\n            }\n            this.pushGossip(id, {\n                topicID: topic,\n                messageIDs: peerMessageIDs\n            });\n        });\n    }\n    /**\n     * Flush gossip and control messages\n     */\n    flush() {\n        // send gossip first, which will also piggyback control\n        for (const [peer, ihave] of this.gossip.entries()) {\n            this.gossip.delete(peer);\n            this.sendRpc(peer, { control: { ihave } });\n        }\n        // send the remaining control messages\n        for (const [peer, control] of this.control.entries()) {\n            this.control.delete(peer);\n            this.sendRpc(peer, { control: { graft: control.graft, prune: control.prune } });\n        }\n    }\n    /**\n     * Adds new IHAVE messages to pending gossip\n     */\n    pushGossip(id, controlIHaveMsgs) {\n        this.log('Add gossip to %s', id);\n        const gossip = this.gossip.get(id) || [];\n        this.gossip.set(id, gossip.concat(controlIHaveMsgs));\n    }\n    /**\n     * Make a PRUNE control message for a peer in a topic\n     */\n    async makePrune(id, topic, doPX, onUnsubscribe) {\n        this.score.prune(id, topic);\n        if (this.streamsOutbound.get(id).protocol === constants.GossipsubIDv10) {\n            // Gossipsub v1.0 -- no backoff, the peer won't be able to parse it anyway\n            return {\n                topicID: topic,\n                peers: []\n            };\n        }\n        // backoff is measured in seconds\n        // GossipsubPruneBackoff and GossipsubUnsubscribeBackoff are measured in milliseconds\n        // The protobuf has it as a uint64\n        const backoffMs = onUnsubscribe ? this.opts.unsubcribeBackoff : this.opts.pruneBackoff;\n        const backoff = backoffMs / 1000;\n        this.doAddBackoff(id, topic, backoffMs);\n        if (!doPX) {\n            return {\n                topicID: topic,\n                peers: [],\n                backoff: backoff\n            };\n        }\n        // select peers for Peer eXchange\n        const peers = this.getRandomGossipPeers(topic, this.opts.prunePeers, (xid) => {\n            return xid !== id && this.score.score(xid) >= 0;\n        });\n        const px = await Promise.all(Array.from(peers).map(async (peerId) => {\n            // see if we have a signed record to send back; if we don't, just send\n            // the peer ID and let the pruned peer find them in the DHT -- we can't trust\n            // unsigned address records through PX anyways\n            // Finding signed records in the DHT is not supported at the time of writing in js-libp2p\n            const id = peerIdFromString(peerId);\n            let peerInfo;\n            try {\n                peerInfo = await this.components.peerStore.get(id);\n            }\n            catch (err) {\n                if (err.code !== 'ERR_NOT_FOUND') {\n                    throw err;\n                }\n            }\n            return {\n                peerID: id.toBytes(),\n                signedPeerRecord: peerInfo?.peerRecordEnvelope\n            };\n        }));\n        return {\n            topicID: topic,\n            peers: px,\n            backoff: backoff\n        };\n    }\n    runHeartbeat = () => {\n        const timer = this.metrics?.heartbeatDuration.startTimer();\n        this.heartbeat()\n            .catch((err) => {\n            this.log('Error running heartbeat', err);\n        })\n            .finally(() => {\n            if (timer != null) {\n                timer();\n            }\n            // Schedule the next run if still in started status\n            if (this.status.code === GossipStatusCode.started) {\n                // Clear previous timeout before overwriting `status.heartbeatTimeout`, it should be completed tho.\n                clearTimeout(this.status.heartbeatTimeout);\n                // NodeJS setInterval function is innexact, calls drift by a few miliseconds on each call.\n                // To run the heartbeat precisely setTimeout() must be used recomputing the delay on every loop.\n                let msToNextHeartbeat = this.opts.heartbeatInterval - ((Date.now() - this.status.hearbeatStartMs) % this.opts.heartbeatInterval);\n                // If too close to next heartbeat, skip one\n                if (msToNextHeartbeat < this.opts.heartbeatInterval * 0.25) {\n                    msToNextHeartbeat += this.opts.heartbeatInterval;\n                    this.metrics?.heartbeatSkipped.inc();\n                }\n                this.status.heartbeatTimeout = setTimeout(this.runHeartbeat, msToNextHeartbeat);\n            }\n        });\n    };\n    /**\n     * Maintains the mesh and fanout maps in gossipsub.\n     */\n    async heartbeat() {\n        const { D, Dlo, Dhi, Dscore, Dout, fanoutTTL } = this.opts;\n        this.heartbeatTicks++;\n        // cache scores throught the heartbeat\n        const scores = new Map();\n        const getScore = (id) => {\n            let s = scores.get(id);\n            if (s === undefined) {\n                s = this.score.score(id);\n                scores.set(id, s);\n            }\n            return s;\n        };\n        // peer id => topic[]\n        const tograft = new Map();\n        // peer id => topic[]\n        const toprune = new Map();\n        // peer id => don't px\n        const noPX = new Map();\n        // clean up expired backoffs\n        this.clearBackoff();\n        // clean up peerhave/iasked counters\n        this.peerhave.clear();\n        this.metrics?.cacheSize.set({ cache: 'iasked' }, this.iasked.size);\n        this.iasked.clear();\n        // apply IWANT request penalties\n        this.applyIwantPenalties();\n        // ensure direct peers are connected\n        if (this.heartbeatTicks % this.opts.directConnectTicks === 0) {\n            // we only do this every few ticks to allow pending connections to complete and account for restarts/downtime\n            await this.directConnect();\n        }\n        // EXTRA: Prune caches\n        this.fastMsgIdCache?.prune();\n        this.seenCache.prune();\n        this.gossipTracer.prune();\n        this.publishedMessageIds.prune();\n        /**\n         * Instead of calling getRandomGossipPeers multiple times to:\n         *   + get more mesh peers\n         *   + more outbound peers\n         *   + oppportunistic grafting\n         *   + emitGossip\n         *\n         * We want to loop through the topic peers only a single time and prepare gossip peers for all topics to improve the performance\n         */\n        const peersToGossipByTopic = new Map();\n        // maintain the mesh for topics we have joined\n        this.mesh.forEach((peers, topic) => {\n            const peersInTopic = this.topics.get(topic);\n            const candidateMeshPeers = new Set();\n            const peersToGossip = new Set();\n            peersToGossipByTopic.set(topic, peersToGossip);\n            if (peersInTopic) {\n                const shuffledPeers = shuffle(Array.from(peersInTopic));\n                const backoff = this.backoff.get(topic);\n                for (const id of shuffledPeers) {\n                    const peerStreams = this.streamsOutbound.get(id);\n                    if (peerStreams &&\n                        this.multicodecs.includes(peerStreams.protocol) &&\n                        !peers.has(id) &&\n                        !this.direct.has(id)) {\n                        const score = getScore(id);\n                        if ((!backoff || !backoff.has(id)) && score >= 0)\n                            candidateMeshPeers.add(id);\n                        // instead of having to find gossip peers after heartbeat which require another loop\n                        // we prepare peers to gossip in a topic within heartbeat to improve performance\n                        if (score >= this.opts.scoreThresholds.gossipThreshold)\n                            peersToGossip.add(id);\n                    }\n                }\n            }\n            // prune/graft helper functions (defined per topic)\n            const prunePeer = (id, reason) => {\n                this.log('HEARTBEAT: Remove mesh link to %s in %s', id, topic);\n                // no need to update peer score here as we do it in makePrune\n                // add prune backoff record\n                this.addBackoff(id, topic);\n                // remove peer from mesh\n                peers.delete(id);\n                // after pruning a peer from mesh, we want to gossip topic to it if its score meet the gossip threshold\n                if (getScore(id) >= this.opts.scoreThresholds.gossipThreshold)\n                    peersToGossip.add(id);\n                this.metrics?.onRemoveFromMesh(topic, reason, 1);\n                // add to toprune\n                const topics = toprune.get(id);\n                if (!topics) {\n                    toprune.set(id, [topic]);\n                }\n                else {\n                    topics.push(topic);\n                }\n            };\n            const graftPeer = (id, reason) => {\n                this.log('HEARTBEAT: Add mesh link to %s in %s', id, topic);\n                // update peer score\n                this.score.graft(id, topic);\n                // add peer to mesh\n                peers.add(id);\n                // when we add a new mesh peer, we don't want to gossip messages to it\n                peersToGossip.delete(id);\n                this.metrics?.onAddToMesh(topic, reason, 1);\n                // add to tograft\n                const topics = tograft.get(id);\n                if (!topics) {\n                    tograft.set(id, [topic]);\n                }\n                else {\n                    topics.push(topic);\n                }\n            };\n            // drop all peers with negative score, without PX\n            peers.forEach((id) => {\n                const score = getScore(id);\n                // Record the score\n                if (score < 0) {\n                    this.log('HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s', id, score, topic);\n                    prunePeer(id, ChurnReason.BadScore);\n                    noPX.set(id, true);\n                }\n            });\n            // do we have enough peers?\n            if (peers.size < Dlo) {\n                const ineed = D - peers.size;\n                // slice up to first `ineed` items and remove them from candidateMeshPeers\n                // same to `const newMeshPeers = candidateMeshPeers.slice(0, ineed)`\n                const newMeshPeers = removeFirstNItemsFromSet(candidateMeshPeers, ineed);\n                newMeshPeers.forEach((p) => {\n                    graftPeer(p, InclusionReason.NotEnough);\n                });\n            }\n            // do we have to many peers?\n            if (peers.size > Dhi) {\n                let peersArray = Array.from(peers);\n                // sort by score\n                peersArray.sort((a, b) => getScore(b) - getScore(a));\n                // We keep the first D_score peers by score and the remaining up to D randomly\n                // under the constraint that we keep D_out peers in the mesh (if we have that many)\n                peersArray = peersArray.slice(0, Dscore).concat(shuffle(peersArray.slice(Dscore)));\n                // count the outbound peers we are keeping\n                let outbound = 0;\n                peersArray.slice(0, D).forEach((p) => {\n                    if (this.outbound.get(p)) {\n                        outbound++;\n                    }\n                });\n                // if it's less than D_out, bubble up some outbound peers from the random selection\n                if (outbound < Dout) {\n                    const rotate = (i) => {\n                        // rotate the peersArray to the right and put the ith peer in the front\n                        const p = peersArray[i];\n                        for (let j = i; j > 0; j--) {\n                            peersArray[j] = peersArray[j - 1];\n                        }\n                        peersArray[0] = p;\n                    };\n                    // first bubble up all outbound peers already in the selection to the front\n                    if (outbound > 0) {\n                        let ihave = outbound;\n                        for (let i = 1; i < D && ihave > 0; i++) {\n                            if (this.outbound.get(peersArray[i])) {\n                                rotate(i);\n                                ihave--;\n                            }\n                        }\n                    }\n                    // now bubble up enough outbound peers outside the selection to the front\n                    let ineed = D - outbound;\n                    for (let i = D; i < peersArray.length && ineed > 0; i++) {\n                        if (this.outbound.get(peersArray[i])) {\n                            rotate(i);\n                            ineed--;\n                        }\n                    }\n                }\n                // prune the excess peers\n                peersArray.slice(D).forEach((p) => {\n                    prunePeer(p, ChurnReason.Excess);\n                });\n            }\n            // do we have enough outbound peers?\n            if (peers.size >= Dlo) {\n                // count the outbound peers we have\n                let outbound = 0;\n                peers.forEach((p) => {\n                    if (this.outbound.get(p)) {\n                        outbound++;\n                    }\n                });\n                // if it's less than D_out, select some peers with outbound connections and graft them\n                if (outbound < Dout) {\n                    const ineed = Dout - outbound;\n                    const newMeshPeers = removeItemsFromSet(candidateMeshPeers, ineed, (id) => this.outbound.get(id) === true);\n                    newMeshPeers.forEach((p) => {\n                        graftPeer(p, InclusionReason.Outbound);\n                    });\n                }\n            }\n            // should we try to improve the mesh with opportunistic grafting?\n            if (this.heartbeatTicks % this.opts.opportunisticGraftTicks === 0 && peers.size > 1) {\n                // Opportunistic grafting works as follows: we check the median score of peers in the\n                // mesh; if this score is below the opportunisticGraftThreshold, we select a few peers at\n                // random with score over the median.\n                // The intention is to (slowly) improve an underperforming mesh by introducing good\n                // scoring peers that may have been gossiping at us. This allows us to get out of sticky\n                // situations where we are stuck with poor peers and also recover from churn of good peers.\n                // now compute the median peer score in the mesh\n                const peersList = Array.from(peers).sort((a, b) => getScore(a) - getScore(b));\n                const medianIndex = Math.floor(peers.size / 2);\n                const medianScore = getScore(peersList[medianIndex]);\n                // if the median score is below the threshold, select a better peer (if any) and GRAFT\n                if (medianScore < this.opts.scoreThresholds.opportunisticGraftThreshold) {\n                    const ineed = this.opts.opportunisticGraftPeers;\n                    const newMeshPeers = removeItemsFromSet(candidateMeshPeers, ineed, (id) => getScore(id) > medianScore);\n                    for (const id of newMeshPeers) {\n                        this.log('HEARTBEAT: Opportunistically graft peer %s on topic %s', id, topic);\n                        graftPeer(id, InclusionReason.Opportunistic);\n                    }\n                }\n            }\n        });\n        // expire fanout for topics we haven't published to in a while\n        const now = Date.now();\n        this.fanoutLastpub.forEach((lastpb, topic) => {\n            if (lastpb + fanoutTTL < now) {\n                this.fanout.delete(topic);\n                this.fanoutLastpub.delete(topic);\n            }\n        });\n        // maintain our fanout for topics we are publishing but we have not joined\n        this.fanout.forEach((fanoutPeers, topic) => {\n            // checks whether our peers are still in the topic and have a score above the publish threshold\n            const topicPeers = this.topics.get(topic);\n            fanoutPeers.forEach((id) => {\n                if (!topicPeers.has(id) || getScore(id) < this.opts.scoreThresholds.publishThreshold) {\n                    fanoutPeers.delete(id);\n                }\n            });\n            const peersInTopic = this.topics.get(topic);\n            const candidateFanoutPeers = [];\n            // the fanout map contains topics to which we are not subscribed.\n            const peersToGossip = new Set();\n            peersToGossipByTopic.set(topic, peersToGossip);\n            if (peersInTopic) {\n                const shuffledPeers = shuffle(Array.from(peersInTopic));\n                for (const id of shuffledPeers) {\n                    const peerStreams = this.streamsOutbound.get(id);\n                    if (peerStreams &&\n                        this.multicodecs.includes(peerStreams.protocol) &&\n                        !fanoutPeers.has(id) &&\n                        !this.direct.has(id)) {\n                        const score = getScore(id);\n                        if (score >= this.opts.scoreThresholds.publishThreshold)\n                            candidateFanoutPeers.push(id);\n                        // instead of having to find gossip peers after heartbeat which require another loop\n                        // we prepare peers to gossip in a topic within heartbeat to improve performance\n                        if (score >= this.opts.scoreThresholds.gossipThreshold)\n                            peersToGossip.add(id);\n                    }\n                }\n            }\n            // do we need more peers?\n            if (fanoutPeers.size < D) {\n                const ineed = D - fanoutPeers.size;\n                candidateFanoutPeers.slice(0, ineed).forEach((id) => {\n                    fanoutPeers.add(id);\n                    peersToGossip?.delete(id);\n                });\n            }\n        });\n        this.emitGossip(peersToGossipByTopic);\n        // send coalesced GRAFT/PRUNE messages (will piggyback gossip)\n        await this.sendGraftPrune(tograft, toprune, noPX);\n        // flush pending gossip that wasn't piggybacked above\n        this.flush();\n        // advance the message history window\n        this.mcache.shift();\n        this.dispatchEvent(new CustomEvent('gossipsub:heartbeat'));\n    }\n    /**\n     * Given a topic, returns up to count peers subscribed to that topic\n     * that pass an optional filter function\n     *\n     * @param topic\n     * @param count\n     * @param filter - a function to filter acceptable peers\n     */\n    getRandomGossipPeers(topic, count, filter = () => true) {\n        const peersInTopic = this.topics.get(topic);\n        if (!peersInTopic) {\n            return new Set();\n        }\n        // Adds all peers using our protocol\n        // that also pass the filter function\n        let peers = [];\n        peersInTopic.forEach((id) => {\n            const peerStreams = this.streamsOutbound.get(id);\n            if (!peerStreams) {\n                return;\n            }\n            if (this.multicodecs.includes(peerStreams.protocol) && filter(id)) {\n                peers.push(id);\n            }\n        });\n        // Pseudo-randomly shuffles peers\n        peers = shuffle(peers);\n        if (count > 0 && peers.length > count) {\n            peers = peers.slice(0, count);\n        }\n        return new Set(peers);\n    }\n    onScrapeMetrics(metrics) {\n        /* Data structure sizes */\n        metrics.mcacheSize.set(this.mcache.size);\n        metrics.mcacheNotValidatedCount.set(this.mcache.notValidatedCount);\n        // Arbitrary size\n        metrics.cacheSize.set({ cache: 'direct' }, this.direct.size);\n        metrics.cacheSize.set({ cache: 'seenCache' }, this.seenCache.size);\n        metrics.cacheSize.set({ cache: 'fastMsgIdCache' }, this.fastMsgIdCache?.size ?? 0);\n        metrics.cacheSize.set({ cache: 'publishedMessageIds' }, this.publishedMessageIds.size);\n        metrics.cacheSize.set({ cache: 'mcache' }, this.mcache.size);\n        metrics.cacheSize.set({ cache: 'score' }, this.score.size);\n        metrics.cacheSize.set({ cache: 'gossipTracer.promises' }, this.gossipTracer.size);\n        metrics.cacheSize.set({ cache: 'gossipTracer.requests' }, this.gossipTracer.requestMsByMsgSize);\n        // Bounded by topic\n        metrics.cacheSize.set({ cache: 'topics' }, this.topics.size);\n        metrics.cacheSize.set({ cache: 'subscriptions' }, this.subscriptions.size);\n        metrics.cacheSize.set({ cache: 'mesh' }, this.mesh.size);\n        metrics.cacheSize.set({ cache: 'fanout' }, this.fanout.size);\n        // Bounded by peer\n        metrics.cacheSize.set({ cache: 'peers' }, this.peers.size);\n        metrics.cacheSize.set({ cache: 'streamsOutbound' }, this.streamsOutbound.size);\n        metrics.cacheSize.set({ cache: 'streamsInbound' }, this.streamsInbound.size);\n        metrics.cacheSize.set({ cache: 'acceptFromWhitelist' }, this.acceptFromWhitelist.size);\n        metrics.cacheSize.set({ cache: 'gossip' }, this.gossip.size);\n        metrics.cacheSize.set({ cache: 'control' }, this.control.size);\n        metrics.cacheSize.set({ cache: 'peerhave' }, this.peerhave.size);\n        metrics.cacheSize.set({ cache: 'outbound' }, this.outbound.size);\n        // 2D nested data structure\n        let backoffSize = 0;\n        const now = Date.now();\n        metrics.connectedPeersBackoffSec.reset();\n        for (const backoff of this.backoff.values()) {\n            backoffSize += backoff.size;\n            for (const [peer, expiredMs] of backoff.entries()) {\n                if (this.peers.has(peer)) {\n                    metrics.connectedPeersBackoffSec.observe(Math.max(0, expiredMs - now) / 1000);\n                }\n            }\n        }\n        metrics.cacheSize.set({ cache: 'backoff' }, backoffSize);\n        // Peer counts\n        for (const [topicStr, peers] of this.topics) {\n            metrics.topicPeersCount.set({ topicStr }, peers.size);\n        }\n        for (const [topicStr, peers] of this.mesh) {\n            metrics.meshPeerCounts.set({ topicStr }, peers.size);\n        }\n        // Peer scores\n        const scores = [];\n        const scoreByPeer = new Map();\n        metrics.behaviourPenalty.reset();\n        for (const peerIdStr of this.peers.keys()) {\n            const score = this.score.score(peerIdStr);\n            scores.push(score);\n            scoreByPeer.set(peerIdStr, score);\n            metrics.behaviourPenalty.observe(this.score.peerStats.get(peerIdStr)?.behaviourPenalty ?? 0);\n        }\n        metrics.registerScores(scores, this.opts.scoreThresholds);\n        // Breakdown score per mesh topicLabel\n        metrics.registerScorePerMesh(this.mesh, scoreByPeer);\n        // Breakdown on each score weight\n        const sw = computeAllPeersScoreWeights(this.peers.keys(), this.score.peerStats, this.score.params, this.score.peerIPs, metrics.topicStrToLabel);\n        metrics.registerScoreWeights(sw);\n    }\n}\nexport function gossipsub(init = {}) {\n    return (components) => new GossipSub(components, init);\n}\n//# sourceMappingURL=index.js.map","import { unmarshalPrivateKey } from '@libp2p/crypto/keys';\nimport { StrictSign, StrictNoSign } from '@libp2p/interface/pubsub';\nimport { PublishConfigType } from '../types.js';\n/**\n * Prepare a PublishConfig object from a PeerId.\n */\nexport async function getPublishConfigFromPeerId(signaturePolicy, peerId) {\n    switch (signaturePolicy) {\n        case StrictSign: {\n            if (!peerId) {\n                throw Error('Must provide PeerId');\n            }\n            if (peerId.privateKey == null) {\n                throw Error('Cannot sign message, no private key present');\n            }\n            if (peerId.publicKey == null) {\n                throw Error('Cannot sign message, no public key present');\n            }\n            // Transform privateKey once at initialization time instead of once per message\n            const privateKey = await unmarshalPrivateKey(peerId.privateKey);\n            return {\n                type: PublishConfigType.Signing,\n                author: peerId,\n                key: peerId.publicKey,\n                privateKey\n            };\n        }\n        case StrictNoSign:\n            return {\n                type: PublishConfigType.Anonymous\n            };\n        default:\n            throw new Error(`Unknown signature policy \"${signaturePolicy}\"`);\n    }\n}\n//# sourceMappingURL=publishConfig.js.map","export class AbortError extends Error {\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\n//# sourceMappingURL=abort-error.js.map","/**\n * @packageDocumentation\n *\n * @example\n *\n * ```js\n * import { abortableSource } from 'abortable-iterator'\n *\n * async function main () {\n *   // An example function that creates an async iterator that yields an increasing\n *   // number every x milliseconds and NEVER ENDS!\n *   const asyncCounter = async function * (start, delay) {\n *     let i = start\n *     while (true) {\n *       yield new Promise(resolve => setTimeout(() => resolve(i++), delay))\n *     }\n *   }\n *\n *   // Create a counter that'll yield numbers from 0 upwards every second\n *   const everySecond = asyncCounter(0, 1000)\n *\n *   // Make everySecond abortable!\n *   const controller = new AbortController()\n *   const abortableEverySecond = abortableSource(everySecond, controller.signal)\n *\n *   // Abort after 5 seconds\n *   setTimeout(() => controller.abort(), 5000)\n *\n *   try {\n *     // Start the iteration, which will throw after 5 seconds when it is aborted\n *     for await (const n of abortableEverySecond) {\n *       console.log(n)\n *     }\n *   } catch (err) {\n *     if (err.code === 'ERR_ABORTED') {\n *       // Expected - all ok :D\n *     } else {\n *       throw err\n *     }\n *   }\n * }\n *\n * main()\n * ```\n */\nimport { AbortError } from './abort-error.js';\nimport { getIterator } from 'get-iterator';\n/**\n * Wrap an iterator to make it abortable, allow cleanup when aborted via onAbort\n */\nexport function abortableSource(source, signal, options) {\n    const opts = options ?? {};\n    const iterator = getIterator(source);\n    async function* abortable() {\n        let nextAbortHandler;\n        const abortHandler = () => {\n            if (nextAbortHandler != null)\n                nextAbortHandler();\n        };\n        signal.addEventListener('abort', abortHandler);\n        while (true) {\n            let result;\n            try {\n                if (signal.aborted) {\n                    const { abortMessage, abortCode } = opts;\n                    throw new AbortError(abortMessage, abortCode);\n                }\n                const abort = new Promise((resolve, reject) => {\n                    nextAbortHandler = () => {\n                        const { abortMessage, abortCode } = opts;\n                        reject(new AbortError(abortMessage, abortCode));\n                    };\n                });\n                // Race the iterator and the abort signals\n                result = await Promise.race([abort, iterator.next()]);\n                nextAbortHandler = null;\n            }\n            catch (err) {\n                signal.removeEventListener('abort', abortHandler);\n                // Might not have been aborted by a known signal\n                const isKnownAborter = err.type === 'aborted' && signal.aborted;\n                if (isKnownAborter && (opts.onAbort != null)) {\n                    // Do any custom abort handling for the iterator\n                    opts.onAbort(source);\n                }\n                // End the iterator if it is a generator\n                if (typeof iterator.return === 'function') {\n                    try {\n                        const p = iterator.return();\n                        if (p instanceof Promise) { // eslint-disable-line max-depth\n                            p.catch(err => {\n                                if (opts.onReturnError != null) {\n                                    opts.onReturnError(err);\n                                }\n                            });\n                        }\n                    }\n                    catch (err) {\n                        if (opts.onReturnError != null) { // eslint-disable-line max-depth\n                            opts.onReturnError(err);\n                        }\n                    }\n                }\n                if (isKnownAborter && opts.returnOnAbort === true) {\n                    return;\n                }\n                throw err;\n            }\n            if (result.done === true) {\n                break;\n            }\n            yield result.value;\n        }\n        signal.removeEventListener('abort', abortHandler);\n    }\n    return abortable();\n}\nexport function abortableSink(sink, signal, options) {\n    return (source) => sink(abortableSource(source, signal, options));\n}\nexport function abortableDuplex(duplex, signal, options) {\n    return {\n        sink: abortableSink(duplex.sink, signal, {\n            ...options,\n            onAbort: undefined\n        }),\n        source: abortableSource(duplex.source, signal, options)\n    };\n}\nexport { AbortError };\nexport { abortableSink as abortableTransform };\n//# sourceMappingURL=index.js.map","export function getIterator(obj) {\n    if (obj != null) {\n        if (typeof obj[Symbol.iterator] === 'function') {\n            return obj[Symbol.iterator]();\n        }\n        if (typeof obj[Symbol.asyncIterator] === 'function') {\n            return obj[Symbol.asyncIterator]();\n        }\n        if (typeof obj.next === 'function') {\n            return obj; // probably an iterator\n        }\n    }\n    throw new Error('argument is not an iterator or iterable');\n}\n//# sourceMappingURL=index.js.map","// ported from https://www.npmjs.com/package/fast-fifo\nclass FixedFIFO {\n    buffer;\n    mask;\n    top;\n    btm;\n    next;\n    constructor(hwm) {\n        if (!(hwm > 0) || ((hwm - 1) & hwm) !== 0) {\n            throw new Error('Max size for a FixedFIFO should be a power of two');\n        }\n        this.buffer = new Array(hwm);\n        this.mask = hwm - 1;\n        this.top = 0;\n        this.btm = 0;\n        this.next = null;\n    }\n    push(data) {\n        if (this.buffer[this.top] !== undefined) {\n            return false;\n        }\n        this.buffer[this.top] = data;\n        this.top = (this.top + 1) & this.mask;\n        return true;\n    }\n    shift() {\n        const last = this.buffer[this.btm];\n        if (last === undefined) {\n            return undefined;\n        }\n        this.buffer[this.btm] = undefined;\n        this.btm = (this.btm + 1) & this.mask;\n        return last;\n    }\n    isEmpty() {\n        return this.buffer[this.btm] === undefined;\n    }\n}\nexport class FIFO {\n    size;\n    hwm;\n    head;\n    tail;\n    constructor(options = {}) {\n        this.hwm = options.splitLimit ?? 16;\n        this.head = new FixedFIFO(this.hwm);\n        this.tail = this.head;\n        this.size = 0;\n    }\n    calculateSize(obj) {\n        if (obj?.byteLength != null) {\n            return obj.byteLength;\n        }\n        return 1;\n    }\n    push(val) {\n        if (val?.value != null) {\n            this.size += this.calculateSize(val.value);\n        }\n        if (!this.head.push(val)) {\n            const prev = this.head;\n            this.head = prev.next = new FixedFIFO(2 * this.head.buffer.length);\n            this.head.push(val);\n        }\n    }\n    shift() {\n        let val = this.tail.shift();\n        if (val === undefined && (this.tail.next != null)) {\n            const next = this.tail.next;\n            this.tail.next = null;\n            this.tail = next;\n            val = this.tail.shift();\n        }\n        if (val?.value != null) {\n            this.size -= this.calculateSize(val.value);\n        }\n        return val;\n    }\n    isEmpty() {\n        return this.head.isEmpty();\n    }\n}\n//# sourceMappingURL=fifo.js.map","/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\nimport deferred from 'p-defer';\nimport { FIFO } from './fifo.js';\nexport class AbortError extends Error {\n    type;\n    code;\n    constructor(message, code) {\n        super(message ?? 'The operation was aborted');\n        this.type = 'aborted';\n        this.code = code ?? 'ABORT_ERR';\n    }\n}\nexport function pushable(options = {}) {\n    const getNext = (buffer) => {\n        const next = buffer.shift();\n        if (next == null) {\n            return { done: true };\n        }\n        if (next.error != null) {\n            throw next.error;\n        }\n        return {\n            done: next.done === true,\n            // @ts-expect-error if done is false, value will be present\n            value: next.value\n        };\n    };\n    return _pushable(getNext, options);\n}\nexport function pushableV(options = {}) {\n    const getNext = (buffer) => {\n        let next;\n        const values = [];\n        while (!buffer.isEmpty()) {\n            next = buffer.shift();\n            if (next == null) {\n                break;\n            }\n            if (next.error != null) {\n                throw next.error;\n            }\n            if (next.done === false) {\n                // @ts-expect-error if done is false value should be pushed\n                values.push(next.value);\n            }\n        }\n        if (next == null) {\n            return { done: true };\n        }\n        return {\n            done: next.done === true,\n            value: values\n        };\n    };\n    return _pushable(getNext, options);\n}\nfunction _pushable(getNext, options) {\n    options = options ?? {};\n    let onEnd = options.onEnd;\n    let buffer = new FIFO();\n    let pushable;\n    let onNext;\n    let ended;\n    let drain = deferred();\n    const waitNext = async () => {\n        try {\n            if (!buffer.isEmpty()) {\n                return getNext(buffer);\n            }\n            if (ended) {\n                return { done: true };\n            }\n            return await new Promise((resolve, reject) => {\n                onNext = (next) => {\n                    onNext = null;\n                    buffer.push(next);\n                    try {\n                        resolve(getNext(buffer));\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                    return pushable;\n                };\n            });\n        }\n        finally {\n            if (buffer.isEmpty()) {\n                // settle promise in the microtask queue to give consumers a chance to\n                // await after calling .push\n                queueMicrotask(() => {\n                    drain.resolve();\n                    drain = deferred();\n                });\n            }\n        }\n    };\n    const bufferNext = (next) => {\n        if (onNext != null) {\n            return onNext(next);\n        }\n        buffer.push(next);\n        return pushable;\n    };\n    const bufferError = (err) => {\n        buffer = new FIFO();\n        if (onNext != null) {\n            return onNext({ error: err });\n        }\n        buffer.push({ error: err });\n        return pushable;\n    };\n    const push = (value) => {\n        if (ended) {\n            return pushable;\n        }\n        // @ts-expect-error `byteLength` is not declared on PushType\n        if (options?.objectMode !== true && value?.byteLength == null) {\n            throw new Error('objectMode was not true but tried to push non-Uint8Array value');\n        }\n        return bufferNext({ done: false, value });\n    };\n    const end = (err) => {\n        if (ended)\n            return pushable;\n        ended = true;\n        return (err != null) ? bufferError(err) : bufferNext({ done: true });\n    };\n    const _return = () => {\n        buffer = new FIFO();\n        end();\n        return { done: true };\n    };\n    const _throw = (err) => {\n        end(err);\n        return { done: true };\n    };\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next: waitNext,\n        return: _return,\n        throw: _throw,\n        push,\n        end,\n        get readableLength() {\n            return buffer.size;\n        },\n        onEmpty: async (options) => {\n            const signal = options?.signal;\n            signal?.throwIfAborted();\n            if (buffer.isEmpty()) {\n                return;\n            }\n            let cancel;\n            let listener;\n            if (signal != null) {\n                cancel = new Promise((resolve, reject) => {\n                    listener = () => {\n                        reject(new AbortError());\n                    };\n                    signal.addEventListener('abort', listener);\n                });\n            }\n            try {\n                await Promise.race([\n                    drain.promise,\n                    cancel\n                ]);\n            }\n            finally {\n                if (listener != null && signal != null) {\n                    signal?.removeEventListener('abort', listener);\n                }\n            }\n        }\n    };\n    if (onEnd == null) {\n        return pushable;\n    }\n    const _pushable = pushable;\n    pushable = {\n        [Symbol.asyncIterator]() { return this; },\n        next() {\n            return _pushable.next();\n        },\n        throw(err) {\n            _pushable.throw(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        return() {\n            _pushable.return();\n            if (onEnd != null) {\n                onEnd();\n                onEnd = undefined;\n            }\n            return { done: true };\n        },\n        push,\n        end(err) {\n            _pushable.end(err);\n            if (onEnd != null) {\n                onEnd(err);\n                onEnd = undefined;\n            }\n            return pushable;\n        },\n        get readableLength() {\n            return _pushable.readableLength;\n        }\n    };\n    return pushable;\n}\n//# sourceMappingURL=index.js.map","/**\n * To guarantee Uint8Array semantics, convert nodejs Buffers\n * into vanilla Uint8Arrays\n */\nexport function asUint8Array(buf) {\n    if (globalThis.Buffer != null) {\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    return buf;\n}\n//# sourceMappingURL=as-uint8array.js.map","import { baseX } from './base.js'\n\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n})\n\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n})\n","import { from } from './base.js'\n\nconst alphabet = Array.from('🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂')\nconst alphabetBytesToChars = /** @type {string[]} */ (alphabet.reduce((p, c, i) => { p[i] = c; return p }, /** @type {string[]} */([])))\nconst alphabetCharsToBytes = /** @type {number[]} */ (alphabet.reduce((p, c, i) => { p[/** @type {number} */ (c.codePointAt(0))] = i; return p }, /** @type {number[]} */([])))\n\n/**\n * @param {Uint8Array} data\n * @returns {string}\n */\nfunction encode (data) {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c]\n    return p\n  }, '')\n}\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction decode (str) {\n  const byts = []\n  for (const char of str) {\n    const byt = alphabetCharsToBytes[/** @type {number} */ (char.codePointAt(0))]\n    if (byt === undefined) {\n      throw new Error(`Non-base256emoji character: ${char}`)\n    }\n    byts.push(byt)\n  }\n  return new Uint8Array(byts)\n}\n\nexport const base256emoji = from({\n  prefix: '🚀',\n  name: 'base256emoji',\n  encode,\n  decode\n})\n","// @ts-check\n\nimport { rfc4648 } from './base.js'\n\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n})\n","// @ts-check\n\nimport { fromString, toString } from '../bytes.js'\nimport { from } from './base.js'\n\nexport const identity = from({\n  prefix: '\\x00',\n  name: 'identity',\n  encode: (buf) => toString(buf),\n  decode: (str) => fromString(str)\n})\n","// @ts-check\n\nimport * as base10 from './bases/base10.js'\nimport * as base16 from './bases/base16.js'\nimport * as base2 from './bases/base2.js'\nimport * as base256emoji from './bases/base256emoji.js'\nimport * as base32 from './bases/base32.js'\nimport * as base36 from './bases/base36.js'\nimport * as base58 from './bases/base58.js'\nimport * as base64 from './bases/base64.js'\nimport * as base8 from './bases/base8.js'\nimport * as identityBase from './bases/identity.js'\nimport * as json from './codecs/json.js'\nimport * as raw from './codecs/raw.js'\nimport * as identity from './hashes/identity.js'\nimport * as sha2 from './hashes/sha2.js'\nimport { CID, hasher, digest, varint, bytes } from './index.js'\n\nconst bases = { ...identityBase, ...base2, ...base8, ...base10, ...base16, ...base32, ...base36, ...base58, ...base64, ...base256emoji }\nconst hashes = { ...sha2, ...identity }\nconst codecs = { raw, json }\n\nexport { CID, hasher, digest, varint, bytes, hashes, bases, codecs }\n","import { bases } from 'multiformats/basics';\nimport { allocUnsafe } from '../alloc.js';\nfunction createCodec(name, prefix, encode, decode) {\n    return {\n        name,\n        prefix,\n        encoder: {\n            name,\n            prefix,\n            encode\n        },\n        decoder: {\n            decode\n        }\n    };\n}\nconst string = createCodec('utf8', 'u', (buf) => {\n    const decoder = new TextDecoder('utf8');\n    return 'u' + decoder.decode(buf);\n}, (str) => {\n    const encoder = new TextEncoder();\n    return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', (buf) => {\n    let string = 'a';\n    for (let i = 0; i < buf.length; i++) {\n        string += String.fromCharCode(buf[i]);\n    }\n    return string;\n}, (str) => {\n    str = str.substring(1);\n    const buf = allocUnsafe(str.length);\n    for (let i = 0; i < str.length; i++) {\n        buf[i] = str.charCodeAt(i);\n    }\n    return buf;\n});\nconst BASES = {\n    utf8: string,\n    'utf-8': string,\n    hex: bases.base16,\n    latin1: ascii,\n    ascii,\n    binary: ascii,\n    ...bases\n};\nexport default BASES;\n//# sourceMappingURL=bases.js.map","import { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc(size = 0) {\n    if (globalThis.Buffer?.alloc != null) {\n        return asUint8Array(globalThis.Buffer.alloc(size));\n    }\n    return new Uint8Array(size);\n}\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe(size = 0) {\n    if (globalThis.Buffer?.allocUnsafe != null) {\n        return asUint8Array(globalThis.Buffer.allocUnsafe(size));\n    }\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc.js.map","import { asUint8Array } from './util/as-uint8array.js';\nimport bases, {} from './util/bases.js';\n/**\n * Create a `Uint8Array` from the passed string\n *\n * Supports `utf8`, `utf-8`, `hex`, and any encoding supported by the multiformats module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function fromString(string, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return asUint8Array(globalThis.Buffer.from(string, 'utf-8'));\n    }\n    // add multibase prefix\n    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions\n}\n//# sourceMappingURL=from-string.js.map","import bases, {} from './util/bases.js';\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString(array, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return globalThis.Buffer.from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');\n    }\n    // strip multibase prefix\n    return base.encoder.encode(array).substring(1);\n}\n//# sourceMappingURL=to-string.js.map","export var MessageTypes;\n(function (MessageTypes) {\n    MessageTypes[MessageTypes[\"NEW_STREAM\"] = 0] = \"NEW_STREAM\";\n    MessageTypes[MessageTypes[\"MESSAGE_RECEIVER\"] = 1] = \"MESSAGE_RECEIVER\";\n    MessageTypes[MessageTypes[\"MESSAGE_INITIATOR\"] = 2] = \"MESSAGE_INITIATOR\";\n    MessageTypes[MessageTypes[\"CLOSE_RECEIVER\"] = 3] = \"CLOSE_RECEIVER\";\n    MessageTypes[MessageTypes[\"CLOSE_INITIATOR\"] = 4] = \"CLOSE_INITIATOR\";\n    MessageTypes[MessageTypes[\"RESET_RECEIVER\"] = 5] = \"RESET_RECEIVER\";\n    MessageTypes[MessageTypes[\"RESET_INITIATOR\"] = 6] = \"RESET_INITIATOR\";\n})(MessageTypes || (MessageTypes = {}));\nexport const MessageTypeNames = Object.freeze({\n    0: 'NEW_STREAM',\n    1: 'MESSAGE_RECEIVER',\n    2: 'MESSAGE_INITIATOR',\n    3: 'CLOSE_RECEIVER',\n    4: 'CLOSE_INITIATOR',\n    5: 'RESET_RECEIVER',\n    6: 'RESET_INITIATOR'\n});\nexport const InitiatorMessageTypes = Object.freeze({\n    NEW_STREAM: MessageTypes.NEW_STREAM,\n    MESSAGE: MessageTypes.MESSAGE_INITIATOR,\n    CLOSE: MessageTypes.CLOSE_INITIATOR,\n    RESET: MessageTypes.RESET_INITIATOR\n});\nexport const ReceiverMessageTypes = Object.freeze({\n    MESSAGE: MessageTypes.MESSAGE_RECEIVER,\n    CLOSE: MessageTypes.CLOSE_RECEIVER,\n    RESET: MessageTypes.RESET_RECEIVER\n});\n//# sourceMappingURL=message-types.js.map","import { Uint8ArrayList } from 'uint8arraylist';\nimport { MessageTypeNames, MessageTypes } from './message-types.js';\nexport const MAX_MSG_SIZE = 1 << 20; // 1MB\nexport const MAX_MSG_QUEUE_SIZE = 4 << 20; // 4MB\nexport class Decoder {\n    _buffer;\n    _headerInfo;\n    _maxMessageSize;\n    _maxUnprocessedMessageQueueSize;\n    constructor(maxMessageSize = MAX_MSG_SIZE, maxUnprocessedMessageQueueSize = MAX_MSG_QUEUE_SIZE) {\n        this._buffer = new Uint8ArrayList();\n        this._headerInfo = null;\n        this._maxMessageSize = maxMessageSize;\n        this._maxUnprocessedMessageQueueSize = maxUnprocessedMessageQueueSize;\n    }\n    write(chunk) {\n        if (chunk == null || chunk.length === 0) {\n            return [];\n        }\n        this._buffer.append(chunk);\n        if (this._buffer.byteLength > this._maxUnprocessedMessageQueueSize) {\n            throw Object.assign(new Error('unprocessed message queue size too large!'), { code: 'ERR_MSG_QUEUE_TOO_BIG' });\n        }\n        const msgs = [];\n        while (this._buffer.length !== 0) {\n            if (this._headerInfo == null) {\n                try {\n                    this._headerInfo = this._decodeHeader(this._buffer);\n                }\n                catch (err) {\n                    if (err.code === 'ERR_MSG_TOO_BIG') {\n                        throw err;\n                    }\n                    break; // We haven't received enough data yet\n                }\n            }\n            const { id, type, length, offset } = this._headerInfo;\n            const bufferedDataLength = this._buffer.length - offset;\n            if (bufferedDataLength < length) {\n                break; // not enough data yet\n            }\n            const msg = {\n                id,\n                type\n            };\n            if (type === MessageTypes.NEW_STREAM || type === MessageTypes.MESSAGE_INITIATOR || type === MessageTypes.MESSAGE_RECEIVER) {\n                msg.data = this._buffer.sublist(offset, offset + length);\n            }\n            msgs.push(msg);\n            this._buffer.consume(offset + length);\n            this._headerInfo = null;\n        }\n        return msgs;\n    }\n    /**\n     * Attempts to decode the message header from the buffer\n     */\n    _decodeHeader(data) {\n        const { value: h, offset } = readVarInt(data);\n        const { value: length, offset: end } = readVarInt(data, offset);\n        const type = h & 7;\n        // @ts-expect-error h is a number not a CODE\n        if (MessageTypeNames[type] == null) {\n            throw new Error(`Invalid type received: ${type}`);\n        }\n        // test message type varint + data length\n        if (length > this._maxMessageSize) {\n            throw Object.assign(new Error('message size too large!'), { code: 'ERR_MSG_TOO_BIG' });\n        }\n        // @ts-expect-error h is a number not a CODE\n        return { id: h >> 3, type, offset: offset + end, length };\n    }\n}\nconst MSB = 0x80;\nconst REST = 0x7F;\nfunction readVarInt(buf, offset = 0) {\n    let res = 0;\n    let shift = 0;\n    let counter = offset;\n    let b;\n    const l = buf.length;\n    do {\n        if (counter >= l || shift > 49) {\n            offset = 0;\n            throw new RangeError('Could not decode varint');\n        }\n        b = buf.get(counter++);\n        res += shift < 28\n            ? (b & REST) << shift\n            : (b & REST) * Math.pow(2, shift);\n        shift += 7;\n    } while (b >= MSB);\n    offset = counter - offset;\n    return {\n        value: res,\n        offset\n    };\n}\n//# sourceMappingURL=decode.js.map","import defer from 'p-defer';\nimport { Uint8ArrayList } from 'uint8arraylist';\nfunction isAsyncIterable(thing) {\n    return thing[Symbol.asyncIterator] != null;\n}\nconst DEFAULT_BATCH_SIZE = 1024 * 1024;\nconst DEFAULT_SERIALIZE = (buf, list) => { list.append(buf); };\nfunction batchedBytes(source, options) {\n    if (isAsyncIterable(source)) {\n        return (async function* () {\n            let buffer = new Uint8ArrayList();\n            let ended = false;\n            let deferred = defer();\n            let size = Number(options?.size ?? DEFAULT_BATCH_SIZE);\n            if (isNaN(size) || size === 0 || size < 0) {\n                size = DEFAULT_BATCH_SIZE;\n            }\n            if (size !== Math.round(size)) {\n                throw new Error('Batch size must be an integer');\n            }\n            const yieldAfter = options?.yieldAfter ?? 0;\n            const serialize = options?.serialize ?? DEFAULT_SERIALIZE;\n            void Promise.resolve().then(async () => {\n                try {\n                    let timeout;\n                    for await (const buf of source) {\n                        // @ts-expect-error - if buf is not `Uint8Array | Uint8ArrayList` we cannot use the default serializer\n                        serialize(buf, buffer);\n                        if (buffer.byteLength >= size) {\n                            clearTimeout(timeout);\n                            deferred.resolve();\n                            continue;\n                        }\n                        timeout = setTimeout(() => {\n                            deferred.resolve();\n                        }, yieldAfter);\n                    }\n                    clearTimeout(timeout);\n                    deferred.resolve();\n                }\n                catch (err) {\n                    deferred.reject(err);\n                }\n                finally {\n                    ended = true;\n                }\n            });\n            while (!ended) { // eslint-disable-line no-unmodified-loop-condition\n                await deferred.promise;\n                deferred = defer();\n                if (buffer.byteLength > 0) {\n                    const b = buffer;\n                    buffer = new Uint8ArrayList();\n                    yield b.subarray();\n                }\n            }\n        })();\n    }\n    return (function* () {\n        const buffer = new Uint8ArrayList();\n        let size = Number(options?.size ?? DEFAULT_BATCH_SIZE);\n        if (isNaN(size) || size === 0 || size < 0) {\n            size = DEFAULT_BATCH_SIZE;\n        }\n        if (size !== Math.round(size)) {\n            throw new Error('Batch size must be an integer');\n        }\n        const serialize = options?.serialize ?? DEFAULT_SERIALIZE;\n        for (const buf of source) {\n            // @ts-expect-error - if buf is not `Uint8Array | Uint8ArrayList` we cannot use the default serializer\n            serialize(buf, buffer);\n            if (buffer.byteLength >= size) {\n                yield buffer.subarray(0, size);\n                buffer.consume(size);\n            }\n        }\n        if (buffer.byteLength > 0) {\n            yield buffer.subarray();\n        }\n    })();\n}\nexport default batchedBytes;\n//# sourceMappingURL=index.js.map","export function allocUnsafe(size) {\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc-unsafe-browser.js.map","import batchedBytes from 'it-batched-bytes';\nimport * as varint from 'uint8-varint';\nimport { Uint8ArrayList } from 'uint8arraylist';\nimport { allocUnsafe } from './alloc-unsafe.js';\nimport { MessageTypes } from './message-types.js';\nconst POOL_SIZE = 10 * 1024;\nclass Encoder {\n    _pool;\n    _poolOffset;\n    constructor() {\n        this._pool = allocUnsafe(POOL_SIZE);\n        this._poolOffset = 0;\n    }\n    /**\n     * Encodes the given message and adds it to the passed list\n     */\n    write(msg, list) {\n        const pool = this._pool;\n        let offset = this._poolOffset;\n        varint.encode(msg.id << 3 | msg.type, pool, offset);\n        offset += varint.encodingLength(msg.id << 3 | msg.type);\n        if ((msg.type === MessageTypes.NEW_STREAM || msg.type === MessageTypes.MESSAGE_INITIATOR || msg.type === MessageTypes.MESSAGE_RECEIVER) && msg.data != null) {\n            varint.encode(msg.data.length, pool, offset);\n            offset += varint.encodingLength(msg.data.length);\n        }\n        else {\n            varint.encode(0, pool, offset);\n            offset += varint.encodingLength(0);\n        }\n        const header = pool.subarray(this._poolOffset, offset);\n        if (POOL_SIZE - offset < 100) {\n            this._pool = allocUnsafe(POOL_SIZE);\n            this._poolOffset = 0;\n        }\n        else {\n            this._poolOffset = offset;\n        }\n        list.append(header);\n        if ((msg.type === MessageTypes.NEW_STREAM || msg.type === MessageTypes.MESSAGE_INITIATOR || msg.type === MessageTypes.MESSAGE_RECEIVER) && msg.data != null) {\n            list.append(msg.data);\n        }\n    }\n}\nconst encoder = new Encoder();\n/**\n * Encode and yield one or more messages\n */\nexport async function* encode(source, minSendBytes = 0) {\n    if (minSendBytes == null || minSendBytes === 0) {\n        // just send the messages\n        for await (const messages of source) {\n            const list = new Uint8ArrayList();\n            for (const msg of messages) {\n                encoder.write(msg, list);\n            }\n            yield list.subarray();\n        }\n        return;\n    }\n    // batch messages up for sending\n    yield* batchedBytes(source, {\n        size: minSendBytes,\n        serialize: (obj, list) => {\n            for (const m of obj) {\n                encoder.write(m, list);\n            }\n        }\n    });\n}\n//# sourceMappingURL=encode.js.map","import { AbstractStream } from '@libp2p/interface/stream-muxer/stream';\nimport { logger } from '@libp2p/logger';\nimport { Uint8ArrayList } from 'uint8arraylist';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { MAX_MSG_SIZE } from './decode.js';\nimport { InitiatorMessageTypes, ReceiverMessageTypes } from './message-types.js';\nexport class MplexStream extends AbstractStream {\n    name;\n    streamId;\n    send;\n    types;\n    maxDataSize;\n    constructor(init) {\n        super(init);\n        this.types = init.direction === 'outbound' ? InitiatorMessageTypes : ReceiverMessageTypes;\n        this.send = init.send;\n        this.name = init.name;\n        this.streamId = init.streamId;\n        this.maxDataSize = init.maxDataSize;\n    }\n    async sendNewStream() {\n        await this.send({ id: this.streamId, type: InitiatorMessageTypes.NEW_STREAM, data: new Uint8ArrayList(uint8ArrayFromString(this.name)) });\n    }\n    async sendData(data) {\n        data = data.sublist();\n        while (data.byteLength > 0) {\n            const toSend = Math.min(data.byteLength, this.maxDataSize);\n            await this.send({\n                id: this.streamId,\n                type: this.types.MESSAGE,\n                data: data.sublist(0, toSend)\n            });\n            data.consume(toSend);\n        }\n    }\n    async sendReset() {\n        await this.send({ id: this.streamId, type: this.types.RESET });\n    }\n    async sendCloseWrite() {\n        await this.send({ id: this.streamId, type: this.types.CLOSE });\n    }\n    async sendCloseRead() {\n        // mplex does not support close read, only close write\n    }\n}\nexport function createStream(options) {\n    const { id, name, send, onEnd, type = 'initiator', maxMsgSize = MAX_MSG_SIZE } = options;\n    return new MplexStream({\n        id: type === 'initiator' ? (`i${id}`) : `r${id}`,\n        streamId: id,\n        name: `${name == null ? id : name}`,\n        direction: type === 'initiator' ? 'outbound' : 'inbound',\n        maxDataSize: maxMsgSize,\n        onEnd,\n        send,\n        log: logger(`libp2p:mplex:stream:${type}:${id}`)\n    });\n}\n//# sourceMappingURL=stream.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { logger } from '@libp2p/logger';\nimport { abortableSource } from 'abortable-iterator';\nimport { pipe } from 'it-pipe';\nimport { pushableV } from 'it-pushable';\nimport { RateLimiterMemory } from 'rate-limiter-flexible';\nimport { toString as uint8ArrayToString } from 'uint8arrays';\nimport { Decoder } from './decode.js';\nimport { encode } from './encode.js';\nimport { MessageTypes, MessageTypeNames } from './message-types.js';\nimport { createStream } from './stream.js';\nconst log = logger('libp2p:mplex');\nconst MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION = 1024;\nconst MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION = 1024;\nconst MAX_STREAM_BUFFER_SIZE = 1024 * 1024 * 4; // 4MB\nconst DISCONNECT_THRESHOLD = 5;\nconst CLOSE_TIMEOUT = 500;\nfunction printMessage(msg) {\n    const output = {\n        ...msg,\n        type: `${MessageTypeNames[msg.type]} (${msg.type})`\n    };\n    if (msg.type === MessageTypes.NEW_STREAM) {\n        output.data = uint8ArrayToString(msg.data instanceof Uint8Array ? msg.data : msg.data.subarray());\n    }\n    if (msg.type === MessageTypes.MESSAGE_INITIATOR || msg.type === MessageTypes.MESSAGE_RECEIVER) {\n        output.data = uint8ArrayToString(msg.data instanceof Uint8Array ? msg.data : msg.data.subarray(), 'base16');\n    }\n    return output;\n}\nexport class MplexStreamMuxer {\n    protocol = '/mplex/6.7.0';\n    sink;\n    source;\n    _streamId;\n    _streams;\n    _init;\n    _source;\n    closeController;\n    rateLimiter;\n    closeTimeout;\n    constructor(init) {\n        init = init ?? {};\n        this._streamId = 0;\n        this._streams = {\n            /**\n             * Stream to ids map\n             */\n            initiators: new Map(),\n            /**\n             * Stream to ids map\n             */\n            receivers: new Map()\n        };\n        this._init = init;\n        this.closeTimeout = init.closeTimeout ?? CLOSE_TIMEOUT;\n        /**\n         * An iterable sink\n         */\n        this.sink = this._createSink();\n        /**\n         * An iterable source\n         */\n        this._source = pushableV({\n            objectMode: true,\n            onEnd: () => {\n                // the source has ended, we can't write any more messages to gracefully\n                // close streams so all we can do is destroy them\n                for (const stream of this._streams.initiators.values()) {\n                    stream.destroy();\n                }\n                for (const stream of this._streams.receivers.values()) {\n                    stream.destroy();\n                }\n            }\n        });\n        this.source = pipe(this._source, source => encode(source, this._init.minSendBytes));\n        /**\n         * Close controller\n         */\n        this.closeController = new AbortController();\n        this.rateLimiter = new RateLimiterMemory({\n            points: init.disconnectThreshold ?? DISCONNECT_THRESHOLD,\n            duration: 1\n        });\n    }\n    /**\n     * Returns a Map of streams and their ids\n     */\n    get streams() {\n        // Inbound and Outbound streams may have the same ids, so we need to make those unique\n        const streams = [];\n        for (const stream of this._streams.initiators.values()) {\n            streams.push(stream);\n        }\n        for (const stream of this._streams.receivers.values()) {\n            streams.push(stream);\n        }\n        return streams;\n    }\n    /**\n     * Initiate a new stream with the given name. If no name is\n     * provided, the id of the stream will be used.\n     */\n    newStream(name) {\n        if (this.closeController.signal.aborted) {\n            throw new Error('Muxer already closed');\n        }\n        const id = this._streamId++;\n        name = name == null ? id.toString() : name.toString();\n        const registry = this._streams.initiators;\n        return this._newStream({ id, name, type: 'initiator', registry });\n    }\n    /**\n     * Close or abort all tracked streams and stop the muxer\n     */\n    async close(options) {\n        if (this.closeController.signal.aborted) {\n            return;\n        }\n        const signal = options?.signal ?? AbortSignal.timeout(this.closeTimeout);\n        try {\n            // try to gracefully close all streams\n            await Promise.all(this.streams.map(async (s) => s.close({\n                signal\n            })));\n            this._source.end();\n            // try to gracefully close the muxer\n            await this._source.onEmpty({\n                signal\n            });\n            this.closeController.abort();\n        }\n        catch (err) {\n            this.abort(err);\n        }\n    }\n    abort(err) {\n        if (this.closeController.signal.aborted) {\n            return;\n        }\n        this.streams.forEach(s => { s.abort(err); });\n        this.closeController.abort(err);\n    }\n    /**\n     * Called whenever an inbound stream is created\n     */\n    _newReceiverStream(options) {\n        const { id, name } = options;\n        const registry = this._streams.receivers;\n        return this._newStream({ id, name, type: 'receiver', registry });\n    }\n    _newStream(options) {\n        const { id, name, type, registry } = options;\n        log('new %s stream %s', type, id);\n        if (type === 'initiator' && this._streams.initiators.size === (this._init.maxOutboundStreams ?? MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION)) {\n            throw new CodeError('Too many outbound streams open', 'ERR_TOO_MANY_OUTBOUND_STREAMS');\n        }\n        if (registry.has(id)) {\n            throw new Error(`${type} stream ${id} already exists!`);\n        }\n        const send = async (msg) => {\n            if (log.enabled) {\n                log.trace('%s stream %s send', type, id, printMessage(msg));\n            }\n            this._source.push(msg);\n        };\n        const onEnd = () => {\n            log('%s stream with id %s and protocol %s ended', type, id, stream.protocol);\n            registry.delete(id);\n            if (this._init.onStreamEnd != null) {\n                this._init.onStreamEnd(stream);\n            }\n        };\n        const stream = createStream({ id, name, send, type, onEnd, maxMsgSize: this._init.maxMsgSize });\n        registry.set(id, stream);\n        return stream;\n    }\n    /**\n     * Creates a sink with an abortable source. Incoming messages will\n     * also have their size restricted. All messages will be varint decoded.\n     */\n    _createSink() {\n        const sink = async (source) => {\n            try {\n                source = abortableSource(source, this.closeController.signal, {\n                    returnOnAbort: true\n                });\n                const decoder = new Decoder(this._init.maxMsgSize, this._init.maxUnprocessedMessageQueueSize);\n                for await (const chunk of source) {\n                    for (const msg of decoder.write(chunk)) {\n                        await this._handleIncoming(msg);\n                    }\n                }\n                this._source.end();\n            }\n            catch (err) {\n                log('error in sink', err);\n                this._source.end(err); // End the source with an error\n            }\n        };\n        return sink;\n    }\n    async _handleIncoming(message) {\n        const { id, type } = message;\n        if (log.enabled) {\n            log.trace('incoming message', printMessage(message));\n        }\n        // Create a new stream?\n        if (message.type === MessageTypes.NEW_STREAM) {\n            if (this._streams.receivers.size === (this._init.maxInboundStreams ?? MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION)) {\n                log('too many inbound streams open');\n                // not going to allow this stream, send the reset message manually\n                // instead of setting it up just to tear it down\n                this._source.push({\n                    id,\n                    type: MessageTypes.RESET_RECEIVER\n                });\n                // if we've hit our stream limit, and the remote keeps trying to open\n                // more new streams, if they are doing this very quickly maybe they\n                // are attacking us and we should close the connection\n                try {\n                    await this.rateLimiter.consume('new-stream', 1);\n                }\n                catch {\n                    log('rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection');\n                    // since there's no backpressure in mplex, the only thing we can really do to protect ourselves is close the connection\n                    this.abort(new Error('Too many open streams'));\n                    return;\n                }\n                return;\n            }\n            const stream = this._newReceiverStream({ id, name: uint8ArrayToString(message.data instanceof Uint8Array ? message.data : message.data.subarray()) });\n            if (this._init.onIncomingStream != null) {\n                this._init.onIncomingStream(stream);\n            }\n            return;\n        }\n        const list = (type & 1) === 1 ? this._streams.initiators : this._streams.receivers;\n        const stream = list.get(id);\n        if (stream == null) {\n            log('missing stream %s for message type %s', id, MessageTypeNames[type]);\n            // if the remote keeps sending us messages for streams that have been\n            // closed or were never opened they may be attacking us so if they do\n            // this very quickly all we can do is close the connection\n            try {\n                await this.rateLimiter.consume('missing-stream', 1);\n            }\n            catch {\n                log('rate limit hit when receiving messages for streams that do not exist - closing remote connection');\n                // since there's no backpressure in mplex, the only thing we can really do to protect ourselves is close the connection\n                this.abort(new Error('Too many messages for missing streams'));\n                return;\n            }\n            return;\n        }\n        const maxBufferSize = this._init.maxStreamBufferSize ?? MAX_STREAM_BUFFER_SIZE;\n        try {\n            switch (type) {\n                case MessageTypes.MESSAGE_INITIATOR:\n                case MessageTypes.MESSAGE_RECEIVER:\n                    if (stream.sourceReadableLength() > maxBufferSize) {\n                        // Stream buffer has got too large, reset the stream\n                        this._source.push({\n                            id: message.id,\n                            type: type === MessageTypes.MESSAGE_INITIATOR ? MessageTypes.RESET_RECEIVER : MessageTypes.RESET_INITIATOR\n                        });\n                        // Inform the stream consumer they are not fast enough\n                        throw new CodeError('Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers', 'ERR_STREAM_INPUT_BUFFER_FULL');\n                    }\n                    // We got data from the remote, push it into our local stream\n                    stream.sourcePush(message.data);\n                    break;\n                case MessageTypes.CLOSE_INITIATOR:\n                case MessageTypes.CLOSE_RECEIVER:\n                    // The remote has stopped writing, so we can stop reading\n                    stream.remoteCloseWrite();\n                    break;\n                case MessageTypes.RESET_INITIATOR:\n                case MessageTypes.RESET_RECEIVER:\n                    // The remote has errored, stop reading and writing to the stream immediately\n                    stream.reset();\n                    break;\n                default:\n                    log('unknown message type %s', type);\n            }\n        }\n        catch (err) {\n            log.error('error while processing message', err);\n            stream.abort(err);\n        }\n    }\n}\n//# sourceMappingURL=mplex.js.map","import { MplexStreamMuxer } from './mplex.js';\nclass Mplex {\n    protocol = '/mplex/6.7.0';\n    _init;\n    constructor(init = {}) {\n        this._init = init;\n    }\n    createStreamMuxer(init = {}) {\n        return new MplexStreamMuxer({\n            ...init,\n            ...this._init\n        });\n    }\n}\nexport function mplex(init = {}) {\n    return () => new Mplex(init);\n}\n//# sourceMappingURL=index.js.map","/**\n * To guarantee Uint8Array semantics, convert nodejs Buffers\n * into vanilla Uint8Arrays\n */\nexport function asUint8Array(buf) {\n    if (globalThis.Buffer != null) {\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    return buf;\n}\n//# sourceMappingURL=as-uint8array.js.map","import { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc(size = 0) {\n    if (globalThis.Buffer?.alloc != null) {\n        return asUint8Array(globalThis.Buffer.alloc(size));\n    }\n    return new Uint8Array(size);\n}\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe(size = 0) {\n    if (globalThis.Buffer?.allocUnsafe != null) {\n        return asUint8Array(globalThis.Buffer.allocUnsafe(size));\n    }\n    return new Uint8Array(size);\n}\n//# sourceMappingURL=alloc.js.map","import { bases } from 'multiformats/basics';\nimport { allocUnsafe } from '../alloc.js';\nfunction createCodec(name, prefix, encode, decode) {\n    return {\n        name,\n        prefix,\n        encoder: {\n            name,\n            prefix,\n            encode\n        },\n        decoder: {\n            decode\n        }\n    };\n}\nconst string = createCodec('utf8', 'u', (buf) => {\n    const decoder = new TextDecoder('utf8');\n    return 'u' + decoder.decode(buf);\n}, (str) => {\n    const encoder = new TextEncoder();\n    return encoder.encode(str.substring(1));\n});\nconst ascii = createCodec('ascii', 'a', (buf) => {\n    let string = 'a';\n    for (let i = 0; i < buf.length; i++) {\n        string += String.fromCharCode(buf[i]);\n    }\n    return string;\n}, (str) => {\n    str = str.substring(1);\n    const buf = allocUnsafe(str.length);\n    for (let i = 0; i < str.length; i++) {\n        buf[i] = str.charCodeAt(i);\n    }\n    return buf;\n});\nconst BASES = {\n    utf8: string,\n    'utf-8': string,\n    hex: bases.base16,\n    latin1: ascii,\n    ascii,\n    binary: ascii,\n    ...bases\n};\nexport default BASES;\n//# sourceMappingURL=bases.js.map","import { asUint8Array } from './util/as-uint8array.js';\nimport bases, {} from './util/bases.js';\n/**\n * Create a `Uint8Array` from the passed string\n *\n * Supports `utf8`, `utf-8`, `hex`, and any encoding supported by the multiformats module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function fromString(string, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return asUint8Array(globalThis.Buffer.from(string, 'utf-8'));\n    }\n    // add multibase prefix\n    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions\n}\n//# sourceMappingURL=from-string.js.map","/**\n * Returns true if the two passed Uint8Arrays have the same content\n */\nexport function equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a.byteLength !== b.byteLength) {\n        return false;\n    }\n    for (let i = 0; i < a.byteLength; i++) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=equals.js.map","import { ed25519 as ed } from '@noble/curves/ed25519';\nconst PUBLIC_KEY_BYTE_LENGTH = 32;\nconst PRIVATE_KEY_BYTE_LENGTH = 64; // private key is actually 32 bytes but for historical reasons we concat private and public keys\nconst KEYS_BYTE_LENGTH = 32;\nexport { PUBLIC_KEY_BYTE_LENGTH as publicKeyLength };\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport async function generateKey() {\n    // the actual private key (32 bytes)\n    const privateKeyRaw = ed.utils.randomPrivateKey();\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    // concatenated the public key to the private key\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\n/**\n * Generate keypair from a 32 byte uint8array\n */\nexport async function generateKeyFromSeed(seed) {\n    if (seed.length !== KEYS_BYTE_LENGTH) {\n        throw new TypeError('\"seed\" must be 32 bytes in length.');\n    }\n    else if (!(seed instanceof Uint8Array)) {\n        throw new TypeError('\"seed\" must be a node.js Buffer, or Uint8Array.');\n    }\n    // based on node forges algorithm, the seed is used directly as private key\n    const privateKeyRaw = seed;\n    const publicKey = ed.getPublicKey(privateKeyRaw);\n    const privateKey = concatKeys(privateKeyRaw, publicKey);\n    return {\n        privateKey,\n        publicKey\n    };\n}\nexport async function hashAndSign(privateKey, msg) {\n    const privateKeyRaw = privateKey.subarray(0, KEYS_BYTE_LENGTH);\n    return ed.sign(msg, privateKeyRaw);\n}\nexport async function hashAndVerify(publicKey, sig, msg) {\n    return ed.verify(sig, msg, publicKey);\n}\nfunction concatKeys(privateKeyRaw, publicKey) {\n    const privateKey = new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);\n    for (let i = 0; i < KEYS_BYTE_LENGTH; i++) {\n        privateKey[i] = privateKeyRaw[i];\n        privateKey[KEYS_BYTE_LENGTH + i] = publicKey[i];\n    }\n    return privateKey;\n}\n//# sourceMappingURL=ed25519-browser.js.map","import { allocUnsafe } from './alloc.js';\nimport { asUint8Array } from './util/as-uint8array.js';\n/**\n * Returns a new Uint8Array created by concatenating the passed ArrayLikes\n */\nexport function concat(arrays, length) {\n    if (length == null) {\n        length = arrays.reduce((acc, curr) => acc + curr.length, 0);\n    }\n    const output = allocUnsafe(length);\n    let offset = 0;\n    for (const arr of arrays) {\n        output.set(arr, offset);\n        offset += arr.length;\n    }\n    return asUint8Array(output);\n}\n//# sourceMappingURL=concat.js.map","/* eslint-env browser */\n// Check native crypto exists and is enabled (In insecure context `self.crypto`\n// exists but `self.crypto.subtle` does not).\nexport default {\n    get(win = globalThis) {\n        const nativeCrypto = win.crypto;\n        if (nativeCrypto == null || nativeCrypto.subtle == null) {\n            throw Object.assign(new Error('Missing Web Crypto API. ' +\n                'The most likely cause of this error is that this page is being accessed ' +\n                'from an insecure context (i.e. not HTTPS). For more information and ' +\n                'possible resolutions see ' +\n                'https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api'), { code: 'ERR_MISSING_WEB_CRYPTO' });\n        }\n        return nativeCrypto;\n    }\n};\n//# sourceMappingURL=webcrypto.js.map","import { concat } from 'uint8arrays/concat';\nimport { fromString } from 'uint8arrays/from-string';\nimport webcrypto from '../webcrypto.js';\n// WebKit on Linux does not support deriving a key from an empty PBKDF2 key.\n// So, as a workaround, we provide the generated key as a constant. We test that\n// this generated key is accurate in test/workaround.spec.ts\n// Generated via:\n// await crypto.subtle.exportKey('jwk',\n//   await crypto.subtle.deriveKey(\n//     { name: 'PBKDF2', salt: new Uint8Array(16), iterations: 32767, hash: { name: 'SHA-256' } },\n//     await crypto.subtle.importKey('raw', new Uint8Array(0), { name: 'PBKDF2' }, false, ['deriveKey']),\n//     { name: 'AES-GCM', length: 128 }, true, ['encrypt', 'decrypt'])\n// )\nexport const derivedEmptyPasswordKey = { alg: 'A128GCM', ext: true, k: 'scm9jmO_4BJAgdwWGVulLg', key_ops: ['encrypt', 'decrypt'], kty: 'oct' };\n// Based off of code from https://github.com/luke-park/SecureCompatibleEncryptionExamples\nexport function create(opts) {\n    const algorithm = opts?.algorithm ?? 'AES-GCM';\n    let keyLength = opts?.keyLength ?? 16;\n    const nonceLength = opts?.nonceLength ?? 12;\n    const digest = opts?.digest ?? 'SHA-256';\n    const saltLength = opts?.saltLength ?? 16;\n    const iterations = opts?.iterations ?? 32767;\n    const crypto = webcrypto.get();\n    keyLength *= 8; // Browser crypto uses bits instead of bytes\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to encrypt the data.\n     */\n    async function encrypt(data, password) {\n        const salt = crypto.getRandomValues(new Uint8Array(saltLength));\n        const nonce = crypto.getRandomValues(new Uint8Array(nonceLength));\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['encrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['encrypt']);\n            }\n        }\n        else {\n            // Derive a key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['encrypt']);\n        }\n        // Encrypt the string.\n        const ciphertext = await crypto.subtle.encrypt(aesGcm, cryptoKey, data);\n        return concat([salt, aesGcm.iv, new Uint8Array(ciphertext)]);\n    }\n    /**\n     * Uses the provided password to derive a pbkdf2 key. The key\n     * will then be used to decrypt the data. The options used to create\n     * this decryption cipher must be the same as those used to create\n     * the encryption cipher.\n     */\n    async function decrypt(data, password) {\n        const salt = data.subarray(0, saltLength);\n        const nonce = data.subarray(saltLength, saltLength + nonceLength);\n        const ciphertext = data.subarray(saltLength + nonceLength);\n        const aesGcm = { name: algorithm, iv: nonce };\n        if (typeof password === 'string') {\n            password = fromString(password);\n        }\n        let cryptoKey;\n        if (password.length === 0) {\n            try {\n                const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n                const runtimeDerivedEmptyPassword = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n                cryptoKey = await crypto.subtle.deriveKey(deriveParams, runtimeDerivedEmptyPassword, { name: algorithm, length: keyLength }, true, ['decrypt']);\n            }\n            catch {\n                cryptoKey = await crypto.subtle.importKey('jwk', derivedEmptyPasswordKey, { name: 'AES-GCM' }, true, ['decrypt']);\n            }\n        }\n        else {\n            // Derive the key using PBKDF2.\n            const deriveParams = { name: 'PBKDF2', salt, iterations, hash: { name: digest } };\n            const rawKey = await crypto.subtle.importKey('raw', password, { name: 'PBKDF2' }, false, ['deriveKey']);\n            cryptoKey = await crypto.subtle.deriveKey(deriveParams, rawKey, { name: algorithm, length: keyLength }, true, ['decrypt']);\n        }\n        // Decrypt the string.\n        const plaintext = await crypto.subtle.decrypt(aesGcm, cryptoKey, ciphertext);\n        return new Uint8Array(plaintext);\n    }\n    const cipher = {\n        encrypt,\n        decrypt\n    };\n    return cipher;\n}\n//# sourceMappingURL=aes-gcm.browser.js.map","import { base64 } from 'multiformats/bases/base64';\nimport * as ciphers from '../ciphers/aes-gcm.js';\n/**\n * Exports the given PrivateKey as a base64 encoded string.\n * The PrivateKey is encrypted via a password derived PBKDF2 key\n * leveraging the aes-gcm cipher algorithm.\n */\nexport async function exporter(privateKey, password) {\n    const cipher = ciphers.create();\n    const encryptedKey = await cipher.encrypt(privateKey, password);\n    return base64.encode(encryptedKey);\n}\n//# sourceMappingURL=exporter.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { enumeration, encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var KeyType;\n(function (KeyType) {\n    KeyType[\"RSA\"] = \"RSA\";\n    KeyType[\"Ed25519\"] = \"Ed25519\";\n    KeyType[\"Secp256k1\"] = \"Secp256k1\";\n})(KeyType || (KeyType = {}));\nvar __KeyTypeValues;\n(function (__KeyTypeValues) {\n    __KeyTypeValues[__KeyTypeValues[\"RSA\"] = 0] = \"RSA\";\n    __KeyTypeValues[__KeyTypeValues[\"Ed25519\"] = 1] = \"Ed25519\";\n    __KeyTypeValues[__KeyTypeValues[\"Secp256k1\"] = 2] = \"Secp256k1\";\n})(__KeyTypeValues || (__KeyTypeValues = {}));\n(function (KeyType) {\n    KeyType.codec = () => {\n        return enumeration(__KeyTypeValues);\n    };\n})(KeyType || (KeyType = {}));\nexport var PublicKey;\n(function (PublicKey) {\n    let _codec;\n    PublicKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PublicKey.encode = (obj) => {\n        return encodeMessage(obj, PublicKey.codec());\n    };\n    PublicKey.decode = (buf) => {\n        return decodeMessage(buf, PublicKey.codec());\n    };\n})(PublicKey || (PublicKey = {}));\nexport var PrivateKey;\n(function (PrivateKey) {\n    let _codec;\n    PrivateKey.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.Type != null) {\n                    w.uint32(8);\n                    KeyType.codec().encode(obj.Type, w);\n                }\n                if (obj.Data != null) {\n                    w.uint32(18);\n                    w.bytes(obj.Data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.Type = KeyType.codec().decode(reader);\n                            break;\n                        case 2:\n                            obj.Data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    PrivateKey.encode = (obj) => {\n        return encodeMessage(obj, PrivateKey.codec());\n    };\n    PrivateKey.decode = (buf) => {\n        return decodeMessage(buf, PrivateKey.codec());\n    };\n})(PrivateKey || (PrivateKey = {}));\n//# sourceMappingURL=keys.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport * as crypto from './ed25519.js';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nexport class Ed25519PublicKey {\n    _key;\n    constructor(key) {\n        this._key = ensureKey(key, crypto.publicKeyLength);\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Ed25519PrivateKey {\n    _key;\n    _publicKey;\n    // key       - 64 byte Uint8Array containing private key\n    // publicKey - 32 byte Uint8Array containing public key\n    constructor(key, publicKey) {\n        this._key = ensureKey(key, crypto.privateKeyLength);\n        this._publicKey = ensureKey(publicKey, crypto.publicKeyLength);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Ed25519PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.Ed25519,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the identity multihash containing its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     *\n     * @returns {Promise<string>}\n     */\n    async id() {\n        const encoding = identity.digest(this.public.bytes);\n        return base58btc.encode(encoding.bytes).substring(1);\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalEd25519PrivateKey(bytes) {\n    // Try the old, redundant public key version\n    if (bytes.length > crypto.privateKeyLength) {\n        bytes = ensureKey(bytes, crypto.privateKeyLength + crypto.publicKeyLength);\n        const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n        const publicKeyBytes = bytes.subarray(crypto.privateKeyLength, bytes.length);\n        return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n    }\n    bytes = ensureKey(bytes, crypto.privateKeyLength);\n    const privateKeyBytes = bytes.subarray(0, crypto.privateKeyLength);\n    const publicKeyBytes = bytes.subarray(crypto.publicKeyLength);\n    return new Ed25519PrivateKey(privateKeyBytes, publicKeyBytes);\n}\nexport function unmarshalEd25519PublicKey(bytes) {\n    bytes = ensureKey(bytes, crypto.publicKeyLength);\n    return new Ed25519PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const { privateKey, publicKey } = await crypto.generateKey();\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nexport async function generateKeyPairFromSeed(seed) {\n    const { privateKey, publicKey } = await crypto.generateKeyFromSeed(seed);\n    return new Ed25519PrivateKey(privateKey, publicKey);\n}\nfunction ensureKey(key, length) {\n    key = Uint8Array.from(key ?? []);\n    if (key.length !== length) {\n        throw new CodeError(`Key must be a Uint8Array of length ${length}, got ${key.length}`, 'ERR_INVALID_KEY_TYPE');\n    }\n    return key;\n}\n//# sourceMappingURL=ed25519-class.js.map","import bases, {} from './util/bases.js';\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString(array, encoding = 'utf8') {\n    const base = bases[encoding];\n    if (base == null) {\n        throw new Error(`Unsupported encoding \"${encoding}\"`);\n    }\n    if ((encoding === 'utf8' || encoding === 'utf-8') && globalThis.Buffer != null && globalThis.Buffer.from != null) {\n        return globalThis.Buffer.from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');\n    }\n    // strip multibase prefix\n    return base.encoder.encode(array).substring(1);\n}\n//# sourceMappingURL=to-string.js.map","import 'node-forge/lib/util.js';\nimport 'node-forge/lib/jsbn.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nexport function bigIntegerToUintBase64url(num, len) {\n    // Call `.abs()` to convert to unsigned\n    let buf = Uint8Array.from(num.abs().toByteArray()); // toByteArray converts to big endian\n    // toByteArray() gives us back a signed array, which will include a leading 0\n    // byte if the most significant bit of the number is 1:\n    // https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-integer\n    // Our number will always be positive so we should remove the leading padding.\n    buf = buf[0] === 0 ? buf.subarray(1) : buf;\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return uint8ArrayToString(buf, 'base64url');\n}\n// Convert a base64url encoded string to a BigInteger\nexport function base64urlToBigInteger(str) {\n    const buf = base64urlToBuffer(str);\n    return new forge.jsbn.BigInteger(uint8ArrayToString(buf, 'base16'), 16);\n}\nexport function base64urlToBuffer(str, len) {\n    let buf = uint8ArrayFromString(str, 'base64urlpad');\n    if (len != null) {\n        if (buf.length > len)\n            throw new Error('byte array longer than desired length');\n        buf = uint8ArrayConcat([new Uint8Array(len - buf.length), buf]);\n    }\n    return buf;\n}\n//# sourceMappingURL=util.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { base64urlToBuffer } from '../util.js';\nimport webcrypto from '../webcrypto.js';\nconst bits = {\n    'P-256': 256,\n    'P-384': 384,\n    'P-521': 521\n};\nconst curveTypes = Object.keys(bits);\nconst names = curveTypes.join(' / ');\nexport async function generateEphmeralKeyPair(curve) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'ECDH',\n        namedCurve: curve\n    }, true, ['deriveBits']);\n    // forcePrivate is used for testing only\n    const genSharedKey = async (theirPub, forcePrivate) => {\n        let privateKey;\n        if (forcePrivate != null) {\n            privateKey = await webcrypto.get().subtle.importKey('jwk', unmarshalPrivateKey(curve, forcePrivate), {\n                name: 'ECDH',\n                namedCurve: curve\n            }, false, ['deriveBits']);\n        }\n        else {\n            privateKey = pair.privateKey;\n        }\n        const key = await webcrypto.get().subtle.importKey('jwk', unmarshalPublicKey(curve, theirPub), {\n            name: 'ECDH',\n            namedCurve: curve\n        }, false, []);\n        const buffer = await webcrypto.get().subtle.deriveBits({\n            name: 'ECDH',\n            // @ts-expect-error namedCurve is missing from the types\n            namedCurve: curve,\n            public: key\n        }, privateKey, bits[curve]);\n        return new Uint8Array(buffer, 0, buffer.byteLength);\n    };\n    const publicKey = await webcrypto.get().subtle.exportKey('jwk', pair.publicKey);\n    const ecdhKey = {\n        key: marshalPublicKey(publicKey),\n        genSharedKey\n    };\n    return ecdhKey;\n}\nconst curveLengths = {\n    'P-256': 32,\n    'P-384': 48,\n    'P-521': 66\n};\n// Marshal converts a jwk encoded ECDH public key into the\n// form specified in section 4.3.6 of ANSI X9.62. (This is the format\n// go-ipfs uses)\nfunction marshalPublicKey(jwk) {\n    if (jwk.crv == null || jwk.x == null || jwk.y == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    if (jwk.crv !== 'P-256' && jwk.crv !== 'P-384' && jwk.crv !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${jwk.crv}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[jwk.crv];\n    return uint8ArrayConcat([\n        Uint8Array.from([4]),\n        base64urlToBuffer(jwk.x, byteLen),\n        base64urlToBuffer(jwk.y, byteLen)\n    ], 1 + byteLen * 2);\n}\n// Unmarshal converts a point, serialized by Marshal, into an jwk encoded key\nfunction unmarshalPublicKey(curve, key) {\n    if (curve !== 'P-256' && curve !== 'P-384' && curve !== 'P-521') {\n        throw new CodeError(`Unknown curve: ${curve}. Must be ${names}`, 'ERR_INVALID_CURVE');\n    }\n    const byteLen = curveLengths[curve];\n    if (!uint8ArrayEquals(key.subarray(0, 1), Uint8Array.from([4]))) {\n        throw new CodeError('Cannot unmarshal public key - invalid key format', 'ERR_INVALID_KEY_FORMAT');\n    }\n    return {\n        kty: 'EC',\n        crv: curve,\n        x: uint8ArrayToString(key.subarray(1, byteLen + 1), 'base64url'),\n        y: uint8ArrayToString(key.subarray(1 + byteLen), 'base64url'),\n        ext: true\n    };\n}\nconst unmarshalPrivateKey = (curve, key) => ({\n    ...unmarshalPublicKey(curve, key.public),\n    d: uint8ArrayToString(key.private, 'base64url')\n});\n//# sourceMappingURL=ecdh-browser.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { randomBytes as randB } from '@noble/hashes/utils';\nexport default function randomBytes(length) {\n    if (isNaN(length) || length <= 0) {\n        throw new CodeError('random bytes length must be a Number bigger than 0', 'ERR_INVALID_LENGTH');\n    }\n    return randB(length);\n}\n//# sourceMappingURL=random-bytes.js.map","import 'node-forge/lib/rsa.js';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { base64urlToBigInteger } from '../util.js';\nfunction convert(key, types) {\n    return types.map(t => base64urlToBigInteger(key[t]));\n}\nexport function jwk2priv(key) {\n    return forge.pki.setRsaPrivateKey(...convert(key, ['n', 'e', 'd', 'p', 'q', 'dp', 'dq', 'qi']));\n}\nexport function jwk2pub(key) {\n    return forge.pki.setRsaPublicKey(...convert(key, ['n', 'e']));\n}\n//# sourceMappingURL=jwk2pem.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport randomBytes from '../random-bytes.js';\nimport webcrypto from '../webcrypto.js';\nimport { jwk2pub, jwk2priv } from './jwk2pem.js';\nimport * as utils from './rsa-utils.js';\nexport { utils };\nexport async function generateKey(bits) {\n    const pair = await webcrypto.get().subtle.generateKey({\n        name: 'RSASSA-PKCS1-v1_5',\n        modulusLength: bits,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        hash: { name: 'SHA-256' }\n    }, true, ['sign', 'verify']);\n    const keys = await exportKey(pair);\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\n// Takes a jwk key\nexport async function unmarshalPrivateKey(key) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['sign']);\n    const pair = [\n        privateKey,\n        await derivePublicFromPrivate(key)\n    ];\n    const keys = await exportKey({\n        privateKey: pair[0],\n        publicKey: pair[1]\n    });\n    return {\n        privateKey: keys[0],\n        publicKey: keys[1]\n    };\n}\nexport { randomBytes as getRandomValues };\nexport async function hashAndSign(key, msg) {\n    const privateKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['sign']);\n    const sig = await webcrypto.get().subtle.sign({ name: 'RSASSA-PKCS1-v1_5' }, privateKey, Uint8Array.from(msg));\n    return new Uint8Array(sig, 0, sig.byteLength);\n}\nexport async function hashAndVerify(key, sig, msg) {\n    const publicKey = await webcrypto.get().subtle.importKey('jwk', key, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, false, ['verify']);\n    return webcrypto.get().subtle.verify({ name: 'RSASSA-PKCS1-v1_5' }, publicKey, sig, msg);\n}\nasync function exportKey(pair) {\n    if (pair.privateKey == null || pair.publicKey == null) {\n        throw new CodeError('Private and public key are required', 'ERR_INVALID_PARAMETERS');\n    }\n    return Promise.all([\n        webcrypto.get().subtle.exportKey('jwk', pair.privateKey),\n        webcrypto.get().subtle.exportKey('jwk', pair.publicKey)\n    ]);\n}\nasync function derivePublicFromPrivate(jwKey) {\n    return webcrypto.get().subtle.importKey('jwk', {\n        kty: jwKey.kty,\n        n: jwKey.n,\n        e: jwKey.e\n    }, {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    }, true, ['verify']);\n}\n/*\n\nRSA encryption/decryption for the browser with webcrypto workaround\n\"bloody dark magic. webcrypto's why.\"\n\nExplanation:\n  - Convert JWK to nodeForge\n  - Convert msg Uint8Array to nodeForge buffer: ByteBuffer is a \"binary-string backed buffer\", so let's make our Uint8Array a binary string\n  - Convert resulting nodeForge buffer to Uint8Array: it returns a binary string, turn that into a Uint8Array\n\n*/\nfunction convertKey(key, pub, msg, handle) {\n    const fkey = pub ? jwk2pub(key) : jwk2priv(key);\n    const fmsg = uint8ArrayToString(Uint8Array.from(msg), 'ascii');\n    const fomsg = handle(fmsg, fkey);\n    return uint8ArrayFromString(fomsg, 'ascii');\n}\nexport function encrypt(key, msg) {\n    return convertKey(key, true, msg, (msg, key) => key.encrypt(msg));\n}\nexport function decrypt(key, msg) {\n    return convertKey(key, false, msg, (msg, key) => key.decrypt(msg));\n}\nexport function keySize(jwk) {\n    if (jwk.kty !== 'RSA') {\n        throw new CodeError('invalid key type', 'ERR_INVALID_KEY_TYPE');\n    }\n    else if (jwk.n == null) {\n        throw new CodeError('invalid key modulus', 'ERR_INVALID_KEY_MODULUS');\n    }\n    const bytes = uint8ArrayFromString(jwk.n, 'base64url');\n    return bytes.length * 8;\n}\n//# sourceMappingURL=rsa-browser.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport 'node-forge/lib/sha512.js';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as pbm from './keys.js';\nimport * as crypto from './rsa.js';\nexport const MAX_KEY_SIZE = 8192;\nexport class RsaPublicKey {\n    _key;\n    constructor(key) {\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkix(this._key);\n    }\n    get bytes() {\n        return pbm.PublicKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    encrypt(bytes) {\n        return crypto.encrypt(this._key, bytes);\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class RsaPrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey;\n    }\n    genSecret() {\n        return crypto.getRandomValues(16);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        if (this._publicKey == null) {\n            throw new CodeError('public key not provided', 'ERR_PUBKEY_NOT_PROVIDED');\n        }\n        return new RsaPublicKey(this._publicKey);\n    }\n    decrypt(bytes) {\n        return crypto.decrypt(this._key, bytes);\n    }\n    marshal() {\n        return crypto.utils.jwkToPkcs1(this._key);\n    }\n    get bytes() {\n        return pbm.PrivateKey.encode({\n            Type: pbm.KeyType.RSA,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected PEM format\n     */\n    async export(password, format = 'pkcs-8') {\n        if (format === 'pkcs-8') {\n            const buffer = new forge.util.ByteBuffer(this.marshal());\n            const asn1 = forge.asn1.fromDer(buffer);\n            const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n            const options = {\n                algorithm: 'aes256',\n                count: 10000,\n                saltSize: 128 / 8,\n                prfAlgorithm: 'sha512'\n            };\n            return forge.pki.encryptRsaPrivateKey(privateKey, password, options);\n        }\n        else if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport async function unmarshalRsaPrivateKey(bytes) {\n    const jwk = crypto.utils.pkcs1ToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport function unmarshalRsaPublicKey(bytes) {\n    const jwk = crypto.utils.pkixToJwk(bytes);\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    return new RsaPublicKey(jwk);\n}\nexport async function fromJwk(jwk) {\n    if (crypto.keySize(jwk) > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.unmarshalPrivateKey(jwk);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\nexport async function generateKeyPair(bits) {\n    if (bits > MAX_KEY_SIZE) {\n        throw new CodeError('key size is too large', 'ERR_KEY_SIZE_TOO_LARGE');\n    }\n    const keys = await crypto.generateKey(bits);\n    return new RsaPrivateKey(keys.privateKey, keys.publicKey);\n}\n//# sourceMappingURL=rsa-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/rsa.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { bigIntegerToUintBase64url, base64urlToBigInteger } from './../util.js';\n// Convert a PKCS#1 in ASN1 DER format to a JWK key\nexport function pkcs1ToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const privateKey = forge.pki.privateKeyFromAsn1(asn1);\n    // https://tools.ietf.org/html/rfc7518#section-6.3.1\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(privateKey.n),\n        e: bigIntegerToUintBase64url(privateKey.e),\n        d: bigIntegerToUintBase64url(privateKey.d),\n        p: bigIntegerToUintBase64url(privateKey.p),\n        q: bigIntegerToUintBase64url(privateKey.q),\n        dp: bigIntegerToUintBase64url(privateKey.dP),\n        dq: bigIntegerToUintBase64url(privateKey.dQ),\n        qi: bigIntegerToUintBase64url(privateKey.qInv),\n        alg: 'RS256'\n    };\n}\n// Convert a JWK key into PKCS#1 in ASN1 DER format\nexport function jwkToPkcs1(jwk) {\n    if (jwk.n == null || jwk.e == null || jwk.d == null || jwk.p == null || jwk.q == null || jwk.dp == null || jwk.dq == null || jwk.qi == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.privateKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e),\n        d: base64urlToBigInteger(jwk.d),\n        p: base64urlToBigInteger(jwk.p),\n        q: base64urlToBigInteger(jwk.q),\n        dP: base64urlToBigInteger(jwk.dp),\n        dQ: base64urlToBigInteger(jwk.dq),\n        qInv: base64urlToBigInteger(jwk.qi)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n// Convert a PKCIX in ASN1 DER format to a JWK key\nexport function pkixToJwk(bytes) {\n    const asn1 = forge.asn1.fromDer(uint8ArrayToString(bytes, 'ascii'));\n    const publicKey = forge.pki.publicKeyFromAsn1(asn1);\n    return {\n        kty: 'RSA',\n        n: bigIntegerToUintBase64url(publicKey.n),\n        e: bigIntegerToUintBase64url(publicKey.e)\n    };\n}\n// Convert a JWK key to PKCIX in ASN1 DER format\nexport function jwkToPkix(jwk) {\n    if (jwk.n == null || jwk.e == null) {\n        throw new CodeError('JWK was missing components', 'ERR_INVALID_PARAMETERS');\n    }\n    const asn1 = forge.pki.publicKeyToAsn1({\n        n: base64urlToBigInteger(jwk.n),\n        e: base64urlToBigInteger(jwk.e)\n    });\n    return uint8ArrayFromString(forge.asn1.toDer(asn1).getBytes(), 'ascii');\n}\n//# sourceMappingURL=rsa-utils.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { secp256k1 as secp } from '@noble/curves/secp256k1';\nimport { sha256 } from 'multiformats/hashes/sha2';\nconst PRIVATE_KEY_BYTE_LENGTH = 32;\nexport { PRIVATE_KEY_BYTE_LENGTH as privateKeyLength };\nexport function generateKey() {\n    return secp.utils.randomPrivateKey();\n}\n/**\n * Hash and sign message with private key\n */\nexport async function hashAndSign(key, msg) {\n    const { digest } = await sha256.digest(msg);\n    try {\n        const signature = secp.sign(digest, key);\n        return signature.toDERRawBytes();\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\n/**\n * Hash message and verify signature with public key\n */\nexport async function hashAndVerify(key, sig, msg) {\n    try {\n        const { digest } = await sha256.digest(msg);\n        return secp.verify(sig, digest, key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_INPUT');\n    }\n}\nexport function compressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(true);\n    return point;\n}\nexport function decompressPublicKey(key) {\n    const point = secp.ProjectivePoint.fromHex(key).toRawBytes(false);\n    return point;\n}\nexport function validatePrivateKey(key) {\n    try {\n        secp.getPublicKey(key, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\nexport function validatePublicKey(key) {\n    try {\n        secp.ProjectivePoint.fromHex(key);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PUBLIC_KEY');\n    }\n}\nexport function computePublicKey(privateKey) {\n    try {\n        return secp.getPublicKey(privateKey, true);\n    }\n    catch (err) {\n        throw new CodeError(String(err), 'ERR_INVALID_PRIVATE_KEY');\n    }\n}\n//# sourceMappingURL=secp256k1.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport { exporter } from './exporter.js';\nimport * as keysProtobuf from './keys.js';\nimport * as crypto from './secp256k1.js';\nexport class Secp256k1PublicKey {\n    _key;\n    constructor(key) {\n        crypto.validatePublicKey(key);\n        this._key = key;\n    }\n    async verify(data, sig) {\n        return crypto.hashAndVerify(this._key, sig, data);\n    }\n    marshal() {\n        return crypto.compressPublicKey(this._key);\n    }\n    get bytes() {\n        return keysProtobuf.PublicKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n}\nexport class Secp256k1PrivateKey {\n    _key;\n    _publicKey;\n    constructor(key, publicKey) {\n        this._key = key;\n        this._publicKey = publicKey ?? crypto.computePublicKey(key);\n        crypto.validatePrivateKey(this._key);\n        crypto.validatePublicKey(this._publicKey);\n    }\n    async sign(message) {\n        return crypto.hashAndSign(this._key, message);\n    }\n    get public() {\n        return new Secp256k1PublicKey(this._publicKey);\n    }\n    marshal() {\n        return this._key;\n    }\n    get bytes() {\n        return keysProtobuf.PrivateKey.encode({\n            Type: keysProtobuf.KeyType.Secp256k1,\n            Data: this.marshal()\n        }).subarray();\n    }\n    equals(key) {\n        return uint8ArrayEquals(this.bytes, key.bytes);\n    }\n    async hash() {\n        const { bytes } = await sha256.digest(this.bytes);\n        return bytes;\n    }\n    /**\n     * Gets the ID of the key.\n     *\n     * The key id is the base58 encoding of the SHA-256 multihash of its public key.\n     * The public key is a protobuf encoding containing a type and the DER encoding\n     * of the PKCS SubjectPublicKeyInfo.\n     */\n    async id() {\n        const hash = await this.public.hash();\n        return uint8ArrayToString(hash, 'base58btc');\n    }\n    /**\n     * Exports the key into a password protected `format`\n     */\n    async export(password, format = 'libp2p-key') {\n        if (format === 'libp2p-key') {\n            return exporter(this.bytes, password);\n        }\n        else {\n            throw new CodeError(`export format '${format}' is not supported`, 'ERR_INVALID_EXPORT_FORMAT');\n        }\n    }\n}\nexport function unmarshalSecp256k1PrivateKey(bytes) {\n    return new Secp256k1PrivateKey(bytes);\n}\nexport function unmarshalSecp256k1PublicKey(bytes) {\n    return new Secp256k1PublicKey(bytes);\n}\nexport async function generateKeyPair() {\n    const privateKeyBytes = crypto.generateKey();\n    return new Secp256k1PrivateKey(privateKeyBytes);\n}\n//# sourceMappingURL=secp256k1-class.js.map","import 'node-forge/lib/asn1.js';\nimport 'node-forge/lib/pbe.js';\nimport { CodeError } from '@libp2p/interface/errors';\n// @ts-expect-error types are missing\nimport forge from 'node-forge/lib/forge.js';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport * as Ed25519 from './ed25519-class.js';\nimport generateEphemeralKeyPair from './ephemeral-keys.js';\nimport { importer } from './importer.js';\nimport { keyStretcher } from './key-stretcher.js';\nimport * as keysPBM from './keys.js';\nimport * as RSA from './rsa-class.js';\nimport * as Secp256k1 from './secp256k1-class.js';\nexport { keyStretcher };\nexport { generateEphemeralKeyPair };\nexport { keysPBM };\nexport const supportedKeys = {\n    rsa: RSA,\n    ed25519: Ed25519,\n    secp256k1: Secp256k1\n};\nfunction unsupportedKey(type) {\n    const supported = Object.keys(supportedKeys).join(' / ');\n    return new CodeError(`invalid or unsupported key type ${type}. Must be ${supported}`, 'ERR_UNSUPPORTED_KEY_TYPE');\n}\nfunction typeToKey(type) {\n    type = type.toLowerCase();\n    if (type === 'rsa' || type === 'ed25519' || type === 'secp256k1') {\n        return supportedKeys[type];\n    }\n    throw unsupportedKey(type);\n}\n// Generates a keypair of the given type and bitsize\nexport async function generateKeyPair(type, bits) {\n    return typeToKey(type).generateKeyPair(bits ?? 2048);\n}\n// Generates a keypair of the given type and bitsize\n// seed is a 32 byte uint8array\nexport async function generateKeyPairFromSeed(type, seed, bits) {\n    if (type.toLowerCase() !== 'ed25519') {\n        throw new CodeError('Seed key derivation is unimplemented for RSA or secp256k1', 'ERR_UNSUPPORTED_KEY_DERIVATION_TYPE');\n    }\n    return Ed25519.generateKeyPairFromSeed(seed);\n}\n// Converts a protobuf serialized public key into its\n// representative object\nexport function unmarshalPublicKey(buf) {\n    const decoded = keysPBM.PublicKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPublicKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PublicKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'unknown');\n    }\n}\n// Converts a public key object into a protobuf serialized public key\nexport function marshalPublicKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n// Converts a protobuf serialized private key into its\n// representative object\nexport async function unmarshalPrivateKey(buf) {\n    const decoded = keysPBM.PrivateKey.decode(buf);\n    const data = decoded.Data ?? new Uint8Array();\n    switch (decoded.Type) {\n        case keysPBM.KeyType.RSA:\n            return supportedKeys.rsa.unmarshalRsaPrivateKey(data);\n        case keysPBM.KeyType.Ed25519:\n            return supportedKeys.ed25519.unmarshalEd25519PrivateKey(data);\n        case keysPBM.KeyType.Secp256k1:\n            return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey(data);\n        default:\n            throw unsupportedKey(decoded.Type ?? 'RSA');\n    }\n}\n// Converts a private key object into a protobuf serialized private key\nexport function marshalPrivateKey(key, type) {\n    type = (type ?? 'rsa').toLowerCase();\n    typeToKey(type); // check type\n    return key.bytes;\n}\n/**\n *\n * @param {string} encryptedKey\n * @param {string} password\n */\nexport async function importKey(encryptedKey, password) {\n    try {\n        const key = await importer(encryptedKey, password);\n        return await unmarshalPrivateKey(key);\n    }\n    catch (_) {\n        // Ignore and try the old pem decrypt\n    }\n    // Only rsa supports pem right now\n    const key = forge.pki.decryptRsaPrivateKey(encryptedKey, password);\n    if (key === null) {\n        throw new CodeError('Cannot read the key, most likely the password is wrong or not a RSA key', 'ERR_CANNOT_DECRYPT_PEM');\n    }\n    let der = forge.asn1.toDer(forge.pki.privateKeyToAsn1(key));\n    der = uint8ArrayFromString(der.getBytes(), 'ascii');\n    return supportedKeys.rsa.unmarshalRsaPrivateKey(der);\n}\n//# sourceMappingURL=index.js.map","/**\n * Returns true if the two passed Uint8Arrays have the same content\n */\nexport function equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a.byteLength !== b.byteLength) {\n        return false;\n    }\n    for (let i = 0; i < a.byteLength; i++) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=equals.js.map","import { CodeError } from '@libp2p/interface/errors';\nimport { symbol } from '@libp2p/interface/peer-id';\nimport { base58btc } from 'multiformats/bases/base58';\nimport { bases } from 'multiformats/basics';\nimport { CID } from 'multiformats/cid';\nimport * as Digest from 'multiformats/hashes/digest';\nimport { identity } from 'multiformats/hashes/identity';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nconst inspect = Symbol.for('nodejs.util.inspect.custom');\nconst baseDecoder = Object\n    .values(bases)\n    .map(codec => codec.decoder)\n    // @ts-expect-error https://github.com/multiformats/js-multiformats/issues/141\n    .reduce((acc, curr) => acc.or(curr), bases.identity.decoder);\n// these values are from https://github.com/multiformats/multicodec/blob/master/table.csv\nconst LIBP2P_KEY_CODE = 0x72;\nconst MARSHALLED_ED225519_PUBLIC_KEY_LENGTH = 36;\nconst MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH = 37;\nclass PeerIdImpl {\n    type;\n    multihash;\n    privateKey;\n    publicKey;\n    string;\n    constructor(init) {\n        this.type = init.type;\n        this.multihash = init.multihash;\n        this.privateKey = init.privateKey;\n        // mark string cache as non-enumerable\n        Object.defineProperty(this, 'string', {\n            enumerable: false,\n            writable: true\n        });\n    }\n    get [Symbol.toStringTag]() {\n        return `PeerId(${this.toString()})`;\n    }\n    [symbol] = true;\n    toString() {\n        if (this.string == null) {\n            this.string = base58btc.encode(this.multihash.bytes).slice(1);\n        }\n        return this.string;\n    }\n    // return self-describing String representation\n    // in default format from RFC 0001: https://github.com/libp2p/specs/pull/209\n    toCID() {\n        return CID.createV1(LIBP2P_KEY_CODE, this.multihash);\n    }\n    toBytes() {\n        return this.multihash.bytes;\n    }\n    /**\n     * Returns Multiaddr as a JSON string\n     */\n    toJSON() {\n        return this.toString();\n    }\n    /**\n     * Checks the equality of `this` peer against a given PeerId\n     */\n    equals(id) {\n        if (id instanceof Uint8Array) {\n            return uint8ArrayEquals(this.multihash.bytes, id);\n        }\n        else if (typeof id === 'string') {\n            return peerIdFromString(id).equals(this);\n        }\n        else if (id?.multihash?.bytes != null) {\n            return uint8ArrayEquals(this.multihash.bytes, id.multihash.bytes);\n        }\n        else {\n            throw new Error('not valid Id');\n        }\n    }\n    /**\n     * Returns PeerId as a human-readable string\n     * https://nodejs.org/api/util.html#utilinspectcustom\n     *\n     * @example\n     * ```js\n     * import { peerIdFromString } from '@libp2p/peer-id'\n     *\n     * console.info(peerIdFromString('QmFoo'))\n     * // 'PeerId(QmFoo)'\n     * ```\n     */\n    [inspect]() {\n        return `PeerId(${this.toString()})`;\n    }\n}\nclass RSAPeerIdImpl extends PeerIdImpl {\n    type = 'RSA';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'RSA' });\n        this.publicKey = init.publicKey;\n    }\n}\nclass Ed25519PeerIdImpl extends PeerIdImpl {\n    type = 'Ed25519';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'Ed25519' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nclass Secp256k1PeerIdImpl extends PeerIdImpl {\n    type = 'secp256k1';\n    publicKey;\n    constructor(init) {\n        super({ ...init, type: 'secp256k1' });\n        this.publicKey = init.multihash.digest;\n    }\n}\nexport function createPeerId(init) {\n    if (init.type === 'RSA') {\n        return new RSAPeerIdImpl(init);\n    }\n    if (init.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(init);\n    }\n    if (init.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(init);\n    }\n    throw new CodeError('Type must be \"RSA\", \"Ed25519\" or \"secp256k1\"', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromPeerId(other) {\n    if (other.type === 'RSA') {\n        return new RSAPeerIdImpl(other);\n    }\n    if (other.type === 'Ed25519') {\n        return new Ed25519PeerIdImpl(other);\n    }\n    if (other.type === 'secp256k1') {\n        return new Secp256k1PeerIdImpl(other);\n    }\n    throw new CodeError('Not a PeerId', 'ERR_INVALID_PARAMETERS');\n}\nexport function peerIdFromString(str, decoder) {\n    decoder = decoder ?? baseDecoder;\n    if (str.charAt(0) === '1' || str.charAt(0) === 'Q') {\n        // identity hash ed25519/secp256k1 key or sha2-256 hash of\n        // rsa public key - base58btc encoded either way\n        const multihash = Digest.decode(base58btc.decode(`z${str}`));\n        if (str.startsWith('12D')) {\n            return new Ed25519PeerIdImpl({ multihash });\n        }\n        else if (str.startsWith('16U')) {\n            return new Secp256k1PeerIdImpl({ multihash });\n        }\n        else {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    return peerIdFromBytes(baseDecoder.decode(str));\n}\nexport function peerIdFromBytes(buf) {\n    try {\n        const multihash = Digest.decode(buf);\n        if (multihash.code === identity.code) {\n            if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n                return new Ed25519PeerIdImpl({ multihash });\n            }\n            else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n                return new Secp256k1PeerIdImpl({ multihash });\n            }\n        }\n        if (multihash.code === sha256.code) {\n            return new RSAPeerIdImpl({ multihash });\n        }\n    }\n    catch {\n        return peerIdFromCID(CID.decode(buf));\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\nexport function peerIdFromCID(cid) {\n    if (cid == null || cid.multihash == null || cid.version == null || (cid.version === 1 && cid.code !== LIBP2P_KEY_CODE)) {\n        throw new Error('Supplied PeerID CID is invalid');\n    }\n    const multihash = cid.multihash;\n    if (multihash.code === sha256.code) {\n        return new RSAPeerIdImpl({ multihash: cid.multihash });\n    }\n    else if (multihash.code === identity.code) {\n        if (multihash.digest.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n            return new Ed25519PeerIdImpl({ multihash: cid.multihash });\n        }\n        else if (multihash.digest.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n            return new Secp256k1PeerIdImpl({ multihash: cid.multihash });\n        }\n    }\n    throw new Error('Supplied PeerID CID is invalid');\n}\n/**\n * @param publicKey - A marshalled public key\n * @param privateKey - A marshalled private key\n */\nexport async function peerIdFromKeys(publicKey, privateKey) {\n    if (publicKey.length === MARSHALLED_ED225519_PUBLIC_KEY_LENGTH) {\n        return new Ed25519PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    if (publicKey.length === MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH) {\n        return new Secp256k1PeerIdImpl({ multihash: Digest.create(identity.code, publicKey), privateKey });\n    }\n    return new RSAPeerIdImpl({ multihash: await sha256.digest(publicKey), publicKey, privateKey });\n}\n//# sourceMappingURL=index.js.map","export const ERR_IPNS_EXPIRED_RECORD = 'ERR_IPNS_EXPIRED_RECORD';\nexport const ERR_UNRECOGNIZED_VALIDITY = 'ERR_UNRECOGNIZED_VALIDITY';\nexport const ERR_SIGNATURE_CREATION = 'ERR_SIGNATURE_CREATION';\nexport const ERR_SIGNATURE_VERIFICATION = 'ERR_SIGNATURE_VERIFICATION';\nexport const ERR_UNRECOGNIZED_FORMAT = 'ERR_UNRECOGNIZED_FORMAT';\nexport const ERR_PEER_ID_FROM_PUBLIC_KEY = 'ERR_PEER_ID_FROM_PUBLIC_KEY';\nexport const ERR_PUBLIC_KEY_FROM_ID = 'ERR_PUBLIC_KEY_FROM_ID';\nexport const ERR_UNDEFINED_PARAMETER = 'ERR_UNDEFINED_PARAMETER';\nexport const ERR_INVALID_RECORD_DATA = 'ERR_INVALID_RECORD_DATA';\nexport const ERR_INVALID_VALUE = 'ERR_INVALID_VALUE';\nexport const ERR_INVALID_EMBEDDED_KEY = 'ERR_INVALID_EMBEDDED_KEY';\nexport const ERR_MISSING_PRIVATE_KEY = 'ERR_MISSING_PRIVATE_KEY';\nexport const ERR_RECORD_TOO_LARGE = 'ERR_RECORD_TOO_LARGE';\n//# sourceMappingURL=errors.js.map","/* eslint-disable import/export */\n/* eslint-disable complexity */\n/* eslint-disable @typescript-eslint/no-namespace */\n/* eslint-disable @typescript-eslint/no-unnecessary-boolean-literal-compare */\n/* eslint-disable @typescript-eslint/no-empty-interface */\nimport { enumeration, encodeMessage, decodeMessage, message } from 'protons-runtime';\nexport var IpnsEntry;\n(function (IpnsEntry) {\n    let ValidityType;\n    (function (ValidityType) {\n        ValidityType[\"EOL\"] = \"EOL\";\n    })(ValidityType = IpnsEntry.ValidityType || (IpnsEntry.ValidityType = {}));\n    let __ValidityTypeValues;\n    (function (__ValidityTypeValues) {\n        __ValidityTypeValues[__ValidityTypeValues[\"EOL\"] = 0] = \"EOL\";\n    })(__ValidityTypeValues || (__ValidityTypeValues = {}));\n    (function (ValidityType) {\n        ValidityType.codec = () => {\n            return enumeration(__ValidityTypeValues);\n        };\n    })(ValidityType = IpnsEntry.ValidityType || (IpnsEntry.ValidityType = {}));\n    let _codec;\n    IpnsEntry.codec = () => {\n        if (_codec == null) {\n            _codec = message((obj, w, opts = {}) => {\n                if (opts.lengthDelimited !== false) {\n                    w.fork();\n                }\n                if (obj.value != null) {\n                    w.uint32(10);\n                    w.bytes(obj.value);\n                }\n                if (obj.signatureV1 != null) {\n                    w.uint32(18);\n                    w.bytes(obj.signatureV1);\n                }\n                if (obj.validityType != null) {\n                    w.uint32(24);\n                    IpnsEntry.ValidityType.codec().encode(obj.validityType, w);\n                }\n                if (obj.validity != null) {\n                    w.uint32(34);\n                    w.bytes(obj.validity);\n                }\n                if (obj.sequence != null) {\n                    w.uint32(40);\n                    w.uint64(obj.sequence);\n                }\n                if (obj.ttl != null) {\n                    w.uint32(48);\n                    w.uint64(obj.ttl);\n                }\n                if (obj.pubKey != null) {\n                    w.uint32(58);\n                    w.bytes(obj.pubKey);\n                }\n                if (obj.signatureV2 != null) {\n                    w.uint32(66);\n                    w.bytes(obj.signatureV2);\n                }\n                if (obj.data != null) {\n                    w.uint32(74);\n                    w.bytes(obj.data);\n                }\n                if (opts.lengthDelimited !== false) {\n                    w.ldelim();\n                }\n            }, (reader, length) => {\n                const obj = {};\n                const end = length == null ? reader.len : reader.pos + length;\n                while (reader.pos < end) {\n                    const tag = reader.uint32();\n                    switch (tag >>> 3) {\n                        case 1:\n                            obj.value = reader.bytes();\n                            break;\n                        case 2:\n                            obj.signatureV1 = reader.bytes();\n                            break;\n                        case 3:\n                            obj.validityType = IpnsEntry.ValidityType.codec().decode(reader);\n                            break;\n                        case 4:\n                            obj.validity = reader.bytes();\n                            break;\n                        case 5:\n                            obj.sequence = reader.uint64();\n                            break;\n                        case 6:\n                            obj.ttl = reader.uint64();\n                            break;\n                        case 7:\n                            obj.pubKey = reader.bytes();\n                            break;\n                        case 8:\n                            obj.signatureV2 = reader.bytes();\n                            break;\n                        case 9:\n                            obj.data = reader.bytes();\n                            break;\n                        default:\n                            reader.skipType(tag & 7);\n                            break;\n                    }\n                }\n                return obj;\n            });\n        }\n        return _codec;\n    };\n    IpnsEntry.encode = (obj) => {\n        return encodeMessage(obj, IpnsEntry.codec());\n    };\n    IpnsEntry.decode = (buf) => {\n        return decodeMessage(buf, IpnsEntry.codec());\n    };\n})(IpnsEntry || (IpnsEntry = {}));\n//# sourceMappingURL=ipns.js.map","import { unmarshalPublicKey } from '@libp2p/crypto/keys';\nimport { isPeerId } from '@libp2p/interface/peer-id';\nimport { logger } from '@libp2p/logger';\nimport { peerIdFromBytes, peerIdFromKeys } from '@libp2p/peer-id';\nimport * as cborg from 'cborg';\nimport errCode from 'err-code';\nimport { base36 } from 'multiformats/bases/base36';\nimport { CID } from 'multiformats/cid';\nimport NanoDate from 'timestamp-nano';\nimport { concat as uint8ArrayConcat } from 'uint8arrays/concat';\nimport { equals as uint8ArrayEquals } from 'uint8arrays/equals';\nimport { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string';\nimport * as ERRORS from './errors.js';\nimport { IpnsEntry } from './pb/ipns.js';\nconst log = logger('ipns:utils');\nconst IPNS_PREFIX = uint8ArrayFromString('/ipns/');\nconst LIBP2P_CID_CODEC = 114;\n/**\n * Convert a JavaScript date into an `RFC3339Nano` formatted\n * string\n */\nexport function toRFC3339(time) {\n    const year = time.getUTCFullYear();\n    const month = String(time.getUTCMonth() + 1).padStart(2, '0');\n    const day = String(time.getUTCDate()).padStart(2, '0');\n    const hour = String(time.getUTCHours()).padStart(2, '0');\n    const minute = String(time.getUTCMinutes()).padStart(2, '0');\n    const seconds = String(time.getUTCSeconds()).padStart(2, '0');\n    const milliseconds = time.getUTCMilliseconds();\n    const nanoseconds = milliseconds * 1000 * 1000;\n    return `${year}-${month}-${day}T${hour}:${minute}:${seconds}.${nanoseconds}Z`;\n}\n/**\n * Parses a date string formatted as `RFC3339Nano` into a\n * JavaScript Date object\n */\nexport function parseRFC3339(time) {\n    const rfc3339Matcher = new RegExp(\n    // 2006-01-02T\n    '(\\\\d{4})-(\\\\d{2})-(\\\\d{2})T' +\n        // 15:04:05\n        '(\\\\d{2}):(\\\\d{2}):(\\\\d{2})' +\n        // .999999999Z\n        '\\\\.(\\\\d+)Z');\n    const m = String(time).trim().match(rfc3339Matcher);\n    if (m == null) {\n        throw new Error('Invalid format');\n    }\n    const year = parseInt(m[1], 10);\n    const month = parseInt(m[2], 10) - 1;\n    const date = parseInt(m[3], 10);\n    const hour = parseInt(m[4], 10);\n    const minute = parseInt(m[5], 10);\n    const second = parseInt(m[6], 10);\n    const millisecond = parseInt(m[7].padEnd(6, '0').slice(0, 3), 10);\n    return new Date(Date.UTC(year, month, date, hour, minute, second, millisecond));\n}\n/**\n * Extracts a public key from the passed PeerId, falling\n * back to the pubKey embedded in the ipns record\n */\nexport const extractPublicKey = async (peerId, record) => {\n    if (record == null || peerId == null) {\n        const error = new Error('one or more of the provided parameters are not defined');\n        log.error(error);\n        throw errCode(error, ERRORS.ERR_UNDEFINED_PARAMETER);\n    }\n    let pubKey;\n    if (record.pubKey != null) {\n        try {\n            pubKey = unmarshalPublicKey(record.pubKey);\n        }\n        catch (err) {\n            log.error(err);\n            throw err;\n        }\n        const otherId = await peerIdFromKeys(record.pubKey);\n        if (!otherId.equals(peerId)) {\n            throw errCode(new Error('Embedded public key did not match PeerID'), ERRORS.ERR_INVALID_EMBEDDED_KEY);\n        }\n    }\n    else if (peerId.publicKey != null) {\n        pubKey = unmarshalPublicKey(peerId.publicKey);\n    }\n    if (pubKey != null) {\n        return pubKey;\n    }\n    throw errCode(new Error('no public key is available'), ERRORS.ERR_UNDEFINED_PARAMETER);\n};\n/**\n * Utility for creating the record data for being signed\n */\nexport const ipnsRecordDataForV1Sig = (value, validityType, validity) => {\n    const validityTypeBuffer = uint8ArrayFromString(validityType);\n    return uint8ArrayConcat([value, validity, validityTypeBuffer]);\n};\n/**\n * Utility for creating the record data for being signed\n */\nexport const ipnsRecordDataForV2Sig = (data) => {\n    const entryData = uint8ArrayFromString('ipns-signature:');\n    return uint8ArrayConcat([entryData, data]);\n};\nexport const marshal = (obj) => {\n    if ('signatureV1' in obj) {\n        return IpnsEntry.encode({\n            value: uint8ArrayFromString(obj.value),\n            signatureV1: obj.signatureV1,\n            validityType: obj.validityType,\n            validity: uint8ArrayFromString(obj.validity.toString()),\n            sequence: obj.sequence,\n            ttl: obj.ttl,\n            pubKey: obj.pubKey,\n            signatureV2: obj.signatureV2,\n            data: obj.data\n        });\n    }\n    else {\n        return IpnsEntry.encode({\n            pubKey: obj.pubKey,\n            signatureV2: obj.signatureV2,\n            data: obj.data\n        });\n    }\n};\nexport function unmarshal(buf) {\n    const message = IpnsEntry.decode(buf);\n    // protobufjs returns bigints as numbers\n    if (message.sequence != null) {\n        message.sequence = BigInt(message.sequence);\n    }\n    // protobufjs returns bigints as numbers\n    if (message.ttl != null) {\n        message.ttl = BigInt(message.ttl);\n    }\n    // Check if we have the data field. If we don't, we fail. We've been producing\n    // V1+V2 records for quite a while and we don't support V1-only records during\n    // validation any more\n    if (message.signatureV2 == null || message.data == null) {\n        throw errCode(new Error('missing data or signatureV2'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    const data = parseCborData(message.data);\n    const value = normalizeValue(data.Value);\n    let validity;\n    try {\n        validity = NanoDate.fromDate(parseRFC3339(uint8ArrayToString(data.Validity)));\n    }\n    catch (e) {\n        log.error('unrecognized validity format (not an rfc3339 format)');\n        throw errCode(new Error('unrecognized validity format (not an rfc3339 format)'), ERRORS.ERR_UNRECOGNIZED_FORMAT);\n    }\n    if (message.value != null && message.signatureV1 != null) {\n        // V1+V2\n        validateCborDataMatchesPbData(message);\n        return {\n            value,\n            validityType: IpnsEntry.ValidityType.EOL,\n            validity,\n            sequence: data.Sequence,\n            ttl: data.TTL,\n            pubKey: message.pubKey,\n            signatureV1: message.signatureV1,\n            signatureV2: message.signatureV2,\n            data: message.data\n        };\n    }\n    else if (message.signatureV2 != null) {\n        // V2-only\n        return {\n            value,\n            validityType: IpnsEntry.ValidityType.EOL,\n            validity,\n            sequence: data.Sequence,\n            ttl: data.TTL,\n            pubKey: message.pubKey,\n            signatureV2: message.signatureV2,\n            data: message.data\n        };\n    }\n    else {\n        throw new Error('invalid record: does not include signatureV1 or signatureV2');\n    }\n}\nexport const peerIdToRoutingKey = (peerId) => {\n    return uint8ArrayConcat([\n        IPNS_PREFIX,\n        peerId.toBytes()\n    ]);\n};\nexport const peerIdFromRoutingKey = (key) => {\n    return peerIdFromBytes(key.slice(IPNS_PREFIX.length));\n};\nexport const createCborData = (value, validity, validityType, sequence, ttl) => {\n    let ValidityType;\n    if (validityType === IpnsEntry.ValidityType.EOL) {\n        ValidityType = 0;\n    }\n    else {\n        throw errCode(new Error('Unknown validity type'), ERRORS.ERR_UNRECOGNIZED_VALIDITY);\n    }\n    const data = {\n        Value: value,\n        Validity: validity,\n        ValidityType,\n        Sequence: sequence,\n        TTL: ttl\n    };\n    return cborg.encode(data);\n};\nexport const parseCborData = (buf) => {\n    const data = cborg.decode(buf);\n    if (data.ValidityType === 0) {\n        data.ValidityType = IpnsEntry.ValidityType.EOL;\n    }\n    else {\n        throw errCode(new Error('Unknown validity type'), ERRORS.ERR_UNRECOGNIZED_VALIDITY);\n    }\n    if (Number.isInteger(data.Sequence)) {\n        // sequence must be a BigInt, but DAG-CBOR doesn't preserve this for Numbers within the safe-integer range\n        data.Sequence = BigInt(data.Sequence);\n    }\n    if (Number.isInteger(data.TTL)) {\n        // ttl must be a BigInt, but DAG-CBOR doesn't preserve this for Numbers within the safe-integer range\n        data.TTL = BigInt(data.TTL);\n    }\n    return data;\n};\n/**\n * Normalizes the given record value. It ensures it is a PeerID, a CID or a\n * string starting with '/'. PeerIDs become `/ipns/${cidV1Libp2pKey}`,\n * CIDs become `/ipfs/${cidAsV1}`.\n */\nexport const normalizeValue = (value) => {\n    if (value != null) {\n        // if we have a PeerId, turn it into an ipns path\n        if (isPeerId(value)) {\n            return `/ipns/${value.toCID().toString(base36)}`;\n        }\n        // if the value is bytes, stringify it and see if we have a path\n        if (value instanceof Uint8Array) {\n            const string = uint8ArrayToString(value);\n            if (string.startsWith('/')) {\n                value = string;\n            }\n        }\n        // if we have a path, check it is a valid path\n        const string = value.toString().trim();\n        if (string.startsWith('/') && string.length > 1) {\n            return string;\n        }\n        // if we have a CID, turn it into an ipfs path\n        const cid = CID.asCID(value);\n        if (cid != null) {\n            // PeerID encoded as a CID\n            if (cid.code === LIBP2P_CID_CODEC) {\n                return `/ipns/${cid.toString(base36)}`;\n            }\n            return `/ipfs/${cid.toV1().toString()}`;\n        }\n        // try parsing what we have as CID bytes or a CID string\n        try {\n            if (value instanceof Uint8Array) {\n                return `/ipfs/${CID.decode(value).toV1().toString()}`;\n            }\n            return `/ipfs/${CID.parse(string).toV1().toString()}`;\n        }\n        catch {\n            // fall through\n        }\n    }\n    throw errCode(new Error('Value must be a valid content path starting with /'), ERRORS.ERR_INVALID_VALUE);\n};\nconst validateCborDataMatchesPbData = (entry) => {\n    if (entry.data == null) {\n        throw errCode(new Error('Record data is missing'), ERRORS.ERR_INVALID_RECORD_DATA);\n    }\n    const data = parseCborData(entry.data);\n    if (!uint8ArrayEquals(data.Value, entry.value ?? new Uint8Array(0))) {\n        throw errCode(new Error('Field \"value\" did not match between protobuf and CBOR'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    if (!uint8ArrayEquals(data.Validity, entry.validity ?? new Uint8Array(0))) {\n        throw errCode(new Error('Field \"validity\" did not match between protobuf and CBOR'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    if (data.ValidityType !== entry.validityType) {\n        throw errCode(new Error('Field \"validityType\" did not match between protobuf and CBOR'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    if (data.Sequence !== entry.sequence) {\n        throw errCode(new Error('Field \"sequence\" did not match between protobuf and CBOR'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    if (data.TTL !== entry.ttl) {\n        throw errCode(new Error('Field \"ttl\" did not match between protobuf and CBOR'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n};\n//# sourceMappingURL=utils.js.map","import { unmarshal } from './utils.js';\nexport function ipnsSelector(key, data) {\n    const entries = data.map((buf, index) => ({\n        record: unmarshal(buf),\n        index\n    }));\n    entries.sort((a, b) => {\n        // Before we'd sort based on the signature version. Unmarshal now fails if\n        // a record does not have SignatureV2, so that is no longer needed. V1-only\n        // records haven't been issues in a long time.\n        const aSeq = a.record.sequence;\n        const bSeq = b.record.sequence;\n        // choose later sequence number\n        if (aSeq > bSeq) {\n            return -1;\n        }\n        else if (aSeq < bSeq) {\n            return 1;\n        }\n        // choose longer lived record if sequence numbers the same\n        const recordAValidityDate = a.record.validity.toDate();\n        const recordBValidityDate = b.record.validity.toDate();\n        if (recordAValidityDate.getTime() > recordBValidityDate.getTime()) {\n            return -1;\n        }\n        if (recordAValidityDate.getTime() < recordBValidityDate.getTime()) {\n            return 1;\n        }\n        return 0;\n    });\n    return entries[0].index;\n}\n//# sourceMappingURL=selector.js.map","import { logger } from '@libp2p/logger';\nimport errCode from 'err-code';\nimport * as ERRORS from './errors.js';\nimport { IpnsEntry } from './pb/ipns.js';\nimport { extractPublicKey, ipnsRecordDataForV2Sig, unmarshal, peerIdFromRoutingKey } from './utils.js';\nconst log = logger('ipns:validator');\n/**\n * Limit valid IPNS record sizes to 10kb\n */\nconst MAX_RECORD_SIZE = 1024 * 10;\n/**\n * Validates the given IPNS Record against the given public key. We need a \"raw\"\n * record in order to be able to access to all of its fields.\n */\nexport const validate = async (publicKey, buf) => {\n    // unmarshal ensures that (1) SignatureV2 and Data are present, (2) that ValidityType\n    // and Validity are of valid types and have a value, (3) that CBOR data matches protobuf\n    // if it's a V1+V2 record.\n    const record = unmarshal(buf);\n    // Validate Signature V2\n    let isValid;\n    try {\n        const dataForSignature = ipnsRecordDataForV2Sig(record.data);\n        isValid = await publicKey.verify(dataForSignature, record.signatureV2);\n    }\n    catch (err) {\n        isValid = false;\n    }\n    if (!isValid) {\n        log.error('record signature verification failed');\n        throw errCode(new Error('record signature verification failed'), ERRORS.ERR_SIGNATURE_VERIFICATION);\n    }\n    // Validate according to the validity type\n    if (record.validityType === IpnsEntry.ValidityType.EOL) {\n        if (record.validity.toDate().getTime() < Date.now()) {\n            log.error('record has expired');\n            throw errCode(new Error('record has expired'), ERRORS.ERR_IPNS_EXPIRED_RECORD);\n        }\n    }\n    else if (record.validityType != null) {\n        log.error('unrecognized validity type');\n        throw errCode(new Error('unrecognized validity type'), ERRORS.ERR_UNRECOGNIZED_VALIDITY);\n    }\n    log('ipns record for %b is valid', record.value);\n};\nexport async function ipnsValidator(key, marshalledData) {\n    if (marshalledData.byteLength > MAX_RECORD_SIZE) {\n        throw errCode(new Error('record too large'), ERRORS.ERR_RECORD_TOO_LARGE);\n    }\n    const peerId = peerIdFromRoutingKey(key);\n    const receivedRecord = unmarshal(marshalledData);\n    // extract public key\n    const pubKey = await extractPublicKey(peerId, receivedRecord);\n    // Record validation\n    await validate(pubKey, marshalledData);\n}\n//# sourceMappingURL=validator.js.map","// this list comes from https://github.com/ipfs/kubo/blob/da28fbc65a2e0f1ce59f9923823326ae2bc4f713/config/bootstrap_peers.go#L17\nexport const bootstrapConfig = {\n    list: [\n        '/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN',\n        '/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa',\n        '/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb',\n        '/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt',\n        '/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ'\n    ]\n};\n//# sourceMappingURL=bootstrappers.js.map","import { createLibp2p as create } from 'libp2p';\nimport { libp2pDefaults } from './libp2p-defaults.js';\nexport async function createLibp2p(datastore, options) {\n    const defaults = libp2pDefaults();\n    options = options ?? {};\n    return create({\n        datastore,\n        ...defaults,\n        ...options,\n        start: false\n    });\n}\n//# sourceMappingURL=libp2p.js.map","import { gossipsub } from '@chainsafe/libp2p-gossipsub';\nimport { noise } from '@chainsafe/libp2p-noise';\nimport { yamux } from '@chainsafe/libp2p-yamux';\nimport { bootstrap } from '@libp2p/bootstrap';\nimport { ipniContentRouting } from '@libp2p/ipni-content-routing';\nimport { kadDHT } from '@libp2p/kad-dht';\nimport { mplex } from '@libp2p/mplex';\nimport { webRTC, webRTCDirect } from '@libp2p/webrtc';\nimport { webSockets } from '@libp2p/websockets';\nimport { webTransport } from '@libp2p/webtransport';\nimport { ipnsSelector } from 'ipns/selector';\nimport { ipnsValidator } from 'ipns/validator';\nimport { autoNATService } from 'libp2p/autonat';\nimport { circuitRelayTransport } from 'libp2p/circuit-relay';\nimport { dcutrService } from 'libp2p/dcutr';\nimport { identifyService } from 'libp2p/identify';\nimport { pingService } from 'libp2p/ping';\nimport { bootstrapConfig } from './bootstrappers.js';\nexport function libp2pDefaults() {\n    return {\n        addresses: {\n            listen: [\n                '/webrtc'\n            ]\n        },\n        transports: [\n            circuitRelayTransport({\n                discoverRelays: 1\n            }),\n            webRTC(),\n            webRTCDirect(),\n            webTransport(),\n            webSockets()\n        ],\n        connectionEncryption: [\n            noise()\n        ],\n        streamMuxers: [\n            yamux(),\n            mplex()\n        ],\n        peerDiscovery: [\n            bootstrap(bootstrapConfig)\n        ],\n        contentRouters: [\n            ipniContentRouting('https://cid.contact')\n        ],\n        services: {\n            identify: identifyService(),\n            autoNAT: autoNATService(),\n            pubsub: gossipsub(),\n            dcutr: dcutrService(),\n            dht: kadDHT({\n                clientMode: true,\n                validators: {\n                    ipns: ipnsValidator\n                },\n                selectors: {\n                    ipns: ipnsSelector\n                }\n            }),\n            ping: pingService()\n        }\n    };\n}\n//# sourceMappingURL=libp2p-defaults.browser.js.map","export const version = '2.0.3';\nexport const name = 'helia';\n//# sourceMappingURL=version.js.map","/**\n * @packageDocumentation\n *\n * Create a Helia node.\n *\n * @example\n *\n * ```typescript\n * import { MemoryDatastore } from 'datastore-core'\n * import { MemoryBlockstore } from 'blockstore-core'\n * import { createHelia } from 'helia'\n * import { unixfs } from '@helia/unixfs'\n * import { CID } from 'multiformats/cid'\n *\n * const node = await createHelia({\n *   blockstore: new MemoryBlockstore(),\n *   datastore: new MemoryDatastore()\n * })\n * const fs = unixfs(node)\n * fs.cat(CID.parse('bafyFoo'))\n * ```\n */\nimport { logger } from '@libp2p/logger';\nimport { MemoryBlockstore } from 'blockstore-core';\nimport { MemoryDatastore } from 'datastore-core';\nimport { HeliaImpl } from './helia.js';\nimport { createLibp2p } from './utils/libp2p.js';\nimport { name, version } from './version.js';\n// re-export interface types so people don't have to depend on @helia/interface\n// if they don't want to\nexport * from '@helia/interface';\nexport * from '@helia/interface/blocks';\nexport * from '@helia/interface/pins';\nconst log = logger('helia');\nexport async function createHelia(init = {}) {\n    const datastore = init.datastore ?? new MemoryDatastore();\n    const blockstore = init.blockstore ?? new MemoryBlockstore();\n    let libp2p;\n    if (isLibp2p(init.libp2p)) {\n        libp2p = init.libp2p;\n    }\n    else {\n        libp2p = await createLibp2p(datastore, init.libp2p);\n    }\n    const helia = new HeliaImpl({\n        ...init,\n        datastore,\n        blockstore,\n        libp2p\n    });\n    if (init.start !== false) {\n        await helia.start();\n    }\n    // add helia to agent version\n    addHeliaToAgentVersion(helia);\n    return helia;\n}\nfunction isLibp2p(obj) {\n    if (obj == null) {\n        return false;\n    }\n    // a non-exhaustive list of methods found on the libp2p object\n    const funcs = ['dial', 'dialProtocol', 'hangUp', 'handle', 'unhandle', 'getMultiaddrs', 'getProtocols'];\n    // if these are all functions it's probably a libp2p object\n    return funcs.every(m => typeof obj[m] === 'function');\n}\nfunction addHeliaToAgentVersion(helia) {\n    // add helia to agent version\n    try {\n        const existingAgentVersion = helia.libp2p.services.identify.host.agentVersion;\n        if (existingAgentVersion.match(/js-libp2p\\/\\d+\\.\\d+\\.\\d+\\sUserAgent=/) == null) {\n            // the user changed the agent version\n            return;\n        }\n        helia.libp2p.services.identify.host.agentVersion = `${name}/${version} ${helia.libp2p.services.identify.host.agentVersion}`;\n    }\n    catch (err) {\n        log.error('could not add Helia to agent version', err);\n    }\n}\n//# sourceMappingURL=index.js.map","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n"],"names":["ID_OFFSET","SIZE_OFFSET","ARRAYBUFFER_ID","STRING_ID","ARRAYBUFFERVIEW","ARRAY","VAL_ALIGN_OFFSET","VAL_SIGNED","VAL_FLOAT","VAL_MANAGED","ARRAYBUFFERVIEW_BUFFER_OFFSET","ARRAYBUFFERVIEW_DATASTART_OFFSET","ARRAYBUFFERVIEW_DATALENGTH_OFFSET","ARRAYBUFFERVIEW_SIZE","ARRAY_LENGTH_OFFSET","ARRAY_SIZE","BIGINT","BigUint64Array","THIS","Symbol","CHUNKSIZE","getStringImpl","buffer","ptr","U32","Uint32Array","U16","Uint16Array","length","offset","String","fromCharCode","apply","subarray","parts","last","size","push","join","preInstantiate","imports","baseModule","getString","memory","env","abort","mesg","file","line","colm","Error","trace","n","console","log","Array","prototype","slice","call","arguments","Math","Date","postInstantiate","instance","rawExports","exports","table","alloc","retain","rttiBase","getInfo","id","getBase","getValueAlign","info","clz32","getView","alignLog2","signed","float","Float32Array","Float64Array","Int8Array","Uint8Array","Int16Array","Int32Array","BigInt64Array","__getArrayView","arr","align","buf","getTypedArray","Type","getTypedArrayView","bufPtr","__allocString","str","i","p","charCodeAt","__getString","__allocArray","values","view","set","__getArray","input","len","out","__getArrayBuffer","__getInt8Array","bind","__getInt8ArrayView","__getUint8Array","__getUint8ArrayView","__getUint8ClampedArray","Uint8ClampedArray","__getUint8ClampedArrayView","__getInt16Array","__getInt16ArrayView","__getUint16Array","__getUint16ArrayView","__getInt32Array","__getInt32ArrayView","__getUint32Array","__getUint32ArrayView","__getInt64Array","__getInt64ArrayView","__getUint64Array","__getUint64ArrayView","__getFloat32Array","__getFloat32ArrayView","__getFloat64Array","__getFloat64ArrayView","__instanceof","baseId","demangle","isResponse","o","Response","async","instantiate","source","instantiateStreaming","WebAssembly","Module","compile","arrayBuffer","module","Object","create","setArgumentsLength","value","internalName","hasOwnProperty","elem","split","curr","part","shift","name","hash","indexOf","className","substring","classElem","ctor","args","wrap","constructor","valueOf","this","thisValue","writable","getOwnPropertyNames","forEach","defineProperty","getOwnPropertyDescriptor","test","getter","replace","setter","get","enumerable","original","instantiateSync","Instance","protobuf","configure","util","_configure","Writer","BufferWriter","Reader","BufferReader","build","rpc","roots","LongBits","utf8","indexOutOfRange","reader","writeLength","RangeError","pos","create_array","isArray","Buffer","isBuffer","readLongVarint","bits","lo","hi","readFixed32_end","end","readFixed64","_slice","uint32","int32","sint32","bool","fixed32","sfixed32","readFloatLE","double","readDoubleLE","bytes","start","nativeBuffer","string","read","skip","skipType","wireType","BufferReader_","fn","Long","merge","int64","uint64","sint64","zzDecode","fixed64","sfixed64","utf8Slice","min","toString","Service","rpcImpl","requestDelimited","responseDelimited","TypeError","EventEmitter","Boolean","rpcCall","method","requestCtor","responseCtor","request","callback","self","asPromise","finish","err","response","emit","setTimeout","endedByRPC","off","zero","toNumber","zzEncode","zeroHash","fromNumber","sign","from","isString","parseInt","fromString","low","high","unsigned","toLong","fromHash","toHash","mask","part0","part1","part2","dst","src","ifNotSet","keys","undefined","newError","CustomError","message","properties","captureStackTrace","stack","configurable","base64","inquire","pool","isNode","g","process","versions","node","global","window","emptyArray","freeze","emptyObject","isInteger","Number","isFinite","floor","isObject","isset","isSet","obj","prop","utf8Write","e","_Buffer_from","_Buffer_allocUnsafe","newBuffer","sizeOrArray","dcodeIO","key2Re","key32Re","key64Re","longToHash","longFromHash","fromBits","lcFirst","charAt","toLowerCase","ProtocolError","oneOfGetter","fieldNames","fieldMap","oneOfSetter","toJSONOptions","longs","enums","json","encoding","allocUnsafe","Op","val","next","noop","State","writer","head","tail","states","writeByte","VarintOp","writeVarint64","writeFixed32","_push","writeFloatLE","writeDoubleLE","writeBytes","decode","write","fork","reset","ldelim","BufferWriter_","writeStringBuffer","writeBytesBuffer","copy","byteLength","ascii_1","base64_1","fromBase64","bech32_1","hex_1","rfc3339_1","utf8_1","fromCallback","ModuleError","getCallback","getOptions","kPromise","kStatus","kOperations","kFinishClose","kCloseCallbacks","AbstractChainedBatch","db","attachResource","nextTick","put","key","options","code","_checkKey","_checkValue","sublevel","keyEncoding","valueEncoding","keyFormat","format","mappedKey","prefixKey","encode","mappedValue","_put","type","del","_del","clear","_clear","close","_write","_close","detachResource","callbacks","cb","kCallback","kWorking","kHandleOne","kHandleMany","kAutoClose","kFinishWork","kReturnMany","kClosing","kHandleClose","kClosed","kKeyEncoding","kValueEncoding","kAbortOnClose","kLegacy","kKeys","kValues","kLimit","kCount","emptyOptions","warnedEnd","CommonIterator","legacy","limit","Infinity","abortOnClose","count","promise","Promise","resolve","reject","_next","nextv","_nextv","acc","onnext","all","_all","onnextv","items","seek","target","mapped","_seek","asyncIterator","item","AbstractIterator","super","IteratorDecodeError","entries","entry","warn","subject","cause","k","AbstractKeyIterator","AbstractValueIterator","supports","Transcoder","DefaultKeyIterator","DefaultValueIterator","DeferredIterator","DeferredKeyIterator","DeferredValueIterator","DefaultChainedBatch","rangeOptions","kLanded","kResources","kCloseResources","kUndefer","kDeferOpen","kOptions","kDefaultOptions","kTranscoder","AbstractLevel","manifest","passive","forward","Set","status","promises","getMany","deferredOpen","snapshots","permanence","keyIterator","valueIterator","iteratorNextv","iteratorAll","encodings","events","assign","opening","open","closing","closed","batch","formats","commonName","empty","createIfMissing","errorIfExists","maybeOpened","once","_open","maybeClosed","cancel","pending","sync","resource","defer","maybeError","valueFormat","_get","notFound","mappedKeys","_getMany","fill","operations","_chainedBatch","ke","ve","op","valueErr","_batch","_sublevel","AbstractSublevel","defaults","iterator","_iterator","_keys","_values","add","delete","filter","kUnfix","kIterator","AbstractSublevelIterator","unfix","AbstractSublevelKeyIterator","AbstractSublevelValueIterator","Iterator","kPrefix","kUpperBound","kPrefixRange","kParent","textEncoder","TextEncoder","separator","static","trim","reserved","parent","every","x","mergeManifests","prefix","upperBound","MultiFormat","Unfixer","result","concat","range","gte","gt","lte","lt","additionalMethods","supportsEncoding","cache","Map","prefixLength","char","def","kEncoded","mapEntry","map","kNut","kFactory","queueMicrotask","has","reverse","ieee754","customInspectSymbol","SlowBuffer","INSPECT_MAX_BYTES","K_MAX_LENGTH","createBuffer","setPrototypeOf","arg","encodingOrOffset","isEncoding","actual","ArrayBuffer","isView","arrayView","isInstance","fromArrayBuffer","byteOffset","fromArrayLike","fromArrayView","SharedArrayBuffer","b","checked","numberIsNaN","data","fromObject","toPrimitive","assertSize","array","mustMatch","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","m","bidirectionalIndexOf","dir","arrayIndexOf","lastIndexOf","indexSize","arrLength","valLength","readUInt16BE","foundIndex","found","j","hexWrite","remaining","strLen","parsed","substr","blitBuffer","asciiWrite","byteArray","asciiToBytes","base64Write","ucs2Write","units","c","utf16leToBytes","fromByteArray","res","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","codePoints","MAX_ARGUMENTS_LENGTH","decodeCodePointsArray","kMaxLength","TYPED_ARRAY_SUPPORT","proto","foo","typedArraySupport","error","poolSize","allocUnsafeSlow","_isBuffer","compare","a","y","list","swap16","swap32","swap64","toLocaleString","equals","inspect","max","thisStart","thisEnd","thisCopy","targetCopy","includes","toJSON","_arr","ret","hexSliceLookupTable","checkOffset","ext","checkInt","wrtBigUInt64LE","checkIntBI","BigInt","wrtBigUInt64BE","checkIEEE754","writeFloat","littleEndian","noAssert","writeDouble","newBuf","readUintLE","readUIntLE","mul","readUintBE","readUIntBE","readUint8","readUInt8","readUint16LE","readUInt16LE","readUint16BE","readUint32LE","readUInt32LE","readUint32BE","readUInt32BE","readBigUInt64LE","defineBigIntMethod","validateNumber","first","boundsError","readBigUInt64BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readBigInt64LE","readBigInt64BE","readFloatBE","readDoubleBE","writeUintLE","writeUIntLE","writeUintBE","writeUIntBE","writeUint8","writeUInt8","writeUint16LE","writeUInt16LE","writeUint16BE","writeUInt16BE","writeUint32LE","writeUInt32LE","writeUint32BE","writeUInt32BE","writeBigUInt64LE","writeBigUInt64BE","writeIntLE","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeBigInt64LE","writeBigInt64BE","writeFloatBE","writeDoubleBE","targetStart","copyWithin","errors","E","sym","getMessage","Base","addNumericalSeparator","ERR_OUT_OF_RANGE","checkBounds","ERR_INVALID_ARG_TYPE","ERR_BUFFER_OUT_OF_BOUNDS","msg","received","abs","INVALID_BASE64_RE","leadSurrogate","toByteArray","base64clean","alphabet","i16","BufferBigIntNotDefined","anySignal","signals","controller","globalThis","AbortController","onAbort","signal","removeEventListener","addEventListener","aborted","parallel","deserialize","createKeyRange","DEFAULT_PREFIX","kIDB","kNamePrefix","kLocation","kVersion","kStore","kOnComplete","BrowserLevel","location","_","version","namePrefix","req","indexedDB","onerror","onsuccess","onupgradeneeded","ev","objectStoreNames","contains","createObjectStore","mode","transaction","objectStore","onabort","oncomplete","store","tasks","stopPropagation","index","loop","commit","keyRange","destroy","deleteDatabase","kCache","kFinished","kCurrentOptions","kPosition","kFirst","maybeCommit","splice","openKeyCursor","cursor","continue","complete","getAllKeys","getAll","direction","lower","upper","lowerExclusive","upperExclusive","IDBKeyRange","bound","lowerBound","parse","formatThousandsRegExp","formatDecimalsRegExp","kb","mb","gb","tb","pb","parseRegExp","mag","thousandsSeparator","unitSeparator","decimalPlaces","fixedDecimals","unit","toFixed","s","isNaN","floatValue","results","exec","parseFloat","symbol","fromPromise","then","catch","proxyMarker","createEndpoint","releaseProxy","finalizer","throwMarker","transferHandlers","canHandle","serialize","port1","port2","MessageChannel","expose","port","createProxy","serialized","isError","ep","allowedOrigins","origin","allowedOrigin","RegExp","isAllowedOrigin","path","argumentList","fromWireValue","returnValue","reduce","rawValue","proxy","transfers","transferCache","transfer","wireValue","transferables","toWireValue","postMessage","closeEndPoint","endpoint","isMessagePort","throwIfProxyReleased","isReleased","releaseEndpoint","requestResponseMessage","proxyCounter","WeakMap","proxyFinalizers","FinalizationRegistry","newCount","isProxyReleased","Proxy","_target","unregister","unregisterProxy","r","_thisArg","rawArgumentList","processArguments","construct","register","registerProxy","processed","v","handler","serializedValue","random","MAX_SAFE_INTEGER","l","MsgSetSendEnabledResponse","MsgSetSendEnabled","MsgUpdateParamsResponse","MsgUpdateParams","MsgMultiSendResponse","MsgMultiSend","MsgSendResponse","MsgSend","coin_1","bank_1","binary_1","helpers_1","createBaseMsgUpdateParams","authority","params","Params","fromPartial","typeUrl","BinaryWriter","fromAddress","toAddress","amount","Coin","BinaryReader","tag","fromJSON","object","inputs","Input","outputs","Output","sendEnabled","SendEnabled","useDefaultFor","Tip","Fee","ModeInfo_Multi","ModeInfo_Single","ModeInfo","SignerInfo","AuthInfo","TxBody","SignDocDirectAux","Tx","any_1","signing_1","multisig_1","createBaseTxRaw","bodyBytes","authInfoBytes","signatures","createBaseSignDoc","chainId","accountNumber","createBaseSignDocDirectAux","publicKey","sequence","tip","createBaseTxBody","messages","memo","timeoutHeight","extensionOptions","nonCriticalExtensionOptions","createBaseSignerInfo","modeInfo","createBaseFee","gasLimit","payer","granter","createBaseAuxSignerData","address","signDoc","sig","body","authInfo","bytesFromBase64","base64FromBytes","Any","signerInfos","fee","single","multi","signModeFromJSON","signModeToJSON","bitarray","CompactBitArray","modeInfos","tipper","__self__","F","fetch","DOMException","support","searchParams","iterable","blob","Blob","formData","viewClasses","isArrayBufferView","normalizeName","normalizeValue","iteratorFor","done","Headers","headers","append","header","consumed","bodyUsed","fileReaderReady","onload","readBlobAsArrayBuffer","FileReader","readAsArrayBuffer","bufferClone","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","DataView","_bodyArrayBuffer","rejected","text","readAsText","chars","readArrayBufferAsText","JSON","oldValue","thisArg","methods","Request","upcased","url","credentials","toUpperCase","referrer","form","decodeURIComponent","bodyInit","ok","statusText","clone","redirectStatuses","redirect","init","xhr","XMLHttpRequest","abortXhr","rawHeaders","getAllResponseHeaders","responseURL","responseText","ontimeout","withCredentials","responseType","setRequestHeader","onreadystatechange","readyState","send","polyfill","ponyfill","ctx","token","timezone","timezoneClip","dateFormat","date","utc","gmt","maskSlice","masks","d","D","H","M","L","getTimezoneOffset","W","targetThursday","getFullYear","getMonth","getDate","setDate","getDay","firstThursday","ds","setHours","getHours","weekDiff","getWeek","N","dow","getDayOfWeek","flags","dd","pad","ddd","i18n","dayNames","dddd","mm","mmm","monthNames","mmmm","yy","yyyy","h","hh","HH","MM","ss","round","t","timeNames","tt","T","TT","Z","match","pop","S","w","plural","ms","msAbs","isPlural","long","fmtLong","fmtShort","stringify","formatArgs","useColors","namespace","humanize","diff","color","lastC","save","namespaces","storage","setItem","removeItem","load","getItem","DEBUG","__nwjs","navigator","userAgent","document","documentElement","style","WebkitAppearance","firebug","exception","$1","localStorage","localstorage","warned","colors","debug","formatters","createDebug","prevTime","namespacesCache","enabledCache","enableOverride","enabled","prev","coerce","unshift","formatter","selectColor","extend","delimiter","newDebug","toNamespace","regexp","default","disable","names","skips","enable","createAbortError","createDelay","clearTimeout","defaultClear","willResolve","timeoutId","settle","rejectFn","signalListener","delayPromise","createWithTimers","clearAndSet","delay","minimum","maximum","randomInteger","Denque","_capacity","capacity","_head","_tail","_fromArray","_capacityMask","_list","peekAt","peek","peekFront","peekBack","_growArray","_shrinkArray","removeOne","remove","removed","del_count","toArray","temp","arg_len","arguments_index","leng","isEmpty","_copyArray","_nextPowerOf2","fullCopy","dest","newList","num","nextPow2","__spreadArray","to","pack","ar","BrowserInfo","os","NodeInfo","platform","SearchBotDeviceInfo","bot","BotInfo","ReactNativeInfo","SEARCHBOT_OS_REGEX","REQUIRED_VERSION_PARTS","userAgentRules","operatingSystemRules","detect","parseUserAgent","product","matchUserAgent","ua","matched","_a","browser","regex","uaMatch","matchedRule","versionParts","output","ii","createVersionParts","detectOS","searchBotMatch","props","ErrClass","getPrototypeOf","event_iterator_1","EventIterator","EventQueue","pullQueue","pushQueue","eventHandlers","isPaused","isStopped","resolution","placeholder","highWaterMark","highWater","stop","fail","rejection","removeCallback","lowWaterMark","lowWater","return","listen","queue","on","event","ReflectOwnKeys","R","Reflect","ReflectApply","receiver","Function","ownKeys","getOwnPropertySymbols","NumberIsNaN","emitter","errorListener","removeListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","_getMaxListeners","that","_addListener","prepend","existing","warning","newListener","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","wrapListener","setMaxListeners","getMaxListeners","doError","er","context","listeners","addListener","prependListener","prependOnceListener","position","originalListener","spliceOne","removeAllListeners","rawListeners","eventNames","_ref","uri","defaultIsExtractableFile","extractFiles","isExtractableFile","files","addFile","paths","storedPaths","FileList","child","ReactNativeFile","File","hwm","top","btm","FixedFIFO","BASE","_cache","update","Events","EE","evt","clearEvent","__proto__","handlers","ee","a1","a2","a3","a4","a5","prefixed","RateLimiterRedis","RateLimiterMongo","RateLimiterMySQL","RateLimiterPostgres","RateLimiterClusterMaster","RateLimiterClusterMasterPM2","RateLimiterCluster","RateLimiterMemory","RateLimiterMemcache","RLWrapperBlackAndWhite","RateLimiterUnion","RateLimiterQueue","BurstyRateLimiter","RateLimiterRes","rateLimiter","burstLimiter","_rateLimiter","_burstLimiter","_combineRes","rlRes","blRes","remainingPoints","msBeforeNext","consumedPoints","isFirstInDuration","consume","pointsToConsume","rlRej","blRej","points","opts","limiter","blackList","whiteList","isBlackListed","isWhiteListed","runActionAnyway","_limiter","_runActionAnyway","_blackList","_isBlackListed","func","_whiteList","_isWhiteListed","isBlackListedSomewhere","isWhiteListedSomewhere","getBlackRes","getWhiteRes","rejectBlack","resolveBlack","resolveWhite","block","secDuration","penalty","reward","duration","blockDuration","execEvenly","execEvenlyMinDelayMs","keyPrefix","_points","_duration","msDuration","_blockDuration","msBlockDuration","_execEvenly","_execEvenlyMinDelayMs","ceil","_keyPrefix","_getKeySecDuration","customDuration","getKey","parseKey","rlKey","cluster","crypto","RateLimiterAbstract","channel","masterInstance","masterSendToWorker","worker","promiseId","workerWaitInit","payload","_initiated","_promises","workerSendToMaster","masterProcessMsg","_rateLimiters","rejRes","workerProcessMsg","getOpts","savePromise","hrtime","randomBytes","timeoutMs","pm2","launchBus","pm2Bus","packet","raw","sendDataToProcessId","pm_id","topic","sendErr","msgData","pm2Message","_timeoutMs","RateLimiterStoreAbstract","client","storeClient","_getRateLimiterRes","changedPoints","_upsert","forceExpire","nowMs","now","incr","errAddKey","createdNew","attemptNumber","nextOptions","resUpsert","errUpsert","errGetExpire","resGetExpireMs","expireMs","_delete","errDelExpire","MemoryStorage","_memoryStorage","incrby","initPoints","getDriverVersion","_client","topology","metadata","driver","_v","major","feature","patch","dbName","tableName","indexKeyPrefix","mongo","conn","_initCollection","_driverVersion","_dbName","getDbName","_tableName","_indexKeyPrefix","collection","createIndex","expire","expireAfterSeconds","unique","_collection","doc","getTime","docAttrs","attrs","where","upsertData","$set","$or","$gt","$eq","$setOnInsert","$inc","upsertOptions","upsert","returnDocument","returnOriginal","findOneAndUpdate","replaceWhere","$lte","replaceTo","errReplace","findOne","deleteOne","deletedCount","clientType","storeType","clearExpiredByTimeout","tableCreated","_clearExpiredHourAgo","_createDbAndTable","clearExpired","_getConnection","query","_releaseConnection","_clearExpiredTimeoutId","unref","getConnection","errConn","connectionManager","acquireConnection","release","releaseConnection","errDb","_getCreateTableStmt","_clientType","_tableCreated","_clearExpiredByTimeout","row","_upsertTransaction","errBegin","rollback","dateNow","newExpire","q","errSelect","affectedRows","_createTable","_query","master","constructorName","rows","queryObj","expireQ","rowCount","RateLimiterQueueError","MAX_QUEUE_SIZE","KEY_DEFAULT","limiterFlexible","maxQueueSize","_queueLimiters","RateLimiterQueueInternal","_limiterFlexible","_maxQueueSize","getTokensRemaining","removeTokens","tokens","_key","_waitTimeout","_queue","_this","_queueRequest","rej","_processFIFO","incrTtlLuaScript","_rejectIfRedisNotReady","rejectIfRedisNotReady","useRedisPackage","useRedis3AndLowerPackage","defineCommand","numberOfKeys","lua","_isRedisReady","isReady","resTtlMs","EX","pTTL","pttl","incrCallback","rlflxIncr","eval","incrBy","_msBeforeNext","_remainingPoints","_consumedPoints","_isFirstInDuration","_getDecoratedProperties","for","BlockedKeys","inMemoryBlockOnConsumed","inMemoryBlockDuration","insuranceLimiter","_inMemoryBlockedKeys","_afterConsume","storeResult","addMs","blockPromise","_block","msInMemoryBlockDuration","_handleError","funcName","getInMemoryBlockMsBeforeExpire","msBeforeExpire","_inMemoryBlockOnConsumed","_inMemoryBlockDuration","_insuranceLimiter","inMemoryBlockMsBeforeExpire","deleteInMemoryBlockedAll","limiters","_limiters","resObj","_addedKeysAmount","collectExpired","sec","Record","_storage","durationSec","msBeforeExpires","expiresAt","durationMs","_value","_expiresAt","_timeoutId","extra","$protobuf","$Reader","$Writer","$util","$root","RPC","subscriptions","ks","$oneOfFields","control","SubOpts","Message","ControlMessage","toObject","arrays","oneofs","_control","subscribe","_subscribe","_topic","seqno","signature","_from","_data","_seqno","_signature","ihave","iwant","graft","prune","ControlIHave","ControlIWant","ControlGraft","ControlPrune","messageIDs","topicID","_topicID","peers","backoff","PeerInfo","fromValue","_backoff","peerID","signedPeerRecord","_peerID","_signedPeerRecord","canUseWeakMap","HermesInternal","canUseWeakSet","WeakSet","canUseSymbol","canUseAsyncIteratorSymbol","createElement","maybe","thunk","isIPv4","isIPv6","isIP","MAX_IPV6_LENGTH","MAX_IPV4_LENGTH","parser","new","readAtomically","parseWith","peekChar","readChar","readGivenChar","readSeparator","sep","inner","readNumber","radix","maxDigits","allowZeroPrefix","maxBytes","digitCount","leadingChar","hasLeadingZero","maxValue","digit","readIPv4Addr","ix","readIPv6Addr","readGroups","groups","ipv4","group","headSize","headIp4","tailSize","readIPAddr","parseIPv4","parseIPv6","parseIP","pair","deferred","piped","sink","NOISE_MSG_MAX_LENGTH_BYTES","DUMP_SESSION_KEYS","number","isSafeInteger","lengths","outputLen","blockLen","exists","checkFinished","destroyed","finished","u8a","createView","rotr","word","toBytes","Hash","_cloneInto","hashCons","hashC","digest","tmp","HMAC","iHash","oHash","digestInto","extract","ikm","salt","HKDF_COUNTER","EMPTY_BUFFER","expand","prk","blocks","okm","HMACTmp","counter","SHA2","padOffset","isLE","take","dataView","roundClean","setBigUint64","_32n","_u32_max","wh","wl","setUint32","oview","outLen","Maj","SHA256_K","IV","SHA256_W","SHA256","A","B","C","G","getUint32","W15","W2","s0","s1","T1","T2","sha256","pureJsCrypto","hashSHA256","getHKDF","ck","generateX25519KeyPair","secretKey","privateKey","generateX25519KeyPairFromSeed","seed","generateX25519SharedKey","chaCha20Poly1305Encrypt","plaintext","nonce","ad","chacha","encrypt","chaCha20Poly1305Decrypt","ciphertext","decrypt","uint16BEEncode","setUint16","uint16BEDecode","getUint16","ALPHABET","BASE_MAP","xc","LEADER","FACTOR","iFACTOR","decodeUnsafe","psz","zeroes","b256","carry","it3","it4","vch","pbegin","pend","b58","it1","it2","repeat","Encoder","baseEncode","Decoder","baseDecode","codePointAt","prefixCodePoint","or","decoder","ComposedDecoder","decoders","left","right","Codec","encoder","baseX","rfc4648","bitsPerChar","codes","written","SyntaxError","base10","base16","base16upper","base2","alphabetBytesToChars","alphabetCharsToBytes","base256emoji","byts","byt","base32","base32upper","base32pad","base32padupper","base32hex","base32hexupper","base32hexpad","base32hexpadupper","base32z","base36","base36upper","base58btc","base58flickr","base64pad","base64url","base64urlpad","base8","identity","TextDecoder","textDecoder","encode_1","oldOffset","INT","MSB","MSBALL","REST$1","MSB$1","N1","N2","N3","N4","N5","N6","N7","N8","N9","encodingLength","encodeTo","int","sizeOffset","digestOffset","Digest","multihash","Hasher","sha","subtle","sha512","link","base","toStringV0","baseCache","toStringV1","cid","CID","asCID","toV0","DAG_PB_CODE","SHA_256_CODE","createV0","toV1","createV1","other","unknown","aa","bb","toStringTag","encodeCID","cidSymbol","remainder","decodeFirst","specs","inspectBytes","prefixSize","multihashSize","multihashBytes","digestBytes","digestSize","multihashCode","codec","initialBytes","parseCIDtoBytes","codeOffset","hashOffset","bases","createCodec","ascii","hex","latin1","binary","PUBLIC_KEY_BYTE_LENGTH","PRIVATE_KEY_BYTE_LENGTH","KEYS_BYTE_LENGTH","concatKeys","privateKeyRaw","win","nativeCrypto","derivedEmptyPasswordKey","alg","key_ops","kty","exporter","password","cipher","algorithm","keyLength","nonceLength","saltLength","iterations","getRandomValues","aesGcm","iv","cryptoKey","importKey","deriveParams","runtimeDerivedEmptyPassword","deriveKey","rawKey","encryptedKey","KeyType","__KeyTypeValues","PublicKey","PrivateKey","_codec","lengthDelimited","Data","Ed25519PublicKey","ensureKey","marshal","Ed25519PrivateKey","_publicKey","public","unmarshalEd25519PrivateKey","privateKeyBytes","publicKeyBytes","unmarshalEd25519PublicKey","generateKeyPair","generateKeyPairFromSeed","bigIntegerToUintBase64url","base64urlToBigInteger","bytesLength","convert","types","derivePublicFromPrivate","exportKey","jwKey","convertKey","pub","handle","fkey","jwk2pub","jwk2priv","keySize","jwk","MAX_KEY_SIZE","RsaPublicKey","verify","asn1","getBytes","RsaPrivateKey","genSecret","dp","dq","qi","dP","dQ","qInv","saltSize","prfAlgorithm","unmarshalRsaPrivateKey","unmarshalRsaPublicKey","fromJwk","generateKey","modulusLength","publicExponent","validatePublicKey","Secp256k1PublicKey","toRawBytes","Secp256k1PrivateKey","toDERRawBytes","unmarshalSecp256k1PrivateKey","unmarshalSecp256k1PublicKey","supportedKeys","rsa","ed25519","secp256k1","unsupportedKey","supported","decoded","baseDecoder","LIBP2P_KEY_CODE","MARSHALLED_ED225519_PUBLIC_KEY_LENGTH","MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH","PeerIdImpl","toCID","startsWith","Ed25519PeerIdImpl","Secp256k1PeerIdImpl","RSAPeerIdImpl","peerIdFromCID","peerIdFromBytes","peerIdFromString","peerIdFromKeys","NoiseExtensions","NoiseHandshakePayload","getPayload","localPeer","staticPublicKey","extensions","signedPayload","peerId","signPayload","getHandshakePayload","libp2pPublicKey","identityKey","identitySig","webtransportCerthashes","createHandshakePayload","getPeerIdFromPayload","decodePayload","verifySignedPayload","noiseStaticKey","remotePeer","payloadPeerId","generatedPayload","isValidPublicKey","pk","writeDefaults","logger","createDisabledLogger","find","keyLogger","logLocalEphemeralKeys","logRemoteEphemeralKey","re","Nonce","increment","getUint64","assertValue","AbstractHandshake","encryptWithAd","cs","decryptWithAd","valid","hasKey","isEmptyKey","createEmptyKey","encryptAndHash","mixHash","encryptedMessage","decryptAndHash","dh","derivedU8","getHash","mixKey","tempK","initializeKey","initializeSymmetric","protocolName","protocolNameBytes","hashProtocolName","tempk1","tempk2","cs1","cs2","writeMessageRegular","ne","ns","readMessageRegular","XX","initializeInitiator","prologue","rs","psk","initializeResponder","writeMessageA","hs","writeMessageB","spk","writeMessageC","messageBuffer","readMessageA","readMessageB","valid1","valid2","readMessageC","initSession","initiator","mc","sendMessage","session","ephemeral","resultingBuffer","recvMessage","resultingPlaintext","resultingValid","XXHandshake","isInitiator","remoteExtensions","connection","xx","staticKeypair","handshake","receivedMessageBuffer","decode0","decode1","decodedPayload","setRemoteNoiseExtension","decode2","getCS","getRemoteStaticKey","encryption","Noise","protocol","staticKeys","metrics","staticNoiseKey","prologueBytes","xxHandshakeSuccesses","registerCounter","help","xxHandshakeErrors","encryptedPackets","decryptedPackets","decryptErrors","registerMetrics","wrappedConnection","lengthEncoder","lengthDecoder","maxDataLength","performHandshake","createSecureConnection","performXXHandshake","propose","exchange","secure","user","duplexPair","network","chunk","encryptStream","encrypted","decrypted","decryptStream","noise","AbortError","abortableSource","getIterator","nextAbortHandler","abortHandler","abortMessage","abortCode","race","isKnownAborter","onReturnError","returnOnAbort","abortable","FIFO","splitLimit","calculateSize","_pushable","getNext","pushable","onNext","ended","onEnd","drain","bufferNext","objectMode","bufferError","throw","readableLength","onEmpty","throwIfAborted","ERR_INVALID_FRAME","ERR_UNREQUESTED_PING","ERR_NOT_MATCHING_PING","ERR_STREAM_ALREADY_EXISTS","ERR_DECODE_INVALID_VERSION","ERR_BOTH_CLIENTS","ERR_RECV_WINDOW_EXCEEDED","PROTOCOL_ERRORS","ERR_INVALID_CONFIG","ERR_MUXER_LOCAL_CLOSED","ERR_MUXER_REMOTE_CLOSED","INITIAL_STREAM_WINDOW","defaultConfig","enableKeepAlive","keepAliveInterval","maxInboundStreams","maxOutboundStreams","initialStreamWindowSize","maxStreamWindowSize","maxMessageSize","FrameType","Flag","flagCodes","GoAwayCode","stringifyHeader","f","flag","streamID","twoPow24","frameInProgress","returnlessSource","readHeader","readData","readBytes","decodeHeader","sublist","encodeHeader","frame","StreamState","thing","peekable","YamuxStream","config","_id","sendWindowCapacity","sendWindowCapacityUpdate","recvWindow","recvWindowCapacity","epochStart","getRTT","sendFrame","Finished","sendWindowUpdate","waitForSendWindowCapacity","toSend","getSendFlags","WindowUpdate","RST","FIN","_resolve","_reject","handleWindowUpdate","processFlags","available","recv","sourcePush","ACK","SYNSent","Established","remoteCloseWrite","Init","SYN","SYNReceived","rtt","delta","YAMUX_PROTOCOL_ID","Yamux","_init","createStreamMuxer","YamuxMuxer","closeController","nextStreamID","_streams","nextPingID","activePing","localGoAway","remoteGoAway","numInboundStreams","numOutboundStreams","onIncomingStream","onStreamEnd","verifyConfig","stream","reason","emitFrames","handleFrame","NormalTermination","errCode","InternalError","keepAliveLoop","streams","newStream","_newStream","sendPing","AbortSignal","timeout","sendGoAway","_closeMuxer","isClosed","closeStream","abortPromise","ping","clearInterval","Ping","handlePing","GoAway","handleGoAway","handleStreamMessage","handlePingResponse","pingId","incomingStream","handleData","yamux","things","parallelBatch","fixedSize","chunkSize","currentLength","emitted","newBl","UnixTime","Metadata","DataType","__DataTypeValues","filesize","blocksizes","hashType","fanout","mtime","Seconds","FractionalNanoseconds","MimeType","Raw","Directory","Symlink","HAMTShard","dirTypes","DEFAULT_FILE_MODE","DEFAULT_DIRECTORY_MODE","UnixFS","marshaled","blockSizes","secs","nsecs","_originalMode","_mode","isDirectory","addBlockSize","removeBlockSize","fileSize","sum","fromHex","hexes","persist","blockstore","cidVersion","defaultBufferImporter","bytesWritten","content","unixfs","onProgress","rawLeaves","leafType","Links","dirBuilder","prepare","originalPath","isSingleBlockImport","fileBuilder","layout","previous","bufferImporter","blockWriteConcurrency","buildFileBatch","leaves","reduceSingleLeafToSelf","leaf","links","Name","Tsize","contentAsAsyncIterable","isFileCandidate","defaultChunkValidator","DEFAULT_MAX_CHILDREN_PER_NODE","balanced","maxChildrenPerNode","balancedLayout","chunked","Dir","root","dirty","flat","parentKey","nodeSize","CID_V0","CID_V1","DirFlat","_children","childCount","directChildrenCount","onlyChild","estimateNodeSize","flush","varint","fromNumberTo32BitBuf","murmur3128","hamtHashFn","HAMT_HASH_CODE","_bucket","hashFn","shardFanoutBits","leafCount","childrenCount","eachLeafSeries","bucket","shardRoot","children","padLength","tableSize","childrenSize","labelPrefix","padStart","shard","subShard","flushedDir","label","bitField","flatToShard","threshold","newDir","oldDir","eachChildSeries","convertToShard","toPathComponents","addToTree","tree","pathElems","lastIndex","currentPath","pathElem","shardSplitThresholdBytes","flushAndYield","importer","candidates","wrapWithDirectory","fileImportConcurrency","chunker","chunkValidator","buildDag","dagBuilder","bytesRead","currentChunkSize","defaultDagBuilder","buildTree","treeBuilder","rootDir","singleRoot","unwrapped","defaultTreeBuilder","importFile","defaultImporterSettings","addBytes","importBytes","addByteStream","bufs","importByteStream","addDirectory","importDirectory","toResolve","depth","subObject","subPath","subObjectCid","blockStart","requestedStart","requestedEnd","blockLength","blockEnd","totalBytes","toPrefix","findShardCid","unmarshal","rootBucket","log2","hamtDepth","lastBucket","_putObjectAt","_options","addLinksToHamtBucket","_findNewBucketAndPos","bucketPath","_parent","toBucketPath","_posAtParent","entryPrefix","entryName","linkName","linkPath","ordered","walkDAG","streamPosition","childOps","childLink","childStart","childEnd","childQueue","concurrency","onIdle","wanted","listDirectory","contentExporters","directory","symlink","linkCid","findLinkCid","nextName","resolvers","cidAndRest","entryPath","startingDepth","walkPath","recursive","recurse","UnixFSError","NotUnixFSError","InvalidPBNodeError","AlreadyExistsError","DoesNotExistError","NoContentError","NotAFileError","NotADirectoryError","InvalidParametersError","wrapHash","InfiniteHash","_hashFn","_depth","_availableBits","_currentBufferIndex","_buffers","pendingBits","_produceMoreBits","availableBits","untake","availableForUntake","totalBits","hashValue","ConsumableBuffer","START_MASKS","STOP_MASKS","_currentBytePos","_currentBitPos","_haveBits","byte","taking","byteBitsToInt","maskFor","hamtHashCode","updateShardedDirectory","isRoot","segment","nextSegment","recreateShardedDirectory","fileName","isOverShardThreshold","estimateShardSize","current","addLink","addToShardedDirectory","addToDirectory","converted","convertToShardedDirectory","contents","createShard","parentLinks","matches","allowOverwriting","finalSegment","existingLink","findIndex","sibling","siblingName","siblingHash","siblingIndex","siblingPrefix","newIndex","newPrefix","cidToDirectory","cidToPBLink","sourceEntry","dagNodeTsize","linkSizes","segments","dirCid","updatePathCids","pblink","mergeOptions","ignoreUndefined","defaultOptions","SHARD_SPLIT_THRESHOLD_BYTES","force","removeFromDirectory","parentBlock","parentCid","removeFromShardedDirectory","unset","convertToFlatDirectory","rootNode","tsize","oldUnixfs","rm","removeLink","stat","resolved","dagSize","localFileSize","localDagSize","inspectDag","pbNode","linkResult","DefaultUnixFS","components","addAll","cat","updatedCid","nodes","updatedBlock","chmod","cp","ls","dirname","emptyDirCid","mkdir","touch","helia","abortableSink","abortableDuplex","duplex","arrayShuffle","blobToIt","openFailedError","closeFailedError","putFailedError","getFailedError","deleteFailedError","hasFailedError","notFoundError","abortedError","MemoryBlockstore","sortAll","sorter","sort","BaseBlockstore","puts","dels","putMany","deleteMany","it","filters","orders","queryKeys","_allKeys","cidToKey","keyToCid","convertPrefix","firstChar","base58","BlockstoreDatastoreAdapter","datastore","order","convertQuery","convertKeyQuery","cids","setImmediate","IDBBlockstore","upgrade","browserReadableStreamToIt","getReader","preventCancel","releaseLock","accessor","uintBoundaries","strict","readUint16","readUint32","readUint64","allowBigInt","decodeUint8","_minor","decodeUint16","decodeUint32","decodeUint64","encodeUint","encodeUintValue","uint","nuint","buint","encodedSize","compareTokens","tok1","tok2","decodeNegint8","decodeNegint16","decodeNegint32","neg1b","pos1b","decodeNegint64","MIN_SAFE_INTEGER","encodeNegint","negint","majorEncoded","toToken","decodeBytesCompact","minor","decodeBytes8","decodeBytes16","decodeBytes32","decodeBytes64","tokenBytes","encodedBytes","encodeBytes","b1","b2","totLength","tok","retainStringBytes","byteValue","decodeStringCompact","decodeString8","decodeString16","decodeString32","decodeString64","encodeString","_pos","decodeArrayCompact","decodeArray8","decodeArray16","decodeArray32","decodeArray64","decodeArrayIndefinite","allowIndefinite","encodeArray","decodeMapCompact","decodeMap8","decodeMap16","decodeMap32","decodeMap64","decodeMapIndefinite","encodeMap","decodeTagCompact","decodeTag8","decodeTag16","decodeTag32","decodeTag64","encodeTag","MINOR_FALSE","MINOR_TRUE","MINOR_NULL","MINOR_UNDEFINED","decodeUndefined","allowUndefined","coerceUndefinedToNull","decodeBreak","createToken","allowNaN","allowInfinity","decodeFloat16","readFloat16","decodeFloat32","readFloat32","decodeFloat64","readFloat64","encodeFloat","success","float64","encodeFloat16","ui8a","encodeFloat32","inp","setFloat64","setFloat32","valu32","exponent","mantissa","logicalExponent","half","NaN","exp","mant","getFloat32","getFloat64","useBuffer","asU8A","fromArray","chunks","decodeErrPrefix","encodeErrPrefix","uintMinorPrefixBytes","assertEnoughData","need","defaultDecodeOptions","Tokeniser","encodedLength","DONE","BREAK","tokensToObject","tokeniser","terminal","tokenToArray","useMaps","rejectDuplicateMapKeys","tokenToMap","tags","tagged","tokenizer","typeofs","objectTypeNames","is","typeOf","objectType","objectTypeName","getObjectType","Bl","maxCursor","_initReuseChunk","topChunk","chunkPos","defaultEncodeOptions","mapSorter","e1","e2","keyToken1","keyToken2","tcmp","cborEncoders","quickEncodeToken","encoders","makeCborEncoders","Ref","simpleTokens","null","true","false","emptyMap","typeEncoders","_typ","_refStack","bigint","boolean","_obj","refStack","addBreakTokens","createCheck","objectToTokens","typ","isMap","sortMapEntries","customTypeEncoder","typeEncoder","tokensToEncoded","encodeCustom","quickBytes","JSONEncoder","inRecursive","recurs","elements","isa","_buf","_token","Tokenizer","modeStack","lastToken","ch","currentMode","skipWhitespace","expect","parseNumber","startPos","negative","swallow","numStr","parseString","readu4","u4","readUtf8Char","ch1","parseValue","invalidMinor","errorer","jump","quick","break","Token","toBase64url","fromBase64url","encodeSignature","encoded","protected","decodeSignature","encodeRecipient","recipient","encRec","encrypted_key","decodeRecipient","isDagJWS","jose","isDagJWE","toGeneral","protectedHeader","jwe","recipients","encodedJose","jws","encJwe","aad","unprotected","isEncodedJWE","BaseDatastore","dbOpenFailedError","dbDeleteFailedError","dbWriteFailedError","dbReadFailedError","SHARDING_FN","MemoryDatastore","pathSepS","pathSepB","pathSep","Key","clean","uint8Array","less","list1","list2","c1","c2","withNamespaces","baseNamespace","namespaceType","namespaceValue","endsWith","isAncestorOf","isDecendantOf","isTopLevel","IDBDatastore","tx","ops","delKey","transform","yielded","LevelDatastore","Level","compression","iteratorOpts","li","levelIteratorToIterator","encodeBase32","keyToTopic","b64url","PubSubDatastore","pubsub","validator","selector","subscriptionKeyFn","_pubsub","_datastore","_peerId","_validator","_selector","_handleSubscriptionKeyFn","_onMessage","errMsg","stringifiedTopic","publish","getTopics","_getLocal","unsubscribe","routingKey","dsVal","detail","topicToKey","_storeIfSubscriptionIsBetter","isBetter","_isBetter","_storeRecord","records","_validateRecord","dsKey","currentRecord","_selectRecord","globalFetch","globalHeaders","buildResource","serverResolver","hostname","recordType","accept","getCacheKey","maxCache","_TXTcache","_servers","_request","_abortControllers","getServers","_getShuffledServers","newServers","setServers","servers","rrType","resolve4","resolve6","resolveTxt","cached","server","Answer","ttl","TTL","clearCache","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","encodeBlobAsBase64","fileReader","readAsDataURL","supportsBinary","lookup","decodeBase64Packet","binaryType","encoded1","encoded2","encoded3","encoded4","bufferLength","arraybuffer","mapBinary","encodedPacket","SEPARATOR","globalThisShim","pick","attr","NATIVE_SET_TIMEOUT","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","useNativeTimers","setTimeoutFn","clearTimeoutFn","TransportError","description","Transport","socket","onError","emitReserved","doOpen","doClose","onClose","packets","onOpen","onData","onPacket","details","pause","onPause","yeast","encodeURIComponent","hasCORS","XHR","xdomain","hasXHR2","xd","xscheme","xs","extraHeaders","setDisableHeaderCheck","requestTimeout","onLoad","requestsCount","requests","cleanup","fromError","attachEvent","unloadHandler","WebSocket","isReactNative","transports","websocket","forceBase64","check","protocols","ws","addEventListeners","onopen","autoUnref","_socket","onclose","closeEvent","onmessage","lastPacket","schema","timestampRequests","timestampParam","b64","encodedQuery","polling","isSSL","poll","total","doPoll","encodedPayload","encodedPackets","decodedPacket","encodePayload","doWrite","sid","xhrStatus","pollXhr","host","ipv6uri","pathNames","regx","queryKey","$0","$2","Socket","writeBuffer","prevBufferLen","agent","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","transportOptions","closeOnBeforeunload","qs","qry","pairs","upgrades","pingInterval","pingTimeout","pingTimeoutTimer","beforeunloadEventListener","transport","offlineEventListener","createTransport","EIO","priorWebsocketSuccess","setTransport","onDrain","probe","failed","onTransportOpen","upgrading","freezeTransport","onTransportClose","onupgrade","onHandshake","resetPingTimeout","sendPacket","filterUpgrades","maxPayload","getWritablePackets","payloadSize","utf8Length","compress","cleanupAndClose","waitForUpgrade","filteredUpgrades","uint32SyncSafeToken","fileTypeFromBuffer","fileTypeFromTokenizer","_check","FileTypeParser","checkString","character","fileInfo","peekBuffer","mayBeLess","mime","ignore","id3HeaderLength","readToken","readBuffer","zipHeader","compressedSize","uncompressedSize","filenameLength","extraFieldLength","filename","mimeType","nextHeaderIndex","brandMajor","maxBufferSize","fileType","readTiffHeader","readField","msb","peekNumber","ic","readElement","lengthField","nrLength","readChildren","element","readChunkHeader","guid","typeId","jsonSize","readSum","tarHeaderChecksumMatches","bigEndian","tagId","numberOfTags","readTiffTag","ifdOffset","readTiffIFD","defaultJsonSerializer","isExtractableFileEnhanced","pipe","variables","operationName","jsonSerializer","accu","currentQuery","extractOperationName","operationDefinitions","definitions","definition","kind","resolveRequestDocument","parsedDocument","ClientError","extractMessage","resolveHeaders","oHeaders","HeadersInstanceToPlainObject","cleanQuery","createHttpMethodFetcher","fetchOptions","middleware","queryParams","params_","search","buildRequestConfig","urlResolved","initResolved","urlNew","initNew","GraphQLClient","requestConfig","rawRequest","queryOrOptions","requestHeaders","rawRequestOptions","parseRawRequestArgs","requestMiddleware","responseMiddleware","makeRequest","callOrIdentity","documentOrOptions","variablesAndRequestHeaders","requestOptions","parseRequestArgs","batchRequests","documentsOrOptions","batchRequestOptions","documents","parseBatchRequestArgs","queries","setHeaders","setHeader","setEndpoint","fetcher","isBatchingQuery","getResult","successfullyReceivedData","some","successfullyPassedErrorPolicy","errorPolicy","rest","contentType","Bucket","posAtParent","_popCount","place","_putAt","_findChild","_findPlace","_at","_delAt","compactArray","asyncMap","asyncReduce","asyncTransformBucket","mapNode","reduceNodes","prettyPrint","existingChild","newPlace","_level","mappedChildren","createHAMT","bucketOptions","_PriorityQueue_queue","__classPrivateFieldGet","_PQueue_instances","_PQueue_carryoverConcurrencyCount","_PQueue_isIntervalIgnored","_PQueue_intervalCount","_PQueue_intervalCap","_PQueue_interval","_PQueue_intervalEnd","_PQueue_intervalId","_PQueue_timeoutId","_PQueue_queue","_PQueue_queueClass","_PQueue_pending","_PQueue_concurrency","_PQueue_isPaused","_PQueue_throwOnTimeout","_PQueue_doesIntervalAllowAnother_get","_PQueue_doesConcurrentAllowAnother_get","_PQueue_next","_PQueue_onResumeInterval","_PQueue_isIntervalPaused_get","_PQueue_tryToStartAnother","_PQueue_initializeIntervalIfNeeded","_PQueue_onInterval","_PQueue_processQueue","_PQueue_throwOnAbort","_PQueue_onEvent","enqueue","run","priority","comparator","step","trunc","dequeue","__classPrivateFieldSet","PQueue","_b","_c","_d","carryoverConcurrencyCount","intervalCap","POSITIVE_INFINITY","interval","autoStart","queueClass","throwOnTimeout","newConcurrency","function_","operation","functions","sizeBy","canInitializeInterval","job","setInterval","decodeOptions","decodeVarint","decodeBytes","byteLen","postOffset","decodeKey","wire","decodeLink","fieldNum","pbn","linksBeforeData","decodeNode","dagPbWalker","rawWalker","dagCborWalker","tokenBuffer","keyToken","valueToken","innerKeyToken","innerValueToken","dagJsonWalker","DEFAULT_DAG_WALKERS","DATASTORE_PIN_PREFIX","DATASTORE_BLOCK_PREFIX","DATASTORE_ENCODING","toDSKey","PinsImpl","dagWalkers","dagWalker","pinKey","pinnedBlock","pinnedBy","pinCount","pin","withPinnedBlock","walk","blockKey","BlockStorage","lock","pins","singleProcess","holdGcLock","readLock","writeLock","isPinned","DS_VERSION_KEY","NetworkedStorage","bitswap","isStarted","notify","missingBlocks","notifyEach","offline","want","HeliaImpl","libp2p","hashers","hashLoader","getHasher","codecOrName","hasher","networkedStorage","assertDatastoreVersionIsCurrent","MessageCache","gossip","msgs","msgIdToStrFn","history","notValidatedCount","historyCapacity","messageId","validated","msgIdStr","originatingPeers","iwantCounts","observeDuplicate","msgId","fromPeerIdStr","getWithIWantCount","getGossipIDs","topics","msgIdsByTopic","msgIds","validate","cacheEntry","FloodsubID","GossipsubIDv10","GossipsubIDv11","GossipsubMaxIHaveLength","shuffle","messageIdToString","typeToKey","SignaturePolicy","PublishConfigType","RejectReason","ValidateError","MessageStatus","rejectReasonFromAcceptance","acceptance","Ignore","Reject","ERR_INVALID_PEER_SCORE_PARAMS","defaultPeerScoreParams","topicScoreCap","appSpecificScore","appSpecificWeight","IPColocationFactorWeight","IPColocationFactorThreshold","IPColocationFactorWhitelist","behaviourPenaltyWeight","behaviourPenaltyThreshold","behaviourPenaltyDecay","decayInterval","decayToZero","retainScore","defaultTopicScoreParams","topicWeight","timeInMeshWeight","timeInMeshQuantum","timeInMeshCap","firstMessageDeliveriesWeight","firstMessageDeliveriesDecay","firstMessageDeliveriesCap","meshMessageDeliveriesWeight","meshMessageDeliveriesDecay","meshMessageDeliveriesCap","meshMessageDeliveriesThreshold","meshMessageDeliveriesWindow","meshMessageDeliveriesActivation","meshFailurePenaltyWeight","meshFailurePenaltyDecay","invalidMessageDeliveriesWeight","invalidMessageDeliveriesDecay","createPeerScoreParams","topicScoreParams","createTopicScoreParams","validateTopicScoreParams","defaultPeerScoreThresholds","gossipThreshold","publishThreshold","graylistThreshold","acceptPXThreshold","opportunisticGraftThreshold","createPeerScoreThresholds","computeScore","peer","pstats","peerIPs","score","tstats","topicParams","topicScore","inMesh","p1","meshTime","p2","firstMessageDeliveries","meshMessageDeliveriesActive","meshMessageDeliveries","deficit","meshFailurePenalty","invalidMessageDeliveries","p5","knownIPs","ip","peersInIP","numPeersInIP","surplus","behaviourPenalty","excess","DeliveryRecordStatus","MessageDeliveries","getRecord","ensureRecord","drec","firstSeenTsMs","gc","removeItemsFromSet","superSet","ineed","cond","subset","MapDef","getDefault","getOrDefault","PeerScore","peerStats","scoreCache","deliveryRecords","_backgroundInterval","scoreCacheValidityMs","validatePeerScoreParams","background","refreshScores","dumpPeerScoreStats","fromEntries","stats","messageFirstSeenTimestampMs","connected","tparams","graftTime","removeIPsForPeer","scoreFnCalls","inc","cacheUntil","scoreFnRuns","scoreCachedDelta","observe","addPenalty","penaltyLabel","onScorePenalty","addPeer","addIP","removeIP","peersWithIP","removePeer","getPtopicStats","validateMessage","deliverMessage","markFirstMessageDelivery","markDuplicateMessageDelivery","rejectInvalidMessage","markInvalidMessageDelivery","rejectMessage","Blacklisted","ignored","invalid","duplicateMessage","cap","validatedTime","deliveryDelayMs","isLateDelivery","onDuplicateMsgDelivery","ipsToRemove","ipToRemove","peerSet","topicStats","IWantTracer","gossipsubIWantFollowupMs","requestMsByMsg","requestMsByMsgExpire","requestMsByMsgSize","addPromise","expireByPeer","iwantPromiseStarted","getBrokenPromises","brokenPromises","iwantPromiseBroken","isDuplicate","trackMessage","iwantPromiseResolved","iwantPromiseResolvedFromDuplicate","iwantPromiseResolvedPeers","maxMs","iwantMessagePruned","requestMs","iwantPromiseDeliveryTime","SimpleTimeCache","validityMs","validUntilMs","MessageSource","InclusionReason","ChurnReason","ScorePenalty","IHaveIgnoreReason","ScoreThreshold","SignPrefix","msgIdFnStrictSign","sequenceNumber","seqnoBytes","msgIdFnStrictNoSign","computeScoreWeights","topicStrToLabel","byTopic","topicLabel","topicScores","p1w","p2w","p3w","p3bw","p4w","capF","p5w","p6w","p7w","OutboundStream","rawStream","errCallback","InboundStream","defaultDecodeRpcLimits","maxSubscriptions","maxMessages","maxIhaveMessageIDs","maxIwantMessageIDs","maxControlMessages","maxPeerInfos","decodeRpc","decodeSubOpts","decodeMessage","decodeControlMessage","decodeControlIHave","decodeControlIWant","decodeControlGraft","decodeControlPrune","decodePeerInfo","V","resolvable","createProtocol","convertToString","ipBuff","ipString","bytes2ip","bytes2str","bytes2port","bytes2mh","bytes2onion","bytes2mb","addrBytes","portBytes","Protocol","GossipStatusCode","GossipSub","globalSignaturePolicy","multicodecs","publishConfig","dataTransform","streamsInbound","streamsOutbound","outboundInflightQueue","direct","floodsubPeers","seenCache","acceptFromWhitelist","mesh","fanoutLastpub","peerhave","iasked","outbound","msgIdFn","fastMsgIdFn","fastMsgIdCache","publishedMessageIds","mcache","topicValidators","heartbeatTicks","gossipTracer","directPeerInitial","decodeRpcLimits","stopped","allowedTopics","heartbeatTimer","fallbackToFloodsub","floodPublish","doPX","directPeers","Dlo","Dhi","Dscore","Dout","Dlazy","heartbeatInterval","second","fanoutTTL","minute","mcacheLength","mcacheGossip","seenTTL","prunePeers","pruneBackoff","unsubcribeBackoff","graftFloodThreshold","opportunisticGraftPeers","opportunisticGraftTicks","directConnectTicks","scoreParams","scoreThresholds","debugName","messageCache","metricsRegister","metricsTopicStrToLabel","maxMeshMessageDeliveriesWindowMs","topicParam","protocolsEnabled","gauge","labelNames","topicSubscriptionStatus","topicPeersCount","meshPeerCounts","meshPeerInclusionEventsFanout","meshPeerInclusionEventsRandom","meshPeerInclusionEventsSubscribed","meshPeerInclusionEventsOutbound","meshPeerInclusionEventsNotEnough","meshPeerInclusionEventsOpportunistic","meshPeerInclusionEventsUnknown","meshPeerChurnEventsDisconnected","meshPeerChurnEventsBadScore","meshPeerChurnEventsPrune","meshPeerChurnEventsExcess","meshPeerChurnEventsUnknown","peersPerProtocol","heartbeatDuration","histogram","buckets","heartbeatSkipped","acceptedMessagesTotal","ignoredMessagesTotal","rejectedMessagesTotal","unknownValidationResultsTotal","asyncValidationMcacheHit","asyncValidationDelayFromFirstSeenSec","asyncValidationUnknownFirstSeen","peerReadStreamError","rpcRecvBytes","rpcRecvCount","rpcRecvSubscription","rpcRecvMessage","rpcRecvControl","rpcRecvIHave","rpcRecvIWant","rpcRecvGraft","rpcRecvPrune","rpcDataError","rpcRecvError","rpcRecvNotAccepted","rpcSentBytes","rpcSentCount","rpcSentSubscription","rpcSentMessage","rpcSentControl","rpcSentIHave","rpcSentIWant","rpcSentGraft","rpcSentPrune","msgPublishCount","msgPublishPeersByTopic","directPeersPublishedTotal","floodsubPeersPublishedTotal","meshPeersPublishedTotal","fanoutPeersPublishedTotal","msgPublishBytes","msgPublishTime","msgForwardCount","msgForwardPeers","msgReceivedPreValidation","msgReceivedError","prevalidationInvalidTotal","prevalidationValidTotal","prevalidationDuplicateTotal","prevalidationUnknownTotal","msgReceivedInvalid","msgReceivedInvalidByTopic","duplicateMsgDeliveryDelay","maxMeshMessageDeliveriesWindowSec","duplicateMsgLateDelivery","duplicateMsgIgnored","peersByScoreThreshold","avgMinMax","scoreWeights","scorePerMesh","scoringPenalties","ihaveRcvIgnored","ihaveRcvMsgids","ihaveRcvNotSeenMsgids","iwantRcvMsgids","iwantRcvDonthaveMsgids","gossipPromiseExpireSec","iwantPromiseUntracked","connectedPeersBackoffSec","cacheSize","mcacheSize","mcacheNotValidatedCount","fastMsgIdCacheCollision","newConnectionCount","toTopic","topicStr","onJoin","onLeave","onAddToMesh","Fanout","Random","Subscribed","Outbound","NotEnough","Opportunistic","onRemoveFromMesh","Dc","BadScore","Prune","Excess","onReportValidation","messageRecord","firstSeenTimestampMs","hit","onIhaveRcv","idonthave","onIwantRcv","iwantByTopic","iwantDonthave","onForwardMsg","tosendCount","onPublishMsg","tosendGroupCount","dataLen","floodsub","onMsgRecvPreValidation","onMsgRecvError","onPrevalidationResult","duplicate","onMsgRecvInvalid","onPublishDuplicateMsg","onPeerReadStreamError","onRpcRecvError","onRpcDataError","onRpcRecv","rpcBytes","onRpcSent","registerScores","scores","graylist","registerScoreWeights","sw","wsTopic","registerScorePerMesh","scoreByPeer","peersPerTopicLabel","peersInMesh","meshScores","getMetrics","addCollect","onScrapeMetrics","getPeers","started","signaturePolicy","Signing","author","Anonymous","getPublishConfigFromPeerId","createOutboundStream","peerStore","multiaddrs","addrs","registrar","multicodec","onConnect","onPeerConnected","onDisconnect","onPeerDisconnected","registrarTopologyIds","heartbeatTimeout","runHeartbeat","hearbeatStartMs","connect","unhandle","outboundStream","inboundStream","remoteAddr","createInboundStream","maxOutboundBufferSize","sendSubscriptions","priorInboundStream","maxInboundDataLength","pipePeerReadStream","addr","currentIP","multiaddr","tuple","tuples","ip4","ip6","multiaddrToIPStr","getMeshPeers","peersInTopic","getSubscribers","awaitRpcHandler","handleReceivedRpc","handlePeerReadStreamError","acceptFrom","subOpt","handleReceivedSubscription","dispatchEvent","handleReceivedMessagePromise","handleReceivedMessage","awaitRpcMessageHandler","handleControlMessage","topicSet","rpcMsg","validationResult","validateReceivedMessage","asyncValidation","emitSelf","propagationSource","forwardMessage","fastMsgIdStr","msgIdCached","SignaturePresent","SeqnoPresent","FromPresent","InvalidSeqno","InvalidSignature","InvalidPeerId","fromPeerId","rpcMsgPreSign","validateToRawMessage","inboundTransform","TransformFailed","topicValidator","getScore","toPeer","sendRpc","controlMsg","handleIHave","handleIWant","handleGraft","handlePrune","sent","iwantMessageIds","messagesAccepted","acceptUntil","LowScore","MaxIhave","MaxIasked","iask","iwantList","GraftBackoff","floodCutoff","addBackoff","makePrune","doAddBackoff","pxConnect","intervalMs","applyIwantPenalties","BrokenPromise","clearBackoff","toconnect","pi","consumePeerRecord","openConnection","getTopologies","wasSubscribed","leave","toAdd","fanoutPeers","fanoutCount","getRandomGossipPeers","sendGraft","meshPeers","sendPrune","selectPeersToForward","excludePeers","tosend","selectPeersToPublish","newFanoutPeers","rawMsg","startMs","transformedData","outboundTransform","originalData","buildRawMessage","ignoreDuplicatePublishError","willSendToSelf","allowPublishToZeroPeers","reportMessageValidationResult","rejectReason","ctrl","piggybackControl","piggybackGossip","outRpc","tograft","toprune","noPX","pruning","emitGossip","peersToGossipByTopic","gossipIDsByTopic","peersToGossip","doEmitGossip","candidateToGossip","factor","peerMessageIDs","pushGossip","controlIHaveMsgs","onUnsubscribe","backoffMs","xid","px","peerInfo","peerRecordEnvelope","timer","startTimer","heartbeat","finally","msToNextHeartbeat","directConnect","candidateMeshPeers","shuffledPeers","peerStreams","prunePeer","graftPeer","newMeshPeers","removeFirstNItemsFromSet","peersArray","rotate","peersList","medianIndex","medianScore","lastpb","topicPeers","candidateFanoutPeers","sendGraftPrune","backoffSize","expiredMs","peerIdStr","peerIdStrs","swPeer","swPeerTopic","swTopic","computeAllPeersScoreWeights","gossipsub","MessageTypes","MessageTypeNames","InitiatorMessageTypes","NEW_STREAM","MESSAGE","MESSAGE_INITIATOR","CLOSE","CLOSE_INITIATOR","RESET","RESET_INITIATOR","ReceiverMessageTypes","MESSAGE_RECEIVER","CLOSE_RECEIVER","RESET_RECEIVER","MAX_MSG_SIZE","_buffer","_headerInfo","_maxMessageSize","_maxUnprocessedMessageQueueSize","maxUnprocessedMessageQueueSize","_decodeHeader","readVarInt","DEFAULT_BATCH_SIZE","DEFAULT_SERIALIZE","yieldAfter","POOL_SIZE","_pool","_poolOffset","MplexStream","streamId","maxDataSize","printMessage","MplexStreamMuxer","_streamId","_source","closeTimeout","initiators","receivers","_createSink","minSendBytes","disconnectThreshold","registry","_newReceiverStream","maxMsgSize","createStream","_handleIncoming","maxStreamBufferSize","sourceReadableLength","Mplex","mplex","ERR_UNRECOGNIZED_VALIDITY","ERR_SIGNATURE_VERIFICATION","ERR_UNRECOGNIZED_FORMAT","ERR_UNDEFINED_PARAMETER","ERR_RECORD_TOO_LARGE","IpnsEntry","ValidityType","__ValidityTypeValues","signatureV1","validityType","validity","pubKey","signatureV2","IPNS_PREFIX","extractPublicKey","record","parseCborData","Value","time","rfc3339Matcher","year","month","hour","millisecond","padEnd","UTC","parseRFC3339","Validity","validateCborDataMatchesPbData","Sequence","peerIdFromRoutingKey","ipnsSelector","aSeq","bSeq","recordAValidityDate","toDate","recordBValidityDate","MAX_RECORD_SIZE","isValid","dataForSignature","entryData","ipnsRecordDataForV2Sig","ipnsValidator","marshalledData","receivedRecord","bootstrapConfig","createLibp2p","addresses","discoverRelays","connectionEncryption","streamMuxers","peerDiscovery","contentRouters","services","identify","autoNAT","dcutr","dht","clientMode","validators","ipns","selectors","createHelia","isLibp2p","agentVersion","addHeliaToAgentVersion","instanceOfAny","constructors","idbProxyableTypes","cursorAdvanceMethods","cursorRequestMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","IDBTransaction","wrapFunction","IDBDatabase","IDBCursor","advance","continuePrimaryKey","storeNames","transformCachableValue","unlisten","cacheDonePromiseForTransaction","IDBObjectStore","IDBIndex","IDBRequest","promisifyRequest","newValue","openDB","blocked","blocking","terminated","openPromise","oldVersion","newVersion","deleteDB","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","storeName","oldTraps"],"sourceRoot":""}