!function(){var t,e,s,n,a={60427:function(t,e,s){"use strict";var n=s(99870),a=s(89546),r=s(91026),i=s(38161);const o=t=>i.k0.parse(t),c=t=>`/ipfs/${t}`;const u="QmUgmRxoLtGERot7Y6G7UyF6fwvnusQZfGR15PuE6pY3aB",d=`/dns4/swarm.io.cybernode.ai/tcp/443/wss/p2p/${u}`,l=`/ip4/88.99.105.146/tcp/4001/p2p/${u}`,p="https://gateway.ipfs.cybernode.ai";var h=s(25108);var m=class{constructor(){this.nodeType="external",this._config={},this._isStarted=!1}get config(){return this._config}get isStarted(){return this._isStarted}async initConfig(){const t=await this.node.config.get("Addresses.Gateway");if(!t)return{gatewayUrl:p};const e=(0,r.HM)(t).nodeAddress();return{gatewayUrl:`http://${e.address}:${e.port}`}}async init(t){this.node=(0,a.Ue)(t),this._config=await this.initConfig(),"undefined"!=typeof window&&(window.node=this.node,window.toCid=o),h.log("IPFS - Kubo addrs",(await this.node.swarm.localAddrs()).map((t=>t.toString()))),this._isStarted=!0}async stat(t,e={}){return this.node.files.stat(c(t),{...e,withLocal:!0,size:!0}).then((t=>{const{type:e,size:s,sizeLocal:n,local:a,blocks:r}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:r}}))}cat(t,e={}){return this.node.cat(o(t),e)}async add(t,e={}){return(await this.node.add(t,e)).cid.toString()}async pin(t,e={}){return(await this.node.pin.add(o(t),e)).toString()}async getPeers(){return(await this.node.swarm.peers()).map((t=>t.peer.toString()))}async stop(){}async start(){}async connectPeer(t){const e=(0,r.HM)(t);return await this.node.bootstrap.add(e),await this.node.swarm.connect(e),!0}ls(){return this.node.pin.ls()}async info(){const{repoSize:t}=await this.node.stats.repo(),e=await this.node.id(),{agentVersion:s,id:n}=e;return{id:n.toString(),agentVersion:s,repoSize:t}}},y=s(21771),g=s(33634),f=s(55472),w=s(63718),b=s(99644),v=s(79071),S=s(69850),$=s(53184),x=s(44913),C=s(46177),A=s(57392),k=s(15624),T=s(21141),_=s(25108);const I={cidVersion:0,rawLeaves:!1};var P=class{constructor(){this.nodeType="helia",this._isStarted=!1}get config(){return{gatewayUrl:p}}get isStarted(){return this._isStarted}async init(){const t=new g.Y("helia-bs");await t.open();const e=new f.s("helia-ds");await e.open();const s=await(async(t,e=[])=>await(0,w.N)({datastore:t,transports:[(0,A.E)(),(0,k.d)(),(0,C.Z)({rtcConfiguration:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478","STUN:freestun.net:3479","STUN:stun.bernardoprovenzano.net:3478","STUN:stun.aa.net.uk:3478"]},{credential:"free",username:"free",urls:["TURN:freestun.net:3479","TURNS:freestun.net:5350"]}]}}),(0,C.R)(),(0,S.f)({discoverRelays:1})],connectionEncryption:[(0,b.t)()],streamMuxers:[(0,v.P)()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[(0,x.U)({list:e})],services:{identify:(0,T.HA)()}}))(e,["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/swarm.io.cybernode.ai/tcp/443/wss/p2p/QmUgmRxoLtGERot7Y6G7UyF6fwvnusQZfGR15PuE6pY3aB"]);this.node=await(0,y.F)({blockstore:t,datastore:e,libp2p:s}),this.fs=(0,$.Y4)(this.node),"undefined"!=typeof window&&(window.libp2p=s,window.node=this.node,window.fs=this.fs,window.toCid=o),s.addEventListener("peer:connect",(t=>{const e=t.detail.toString(),n=s.getConnections(e)||[],a=Object.fromEntries(n.map((t=>[t.remoteAddr.toString(),t.remoteAddr.protoCodes().map((t=>(0,r.a_)(t)?.name))])));_.debug(`Connected to ${e}`,a)})),s.addEventListener("peer:disconnect",(t=>{_.debug(`Disconnected from ${t.detail.toString()}`)})),_.log("IPFS - Helia addrs",s.getMultiaddrs().map((t=>t.toString()))),this._isStarted=!0}async stat(t,e={}){return this.fs.stat(o(t),e).then((t=>{const{type:e,fileSize:s,localFileSize:n,blocks:a,dagSize:r,mtime:i}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:a}}))}cat(t,e={}){return this.fs.cat(o(t),e)}async add(t,e={}){const s={...e,...I};let n;if(t instanceof File){const e=t.name,a=await t.arrayBuffer(),r=new Uint8Array(a);n=await this.fs.addFile({path:e,content:r},s)}else{const e=(new TextEncoder).encode(t);n=await this.fs.addBytes(e,s)}return _.log("----added to helia",n.toString()),this.pin(n.toString(),e),n.toString()}async pin(t,e={}){const s=o(t);if(!await(this.node?.pins.isPinned(s,e))){(await(this.node?.pins.add(s,e)))?.cid.toString()}}async getPeers(){return this.node.libp2p.getConnections().map((t=>t.remotePeer.toString()))}async stop(){await(this.node?.stop())}async start(){await(this.node?.start())}async connectPeer(t){await this.node.libp2p.dial((0,r.HM)(t));return!0}ls(){const t=async function*(t){for await(const e of t){const{cid:t,metadata:s}=e;yield{cid:t.toV0(),metadata:s,type:"recursive"}}}(this.node.pins.ls());return t}async info(){return{id:this.node.libp2p.peerId.toString(),agentVersion:this.node.libp2p.services.identify.host.agentVersion,repoSize:-1}}},q=s(27864),M=s(38134);var R=()=>({start:!0,repo:"ipfs-repo-cyber-v2",relay:{enabled:!1,hop:{enabled:!1}},preload:{enabled:!1},config:{API:{HTTPHeaders:{"Access-Control-Allow-Methods":["PUT","POST"],"Access-Control-Allow-Origin":["http://localhost:3000","http://127.0.0.1:5001","http://127.0.0.1:8888","http://localhost:8888"]}},Addresses:{Gateway:"/ip4/127.0.0.1/tcp/8080",Swarm:[],Delegates:[]},Discovery:{MDNS:{Enabled:!0,Interval:10},webRTCStar:{Enabled:!1}},Bootstrap:[],Pubsub:{Enabled:!1},Swarm:{ConnMgr:{HighWater:300,LowWater:50},DisableNatPortMap:!1},Routing:{Type:"dhtclient"}},libp2p:{transports:[(0,A.E)({filter:M.FR})],nat:{enabled:!1}},EXPERIMENTAL:{ipnsPubsub:!1}});var z=class{constructor(){this.nodeType="embedded",this._isStarted=!1}get config(){return{gatewayUrl:p}}get isStarted(){return this._isStarted}async init(){this.node=await(0,q.Ue)(R()),"undefined"!=typeof window&&(window.node=this.node,window.toCid=o),this._isStarted=!0}async stat(t,e={}){return this.node.files.stat(c(t),{...e,withLocal:!0,size:!0}).then((t=>{const{type:e,size:s,sizeLocal:n,local:a,blocks:r}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:r}}))}cat(t,e={}){return this.node.cat(o(t),e)}async add(t,e={}){return(await this.node.add(t,e)).cid.toString()}async pin(t,e={}){return(await this.node.pin.add(o(t),e)).toString()}async getPeers(){return(await this.node.swarm.peers()).map((t=>t.peer.toString()))}async stop(){}async start(){}async connectPeer(t){const e=(0,r.HM)(t);return await this.node.bootstrap.add(e),await this.node.swarm.connect(e),!0}ls(){return this.node.pin.ls()}async info(){const t=await this.node.stats.repo(),e=Number(t.repoSize),s=await this.node.id(),{agentVersion:n,id:a}=s;return{id:a.toString(),agentVersion:n,repoSize:e}}},E=s(49784),U=s(41487),O=s.n(U),D=s(95034),L=s(41690),F=s(25108);const N=async t=>{if(!t)return"unknown";const e=await(0,D.pM)(t);return e?.mime||"text/plain"};var Q=s(23085).lW,B=s(25108);const j=/^Qm[a-zA-Z0-9]{44}$/g,H=/^https:\/\/|^http:\/\//g;function G(t,e){return`data:${e};base64,${(0,E.B)(t,"base64")}`}const W=/\s?<!doctype html>|(<html\b[^>]*>|<body\b[^>]*>|<x-[^>]+>)+/i;const Z=async(t,e,s)=>{try{const n=t?.meta?.mime,a={link:`/ipfs/${e}`,gateway:!1,cid:e},r=(t=>{if(t){if(t.includes("video"))return"video";if(t.includes("audio"))return"audio"}return"other"})(n);if(["video","audio"].indexOf(r)>-1)return{...a,type:r,gateway:!0};const i=t?.result?await(async(t,e)=>{let s=0;try{if(t instanceof Uint8Array)return e&&e(t.byteLength),t;const n=[];if(t instanceof ReadableStream){const a=t.getReader(),r=async({done:t,value:i})=>t?(0,L.z)(n):(n.push(i),s+=i.byteLength,e&&e(s),a.read().then(r));return await a.read().then(r)}const a=t[Symbol.asyncIterator]();for await(const t of a)t instanceof Uint8Array&&(n.push(t),s+=t.byteLength,e&&e(s));return(0,L.z)(n)}catch(t){return void F.error("Error reading stream/iterable.\r\n Probably Hot reload error!",t)}})(t.result,s):void 0;if(n)if(-1!==n.indexOf("text/plain")||-1!==n.indexOf("application/xml"))if(O()(Q.from(i)))a.type="image",a.content=G(i,"image/svg+xml");else{const t=(0,E.B)(i);a.link=t.length>42?`/ipfs/${e}`:`/search/${t}`,t.match(j)?(a.gateway=!0,a.type="other",a.content=t,a.link=`/ipfs/${e}`):t.match(H)?(a.type="link",a.gateway=!1,a.content=t,a.link=`/ipfs/${e}`):!function(t){const e=t.trim().slice(0,1e3);return W.test(e)}(t)?(a.type="text",a.content=t,a.text=function(t,e=300){return t.length>e?`${t.slice(0,e)}...`:t}(t)):(a.type="other",a.gateway=!0,a.content=e.toString())}else-1!==n.indexOf("image")?(a.content=G(i,n),a.type="image",a.gateway=!1):-1!==n.indexOf("application/pdf")&&(a.type="pdf",a.content=function(t,e){const s=new Blob([t],{type:e});return URL.createObjectURL(s)}(i,n),a.gateway=!0);else a.text=`Can't detect MIME for ${e.toString()}`,a.gateway=!0;return a}catch(t){return void B.log("----parseRawIpfsData",t,e)}},V=(t,e,s=150)=>t&&e&&"text/plain"===e?(0,E.B)(t).slice(0,s):void 0;const J=new(s(39387).ZP)("cyber-page-cash");J.version(3).stores({cid:"cid",following:"cid"});var Y=J;var X={add:async(t,e)=>{if(!await Y.table("cid").get({cid:t})){const s={cid:t,data:e};Y.table("cid").add(s)}},get:async t=>{const e=await Y.table("cid").get({cid:t});return e?.data||e?.content}},K=s(86107);var tt=(()=>{const t=new K.vu("https://io.cybernode.ai");return{add:async e=>{const s="string"==typeof e?new File([e],"file.txt"):e;return t.add(s,{cidVersion:0,rawLeaves:!1})},status:async e=>t.status(e)}})(),et=s(25108);const st=async t=>{const e=await X.get(t);if(e&&e.length){const s=await N(e),n=V(e,s);return{result:e,cid:t,meta:{type:"file",size:e.length,sizeLocal:e.length,mime:s},source:"db",textPreview:n}}},nt={type:"file",size:void 0,local:void 0,sizeLocal:void 0},at=async(t,e,s)=>{if(e){return await e.stat(t,{signal:s})}return nt},rt=async(t,e,s)=>{const n=s||new AbortController,{signal:a}=n;let r;if(e){s||(r=setTimeout((()=>{n.abort()}),6e4));try{const s=Date.now(),n=await at(t,e,a),i=Date.now();n.statsTime=i-s;const o=!!n.size&&n.size<2e7;if(r&&clearTimeout(r),"directory"===n.type)return{cid:t,availableDownload:!0,source:"node",meta:n};{const{value:s,done:r}=await e.cat(t,{signal:a,length:2048,offset:0})[Symbol.asyncIterator]().next(),c=await N(s),u=n.size&&n.size>-1&&s.length>=n.size,d=V(s,c);u&&await X.add(t,(0,L.z)(s));const l=u?s:o?e.cat(t,{signal:a}):void 0;return n.catTime=Date.now()-i,!n.local&&o?(e.pin(t),n.pinTime=Date.now()-n.catTime):n.pinTime=-1,{result:l,textPreview:d,cid:t,meta:{...n,mime:c},source:"node"}}}catch(e){return et.debug("error fetchIPFSContentFromNode",e),{cid:t,availableDownload:!0,source:"node",meta:nt}}}else et.log("--------fetchIPFSContentFromNode NO NODE INTIALIZED--------")},it=async(t,e,s)=>{const n="external"===e?.nodeType,a=n?await at(t,e,s?.signal):nt,r=`${p}/ipfs/${t}`,i=await fetch(r,{method:"GET",signal:s?.signal});if(i&&i.body){const e=e=>n?Promise.resolve():X.add(t,(0,L.z)(e)),{mime:s,result:o,firstChunk:c}=await async function(t,e){const[s,n]=t.tee(),a=[],r=s.getReader(),{value:i}=await r.read(),o=i?await N(i):void 0,c=n.getReader(),u={async*[Symbol.asyncIterator](){for(;;){const{done:t,value:s}=await c.read();if(t)return void(e&&e(a,o));e&&a.push(s),yield s}}};return{mime:o,result:u,firstChunk:i}}(i.body,e),u=V(c,s);return{cid:t,textPreview:u,meta:{...a,mime:s},result:o,source:"gateway",contentUrl:r}}};const ot=async(t,e,s,n)=>{const a=await st(t);if(void 0!==a)return a;if(e){n&&n("trying to get with a node");return await rt(t,e,s)}n&&n("trying to get with a gatway");return await it(t,e,s)},ct=async(t,e)=>{let s;return t&&(s=await t.add(e)),tt.add(e),s&&await X.add(s,await(async t=>new Uint8Array("string"==typeof t?Q.from(t):await t.arrayBuffer()))(e)),s};var ut=s(25108);var dt=s(25108);const lt={helia:P,embedded:z,external:m};async function pt(t){const{ipfsNodeType:e,...s}=t,n=function(t,e){return class extends t{async fetchWithDetails(t,e){const s=await ot(t,this),n=await Z(s,t);return e?n?.type===e?n:void 0:n}async addContent(t){return ct(this,t)}async isConnectedToSwarm(){return!!(await super.getPeers()).find((t=>t===e.swarmPeerId))}async reconnectToSwarm(t){await this.isConnectedToSwarm()||super.connectPeer(e.swarmPeerAddress).then((()=>(ut.log(`ðŸ connected to swarm - ${e.swarmPeerAddress}`),!0))).catch((t=>(ut.log(`Can't connect to swarm ${e.swarmPeerAddress}: ${t.message}`),!1)))}}}(lt[e],{swarmPeerId:u,swarmPeerAddress:"external"===e?l:d}),a=new n;return await a.init({url:s.urlOpts}),dt.log("----init",e),await a.reconnectToSwarm(),a}var ht=s(86515),mt=s(16697),yt=s(94975),gt=s(42965),ft=s(29127),wt=s(87877),bt=s(23071),vt=s(1545),St=s(25211),$t=s(28368),xt=s(79878),Ct=s(32817),At=s(54608),kt=s(81480),Tt=s(25108);class _t{constructor(t,e){this.settings=t,this.order=e}getNextSource(t){const e=this.order.indexOf(t);return e<this.order.length?this.order[e+1]:void 0}}class It extends Error{constructor(t){super(`Timeout after ${t}`),Object.setPrototypeOf(this,It.prototype)}}var Pt=s(29829),qt=s(22222);function Mt(t){return Boolean(t.match(/^Qm[a-zA-Z0-9]{44}$/g))}var Rt=(t=>(t[t.transactions=1]="transactions",t[t.particle=2]="particle",t[t.chat=3]="chat",t))(Rt||{}),zt=(t=>(t[t.pending=0]="pending",t[t.executing=1]="executing",t[t.done=2]="done",t[t.error=-1]="error",t))(zt||{}),Et=s(25108);const Ut={list:{isLoading:!1,data:[],error:void 0},chats:{},summary:{unreadCount:{total:0,particles:0,neurons:0}}};function Ot(t){t.entryType===Rt.chat&&t.meta.to&&(t.entryType=Rt.particle);const{meta:e}=t,s={timestamp:new Date(e.timestamp).toISOString(),transactionHash:t.transactionHash||t.hash||t.meta.transaction_hash||t.meta.hash||t.meta.transactionHash,memo:t.memo||e.memo,senseChatId:t.id,unreadCount:t.unreadCount||0};switch(t.entryType){case Rt.chat:case Rt.transactions:{const e=t.meta,{type:n}=e;let a=t.ownerId;if("cosmos.bank.v1beta1.MsgSend"===n){a=e.value.fromAddress}else if("cosmos.bank.v1beta1.MsgMultiSend"===n){a=e.value.inputs[0].address}Object.assign(s,{type:n,from:a,meta:t.meta.value});break}case Rt.particle:{const e=t.meta;Object.assign(s,{type:"cyber.graph.v1beta1.MsgCyberlink",from:e.neuron,meta:e,fromLog:!0});break}default:return{}}return s}const Dt=(0,Pt.hg)("sense/getSenseList",(async t=>(await t.getList()).map(Ot))),Lt=(0,Pt.hg)("sense/getSenseChat",(async({id:t,senseApi:e})=>{if(Mt(t)){return(await e.getLinks(t)).map((e=>{if(0!==e.timestamp)return Ot({...e,id:t,entryType:Rt.particle,meta:e})})).filter(Boolean)}return(await e.getFriendItems(t)).map((e=>{const s=e.to?Rt.particle:Rt.chat;return Ot({...e,entryType:s,id:t,meta:e})}))})),Ft=(0,Pt.hg)("sense/markAsRead",(async({id:t,senseApi:e})=>e.markAsRead(t))),Nt={id:"",isLoading:!1,data:[],error:void 0,unreadCount:0};function Qt(t,e){return t.data.slice(-5).some((t=>t.transactionHash===e.transactionHash))}const Bt=(0,Pt.oM)({name:"sense",initialState:Ut,reducers:{updateSenseList:{reducer:(t,e)=>{e.payload.forEach((e=>{const{senseChatId:s}=e;t.chats[s]||(t.chats[s]={...Nt});const n=t.chats[s];Object.assign(n,{id:s,unreadCount:e.unreadCount||0}),Qt(n,e)||(n.data=n.data.concat(e))})),Bt.caseReducers.orderSenseList(t)},prepare:t=>({payload:t.map(Ot)})},addSenseItem(t,e){const{id:s,item:n}=e.payload;t.chats[s].data.push({...n,meta:n.meta,status:"pending"});const a=t.list.data.filter((t=>t!==s));a.unshift(s),t.list.data=a},updateSenseItem(t,e){const{chatId:s,txHash:n,isSuccess:a}=e.payload,r=t.chats[s].data.find((t=>t.transactionHash===n));r&&(a?delete r.status:r.status="error")},orderSenseList(t){const e=Object.keys(t.chats).reduce(((e,s)=>{const n=t.chats[s];if(!n.data.length)return e;const a=n.data[n.data.length-1];return e.push({id:s,lastMsg:a}),e}),[]).sort(((t,e)=>Date.parse(e.lastMsg.timestamp)-Date.parse(t.lastMsg.timestamp)));t.list.data=e.map((t=>t.id))},reset:()=>Ut},extraReducers:t=>{t.addCase(Dt.pending,(t=>{t.list.isLoading=!0})),t.addCase(Dt.fulfilled,((t,e)=>{t.list.isLoading=!1;const s=[];e.payload.forEach((e=>{const{senseChatId:n}=e;t.chats[n]||(t.chats[n]={...Nt});const a=t.chats[n];Object.assign(a,{id:n,unreadCount:e.unreadCount||0}),Qt(a,e)||(a.data=a.data.concat(e)),s.push(n)})),t.list.data=s})),t.addCase(Dt.rejected,((t,e)=>{Et.error(e),t.list.isLoading=!1,t.list.error=e.error.message})),t.addCase(Lt.pending,((t,e)=>{const{id:s}=e.meta.arg;t.chats[s]||(t.chats[s]={...Nt}),t.chats[s].isLoading=!0})),t.addCase(Lt.fulfilled,((t,e)=>{const{id:s}=e.meta.arg,n=t.chats[s];n.isLoading=!1,n.id=s,n.data=e.payload})),t.addCase(Lt.rejected,((t,e)=>{Et.error(e);const s=t.chats[e.meta.arg.id];s.isLoading=!1,s.error=e.error.message})),t.addCase(Ft.fulfilled,((t,e)=>{const{id:s}=e.meta.arg,n=t.chats[s],a=Mt(s),{unreadCount:r}=n;t.summary.unreadCount.total-=r,a?t.summary.unreadCount.particles-=r:t.summary.unreadCount.neurons-=r,n.unreadCount=0}))}}),{addSenseItem:jt,updateSenseItem:Ht,updateSenseList:Gt,reset:Wt}=((0,qt.P1)((t=>t.sense.chats),(t=>{let e=0,s=0;Object.values(t).forEach((({id:t,unreadCount:n})=>{Mt(t)?e+=n:s+=n}));return{total:e+s,particles:e,neurons:s}})),Bt.actions);Bt.reducer;var Zt=class{constructor(){this.channel=new BroadcastChannel("cyb-broadcast-channel")}postServiceStatus(t,e,s){this.channel.postMessage({type:"service_status",value:{name:t,status:e,message:s}})}postSyncEntryProgress(t,e){this.channel.postMessage({type:"sync_entry",value:{entry:t,state:e}})}postSenseUpdate(t){t.length>0&&this.channel.postMessage(Gt(t))}post(t){this.channel.postMessage(t)}},Vt=s(25108);function Jt(t){return(t.priority||0)+(t.viewPortPriority||0)}const Yt={external:new _t({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e4,maxConcurrentExecutions:50},gateway:{timeout:21e3,maxConcurrentExecutions:11}},["db","node","gateway"]),embedded:new _t({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e4,maxConcurrentExecutions:50},gateway:{timeout:21e3,maxConcurrentExecutions:11}},["db","gateway","node"]),helia:new _t({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e3,maxConcurrentExecutions:50},gateway:{timeout:3e3,maxConcurrentExecutions:11}},["db","node","gateway"])};var Xt=class{constructor(t,{strategy:e,queueDebounceMs:s,defferedDbSaver:n}){this.queue$=new ht.X(new Map),this.node=void 0,this.lastNodeCallTime=Date.now(),this.channel=new Zt,this.executing={db:new Set,node:new Set,gateway:new Set},t.subscribe((t=>{t&&this.setNode(t)})),this.strategy=e||Yt.embedded,this.queueDebounceMs=s||33,this.defferedDbSaver=n,(0,mt.F)(5e3).pipe((0,yt.h)((()=>this.queue$.value.size>0&&!!this.node))).subscribe((()=>this.node.reconnectToSwarm(this.lastNodeCallTime))),this.queue$.pipe((0,gt.b)(this.queueDebounceMs),(0,ft.U)((t=>this.cancelDeprioritizedItems(t))),(0,wt.z)((t=>{const e=this.getItemBySourceAndPriority(t);return e.length>0?(this.node?.reconnectToSwarm(this.lastNodeCallTime),(0,bt.T)(...e.map((t=>this.fetchData$(t))))):vt.E}))).subscribe((({item:t,status:e,source:s,result:n})=>{const{cid:a}=t,r=this.queue$.value.get(a)?.callbacks||[];if(r.map((t=>t(a,e,s,n))),"node"===s&&(this.lastNodeCallTime=Date.now()),this.executing[s].delete(a),"completed"===e||"cancelled"===e)this.removeAndNext(a);else{const e=this.strategy.getNextSource(s);e?this.switchSourceAndNext(t,e):(this.removeAndNext(a),r.map((t=>t(a,"not_found",s,n))))}this.postSummary()}))}switchStrategy(t){this.strategy=t}async setNode(t,e){Vt.log(`switch node from ${this.node?.nodeType} to ${t.nodeType}`),this.node=t,this.switchStrategy(e||Yt[t.nodeType])}getItemBySourceAndPriority(t){const e=[...t.values()].filter((t=>"pending"===t.status)),s=At.vMG((t=>t.source),e),n=[];for(const[t,e]of Object.entries(s)){const s=this.strategy.settings[t].maxConcurrentExecutions-this.executing[t].size,a=e.sort(((t,e)=>Jt(e)-Jt(t))).slice(0,s);n.push(...a)}return n}postSummary(){const t=`(total: ${this.queue$.value.size} |  db - ${this.executing.db.size} node - ${this.executing.node.size} gateway - ${this.executing.gateway.size})`;this.channel.postServiceStatus("ipfs","started",t)}fetchData$(t){const{cid:e,source:s,callbacks:n,controller:a}=t,r=this.strategy.settings[s];this.executing[s].add(e),this.postSummary();const i=this.queue$.value.get(e);return this.queue$.value.set(e,{...i,status:"executing",executionTime:Date.now(),controller:new AbortController}),n.map((t=>t(e,"executing",s))),(o=async()=>{try{const t=await async function(t,e,s){const{node:n,controller:a}=s;try{switch(e){case"db":return st(t);case"node":return rt(t,n,a);case"gateway":return it(t,n,a);default:return}}catch(t){return void et.log("----fetchIpfsContent error",t)}}(e,s,{controller:a,node:this.node}).then((t=>(this.defferedDbSaver?.enqueueIpfsContent(t),t)));return t}catch(t){throw t}},new kt.y((t=>{o().then((e=>{t.next(e),t.complete()})).catch((e=>{Tt.debug("----promiseToObservable error",e),t.error(e)}))}))).pipe((0,St.V)({each:r.timeout,with:()=>(0,$t._)((()=>(a?.abort("timeout"),new It(r.timeout))))}),(0,ft.U)((e=>({item:t,status:e?"completed":"error",source:s,result:e}))),(0,xt.K)((e=>e instanceof It?(0,Ct.of)({item:t,status:"timeout",source:s}):"AbortError"===e?.name?(0,Ct.of)({item:t,status:"cancelled",source:s}):(0,Ct.of)({item:t,status:"error",source:s}))));var o}mutateQueueItem(t,e){const s=this.queue$.value,n=s.get(t);return n&&s.set(t,{...n,...e}),this.queue$.next(s)}removeAndNext(t){const e=this.queue$.value;e.delete(t),this.queue$.next(e)}switchSourceAndNext(t,e){t.callbacks.map((s=>s(t.cid,"pending",e))),this.mutateQueueItem(t.cid,{status:"pending",source:e})}cancelDeprioritizedItems(t){return["node","gateway"].forEach((e=>{Array.from(this.executing[e]).forEach((s=>{const n=t.get(s);n&&Jt(n)<0&&n.controller&&(n.controller.abort("cancelled"),n.callbacks.map((t=>t(n.cid,"pending",n.source))),t.set(s,{...n,status:"pending"}),this.executing[e].delete(s))}))})),t}releaseExecution(t){Object.keys(this.executing).forEach((e=>this.executing[e].delete(t)))}enqueue(t,e,s={}){const n=this.queue$.value,a=n.get(t);if(a)this.mutateQueueItem(t,{callbacks:[...a.callbacks,e]});else{const a=s.initialSource||this.strategy.order[0],r={cid:t,callbacks:[e],source:a,status:"pending",postProcessing:!0,...s};e(t,"pending",a),n.set(t,r),this.queue$.next(n)}}enqueueAndWait(t,e={}){return new Promise((s=>{this.enqueue(t,((t,e,n,a)=>{"completed"!==e&&"not_found"!==e||s({status:e,source:n,result:a})}),e)}))}updateViewPortPriority(t,e){this.mutateQueueItem(t,{viewPortPriority:e})}cancel(t){const e=this.queue$.value.get(t);e&&(e.controller?e.controller.abort("cancelled"):this.removeAndNext(t))}cancelByParent(t){const e=this.queue$.value;e.forEach(((s,n)=>{s.parent===t&&(this.releaseExecution(n),s.controller?.abort("cancelled"),e.delete(n))})),this.queue$.next(e)}clear(){const t=this.queue$.value;t.forEach(((e,s)=>{this.releaseExecution(s),e.controller?.abort("cancelled"),t.delete(s)})),this.queue$.next(new Map)}getQueueMap(){return this.queue$.value}getQueueList(){return Array.from(this.queue$.value.values())}getStats(){return At.zGw(At.VFc(At.vgT("status")),At.Zpf,At.UID(At._Qy(["status","count"])))(this.getQueueList())}},Kt=(t=>(t[t.ZERO=0]="ZERO",t[t.LOW=.1]="LOW",t[t.MEDIUM=.5]="MEDIUM",t[t.HIGH=.9]="HIGH",t[t.URGENT=1]="URGENT",t))(Kt||{}),te=s(12550);function ee(t){return{async*[Symbol.asyncIterator](){let e=!1;for(;!e;){const s=new Promise((s=>{t.onmessage=t=>{null===t.data?(e=!0,s(null)):s(t.data)}})),n=await s;null!==n&&(yield n)}}}}const se={canHandle:t=>t&&t.result&&"function"==typeof t.result[Symbol.asyncIterator],serialize(t){if(void 0===t)return[null,[]];const{result:e,...s}=t,{port1:n,port2:a}=new MessageChannel;return e&&(async()=>{for await(const t of e)n.postMessage(t);n.postMessage(null),n.close()})(),[{...s,port:a},[a]]},deserialize(t){if(!t)return;const{port:e,...s}=t;return{...s,result:ee(e)}}};var ne=s(34155),ae=s(25108);"undefined"!=typeof SharedWorker&&ne.env.IS_DEV;function re(){n.Y6.set("IPFSContent",se)}function ie(t){const e={log:{original:ae.log},error:{original:ae.error},warn:{original:ae.warn}},s=s=>{const{original:n}=e[s];e[s].original=ae[s],ae[s]=(...e)=>{n.apply(ae,e);const a=e.map((t=>function(t){try{return JSON.stringify(t)}catch(e){return String(t)}}(t)));t.postMessage({type:"console",method:s,args:a})}};Object.keys(e).forEach((t=>s(t)))}var oe=s(97255),ce=s(42006),ue=s(65583);const de=(t,e)=>({sendStatus:(s,n,a)=>{e.postSyncEntryProgress(t,{status:s,message:n,progress:a,done:["active","error","listen"].some((t=>t===s))})}});async function le(t,e,s=10){let n=[];for await(const a of t)n.push(a),n.length===s&&(await e(n),n=[]);n.length>0&&await e(n)}const pe="QmbdH2WBamyKLPE5zu4mJ9v49qvY8BFfoumoVPMR5V4Rvx",he="QmPLSA5oPqYxgc8F7EwrM8WS9vKrr1zPoDniSRFh8HSrxx",me=new RegExp("^bostrom[a-zA-Z0-9]{39}$","g"),ye=[pe,he];var ge=s(25108);var fe=class{constructor(t){if(this.statusApi=de("resolver",new Zt),this._syncQueue$=new ht.X(new Map),!t.waitForParticleResolve)throw new Error("waitForParticleResolve is not defined");this.waitForParticleResolve=t.waitForParticleResolve,t.dbInstance$.subscribe((async t=>{this.db=t,await this.loadSyncQueue()})),this.isInitialized$=(0,oe.a)([t.dbInstance$,t.ipfsInstance$]).pipe((0,ft.U)((([t,e])=>!!e&&!!t)))}get queue(){return this._syncQueue$.getValue()}get loop$(){return this._loop$}async processSyncQueue(t){const e=t.length;this.statusApi.sendStatus("in-progress",`processing batch ${e}/${e} batch. ${this.queue.size} pending...`);let s=e;await Promise.all(t.map((async t=>{const{id:n}=t;return this.waitForParticleResolve(n,Kt.MEDIUM).then((async t=>{"not_found"===t.status?await this.db.updateSyncQueue({id:n,status:zt.error}):await this.db.removeSyncQueue(n);const a=this._syncQueue$.value;a.delete(n),s--,this._syncQueue$.next(a),this.statusApi.sendStatus("in-progress",`processing batch ${e-s}/${e} batch. ${this.queue.size} pending...`)}))})))}start(){const t=this.isInitialized$.pipe((0,ce.b)((t=>ge.log(`sync queue isInitialized - ${t}`))),(0,yt.h)((t=>!0===t)),(0,wt.z)((()=>this._syncQueue$)),(0,yt.h)((t=>t.size>0)),(0,wt.z)((t=>{const e=[...t.values()],s=100-e.filter((t=>t.status===zt.executing)).length;if(s>0){const n=e.filter((t=>t.status===zt.pending)).sort(((t,e)=>t.priority-e.priority)).slice(0,s);if(n.length>0)return n.forEach((e=>{t.set(e.id,{...e,status:zt.executing})})),this._syncQueue$.next(t),this.statusApi.sendStatus("in-progress","starting..."),this.processSyncQueue(n)}return vt.E})));return this._loop$=t.pipe((0,ue.B)()),this._loop$.subscribe({next:t=>{this.statusApi.sendStatus("active")},error:t=>this.statusApi.sendStatus("error",t.toString())}),this}async fetchDirect(t){return this.waitForParticleResolve(t,Kt.URGENT)}async enqueueBatch(t,e){return le(t,(t=>this.enqueue(t.map((t=>({id:t,priority:e}))))),500)}async enqueue(t){if(0===t.length)return;await this.db.putSyncQueue(t);const e=this._syncQueue$.value;t.forEach((t=>e.set(t.id,{...t,status:zt.pending}))),this._syncQueue$.next(e)}async loadSyncQueue(){const t=await this.db.getSyncQueue({statuses:[zt.pending]}).then((t=>new Map(t.map((t=>[t.id,t])))));this._syncQueue$.next(new Map([...t,...this.queue]))}},we=s(98431),be=s(19917),ve=s(11954),Se=s(96486),$e=s(48116),xe=s.n($e);s(25108);const Ce=t=>xe()(new Date(t),'yyyy-mm-dd"T"HH:MM:ss.l',!0),Ae=t=>Date.parse(t.endsWith("Z")?t:`${t}Z`);const ke=(t,e)=>{const{transaction_hash:s,index:n,transaction:{memo:a,block:{timestamp:r,height:i},success:o},type:c,value:u}=e;return{hash:s,index:n,type:c,timestamp:Ae(r),memo:a,value:u,success:o,neuron:t,blockHeight:i}},Te=({from:t,to:e,neuron:s,timestamp:n,transaction_hash:a})=>({from:t,to:e,neuron:s,timestamp:Ae(n),transactionHash:a});function _e(t,e){return async(...s)=>{if(e.aborted)throw new DOMException("The operation was aborted.","AbortError");return t(...s)}}var Ie=s(34155);const Pe=Ie.env.CYBER_NODE_URL_LCD||"https://lcd.bostrom.cybernode.ai",qe=Ie.env.CYBER_INDEX_WSS||"wss://index.bostrom.cybernode.ai/v1/graphql",Me="wss://rpc.bostrom.cybernode.ai/websocket";var Re=s(29639),ze=s(98994),Ee=s(28972);const Ue="cosmos.bank.v1beta1.MsgSend",Oe="cosmos.bank.v1beta1.MsgMultiSend",De=(t,e)=>{const{data:s,events:n}=e,a=n["tx.hash"][0],r=n["message.action"][0].slice(1),i=Date.now(),o=n["tx.height"][0],{memo:c="",messages:u}=(t=>{const e=Re.Tx.decode((0,Ee.Gh)(t)),s=e.body?.memo,n=e.body?.messages.map((t=>{const e=t.typeUrl.slice(1);return e===Ue?ze.MsgSend.decode(t.value):e===Oe?ze.MsgMultiSend.decode(t.value):void 0})).filter((t=>void 0!==t));return{memo:s,messages:n}})(s.value.TxResult.tx),d=[];return u.forEach(((e,s)=>{d.push({hash:a,index:s,type:r,timestamp:i,success:!0,value:e,memo:c,neuron:t,blockHeight:o})})),d};var Le=s(31230);async function*Fe(t,e){let s=0;for(;;){const n=await t({...e,offset:s});if(0===n.length)break;yield n,s+=n.length}}var Ne=s(6584),Qe=s(85185),Be=s(95210),je=s(78699),He=s(26461);const Ge=new Be.g((0,He.eI)({url:qe,shouldRetry:t=>!0,retryAttempts:10,retryWait:async t=>{setTimeout((()=>Promise.resolve()),Math.min(1e3*2**t,1e4))}})),We=t=>new je.g6("https://index.bostrom.cybernode.ai/v1/graphql",{signal:t});const Ze=(0,Le.Ps)("\nquery Cyberlinks($limit: Int, $offset: Int, $orderBy: [cyberlinks_order_by!], $where: cyberlinks_bool_exp) {\n  cyberlinks(limit: $limit, offset: $offset, order_by: $orderBy, where: $where) {\n    from: particle_from\n    to: particle_to\n    timestamp\n    neuron\n    transaction_hash\n  }\n}\n"),Ve=((0,Le.Ps)("\n  query Cyberlinks($where: cyberlinks_bool_exp) {\n    cyberlinks_aggregate(where: $where) {\n      aggregate {\n        count\n      }\n    }\n    first: cyberlinks(limit: 1, order_by: { timestamp: asc }, where: $where) {\n      timestamp\n    }\n    last: cyberlinks(limit: 1, order_by: { timestamp: desc }, where: $where) {\n      timestamp,\n      to: particle_to,\n      from: particle_from\n    }\n  }\n"),(0,Le.Ps)("\n  query MyQuery($address: String, $particles_from: [String!], $timestamp: timestamp) {\n    cyberlinks_aggregate(where: {\n        _and: [\n          { neuron: {_eq: $address}},\n          { particle_from: {_in: $particles_from}},\n          { timestamp: {_gt: $timestamp}}\n        ]\n      }) {\n      aggregate {\n        count\n      }\n    }\n  }\n  ")),Je=async({particleCid:t,timestampFrom:e,offset:s=0,abortSignal:n})=>(await We(n).request(Ze,{limit:200,offset:s,orderBy:[{timestamp:"asc"}],where:{_or:[{particle_to:{_eq:t}},{particle_from:{_eq:t}}],timestamp:{_gt:Ce(e)}}})).cyberlinks,Ye=async({neuron:t,particlesFrom:e,timestampFrom:s,batchSize:n,offset:a=0,abortSignal:r})=>{const i={_and:[{timestamp:{_gt:Ce(s)}},{neuron:{_eq:t}},{particle_from:{_in:e}}]};return(await We(r).request(Ze,{limit:n,offset:a,orderBy:[{timestamp:"asc"}],where:i})).cyberlinks},Xe=async(t,e,s,n,a)=>Fe(Ye,{neuron:t,particlesFrom:e,timestampFrom:s,batchSize:n,abortSignal:a}),Ke=t=>[...new Set([...t.map((t=>t.to)),...t.map((t=>t.from))])],ts=async(t,e,s,n,a)=>{const r=((t,e,s)=>Fe(Je,{particleCid:t,timestampFrom:e,abortSignal:s}))(t,e,a),i=[];for await(const t of r){i.push(...t);const e=Ke(t);e.length>0&&await le(e,(t=>s.enqueueBatch(t,n)),20)}return i};const es=({neuron:t,timestampFrom:e,offset:s=0,types:n=[],orderDirection:a="desc",limit:r,abortSignal:i})=>({address:`{${t}}`,limit:r,timestamp_from:Ce(e),offset:s,types:`{${n.map((t=>`"${t}"`)).join(" ,")}}`,order_direction:a}),ss=t=>(0,Le.Ps)(`\n${t} MyQuery($address: _text, $limit: bigint, $offset: bigint, $timestamp_from: timestamp, $types: _text, $order_direction: order_by) {\n  messages_by_address(\n    args: {addresses: $address, limit: $limit, offset: $offset, types: $types},\n    order_by: {transaction: {block: {timestamp: $order_direction}}},\n    where: {transaction: {block: {timestamp: {_gt: $timestamp_from}}}}\n    ) {\n    transaction_hash\n    index\n    value\n    transaction {\n      success\n      block {\n        timestamp,\n        height\n      }\n      memo\n    }\n    type\n  }\n}\n`),ns=async({neuron:t,timestampFrom:e,offset:s=0,types:n=[],orderDirection:a="desc",limit:r,abortSignal:i})=>{const o=await We(i).request(ss("query"),es({neuron:t,timestampFrom:e,offset:s,types:n,orderDirection:a,limit:r,abortSignal:i}));return o?.messages_by_address},as=(0,Le.Ps)('\n  query MyQuery($address: _text, $timestamp: timestamp) {\n    messages_by_address_aggregate(\n      args: {addresses: $address, limit: "100000000", offset: "0", types: "{}"},\n      where: {transaction: {block: {timestamp: {_gt: $timestamp}}}}) {\n        aggregate {\n          count\n        }\n      }\n  }\n  '),rs=(t,e,s,n,a)=>{const r=t.get(e),i=r?.transactions||[];return i.push(s),t.set(e,{userAddress:e,lastSendTimestamp:a?s.timestamp:r?.lastSendTimestamp||0,last:{amount:n,memo:s.memo,direction:a?"to":"from"},transactions:i}),t},is=async(t,e,s,n,a=!0)=>{const r=await t.findSyncStatus({ownerId:e,entryType:Rt.chat}),i=new Map(r?.map((t=>[t.id,t]))),o=((t,e)=>{if(0===(e.filter((t=>t.type===Ue||t.type===Oe))||[]).length)return[];const s=new Map;return e.forEach((e=>{let n="";if(e.type===Oe){const{inputs:n,outputs:a}=e.value,r=n.find((e=>e.address===t));(r?a:n).forEach((t=>rs(s,t.address,e,t.coins,r)))}else if(e.type===Ue){const{fromAddress:a,toAddress:r,amount:i}=e.value,o=a===t;n=o?r:a,rs(s,n,e,i,o)}})),s})(e,await t.getTransactions(e,{order:"asc",timestampFrom:s})),c=[];for(const s of o.values()){const r=i.get(s.userAddress),o=s.transactions.at(-1),{timestamp:u,hash:d,index:l}=o,p={entryType:Rt.chat,ownerId:e,meta:{transactionHash:d,index:l}};if(r){const{id:e,timestampRead:i,timestampUpdate:d,meta:l,unreadCount:h}=r,m=Math.max(i,s.lastSendTimestamp),{timestampUpdateContent:y=0,timestampUpdateChat:g=0}=l,f=Math.max(s.lastSendTimestamp,g),w=h+s.transactions.filter((t=>t.timestamp>f)).length;if(d<u){const s=a?u:g,i={...p,id:e,unreadCount:w,timestampRead:m,timestampUpdate:Math.max(u,y,s),meta:{...p.meta,timestampUpdateChat:s,timestampUpdateContent:y}};await _e(t.updateSyncStatus.bind(t),n)(i),c.push({...r,...i,meta:o})}}else{const e=s.transactions.filter((t=>t.timestamp>s.lastSendTimestamp)).length,r={...p,id:s.userAddress,unreadCount:e,timestampUpdate:a?u:0,timestampRead:s.lastSendTimestamp,disabled:!1};await _e(t.putSyncStatus.bind(t),n)(r),c.push({...r,meta:o})}}return c};var os=s(98430),cs=s(34978),us=s(93994);class ds{constructor(t){this.requestRecords=[],this.totalRequests=0,this.completedRequests=0,this.estimatedTime=-1,this.batchSize=1,this.onProgressUpdate=t}get progress(){return{totalCount:this.totalRequests,completeCount:this.completedRequests,estimatedTime:this.estimatedTime}}start(t,e=1){return this.totalRequests=t,this.requestRecords=[],this.completedRequests=0,this.estimatedTime=-1,this.batchSize=e,this.progress}add(t){return this.totalRequests+=t,this.progress}trackProgress(t){if(this.addRequestRecord(t),this.requestRecords.length>10&&this.requestRecords.shift(),this.requestRecords.length>1){const e=this.calculateAverageTimePerItem()*((this.totalRequests-this.completedRequests)*t);this.completedRequests+=t,this.estimatedTime=Math.round(e),this.onProgressUpdate&&this.onProgressUpdate(this.progress)}return this.progress}addRequestRecord(t){this.requestRecords.push({timestamp:Date.now(),itemCount:t})}calculateAverageTimePerItem(){let t=0,e=0;for(let s=1;s<this.requestRecords.length;s++){const n=this.requestRecords[s].timestamp-this.requestRecords[s-1].timestamp,{itemCount:a}=this.requestRecords[s];t+=n*a,e+=a}return 0===e?0:t/e}}var ls=class{constructor(t,e,s){if(this.progressTracker=new ds,this.channelApi=new Zt,this.params={myAddress:null},this.name=t,this.abortController=new AbortController,this.statusApi=de(t,this.channelApi),this.particlesResolver=s,this.cyblogCh=(0,us.B)({thread:"bckd",module:t}),!e.params$)throw new Error("params$ is not defined");e.dbInstance$.subscribe((t=>{this.db=t})),this.particlesResolver=s,this.isInitialized$=this.createIsInitializedObserver(e),this.isInitialized$.subscribe((t=>{this.cyblogCh.info(`>>> ${this.name} - ${t?"initialized":"inactive"}`),this.statusApi.sendStatus(t?"initialized":"inactive")})),this.isInitialized$.pipe((0,cs.w)((()=>e.params$))).subscribe((t=>{this.params=t,this.cyblogCh.info(`>>> ${this.name} - params updated`,{data:t})})),this.isInitialized$.pipe((0,yt.h)((t=>!!t)),(0,cs.w)((()=>this.createRestartObserver(e.params$)))).subscribe((()=>{this.restart()}))}initAbortController(){this.abortController=new AbortController}createRestartObserver(t){return t.pipe((0,ft.U)((t=>t.myAddress)),(0,we.x)(((t,e)=>t===e)),(0,ft.U)((t=>!!t)),(0,yt.h)((t=>!!t)))}};const ps=(t,e,s)=>t.pipe((0,we.x)(),(0,ce.b)((t=>s?.(t))),(0,yt.h)((t=>t)),(0,cs.w)((()=>e)),(0,ue.B)());var hs=s(25108);var ms=class extends ls{constructor(t,e,s){super(t,e,s),this.reloadTrigger$=new te.x;const n=ps(this.isInitialized$,this.reloadTrigger$.pipe((0,os.O)(null),(0,ce.b)((()=>{this.initAbortController()})),(0,cs.w)((()=>this.createInitObservable().pipe((0,cs.w)((t=>this.createClientObservable(t).pipe((0,ce.b)((()=>this.statusApi.sendStatus("listen"))),(0,cs.w)((t=>(0,ve.D)(this.onUpdate(t,this.params))))))))))),(e=>{hs.log(`>>> ${t} isInitialized`,e),this.statusApi.sendStatus(e?"initialized":"inactive")}));n.subscribe({next:()=>{this.statusApi.sendStatus("listen")},error:t=>{this.statusApi.sendStatus("error",t)}}),this.source$=n}restart(){this.abortController?.abort(),this.reloadTrigger$.next(),hs.log(`>>> ${this.name} client restart`)}start(){return this.source$.subscribe((()=>{})),this}};var ys=class extends ms{createIsInitializedObserver(t){return(0,oe.a)([t.dbInstance$,t.params$.pipe((0,ft.U)((t=>t.myAddress)),(0,we.x)()),this.particlesResolver.isInitialized$]).pipe((0,ft.U)((([t,e,s])=>!!t&&!!s&&!!e)))}createClientObservable(t){const{myAddress:e}=this.params;this.cyblogCh.info(`>>> ${this.name} subscribe ${e} from ${Ce(t)}`);const s=es({neuron:e,timestampFrom:t,types:[],orderDirection:"desc",limit:100}),n=function(t,e){const s=new Ne.f({link:Ge,cache:new Qe.h}).subscribe({query:t,variables:e});return new kt.y((t=>{const e=s.subscribe({next(e){t.next(e.data)},error(e){t.error(e)},complete(){t.complete()}});return()=>e.unsubscribe()}))}(ss("subscription"),s).pipe((0,ft.U)((t=>({source:"indexer",transactions:t.messages_by_address.map((t=>ke(e,t)))})))),a=function(t,e,s){return new kt.y((n=>{const a=new WebSocket(Me);return a.onopen=()=>{s(`node ws connected to ${Me} with ${e}`),a.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",id:"0",params:{query:e}}))},a.onmessage=e=>{const a=JSON.parse(e.data);s(`node ws ${t} onmessage`,a),n.next(a.result)},a.onerror=e=>{s(`node ws ${t} error`,{error:e}),n.error(e)},a.onclose=()=>{s(`node ws ${t} closed`),n.complete()},()=>{a.close()}}))}(e,(r=e,`tm.event='Tx' AND transfer.recipient='${r}'`),((t,e)=>this.cyblogCh.info(t,{unit:"node-ws",...e}))).pipe((0,yt.h)((t=>!(0,Se.isEmpty)(t))),(0,ft.U)((t=>({source:"node",transactions:De(e,t)}))));var r;return(0,bt.T)(n,a)}createInitObservable(){return(0,be.P)((()=>(0,ve.D)(this.initSync())))}async initSync(){const{myAddress:t}=this.params,{signal:e}=this.abortController,s=await this.db.getSyncStatus(t,t),n=await this.syncTransactions(t,t,s);this.statusApi.sendStatus("in-progress","sync my chats");const a=await is(this.db,t,s.timestampUpdate,e);return this.channelApi.postSenseUpdate(a),this.statusApi.sendStatus("active"),n}async onUpdate({source:t,transactions:e},s){const{myAddress:n}=s,{signal:a}=this.abortController;if(0===e.length)return void this.cyblogCh.info(`>>> ${this.name} ${n} recived 0 updates `);const r=await this.db.getSyncStatus(n,n);await this.processBatchTransactions(n,n,e,r,t),this.statusApi.sendStatus("in-progress","sync my chats");const i=await is(this.db,n,r.timestampUpdate,a,"node"!==t);this.channelApi.postSenseUpdate(i),this.statusApi.sendStatus("listen")}async processBatchTransactions(t,e,s,{timestampRead:n,unreadCount:a,timestampUpdate:r},i){const{signal:o}=this.abortController,c="node"!==i;this.cyblogCh.info("--------syncTransactions batch ",{data:[t,e,s.length,s.at(0)?.timestamp,s.at(-1)?.timestamp,i]}),await _e(this.db.putTransactions,o)(s),this.syncLinks(s,o);const{hash:u,index:d,timestamp:l}=s.at(-1),p=l,h={ownerId:t,entryType:Rt.transactions,id:e,timestampUpdate:c?p:r,unreadCount:a+s.length,timestampRead:n||0,disabled:!1,meta:{transactionHash:u,index:d}};return await _e(this.db.putSyncStatus,o)(h),p}async syncTransactions(t,e,s){const{unreadCount:n,timestampUpdate:a}=s,r=a+1;this.statusApi.sendStatus("estimating");const i=await(async(t,e,s)=>{const n=await We(s).request(as,{address:`{${t}}`,timestamp:Ce(e)});return n?.messages_by_address_aggregate.aggregate.count})(e,r,this.abortController.signal);if(this.cyblogCh.info(`>>> syncTransactions - start ${e},  count: ${i}, from: ${r}`),0===i)return r;this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.start(Math.ceil(i/500)));const o=(({neuron:t,timestampFrom:e,types:s,orderDirection:n,limit:a,abortSignal:r})=>Fe(ns,{neuron:t,timestampFrom:e,types:s,orderDirection:n,limit:a,abortSignal:r}))({neuron:e,timestampFrom:r,types:[],orderDirection:"asc",limit:500,abortSignal:this.abortController?.signal});let c=0,u=r;for await(const a of o){this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.trackProgress(1)),c+=a.length;const r=a.map((t=>ke(e,t)));u=await this.processBatchTransactions(t,e,r,{...s,unreadCount:n+c},"indexer")}return u}async syncLinks(t,e){const{tweets:s,particlesFound:n,links:a}=function(t){const e=t.filter((t=>"cyber.graph.v1beta1.MsgCyberlink"===t.type)),s=new Set,n=[];return{tweets:e.reduce(((t,{value:e,hash:a,timestamp:r})=>(e.links.forEach((i=>{s.add(i.to),s.add(i.from);const o={...i,timestamp:r,neuron:e.neuron,transactionHash:a};n.push(o),i.from===pe&&(t[o.to]=o)})),t)),{}),particlesFound:[...s],links:n}}(t);a.length>0&&await le(a,(t=>_e(this.db.putCyberlinks,e)(t)),500);const r=Object.keys(s),i=n.filter((t=>!r.includes(t)));await this.particlesResolver.enqueueBatch(r,Kt.HIGH),i.length>0&&await this.particlesResolver.enqueueBatch(i,Kt.LOW)}};const gs=t=>t.replace(/([-_][a-z])/g,(t=>t.toUpperCase().replace("-","").replace("_","")));function fs(t){if(!t||"object"!=typeof t)return t;const e={};return Object.keys(t).forEach((s=>{if(Object.prototype.hasOwnProperty.call(t,s)){const n=gs(s);let a=t[s];Array.isArray(t[s])?a=t[s].map((t=>fs(t))):"object"==typeof t[s]&&(a=fs(t[s])),e[n]=a}})),e}function ws(t,e,s=0,n=0){const a=t.filter((t=>t.timestamp>s)),r=(0,Se.findLastIndex)(a,(t=>t.neuron===e)),i=r<0?n+a.length:a.length-r-1;return{timestampRead:r<0?s:t[r].timestamp,unreadCount:i}}function bs(t,e,s,n=!0){const{timestampRead:a,unreadCount:r}=ws(e,s,t.timestampRead,t.unreadCount),i=fs(e[e.length-1]),o=i.timestamp;return{...t,ownerId:s,entryType:Rt.particle,disabled:!1,unreadCount:r,meta:{...i,timestamp:o},timestampRead:a,timestampUpdate:n?o:t.timestampUpdate}}const vs=t=>t instanceof DOMException&&"AbortError"===t.name;var Ss=s(66584),$s=s(16899),xs=s(96371),Cs=s(25108);var As=class extends ls{constructor(t,e,s,n,{warmupMs:a}={warmupMs:0}){super(t,s,n);const{loop$:r,restartLoop:i}=((t,e,s={})=>{const{intervalMs:n,warmupMs:a=0,onStartInterval:r,onError:i,retryDelayMs:o=0,onChange:c}=s,u=new te.x,d=u.pipe((0,os.O)(null),(0,cs.w)((()=>(0,mt.F)(n).pipe((0,os.O)(0),(0,Ss.g)(a)))));return{loop$:ps(t,d.pipe((0,ce.b)((()=>r&&r())),(0,$s.z)((()=>e.pipe((0,xs.X)({delay:t=>(Cs.log("retry",t),i&&i(t),(0,mt.F)(o))}))))),(t=>c?.(t))),restartLoop:()=>{u.next()}}})(this.isInitialized$,(0,be.P)((()=>(0,ve.D)(this.doSync()))),{intervalMs:e,warmupMs:a,onError:e=>{this.cyblogCh.info(`>>> ${t} error`,e.toString()),this.statusApi.sendStatus("error",e.toString())},onChange:e=>{this.cyblogCh.info(`>>> ${t} initialized: ${e}`),this.statusApi.sendStatus(e?"initialized":"inactive")}});this.loop$=r,this.restartLoop=i}restart(){this.abortController?.abort(),this.restartLoop?.(),this.cyblogCh.info(`>>> ${this.name} loop restart`)}start(){return this.loop$.subscribe((()=>this.statusApi.sendStatus("active"))),this}async doSync(){const t=(0,At.d9v)(this.params);this.initAbortController();try{await this.sync(t)}catch(e){const s=vs(e);if(this.cyblogCh.info(`>>> ${this.name} ${t.myAddress} sync error [abrt:${s}]:`,{error:e}),!s)throw e}}};var ks=class extends As{createIsInitializedObserver(t){return(0,oe.a)([t.dbInstance$,t.ipfsInstance$,t.params$.pipe((0,ft.U)((t=>t.myAddress)),(0,we.x)()),this.particlesResolver.isInitialized$]).pipe((0,ft.U)((([t,e,s,n])=>!!(e&&t&&n&&s))))}async sync(t){const{myAddress:e}=t,{signal:s}=this.abortController;this.statusApi.sendStatus("estimating");const n=await this.db.findSyncStatus({ownerId:e,entryType:Rt.particle}),a=n.at(0)?.timestampUpdate||0,r=await(async(t,e,s,n)=>{const a=await We(n).request(Ve,{address:t,particles_from:e,timestamp:Ce(s)});return a?.cyberlinks_aggregate.aggregate.count})(e,[pe],a,s);if(this.cyblogCh.info(`>>> syncMyParticles ${e} count ${r}`),this.progressTracker.start(r+n.length),this.statusApi.sendStatus("in-progress","preparing...",this.progressTracker.progress),r>0){const t=await this.fetchNewTweets(e,a,s);n.push(...t)}await this.syncParticles(e,n,s)}async fetchNewTweets(t,e,s){const n=await Xe(t,[pe],e,200,this.abortController?.signal),a=[],r=await this.db.findSyncStatus({ownerId:t,entryType:Rt.particle}),i=new Map(r.map((t=>[t.id,t])));for await(const e of n){this.statusApi.sendStatus("in-progress","fetching new tweets...",this.progressTracker.trackProgress(1));const n=e.map(fs).map((e=>{const{timestamp:s,to:n}=e,a=Ae(s),r=i.get(n)?Ae(s):0;return{ownerId:t,id:n,entryType:Rt.particle,timestampUpdate:r,timestampRead:a,unreadCount:0,disabled:!1,meta:{...e,timestamp:a}}}));n.length>0&&(await _e(this.db.putSyncStatus,s)(n),a.push(...n))}return a}async syncParticles(t,e,s){const n=[];for(const a of e){const{id:e,timestampUpdate:r}=a;this.statusApi.sendStatus("in-progress","fetching tweet updates...",this.progressTracker.trackProgress(1));const i=await ts(e,r,this.particlesResolver,Kt.MEDIUM,this.abortController?.signal);if(i.length>0){const e=i.map(Te);await le(e,(t=>_e(this.db.putCyberlinks,s)(t)),500);const r=bs(a,e,t);n.push(r)}}n.length>0&&await _e(this.db.putSyncStatus,s)(n),this.channelApi.postSenseUpdate(n)}};var Ts=class extends As{constructor(t,e,s,n,{warmupMs:a}={warmupMs:0}){if(!s.followings$)throw new Error("followings$ is required");super(t,e,s,n,{warmupMs:a}),this.followings=[]}createIsInitializedObserver(t){const e=new ht.X(!1);t.params$?.pipe((0,ft.U)((t=>t.myAddress)),(0,we.x)()).subscribe((()=>{e.next(!1)})),t.followings$.subscribe((t=>{this.followings=t,e.next(!0),this.restart()}));return(0,oe.a)([t.dbInstance$,t.params$,this.particlesResolver.isInitialized$,e]).pipe((0,ft.U)((([t,e,s,n])=>!!t&&!!e.myAddress&&!!s&&n)))}async sync(t){const{signal:e}=this.abortController;this.statusApi.sendStatus("in-progress","preparing...");const{myAddress:s}=t,{followings:n}=this;this.statusApi.sendStatus("estimating"),this.cyblogCh.info(`>>> syncMyFriends ${s} count ${n.length}`,{unit:"friends-sync",data:n}),this.progressTracker.start(n.length),this.statusApi.sendStatus("in-progress","sync...",this.progressTracker.progress);for(const t of n)await this.syncLinks(s,t,e)}async syncLinks(t,e,s){let n=[];try{this.statusApi.sendStatus("in-progress",`starting sync ${e}...`,this.progressTracker.progress);const{timestampRead:a,unreadCount:r,meta:i}=await this.db.getSyncStatus(t,e),{timestampUpdateChat:o=0,timestampUpdateContent:c=0}=i||{},u=c+1,d=await Xe(e,ye,u,200,s);for await(const i of d){this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.trackProgress(1));const c=i.map(Te),{timestampRead:u,unreadCount:d}=ws(c,t,a,r);if(c.length>0){const a=fs(c.at(-1)),r=a.timestamp;await _e(this.db.putCyberlinks,s)(c);const i=c.map((t=>t.to));await this.particlesResolver.enqueueBatch(i,Kt.HIGH);const l={ownerId:t,entryType:Rt.chat,id:e,timestampUpdate:Math.max(r,o),unreadCount:d,timestampRead:u,disabled:!1,meta:{...a,timestampUpdateContent:r,timestampUpdateChat:o}};await _e(this.db.putSyncStatus,s)(l),n.push(l)}}}catch(t){if(this.cyblogCh.error(`>>> SyncMyFriends ${e} error`,{error:t}),vs(t))throw n=[],t;this.statusApi.sendStatus("error",t.toString())}finally{this.channelApi.postSenseUpdate(n)}}},_s=s(89862),Is=s.n(_s),Ps=s(6581),qs=s(23085).lW;const Ms=t=>new Promise(((e,s)=>{const n=new(Is())("file",qs.from(t)).marshal();Ps.DAGNode.create(n,((t,n)=>{t&&s(new Error("Cannot create ipfs DAGNode")),Ps.util.cid(n,((t,s)=>{e(s.toBaseEncodedString())}))}))}));var Rs=s(52861);s(25108);const zs=(0,us.B)({thread:"bckd",unit:"fetchStoredSyncCommunity"}),Es=(t,e,s,n)=>new kt.y((a=>{a.next({action:"reset",items:[]}),(async()=>{const r=await t.getCommunity(e);a.next({action:"add",items:r});const i=new Map(r.map((t=>[t.particle,t]))),o=t=>i.get(t)||{ownerId:e,name:"",following:!1,follower:!1},c=await(async(t,e)=>{const s=await(0,Rs.Z)({method:"get",url:`${Pe}/txs?cyberlink.neuron=${t}&cyberlink.particleFrom=${he}&limit=1000000000`,signal:e});return s.data.txs?s.data.txs.map((t=>t.tx.value.msg[0].value.links[0].to)):[]})(e,n),u=await(async(t,e)=>{const s=await Ms(t),n=await(0,Rs.Z)({method:"get",url:`${Pe}/txs?cyberlink.particleFrom=${he}&cyberlink.particleTo=${s}&limit=1000000000`,signal:e});return n.data.txs?n.data.txs.map((t=>t.tx.value.msg[0].value.neuron)):[]})(e,n),d=c.filter((t=>!r.some((e=>e.particle===t&&e.following)))),l=u.filter((t=>!r.some((e=>e.neuron===t&&e.follower))));zs.info(`>>>$ sync community ${e} processing, stored ${r.length} new followers: ${d.length} new following: ${l.length}`);const p=await Promise.all(l.map((async e=>{const s=await Ms(e),n={...o(s),particle:s,neuron:e,follower:!0};return await t.putCommunity(n),i.set(s,n),n})));a.next({action:"add",items:p}),await Promise.all(d.map((async e=>{const n=(await s(e,Kt.URGENT))?.result?.textPreview;if(n&&n.match(me)){const s={...o(e),neuron:n,particle:e,following:!0};await t.putCommunity(s),i.set(e,s),a.next({action:"add",items:[s]})}}))),zs.info(`>>>$ sync community ${e}, done`),a.next({action:"complete",items:[]}),a.complete()})().catch((t=>{zs.error(`>>>$ sync community ${e}, error`,{error:t}),a.error(t)}))}));const Us=(0,us.B)({thread:"bckd"});class Os{constructor(t){this.channelApi=new Zt,this.loops={};const{dbInstance$:e,ipfsInstance$:s}=t;this.isInitialized$=(0,oe.a)([e,s]).pipe((0,ft.U)((([t,e])=>!!t&&!!e))),this.isInitialized$.subscribe({next:t=>t&&this.channelApi.postServiceStatus("sync","started"),error:t=>this.channelApi.postServiceStatus("sync","error",t)});const n=new fe(t).start(),a=function(t){const{dbInstance$:e,ipfsInstance$:s,params$:n}=t,a=new Zt;return(0,oe.a)([e,n.pipe((0,ft.U)((t=>t.myAddress)),(0,we.x)()),s]).pipe((0,yt.h)((([t,e,s])=>!!t&&!!s&&!!e)),(0,cs.w)((([e,s,n])=>{const{waitForParticleResolve:r}=t;let i=[];return new kt.y((t=>{t.next([]),Es(e,s,r).subscribe((({action:e,items:s})=>{a.post({type:"load_community",value:{action:e,items:s}}),"reset"===e?i=[]:["add","complete"].some((t=>t===e))&&i.push(...s),"complete"===e&&(t.next(i),t.complete())}))}))})))}(t);a.subscribe((t=>{Us.info("--\x3e community fetched",{unit:"community",data:t})}));const r=a.pipe((0,ft.U)((t=>t.filter((t=>t.following)))),(0,ft.U)((t=>t.map((t=>t.neuron)))));new ys("transactions",t,n).start(),new ks("particles",3e5,t,n).start(),new Ts("my-friends",3e5,{...t,followings$:r},n).start()}restart(t){this.loops[t]?.restart()}}var Ds=s(44586),Ls=s(93994).Z,Fs=s(25108);var Ns=class{constructor(t){this.queue$=new ht.X(new Map),t.subscribe((t=>{this.dbApi=t})),t.pipe((0,yt.h)((t=>!!t)),(0,ce.b)((()=>Ls.info("DeferredDbSaver - initialized"))),(0,wt.z)((()=>this.queue$)),(0,yt.h)((t=>t.size>0)),(0,wt.z)((t=>(0,be.P)((()=>(0,ve.D)(this.processQueue(t))))))).subscribe({error:t=>Fs.error("Error processing IPFS queue",t)})}get queue(){return this.queue$.getValue()}enqueueIpfsContent(t){if(!t)return;const{cid:e}=t;this.queue$.next(new Map(this.queue$.value).set(e,{content:t}))}enqueueLinks(t){if(!t||!t.length)return;const e=(0,Ds.Z)();this.queue$.next(new Map(this.queue$.value).set(e,{links:t}))}async processQueue(t){this.queue$.next(new Map);for(const[e,s]of t)await this.processQueueItem(s),t.delete(e)}async processQueueItem(t){const{content:e,links:s}=t;if(e){const t=(t=>{const{cid:e,result:s,meta:n,textPreview:a}=t,{size:r,mime:i,type:o,blocks:c,sizeLocal:u}=n;return{cid:e,size:r||0,mime:i||"unknown",type:o,text:a?.replace(/"/g,"'")||"",size_local:u||-1,blocks:c||0}})(e);await this.dbApi.putParticles(t)}s&&s.length>0&&await this.dbApi.putCyberlinks(s)}},Qs=s(25108);const Bs=(()=>{const t=new te.x,e=new ht.X(void 0),s=new ht.X({myAddress:null});let a;const r=new Ns(t),i=new Xt(e,{defferedDbSaver:r}),o=new Zt,c=new Os({waitForParticleResolve:async(t,e=Kt.MEDIUM)=>i.enqueueAndWait(t,{postProcessing:!0,priority:e}),dbInstance$:t,ipfsInstance$:e,params$:s}),u={importCyberlinks:t=>{r.enqueueLinks(t)}},d={start:async t=>{try{return a&&(Qs.log("Ipfs node already started!"),await a.stop()),o.postServiceStatus("ipfs","starting"),a=await pt(t),e.next(a),setTimeout((()=>o.postServiceStatus("ipfs","started")),0),!0}catch(t){Qs.log("----ipfs node init error ",t);const e=t instanceof Error?t.message:t;throw o.postServiceStatus("ipfs","error",e),Error(e)}},stop:async()=>{a&&await a.stop(),e.next(void 0),o.postServiceStatus("ipfs","inactive")},getIpfsNode:async()=>a&&(0,n.sj)(a),config:async()=>a?.config,info:async()=>a?.info(),fetchWithDetails:async(t,e)=>a?.fetchWithDetails(t,e),enqueue:async(t,e,s)=>i.enqueue(t,e,s),enqueueAndWait:async(t,e)=>i.enqueueAndWait(t,e),dequeue:async t=>i.cancel(t),dequeueByParent:async t=>i.cancelByParent(t),clearQueue:async()=>i.clear(),addContent:async t=>a?.addContent(t)};return{init:async e=>{t.next(e)},isInitialized:()=>!!e.value,ipfsApi:(0,n.sj)(d),defferedDbApi:(0,n.sj)(u),ipfsQueue:(0,n.sj)(i),restartSync:t=>c.restart(t),setParams:t=>s.next({...s.value,...t})}})();var js,Hs;js=self,Hs=Bs,re(),void 0!==js.onconnect?js.onconnect=t=>{const e=t.ports[0];ie(e),(0,n.Jj)(Hs,e)}:(0,n.Jj)(Hs)},96407:function(t,e,s){"use strict";s.d(e,{bG:function(){return n}});const n="CYBLOG_BROADCST_CHANNEL"},93994:function(t,e,s){"use strict";s.d(e,{B:function(){return c}});var n=s(96486),a=s.n(n),r=s(96407),i=s(25108);const o=[];const c=(t={})=>{const e=new BroadcastChannel(r.bG);function s(s,n,a){const r={...t,...a};a?.error&&(r.error=JSON.stringify(a.error)),e.postMessage({type:"log",value:{level:s,message:n,context:r}})}return{info:function(t,e){return s("info",t,e)},error:function(t,e){return s("error",t,e)},warn:function(t,e){return s("warn",t,e)},trace:function(t,e){return s("warn",t,e)}}},u=function(t={}){let e={};function s(s,r,c=t){try{const t=c?.formatter?c?.formatter(r):r;!function(t,e=!0){for(o.push(t);e&&o.length>1e3;)o.shift()}({timestamp:new Date,level:s,message:t,stacktrace:c?.stacktrace,context:a().omit(c,["formatter","stacktrace"])});Object.keys(e).reduce(((t,s)=>{const n=e[s],a=c[s];return n&&a?t||"all"===n||0===n.length||n.some((t=>t===a)):t}),!1)&&function(t,e,s){const r=a().omit(s,["formatter","thread","module","unit","data"]),{thread:o="",module:c="",unit:u="",data:d=""}=s,l=(0,n.isEmpty)(r)?"":r;Array.isArray(e)?i[t](...e,l):s?.formatter?i[t](s?.formatter(e),l):i[t](`[${o}:${c}:${u}] ${e}`,d,l)}(s,r,c)}catch(t){i.log("cyblog error",t)}}return new BroadcastChannel(r.bG).onmessage=t=>{"params"===t.data.type&&(e={...e,...t.data.value})},{log:s,info:function(t,e){return s("info",t,e)},error:function(t,e){return s("error",t,e)},warn:function(t,e){return s("warn",t,e)},trace:function(t,e){return s("warn",t,e)},logList:o,getLogs:()=>o.map((t=>{const{context:e,...s}=t,{unit:n="",module:a="",thread:r="",data:i="",error:o="",stacktrace:c=""}=e||{};return{...s,unit:n,module:a,thread:r,data:i,error:o,stacktrace:c}})),clear:()=>o.splice(0,o.length),getConsoleLogParams:()=>e}}({thread:"main"});e.Z=u},67064:function(){},81949:function(){},95856:function(){},35883:function(){},66778:function(){},10465:function(){},52596:function(){},63897:function(){},85104:function(){},83886:function(){},52:function(){},25819:function(){},81265:function(){},35539:function(){},99283:function(){},43838:function(){}},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var s=r[t]={id:t,loaded:!1,exports:{}};return a[t].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=a,i.x=function(){var t=i.O(void 0,[912,393,698,724],(function(){return i(60427)}));return t=i.O(t)},i.amdO={},t=[],i.O=function(e,s,n,a){if(!s){var r=1/0;for(d=0;d<t.length;d++){s=t[d][0],n=t[d][1],a=t[d][2];for(var o=!0,c=0;c<s.length;c++)(!1&a||r>=a)&&Object.keys(i.O).every((function(t){return i.O[t](s[c])}))?s.splice(c--,1):(o=!1,a<r&&(r=a));if(o){t.splice(d--,1);var u=n();void 0!==u&&(e=u)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[s,n,a]},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},s=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},i.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var a=Object.create(null);i.r(a);var r={};e=e||[null,s({}),s([]),s(s)];for(var o=2&n&&t;"object"==typeof o&&!~e.indexOf(o);o=s(o))Object.getOwnPropertyNames(o).forEach((function(e){r[e]=function(){return t[e]}}));return r.default=function(){return t},i.d(a,r),a},i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.f={},i.e=function(t){return Promise.all(Object.keys(i.f).reduce((function(e,s){return i.f[s](t,e),e}),[]))},i.u=function(t){return t+"."+{393:"d8cfa458",698:"d0b17df8",724:"0892e360",827:"89ce62da",912:"ecb020b3"}[t]+".chunk.js"},i.miniCssF=function(t){},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},i.p="/",function(){var t={73:1};i.f.i=function(e,s){t[e]||importScripts(i.p+i.u(e))};var e=self.webpackChunkcyb=self.webpackChunkcyb||[],s=e.push.bind(e);e.push=function(e){var n=e[0],a=e[1],r=e[2];for(var o in a)i.o(a,o)&&(i.m[o]=a[o]);for(r&&r(i);n.length;)t[n.pop()]=1;s(e)}}(),n=i.x,i.x=function(){return Promise.all([912,393,698,724].map(i.e,i)).then(n)};i.x()}();
//# sourceMappingURL=73.80c059f2.chunk.js.map