/*! For license information please see 168.0ce26f6d.chunk.js.LICENSE.txt */
(self.webpackChunkcyb=self.webpackChunkcyb||[]).push([[168],{73650:function(e,t,r){"use strict";var n=r(96763);const i=-8,s=-4,o=0,a=1,c=1,u=2,l=5,h=1024,d=2048,f=8192,p=0,y=4,g=8,m=12,b=12,w=16,v="undefined"!=typeof BigUint64Array,_=Symbol(),E=1024;function S(e,t){const r=new Uint32Array(e),n=new Uint16Array(e);var i=r[t+s>>>2]>>>1,o=t>>>1;if(i<=E)return String.fromCharCode.apply(String,n.subarray(o,o+i));const a=[];do{const e=n[o+E-1],t=e>=55296&&e<56320?E-1:E;a.push(String.fromCharCode.apply(String,n.subarray(o,o+=t))),i-=t}while(i>E);return a.join("")+String.fromCharCode.apply(String,n.subarray(o,o+i))}function x(e){const t={};function r(e,t){return e?S(e.buffer,t):"<yet unknown>"}const i=e.env=e.env||{};return i.abort=i.abort||function(e,n,s,o){const a=t.memory||i.memory;throw Error("abort: "+r(a,e)+" at "+r(a,n)+":"+s+":"+o)},i.trace=i.trace||function(e,s){const o=t.memory||i.memory;n.log("trace: "+r(o,e)+(s?" ":"")+Array.prototype.slice.call(arguments,2,2+s).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function A(e,t){const r=t.exports,n=r.memory,_=r.table,E=r.__alloc,x=r.__retain,A=r.__rtti_base||-1;function k(e){const t=new Uint32Array(n.buffer);if((e>>>=0)>=t[A>>>2])throw Error("invalid id: "+e);return t[(A+4>>>2)+2*e]}function I(e){const t=new Uint32Array(n.buffer);if((e>>>=0)>=t[A>>>2])throw Error("invalid id: "+e);return t[(A+4>>>2)+2*e+1]}function T(e){return 31-Math.clz32(e>>>l&31)}function C(e,t,r){const i=n.buffer;if(r)switch(e){case 2:return new Float32Array(i);case 3:return new Float64Array(i)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(i);case 1:return new(t?Int16Array:Uint16Array)(i);case 2:return new(t?Int32Array:Uint32Array)(i);case 3:return new(t?BigInt64Array:BigUint64Array)(i)}throw Error("unsupported align: "+e)}function R(e){const t=new Uint32Array(n.buffer),r=t[e+i>>>2],o=k(r);if(!(o&c))throw Error("not an array: "+r);const a=T(o);var l=t[e+y>>>2];const f=o&u?t[e+b>>>2]:t[l+s>>>2]>>>a;return C(a,o&h,o&d).subarray(l>>>=a,l+f)}function O(e,t,r){return new e(D(e,t,r))}function D(e,t,r){const i=n.buffer,o=new Uint32Array(i),a=o[r+y>>>2];return new e(i,a,o[a+s>>>2]>>>t)}return e.__allocString=function(e){const t=e.length,r=E(t<<1,a),i=new Uint16Array(n.buffer);for(var s=0,o=r>>>1;s<t;++s)i[o+s]=e.charCodeAt(s);return r},e.__getString=function(e){const t=n.buffer;if(new Uint32Array(t)[e+i>>>2]!==a)throw Error("not a string: "+e);return S(t,e)},e.__allocArray=function(e,t){const r=k(e);if(!(r&(c|u)))throw Error("not an array: "+e+" @ "+r);const i=T(r),s=t.length,a=E(s<<i,o),l=E(r&u?w:m,e),v=new Uint32Array(n.buffer);v[l+p>>>2]=x(a),v[l+y>>>2]=a,v[l+g>>>2]=s<<i,r&u&&(v[l+b>>>2]=s);const _=C(i,r&h,r&d);if(r&f)for(let e=0;e<s;++e)_[(a>>>i)+e]=x(t[e]);else _.set(t,a>>>i);return l},e.__getArrayView=R,e.__getArray=function(e){const t=R(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=n.buffer,r=new Uint32Array(t)[e+s>>>2];return t.slice(e,e+r)},e.__getInt8Array=O.bind(null,Int8Array,0),e.__getInt8ArrayView=D.bind(null,Int8Array,0),e.__getUint8Array=O.bind(null,Uint8Array,0),e.__getUint8ArrayView=D.bind(null,Uint8Array,0),e.__getUint8ClampedArray=O.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=D.bind(null,Uint8ClampedArray,0),e.__getInt16Array=O.bind(null,Int16Array,1),e.__getInt16ArrayView=D.bind(null,Int16Array,1),e.__getUint16Array=O.bind(null,Uint16Array,1),e.__getUint16ArrayView=D.bind(null,Uint16Array,1),e.__getInt32Array=O.bind(null,Int32Array,2),e.__getInt32ArrayView=D.bind(null,Int32Array,2),e.__getUint32Array=O.bind(null,Uint32Array,2),e.__getUint32ArrayView=D.bind(null,Uint32Array,2),v&&(e.__getInt64Array=O.bind(null,BigInt64Array,3),e.__getInt64ArrayView=D.bind(null,BigInt64Array,3),e.__getUint64Array=O.bind(null,BigUint64Array,3),e.__getUint64ArrayView=D.bind(null,BigUint64Array,3)),e.__getFloat32Array=O.bind(null,Float32Array,2),e.__getFloat32ArrayView=D.bind(null,Float32Array,2),e.__getFloat64Array=O.bind(null,Float64Array,3),e.__getFloat64ArrayView=D.bind(null,Float64Array,3),e.__instanceof=function(e,t){const r=new Uint32Array(n.buffer);var s=r[e+i>>>2];if(s<=r[A>>>2])do{if(s==t)return!0}while(s=I(s));return!1},e.memory=e.memory||n,e.table=e.table||_,P(r,e)}function k(e){return"undefined"!=typeof Response&&e instanceof Response}async function I(e,t){return k(e=await e)?T(e,t):A(x(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}async function T(e,t){return WebAssembly.instantiateStreaming?A(x(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):I(k(e=await e)?e.arrayBuffer():e,t)}function P(e,t){var r=t?Object.create(t):{},n=e.__argumentsLength?function(t){e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||function(){};for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const i=e[t];let s=t.split("."),o=r;for(;s.length>1;){let e=s.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let a=s[0],c=a.indexOf("#");if(c>=0){let r=a.substring(0,c),s=o[r];if(void 0===s||!s.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[_]}},e.wrap=function(t){return Object.create(e.prototype,{[_]:{value:t,writable:!1}})},s&&Object.getOwnPropertyNames(s).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t)))),o[r]=e}if(a=a.substring(c+1),o=o[r].prototype,/^(get|set):/.test(a)){if(!Object.prototype.hasOwnProperty.call(o,a=a.substring(4))){let r=e[t.replace("set:","get:")],n=e[t.replace("get:","set:")];Object.defineProperty(o,a,{get:function(){return r(this[_])},set:function(e){n(this[_],e)},enumerable:!0})}}else"constructor"===a?(o[a]=(...e)=>(n(e.length),i(...e))).original=i:(o[a]=function(...e){return n(e.length),i(this[_],...e)}).original=i}else/^(get|set):/.test(a)?Object.prototype.hasOwnProperty.call(o,a=a.substring(4))||Object.defineProperty(o,a,{get:e[t.replace("set:","get:")],set:e[t.replace("get:","set:")],enumerable:!0}):"function"==typeof i&&i!==n?(o[a]=(...e)=>(n(e.length),i(...e))).original=i:o[a]=i}return r}t.instantiate=I,t.instantiateSync=function(e,t){return A(x(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))},t.instantiateStreaming=T,t.demangle=P},85590:function(e,t,r){"use strict";e.exports=r(51782)},51782:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(17413),n.BufferWriter=r(13790),n.Reader=r(68297),n.BufferReader=r(11010),n.util=r(39070),n.rpc=r(71203),n.roots=r(31269),n.configure=i,i()},68297:function(e,t,r){"use strict";e.exports=c;var n,i=r(39070),s=i.LongBits,o=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},h=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function d(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new s(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=h(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var n=i.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=h(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},11010:function(e,t,r){"use strict";e.exports=s;var n=r(68297);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(39070);function s(e){n.call(this,e)}s._configure=function(){i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},31269:function(e){"use strict";e.exports={}},71203:function(e,t,r){"use strict";t.Service=r(49591)},49591:function(e,t,r){"use strict";e.exports=i;var n=r(39070);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,i,s);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},5923:function(e,t,r){"use strict";e.exports=i;var n=r(39070);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?s:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},39070:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function s(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(18045),n.base64=r(8839),n.EventEmitter=r(24358),n.float=r(49410),n.inquire=r(84153),n.utf8=r(81447),n.pool=r(99390),n.LongBits=r(5923),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=s,n.ProtocolError=s("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},17413:function(e,t,r){"use strict";e.exports=h;var n,i=r(39070),s=i.LongBits,o=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=d(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(y,10,s.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=s.from(e);return this._push(y,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(y,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=s.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var m=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var r=h.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},13790:function(e,t,r){"use strict";e.exports=s;var n=r(17413);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(39070);function s(){n.call(this)}function o(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}s._configure=function(){s.alloc=i._Buffer_allocUnsafe,s.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},76005:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToPath=t.Slip10RawIndex=t.slip10CurveFromString=t.Slip10Curve=t.Slip10=t.pathToString=t.sha512=t.Sha512=t.sha256=t.Sha256=t.Secp256k1Signature=t.ExtendedSecp256k1Signature=t.Secp256k1=t.ripemd160=t.Ripemd160=t.Random=t.Xchacha20poly1305Ietf=t.xchacha20NonceLength=t.isArgon2idOptions=t.Ed25519Keypair=t.Ed25519=t.Argon2id=t.keccak256=t.Keccak256=t.Hmac=t.EnglishMnemonic=t.Bip39=void 0;var n=r(88178);Object.defineProperty(t,"Bip39",{enumerable:!0,get:function(){return n.Bip39}}),Object.defineProperty(t,"EnglishMnemonic",{enumerable:!0,get:function(){return n.EnglishMnemonic}});var i=r(48094);Object.defineProperty(t,"Hmac",{enumerable:!0,get:function(){return i.Hmac}});var s=r(71715);Object.defineProperty(t,"Keccak256",{enumerable:!0,get:function(){return s.Keccak256}}),Object.defineProperty(t,"keccak256",{enumerable:!0,get:function(){return s.keccak256}});var o=r(92297);Object.defineProperty(t,"Argon2id",{enumerable:!0,get:function(){return o.Argon2id}}),Object.defineProperty(t,"Ed25519",{enumerable:!0,get:function(){return o.Ed25519}}),Object.defineProperty(t,"Ed25519Keypair",{enumerable:!0,get:function(){return o.Ed25519Keypair}}),Object.defineProperty(t,"isArgon2idOptions",{enumerable:!0,get:function(){return o.isArgon2idOptions}}),Object.defineProperty(t,"xchacha20NonceLength",{enumerable:!0,get:function(){return o.xchacha20NonceLength}}),Object.defineProperty(t,"Xchacha20poly1305Ietf",{enumerable:!0,get:function(){return o.Xchacha20poly1305Ietf}});var a=r(33090);Object.defineProperty(t,"Random",{enumerable:!0,get:function(){return a.Random}});var c=r(57098);Object.defineProperty(t,"Ripemd160",{enumerable:!0,get:function(){return c.Ripemd160}}),Object.defineProperty(t,"ripemd160",{enumerable:!0,get:function(){return c.ripemd160}});var u=r(88993);Object.defineProperty(t,"Secp256k1",{enumerable:!0,get:function(){return u.Secp256k1}});var l=r(98707);Object.defineProperty(t,"ExtendedSecp256k1Signature",{enumerable:!0,get:function(){return l.ExtendedSecp256k1Signature}}),Object.defineProperty(t,"Secp256k1Signature",{enumerable:!0,get:function(){return l.Secp256k1Signature}});var h=r(4707);Object.defineProperty(t,"Sha256",{enumerable:!0,get:function(){return h.Sha256}}),Object.defineProperty(t,"sha256",{enumerable:!0,get:function(){return h.sha256}}),Object.defineProperty(t,"Sha512",{enumerable:!0,get:function(){return h.Sha512}}),Object.defineProperty(t,"sha512",{enumerable:!0,get:function(){return h.sha512}});var d=r(82098);Object.defineProperty(t,"pathToString",{enumerable:!0,get:function(){return d.pathToString}}),Object.defineProperty(t,"Slip10",{enumerable:!0,get:function(){return d.Slip10}}),Object.defineProperty(t,"Slip10Curve",{enumerable:!0,get:function(){return d.Slip10Curve}}),Object.defineProperty(t,"slip10CurveFromString",{enumerable:!0,get:function(){return d.slip10CurveFromString}}),Object.defineProperty(t,"Slip10RawIndex",{enumerable:!0,get:function(){return d.Slip10RawIndex}}),Object.defineProperty(t,"stringToPath",{enumerable:!0,get:function(){return d.stringToPath}})},44917:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=t.toRfc3339=t.fromRfc3339=t.toHex=t.fromHex=t.toBech32=t.normalizeBech32=t.fromBech32=t.toBase64=t.fromBase64=t.toAscii=t.fromAscii=void 0;var n=r(1718);Object.defineProperty(t,"fromAscii",{enumerable:!0,get:function(){return n.fromAscii}}),Object.defineProperty(t,"toAscii",{enumerable:!0,get:function(){return n.toAscii}});var i=r(18594);Object.defineProperty(t,"fromBase64",{enumerable:!0,get:function(){return i.fromBase64}}),Object.defineProperty(t,"toBase64",{enumerable:!0,get:function(){return i.toBase64}});var s=r(50714);Object.defineProperty(t,"fromBech32",{enumerable:!0,get:function(){return s.fromBech32}}),Object.defineProperty(t,"normalizeBech32",{enumerable:!0,get:function(){return s.normalizeBech32}}),Object.defineProperty(t,"toBech32",{enumerable:!0,get:function(){return s.toBech32}});var o=r(71028);Object.defineProperty(t,"fromHex",{enumerable:!0,get:function(){return o.fromHex}}),Object.defineProperty(t,"toHex",{enumerable:!0,get:function(){return o.toHex}});var a=r(71466);Object.defineProperty(t,"fromRfc3339",{enumerable:!0,get:function(){return a.fromRfc3339}}),Object.defineProperty(t,"toRfc3339",{enumerable:!0,get:function(){return a.toRfc3339}});var c=r(7290);Object.defineProperty(t,"fromUtf8",{enumerable:!0,get:function(){return c.fromUtf8}}),Object.defineProperty(t,"toUtf8",{enumerable:!0,get:function(){return c.toUtf8}})},51298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uint64=t.Uint53=t.Uint32=t.Int53=t.Decimal=void 0;var n=r(75173);Object.defineProperty(t,"Decimal",{enumerable:!0,get:function(){return n.Decimal}});var i=r(80887);Object.defineProperty(t,"Int53",{enumerable:!0,get:function(){return i.Int53}}),Object.defineProperty(t,"Uint32",{enumerable:!0,get:function(){return i.Uint32}}),Object.defineProperty(t,"Uint53",{enumerable:!0,get:function(){return i.Uint53}}),Object.defineProperty(t,"Uint64",{enumerable:!0,get:function(){return i.Uint64}})},5450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCoins=t.coins=t.coin=t.executeKdf=t.makeSignDoc=t.makeSignBytes=t.makeAuthInfoBytes=t.isOfflineDirectSigner=t.Registry=t.isTxBodyEncodeObject=t.isTsProtoGeneratedType=t.isPbjsGeneratedType=t.encodePubkey=t.decodePubkey=t.decodeOptionalPubkey=t.anyToSinglePubkey=t.makeCosmoshubPath=t.DirectSecp256k1Wallet=t.extractKdfConfiguration=t.DirectSecp256k1HdWallet=t.decodeTxRaw=void 0;var n=r(53142);Object.defineProperty(t,"decodeTxRaw",{enumerable:!0,get:function(){return n.decodeTxRaw}});var i=r(19124);Object.defineProperty(t,"DirectSecp256k1HdWallet",{enumerable:!0,get:function(){return i.DirectSecp256k1HdWallet}}),Object.defineProperty(t,"extractKdfConfiguration",{enumerable:!0,get:function(){return i.extractKdfConfiguration}});var s=r(97568);Object.defineProperty(t,"DirectSecp256k1Wallet",{enumerable:!0,get:function(){return s.DirectSecp256k1Wallet}});var o=r(69550);Object.defineProperty(t,"makeCosmoshubPath",{enumerable:!0,get:function(){return o.makeCosmoshubPath}});var a=r(39866);Object.defineProperty(t,"anyToSinglePubkey",{enumerable:!0,get:function(){return a.anyToSinglePubkey}}),Object.defineProperty(t,"decodeOptionalPubkey",{enumerable:!0,get:function(){return a.decodeOptionalPubkey}}),Object.defineProperty(t,"decodePubkey",{enumerable:!0,get:function(){return a.decodePubkey}}),Object.defineProperty(t,"encodePubkey",{enumerable:!0,get:function(){return a.encodePubkey}});var c=r(40267);Object.defineProperty(t,"isPbjsGeneratedType",{enumerable:!0,get:function(){return c.isPbjsGeneratedType}}),Object.defineProperty(t,"isTsProtoGeneratedType",{enumerable:!0,get:function(){return c.isTsProtoGeneratedType}}),Object.defineProperty(t,"isTxBodyEncodeObject",{enumerable:!0,get:function(){return c.isTxBodyEncodeObject}}),Object.defineProperty(t,"Registry",{enumerable:!0,get:function(){return c.Registry}});var u=r(7986);Object.defineProperty(t,"isOfflineDirectSigner",{enumerable:!0,get:function(){return u.isOfflineDirectSigner}});var l=r(62501);Object.defineProperty(t,"makeAuthInfoBytes",{enumerable:!0,get:function(){return l.makeAuthInfoBytes}}),Object.defineProperty(t,"makeSignBytes",{enumerable:!0,get:function(){return l.makeSignBytes}}),Object.defineProperty(t,"makeSignDoc",{enumerable:!0,get:function(){return l.makeSignDoc}});var h=r(48913);Object.defineProperty(t,"executeKdf",{enumerable:!0,get:function(){return h.executeKdf}});var d=r(78824);Object.defineProperty(t,"coin",{enumerable:!0,get:function(){return d.coin}}),Object.defineProperty(t,"coins",{enumerable:!0,get:function(){return d.coins}}),Object.defineProperty(t,"parseCoins",{enumerable:!0,get:function(){return d.parseCoins}})},84007:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isMsgVoteWeightedEncodeObject=t.isMsgVoteEncodeObject=t.isMsgUndelegateEncodeObject=t.isMsgTransferEncodeObject=t.isMsgSubmitProposalEncodeObject=t.isMsgSendEncodeObject=t.isMsgEditValidatorEncodeObject=t.isMsgDepositEncodeObject=t.isMsgDelegateEncodeObject=t.isMsgCreateValidatorEncodeObject=t.isMsgCancelUnbondingDelegationEncodeObject=t.isMsgBeginRedelegateEncodeObject=t.isAminoMsgWithdrawValidatorCommission=t.isAminoMsgWithdrawDelegatorReward=t.isAminoMsgVoteWeighted=t.isAminoMsgVote=t.isAminoMsgVerifyInvariant=t.isAminoMsgUnjail=t.isAminoMsgUndelegate=t.isAminoMsgTransfer=t.isAminoMsgSubmitProposal=t.isAminoMsgSubmitEvidence=t.isAminoMsgSetWithdrawAddress=t.isAminoMsgSend=t.isAminoMsgMultiSend=t.isAminoMsgFundCommunityPool=t.isAminoMsgEditValidator=t.isAminoMsgDeposit=t.isAminoMsgDelegate=t.isAminoMsgCreateVestingAccount=t.isAminoMsgCreateValidator=t.isAminoMsgBeginRedelegate=t.createVestingAminoConverters=t.createStakingAminoConverters=t.createSlashingAminoConverters=t.createIbcAminoConverters=t.createGroupAminoConverters=t.createGovAminoConverters=t.createFeegrantAminoConverters=t.createEvidenceAminoConverters=t.createDistributionAminoConverters=t.createCrysisAminoConverters=t.createBankAminoConverters=t.createAuthzAminoConverters=t.logs=t.GasPrice=t.calculateFee=t.fromTendermintEvent=t.AminoTypes=t.accountFromAny=void 0,t.parseCoins=t.makeCosmoshubPath=t.coins=t.coin=t.TimeoutError=t.StargateClient=t.isDeliverTxSuccess=t.isDeliverTxFailure=t.BroadcastTxError=t.assertIsDeliverTxSuccess=t.assertIsDeliverTxFailure=t.SigningStargateClient=t.defaultRegistryTypes=t.createDefaultAminoConverters=t.isSearchTxQueryArray=t.QueryClient=t.decodeCosmosSdkDecFromProto=t.createProtobufRpcClient=t.createPagination=t.makeMultisignedTxBytes=t.makeMultisignedTx=t.setupTxExtension=t.setupStakingExtension=t.setupSlashingExtension=t.setupMintExtension=t.setupIbcExtension=t.setupGovExtension=t.setupFeegrantExtension=t.setupDistributionExtension=t.setupBankExtension=t.setupAuthzExtension=t.setupAuthExtension=t.isMsgWithdrawDelegatorRewardEncodeObject=void 0;var o=r(78543);Object.defineProperty(t,"accountFromAny",{enumerable:!0,get:function(){return o.accountFromAny}});var a=r(55304);Object.defineProperty(t,"AminoTypes",{enumerable:!0,get:function(){return a.AminoTypes}});var c=r(96238);Object.defineProperty(t,"fromTendermintEvent",{enumerable:!0,get:function(){return c.fromTendermintEvent}});var u=r(30163);Object.defineProperty(t,"calculateFee",{enumerable:!0,get:function(){return u.calculateFee}}),Object.defineProperty(t,"GasPrice",{enumerable:!0,get:function(){return u.GasPrice}}),t.logs=s(r(60540));var l=r(8557);Object.defineProperty(t,"createAuthzAminoConverters",{enumerable:!0,get:function(){return l.createAuthzAminoConverters}}),Object.defineProperty(t,"createBankAminoConverters",{enumerable:!0,get:function(){return l.createBankAminoConverters}}),Object.defineProperty(t,"createCrysisAminoConverters",{enumerable:!0,get:function(){return l.createCrysisAminoConverters}}),Object.defineProperty(t,"createDistributionAminoConverters",{enumerable:!0,get:function(){return l.createDistributionAminoConverters}}),Object.defineProperty(t,"createEvidenceAminoConverters",{enumerable:!0,get:function(){return l.createEvidenceAminoConverters}}),Object.defineProperty(t,"createFeegrantAminoConverters",{enumerable:!0,get:function(){return l.createFeegrantAminoConverters}}),Object.defineProperty(t,"createGovAminoConverters",{enumerable:!0,get:function(){return l.createGovAminoConverters}}),Object.defineProperty(t,"createGroupAminoConverters",{enumerable:!0,get:function(){return l.createGroupAminoConverters}}),Object.defineProperty(t,"createIbcAminoConverters",{enumerable:!0,get:function(){return l.createIbcAminoConverters}}),Object.defineProperty(t,"createSlashingAminoConverters",{enumerable:!0,get:function(){return l.createSlashingAminoConverters}}),Object.defineProperty(t,"createStakingAminoConverters",{enumerable:!0,get:function(){return l.createStakingAminoConverters}}),Object.defineProperty(t,"createVestingAminoConverters",{enumerable:!0,get:function(){return l.createVestingAminoConverters}}),Object.defineProperty(t,"isAminoMsgBeginRedelegate",{enumerable:!0,get:function(){return l.isAminoMsgBeginRedelegate}}),Object.defineProperty(t,"isAminoMsgCreateValidator",{enumerable:!0,get:function(){return l.isAminoMsgCreateValidator}}),Object.defineProperty(t,"isAminoMsgCreateVestingAccount",{enumerable:!0,get:function(){return l.isAminoMsgCreateVestingAccount}}),Object.defineProperty(t,"isAminoMsgDelegate",{enumerable:!0,get:function(){return l.isAminoMsgDelegate}}),Object.defineProperty(t,"isAminoMsgDeposit",{enumerable:!0,get:function(){return l.isAminoMsgDeposit}}),Object.defineProperty(t,"isAminoMsgEditValidator",{enumerable:!0,get:function(){return l.isAminoMsgEditValidator}}),Object.defineProperty(t,"isAminoMsgFundCommunityPool",{enumerable:!0,get:function(){return l.isAminoMsgFundCommunityPool}}),Object.defineProperty(t,"isAminoMsgMultiSend",{enumerable:!0,get:function(){return l.isAminoMsgMultiSend}}),Object.defineProperty(t,"isAminoMsgSend",{enumerable:!0,get:function(){return l.isAminoMsgSend}}),Object.defineProperty(t,"isAminoMsgSetWithdrawAddress",{enumerable:!0,get:function(){return l.isAminoMsgSetWithdrawAddress}}),Object.defineProperty(t,"isAminoMsgSubmitEvidence",{enumerable:!0,get:function(){return l.isAminoMsgSubmitEvidence}}),Object.defineProperty(t,"isAminoMsgSubmitProposal",{enumerable:!0,get:function(){return l.isAminoMsgSubmitProposal}}),Object.defineProperty(t,"isAminoMsgTransfer",{enumerable:!0,get:function(){return l.isAminoMsgTransfer}}),Object.defineProperty(t,"isAminoMsgUndelegate",{enumerable:!0,get:function(){return l.isAminoMsgUndelegate}}),Object.defineProperty(t,"isAminoMsgUnjail",{enumerable:!0,get:function(){return l.isAminoMsgUnjail}}),Object.defineProperty(t,"isAminoMsgVerifyInvariant",{enumerable:!0,get:function(){return l.isAminoMsgVerifyInvariant}}),Object.defineProperty(t,"isAminoMsgVote",{enumerable:!0,get:function(){return l.isAminoMsgVote}}),Object.defineProperty(t,"isAminoMsgVoteWeighted",{enumerable:!0,get:function(){return l.isAminoMsgVoteWeighted}}),Object.defineProperty(t,"isAminoMsgWithdrawDelegatorReward",{enumerable:!0,get:function(){return l.isAminoMsgWithdrawDelegatorReward}}),Object.defineProperty(t,"isAminoMsgWithdrawValidatorCommission",{enumerable:!0,get:function(){return l.isAminoMsgWithdrawValidatorCommission}}),Object.defineProperty(t,"isMsgBeginRedelegateEncodeObject",{enumerable:!0,get:function(){return l.isMsgBeginRedelegateEncodeObject}}),Object.defineProperty(t,"isMsgCancelUnbondingDelegationEncodeObject",{enumerable:!0,get:function(){return l.isMsgCancelUnbondingDelegationEncodeObject}}),Object.defineProperty(t,"isMsgCreateValidatorEncodeObject",{enumerable:!0,get:function(){return l.isMsgCreateValidatorEncodeObject}}),Object.defineProperty(t,"isMsgDelegateEncodeObject",{enumerable:!0,get:function(){return l.isMsgDelegateEncodeObject}}),Object.defineProperty(t,"isMsgDepositEncodeObject",{enumerable:!0,get:function(){return l.isMsgDepositEncodeObject}}),Object.defineProperty(t,"isMsgEditValidatorEncodeObject",{enumerable:!0,get:function(){return l.isMsgEditValidatorEncodeObject}}),Object.defineProperty(t,"isMsgSendEncodeObject",{enumerable:!0,get:function(){return l.isMsgSendEncodeObject}}),Object.defineProperty(t,"isMsgSubmitProposalEncodeObject",{enumerable:!0,get:function(){return l.isMsgSubmitProposalEncodeObject}}),Object.defineProperty(t,"isMsgTransferEncodeObject",{enumerable:!0,get:function(){return l.isMsgTransferEncodeObject}}),Object.defineProperty(t,"isMsgUndelegateEncodeObject",{enumerable:!0,get:function(){return l.isMsgUndelegateEncodeObject}}),Object.defineProperty(t,"isMsgVoteEncodeObject",{enumerable:!0,get:function(){return l.isMsgVoteEncodeObject}}),Object.defineProperty(t,"isMsgVoteWeightedEncodeObject",{enumerable:!0,get:function(){return l.isMsgVoteWeightedEncodeObject}}),Object.defineProperty(t,"isMsgWithdrawDelegatorRewardEncodeObject",{enumerable:!0,get:function(){return l.isMsgWithdrawDelegatorRewardEncodeObject}}),Object.defineProperty(t,"setupAuthExtension",{enumerable:!0,get:function(){return l.setupAuthExtension}}),Object.defineProperty(t,"setupAuthzExtension",{enumerable:!0,get:function(){return l.setupAuthzExtension}}),Object.defineProperty(t,"setupBankExtension",{enumerable:!0,get:function(){return l.setupBankExtension}}),Object.defineProperty(t,"setupDistributionExtension",{enumerable:!0,get:function(){return l.setupDistributionExtension}}),Object.defineProperty(t,"setupFeegrantExtension",{enumerable:!0,get:function(){return l.setupFeegrantExtension}}),Object.defineProperty(t,"setupGovExtension",{enumerable:!0,get:function(){return l.setupGovExtension}}),Object.defineProperty(t,"setupIbcExtension",{enumerable:!0,get:function(){return l.setupIbcExtension}}),Object.defineProperty(t,"setupMintExtension",{enumerable:!0,get:function(){return l.setupMintExtension}}),Object.defineProperty(t,"setupSlashingExtension",{enumerable:!0,get:function(){return l.setupSlashingExtension}}),Object.defineProperty(t,"setupStakingExtension",{enumerable:!0,get:function(){return l.setupStakingExtension}}),Object.defineProperty(t,"setupTxExtension",{enumerable:!0,get:function(){return l.setupTxExtension}});var h=r(17426);Object.defineProperty(t,"makeMultisignedTx",{enumerable:!0,get:function(){return h.makeMultisignedTx}}),Object.defineProperty(t,"makeMultisignedTxBytes",{enumerable:!0,get:function(){return h.makeMultisignedTxBytes}});var d=r(1267);Object.defineProperty(t,"createPagination",{enumerable:!0,get:function(){return d.createPagination}}),Object.defineProperty(t,"createProtobufRpcClient",{enumerable:!0,get:function(){return d.createProtobufRpcClient}}),Object.defineProperty(t,"decodeCosmosSdkDecFromProto",{enumerable:!0,get:function(){return d.decodeCosmosSdkDecFromProto}}),Object.defineProperty(t,"QueryClient",{enumerable:!0,get:function(){return d.QueryClient}});var f=r(74487);Object.defineProperty(t,"isSearchTxQueryArray",{enumerable:!0,get:function(){return f.isSearchTxQueryArray}});var p=r(63116);Object.defineProperty(t,"createDefaultAminoConverters",{enumerable:!0,get:function(){return p.createDefaultAminoConverters}}),Object.defineProperty(t,"defaultRegistryTypes",{enumerable:!0,get:function(){return p.defaultRegistryTypes}}),Object.defineProperty(t,"SigningStargateClient",{enumerable:!0,get:function(){return p.SigningStargateClient}});var y=r(83131);Object.defineProperty(t,"assertIsDeliverTxFailure",{enumerable:!0,get:function(){return y.assertIsDeliverTxFailure}}),Object.defineProperty(t,"assertIsDeliverTxSuccess",{enumerable:!0,get:function(){return y.assertIsDeliverTxSuccess}}),Object.defineProperty(t,"BroadcastTxError",{enumerable:!0,get:function(){return y.BroadcastTxError}}),Object.defineProperty(t,"isDeliverTxFailure",{enumerable:!0,get:function(){return y.isDeliverTxFailure}}),Object.defineProperty(t,"isDeliverTxSuccess",{enumerable:!0,get:function(){return y.isDeliverTxSuccess}}),Object.defineProperty(t,"StargateClient",{enumerable:!0,get:function(){return y.StargateClient}}),Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return y.TimeoutError}});var g=r(5450);Object.defineProperty(t,"coin",{enumerable:!0,get:function(){return g.coin}}),Object.defineProperty(t,"coins",{enumerable:!0,get:function(){return g.coins}}),Object.defineProperty(t,"makeCosmoshubPath",{enumerable:!0,get:function(){return g.makeCosmoshubPath}}),Object.defineProperty(t,"parseCoins",{enumerable:!0,get:function(){return g.parseCoins}})},60540:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAttribute=t.parseRawLog=t.parseLogs=t.parseLog=t.parseEvent=t.parseAttribute=void 0;const n=r(55299);function i(e){if(!(0,n.isNonNullObject)(e))throw new Error("Attribute must be a non-null object");const{key:t,value:r}=e;if("string"!=typeof t||!t)throw new Error("Attribute's key must be a non-empty string");if("string"!=typeof r&&void 0!==r)throw new Error("Attribute's value must be a string or unset");return{key:t,value:r||""}}function s(e){if(!(0,n.isNonNullObject)(e))throw new Error("Event must be a non-null object");const{type:t,attributes:r}=e;if("string"!=typeof t||""===t)throw new Error("Event type must be a non-empty string");if(!Array.isArray(r))throw new Error("Event's attributes must be an array");return{type:t,attributes:r.map(i)}}function o(e){if(!(0,n.isNonNullObject)(e))throw new Error("Log must be a non-null object");const{msg_index:t,log:r,events:i}=e;if("number"!=typeof t)throw new Error("Log's msg_index must be a number");if("string"!=typeof r)throw new Error("Log's log must be a string");if(!Array.isArray(i))throw new Error("Log's events must be an array");return{msg_index:t,log:r,events:i.map(s)}}function a(e){if(!Array.isArray(e))throw new Error("Logs must be an array");return e.map(o)}t.parseAttribute=i,t.parseEvent=s,t.parseLog=o,t.parseLogs=a,t.parseRawLog=function(e){return e?a(JSON.parse(e).map((({events:e},t)=>({msg_index:t,events:e,log:""})))):[]},t.findAttribute=function(e,t,r){const n=e.find((()=>!0)),i=n?.events.find((e=>e.type===t))?.attributes.find((e=>e.key===r));if(!i)throw new Error(`Could not find attribute '${r}' in first event of type '${t}' in first log.`);return i}},67112:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BlockIdFlag=t.isTendermint37Client=t.isTendermint34Client=t.isComet38Client=t.connectComet=t.Tendermint37Client=t.tendermint37=t.Tendermint34Client=t.tendermint34=t.VoteType=t.SubscriptionEventType=t.Method=t.broadcastTxSyncSuccess=t.broadcastTxCommitSuccess=t.WebsocketClient=t.HttpClient=t.HttpBatchClient=t.Comet38Client=t.comet38=t.toSeconds=t.toRfc3339WithNanoseconds=t.fromSeconds=t.fromRfc3339WithNanoseconds=t.DateTime=t.rawSecp256k1PubkeyToRawAddress=t.rawEd25519PubkeyToRawAddress=t.pubkeyToRawAddress=t.pubkeyToAddress=void 0;var o=r(90184);Object.defineProperty(t,"pubkeyToAddress",{enumerable:!0,get:function(){return o.pubkeyToAddress}}),Object.defineProperty(t,"pubkeyToRawAddress",{enumerable:!0,get:function(){return o.pubkeyToRawAddress}}),Object.defineProperty(t,"rawEd25519PubkeyToRawAddress",{enumerable:!0,get:function(){return o.rawEd25519PubkeyToRawAddress}}),Object.defineProperty(t,"rawSecp256k1PubkeyToRawAddress",{enumerable:!0,get:function(){return o.rawSecp256k1PubkeyToRawAddress}});var a=r(51569);Object.defineProperty(t,"DateTime",{enumerable:!0,get:function(){return a.DateTime}}),Object.defineProperty(t,"fromRfc3339WithNanoseconds",{enumerable:!0,get:function(){return a.fromRfc3339WithNanoseconds}}),Object.defineProperty(t,"fromSeconds",{enumerable:!0,get:function(){return a.fromSeconds}}),Object.defineProperty(t,"toRfc3339WithNanoseconds",{enumerable:!0,get:function(){return a.toRfc3339WithNanoseconds}}),Object.defineProperty(t,"toSeconds",{enumerable:!0,get:function(){return a.toSeconds}}),t.comet38=s(r(49300));var c=r(49300);Object.defineProperty(t,"Comet38Client",{enumerable:!0,get:function(){return c.Comet38Client}});var u=r(90112);Object.defineProperty(t,"HttpBatchClient",{enumerable:!0,get:function(){return u.HttpBatchClient}}),Object.defineProperty(t,"HttpClient",{enumerable:!0,get:function(){return u.HttpClient}}),Object.defineProperty(t,"WebsocketClient",{enumerable:!0,get:function(){return u.WebsocketClient}});var l=r(74024);Object.defineProperty(t,"broadcastTxCommitSuccess",{enumerable:!0,get:function(){return l.broadcastTxCommitSuccess}}),Object.defineProperty(t,"broadcastTxSyncSuccess",{enumerable:!0,get:function(){return l.broadcastTxSyncSuccess}}),Object.defineProperty(t,"Method",{enumerable:!0,get:function(){return l.Method}}),Object.defineProperty(t,"SubscriptionEventType",{enumerable:!0,get:function(){return l.SubscriptionEventType}}),Object.defineProperty(t,"VoteType",{enumerable:!0,get:function(){return l.VoteType}}),t.tendermint34=s(r(74024));var h=r(74024);Object.defineProperty(t,"Tendermint34Client",{enumerable:!0,get:function(){return h.Tendermint34Client}}),t.tendermint37=s(r(86721));var d=r(86721);Object.defineProperty(t,"Tendermint37Client",{enumerable:!0,get:function(){return d.Tendermint37Client}});var f=r(66295);Object.defineProperty(t,"connectComet",{enumerable:!0,get:function(){return f.connectComet}}),Object.defineProperty(t,"isComet38Client",{enumerable:!0,get:function(){return f.isComet38Client}}),Object.defineProperty(t,"isTendermint34Client",{enumerable:!0,get:function(){return f.isTendermint34Client}}),Object.defineProperty(t,"isTendermint37Client",{enumerable:!0,get:function(){return f.isTendermint37Client}});var p=r(58669);Object.defineProperty(t,"BlockIdFlag",{enumerable:!0,get:function(){return p.BlockIdFlag}})},75331:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createCyberAminoConverters=t.OfflineDappWallet=t.SigningCyberClient=t.CyberClient=void 0;var s=r(68701);Object.defineProperty(t,"CyberClient",{enumerable:!0,get:function(){return s.CyberClient}});var o=r(34768);Object.defineProperty(t,"SigningCyberClient",{enumerable:!0,get:function(){return o.SigningCyberClient}}),Object.defineProperty(t,"OfflineDappWallet",{enumerable:!0,get:function(){return o.OfflineDappWallet}}),i(r(98379),t);var a=r(42055);Object.defineProperty(t,"createCyberAminoConverters",{enumerable:!0,get:function(){return a.createCyberAminoConverters}})},91214:function(e,t,r){"use strict";t.aJ=t.CB=t._A=t.EX=t.wf=t.uc=t.Bh=t.l=t.TS=t.Fs=t.mF=void 0;const n=r(5765),i=r(13423),s=r(78541),o=r(97686),a=r(67974),c=r(23427),u=r(81809),l=r(28099);var h,d;function f(e){switch(e){case 0:case"ORDER_BY_UNSPECIFIED":return h.ORDER_BY_UNSPECIFIED;case 1:case"ORDER_BY_ASC":return h.ORDER_BY_ASC;case 2:case"ORDER_BY_DESC":return h.ORDER_BY_DESC;default:return h.UNRECOGNIZED}}function p(e){switch(e){case h.ORDER_BY_UNSPECIFIED:return"ORDER_BY_UNSPECIFIED";case h.ORDER_BY_ASC:return"ORDER_BY_ASC";case h.ORDER_BY_DESC:return"ORDER_BY_DESC";case h.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function y(e){switch(e){case 0:case"BROADCAST_MODE_UNSPECIFIED":return d.BROADCAST_MODE_UNSPECIFIED;case 1:case"BROADCAST_MODE_BLOCK":return d.BROADCAST_MODE_BLOCK;case 2:case"BROADCAST_MODE_SYNC":return d.BROADCAST_MODE_SYNC;case 3:case"BROADCAST_MODE_ASYNC":return d.BROADCAST_MODE_ASYNC;default:return d.UNRECOGNIZED}}function g(e){switch(e){case d.BROADCAST_MODE_UNSPECIFIED:return"BROADCAST_MODE_UNSPECIFIED";case d.BROADCAST_MODE_BLOCK:return"BROADCAST_MODE_BLOCK";case d.BROADCAST_MODE_SYNC:return"BROADCAST_MODE_SYNC";case d.BROADCAST_MODE_ASYNC:return"BROADCAST_MODE_ASYNC";case d.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function m(){return{txBytes:new Uint8Array,mode:0}}function b(){return{tx:void 0,txBytes:new Uint8Array}}function w(){return{height:BigInt(0),pagination:void 0}}!function(e){e[e.ORDER_BY_UNSPECIFIED=0]="ORDER_BY_UNSPECIFIED",e[e.ORDER_BY_ASC=1]="ORDER_BY_ASC",e[e.ORDER_BY_DESC=2]="ORDER_BY_DESC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(h||(t.mF=h={})),function(e){e[e.BROADCAST_MODE_UNSPECIFIED=0]="BROADCAST_MODE_UNSPECIFIED",e[e.BROADCAST_MODE_BLOCK=1]="BROADCAST_MODE_BLOCK",e[e.BROADCAST_MODE_SYNC=2]="BROADCAST_MODE_SYNC",e[e.BROADCAST_MODE_ASYNC=3]="BROADCAST_MODE_ASYNC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(d||(d={})),t.Fs={typeUrl:"/cosmos.tx.v1beta1.GetTxsEventRequest",aminoType:"cosmos-sdk/GetTxsEventRequest",is:e=>e&&(e.$typeUrl===t.Fs.typeUrl||Array.isArray(e.events)&&(!e.events.length||"string"==typeof e.events[0])&&(0,c.isSet)(e.orderBy)),isSDK:e=>e&&(e.$typeUrl===t.Fs.typeUrl||Array.isArray(e.events)&&(!e.events.length||"string"==typeof e.events[0])&&(0,c.isSet)(e.order_by)),isAmino:e=>e&&(e.$typeUrl===t.Fs.typeUrl||Array.isArray(e.events)&&(!e.events.length||"string"==typeof e.events[0])&&(0,c.isSet)(e.order_by)),encode(e,t=u.BinaryWriter.create()){for(const r of e.events)t.uint32(10).string(r);return void 0!==e.pagination&&i.PageRequest.encode(e.pagination,t.uint32(18).fork()).ldelim(),0!==e.orderBy&&t.uint32(24).int32(e.orderBy),t},decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={events:[],pagination:void 0,orderBy:0};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.events.push(r.string());break;case 2:s.pagination=i.PageRequest.decode(r,r.uint32());break;case 3:s.orderBy=r.int32();break;default:r.skipType(7&e)}}return s},fromJSON:e=>({events:Array.isArray(e?.events)?e.events.map((e=>String(e))):[],pagination:(0,c.isSet)(e.pagination)?i.PageRequest.fromJSON(e.pagination):void 0,orderBy:(0,c.isSet)(e.orderBy)?f(e.orderBy):-1}),toJSON(e){const t={};return e.events?t.events=e.events.map((e=>e)):t.events=[],void 0!==e.pagination&&(t.pagination=e.pagination?i.PageRequest.toJSON(e.pagination):void 0),void 0!==e.orderBy&&(t.orderBy=p(e.orderBy)),t},fromPartial(e){const t={events:[],pagination:void 0,orderBy:0};return t.events=e.events?.map((e=>e))||[],t.pagination=void 0!==e.pagination&&null!==e.pagination?i.PageRequest.fromPartial(e.pagination):void 0,t.orderBy=e.orderBy??0,t},fromAmino(e){const t={events:[],pagination:void 0,orderBy:0};return t.events=e.events?.map((e=>e))||[],void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageRequest.fromAmino(e.pagination)),void 0!==e.order_by&&null!==e.order_by&&(t.orderBy=e.order_by),t},toAmino(e){const t={};return e.events?t.events=e.events.map((e=>e)):t.events=e.events,t.pagination=e.pagination?i.PageRequest.toAmino(e.pagination):void 0,t.order_by=0===e.orderBy?void 0:e.orderBy,t},fromAminoMsg:e=>t.Fs.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetTxsEventRequest",value:t.Fs.toAmino(e)}),fromProtoMsg:e=>t.Fs.decode(e.value),toProto:e=>t.Fs.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetTxsEventRequest",value:t.Fs.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.Fs.typeUrl,t.Fs),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.Fs.aminoType,t.Fs.typeUrl),t.TS={typeUrl:"/cosmos.tx.v1beta1.GetTxsEventResponse",aminoType:"cosmos-sdk/GetTxsEventResponse",is:e=>e&&(e.$typeUrl===t.TS.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.is(e.txs[0]))&&Array.isArray(e.txResponses)&&(!e.txResponses.length||s.TxResponse.is(e.txResponses[0]))),isSDK:e=>e&&(e.$typeUrl===t.TS.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.isSDK(e.txs[0]))&&Array.isArray(e.tx_responses)&&(!e.tx_responses.length||s.TxResponse.isSDK(e.tx_responses[0]))),isAmino:e=>e&&(e.$typeUrl===t.TS.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.isAmino(e.txs[0]))&&Array.isArray(e.tx_responses)&&(!e.tx_responses.length||s.TxResponse.isAmino(e.tx_responses[0]))),encode(e,t=u.BinaryWriter.create()){for(const r of e.txs)n.Tx.encode(r,t.uint32(10).fork()).ldelim();for(const r of e.txResponses)s.TxResponse.encode(r,t.uint32(18).fork()).ldelim();return void 0!==e.pagination&&i.PageResponse.encode(e.pagination,t.uint32(26).fork()).ldelim(),t},decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let o=void 0===t?r.len:r.pos+t;const a={txs:[],txResponses:[],pagination:void 0};for(;r.pos<o;){const e=r.uint32();switch(e>>>3){case 1:a.txs.push(n.Tx.decode(r,r.uint32()));break;case 2:a.txResponses.push(s.TxResponse.decode(r,r.uint32()));break;case 3:a.pagination=i.PageResponse.decode(r,r.uint32());break;default:r.skipType(7&e)}}return a},fromJSON:e=>({txs:Array.isArray(e?.txs)?e.txs.map((e=>n.Tx.fromJSON(e))):[],txResponses:Array.isArray(e?.txResponses)?e.txResponses.map((e=>s.TxResponse.fromJSON(e))):[],pagination:(0,c.isSet)(e.pagination)?i.PageResponse.fromJSON(e.pagination):void 0}),toJSON(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toJSON(e):void 0)):t.txs=[],e.txResponses?t.txResponses=e.txResponses.map((e=>e?s.TxResponse.toJSON(e):void 0)):t.txResponses=[],void 0!==e.pagination&&(t.pagination=e.pagination?i.PageResponse.toJSON(e.pagination):void 0),t},fromPartial(e){const t={txs:[],txResponses:[],pagination:void 0};return t.txs=e.txs?.map((e=>n.Tx.fromPartial(e)))||[],t.txResponses=e.txResponses?.map((e=>s.TxResponse.fromPartial(e)))||[],t.pagination=void 0!==e.pagination&&null!==e.pagination?i.PageResponse.fromPartial(e.pagination):void 0,t},fromAmino(e){const t={txs:[],txResponses:[],pagination:void 0};return t.txs=e.txs?.map((e=>n.Tx.fromAmino(e)))||[],t.txResponses=e.tx_responses?.map((e=>s.TxResponse.fromAmino(e)))||[],void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageResponse.fromAmino(e.pagination)),t},toAmino(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toAmino(e):void 0)):t.txs=e.txs,e.txResponses?t.tx_responses=e.txResponses.map((e=>e?s.TxResponse.toAmino(e):void 0)):t.tx_responses=e.txResponses,t.pagination=e.pagination?i.PageResponse.toAmino(e.pagination):void 0,t},fromAminoMsg:e=>t.TS.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetTxsEventResponse",value:t.TS.toAmino(e)}),fromProtoMsg:e=>t.TS.decode(e.value),toProto:e=>t.TS.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetTxsEventResponse",value:t.TS.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.TS.typeUrl,t.TS),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.TS.aminoType,t.TS.typeUrl),t.l={typeUrl:"/cosmos.tx.v1beta1.BroadcastTxRequest",aminoType:"cosmos-sdk/BroadcastTxRequest",is:e=>e&&(e.$typeUrl===t.l.typeUrl||(e.txBytes instanceof Uint8Array||"string"==typeof e.txBytes)&&(0,c.isSet)(e.mode)),isSDK:e=>e&&(e.$typeUrl===t.l.typeUrl||(e.tx_bytes instanceof Uint8Array||"string"==typeof e.tx_bytes)&&(0,c.isSet)(e.mode)),isAmino:e=>e&&(e.$typeUrl===t.l.typeUrl||(e.tx_bytes instanceof Uint8Array||"string"==typeof e.tx_bytes)&&(0,c.isSet)(e.mode)),encode:(e,t=u.BinaryWriter.create())=>(0!==e.txBytes.length&&t.uint32(10).bytes(e.txBytes),0!==e.mode&&t.uint32(16).int32(e.mode),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=m();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.txBytes=r.bytes();break;case 2:i.mode=r.int32();break;default:r.skipType(7&e)}}return i},fromJSON:e=>({txBytes:(0,c.isSet)(e.txBytes)?(0,c.bytesFromBase64)(e.txBytes):new Uint8Array,mode:(0,c.isSet)(e.mode)?y(e.mode):-1}),toJSON(e){const t={};return void 0!==e.txBytes&&(t.txBytes=(0,c.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),void 0!==e.mode&&(t.mode=g(e.mode)),t},fromPartial(e){const t=m();return t.txBytes=e.txBytes??new Uint8Array,t.mode=e.mode??0,t},fromAmino(e){const t=m();return void 0!==e.tx_bytes&&null!==e.tx_bytes&&(t.txBytes=(0,c.bytesFromBase64)(e.tx_bytes)),void 0!==e.mode&&null!==e.mode&&(t.mode=e.mode),t},toAmino(e){const t={};return t.tx_bytes=e.txBytes?(0,c.base64FromBytes)(e.txBytes):void 0,t.mode=0===e.mode?void 0:e.mode,t},fromAminoMsg:e=>t.l.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/BroadcastTxRequest",value:t.l.toAmino(e)}),fromProtoMsg:e=>t.l.decode(e.value),toProto:e=>t.l.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.BroadcastTxRequest",value:t.l.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.l.typeUrl,t.l),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.l.aminoType,t.l.typeUrl),t.Bh={typeUrl:"/cosmos.tx.v1beta1.BroadcastTxResponse",aminoType:"cosmos-sdk/BroadcastTxResponse",is:e=>e&&e.$typeUrl===t.Bh.typeUrl,isSDK:e=>e&&e.$typeUrl===t.Bh.typeUrl,isAmino:e=>e&&e.$typeUrl===t.Bh.typeUrl,encode:(e,t=u.BinaryWriter.create())=>(void 0!==e.txResponse&&s.TxResponse.encode(e.txResponse,t.uint32(10).fork()).ldelim(),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={txResponse:void 0};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.txResponse=s.TxResponse.decode(r,r.uint32());else r.skipType(7&e)}return i},fromJSON:e=>({txResponse:(0,c.isSet)(e.txResponse)?s.TxResponse.fromJSON(e.txResponse):void 0}),toJSON(e){const t={};return void 0!==e.txResponse&&(t.txResponse=e.txResponse?s.TxResponse.toJSON(e.txResponse):void 0),t},fromPartial(e){const t={txResponse:void 0};return t.txResponse=void 0!==e.txResponse&&null!==e.txResponse?s.TxResponse.fromPartial(e.txResponse):void 0,t},fromAmino(e){const t={txResponse:void 0};return void 0!==e.tx_response&&null!==e.tx_response&&(t.txResponse=s.TxResponse.fromAmino(e.tx_response)),t},toAmino(e){const t={};return t.tx_response=e.txResponse?s.TxResponse.toAmino(e.txResponse):void 0,t},fromAminoMsg:e=>t.Bh.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/BroadcastTxResponse",value:t.Bh.toAmino(e)}),fromProtoMsg:e=>t.Bh.decode(e.value),toProto:e=>t.Bh.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.BroadcastTxResponse",value:t.Bh.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.Bh.typeUrl,t.Bh),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.Bh.aminoType,t.Bh.typeUrl),t.uc={typeUrl:"/cosmos.tx.v1beta1.SimulateRequest",aminoType:"cosmos-sdk/SimulateRequest",is:e=>e&&(e.$typeUrl===t.uc.typeUrl||e.txBytes instanceof Uint8Array||"string"==typeof e.txBytes),isSDK:e=>e&&(e.$typeUrl===t.uc.typeUrl||e.tx_bytes instanceof Uint8Array||"string"==typeof e.tx_bytes),isAmino:e=>e&&(e.$typeUrl===t.uc.typeUrl||e.tx_bytes instanceof Uint8Array||"string"==typeof e.tx_bytes),encode:(e,t=u.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),0!==e.txBytes.length&&t.uint32(18).bytes(e.txBytes),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s=b();for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:s.tx=n.Tx.decode(r,r.uint32());break;case 2:s.txBytes=r.bytes();break;default:r.skipType(7&e)}}return s},fromJSON:e=>({tx:(0,c.isSet)(e.tx)?n.Tx.fromJSON(e.tx):void 0,txBytes:(0,c.isSet)(e.txBytes)?(0,c.bytesFromBase64)(e.txBytes):new Uint8Array}),toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),void 0!==e.txBytes&&(t.txBytes=(0,c.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),t},fromPartial(e){const t=b();return t.tx=void 0!==e.tx&&null!==e.tx?n.Tx.fromPartial(e.tx):void 0,t.txBytes=e.txBytes??new Uint8Array,t},fromAmino(e){const t=b();return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromAmino(e.tx)),void 0!==e.tx_bytes&&null!==e.tx_bytes&&(t.txBytes=(0,c.bytesFromBase64)(e.tx_bytes)),t},toAmino(e){const t={};return t.tx=e.tx?n.Tx.toAmino(e.tx):void 0,t.tx_bytes=e.txBytes?(0,c.base64FromBytes)(e.txBytes):void 0,t},fromAminoMsg:e=>t.uc.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/SimulateRequest",value:t.uc.toAmino(e)}),fromProtoMsg:e=>t.uc.decode(e.value),toProto:e=>t.uc.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.SimulateRequest",value:t.uc.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.uc.typeUrl,t.uc),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.uc.aminoType,t.uc.typeUrl),t.wf={typeUrl:"/cosmos.tx.v1beta1.SimulateResponse",aminoType:"cosmos-sdk/SimulateResponse",is:e=>e&&e.$typeUrl===t.wf.typeUrl,isSDK:e=>e&&e.$typeUrl===t.wf.typeUrl,isAmino:e=>e&&e.$typeUrl===t.wf.typeUrl,encode:(e,t=u.BinaryWriter.create())=>(void 0!==e.gasInfo&&s.GasInfo.encode(e.gasInfo,t.uint32(10).fork()).ldelim(),void 0!==e.result&&s.Result.encode(e.result,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={gasInfo:void 0,result:void 0};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.gasInfo=s.GasInfo.decode(r,r.uint32());break;case 2:i.result=s.Result.decode(r,r.uint32());break;default:r.skipType(7&e)}}return i},fromJSON:e=>({gasInfo:(0,c.isSet)(e.gasInfo)?s.GasInfo.fromJSON(e.gasInfo):void 0,result:(0,c.isSet)(e.result)?s.Result.fromJSON(e.result):void 0}),toJSON(e){const t={};return void 0!==e.gasInfo&&(t.gasInfo=e.gasInfo?s.GasInfo.toJSON(e.gasInfo):void 0),void 0!==e.result&&(t.result=e.result?s.Result.toJSON(e.result):void 0),t},fromPartial(e){const t={gasInfo:void 0,result:void 0};return t.gasInfo=void 0!==e.gasInfo&&null!==e.gasInfo?s.GasInfo.fromPartial(e.gasInfo):void 0,t.result=void 0!==e.result&&null!==e.result?s.Result.fromPartial(e.result):void 0,t},fromAmino(e){const t={gasInfo:void 0,result:void 0};return void 0!==e.gas_info&&null!==e.gas_info&&(t.gasInfo=s.GasInfo.fromAmino(e.gas_info)),void 0!==e.result&&null!==e.result&&(t.result=s.Result.fromAmino(e.result)),t},toAmino(e){const t={};return t.gas_info=e.gasInfo?s.GasInfo.toAmino(e.gasInfo):void 0,t.result=e.result?s.Result.toAmino(e.result):void 0,t},fromAminoMsg:e=>t.wf.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/SimulateResponse",value:t.wf.toAmino(e)}),fromProtoMsg:e=>t.wf.decode(e.value),toProto:e=>t.wf.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.SimulateResponse",value:t.wf.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.wf.typeUrl,t.wf),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.wf.aminoType,t.wf.typeUrl),t.EX={typeUrl:"/cosmos.tx.v1beta1.GetTxRequest",aminoType:"cosmos-sdk/GetTxRequest",is:e=>e&&(e.$typeUrl===t.EX.typeUrl||"string"==typeof e.hash),isSDK:e=>e&&(e.$typeUrl===t.EX.typeUrl||"string"==typeof e.hash),isAmino:e=>e&&(e.$typeUrl===t.EX.typeUrl||"string"==typeof e.hash),encode:(e,t=u.BinaryWriter.create())=>(""!==e.hash&&t.uint32(10).string(e.hash),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={hash:""};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.hash=r.string();else r.skipType(7&e)}return i},fromJSON:e=>({hash:(0,c.isSet)(e.hash)?String(e.hash):""}),toJSON(e){const t={};return void 0!==e.hash&&(t.hash=e.hash),t},fromPartial(e){const t={hash:""};return t.hash=e.hash??"",t},fromAmino(e){const t={hash:""};return void 0!==e.hash&&null!==e.hash&&(t.hash=e.hash),t},toAmino(e){const t={};return t.hash=""===e.hash?void 0:e.hash,t},fromAminoMsg:e=>t.EX.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetTxRequest",value:t.EX.toAmino(e)}),fromProtoMsg:e=>t.EX.decode(e.value),toProto:e=>t.EX.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetTxRequest",value:t.EX.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.EX.typeUrl,t.EX),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.EX.aminoType,t.EX.typeUrl),t._A={typeUrl:"/cosmos.tx.v1beta1.GetTxResponse",aminoType:"cosmos-sdk/GetTxResponse",is:e=>e&&e.$typeUrl===t._A.typeUrl,isSDK:e=>e&&e.$typeUrl===t._A.typeUrl,isAmino:e=>e&&e.$typeUrl===t._A.typeUrl,encode:(e,t=u.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),void 0!==e.txResponse&&s.TxResponse.encode(e.txResponse,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const o={tx:void 0,txResponse:void 0};for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:o.tx=n.Tx.decode(r,r.uint32());break;case 2:o.txResponse=s.TxResponse.decode(r,r.uint32());break;default:r.skipType(7&e)}}return o},fromJSON:e=>({tx:(0,c.isSet)(e.tx)?n.Tx.fromJSON(e.tx):void 0,txResponse:(0,c.isSet)(e.txResponse)?s.TxResponse.fromJSON(e.txResponse):void 0}),toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),void 0!==e.txResponse&&(t.txResponse=e.txResponse?s.TxResponse.toJSON(e.txResponse):void 0),t},fromPartial(e){const t={tx:void 0,txResponse:void 0};return t.tx=void 0!==e.tx&&null!==e.tx?n.Tx.fromPartial(e.tx):void 0,t.txResponse=void 0!==e.txResponse&&null!==e.txResponse?s.TxResponse.fromPartial(e.txResponse):void 0,t},fromAmino(e){const t={tx:void 0,txResponse:void 0};return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromAmino(e.tx)),void 0!==e.tx_response&&null!==e.tx_response&&(t.txResponse=s.TxResponse.fromAmino(e.tx_response)),t},toAmino(e){const t={};return t.tx=e.tx?n.Tx.toAmino(e.tx):void 0,t.tx_response=e.txResponse?s.TxResponse.toAmino(e.txResponse):void 0,t},fromAminoMsg:e=>t._A.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetTxResponse",value:t._A.toAmino(e)}),fromProtoMsg:e=>t._A.decode(e.value),toProto:e=>t._A.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetTxResponse",value:t._A.encode(e).finish()})},l.GlobalDecoderRegistry.register(t._A.typeUrl,t._A),l.GlobalDecoderRegistry.registerAminoProtoMapping(t._A.aminoType,t._A.typeUrl),t.CB={typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsRequest",aminoType:"cosmos-sdk/GetBlockWithTxsRequest",is:e=>e&&(e.$typeUrl===t.CB.typeUrl||"bigint"==typeof e.height),isSDK:e=>e&&(e.$typeUrl===t.CB.typeUrl||"bigint"==typeof e.height),isAmino:e=>e&&(e.$typeUrl===t.CB.typeUrl||"bigint"==typeof e.height),encode:(e,t=u.BinaryWriter.create())=>(e.height!==BigInt(0)&&t.uint32(8).int64(e.height),void 0!==e.pagination&&i.PageRequest.encode(e.pagination,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s=w();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.height=r.int64();break;case 2:s.pagination=i.PageRequest.decode(r,r.uint32());break;default:r.skipType(7&e)}}return s},fromJSON:e=>({height:(0,c.isSet)(e.height)?BigInt(e.height.toString()):BigInt(0),pagination:(0,c.isSet)(e.pagination)?i.PageRequest.fromJSON(e.pagination):void 0}),toJSON(e){const t={};return void 0!==e.height&&(t.height=(e.height||BigInt(0)).toString()),void 0!==e.pagination&&(t.pagination=e.pagination?i.PageRequest.toJSON(e.pagination):void 0),t},fromPartial(e){const t=w();return t.height=void 0!==e.height&&null!==e.height?BigInt(e.height.toString()):BigInt(0),t.pagination=void 0!==e.pagination&&null!==e.pagination?i.PageRequest.fromPartial(e.pagination):void 0,t},fromAmino(e){const t=w();return void 0!==e.height&&null!==e.height&&(t.height=BigInt(e.height)),void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageRequest.fromAmino(e.pagination)),t},toAmino(e){const t={};return t.height=e.height!==BigInt(0)?e.height.toString():void 0,t.pagination=e.pagination?i.PageRequest.toAmino(e.pagination):void 0,t},fromAminoMsg:e=>t.CB.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetBlockWithTxsRequest",value:t.CB.toAmino(e)}),fromProtoMsg:e=>t.CB.decode(e.value),toProto:e=>t.CB.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsRequest",value:t.CB.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.CB.typeUrl,t.CB),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.CB.aminoType,t.CB.typeUrl),t.aJ={typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsResponse",aminoType:"cosmos-sdk/GetBlockWithTxsResponse",is:e=>e&&(e.$typeUrl===t.aJ.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.is(e.txs[0]))),isSDK:e=>e&&(e.$typeUrl===t.aJ.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.isSDK(e.txs[0]))),isAmino:e=>e&&(e.$typeUrl===t.aJ.typeUrl||Array.isArray(e.txs)&&(!e.txs.length||n.Tx.isAmino(e.txs[0]))),encode(e,t=u.BinaryWriter.create()){for(const r of e.txs)n.Tx.encode(r,t.uint32(10).fork()).ldelim();return void 0!==e.blockId&&o.BlockID.encode(e.blockId,t.uint32(18).fork()).ldelim(),void 0!==e.block&&a.Block.encode(e.block,t.uint32(26).fork()).ldelim(),void 0!==e.pagination&&i.PageResponse.encode(e.pagination,t.uint32(34).fork()).ldelim(),t},decode(e,t){const r=e instanceof u.BinaryReader?e:new u.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const c={txs:[],blockId:void 0,block:void 0,pagination:void 0};for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:c.txs.push(n.Tx.decode(r,r.uint32()));break;case 2:c.blockId=o.BlockID.decode(r,r.uint32());break;case 3:c.block=a.Block.decode(r,r.uint32());break;case 4:c.pagination=i.PageResponse.decode(r,r.uint32());break;default:r.skipType(7&e)}}return c},fromJSON:e=>({txs:Array.isArray(e?.txs)?e.txs.map((e=>n.Tx.fromJSON(e))):[],blockId:(0,c.isSet)(e.blockId)?o.BlockID.fromJSON(e.blockId):void 0,block:(0,c.isSet)(e.block)?a.Block.fromJSON(e.block):void 0,pagination:(0,c.isSet)(e.pagination)?i.PageResponse.fromJSON(e.pagination):void 0}),toJSON(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toJSON(e):void 0)):t.txs=[],void 0!==e.blockId&&(t.blockId=e.blockId?o.BlockID.toJSON(e.blockId):void 0),void 0!==e.block&&(t.block=e.block?a.Block.toJSON(e.block):void 0),void 0!==e.pagination&&(t.pagination=e.pagination?i.PageResponse.toJSON(e.pagination):void 0),t},fromPartial(e){const t={txs:[],blockId:void 0,block:void 0,pagination:void 0};return t.txs=e.txs?.map((e=>n.Tx.fromPartial(e)))||[],t.blockId=void 0!==e.blockId&&null!==e.blockId?o.BlockID.fromPartial(e.blockId):void 0,t.block=void 0!==e.block&&null!==e.block?a.Block.fromPartial(e.block):void 0,t.pagination=void 0!==e.pagination&&null!==e.pagination?i.PageResponse.fromPartial(e.pagination):void 0,t},fromAmino(e){const t={txs:[],blockId:void 0,block:void 0,pagination:void 0};return t.txs=e.txs?.map((e=>n.Tx.fromAmino(e)))||[],void 0!==e.block_id&&null!==e.block_id&&(t.blockId=o.BlockID.fromAmino(e.block_id)),void 0!==e.block&&null!==e.block&&(t.block=a.Block.fromAmino(e.block)),void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageResponse.fromAmino(e.pagination)),t},toAmino(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toAmino(e):void 0)):t.txs=e.txs,t.block_id=e.blockId?o.BlockID.toAmino(e.blockId):void 0,t.block=e.block?a.Block.toAmino(e.block):void 0,t.pagination=e.pagination?i.PageResponse.toAmino(e.pagination):void 0,t},fromAminoMsg:e=>t.aJ.fromAmino(e.value),toAminoMsg:e=>({type:"cosmos-sdk/GetBlockWithTxsResponse",value:t.aJ.toAmino(e)}),fromProtoMsg:e=>t.aJ.decode(e.value),toProto:e=>t.aJ.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsResponse",value:t.aJ.encode(e).finish()})},l.GlobalDecoderRegistry.register(t.aJ.typeUrl,t.aJ),l.GlobalDecoderRegistry.registerAminoProtoMapping(t.aJ.aminoType,t.aJ.typeUrl)},75736:function(e,t,r){"use strict";t.NU=t.AS=t.Ei=t.nb=t.Cz=t.zL=t.l5=t.ik=void 0;const n=r(22579),i=r(81809),s=r(23427),o=r(28099),a=r(27537);function c(){return{depositorAddress:"",poolId:BigInt(0),depositCoins:[]}}function u(){return{withdrawerAddress:"",poolId:BigInt(0),poolCoin:n.Coin.fromPartial({})}}function l(){return{swapRequesterAddress:"",poolId:BigInt(0),swapTypeId:0,offerCoin:n.Coin.fromPartial({}),demandCoinDenom:"",offerCoinFee:n.Coin.fromPartial({}),orderPrice:""}}t.ik={typeUrl:"/cyber.liquidity.v1beta1.MsgCreatePool",is:e=>e&&(e.$typeUrl===t.ik.typeUrl||"string"==typeof e.poolCreatorAddress&&"number"==typeof e.poolTypeId&&Array.isArray(e.depositCoins)&&(!e.depositCoins.length||n.Coin.is(e.depositCoins[0]))),isSDK:e=>e&&(e.$typeUrl===t.ik.typeUrl||"string"==typeof e.pool_creator_address&&"number"==typeof e.pool_type_id&&Array.isArray(e.deposit_coins)&&(!e.deposit_coins.length||n.Coin.isSDK(e.deposit_coins[0]))),isAmino:e=>e&&(e.$typeUrl===t.ik.typeUrl||"string"==typeof e.pool_creator_address&&"number"==typeof e.pool_type_id&&Array.isArray(e.deposit_coins)&&(!e.deposit_coins.length||n.Coin.isAmino(e.deposit_coins[0]))),encode(e,t=i.BinaryWriter.create()){""!==e.poolCreatorAddress&&t.uint32(10).string(e.poolCreatorAddress),0!==e.poolTypeId&&t.uint32(16).uint32(e.poolTypeId);for(const r of e.depositCoins)n.Coin.encode(r,t.uint32(34).fork()).ldelim();return t},decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const o={poolCreatorAddress:"",poolTypeId:0,depositCoins:[]};for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:o.poolCreatorAddress=r.string();break;case 2:o.poolTypeId=r.uint32();break;case 4:o.depositCoins.push(n.Coin.decode(r,r.uint32()));break;default:r.skipType(7&e)}}return o},fromJSON:e=>({poolCreatorAddress:(0,s.isSet)(e.poolCreatorAddress)?String(e.poolCreatorAddress):"",poolTypeId:(0,s.isSet)(e.poolTypeId)?Number(e.poolTypeId):0,depositCoins:Array.isArray(e?.depositCoins)?e.depositCoins.map((e=>n.Coin.fromJSON(e))):[]}),toJSON(e){const t={};return void 0!==e.poolCreatorAddress&&(t.poolCreatorAddress=e.poolCreatorAddress),void 0!==e.poolTypeId&&(t.poolTypeId=Math.round(e.poolTypeId)),e.depositCoins?t.depositCoins=e.depositCoins.map((e=>e?n.Coin.toJSON(e):void 0)):t.depositCoins=[],t},fromPartial(e){const t={poolCreatorAddress:"",poolTypeId:0,depositCoins:[]};return t.poolCreatorAddress=e.poolCreatorAddress??"",t.poolTypeId=e.poolTypeId??0,t.depositCoins=e.depositCoins?.map((e=>n.Coin.fromPartial(e)))||[],t},fromAmino(e){const t={poolCreatorAddress:"",poolTypeId:0,depositCoins:[]};return void 0!==e.pool_creator_address&&null!==e.pool_creator_address&&(t.poolCreatorAddress=e.pool_creator_address),void 0!==e.pool_type_id&&null!==e.pool_type_id&&(t.poolTypeId=e.pool_type_id),t.depositCoins=e.deposit_coins?.map((e=>n.Coin.fromAmino(e)))||[],t},toAmino(e){const t={};return t.pool_creator_address=""===e.poolCreatorAddress?void 0:e.poolCreatorAddress,t.pool_type_id=0===e.poolTypeId?void 0:e.poolTypeId,e.depositCoins?t.deposit_coins=e.depositCoins.map((e=>e?n.Coin.toAmino(e):void 0)):t.deposit_coins=e.depositCoins,t},fromAminoMsg:e=>t.ik.fromAmino(e.value),fromProtoMsg:e=>t.ik.decode(e.value),toProto:e=>t.ik.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgCreatePool",value:t.ik.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.ik.typeUrl,t.ik),t.l5={typeUrl:"/cyber.liquidity.v1beta1.MsgCreatePoolResponse",is:e=>e&&e.$typeUrl===t.l5.typeUrl,isSDK:e=>e&&e.$typeUrl===t.l5.typeUrl,isAmino:e=>e&&e.$typeUrl===t.l5.typeUrl,encode:(e,t=i.BinaryWriter.create())=>t,decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={};for(;r.pos<n;){const e=r.uint32();r.skipType(7&e)}return s},fromJSON:e=>({}),toJSON:e=>({}),fromPartial:e=>({}),fromAmino:e=>({}),toAmino:e=>({}),fromAminoMsg:e=>t.l5.fromAmino(e.value),fromProtoMsg:e=>t.l5.decode(e.value),toProto:e=>t.l5.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgCreatePoolResponse",value:t.l5.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.l5.typeUrl,t.l5),t.zL={typeUrl:"/cyber.liquidity.v1beta1.MsgDepositWithinBatch",is:e=>e&&(e.$typeUrl===t.zL.typeUrl||"string"==typeof e.depositorAddress&&"bigint"==typeof e.poolId&&Array.isArray(e.depositCoins)&&(!e.depositCoins.length||n.Coin.is(e.depositCoins[0]))),isSDK:e=>e&&(e.$typeUrl===t.zL.typeUrl||"string"==typeof e.depositor_address&&"bigint"==typeof e.pool_id&&Array.isArray(e.deposit_coins)&&(!e.deposit_coins.length||n.Coin.isSDK(e.deposit_coins[0]))),isAmino:e=>e&&(e.$typeUrl===t.zL.typeUrl||"string"==typeof e.depositor_address&&"bigint"==typeof e.pool_id&&Array.isArray(e.deposit_coins)&&(!e.deposit_coins.length||n.Coin.isAmino(e.deposit_coins[0]))),encode(e,t=i.BinaryWriter.create()){""!==e.depositorAddress&&t.uint32(10).string(e.depositorAddress),e.poolId!==BigInt(0)&&t.uint32(16).uint64(e.poolId);for(const r of e.depositCoins)n.Coin.encode(r,t.uint32(26).fork()).ldelim();return t},decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const o=c();for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:o.depositorAddress=r.string();break;case 2:o.poolId=r.uint64();break;case 3:o.depositCoins.push(n.Coin.decode(r,r.uint32()));break;default:r.skipType(7&e)}}return o},fromJSON:e=>({depositorAddress:(0,s.isSet)(e.depositorAddress)?String(e.depositorAddress):"",poolId:(0,s.isSet)(e.poolId)?BigInt(e.poolId.toString()):BigInt(0),depositCoins:Array.isArray(e?.depositCoins)?e.depositCoins.map((e=>n.Coin.fromJSON(e))):[]}),toJSON(e){const t={};return void 0!==e.depositorAddress&&(t.depositorAddress=e.depositorAddress),void 0!==e.poolId&&(t.poolId=(e.poolId||BigInt(0)).toString()),e.depositCoins?t.depositCoins=e.depositCoins.map((e=>e?n.Coin.toJSON(e):void 0)):t.depositCoins=[],t},fromPartial(e){const t=c();return t.depositorAddress=e.depositorAddress??"",t.poolId=void 0!==e.poolId&&null!==e.poolId?BigInt(e.poolId.toString()):BigInt(0),t.depositCoins=e.depositCoins?.map((e=>n.Coin.fromPartial(e)))||[],t},fromAmino(e){const t=c();return void 0!==e.depositor_address&&null!==e.depositor_address&&(t.depositorAddress=e.depositor_address),void 0!==e.pool_id&&null!==e.pool_id&&(t.poolId=BigInt(e.pool_id)),t.depositCoins=e.deposit_coins?.map((e=>n.Coin.fromAmino(e)))||[],t},toAmino(e){const t={};return t.depositor_address=""===e.depositorAddress?void 0:e.depositorAddress,t.pool_id=e.poolId!==BigInt(0)?e.poolId.toString():void 0,e.depositCoins?t.deposit_coins=e.depositCoins.map((e=>e?n.Coin.toAmino(e):void 0)):t.deposit_coins=e.depositCoins,t},fromAminoMsg:e=>t.zL.fromAmino(e.value),fromProtoMsg:e=>t.zL.decode(e.value),toProto:e=>t.zL.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgDepositWithinBatch",value:t.zL.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.zL.typeUrl,t.zL),t.Cz={typeUrl:"/cyber.liquidity.v1beta1.MsgDepositWithinBatchResponse",is:e=>e&&e.$typeUrl===t.Cz.typeUrl,isSDK:e=>e&&e.$typeUrl===t.Cz.typeUrl,isAmino:e=>e&&e.$typeUrl===t.Cz.typeUrl,encode:(e,t=i.BinaryWriter.create())=>t,decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={};for(;r.pos<n;){const e=r.uint32();r.skipType(7&e)}return s},fromJSON:e=>({}),toJSON:e=>({}),fromPartial:e=>({}),fromAmino:e=>({}),toAmino:e=>({}),fromAminoMsg:e=>t.Cz.fromAmino(e.value),fromProtoMsg:e=>t.Cz.decode(e.value),toProto:e=>t.Cz.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgDepositWithinBatchResponse",value:t.Cz.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.Cz.typeUrl,t.Cz),t.nb={typeUrl:"/cyber.liquidity.v1beta1.MsgWithdrawWithinBatch",is:e=>e&&(e.$typeUrl===t.nb.typeUrl||"string"==typeof e.withdrawerAddress&&"bigint"==typeof e.poolId&&n.Coin.is(e.poolCoin)),isSDK:e=>e&&(e.$typeUrl===t.nb.typeUrl||"string"==typeof e.withdrawer_address&&"bigint"==typeof e.pool_id&&n.Coin.isSDK(e.pool_coin)),isAmino:e=>e&&(e.$typeUrl===t.nb.typeUrl||"string"==typeof e.withdrawer_address&&"bigint"==typeof e.pool_id&&n.Coin.isAmino(e.pool_coin)),encode:(e,t=i.BinaryWriter.create())=>(""!==e.withdrawerAddress&&t.uint32(10).string(e.withdrawerAddress),e.poolId!==BigInt(0)&&t.uint32(16).uint64(e.poolId),void 0!==e.poolCoin&&n.Coin.encode(e.poolCoin,t.uint32(26).fork()).ldelim(),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const o=u();for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:o.withdrawerAddress=r.string();break;case 2:o.poolId=r.uint64();break;case 3:o.poolCoin=n.Coin.decode(r,r.uint32());break;default:r.skipType(7&e)}}return o},fromJSON:e=>({withdrawerAddress:(0,s.isSet)(e.withdrawerAddress)?String(e.withdrawerAddress):"",poolId:(0,s.isSet)(e.poolId)?BigInt(e.poolId.toString()):BigInt(0),poolCoin:(0,s.isSet)(e.poolCoin)?n.Coin.fromJSON(e.poolCoin):void 0}),toJSON(e){const t={};return void 0!==e.withdrawerAddress&&(t.withdrawerAddress=e.withdrawerAddress),void 0!==e.poolId&&(t.poolId=(e.poolId||BigInt(0)).toString()),void 0!==e.poolCoin&&(t.poolCoin=e.poolCoin?n.Coin.toJSON(e.poolCoin):void 0),t},fromPartial(e){const t=u();return t.withdrawerAddress=e.withdrawerAddress??"",t.poolId=void 0!==e.poolId&&null!==e.poolId?BigInt(e.poolId.toString()):BigInt(0),t.poolCoin=void 0!==e.poolCoin&&null!==e.poolCoin?n.Coin.fromPartial(e.poolCoin):void 0,t},fromAmino(e){const t=u();return void 0!==e.withdrawer_address&&null!==e.withdrawer_address&&(t.withdrawerAddress=e.withdrawer_address),void 0!==e.pool_id&&null!==e.pool_id&&(t.poolId=BigInt(e.pool_id)),void 0!==e.pool_coin&&null!==e.pool_coin&&(t.poolCoin=n.Coin.fromAmino(e.pool_coin)),t},toAmino(e){const t={};return t.withdrawer_address=""===e.withdrawerAddress?void 0:e.withdrawerAddress,t.pool_id=e.poolId!==BigInt(0)?e.poolId.toString():void 0,t.pool_coin=e.poolCoin?n.Coin.toAmino(e.poolCoin):void 0,t},fromAminoMsg:e=>t.nb.fromAmino(e.value),fromProtoMsg:e=>t.nb.decode(e.value),toProto:e=>t.nb.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgWithdrawWithinBatch",value:t.nb.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.nb.typeUrl,t.nb),t.Ei={typeUrl:"/cyber.liquidity.v1beta1.MsgWithdrawWithinBatchResponse",is:e=>e&&e.$typeUrl===t.Ei.typeUrl,isSDK:e=>e&&e.$typeUrl===t.Ei.typeUrl,isAmino:e=>e&&e.$typeUrl===t.Ei.typeUrl,encode:(e,t=i.BinaryWriter.create())=>t,decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={};for(;r.pos<n;){const e=r.uint32();r.skipType(7&e)}return s},fromJSON:e=>({}),toJSON:e=>({}),fromPartial:e=>({}),fromAmino:e=>({}),toAmino:e=>({}),fromAminoMsg:e=>t.Ei.fromAmino(e.value),fromProtoMsg:e=>t.Ei.decode(e.value),toProto:e=>t.Ei.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgWithdrawWithinBatchResponse",value:t.Ei.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.Ei.typeUrl,t.Ei),t.AS={typeUrl:"/cyber.liquidity.v1beta1.MsgSwapWithinBatch",is:e=>e&&(e.$typeUrl===t.AS.typeUrl||"string"==typeof e.swapRequesterAddress&&"bigint"==typeof e.poolId&&"number"==typeof e.swapTypeId&&n.Coin.is(e.offerCoin)&&"string"==typeof e.demandCoinDenom&&n.Coin.is(e.offerCoinFee)&&"string"==typeof e.orderPrice),isSDK:e=>e&&(e.$typeUrl===t.AS.typeUrl||"string"==typeof e.swap_requester_address&&"bigint"==typeof e.pool_id&&"number"==typeof e.swap_type_id&&n.Coin.isSDK(e.offer_coin)&&"string"==typeof e.demand_coin_denom&&n.Coin.isSDK(e.offer_coin_fee)&&"string"==typeof e.order_price),isAmino:e=>e&&(e.$typeUrl===t.AS.typeUrl||"string"==typeof e.swap_requester_address&&"bigint"==typeof e.pool_id&&"number"==typeof e.swap_type_id&&n.Coin.isAmino(e.offer_coin)&&"string"==typeof e.demand_coin_denom&&n.Coin.isAmino(e.offer_coin_fee)&&"string"==typeof e.order_price),encode:(e,t=i.BinaryWriter.create())=>(""!==e.swapRequesterAddress&&t.uint32(10).string(e.swapRequesterAddress),e.poolId!==BigInt(0)&&t.uint32(16).uint64(e.poolId),0!==e.swapTypeId&&t.uint32(24).uint32(e.swapTypeId),void 0!==e.offerCoin&&n.Coin.encode(e.offerCoin,t.uint32(34).fork()).ldelim(),""!==e.demandCoinDenom&&t.uint32(42).string(e.demandCoinDenom),void 0!==e.offerCoinFee&&n.Coin.encode(e.offerCoinFee,t.uint32(50).fork()).ldelim(),""!==e.orderPrice&&t.uint32(58).string(a.Decimal.fromUserInput(e.orderPrice,18).atomics),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const o=l();for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:o.swapRequesterAddress=r.string();break;case 2:o.poolId=r.uint64();break;case 3:o.swapTypeId=r.uint32();break;case 4:o.offerCoin=n.Coin.decode(r,r.uint32());break;case 5:o.demandCoinDenom=r.string();break;case 6:o.offerCoinFee=n.Coin.decode(r,r.uint32());break;case 7:o.orderPrice=a.Decimal.fromAtomics(r.string(),18).toString();break;default:r.skipType(7&e)}}return o},fromJSON:e=>({swapRequesterAddress:(0,s.isSet)(e.swapRequesterAddress)?String(e.swapRequesterAddress):"",poolId:(0,s.isSet)(e.poolId)?BigInt(e.poolId.toString()):BigInt(0),swapTypeId:(0,s.isSet)(e.swapTypeId)?Number(e.swapTypeId):0,offerCoin:(0,s.isSet)(e.offerCoin)?n.Coin.fromJSON(e.offerCoin):void 0,demandCoinDenom:(0,s.isSet)(e.demandCoinDenom)?String(e.demandCoinDenom):"",offerCoinFee:(0,s.isSet)(e.offerCoinFee)?n.Coin.fromJSON(e.offerCoinFee):void 0,orderPrice:(0,s.isSet)(e.orderPrice)?String(e.orderPrice):""}),toJSON(e){const t={};return void 0!==e.swapRequesterAddress&&(t.swapRequesterAddress=e.swapRequesterAddress),void 0!==e.poolId&&(t.poolId=(e.poolId||BigInt(0)).toString()),void 0!==e.swapTypeId&&(t.swapTypeId=Math.round(e.swapTypeId)),void 0!==e.offerCoin&&(t.offerCoin=e.offerCoin?n.Coin.toJSON(e.offerCoin):void 0),void 0!==e.demandCoinDenom&&(t.demandCoinDenom=e.demandCoinDenom),void 0!==e.offerCoinFee&&(t.offerCoinFee=e.offerCoinFee?n.Coin.toJSON(e.offerCoinFee):void 0),void 0!==e.orderPrice&&(t.orderPrice=e.orderPrice),t},fromPartial(e){const t=l();return t.swapRequesterAddress=e.swapRequesterAddress??"",t.poolId=void 0!==e.poolId&&null!==e.poolId?BigInt(e.poolId.toString()):BigInt(0),t.swapTypeId=e.swapTypeId??0,t.offerCoin=void 0!==e.offerCoin&&null!==e.offerCoin?n.Coin.fromPartial(e.offerCoin):void 0,t.demandCoinDenom=e.demandCoinDenom??"",t.offerCoinFee=void 0!==e.offerCoinFee&&null!==e.offerCoinFee?n.Coin.fromPartial(e.offerCoinFee):void 0,t.orderPrice=e.orderPrice??"",t},fromAmino(e){const t=l();return void 0!==e.swap_requester_address&&null!==e.swap_requester_address&&(t.swapRequesterAddress=e.swap_requester_address),void 0!==e.pool_id&&null!==e.pool_id&&(t.poolId=BigInt(e.pool_id)),void 0!==e.swap_type_id&&null!==e.swap_type_id&&(t.swapTypeId=e.swap_type_id),void 0!==e.offer_coin&&null!==e.offer_coin&&(t.offerCoin=n.Coin.fromAmino(e.offer_coin)),void 0!==e.demand_coin_denom&&null!==e.demand_coin_denom&&(t.demandCoinDenom=e.demand_coin_denom),void 0!==e.offer_coin_fee&&null!==e.offer_coin_fee&&(t.offerCoinFee=n.Coin.fromAmino(e.offer_coin_fee)),void 0!==e.order_price&&null!==e.order_price&&(t.orderPrice=e.order_price),t},toAmino(e){const t={};return t.swap_requester_address=""===e.swapRequesterAddress?void 0:e.swapRequesterAddress,t.pool_id=e.poolId!==BigInt(0)?e.poolId.toString():void 0,t.swap_type_id=0===e.swapTypeId?void 0:e.swapTypeId,t.offer_coin=e.offerCoin?n.Coin.toAmino(e.offerCoin):void 0,t.demand_coin_denom=""===e.demandCoinDenom?void 0:e.demandCoinDenom,t.offer_coin_fee=e.offerCoinFee?n.Coin.toAmino(e.offerCoinFee):void 0,t.order_price=""===e.orderPrice?void 0:e.orderPrice,t},fromAminoMsg:e=>t.AS.fromAmino(e.value),fromProtoMsg:e=>t.AS.decode(e.value),toProto:e=>t.AS.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgSwapWithinBatch",value:t.AS.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.AS.typeUrl,t.AS),t.NU={typeUrl:"/cyber.liquidity.v1beta1.MsgSwapWithinBatchResponse",is:e=>e&&e.$typeUrl===t.NU.typeUrl,isSDK:e=>e&&e.$typeUrl===t.NU.typeUrl,isAmino:e=>e&&e.$typeUrl===t.NU.typeUrl,encode:(e,t=i.BinaryWriter.create())=>t,decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={};for(;r.pos<n;){const e=r.uint32();r.skipType(7&e)}return s},fromJSON:e=>({}),toJSON:e=>({}),fromPartial:e=>({}),fromAmino:e=>({}),toAmino:e=>({}),fromAminoMsg:e=>t.NU.fromAmino(e.value),fromProtoMsg:e=>t.NU.decode(e.value),toProto:e=>t.NU.encode(e).finish(),toProtoMsg:e=>({typeUrl:"/cyber.liquidity.v1beta1.MsgSwapWithinBatchResponse",value:t.NU.encode(e).finish()})},o.GlobalDecoderRegistry.register(t.NU.typeUrl,t.NU)},27537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uint64=t.Uint53=t.Uint32=t.Int53=t.Decimal=void 0;var n=r(21690);Object.defineProperty(t,"Decimal",{enumerable:!0,get:function(){return n.Decimal}});var i=r(62038);Object.defineProperty(t,"Int53",{enumerable:!0,get:function(){return i.Int53}}),Object.defineProperty(t,"Uint32",{enumerable:!0,get:function(){return i.Uint32}}),Object.defineProperty(t,"Uint53",{enumerable:!0,get:function(){return i.Uint53}}),Object.defineProperty(t,"Uint64",{enumerable:!0,get:function(){return i.Uint64}})},40796:function(e,t,r){"use strict";const{fromCallback:n}=r(78100),i=r(20266),{getCallback:s,getOptions:o}=r(61343),a=Symbol("promise"),c=Symbol("status"),u=Symbol("operations"),l=Symbol("finishClose"),h=Symbol("closeCallbacks");t.AbstractChainedBatch=class{constructor(e){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}this[u]=[],this[h]=[],this[c]="open",this[l]=this[l].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[u].length}put(e,t,r){if("open"!==this[c])throw new i("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;const s=r&&null!=r.sublevel?r.sublevel:this.db,o=r,a=s.keyEncoding(r&&r.keyEncoding),l=s.valueEncoding(r&&r.valueEncoding),h=a.format;r={...r,keyEncoding:h,valueEncoding:l.format},s!==this.db&&(r.sublevel=null);const d=s.prefixKey(a.encode(e),h),f=l.encode(t);return this._put(d,f,r),this[u].push({...o,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if("open"!==this[c])throw new i("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const n=t&&null!=t.sublevel?t.sublevel:this.db,s=t,o=n.keyEncoding(t&&t.keyEncoding),a=o.format;return t={...t,keyEncoding:a},n!==this.db&&(t.sublevel=null),this._del(n.prefixKey(o.encode(e),a),t),this[u].push({...s,type:"del",key:e}),this}_del(e,t){}clear(){if("open"!==this[c])throw new i("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[u]=[],this}_clear(){}write(e,t){return t=s(e,t),t=n(t,a),e=o(e),"open"!==this[c]?this.nextTick(t,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(t):(this[c]="writing",this._write(e,(e=>{this[c]="closing",this[h].push((()=>t(e))),e||this.db.emit("batch",this[u]),this._close(this[l])}))),t[a]}_write(e,t){}close(e){return e=n(e,a),"closing"===this[c]?this[h].push(e):"closed"===this[c]?this.nextTick(e):(this[h].push(e),"writing"!==this[c]&&(this[c]="closing",this._close(this[l]))),e[a]}_close(e){this.nextTick(e)}[l](){this[c]="closed",this.db.detachResource(this);const e=this[h];this[h]=[];for(const t of e)t()}}},63527:function(e,t,r){"use strict";var n=r(96763);const{fromCallback:i}=r(78100),s=r(20266),{getOptions:o,getCallback:a}=r(61343),c=Symbol("promise"),u=Symbol("callback"),l=Symbol("working"),h=Symbol("handleOne"),d=Symbol("handleMany"),f=Symbol("autoClose"),p=Symbol("finishWork"),y=Symbol("returnMany"),g=Symbol("closing"),m=Symbol("handleClose"),b=Symbol("closed"),w=Symbol("closeCallbacks"),v=Symbol("keyEncoding"),_=Symbol("valueEncoding"),E=Symbol("abortOnClose"),S=Symbol("legacy"),x=Symbol("keys"),A=Symbol("values"),k=Symbol("limit"),I=Symbol("count"),T=Object.freeze({}),P=()=>{};let C=!1;class R{constructor(e,t,r){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}if("object"!=typeof t||null===t)throw new TypeError("The second argument must be an options object");this[b]=!1,this[w]=[],this[l]=!1,this[g]=!1,this[f]=!1,this[u]=null,this[h]=this[h].bind(this),this[d]=this[d].bind(this),this[m]=this[m].bind(this),this[v]=t[v],this[_]=t[_],this[S]=r,this[k]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[I]=0,this[E]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[I]}get limit(){return this[k]}next(e){let t;if(void 0===e)t=new Promise(((t,r)=>{e=(e,n,i)=>{e?r(e):this[S]?void 0===n&&void 0===i?t():t([n,i]):t(n)}}));else if("function"!=typeof e)throw new TypeError("Callback must be a function");return this[g]?this.nextTick(e,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(e,new s("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[u]=e,this[I]>=this[k]?this.nextTick(this[h],null):this._next(this[h])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=a(t,r),r=i(r,c),t=o(t,T),Number.isInteger(e)?(this[g]?this.nextTick(r,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(r,new s("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[k]<1/0&&(e=Math.min(e,this[k]-this[I])),this[l]=!0,this[u]=r,e<=0?this.nextTick(this[d],null,[]):this._nextv(e,t,this[d])),r[c]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[c])}_nextv(e,t,r){const n=[],i=(t,s,o)=>t?r(t):(this[S]?void 0===s&&void 0===o:void 0===s)?r(null,n):(n.push(this[S]?[s,o]:s),void(n.length===e?r(null,n):this._next(i)));this._next(i)}all(e,t){return t=a(e,t),t=i(t,c),e=o(e,T),this[g]?this.nextTick(t,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(t,new s("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[u]=t,this[f]=!0,this[I]>=this[k]?this.nextTick(this[d],null,[]):this._all(e,this[d])),t[c]}_all(e,t){let r=this[I];const n=[],i=()=>{const e=this[k]<1/0?Math.min(1e3,this[k]-r):1e3;e<=0?this.nextTick(t,null,n):this._nextv(e,T,s)},s=(e,s)=>{e?t(e):0===s.length?t(null,n):(n.push.apply(n,s),r+=s.length,i())};i()}[p](){const e=this[u];return this[E]&&null===e?P:(this[l]=!1,this[u]=null,this[g]&&this._close(this[m]),e)}[y](e,t,r){this[f]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=o(t,T),this[g]);else{if(this[l])throw new s("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[v]),n=r.format;t.keyEncoding!==n&&(t={...t,keyEncoding:n});const i=this.db.prefixKey(r.encode(e),n);this._seek(i,t)}}}_seek(e,t){throw new s("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){if(e=i(e,c),this[b])this.nextTick(e);else if(this[g])this[w].push(e);else if(this[g]=!0,this[w].push(e),this[l]){if(this[E]){this[p]()(new s("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[m]);return e[c]}_close(e){this.nextTick(e)}[m](){this[b]=!0,this.db.detachResource(this);const e=this[w];this[w]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;void 0!==(e=await this.next());)yield e}finally{this[b]||await this.close()}}}class O extends R{constructor(e,t){super(e,t,!0),this[x]=!1!==t.keys,this[A]=!1!==t.values}[h](e,t,r){const n=this[p]();if(e)return n(e);try{t=this[x]&&void 0!==t?this[v].decode(t):void 0,r=this[A]&&void 0!==r?this[_].decode(r):void 0}catch(e){return n(new D("entry",e))}void 0===t&&void 0===r||this[I]++,n(null,t,r)}[d](e,t){const r=this[p]();if(e)return this[y](r,e);try{for(const e of t){const t=e[0],r=e[1];e[0]=this[x]&&void 0!==t?this[v].decode(t):void 0,e[1]=this[A]&&void 0!==r?this[_].decode(r):void 0}}catch(e){return this[y](r,new D("entries",e))}this[I]+=t.length,this[y](r,null,t)}end(e){return C||void 0===n||(C=!0,n.warn(new s("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}}class D extends s{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const e of["_ended property","_nexting property","_end method"])Object.defineProperty(O.prototype,e.split(" ")[0],{get(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})}});O.keyEncoding=v,O.valueEncoding=_,t.AbstractIterator=O,t.AbstractKeyIterator=class extends R{constructor(e,t){super(e,t,!1)}[h](e,t){const r=this[p]();if(e)return r(e);try{t=void 0!==t?this[v].decode(t):void 0}catch(e){return r(new D("key",e))}void 0!==t&&this[I]++,r(null,t)}[d](e,t){const r=this[p]();if(e)return this[y](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[v].decode(r):void 0}}catch(e){return this[y](r,new D("keys",e))}this[I]+=t.length,this[y](r,null,t)}},t.AbstractValueIterator=class extends R{constructor(e,t){super(e,t,!1)}[h](e,t){const r=this[p]();if(e)return r(e);try{t=void 0!==t?this[_].decode(t):void 0}catch(e){return r(new D("value",e))}void 0!==t&&this[I]++,r(null,t)}[d](e,t){const r=this[p]();if(e)return this[y](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[_].decode(r):void 0}}catch(e){return this[y](r,new D("values",e))}this[I]+=t.length,this[y](r,null,t)}}},91983:function(e,t,r){"use strict";const{supports:n}=r(25356),{Transcoder:i}=r(36035),{EventEmitter:s}=r(37007),{fromCallback:o}=r(78100),a=r(20266),{AbstractIterator:c}=r(63527),{DefaultKeyIterator:u,DefaultValueIterator:l}=r(85682),{DeferredIterator:h,DeferredKeyIterator:d,DeferredValueIterator:f}=r(4416),{DefaultChainedBatch:p}=r(47050),{getCallback:y,getOptions:g}=r(61343),m=r(386),b=Symbol("promise"),w=Symbol("landed"),v=Symbol("resources"),_=Symbol("closeResources"),E=Symbol("operations"),S=Symbol("undefer"),x=Symbol("deferOpen"),A=Symbol("options"),k=Symbol("status"),I=Symbol("defaultOptions"),T=Symbol("transcoder"),P=Symbol("keyEncoding"),C=Symbol("valueEncoding"),R=()=>{};class O extends s{constructor(e,t){if(super(),"object"!=typeof e||null===e)throw new TypeError("The first argument 'manifest' must be an object");t=g(t);const{keyEncoding:r,valueEncoding:s,passive:o,...a}=t;this[v]=new Set,this[E]=[],this[x]=!0,this[A]=a,this[k]="opening",this.supports=n(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==e.snapshots,permanence:!1!==e.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new i(N(this)),this[P]=this[T].encoding(r||"utf8"),this[C]=this[T].encoding(s||"utf8");for(const e of this[T].encodings())this.supports.encodings[e.commonName]||(this.supports.encodings[e.commonName]=!0);this[I]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[P].commonName,valueEncoding:this[C].commonName}),key:Object.freeze({keyEncoding:this[P].commonName})},this.nextTick((()=>{this[x]&&this.open({passive:!1},R)}))}get status(){return this[k]}keyEncoding(e){return this[T].encoding(null!=e?e:this[P])}valueEncoding(e){return this[T].encoding(null!=e?e:this[C])}open(e,t){t=y(e,t),t=o(t,b),(e={...this[A],...g(e)}).createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists;const r=e=>{"closing"===this[k]||"opening"===this[k]?this.once(w,e?()=>r(e):r):"open"!==this[k]?t(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:e})):t()};return e.passive?"opening"===this[k]?this.once(w,r):this.nextTick(r):"closed"===this[k]||this[x]?(this[x]=!1,this[k]="opening",this.emit("opening"),this._open(e,(e=>{if(e)return this[k]="closed",this[_]((()=>{this.emit(w),r(e)})),void this[S]();this[k]="open",this[S](),this.emit(w),"open"===this[k]&&this.emit("open"),"open"===this[k]&&this.emit("ready"),r()}))):"open"===this[k]?this.nextTick(r):this.once(w,(()=>this.open(e,t))),t[b]}_open(e,t){this.nextTick(t)}close(e){e=o(e,b);const t=r=>{"opening"===this[k]||"closing"===this[k]?this.once(w,r?t(r):t):"closed"!==this[k]?e(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if("open"===this[k]){this[k]="closing",this.emit("closing");const e=e=>{this[k]="open",this[S](),this.emit(w),t(e)};this[_]((()=>{this._close((r=>{if(r)return e(r);this[k]="closed",this[S](),this.emit(w),"closed"===this[k]&&this.emit("closed"),t()}))}))}else"closed"===this[k]?this.nextTick(t):this.once(w,(()=>this.close(e)));return e[b]}[_](e){if(0===this[v].size)return this.nextTick(e);let t=this[v].size,r=!0;const n=()=>{0==--t&&(r?this.nextTick(e):e())};for(const e of this[v])e.close(n);r=!1,this[v].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=y(t,r),r=o(r,b),t=g(t,this[I].entry),"opening"===this[k])return this.defer((()=>this.get(e,t,r))),r[b];if(B(this,r))return r[b];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),c=i.format,u=s.format;return t.keyEncoding===c&&t.valueEncoding===u||(t=Object.assign({},t,{keyEncoding:c,valueEncoding:u})),this._get(this.prefixKey(i.encode(e),c),t,((e,t)=>{if(e)return("LEVEL_NOT_FOUND"===e.code||e.notFound||/NotFound/i.test(e))&&(e.code||(e.code="LEVEL_NOT_FOUND"),e.notFound||(e.notFound=!0),e.status||(e.status=404)),r(e);try{t=s.decode(t)}catch(e){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[b]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=y(t,r),r=o(r,b),t=g(t,this[I].entry),"opening"===this[k])return this.defer((()=>this.getMany(e,t,r))),r[b];if(B(this,r))return r[b];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[b];if(0===e.length)return this.nextTick(r,null,[]),r[b];const n=this.keyEncoding(t.keyEncoding),i=this.valueEncoding(t.valueEncoding),s=n.format,c=i.format;t.keyEncoding===s&&t.valueEncoding===c||(t=Object.assign({},t,{keyEncoding:s,valueEncoding:c}));const u=new Array(e.length);for(let t=0;t<e.length;t++){const i=e[t],o=this._checkKey(i);if(o)return this.nextTick(r,o),r[b];u[t]=this.prefixKey(n.encode(i),s)}return this._getMany(u,t,((e,t)=>{if(e)return r(e);try{for(let e=0;e<t.length;e++)void 0!==t[e]&&(t[e]=i.decode(t[e]))}catch(e){return r(new a(`Could not decode one or more of ${t.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[b]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,n){if(n=y(r,n),n=o(n,b),r=g(r,this[I].entry),"opening"===this[k])return this.defer((()=>this.put(e,t,r,n))),n[b];if(B(this,n))return n[b];const i=this._checkKey(e)||this._checkValue(t);if(i)return this.nextTick(n,i),n[b];const s=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),c=s.format,u=a.format;r.keyEncoding===c&&r.valueEncoding===u||(r=Object.assign({},r,{keyEncoding:c,valueEncoding:u}));const l=this.prefixKey(s.encode(e),c),h=a.encode(t);return this._put(l,h,r,(r=>{if(r)return n(r);this.emit("put",e,t),n()})),n[b]}_put(e,t,r,n){this.nextTick(n)}del(e,t,r){if(r=y(t,r),r=o(r,b),t=g(t,this[I].key),"opening"===this[k])return this.defer((()=>this.del(e,t,r))),r[b];if(B(this,r))return r[b];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(t.keyEncoding),s=i.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(i.encode(e),s),t,(t=>{if(t)return r(t);this.emit("del",e),r()})),r[b]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if("opening"===this[k])return new p(this);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"==typeof e?e:y(t,r),r=o(r,b),t=g(t,this[I].empty),"opening"===this[k])return this.defer((()=>this.batch(e,t,r))),r[b];if(B(this,r))return r[b];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[b];if(0===e.length)return this.nextTick(r),r[b];const n=new Array(e.length),{keyEncoding:i,valueEncoding:s,...c}=t;for(let t=0;t<e.length;t++){if("object"!=typeof e[t]||null===e[t])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[b];const o=Object.assign({},e[t]);if("put"!==o.type&&"del"!==o.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[b];const a=this._checkKey(o.key);if(a)return this.nextTick(r,a),r[b];const c=null!=o.sublevel?o.sublevel:this,u=c.keyEncoding(o.keyEncoding||i),l=u.format;if(o.key=c.prefixKey(u.encode(o.key),l),o.keyEncoding=l,"put"===o.type){const e=this._checkValue(o.value);if(e)return this.nextTick(r,e),r[b];const t=c.valueEncoding(o.valueEncoding||s);o.value=t.encode(o.value),o.valueEncoding=t.format}c!==this&&(o.sublevel=null),n[t]=o}return this._batch(n,c,(t=>{if(t)return r(t);this.emit("batch",e),r()})),r[b]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,D.defaults(t))}_sublevel(e,t){return new D(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=y(e,t),t=o(t,b),e=g(e,this[I].empty),"opening"===this[k])return this.defer((()=>this.clear(e,t))),t[b];if(B(this,t))return t[b];const r=e,n=this.keyEncoding(e.keyEncoding);return(e=m(e,n)).keyEncoding=n.format,0===e.limit?this.nextTick(t):this._clear(e,(e=>{if(e)return t(e);this.emit("clear",r),t()})),t[b]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=m(e,t)).keys=!1!==e.keys,e.values=!1!==e.values,e[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new h(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new c(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=m(e,t))[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new d(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new u(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=m(e,t))[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new f(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new l(this,e)}defer(e){if("function"!=typeof e)throw new TypeError("The first argument must be a function");this[E].push(e)}[S](){if(0===this[E].length)return;const e=this[E];this[E]=[];for(const t of e)t()}attachResource(e){if("object"!=typeof e||null===e||"function"!=typeof e.close)throw new TypeError("The first argument must be a resource object");this[v].add(e)}detachResource(e){this[v].delete(e)}_chainedBatch(){return new p(this)}_checkKey(e){if(null==e)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(null==e)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}O.prototype.nextTick=r(20028);const{AbstractSublevel:D}=r(99933)({AbstractLevel:O});t.AbstractLevel=O,t.AbstractSublevel=D;const B=function(e,t){return"open"!==e[k]&&(e.nextTick(t,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},N=function(e){return Object.keys(e.supports.encodings).filter((t=>!!e.supports.encodings[t]))}},75e3:function(e,t,r){"use strict";t.AbstractLevel=r(91983).AbstractLevel,t.AbstractSublevel=r(91983).AbstractSublevel,t.AbstractIterator=r(63527).AbstractIterator,t.AbstractKeyIterator=r(63527).AbstractKeyIterator,t.AbstractValueIterator=r(63527).AbstractValueIterator,t.AbstractChainedBatch=r(40796).AbstractChainedBatch},84716:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:s}=r(63527),o=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),u=Symbol("handleMany"),l=Symbol("callback");class h extends n{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[l]=null}[c](e,t,r){const n=this[l];if(e)return n(e);void 0!==t&&(t=this[o](t)),n(e,t,r)}[u](e,t){const r=this[l];if(e)return r(e);for(const e of t){const t=e[0];void 0!==t&&(e[0]=this[o](t))}r(e,t)}}class d extends i{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[l]=null}[c](e,t){const r=this[l];if(e)return r(e);void 0!==t&&(t=this[o](t)),r(e,t)}[u](e,t){const r=this[l];if(e)return r(e);for(let e=0;e<t.length;e++){const r=t[e];void 0!==r&&(t[e]=this[o](r))}r(e,t)}}class f extends s{constructor(e,t,r){super(e,t),this[a]=r}}for(const e of[h,d])e.prototype._next=function(e){this[l]=e,this[a].next(this[c])},e.prototype._nextv=function(e,t,r){this[l]=r,this[a].nextv(e,t,this[u])},e.prototype._all=function(e,t){this[l]=t,this[a].all(e,this[u])};for(const e of[f])e.prototype._next=function(e){this[a].next(e)},e.prototype._nextv=function(e,t,r){this[a].nextv(e,t,r)},e.prototype._all=function(e,t){this[a].all(e,t)};for(const e of[h,d,f])e.prototype._seek=function(e,t){this[a].seek(e,t)},e.prototype._close=function(e){this[a].close(e)};t.AbstractSublevelIterator=h,t.AbstractSublevelKeyIterator=d,t.AbstractSublevelValueIterator=f},99933:function(e,t,r){"use strict";const n=r(20266),{Buffer:i}=r(91042)||{},{AbstractSublevelIterator:s,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:a}=r(84716),c=Symbol("prefix"),u=Symbol("upperBound"),l=Symbol("prefixRange"),h=Symbol("parent"),d=Symbol("unfix"),f=new TextEncoder,p={separator:"!"};e.exports=function({AbstractLevel:e}){class t extends e{static defaults(e){if("string"==typeof e)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?p:e.separator?e:{...e,separator:"!"}}constructor(e,r,i){const{separator:s,manifest:o,...a}=t.defaults(i);r=w(r,s);const l=s.charCodeAt(0)+1,p=e[h]||e;if(!f.encode(r).every((e=>e>l&&e<127)))throw new n(`Prefix must use bytes > ${l} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(y(p,o),a);const g=(e.prefix||"")+s+r+s,v=g.slice(0,-1)+String.fromCharCode(l);this[h]=p,this[c]=new m(g),this[u]=new m(v),this[d]=new b,this.nextTick=p.nextTick}prefixKey(e,t){if("utf8"===t)return this[c].utf8+e;if(0===e.byteLength)return this[c][t];if("view"===t){const t=this[c].view,r=new Uint8Array(t.byteLength+e.byteLength);return r.set(t,0),r.set(e,t.byteLength),r}{const t=this[c].buffer;return i.concat([t,e],t.byteLength+e.byteLength)}}[l](e,t){void 0!==e.gte?e.gte=this.prefixKey(e.gte,t):void 0!==e.gt?e.gt=this.prefixKey(e.gt,t):e.gte=this[c][t],void 0!==e.lte?e.lte=this.prefixKey(e.lte,t):void 0!==e.lt?e.lt=this.prefixKey(e.lt,t):e.lte=this[u][t]}get prefix(){return this[c].utf8}get db(){return this[h]}_open(e,t){this[h].open({passive:!0},t)}_put(e,t,r,n){this[h].put(e,t,r,n)}_get(e,t,r){this[h].get(e,t,r)}_getMany(e,t,r){this[h].getMany(e,t,r)}_del(e,t,r){this[h].del(e,t,r)}_batch(e,t,r){this[h].batch(e,t,r)}_clear(e,t){this[l](e,e.keyEncoding),this[h].clear(e,t)}_iterator(e){this[l](e,e.keyEncoding);const t=this[h].iterator(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new s(this,e,t,r)}_keys(e){this[l](e,e.keyEncoding);const t=this[h].keys(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new o(this,e,t,r)}_values(e){this[l](e,e.keyEncoding);const t=this[h].values(e);return new a(this,e,t)}}return{AbstractSublevel:t}};const y=function(e,t){return{...e.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...t,encodings:{utf8:g(e,"utf8"),buffer:g(e,"buffer"),view:g(e,"view")}}},g=function(e,t){return!!e.supports.encodings[t]&&e.keyEncoding(t).name===t};class m{constructor(e){this.utf8=e,this.view=f.encode(e),this.buffer=i?i.from(this.view.buffer,0,this.view.byteLength):{}}}class b{constructor(){this.cache=new Map}get(e,t){let r=this.cache.get(t);return void 0===r&&(r="view"===t?function(e,t){return t.subarray(e)}.bind(null,e):function(e,t){return t.slice(e)}.bind(null,e),this.cache.set(t,r)),r}}const w=function(e,t){let r=0,n=e.length;for(;r<n&&e[r]===t;)r++;for(;n>r&&e[n-1]===t;)n--;return e.slice(r,n)}},61343:function(e,t){"use strict";t.getCallback=function(e,t){return"function"==typeof e?e:t},t.getOptions=function(e,t){return"object"==typeof e&&null!==e?e:void 0!==t?t:{}}},47050:function(e,t,r){"use strict";const{AbstractChainedBatch:n}=r(40796),i=r(20266),s=Symbol("encoded");t.DefaultChainedBatch=class extends n{constructor(e){super(e),this[s]=[]}_put(e,t,r){this[s].push({...r,type:"put",key:e,value:t})}_del(e,t){this[s].push({...t,type:"del",key:e})}_clear(){this[s]=[]}_write(e,t){"opening"===this.db.status?this.db.defer((()=>this._write(e,t))):"open"===this.db.status?0===this[s].length?this.nextTick(t):this.db._batch(this[s],e,t):this.nextTick(t,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},85682:function(e,t,r){"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:i}=r(63527),s=Symbol("iterator"),o=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class u extends n{constructor(e,t){super(e,t),this[s]=e.iterator({...t,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class l extends i{constructor(e,t){super(e,t),this[s]=e.iterator({...t,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const e of[u,l]){const t=e===u,r=t?e=>e[0]:e=>e[1];e.prototype._next=function(e){this[o]=e,this[s].next(this[a])},e.prototype[a]=function(e,r,n){const i=this[o];e?i(e):i(null,t?r:n)},e.prototype._nextv=function(e,t,r){this[o]=r,this[s].nextv(e,t,this[c])},e.prototype._all=function(e,t){this[o]=t,this[s].all(e,this[c])},e.prototype[c]=function(e,t){const n=this[o];e?n(e):n(null,t.map(r))},e.prototype._seek=function(e,t){this[s].seek(e,t)},e.prototype._close=function(e){this[s].close(e)}}t.DefaultKeyIterator=u,t.DefaultValueIterator=l},4416:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:s}=r(63527),o=r(20266),a=Symbol("nut"),c=Symbol("undefer"),u=Symbol("factory");class l extends n{constructor(e,t){super(e,t),this[a]=null,this[u]=()=>e.iterator(t),this.db.defer((()=>this[c]()))}}class h extends i{constructor(e,t){super(e,t),this[a]=null,this[u]=()=>e.keys(t),this.db.defer((()=>this[c]()))}}class d extends s{constructor(e,t){super(e,t),this[a]=null,this[u]=()=>e.values(t),this.db.defer((()=>this[c]()))}}for(const e of[l,h,d])e.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[u]())},e.prototype._next=function(e){null!==this[a]?this[a].next(e):"opening"===this.db.status?this.db.defer((()=>this._next(e))):this.nextTick(e,new o("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._nextv=function(e,t,r){null!==this[a]?this[a].nextv(e,t,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(e,t,r))):this.nextTick(r,new o("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._all=function(e,t){null!==this[a]?this[a].all(t):"opening"===this.db.status?this.db.defer((()=>this._all(e,t))):this.nextTick(t,new o("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._seek=function(e,t){null!==this[a]?this[a]._seek(e,t):"opening"===this.db.status&&this.db.defer((()=>this._seek(e,t)))},e.prototype._close=function(e){null!==this[a]?this[a].close(e):"opening"===this.db.status?this.db.defer((()=>this._close(e))):this.nextTick(e)};t.DeferredIterator=l,t.DeferredKeyIterator=h,t.DeferredValueIterator=d},20028:function(e,t,r){"use strict";const n=r(79596);e.exports=function(e,...t){0===t.length?n(e):n((()=>e(...t)))}},386:function(e,t,r){"use strict";const n=r(20266),i=Object.prototype.hasOwnProperty,s=new Set(["lt","lte","gt","gte"]);e.exports=function(e,t){const r={};for(const o in e)if(i.call(e,o)&&"keyEncoding"!==o&&"valueEncoding"!==o){if("start"===o||"end"===o)throw new n(`The legacy range option '${o}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===o)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});s.has(o)?r[o]=t.encode(e[o]):r[o]=e[o]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},91042:function(e,t,r){"use strict";var n=r(96763);const i=r(67526),s=r(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function c(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|g(e,t);let n=c(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return p(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);const i=function(e){if(u.isBuffer(e)){const t=0|y(e.length),r=c(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Z(e.length)?c(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),c(e<0?0:0|y(e))}function f(e){const t=e.length<0?0:0|y(e.length),r=c(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function y(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function g(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return n?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let s,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(u(e,s)===u(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(u(e,s+n)!==u(t,n)){r=!1;break}if(r)return s}return-1}function _(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Z(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return J(H(t,e.length-r),e,r,n)}function S(e,t,r,n){return J(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function x(e,t,r,n){return J(G(t),e,r,n)}function A(e,t,r,n){return J(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=T));return r}(n)}t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===n||"function"!=typeof n.error||n.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?c(e):void 0!==t?"string"==typeof r?c(e).fill(t,r):c(e).fill(t):c(e)}(e,t,r)},u.allocUnsafe=function(e){return d(e)},u.allocUnsafeSlow=function(e){return d(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(Y(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=u.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(Y(t,Uint8Array))i+t.length>n.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)b(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,i){if(Y(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==l[e]){s=c[e],o=l[e];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return x(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function P(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=X[e[n]];return i}function O(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,s){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function M(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function U(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,n,i){return t=+t,r>>>=0,i||U(e,0,r,4),s.write(e,t,r,n,23,4),r+4}function j(e,t,r,n,i){return t=+t,r>>>=0,i||U(e,0,r,8),s.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){B(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){B(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=Q((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=Q((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=Q((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=Q((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return j(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return j(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=u.isBuffer(e)?e:u.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const F={};function z(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function $(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,i,s)}function V(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw V(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=$(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=$(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function J(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Q(e){return"undefined"==typeof BigInt?ee:e}function ee(){throw new Error("BigInt not supported")}},44708:function(e){function t(e){const t=new globalThis.AbortController;function r(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",r)}for(const t of e)if(t&&t.addEventListener){if(t.aborted){r();break}t.addEventListener("abort",r)}return t.signal}e.exports=t,e.exports.anySignal=t},18121:function(e,t,r){"use strict";var n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function y(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=u-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function m(e,t,r,n){if(e<t||e>r||e!==s(e))throw Error(o+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(function e(t){var r,_,E,S,x,A,k,I,T,P,C=V.prototype={constructor:V,toString:null,valueOf:null},R=new V(1),O=20,D=4,B=-7,N=21,M=-1e7,U=1e7,L=!1,j=1,F=0,z={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},$="0123456789abcdefghijklmnopqrstuvwxyz",K=!0;function V(e,t){var r,i,o,c,h,d,f,p,y=this;if(!(y instanceof V))return new V(e,t);if(null==t){if(e&&!0===e._isBigNumber)return y.s=e.s,void(!e.c||e.e>U?y.c=y.e=null:e.e<M?y.c=[y.e=0]:(y.e=e.e,y.c=e.c.slice()));if((d="number"==typeof e)&&0*e==0){if(y.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,h=e;h>=10;h/=10,c++);return void(c>U?y.c=y.e=null:(y.e=c,y.c=[e]))}p=String(e)}else{if(!n.test(p=String(e)))return E(y,p,d);y.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(h=p.search(/e/i))>0?(c<0&&(c=h),c+=+p.slice(h+1),p=p.substring(0,h)):c<0&&(c=p.length)}else{if(m(t,2,$.length,"Base"),10==t&&K)return G(y=new V(e),O+y.e+1,D);if(p=String(e),d="number"==typeof e){if(0*e!=0)return E(y,p,d,t);if(y.s=1/e<0?(p=p.slice(1),-1):1,V.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else y.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=$.slice(0,t),c=h=0,f=p.length;h<f;h++)if(r.indexOf(i=p.charAt(h))<0){if("."==i){if(h>c){c=f;continue}}else if(!o&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){o=!0,h=-1,c=0;continue}return E(y,String(e),d,t)}d=!1,(c=(p=_(p,t,10,y.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(h=0;48===p.charCodeAt(h);h++);for(f=p.length;48===p.charCodeAt(--f););if(p=p.slice(h,++f)){if(f-=h,d&&V.DEBUG&&f>15&&(e>l||e!==s(e)))throw Error(a+y.s*e);if((c=c-h-1)>U)y.c=y.e=null;else if(c<M)y.c=[y.e=0];else{if(y.e=c,y.c=[],h=(c+1)%u,c<0&&(h+=u),h<f){for(h&&y.c.push(+p.slice(0,h)),f-=u;h<f;)y.c.push(+p.slice(h,h+=u));h=u-(p=p.slice(h)).length}else h-=f;for(;h--;p+="0");y.c.push(+p)}}else y.c=[y.e=0]}function q(e,t,r,n){var i,s,o,a,c;if(null==r?r=D:m(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=y(e.c),c=1==n||2==n&&(o<=B||o>=N)?w(c,o):v(c,o,"0");else if(s=(e=G(new V(e),t,r)).e,a=(c=y(e.c)).length,1==n||2==n&&(t<=s||s<=B)){for(;a<t;c+="0",a++);c=w(c,s)}else if(t-=o,c=v(c,s,"0"),s+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-a)>0)for(s+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function W(e,t){for(var r,n=1,i=new V(e[0]);n<e.length;n++){if(!(r=new V(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function H(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*u-1)>U?e.c=e.e=null:r<M?e.c=[e.e=0]:(e.e=r,e.c=t),e}function G(e,t,r,n){var o,a,l,d,f,p,y,g=e.c,m=h;if(g){e:{for(o=1,d=g[0];d>=10;d/=10,o++);if((a=t-o)<0)a+=u,l=t,y=(f=g[p=0])/m[o-l-1]%10|0;else if((p=i((a+1)/u))>=g.length){if(!n)break e;for(;g.length<=p;g.push(0));f=y=0,o=1,l=(a%=u)-u+1}else{for(f=d=g[p],o=1;d>=10;d/=10,o++);y=(l=(a%=u)-u+o)<0?0:f/m[o-l-1]%10|0}if(n=n||t<0||null!=g[p+1]||(l<0?f:f%m[o-l-1]),n=r<4?(y||n)&&(0==r||r==(e.s<0?3:2)):y>5||5==y&&(4==r||n||6==r&&(a>0?l>0?f/m[o-l]:0:g[p-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,n?(t-=e.e+1,g[0]=m[(u-t%u)%u],e.e=-t||0):g[0]=e.e=0,e;if(0==a?(g.length=p,d=1,p--):(g.length=p+1,d=m[u-a],g[p]=l>0?s(f/m[o-l]%m[l])*d:0),n)for(;;){if(0==p){for(a=1,l=g[0];l>=10;l/=10,a++);for(l=g[0]+=d,d=1;l>=10;l/=10,d++);a!=d&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=d,g[p]!=c)break;g[p--]=0,d=1}for(a=g.length;0===g[--a];g.pop());}e.e>U?e.c=e.e=null:e.e<M&&(e.c=[e.e=0])}return e}function J(e){var t,r=e.e;return null===r?e.toString():(t=y(e.c),t=r<=B||r>=N?w(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return V.clone=e,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(r=e[t],0,f,t),O=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(r=e[t],0,8,t),D=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(m(r[0],-f,0,t),m(r[1],0,f,t),B=r[0],N=r[1]):(m(r,-f,f,t),B=-(N=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)m(r[0],-f,-1,t),m(r[1],1,f,t),M=r[0],U=r[1];else{if(m(r,-f,f,t),!r)throw Error(o+t+" cannot be zero: "+r);M=-(U=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(o+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!r,Error(o+"crypto unavailable");L=r}else L=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(r=e[t],0,9,t),j=r),e.hasOwnProperty(t="POW_PRECISION")&&(m(r=e[t],0,f,t),F=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(o+t+" not an object: "+r);z=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+t+" invalid: "+r);K="0123456789"==r.slice(0,10),$=r}}return{DECIMAL_PLACES:O,ROUNDING_MODE:D,EXPONENTIAL_AT:[B,N],RANGE:[M,U],CRYPTO:L,MODULO_MODE:j,POW_PRECISION:F,FORMAT:z,ALPHABET:$}},V.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!V.DEBUG)return!0;var t,r,n=e.c,i=e.e,a=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===a||-1===a)&&i>=-f&&i<=f&&i===s(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=c||r!==s(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===a||1===a||-1===a))return!0;throw Error(o+"Invalid BigNumber: "+e)},V.maximum=V.max=function(){return W(arguments,C.lt)},V.minimum=V.min=function(){return W(arguments,C.gt)},V.random=(S=9007199254740992,x=Math.random()*S&2097151?function(){return s(Math.random()*S)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,a,c,l=0,d=[],p=new V(R);if(null==e?e=O:m(e,0,f),a=i(e/u),L)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[l]=r[0],t[l+1]=r[1]):(d.push(c%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw L=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);l<a;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(d.push(c%1e14),l+=7);l=a/7}if(!L)for(;l<a;)(c=x())<9e15&&(d[l++]=c%1e14);for(a=d[--l],e%=u,a&&e&&(c=h[u-e],d[l]=s(a/c)*c);0===d[l];d.pop(),l--);if(l<0)d=[n=0];else{for(n=-1;0===d[0];d.splice(0,1),n-=u);for(l=1,c=d[0];c>=10;c/=10,l++);l<u&&(n-=u-l)}return p.e=n,p.c=d,p}),V.sum=function(){for(var e=1,t=arguments,r=new V(t[0]);e<t.length;)r=r.plus(t[e++]);return r},_=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,l,h,d,f,p,g,m=n.indexOf("."),b=O,w=D;for(m>=0&&(h=F,F=0,n=n.replace(".",""),f=(g=new V(i)).pow(n.length-m),F=h,g.c=t(v(y(f.c),f.e,"0"),10,s,e),g.e=g.c.length),l=h=(p=t(n,i,s,a?(c=$,e):(c=e,$))).length;0==p[--h];p.pop());if(!p[0])return c.charAt(0);if(m<0?--l:(f.c=p,f.e=l,f.s=o,p=(f=r(f,g,b,w,s)).c,d=f.r,l=f.e),m=p[u=l+b+1],h=s/2,d=d||u<0||null!=p[u+1],d=w<4?(null!=m||d)&&(0==w||w==(f.s<0?3:2)):m>h||m==h&&(4==w||d||6==w&&1&p[u-1]||w==(f.s<0?8:7)),u<1||!p[0])n=d?v(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(p.length=u,d)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(h=p.length;!p[--h];);for(m=0,n="";m<=h;n+=c.charAt(p[m++]));n=v(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,u=t%d,l=t/d|0;for(e=e.slice();c--;)a=((i=u*(s=e[c]%d)+(n=l*s+(o=e[c]/d|0)*u)%d*d+a)/r|0)+(n/d|0)+l*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,o,a,l){var h,d,f,y,g,m,b,w,v,_,E,S,x,A,k,I,T,P=n.s==i.s?1:-1,C=n.c,R=i.c;if(!(C&&C[0]&&R&&R[0]))return new V(n.s&&i.s&&(C?!R||C[0]!=R[0]:R)?C&&0==C[0]||!R?0*P:P/0:NaN);for(v=(w=new V(P)).c=[],P=o+(d=n.e-i.e)+1,l||(l=c,d=p(n.e/u)-p(i.e/u),P=P/u|0),f=0;R[f]==(C[f]||0);f++);if(R[f]>(C[f]||0)&&d--,P<0)v.push(1),y=!0;else{for(A=C.length,I=R.length,f=0,P+=2,(g=s(l/(R[0]+1)))>1&&(R=e(R,g,l),C=e(C,g,l),I=R.length,A=C.length),x=I,E=(_=C.slice(0,I)).length;E<I;_[E++]=0);T=R.slice(),T=[0].concat(T),k=R[0],R[1]>=l/2&&k++;do{if(g=0,(h=t(R,_,I,E))<0){if(S=_[0],I!=E&&(S=S*l+(_[1]||0)),(g=s(S/k))>1)for(g>=l&&(g=l-1),b=(m=e(R,g,l)).length,E=_.length;1==t(m,_,b,E);)g--,r(m,I<b?T:R,b,l),b=m.length,h=1;else 0==g&&(h=g=1),b=(m=R.slice()).length;if(b<E&&(m=[0].concat(m)),r(_,m,E,l),E=_.length,-1==h)for(;t(R,_,I,E)<1;)g++,r(_,I<E?T:R,E,l),E=_.length}else 0===h&&(g++,_=[0]);v[f++]=g,_[0]?_[E++]=C[x]||0:(_=[C[x]],E=1)}while((x++<A||null!=_[0])&&P--);y=null!=_[0],v[0]||v.splice(0,1)}if(l==c){for(f=1,P=v[0];P>=10;P/=10,f++);G(w,o+(w.e=f+d*u-1)+1,a,y)}else w.e=d,w.r=+y;return w}}(),A=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,I=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(e,t,r,n){var i,s=r?t:t.replace(P,"");if(T.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(A,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(k,"$1").replace(I,"0.$1")),t!=s))return new V(s,i);if(V.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},C.absoluteValue=C.abs=function(){var e=new V(this);return e.s<0&&(e.s=1),e},C.comparedTo=function(e,t){return g(this,new V(e,t))},C.decimalPlaces=C.dp=function(e,t){var r,n,i,s=this;if(null!=e)return m(e,0,f),null==t?t=D:m(t,0,8),G(new V(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-p(this.e/u))*u,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},C.dividedBy=C.div=function(e,t){return r(this,new V(e,t),O,D)},C.dividedToIntegerBy=C.idiv=function(e,t){return r(this,new V(e,t),0,1)},C.exponentiatedBy=C.pow=function(e,t){var r,n,a,c,l,h,d,f,p=this;if((e=new V(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+J(e));if(null!=t&&(t=new V(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return f=new V(Math.pow(+J(p),l?e.s*(2-b(e)):+J(e))),t?f.mod(t):f;if(h=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new V(NaN);(n=!h&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&b(e)?-0:0,p.e>-1&&(c=1/c),new V(h?1/c:c);F&&(c=i(F/u+2))}for(l?(r=new V(.5),h&&(e.s=1),d=b(e)):d=(a=Math.abs(+J(e)))%2,f=new V(R);;){if(d){if(!(f=f.times(p)).c)break;c?f.c.length>c&&(f.c.length=c):n&&(f=f.mod(t))}if(a){if(0===(a=s(a/2)))break;d=a%2}else if(G(e=e.times(r),e.e+1,1),e.e>14)d=b(e);else{if(0===(a=+J(e)))break;d=a%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):n&&(p=p.mod(t))}return n?f:(h&&(f=R.div(f)),t?f.mod(t):c?G(f,F,D,undefined):f)},C.integerValue=function(e){var t=new V(this);return null==e?e=D:m(e,0,8),G(t,t.e+1,e)},C.isEqualTo=C.eq=function(e,t){return 0===g(this,new V(e,t))},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(e,t){return g(this,new V(e,t))>0},C.isGreaterThanOrEqualTo=C.gte=function(e,t){return 1===(t=g(this,new V(e,t)))||0===t},C.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},C.isLessThan=C.lt=function(e,t){return g(this,new V(e,t))<0},C.isLessThanOrEqualTo=C.lte=function(e,t){return-1===(t=g(this,new V(e,t)))||0===t},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&0==this.c[0]},C.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new V(e,t)).s,!a||!t)return new V(NaN);if(a!=t)return e.s=-t,o.plus(e);var l=o.e/u,h=e.e/u,d=o.c,f=e.c;if(!l||!h){if(!d||!f)return d?(e.s=-t,e):new V(f?o:NaN);if(!d[0]||!f[0])return f[0]?(e.s=-t,e):new V(d[0]?o:3==D?-0:0)}if(l=p(l),h=p(h),d=d.slice(),a=l-h){for((s=a<0)?(a=-a,i=d):(h=l,i=f),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=d.length)<(t=f.length))?a:t,a=t=0;t<n;t++)if(d[t]!=f[t]){s=d[t]<f[t];break}if(s&&(i=d,d=f,f=i,e.s=-e.s),(t=(n=f.length)-(r=d.length))>0)for(;t--;d[r++]=0);for(t=c-1;n>a;){if(d[--n]<f[n]){for(r=n;r&&!d[--r];d[r]=t);--d[r],d[n]+=c}d[n]-=f[n]}for(;0==d[0];d.splice(0,1),--h);return d[0]?H(e,d,h):(e.s=3==D?-1:1,e.c=[e.e=0],e)},C.modulo=C.mod=function(e,t){var n,i,s=this;return e=new V(e,t),!s.c||!e.s||e.c&&!e.c[0]?new V(NaN):!e.c||s.c&&!s.c[0]?new V(s):(9==j?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,j),(e=s.minus(n.times(e))).c[0]||1!=j||(e.s=s.s),e)},C.multipliedBy=C.times=function(e,t){var r,n,i,s,o,a,l,h,f,y,g,m,b,w,v,_=this,E=_.c,S=(e=new V(e,t)).c;if(!(E&&S&&E[0]&&S[0]))return!_.s||!e.s||E&&!E[0]&&!S||S&&!S[0]&&!E?e.c=e.e=e.s=null:(e.s*=_.s,E&&S?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(_.e/u)+p(e.e/u),e.s*=_.s,(l=E.length)<(y=S.length)&&(b=E,E=S,S=b,i=l,l=y,y=i),i=l+y,b=[];i--;b.push(0));for(w=c,v=d,i=y;--i>=0;){for(r=0,g=S[i]%v,m=S[i]/v|0,s=i+(o=l);s>i;)r=((h=g*(h=E[--o]%v)+(a=m*h+(f=E[o]/v|0)*g)%v*v+b[s]+r)/w|0)+(a/v|0)+m*f,b[s--]=h%w;b[s]=r}return r?++n:b.splice(0,1),H(e,b,n)},C.negated=function(){var e=new V(this);return e.s=-e.s||null,e},C.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new V(e,t)).s,!i||!t)return new V(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/u,o=e.e/u,a=n.c,l=e.c;if(!s||!o){if(!a||!l)return new V(i/0);if(!a[0]||!l[0])return l[0]?e:new V(a[0]?n:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=l):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=l.length)<0&&(r=l,l=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+l[t]+i)/c|0,a[t]=c===a[t]?0:a[t]%c;return i&&(a=[i].concat(a),++o),H(e,a,o)},C.precision=C.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return m(e,1,f),null==t?t=D:m(t,0,8),G(new V(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*u+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},C.shiftedBy=function(e){return m(e,-9007199254740991,l),this.times("1e"+e)},C.squareRoot=C.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,u=o.e,l=O+4,h=new V("0.5");if(1!==c||!a||!a[0])return new V(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+J(o)))||c==1/0?(((t=y(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),n=new V(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new V(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(s=n,n=h.times(s.plus(r(o,s,l,1))),y(s.c).slice(0,c)===(t=y(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(G(n,n.e+O+2,1),e=!n.times(n).eq(o));break}if(!i&&(G(s,s.e+O+2,0),s.times(s).eq(o))){n=s;break}l+=4,c+=4,i=1}return G(n,n.e+O+1,D,e)},C.toExponential=function(e,t){return null!=e&&(m(e,0,f),e++),q(this,e,t,1)},C.toFixed=function(e,t){return null!=e&&(m(e,0,f),e=e+this.e+1),q(this,e,t)},C.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=z;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",h=a[0],d=a[1],f=i.s<0,p=f?h.slice(1):h,y=p.length;if(u&&(s=c,c=u,u=s,y-=s),c>0&&y>0){for(s=y%c||c,h=p.substr(0,s);s<y;s+=c)h+=l+p.substr(s,c);u>0&&(h+=l+p.slice(s)),f&&(h="-"+h)}n=d?h+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):h}return(r.prefix||"")+n+(r.suffix||"")},C.toFraction=function(e){var t,n,i,s,a,c,l,d,f,p,g,m,b=this,w=b.c;if(null!=e&&(!(l=new V(e)).isInteger()&&(l.c||1!==l.s)||l.lt(R)))throw Error(o+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+J(l));if(!w)return new V(b);for(t=new V(R),f=n=new V(R),i=d=new V(R),m=y(w),a=t.e=m.length-b.e-1,t.c[0]=h[(c=a%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?a>0?t:f:l,c=U,U=1/0,l=new V(m),d.c[0]=0;p=r(l,t,0,1),1!=(s=n.plus(p.times(i))).comparedTo(e);)n=i,i=s,f=d.plus(p.times(s=f)),d=s,t=l.minus(p.times(s=t)),l=s;return s=r(e.minus(n),i,0,1),d=d.plus(s.times(f)),n=n.plus(s.times(i)),d.s=f.s=b.s,g=r(f,i,a*=2,D).minus(b).abs().comparedTo(r(d,n,a,D).minus(b).abs())<1?[f,i]:[d,n],U=c,g},C.toNumber=function(){return+J(this)},C.toPrecision=function(e,t){return null!=e&&m(e,1,f),q(this,e,t,2)},C.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=B||i>=N?w(y(r.c),i):v(y(r.c),i,"0"):10===e&&K?t=v(y((r=G(new V(r),O+i+1,D)).c),r.e,"0"):(m(e,2,$.length,"Base"),t=_(v(y(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},C.valueOf=C.toJSON=function(){return J(this)},C._isBigNumber=!0,C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf,null!=t&&V.set(t),V})()},19148:function(e,t,r){"use strict";const{AbstractLevel:n}=r(75e3),i=r(20266),s=r(5372),{fromCallback:o}=r(78100),{Iterator:a}=r(26296),c=r(5222),u=r(23452),l=r(97766),h="level-js-",d=Symbol("idb"),f=Symbol("namePrefix"),p=Symbol("location"),y=Symbol("version"),g=Symbol("store"),m=Symbol("onComplete"),b=Symbol("promise");class w extends n{constructor(e,t,r){if("function"==typeof t||"function"==typeof r)throw new i("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:s,...o}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),"string"!=typeof e)throw new Error("constructor requires a location string argument");this[p]=e,this[f]=null==n?h:n,this[y]=parseInt(s||1,10),this[d]=null}get location(){return this[p]}get namePrefix(){return this[f]}get version(){return this[y]}get db(){return this[d]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[f]+this[p],this[y]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[d]=r.result,t()},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this[p])||t.createObjectStore(this[p])}}[g](e){return this[d].transaction([this[p]],e).objectStore(this[p])}[m](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const n=this[g]("readonly");let s;try{s=n.get(e)}catch(e){return this.nextTick(r,e)}this[m](s,(function(e,t){return e?r(e):void 0===t?r(new i("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,c(t))}))}_getMany(e,t,r){const n=this[g]("readonly"),i=e.map((e=>t=>{let r;try{r=n.get(e)}catch(e){return t(e)}r.onsuccess=()=>{const e=r.result;t(null,void 0===e?e:c(e))},r.onerror=e=>{e.stopPropagation(),t(r.error)}}));s(i,16,r)}_del(e,t,r){const n=this[g]("readwrite");let i;try{i=n.delete(e)}catch(e){return this.nextTick(r,e)}this[m](i,r)}_put(e,t,r,n){const i=this[g]("readwrite");let s;try{s=i.put(t,e)}catch(e){return this.nextTick(n,e)}this[m](s,n)}_iterator(e){return new a(this,this[p],e)}_batch(e,t,r){const n=this[g]("readwrite"),i=n.transaction;let s,o=0;i.onabort=function(){r(s||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()},function t(){const r=e[o++],a=r.key;let c;try{c="del"===r.type?n.delete(a):n.put(r.value,a)}catch(e){return s=e,void i.abort()}o<e.length?c.onsuccess=t:"function"==typeof i.commit&&i.commit()}()}_clear(e,t){let r,n;try{r=l(e)}catch(e){return this.nextTick(t)}if(e.limit>=0)return u(this,this[p],r,e,t);try{const e=this[g]("readwrite");n=r?e.delete(r):e.clear()}catch(e){return this.nextTick(t,e)}this[m](n,t)}_close(e){this[d].close(),this.nextTick(e)}}w.destroy=function(e,t,r){"function"==typeof t&&(r=t,t=h),r=o(r,b);const n=indexedDB.deleteDatabase(t+e);return n.onsuccess=function(){r()},n.onerror=function(e){r(e)},r[b]},t.BrowserLevel=w},26296:function(e,t,r){"use strict";const{AbstractIterator:n}=r(75e3),i=r(97766),s=r(5222),o=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),u=Symbol("currentOptions"),l=Symbol("position"),h=Symbol("location"),d=Symbol("first"),f={};function p(e){"function"==typeof e.commit&&e.commit()}t.Iterator=class extends n{constructor(e,t,r){super(e,r),this[o]=[],this[a]=0===this.limit,this[c]=r,this[u]={...r},this[l]=void 0,this[h]=t,this[d]=!0}_nextv(e,t,r){if(this[d]=!1,this[a])return this.nextTick(r,null,[]);if(this[o].length>0)return e=Math.min(e,this[o].length),this.nextTick(r,null,this[o].splice(0,e));let n;void 0!==this[l]&&(this[c].reverse?(this[u].lt=this[l],this[u].lte=void 0):(this[u].gt=this[l],this[u].gte=void 0));try{n=i(this[u])}catch(e){return this[a]=!0,this.nextTick(r,null,[])}const f=this.db.db.transaction([this[h]],"readonly"),y=f.objectStore(this[h]),g=[];if(this[c].reverse){y[!this[c].values&&y.openKeyCursor?"openKeyCursor":"openCursor"](n,"prev").onsuccess=t=>{const r=t.target.result;if(r){const{key:t,value:n}=r;this[l]=t,g.push([this[c].keys&&void 0!==t?s(t):void 0,this[c].values&&void 0!==n?s(n):void 0]),g.length<e?r.continue():p(f)}else this[a]=!0}}else{let t,r;const i=()=>{if(void 0===t||void 0===r)return;const n=Math.max(t.length,r.length);0===n||e===1/0?this[a]=!0:this[l]=t[n-1],g.length=n;for(let e=0;e<n;e++){const n=t[e],i=r[e];g[e]=[this[c].keys&&void 0!==n?s(n):void 0,this[c].values&&void 0!==i?s(i):void 0]}p(f)};this[c].keys||e<1/0?y.getAllKeys(n,e<1/0?e:void 0).onsuccess=e=>{t=e.target.result,i()}:(t=[],this.nextTick(i)),this[c].values?y.getAll(n,e<1/0?e:void 0).onsuccess=e=>{r=e.target.result,i()}:(r=[],this.nextTick(i))}f.onabort=()=>{r(f.error||new Error("aborted by user")),r=null},f.oncomplete=()=>{r(null,g),r=null}}_next(e){if(this[o].length>0){const[t,r]=this[o].shift();this.nextTick(e,null,t,r)}else if(this[a])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[d]&&(this[d]=!1,t=1),this._nextv(t,f,((t,r)=>{if(t)return e(t);this[o]=r,this._next(e)}))}}_all(e,t){this[d]=!1;const r=this[o].splice(0,this[o].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(t,null,r);this._nextv(n,f,((e,n)=>{if(e)return t(e);r.length>0&&(n=r.concat(n)),t(null,n)}))}_seek(e,t){let r;this[d]=!0,this[o]=[],this[a]=!1,this[l]=void 0,this[u]={...this[c]};try{r=i(this[c])}catch(e){return void(this[a]=!0)}null===r||r.includes(e)?this[c].reverse?this[u].lte=e:this[u].gte=e:this[a]=!0}}},23452:function(e){"use strict";e.exports=function(e,t,r,n,i){if(0===n.limit)return e.nextTick(i);const s=e.db.transaction([t],"readwrite"),o=s.objectStore(t);let a=0;s.oncomplete=function(){i()},s.onabort=function(){i(s.error||new Error("aborted by user"))};const c=o.openKeyCursor?"openKeyCursor":"openCursor",u=n.reverse?"prev":"next";o[c](r,u).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&t.continue()})}}},5222:function(e){"use strict";const t=new TextEncoder;e.exports=function(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):t.encode(e)}},97766:function(e){"use strict";e.exports=function(e){const t=void 0!==e.gte?e.gte:void 0!==e.gt?e.gt:void 0,r=void 0!==e.lte?e.lte:void 0!==e.lt?e.lt:void 0,n=void 0===e.gte,i=void 0===e.lte;return void 0!==t&&void 0!==r?IDBKeyRange.bound(t,r,n,i):void 0!==t?IDBKeyRange.lowerBound(t,n):void 0!==r?IDBKeyRange.upperBound(r,i):null}},48287:function(e,t,r){"use strict";var n=r(96763),i=r(67526),s=r(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;var a=2147483647;function c(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|g(e,t),n=c(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return p(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);var i=function(e){if(u.isBuffer(e)){var t=0|y(e.length),r=c(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||K(e.length)?c(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),c(e<0?0:0|y(e))}function f(e){for(var t=e.length<0?0:0|y(e.length),r=c(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function y(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function g(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(e).length;default:if(i)return n?-1:j(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),K(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var s,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(s=r;s<a;s++)if(u(e,s)===u(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===c)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){for(var h=!0,d=0;d<c;d++)if(u(e,s+d)!==u(t,d)){h=!1;break}if(h)return s}return-1}function _(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(t.substr(2*o,2),16);if(K(a))return o;e[r+o]=a}return o}function E(e,t,r,n){return z(j(t,e.length-r),e,r,n)}function S(e,t,r,n){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function x(e,t,r,n){return z(F(t),e,r,n)}function A(e,t,r,n){return z(function(e,t){for(var r,n,i,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,o,a,c,u=e[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(s=e[i+1]))&&(c=(31&u)<<6|63&s)>127&&(l=c);break;case 3:s=e[i+1],o=e[i+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=T));return r}(n)}t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===n||"function"!=typeof n.error||n.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?c(e):void 0!==t?"string"==typeof r?c(e).fill(t,r):c(e).fill(t):c(e)}(e,t,r)},u.allocUnsafe=function(e){return d(e)},u.allocUnsafeSlow=function(e){return d(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if($(s,Uint8Array))i+s.length>n.length?u.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},u.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),a=Math.min(s,o),c=this.slice(n,i),l=e.slice(t,r),h=0;h<a;++h)if(c[h]!==l[h]){s=c[h],o=l[h];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return x(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=V[e[s]];return i}function O(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,s){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(e,t,r,n,i){return t=+t,r>>>=0,i||N(e,0,r,4),s.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,i){return t=+t,r>>>=0,i||N(e,0,r,8),s.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var s=0,o=1,a=0;for(this[t]=255&e;++s<r&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var o=u.isBuffer(e)?e:u.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=o[s%a]}return this};var L=/[^+/0-9A-Za-z-_]/g;function j(e,t){var r;t=t||1/0;for(var n=e.length,i=null,s=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function F(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var V=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},25508:function(e){"use strict";e.exports=function(e,t){if("string"==typeof e)return o(e);if("number"==typeof e)return s(e,t);return null},e.exports.format=s,e.exports.parse=o;var t=/\B(?=(\d{3})+(?!\d))/g,r=/(?:\.0*|(\.[^0]+)0+)$/,n={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},i=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function s(e,i){if(!Number.isFinite(e))return null;var s=Math.abs(e),o=i&&i.thousandsSeparator||"",a=i&&i.unitSeparator||"",c=i&&void 0!==i.decimalPlaces?i.decimalPlaces:2,u=Boolean(i&&i.fixedDecimals),l=i&&i.unit||"";l&&n[l.toLowerCase()]||(l=s>=n.pb?"PB":s>=n.tb?"TB":s>=n.gb?"GB":s>=n.mb?"MB":s>=n.kb?"KB":"B");var h=(e/n[l.toLowerCase()]).toFixed(c);return u||(h=h.replace(r,"$1")),o&&(h=h.split(".").map((function(e,r){return 0===r?e.replace(t,o):e})).join(".")),h+a+l}function o(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,r=i.exec(e),s="b";return r?(t=parseFloat(r[1]),s=r[4].toLowerCase()):(t=parseInt(e,10),s="b"),isNaN(t)?null:Math.floor(n[s]*t)}},78100:function(e,t,r){"use strict";var n=r(50844);t.fromCallback=function(e,t){if(void 0===e){var r=new Promise((function(t,r){e=function(e,n){e?r(e):t(n)}}));e[void 0!==t?t:"promise"]=r}else if("function"!=typeof e)throw new TypeError("Callback must be a function");return e},t.fromPromise=function(e,t){if(void 0===t)return e;e.then((function(e){n((()=>t(null,e)))})).catch((function(e){n((()=>t(e)))}))}},50844:function(e){e.exports="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)},29017:function(e,t,r){"use strict";r.d(t,{A2:function(){return o},BX:function(){return v},J3:function(){return l},p:function(){return h}});var n=r(96763);const i=Symbol("Comlink.proxy"),s=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),c=Symbol("Comlink.thrown"),u=e=>"object"==typeof e&&null!==e||"function"==typeof e,l=new Map([["proxy",{canHandle:e=>u(e)&&e[i],serialize(e){const{port1:t,port2:r}=new MessageChannel;return h(e,t),[r,[r]]},deserialize(e){return e.start(),m(e,[],t);var t}}],["throw",{canHandle:e=>u(e)&&c in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function h(e,t=globalThis,r=["*"]){t.addEventListener("message",(function i(s){if(!s||!s.data)return;if(!function(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}(r,s.origin))return void n.warn(`Invalid origin '${s.origin}' for comlink proxy`);const{id:o,type:u,path:l}=Object.assign({path:[]},s.data),f=(s.data.argumentList||[]).map(E);let p;try{const t=l.slice(0,-1).reduce(((e,t)=>e[t]),e),r=l.reduce(((e,t)=>e[t]),e);switch(u){case"GET":p=r;break;case"SET":t[l.slice(-1)[0]]=E(s.data.value),p=!0;break;case"APPLY":p=r.apply(t,f);break;case"CONSTRUCT":p=v(new r(...f));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;h(e,r),p=function(e,t){return w.set(e,t),e}(t,[t])}break;case"RELEASE":p=void 0;break;default:return}}catch(e){p={value:e,[c]:0}}Promise.resolve(p).catch((e=>({value:e,[c]:0}))).then((r=>{const[n,s]=_(r);t.postMessage(Object.assign(Object.assign({},n),{id:o}),s),"RELEASE"===u&&(t.removeEventListener("message",i),d(t),a in e&&"function"==typeof e[a]&&e[a]())})).catch((e=>{const[r,n]=_({value:new TypeError("Unserializable return value"),[c]:0});t.postMessage(Object.assign(Object.assign({},r),{id:o}),n)}))})),t.start&&t.start()}function d(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function f(e){if(e)throw new Error("Proxy has been released and is not useable")}function p(e){return S(e,{type:"RELEASE"}).then((()=>{d(e)}))}const y=new WeakMap,g="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(y.get(e)||0)-1;y.set(e,t),0===t&&p(e)}));function m(e,t=[],r=function(){}){let n=!1;const i=new Proxy(r,{get(r,s){if(f(n),s===o)return()=>{!function(e){g&&g.unregister(e)}(i),p(e),n=!0};if("then"===s){if(0===t.length)return{then:()=>i};const r=S(e,{type:"GET",path:t.map((e=>e.toString()))}).then(E);return r.then.bind(r)}return m(e,[...t,s])},set(r,i,s){f(n);const[o,a]=_(s);return S(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:o},a).then(E)},apply(r,i,o){f(n);const a=t[t.length-1];if(a===s)return S(e,{type:"ENDPOINT"}).then(E);if("bind"===a)return m(e,t.slice(0,-1));const[c,u]=b(o);return S(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:c},u).then(E)},construct(r,i){f(n);const[s,o]=b(i);return S(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:s},o).then(E)}});return function(e,t){const r=(y.get(t)||0)+1;y.set(t,r),g&&g.register(e,t,e)}(i,e),i}function b(e){const t=e.map(_);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const w=new WeakMap;function v(e){return Object.assign(e,{[i]:!0})}function _(e){for(const[t,r]of l)if(r.canHandle(e)){const[n,i]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},i]}return[{type:"RAW",value:e},w.get(e)||[]]}function E(e){switch(e.type){case"HANDLER":return l.get(e.name).deserialize(e.value);case"RAW":return e.value}}function S(e,t,r){return new Promise((n=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===i&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),r)}))}},63191:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TallyParams=t.VotingParams=t.DepositParams=t.Vote=t.TallyResult=t.Proposal=t.Deposit=t.TextProposal=t.WeightedVoteOption=t.proposalStatusToJSON=t.proposalStatusFromJSON=t.ProposalStatus=t.voteOptionToJSON=t.voteOptionFromJSON=t.VoteOption=t.protobufPackage=void 0;const n=r(60617),i=r(8890),s=r(12708),o=r(1082),a=r(50287),c=r(42825);var u,l;function h(e){switch(e){case 0:case"VOTE_OPTION_UNSPECIFIED":return u.VOTE_OPTION_UNSPECIFIED;case 1:case"VOTE_OPTION_YES":return u.VOTE_OPTION_YES;case 2:case"VOTE_OPTION_ABSTAIN":return u.VOTE_OPTION_ABSTAIN;case 3:case"VOTE_OPTION_NO":return u.VOTE_OPTION_NO;case 4:case"VOTE_OPTION_NO_WITH_VETO":return u.VOTE_OPTION_NO_WITH_VETO;default:return u.UNRECOGNIZED}}function d(e){switch(e){case u.VOTE_OPTION_UNSPECIFIED:return"VOTE_OPTION_UNSPECIFIED";case u.VOTE_OPTION_YES:return"VOTE_OPTION_YES";case u.VOTE_OPTION_ABSTAIN:return"VOTE_OPTION_ABSTAIN";case u.VOTE_OPTION_NO:return"VOTE_OPTION_NO";case u.VOTE_OPTION_NO_WITH_VETO:return"VOTE_OPTION_NO_WITH_VETO";case u.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function f(e){switch(e){case 0:case"PROPOSAL_STATUS_UNSPECIFIED":return l.PROPOSAL_STATUS_UNSPECIFIED;case 1:case"PROPOSAL_STATUS_DEPOSIT_PERIOD":return l.PROPOSAL_STATUS_DEPOSIT_PERIOD;case 2:case"PROPOSAL_STATUS_VOTING_PERIOD":return l.PROPOSAL_STATUS_VOTING_PERIOD;case 3:case"PROPOSAL_STATUS_PASSED":return l.PROPOSAL_STATUS_PASSED;case 4:case"PROPOSAL_STATUS_REJECTED":return l.PROPOSAL_STATUS_REJECTED;case 5:case"PROPOSAL_STATUS_FAILED":return l.PROPOSAL_STATUS_FAILED;default:return l.UNRECOGNIZED}}function p(e){switch(e){case l.PROPOSAL_STATUS_UNSPECIFIED:return"PROPOSAL_STATUS_UNSPECIFIED";case l.PROPOSAL_STATUS_DEPOSIT_PERIOD:return"PROPOSAL_STATUS_DEPOSIT_PERIOD";case l.PROPOSAL_STATUS_VOTING_PERIOD:return"PROPOSAL_STATUS_VOTING_PERIOD";case l.PROPOSAL_STATUS_PASSED:return"PROPOSAL_STATUS_PASSED";case l.PROPOSAL_STATUS_REJECTED:return"PROPOSAL_STATUS_REJECTED";case l.PROPOSAL_STATUS_FAILED:return"PROPOSAL_STATUS_FAILED";case l.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function y(){return{proposalId:BigInt(0),depositor:"",amount:[]}}function g(){return{proposalId:BigInt(0),content:void 0,status:0,finalTallyResult:t.TallyResult.fromPartial({}),submitTime:s.Timestamp.fromPartial({}),depositEndTime:s.Timestamp.fromPartial({}),totalDeposit:[],votingStartTime:s.Timestamp.fromPartial({}),votingEndTime:s.Timestamp.fromPartial({})}}function m(){return{proposalId:BigInt(0),voter:"",option:0,options:[]}}function b(){return{minDeposit:[],maxDepositPeriod:o.Duration.fromPartial({})}}function w(){return{votingPeriod:o.Duration.fromPartial({})}}function v(){return{quorum:new Uint8Array,threshold:new Uint8Array,vetoThreshold:new Uint8Array}}t.protobufPackage="cosmos.gov.v1beta1",function(e){e[e.VOTE_OPTION_UNSPECIFIED=0]="VOTE_OPTION_UNSPECIFIED",e[e.VOTE_OPTION_YES=1]="VOTE_OPTION_YES",e[e.VOTE_OPTION_ABSTAIN=2]="VOTE_OPTION_ABSTAIN",e[e.VOTE_OPTION_NO=3]="VOTE_OPTION_NO",e[e.VOTE_OPTION_NO_WITH_VETO=4]="VOTE_OPTION_NO_WITH_VETO",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(u||(t.VoteOption=u={})),t.voteOptionFromJSON=h,t.voteOptionToJSON=d,function(e){e[e.PROPOSAL_STATUS_UNSPECIFIED=0]="PROPOSAL_STATUS_UNSPECIFIED",e[e.PROPOSAL_STATUS_DEPOSIT_PERIOD=1]="PROPOSAL_STATUS_DEPOSIT_PERIOD",e[e.PROPOSAL_STATUS_VOTING_PERIOD=2]="PROPOSAL_STATUS_VOTING_PERIOD",e[e.PROPOSAL_STATUS_PASSED=3]="PROPOSAL_STATUS_PASSED",e[e.PROPOSAL_STATUS_REJECTED=4]="PROPOSAL_STATUS_REJECTED",e[e.PROPOSAL_STATUS_FAILED=5]="PROPOSAL_STATUS_FAILED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(l||(t.ProposalStatus=l={})),t.proposalStatusFromJSON=f,t.proposalStatusToJSON=p,t.WeightedVoteOption={typeUrl:"/cosmos.gov.v1beta1.WeightedVoteOption",encode:(e,t=a.BinaryWriter.create())=>(0!==e.option&&t.uint32(8).int32(e.option),""!==e.weight&&t.uint32(18).string(e.weight),t),decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={option:0,weight:""};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.option=r.int32();break;case 2:i.weight=r.string();break;default:r.skipType(7&e)}}return i},fromJSON(e){const t={option:0,weight:""};return(0,c.isSet)(e.option)&&(t.option=h(e.option)),(0,c.isSet)(e.weight)&&(t.weight=String(e.weight)),t},toJSON(e){const t={};return void 0!==e.option&&(t.option=d(e.option)),void 0!==e.weight&&(t.weight=e.weight),t},fromPartial(e){const t={option:0,weight:""};return t.option=e.option??0,t.weight=e.weight??"",t}},t.TextProposal={typeUrl:"/cosmos.gov.v1beta1.TextProposal",encode:(e,t=a.BinaryWriter.create())=>(""!==e.title&&t.uint32(10).string(e.title),""!==e.description&&t.uint32(18).string(e.description),t),decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={title:"",description:""};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.title=r.string();break;case 2:i.description=r.string();break;default:r.skipType(7&e)}}return i},fromJSON(e){const t={title:"",description:""};return(0,c.isSet)(e.title)&&(t.title=String(e.title)),(0,c.isSet)(e.description)&&(t.description=String(e.description)),t},toJSON(e){const t={};return void 0!==e.title&&(t.title=e.title),void 0!==e.description&&(t.description=e.description),t},fromPartial(e){const t={title:"",description:""};return t.title=e.title??"",t.description=e.description??"",t}},t.Deposit={typeUrl:"/cosmos.gov.v1beta1.Deposit",encode(e,t=a.BinaryWriter.create()){e.proposalId!==BigInt(0)&&t.uint32(8).uint64(e.proposalId),""!==e.depositor&&t.uint32(18).string(e.depositor);for(const r of e.amount)n.Coin.encode(r,t.uint32(26).fork()).ldelim();return t},decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s=y();for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:s.proposalId=r.uint64();break;case 2:s.depositor=r.string();break;case 3:s.amount.push(n.Coin.decode(r,r.uint32()));break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=y();return(0,c.isSet)(e.proposalId)&&(t.proposalId=BigInt(e.proposalId.toString())),(0,c.isSet)(e.depositor)&&(t.depositor=String(e.depositor)),Array.isArray(e?.amount)&&(t.amount=e.amount.map((e=>n.Coin.fromJSON(e)))),t},toJSON(e){const t={};return void 0!==e.proposalId&&(t.proposalId=(e.proposalId||BigInt(0)).toString()),void 0!==e.depositor&&(t.depositor=e.depositor),e.amount?t.amount=e.amount.map((e=>e?n.Coin.toJSON(e):void 0)):t.amount=[],t},fromPartial(e){const t=y();return void 0!==e.proposalId&&null!==e.proposalId&&(t.proposalId=BigInt(e.proposalId.toString())),t.depositor=e.depositor??"",t.amount=e.amount?.map((e=>n.Coin.fromPartial(e)))||[],t}},t.Proposal={typeUrl:"/cosmos.gov.v1beta1.Proposal",encode(e,r=a.BinaryWriter.create()){e.proposalId!==BigInt(0)&&r.uint32(8).uint64(e.proposalId),void 0!==e.content&&i.Any.encode(e.content,r.uint32(18).fork()).ldelim(),0!==e.status&&r.uint32(24).int32(e.status),void 0!==e.finalTallyResult&&t.TallyResult.encode(e.finalTallyResult,r.uint32(34).fork()).ldelim(),void 0!==e.submitTime&&s.Timestamp.encode(e.submitTime,r.uint32(42).fork()).ldelim(),void 0!==e.depositEndTime&&s.Timestamp.encode(e.depositEndTime,r.uint32(50).fork()).ldelim();for(const t of e.totalDeposit)n.Coin.encode(t,r.uint32(58).fork()).ldelim();return void 0!==e.votingStartTime&&s.Timestamp.encode(e.votingStartTime,r.uint32(66).fork()).ldelim(),void 0!==e.votingEndTime&&s.Timestamp.encode(e.votingEndTime,r.uint32(74).fork()).ldelim(),r},decode(e,r){const o=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let c=void 0===r?o.len:o.pos+r;const u=g();for(;o.pos<c;){const e=o.uint32();switch(e>>>3){case 1:u.proposalId=o.uint64();break;case 2:u.content=i.Any.decode(o,o.uint32());break;case 3:u.status=o.int32();break;case 4:u.finalTallyResult=t.TallyResult.decode(o,o.uint32());break;case 5:u.submitTime=s.Timestamp.decode(o,o.uint32());break;case 6:u.depositEndTime=s.Timestamp.decode(o,o.uint32());break;case 7:u.totalDeposit.push(n.Coin.decode(o,o.uint32()));break;case 8:u.votingStartTime=s.Timestamp.decode(o,o.uint32());break;case 9:u.votingEndTime=s.Timestamp.decode(o,o.uint32());break;default:o.skipType(7&e)}}return u},fromJSON(e){const r=g();return(0,c.isSet)(e.proposalId)&&(r.proposalId=BigInt(e.proposalId.toString())),(0,c.isSet)(e.content)&&(r.content=i.Any.fromJSON(e.content)),(0,c.isSet)(e.status)&&(r.status=f(e.status)),(0,c.isSet)(e.finalTallyResult)&&(r.finalTallyResult=t.TallyResult.fromJSON(e.finalTallyResult)),(0,c.isSet)(e.submitTime)&&(r.submitTime=(0,c.fromJsonTimestamp)(e.submitTime)),(0,c.isSet)(e.depositEndTime)&&(r.depositEndTime=(0,c.fromJsonTimestamp)(e.depositEndTime)),Array.isArray(e?.totalDeposit)&&(r.totalDeposit=e.totalDeposit.map((e=>n.Coin.fromJSON(e)))),(0,c.isSet)(e.votingStartTime)&&(r.votingStartTime=(0,c.fromJsonTimestamp)(e.votingStartTime)),(0,c.isSet)(e.votingEndTime)&&(r.votingEndTime=(0,c.fromJsonTimestamp)(e.votingEndTime)),r},toJSON(e){const r={};return void 0!==e.proposalId&&(r.proposalId=(e.proposalId||BigInt(0)).toString()),void 0!==e.content&&(r.content=e.content?i.Any.toJSON(e.content):void 0),void 0!==e.status&&(r.status=p(e.status)),void 0!==e.finalTallyResult&&(r.finalTallyResult=e.finalTallyResult?t.TallyResult.toJSON(e.finalTallyResult):void 0),void 0!==e.submitTime&&(r.submitTime=(0,c.fromTimestamp)(e.submitTime).toISOString()),void 0!==e.depositEndTime&&(r.depositEndTime=(0,c.fromTimestamp)(e.depositEndTime).toISOString()),e.totalDeposit?r.totalDeposit=e.totalDeposit.map((e=>e?n.Coin.toJSON(e):void 0)):r.totalDeposit=[],void 0!==e.votingStartTime&&(r.votingStartTime=(0,c.fromTimestamp)(e.votingStartTime).toISOString()),void 0!==e.votingEndTime&&(r.votingEndTime=(0,c.fromTimestamp)(e.votingEndTime).toISOString()),r},fromPartial(e){const r=g();return void 0!==e.proposalId&&null!==e.proposalId&&(r.proposalId=BigInt(e.proposalId.toString())),void 0!==e.content&&null!==e.content&&(r.content=i.Any.fromPartial(e.content)),r.status=e.status??0,void 0!==e.finalTallyResult&&null!==e.finalTallyResult&&(r.finalTallyResult=t.TallyResult.fromPartial(e.finalTallyResult)),void 0!==e.submitTime&&null!==e.submitTime&&(r.submitTime=s.Timestamp.fromPartial(e.submitTime)),void 0!==e.depositEndTime&&null!==e.depositEndTime&&(r.depositEndTime=s.Timestamp.fromPartial(e.depositEndTime)),r.totalDeposit=e.totalDeposit?.map((e=>n.Coin.fromPartial(e)))||[],void 0!==e.votingStartTime&&null!==e.votingStartTime&&(r.votingStartTime=s.Timestamp.fromPartial(e.votingStartTime)),void 0!==e.votingEndTime&&null!==e.votingEndTime&&(r.votingEndTime=s.Timestamp.fromPartial(e.votingEndTime)),r}},t.TallyResult={typeUrl:"/cosmos.gov.v1beta1.TallyResult",encode:(e,t=a.BinaryWriter.create())=>(""!==e.yes&&t.uint32(10).string(e.yes),""!==e.abstain&&t.uint32(18).string(e.abstain),""!==e.no&&t.uint32(26).string(e.no),""!==e.noWithVeto&&t.uint32(34).string(e.noWithVeto),t),decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={yes:"",abstain:"",no:"",noWithVeto:""};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.yes=r.string();break;case 2:i.abstain=r.string();break;case 3:i.no=r.string();break;case 4:i.noWithVeto=r.string();break;default:r.skipType(7&e)}}return i},fromJSON(e){const t={yes:"",abstain:"",no:"",noWithVeto:""};return(0,c.isSet)(e.yes)&&(t.yes=String(e.yes)),(0,c.isSet)(e.abstain)&&(t.abstain=String(e.abstain)),(0,c.isSet)(e.no)&&(t.no=String(e.no)),(0,c.isSet)(e.noWithVeto)&&(t.noWithVeto=String(e.noWithVeto)),t},toJSON(e){const t={};return void 0!==e.yes&&(t.yes=e.yes),void 0!==e.abstain&&(t.abstain=e.abstain),void 0!==e.no&&(t.no=e.no),void 0!==e.noWithVeto&&(t.noWithVeto=e.noWithVeto),t},fromPartial(e){const t={yes:"",abstain:"",no:"",noWithVeto:""};return t.yes=e.yes??"",t.abstain=e.abstain??"",t.no=e.no??"",t.noWithVeto=e.noWithVeto??"",t}},t.Vote={typeUrl:"/cosmos.gov.v1beta1.Vote",encode(e,r=a.BinaryWriter.create()){e.proposalId!==BigInt(0)&&r.uint32(8).uint64(e.proposalId),""!==e.voter&&r.uint32(18).string(e.voter),0!==e.option&&r.uint32(24).int32(e.option);for(const n of e.options)t.WeightedVoteOption.encode(n,r.uint32(34).fork()).ldelim();return r},decode(e,r){const n=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let i=void 0===r?n.len:n.pos+r;const s=m();for(;n.pos<i;){const e=n.uint32();switch(e>>>3){case 1:s.proposalId=n.uint64();break;case 2:s.voter=n.string();break;case 3:s.option=n.int32();break;case 4:s.options.push(t.WeightedVoteOption.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const r=m();return(0,c.isSet)(e.proposalId)&&(r.proposalId=BigInt(e.proposalId.toString())),(0,c.isSet)(e.voter)&&(r.voter=String(e.voter)),(0,c.isSet)(e.option)&&(r.option=h(e.option)),Array.isArray(e?.options)&&(r.options=e.options.map((e=>t.WeightedVoteOption.fromJSON(e)))),r},toJSON(e){const r={};return void 0!==e.proposalId&&(r.proposalId=(e.proposalId||BigInt(0)).toString()),void 0!==e.voter&&(r.voter=e.voter),void 0!==e.option&&(r.option=d(e.option)),e.options?r.options=e.options.map((e=>e?t.WeightedVoteOption.toJSON(e):void 0)):r.options=[],r},fromPartial(e){const r=m();return void 0!==e.proposalId&&null!==e.proposalId&&(r.proposalId=BigInt(e.proposalId.toString())),r.voter=e.voter??"",r.option=e.option??0,r.options=e.options?.map((e=>t.WeightedVoteOption.fromPartial(e)))||[],r}},t.DepositParams={typeUrl:"/cosmos.gov.v1beta1.DepositParams",encode(e,t=a.BinaryWriter.create()){for(const r of e.minDeposit)n.Coin.encode(r,t.uint32(10).fork()).ldelim();return void 0!==e.maxDepositPeriod&&o.Duration.encode(e.maxDepositPeriod,t.uint32(18).fork()).ldelim(),t},decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s=b();for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:s.minDeposit.push(n.Coin.decode(r,r.uint32()));break;case 2:s.maxDepositPeriod=o.Duration.decode(r,r.uint32());break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=b();return Array.isArray(e?.minDeposit)&&(t.minDeposit=e.minDeposit.map((e=>n.Coin.fromJSON(e)))),(0,c.isSet)(e.maxDepositPeriod)&&(t.maxDepositPeriod=o.Duration.fromJSON(e.maxDepositPeriod)),t},toJSON(e){const t={};return e.minDeposit?t.minDeposit=e.minDeposit.map((e=>e?n.Coin.toJSON(e):void 0)):t.minDeposit=[],void 0!==e.maxDepositPeriod&&(t.maxDepositPeriod=e.maxDepositPeriod?o.Duration.toJSON(e.maxDepositPeriod):void 0),t},fromPartial(e){const t=b();return t.minDeposit=e.minDeposit?.map((e=>n.Coin.fromPartial(e)))||[],void 0!==e.maxDepositPeriod&&null!==e.maxDepositPeriod&&(t.maxDepositPeriod=o.Duration.fromPartial(e.maxDepositPeriod)),t}},t.VotingParams={typeUrl:"/cosmos.gov.v1beta1.VotingParams",encode:(e,t=a.BinaryWriter.create())=>(void 0!==e.votingPeriod&&o.Duration.encode(e.votingPeriod,t.uint32(10).fork()).ldelim(),t),decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=w();for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.votingPeriod=o.Duration.decode(r,r.uint32());else r.skipType(7&e)}return i},fromJSON(e){const t=w();return(0,c.isSet)(e.votingPeriod)&&(t.votingPeriod=o.Duration.fromJSON(e.votingPeriod)),t},toJSON(e){const t={};return void 0!==e.votingPeriod&&(t.votingPeriod=e.votingPeriod?o.Duration.toJSON(e.votingPeriod):void 0),t},fromPartial(e){const t=w();return void 0!==e.votingPeriod&&null!==e.votingPeriod&&(t.votingPeriod=o.Duration.fromPartial(e.votingPeriod)),t}},t.TallyParams={typeUrl:"/cosmos.gov.v1beta1.TallyParams",encode:(e,t=a.BinaryWriter.create())=>(0!==e.quorum.length&&t.uint32(10).bytes(e.quorum),0!==e.threshold.length&&t.uint32(18).bytes(e.threshold),0!==e.vetoThreshold.length&&t.uint32(26).bytes(e.vetoThreshold),t),decode(e,t){const r=e instanceof a.BinaryReader?e:new a.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=v();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.quorum=r.bytes();break;case 2:i.threshold=r.bytes();break;case 3:i.vetoThreshold=r.bytes();break;default:r.skipType(7&e)}}return i},fromJSON(e){const t=v();return(0,c.isSet)(e.quorum)&&(t.quorum=(0,c.bytesFromBase64)(e.quorum)),(0,c.isSet)(e.threshold)&&(t.threshold=(0,c.bytesFromBase64)(e.threshold)),(0,c.isSet)(e.vetoThreshold)&&(t.vetoThreshold=(0,c.bytesFromBase64)(e.vetoThreshold)),t},toJSON(e){const t={};return void 0!==e.quorum&&(t.quorum=(0,c.base64FromBytes)(void 0!==e.quorum?e.quorum:new Uint8Array)),void 0!==e.threshold&&(t.threshold=(0,c.base64FromBytes)(void 0!==e.threshold?e.threshold:new Uint8Array)),void 0!==e.vetoThreshold&&(t.vetoThreshold=(0,c.base64FromBytes)(void 0!==e.vetoThreshold?e.vetoThreshold:new Uint8Array)),t},fromPartial(e){const t=v();return t.quorum=e.quorum??new Uint8Array,t.threshold=e.threshold??new Uint8Array,t.vetoThreshold=e.vetoThreshold??new Uint8Array,t}}},92692:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceClientImpl=t.TxDecodeAminoResponse=t.TxDecodeAminoRequest=t.TxEncodeAminoResponse=t.TxEncodeAminoRequest=t.TxEncodeResponse=t.TxEncodeRequest=t.TxDecodeResponse=t.TxDecodeRequest=t.GetBlockWithTxsResponse=t.GetBlockWithTxsRequest=t.GetTxResponse=t.GetTxRequest=t.SimulateResponse=t.SimulateRequest=t.BroadcastTxResponse=t.BroadcastTxRequest=t.GetTxsEventResponse=t.GetTxsEventRequest=t.broadcastModeToJSON=t.broadcastModeFromJSON=t.BroadcastMode=t.orderByToJSON=t.orderByFromJSON=t.OrderBy=t.protobufPackage=void 0;const n=r(6975),i=r(99569),s=r(85231),o=r(11068),a=r(94392),c=r(50287),u=r(42825);var l,h;function d(e){switch(e){case 0:case"ORDER_BY_UNSPECIFIED":return l.ORDER_BY_UNSPECIFIED;case 1:case"ORDER_BY_ASC":return l.ORDER_BY_ASC;case 2:case"ORDER_BY_DESC":return l.ORDER_BY_DESC;default:return l.UNRECOGNIZED}}function f(e){switch(e){case l.ORDER_BY_UNSPECIFIED:return"ORDER_BY_UNSPECIFIED";case l.ORDER_BY_ASC:return"ORDER_BY_ASC";case l.ORDER_BY_DESC:return"ORDER_BY_DESC";case l.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function p(e){switch(e){case 0:case"BROADCAST_MODE_UNSPECIFIED":return h.BROADCAST_MODE_UNSPECIFIED;case 1:case"BROADCAST_MODE_BLOCK":return h.BROADCAST_MODE_BLOCK;case 2:case"BROADCAST_MODE_SYNC":return h.BROADCAST_MODE_SYNC;case 3:case"BROADCAST_MODE_ASYNC":return h.BROADCAST_MODE_ASYNC;default:return h.UNRECOGNIZED}}function y(e){switch(e){case h.BROADCAST_MODE_UNSPECIFIED:return"BROADCAST_MODE_UNSPECIFIED";case h.BROADCAST_MODE_BLOCK:return"BROADCAST_MODE_BLOCK";case h.BROADCAST_MODE_SYNC:return"BROADCAST_MODE_SYNC";case h.BROADCAST_MODE_ASYNC:return"BROADCAST_MODE_ASYNC";case h.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function g(){return{events:[],pagination:void 0,orderBy:0,page:BigInt(0),limit:BigInt(0)}}function m(){return{txs:[],txResponses:[],pagination:void 0,total:BigInt(0)}}function b(){return{txBytes:new Uint8Array,mode:0}}function w(){return{tx:void 0,txBytes:new Uint8Array}}function v(){return{height:BigInt(0),pagination:void 0}}function _(){return{txBytes:new Uint8Array}}function E(){return{txBytes:new Uint8Array}}function S(){return{aminoBinary:new Uint8Array}}function x(){return{aminoBinary:new Uint8Array}}t.protobufPackage="cosmos.tx.v1beta1",function(e){e[e.ORDER_BY_UNSPECIFIED=0]="ORDER_BY_UNSPECIFIED",e[e.ORDER_BY_ASC=1]="ORDER_BY_ASC",e[e.ORDER_BY_DESC=2]="ORDER_BY_DESC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(l||(t.OrderBy=l={})),t.orderByFromJSON=d,t.orderByToJSON=f,function(e){e[e.BROADCAST_MODE_UNSPECIFIED=0]="BROADCAST_MODE_UNSPECIFIED",e[e.BROADCAST_MODE_BLOCK=1]="BROADCAST_MODE_BLOCK",e[e.BROADCAST_MODE_SYNC=2]="BROADCAST_MODE_SYNC",e[e.BROADCAST_MODE_ASYNC=3]="BROADCAST_MODE_ASYNC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(h||(t.BroadcastMode=h={})),t.broadcastModeFromJSON=p,t.broadcastModeToJSON=y,t.GetTxsEventRequest={typeUrl:"/cosmos.tx.v1beta1.GetTxsEventRequest",encode(e,t=c.BinaryWriter.create()){for(const r of e.events)t.uint32(10).string(r);return void 0!==e.pagination&&i.PageRequest.encode(e.pagination,t.uint32(18).fork()).ldelim(),0!==e.orderBy&&t.uint32(24).int32(e.orderBy),e.page!==BigInt(0)&&t.uint32(32).uint64(e.page),e.limit!==BigInt(0)&&t.uint32(40).uint64(e.limit),t},decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s=g();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.events.push(r.string());break;case 2:s.pagination=i.PageRequest.decode(r,r.uint32());break;case 3:s.orderBy=r.int32();break;case 4:s.page=r.uint64();break;case 5:s.limit=r.uint64();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=g();return Array.isArray(e?.events)&&(t.events=e.events.map((e=>String(e)))),(0,u.isSet)(e.pagination)&&(t.pagination=i.PageRequest.fromJSON(e.pagination)),(0,u.isSet)(e.orderBy)&&(t.orderBy=d(e.orderBy)),(0,u.isSet)(e.page)&&(t.page=BigInt(e.page.toString())),(0,u.isSet)(e.limit)&&(t.limit=BigInt(e.limit.toString())),t},toJSON(e){const t={};return e.events?t.events=e.events.map((e=>e)):t.events=[],void 0!==e.pagination&&(t.pagination=e.pagination?i.PageRequest.toJSON(e.pagination):void 0),void 0!==e.orderBy&&(t.orderBy=f(e.orderBy)),void 0!==e.page&&(t.page=(e.page||BigInt(0)).toString()),void 0!==e.limit&&(t.limit=(e.limit||BigInt(0)).toString()),t},fromPartial(e){const t=g();return t.events=e.events?.map((e=>e))||[],void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageRequest.fromPartial(e.pagination)),t.orderBy=e.orderBy??0,void 0!==e.page&&null!==e.page&&(t.page=BigInt(e.page.toString())),void 0!==e.limit&&null!==e.limit&&(t.limit=BigInt(e.limit.toString())),t}},t.GetTxsEventResponse={typeUrl:"/cosmos.tx.v1beta1.GetTxsEventResponse",encode(e,t=c.BinaryWriter.create()){for(const r of e.txs)n.Tx.encode(r,t.uint32(10).fork()).ldelim();for(const r of e.txResponses)s.TxResponse.encode(r,t.uint32(18).fork()).ldelim();return void 0!==e.pagination&&i.PageResponse.encode(e.pagination,t.uint32(26).fork()).ldelim(),e.total!==BigInt(0)&&t.uint32(32).uint64(e.total),t},decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let o=void 0===t?r.len:r.pos+t;const a=m();for(;r.pos<o;){const e=r.uint32();switch(e>>>3){case 1:a.txs.push(n.Tx.decode(r,r.uint32()));break;case 2:a.txResponses.push(s.TxResponse.decode(r,r.uint32()));break;case 3:a.pagination=i.PageResponse.decode(r,r.uint32());break;case 4:a.total=r.uint64();break;default:r.skipType(7&e)}}return a},fromJSON(e){const t=m();return Array.isArray(e?.txs)&&(t.txs=e.txs.map((e=>n.Tx.fromJSON(e)))),Array.isArray(e?.txResponses)&&(t.txResponses=e.txResponses.map((e=>s.TxResponse.fromJSON(e)))),(0,u.isSet)(e.pagination)&&(t.pagination=i.PageResponse.fromJSON(e.pagination)),(0,u.isSet)(e.total)&&(t.total=BigInt(e.total.toString())),t},toJSON(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toJSON(e):void 0)):t.txs=[],e.txResponses?t.txResponses=e.txResponses.map((e=>e?s.TxResponse.toJSON(e):void 0)):t.txResponses=[],void 0!==e.pagination&&(t.pagination=e.pagination?i.PageResponse.toJSON(e.pagination):void 0),void 0!==e.total&&(t.total=(e.total||BigInt(0)).toString()),t},fromPartial(e){const t=m();return t.txs=e.txs?.map((e=>n.Tx.fromPartial(e)))||[],t.txResponses=e.txResponses?.map((e=>s.TxResponse.fromPartial(e)))||[],void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageResponse.fromPartial(e.pagination)),void 0!==e.total&&null!==e.total&&(t.total=BigInt(e.total.toString())),t}},t.BroadcastTxRequest={typeUrl:"/cosmos.tx.v1beta1.BroadcastTxRequest",encode:(e,t=c.BinaryWriter.create())=>(0!==e.txBytes.length&&t.uint32(10).bytes(e.txBytes),0!==e.mode&&t.uint32(16).int32(e.mode),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=b();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.txBytes=r.bytes();break;case 2:i.mode=r.int32();break;default:r.skipType(7&e)}}return i},fromJSON(e){const t=b();return(0,u.isSet)(e.txBytes)&&(t.txBytes=(0,u.bytesFromBase64)(e.txBytes)),(0,u.isSet)(e.mode)&&(t.mode=p(e.mode)),t},toJSON(e){const t={};return void 0!==e.txBytes&&(t.txBytes=(0,u.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),void 0!==e.mode&&(t.mode=y(e.mode)),t},fromPartial(e){const t=b();return t.txBytes=e.txBytes??new Uint8Array,t.mode=e.mode??0,t}},t.BroadcastTxResponse={typeUrl:"/cosmos.tx.v1beta1.BroadcastTxResponse",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.txResponse&&s.TxResponse.encode(e.txResponse,t.uint32(10).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={txResponse:void 0};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.txResponse=s.TxResponse.decode(r,r.uint32());else r.skipType(7&e)}return i},fromJSON(e){const t={txResponse:void 0};return(0,u.isSet)(e.txResponse)&&(t.txResponse=s.TxResponse.fromJSON(e.txResponse)),t},toJSON(e){const t={};return void 0!==e.txResponse&&(t.txResponse=e.txResponse?s.TxResponse.toJSON(e.txResponse):void 0),t},fromPartial(e){const t={txResponse:void 0};return void 0!==e.txResponse&&null!==e.txResponse&&(t.txResponse=s.TxResponse.fromPartial(e.txResponse)),t}},t.SimulateRequest={typeUrl:"/cosmos.tx.v1beta1.SimulateRequest",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),0!==e.txBytes.length&&t.uint32(18).bytes(e.txBytes),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s=w();for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:s.tx=n.Tx.decode(r,r.uint32());break;case 2:s.txBytes=r.bytes();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=w();return(0,u.isSet)(e.tx)&&(t.tx=n.Tx.fromJSON(e.tx)),(0,u.isSet)(e.txBytes)&&(t.txBytes=(0,u.bytesFromBase64)(e.txBytes)),t},toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),void 0!==e.txBytes&&(t.txBytes=(0,u.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),t},fromPartial(e){const t=w();return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromPartial(e.tx)),t.txBytes=e.txBytes??new Uint8Array,t}},t.SimulateResponse={typeUrl:"/cosmos.tx.v1beta1.SimulateResponse",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.gasInfo&&s.GasInfo.encode(e.gasInfo,t.uint32(10).fork()).ldelim(),void 0!==e.result&&s.Result.encode(e.result,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={gasInfo:void 0,result:void 0};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:i.gasInfo=s.GasInfo.decode(r,r.uint32());break;case 2:i.result=s.Result.decode(r,r.uint32());break;default:r.skipType(7&e)}}return i},fromJSON(e){const t={gasInfo:void 0,result:void 0};return(0,u.isSet)(e.gasInfo)&&(t.gasInfo=s.GasInfo.fromJSON(e.gasInfo)),(0,u.isSet)(e.result)&&(t.result=s.Result.fromJSON(e.result)),t},toJSON(e){const t={};return void 0!==e.gasInfo&&(t.gasInfo=e.gasInfo?s.GasInfo.toJSON(e.gasInfo):void 0),void 0!==e.result&&(t.result=e.result?s.Result.toJSON(e.result):void 0),t},fromPartial(e){const t={gasInfo:void 0,result:void 0};return void 0!==e.gasInfo&&null!==e.gasInfo&&(t.gasInfo=s.GasInfo.fromPartial(e.gasInfo)),void 0!==e.result&&null!==e.result&&(t.result=s.Result.fromPartial(e.result)),t}},t.GetTxRequest={typeUrl:"/cosmos.tx.v1beta1.GetTxRequest",encode:(e,t=c.BinaryWriter.create())=>(""!==e.hash&&t.uint32(10).string(e.hash),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={hash:""};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.hash=r.string();else r.skipType(7&e)}return i},fromJSON(e){const t={hash:""};return(0,u.isSet)(e.hash)&&(t.hash=String(e.hash)),t},toJSON(e){const t={};return void 0!==e.hash&&(t.hash=e.hash),t},fromPartial(e){const t={hash:""};return t.hash=e.hash??"",t}},t.GetTxResponse={typeUrl:"/cosmos.tx.v1beta1.GetTxResponse",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),void 0!==e.txResponse&&s.TxResponse.encode(e.txResponse,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const o={tx:void 0,txResponse:void 0};for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:o.tx=n.Tx.decode(r,r.uint32());break;case 2:o.txResponse=s.TxResponse.decode(r,r.uint32());break;default:r.skipType(7&e)}}return o},fromJSON(e){const t={tx:void 0,txResponse:void 0};return(0,u.isSet)(e.tx)&&(t.tx=n.Tx.fromJSON(e.tx)),(0,u.isSet)(e.txResponse)&&(t.txResponse=s.TxResponse.fromJSON(e.txResponse)),t},toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),void 0!==e.txResponse&&(t.txResponse=e.txResponse?s.TxResponse.toJSON(e.txResponse):void 0),t},fromPartial(e){const t={tx:void 0,txResponse:void 0};return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromPartial(e.tx)),void 0!==e.txResponse&&null!==e.txResponse&&(t.txResponse=s.TxResponse.fromPartial(e.txResponse)),t}},t.GetBlockWithTxsRequest={typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsRequest",encode:(e,t=c.BinaryWriter.create())=>(e.height!==BigInt(0)&&t.uint32(8).int64(e.height),void 0!==e.pagination&&i.PageRequest.encode(e.pagination,t.uint32(18).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s=v();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.height=r.int64();break;case 2:s.pagination=i.PageRequest.decode(r,r.uint32());break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=v();return(0,u.isSet)(e.height)&&(t.height=BigInt(e.height.toString())),(0,u.isSet)(e.pagination)&&(t.pagination=i.PageRequest.fromJSON(e.pagination)),t},toJSON(e){const t={};return void 0!==e.height&&(t.height=(e.height||BigInt(0)).toString()),void 0!==e.pagination&&(t.pagination=e.pagination?i.PageRequest.toJSON(e.pagination):void 0),t},fromPartial(e){const t=v();return void 0!==e.height&&null!==e.height&&(t.height=BigInt(e.height.toString())),void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageRequest.fromPartial(e.pagination)),t}},t.GetBlockWithTxsResponse={typeUrl:"/cosmos.tx.v1beta1.GetBlockWithTxsResponse",encode(e,t=c.BinaryWriter.create()){for(const r of e.txs)n.Tx.encode(r,t.uint32(10).fork()).ldelim();return void 0!==e.blockId&&o.BlockID.encode(e.blockId,t.uint32(18).fork()).ldelim(),void 0!==e.block&&a.Block.encode(e.block,t.uint32(26).fork()).ldelim(),void 0!==e.pagination&&i.PageResponse.encode(e.pagination,t.uint32(34).fork()).ldelim(),t},decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const u={txs:[],blockId:void 0,block:void 0,pagination:void 0};for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:u.txs.push(n.Tx.decode(r,r.uint32()));break;case 2:u.blockId=o.BlockID.decode(r,r.uint32());break;case 3:u.block=a.Block.decode(r,r.uint32());break;case 4:u.pagination=i.PageResponse.decode(r,r.uint32());break;default:r.skipType(7&e)}}return u},fromJSON(e){const t={txs:[],blockId:void 0,block:void 0,pagination:void 0};return Array.isArray(e?.txs)&&(t.txs=e.txs.map((e=>n.Tx.fromJSON(e)))),(0,u.isSet)(e.blockId)&&(t.blockId=o.BlockID.fromJSON(e.blockId)),(0,u.isSet)(e.block)&&(t.block=a.Block.fromJSON(e.block)),(0,u.isSet)(e.pagination)&&(t.pagination=i.PageResponse.fromJSON(e.pagination)),t},toJSON(e){const t={};return e.txs?t.txs=e.txs.map((e=>e?n.Tx.toJSON(e):void 0)):t.txs=[],void 0!==e.blockId&&(t.blockId=e.blockId?o.BlockID.toJSON(e.blockId):void 0),void 0!==e.block&&(t.block=e.block?a.Block.toJSON(e.block):void 0),void 0!==e.pagination&&(t.pagination=e.pagination?i.PageResponse.toJSON(e.pagination):void 0),t},fromPartial(e){const t={txs:[],blockId:void 0,block:void 0,pagination:void 0};return t.txs=e.txs?.map((e=>n.Tx.fromPartial(e)))||[],void 0!==e.blockId&&null!==e.blockId&&(t.blockId=o.BlockID.fromPartial(e.blockId)),void 0!==e.block&&null!==e.block&&(t.block=a.Block.fromPartial(e.block)),void 0!==e.pagination&&null!==e.pagination&&(t.pagination=i.PageResponse.fromPartial(e.pagination)),t}},t.TxDecodeRequest={typeUrl:"/cosmos.tx.v1beta1.TxDecodeRequest",encode:(e,t=c.BinaryWriter.create())=>(0!==e.txBytes.length&&t.uint32(10).bytes(e.txBytes),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=_();for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.txBytes=r.bytes();else r.skipType(7&e)}return i},fromJSON(e){const t=_();return(0,u.isSet)(e.txBytes)&&(t.txBytes=(0,u.bytesFromBase64)(e.txBytes)),t},toJSON(e){const t={};return void 0!==e.txBytes&&(t.txBytes=(0,u.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),t},fromPartial(e){const t=_();return t.txBytes=e.txBytes??new Uint8Array,t}},t.TxDecodeResponse={typeUrl:"/cosmos.tx.v1beta1.TxDecodeResponse",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s={tx:void 0};for(;r.pos<i;){const e=r.uint32();if(e>>>3==1)s.tx=n.Tx.decode(r,r.uint32());else r.skipType(7&e)}return s},fromJSON(e){const t={tx:void 0};return(0,u.isSet)(e.tx)&&(t.tx=n.Tx.fromJSON(e.tx)),t},toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),t},fromPartial(e){const t={tx:void 0};return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromPartial(e.tx)),t}},t.TxEncodeRequest={typeUrl:"/cosmos.tx.v1beta1.TxEncodeRequest",encode:(e,t=c.BinaryWriter.create())=>(void 0!==e.tx&&n.Tx.encode(e.tx,t.uint32(10).fork()).ldelim(),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let i=void 0===t?r.len:r.pos+t;const s={tx:void 0};for(;r.pos<i;){const e=r.uint32();if(e>>>3==1)s.tx=n.Tx.decode(r,r.uint32());else r.skipType(7&e)}return s},fromJSON(e){const t={tx:void 0};return(0,u.isSet)(e.tx)&&(t.tx=n.Tx.fromJSON(e.tx)),t},toJSON(e){const t={};return void 0!==e.tx&&(t.tx=e.tx?n.Tx.toJSON(e.tx):void 0),t},fromPartial(e){const t={tx:void 0};return void 0!==e.tx&&null!==e.tx&&(t.tx=n.Tx.fromPartial(e.tx)),t}},t.TxEncodeResponse={typeUrl:"/cosmos.tx.v1beta1.TxEncodeResponse",encode:(e,t=c.BinaryWriter.create())=>(0!==e.txBytes.length&&t.uint32(10).bytes(e.txBytes),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=E();for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.txBytes=r.bytes();else r.skipType(7&e)}return i},fromJSON(e){const t=E();return(0,u.isSet)(e.txBytes)&&(t.txBytes=(0,u.bytesFromBase64)(e.txBytes)),t},toJSON(e){const t={};return void 0!==e.txBytes&&(t.txBytes=(0,u.base64FromBytes)(void 0!==e.txBytes?e.txBytes:new Uint8Array)),t},fromPartial(e){const t=E();return t.txBytes=e.txBytes??new Uint8Array,t}},t.TxEncodeAminoRequest={typeUrl:"/cosmos.tx.v1beta1.TxEncodeAminoRequest",encode:(e,t=c.BinaryWriter.create())=>(""!==e.aminoJson&&t.uint32(10).string(e.aminoJson),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={aminoJson:""};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.aminoJson=r.string();else r.skipType(7&e)}return i},fromJSON(e){const t={aminoJson:""};return(0,u.isSet)(e.aminoJson)&&(t.aminoJson=String(e.aminoJson)),t},toJSON(e){const t={};return void 0!==e.aminoJson&&(t.aminoJson=e.aminoJson),t},fromPartial(e){const t={aminoJson:""};return t.aminoJson=e.aminoJson??"",t}},t.TxEncodeAminoResponse={typeUrl:"/cosmos.tx.v1beta1.TxEncodeAminoResponse",encode:(e,t=c.BinaryWriter.create())=>(0!==e.aminoBinary.length&&t.uint32(10).bytes(e.aminoBinary),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=S();for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.aminoBinary=r.bytes();else r.skipType(7&e)}return i},fromJSON(e){const t=S();return(0,u.isSet)(e.aminoBinary)&&(t.aminoBinary=(0,u.bytesFromBase64)(e.aminoBinary)),t},toJSON(e){const t={};return void 0!==e.aminoBinary&&(t.aminoBinary=(0,u.base64FromBytes)(void 0!==e.aminoBinary?e.aminoBinary:new Uint8Array)),t},fromPartial(e){const t=S();return t.aminoBinary=e.aminoBinary??new Uint8Array,t}},t.TxDecodeAminoRequest={typeUrl:"/cosmos.tx.v1beta1.TxDecodeAminoRequest",encode:(e,t=c.BinaryWriter.create())=>(0!==e.aminoBinary.length&&t.uint32(10).bytes(e.aminoBinary),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i=x();for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.aminoBinary=r.bytes();else r.skipType(7&e)}return i},fromJSON(e){const t=x();return(0,u.isSet)(e.aminoBinary)&&(t.aminoBinary=(0,u.bytesFromBase64)(e.aminoBinary)),t},toJSON(e){const t={};return void 0!==e.aminoBinary&&(t.aminoBinary=(0,u.base64FromBytes)(void 0!==e.aminoBinary?e.aminoBinary:new Uint8Array)),t},fromPartial(e){const t=x();return t.aminoBinary=e.aminoBinary??new Uint8Array,t}},t.TxDecodeAminoResponse={typeUrl:"/cosmos.tx.v1beta1.TxDecodeAminoResponse",encode:(e,t=c.BinaryWriter.create())=>(""!==e.aminoJson&&t.uint32(10).string(e.aminoJson),t),decode(e,t){const r=e instanceof c.BinaryReader?e:new c.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const i={aminoJson:""};for(;r.pos<n;){const e=r.uint32();if(e>>>3==1)i.aminoJson=r.string();else r.skipType(7&e)}return i},fromJSON(e){const t={aminoJson:""};return(0,u.isSet)(e.aminoJson)&&(t.aminoJson=String(e.aminoJson)),t},toJSON(e){const t={};return void 0!==e.aminoJson&&(t.aminoJson=e.aminoJson),t},fromPartial(e){const t={aminoJson:""};return t.aminoJson=e.aminoJson??"",t}};t.ServiceClientImpl=class{constructor(e){this.rpc=e,this.Simulate=this.Simulate.bind(this),this.GetTx=this.GetTx.bind(this),this.BroadcastTx=this.BroadcastTx.bind(this),this.GetTxsEvent=this.GetTxsEvent.bind(this),this.GetBlockWithTxs=this.GetBlockWithTxs.bind(this),this.TxDecode=this.TxDecode.bind(this),this.TxEncode=this.TxEncode.bind(this),this.TxEncodeAmino=this.TxEncodeAmino.bind(this),this.TxDecodeAmino=this.TxDecodeAmino.bind(this)}Simulate(e){const r=t.SimulateRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","Simulate",r).then((e=>t.SimulateResponse.decode(new c.BinaryReader(e))))}GetTx(e){const r=t.GetTxRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","GetTx",r).then((e=>t.GetTxResponse.decode(new c.BinaryReader(e))))}BroadcastTx(e){const r=t.BroadcastTxRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","BroadcastTx",r).then((e=>t.BroadcastTxResponse.decode(new c.BinaryReader(e))))}GetTxsEvent(e){const r=t.GetTxsEventRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","GetTxsEvent",r).then((e=>t.GetTxsEventResponse.decode(new c.BinaryReader(e))))}GetBlockWithTxs(e){const r=t.GetBlockWithTxsRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","GetBlockWithTxs",r).then((e=>t.GetBlockWithTxsResponse.decode(new c.BinaryReader(e))))}TxDecode(e){const r=t.TxDecodeRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","TxDecode",r).then((e=>t.TxDecodeResponse.decode(new c.BinaryReader(e))))}TxEncode(e){const r=t.TxEncodeRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","TxEncode",r).then((e=>t.TxEncodeResponse.decode(new c.BinaryReader(e))))}TxEncodeAmino(e){const r=t.TxEncodeAminoRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","TxEncodeAmino",r).then((e=>t.TxEncodeAminoResponse.decode(new c.BinaryReader(e))))}TxDecodeAmino(e){const r=t.TxDecodeAminoRequest.encode(e).finish();return this.rpc.request("cosmos.tx.v1beta1.Service","TxDecodeAmino",r).then((e=>t.TxDecodeAminoResponse.decode(new c.BinaryReader(e))))}}},81386:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Acknowledgement=t.PacketId=t.PacketState=t.Packet=t.Counterparty=t.IdentifiedChannel=t.Channel=t.orderToJSON=t.orderFromJSON=t.Order=t.stateToJSON=t.stateFromJSON=t.State=t.protobufPackage=void 0;const n=r(51178),i=r(50287),s=r(42825);var o,a;function c(e){switch(e){case 0:case"STATE_UNINITIALIZED_UNSPECIFIED":return o.STATE_UNINITIALIZED_UNSPECIFIED;case 1:case"STATE_INIT":return o.STATE_INIT;case 2:case"STATE_TRYOPEN":return o.STATE_TRYOPEN;case 3:case"STATE_OPEN":return o.STATE_OPEN;case 4:case"STATE_CLOSED":return o.STATE_CLOSED;default:return o.UNRECOGNIZED}}function u(e){switch(e){case o.STATE_UNINITIALIZED_UNSPECIFIED:return"STATE_UNINITIALIZED_UNSPECIFIED";case o.STATE_INIT:return"STATE_INIT";case o.STATE_TRYOPEN:return"STATE_TRYOPEN";case o.STATE_OPEN:return"STATE_OPEN";case o.STATE_CLOSED:return"STATE_CLOSED";case o.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function l(e){switch(e){case 0:case"ORDER_NONE_UNSPECIFIED":return a.ORDER_NONE_UNSPECIFIED;case 1:case"ORDER_UNORDERED":return a.ORDER_UNORDERED;case 2:case"ORDER_ORDERED":return a.ORDER_ORDERED;default:return a.UNRECOGNIZED}}function h(e){switch(e){case a.ORDER_NONE_UNSPECIFIED:return"ORDER_NONE_UNSPECIFIED";case a.ORDER_UNORDERED:return"ORDER_UNORDERED";case a.ORDER_ORDERED:return"ORDER_ORDERED";case a.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function d(){return{state:0,ordering:0,counterparty:t.Counterparty.fromPartial({}),connectionHops:[],version:""}}function f(){return{state:0,ordering:0,counterparty:t.Counterparty.fromPartial({}),connectionHops:[],version:"",portId:"",channelId:""}}function p(){return{sequence:BigInt(0),sourcePort:"",sourceChannel:"",destinationPort:"",destinationChannel:"",data:new Uint8Array,timeoutHeight:n.Height.fromPartial({}),timeoutTimestamp:BigInt(0)}}function y(){return{portId:"",channelId:"",sequence:BigInt(0),data:new Uint8Array}}function g(){return{portId:"",channelId:"",sequence:BigInt(0)}}t.protobufPackage="ibc.core.channel.v1",function(e){e[e.STATE_UNINITIALIZED_UNSPECIFIED=0]="STATE_UNINITIALIZED_UNSPECIFIED",e[e.STATE_INIT=1]="STATE_INIT",e[e.STATE_TRYOPEN=2]="STATE_TRYOPEN",e[e.STATE_OPEN=3]="STATE_OPEN",e[e.STATE_CLOSED=4]="STATE_CLOSED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(o||(t.State=o={})),t.stateFromJSON=c,t.stateToJSON=u,function(e){e[e.ORDER_NONE_UNSPECIFIED=0]="ORDER_NONE_UNSPECIFIED",e[e.ORDER_UNORDERED=1]="ORDER_UNORDERED",e[e.ORDER_ORDERED=2]="ORDER_ORDERED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(a||(t.Order=a={})),t.orderFromJSON=l,t.orderToJSON=h,t.Channel={typeUrl:"/ibc.core.channel.v1.Channel",encode(e,r=i.BinaryWriter.create()){0!==e.state&&r.uint32(8).int32(e.state),0!==e.ordering&&r.uint32(16).int32(e.ordering),void 0!==e.counterparty&&t.Counterparty.encode(e.counterparty,r.uint32(26).fork()).ldelim();for(const t of e.connectionHops)r.uint32(34).string(t);return""!==e.version&&r.uint32(42).string(e.version),r},decode(e,r){const n=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===r?n.len:n.pos+r;const o=d();for(;n.pos<s;){const e=n.uint32();switch(e>>>3){case 1:o.state=n.int32();break;case 2:o.ordering=n.int32();break;case 3:o.counterparty=t.Counterparty.decode(n,n.uint32());break;case 4:o.connectionHops.push(n.string());break;case 5:o.version=n.string();break;default:n.skipType(7&e)}}return o},fromJSON(e){const r=d();return(0,s.isSet)(e.state)&&(r.state=c(e.state)),(0,s.isSet)(e.ordering)&&(r.ordering=l(e.ordering)),(0,s.isSet)(e.counterparty)&&(r.counterparty=t.Counterparty.fromJSON(e.counterparty)),Array.isArray(e?.connectionHops)&&(r.connectionHops=e.connectionHops.map((e=>String(e)))),(0,s.isSet)(e.version)&&(r.version=String(e.version)),r},toJSON(e){const r={};return void 0!==e.state&&(r.state=u(e.state)),void 0!==e.ordering&&(r.ordering=h(e.ordering)),void 0!==e.counterparty&&(r.counterparty=e.counterparty?t.Counterparty.toJSON(e.counterparty):void 0),e.connectionHops?r.connectionHops=e.connectionHops.map((e=>e)):r.connectionHops=[],void 0!==e.version&&(r.version=e.version),r},fromPartial(e){const r=d();return r.state=e.state??0,r.ordering=e.ordering??0,void 0!==e.counterparty&&null!==e.counterparty&&(r.counterparty=t.Counterparty.fromPartial(e.counterparty)),r.connectionHops=e.connectionHops?.map((e=>e))||[],r.version=e.version??"",r}},t.IdentifiedChannel={typeUrl:"/ibc.core.channel.v1.IdentifiedChannel",encode(e,r=i.BinaryWriter.create()){0!==e.state&&r.uint32(8).int32(e.state),0!==e.ordering&&r.uint32(16).int32(e.ordering),void 0!==e.counterparty&&t.Counterparty.encode(e.counterparty,r.uint32(26).fork()).ldelim();for(const t of e.connectionHops)r.uint32(34).string(t);return""!==e.version&&r.uint32(42).string(e.version),""!==e.portId&&r.uint32(50).string(e.portId),""!==e.channelId&&r.uint32(58).string(e.channelId),r},decode(e,r){const n=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===r?n.len:n.pos+r;const o=f();for(;n.pos<s;){const e=n.uint32();switch(e>>>3){case 1:o.state=n.int32();break;case 2:o.ordering=n.int32();break;case 3:o.counterparty=t.Counterparty.decode(n,n.uint32());break;case 4:o.connectionHops.push(n.string());break;case 5:o.version=n.string();break;case 6:o.portId=n.string();break;case 7:o.channelId=n.string();break;default:n.skipType(7&e)}}return o},fromJSON(e){const r=f();return(0,s.isSet)(e.state)&&(r.state=c(e.state)),(0,s.isSet)(e.ordering)&&(r.ordering=l(e.ordering)),(0,s.isSet)(e.counterparty)&&(r.counterparty=t.Counterparty.fromJSON(e.counterparty)),Array.isArray(e?.connectionHops)&&(r.connectionHops=e.connectionHops.map((e=>String(e)))),(0,s.isSet)(e.version)&&(r.version=String(e.version)),(0,s.isSet)(e.portId)&&(r.portId=String(e.portId)),(0,s.isSet)(e.channelId)&&(r.channelId=String(e.channelId)),r},toJSON(e){const r={};return void 0!==e.state&&(r.state=u(e.state)),void 0!==e.ordering&&(r.ordering=h(e.ordering)),void 0!==e.counterparty&&(r.counterparty=e.counterparty?t.Counterparty.toJSON(e.counterparty):void 0),e.connectionHops?r.connectionHops=e.connectionHops.map((e=>e)):r.connectionHops=[],void 0!==e.version&&(r.version=e.version),void 0!==e.portId&&(r.portId=e.portId),void 0!==e.channelId&&(r.channelId=e.channelId),r},fromPartial(e){const r=f();return r.state=e.state??0,r.ordering=e.ordering??0,void 0!==e.counterparty&&null!==e.counterparty&&(r.counterparty=t.Counterparty.fromPartial(e.counterparty)),r.connectionHops=e.connectionHops?.map((e=>e))||[],r.version=e.version??"",r.portId=e.portId??"",r.channelId=e.channelId??"",r}},t.Counterparty={typeUrl:"/ibc.core.channel.v1.Counterparty",encode:(e,t=i.BinaryWriter.create())=>(""!==e.portId&&t.uint32(10).string(e.portId),""!==e.channelId&&t.uint32(18).string(e.channelId),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={portId:"",channelId:""};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.portId=r.string();break;case 2:s.channelId=r.string();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t={portId:"",channelId:""};return(0,s.isSet)(e.portId)&&(t.portId=String(e.portId)),(0,s.isSet)(e.channelId)&&(t.channelId=String(e.channelId)),t},toJSON(e){const t={};return void 0!==e.portId&&(t.portId=e.portId),void 0!==e.channelId&&(t.channelId=e.channelId),t},fromPartial(e){const t={portId:"",channelId:""};return t.portId=e.portId??"",t.channelId=e.channelId??"",t}},t.Packet={typeUrl:"/ibc.core.channel.v1.Packet",encode:(e,t=i.BinaryWriter.create())=>(e.sequence!==BigInt(0)&&t.uint32(8).uint64(e.sequence),""!==e.sourcePort&&t.uint32(18).string(e.sourcePort),""!==e.sourceChannel&&t.uint32(26).string(e.sourceChannel),""!==e.destinationPort&&t.uint32(34).string(e.destinationPort),""!==e.destinationChannel&&t.uint32(42).string(e.destinationChannel),0!==e.data.length&&t.uint32(50).bytes(e.data),void 0!==e.timeoutHeight&&n.Height.encode(e.timeoutHeight,t.uint32(58).fork()).ldelim(),e.timeoutTimestamp!==BigInt(0)&&t.uint32(64).uint64(e.timeoutTimestamp),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let s=void 0===t?r.len:r.pos+t;const o=p();for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:o.sequence=r.uint64();break;case 2:o.sourcePort=r.string();break;case 3:o.sourceChannel=r.string();break;case 4:o.destinationPort=r.string();break;case 5:o.destinationChannel=r.string();break;case 6:o.data=r.bytes();break;case 7:o.timeoutHeight=n.Height.decode(r,r.uint32());break;case 8:o.timeoutTimestamp=r.uint64();break;default:r.skipType(7&e)}}return o},fromJSON(e){const t=p();return(0,s.isSet)(e.sequence)&&(t.sequence=BigInt(e.sequence.toString())),(0,s.isSet)(e.sourcePort)&&(t.sourcePort=String(e.sourcePort)),(0,s.isSet)(e.sourceChannel)&&(t.sourceChannel=String(e.sourceChannel)),(0,s.isSet)(e.destinationPort)&&(t.destinationPort=String(e.destinationPort)),(0,s.isSet)(e.destinationChannel)&&(t.destinationChannel=String(e.destinationChannel)),(0,s.isSet)(e.data)&&(t.data=(0,s.bytesFromBase64)(e.data)),(0,s.isSet)(e.timeoutHeight)&&(t.timeoutHeight=n.Height.fromJSON(e.timeoutHeight)),(0,s.isSet)(e.timeoutTimestamp)&&(t.timeoutTimestamp=BigInt(e.timeoutTimestamp.toString())),t},toJSON(e){const t={};return void 0!==e.sequence&&(t.sequence=(e.sequence||BigInt(0)).toString()),void 0!==e.sourcePort&&(t.sourcePort=e.sourcePort),void 0!==e.sourceChannel&&(t.sourceChannel=e.sourceChannel),void 0!==e.destinationPort&&(t.destinationPort=e.destinationPort),void 0!==e.destinationChannel&&(t.destinationChannel=e.destinationChannel),void 0!==e.data&&(t.data=(0,s.base64FromBytes)(void 0!==e.data?e.data:new Uint8Array)),void 0!==e.timeoutHeight&&(t.timeoutHeight=e.timeoutHeight?n.Height.toJSON(e.timeoutHeight):void 0),void 0!==e.timeoutTimestamp&&(t.timeoutTimestamp=(e.timeoutTimestamp||BigInt(0)).toString()),t},fromPartial(e){const t=p();return void 0!==e.sequence&&null!==e.sequence&&(t.sequence=BigInt(e.sequence.toString())),t.sourcePort=e.sourcePort??"",t.sourceChannel=e.sourceChannel??"",t.destinationPort=e.destinationPort??"",t.destinationChannel=e.destinationChannel??"",t.data=e.data??new Uint8Array,void 0!==e.timeoutHeight&&null!==e.timeoutHeight&&(t.timeoutHeight=n.Height.fromPartial(e.timeoutHeight)),void 0!==e.timeoutTimestamp&&null!==e.timeoutTimestamp&&(t.timeoutTimestamp=BigInt(e.timeoutTimestamp.toString())),t}},t.PacketState={typeUrl:"/ibc.core.channel.v1.PacketState",encode:(e,t=i.BinaryWriter.create())=>(""!==e.portId&&t.uint32(10).string(e.portId),""!==e.channelId&&t.uint32(18).string(e.channelId),e.sequence!==BigInt(0)&&t.uint32(24).uint64(e.sequence),0!==e.data.length&&t.uint32(34).bytes(e.data),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s=y();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.portId=r.string();break;case 2:s.channelId=r.string();break;case 3:s.sequence=r.uint64();break;case 4:s.data=r.bytes();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=y();return(0,s.isSet)(e.portId)&&(t.portId=String(e.portId)),(0,s.isSet)(e.channelId)&&(t.channelId=String(e.channelId)),(0,s.isSet)(e.sequence)&&(t.sequence=BigInt(e.sequence.toString())),(0,s.isSet)(e.data)&&(t.data=(0,s.bytesFromBase64)(e.data)),t},toJSON(e){const t={};return void 0!==e.portId&&(t.portId=e.portId),void 0!==e.channelId&&(t.channelId=e.channelId),void 0!==e.sequence&&(t.sequence=(e.sequence||BigInt(0)).toString()),void 0!==e.data&&(t.data=(0,s.base64FromBytes)(void 0!==e.data?e.data:new Uint8Array)),t},fromPartial(e){const t=y();return t.portId=e.portId??"",t.channelId=e.channelId??"",void 0!==e.sequence&&null!==e.sequence&&(t.sequence=BigInt(e.sequence.toString())),t.data=e.data??new Uint8Array,t}},t.PacketId={typeUrl:"/ibc.core.channel.v1.PacketId",encode:(e,t=i.BinaryWriter.create())=>(""!==e.portId&&t.uint32(10).string(e.portId),""!==e.channelId&&t.uint32(18).string(e.channelId),e.sequence!==BigInt(0)&&t.uint32(24).uint64(e.sequence),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s=g();for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 1:s.portId=r.string();break;case 2:s.channelId=r.string();break;case 3:s.sequence=r.uint64();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t=g();return(0,s.isSet)(e.portId)&&(t.portId=String(e.portId)),(0,s.isSet)(e.channelId)&&(t.channelId=String(e.channelId)),(0,s.isSet)(e.sequence)&&(t.sequence=BigInt(e.sequence.toString())),t},toJSON(e){const t={};return void 0!==e.portId&&(t.portId=e.portId),void 0!==e.channelId&&(t.channelId=e.channelId),void 0!==e.sequence&&(t.sequence=(e.sequence||BigInt(0)).toString()),t},fromPartial(e){const t=g();return t.portId=e.portId??"",t.channelId=e.channelId??"",void 0!==e.sequence&&null!==e.sequence&&(t.sequence=BigInt(e.sequence.toString())),t}},t.Acknowledgement={typeUrl:"/ibc.core.channel.v1.Acknowledgement",encode:(e,t=i.BinaryWriter.create())=>(void 0!==e.result&&t.uint32(170).bytes(e.result),void 0!==e.error&&t.uint32(178).string(e.error),t),decode(e,t){const r=e instanceof i.BinaryReader?e:new i.BinaryReader(e);let n=void 0===t?r.len:r.pos+t;const s={result:void 0,error:void 0};for(;r.pos<n;){const e=r.uint32();switch(e>>>3){case 21:s.result=r.bytes();break;case 22:s.error=r.string();break;default:r.skipType(7&e)}}return s},fromJSON(e){const t={result:void 0,error:void 0};return(0,s.isSet)(e.result)&&(t.result=(0,s.bytesFromBase64)(e.result)),(0,s.isSet)(e.error)&&(t.error=String(e.error)),t},toJSON(e){const t={};return void 0!==e.result&&(t.result=void 0!==e.result?(0,s.base64FromBytes)(e.result):void 0),void 0!==e.error&&(t.error=e.error),t},fromPartial(e){const t={result:void 0,error:void 0};return t.result=e.result??void 0,t.error=e.error??void 0,t}}},74945:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(r.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function a(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function c(e){this.map={},e instanceof c?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function u(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function l(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function h(e){var t=new FileReader,r=l(t);return t.readAsArrayBuffer(e),r}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||i(e))?this._bodyArrayBuffer=d(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,r,n=u(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=l(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(e,t){e=s(e),t=o(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},c.prototype.delete=function(e){delete this.map[s(e)]},c.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},c.prototype.set=function(e,t){this.map[s(e)]=o(t)},c.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},c.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),a(e)},c.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),a(e)},c.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),a(e)},r.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(e,t){var r,n,i=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),p.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function m(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},f.call(y.prototype),f.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];m.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function w(e,n){return new Promise((function(i,s){var o=new y(e,n);if(o.signal&&o.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new c,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var n="response"in a?a.response:a.responseText;i(new m(n,r))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&r.blob&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",u)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}w.polyfill=!0,e.fetch||(e.fetch=w,e.Headers=c,e.Request=y,e.Response=m),t.Headers=c,t.Request=y,t.Response=m,t.fetch=w,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},21423:function(e,t,r){"use strict";r.d(t,{wE:function(){return x}});var n=r(97217);e=r.hmd(e);var i=r(96763);let s;const o=new Array(128).fill(void 0);function a(e){return o[e]}o.push(void 0,null,!0,!1);let c=o.length;function u(e){const t=a(e);return function(e){e<132||(o[e]=c,c=e)}(e),t}let l=0,h=null;function d(){return null!==h&&0!==h.byteLength||(h=new Uint8Array(s.memory.buffer)),h}const f="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},p="function"==typeof f.encodeInto?function(e,t){return f.encodeInto(e,t)}:function(e,t){const r=f.encode(e);return t.set(r),{read:e.length,written:r.length}};function y(e,t,r){if(void 0===r){const r=f.encode(e),n=t(r.length,1)>>>0;return d().subarray(n,n+r.length).set(r),l=r.length,n}let n=e.length,i=t(n,1)>>>0;const s=d();let o=0;for(;o<n;o++){const t=e.charCodeAt(o);if(t>127)break;s[i+o]=t}if(o!==n){0!==o&&(e=e.slice(o)),i=r(i,n,n=o+3*e.length,1)>>>0;const t=d().subarray(i+o,i+n);o+=p(e,t).written,i=r(i,n,o,1)>>>0}return l=o,i}let g=null;function m(){return null!==g&&0!==g.byteLength||(g=new Int32Array(s.memory.buffer)),g}function b(e){c===o.length&&o.push(o.length+1);const t=c;return c=o[t],o[t]=e,t}const w="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function v(e,t){return e>>>=0,w.decode(d().subarray(e,e+t))}function _(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let r="[";t>0&&(r+=_(e[0]));for(let n=1;n<t;n++)r+=", "+_(e[n]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let n;if(!(r.length>1))return toString.call(e);if(n=r[1],"Object"==n)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:n}"undefined"!=typeof TextDecoder&&w.decode();const E="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>{s.__wbindgen_export_2.get(e.dtor)(e.a,e.b)}));function S(e,t,r){s._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hf3cea9750e4420ef(e,t,b(r))}function x(e,t){return u(s.compile(b(e),b(t)))}function A(e,t){try{return e.apply(this,t)}catch(e){s.__wbindgen_exn_store(b(e))}}function k(){const t={wbg:{}};return t.wbg.__wbindgen_is_undefined=function(e){return void 0===a(e)},t.wbg.__wbg_log_af664d6e0fce87fe=function(e,t){i.log(v(e,t))},t.wbg.__wbindgen_object_drop_ref=function(e){u(e)},t.wbg.__wbg_jsCyberSearch_31ae9a5f5af464bc=function(e,t){return b((0,n.Bn)(v(e,t)))},t.wbg.__wbg_jsCyberLink_2bba38538259dfae=function(e,t,r,i){return b((0,n.lJ)(v(e,t),v(r,i)))},t.wbg.__wbg_jsGetPassportByNickname_66cc923b007c77b2=function(e,t){return b((0,n.xm)(v(e,t)))},t.wbg.__wbg_jsGetIpfsTextContent_0dd3748b1688b10e=function(e,t){return b((0,n.So)(v(e,t)))},t.wbg.__wbg_jsAddContenToIpfs_3d1cb5924c163cfe=function(e,t){return b((0,n.rz)(v(e,t)))},t.wbg.__wbg_jsEvalScriptFromIpfs_559b685caaa5f15f=function(e,t,r,i,s){return b((0,n.bn)(v(e,t),v(r,i),a(s)))},t.wbg.__wbg_jsOpenAICompletions_45a2730c765a747c=function(e,t,r,i,s){return b((0,n.TC)(a(e),v(t,r),a(i),a(s)))},t.wbg.__wbg_jsSearchByEmbedding_c6fa1395fdaec250=function(e,t,r){return b((0,n.YD)(v(e,t),r>>>0))},t.wbg.__wbg_jsCyberLinksFrom_358af52be69ceae6=function(e,t){return b((0,n._4)(v(e,t)))},t.wbg.__wbg_jsCyberLinksTo_0856ca22f5524370=function(e,t){return b((0,n.vZ)(v(e,t)))},t.wbg.__wbg_jsExecuteScriptCallback_5ea4658c68e04549=function(e,t,r){return b((0,n.Df)(v(e,t),a(r)))},t.wbg.__wbindgen_string_get=function(e,t){const r=a(t),n="string"==typeof r?r:void 0;var i=null==n?0:y(n,s.__wbindgen_malloc,s.__wbindgen_realloc),o=l;m()[e/4+1]=o,m()[e/4+0]=i},t.wbg.__wbindgen_object_clone_ref=function(e){return b(a(e))},t.wbg.__wbindgen_string_new=function(e,t){return b(v(e,t))},t.wbg.__wbg_fetch_57429b87be3dcc33=function(e){return b(fetch(a(e)))},t.wbg.__wbindgen_is_object=function(e){const t=a(e);return"object"==typeof t&&null!==t},t.wbg.__wbg_crypto_70a96de3b6b73dac=function(e){return b(a(e).crypto)},t.wbg.__wbg_process_dd1577445152112e=function(e){return b(a(e).process)},t.wbg.__wbg_versions_58036bec3add9e6f=function(e){return b(a(e).versions)},t.wbg.__wbg_node_6a9d28205ed5b0d8=function(e){return b(a(e).node)},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof a(e)},t.wbg.__wbg_require_f05d779769764e82=function(){return A((function(){return b(e.require)}),arguments)},t.wbg.__wbg_msCrypto_adbc770ec9eca9c7=function(e){return b(a(e).msCrypto)},t.wbg.__wbg_randomFillSync_e950366c42764a07=function(){return A((function(e,t){a(e).randomFillSync(u(t))}),arguments)},t.wbg.__wbg_getRandomValues_3774744e221a22ad=function(){return A((function(e,t){a(e).getRandomValues(a(t))}),arguments)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){return b(new Error)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=y(a(t).stack,s.__wbindgen_malloc,s.__wbindgen_realloc),n=l;m()[e/4+1]=n,m()[e/4+0]=r},t.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let r,n;try{r=e,n=t,i.error(v(e,t))}finally{s.__wbindgen_free(r,n,1)}},t.wbg.__wbindgen_cb_drop=function(e){const t=u(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},t.wbg.__wbg_signal_bcb55e86063f8860=function(e){return b(a(e).signal)},t.wbg.__wbg_new_668956ac1089f8cf=function(){return A((function(){return b(new AbortController)}),arguments)},t.wbg.__wbg_abort_de75e4ab5136bcee=function(e){a(e).abort()},t.wbg.__wbg_new_143b41b4342650bb=function(){return A((function(){return b(new Headers)}),arguments)},t.wbg.__wbg_append_fac652007989b765=function(){return A((function(e,t,r,n,i){a(e).append(v(t,r),v(n,i))}),arguments)},t.wbg.__wbg_newwithstrandinit_a4cd16dfaafcf625=function(){return A((function(e,t,r){return b(new Request(v(e,t),a(r)))}),arguments)},t.wbg.__wbg_instanceof_Response_7ade9a5a066d1a55=function(e){let t;try{t=a(e)instanceof Response}catch(e){t=!1}return t},t.wbg.__wbg_url_59cb32ef6a837521=function(e,t){const r=y(a(t).url,s.__wbindgen_malloc,s.__wbindgen_realloc),n=l;m()[e/4+1]=n,m()[e/4+0]=r},t.wbg.__wbg_status_d2b2d0889f7e970f=function(e){return a(e).status},t.wbg.__wbg_headers_2de03c88f895093b=function(e){return b(a(e).headers)},t.wbg.__wbg_arrayBuffer_2693673868da65b7=function(){return A((function(e){return b(a(e).arrayBuffer())}),arguments)},t.wbg.__wbg_text_65fa1887e8f7b4ac=function(){return A((function(e){return b(a(e).text())}),arguments)},t.wbg.__wbg_fetch_621998933558ad27=function(e,t){return b(a(e).fetch(a(t)))},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof a(e)},t.wbg.__wbg_self_742dd6eab3e9211e=function(){return A((function(){return b(self.self)}),arguments)},t.wbg.__wbg_window_c409e731db53a0e2=function(){return A((function(){return b(window.window)}),arguments)},t.wbg.__wbg_globalThis_b70c095388441f2d=function(){return A((function(){return b(globalThis.globalThis)}),arguments)},t.wbg.__wbg_global_1c72617491ed7194=function(){return A((function(){return b(r.g.global)}),arguments)},t.wbg.__wbg_newnoargs_c9e6043b8ad84109=function(e,t){return b(new Function(v(e,t)))},t.wbg.__wbg_next_f4bc0e96ea67da68=function(e){return b(a(e).next)},t.wbg.__wbg_value_2f4ef2036bfad28e=function(e){return b(a(e).value)},t.wbg.__wbg_iterator_7c7e58f62eb84700=function(){return b(Symbol.iterator)},t.wbg.__wbg_new_2b6fea4ea03b1b95=function(){return b(new Object)},t.wbg.__wbg_call_557a2f2deacc4912=function(){return A((function(e,t){return b(a(e).call(a(t)))}),arguments)},t.wbg.__wbg_call_587b30eea3e09332=function(){return A((function(e,t,r){return b(a(e).call(a(t),a(r)))}),arguments)},t.wbg.__wbg_next_ec061e48a0e72a96=function(){return A((function(e){return b(a(e).next())}),arguments)},t.wbg.__wbg_done_b6abb27d42b63867=function(e){return a(e).done},t.wbg.__wbg_get_f53c921291c381bd=function(){return A((function(e,t){return b(Reflect.get(a(e),a(t)))}),arguments)},t.wbg.__wbg_has_40b8c976775c8ead=function(){return A((function(e,t){return Reflect.has(a(e),a(t))}),arguments)},t.wbg.__wbg_set_07da13cc24b69217=function(){return A((function(e,t,r){return Reflect.set(a(e),a(t),a(r))}),arguments)},t.wbg.__wbg_buffer_55ba7a6b1b92e2ac=function(e){return b(a(e).buffer)},t.wbg.__wbg_parse_76a8a18ca3f8730b=function(){return A((function(e,t){return b(JSON.parse(v(e,t)))}),arguments)},t.wbg.__wbg_stringify_d06ad2addc54d51e=function(){return A((function(e){return b(JSON.stringify(a(e)))}),arguments)},t.wbg.__wbg_new_2b55e405e4af4986=function(e,t){try{var r={a:e,b:t};const n=new Promise(((e,t)=>{const n=r.a;r.a=0;try{return function(e,t,r,n){s.wasm_bindgen__convert__closures__invoke2_mut__h55069aa6b66204e3(e,t,b(r),b(n))}(n,r.b,e,t)}finally{r.a=n}}));return b(n)}finally{r.a=r.b=0}},t.wbg.__wbg_resolve_ae38ad63c43ff98b=function(e){return b(Promise.resolve(a(e)))},t.wbg.__wbg_then_8df675b8bb5d5e3c=function(e,t){return b(a(e).then(a(t)))},t.wbg.__wbg_then_835b073a479138e5=function(e,t,r){return b(a(e).then(a(t),a(r)))},t.wbg.__wbg_newwithbyteoffsetandlength_88d1d8be5df94b9b=function(e,t,r){return b(new Uint8Array(a(e),t>>>0,r>>>0))},t.wbg.__wbg_new_09938a7d020f049b=function(e){return b(new Uint8Array(a(e)))},t.wbg.__wbg_newwithlength_89eeca401d8918c2=function(e){return b(new Uint8Array(e>>>0))},t.wbg.__wbg_subarray_d82be056deb4ad27=function(e,t,r){return b(a(e).subarray(t>>>0,r>>>0))},t.wbg.__wbg_length_0aab7ffd65ad19ed=function(e){return a(e).length},t.wbg.__wbg_set_3698e3ca519b3c3c=function(e,t,r){a(e).set(a(t),r>>>0)},t.wbg.__wbindgen_debug_string=function(e,t){const r=y(_(a(t)),s.__wbindgen_malloc,s.__wbindgen_realloc),n=l;m()[e/4+1]=n,m()[e/4+0]=r},t.wbg.__wbindgen_throw=function(e,t){throw new Error(v(e,t))},t.wbg.__wbindgen_memory=function(){return b(s.memory)},t.wbg.__wbindgen_closure_wrapper2123=function(e,t,r){const n=function(e,t,r,n){const i={a:e,b:t,cnt:1,dtor:r},o=(...e)=>{i.cnt++;const t=i.a;i.a=0;try{return n(t,i.b,...e)}finally{0==--i.cnt?(s.__wbindgen_export_2.get(i.dtor)(t,i.b),E.unregister(i)):i.a=t}};return o.original=i,E.register(o,i,i),o}(e,t,604,S);return b(n)},t}function I(e,t){return s=e.exports,T.__wbindgen_wasm_module=t,g=null,h=null,s.__wbindgen_start(),s}async function T(e){if(void 0!==s)return s;void 0===e&&(e=new URL(r(43827),r.b));const t=k();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;i.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return I(n,o)}t.Ay=T},54075:function(e,t,r){var n;!function(i){"use strict";var s,o,a,c=(s=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,o=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g,function(e,t,r,n){if(1!==arguments.length||"string"!==(null===(i=e)?"null":void 0===i?"undefined":"object"!=typeof i?typeof i:Array.isArray(i)?"array":{}.toString.call(i).slice(8,-1).toLowerCase())||/\d/.test(e)||(t=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i,l=(t=String(c.masks[t]||t||c.masks.default)).slice(0,4);"UTC:"!==l&&"GMT:"!==l||(t=t.slice(4),r=!0,"GMT:"===l&&(n=!0));var h=r?"getUTC":"get",d=e[h+"Date"](),f=e[h+"Day"](),p=e[h+"Month"](),y=e[h+"FullYear"](),g=e[h+"Hours"](),m=e[h+"Minutes"](),b=e[h+"Seconds"](),w=e[h+"Milliseconds"](),v=r?0:e.getTimezoneOffset(),_=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var r=new Date(t.getFullYear(),0,4);r.setDate(r.getDate()-(r.getDay()+6)%7+3);var n=t.getTimezoneOffset()-r.getTimezoneOffset();t.setHours(t.getHours()-n);var i=(t-r)/6048e5;return 1+Math.floor(i)}(e),E=function(e){var t=e.getDay();return 0===t&&(t=7),t}(e),S={d:d,dd:u(d),ddd:c.i18n.dayNames[f],dddd:c.i18n.dayNames[f+7],m:p+1,mm:u(p+1),mmm:c.i18n.monthNames[p],mmmm:c.i18n.monthNames[p+12],yy:String(y).slice(2),yyyy:y,h:g%12||12,hh:u(g%12||12),H:g,HH:u(g),M:m,MM:u(m),s:b,ss:u(b),l:u(w,3),L:u(Math.round(w/10)),t:g<12?c.i18n.timeNames[0]:c.i18n.timeNames[1],tt:g<12?c.i18n.timeNames[2]:c.i18n.timeNames[3],T:g<12?c.i18n.timeNames[4]:c.i18n.timeNames[5],TT:g<12?c.i18n.timeNames[6]:c.i18n.timeNames[7],Z:n?"GMT":r?"UTC":(String(e).match(o)||[""]).pop().replace(a,""),o:(v>0?"-":"+")+u(100*Math.floor(Math.abs(v)/60)+Math.abs(v)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10],W:_,N:E};return t.replace(s,(function(e){return e in S?S[e]:e.slice(1,e.length-1)}))});function u(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}c.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(n=function(){return c}.call(t,r,t,e))||(e.exports=n)}()},28e3:function(e){var t=1e3,r=60*t,n=60*r,i=24*n,s=7*i,o=365.25*i;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var s=Math.abs(e);if(s>=i)return a(e,s,i,"day");if(s>=n)return a(e,s,n,"hour");if(s>=r)return a(e,s,r,"minute");if(s>=t)return a(e,s,t,"second");return e+" ms"}(e):function(e){var s=Math.abs(e);if(s>=i)return Math.round(e/i)+"d";if(s>=n)return Math.round(e/n)+"h";if(s>=r)return Math.round(e/r)+"m";if(s>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},17833:function(e,t,r){var n=r(96763),i=r(65606);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,n.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=n.debug||n.log||(()=>{}),e.exports=r(40736)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},40736:function(e,t,r){var n=r(96763);e.exports=function(e){function t(e){let r,n,s,o=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];r=s.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=i,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(n!==t.namespaces&&(n=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function i(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(28e3),t.destroy=function(){n.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},62328:function(e){"use strict";const t=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:r,willResolve:n})=>(i,{value:s,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(t());let a,c,u;const l=e||clearTimeout,h=()=>{l(a),u(t())},d=new Promise(((e,t)=>{c=()=>{o&&o.removeEventListener("abort",h),n?e(s):t(s)},u=t,a=(r||setTimeout)(c,i)}));return o&&o.addEventListener("abort",h,{once:!0}),d.clear=()=>{l(a),a=null,c()},d},n=e=>{const t=r({...e,willResolve:!0});return t.reject=r({...e,willResolve:!1}),t.range=(e,r,n)=>t(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,r),n),t},i=n();i.createWithTimers=n,e.exports=i,e.exports.default=i},44534:function(e){"use strict";function t(e,t){t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(0===arguments.length)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(0===arguments.length)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),n=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var i,s=this._list[t];if(e<r/2){for(i=e;i>0;i--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(i=r-1-e;i>0;i--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}},t.prototype.remove=function(e,t){var r,n=e,i=t;if(n===(0|n)&&this._head!==this._tail){var s=this.size(),o=this._list.length;if(!(n>=s||n<-s||t<1)){if(n<0&&(n+=s),1===t||!t)return(r=new Array(1))[0]=this.removeOne(n),r;if(0===n&&n+t>=s)return r=this.toArray(),this.clear(),r;var a;for(n+t>s&&(t=s-n),r=new Array(t),a=0;a<t;a++)r[a]=this._list[this._head+n+a&this._capacityMask];if(n=this._head+n&this._capacityMask,e+t===s){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(n<s/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[n=n-1+o&this._capacityMask]);for(n=this._head-1+o&this._capacityMask;i>0;)this._list[n=n-1+o&this._capacityMask]=void 0,i--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+t+o&this._capacityMask,a=s-(t+e);a>0;a--)this.push(this._list[n++]);for(n=this._tail;i>0;)this._list[n=n+1+o&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},t.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n)){if(arguments.length>2){var i,s,o,a=arguments.length,c=this._list.length,u=2;if(!n||r<n/2){for(s=new Array(r),i=0;i<r;i++)s[i]=this._list[this._head+i&this._capacityMask];for(0===t?(o=[],r>0&&(this._head=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._head=this._head+r+c&this._capacityMask);a>u;)this.unshift(arguments[--a]);for(i=r;i>0;i--)this.unshift(s[i-1])}else{var l=(s=new Array(n-(r+t))).length;for(i=0;i<l;i++)s[i]=this._list[this._head+r+t+i&this._capacityMask];for(0===t?(o=[],r!=n&&(this._tail=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._tail=this._tail-l+c&this._capacityMask);u<a;)this.push(arguments[u++]);for(i=0;i<l;i++)this.push(s[i])}return o}return this.remove(r,t)}}},t.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){var t=e.length,r=this._nextPowerOf2(t);this._list=new Array(r),this._capacityMask=r-1,this._tail=t;for(var n=0;n<t;n++)this._list[n]=e[n]},t.prototype._copyArray=function(e,t){var r=this._list,n=r.length,i=this.length;if((t|=i)==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var s,o=new Array(t),a=0;if(e||this._head>this._tail){for(s=this._head;s<n;s++)o[a++]=r[s];for(s=0;s<this._tail;s++)o[a++]=r[s]}else for(s=this._head;s<this._tail;s++)o[a++]=r[s];return o},t.prototype._growArray=function(){if(0!=this._head){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},t.prototype._nextPowerOf2=function(e){var t=1<<Math.log(e)/Math.log(2)+1;return Math.max(t,4)},e.exports=t},48468:function(e,t,r){"use strict";r.d(t,{o0:function(){return p}});var n=r(65606),i=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},s=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},o=function(e){this.version=e,this.type="node",this.name="node",this.os=n.platform},a=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},u=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},l=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,h=3,d=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){return e?g(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new u:"undefined"!=typeof navigator?g(navigator.userAgent):void 0!==n&&n.version?new o(n.version.slice(1)):null}function y(e){return""!==e&&d.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]}),!1)}function g(e){var t=y(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new c;var o=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);o?o.length<h&&(o=i(i([],o,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(h-o.length),!0)):o=[];var u=o.join("."),d=function(e){for(var t=0,r=f.length;t<r;t++){var n=f[t],i=n[0];if(n[1].exec(e))return i}return null}(e),p=l.exec(e);return p&&p[1]?new a(r,u,d,p[1]):new s(r,u,d)}},32144:function(e){e.exports=function(e,t,r,n,i){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:i;return e===i?r:e}},66310:function(e){"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(r){n.message=e.message,n.stack=e.stack;const i=function(){};i.prototype=Object.create(Object.getPrototypeOf(e));return t(new i,n)}}},60544:function(e,t,r){"use strict";const n=r(69939);t.PP=n.EventIterator,n.EventIterator},69939:function(e,t,r){"use strict";var n=r(96763);Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():n&&n.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class s{constructor(e,{highWaterMark:t=100,lowWaterMark:r=1}={}){const n=new i;n.highWaterMark=t,n.lowWaterMark=r,n.removeCallback=e({push:e=>n.push(e),stop:()=>n.stop(),fail:e=>n.fail(e),on:(e,t)=>{n.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=s,t.default=s},56614:function(e){"use strict";e.exports=function(e){var t=e.uri,r=e.name,n=e.type;this.uri=t,this.name=r,this.type=n}},47169:function(e,t,r){"use strict";var n=r(64767);e.exports=function e(t,r,i){var s;void 0===r&&(r=""),void 0===i&&(i=n);var o=new Map;function a(e,t){var r=o.get(t);r?r.push.apply(r,e):o.set(t,e)}if(i(t))s=null,a([r],t);else{var c=r?r+".":"";if("undefined"!=typeof FileList&&t instanceof FileList)s=Array.prototype.map.call(t,(function(e,t){return a([""+c+t],e),null}));else if(Array.isArray(t))s=t.map((function(t,r){var n=e(t,""+c+r,i);return n.files.forEach(a),n.clone}));else if(t&&t.constructor===Object)for(var u in s={},t){var l=e(t[u],""+c+u,i);l.files.forEach(a),s[u]=l.clone}else s=t}return{clone:s,files:o}}},64767:function(e,t,r){"use strict";var n=r(56614);e.exports=function(e){return"undefined"!=typeof File&&e instanceof File||"undefined"!=typeof Blob&&e instanceof Blob||e instanceof n}},8190:function(e){e.exports=class{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},36080:function(e,t,r){const n=r(8190);e.exports=class{constructor(e){this.hwm=e||16,this.head=new n(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new n(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},19951:function(e,t){"use strict";function r(e,t=r.BASE){const n=e.length;for(let r=0;r<n;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}Object.defineProperty(t,"__esModule",{value:!0}),r.BASE=2166136261,t.default=r,e.exports=r},29339:function(e){e.exports="object"==typeof self?self.FormData:window.FormData},40194:function(e){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function i(i,s){r[i]=s,++t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==n[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==n[e]&&(n[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:i(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}},77011:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,s),!0;case 6:return l.fn.call(l.context,t,n,i,s,o),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},93157:function(e,t,r){const n=r(96204),i=r(25371),s=r(66349),o=r(96880),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u}=r(36913),l=r(45348),h=r(62326),d=r(14091),f=r(84400),p=r(10296),y=r(66872),g=r(29765);e.exports={RateLimiterRedis:n,RateLimiterMongo:i,RateLimiterMySQL:s,RateLimiterPostgres:o,RateLimiterMemory:l,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:y,RateLimiterRes:g}},66872:function(e,t,r){const n=r(29765);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return e?new n(e.remainingPoints,Math.min(e.msBeforeNext,t?t.msBeforeNext:0),e.consumedPoints,e.isFirstInDuration):null}consume(e,t=1,r={}){return this._rateLimiter.consume(e,t,r).catch((i=>i instanceof n?this._burstLimiter.consume(e,t,r).then((e=>Promise.resolve(this._combineRes(i,e)))).catch((e=>e instanceof n?Promise.reject(this._combineRes(i,e)):Promise.reject(e))):Promise.reject(i)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},14091:function(e,t,r){const n=r(29765);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if(void 0===e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway=void 0!==e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new n(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new n(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.rejectBlack()),void 0===r?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),r)}block(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),r)}penalty(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),r)}reward(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),r)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),void 0===t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},98573:function(e){e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration=void 0===e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration=void 0===e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly=void 0!==e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs=void 0===e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if(void 0===e&&(e="rlflx"),"string"!=typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},36913:function(e,t,r){var n=r(65606),i=r(96763);const s=r(71619),o=r(36180),a=r(98573),c=r(45348),u=r(29765),l="rate_limiter_flexible";let h=null;const d=function(e,t,r,n){let i;i=null===n||!0===n||!1===n?n:{remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},e.send({channel:l,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:r,data:i})},f=function(e){setTimeout((()=>{this._initiated?n.send(e):void 0!==this._promises[e.promiseId]&&f.call(this,e)}),30)},p=function(e,t,r,i,s){const o={channel:l,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:r,arg:i,opts:s}};this._initiated?n.send(o):f.call(this,o)},y=function(e,t){if(!t||t.channel!==l||void 0===this._rateLimiters[t.keyPrefix])return!1;let r;switch(t.func){case"consume":r=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":r=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":r=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":r=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":r=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":r=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}r&&r.then((r=>{d(e,t,"resolve",r)})).catch((r=>{d(e,t,"reject",r)}))},g=function(e){if(!e||e.channel!==l||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new u(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},m=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},b=function(e,t){const r=n.hrtime();let i=r[0].toString()+r[1].toString();return void 0!==this._promises[i]&&(i+=o.randomBytes(12).toString("base64")),this._promises[i]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[i],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},i};e.exports={RateLimiterClusterMaster:class{constructor(){if(h)return h;this._rateLimiters={},s.setMaxListeners(0),s.on("message",((e,t)=>{t&&t.channel===l&&"init"===t.type?(void 0===this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new c(t.opts)),e.send({channel:l,type:"init",keyPrefix:t.opts.keyPrefix})):y.call(this,e,t)})),h=this}},RateLimiterClusterMasterPM2:class{constructor(e){if(h)return h;this._rateLimiters={},e.launchBus(((t,r)=>{r.on("process:msg",(t=>{const r=t.raw;if(r&&r.channel===l&&"init"===r.type)void 0===this._rateLimiters[r.opts.keyPrefix]&&(this._rateLimiters[r.opts.keyPrefix]=new c(r.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:l,channel:l,type:"init",keyPrefix:r.opts.keyPrefix},((e,t)=>{e&&i.log(e,t)}));else{y.call(this,{send:r=>{const n=r;n.topic=l,void 0===n.data&&(n.data={}),e.sendDataToProcessId(t.process.pm_id,n,((e,t)=>{e&&i.log(e,t)}))}},r)}}))})),h=this}},RateLimiterCluster:class extends a{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs=void 0===e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),n.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,n.on("message",(e=>{e&&e.channel===l&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:g.call(this,e)})),n.send({channel:l,type:"init",opts:m.call(this)}),this._promises={}}consume(e,t=1,r={}){return new Promise(((n,i)=>{const s=b.call(this,n,i);p.call(this,"consume",s,e,t,r)}))}penalty(e,t=1,r={}){return new Promise(((n,i)=>{const s=b.call(this,n,i);p.call(this,"penalty",s,e,t,r)}))}reward(e,t=1,r={}){return new Promise(((n,i)=>{const s=b.call(this,n,i);p.call(this,"reward",s,e,t,r)}))}block(e,t,r={}){return new Promise(((n,i)=>{const s=b.call(this,n,i);p.call(this,"block",s,e,t,r)}))}get(e,t={}){return new Promise(((r,n)=>{const i=b.call(this,r,n);p.call(this,"get",i,e,t)}))}delete(e,t={}){return new Promise(((r,n)=>{const i=b.call(this,r,n);p.call(this,"delete",i,e,t)}))}}}},62326:function(e,t,r){const n=r(24248),i=r(29765);e.exports=class extends n{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,r){const n=new i;return n.consumedPoints=parseInt(r.consumedPoints),n.isFirstInDuration=r.consumedPoints===t,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=r.msBeforeNext,n}_upsert(e,t,r,n=!1,i={}){return new Promise(((s,o)=>{const a=Date.now(),c=Math.floor(r/1e3);n?this.client.set(e,t,c,(r=>{r?o(r):this.client.set(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.incr(e,t,((u,l)=>{u||!1===l?this.client.add(e,t,c,((u,l)=>{if(u||!l)if(void 0===i.attemptNumber||i.attemptNumber<3){const a=Object.assign({},i);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,r,n,a).then((e=>s(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,r={consumedPoints:l,msBeforeNext:e>=0?Math.max(e-a,0):-1};s(r)}}))}))}))}_get(e){return new Promise(((t,r)=>{const n=Date.now();this.client.get(e,((i,s)=>{s?this.client.get(`${e}_expire`,((e,i)=>{if(e)r(e);else{const e=!1===i?0:i,r={consumedPoints:s,msBeforeNext:e>=0?Math.max(e-n,0):-1};t(r)}})):t(null)}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((n,i)=>{n?r(n):!1===i?t(i):this.client.del(`${e}_expire`,(e=>{e?r(e):t(i)}))}))}))}}},45348:function(e,t,r){const n=r(98573),i=r(79690),s=r(29765);e.exports=class extends n{constructor(e={}){super(e),this._memoryStorage=new i}consume(e,t=1,r={}){return new Promise(((n,i)=>{const s=this.getKey(e),o=this._getKeySecDuration(r);let a=this._memoryStorage.incrby(s,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(s,a.consumedPoints,this.blockDuration)),i(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(n,e,a)}else n(a)}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(r),s=this._memoryStorage.incrby(n,t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(r),s=this._memoryStorage.incrby(n,-t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}block(e,t){const r=1e3*t,n=this.points+1;return this._memoryStorage.set(this.getKey(e),n,t),Promise.resolve(new s(0,0===r?-1:r,n))}set(e,t,r){const n=1e3*(r>=0?r:this.duration);return this._memoryStorage.set(this.getKey(e),t,r),Promise.resolve(new s(0,0===n?-1:n,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}},25371:function(e,t,r){const n=r(24248),i=r(29765);function s(e){try{const t=e.client?e.client:e,{version:r}=t.topology.s.options.metadata.driver,n=r.split(".").map((e=>parseInt(e)));return{major:n[0],feature:n[1],patch:n[2]}}catch(e){return{major:0,feature:0,patch:0}}}class o extends n{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"==typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=s(this.client)})):(this._initCollection(),this._driverVersion=s(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get client(){return this._client}set client(e){if(void 0===e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e=("function"==typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}_getRateLimiterRes(e,t,r){const n=new i;let s;return s=void 0===r.value?r:r.value,n.isFirstInDuration=s.points===t,n.consumedPoints=s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=null!==s.expire?Math.max(new Date(s.expire).getTime()-Date.now(),0):-1,n}_upsert(e,t,r,n=!1,i={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const s=i.attrs||{};let o,a;n?(o={key:e},o=Object.assign(o,s),a={$set:{key:e,points:t,expire:r>0?new Date(Date.now()+r):null}},a.$set=Object.assign(a.$set,s)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,s),a={$setOnInsert:{key:e,expire:r>0?new Date(Date.now()+r):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,s));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((i,u)=>{this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},s),a={$set:Object.assign({key:e,points:t,expire:r>0?new Date(Date.now()+r):null},s)};this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((s=>{s&&11e3===s.code?this._upsert(e,t,r,n).then((e=>i(e))).catch((e=>u(e))):u(s)}))}else u(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},r);return this._collection.findOne(n)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e},r);return this._collection.deleteOne(n).then((e=>e.deletedCount>0))}}e.exports=o},66349:function(e,t,r){const n=r(24248),i=r(29765);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(r),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((r,n)=>{if(r)return t(r);e(n)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(n=>{if(n)return this._releaseConnection(r),t(n);r.query(this._getCreateTableStmt(),(n=>{if(n)return this._releaseConnection(r),t(n);this._releaseConnection(r),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if(void 0===e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new i,[s]=r;return n.isFirstInDuration=t===s.points,n.consumedPoints=n.isFirstInDuration?t:s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,n}_upsertTransaction(e,t,r,n,i){return new Promise(((s,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const c=Date.now(),u=n>0?c+n:null;let l,h;i?(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",h=[this.dbName,this.tableName,t,r,u,r,u]):(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",h=[this.dbName,this.tableName,t,r,u,c,r,r,c,u]),e.query(l,h,(r=>{if(r)return e.rollback(),o(r);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,r)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);s(r)}))}))}))}))}))}_upsert(e,t,r,n=!1){return this.tableCreated?new Promise(((i,s)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,r,n).then((e=>{i(e),this._releaseConnection(o)})).catch((e=>{s(e),this._releaseConnection(o)}))})).catch((e=>{s(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,i)=>{e?r(e):0===i.length?t(null):t(i),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,i)=>{e?r(e):t(i.affectedRows>0),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}}},96880:function(e,t,r){const n=r(24248),i=r(29765);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"==typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const r={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(r).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((r=>{"23505"===r.code?e():t(r)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if(void 0===e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new i,s=r.rows[0];return n.isFirstInDuration=t===s.points,n.consumedPoints=n.isFirstInDuration?t:s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,n}_query(e){const t={name:`${this.tableName.toLowerCase()}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,r)=>{this._getConnection().then((n=>{n.query(t).then((t=>{e(t),this._releaseConnection(n)})).catch((e=>{r(e),this._releaseConnection(n)}))})).catch((e=>{r(e)}))}))}_upsert(e,t,r,n=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const i=r>0?Date.now()+r:null,s=n?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:n?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${n?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${s}\n            RETURNING points, expire;`,values:[e,t,i,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}},10296:function(e,t,r){const n=r(85392),i=4294967295,s="limiter";e.exports=class{constructor(e,t={maxQueueSize:i}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e=s){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t=s){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:i,key:s}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((r,i)=>{e>t._limiterFlexible.points?i(new n(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,r,i,e):t._limiterFlexible.consume(t._key,e).then((e=>{r(e.remainingPoints)})).catch((n=>{n instanceof Error?i(n):(t._queueRequest.call(t,r,i,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),n.msBeforeNext)))}))}))}_queueRequest(e,t,r){const i=this;i._queue.length<i._maxQueueSize?i._queue.push({resolve:e,reject:t,tokens:r}):t(new n(`Number of requests reached it's maximum ${i._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((r=>{t.resolve(r.remainingPoints),e._processFIFO.call(e)})).catch((r=>{r instanceof Error?(t.reject(r),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),r.msBeforeNext)))}))}}},96204:function(e,t,r){const n=r(24248),i=r(29765),s="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";e.exports=class extends n{constructor(e){super(e),this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,this.useRedisPackage=e.useRedisPackage,this.useRedis3AndLowerPackage=e.useRedis3AndLowerPackage,"function"==typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:s})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"==typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,r){let[n,s]=r;Array.isArray(n)&&([,n]=n,[,s]=s);const o=new i;return o.consumedPoints=parseInt(n),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s,o}async _upsert(e,t,r,n=!1){if(!this._isRedisReady())throw new Error("Redis connection is not ready");const i=Math.floor(r/1e3),o=this.client.multi();return n?(i>0?this.useRedisPackage||this.useRedis3AndLowerPackage?o.set(e,t,{EX:i}):o.set(e,t,"EX",i):o.set(e,t),this.useRedisPackage||this.useRedis3AndLowerPackage?o.pTTL(e).exec(!0):o.pttl(e).exec(!0)):i>0?this.useRedisPackage||this.useRedis3AndLowerPackage?this.useRedis3AndLowerPackage?new Promise(((r,n)=>{const o=function(e,t){return e?n(e):r(t)};"function"==typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,i,o):this.client.eval(s,1,e,t,i,o)})):this.client.eval(s,{keys:[e],arguments:[String(t),String(i)]}):this.client.rlflxIncr([e].concat([String(t),String(i)])):this.useRedisPackage||this.useRedis3AndLowerPackage?o.incrBy(e,t).pTTL(e).exec(!0):o.incrby(e,t).pttl(e).exec(!0)}async _get(e){if(!this._isRedisReady())throw new Error("Redis connection is not ready");return this.useRedisPackage||this.useRedis3AndLowerPackage?this.client.multi().get(e).pTTL(e).exec(!0).then((e=>{const[t]=e;return null===t?null:e})):this.client.multi().get(e).pttl(e).exec().then((e=>{const[[,t]]=e;return null===t?null:e}))}_delete(e){return this.client.del(e).then((e=>e>0))}}},29765:function(e){e.exports=class{constructor(e,t,r,n){this.remainingPoints=void 0===e?0:e,this.msBeforeNext=void 0===t?0:t,this.consumedPoints=void 0===r?0:r,this.isFirstInDuration=void 0!==n&&n}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},24248:function(e,t,r){const n=r(98573),i=r(6410),s=r(29765);e.exports=class extends n{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new i}get client(){return this._client}set client(e){if(void 0===e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,r,n,i,s={}){const o=this._getRateLimiterRes(r,n,i);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(r,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+n&&(o.msBeforeNext=this.msBlockDuration,e=this._block(r,o.consumedPoints,this.msBlockDuration,s)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(r,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,r,i,s,o=!1,a={}){this.insuranceLimiter instanceof n?this.insuranceLimiter[t](s,o,a).then((e=>{r(e)})).catch((e=>{i(e)})):i(e)}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if(void 0!==e&&!(e instanceof n))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,r={}){const n=1e3*t;return this._block(this.getKey(e),this.points+1,n,r)}set(e,t,r,n={}){const i=1e3*(r>=0?r:this.duration);return this._block(this.getKey(e),t,i,n)}consume(e,t=1,r={}){return new Promise(((n,i)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return i(new s(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{this._afterConsume(n,i,o,t,e)})).catch((s=>{this._handleError(s,"consume",n,i,e,t,r)}))}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise(((i,s)=>{this._upsert(n,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{i(this._getRateLimiterRes(n,t,e))})).catch((n=>{this._handleError(n,"penalty",i,s,e,t,r)}))}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise(((i,s)=>{this._upsert(n,-t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{i(this._getRateLimiterRes(n,-t,e))})).catch((n=>{this._handleError(n,"reward",i,s,e,t,r)}))}))}get(e,t={}){const r=this.getKey(e);return new Promise(((n,i)=>{this._get(r,t).then((e=>{n(null==e?null:this._getRateLimiterRes(r,0,e))})).catch((r=>{this._handleError(r,"get",n,i,e,t)}))}))}delete(e,t={}){const r=this.getKey(e);return new Promise(((n,i)=>{this._delete(r,t).then((e=>{this._inMemoryBlockedKeys.delete(r),n(e)})).catch((r=>{this._handleError(r,"delete",n,i,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,r){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,r,n={}){return new Promise(((i,o)=>{this._upsert(e,t,r,!0,n).then((()=>{i(new s(0,r>0?r:-1,t))})).catch((t=>{this._handleError(t,"block",i,o,this.parseKey(e),r/1e3,n)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,r,n=!1,i={}){throw new Error("You have to implement the method '_upsert'!")}}},84400:function(e,t,r){const n=r(98573);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof n))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((r,n)=>{const i=[];this._limiters.forEach((r=>{i.push(r.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(i).then((e=>{const t={};let i=!1;e.forEach((e=>{!0===e.rejected&&(i=!0)}));for(let r=0;r<e.length;r++)i&&!0===e[r].rejected?t[this._limiters[r].keyPrefix]=e[r].rej:i||(t[this._limiters[r].keyPrefix]=e[r]);i?n(t):r(t)}))}))}}},28622:function(e){e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},6410:function(e,t,r){const n=r(28622);e.exports=n},79690:function(e,t,r){const n=r(47289),i=r(29765);e.exports=class{constructor(){this._storage={}}incrby(e,t,r){if(this._storage[e]){const n=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==n?(this._storage[e].value=this._storage[e].value+t,new i(0,n,this._storage[e].value,!1)):this.set(e,t,r)}return this.set(e,t,r)}set(e,t,r){const s=1e3*r;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new n(t,s>0?new Date(Date.now()+s):null),s>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),s),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new i(0,0===s?-1:s,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new i(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},47289:function(e){e.exports=class{constructor(e,t,r=null){this.value=e,this.expiresAt=t,this.timeoutId=r}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},85392:function(e){e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},43827:function(e,t,r){"use strict";e.exports=r.p+"cyb_rune_wasm_bg.96a4434c31.wasm"},28732:function(e,t,r){var n,i,s;i=[r(85590)],void 0===(s="function"==typeof(n=function(e){"use strict";var t=e.Reader,r=e.Writer,n=e.util,i=e.roots.default||(e.roots.default={});return i.RPC=function(){function s(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.subscriptions=n.emptyArray,s.prototype.messages=n.emptyArray,s.prototype.control=null,Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var n=0;n<e.subscriptions.length;++n)i.RPC.SubOpts.encode(e.subscriptions[n],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(n=0;n<e.messages.length;++n)i.RPC.Message.encode(e.messages[n],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&i.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(i.RPC.SubOpts.decode(e,e.uint32()));break;case 2:s.messages&&s.messages.length||(s.messages=[]),s.messages.push(i.RPC.Message.decode(e,e.uint32()));break;case 3:s.control=i.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC)return e;var t=new i.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!=typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=i.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");for(t.messages=[],r=0;r<e.messages.length;++r){if("object"!=typeof e.messages[r])throw TypeError(".RPC.messages: object expected");t.messages[r]=i.RPC.Message.fromObject(e.messages[r])}}if(null!=e.control){if("object"!=typeof e.control)throw TypeError(".RPC.control: object expected");t.control=i.RPC.ControlMessage.fromObject(e.control)}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.messages=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n)r.subscriptions[n]=i.RPC.SubOpts.toObject(e.subscriptions[n],t)}if(e.messages&&e.messages.length)for(r.messages=[],n=0;n<e.messages.length;++n)r.messages[n]=i.RPC.Message.toObject(e.messages[n],t);return null!=e.control&&e.hasOwnProperty("control")&&(r.control=i.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.SubOpts=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.subscribe=null,s.prototype.topic=null,Object.defineProperty(s.prototype,"_subscribe",{get:n.oneOfGetter(o=["subscribe"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_topic",{get:n.oneOfGetter(o=["topic"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.SubOpts;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.subscribe=e.bool();break;case 2:s.topic=e.string();break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC.SubOpts)return e;var t=new i.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic,t.oneofs&&(r._topic="topic")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.Message=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.from=null,s.prototype.data=null,s.prototype.seqno=null,s.prototype.topic="",s.prototype.signature=null,s.prototype.key=null,Object.defineProperty(s.prototype,"_from",{get:n.oneOfGetter(o=["from"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_data",{get:n.oneOfGetter(o=["data"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_seqno",{get:n.oneOfGetter(o=["seqno"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_signature",{get:n.oneOfGetter(o=["signature"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_key",{get:n.oneOfGetter(o=["key"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var s=void 0===r?e.len:e.pos+r,o=new i.RPC.Message;e.pos<s;){var a=e.uint32();switch(a>>>3){case 1:o.from=e.bytes();break;case 2:o.data=e.bytes();break;case 3:o.seqno=e.bytes();break;case 4:o.topic=e.string();break;case 5:o.signature=e.bytes();break;case 6:o.key=e.bytes();break;default:e.skipType(7&a)}}if(!o.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:o});return o},s.fromObject=function(e){if(e instanceof i.RPC.Message)return e;var t=new i.RPC.Message;return null!=e.from&&("string"==typeof e.from?n.base64.decode(e.from,t.from=n.newBuffer(n.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"==typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"==typeof e.seqno?n.base64.decode(e.seqno,t.seqno=n.newBuffer(n.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"==typeof e.signature?n.base64.decode(e.signature,t.signature=n.newBuffer(n.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"==typeof e.key?n.base64.decode(e.key,t.key=n.newBuffer(n.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?n.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?n.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?n.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?n.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlMessage=function(){function s(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ihave=n.emptyArray,s.prototype.iwant=n.emptyArray,s.prototype.graft=n.emptyArray,s.prototype.prune=n.emptyArray,s.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var n=0;n<e.ihave.length;++n)i.RPC.ControlIHave.encode(e.ihave[n],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(n=0;n<e.iwant.length;++n)i.RPC.ControlIWant.encode(e.iwant[n],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(n=0;n<e.graft.length;++n)i.RPC.ControlGraft.encode(e.graft[n],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(n=0;n<e.prune.length;++n)i.RPC.ControlPrune.encode(e.prune[n],t.uint32(34).fork()).ldelim();return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlMessage;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.push(i.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.push(i.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.push(i.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.push(i.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlMessage)return e;var t=new i.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!=typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=i.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");for(t.iwant=[],r=0;r<e.iwant.length;++r){if("object"!=typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=i.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");for(t.graft=[],r=0;r<e.graft.length;++r){if("object"!=typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=i.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");for(t.prune=[],r=0;r<e.prune.length;++r){if("object"!=typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=i.RPC.ControlPrune.fromObject(e.prune[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var n=0;n<e.ihave.length;++n)r.ihave[n]=i.RPC.ControlIHave.toObject(e.ihave[n],t)}if(e.iwant&&e.iwant.length)for(r.iwant=[],n=0;n<e.iwant.length;++n)r.iwant[n]=i.RPC.ControlIWant.toObject(e.iwant[n],t);if(e.graft&&e.graft.length)for(r.graft=[],n=0;n<e.graft.length;++n)r.graft[n]=i.RPC.ControlGraft.toObject(e.graft[n],t);if(e.prune&&e.prune.length)for(r.prune=[],n=0;n<e.prune.length;++n)r.prune[n]=i.RPC.ControlPrune.toObject(e.prune[n],t);return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlIHave=function(){function s(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,s.prototype.messageIDs=n.emptyArray,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(18).bytes(e.messageIDs[n]);return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlIHave;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.topicID=e.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),s.messageIDs.push(e.bytes());break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlIHave)return e;var t=new i.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlIWant=function(){function s(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.messageIDs=n.emptyArray,s.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(10).bytes(e.messageIDs[n]);return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlIWant;e.pos<n;){var o=e.uint32();o>>>3==1?(s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),s.messageIDs.push(e.bytes())):e.skipType(7&o)}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlIWant)return e;var t=new i.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlGraft=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlGraft;e.pos<n;){var o=e.uint32();o>>>3==1?s.topicID=e.string():e.skipType(7&o)}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlGraft)return e;var t=new i.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlPrune=function(){function s(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,s.prototype.peers=n.emptyArray,s.prototype.backoff=null,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_backoff",{get:n.oneOfGetter(o=["backoff"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var n=0;n<e.peers.length;++n)i.RPC.PeerInfo.encode(e.peers[n],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlPrune;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.topicID=e.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),s.peers.push(i.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:s.backoff=e.uint64();break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlPrune)return e;var t=new i.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!=typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=i.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(n.Long?(t.backoff=n.Long.fromValue(e.backoff)).unsigned=!0:"string"==typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"==typeof e.backoff?t.backoff=e.backoff:"object"==typeof e.backoff&&(t.backoff=new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var s=0;s<e.peers.length;++s)r.peers[s]=i.RPC.PeerInfo.toObject(e.peers[s],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"==typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?n.Long.prototype.toString.call(e.backoff):t.longs===Number?new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.PeerInfo=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.peerID=null,s.prototype.signedPeerRecord=null,Object.defineProperty(s.prototype,"_peerID",{get:n.oneOfGetter(o=["peerID"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_signedPeerRecord",{get:n.oneOfGetter(o=["signedPeerRecord"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,s=new i.RPC.PeerInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:s.peerID=e.bytes();break;case 2:s.signedPeerRecord=e.bytes();break;default:e.skipType(7&o)}}return s},s.fromObject=function(e){if(e instanceof i.RPC.PeerInfo)return e;var t=new i.RPC.PeerInfo;return null!=e.peerID&&("string"==typeof e.peerID?n.base64.decode(e.peerID,t.peerID=n.newBuffer(n.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"==typeof e.signedPeerRecord?n.base64.decode(e.signedPeerRecord,t.signedPeerRecord=n.newBuffer(n.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?n.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?n.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s}(),i})?n.apply(t,i):n)||(e.exports=s)},2619:function(e,t,r){"use strict";r.d(t,{En:function(){return s},et:function(){return i},ol:function(){return o},uJ:function(){return a}});var n=r(44009),i="function"==typeof WeakMap&&!(0,n.no)((function(){return"ReactNative"==navigator.product&&!global.HermesInternal})),s="function"==typeof WeakSet,o="function"==typeof Symbol&&"function"==typeof Symbol.for,a=o&&Symbol.asyncIterator;(0,n.no)((function(){return window.document.createElement})),(0,n.no)((function(){return navigator.userAgent.indexOf("jsdom")>=0}))},71675:function(e,t,r){"use strict";r.d(t,{ei:function(){return o},w7:function(){return s},wM:function(){return i}});var n=r(64943);function i(e){return Boolean((0,n.vm)(e))}function s(e){return Boolean((0,n.JI)(e))}function o(e){return Boolean((0,n.do)(e))}},64943:function(e,t,r){"use strict";r.d(t,{do:function(){return c},vm:function(){return o},JI:function(){return a}});const n=45,i=15,s=new class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,r=e();return void 0===r&&(this.index=t),r}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,r){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return r()}))}readNumber(e,t,r,n){return this.readAtomically((()=>{let i=0,s=0;const o=this.peekChar();if(void 0===o)return;const a="0"===o,c=2**(8*n)-1;for(;;){const r=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const r=Number.parseInt(t,e);return Number.isNaN(r)?void 0:r}));if(void 0===r)break;if(i*=e,i+=r,i>c)return;if(s+=1,void 0!==t&&s>t)return}return 0===s||!r&&a&&s>1?void 0:i}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const r=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===r)return;e[t]=r}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const r=2*t;if(t<e.length-3){const n=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==n)return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],[r+4,!0]}const n=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===n)return[r,!1];e[r]=n>>8,e[r+1]=255&n}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[r,n]=e(t);if(16===r)return t;if(n)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),s=16-(r+2),[o]=e(i.subarray(0,s));return t.set(i.subarray(0,o),16-o),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};function o(e){if(!(e.length>i))return s.new(e).parseWith((()=>s.readIPv4Addr()))}function a(e){if(!(e.length>n))return s.new(e).parseWith((()=>s.readIPv6Addr()))}function c(e){if(!(e.length>n))return s.new(e).parseWith((()=>s.readIPAddr()))}},86320:function(e,t,r){"use strict";r.d(t,{f:function(){return wn}});var n={};r.r(n),r.d(n,{base10:function(){return we}});var i={};r.r(i),r.d(i,{base16:function(){return ve},base16upper:function(){return _e}});var s={};r.r(s),r.d(s,{base2:function(){return Ee}});var o={};r.r(o),r.d(o,{base256emoji:function(){return ke}});var a={};r.r(a),r.d(a,{base32:function(){return Ie},base32hex:function(){return Re},base32hexpad:function(){return De},base32hexpadupper:function(){return Be},base32hexupper:function(){return Oe},base32pad:function(){return Pe},base32padupper:function(){return Ce},base32upper:function(){return Te},base32z:function(){return Ne}});var c={};r.r(c),r.d(c,{base36:function(){return Me},base36upper:function(){return Ue}});var u={};r.r(u),r.d(u,{base58btc:function(){return Le},base58flickr:function(){return je}});var l={};r.r(l),r.d(l,{base64:function(){return Fe},base64pad:function(){return ze},base64url:function(){return $e},base64urlpad:function(){return Ke}});var h={};r.r(h),r.d(h,{base8:function(){return Ve}});var d={};r.r(d),r.d(d,{identity:function(){return qe}});var f={};r.r(f),r.d(f,{code:function(){return Je},decode:function(){return Ze},encode:function(){return Ye},name:function(){return Ge}});var p={};r.r(p),r.d(p,{code:function(){return Qe},decode:function(){return tt},encode:function(){return et},name:function(){return Xe}});var y={};r.r(y),r.d(y,{identity:function(){return kt}});var g={};r.r(g),r.d(g,{sha256:function(){return Ct},sha512:function(){return Rt}});var m={};r.r(m),r.d(m,{Ed25519PrivateKey:function(){return ur},Ed25519PublicKey:function(){return cr},generateKeyPair:function(){return dr},generateKeyPairFromSeed:function(){return fr},unmarshalEd25519PrivateKey:function(){return lr},unmarshalEd25519PublicKey:function(){return hr}});var b={};r.r(b),r.d(b,{MAX_KEY_SIZE:function(){return kr},RsaPrivateKey:function(){return Tr},RsaPublicKey:function(){return Ir},fromJwk:function(){return Rr},generateKeyPair:function(){return Or},unmarshalRsaPrivateKey:function(){return Pr},unmarshalRsaPublicKey:function(){return Cr}});var w={};r.r(w),r.d(w,{Secp256k1PrivateKey:function(){return Mr},Secp256k1PublicKey:function(){return Nr},generateKeyPair:function(){return jr},unmarshalSecp256k1PrivateKey:function(){return Ur},unmarshalSecp256k1PublicKey:function(){return Lr}});var v=r(89754),_=r(89585),E=r(97313);function S(){const e=(0,E.A)();let t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){const t=await e.promise;yield*t}()}}var x=r(81033);const A=65535,k=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var I=r(62962),T=r(80497);function P(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function C(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function R(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");P(e.outputLen),P(e.blockLen)}function O(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function D(e,t){C(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const B="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,N=e=>e instanceof Uint8Array,M=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),U=(e,t)=>e<<32-t|e>>>t;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function L(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),!N(e))throw new Error("expected Uint8Array, got "+typeof e);return e}class j{clone(){return this._cloneInto()}}function F(e){const t=t=>e().update(L(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}class z extends j{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,R(e);const r=L(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return O(this),this.iHash.update(e),this}digestInto(e){O(this),C(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const $=(e,t,r)=>new z(e,t).update(r).digest();function K(e,t,r){return R(e),void 0===r&&(r=new Uint8Array(e.outputLen)),$(e,L(r),L(t))}$.create=(e,t)=>new z(e,t);const V=new Uint8Array([0]),q=new Uint8Array;function W(e,t,r,n=32){if(R(e),P(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/e.outputLen);void 0===r&&(r=q);const s=new Uint8Array(i*e.outputLen),o=$.create(e,t),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let t=0;t<i;t++)V[0]=t+1,a.update(0===t?q:c).update(r).update(V).digestInto(c),s.set(c,e.outputLen*t),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),V.fill(0),s.slice(0,n)}class H extends j{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=M(this.buffer)}update(e){O(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=L(e)).length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o!==n)r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=M(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){O(this),D(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let e=s;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const o=M(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.length=n,e.pos=o,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}const G=(e,t,r)=>e&t^e&r^t&r,J=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Y=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Z=new Uint32Array(64);class X extends H{constructor(){super(64,32,8,!1),this.A=0|Y[0],this.B=0|Y[1],this.C=0|Y[2],this.D=0|Y[3],this.E=0|Y[4],this.F=0|Y[5],this.G=0|Y[6],this.H=0|Y[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)Z[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Z[e-15],r=Z[e-2],n=U(t,7)^U(t,18)^t>>>3,i=U(r,17)^U(r,19)^r>>>10;Z[e]=i+Z[e-7]+n+Z[e-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(U(o,6)^U(o,11)^U(o,25))+((l=o)&a^~l&c)+J[e]+Z[e]|0,h=(U(r,2)^U(r,13)^U(r,22))+G(r,n,i)|0;u=c,c=a,a=o,o=s+t|0,s=i,i=n,n=r,r=t+h|0}var l;r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,s,o,a,c,u)}roundClean(){Z.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Q=F((()=>new X)),ee={hashSHA256:e=>Q(e),getHKDF(e,t){const r=K(Q,t,e),n=W(Q,r,void 0,96);return[n.subarray(0,32),n.subarray(32,64),n.subarray(64,96)]},generateX25519KeyPair(){const e=T.TU.utils.randomPrivateKey();return{publicKey:T.TU.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:T.TU.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>T.TU.getSharedSecret(e,t),chaCha20Poly1305Encrypt:(e,t,r,n)=>(0,I.ix)(n,t,r).encrypt(e),chaCha20Poly1305Decrypt:(e,t,r,n,i)=>(0,I.ix)(n,t,r).decrypt(e,i)};function te(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function re(e=0){return null!=globalThis.Buffer?.allocUnsafe?te(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ne(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=re(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return te(r)}const ie=e=>{const t=(r=2,globalThis.Buffer?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r));var r;return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};ie.bytes=2;const se=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};se.bytes=2;var oe=r(70202),ae=(r(12746),r(12698),r(50276));var ce=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},ue=ce;new Uint8Array(0);const le=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class he{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class de{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return pe(this,e)}}class fe{constructor(e){this.decoders=e}or(e){return pe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pe=(e,t)=>new fe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ye{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new he(e,t,r),this.decoder=new de(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ge=({name:e,prefix:t,encode:r,decode:n})=>new ye(e,t,r,n),me=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=ue(r,t);return ge({prefix:e,name:t,encode:n,decode:e=>le(i(e))})},be=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>ge({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),we=me({prefix:"9",name:"base10",alphabet:"0123456789"}),ve=be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_e=be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ee=be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Se=Array.from(""),xe=Se.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ae=Se.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ke=ge({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=xe[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ae[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Ie=be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Te=be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pe=be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ce=be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Re=be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oe=be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),De=be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Be=be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ne=be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Me=me({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ue=me({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Le=me({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),je=me({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Fe=be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ze=be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$e=be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ke=be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ve=be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qe=ge({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),We=new TextEncoder,He=new TextDecoder,Ge="json",Je=512,Ye=e=>We.encode(JSON.stringify(e)),Ze=e=>JSON.parse(He.decode(e)),Xe="raw",Qe=85,et=e=>le(e),tt=e=>le(e);var rt=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=st;)r[n++]=255&t|nt,t/=128;for(;t&it;)r[n++]=255&t|nt,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},nt=128,it=-128,st=Math.pow(2,31);var ot=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&ct)<<s:(n&ct)*Math.pow(2,s),s+=7}while(n>=at);return e.bytes=o-r,i},at=128,ct=127;var ut=Math.pow(2,7),lt=Math.pow(2,14),ht=Math.pow(2,21),dt=Math.pow(2,28),ft=Math.pow(2,35),pt=Math.pow(2,42),yt=Math.pow(2,49),gt=Math.pow(2,56),mt=Math.pow(2,63),bt={encode:rt,decode:ot,encodingLength:function(e){return e<ut?1:e<lt?2:e<ht?3:e<dt?4:e<ft?5:e<pt?6:e<yt?7:e<gt?8:e<mt?9:10}};const wt=(e,t=0)=>[bt.decode(e,t),bt.decode.bytes],vt=(e,t,r=0)=>(bt.encode(e,t,r),t),_t=e=>bt.encodingLength(e),Et=(e,t)=>{const r=t.byteLength,n=_t(e),i=n+_t(r),s=new Uint8Array(i+r);return vt(e,s,0),vt(r,s,n),s.set(t,i),new xt(e,r,t,s)},St=e=>{const t=le(e),[r,n]=wt(t),[i,s]=wt(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new xt(r,i,o,t)};class xt{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const At=le,kt={code:0,name:"identity",encode:At,digest:e=>Et(0,At(e))},It=({name:e,code:t,encode:r})=>new Tt(e,t,r);class Tt{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Et(this.code,t):t.then((e=>Et(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Pt=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ct=It({name:"sha2-256",code:18,encode:Pt("SHA-256")}),Rt=It({name:"sha2-512",code:19,encode:Pt("SHA-512")}),Ot=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?Ut(r,Bt(e),t||Le.encoder):Lt(r,Bt(e),t||Ie.encoder)},Dt=new WeakMap,Bt=e=>{const t=Dt.get(e);if(null==t){const t=new Map;return Dt.set(e,t),t}return t};class Nt{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==jt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ft)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Nt.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Et(e,t);return Nt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Nt.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return Ot(this,e)}toJSON(){return{"/":Ot(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Nt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Nt(e,r,n,i||zt(e,r,n.bytes))}if(!0===t[$t]){const{version:e,multihash:r,code:n}=t,i=St(r);return Nt.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==jt)throw new Error(`Version 0 CID must use dag-pb (code: ${jt}) block encoding`);return new Nt(e,t,r,r.bytes);case 1:{const n=zt(e,t,r.bytes);return new Nt(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Nt.create(0,jt,e)}static createV1(e,t){return Nt.create(1,e,t)}static decode(e){const[t,r]=Nt.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Nt.inspectBytes(e),r=t.size-t.multihashSize,n=le(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new xt(t.multihashCode,t.digestSize,i,n);return[0===t.version?Nt.createV0(s):Nt.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=wt(e.subarray(t));return t+=n,r};let n=r(),i=jt;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=Mt(e,t),i=Nt.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Bt(i).set(r,e),i}}const Mt=(e,t)=>{switch(e[0]){case"Q":{const r=t||Le;return[Le.prefix,r.decode(`${Le.prefix}${e}`)]}case Le.prefix:{const r=t||Le;return[Le.prefix,r.decode(e)]}case Ie.prefix:{const r=t||Ie;return[Ie.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Ut=(e,t,r)=>{const{prefix:n}=r;if(n!==Le.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},Lt=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},jt=112,Ft=18,zt=(e,t,r)=>{const n=_t(e),i=n+_t(t),s=new Uint8Array(i+r.byteLength);return vt(e,s,0),vt(t,s,n),s.set(r,i),s},$t=Symbol.for("@ipld/js-cid/CID"),Kt={...d,...s,...h,...n,...i,...a,...c,...u,...l,...o};function Vt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const qt=Vt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Wt=Vt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=re((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var Ht={utf8:qt,"utf-8":qt,hex:Kt.base16,latin1:Wt,ascii:Wt,binary:Wt,...Kt};function Gt(e,t="utf8"){const r=Ht[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):te(globalThis.Buffer.from(e,"utf-8"))}function Jt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const Yt=32,Zt=64,Xt=32;function Qt(e,t){const r=new Uint8Array(Zt);for(let n=0;n<Xt;n++)r[n]=e[n],r[Xt+n]=t[n];return r}var er={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};const tr={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function rr(e,t){const r=function(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=er.get();return r*=8,{encrypt:async function(e,c){const u=a.getRandomValues(new Uint8Array(s)),l=a.getRandomValues(new Uint8Array(n)),h={name:t,iv:l};let d;if("string"==typeof c&&(c=Gt(c)),0===c.length){d=await a.subtle.importKey("jwk",tr,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}catch{d=await a.subtle.importKey("jwk",tr,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}const f=await a.subtle.encrypt(h,d,e);return ne([u,h.iv,new Uint8Array(f)])},decrypt:async function(e,c){const u=e.subarray(0,s),l=e.subarray(s,s+n),h=e.subarray(s+n),d={name:t,iv:l};let f;if("string"==typeof c&&(c=Gt(c)),0===c.length)try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}catch{f=await a.subtle.importKey("jwk",tr,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}const p=await a.subtle.decrypt(d,f,h);return new Uint8Array(p)}}}(),n=await r.encrypt(e,t);return Fe.encode(n)}var nr,ir,sr,or,ar=r(59110);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(nr||(nr={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(ir||(ir={})),function(e){e.codec=()=>(0,ar.eG)(ir)}(nr||(nr={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,ar.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),nr.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=nr.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,ar.mH)(t,e.codec()),e.decode=t=>(0,ar.Y8)(t,e.codec())}(sr||(sr={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,ar.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),nr.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=nr.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,ar.mH)(t,e.codec()),e.decode=t=>(0,ar.Y8)(t,e.codec())}(or||(or={}));class cr{_key;constructor(e){this._key=pr(e,Yt)}async verify(e,t){return async function(e,t,r){return T.ev.verify(t,r,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return sr.encode({Type:nr.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}}class ur{_key;_publicKey;constructor(e,t){this._key=pr(e,Zt),this._publicKey=pr(t,Yt)}async sign(e){return async function(e,t){const r=e.subarray(0,Xt);return T.ev.sign(t,r)}(this._key,e)}get public(){return new cr(this._publicKey)}marshal(){return this._key}get bytes(){return or.encode({Type:nr.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}async id(){const e=kt.digest(this.public.bytes);return Le.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return rr(this.bytes,e);throw new oe.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function lr(e){if(e.length>Zt){const t=(e=pr(e,Zt+Yt)).subarray(0,Zt),r=e.subarray(Zt,e.length);return new ur(t,r)}const t=(e=pr(e,Zt)).subarray(0,Zt),r=e.subarray(Yt);return new ur(t,r)}function hr(e){return e=pr(e,Yt),new cr(e)}async function dr(){const{privateKey:e,publicKey:t}=await async function(){const e=T.ev.utils.randomPrivateKey(),t=T.ev.getPublicKey(e);return{privateKey:Qt(e,t),publicKey:t}}();return new ur(e,t)}async function fr(e){const{privateKey:t,publicKey:r}=await async function(e){if(e.length!==Xt)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=T.ev.getPublicKey(t);return{privateKey:Qt(t,r),publicKey:r}}(e);return new ur(t,r)}function pr(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw new oe.Ak(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function yr(e,t="utf8"){const r=Ht[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}r(7619),r(43736);function gr(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.subarray(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=ne([new Uint8Array(t-r.length),r])}return yr(r,"base64url")}function mr(e){const t=function(e,t){let r=Gt(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=ne([new Uint8Array(t-r.length),r])}return r}(e);return new ae.jsbn.BigInteger(yr(t,"base16"),16)}const br={"P-256":256,"P-384":384,"P-521":521};Object.keys(br).join(" / ");r(72313);function wr(e){if(isNaN(e)||e<=0)throw new oe.Ak("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return function(e=32){if(B&&"function"==typeof B.getRandomValues)return B.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(e)}r(15805);function vr(e,t){return t.map((t=>mr(e[t])))}async function _r(e){const t=[await er.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Sr(e)],r=await Er({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function Er(e){if(null==e.privateKey||null==e.publicKey)throw new oe.Ak("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([er.get().subtle.exportKey("jwk",e.privateKey),er.get().subtle.exportKey("jwk",e.publicKey)])}async function Sr(e){return er.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function xr(e,t,r,n){const i=t?function(e){return ae.pki.setRsaPublicKey(...vr(e,["n","e"]))}(e):function(e){return ae.pki.setRsaPrivateKey(...vr(e,["n","e","d","p","q","dp","dq","qi"]))}(e);return Gt(n(yr(Uint8Array.from(r),"ascii"),i),"ascii")}function Ar(e){if("RSA"!==e.kty)throw new oe.Ak("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new oe.Ak("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*Gt(e.n,"base64url").length}const kr=8192;class Ir{_key;constructor(e){this._key=e}async verify(e,t){return async function(e,t,r){const n=await er.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return er.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new oe.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=ae.pki.publicKeyToAsn1({n:mr(e.n),e:mr(e.e)});return Gt(ae.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return sr.encode({Type:nr.RSA,Data:this.marshal()}).subarray()}encrypt(e){return xr(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}}class Tr{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return wr(16)}async sign(e){return async function(e,t){const r=await er.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await er.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new oe.Ak("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Ir(this._publicKey)}decrypt(e){return xr(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new oe.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=ae.pki.privateKeyToAsn1({n:mr(e.n),e:mr(e.e),d:mr(e.d),p:mr(e.p),q:mr(e.q),dP:mr(e.dp),dQ:mr(e.dq),qInv:mr(e.qi)});return Gt(ae.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return or.encode({Type:nr.RSA,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}async id(){return yr(await this.public.hash(),"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new ae.util.ByteBuffer(this.marshal()),r=ae.asn1.fromDer(t),n=ae.pki.privateKeyFromAsn1(r),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return ae.pki.encryptRsaPrivateKey(n,e,i)}if("libp2p-key"===t)return rr(this.bytes,e);throw new oe.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function Pr(e){const t=function(e){const t=ae.asn1.fromDer(yr(e,"ascii")),r=ae.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:gr(r.n),e:gr(r.e),d:gr(r.d),p:gr(r.p),q:gr(r.q),dp:gr(r.dP),dq:gr(r.dQ),qi:gr(r.qInv),alg:"RS256"}}(e);if(Ar(t)>kr)throw new oe.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await _r(t);return new Tr(r.privateKey,r.publicKey)}function Cr(e){const t=function(e){const t=ae.asn1.fromDer(yr(e,"ascii")),r=ae.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:gr(r.n),e:gr(r.e)}}(e);if(Ar(t)>kr)throw new oe.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Ir(t)}async function Rr(e){if(Ar(e)>kr)throw new oe.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await _r(e);return new Tr(t.privateKey,t.publicKey)}async function Or(e){if(e>kr)throw new oe.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await er.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Er(t);return{privateKey:r[0],publicKey:r[1]}}(e);return new Tr(t.privateKey,t.publicKey)}var Dr=r(64544);function Br(e){try{Dr.bI.ProjectivePoint.fromHex(e)}catch(e){throw new oe.Ak(String(e),"ERR_INVALID_PUBLIC_KEY")}}class Nr{_key;constructor(e){Br(e),this._key=e}async verify(e,t){return async function(e,t,r){try{const{digest:n}=await Ct.digest(r);return Dr.bI.verify(t,n,e)}catch(e){throw new oe.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Dr.bI.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return sr.encode({Type:nr.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}}class Mr{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return Dr.bI.getPublicKey(e,!0)}catch(e){throw new oe.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Dr.bI.getPublicKey(e,!0)}catch(e){throw new oe.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Br(this._publicKey)}async sign(e){return async function(e,t){const{digest:r}=await Ct.digest(t);try{return Dr.bI.sign(r,e).toDERRawBytes()}catch(e){throw new oe.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Nr(this._publicKey)}marshal(){return this._key}get bytes(){return or.encode({Type:nr.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Ct.digest(this.bytes);return e}async id(){return yr(await this.public.hash(),"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return rr(this.bytes,e);throw new oe.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function Ur(e){return new Mr(e)}function Lr(e){return new Nr(e)}async function jr(){const e=Dr.bI.utils.randomPrivateKey();return new Mr(e)}const Fr={rsa:b,ed25519:m,secp256k1:w};function zr(e){const t=Object.keys(Fr).join(" / ");return new oe.Ak(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}async function $r(e){const t=or.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case nr.RSA:return Fr.rsa.unmarshalRsaPrivateKey(r);case nr.Ed25519:return Fr.ed25519.unmarshalEd25519PrivateKey(r);case nr.Secp256k1:return Fr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw zr(t.Type??"RSA")}}var Kr=r(66660);const Vr=Symbol.for("nodejs.util.inspect.custom"),qr=Object.values(Kt).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Kt.identity.decoder),Wr=114,Hr=36,Gr=37;class Jr{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Kr.H]=!0;toString(){return null==this.string&&(this.string=Le.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Nt.createV1(Wr,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Jt(this.multihash.bytes,e);if("string"==typeof e)return function(e,t){if(t=t??qr,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=St(Le.decode(`z${e}`));return e.startsWith("12D")?new Zr({multihash:t}):e.startsWith("16U")?new Xr({multihash:t}):new Yr({multihash:t})}return function(e){try{const t=St(e);if(t.code===kt.code){if(t.digest.length===Hr)return new Zr({multihash:t});if(t.digest.length===Gr)return new Xr({multihash:t})}if(t.code===Ct.code)return new Yr({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Wr)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Ct.code)return new Yr({multihash:e.multihash});if(t.code===kt.code){if(t.digest.length===Hr)return new Zr({multihash:e.multihash});if(t.digest.length===Gr)return new Xr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Nt.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(qr.decode(e))}(e).equals(this);if(null!=e?.multihash?.bytes)return Jt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Vr](){return`PeerId(${this.toString()})`}}class Yr extends Jr{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class Zr extends Jr{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class Xr extends Jr{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}async function Qr(e,t){return e.length===Hr?new Zr({multihash:Et(kt.code,e),privateKey:t}):e.length===Gr?new Xr({multihash:Et(kt.code,e),privateKey:t}):new Yr({multihash:await Ct.digest(e),publicKey:e,privateKey:t})}var en,tn;async function rn(e,t,r){const n=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");return(await $r(e.privateKey)).sign(t)}(e,on(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,r){return tn.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}(e.publicKey,n,r)}async function nn(e){return Qr(e.identityKey)}function sn(e){return tn.decode(e)}function on(e){const t=Gt("noise-libp2p-static-key:");return ne([t,e],t.length+e.length)}async function an(e,t,r){const n=await Qr(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);const i=on(e);if(null==n.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const s=function(e){const t=sr.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case nr.RSA:return Fr.rsa.unmarshalRsaPublicKey(r);case nr.Ed25519:return Fr.ed25519.unmarshalEd25519PublicKey(r);case nr.Secp256k1:return Fr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw zr(t.Type??"unknown")}}(n.publicKey);if(!await s.verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function cn(e){return e instanceof Uint8Array&&32===e.length}!function(e){let t;e.codec=()=>(null==t&&(t=(0,ar.iU)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={webtransportCerthashes:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,ar.mH)(t,e.codec()),e.decode=t=>(0,ar.Y8)(t,e.codec())}(en||(en={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,ar.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(e.identityKey??new Uint8Array(0))),(!0===r.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(e.identitySig??new Uint8Array(0))),null!=e.extensions&&(t.uint32(34),en.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 4:r.extensions=en.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,ar.mH)(t,e.codec()),e.decode=t=>(0,ar.Y8)(t,e.codec())}(tn||(tn={}));var un=r(17833);un.formatters.b=e=>null==e?"undefined":Le.baseEncode(e),un.formatters.t=e=>null==e?"undefined":Ie.baseEncode(e),un.formatters.m=e=>null==e?"undefined":Fe.baseEncode(e),un.formatters.p=e=>null==e?"undefined":e.toString(),un.formatters.c=e=>null==e?"undefined":e.toString(),un.formatters.k=e=>null==e?"undefined":e.toString(),un.formatters.a=e=>null==e?"undefined":e.toString();const ln=function(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return un.enabled(`${e}:trace`)&&null!=un.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=un(`${e}:trace`)),Object.assign(un(e),{error:un(`${e}:error`),trace:t})}("libp2p:noise");let hn;function dn(e){e?(hn(`LOCAL_PUBLIC_EPHEMERAL_KEY ${yr(e.publicKey,"hex")}`),hn(`LOCAL_PRIVATE_EPHEMERAL_KEY ${yr(e.privateKey,"hex")}`)):hn("Missing local ephemeral keys.")}function fn(e){hn(`REMOTE_EPHEMERAL_PUBLIC_KEY ${yr(e,"hex")}`)}hn=k?ln:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class pn{n;bytes;view;constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class yn{crypto;constructor(e){this.crypto=e}encryptWithAd(e,t,r){const n=this.encrypt(e.k,e.n,t,r);return e.n.increment(),n}decryptWithAd(e,t,r,n){const{plaintext:i,valid:s}=this.decrypt(e.k,e.n,t,r,n);return s&&e.n.increment(),{plaintext:i,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){return Jt(this.createEmptyKey(),e)}encrypt(e,t,r,n){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(n,t.getBytes(),r,e)}encryptAndHash(e,t){let r;return r=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,r),r}decrypt(e,t,r,n,i){t.assertValue();const s=this.crypto.chaCha20Poly1305Decrypt(n,t.getBytes(),r,e,i);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let r,n=!0;return this.hasKey(e.cs)?({plaintext:r,valid:n}=this.decryptWithAd(e.cs,e.h,t)):r=t,this.mixHash(e,t),{plaintext:r,valid:n}}dh(e,t){try{const r=this.crypto.generateX25519SharedKey(e,t);return 32===r.length?r:r.subarray(0,32)}catch(e){const t=e;return ln.error(t),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(ne([e,t],e.length+t.length))}mixKey(e,t){const[r,n]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(n),e.ck=r}initializeKey(e){return{k:e,n:new pn}}initializeSymmetric(e){const t=Gt(e,"utf-8"),r=this.hashProtocolName(t),n=r,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:n,h:r}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,r]=this.crypto.getHKDF(e.ck,new Uint8Array(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(r)}}writeMessageRegular(e,t){const r=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:r}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}class gn extends yn{initializeInitiator(e,t,r,n){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:r,psk:n,re:new Uint8Array(32)}}initializeResponder(e,t,r,n){const i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(i,e);return{ss:i,s:t,rs:r,psk:n,re:new Uint8Array(32)}}writeMessageA(e,t,r){const n=new Uint8Array(0);e.e=void 0!==r?r:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);return{ne:i,ns:n,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:r,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),s={ne:this.createEmptyKey(),ns:n,ciphertext:i},{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:s,cs1:o,cs2:a}}readMessageA(e,t){return cn(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(cn(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&cn(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:n&&s}}readMessageC(e,t){const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&cn(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:n&&s,cs1:o,cs2:a}}initSession(e,t,r){const n=this.createEmptyKey(),i=new Uint8Array(32);let s;return s=e?this.initializeInitiator(t,r,i,n):this.initializeResponder(t,r,i,n),{hs:s,i:e,mc:0}}sendMessage(e,t,r){let n;if(0===e.mc)n=this.writeMessageA(e.hs,t,r);else if(1===e.mc)n=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:r,messageBuffer:i,cs1:s,cs2:o}=this.writeMessageC(e.hs,t);n=i,e.h=r,e.cs1=s,e.cs2=o}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}}return e.mc++,n}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(0===e.mc)({plaintext:r,valid:n}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:r,valid:n}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:s,valid:o,cs1:a,cs2:c}=this.readMessageC(e.hs,t);r=s,n=o,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:r,valid:n}}}class mn{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(e,t,r,n,i,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=i,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new gn(n),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e,t;if(e=this.session.hs.s,hn(`LOCAL_STATIC_PUBLIC_KEY ${yr(e.publicKey,"hex")}`),hn(`LOCAL_STATIC_PRIVATE_KEY ${yr(e.privateKey,"hex")}`),this.isInitiator){ln.trace("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,new Uint8Array(0));await this.connection.write((t=e,ne([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length))),ln.trace("Stage 0 - Initiator finished sending first message."),dn(this.session.hs.e)}else{ln.trace("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}((await this.connection.read()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new oe.c6("xx handshake stage 0 validation fail");ln.trace("Stage 0 - Responder received first message."),fn(this.session.hs.re)}}async exchange(){if(this.isInitiator){ln.trace("Stage 1 - Initiator waiting to receive first message from responder...");const e=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new oe.c6("xx handshake stage 1 validation fail");ln.trace("Stage 1 - Initiator received the message."),fn(this.session.hs.re),t=this.session.hs.rs,hn(`REMOTE_STATIC_PUBLIC_KEY ${yr(t,"hex")}`),ln.trace("Initiator going to check remote's signature...");try{const e=sn(r);this.remotePeer=this.remotePeer||await nn(e),await an(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){const t=e;throw new oe.aS(`Error occurred while verifying signed payload: ${t.message}`)}ln.trace("All good with the signature!")}else{ln.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const t=this.xx.sendMessage(this.session,this.payload);await this.connection.write((e=t,ne([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length))),ln.trace("Stage 1 - Responder sent the second handshake message with signed payload."),dn(this.session.hs.e)}var e,t}async finish(){if(this.isInitiator){ln.trace("Stage 2 - Initiator sending third handshake message.");const t=this.xx.sendMessage(this.session,this.payload);await this.connection.write((e=t,ne([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length))),ln.trace("Stage 2 - Initiator sent message with signed payload.")}else{ln.trace("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.read()).subarray()),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new oe.c6("xx handshake stage 2 validation fail");ln.trace("Stage 2 - Responder received the message, finished handshake.");try{const e=sn(t);this.remotePeer=this.remotePeer||await nn(e),await an(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){const t=e;throw new oe.aS(`Error occurred while verifying signed payload: ${t.message}`)}}var e,t;(t=this.session).cs1&&t.cs2?(hn(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${yr(t.cs1.k,"hex")}`),hn(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${yr(t.cs2.k,"hex")}`)):hn("Missing cipher state.")}encrypt(e,t){const r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}decrypt(e,t,r){const n=this.getCS(t,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e,r)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new oe.c6("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class bn{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(e={}){const{staticNoiseKey:t,extensions:r,crypto:n,prologueBytes:i,metrics:s}=e;this.crypto=n??ee,this.extensions=r,this.metrics=s?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(s):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=i??new Uint8Array(0)}async secureOutbound(e,t,r){const n=(0,_.V)(t,{lengthEncoder:ie,lengthDecoder:se,maxDataLength:A}),i=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,i),remoteExtensions:i.remoteExtensions,remotePeer:i.remotePeer}}async secureInbound(e,t,r){const n=(0,_.V)(t,{lengthEncoder:ie,lengthDecoder:se,maxDataLength:A}),i=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,i),remotePeer:i.remotePeer,remoteExtensions:i.remoteExtensions}}async performHandshake(e){const t=await rn(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:r,remotePeer:n,connection:i}=e,s=new mn(r,t,this.prologue,this.crypto,this.staticKeys,i,n);try{await s.propose(),await s.exchange(),await s.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(e){if(this.metrics?.xxHandshakeErrors.increment(),e instanceof Error)throw e.message=`Error occurred during XX handshake: ${e.message}`,e}return s}async createSecureConnection(e,t){const[r,n]=function(){const e=S(),t=S();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await(0,x.F)(r,function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=65519){let i=r+65519;i>n.length&&(i=n.length);const s=e.encrypt(n.subarray(r,i),e.session);t?.encryptedPackets.increment(),yield ie(s.byteLength),yield s}}}(t,this.metrics),i,(e=>(0,v.D)(e,{lengthDecoder:se})),function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=A){let i=r+A;if(i>n.length&&(i=n.length),i-16<r)throw new Error("Invalid chunk");const s=n.subarray(r,i),o=n.subarray(r,i-16),{plaintext:a,valid:c}=e.decrypt(s,e.session,o);if(!c)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield a}}}(t,this.metrics),r),n}}function wn(e={}){return()=>new bn(e)}},84419:function(e,t,r){"use strict";r.d(t,{N:function(){return re}});var n=r(70202),i=r(17833);var s=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);class o{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class a{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return u(this,e)}}class c{constructor(e){this.decoders=e}or(e){return u(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const u=(e,t)=>new c({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class l{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new o(e,t,r),this.decoder=new a(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const h=({name:e,prefix:t,encode:r,decode:n})=>new l(e,t,r,n),d=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=s(r,t);return h({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},f=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>h({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),p=f({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),y=(f({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),f({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),f({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),f({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),f({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),f({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),f({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),f({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),d({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),g=(d({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),f({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));f({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),f({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function m(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return i.enabled(`${e}:trace`)&&null!=i.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=i(`${e}:trace`)),Object.assign(i(e),{error:i(`${e}:error`),trace:t})}i.formatters.b=e=>null==e?"undefined":y.baseEncode(e),i.formatters.t=e=>null==e?"undefined":p.baseEncode(e),i.formatters.m=e=>null==e?"undefined":g.baseEncode(e),i.formatters.p=e=>null==e?"undefined":e.toString(),i.formatters.c=e=>null==e?"undefined":e.toString(),i.formatters.k=e=>null==e?"undefined":e.toString(),i.formatters.a=e=>null==e?"undefined":e.toString();class b extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function w(e,t,r){const n=r??{},i=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const s=()=>{null!=r&&r()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=n;throw new b(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=n;t(new b(e,r))}}));o=await Promise.race([e,i.next()]),r=null}catch(r){t.removeEventListener("abort",s);const o="aborted"===r.type&&t.aborted;if(o&&null!=n.onAbort&&n.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=n.onReturnError&&n.onReturnError(e)}))}catch(e){null!=n.onReturnError&&n.onReturnError(e)}if(o&&!0===n.returnOnAbort)return;throw r}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}var v=r(81033),_=r(97313);class E{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class S{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new E(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new E(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}class x extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function A(e,t){let r,n,i,s=(t=t??{}).onEnd,o=new S,a=(0,_.A)();const c=e=>null!=n?n(e):(o.push(e),r),u=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?r:(i=!0,null!=e?(e=>(o=new S,null!=n?n({error:e}):(o.push({error:e}),r)))(e):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{n=s=>{n=null,o.push(s);try{t(e(o))}catch(e){i(e)}return r}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,_.A)()}))}},return:()=>(o=new S,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let r,n;null!=t&&(r=new Promise(((e,r)=>{n=()=>{r(new x)},t.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=t&&t?.removeEventListener("abort",n)}}},null==s)return r;const h=r;return r={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return h.readableLength}},r}const k="ERR_INVALID_FRAME",I="ERR_UNREQUESTED_PING",T="ERR_NOT_MATCHING_PING",P="ERR_STREAM_ALREADY_EXISTS",C="ERR_DECODE_INVALID_VERSION",R="ERR_BOTH_CLIENTS",O="ERR_RECV_WINDOW_EXCEEDED",D=new Set([k,I,T,P,C,R,O]),B="ERR_INVALID_CONFIG",N="ERR_MUXER_LOCAL_CLOSED",M="ERR_MUXER_REMOTE_CLOSED",U=262144,L={log:m("libp2p:yamux"),enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:U,maxStreamWindowSize:16777216,maxMessageSize:65536};var j,F,z=r(40859);!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(j||(j={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(F||(F={}));const $=Object.values(F).filter((e=>"string"!=typeof e));var K;!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(K||(K={}));function V(e){const t=$.filter((t=>(e.flag&t)===t)).map((e=>F[e])).join("|");return`streamID=${e.streamID} type=${j[e.type]} flag=${t} length=${e.length}`}const q=2**24;class W{source;buffer;frameInProgress;constructor(e){this.source=function(e){if(void 0!==e[Symbol.iterator]){const t=e[Symbol.iterator]();return t.return=void 0,{[Symbol.iterator]:()=>t}}if(void 0!==e[Symbol.asyncIterator]){const t=e[Symbol.asyncIterator]();return t.return=void 0,{[Symbol.asyncIterator]:()=>t}}throw new Error("a source must be either an iterable or an async iterable")}(e),this.buffer=new z.I,this.frameInProgress=!1}async*emitFrames(){for await(const e of this.source)for(this.buffer.append(e);;){const e=this.readHeader();if(void 0===e)break;const{type:t,length:r}=e;t===j.Data?(this.frameInProgress=!0,yield{header:e,readData:this.readBytes.bind(this,r)}):yield{header:e}}}readHeader(){if(this.frameInProgress)throw new n.Ak("decoding frame already in progress","ERR_DECODE_IN_PROGRESS");if(this.buffer.length<12)return;const e=function(e){if(0!==e[0])throw new n.Ak("Invalid frame version",C);return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*q+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*q+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}async readBytes(e){if(this.buffer.length<e)for await(const t of this.source)if(this.buffer.append(t),this.buffer.length>=e)break;const t=this.buffer.sublist(0,e);return this.buffer.consume(e),this.frameInProgress=!1,t}}function H(e){const t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}var G=r(70296),J=r(97101);var Y,Z=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r),yield r}();const r=(0,J.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s?.then)return async function*(){yield n;for await(const e of r)await t(e),yield e}();const o=t;return function*(){yield n;for(const e of r)o(e),yield e}()};!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(Y||(Y={}));class X extends G.l{name;state;config;_id;sendWindowCapacity;sendWindowCapacityUpdate;recvWindow;recvWindowCapacity;epochStart;getRTT;sendFrame;constructor(e){super({...e,onEnd:t=>{this.state=Y.Finished,e.onEnd?.(t)}}),this.config=e.config,this._id=parseInt(e.id,10),this.name=e.name,this.state=e.state,this.sendWindowCapacity=U,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=e.getRTT,this.sendFrame=e.sendFrame,this.source=Z(this.source,(()=>{this.sendWindowUpdate()}))}async sendNewStream(){}async sendData(e,t={}){for(e=e.sublist();0!==e.byteLength;){if(0===this.sendWindowCapacity&&await this.waitForSendWindowCapacity(t),"open"!==this.status)return;const r=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,e.length),n=this.getSendFlags();this.sendFrame({type:j.Data,flag:n,streamID:this._id,length:r},e.subarray(0,r)),this.sendWindowCapacity-=r,e.consume(r)}}async sendReset(){this.sendFrame({type:j.WindowUpdate,flag:F.RST,streamID:this._id,length:0})}async sendCloseWrite(){const e=this.getSendFlags()|F.FIN;this.sendFrame({type:j.WindowUpdate,flag:e,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(e={}){if(this.sendWindowCapacity>0)return;let t,r;const i=()=>{"open"===this.status?r(new n.Ak("stream aborted","ERR_STREAM_ABORT")):t()};e.signal?.addEventListener("abort",i);try{await new Promise(((e,n)=>{this.sendWindowCapacityUpdate=()=>{e()},r=n,t=e}))}finally{e.signal?.removeEventListener("abort",i)}}handleWindowUpdate(e){this.log?.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);const t=this.sendWindowCapacity;this.sendWindowCapacity+=e.length,0===t&&e.length>0&&this.sendWindowCapacityUpdate?.()}async handleData(e,t){if(this.log?.trace("stream received data id=%s",this._id),this.processFlags(e.flag),this.recvWindowCapacity<e.length)throw new n.Ak("receive window exceeded",O,{available:this.recvWindowCapacity,recv:e.length});const r=await t();this.recvWindowCapacity-=e.length,this.sourcePush(r)}processFlags(e){(e&F.ACK)===F.ACK&&this.state===Y.SYNSent&&(this.state=Y.Established),(e&F.FIN)===F.FIN&&this.remoteCloseWrite(),(e&F.RST)===F.RST&&this.reset()}getSendFlags(){switch(this.state){case Y.Init:return this.state=Y.SYNSent,F.SYN;case Y.SYNReceived:return this.state=Y.Established,F.ACK;default:return 0}}sendWindowUpdate(){const e=this.getSendFlags(),t=Date.now(),r=this.getRTT();if(0===e&&r>0&&t-this.epochStart<4*r&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&0===e)return;const n=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:j.WindowUpdate,flag:e,streamID:this._id,length:n})}}const Q="/yamux/1.0.0";class ee{protocol=Q;_init;constructor(e={}){this._init=e}createStreamMuxer(e){return new te({...this._init,...e})}}class te{protocol=Q;source;sink;config;log;closeController;nextStreamID;_streams;nextPingID;activePing;rtt;client;localGoAway;remoteGoAway;numInboundStreams;numOutboundStreams;onIncomingStream;onStreamEnd;constructor(e){this.client="outbound"===e.direction,this.config={...L,...e},this.log=this.config.log,function(e){if(e.keepAliveInterval<=0)throw new n.Ak("keep-alive interval must be positive",B);if(e.maxInboundStreams<0)throw new n.Ak("max inbound streams must be larger or equal 0",B);if(e.maxOutboundStreams<0)throw new n.Ak("max outbound streams must be larger or equal 0",B);if(e.initialStreamWindowSize<U)throw new n.Ak("InitialStreamWindowSize must be larger or equal 256 kB",B);if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new n.Ak("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",B);if(e.maxStreamWindowSize>2**32-1)throw new n.Ak("MaxStreamWindowSize must be less than equal MAX_UINT32",B);if(e.maxMessageSize<1024)throw new n.Ak("MaxMessageSize must be greater than a kilobyte",B)}(this.config),this.closeController=new AbortController,this.onIncomingStream=e.onIncomingStream,this.onStreamEnd=e.onStreamEnd,this._streams=new Map,this.source=function(e={}){return A((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}({onEnd:()=>{this.log?.trace("muxer source ended"),this._streams.forEach((e=>{e.destroy()}))}}),this.sink=async e=>{let t,r;e=w(e,this.closeController.signal,{returnOnAbort:!0});try{const r=new W(e);await(0,v.F)(r.emitFrames.bind(r),(async e=>{for await(const{header:t,readData:r}of e)await this.handleFrame(t,r)})),t=K.NormalTermination}catch(e){const n=e.code;D.has(n)?(this.log?.error("protocol error in sink",e),t=K.ProtocolError):(this.log?.error("internal error in sink",e),t=K.InternalError),r=e}this.log?.trace("muxer sink ended"),null!=r?this.abort(r,t):await this.close({reason:t})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=0,this.log?.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((e=>this.log?.error("keepalive error: %s",e)))}get streams(){return Array.from(this._streams.values())}newStream(e){if(void 0!==this.remoteGoAway)throw new n.Ak("muxer closed remotely",M);if(void 0!==this.localGoAway)throw new n.Ak("muxer closed locally",N);const t=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new n.Ak("max outbound streams exceeded","ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED");this.log?.trace("new outgoing stream id=%s",t);const r=this._newStream(t,e,Y.Init,"outbound");return this._streams.set(t,r),this.numOutboundStreams++,r.sendWindowUpdate(),r}async ping(){if(void 0!==this.remoteGoAway)throw new n.Ak("muxer closed remotely",M);if(void 0!==this.localGoAway)throw new n.Ak("muxer closed locally",N);if(void 0===this.activePing){let e=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise(((t,r)=>{const i=()=>{r(new n.Ak("muxer closed locally",N))};this.closeController.signal.addEventListener("abort",i,{once:!0}),e=()=>{this.closeController.signal.removeEventListener("abort",i),t()}})),resolve:e};const t=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const r=Date.now();this.rtt=r-t}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(e={}){if(this.closeController.signal.aborted)return;const t=e?.reason??K.NormalTermination;this.log?.trace("muxer close reason=%s",t),e.signal=e.signal??AbortSignal.timeout(500);try{await Promise.all([...this._streams.values()].map((async t=>t.close(e)))),this.sendGoAway(t),this._closeMuxer()}catch(e){this.abort(e)}}abort(e,t){if(!this.closeController.signal.aborted){t=t??K.InternalError,this.log?.error("muxer abort reason=%s error=%s",t,e);for(const t of this._streams.values())t.abort(e);this.sendGoAway(t),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(e,t,r,i){if(null!=this._streams.get(e))throw new n.Ak("Stream already exists",P,{id:e});const s=new X({id:e.toString(),name:t,state:r,direction:i,sendFrame:this.sendFrame.bind(this),onEnd:()=>{this.closeStream(e),this.onStreamEnd?.(s)},log:m(`libp2p:yamux:${i}:${e}`),config:this.config,getRTT:this.getRTT.bind(this)});return s}closeStream(e){this.client===(e%2==0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}async keepAliveLoop(){const e=new Promise(((e,t)=>{this.closeController.signal.addEventListener("abort",t,{once:!0})}));for(this.log?.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let t;try{await Promise.race([e,new Promise((e=>{t=setTimeout(e,this.config.keepAliveInterval)}))]),this.ping().catch((e=>this.log?.error("ping error: %s",e)))}catch(e){return void clearInterval(t)}}}async handleFrame(e,t){const{streamID:r,type:i,length:s}=e;if(this.log?.trace("received frame %s",V(e)),0===r)switch(i){case j.Ping:return void this.handlePing(e);case j.GoAway:return void this.handleGoAway(s);default:throw new n.Ak("Invalid frame type",k,{header:e})}else switch(e.type){case j.Data:case j.WindowUpdate:return void await this.handleStreamMessage(e,t);default:throw new n.Ak("Invalid frame type",k,{header:e})}}handlePing(e){if(e.flag===F.SYN)this.log?.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,F.ACK);else{if(e.flag!==F.ACK)throw new n.Ak("Invalid frame flag",k,{header:e});this.log?.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}handlePingResponse(e){if(void 0===this.activePing)throw new n.Ak("ping not requested",I);if(this.activePing.id!==e)throw new n.Ak("ping doesn't match our id",T);this.activePing.resolve()}handleGoAway(e){this.log?.trace("received GoAway reason=%s",K[e]??"unknown"),this.remoteGoAway=e;for(const e of this._streams.values())e.reset();this._closeMuxer()}async handleStreamMessage(e,t){const{streamID:r,flag:n,type:i}=e;(n&F.SYN)===F.SYN&&this.incomingStream(r);const s=this._streams.get(r);if(void 0!==s)switch(i){case j.WindowUpdate:return void s.handleWindowUpdate(e);case j.Data:if(void 0===t)throw new Error("unreachable");return void await s.handleData(e,t);default:throw new Error("unreachable")}else if(i===j.Data){if(this.log?.("discarding data for stream id=%s",r),void 0===t)throw new Error("unreachable");await t()}else this.log?.("frame for missing stream id=%s",r)}incomingStream(e){if(this.client!==(e%2==0))throw new n.Ak("both endpoints are clients",R);if(this._streams.has(e))return;if(this.log?.trace("new incoming stream id=%s",e),void 0!==this.localGoAway)return void this.sendFrame({type:j.WindowUpdate,flag:F.RST,streamID:e,length:0});if(this.numInboundStreams>=this.config.maxInboundStreams)return this.log?.("maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:j.WindowUpdate,flag:F.RST,streamID:e,length:0});const t=this._newStream(e,void 0,Y.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,t),this.onIncomingStream?.(t)}sendFrame(e,t){if(this.log?.trace("sending frame %s",V(e)),e.type===j.Data){if(void 0===t)throw new n.Ak("invalid frame",k);this.source.push(H(e)),this.source.push(t)}else this.source.push(H(e))}sendPing(e,t=F.SYN){t===F.SYN?this.log?.trace("sending ping request pingId=%s",e):this.log?.trace("sending ping response pingId=%s",e),this.sendFrame({type:j.Ping,flag:t,streamID:0,length:e})}sendGoAway(e=K.NormalTermination){this.log?.("sending GoAway reason=%s",K[e]),this.localGoAway=e,this.sendFrame({type:j.GoAway,flag:0,streamID:0,length:e})}}function re(e={}){return()=>new ee(e)}},48874:function(e,t,r){"use strict";r(64943);parseInt("0xFFFF",16),new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255])},19213:function(e,t,r){"use strict";r.d(t,{Si:function(){return ki}});var n={};r.r(n),r.d(n,{code:function(){return x},decode:function(){return k},encode:function(){return A},name:function(){return S}});var i=r(66310);var s=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};var o=function(e,t=1){return t=Number(t),null!=e[Symbol.asyncIterator]?async function*(){let r=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}():function*(){let r=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}()};async function*a(e,t=1){for await(const r of o(e,t)){const e=r.map((async e=>e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}var c=r(40859);const u=(e={})=>{const t=e.chunkSize??262144;return async function*(e){let r=new c.I,n=0,i=!1;for await(const s of e)for(r.append(s),n+=s.length;n>=t;)if(yield r.slice(0,t),i=!0,t===r.length)r=new c.I,n=0;else{const e=new c.I;e.append(r.sublist(t)),r=e,n-=t}(!i||n>0)&&(yield r.subarray(0,n))}};var l,h,d,f=r(24400),p=r(59110);!function(e){let t,r,n;!function(e){e.Raw="Raw",e.Directory="Directory",e.File="File",e.Metadata="Metadata",e.Symlink="Symlink",e.HAMTShard="HAMTShard"}(t=e.DataType||(e.DataType={})),function(e){e[e.Raw=0]="Raw",e[e.Directory=1]="Directory",e[e.File=2]="File",e[e.Metadata=3]="Metadata",e[e.Symlink=4]="Symlink",e[e.HAMTShard=5]="HAMTShard"}(r||(r={})),function(e){e.codec=()=>(0,p.eG)(r)}(t=e.DataType||(e.DataType={})),e.codec=()=>(null==n&&(n=(0,p.iU)(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.Type&&(r.uint32(8),e.DataType.codec().encode(t.Type,r)),null!=t.Data&&(r.uint32(18),r.bytes(t.Data)),null!=t.filesize&&(r.uint32(24),r.uint64(t.filesize)),null!=t.blocksizes)for(const e of t.blocksizes)r.uint32(32),r.uint64(e);null!=t.hashType&&(r.uint32(40),r.uint64(t.hashType)),null!=t.fanout&&(r.uint32(48),r.uint64(t.fanout)),null!=t.mode&&(r.uint32(56),r.uint32(t.mode)),null!=t.mtime&&(r.uint32(66),h.codec().encode(t.mtime,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={blocksizes:[]},i=null==r?t.len:t.pos+r;for(;t.pos<i;){const r=t.uint32();switch(r>>>3){case 1:n.Type=e.DataType.codec().decode(t);break;case 2:n.Data=t.bytes();break;case 3:n.filesize=t.uint64();break;case 4:n.blocksizes.push(t.uint64());break;case 5:n.hashType=t.uint64();break;case 6:n.fanout=t.uint64();break;case 7:n.mode=t.uint32();break;case 8:n.mtime=h.codec().decode(t,t.uint32());break;default:t.skipType(7&r)}}return n}))),n),e.encode=t=>(0,p.mH)(t,e.codec()),e.decode=t=>(0,p.Y8)(t,e.codec())}(l||(l={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,p.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Seconds=e.int64();break;case 2:r.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,p.mH)(t,e.codec()),e.decode=t=>(0,p.Y8)(t,e.codec())}(h||(h={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,p.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.MimeType=e.string();else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,p.mH)(t,e.codec()),e.decode=t=>(0,p.Y8)(t,e.codec())}(d||(d={}));const y={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},g=["directory","hamt-sharded-directory"],m=parseInt("0644",8),b=parseInt("0755",8);class w{static unmarshal(e){const t=l.decode(e),r=new w({type:y[null!=t.Type?t.Type.toString():"File"],data:t.Data,blockSizes:t.blocksizes,mode:t.mode,mtime:null!=t.mtime?{secs:t.mtime.Seconds??0n,nsecs:t.mtime.FractionalNanoseconds}:void 0,fanout:t.fanout});return r._originalMode=t.mode??0,r}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(e={type:"file"}){const{type:t,data:r,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(null!=t&&!Object.values(y).includes(t))throw i(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t??"file",this.data=r,this.hashType=s,this.fanout=o,this.blockSizes=n??[],this._originalMode=0,this.mode=c,this.mtime=a}set mode(e){this._mode=null==e?this.isDirectory()?b:m:4095&e}get mode(){return this._mode}isDirectory(){return g.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach((t=>{e+=t})),null!=this.data&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=l.DataType.Raw;break;case"directory":e=l.DataType.Directory;break;case"file":e=l.DataType.File;break;case"metadata":e=l.DataType.Metadata;break;case"symlink":e=l.DataType.Symlink;break;case"hamt-sharded-directory":e=l.DataType.HAMTShard;break;default:throw i(new Error(`Type: ${e} is not valid`),"ERR_INVALID_TYPE")}let t,r,n=this.data;return null!=this.data&&0!==this.data.length||(n=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(this.mode??0),t!==m||this.isDirectory()||(t=void 0),t===b&&this.isDirectory()&&(t=void 0)),null!=this.mtime&&(r={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),l.encode({Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r})}}const v=new Uint8Array(0),_=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):v},E=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},S="raw",x=85,A=e=>E(e),k=e=>E(e);var I=r(55433);var T=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class P{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class C{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return O(this,e)}}class R{constructor(e){this.decoders=e}or(e){return O(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const O=(e,t)=>new R({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class D{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new P(e,t,r),this.decoder=new C(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const B=({name:e,prefix:t,encode:r,decode:n})=>new D(e,t,r,n),N=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=T(r,t);return B({prefix:e,name:t,encode:n,decode:e=>E(i(e))})},M=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>B({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),U=M({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),L=(M({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),M({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),M({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),M({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),M({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),M({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),M({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),N({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));N({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var j=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=$;)r[n++]=255&t|F,t/=128;for(;t&z;)r[n++]=255&t|F,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},F=128,z=-128,$=Math.pow(2,31);var K=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&q)<<s:(n&q)*Math.pow(2,s),s+=7}while(n>=V);return e.bytes=o-r,i},V=128,q=127;var W=Math.pow(2,7),H=Math.pow(2,14),G=Math.pow(2,21),J=Math.pow(2,28),Y=Math.pow(2,35),Z=Math.pow(2,42),X=Math.pow(2,49),Q=Math.pow(2,56),ee=Math.pow(2,63),te={encode:j,decode:K,encodingLength:function(e){return e<W?1:e<H?2:e<G?3:e<J?4:e<Y?5:e<Z?6:e<X?7:e<Q?8:e<ee?9:10}};const re=(e,t=0)=>[te.decode(e,t),te.decode.bytes],ne=(e,t,r=0)=>(te.encode(e,t,r),t),ie=e=>te.encodingLength(e),se=(e,t)=>{const r=t.byteLength,n=ie(e),i=n+ie(r),s=new Uint8Array(i+r);return ne(e,s,0),ne(r,s,n),s.set(t,i),new ae(e,r,t,s)},oe=e=>{const t=E(e),[r,n]=re(t),[i,s]=re(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new ae(r,i,o,t)};class ae{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const ce=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?fe(r,le(e),t||L.encoder):pe(r,le(e),t||U.encoder)},ue=new WeakMap,le=e=>{const t=ue.get(e);if(null==t){const t=new Map;return ue.set(e,t),t}return t};class he{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==ye)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ge)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return he.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=se(e,t);return he.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return he.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return ce(this,e)}toJSON(){return{"/":ce(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof he)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new he(e,r,n,i||me(e,r,n.bytes))}if(!0===t[be]){const{version:e,multihash:r,code:n}=t,i=oe(r);return he.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==ye)throw new Error(`Version 0 CID must use dag-pb (code: ${ye}) block encoding`);return new he(e,t,r,r.bytes);case 1:{const n=me(e,t,r.bytes);return new he(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return he.create(0,ye,e)}static createV1(e,t){return he.create(1,e,t)}static decode(e){const[t,r]=he.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=he.inspectBytes(e),r=t.size-t.multihashSize,n=E(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new ae(t.multihashCode,t.digestSize,i,n);return[0===t.version?he.createV0(s):he.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=re(e.subarray(t));return t+=n,r};let n=r(),i=ye;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=de(e,t),i=he.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return le(i).set(r,e),i}}const de=(e,t)=>{switch(e[0]){case"Q":{const r=t||L;return[L.prefix,r.decode(`${L.prefix}${e}`)]}case L.prefix:{const r=t||L;return[L.prefix,r.decode(e)]}case U.prefix:{const r=t||U;return[U.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},fe=(e,t,r)=>{const{prefix:n}=r;if(n!==L.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},pe=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},ye=112,ge=18,me=(e,t,r)=>{const n=ie(e),i=n+ie(t),s=new Uint8Array(i+r.byteLength);return ne(e,s,0),ne(t,s,n),s.set(r,i),s},be=Symbol.for("@ipld/js-cid/CID"),we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?se(this.code,t):t.then((e=>se(this.code,e)))}throw Error("Unknown type, must be binary type")}}const _e=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ee=we({name:"sha2-256",code:18,encode:_e("SHA-256")}),Se=(we({name:"sha2-512",code:19,encode:_e("SHA-512")}),async(e,t,r)=>{null==r.codec&&(r.codec=f);const n=await Ee.digest(e),i=he.create(r.cidVersion,r.codec.code,n);return await t.put(i,e,r),i});function xe(e){return async function*(t,r){let i=0n;for await(let s of t.content)yield async()=>{let o;const a={codec:f,cidVersion:e.cidVersion,onProgress:e.onProgress};e.rawLeaves?(a.codec=n,a.cidVersion=1):(o=new w({type:e.leafType,data:s}),s=f.encode({Data:o.marshal(),Links:[]}));const c=await Se(s,r,a);return i+=BigInt(s.byteLength),e.onProgress?.(new I.j("unixfs:importer:progress:file:write",{bytesWritten:i,cid:c,path:t.path})),{cid:c,unixfs:o,size:BigInt(s.length),block:s}}}}const Ae=async(e,t,r)=>{const n=new w({type:"directory",mtime:e.mtime,mode:e.mode}),i=(0,f.encode)((0,f.prepare)({Data:n.marshal()}));return{cid:await Se(i,t,r),path:e.path,unixfs:n,size:BigInt(i.length),originalPath:e.originalPath,block:i}};function ke(e){return!0===e.single}const Ie=async(e,t,r)=>r.layout(async function*(e,t,r){let n,i=-1;for await(const s of a(r.bufferImporter(e,t),r.blockWriteConcurrency))i++,0!==i?(1===i&&null!=n&&(yield{...n,block:void 0,single:void 0},n=void 0),yield{...s,block:void 0}):n={...s,single:!0};null!=n&&(yield n)}(e,t,r),((e,t,r)=>async function(n){if(1===n.length&&ke(n[0])&&r.reduceSingleLeafToSelf){const i=n[0];let s=i.block;return!ke(i)||void 0===e.mtime&&void 0===e.mode||(i.unixfs=new w({type:"file",mtime:e.mtime,mode:e.mode,data:i.block}),s={Data:i.unixfs.marshal(),Links:[]},i.block=(0,f.encode)((0,f.prepare)(s)),i.cid=await Se(i.block,t,{...r,cidVersion:r.cidVersion}),i.size=BigInt(i.block.length)),r.onProgress?.(new I.j("unixfs:importer:progress:file:layout",{cid:i.cid,path:i.originalPath})),{cid:i.cid,path:e.path,unixfs:i.unixfs,size:i.size,originalPath:i.originalPath}}const i=new w({type:"file",mtime:e.mtime,mode:e.mode}),s=n.filter((e=>e.cid.code===x&&e.size>0||null!=e.unixfs&&null==e.unixfs.data&&e.unixfs.fileSize()>0n||Boolean(e.unixfs?.data?.length))).map((e=>e.cid.code===x?(i.addBlockSize(e.size),{Name:"",Tsize:Number(e.size),Hash:e.cid}):(null==e.unixfs||null==e.unixfs.data?i.addBlockSize(e.unixfs?.fileSize()??0n):i.addBlockSize(BigInt(e.unixfs.data.length)),{Name:"",Tsize:Number(e.size),Hash:e.cid}))),o={Data:i.marshal(),Links:s},a=(0,f.encode)((0,f.prepare)(o)),c=await Se(a,t,r);return r.onProgress?.(new I.j("unixfs:importer:progress:file:layout",{cid:c,path:e.originalPath})),{cid:c,path:e.path,unixfs:i,size:BigInt(a.length+o.Links.reduce(((e,t)=>e+(t.Tsize??0)),0)),originalPath:e.originalPath,block:a}})(e,t,r));function Te(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(t=e,Symbol.iterator in t)return async function*(){yield*e}();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch{throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function Pe(e){return null!=e.content}var Ce=r(16676);const Re=()=>async function*(e){for await(const t of e){if(void 0===t.length)throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof t||t instanceof String)yield(0,Ce.s)(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}},Oe=174;function De(e){const t=e?.maxChildrenPerNode??Oe;return async function e(r,n){const i=[];for await(const e of o(r,t))i.push(await n(e));return i.length>1?e(i,n):i[0]}}class Be{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(e,t){this.options=t??{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}const Ne=he.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Me=he.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");class Ue extends Be{_children;constructor(e,t){super(e,t),this._children=new Map}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(e,t)}async get(e){return Promise.resolve(this._children.get(e))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(const[e,t]of this._children.entries())yield{key:e,child:t}}estimateNodeSize(){if(void 0!==this.nodeSize)return this.nodeSize;this.nodeSize=0;for(const[e,t]of this._children.entries())null!=t.size&&null!=t.cid&&(this.nodeSize+=e.length+(1===this.options.cidVersion?Me.bytes.byteLength:Ne.bytes.byteLength));return this.nodeSize}async*flush(e){const t=[];for(const[r,n]of this._children.entries()){let i=n;if(n instanceof Be)for await(const t of n.flush(e))i=t,yield t;null!=i.size&&null!=i.cid&&t.push({Name:r,Tsize:Number(i.size),Hash:i.cid})}const r=new w({type:"directory",mtime:this.mtime,mode:this.mode}),n={Data:r.marshal(),Links:t},i=(0,f.encode)((0,f.prepare)(n)),s=await Se(i,e,this.options),o=i.length+n.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=s,this.size=o,yield{cid:s,unixfs:r,path:this.path,size:BigInt(o)}}}const Le=new Uint8Array(0),je=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):Le},Fe=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var ze=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=Ve;)r[n++]=255&t|$e,t/=128;for(;t&Ke;)r[n++]=255&t|$e,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},$e=128,Ke=-128,Ve=Math.pow(2,31);var qe=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&He)<<s:(n&He)*Math.pow(2,s),s+=7}while(n>=We);return e.bytes=o-r,i},We=128,He=127;var Ge=Math.pow(2,7),Je=Math.pow(2,14),Ye=Math.pow(2,21),Ze=Math.pow(2,28),Xe=Math.pow(2,35),Qe=Math.pow(2,42),et=Math.pow(2,49),tt=Math.pow(2,56),rt=Math.pow(2,63),nt={encode:ze,decode:qe,encodingLength:function(e){return e<Ge?1:e<Je?2:e<Ye?3:e<Ze?4:e<Xe?5:e<Qe?6:e<et?7:e<tt?8:e<rt?9:10}};const it=(e,t,r=0)=>(nt.encode(e,t,r),t),st=e=>nt.encodingLength(e),ot=(e,t)=>{const r=t.byteLength,n=st(e),i=n+st(r),s=new Uint8Array(i+r);return it(e,s,0),it(r,s,n),s.set(t,i),new at(e,r,t,s)};class at{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const ct=({name:e,code:t,encode:r})=>new ut(e,t,r);class ut{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ot(this.code,t):t.then((e=>ot(this.code,e)))}throw Error("Unknown type, must be binary type")}}var lt=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class ht{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class dt{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return pt(this,e)}}class ft{constructor(e){this.decoders=e}or(e){return pt(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pt=(e,t)=>new ft({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class yt{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ht(e,t,r),this.decoder=new dt(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gt=({name:e,prefix:t,encode:r,decode:n})=>new yt(e,t,r,n),mt=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=lt(r,t);return gt({prefix:e,name:t,encode:n,decode:e=>Fe(i(e))})},bt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>gt({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)});mt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap;class wt{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return wt.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=ot(e,t);return wt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return wt.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return cid_format(this,e)}toJSON(){return{"/":cid_format(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof wt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new wt(e,r,n,i||cid_encodeCID(e,r,n.bytes))}if(!0===t[cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=(e=>{const t=Fe(e),[r,n]=multiformats_src_varint_decode(t),[i,s]=multiformats_src_varint_decode(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new at(r,i,o,t)})(r);return wt.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${cid_DAG_PB_CODE}) block encoding`);return new wt(e,t,r,r.bytes);case 1:{const n=cid_encodeCID(e,t,r.bytes);return new wt(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return wt.create(0,cid_DAG_PB_CODE,e)}static createV1(e,t){return wt.create(1,e,t)}static decode(e){const[t,r]=wt.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=wt.inspectBytes(e),r=t.size-t.multihashSize,n=Fe(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new at(t.multihashCode,t.digestSize,i,n);return[0===t.version?wt.createV0(s):wt.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=multiformats_src_varint_decode(e.subarray(t));return n,r};let n=r(),i=cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=cid_parseCIDtoBytes(e,t),i=wt.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");var vt=r(38437);ct({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(vt.x86.hash32(e))});const _t=ct({name:"murmur3-128",code:34,encode:e=>je(vt.x64.hash128(e))});ct({name:"murmur3-x64-64",code:34,encode:e=>je(vt.x64.hash128(e)).subarray(0,8)});var Et=r(16324);async function St(e){return(await _t.encode(e)).slice(0,8).reverse()}const xt=BigInt(34);var At=class extends Be{_bucket;constructor(e,t){super(e,t),this._bucket=(0,Et.T)({hashFn:St,bits:t.shardFanoutBits??8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=It(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of kt(this._bucket,e,this,this.options))yield{...t,path:this.path}}};async function*kt(e,t,r,n){const i=e._children,s=(e.tableSize()-1).toString(16).length,o=[];let a=0n;for(let e=0;e<i.length;e++){const r=i.get(e);if(null==r)continue;const c=e.toString(16).toUpperCase().padStart(s,"0");if(r instanceof Et.f){let e;for await(const i of kt(r,t,null,n))e=i;if(null==e)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:c,Tsize:Number(e.size),Hash:e.cid}),a+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;if(null==n)throw new Error("Did not flush dir");const i=c+r.key;o.push({Name:i,Tsize:Number(n.size),Hash:n.cid}),a+=n.size}else{const e=r.value;if(null==e.cid)continue;const t=c+r.key,n=e.size;o.push({Name:t,Tsize:Number(n),Hash:e.cid}),a+=BigInt(n??0)}}const c=Uint8Array.from(i.bitField().reverse()),u=new w({type:"hamt-sharded-directory",data:c,fanout:BigInt(e.tableSize()),hashType:xt,mtime:r?.mtime,mode:r?.mode}),l={Data:u.marshal(),Links:o},h=(0,f.encode)((0,f.prepare)(l)),d=await Se(h,t,n),p=BigInt(h.byteLength)+a;yield{cid:d,unixfs:u,size:p}}function It(e,t,r){const n=e._children,i=(e.tableSize()-1).toString(16).length,s=[];for(let e=0;e<n.length;e++){const t=n.get(e);if(null==t)continue;const o=e.toString(16).toUpperCase().padStart(i,"0");if(t instanceof Et.f){const e=It(t,null,r);s.push({Name:o,Tsize:Number(e),Hash:0===r.cidVersion?Ne:Me})}else if("function"==typeof t.value.flush){const e=t.value.nodeSize();s.push({Name:o+t.key,Tsize:Number(e),Hash:0===r.cidVersion?Ne:Me})}else{const e=t.value;if(null==e.cid)continue;const r=o+t.key,n=e.size;s.push({Name:r,Tsize:Number(n),Hash:e.cid})}}const o=Uint8Array.from(n.bitField().reverse()),a=new w({type:"hamt-sharded-directory",data:o,fanout:BigInt(e.tableSize()),hashType:xt,mtime:t?.mtime,mode:t?.mode});return(0,f.encode)((0,f.prepare)({Data:a.marshal(),Links:s})).length}async function Tt(e,t,r,n){let i=t;t instanceof Ue&&t.estimateNodeSize()>r&&(i=await async function(e,t){const r=new At({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:t,child:n}of e.eachChildSeries())await r.put(t,n);return r}(t,n));const s=i.parent;if(null!=s){if(i!==t){if(null!=e&&(e.parent=i),null==i.parentKey)throw new Error("No parent key found");await s.put(i.parentKey,i)}return Tt(i,s,r,n)}return i}const Pt=(e="")=>e.split(/(?<!\\)\//).filter(Boolean);async function Ct(e,t,r){const n=Pt(e.path??""),i=n.length-1;let s=t,o="";for(let a=0;a<n.length;a++){const c=n[a];o+=`${""!==o?"/":""}${c}`;const u=a===i;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,e),t=await Tt(null,s,r.shardSplitThresholdBytes,r);else{let e=await s.get(c);null!=e&&e instanceof Be||(e=new Ue({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:e?.unixfs?.mtime,mode:e?.unixfs?.mode},r)),await s.put(c,e),s=e}}return t}async function*Rt(e,t){e instanceof Be?yield*e.flush(t):!0===e.unixfs?.isDirectory()&&(yield e)}async function*Ot(e,t,r={}){let n;n=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];const i=r.wrapWithDirectory??!1,s=r.shardSplitThresholdBytes??262144,o=r.shardFanoutBits??8,c=r.cidVersion??1,l=r.rawLeaves??!0,h=r.leafType??"file",d=r.fileImportConcurrency??50,f=r.blockWriteConcurrency??10,p=r.reduceSingleLeafToSelf??!0,y=r.chunker??u(),g=r.chunkValidator??Re(),m=r.dagBuilder??function(e){return async function*(t,r){for await(const n of t){let t;if(null!=n.path&&(t=n.path,n.path=n.path.split("/").filter((e=>null!=e&&"."!==e)).join("/")),Pe(n)){const i={path:n.path,mtime:n.mtime,mode:n.mode,content:async function*(){let t=0n;for await(const r of e.chunker(e.chunkValidator(Te(n.content)))){const i=BigInt(r.byteLength);t+=i,e.onProgress?.(new I.j("unixfs:importer:progress:file:read",{bytesRead:t,chunkSize:i,path:n.path})),yield r}}(),originalPath:t};yield async()=>Ie(i,r,e)}else{if(null==n.path)throw new Error("Import candidate must have content or path or both");{const i={path:n.path,mtime:n.mtime,mode:n.mode,originalPath:t};yield async()=>Ae(i,r,e)}}}}}({chunker:y,chunkValidator:g,wrapWithDirectory:i,layout:r.layout??De(),bufferImporter:r.bufferImporter??xe({cidVersion:c,rawLeaves:l,leafType:h,onProgress:r.onProgress}),blockWriteConcurrency:f,reduceSingleLeafToSelf:p,cidVersion:c,onProgress:r.onProgress}),b=r.treeBuilder??function(e){return async function*(t,r){let n,i=new Ue({root:!0,dir:!0,path:"",dirty:!0,flat:!0},e),s=!1;for await(const r of t){if(null==r)continue;const t=`${r.originalPath??""}`.split("/")[0];null!=t&&""!==t&&(null==n?(n=t,s=!0):n!==t&&(s=!1)),i=await Ct(r,i,e),null!=r.unixfs&&r.unixfs.isDirectory()||(yield r)}if(e.wrapWithDirectory||s&&i.childCount()>1)yield*Rt(i,r);else for await(const e of i.eachChildSeries())null!=e&&(yield*Rt(e.child,r))}}({wrapWithDirectory:i,shardSplitThresholdBytes:s,shardFanoutBits:o,cidVersion:c,onProgress:r.onProgress});for await(const e of b(a(m(n,t),d),t))yield{cid:e.cid,path:e.path,unixfs:e.unixfs,size:e.size}}async function Dt(e,t,r={}){const n=await s(Ot([e],t,r));if(null==n)throw i(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}r(76561);const Bt={cidVersion:1,rawLeaves:!0,layout:De({maxChildrenPerNode:1024}),chunker:u({chunkSize:1048576})};async function Nt(e,t,r={}){const{cid:n}=await async function(e,t,r={}){return Dt({content:e},t,r)}(e,t,{...Bt,...r});return n}async function Mt(e,t,r={}){const{cid:n}=await async function(e,t,r={}){return Dt({content:e},t,r)}(e,t,{...Bt,...r});return n}async function Ut(e,t,r={}){const{cid:n}=await async function(e,t,r={}){const n=await s(Ot([e],t,r));if(null==n)throw i(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}({...e,path:e.path??"-"},t,{...Bt,...r});return n}var Lt=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t;for await(const r of e)t=r;return t})();let t;for(const r of e)t=r;return t},jt=r(74868);const Ft=0;var zt=async(e,t,r,n,s,o,a,c)=>{const u=await a.get(e,c),l=jt.decode(u);let h=l,d=r;for(;n.length>0;){const s=n[0];if(!(s in h))throw i(new Error(`No property named ${s} found in cbor node ${e}`),"ERR_NO_PROP");{n.shift(),d=`${d}/${s}`;const i=he.asCID(h[s]);if(null!=i)return{entry:{type:"object",name:t,path:r,cid:e,node:u,depth:o,size:BigInt(u.length),content:async function*(){yield l}},next:{cid:i,name:s,path:d,toResolve:n}};h=h[s]}}return{entry:{type:"object",name:t,path:r,cid:e,node:u,depth:o,size:BigInt(u.length),content:async function*(){yield l}}}};var $t=function(e,t,r,n){const i=BigInt(e.length),s=BigInt(t+i);return r>=s||n<t?new Uint8Array(0):(n>=t&&n<s&&(e=e.subarray(0,Number(n-t))),r>=t&&r<s&&(e=e.subarray(Number(r-t))),e)};var Kt=(e,t=0,r=e)=>{const n=BigInt(e),s=BigInt(t??0);let o=BigInt(r);if(o!==n&&(o=s+o),o>n&&(o=n),s<0n)throw i(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(s>n)throw i(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(o<0n)throw i(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(o>n)throw i(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:s,end:o}};var Vt=async(e,t,r,n,s,o,a,c)=>{if(n.length>0)throw i(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const u=oe(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:(l=u.digest,async function*(e={}){const{start:t,end:r}=Kt(l.length,e.offset,e.length),n=$t(l,0n,t,r);e.onProgress?.(new I.j("unixfs:exporter:progress:identity",{bytesRead:BigInt(n.byteLength),totalBytes:r-t,fileSize:BigInt(l.byteLength)})),yield n}),depth:o,size:BigInt(u.digest.length),node:u.digest}};var l};var qt=async(e,t,r,n,s,o,a,c)=>{if(n.length>0)throw i(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const u=await a.get(e,c);return{entry:{type:"raw",name:t,path:r,cid:e,content:(l=u,async function*(e={}){const{start:t,end:r}=Kt(l.length,e.offset,e.length),n=$t(l,0n,t,r);e.onProgress?.(new I.j("unixfs:exporter:progress:raw",{bytesRead:BigInt(n.byteLength),totalBytes:r-t,fileSize:BigInt(l.byteLength)})),yield n}),depth:o,size:BigInt(u.length),node:u}};var l};const Wt=new Uint8Array(0),Ht=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):Wt},Gt=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var Jt=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=Xt;)r[n++]=255&t|Yt,t/=128;for(;t&Zt;)r[n++]=255&t|Yt,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Yt=128,Zt=-128,Xt=Math.pow(2,31);var Qt=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&tr)<<s:(n&tr)*Math.pow(2,s),s+=7}while(n>=er);return e.bytes=o-r,i},er=128,tr=127;var rr=Math.pow(2,7),nr=Math.pow(2,14),ir=Math.pow(2,21),sr=Math.pow(2,28),or=Math.pow(2,35),ar=Math.pow(2,42),cr=Math.pow(2,49),ur=Math.pow(2,56),lr=Math.pow(2,63),hr={encode:Jt,decode:Qt,encodingLength:function(e){return e<rr?1:e<nr?2:e<ir?3:e<sr?4:e<or?5:e<ar?6:e<cr?7:e<ur?8:e<lr?9:10}};const dr=(e,t,r=0)=>(hr.encode(e,t,r),t),fr=e=>hr.encodingLength(e),pr=(e,t)=>{const r=t.byteLength,n=fr(e),i=n+fr(r),s=new Uint8Array(i+r);return dr(e,s,0),dr(r,s,n),s.set(t,i),new yr(e,r,t,s)};class yr{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const gr=({name:e,code:t,encode:r})=>new mr(e,t,r);class mr{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?pr(this.code,t):t.then((e=>pr(this.code,e)))}throw Error("Unknown type, must be binary type")}}var br=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class wr{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vr{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Er(this,e)}}class _r{constructor(e){this.decoders=e}or(e){return Er(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Er=(e,t)=>new _r({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Sr{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new wr(e,t,r),this.decoder=new vr(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xr=({name:e,prefix:t,encode:r,decode:n})=>new Sr(e,t,r,n),Ar=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=br(r,t);return xr({prefix:e,name:t,encode:n,decode:e=>Gt(i(e))})},kr=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>xr({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)});Ar({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ar({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),kr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),kr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap;class Ir{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ir.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=pr(e,t);return Ir.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ir.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return src_cid_format(this,e)}toJSON(){return{"/":src_cid_format(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ir)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Ir(e,r,n,i||src_cid_encodeCID(e,r,n.bytes))}if(!0===t[src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=(e=>{const t=Gt(e),[r,n]=node_modules_multiformats_src_varint_decode(t),[i,s]=node_modules_multiformats_src_varint_decode(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new yr(r,i,o,t)})(r);return Ir.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${src_cid_DAG_PB_CODE}) block encoding`);return new Ir(e,t,r,r.bytes);case 1:{const n=src_cid_encodeCID(e,t,r.bytes);return new Ir(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ir.create(0,src_cid_DAG_PB_CODE,e)}static createV1(e,t){return Ir.create(1,e,t)}static decode(e){const[t,r]=Ir.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ir.inspectBytes(e),r=t.size-t.multihashSize,n=Gt(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new yr(t.multihashCode,t.digestSize,i,n);return[0===t.version?Ir.createV0(s):Ir.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=node_modules_multiformats_src_varint_decode(e.subarray(t));return n,r};let n=r(),i=src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=src_cid_parseCIDtoBytes(e,t),i=Ir.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");gr({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(vt.x86.hash32(e))});const Tr=gr({name:"murmur3-128",code:34,encode:e=>Ht(vt.x64.hash128(e))}),Pr=(gr({name:"murmur3-x64-64",code:34,encode:e=>Ht(vt.x64.hash128(e)).subarray(0,8)}),async function(e){return(await Tr.encode(e)).slice(0,8).reverse()}),Cr=(e,t)=>e.toString(16).toUpperCase().padStart(t,"0").substring(0,t),Rr=async(e,t,r,n,s)=>{if(null==n){if(null==e.Data)throw i(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let t;try{t=w.unmarshal(e.Data)}catch(e){throw i(e,"ERR_NOT_UNIXFS")}if("hamt-sharded-directory"!==t.type)throw i(new Error("not a HAMT"),"ERR_NOT_UNIXFS");if(null==t.fanout)throw i(new Error("missing fanout"),"ERR_NOT_UNIXFS");const r=(0,Et.T)({hashFn:Pr,bits:Math.log2(Number(t.fanout))});n={rootBucket:r,hamtDepth:1,lastBucket:r}}const o=(n.lastBucket.tableSize()-1).toString(16).length;await(async(e,t,r)=>{const n=(t.tableSize()-1).toString(16).length;await Promise.all(e.map((async e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(e.Name.length!==n)await r.put(e.Name.substring(2),!0);else{const n=parseInt(e.Name,16);t._putObjectAt(n,new Et.f({hash:r._options.hash,bits:r._options.bits},t,n))}})))})(e.Links,n.lastBucket,n.rootBucket);const a=await n.rootBucket._findNewBucketAndPos(t);let c=Cr(a.pos,o);const u=(e=>{let t=e.bucket;const r=[];for(;null!=t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()})(a);u.length>n.hamtDepth&&(n.lastBucket=u[n.hamtDepth],c=Cr(n.lastBucket._posAtParent,o));const l=e.Links.find((e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,o),n=e.Name.substring(o);return r===c&&(""===n||n===t)}));if(null==l)return;if(null!=l.Name&&l.Name.substring(o)===t)return l.Hash;n.hamtDepth++;const h=await r.get(l.Hash,s);return e=(0,f.decode)(h),Rr(e,t,r,n,s)};var Or=Rr,Dr=r(97101);var Br=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r)&&(yield r)}();const r=(0,Dr.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s.then)return async function*(){await s&&(yield n);for await(const e of r)await t(e)&&(yield e)}();const o=t;return function*(){!0===s&&(yield n);for(const e of r)o(e)&&(yield e)}()};var Nr=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)yield t(r)}();const r=(0,Dr.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s.then)return async function*(){yield await s;for await(const e of r)yield t(e)}();const o=t;return function*(){yield s;for(const e of r)yield o(e)}()},Mr=r(48209),Ur=r(81033);var Lr=(e,t,r,n,i,s,o)=>async function*(r={}){const a=r.offset??0,c=r.length??t.Links.length,u=t.Links.slice(a,c);r.onProgress?.(new I.j("unixfs:exporter:walk:directory",{cid:e})),yield*(0,Ur.F)(u,(e=>Nr(e,(e=>async()=>{const t=e.Name??"",a=`${n}/${t}`;return(await i(e.Hash,t,a,[],s+1,o,r)).entry}))),(e=>(0,Mr.A)(e,{ordered:!0})),(e=>Br(e,(e=>null!=e))))},jr=r(48651),Fr=r(84665);async function zr(e,t,r,n,s,o,a){if(t instanceof Uint8Array){const e=$t(t,n,s,o);return void r.push(e)}if(null==t.Data)throw i(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let c;try{c=w.unmarshal(t.Data)}catch(e){throw i(e,"ERR_NOT_UNIXFS")}if(null!=c.data){const e=c.data,t=$t(e,n,s,o);r.push(t),n+=BigInt(t.byteLength)}const u=[];if(t.Links.length!==c.blockSizes.length)throw i(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let e=0;e<t.Links.length;e++){const r=t.Links[e],i=n,a=i+c.blockSizes[e];if((s>=i&&s<a||o>=i&&o<=a||s<i&&o>a)&&u.push({link:r,blockStart:n}),(n=a)>o)break}await(0,Ur.F)(u,(t=>Nr(t,(t=>async()=>{const r=await e.get(t.link.Hash,a);return{...t,block:r}}))),(e=>(0,Mr.A)(e,{ordered:!0})),(async t=>{for await(const{link:n,block:c,blockStart:u}of t){let t;switch(n.Hash.code){case f.code:t=f.decode(c);break;case x:t=c;break;default:return void r.end(i(new Error(`Unsupported codec: ${n.Hash.code}`),"ERR_NOT_UNIXFS"))}const l=new Fr.A({concurrency:1});l.on("error",(e=>{r.end(e)})),l.add((async()=>{a.onProgress?.(new I.j("unixfs:exporter:walk:file",{cid:n.Hash})),await zr(e,t,r,u,s,o,a)})),await l.onIdle()}})),n>=o&&r.end()}var $r=(e,t,r,n,s,o,a)=>async function*(n={}){const s=r.fileSize();if(void 0===s)throw new Error("File was a directory");const{start:o,end:c}=Kt(s,n.offset,n.length);if(0n===c)return;let u=0n;const l=c-o,h=(0,jr.N)();n.onProgress?.(new I.j("unixfs:exporter:walk:file",{cid:e})),zr(a,t,h,0n,o,c,n).catch((e=>{h.end(e)}));for await(const e of h)if(null!=e){if(u+=BigInt(e.byteLength),u>l)throw h.end(),i(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");u===l&&h.end(),n.onProgress?.(new I.j("unixfs:exporter:progress:unixfs:file",{bytesRead:u,totalBytes:l,fileSize:s})),yield e}if(u<l)throw i(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")};async function*Kr(e,t,r,n,s,o){const a=e.Links;if(null==e.Data)throw i(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let c;try{c=w.unmarshal(e.Data)}catch(e){throw i(e,"ERR_NOT_UNIXFS")}if(null==c.fanout)throw i(new Error("missing fanout"),"ERR_NOT_UNIXFS");const u=(c.fanout-1n).toString(16).length,l=(0,Ur.F)(a,(i=>Nr(i,(i=>async()=>{const a=null!=i.Name?i.Name.substring(u):null;if(null!=a&&""!==a){const e=await r(i.Hash,a,`${t}/${a}`,[],n+1,s,o);return{entries:null==e.entry?[]:[e.entry]}}{const a=await s.get(i.Hash,o);return e=(0,f.decode)(a),o.onProgress?.(new I.j("unixfs:exporter:walk:hamt-sharded-directory",{cid:i.Hash})),{entries:Kr(e,t,r,n,s,o)}}}))),(e=>(0,Mr.A)(e,{ordered:!0})));for await(const{entries:e}of l)yield*e}var Vr=(e,t,r,n,i,s,o)=>function(r={}){return r.onProgress?.(new I.j("unixfs:exporter:walk:hamt-sharded-directory",{cid:e})),Kr(t,n,i,s,o,r)};const qr={raw:$r,file:$r,directory:Lr,"hamt-sharded-directory":Vr,metadata:(e,t,r,n,i,s,o)=>()=>[],symlink:(e,t,r,n,i,s,o)=>()=>[]};var Wr=async(e,t,r,n,s,o,a,c)=>{const u=await a.get(e,c),l=(0,f.decode)(u);let h,d;if(null==t&&(t=e.toString()),null==l.Data)throw i(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{h=w.unmarshal(l.Data)}catch(e){throw i(e,"ERR_NOT_UNIXFS")}if(null==r&&(r=t),n.length>0){let e;if(e="hamt-sharded-directory"===h?.type?await Or(l,n[0],a):((e,t)=>{const r=e.Links.find((e=>e.Name===t));return r?.Hash})(l,n[0]),null==e)throw i(new Error("file does not exist"),"ERR_NOT_FOUND");const t=n.shift();d={cid:e,toResolve:n,name:t??"",path:`${r}/${t}`}}const p=qr[h.type](e,l,h,r,s,o,a);if(null==p)throw i(new Error("could not find content exporter"),"ERR_NOT_FOUND");return h.isDirectory()?{entry:{type:"directory",name:t,path:r,cid:e,content:p,unixfs:h,depth:o,node:l,size:h.fileSize()},next:d}:{entry:{type:"file",name:t,path:r,cid:e,content:p,unixfs:h,depth:o,node:l,size:h.fileSize()},next:d}};const Hr={[f.code]:Wr,[x]:qt,[jt.code]:zt,[Ft]:Vt},Gr=async(e,t,r,n,s,o,a)=>{const c=Hr[e.code];if(null==c)throw i(new Error(`No resolver for code ${e.code}`),"ERR_NO_RESOLVER");return c(e,t,r,n,Gr,s,o,a)};var Jr=Gr;const Yr=e=>{if(e instanceof Uint8Array)return{cid:he.decode(e),toResolve:[]};const t=he.asCID(e);if(null!=t)return{cid:t,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=((e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean))(e);return{cid:he.parse(t[0]),toResolve:t.slice(1)}}throw i(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function Zr(e,t,r={}){const n=await Lt(async function*(e,t,r={}){let{cid:n,toResolve:s}=Yr(e),o=n.toString(),a=o;const c=s.length;for(;;){const u=await Jr(n,o,a,s,c,t,r);if(null==u.entry&&null==u.next)throw i(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(null!=u.entry&&(yield u.entry),null==u.next)return;s=u.next.toResolve,n=u.next.cid,o=u.next.name,a=u.next.path}}(e,t,r));if(null==n)throw i(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return n}async function*Xr(e,t,r={}){const n=await Zr(e,t,r);if(null!=n&&(yield n,"directory"===n.type))for await(const e of async function*e(t,r){for await(const n of t.content(r))yield n,n instanceof Uint8Array||"directory"===n.type&&(yield*e(n,r))}(n,r))yield e}var Qr=r(5027);class en extends Error{name;code;constructor(e,t,r){super(e),this.name=t,this.code=r}}class tn extends en{constructor(e="not a Unixfs node"){super(e,"NotUnixFSError","ERR_NOT_UNIXFS")}}class rn extends en{constructor(e="invalid PBNode"){super(e,"InvalidPBNodeError","ERR_INVALID_PBNODE")}}class nn extends en{constructor(e="unknown error"){super(e,"InvalidPBNodeError","ERR_UNKNOWN_ERROR")}}class sn extends en{constructor(e="path already exists"){super(e,"AlreadyExistsError","ERR_ALREADY_EXISTS")}}class on extends en{constructor(e="path does not exist"){super(e,"DoesNotExistError","ERR_DOES_NOT_EXIST")}}class an extends en{constructor(e="no content"){super(e,"NoContentError","ERR_NO_CONTENT")}}class cn extends en{constructor(e="not a file"){super(e,"NotAFileError","ERR_NOT_A_FILE")}}class un extends en{constructor(e="not a directory"){super(e,"NotADirectoryError","ERR_NOT_A_DIRECTORY")}}class ln extends en{constructor(e="invalid parameters"){super(e,"InvalidParametersError","ERR_INVALID_PARAMETERS")}}var hn=r(17833);const dn=M({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});M({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),M({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),M({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function fn(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return hn.enabled(`${e}:trace`)&&null!=hn.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=hn(`${e}:trace`)),Object.assign(hn(e),{error:hn(`${e}:error`),trace:t})}hn.formatters.b=e=>null==e?"undefined":L.baseEncode(e),hn.formatters.t=e=>null==e?"undefined":U.baseEncode(e),hn.formatters.m=e=>null==e?"undefined":dn.baseEncode(e),hn.formatters.p=e=>null==e?"undefined":e.toString(),hn.formatters.c=e=>null==e?"undefined":e.toString(),hn.formatters.k=e=>null==e?"undefined":e.toString(),hn.formatters.a=e=>null==e?"undefined":e.toString();var pn=r(52669),yn=r(44008);function gn(e){return function(t){return t instanceof mn?t:new mn(t,e)}}class mn{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?(0,yn.x)([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new vn(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}const bn=[255,254,252,248,240,224,192,128],wn=[1,3,7,15,31,63,127,255];class vn{_value;_currentBytePos;_currentBitPos;constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+_n(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function _n(e,t,r){const n=function(e,t){return bn[e]&wn[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}we({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(vt.x86.hash32(e))});const En=we({name:"murmur3-128",code:34,encode:e=>_(vt.x64.hash128(e))}),Sn=(we({name:"murmur3-x64-64",code:34,encode:e=>_(vt.x64.hash128(e)).subarray(0,8)}),BigInt(En.code));async function xn(e){return(await En.encode(e)).subarray(0,8).reverse()}const An=async(e,t,r)=>{null==r.codec&&(r.codec=f);const n=await Ee.digest(e),i=he.create(r.cidVersion,r.codec.code,n);return await t.put(i,e,{...r,signal:r.signal}),i};class kn{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(e,t){this.options=t??{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}class In extends kn{_bucket;constructor(e,t){super(e,t),this._bucket=(0,Et.T)({hashFn:xn,bits:8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=Pn(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of Tn(this._bucket,e,this,this.options))yield{...t,path:this.path}}}async function*Tn(e,t,r,n){const i=e._children,s=[];let o=0n;for(let e=0;e<i.length;e++){const r=i.get(e);if(null==r)continue;const a=e.toString(16).toUpperCase().padStart(2,"0");if(r instanceof Et.f){let e;for await(const i of Tn(r,t,null,n))e=i;if(null==e)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:a,Tsize:Number(e.size),Hash:e.cid}),o+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;if(null==n)throw new Error("Did not flush dir");const i=a+r.key;s.push({Name:i,Tsize:Number(n.size),Hash:n.cid}),o+=n.size}else{const e=r.value;if(null==e.cid)continue;const t=a+r.key,n=e.size;s.push({Name:t,Tsize:Number(n),Hash:e.cid}),o+=BigInt(n??0)}}const a=Uint8Array.from(i.bitField().reverse()),c=new w({type:"hamt-sharded-directory",data:a,fanout:BigInt(e.tableSize()),hashType:Sn,mtime:r?.mtime,mode:r?.mode}),u={Data:c.marshal(),Links:s},l=(0,f.encode)((0,f.prepare)(u)),h=await An(l,t,n),d=BigInt(l.byteLength)+o;yield{cid:h,unixfs:c,size:d}}function Pn(e,t,r){const n=e._children,i=[];for(let e=0;e<n.length;e++){const t=n.get(e);if(null==t)continue;const s=e.toString(16).toUpperCase().padStart(2,"0");if(t instanceof Et.f){const e=Pn(t,null,r);i.push({Name:s,Tsize:Number(e),Hash:0===r.cidVersion?Cn:Rn})}else if("function"==typeof t.value.flush){const e=t.value.nodeSize();i.push({Name:s+t.key,Tsize:Number(e),Hash:0===r.cidVersion?Cn:Rn})}else{const e=t.value;if(null==e.cid)continue;const r=s+t.key,n=e.size;i.push({Name:r,Tsize:Number(n),Hash:e.cid})}}const s=Uint8Array.from(n.bitField().reverse()),o=new w({type:"hamt-sharded-directory",data:s,fanout:BigInt(e.tableSize()),hashType:Sn,mtime:t?.mtime,mode:t?.mode});return(0,f.encode)((0,f.prepare)({Data:o.marshal(),Links:i})).length}const Cn=he.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Rn=he.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),On=fn("helia:unixfs:commands:utils:hamt-utils"),Dn=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),Bn=async(e,t,r)=>{const n=w.unmarshal(e[0].node.Data??new Uint8Array(0)),i=BigInt(Math.pow(2,8));let s,o;e.reverse();for(let a=0;a<e.length;a++){const c=a===e.length-1,u=e[a],l=Uint8Array.from(u.children.bitField().reverse()),h=new w({type:"hamt-sharded-directory",data:l,fanout:i,hashType:Sn});c&&(h.mtime=n.mtime,h.mode=n.mode),o={Data:h.marshal(),Links:u.node.Links};const d=f.encode(f.prepare(o));if(s=await An(d,t,r),!c){const t=e[a+1];if(null==t)throw new Error("Was not operating on shard root but also had no parent?");On("updating link in parent sub-shard with prefix %s",t.prefix),t.node.Links=t.node.Links.filter((e=>e.Name!==t.prefix)),t.node.Links.push({Name:t.prefix,Hash:s,Tsize:u.node.Links.reduce(((e,t)=>e+(t.Tsize??0)),d.byteLength)})}}if(null==s||null==o)throw new Error("Noting persisted");return{cid:s,node:o}},Nn=async(e,t,r,n)=>{const i=gn(xn)((0,Ce.s)(t)),s=[];for(;;){const o=await r.get(e,n),a=f.decode(o),c=new pn,u=await i.take(8),l=Dn(u);let h;s.push({prefix:l,children:c,node:a});for(const e of a.Links){const t=e.Name??"";if(t.length<2)throw new Error("Invalid HAMT - link name was too short");const r=parseInt(t.substring(0,2),16);c.set(r,!0),t.startsWith(l)&&(h=e)}if(null==h){On("no link found with prefix %s for %s",l,t);break}const d=h.Name??"";if(d.length<2)throw new Error("Invalid HAMT - link name was too short");if(2!==d.length)break;e=h.Hash,On("descend into sub-shard with prefix %s",d)}return{path:s,hash:i}};async function Mn(e,t,r,n){if(null==e.Data)throw new Error("DagPB node had no data");const i=w.unmarshal(e.Data);let s;if("directory"===i.type)s=function(e){let t=0;for(const r of e.Links)t+=(r.Name??"").length,t+=1===r.Hash.version?Rn.bytes.byteLength:Cn.bytes.byteLength;return t}(e);else{if("hamt-sharded-directory"!==i.type)throw new Error("Can only estimate the size of directories or shards");s=await Un(e,0,r,t,n)}return s>r}async function Un(e,t,r,n,i){if(t>r)return r;if(null==e.Data)return t;if(!w.unmarshal(e.Data).isDirectory())return t;for(const s of e.Links){let e=s.Name??"";if(e=e.substring(2),t+=e.length,t+=s.Hash.bytes.byteLength,s.Hash.code===f.code){const e=await n.get(s.Hash,i),o=f.decode(e);t+=await Un(o,t,r,n,i)}}return t}const Ln=fn("helia:unixfs:components:utils:add-link");async function jn(e,t,r,n){if(null==e.node.Data)throw new ln("Invalid parent passed to addLink");if("hamt-sharded-directory"===w.unmarshal(e.node.Data).type)return Ln("adding link to sharded directory"),$n(e,t,r,n);Ln(`adding ${t.Name} (${t.Hash}) to regular directory`);const i=await zn(e,t,r,n);if(await Mn(i.node,r,n.shardSplitThresholdBytes,n)){Ln("converting directory to sharded directory");const e=await Fn(i,r);i.cid=e.cid,i.node=f.decode(await r.get(e.cid,n))}return i}const Fn=async(e,t)=>{if(null==e.node.Data)throw new ln("Invalid parent passed to convertToShardedDirectory");const r=w.unmarshal(e.node.Data),n=await(async(e,t,r)=>{const n=new In({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let e=0;e<t.length;e++)await n._bucket.put(t[e].name,{size:t[e].size,cid:t[e].cid});const i=await Lt(n.flush(e));if(null==i)throw new Error("Flushing shard yielded no result");return i})(t,e.node.Links.map((e=>({name:e.Name??"",size:BigInt(e.Tsize??0),cid:e.Hash}))),{mode:r.mode,mtime:r.mtime,cidVersion:e.cid.version});return Ln(`converted directory to sharded directory ${n.cid}`),n},zn=async(e,t,r,n)=>{const i=e.node.Links.filter((e=>{const r=e.Name===t.Name;if(r&&!n.allowOverwriting)throw new sn;return!r}));if(i.push(t),null==e.node.Data)throw new rn("Parent node with no data passed to addToDirectory");const s=w.unmarshal(e.node.Data);let o;if(null!=s.mtime){const e=Date.now(),t=Math.floor(e/1e3);s.mtime={secs:BigInt(t),nsecs:1e3*(e-1e3*t)},o=s.marshal()}else o=e.node.Data;e.node=f.prepare({Data:o,Links:i});const a=f.encode(e.node),c=await Ee.digest(a),u=he.create(e.cid.version,f.code,c);return await r.put(u,a),{node:e.node,cid:u}},$n=async(e,t,r,n)=>{const{path:i,hash:s}=await Nn(e.cid,t.Name,r,n),o=i[i.length-1];if(null==o)throw new Error("Invalid HAMT, could not generate path");const a=o.prefix,c=parseInt(a,16);Ln("next prefix for %s is %s",t.Name,a);const u=`${a}${t.Name}`,l=o.node.Links.find((e=>(e.Name??"").startsWith(a)));if(null!=l)if(Ln("link %s was present in shard",u),l.Name===u){if(!n.allowOverwriting)throw new sn;Ln("overwriting %s in subshard",t.Name),o.node.Links=o.node.Links.filter((e=>e.Name!==u)),o.node.Links.push({Name:u,Hash:t.Hash,Tsize:t.Tsize})}else{if(2===l.Name?.length)throw new Error("Existing link was subshard?!");{Ln("prefix %s already exists, creating new subshard",a);const e=o.node.Links.findIndex((e=>e.Name?.startsWith(a))),r=o.node.Links.splice(e,1)[0],n=(r.Name??"").substring(2),c=gn(xn)((0,Ce.s)(n));for(let e=0;e<i.length;e++)await c.take(8);for(;;){const e=await c.take(8),o=Dn(e);r.Name=`${o}${n}`;const u=await s.take(8),l=Dn(u);if(o===l){const e=new pn;e.set(u,!0),i.push({prefix:l,children:e,node:{Links:[]}});continue}const h=new pn;h.set(u,!0),h.set(e,!0),i.push({prefix:a,children:h,node:{Links:[r,{Name:`${l}${t.Name}`,Hash:t.Hash,Tsize:t.Tsize}]}});break}}}else Ln("link %s was not present in sub-shard",u),t.Name=u,o.node.Links.push(t),o.children.set(c,!0),Ln("adding %s to existing sub-shard",u);return Bn(i,r,n)};async function Kn(e,t,r={}){const n=await Zr(e,t,r);if("directory"!==n.type)throw new un(`${e.toString()} was not a UnixFS directory`);return{cid:e,node:n.node}}async function Vn(e,t,r,n){const i=await Zr(e,r,n);if("directory"!==i.type&&"file"!==i.type&&"raw"!==i.type)throw new tn(`${e.toString()} was not a UnixFS node`);return{Name:t,Tsize:i.node instanceof Uint8Array?i.node.byteLength:qn(i.node),Hash:e}}function qn(e){const t=e.Links.reduce(((e,t)=>e+(t.Tsize??0)),0);return f.encode(e).byteLength+t}const Wn=fn("helia:unixfs:components:utils:resolve");async function Hn(e,t,r,n){if(null==t||""===t)return{cid:e};Wn('resolve "%s" under %c',t,e);const i=t.split("/").filter(Boolean),s=[{name:"",cid:e,size:0n}];for(let t=0;t<i.length;t++){const o=i[t],a=await Zr(e,r,n);if(Wn('resolving "%s"',o,a),"file"===a.type){if(t<i.length-1)throw new ln("Path was invalid");e=a.cid}else{if("directory"!==a.type)throw new ln("Could not resolve path");{let t;for await(const e of a.content())if(e.name===o){t=e.cid;break}if(null==t)throw new on("Could not find path in directory");e=t,s.push({name:o,cid:e,size:a.size})}}}return Wn("resolved %s to %c",t,e),{cid:e,path:t,segments:s}}async function Gn(e,t,r,n){if(null==t.segments||0===t.segments.length)return e;let i=t.segments.pop();if(null==i)throw new Error("Insufficient segments");i.cid=e,t.segments.reverse();for(const s of t.segments){const[t,o]=await Promise.all([Kn(s.cid,r,n),Vn(i.cid,i.name,r,n)]);e=(await jn(t,o,r,{...n,allowOverwriting:!0,cidVersion:e.version})).cid,s.cid=e,i=s}return e}const Jn=Qr.A.bind({ignoreUndefined:!0}),Yn={};const Zn=262144,Xn=Qr.A.bind({ignoreUndefined:!0}),Qn=fn("helia:unixfs:chmod"),ei={recursive:!1,shardSplitThresholdBytes:Zn};const ti=Qr.A.bind({ignoreUndefined:!0}),ri=fn("helia:unixfs:cp"),ni={force:!1,shardSplitThresholdBytes:Zn};const ii=Qr.A.bind({ignoreUndefined:!0}),si={};const oi=Qr.A.bind({ignoreUndefined:!0}),ai=fn("helia:unixfs:mkdir"),ci={cidVersion:1,force:!1,shardSplitThresholdBytes:Zn};const ui=fn("helia:unixfs:utils:remove-link");const li=async(e,t,r,n)=>{e.node.Links=e.node.Links.filter((e=>e.Name!==t));const i=f.encode(e.node),s=await An(i,r,{...n,cidVersion:e.cid.version});return ui(`Updated regular directory ${s}`),{node:e.node,cid:s}},hi=async(e,t,r,n)=>{const{path:i}=await Nn(e.cid,t,r,n),s=i[i.length-1];if(null==s)throw new Error("Invalid HAMT, could not generate path");const o=s.node.Links.filter((e=>(e.Name??"").substring(2)===t)).map((e=>e.Name)).pop();if(null==o)throw new Error("File not found");const a=o.substring(0,2),c=parseInt(a,16);if(s.node.Links=s.node.Links.filter((e=>e.Name!==o)),s.children.unset(c),1===s.node.Links.length)for(;1!==i.length;){const e=i[i.length-1];if(null==e||e.node.Links.length>1)break;i.pop();const t=i[i.length-1];if(null==t)break;const r=e.node.Links[0];t.node.Links=t.node.Links.filter((e=>!(e.Name??"").startsWith(t.prefix))),t.node.Links.push({Hash:r.Hash,Name:`${t.prefix}${(r.Name??"").substring(2)}`,Tsize:r.Tsize})}return Bn(i,r,n)},di=async(e,t,r)=>{if(null==e.node.Data)throw new ln("Invalid parent passed to convertToFlatDirectory");const n={Links:[]},i=await Zr(e.cid,t);if("directory"!==i.type)throw new Error("Unexpected node type");for await(const e of i.content()){let t=0;t=e.node instanceof Uint8Array?e.node.byteLength:f.encode(e.node).length,n.Links.push({Hash:e.cid,Name:e.name,Tsize:t})}const s=w.unmarshal(e.node.Data);n.Data=new w({type:"directory",mode:s.mode,mtime:s.mtime}).marshal();const o=f.encode(f.prepare(n));return{cid:await An(o,t,{codec:f,cidVersion:e.cid.version,signal:r.signal}),node:n}},fi=Qr.A.bind({ignoreUndefined:!0}),pi=fn("helia:unixfs:rm"),yi={shardSplitThresholdBytes:Zn};async function gi(e,t,r,n={}){const i=fi(yi,n);if(t.includes("/"))throw new ln("Name must not have slashes");const s=await Kn(e,r,i);pi("Removing %s from %c",t,e);const o=await async function(e,t,r,n){if(null==e.node.Data)throw new rn("Parent node had no data");if("hamt-sharded-directory"===w.unmarshal(e.node.Data).type){ui(`removing ${t} from sharded directory`);const i=await hi(e,t,r,n);return await Mn(i.node,r,n.shardSplitThresholdBytes,n)?i:(ui("converting shard to flat directory %c",e.cid),di(i,r,n))}return ui(`removing link ${t} regular directory`),li(e,t,r,n)}(s,t,r,{...i,cidVersion:e.version});return o.cid}const mi=Qr.A.bind({ignoreUndefined:!0}),bi=fn("helia:unixfs:stat"),wi={};async function vi(e,t,r={}){const n=mi(wi,r),i=await Hn(e,r.path,t,n);bi("stat %c",i.cid);const s=await Zr(i.cid,t,n);if("file"!==s.type&&"directory"!==s.type&&"raw"!==s.type)throw new tn;let o,a,c=0n,u=0n,l=0n,h=0n,d=0;const f=s.type;let p;if("raw"===s.type&&(c=BigInt(s.node.byteLength),u=BigInt(s.node.byteLength),l=BigInt(s.node.byteLength),h=BigInt(s.node.byteLength),d=1),"directory"===s.type&&(c=0n,u=BigInt(s.unixfs.marshal().byteLength),l=0n,h=u,d=1,o=s.unixfs.mode,a=s.unixfs.mtime,p=s.unixfs),"file"===s.type){const e=await _i(i.cid,t,n);c=s.unixfs.fileSize(),u=BigInt((s.node.Data?.byteLength??0)+s.node.Links.reduce(((e,t)=>e+(t.Tsize??0)),0)),l=BigInt(e.localFileSize),h=BigInt(e.localDagSize),d=e.blocks,o=s.unixfs.mode,a=s.unixfs.mtime,p=s.unixfs}return{cid:i.cid,mode:o,mtime:a,fileSize:c,dagSize:u,localFileSize:l,localDagSize:h,blocks:d,type:f,unixfs:p}}async function _i(e,t,r){const n={localFileSize:0,localDagSize:0,blocks:0};if(await t.has(e,r)){const i=await t.get(e,r);if(n.blocks++,n.localDagSize+=i.byteLength,e.code===x)n.localFileSize+=i.byteLength;else{if(e.code!==f.code)throw new nn(`${e.toString()} was neither DAG_PB nor RAW`);{const s=f.decode(i);if(s.Links.length>0)for(const e of s.Links){const i=await _i(e.Hash,t,r);n.localFileSize+=i.localFileSize,n.localDagSize+=i.localDagSize,n.blocks+=i.blocks}else{if(null==s.Data)throw new rn(`PBNode ${e.toString()} had no data`);const t=w.unmarshal(s.Data);if(null==t.data)throw new rn(`UnixFS node ${e.toString()} had no data`);n.localFileSize+=t.data.byteLength??0}}}}return n}const Ei=Qr.A.bind({ignoreUndefined:!0}),Si=fn("helia:unixfs:touch"),xi={recursive:!1,shardSplitThresholdBytes:Zn};r(9712);class Ai{components;constructor(e){this.components=e}async*addAll(e,t={}){yield*async function*(e,t,r={}){yield*Ot(e,t,{...Bt,...r})}(e,this.components.blockstore,t)}async addBytes(e,t={}){return Nt(e,this.components.blockstore,t)}async addByteStream(e,t={}){return Mt(e,this.components.blockstore,t)}async addFile(e,t={}){return async function(e,t,r={}){const{cid:n}=await Dt(e,t,{...Bt,...r});return n}(e,this.components.blockstore,t)}async addDirectory(e={},t={}){return Ut(e,this.components.blockstore,t)}async*cat(e,t={}){yield*async function*(e,t,r={}){const n=Jn(Yn,r),i=await Hn(e,n.path,t,n),s=await Zr(i.cid,t,n);if("file"!==s.type&&"raw"!==s.type)throw new cn;if(null==s.content)throw new an;yield*s.content(n)}(e,this.components.blockstore,t)}async chmod(e,t,r={}){return async function(e,t,r,n={}){const i=Xn(ei,n),s=await Hn(e,i.path,r,n);if(Qn("chmod %c %d",s.cid,t),i.recursive){const o=await(0,Ur.F)((async function*(){for await(const e of Xr(s.cid,r,n)){let r,n=[];if("raw"===e.type)r=new w({type:"file",data:e.node});else{if("file"!==e.type&&"directory"!==e.type)throw new tn;r=e.unixfs,n=e.node.Links}r.mode=t;const i={Data:r.marshal(),Links:n};yield{path:e.path,content:i}}}),(t=>Ot(t,r,{...i,dagBuilder:async function*(t,r){for await(const n of t)yield async function(){const t=n.content,s=f.encode(t),o=await An(s,r,{...i,cidVersion:e.version});if(null==t.Data)throw new rn(`${o} had no data`);const a=w.unmarshal(t.Data);return{cid:o,size:BigInt(s.length),path:n.path,unixfs:a}}}})),(async e=>Lt(e)));if(null==o)throw new nn(`Could not chmod ${s.cid.toString()}`);return Gn(o.cid,s,r,i)}const o=await r.get(s.cid,n);let a,c=[];if(s.cid.code===x)a=new w({type:"file",data:o});else{const e=f.decode(o);if(null==e.Data)throw new rn(`${s.cid.toString()} had no data`);c=e.Links,a=w.unmarshal(e.Data)}a.mode=t;const u=f.encode({Data:a.marshal(),Links:c}),l=await Ee.digest(u),h=he.create(s.cid.version,f.code,l);return await r.put(h,u),Gn(h,s,r,i)}(e,t,this.components.blockstore,r)}async cp(e,t,r,n={}){return async function(e,t,r,n,i={}){const s=ti(ni,i);if(r.includes("/"))throw new ln("Name must not have slashes");const[o,a]=await Promise.all([Kn(t,n,s),Vn(e,r,n,s)]);return ri('Adding %c as "%s" to %c',e,r,t),(await jn(o,a,n,{allowOverwriting:s.force,cidVersion:t.version,...s})).cid}(e,t,r,this.components.blockstore,n)}async*ls(e,t={}){yield*async function*(e,t,r={}){const n=ii(si,r),i=await Hn(e,n.path,t,n),s=await Zr(i.cid,t);if("file"!==s.type&&"raw"!==s.type){if(null==s.content)throw new an;if("directory"!==s.type)throw new un;yield*s.content({offset:r.offset,length:r.length})}else yield s}(e,this.components.blockstore,t)}async mkdir(e,t,r={}){return async function(e,t,r,n={}){const i=oi(ci,n);if(t.includes("/"))throw new ln("Path must not have slashes");if("directory"!==(await Zr(e,r,n)).type)throw new un(`${e.toString()} was not a UnixFS directory`);ai("creating %s",t);const s={Data:new w({type:"directory",mode:i.mode,mtime:i.mtime}).marshal(),Links:[]},o=f.encode(s),a=await Ee.digest(o),c=he.create(i.cidVersion,f.code,a);await r.put(c,o);const[u,l]=await Promise.all([Kn(e,r,i),Vn(c,t,r,i)]);return ai("adding empty dir called %s to %c",t,e),(await jn(u,l,r,{...i,allowOverwriting:i.force})).cid}(e,t,this.components.blockstore,r)}async rm(e,t,r={}){return gi(e,t,this.components.blockstore,r)}async stat(e,t={}){return vi(e,this.components.blockstore,t)}async touch(e,t={}){return async function(e,t,r={}){const n=Ei(xi,r),i=await Hn(e,n.path,t,n),s=n.mtime??{secs:BigInt(Math.round(Date.now()/1e3)),nsecs:0};if(Si("touch %c %o",i.cid,s),n.recursive){const r=await(0,Ur.F)((async function*(){for await(const e of Xr(i.cid,t)){let t,r;if("raw"===e.type)t=new w({data:e.node}),r=[];else{if("file"!==e.type&&"directory"!==e.type)throw new tn;t=e.unixfs,r=e.node.Links}t.mtime=s;const n={Data:t.marshal(),Links:r};yield{path:e.path,content:n}}}),(r=>Ot(r,t,{...n,dagBuilder:async function*(t,r){for await(const i of t)yield async function(){const t=i.content,s=f.encode(t),o=await An(s,r,{...n,cidVersion:e.version});if(null==t.Data)throw new rn(`${o} had no data`);const a=w.unmarshal(t.Data);return{cid:o,size:BigInt(s.length),path:i.path,unixfs:a}}}})),(async e=>Lt(e)));if(null==r)throw new nn(`Could not chmod ${i.cid.toString()}`);return Gn(r.cid,i,t,n)}const o=await t.get(i.cid,r);let a,c=[];if(i.cid.code===x)a=new w({data:o});else{const e=f.decode(o);if(c=e.Links,null==e.Data)throw new rn(`${i.cid.toString()} had no data`);a=w.unmarshal(e.Data)}a.mtime=s;const u=f.encode({Data:a.marshal(),Links:c}),l=await Ee.digest(u),h=he.create(i.cid.version,f.code,l);return await t.put(h,u),Gn(h,i,t,n)}(e,this.components.blockstore,t)}}function ki(e){return new Ai(e)}},23674:function(e,t,r){"use strict";r.d(t,{Bj:function(){return G}});var n=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator"}),i=Object.freeze({set:n.Set,for:n.For,in:n.In,is:n.Is,if:n.If,else:n.Else,endif:n.EndIf,elif:n.ElseIf,endfor:n.EndFor,and:n.And,or:n.Or,not:n.Not,"not in":n.NotIn,true:n.BooleanLiteral,false:n.BooleanLiteral}),s=class{constructor(e,t){this.value=e,this.type=t}};function o(e){return/\w/.test(e)}function a(e){return/[0-9]/.test(e)}var c=[["{%",n.OpenStatement],["%}",n.CloseStatement],["{{",n.OpenExpression],["}}",n.CloseExpression],["(",n.OpenParen],[")",n.CloseParen],["{",n.OpenCurlyBracket],["}",n.CloseCurlyBracket],["[",n.OpenSquareBracket],["]",n.CloseSquareBracket],[",",n.Comma],[".",n.Dot],[":",n.Colon],["|",n.Pipe],["<=",n.ComparisonBinaryOperator],[">=",n.ComparisonBinaryOperator],["==",n.ComparisonBinaryOperator],["!=",n.ComparisonBinaryOperator],["<",n.ComparisonBinaryOperator],[">",n.ComparisonBinaryOperator],["+",n.AdditiveBinaryOperator],["-",n.AdditiveBinaryOperator],["*",n.MultiplicativeBinaryOperator],["/",n.MultiplicativeBinaryOperator],["%",n.MultiplicativeBinaryOperator],["=",n.Equals]],u=new Map([["n","\n"],["t","\t"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);var l=class{type="Statement"},h=class extends l{constructor(e){super(),this.body=e}type="Program"},d=class extends l{constructor(e,t,r){super(),this.test=e,this.body=t,this.alternate=r}type="If"},f=class extends l{constructor(e,t,r){super(),this.loopvar=e,this.iterable=t,this.body=r}type="For"},p=class extends l{constructor(e,t){super(),this.assignee=e,this.value=t}type="Set"},y=class extends l{type="Expression"},g=class extends y{constructor(e,t,r){super(),this.object=e,this.property=t,this.computed=r}type="MemberExpression"},m=class extends y{constructor(e,t){super(),this.callee=e,this.args=t}type="CallExpression"},b=class extends y{constructor(e){super(),this.value=e}type="Identifier"},w=class extends y{constructor(e){super(),this.value=e}type="Literal"},v=class extends w{type="NumericLiteral"},_=class extends w{type="StringLiteral"},E=class extends w{type="BooleanLiteral"},S=class extends w{type="ArrayLiteral"},x=class extends w{type="TupleLiteral"},A=class extends w{type="ObjectLiteral"},k=class extends y{constructor(e,t,r){super(),this.operator=e,this.left=t,this.right=r}type="BinaryExpression"},I=class extends y{constructor(e,t){super(),this.operand=e,this.filter=t}type="FilterExpression"},T=class extends y{constructor(e,t,r){super(),this.operand=e,this.negate=t,this.test=r}type="TestExpression"},P=class extends y{constructor(e,t){super(),this.operator=e,this.argument=t}type="UnaryExpression"},C=class extends y{constructor(e=undefined,t=undefined,r=undefined){super(),this.start=e,this.stop=t,this.step=r}type="SliceExpression"},R=class extends y{constructor(e,t){super(),this.key=e,this.value=t}type="KeywordArgumentExpression"};function O(e){const t=new h([]);let r=0;function i(t,n){const i=e[r++];if(!i||i.type!==t)throw new Error(`Parser Error: ${n}. ${i.type} !== ${t}.`);return i}function s(){switch(e[r].type){case n.Text:return new _(i(n.Text,"Expected text token").value);case n.OpenStatement:return function(){let t;switch(i(n.OpenStatement,"Expected opening statement token"),e[r].type){case n.Set:++r,t=c(),i(n.CloseStatement,"Expected closing statement token");break;case n.If:++r,t=u(),i(n.OpenStatement,"Expected {% token"),i(n.EndIf,"Expected endif token"),i(n.CloseStatement,"Expected %} token");break;case n.For:++r,t=function(){const e=l(!0);if(!(e instanceof b||e instanceof x))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${e.type} instead`);i(n.In,"Expected `in` keyword following loop variable");const t=y();i(n.CloseStatement,"Expected closing statement token");const r=[];for(;o(n.OpenStatement,n.EndFor);)r.push(s());return new f(e,t,r)}(),i(n.OpenStatement,"Expected {% token"),i(n.EndFor,"Expected endfor token"),i(n.CloseStatement,"Expected %} token");break;default:throw new SyntaxError(`Unknown statement type: ${e[r].type}`)}return t}();case n.OpenExpression:return function(){i(n.OpenExpression,"Expected opening expression token");const e=y();return i(n.CloseExpression,"Expected closing expression token"),e}();default:throw new SyntaxError(`Unexpected token type: ${e[r].type}`)}}function o(...t){return r+t.length<=e.length&&t.some(((t,n)=>t!==e[r+n].type))}function a(...t){return r+t.length<=e.length&&t.every(((t,n)=>t===e[r+n].type))}function c(){const e=y();if(a(n.Equals)){++r;const t=c();return new p(e,t)}return e}function u(){const t=y();i(n.CloseStatement,"Expected closing statement token");const o=[],c=[];for(;e[r]?.type!==n.OpenStatement||e[r+1]?.type!==n.ElseIf&&e[r+1]?.type!==n.Else&&e[r+1]?.type!==n.EndIf;)o.push(s());if(e[r]?.type===n.OpenStatement&&e[r+1]?.type!==n.EndIf)if(++r,a(n.ElseIf))i(n.ElseIf,"Expected elseif token"),c.push(u());else for(i(n.Else,"Expected else token"),i(n.CloseStatement,"Expected closing statement token");e[r]?.type!==n.OpenStatement||e[r+1]?.type!==n.EndIf;)c.push(s());return new d(t,o,c)}function l(e=!1){const t=e?F:y,i=[t()],s=a(n.Comma);for(;s&&(++r,i.push(t()),a(n.Comma)););return s?new x(i):i[0]}function y(){return function(){const e=w();if(a(n.If)){++r;const t=w();i(n.Else,"Expected else token");const s=w();return new d(t,[e],[s])}return e}()}function w(){let t=O();for(;a(n.Or);){const n=e[r];++r;const i=O();t=new k(n,t,i)}return t}function O(){let t=D();for(;a(n.And);){const n=e[r];++r;const i=D();t=new k(n,t,i)}return t}function D(){let t;for(;a(n.Not);){const n=e[r];++r;const i=D();t=new P(n,i)}return t??function(){let t=B();for(;a(n.ComparisonBinaryOperator)||a(n.In)||a(n.NotIn);){const n=e[r];++r;const i=B();t=new k(n,t,i)}return t}()}function B(){let t=L();for(;a(n.AdditiveBinaryOperator);){const n=e[r];++r;const i=L();t=new k(n,t,i)}return t}function N(){const t=function(){let t=F();for(;a(n.Dot)||a(n.OpenSquareBracket);){const s=e[r];let o;++r;const a=s.type!==n.Dot;if(a)o=U(),i(n.CloseSquareBracket,"Expected closing square bracket");else if(o=F(),"Identifier"!==o.type)throw new SyntaxError("Expected identifier following dot operator");t=new g(t,o,a)}return t}();return a(n.OpenParen)?M(t):t}function M(e){let t=new m(e,function(){i(n.OpenParen,"Expected opening parenthesis for arguments list");const e=function(){const e=[];for(;!a(n.CloseParen);){let t=y();if(a(n.Equals)){if(++r,!(t instanceof b))throw new SyntaxError("Expected identifier for keyword argument");const e=y();t=new R(t,e)}e.push(t),a(n.Comma)&&++r}return e}();return i(n.CloseParen,"Expected closing parenthesis for arguments list"),e}());return a(n.OpenParen)&&(t=M(t)),t}function U(){const e=[];let t=!1;for(;!a(n.CloseSquareBracket);)a(n.Colon)?(e.push(void 0),++r,t=!0):(e.push(y()),a(n.Colon)&&(++r,t=!0));if(0===e.length)throw new SyntaxError("Expected at least one argument for member/slice expression");if(t){if(e.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new C(...e)}return e[0]}function L(){let t=j();for(;a(n.MultiplicativeBinaryOperator);){const n=e[r];++r;const i=j();t=new k(n,t,i)}return t}function j(){let e=function(){let e=N();for(;a(n.Pipe);){++r;let t=F();if(!(t instanceof b))throw new SyntaxError("Expected identifier for the filter");a(n.OpenParen)&&(t=M(t)),e=new I(e,t)}return e}();for(;a(n.Is);){++r;const t=a(n.Not);t&&++r;let i=F();if(i instanceof E&&(i=new b(i.value.toString())),!(i instanceof b))throw new SyntaxError("Expected identifier for the test");e=new T(e,t,i)}return e}function F(){const t=e[r];switch(t.type){case n.NumericLiteral:return++r,new v(Number(t.value));case n.StringLiteral:return++r,new _(t.value);case n.BooleanLiteral:return++r,new E("true"===t.value);case n.Identifier:return++r,new b(t.value);case n.OpenParen:{++r;const t=l();if(e[r].type!==n.CloseParen)throw new SyntaxError(`Expected closing parenthesis, got ${e[r].type} instead`);return++r,t}case n.OpenSquareBracket:{++r;const e=[];for(;!a(n.CloseSquareBracket);)e.push(y()),a(n.Comma)&&++r;return++r,new S(e)}case n.OpenCurlyBracket:{++r;const e=new Map;for(;!a(n.CloseCurlyBracket);){const t=y();i(n.Colon,"Expected colon between key and value in object literal");const s=y();e.set(t,s),a(n.Comma)&&++r}return++r,new A(e)}default:throw new SyntaxError(`Unexpected token: ${t.type}`)}}for(;r<e.length;)t.body.push(s());return t}function D(e,t,r=1){void 0===t&&(t=e,e=0);const n=[];for(let i=e;i<t;i+=r)n.push(i);return n}function B(e,t,r,n=1){const i=Math.sign(n);i>=0?(t=(t??=0)<0?Math.max(e.length+t,0):Math.min(t,e.length),r=(r??=e.length)<0?Math.max(e.length+r,0):Math.min(r,e.length)):(t=(t??=e.length-1)<0?Math.max(e.length+t,-1):Math.min(t,e.length-1),r=(r??=-1)<-1?Math.max(e.length+r,-1):Math.min(r,e.length-1));const s=[];for(let o=t;i*o<i*r;o+=n)s.push(e[o]);return s}function N(e){return e.replace(/\b\w/g,(e=>e.toUpperCase()))}var M=class{type="RuntimeValue";value;builtins=new Map;constructor(e=undefined){this.value=e}__bool__(){return new j(!!this.value)}},U=class extends M{type="NumericValue"},L=class extends M{type="StringValue";builtins=new Map([["upper",new K((()=>new L(this.value.toUpperCase())))],["lower",new K((()=>new L(this.value.toLowerCase())))],["strip",new K((()=>new L(this.value.trim())))],["title",new K((()=>new L(N(this.value))))],["length",new U(this.value.length)]])},j=class extends M{type="BooleanValue"},F=class extends M{type="ObjectValue";__bool__(){return new j(this.value.size>0)}builtins=new Map([["get",new K((([e,t])=>{if(!(e instanceof L))throw new Error(`Object key must be a string: got ${e.type}`);return this.value.get(e.value)??t??new V}))],["items",new K((()=>new z(Array.from(this.value.entries()).map((([e,t])=>new z([new L(e),t]))))))]])},z=class extends M{type="ArrayValue";builtins=new Map([["length",new U(this.value.length)]]);__bool__(){return new j(this.value.length>0)}},$=class extends z{type="TupleValue"},K=class extends M{type="FunctionValue"},V=class extends M{type="NullValue"},q=class extends M{type="UndefinedValue"},W=class{constructor(e){this.parent=e}variables=new Map([["namespace",new K((e=>{if(0===e.length)return new F(new Map);if(1!==e.length||!(e[0]instanceof F))throw new Error("`namespace` expects either zero arguments or a single object argument");return e[0]}))]]);tests=new Map([["boolean",e=>"BooleanValue"===e.type],["callable",e=>e instanceof K],["odd",e=>{if("NumericValue"!==e.type)throw new Error(`Cannot apply test "odd" to type: ${e.type}`);return e.value%2!=0}],["even",e=>{if("NumericValue"!==e.type)throw new Error(`Cannot apply test "even" to type: ${e.type}`);return e.value%2==0}],["false",e=>"BooleanValue"===e.type&&!e.value],["true",e=>"BooleanValue"===e.type&&e.value],["number",e=>"NumericValue"===e.type],["integer",e=>"NumericValue"===e.type&&Number.isInteger(e.value)],["iterable",e=>e instanceof z||e instanceof L],["lower",e=>{const t=e.value;return"StringValue"===e.type&&t===t.toLowerCase()}],["upper",e=>{const t=e.value;return"StringValue"===e.type&&t===t.toUpperCase()}],["none",e=>"NullValue"===e.type],["defined",e=>"UndefinedValue"!==e.type],["undefined",e=>"UndefinedValue"===e.type],["equalto",(e,t)=>e.value===t.value]]);set(e,t){return this.declareVariable(e,H(t))}declareVariable(e,t){if(this.variables.has(e))throw new SyntaxError(`Variable already declared: ${e}`);return this.variables.set(e,t),t}setVariable(e,t){return this.variables.set(e,t),t}resolve(e){if(this.variables.has(e))return this;if(this.parent)return this.parent.resolve(e);throw new Error(`Unknown variable: ${e}`)}lookupVariable(e){try{return this.resolve(e).variables.get(e)??new q}catch{return new q}}};function H(e){switch(typeof e){case"number":return new U(e);case"string":return new L(e);case"boolean":return new j(e);case"object":return null===e?new V:Array.isArray(e)?new z(e.map(H)):new F(new Map(Object.entries(e).map((([e,t])=>[e,H(t)]))));case"function":return new K(((t,r)=>H(e(...t.map((e=>e.value)))??null)));default:throw new Error(`Cannot convert to runtime value: ${e}`)}}var G=class{parsed;constructor(e){const t=function(e,t={}){const r=[],l=function(e,t={}){return e.endsWith("\n")&&(e=e.slice(0,-1)),e=e.replace(/{#.*?#}/gs,"{##}"),t.lstrip_blocks&&(e=e.replace(/^[ \t]*({[#%])/gm,"$1")),t.trim_blocks&&(e=e.replace(/([#%]})\n/g,"$1")),e.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}(e,t);let h=0;const d=e=>{let t="";for(;e(l[h]);)if("\\"!==l[h]){if(t+=l[h++],h>=l.length)throw new SyntaxError("Unexpected end of input")}else{if(++h,h>=l.length)throw new SyntaxError("Unexpected end of input");const e=l[h++],r=u.get(e);if(void 0===r)throw new SyntaxError(`Unexpected escaped character: ${e}`);t+=r}return t};e:for(;h<l.length;){const e=r.at(-1)?.type;if(void 0===e||e===n.CloseStatement||e===n.CloseExpression){let e="";for(;h<l.length&&("{"!==l[h]||"%"!==l[h+1]&&"{"!==l[h+1]);)e+=l[h++];if(e.length>0){r.push(new s(e,n.Text));continue}}d((e=>/\s/.test(e)));const t=l[h];if("-"===t||"+"===t){const e=r.at(-1)?.type;if(e===n.Text||void 0===e)throw new SyntaxError(`Unexpected character: ${t}`);switch(e){case n.Identifier:case n.NumericLiteral:case n.BooleanLiteral:case n.StringLiteral:case n.CloseParen:case n.CloseSquareBracket:break;default:{++h;const e=d(a);r.push(new s(`${t}${e}`,e.length>0?n.NumericLiteral:n.UnaryOperator));continue}}}for(const[e,t]of c)if(l.slice(h,h+e.length)===e){r.push(new s(e,t)),h+=e.length;continue e}if("'"!==t&&'"'!==t)if(a(t)){const e=d(a);r.push(new s(e,n.NumericLiteral))}else{if(!o(t))throw new SyntaxError(`Unexpected character: ${t}`);{const e=d(o),t=Object.hasOwn(i,e)?i[e]:n.Identifier;t===n.In&&r.at(-1)?.type===n.Not?(r.pop(),r.push(new s("not in",n.NotIn))):r.push(new s(e,t))}}else{++h;const e=d((e=>e!==t));r.push(new s(e,n.StringLiteral)),++h}}return r}(e,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=O(t)}render(e){const t=new W;t.set("false",!1),t.set("true",!0),t.set("raise_exception",(e=>{throw new Error(e)})),t.set("range",D);for(const[r,n]of Object.entries(e))t.set(r,n);const r=new class{global;constructor(e){this.global=e??new W}run(e){return this.evaluate(e,this.global)}evaluateBinaryExpression(e,t){const r=this.evaluate(e.left,t);switch(e.operator.value){case"and":return r.__bool__().value?this.evaluate(e.right,t):r;case"or":return r.__bool__().value?r:this.evaluate(e.right,t)}const n=this.evaluate(e.right,t);switch(e.operator.value){case"==":return new j(r.value==n.value);case"!=":return new j(r.value!=n.value)}if(r instanceof q||n instanceof q)throw new Error("Cannot perform operation on undefined values");if(r instanceof V||n instanceof V)throw new Error("Cannot perform operation on null values");if(r instanceof U&&n instanceof U)switch(e.operator.value){case"+":return new U(r.value+n.value);case"-":return new U(r.value-n.value);case"*":return new U(r.value*n.value);case"/":return new U(r.value/n.value);case"%":return new U(r.value%n.value);case"<":return new j(r.value<n.value);case">":return new j(r.value>n.value);case">=":return new j(r.value>=n.value);case"<=":return new j(r.value<=n.value)}else if(r instanceof z&&n instanceof z){if("+"===e.operator.value)return new z(r.value.concat(n.value))}else if(n instanceof z){const t=void 0!==n.value.find((e=>e.value===r.value));switch(e.operator.value){case"in":return new j(t);case"not in":return new j(!t)}}if((r instanceof L||n instanceof L)&&"+"===e.operator.value)return new L(r.value.toString()+n.value.toString());if(r instanceof L&&n instanceof L)switch(e.operator.value){case"in":return new j(n.value.includes(r.value));case"not in":return new j(!n.value.includes(r.value))}if(r instanceof L&&n instanceof F)switch(e.operator.value){case"in":return new j(n.value.has(r.value));case"not in":return new j(!n.value.has(r.value))}throw new SyntaxError(`Unknown operator "${e.operator.value}" between ${r.type} and ${n.type}`)}evaluateFilterExpression(e,t){const r=this.evaluate(e.operand,t);if("Identifier"===e.filter.type){const t=e.filter;if(r instanceof z)switch(t.value){case"list":return r;case"first":return r.value[0];case"last":return r.value[r.value.length-1];case"length":return new U(r.value.length);case"reverse":return new z(r.value.reverse());case"sort":return new z(r.value.sort(((e,t)=>{if(e.type!==t.type)throw new Error(`Cannot compare different types: ${e.type} and ${t.type}`);switch(e.type){case"NumericValue":return e.value-t.value;case"StringValue":return e.value.localeCompare(t.value);default:throw new Error(`Cannot compare type: ${e.type}`)}})));default:throw new Error(`Unknown ArrayValue filter: ${t.value}`)}else if(r instanceof L)switch(t.value){case"length":return new U(r.value.length);case"upper":return new L(r.value.toUpperCase());case"lower":return new L(r.value.toLowerCase());case"title":return new L(N(r.value));case"capitalize":return new L(r.value.charAt(0).toUpperCase()+r.value.slice(1));case"trim":return new L(r.value.trim());default:throw new Error(`Unknown StringValue filter: ${t.value}`)}else{if(r instanceof U){if("abs"===t.value)return new U(Math.abs(r.value));throw new Error(`Unknown NumericValue filter: ${t.value}`)}if(r instanceof F)switch(t.value){case"items":return new z(Array.from(r.value.entries()).map((([e,t])=>new z([new L(e),t]))));case"length":return new U(r.value.size);default:throw new Error(`Unknown ObjectValue filter: ${t.value}`)}}throw new Error(`Cannot apply filter "${t.value}" to type: ${r.type}`)}if("CallExpression"===e.filter.type){const n=e.filter;if("Identifier"!==n.callee.type)throw new Error(`Unknown filter: ${n.callee.type}`);const i=n.callee.value;if(r instanceof z){if("selectattr"===i){if(r.value.some((e=>!(e instanceof F))))throw new Error("`selectattr` can only be applied to array of objects");if(n.args.some((e=>"StringLiteral"!==e.type)))throw new Error("arguments of `selectattr` must be strings");const[e,i,s]=n.args.map((e=>this.evaluate(e,t)));let o;if(i){const e=t.tests.get(i.value);if(!e)throw new Error(`Unknown test: ${i.value}`);o=e}else o=(...e)=>e[0].__bool__().value;const a=r.value.filter((t=>{const r=t.value.get(e.value);return!!r&&o(r,s)}));return new z(a)}throw new Error(`Unknown ArrayValue filter: ${i}`)}throw new Error(`Cannot apply filter "${i}" to type: ${r.type}`)}throw new Error(`Unknown filter: ${e.filter.type}`)}evaluateTestExpression(e,t){const r=this.evaluate(e.operand,t),n=t.tests.get(e.test.value);if(!n)throw new Error(`Unknown test: ${e.test.value}`);const i=n(r);return new j(e.negate?!i:i)}evaluateUnaryExpression(e,t){const r=this.evaluate(e.argument,t);if("not"===e.operator.value)return new j(!r.value);throw new SyntaxError(`Unknown operator: ${e.operator.value}`)}evalProgram(e,t){return this.evaluateBlock(e.body,t)}evaluateBlock(e,t){let r="";for(const n of e){const e=this.evaluate(n,t);"NullValue"!==e.type&&"UndefinedValue"!==e.type&&(r+=e.value)}return new L(r)}evaluateIdentifier(e,t){return t.lookupVariable(e.value)}evaluateCallExpression(e,t){const r=[],n=new Map;for(const i of e.args)if("KeywordArgumentExpression"===i.type){const e=i;n.set(e.key.value,this.evaluate(e.value,t))}else r.push(this.evaluate(i,t));n.size>0&&r.push(new F(n));const i=this.evaluate(e.callee,t);if("FunctionValue"!==i.type)throw new Error(`Cannot call something that is not a function: got ${i.type}`);return i.value(r,t)}evaluateSliceExpression(e,t,r){if(!(e instanceof z||e instanceof L))throw new Error("Slice object must be an array or string");const n=this.evaluate(t.start,r),i=this.evaluate(t.stop,r),s=this.evaluate(t.step,r);if(!(n instanceof U||n instanceof q))throw new Error("Slice start must be numeric or undefined");if(!(i instanceof U||i instanceof q))throw new Error("Slice stop must be numeric or undefined");if(!(s instanceof U||s instanceof q))throw new Error("Slice step must be numeric or undefined");return e instanceof z?new z(B(e.value,n.value,i.value,s.value)):new L(B(Array.from(e.value),n.value,i.value,s.value).join(""))}evaluateMemberExpression(e,t){const r=this.evaluate(e.object,t);let n,i;if(e.computed){if("SliceExpression"===e.property.type)return this.evaluateSliceExpression(r,e.property,t);n=this.evaluate(e.property,t)}else n=new L(e.property.value);if(r instanceof F){if(!(n instanceof L))throw new Error(`Cannot access property with non-string: got ${n.type}`);i=r.value.get(n.value)??r.builtins.get(n.value)}else if(r instanceof z||r instanceof L)if(n instanceof U)i=r.value.at(n.value),r instanceof L&&(i=new L(r.value.at(n.value)));else{if(!(n instanceof L))throw new Error(`Cannot access property with non-string/non-number: got ${n.type}`);i=r.builtins.get(n.value)}else{if(!(n instanceof L))throw new Error(`Cannot access property with non-string: got ${n.type}`);i=r.builtins.get(n.value)}return i instanceof M?i:new q}evaluateSet(e,t){const r=this.evaluate(e.value,t);if("Identifier"===e.assignee.type){const n=e.assignee.value;t.setVariable(n,r)}else{if("MemberExpression"!==e.assignee.type)throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(e.assignee)}`);{const n=e.assignee,i=this.evaluate(n.object,t);if(!(i instanceof F))throw new Error("Cannot assign to member of non-object");if("Identifier"!==n.property.type)throw new Error("Cannot assign to member with non-identifier property");i.value.set(n.property.value,r)}}return new V}evaluateIf(e,t){const r=this.evaluate(e.test,t);return this.evaluateBlock(r.__bool__().value?e.body:e.alternate,t)}evaluateFor(e,t){const r=new W(t),n=this.evaluate(e.iterable,r);if(!(n instanceof z))throw new Error(`Expected iterable type in for loop: got ${n.type}`);let i="";for(let t=0;t<n.value.length;++t){const s=new Map([["index",new U(t+1)],["index0",new U(t)],["revindex",new U(n.value.length-t)],["revindex0",new U(n.value.length-t-1)],["first",new j(0===t)],["last",new j(t===n.value.length-1)],["length",new U(n.value.length)],["previtem",t>0?n.value[t-1]:new q],["nextitem",t<n.value.length-1?n.value[t+1]:new q]]);r.setVariable("loop",new F(s));const o=n.value[t];if("Identifier"===e.loopvar.type)r.setVariable(e.loopvar.value,o);else if("TupleLiteral"===e.loopvar.type){const t=e.loopvar;if("ArrayValue"!==o.type)throw new Error(`Cannot unpack non-iterable type: ${o.type}`);const n=o;if(t.value.length!==n.value.length)throw new Error(`Too ${t.value.length>n.value.length?"few":"many"} items to unpack`);for(let e=0;e<t.value.length;++e){if("Identifier"!==t.value[e].type)throw new Error(`Cannot unpack non-identifier type: ${t.value[e].type}`);r.setVariable(t.value[e].value,n.value[e])}}i+=this.evaluateBlock(e.body,r).value}return new L(i)}evaluate(e,t){if(void 0===e)return new q;switch(e.type){case"Program":return this.evalProgram(e,t);case"Set":return this.evaluateSet(e,t);case"If":return this.evaluateIf(e,t);case"For":return this.evaluateFor(e,t);case"NumericLiteral":return new U(Number(e.value));case"StringLiteral":return new L(e.value);case"BooleanLiteral":return new j(e.value);case"ArrayLiteral":return new z(e.value.map((e=>this.evaluate(e,t))));case"TupleLiteral":return new $(e.value.map((e=>this.evaluate(e,t))));case"ObjectLiteral":{const r=new Map;for(const[n,i]of e.value){const e=this.evaluate(n,t);if(!(e instanceof L))throw new Error(`Object keys must be strings: got ${e.type}`);r.set(e.value,this.evaluate(i,t))}return new F(r)}case"Identifier":return this.evaluateIdentifier(e,t);case"CallExpression":return this.evaluateCallExpression(e,t);case"MemberExpression":return this.evaluateMemberExpression(e,t);case"UnaryExpression":return this.evaluateUnaryExpression(e,t);case"BinaryExpression":return this.evaluateBinaryExpression(e,t);case"FilterExpression":return this.evaluateFilterExpression(e,t);case"TestExpression":return this.evaluateTestExpression(e,t);default:throw new SyntaxError(`Unknown node type: ${e.type}`)}}}(t);return r.run(this.parsed).value}}},57805:function(e,t,r){"use strict";r.d(t,{lc:function(){return n},DG:function(){return o},IV:function(){return i}});class n extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function i(e,t,r){const i=r??{},s=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const o=()=>{null!=r&&r()};for(t.addEventListener("abort",o);;){let a;try{if(t.aborted){const{abortMessage:e,abortCode:t}=i;throw new n(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=i;t(new n(e,r))}}));a=await Promise.race([e,s.next()]),r=null}catch(r){t.removeEventListener("abort",o);const n="aborted"===r.type&&t.aborted;if(n&&null!=i.onAbort&&await i.onAbort(e),"function"==typeof s.return)try{const e=s.return();e instanceof Promise&&e.catch((e=>{null!=i.onReturnError&&i.onReturnError(e)}))}catch(e){null!=i.onReturnError&&i.onReturnError(e)}if(n&&!0===i.returnOnAbort)return;throw r}if(!0===a.done)break;yield a.value}t.removeEventListener("abort",o)}()}function s(e,t,r){return n=>e(i(n,t,r))}function o(e,t,r){return{sink:s(e.sink,t,{...r,onAbort:void 0}),source:i(e.source,t,r)}}},62593:function(e,t,r){"use strict";function n(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);for(let t=(e=[...e]).length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}r.d(t,{A:function(){return n}})},22909:function(e,t,r){"use strict";r.d(t,{A:function(){return i}});var n=r(65385);function i(e){return"function"==typeof e.stream?(0,n.A)(e.stream()):(0,n.A)(new Response(e).body)}},36918:function(e,t,r){"use strict";r.d(t,{if:function(){return f},I:function(){return ue},ED:function(){return se}});var n={};r.r(n),r.d(n,{abortedError:function(){return d},closeFailedError:function(){return o},deleteFailedError:function(){return u},getFailedError:function(){return c},hasFailedError:function(){return l},notFoundError:function(){return h},openFailedError:function(){return s},putFailedError:function(){return a}});var i=r(66310);function s(e){return e=e??new Error("Open failed"),i(e,"ERR_OPEN_FAILED")}function o(e){return e=e??new Error("Close failed"),i(e,"ERR_CLOSE_FAILED")}function a(e){return e=e??new Error("Put failed"),i(e,"ERR_PUT_FAILED")}function c(e){return e=e??new Error("Get failed"),i(e,"ERR_GET_FAILED")}function u(e){return e=e??new Error("Delete failed"),i(e,"ERR_DELETE_FAILED")}function l(e){return e=e??new Error("Has failed"),i(e,"ERR_HAS_FAILED")}function h(e){return e=e??new Error("Not Found"),i(e,"ERR_NOT_FOUND")}function d(e){return e=e??new Error("Aborted"),i(e,"ERR_ABORTED")}class f{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(const{cid:r,block:n}of e)await this.put(r,n,t),yield r}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(const r of e)yield{cid:r,block:await this.get(r,t)}}async delete(e,t){await Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(const r of e)await this.delete(r,t),yield r}async*getAll(e){throw new Error(".getAll is not implemented")}}var p=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);const y=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class g{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class m{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return w(this,e)}}class b{constructor(e){this.decoders=e}or(e){return w(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const w=(e,t)=>new b({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class v{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new g(e,t,r),this.decoder=new m(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _=({name:e,prefix:t,encode:r,decode:n})=>new v(e,t,r,n),E=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=p(r,t);return _({prefix:e,name:t,encode:n,decode:e=>y(i(e))})},S=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>_({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),x=S({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A=(S({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),S({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),S({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),S({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),S({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),S({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),S({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),S({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),E({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));E({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var k=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=P;)r[n++]=255&t|I,t/=128;for(;t&T;)r[n++]=255&t|I,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},I=128,T=-128,P=Math.pow(2,31);var C=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&O)<<s:(n&O)*Math.pow(2,s),s+=7}while(n>=R);return e.bytes=o-r,i},R=128,O=127;var D=Math.pow(2,7),B=Math.pow(2,14),N=Math.pow(2,21),M=Math.pow(2,28),U=Math.pow(2,35),L=Math.pow(2,42),j=Math.pow(2,49),F=Math.pow(2,56),z=Math.pow(2,63),$={encode:k,decode:C,encodingLength:function(e){return e<D?1:e<B?2:e<N?3:e<M?4:e<U?5:e<L?6:e<j?7:e<F?8:e<z?9:10}};const K=(e,t=0)=>[$.decode(e,t),$.decode.bytes],V=(e,t,r=0)=>($.encode(e,t,r),t),q=e=>$.encodingLength(e),W=e=>{const t=y(e),[r,n]=K(t),[i,s]=K(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new H(r,i,o,t)};class H{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const G=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?Q(r,Y(e),t||A.encoder):ee(r,Y(e),t||x.encoder)},J=new WeakMap,Y=e=>{const t=J.get(e);if(null==t){const t=new Map;return J.set(e,t),t}return t};class Z{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==te)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==re)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Z.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=q(e),i=n+q(r),s=new Uint8Array(i+r);return V(e,s,0),V(r,s,n),s.set(t,i),new H(e,r,t,s)})(e,t);return Z.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Z.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return G(this,e)}toJSON(){return{"/":G(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Z)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Z(e,r,n,i||ne(e,r,n.bytes))}if(!0===t[ie]){const{version:e,multihash:r,code:n}=t,i=W(r);return Z.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==te)throw new Error(`Version 0 CID must use dag-pb (code: ${te}) block encoding`);return new Z(e,t,r,r.bytes);case 1:{const n=ne(e,t,r.bytes);return new Z(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Z.create(0,te,e)}static createV1(e,t){return Z.create(1,e,t)}static decode(e){const[t,r]=Z.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Z.inspectBytes(e),r=t.size-t.multihashSize,n=y(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new H(t.multihashCode,t.digestSize,i,n);return[0===t.version?Z.createV0(s):Z.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=K(e.subarray(t));return t+=n,r};let n=r(),i=te;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=X(e,t),i=Z.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Y(i).set(r,e),i}}const X=(e,t)=>{switch(e[0]){case"Q":{const r=t||A;return[A.prefix,r.decode(`${A.prefix}${e}`)]}case A.prefix:{const r=t||A;return[A.prefix,r.decode(e)]}case x.prefix:{const r=t||x;return[x.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Q=(e,t,r)=>{const{prefix:n}=r;if(n!==A.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},ee=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},te=112,re=18,ne=(e,t,r)=>{const n=q(e),i=n+q(t),s=new Uint8Array(i+r.byteLength);return V(e,s,0),V(t,s,n),s.set(r,i),s},ie=Symbol.for("@ipld/js-cid/CID");class se extends f{data;constructor(){super(),this.data=new Map}put(e,t){return this.data.set(x.encode(e.multihash.bytes),t),e}get(e){const t=this.data.get(x.encode(e.multihash.bytes));if(null==t)throw h();return t}has(e){return this.data.has(x.encode(e.multihash.bytes))}async delete(e){this.data.delete(x.encode(e.multihash.bytes))}async*getAll(){for(const[e,t]of this.data.entries())yield{cid:Z.createV1(85,W(x.decode(e))),block:t}}}var oe=r(17833);const ae=S({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});S({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),S({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),S({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});oe.formatters.b=e=>null==e?"undefined":A.baseEncode(e),oe.formatters.t=e=>null==e?"undefined":x.baseEncode(e),oe.formatters.m=e=>null==e?"undefined":ae.baseEncode(e),oe.formatters.p=e=>null==e?"undefined":e.toString(),oe.formatters.c=e=>null==e?"undefined":e.toString(),oe.formatters.k=e=>null==e?"undefined":e.toString(),oe.formatters.a=e=>null==e?"undefined":e.toString();r(97101);r(97313);class ce extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}r(48651);!function(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);oe.enabled(`${e}:trace`)&&null!=oe.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=oe(`${e}:trace`)),Object.assign(oe(e),{error:oe(`${e}:error`),trace:t})}("blockstore:core:tiered");const ue={...n}},20984:function(e,t,r){"use strict";r.d(t,{n:function(){return w}});var n=r(8306),i=r(48651),s=r(30256),o=r(75946),a=r(79033),c=r(52671),u=r(1987),l=r(32763),h=r(66310),d=r(40506),f=r(66213);const p=(e,t)=>async function*(){const r=await async function(e){const t=[];for await(const r of e)t.push(r);return t}(e);yield*r.sort(t)}();class y{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await(0,n.A)(this.putMany(e,r)),e=[],await(0,n.A)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=(0,d.A)(r,(t=>t.key.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>p(e,t)),r)),null!=e.offset){let t=0;r=(0,d.A)(r,(()=>t++>=(e.offset||0)))}return null!=e.limit&&(r=(0,f.A)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=(0,d.A)(r,(t=>t.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>p(e,t)),r)),null!=e.offset){let t=0;r=(0,d.A)(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=(0,f.A)(r,e.limit)),r}}function g(e){const t=o.TO.asCID(e);if(!t)throw h(new Error("Not a valid cid"),"ERR_INVALID_CID");return new s.U("/"+u.base32.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function m(e){return o.TO.createV1(a.code,c.D4(u.base32.decode("b"+e.toString().slice(1).toLowerCase())))}function b(e){const t=e.substring(0,1);if("/"===t)return b(e.substring(1));let r,n;r="b"===t.toLowerCase()?e=>u.base32.decode(e.toLowerCase()).subarray(2):"c"===t.toLowerCase()?e=>u.base32pad.decode(e.toLowerCase()).subarray(2):"z"===t?e=>l.base58btc.decode(e).subarray(2):"Q"===t?e=>l.base58btc.decode("z"+e):e=>u.base32.decode("b"+e.toLowerCase()).subarray(2);for(let t=1;t<e.length;t++)try{n=r(e.substring(0,t))}catch(e){if("Unexpected end of data"!==e.message)throw e}let i="/C";return n&&(i=`/${u.base32.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}class w extends y{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:r,value:n}of this.child.query(function(e){return{...e,prefix:e.prefix?b(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e({key:m(t.key),value:t.value}))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e({key:m(t.key),value:t.value},{key:m(r.key),value:r.value}))):void 0}}(e),t))yield{key:m(r),value:n}}async*queryKeys(e,t){for await(const r of this.child.queryKeys(function(e){return{...e,prefix:e.prefix?b(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e(m(t)))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e(m(t),m(r)))):void 0}}(e),t))yield m(r)}async get(e,t){return this.child.get(g(e),t)}async*getMany(e,t){for await(const r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(g(e),t,r)}async*putMany(e,t){const r=(0,i.N)({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((async()=>{try{const i=this.child;await(0,n.A)(this.child.putMany(async function*(){for await(const n of e){const e=g(n.key);await i.has(e,t)||(yield{key:e,value:n.value}),r.push(n)}}())),r.end()}catch(e){r.end(e)}})),yield*r}has(e,t){return this.child.has(g(e),t)}delete(e,t){return this.child.delete(g(e),t)}deleteMany(e,t){const r=(0,i.N)({objectMode:!0});return(0,n.A)(this.child.deleteMany(async function*(){for await(const t of e)yield g(t),r.push(t);r.end()}(),t)).catch((e=>{r.end(e)})),r}}},93439:function(e,t,r){"use strict";r.d(t,{E:function(){return Z}});var n=r(36918),i=r(96148);var s=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);const o=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class a{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class c{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return l(this,e)}}class u{constructor(e){this.decoders=e}or(e){return l(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const l=(e,t)=>new u({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new a(e,t,r),this.decoder=new c(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const d=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),f=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=s(r,t);return d({prefix:e,name:t,encode:n,decode:e=>o(i(e))})},p=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>d({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),y=p({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),g=p({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),m=(p({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),p({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),p({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),p({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),p({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),p({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),f({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));f({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var b=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=_;)r[n++]=255&t|w,t/=128;for(;t&v;)r[n++]=255&t|w,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},w=128,v=-128,_=Math.pow(2,31);var E=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&x)<<s:(n&x)*Math.pow(2,s),s+=7}while(n>=S);return e.bytes=o-r,i},S=128,x=127;var A=Math.pow(2,7),k=Math.pow(2,14),I=Math.pow(2,21),T=Math.pow(2,28),P=Math.pow(2,35),C=Math.pow(2,42),R=Math.pow(2,49),O=Math.pow(2,56),D=Math.pow(2,63),B={encode:b,decode:E,encodingLength:function(e){return e<A?1:e<k?2:e<I?3:e<T?4:e<P?5:e<C?6:e<R?7:e<O?8:e<D?9:10}};const N=(e,t=0)=>[B.decode(e,t),B.decode.bytes],M=(e,t,r=0)=>(B.encode(e,t,r),t),U=e=>B.encodingLength(e),L=e=>{const t=o(e),[r,n]=N(t),[i,s]=N(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new j(r,i,a,t)};class j{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const F=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?q(r,$(e),t||m.encoder):W(r,$(e),t||y.encoder)},z=new WeakMap,$=e=>{const t=z.get(e);if(null==t){const t=new Map;return z.set(e,t),t}return t};class K{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==H)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==G)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return K.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=U(e),i=n+U(r),s=new Uint8Array(i+r);return M(e,s,0),M(r,s,n),s.set(t,i),new j(e,r,t,s)})(e,t);return K.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return K.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return F(this,e)}toJSON(){return{"/":F(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof K)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new K(e,r,n,i||J(e,r,n.bytes))}if(!0===t[Y]){const{version:e,multihash:r,code:n}=t,i=L(r);return K.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==H)throw new Error(`Version 0 CID must use dag-pb (code: ${H}) block encoding`);return new K(e,t,r,r.bytes);case 1:{const n=J(e,t,r.bytes);return new K(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return K.create(0,H,e)}static createV1(e,t){return K.create(1,e,t)}static decode(e){const[t,r]=K.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=K.inspectBytes(e),r=t.size-t.multihashSize,n=o(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new j(t.multihashCode,t.digestSize,i,n);return[0===t.version?K.createV0(s):K.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=N(e.subarray(t));return t+=n,r};let n=r(),i=H;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=V(e,t),i=K.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return $(i).set(r,e),i}}const V=(e,t)=>{switch(e[0]){case"Q":{const r=t||m;return[m.prefix,r.decode(`${m.prefix}${e}`)]}case m.prefix:{const r=t||m;return[m.prefix,r.decode(e)]}case y.prefix:{const r=t||y;return[y.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},q=(e,t,r)=>{const{prefix:n}=r;if(n!==m.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},W=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},H=112,G=18,J=(e,t,r)=>{const n=U(e),i=n+U(t),s=new Uint8Array(i+r.byteLength);return M(e,s,0),M(t,s,n),s.set(r,i),s},Y=Symbol.for("@ipld/js-cid/CID");class Z extends n.if{location;version;db;base;constructor(e,t={}){super(),this.location=`${t.prefix??""}${e}`,this.version=t.version??1,this.base=t.base??g}#e(e){return`/${this.base.encoder.encode(e.multihash.bytes)}`}#t(e){return K.createV1(85,L(this.base.decoder.decode(e.substring(1))))}async open(){try{const e=this.location;this.db=await(0,i.P2)(e,this.version,{upgrade(t){t.createObjectStore(e)}})}catch(e){throw n.I.openFailedError(e)}}async close(){this.db?.close()}async put(e,t){if(null==this.db)throw new Error("Blockstore needs to be opened.");try{return await this.db.put(this.location,t,this.#e(e)),e}catch(e){throw n.I.putFailedError(e)}}async get(e){if(null==this.db)throw new Error("Blockstore needs to be opened.");let t;try{t=await this.db.get(this.location,this.#e(e))}catch(e){throw n.I.putFailedError(e)}if(void 0===t)throw n.I.notFoundError();return t}async delete(e){if(null==this.db)throw new Error("Blockstore needs to be opened.");try{await this.db.delete(this.location,this.#e(e))}catch(e){throw n.I.putFailedError(e)}}async has(e){if(null==this.db)throw new Error("Blockstore needs to be opened.");try{return Boolean(await this.db.getKey(this.location,this.#e(e)))}catch(e){throw n.I.putFailedError(e)}}async*getAll(e){if(null==this.db)throw new Error("Blockstore needs to be opened.");for(const e of await this.db.getAllKeys(this.location)){const t=this.#t(e.toString()),r=await this.get(t);yield{cid:t,block:r}}}async destroy(){await(0,i.MR)(this.location)}}},65385:function(e,t,r){"use strict";async function*n(e,t={}){const r=e.getReader();try{for(;;){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await r.cancel(),r.releaseLock()}}r.d(t,{A:function(){return n}})},67645:function(e,t,r){"use strict";function n(e){return e instanceof Uint8Array?{get:t=>e[t],set(t,r){e[t]=r}}:{get:t=>e.get(t),set(t,r){e.set(t,r)}}}r.d(t,{A:function(){return n}})},16668:function(e,t,r){"use strict";r.d(t,{D4:function(){return i.D4},ZU:function(){return s.Z},lF:function(){return n.lF},ou:function(){return s.o}});var n=r(64073),i=r(4867),s=r(48636)},59709:function(e,t,r){"use strict";r.d(t,{CV:function(){return a},Gr:function(){return d},H2:function(){return p},Km:function(){return h},VF:function(){return u},Wg:function(){return c},Xb:function(){return f},gv:function(){return y},nI:function(){return s},tA:function(){return l},xh:function(){return o}});var n=r(48636),i=r(5528);const s=[24,256,65536,4294967296,BigInt("18446744073709551616")];function o(e,t,r){(0,i.pZ)(e,t,1);const n=e[t];if(!0===r.strict&&n<s[0])throw new Error(`${i.WR} integer encoded in more bytes than necessary (strict decode)`);return n}function a(e,t,r){(0,i.pZ)(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<s[1])throw new Error(`${i.WR} integer encoded in more bytes than necessary (strict decode)`);return n}function c(e,t,r){(0,i.pZ)(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<s[2])throw new Error(`${i.WR} integer encoded in more bytes than necessary (strict decode)`);return n}function u(e,t,r){(0,i.pZ)(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],a=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&a<s[3])throw new Error(`${i.WR} integer encoded in more bytes than necessary (strict decode)`);if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(!0===r.allowBigInt)return a;throw new Error(`${i.WR} integers outside of the safe integer range are not supported`)}function l(e,t,r,i){return new n.o(n.Z.uint,o(e,t+1,i),2)}function h(e,t,r,i){return new n.o(n.Z.uint,a(e,t+1,i),3)}function d(e,t,r,i){return new n.o(n.Z.uint,c(e,t+1,i),5)}function f(e,t,r,i){return new n.o(n.Z.uint,u(e,t+1,i),9)}function p(e,t){return y(e,0,t.value)}function y(e,t,r){if(r<s[0]){const n=Number(r);e.push([t|n])}else if(r<s[1]){const n=Number(r);e.push([24|t,n])}else if(r<s[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<s[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<s[4]))throw new Error(`${i.WR} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&s,s>>=8,r[3]=255&s,s>>=8,r[2]=255&s,s>>=8,r[1]=255&s,e.push(r)}}}p.encodedSize=function(e){return y.encodedSize(e.value)},y.encodedSize=function(e){return e<s[0]?1:e<s[1]?2:e<s[2]?3:e<s[3]?5:9},p.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}},41833:function(e,t,r){"use strict";r.d(t,{Z:function(){return c},gW:function(){return h},tF:function(){return a},ug:function(){return d},wJ:function(){return o}});var n=r(48636),i=r(59709),s=r(5528);function o(e,t,r,s){return new n.o(n.Z.negint,-1-i.xh(e,t+1,s),2)}function a(e,t,r,s){return new n.o(n.Z.negint,-1-i.CV(e,t+1,s),3)}function c(e,t,r,s){return new n.o(n.Z.negint,-1-i.Wg(e,t+1,s),5)}const u=BigInt(-1),l=BigInt(1);function h(e,t,r,o){const a=i.VF(e,t+1,o);if("bigint"!=typeof a){const e=-1-a;if(e>=Number.MIN_SAFE_INTEGER)return new n.o(n.Z.negint,e,9)}if(!0!==o.allowBigInt)throw new Error(`${s.WR} integers outside of the safe integer range are not supported`);return new n.o(n.Z.negint,u-BigInt(a),9)}function d(e,t){const r=t.value,n="bigint"==typeof r?r*u-l:-1*r-1;i.gv(e,t.type.majorEncoded,n)}d.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*u-l:-1*t-1;return r<i.nI[0]?1:r<i.nI[1]?2:r<i.nI[2]?3:r<i.nI[3]?5:9},d.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}},38464:function(e,t,r){"use strict";r.d(t,{Cz:function(){return u},Hy:function(){return h},LC:function(){return c},MW:function(){return p},N8:function(){return l},cT:function(){return d}});var n=r(48636),i=r(5528),s=r(59709),o=r(49607);function a(e,t,r,s){(0,i.pZ)(e,t,r+s);const a=(0,o.di)(e,t+r,t+r+s);return new n.o(n.Z.bytes,a,r+s)}function c(e,t,r,n){return a(e,t,1,r)}function u(e,t,r,n){return a(e,t,2,s.xh(e,t+1,n))}function l(e,t,r,n){return a(e,t,3,s.CV(e,t+1,n))}function h(e,t,r,n){return a(e,t,5,s.Wg(e,t+1,n))}function d(e,t,r,n){const o=s.VF(e,t+1,n);if("bigint"==typeof o)throw new Error(`${i.WR} 64-bit integer bytes lengths not supported`);return a(e,t,9,o)}function f(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===n.Z.string?(0,o.sH)(e.value):e.value),e.encodedBytes}function p(e,t){const r=f(t);s.gv(e,t.type.majorEncoded,r.length),e.push(r)}p.encodedSize=function(e){const t=f(e);return s.gv.encodedSize(t.length)+t.length},p.compareTokens=function(e,t){return r=f(e),n=f(t),r.length<n.length?-1:r.length>n.length?1:(0,o.UD)(r,n);var r,n}},84897:function(e,t,r){"use strict";r.d(t,{$A:function(){return d},Hc:function(){return u},Rw:function(){return h},aj:function(){return p},gh:function(){return f},s4:function(){return l}});var n=r(48636),i=r(5528),s=r(59709),o=r(38464),a=r(49607);function c(e,t,r,s,o){const c=r+s;(0,i.pZ)(e,t,c);const u=new n.o(n.Z.string,(0,a.dI)(e,t+r,t+c),c);return!0===o.retainStringBytes&&(u.byteValue=(0,a.di)(e,t+r,t+c)),u}function u(e,t,r,n){return c(e,t,1,r,n)}function l(e,t,r,n){return c(e,t,2,s.xh(e,t+1,n),n)}function h(e,t,r,n){return c(e,t,3,s.CV(e,t+1,n),n)}function d(e,t,r,n){return c(e,t,5,s.Wg(e,t+1,n),n)}function f(e,t,r,n){const o=s.VF(e,t+1,n);if("bigint"==typeof o)throw new Error(`${i.WR} 64-bit integer string lengths not supported`);return c(e,t,9,o,n)}const p=o.MW},2976:function(e,t,r){"use strict";r.d(t,{NL:function(){return d},RD:function(){return u},_i:function(){return c},fd:function(){return l},go:function(){return h},tW:function(){return a},u8:function(){return f}});var n=r(48636),i=r(59709),s=r(5528);function o(e,t,r,i){return new n.o(n.Z.array,i,r)}function a(e,t,r,n){return o(0,0,1,r)}function c(e,t,r,n){return o(0,0,2,i.xh(e,t+1,n))}function u(e,t,r,n){return o(0,0,3,i.CV(e,t+1,n))}function l(e,t,r,n){return o(0,0,5,i.Wg(e,t+1,n))}function h(e,t,r,n){const a=i.VF(e,t+1,n);if("bigint"==typeof a)throw new Error(`${s.WR} 64-bit integer array lengths not supported`);return o(0,0,9,a)}function d(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${s.WR} indefinite length items not allowed`);return o(0,0,1,1/0)}function f(e,t){i.gv(e,n.Z.array.majorEncoded,t.value)}f.compareTokens=i.H2.compareTokens,f.encodedSize=function(e){return i.gv.encodedSize(e.value)}},67818:function(e,t,r){"use strict";r.d(t,{CV:function(){return l},LO:function(){return f},Ws:function(){return u},dk:function(){return c},hi:function(){return h},m_:function(){return d},sP:function(){return a}});var n=r(48636),i=r(59709),s=r(5528);function o(e,t,r,i){return new n.o(n.Z.map,i,r)}function a(e,t,r,n){return o(0,0,1,r)}function c(e,t,r,n){return o(0,0,2,i.xh(e,t+1,n))}function u(e,t,r,n){return o(0,0,3,i.CV(e,t+1,n))}function l(e,t,r,n){return o(0,0,5,i.Wg(e,t+1,n))}function h(e,t,r,n){const a=i.VF(e,t+1,n);if("bigint"==typeof a)throw new Error(`${s.WR} 64-bit integer map lengths not supported`);return o(0,0,9,a)}function d(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${s.WR} indefinite length items not allowed`);return o(0,0,1,1/0)}function f(e,t){i.gv(e,n.Z.map.majorEncoded,t.value)}f.compareTokens=i.H2.compareTokens,f.encodedSize=function(e){return i.gv.encodedSize(e.value)}},26419:function(e,t,r){"use strict";r.d(t,{RV:function(){return u},U6:function(){return a},UE:function(){return s},Yv:function(){return c},hL:function(){return o},jD:function(){return l}});var n=r(48636),i=r(59709);function s(e,t,r,i){return new n.o(n.Z.tag,r,1)}function o(e,t,r,s){return new n.o(n.Z.tag,i.xh(e,t+1,s),2)}function a(e,t,r,s){return new n.o(n.Z.tag,i.CV(e,t+1,s),3)}function c(e,t,r,s){return new n.o(n.Z.tag,i.Wg(e,t+1,s),5)}function u(e,t,r,s){return new n.o(n.Z.tag,i.VF(e,t+1,s),9)}function l(e,t){i.gv(e,n.Z.tag.majorEncoded,t.value)}l.compareTokens=i.H2.compareTokens,l.encodedSize=function(e){return i.gv.encodedSize(e.value)}},48280:function(e,t,r){"use strict";r.d(t,{IC:function(){return p},VQ:function(){return y},jD:function(){return l},lD:function(){return g},qz:function(){return h},y:function(){return f}});var n=r(48636),i=r(5528),s=r(59709);const o=20,a=21,c=22,u=23;function l(e,t,r,s){if(!1===s.allowUndefined)throw new Error(`${i.WR} undefined values are not supported`);return!0===s.coerceUndefinedToNull?new n.o(n.Z.null,null,1):new n.o(n.Z.undefined,void 0,1)}function h(e,t,r,s){if(!1===s.allowIndefinite)throw new Error(`${i.WR} indefinite length items not allowed`);return new n.o(n.Z.break,void 0,1)}function d(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${i.WR} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${i.WR} Infinity values are not supported`)}return new n.o(n.Z.float,e,t)}function f(e,t,r,n){return d(_(e,t+1),3,n)}function p(e,t,r,n){return d(S(e,t+1),5,n)}function y(e,t,r,n){return d(x(e,t+1),9,n)}function g(e,t,r){const i=t.value;if(!1===i)e.push([n.Z.float.majorEncoded|o]);else if(!0===i)e.push([n.Z.float.majorEncoded|a]);else if(null===i)e.push([n.Z.float.majorEncoded|c]);else if(void 0===i)e.push([n.Z.float.majorEncoded|u]);else{let t,n=!1;r&&!0===r.float64||(v(i),t=_(w,1),i===t||Number.isNaN(i)?(w[0]=249,e.push(w.slice(0,3)),n=!0):(E(i),t=S(w,1),i===t&&(w[0]=250,e.push(w.slice(0,5)),n=!0))),n||(s=i,b.setFloat64(0,s,!1),t=x(w,1),w[0]=251,e.push(w.slice(0,9)))}var s}g.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){v(r);let e=_(w,1);if(r===e||Number.isNaN(r))return 3;if(E(r),e=S(w,1),r===e)return 5}return 9};const m=new ArrayBuffer(9),b=new DataView(m,1),w=new Uint8Array(m,0);function v(e){if(e===1/0)b.setUint16(0,31744,!1);else if(e===-1/0)b.setUint16(0,64512,!1);else if(Number.isNaN(e))b.setUint16(0,32256,!1);else{b.setFloat32(0,e);const t=b.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)b.setUint16(0,31744,!1);else if(0===r)b.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?b.setUint16(0,0):e<-14?b.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):b.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function _(e,t){if(e.length-t<2)throw new Error(`${i.WR} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,s=1023&r;let o;return o=0===n?s*2**-24:31!==n?(s+1024)*2**(n-25):0===s?1/0:NaN,32768&r?-o:o}function E(e){b.setFloat32(0,e,!1)}function S(e,t){if(e.length-t<4)throw new Error(`${i.WR} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function x(e,t){if(e.length-t<8)throw new Error(`${i.WR} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}g.compareTokens=s.H2.compareTokens},49607:function(e,t,r){"use strict";r.d(t,{H8:function(){return a},UD:function(){return p},c4:function(){return f},ci:function(){return l},dI:function(){return c},di:function(){return h},sH:function(){return u},xW:function(){return d},y9:function(){return b}});const n=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,i=new TextDecoder,s=new TextEncoder;function o(e){return n&&globalThis.Buffer.isBuffer(e)}function a(e){return e instanceof Uint8Array?o(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const c=n?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):g(e,t,r):(e,t,r)=>r-t>64?i.decode(e.subarray(t,r)):g(e,t,r),u=n?e=>e.length>64?globalThis.Buffer.from(e):y(e):e=>e.length>64?s.encode(e):y(e),l=e=>Uint8Array.from(e),h=n?(e,t,r)=>o(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),d=n?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),a(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},f=n?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function p(e,t){if(o(e)&&o(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function y(e,t=1/0){let r;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function g(e,t,r){const n=[];for(;t<r;){const i=e[t];let s=null,o=i>239?4:i>223?3:i>191?2:1;if(t+o<=r){let r,n,a,c;switch(o){case 1:i<128&&(s=i);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&i)<<6|63&r,c>127&&(s=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),t+=o}return b(n)}const m=4096;function b(e){const t=e.length;if(t<=m)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=m));return r}},5528:function(e,t,r){"use strict";r.d(t,{WR:function(){return n},pZ:function(){return o},uz:function(){return i}});const n="CBOR decode error:",i="CBOR encode error:",s=[];function o(e,t,r){if(e.length-t<r)throw new Error(`${n} not enough data for type`)}s[23]=1,s[24]=2,s[25]=3,s[26]=5,s[27]=9},4867:function(e,t,r){"use strict";r.d(t,{D4:function(){return h}});var n=r(5528),i=r(48636),s=r(80173);const o={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class a{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=s.wL[e];if(void 0===t){const r=s.lA[e];if(!r)throw new Error(`${n.WR} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const i=31&e;t=r(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}}const c=Symbol.for("DONE"),u=Symbol.for("BREAK");function l(e,t){if(e.done())return c;const r=e.next();if(r.type===i.Z.break)return u;if(r.type.terminal)return r.value;if(r.type===i.Z.array)return function(e,t,r){const i=[];for(let s=0;s<e.value;s++){const o=l(t,r);if(o===u){if(e.value===1/0)break;throw new Error(`${n.WR} got unexpected break to lengthed array`)}if(o===c)throw new Error(`${n.WR} found array but not enough entries (got ${s}, expected ${e.value})`);i[s]=o}return i}(r,e,t);if(r.type===i.Z.map)return function(e,t,r){const i=!0===r.useMaps,s=i?void 0:{},o=i?new Map:void 0;for(let a=0;a<e.value;a++){const h=l(t,r);if(h===u){if(e.value===1/0)break;throw new Error(`${n.WR} got unexpected break to lengthed map`)}if(h===c)throw new Error(`${n.WR} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(!0!==i&&"string"!=typeof h)throw new Error(`${n.WR} non-string keys not supported (got ${typeof h})`);if(!0===r.rejectDuplicateMapKeys&&(i&&o.has(h)||!i&&h in s))throw new Error(`${n.WR} found repeat map key "${h}"`);const d=l(t,r);if(d===c)throw new Error(`${n.WR} found map but not enough entries (got ${a} [no value], expected ${e.value})`);i?o.set(h,d):s[h]=d}return i?o:s}(r,e,t);if(r.type===i.Z.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=l(e,t);return t.tags[r.value](n)}throw new Error(`${n.WR} tag not supported (${r.value})`)}throw new Error("unsupported")}function h(e,t){if(!(e instanceof Uint8Array))throw new Error(`${n.WR} data to decode must be a Uint8Array`);const r=(t=Object.assign({},o,t)).tokenizer||new a(e,t),i=l(r,t);if(i===c)throw new Error(`${n.WR} did not find any content to decode`);if(i===u)throw new Error(`${n.WR} got unexpected break`);if(!r.done())throw new Error(`${n.WR} too many terminals, data makes no sense`);return i}},64073:function(e,t,r){"use strict";r.d(t,{lF:function(){return P},mW:function(){return T}});const n=["string","number","bigint","symbol"],i=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function s(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(n.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(i.includes(t))return t;return}(e);return r||"Object"}var o=r(48636),a=r(49607);class c{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=(0,a.c4)(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=(0,a.di)(r,0,this.cursor)}else t=(0,a.xW)(this.chunks,this.cursor);return e&&this.reset(),t}}var u=r(5528),l=r(80173),h=r(59709),d=r(41833),f=r(38464),p=r(84897),y=r(2976),g=r(67818),m=r(26419),b=r(48280),w=r(96763);const v={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,s=_[i].compareTokens(r,n);0===s&&w.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return s},quickEncodeToken:l.Nx};const _=function(){const e=[];return e[o.Z.uint.major]=h.H2,e[o.Z.negint.major]=d.ug,e[o.Z.bytes.major]=f.MW,e[o.Z.string.major]=p.aj,e[o.Z.array.major]=y.u8,e[o.Z.map.major]=g.LO,e[o.Z.tag.major]=m.jD,e[o.Z.float.major]=b.lD,e}(),E=new c;class S{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${u.uz} object contains circular references`);return new S(t,e)}}const x={null:new o.o(o.Z.null,null),undefined:new o.o(o.Z.undefined,void 0),true:new o.o(o.Z.true,!0),false:new o.o(o.Z.false,!1),emptyArray:new o.o(o.Z.array,0),emptyMap:new o.o(o.Z.map,0)},A={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?e>=0?new o.o(o.Z.uint,e):new o.o(o.Z.negint,e):new o.o(o.Z.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new o.o(o.Z.uint,e):new o.o(o.Z.negint,e),Uint8Array:(e,t,r,n)=>new o.o(o.Z.bytes,e),string:(e,t,r,n)=>new o.o(o.Z.string,e),boolean:(e,t,r,n)=>e?x.true:x.false,null:(e,t,r,n)=>x.null,undefined:(e,t,r,n)=>x.undefined,ArrayBuffer:(e,t,r,n)=>new o.o(o.Z.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new o.o(o.Z.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[x.emptyArray,new o.o(o.Z.break)]:x.emptyArray;n=S.createCheck(n,e);const i=[];let s=0;for(const t of e)i[s++]=k(t,r,n);return r.addBreakTokens?[new o.o(o.Z.array,e.length),i,new o.o(o.Z.break)]:[new o.o(o.Z.array,e.length),i]},Object(e,t,r,n){const i="Object"!==t,s=i?e.keys():Object.keys(e),a=i?e.size:s.length;if(!a)return!0===r.addBreakTokens?[x.emptyMap,new o.o(o.Z.break)]:x.emptyMap;n=S.createCheck(n,e);const c=[];let u=0;for(const t of s)c[u++]=[k(t,r,n),k(i?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(c,r),r.addBreakTokens?[new o.o(o.Z.map,a),c,new o.o(o.Z.break)]:[new o.o(o.Z.map,a),c]}};A.Map=A.Object,A.Buffer=A.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))A[`${e}Array`]=A.DataView;function k(e,t={},r){const n=s(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||A[n];if("function"==typeof i){const s=i(e,n,t,r);if(null!=s)return s}const o=A[n];if(!o)throw new Error(`${u.uz} unsupported type: ${n}`);return o(e,n,t,r)}function I(e,t,r,n){if(Array.isArray(t))for(const i of t)I(e,i,r,n);else r[t.type.major](e,t,n)}function T(e,t,r){const n=k(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const i=t[n.type.major];if(i.encodedSize){const e=i.encodedSize(n,r),t=new c(e);if(i(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return(0,a.H8)(t.chunks[0])}}return E.reset(),I(E,n,t,r),E.toBytes(!0)}function P(e,t){return t=Object.assign({},v,t),T(e,_,t)}},70263:function(e,t,r){"use strict";r.d(t,{_F:function(){return h},D4:function(){return d},lF:function(){return u}});var n=r(48636),i=r(64073),s=r(5528),o=r(49607);class a extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===n.Z.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===n.Z.map&&(t.elements++,1!==t.elements&&(t.elements%2==1?e.push([44]):e.push([58]))))}[n.Z.uint.major](e,t){this.prefix(e);const r=String(t.value),n=[];for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);e.push(n)}[n.Z.negint.major](e,t){this[n.Z.uint.major](e,t)}[n.Z.bytes.major](e,t){throw new Error(`${s.uz} unsupported type: Uint8Array`)}[n.Z.string.major](e,t){this.prefix(e);const r=(0,o.sH)(JSON.stringify(t.value));e.push(r.length>32?(0,o.H8)(r):r)}[n.Z.array.major](e,t){this.prefix(e),this.inRecursive.push({type:n.Z.array,elements:0}),e.push([91])}[n.Z.map.major](e,t){this.prefix(e),this.inRecursive.push({type:n.Z.map,elements:0}),e.push([123])}[n.Z.tag.major](e,t){}[n.Z.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===n.Z.array)e.push([93]);else{if(t.type!==n.Z.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${s.uz} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const r=String(t.value),i=[];let o=!1;for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e),o||46!==i[e]&&101!==i[e]&&69!==i[e]||(o=!0);o||(i.push(46),i.push(48)),e.push(i)}}const c={addBreakTokens:!0,mapSorter:function(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${s.uz} complex map keys are not supported`);const r=e[0],i=t[0];if(r.type!==n.Z.string||i.type!==n.Z.string)throw new Error(`${s.uz} non-string map keys are not supported`);if(r<i)return-1;if(r>i)return 1;throw new Error(`${s.uz} unexpected duplicate map keys, this is not supported`)}};function u(e,t){return t=Object.assign({},c,t),(0,i.mW)(e,new a,t)}var l=r(4867);class h{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${s.WR} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${s.WR} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,r=!1;const i=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new n.o(n.Z.uint,0,this.pos-e);this.pos++,r=!0}if(i([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${s.WR} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${s.WR} unexpected token at position ${this.pos}`);r=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this.pos++,this.done()||43!==this.ch()&&45!==this.ch()||this.pos++,i([48,49,50,51,52,53,54,55,56,57]));const o=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),a=parseFloat(o);return r?new n.o(n.Z.float,a,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(a)?new n.o(a>=0?n.Z.uint:n.Z.negint,a,this.pos-e):new n.o(a>=0?n.Z.uint:n.Z.negint,BigInt(o),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${s.WR} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let e=this.pos,t=0;e<this.data.length&&t<65536;e++,t++){const r=this.data[e];if(92===r||r<32||r>=128)break;if(34===r){const r=String.fromCharCode.apply(null,this.data.subarray(this.pos,e));return this.pos=e+1,new n.o(n.Z.string,r,t)}}const e=this.pos,t=[],r=()=>{if(this.pos+4>=this.data.length)throw new Error(`${s.WR} unexpected end of unicode escape sequence at position ${this.pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${s.WR} unexpected unicode escape character at position ${this.pos}`);t=t-65+10}e=16*e+t,this.pos++}return e},i=()=>{const e=this.ch();let r,n,i,o,a=null,c=e>239?4:e>223?3:e>191?2:1;if(this.pos+c>this.data.length)throw new Error(`${s.WR} unexpected unicode sequence at position ${this.pos}`);switch(c){case 1:e<128&&(a=e);break;case 2:r=this.data[this.pos+1],128==(192&r)&&(o=(31&e)<<6|63&r,o>127&&(a=o));break;case 3:r=this.data[this.pos+1],n=this.data[this.pos+2],128==(192&r)&&128==(192&n)&&(o=(15&e)<<12|(63&r)<<6|63&n,o>2047&&(o<55296||o>57343)&&(a=o));break;case 4:r=this.data[this.pos+1],n=this.data[this.pos+2],i=this.data[this.pos+3],128==(192&r)&&128==(192&n)&&128==(192&i)&&(o=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&i,o>65535&&o<1114112&&(a=o))}null===a?(a=65533,c=1):a>65535&&(a-=65536,t.push(a>>>10&1023|55296),a=56320|1023&a),t.push(a),this.pos+=c};for(;!this.done();){const a=this.ch();let c;switch(a){case 92:if(this.pos++,this.done())throw new Error(`${s.WR} unexpected string termination at position ${this.pos}`);switch(c=this.ch(),this.pos++,c){case 34:case 39:case 92:case 47:t.push(c);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${s.WR} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new n.o(n.Z.string,(0,o.y9)(t),this.pos-e);default:if(a<32)throw new Error(`${s.WR} invalid control character at position ${this.pos}`);a<128?(t.push(a),this.pos++):i()}}throw new Error(`${s.WR} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new n.o(n.Z.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new n.o(n.Z.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new n.o(n.Z.null,null,4);case 102:return this.expect([102,97,108,115,101]),new n.o(n.Z.false,!1,5);case 116:return this.expect([116,114,117,101]),new n.o(n.Z.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${s.WR} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new n.o(n.Z.break,void 0,1);if(44!==this.ch())throw new Error(`${s.WR} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new n.o(n.Z.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new n.o(n.Z.break,void 0,1);if(44!==this.ch())throw new Error(`${s.WR} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new n.o(n.Z.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${s.WR} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${s.WR} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function d(e,t){return t=Object.assign({tokenizer:new h(e,t)},t),(0,l.D4)(e,t)}},80173:function(e,t,r){"use strict";r.d(t,{Nx:function(){return b},lA:function(){return g},wL:function(){return m}});var n=r(48636),i=r(59709),s=r(41833),o=r(38464),a=r(84897),c=r(2976),u=r(67818),l=r(26419),h=r(48280),d=r(5528),f=r(49607);function p(e,t,r){throw new Error(`${d.WR} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function y(e){return()=>{throw new Error(`${d.WR} ${e}`)}}const g=[];for(let e=0;e<=23;e++)g[e]=p;g[24]=i.tA,g[25]=i.Km,g[26]=i.Gr,g[27]=i.Xb,g[28]=p,g[29]=p,g[30]=p,g[31]=p;for(let e=32;e<=55;e++)g[e]=p;g[56]=s.wJ,g[57]=s.tF,g[58]=s.Z,g[59]=s.gW,g[60]=p,g[61]=p,g[62]=p,g[63]=p;for(let e=64;e<=87;e++)g[e]=o.LC;g[88]=o.Cz,g[89]=o.N8,g[90]=o.Hy,g[91]=o.cT,g[92]=p,g[93]=p,g[94]=p,g[95]=y("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)g[e]=a.Hc;g[120]=a.s4,g[121]=a.Rw,g[122]=a.$A,g[123]=a.gh,g[124]=p,g[125]=p,g[126]=p,g[127]=y("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)g[e]=c.tW;g[152]=c._i,g[153]=c.RD,g[154]=c.fd,g[155]=c.go,g[156]=p,g[157]=p,g[158]=p,g[159]=c.NL;for(let e=160;e<=183;e++)g[e]=u.sP;g[184]=u.dk,g[185]=u.Ws,g[186]=u.CV,g[187]=u.hi,g[188]=p,g[189]=p,g[190]=p,g[191]=u.m_;for(let e=192;e<=215;e++)g[e]=l.UE;g[216]=l.hL,g[217]=l.U6,g[218]=l.Yv,g[219]=l.RV,g[220]=p,g[221]=p,g[222]=p,g[223]=p;for(let e=224;e<=243;e++)g[e]=y("simple values are not supported");g[244]=p,g[245]=p,g[246]=p,g[247]=h.jD,g[248]=y("simple values are not supported"),g[249]=h.y,g[250]=h.IC,g[251]=h.VQ,g[252]=p,g[253]=p,g[254]=p,g[255]=h.qz;const m=[];for(let e=0;e<24;e++)m[e]=new n.o(n.Z.uint,e,1);for(let e=-1;e>=-24;e--)m[31-e]=new n.o(n.Z.negint,e,1);function b(e){switch(e.type){case n.Z.false:return(0,f.ci)([244]);case n.Z.true:return(0,f.ci)([245]);case n.Z.null:return(0,f.ci)([246]);case n.Z.bytes:return e.value.length?void 0:(0,f.ci)([64]);case n.Z.string:return""===e.value?(0,f.ci)([96]):void 0;case n.Z.array:return 0===e.value?(0,f.ci)([128]):void 0;case n.Z.map:return 0===e.value?(0,f.ci)([160]):void 0;case n.Z.uint:return e.value<24?(0,f.ci)([Number(e.value)]):void 0;case n.Z.negint:if(e.value>=-24)return(0,f.ci)([31-Number(e.value)])}}m[64]=new n.o(n.Z.bytes,new Uint8Array(0),1),m[96]=new n.o(n.Z.string,"",1),m[128]=new n.o(n.Z.array,0,1),m[160]=new n.o(n.Z.map,0,1),m[244]=new n.o(n.Z.false,!1,1),m[245]=new n.o(n.Z.true,!0,1),m[246]=new n.o(n.Z.null,null,1)},48636:function(e,t,r){"use strict";r.d(t,{Z:function(){return n},o:function(){return i}});class n{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}n.uint=new n(0,"uint",!0),n.negint=new n(1,"negint",!0),n.bytes=new n(2,"bytes",!0),n.string=new n(3,"string",!0),n.array=new n(4,"array",!1),n.map=new n(5,"map",!1),n.tag=new n(6,"tag",!1),n.float=new n(7,"float",!0),n.false=new n(7,"false",!0),n.true=new n(7,"true",!0),n.null=new n(7,"null",!0),n.undefined=new n(7,"undefined",!0),n.break=new n(7,"break",!0);class i{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}},43259:function(e,t,r){"use strict";r.r(t),r.d(t,{code:function(){return f},decode:function(){return b},encode:function(){return m},name:function(){return d},toGeneral:function(){return g}});var n=r(34664);function i(e){return n.base64url.encode(e).slice(1)}function s(e){return n.base64url.decode(`u${e}`)}var o=r(75946);function a(e){const t={signature:s(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=s(e.protected)),t}function c(e){const t={signature:i(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=i(e.protected)),t}function u(e){const t={};return e.encrypted_key&&(t.encrypted_key=s(e.encrypted_key)),e.header&&(t.header=e.header),t}function l(e){const t={};return e.encrypted_key&&(t.encrypted_key=i(e.encrypted_key)),e.header&&(t.header=e.header),t}var h=r(74868);const d="dag-jose",f=133;function p(e){return"payload"in e&&"string"==typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function y(e){return"ciphertext"in e&&"string"==typeof e.ciphertext&&"iv"in e&&"string"==typeof e.iv&&"protected"in e&&"string"==typeof e.protected&&"tag"in e&&"string"==typeof e.tag}function g(e){if("string"==typeof e){const t=e.split(".");if(3===t.length)return function(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:o.TO.decode(s(r))}}(t);if(5===t.length)return function(e){const[t,r,n,i,s]=e,o={ciphertext:i,iv:n,protected:t,tag:s};return r&&(o.recipients=[{encrypted_key:r}]),o}(t);throw new Error("Not a valid JOSE string")}if(p(e)||y(e))return e;throw new Error("Not a valid unencoded JOSE object")}function m(e){let t;if("string"==typeof e&&(e=g(e)),p(e))t=function(e){const t=s(e.payload);try{o.TO.decode(t)}catch(e){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(a)}}(e);else{if(!y(e))throw new Error("Not a valid JOSE object");t=function(e){const t={ciphertext:s(e.ciphertext),protected:s(e.protected),iv:s(e.iv),tag:s(e.tag)};return e.aad&&(t.aad=s(e.aad)),e.recipients&&(t.recipients=e.recipients.map(u)),e.unprotected&&(t.unprotected=e.unprotected),t}(e)}return new Uint8Array(h.encode(t))}function b(e){let t;try{t=h.decode(e)}catch(e){throw new Error("Not a valid DAG-JOSE object")}if("payload"in(r=t)&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures))return function(e){const t={payload:i(e.payload),signatures:e.signatures.map(c)};return t.link=o.TO.decode(new Uint8Array(e.payload)),t}(t);if(function(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}(t))return function(e){const t={ciphertext:i(e.ciphertext),protected:i(e.protected),iv:i(e.iv),tag:i(e.tag)};return e.aad&&(t.aad=i(e.aad)),e.recipients&&(t.recipients=e.recipients.map(l)),e.unprotected&&(t.unprotected=e.unprotected),t}(t);throw new Error("Not a valid DAG-JOSE object");var r}},88080:function(e,t,r){"use strict";r.d(t,{f:function(){return a}});var n=r(61563),i=r(96825),s=r(87583),o=r(526);class a{put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield r}async*getMany(e,t={}){for await(const r of e)yield{key:r,value:await this.get(r,t)}}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await(0,n.A)(this.putMany(e,r)),e=[],await(0,n.A)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix){const t=e.prefix;r=(0,i.A)(r,(e=>e.key.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,i.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>(0,s.A)(e,t)),r)),null!=e.offset){let t=0;const n=e.offset;r=(0,i.A)(r,(()=>t++>=n))}return null!=e.limit&&(r=(0,o.A)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix){const t=e.prefix;r=(0,i.A)(r,(e=>e.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,i.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>(0,s.A)(e,t)),r)),null!=e.offset){const t=e.offset;let n=0;r=(0,i.A)(r,(()=>n++>=t))}return null!=e.limit&&(r=(0,o.A)(r,e.limit)),r}}},81178:function(e,t,r){"use strict";r.r(t),r.d(t,{abortedError:function(){return u},dbDeleteFailedError:function(){return s},dbOpenFailedError:function(){return i},dbReadFailedError:function(){return a},dbWriteFailedError:function(){return o},notFoundError:function(){return c}});var n=r(66310);function i(e){return e=e??new Error("Cannot open database"),n(e,"ERR_DB_OPEN_FAILED")}function s(e){return e=e??new Error("Delete failed"),n(e,"ERR_DB_DELETE_FAILED")}function o(e){return e=e??new Error("Write failed"),n(e,"ERR_DB_WRITE_FAILED")}function a(e){return e=e??new Error("Read failed"),n(e,"ERR_DB_READ_FAILED")}function c(e){return e=e??new Error("Not Found"),n(e,"ERR_NOT_FOUND")}function u(e){return e=e??new Error("Aborted"),n(e,"ERR_ABORTED")}},65857:function(e,t,r){"use strict";r.d(t,{fD:function(){return o.f},I:function(){return n},bk:function(){return a.b}});var n=r(81178),i=r(17538);const s="SHARDING";var o=r(88080),a=r(91618);r(97101);r(81033);class c extends o.f{child;transform;constructor(e,t){super(),this.child=e,this.transform=t}async put(e,t,r){return await this.child.put(this.transform.convert(e),t,r),e}async get(e,t){return this.child.get(this.transform.convert(e),t)}async has(e,t){return this.child.has(this.transform.convert(e),t)}async delete(e,t){await this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){const r=this.transform,n=this.child;yield*(0,it_pipe_dist_src.F)(e,(async function*(e){yield*dist_src(e,(({key:e,value:t})=>({key:r.convert(e),value:t})))}),(async function*(e){yield*n.putMany(e,t)}),(async function*(e){yield*dist_src(e,(e=>r.invert(e)))}))}async*getMany(e,t={}){const r=this.transform,n=this.child;yield*(0,it_pipe_dist_src.F)(e,(async function*(e){yield*dist_src(e,(e=>r.convert(e)))}),(async function*(e){yield*n.getMany(e,t)}),(async function*(e){yield*dist_src(e,(({key:e,value:t})=>({key:r.invert(e),value:t})))}))}async*deleteMany(e,t={}){const r=this.transform,n=this.child;yield*(0,it_pipe_dist_src.F)(e,(async function*(e){yield*dist_src(e,(e=>r.convert(e)))}),(async function*(e){yield*n.deleteMany(e,t)}),(async function*(e){yield*dist_src(e,(e=>r.invert(e)))}))}batch(){const e=this.child.batch();return{put:(t,r)=>{e.put(this.transform.convert(t),r)},delete:t=>{e.delete(this.transform.convert(t))},commit:async t=>{await e.commit(t)}}}query(e,t){const r={...e};r.filters=(r.filters??[]).map((e=>({key:t,value:r})=>e({key:this.transform.convert(t),value:r})));const{prefix:n}=e;return null!=n&&"/"!==n&&(delete r.prefix,r.filters.push((({key:e})=>this.transform.invert(e).toString().startsWith(n)))),null!=r.orders&&(r.orders=r.orders.map((e=>(t,r)=>e({key:this.transform.invert(t.key),value:t.value},{key:this.transform.invert(r.key),value:r.value})))),dist_src(this.child.query(r,t),(({key:e,value:t})=>({key:this.transform.invert(e),value:t})))}queryKeys(e,t){const r={...e};r.filters=(r.filters??[]).map((e=>t=>e(this.transform.convert(t))));const{prefix:n}=e;return null!=n&&"/"!==n&&(delete r.prefix,r.filters.push((e=>this.transform.invert(e).toString().startsWith(n)))),null!=r.orders&&(r.orders=r.orders.map((e=>(t,r)=>e(this.transform.invert(t),this.transform.invert(r))))),dist_src(this.child.queryKeys(r,t),(e=>this.transform.invert(e)))}}new i.U(s);class u extends o.f{child;shard;constructor(e,t){super(),this.child=new c(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){this.shard=await u.create(this.child,this.shard)}_convertKey(e){const t=e.toString();if(t===shardKey.toString())return e;return new i.U(this.shard.fun(t)).child(e)}_invertKey(e){return e.toString()===shardKey.toString()?e:i.U.withNamespaces(e.list().slice(1))}static async create(e,t){if(!await e.has(shardKey)){if(null==t)throw n.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));await e.put(shardKey,(new TextEncoder).encode(t.toString()+"\n"))}null==t&&await readShardFun("/",e);const r=await readShardFun("/",e),i=r.toString(),s=t.toString();if(i!==s)throw new Error(`specified fun ${s} does not match repo shard fun ${i}`);return r}async put(e,t,r){return await this.child.put(e,t,r),e}async get(e,t){return this.child.get(e,t)}async has(e,t){return this.child.has(e,t)}async delete(e,t){await this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){const r={...e,filters:[({key:e})=>e.toString()!==shardKey.toString()].concat(e.filters??[])};return this.child.query(r,t)}queryKeys(e,t){const r={...e,filters:[e=>e.toString()!==shardKey.toString()].concat(e.filters??[])};return this.child.queryKeys(r,t)}}r(96825),r(97313);class l extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}r(87583),r(526);class h extends o.f{mounts;constructor(e){super(),this.mounts=e.slice()}_lookup(e){for(const t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e))return{datastore:t.datastore,mountpoint:t.prefix}}async put(e,t,r){const i=this._lookup(e);if(null==i)throw n.dbWriteFailedError(new Error("No datastore mounted for this key"));return await i.datastore.put(e,t,r),e}async get(e,t={}){const r=this._lookup(e);if(null==r)throw n.notFoundError(new Error("No datastore mounted for this key"));return r.datastore.get(e,t)}async has(e,t){const r=this._lookup(e);return null==r?Promise.resolve(!1):r.datastore.has(e,t)}async delete(e,t){const r=this._lookup(e);if(null==r)throw n.dbDeleteFailedError(new Error("No datastore mounted for this key"));await r.datastore.delete(e,t)}batch(){const e={},t=t=>{const r=this._lookup(t);if(null==r)throw new Error("No datastore mounted for this key");const n=r.mountpoint.toString();return null==e[n]&&(e[n]=r.datastore.batch()),{batch:e[n]}};return{put:(e,r)=>{t(e).batch.put(e,r)},delete:e=>{t(e).batch.delete(e)},commit:async t=>{await Promise.all(Object.keys(e).map((async r=>{await e[r].commit(t)})))}}}query(e,t){const r=this.mounts.map((r=>r.datastore.query({prefix:e.prefix,filters:e.filters},t)));let n=it_merge_dist_src(...r);if(null!=e.filters&&e.filters.forEach((e=>{(0,it_filter_dist_src.A)(n,e)})),null!=e.orders&&e.orders.forEach((e=>{(0,it_sort_dist_src.A)(n,e)})),null!=e.offset){let t=0;const r=e.offset;(0,it_filter_dist_src.A)(n,(()=>t++>=r))}return null!=e.limit&&(0,it_take_dist_src.A)(n,e.limit),n}queryKeys(e,t){const r=this.mounts.map((r=>r.datastore.queryKeys({prefix:e.prefix,filters:e.filters},t)));let n=it_merge_dist_src(...r);if(null!=e.filters&&e.filters.forEach((e=>{(0,it_filter_dist_src.A)(n,e)})),null!=e.orders&&e.orders.forEach((e=>{(0,it_sort_dist_src.A)(n,e)})),null!=e.offset){let t=0;const r=e.offset;(0,it_filter_dist_src.A)(n,(()=>t++>=r))}return null!=e.limit&&(0,it_take_dist_src.A)(n,e.limit),n}}var d=r(17833);var f=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);class p{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class y{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return m(this,e)}}class g{constructor(e){this.decoders=e}or(e){return m(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const m=(e,t)=>new g({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class b{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new p(e,t,r),this.decoder=new y(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const w=({name:e,prefix:t,encode:r,decode:n})=>new b(e,t,r,n),v=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=f(r,t);return w({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},_=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>w({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),E=_({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),S=(_({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),v({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),x=(v({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));_({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});d.formatters.b=e=>null==e?"undefined":S.baseEncode(e),d.formatters.t=e=>null==e?"undefined":E.baseEncode(e),d.formatters.m=e=>null==e?"undefined":x.baseEncode(e),d.formatters.p=e=>null==e?"undefined":e.toString(),d.formatters.c=e=>null==e?"undefined":e.toString(),d.formatters.k=e=>null==e?"undefined":e.toString(),d.formatters.a=e=>null==e?"undefined":e.toString();r(61563),r(48651);!function(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);d.enabled(`${e}:trace`)&&null!=d.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=d(`${e}:trace`)),Object.assign(d(e),{error:d(`${e}:error`),trace:t})}("datastore:core:tiered");class A extends o.f{stores;constructor(e){super(),this.stores=e.slice()}async put(e,t,r){try{return await Promise.all(this.stores.map((async n=>{await n.put(e,t,r)}))),e}catch(e){throw n.dbWriteFailedError(e)}}async get(e,t){for(const r of this.stores)try{const n=await r.get(e,t);if(null!=n)return n}catch(e){log.error(e)}throw n.notFoundError()}async has(e,t){for(const r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map((async r=>{await r.delete(e,t)})))}catch(e){throw n.dbDeleteFailedError(e)}}async*putMany(e,t={}){let r;const n=this.stores.map((e=>{const r=(0,it_pushable_dist_src.N)({objectMode:!0});return(0,it_drain_dist_src.A)(e.putMany(r,t)).catch((e=>{e})),r}));try{for await(const t of e){if(null!=r)throw r;n.forEach((e=>e.push(t))),yield t.key}}finally{n.forEach((e=>e.end()))}}async*deleteMany(e,t={}){let r;const n=this.stores.map((e=>{const r=(0,it_pushable_dist_src.N)({objectMode:!0});return(0,it_drain_dist_src.A)(e.deleteMany(r,t)).catch((e=>{e})),r}));try{for await(const t of e){if(null!=r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}batch(){const e=this.stores.map((e=>e.batch()));return{put:(t,r)=>{e.forEach((e=>{e.put(t,r)}))},delete:t=>{e.forEach((e=>{e.delete(t)}))},commit:async t=>{for(const r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}},91618:function(e,t,r){"use strict";r.d(t,{b:function(){return o}});var n=r(17538),i=r(88080),s=r(81178);class o extends i.f{data;constructor(){super(),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){const t=this.data.get(e.toString());if(null==t)throw s.notFoundError();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(const[e,t]of this.data.entries())yield{key:new n.U(e),value:t}}*_allKeys(){for(const e of this.data.keys())yield new n.U(e)}}},17538:function(e,t,r){"use strict";r.d(t,{U:function(){return c}});var n=r(16676),i=r(98067);const s="/",o=(new TextEncoder).encode(s),a=o[0];class c{_buf;constructor(e,t){if("string"==typeof e)this._buf=(0,n.s)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==a)throw new Error("Invalid key")}toString(e="utf8"){return(0,i.d)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new c(e.join(s))}static random(){return new c(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new c(e):"function"==typeof e.uint8Array?new c(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=o),this._buf[0]!==a){const e=new Uint8Array(this._buf.byteLength+1);e.fill(a,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===a;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],i=r[e];if(n<i)return!0;if(n>i)return!1}return t.length<r.length}reverse(){return c.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(s).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new c(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(s)||(e+=s),e+=this.type(),new c(e)}parent(){const e=this.list();return 1===e.length?new c(s):new c(e.slice(0,-1).join(s))}child(e){return this.toString()===s?e:e.toString()===s?this:new c(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return c.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}},61563:function(e,t){"use strict";t.A=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);}},96825:function(e,t,r){"use strict";var n=r(97101);t.A=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r)&&(yield r)}();const r=(0,n.A)(e),{value:i,done:s}=r.next();if(!0===s)return function*(){}();const o=t(i);if("function"==typeof o.then)return async function*(){await o&&(yield i);for await(const e of r)await t(e)&&(yield e)}();const a=t;return function*(){!0===o&&(yield i);for(const e of r)a(e)&&(yield e)}()}},87583:function(e,t,r){"use strict";r.d(t,{A:function(){return i}});var n=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const r of e)t.push(r);return t})();const t=[];for(const r of e)t.push(r);return t};var i=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){const r=await n(e);yield*r.sort(t)}():function*(){const r=n(e);yield*r.sort(t)}()}},526:function(e,t){"use strict";t.A=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}():function*(){let r=0;if(!(t<1))for(const n of e)if(yield n,r++,r===t)return}()}},96059:function(e,t,r){"use strict";r.d(t,{t:function(){return y}});var n=r(65857),i=r(96148);var s=r(98067),o=r(16676);const a="/",c=(new TextEncoder).encode(a),u=c[0];class l{constructor(e,t){if("string"==typeof e)this._buf=(0,o.s)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==u)throw new Error("Invalid key")}toString(e="utf8"){return(0,s.d)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new l(e.join(a))}static random(){return new l(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new l(e):"function"==typeof e.uint8Array?new l(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=c),this._buf[0]!==u){const e=new Uint8Array(this._buf.byteLength+1);e.fill(u,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===u;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],i=r[e];if(n<i)return!0;if(n>i)return!1}return t.length<r.length}reverse(){return l.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(a).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new l(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(a)||(e+=a),e+=this.type(),new l(e)}parent(){const e=this.list();return 1===e.length?new l(a):new l(e.slice(0,-1).join(a))}child(e){return this.toString()===a?e:e.toString()===a?this:new l(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return l.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}var h=r(97101);var d=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r)&&(yield r)}();const r=(0,h.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s.then)return async function*(){await s&&(yield n);for await(const e of r)await t(e)&&(yield e)}();const o=t;return function*(){!0===s&&(yield n);for(const e of r)o(e)&&(yield e)}()};var f=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const r of e)t.push(r);return t})();const t=[];for(const r of e)t.push(r);return t};var p=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){const r=await f(e);yield*r.sort(t)}():function*(){const r=f(e);yield*r.sort(t)}()};class y extends n.fD{location;version;db;constructor(e,t={}){super(),this.location=`${t.prefix??""}${e}`,this.version=t.version??1}async open(){try{const e=this.location;this.db=await(0,i.P2)(e,this.version,{upgrade(t){t.createObjectStore(e)}})}catch(e){throw n.I.dbOpenFailedError(e)}}async close(){this.db?.close()}async put(e,t){if(null==this.db)throw new Error("Datastore needs to be opened.");try{return await this.db.put(this.location,t,e.toString()),e}catch(e){throw n.I.dbWriteFailedError(e)}}async get(e){if(null==this.db)throw new Error("Datastore needs to be opened.");let t;try{t=await this.db.get(this.location,e.toString())}catch(e){throw n.I.dbReadFailedError(e)}if(void 0===t)throw n.I.notFoundError();return t}async has(e){if(null==this.db)throw new Error("Blockstore needs to be opened.");try{return Boolean(await this.db.getKey(this.location,e.toString()))}catch(e){throw n.I.dbReadFailedError(e)}}async delete(e){if(null==this.db)throw new Error("Datastore needs to be opened.");try{await this.db.delete(this.location,e.toString())}catch(e){throw n.I.dbWriteFailedError(e)}}batch(){const e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async()=>{if(null==this.db)throw new Error("Datastore needs to be opened.");const r=this.db.transaction(this.location,"readwrite");try{const n=e.filter((({key:e})=>null==t.find((t=>t.toString()===e.toString())))).map((e=>async()=>{await r.store.put(e.value,e.key.toString())})).concat(t.map((e=>async()=>{await r.store.delete(e.toString())}))).concat((async()=>{await r.done}));await Promise.all(n.map((async e=>{await e()})))}catch{r.abort()}}}}async*query(e){let t=this.#r(e,((e,t)=>({key:e,value:t})));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>d(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>p(e,t)),t)),yield*t}async*queryKeys(e){let t=this.#r(e,(e=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>d(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>p(e,t)),t)),yield*t}async*#r(e,t){if(null==this.db)throw new Error("Datastore needs to be opened.");let r=0,n=-1;for(const i of await this.db.getAllKeys(this.location)){if(null!=e.prefix&&!i.toString().startsWith(e.prefix))continue;if(null!=e.limit&&r===e.limit)return;if(n++,null!=e.offset&&n<e.offset)continue;const s=new l(i.toString());let o;try{o=await this.get(s)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e;continue}null!=o&&(yield t(s,o),r++)}}async destroy(){await(0,i.MR)(this.location)}}},77618:function(e,t,r){"use strict";r.d(t,{Q:function(){return b}});var n=r(53301),i=r(66310);function s(e){return e=e||new Error("Cannot open database"),i(e,"ERR_DB_OPEN_FAILED")}function o(e){return e=e||new Error("Delete failed"),i(e,"ERR_DB_DELETE_FAILED")}function a(e){return e=e||new Error("Write failed"),i(e,"ERR_DB_WRITE_FAILED")}function c(e){return e=e||new Error("Not Found"),i(e,"ERR_NOT_FOUND")}r(30256);const u="SHARDING";const l=(e,t)=>async function*(){const r=await async function(e){const t=[];for await(const r of e)t.push(r);return t}(e);yield*r.sort(t)}();var h=r(8306),d=r(40506),f=r(66213);class p{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await(0,h.A)(this.putMany(e,r)),e=[],await(0,h.A)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=(0,d.A)(r,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>l(e,t)),r)),null!=e.offset){let t=0;r=(0,d.A)(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=(0,f.A)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=(0,d.A)(r,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>l(e,t)),r)),null!=e.offset){let t=0;r=(0,d.A)(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=(0,f.A)(r,e.limit)),r}}var y=r(47390);r(48651),r(67631);new n.U(u),new n.U("_README");(0,r(64340).vF)("datastore:core:tiered");var g=r(86602),m=r(82949);class b extends p{constructor(e,t={}){super(),this.db="string"==typeof e?new m.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw s(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(e){throw a(e)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(e){if(e.notFound)throw c(e);throw a(e)}return t}async has(e){try{await this.db.get(e.toString())}catch(e){if(e.notFound)return!1;throw e}return!0}async delete(e){try{await this.db.del(e.toString())}catch(e){throw o(e)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>(0,g.A)(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=(0,d.A)(t,(()=>e++>=r))}return n&&(t=(0,f.A)(t,n)),t}queryKeys(e){let t=(0,y.A)(this._query({values:!1,prefix:e.prefix}),(({key:e})=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>(0,d.A)(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>(0,g.A)(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=(0,d.A)(t,(()=>e++>=r))}return n&&(t=(0,f.A)(t,n)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const r=e.prefix.toString();t.gte=r,t.lt=r+""}const r=this.db.iterator(t);if(r[Symbol.asyncIterator])return async function*(e){for await(const[t,r]of e)yield{key:new n.U(t,!1),value:r};await e.close()}(r);if(null!=r.next&&null!=r.end)return i=r,{[Symbol.asyncIterator]:()=>({next:()=>new Promise(((e,t)=>{i.next(((r,s,o)=>r?t(r):null==s?i.end((r=>{if(r)return t(r);e({done:!0,value:void 0})})):void e({done:!1,value:{key:new n.U(s,!1),value:o}})))})),return:()=>new Promise(((e,t)=>{i.end((r=>{if(r)return t(r);e({done:!0,value:void 0})}))}))})};var i;throw new Error("Level returned incompatible iterator")}}},81070:function(e,t,r){"use strict";r.d(t,{D:function(){return w}});var n=r(53301);r(66310);r(30256);const i="SHARDING";const s=(e,t)=>async function*(){const r=await async function(e){const t=[];for await(const r of e)t.push(r);return t}(e);yield*r.sort(t)}();var o=r(8306),a=r(40506),c=r(66213);class u{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await(0,o.A)(this.putMany(e,r)),e=[],await(0,o.A)(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=(0,a.A)(r,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,a.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>s(e,t)),r)),null!=e.offset){let t=0;r=(0,a.A)(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=(0,c.A)(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=(0,a.A)(r,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>(0,a.A)(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>s(e,t)),r)),null!=e.offset){let t=0;r=(0,a.A)(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=(0,c.A)(r,e.limit)),r}}r(47390),r(48651),r(67631);new n.U(i),new n.U("_README");var l=r(64340);(0,l.vF)("datastore:core:tiered");var h=r(17729),d=r(98067),f=r(16676);const p="/record/";function y(e){return(0,d.d)(e,"base32")}function g(e){("string"==typeof e||e instanceof String)&&(e=(0,f.s)(e.toString()));const t=(0,d.d)(e,"base64url");return`${p}${t}`}var m=r(94145);const b=(0,l.vF)("datastore-pubsub:publisher");class w extends u{constructor(e,t,r,n,i,s){if(super(),!n)throw new h.A("missing validator","ERR_INVALID_PARAMETERS");if("function"!=typeof n)throw new h.A("missing validate function","ERR_INVALID_PARAMETERS");if("function"!=typeof i)throw new h.A("missing select function","ERR_INVALID_PARAMETERS");if(s&&"function"!=typeof s)throw new h.A("invalid subscriptionKeyFn received","ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=n,this._selector=i,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t,r){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw b.error(e),new h.A(e,"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw b.error(e),new h.A(e,"ERR_INVALID_VALUE_RECEIVED")}const n=g(e);b(`publish value for topic ${n}`),await this._pubsub.publish(n,t)}async get(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw b.error(e),new h.A(e,"ERR_INVALID_DATASTORE_KEY")}const r=g(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e,t);try{await this._pubsub.subscribe(r)}catch(e){const t=`cannot subscribe topic ${r}`;throw b.error(t),new h.A(t,"ERR_SUBSCRIBING_TOPIC")}return b(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){const t=g(e);return this._pubsub.unsubscribe(t)}async _getLocal(e,t){const r=new n.U("/"+y(e),!1);let i;try{i=await this._datastore.get(r,t)}catch(e){if("ERR_NOT_FOUND"!==e.code){const e=`unexpected error getting the ipns record for ${r.toString()}`;throw b.error(e),new h.A(e,"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const t=`local record requested was not found for ${r.toString()}`;throw b.error(t),new h.A(t,"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw b.error(e),new h.A(e,"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){const t=e.detail;if("signed"!==t.type)return void b.error("unsigned message received, this module can only work with signed messages");const{data:r,from:n,topic:i}=t;let s;try{s=function(e){if(e.substring(0,p.length)!==p)throw new h.A("topic received is not from a record","ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const t=e.substring(p.length);return(0,f.s)(t,"base64url")}(i)}catch(e){return void b.error(e)}if(b(`message received for topic ${i}`),this._peerId.equals(n))b("message discarded as it is from the same peer");else{if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(s)}catch(e){return void b.error("message discarded by the subscriptionKeyFn")}s=e}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(e){b.error(e)}}}async _storeIfSubscriptionIsBetter(e,t,r){let n=!1;try{n=await this._isBetter(e,t)}catch(e){if("ERR_NOT_VALID_RECORD"!==e.code)throw e}n&&await this._storeRecord(e,t,r)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){return 0===await this._selector(e,t)}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch(e){const t="record received through pubsub is not valid";throw b.error(t),new h.A(t,"ERR_NOT_VALID_RECORD")}const r=new n.U(e);let i;try{i=await this._getLocal(r.uint8Array())}catch(e){return!0}return!(0,m.a)(i,t)&&this._selectRecord(e,[i,t])}async _storeRecord(e,t,r){const i=new n.U("/"+y(e),!1);await this._datastore.put(i,t,r),b(`record for ${g(e)} was stored in the datastore`)}}},76629:function(e,t,r){"use strict";r.d(t,{A:function(){return h}});var n=r(17833),i=r(2823);const s=globalThis.fetch,o=globalThis.Headers;globalThis.Request,globalThis.Response;function a(e,t,r){return`${e}?name=${t}&type=${r}`}async function c(e,t){const r=await s(e,{headers:new o({accept:"application/dns-json"}),signal:t});return await r.json()}function u(e,t){return`${t}_${e}`}const l=Object.assign(n("dns-over-http-resolver"),{error:n("dns-over-http-resolver:error")});var h=class{constructor(e={}){this._cache=new i({max:e?.maxCache??100}),this._TXTcache=new i({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??c,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>e.abort()))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){const t="A",r=this._cache.get(u(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const i=new AbortController;this._abortControllers.push(i);try{const n=await this._request(a(r,e,t),i.signal),s=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(u(e,t),s,{ttl:o}),s}catch(s){i.signal.aborted&&(n=!0),l.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==i))}}if(n)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){const t="AAAA",r=this._cache.get(u(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const i=new AbortController;this._abortControllers.push(i);try{const n=await this._request(a(r,e,t),i.signal),s=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(u(e,t),s,{ttl:o}),s}catch(s){i.signal.aborted&&(n=!0),l.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==i))}}if(n)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){const t="TXT",r=this._TXTcache.get(u(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const i=new AbortController;this._abortControllers.push(i);try{const n=await this._request(a(r,e,t),i.signal),s=n.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._TXTcache.set(u(e,t),s,{ttl:o}),s}catch(s){i.signal.aborted&&(n=!0),l.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==i))}}if(n)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}},84480:function(e,t,r){"use strict";r.d(t,{yQ:function(){return G},_7:function(){return E},dY:function(){return z},qg:function(){return H}});const n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const i=Object.create(null);Object.keys(n).forEach((e=>{i[n[e]]=e}));const s={type:"error",data:"parser error"},o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),a="function"==typeof ArrayBuffer,c=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};var u=({type:e,data:t},r,i)=>{return o&&t instanceof Blob?r?i(t):c(t,i):a&&(t instanceof ArrayBuffer||(s=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer))?r?i(t):c(new Blob([t]),i):i(n[e]+(t||""));var s};const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<l.length;e++)h[l.charCodeAt(e)]=e;const d="function"==typeof ArrayBuffer,f=(e,t)=>{if(d){const r=(e=>{let t,r,n,i,s,o=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const u=new ArrayBuffer(o),l=new Uint8Array(u);for(t=0;t<a;t+=4)r=h[e.charCodeAt(t)],n=h[e.charCodeAt(t+1)],i=h[e.charCodeAt(t+2)],s=h[e.charCodeAt(t+3)],l[c++]=r<<2|n>>4,l[c++]=(15&n)<<4|i>>2,l[c++]=(3&i)<<6|63&s;return u})(e);return p(r,t)}return{base64:!0,data:e}},p=(e,t)=>"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e;var y=(e,t)=>{if("string"!=typeof e)return{type:"message",data:p(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:f(e.substring(1),t)};return i[r]?e.length>1?{type:i[r],data:e.substring(1)}:{type:i[r]}:s};const g=String.fromCharCode(30);var m=r(87122);const b="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function w(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const v=b.setTimeout,_=b.clearTimeout;function E(e,t){t.useNativeTimers?(e.setTimeoutFn=v.bind(b),e.clearTimeoutFn=_.bind(b)):(e.setTimeoutFn=b.setTimeout.bind(b),e.clearTimeoutFn=b.clearTimeout.bind(b))}class S extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class x extends m.v{constructor(e){super(),this.writable=!1,E(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new S(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=y(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}}const A="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),k=64,I={};let T,P=0,C=0;function R(e){let t="";do{t=A[e%k]+t,e=Math.floor(e/k)}while(e>0);return t}function O(){const e=R(+new Date);return e!==T?(P=0,T=e):e+"."+R(P++)}for(;C<k;C++)I[A[C]]=C;function D(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}let B=!1;try{B="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const N=B;function M(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||N))return new XMLHttpRequest}catch(e){}if(!t)try{return new(b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function U(){}const L=null!=new M({xdomain:!1}).responseType;class j extends m.v{constructor(e,t){super(),E(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=w(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new M(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=j.requestsCount++,j.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=U,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete j.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(j.requestsCount=0,j.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",F);else if("function"==typeof addEventListener){addEventListener("onpagehide"in b?"pagehide":"unload",F,!1)}function F(){for(let e in j.requests)j.requests.hasOwnProperty(e)&&j.requests[e].abort()}const z="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),$=b.WebSocket||b.MozWebSocket;r(62045).hp;const K="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const V={websocket:class extends x{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=K?{}:w(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=K?new $(e,t,r):t?new $(e,t):new $(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;u(r,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}n&&z((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=O()),this.supportsBinary||(e.b64=1);const n=D(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!$}},polling:class extends x{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=L&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const r=e.split(g),n=[];for(let e=0;e<r.length;e++){const i=y(r[e],t);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let i=0;e.forEach(((e,s)=>{u(e,!1,(e=>{n[s]=e,++i===r&&t(n.join(g))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=O()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);const n=D(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new j(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},q=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,W=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function H(e){const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=q.exec(e||""),s={},o=14;for(;o--;)s[W[o]]=i[o]||"";return-1!=r&&-1!=n&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,s.path),s.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,s.query),s}class G extends m.v{constructor(e,t={}){super(),this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=H(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=H(t.host).host),E(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new V[e](r)}open(){let e;if(this.opts.rememberUpgrade&&G.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),r=!1;G.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;G.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){r||(r=!0,u(),t.close(),t=null)}const s=e=>{const r=new Error("probe error: "+e);r.transport=t.name,i(),this.emitReserved("upgradeError",r)};function o(){s("transport closed")}function a(){s("socket closed")}function c(e){t&&e.name!==t.name&&i()}const u=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",n),t.once("error",s),t.once("close",o),this.once("close",a),this.once("upgrading",c),t.open()}onOpen(){if(this.readyState="open",G.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(e+="string"==typeof(t=n)?function(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(t):Math.ceil(1.33*(t.byteLength||t.size))),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}var t;return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){G.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}G.protocol=4;G.protocol},44554:function(e,t,r){"use strict";r.d(t,{BI:function(){return c}});r(77286);var n=r(48287),i=r(4017),s=r(56363);const o={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4};var a=r(96055);async function c(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Uint8Array?e:new Uint8Array(e);if(t?.length>1)return l(s.vY(t))}function u(e,t,r){r={offset:0,...r};for(const[n,i]of t.entries())if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function l(e){try{return(new h).parse(e)}catch(e){if(!(e instanceof s.d1))throw e}}class h{check(e,t){return u(this.buffer,e,t)}checkString(e,t){return this.check((r=e,[...r].map((e=>e.charCodeAt(0)))),t);var r}async parse(e){if(this.buffer=n.Buffer.alloc(4100),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const t=await e.readToken(o);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),l(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const r={compressedSize:this.buffer.readUInt32LE(18),uncompressedSize:this.buffer.readUInt32LE(22),filenameLength:this.buffer.readUInt16LE(26),extraFieldLength:this.buffer.readUInt16LE(28)};if(r.filename=await e.readToken(new i.cT(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),"META-INF/mozilla.rsa"===r.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml")){switch(r.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===r.filename&&r.compressedSize===r.uncompressedSize){let a=await e.readToken(new i.cT(r.compressedSize,"utf-8"));switch(a=a.trim(),a){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===r.compressedSize){let c=-1;for(;c<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),c=this.buffer.indexOf("504B0304",0,"hex"),await e.ignore(c>=0?c:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(h){if(!(h instanceof s.d1))throw h}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const d=n.Buffer.alloc(8);return await e.readBuffer(d),u(d,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:u(d,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:u(d,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:u(d,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:u(d,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:u(d,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&0!=(96&this.buffer[8])){const f=this.buffer.toString("binary",8,12).replace("\0"," ").trim();switch(f){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return f.startsWith("3g")?f.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const p=10485760,y=n.Buffer.alloc(Math.min(p,e.fileInfo.size));if(await e.readBuffer(y,{mayBeLess:!0}),y.includes(n.Buffer.from("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(g){if(!(g instanceof s.d1))throw g}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const m=await this.readTiffHeader(!1);if(m)return m}if(this.check([77,77])){const b=await this.readTiffHeader(!0);if(b)return b}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function w(){const t=await e.peekNumber(i.hp);let r=128,s=0;for(;0==(t&r)&&0!==r;)++s,r>>=1;const o=n.Buffer.alloc(s+1);return await e.readBuffer(o),o}async function v(){const e=await w(),t=await w();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function _(t){for(;t>0;){const r=await v();if(17026===r.id){return(await e.readToken(new i.cT(r.len,"utf-8"))).replace(/\00.*$/g,"")}await e.ignore(r.len),--t}}const E=await v();switch(await _(E.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const S=this.buffer.toString("binary",2,6);if(S.match("^d*")&&S>=1e3&&S<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new i.cT(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){async function x(){return{length:await e.readToken(i.T9),type:await e.readToken(new i.cT(4,"binary"))}}await e.ignore(8);do{const A=await x();if(A.length<0)return;switch(A.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(A.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function k(){const t=n.Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(i.D0))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const I=await k();let T=I.size-24;if(u(I.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const P=n.Buffer.alloc(16);if(T-=await e.readBuffer(P),u(P,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(u(P,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(T)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new i.cT(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const C=this.buffer.readUInt32LE(12);if(C>12&&this.buffer.length>=C+16)try{const R=this.buffer.slice(16,C+16).toString();if(JSON.parse(R).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),function(e,t=0){const r=Number.parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(r))return!1;let n=256;for(let r=t;r<t+148;r++)n+=e[r];for(let r=t+156;r<t+512;r++)n+=e[r];return r===n}(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const t=await this.tokenizer.readToken(e?i.y7:i.aU);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const t=await this.tokenizer.readToken(e?i.y7:i.aU);for(let r=0;r<t;++r){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const t=(e?i.y7:i.aU).get(this.buffer,2),r=(e?i.a2:i.M_).get(this.buffer,4);if(42===t){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}await this.tokenizer.ignore(r);return await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(43===t)return{ext:"tif",mime:"image/tiff"}}}new Set(a.X),new Set(a.O)},97907:function(e,t,r){"use strict";r.d(t,{l4:function(){return w}});const n={parse:JSON.parse,stringify:JSON.stringify};var i=r(64767),s=r(47169),o=r(29339);const a=e=>i(e)||null!==e&&"object"==typeof e&&"function"==typeof e.pipe;var c=(e,t,r,i=n)=>{const{clone:c,files:u}=s({query:e,variables:t,operationName:r},"",a);if(0===u.size){if(!Array.isArray(e))return i.stringify(c);if(void 0!==t&&!Array.isArray(t))throw new Error("Cannot create request body with given variable type, array expected");const r=e.reduce(((e,r,n)=>(e.push({query:r,variables:t?t[n]:void 0}),e)),[]);return i.stringify(r)}const l=new("undefined"==typeof FormData?o:FormData);l.append("operations",i.stringify(c));const h={};let d=0;return u.forEach((e=>{h[++d]=e})),l.append("map",i.stringify(h)),d=0,u.forEach(((e,t)=>{l.append(""+ ++d,t)})),l};var u=r(70350),l=r(75148);const h=e=>{let t;const r=e.definitions.filter((e=>"OperationDefinition"===e.kind));return 1===r.length&&(t=r[0]?.name?.value),t},d=e=>{if("string"==typeof e){let t;try{const r=(0,u.qg)(e);t=h(r)}catch(e){}return{query:e,operationName:t}}const t=h(e);return{query:(0,l.y)(e),operationName:t}};class f extends Error{constructor(e,t){super(`${f.extractMessage(e)}: ${JSON.stringify({response:e,request:t})}`),Object.setPrototypeOf(this,f.prototype),this.response=e,this.request=t,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,f)}static extractMessage(e){return e.errors?.[0]?.message??`GraphQL Error (Code: ${e.status})`}}var p=r(74945),y=r.t(p,2);r(96763);const g=e=>{let t={};return e&&("undefined"!=typeof Headers&&e instanceof Headers||y&&p.Headers&&e instanceof p.Headers?t=(e=>{const t={};return e.forEach(((e,r)=>{t[r]=e})),t})(e):Array.isArray(e)?e.forEach((([e,r])=>{e&&void 0!==r&&(t[e]=r)})):t=e),t},m=e=>e.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),b=e=>async t=>{const{url:r,query:i,variables:s,operationName:o,fetch:a,fetchOptions:u,middleware:l}=t,h={...t.headers};let d,f="";"POST"===e?(d=c(i,s,o,u.jsonSerializer),"string"==typeof d&&(h["Content-Type"]="application/json")):f=(e=>{if(!Array.isArray(e.query)){const t=e,r=[`query=${encodeURIComponent(m(t.query))}`];return e.variables&&r.push(`variables=${encodeURIComponent(t.jsonSerializer.stringify(t.variables))}`),t.operationName&&r.push(`operationName=${encodeURIComponent(t.operationName)}`),r.join("&")}if(void 0!==e.variables&&!Array.isArray(e.variables))throw new Error("Cannot create query with given variable type, array expected");const t=e,r=e.query.reduce(((e,r,n)=>(e.push({query:m(r),variables:t.variables?t.jsonSerializer.stringify(t.variables[n]):void 0}),e)),[]);return`query=${encodeURIComponent(t.jsonSerializer.stringify(r))}`})({query:i,variables:s,operationName:o,jsonSerializer:u.jsonSerializer??n});const p={method:e,headers:h,body:d,...u};let y=r,g=p;if(l){const e=await Promise.resolve(l({...p,url:r,operationName:o,variables:s})),{url:t,...n}=e;y=t,g=n}return f&&(y=`${y}?${f}`),await a(y,g)};class w{constructor(e,t={}){this.url=e,this.requestConfig=t,this.rawRequest=async(...e)=>{const[t,r,n]=e,i=((e,t,r)=>e.query?e:{query:e,variables:t,requestHeaders:r,signal:void 0})(t,r,n),{headers:s,fetch:o=p,method:a="POST",requestMiddleware:c,responseMiddleware:u,...l}=this.requestConfig,{url:h}=this;void 0!==i.signal&&(l.signal=i.signal);const{operationName:f}=d(i.query);return v({url:h,query:i.query,variables:i.variables,headers:{...g(E(s)),...g(i.requestHeaders)},operationName:f,fetch:o,method:a,fetchOptions:l,middleware:c}).then((e=>(u&&u(e),e))).catch((e=>{throw u&&u(e),e}))}}async request(e,...t){const[r,n]=t,i=((e,t,r)=>e.document?e:{document:e,variables:t,requestHeaders:r,signal:void 0})(e,r,n),{headers:s,fetch:o=p,method:a="POST",requestMiddleware:c,responseMiddleware:u,...l}=this.requestConfig,{url:h}=this;void 0!==i.signal&&(l.signal=i.signal);const{query:f,operationName:y}=d(i.document);return v({url:h,query:f,variables:i.variables,headers:{...g(E(s)),...g(i.requestHeaders)},operationName:y,fetch:o,method:a,fetchOptions:l,middleware:c}).then((e=>(u&&u(e),e.data))).catch((e=>{throw u&&u(e),e}))}batchRequests(e,t){const r=((e,t)=>e.documents?e:{documents:e,requestHeaders:t,signal:void 0})(e,t),{headers:n,...i}=this.requestConfig;void 0!==r.signal&&(i.signal=r.signal);const s=r.documents.map((({document:e})=>d(e).query)),o=r.documents.map((({variables:e})=>e));return v({url:this.url,query:s,variables:o,headers:{...g(E(n)),...g(r.requestHeaders)},operationName:void 0,fetch:this.requestConfig.fetch??p,method:this.requestConfig.method||"POST",fetchOptions:i,middleware:this.requestConfig.requestMiddleware}).then((e=>(this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(e),e.data))).catch((e=>{throw this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(e),e}))}setHeaders(e){return this.requestConfig.headers=e,this}setHeader(e,t){const{headers:r}=this.requestConfig;return r?r[e]=t:this.requestConfig.headers={[e]:t},this}setEndpoint(e){return this.url=e,this}}const v=async e=>{const{query:t,variables:r,fetchOptions:i}=e,s=b((e.method??"post").toUpperCase());const o=Array.isArray(e.query),a=await s(e),c=await _(a,i.jsonSerializer??n),u=Array.isArray(c)?!c.some((({data:e})=>!e)):Boolean(c.data),l=Array.isArray(c)||!c.errors||Array.isArray(c.errors)&&!c.errors.length||"all"===i.errorPolicy||"ignore"===i.errorPolicy;if(a.ok&&l&&u){const{errors:e,...t}=(Array.isArray(c),c),r="ignore"===i.errorPolicy?t:c;return{...o?{data:r}:r,headers:a.headers,status:a.status}}throw new f({..."string"==typeof c?{error:c}:c,status:a.status,headers:a.headers},{query:t,variables:r})};const _=async(e,t)=>{let r;return e.headers.forEach(((e,t)=>{"content-type"===t.toLowerCase()&&(r=e)})),r&&(r.toLowerCase().startsWith("application/json")||r.toLowerCase().startsWith("application/graphql+json")||r.toLowerCase().startsWith("application/graphql-response+json"))?t.parse(await e.text()):e.text()},E=e=>"function"==typeof e?e():e},16324:function(e,t,r){"use strict";r.d(t,{f:function(){return s},T:function(){return g}});var n=r(52669),i=r(16676);class s{constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new n,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof s?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof s?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce(((r,n,i)=>(null!=n&&(n instanceof s?r.push(n.serialize(e,t)):r.push(e(n,i))),r)),[]))}async asyncTransform(e,t){return await u(this,e,t)}toJSON(){return this.serialize(a,c)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof s))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"==typeof e?(0,i.s)(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof s?await n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new s(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),await e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(o);if(null!=e&&!(e instanceof s)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function o(e){return Boolean(e)}function a(e,t){return e.key}function c(e){return e}async function u(e,t,r){const n=[];for(const i of e._children.compactArray())if(i instanceof s)await u(i,t,r);else{const r=await t(i);n.push({bitField:e._children.bitField(),children:r})}return await r(n)}const l=[255,254,252,248,240,224,192,128],h=[1,3,7,15,31,63,127,255];class d{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+f(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function f(e,t,r){const n=function(e,t){return l[e]&h[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}var p=r(44008);class y{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?(0,p.x)([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new d(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function g(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:(r=e.hashFn,function(e){return e instanceof y?e:new y(e,r)})};var r;return new s(t)}},84462:function(e,t,r){"use strict";r.d(t,{g:function(){return Cf}});var n={};r.r(n),r.d(n,{base32:function(){return ue},base32hex:function(){return fe},base32hexpad:function(){return ye},base32hexpadupper:function(){return ge},base32hexupper:function(){return pe},base32pad:function(){return he},base32padupper:function(){return de},base32upper:function(){return le},base32z:function(){return me}});var i={};r.r(i),r.d(i,{base58btc:function(){return be},base58flickr:function(){return we}});var s={};r.r(s),r.d(s,{base64:function(){return ve},base64pad:function(){return _e},base64url:function(){return Ee},base64urlpad:function(){return Se}});var o={};r.r(o),r.d(o,{identity:function(){return Qe}});var a={};r.r(a),r.d(a,{sha256:function(){return nt},sha512:function(){return it}});var c={};r.r(c),r.d(c,{base36:function(){return Kr},base36upper:function(){return Vr}});var u={};r.r(u),r.d(u,{code:function(){return ti},decode:function(){return ni},encode:function(){return ri},name:function(){return ei}});var l={};r.r(l),r.d(l,{code:function(){return si},decode:function(){return ai},encode:function(){return oi},name:function(){return ii}});var h={};r.r(h),r.d(h,{base58btc:function(){return Ki},base58flickr:function(){return Vi}});var d={};r.r(d),r.d(d,{base10:function(){return qi}});var f={};r.r(f),r.d(f,{base16:function(){return Wi},base16upper:function(){return Hi}});var p={};r.r(p),r.d(p,{base2:function(){return Gi}});var y={};r.r(y),r.d(y,{base256emoji:function(){return Xi}});var g={};r.r(g),r.d(g,{base32:function(){return Qi},base32hex:function(){return ns},base32hexpad:function(){return ss},base32hexpadupper:function(){return os},base32hexupper:function(){return is},base32pad:function(){return ts},base32padupper:function(){return rs},base32upper:function(){return es},base32z:function(){return as}});var m={};r.r(m),r.d(m,{base36:function(){return cs},base36upper:function(){return us}});var b={};r.r(b),r.d(b,{base64:function(){return ls},base64pad:function(){return hs},base64url:function(){return ds},base64urlpad:function(){return fs}});var w={};r.r(w),r.d(w,{base8:function(){return ps}});var v={};r.r(v),r.d(v,{identity:function(){return ys}});var _={};r.r(_),r.d(_,{code:function(){return ws},decode:function(){return _s},encode:function(){return vs},name:function(){return bs}});var E={};r.r(E),r.d(E,{code:function(){return Ss},decode:function(){return As},encode:function(){return xs},name:function(){return Es}});var S={};r.r(S),r.d(S,{identity:function(){return Ys}});var x={};r.r(x),r.d(x,{sha256:function(){return eo},sha512:function(){return to}});var A={};r.r(A),r.d(A,{Ed25519PrivateKey:function(){return ca},Ed25519PublicKey:function(){return aa},generateKeyPair:function(){return ha},generateKeyPairFromSeed:function(){return da},unmarshalEd25519PrivateKey:function(){return ua},unmarshalEd25519PublicKey:function(){return la}});var k={};r.r(k),r.d(k,{MAX_KEY_SIZE:function(){return Aa},RsaPrivateKey:function(){return Ia},RsaPublicKey:function(){return ka},fromJwk:function(){return Ca},generateKeyPair:function(){return Ra},unmarshalRsaPrivateKey:function(){return Ta},unmarshalRsaPublicKey:function(){return Pa}});var I={};r.r(I),r.d(I,{Secp256k1PrivateKey:function(){return Na},Secp256k1PublicKey:function(){return Ba},generateKeyPair:function(){return La},unmarshalSecp256k1PrivateKey:function(){return Ma},unmarshalSecp256k1PublicKey:function(){return Ua}});var T={};r.r(T),r.d(T,{identity:function(){return nu}});var P={};r.r(P),r.d(P,{base2:function(){return iu}});var C={};r.r(C),r.d(C,{base8:function(){return su}});var R={};r.r(R),r.d(R,{base10:function(){return ou}});var O={};r.r(O),r.d(O,{base16:function(){return au},base16upper:function(){return cu}});var D={};r.r(D),r.d(D,{base32:function(){return uu},base32hex:function(){return fu},base32hexpad:function(){return yu},base32hexpadupper:function(){return gu},base32hexupper:function(){return pu},base32pad:function(){return hu},base32padupper:function(){return du},base32upper:function(){return lu},base32z:function(){return mu}});var B={};r.r(B),r.d(B,{base36:function(){return bu},base36upper:function(){return wu}});var N={};r.r(N),r.d(N,{base58btc:function(){return vu},base58flickr:function(){return _u}});var M={};r.r(M),r.d(M,{base64:function(){return Eu},base64pad:function(){return Su},base64url:function(){return xu},base64urlpad:function(){return Au}});var U={};r.r(U),r.d(U,{base256emoji:function(){return Pu}});var L={};r.r(L),r.d(L,{sha256:function(){return el},sha512:function(){return tl}});var j={};r.r(j),r.d(j,{identity:function(){return nl}});var F={};r.r(F),r.d(F,{code:function(){return sl},decode:function(){return al},encode:function(){return ol},name:function(){return il}});var z={};r.r(z),r.d(z,{code:function(){return hl},decode:function(){return fl},encode:function(){return dl},name:function(){return ll}});var $={};r.r($),r.d($,{base10:function(){return Yl}});var K={};r.r(K),r.d(K,{base16:function(){return Zl},base16upper:function(){return Xl}});var V={};r.r(V),r.d(V,{base2:function(){return Ql}});var q={};r.r(q),r.d(q,{base256emoji:function(){return nh}});var W={};r.r(W),r.d(W,{base8:function(){return ih}});var H={};r.r(H),r.d(H,{identity:function(){return sh}});var G={};r.r(G),r.d(G,{Ed25519PrivateKey:function(){return od},Ed25519PublicKey:function(){return sd},generateKeyPair:function(){return ud},generateKeyPairFromSeed:function(){return ld},unmarshalEd25519PrivateKey:function(){return ad},unmarshalEd25519PublicKey:function(){return cd}});var J={};r.r(J),r.d(J,{MAX_KEY_SIZE:function(){return xd},RsaPrivateKey:function(){return kd},RsaPublicKey:function(){return Ad},fromJwk:function(){return Pd},generateKeyPair:function(){return Cd},unmarshalRsaPrivateKey:function(){return Id},unmarshalRsaPublicKey:function(){return Td}});var Y={};r.r(Y),r.d(Y,{Secp256k1PrivateKey:function(){return Dd},Secp256k1PublicKey:function(){return Od},generateKeyPair:function(){return Md},unmarshalSecp256k1PrivateKey:function(){return Bd},unmarshalSecp256k1PublicKey:function(){return Nd}});var Z=r(17833);var X=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},Q=X;new Uint8Array(0);const ee=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class te{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class re{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ie(this,e)}}class ne{constructor(e){this.decoders=e}or(e){return ie(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ie=(e,t)=>new ne({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class se{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new te(e,t,r),this.decoder=new re(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oe=({name:e,prefix:t,encode:r,decode:n})=>new se(e,t,r,n),ae=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Q(r,t);return oe({prefix:e,name:t,encode:n,decode:e=>ee(i(e))})},ce=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>oe({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),ue=ce({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),le=ce({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),he=ce({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),de=ce({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fe=ce({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pe=ce({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ye=ce({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ge=ce({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),me=ce({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),be=ae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),we=ae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ve=ce({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_e=ce({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ee=ce({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Se=ce({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function xe(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return Z.enabled(`${e}:trace`)&&null!=Z.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=Z(`${e}:trace`)),Object.assign(Z(e),{error:Z(`${e}:error`),trace:t})}Z.formatters.b=e=>null==e?"undefined":be.baseEncode(e),Z.formatters.t=e=>null==e?"undefined":ue.baseEncode(e),Z.formatters.m=e=>null==e?"undefined":ve.baseEncode(e),Z.formatters.p=e=>null==e?"undefined":e.toString(),Z.formatters.c=e=>null==e?"undefined":e.toString(),Z.formatters.k=e=>null==e?"undefined":e.toString(),Z.formatters.a=e=>null==e?"undefined":e.toString();var Ae=r(36918),ke=r(65857),Ie=r(98308);var Te=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);},Pe=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=Oe;)r[n++]=255&t|Ce,t/=128;for(;t&Re;)r[n++]=255&t|Ce,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Ce=128,Re=-128,Oe=Math.pow(2,31);var De=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&Ne)<<s:(n&Ne)*Math.pow(2,s),s+=7}while(n>=Be);return e.bytes=o-r,i},Be=128,Ne=127;var Me=Math.pow(2,7),Ue=Math.pow(2,14),Le=Math.pow(2,21),je=Math.pow(2,28),Fe=Math.pow(2,35),ze=Math.pow(2,42),$e=Math.pow(2,49),Ke=Math.pow(2,56),Ve=Math.pow(2,63),qe={encode:Pe,decode:De,encodingLength:function(e){return e<Me?1:e<Ue?2:e<Le?3:e<je?4:e<Fe?5:e<ze?6:e<$e?7:e<Ke?8:e<Ve?9:10}};const We=(e,t=0)=>[qe.decode(e,t),qe.decode.bytes],He=(e,t,r=0)=>(qe.encode(e,t,r),t),Ge=e=>qe.encodingLength(e),Je=(e,t)=>{const r=t.byteLength,n=Ge(e),i=n+Ge(r),s=new Uint8Array(i+r);return He(e,s,0),He(r,s,n),s.set(t,i),new Ze(e,r,t,s)},Ye=e=>{const t=ee(e),[r,n]=We(t),[i,s]=We(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Ze(r,i,o,t)};class Ze{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Xe=ee,Qe={code:0,name:"identity",encode:Xe,digest:e=>Je(0,Xe(e))},et=({name:e,code:t,encode:r})=>new tt(e,t,r);class tt{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Je(this.code,t):t.then((e=>Je(this.code,e)))}throw Error("Unknown type, must be binary type")}}const rt=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),nt=et({name:"sha2-256",code:18,encode:rt("SHA-256")}),it=et({name:"sha2-512",code:19,encode:rt("SHA-512")});var st=r(55433);const ot=["string","number","bigint","symbol"],at=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function ct(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(ot.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(at.includes(t))return t;return}(e);return r||"Object"}class ut{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}ut.uint=new ut(0,"uint",!0),ut.negint=new ut(1,"negint",!0),ut.bytes=new ut(2,"bytes",!0),ut.string=new ut(3,"string",!0),ut.array=new ut(4,"array",!1),ut.map=new ut(5,"map",!1),ut.tag=new ut(6,"tag",!1),ut.float=new ut(7,"float",!0),ut.false=new ut(7,"false",!0),ut.true=new ut(7,"true",!0),ut.null=new ut(7,"null",!0),ut.undefined=new ut(7,"undefined",!0),ut.break=new ut(7,"break",!0);class lt{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const ht=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,dt=new TextDecoder,ft=new TextEncoder;function pt(e){return ht&&globalThis.Buffer.isBuffer(e)}function yt(e){return e instanceof Uint8Array?pt(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const gt=ht?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):St(e,t,r):(e,t,r)=>r-t>64?dt.decode(e.subarray(t,r)):St(e,t,r),mt=ht?e=>e.length>64?globalThis.Buffer.from(e):Et(e):e=>e.length>64?ft.encode(e):Et(e),bt=e=>Uint8Array.from(e),wt=ht?(e,t,r)=>pt(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),vt=ht?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),yt(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},_t=ht?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Et(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function St(e,t,r){const n=[];for(;t<r;){const i=e[t];let s=null,o=i>239?4:i>223?3:i>191?2:1;if(t+o<=r){let r,n,a,c;switch(o){case 1:i<128&&(s=i);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&i)<<6|63&r,c>127&&(s=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),t+=o}return At(n)}const xt=4096;function At(e){const t=e.length;if(t<=xt)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=xt));return r}class kt{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=_t(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=wt(r,0,this.cursor)}else t=vt(this.chunks,this.cursor);return e&&this.reset(),t}}const It="CBOR decode error:",Tt="CBOR encode error:",Pt=[];function Ct(e,t,r){if(e.length-t<r)throw new Error(`${It} not enough data for type`)}Pt[23]=1,Pt[24]=2,Pt[25]=3,Pt[26]=5,Pt[27]=9;const Rt=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ot(e,t,r){Ct(e,t,1);const n=e[t];if(!0===r.strict&&n<Rt[0])throw new Error(`${It} integer encoded in more bytes than necessary (strict decode)`);return n}function Dt(e,t,r){Ct(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<Rt[1])throw new Error(`${It} integer encoded in more bytes than necessary (strict decode)`);return n}function Bt(e,t,r){Ct(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<Rt[2])throw new Error(`${It} integer encoded in more bytes than necessary (strict decode)`);return n}function Nt(e,t,r){Ct(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&s<Rt[3])throw new Error(`${It} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(!0===r.allowBigInt)return s;throw new Error(`${It} integers outside of the safe integer range are not supported`)}function Mt(e,t){return Ut(e,0,t.value)}function Ut(e,t,r){if(r<Rt[0]){const n=Number(r);e.push([t|n])}else if(r<Rt[1]){const n=Number(r);e.push([24|t,n])}else if(r<Rt[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<Rt[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<Rt[4]))throw new Error(`${It} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&s,s>>=8,r[3]=255&s,s>>=8,r[2]=255&s,s>>=8,r[1]=255&s,e.push(r)}}}Mt.encodedSize=function(e){return Ut.encodedSize(e.value)},Ut.encodedSize=function(e){return e<Rt[0]?1:e<Rt[1]?2:e<Rt[2]?3:e<Rt[3]?5:9},Mt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const Lt=BigInt(-1),jt=BigInt(1);function Ft(e,t){const r=t.value,n="bigint"==typeof r?r*Lt-jt:-1*r-1;Ut(e,t.type.majorEncoded,n)}function zt(e,t,r,n){Ct(e,t,r+n);const i=wt(e,t+r,t+r+n);return new lt(ut.bytes,i,r+n)}function $t(e,t,r,n){return zt(e,t,1,r)}function Kt(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===ut.string?mt(e.value):e.value),e.encodedBytes}function Vt(e,t){const r=Kt(t);Ut(e,t.type.majorEncoded,r.length),e.push(r)}function qt(e,t,r,n,i){const s=r+n;Ct(e,t,s);const o=new lt(ut.string,gt(e,t+r,t+s),s);return!0===i.retainStringBytes&&(o.byteValue=wt(e,t+r,t+s)),o}function Wt(e,t,r,n){return qt(e,t,1,r,n)}Ft.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*Lt-jt:-1*t-1;return r<Rt[0]?1:r<Rt[1]?2:r<Rt[2]?3:r<Rt[3]?5:9},Ft.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Vt.encodedSize=function(e){const t=Kt(e);return Ut.encodedSize(t.length)+t.length},Vt.compareTokens=function(e,t){return r=Kt(e),n=Kt(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(pt(e)&&pt(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const Ht=Vt;function Gt(e,t,r,n){return new lt(ut.array,n,r)}function Jt(e,t,r,n){return Gt(0,0,1,r)}function Yt(e,t){Ut(e,ut.array.majorEncoded,t.value)}function Zt(e,t,r,n){return new lt(ut.map,n,r)}function Xt(e,t,r,n){return Zt(0,0,1,r)}function Qt(e,t){Ut(e,ut.map.majorEncoded,t.value)}function er(e,t,r,n){return new lt(ut.tag,r,1)}function tr(e,t){Ut(e,ut.tag.majorEncoded,t.value)}Yt.compareTokens=Mt.compareTokens,Yt.encodedSize=function(e){return Ut.encodedSize(e.value)},Qt.compareTokens=Mt.compareTokens,Qt.encodedSize=function(e){return Ut.encodedSize(e.value)},tr.compareTokens=Mt.compareTokens,tr.encodedSize=function(e){return Ut.encodedSize(e.value)};const rr=20,nr=21,ir=22,sr=23;function or(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${It} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${It} Infinity values are not supported`)}return new lt(ut.float,e,t)}function ar(e,t,r){const n=t.value;if(!1===n)e.push([ut.float.majorEncoded|rr]);else if(!0===n)e.push([ut.float.majorEncoded|nr]);else if(null===n)e.push([ut.float.majorEncoded|ir]);else if(void 0===n)e.push([ut.float.majorEncoded|sr]);else{let t,s=!1;r&&!0===r.float64||(hr(n),t=dr(lr,1),n===t||Number.isNaN(n)?(lr[0]=249,e.push(lr.slice(0,3)),s=!0):(fr(n),t=pr(lr,1),n===t&&(lr[0]=250,e.push(lr.slice(0,5)),s=!0))),s||(i=n,ur.setFloat64(0,i,!1),t=yr(lr,1),lr[0]=251,e.push(lr.slice(0,9)))}var i}ar.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){hr(r);let e=dr(lr,1);if(r===e||Number.isNaN(r))return 3;if(fr(r),e=pr(lr,1),r===e)return 5}return 9};const cr=new ArrayBuffer(9),ur=new DataView(cr,1),lr=new Uint8Array(cr,0);function hr(e){if(e===1/0)ur.setUint16(0,31744,!1);else if(e===-1/0)ur.setUint16(0,64512,!1);else if(Number.isNaN(e))ur.setUint16(0,32256,!1);else{ur.setFloat32(0,e);const t=ur.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)ur.setUint16(0,31744,!1);else if(0===r)ur.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?ur.setUint16(0,0):e<-14?ur.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):ur.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function dr(e,t){if(e.length-t<2)throw new Error(`${It} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let s;return s=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-s:s}function fr(e){ur.setFloat32(0,e,!1)}function pr(e,t){if(e.length-t<4)throw new Error(`${It} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function yr(e,t){if(e.length-t<8)throw new Error(`${It} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function gr(e,t,r){throw new Error(`${It} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function mr(e){return()=>{throw new Error(`${It} ${e}`)}}ar.compareTokens=Mt.compareTokens;const br=[];for(let e=0;e<=23;e++)br[e]=gr;br[24]=function(e,t,r,n){return new lt(ut.uint,Ot(e,t+1,n),2)},br[25]=function(e,t,r,n){return new lt(ut.uint,Dt(e,t+1,n),3)},br[26]=function(e,t,r,n){return new lt(ut.uint,Bt(e,t+1,n),5)},br[27]=function(e,t,r,n){return new lt(ut.uint,Nt(e,t+1,n),9)},br[28]=gr,br[29]=gr,br[30]=gr,br[31]=gr;for(let e=32;e<=55;e++)br[e]=gr;br[56]=function(e,t,r,n){return new lt(ut.negint,-1-Ot(e,t+1,n),2)},br[57]=function(e,t,r,n){return new lt(ut.negint,-1-Dt(e,t+1,n),3)},br[58]=function(e,t,r,n){return new lt(ut.negint,-1-Bt(e,t+1,n),5)},br[59]=function(e,t,r,n){const i=Nt(e,t+1,n);if("bigint"!=typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new lt(ut.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${It} integers outside of the safe integer range are not supported`);return new lt(ut.negint,Lt-BigInt(i),9)},br[60]=gr,br[61]=gr,br[62]=gr,br[63]=gr;for(let e=64;e<=87;e++)br[e]=$t;br[88]=function(e,t,r,n){return zt(e,t,2,Ot(e,t+1,n))},br[89]=function(e,t,r,n){return zt(e,t,3,Dt(e,t+1,n))},br[90]=function(e,t,r,n){return zt(e,t,5,Bt(e,t+1,n))},br[91]=function(e,t,r,n){const i=Nt(e,t+1,n);if("bigint"==typeof i)throw new Error(`${It} 64-bit integer bytes lengths not supported`);return zt(e,t,9,i)},br[92]=gr,br[93]=gr,br[94]=gr,br[95]=mr("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)br[e]=Wt;br[120]=function(e,t,r,n){return qt(e,t,2,Ot(e,t+1,n),n)},br[121]=function(e,t,r,n){return qt(e,t,3,Dt(e,t+1,n),n)},br[122]=function(e,t,r,n){return qt(e,t,5,Bt(e,t+1,n),n)},br[123]=function(e,t,r,n){const i=Nt(e,t+1,n);if("bigint"==typeof i)throw new Error(`${It} 64-bit integer string lengths not supported`);return qt(e,t,9,i,n)},br[124]=gr,br[125]=gr,br[126]=gr,br[127]=mr("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)br[e]=Jt;br[152]=function(e,t,r,n){return Gt(0,0,2,Ot(e,t+1,n))},br[153]=function(e,t,r,n){return Gt(0,0,3,Dt(e,t+1,n))},br[154]=function(e,t,r,n){return Gt(0,0,5,Bt(e,t+1,n))},br[155]=function(e,t,r,n){const i=Nt(e,t+1,n);if("bigint"==typeof i)throw new Error(`${It} 64-bit integer array lengths not supported`);return Gt(0,0,9,i)},br[156]=gr,br[157]=gr,br[158]=gr,br[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${It} indefinite length items not allowed`);return Gt(0,0,1,1/0)};for(let e=160;e<=183;e++)br[e]=Xt;br[184]=function(e,t,r,n){return Zt(0,0,2,Ot(e,t+1,n))},br[185]=function(e,t,r,n){return Zt(0,0,3,Dt(e,t+1,n))},br[186]=function(e,t,r,n){return Zt(0,0,5,Bt(e,t+1,n))},br[187]=function(e,t,r,n){const i=Nt(e,t+1,n);if("bigint"==typeof i)throw new Error(`${It} 64-bit integer map lengths not supported`);return Zt(0,0,9,i)},br[188]=gr,br[189]=gr,br[190]=gr,br[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${It} indefinite length items not allowed`);return Zt(0,0,1,1/0)};for(let e=192;e<=215;e++)br[e]=er;br[216]=function(e,t,r,n){return new lt(ut.tag,Ot(e,t+1,n),2)},br[217]=function(e,t,r,n){return new lt(ut.tag,Dt(e,t+1,n),3)},br[218]=function(e,t,r,n){return new lt(ut.tag,Bt(e,t+1,n),5)},br[219]=function(e,t,r,n){return new lt(ut.tag,Nt(e,t+1,n),9)},br[220]=gr,br[221]=gr,br[222]=gr,br[223]=gr;for(let e=224;e<=243;e++)br[e]=mr("simple values are not supported");br[244]=gr,br[245]=gr,br[246]=gr,br[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${It} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new lt(ut.null,null,1):new lt(ut.undefined,void 0,1)},br[248]=mr("simple values are not supported"),br[249]=function(e,t,r,n){return or(dr(e,t+1),3,n)},br[250]=function(e,t,r,n){return or(pr(e,t+1),5,n)},br[251]=function(e,t,r,n){return or(yr(e,t+1),9,n)},br[252]=gr,br[253]=gr,br[254]=gr,br[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${It} indefinite length items not allowed`);return new lt(ut.break,void 0,1)};const wr=[];for(let e=0;e<24;e++)wr[e]=new lt(ut.uint,e,1);for(let e=-1;e>=-24;e--)wr[31-e]=new lt(ut.negint,e,1);wr[64]=new lt(ut.bytes,new Uint8Array(0),1),wr[96]=new lt(ut.string,"",1),wr[128]=new lt(ut.array,0,1),wr[160]=new lt(ut.map,0,1),wr[244]=new lt(ut.false,!1,1),wr[245]=new lt(ut.true,!0,1),wr[246]=new lt(ut.null,null,1);var vr=r(96763);const _r={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,s=Er[i].compareTokens(r,n);0===s&&vr.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return s},quickEncodeToken:function(e){switch(e.type){case ut.false:return bt([244]);case ut.true:return bt([245]);case ut.null:return bt([246]);case ut.bytes:return e.value.length?void 0:bt([64]);case ut.string:return""===e.value?bt([96]):void 0;case ut.array:return 0===e.value?bt([128]):void 0;case ut.map:return 0===e.value?bt([160]):void 0;case ut.uint:return e.value<24?bt([Number(e.value)]):void 0;case ut.negint:if(e.value>=-24)return bt([31-Number(e.value)])}}};const Er=function(){const e=[];return e[ut.uint.major]=Mt,e[ut.negint.major]=Ft,e[ut.bytes.major]=Vt,e[ut.string.major]=Ht,e[ut.array.major]=Yt,e[ut.map.major]=Qt,e[ut.tag.major]=tr,e[ut.float.major]=ar,e}(),Sr=new kt;class xr{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Tt} object contains circular references`);return new xr(t,e)}}const Ar={null:new lt(ut.null,null),undefined:new lt(ut.undefined,void 0),true:new lt(ut.true,!0),false:new lt(ut.false,!1),emptyArray:new lt(ut.array,0),emptyMap:new lt(ut.map,0)},kr={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new lt(e>=0?ut.uint:ut.negint,e):new lt(ut.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new lt(ut.uint,e):new lt(ut.negint,e),Uint8Array:(e,t,r,n)=>new lt(ut.bytes,e),string:(e,t,r,n)=>new lt(ut.string,e),boolean:(e,t,r,n)=>e?Ar.true:Ar.false,null:(e,t,r,n)=>Ar.null,undefined:(e,t,r,n)=>Ar.undefined,ArrayBuffer:(e,t,r,n)=>new lt(ut.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new lt(ut.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Ar.emptyArray,new lt(ut.break)]:Ar.emptyArray;n=xr.createCheck(n,e);const i=[];let s=0;for(const t of e)i[s++]=Ir(t,r,n);return r.addBreakTokens?[new lt(ut.array,e.length),i,new lt(ut.break)]:[new lt(ut.array,e.length),i]},Object(e,t,r,n){const i="Object"!==t,s=i?e.keys():Object.keys(e),o=i?e.size:s.length;if(!o)return!0===r.addBreakTokens?[Ar.emptyMap,new lt(ut.break)]:Ar.emptyMap;n=xr.createCheck(n,e);const a=[];let c=0;for(const t of s)a[c++]=[Ir(t,r,n),Ir(i?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,r),r.addBreakTokens?[new lt(ut.map,o),a,new lt(ut.break)]:[new lt(ut.map,o),a]}};kr.Map=kr.Object,kr.Buffer=kr.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))kr[`${e}Array`]=kr.DataView;function Ir(e,t={},r){const n=ct(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||kr[n];if("function"==typeof i){const s=i(e,n,t,r);if(null!=s)return s}const s=kr[n];if(!s)throw new Error(`${Tt} unsupported type: ${n}`);return s(e,n,t,r)}function Tr(e,t,r,n){if(Array.isArray(t))for(const i of t)Tr(e,i,r,n);else r[t.type.major](e,t,n)}function Pr(e,t,r){const n=Ir(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const i=t[n.type.major];if(i.encodedSize){const e=i.encodedSize(n,r),t=new kt(e);if(i(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return yt(t.chunks[0])}}return Sr.reset(),Tr(Sr,n,t,r),Sr.toBytes(!0)}function Cr(e,t){return t=Object.assign({},_r,t),Pr(e,Er,t)}const Rr={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Or{constructor(e,t={}){this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=wr[e];if(void 0===t){const r=br[e];if(!r)throw new Error(`${It} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this._pos,n,this.options)}return this._pos+=t.encodedLength,t}}const Dr=Symbol.for("DONE"),Br=Symbol.for("BREAK");function Nr(e,t){if(e.done())return Dr;const r=e.next();if(r.type===ut.break)return Br;if(r.type.terminal)return r.value;if(r.type===ut.array)return function(e,t,r){const n=[];for(let i=0;i<e.value;i++){const s=Nr(t,r);if(s===Br){if(e.value===1/0)break;throw new Error(`${It} got unexpected break to lengthed array`)}if(s===Dr)throw new Error(`${It} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=s}return n}(r,e,t);if(r.type===ut.map)return function(e,t,r){const n=!0===r.useMaps,i=n?void 0:{},s=n?new Map:void 0;for(let o=0;o<e.value;o++){const a=Nr(t,r);if(a===Br){if(e.value===1/0)break;throw new Error(`${It} got unexpected break to lengthed map`)}if(a===Dr)throw new Error(`${It} found map but not enough entries (got ${o} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${It} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&s.has(a)||!n&&a in i))throw new Error(`${It} found repeat map key "${a}"`);const c=Nr(t,r);if(c===Dr)throw new Error(`${It} found map but not enough entries (got ${o} [no value], expected ${e.value})`);n?s.set(a,c):i[a]=c}return n?s:i}(r,e,t);if(r.type===ut.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=Nr(e,t);return t.tags[r.value](n)}throw new Error(`${It} tag not supported (${r.value})`)}throw new Error("unsupported")}function Mr(e,t){const[r,n]=function(e,t){if(!(e instanceof Uint8Array))throw new Error(`${It} data to decode must be a Uint8Array`);const r=(t=Object.assign({},Rr,t)).tokenizer||new Or(e,t),n=Nr(r,t);if(n===Dr)throw new Error(`${It} did not find any content to decode`);if(n===Br)throw new Error(`${It} got unexpected break`);return[n,e.subarray(r.pos())]}(e,t);if(n.length>0)throw new Error(`${It} too many terminals, data makes no sense`);return r}var Ur=r(98067),Lr=r(16676);const jr="/",Fr=(new TextEncoder).encode(jr),zr=Fr[0];class $r{constructor(e,t){if("string"==typeof e)this._buf=(0,Lr.s)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==zr)throw new Error("Invalid key")}toString(e="utf8"){return(0,Ur.d)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new $r(e.join(jr))}static random(){return new $r(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new $r(e):"function"==typeof e.uint8Array?new $r(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Fr),this._buf[0]!==zr){const e=new Uint8Array(this._buf.byteLength+1);e.fill(zr,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===zr;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],i=r[e];if(n<i)return!0;if(n>i)return!1}return t.length<r.length}reverse(){return $r.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(jr).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new $r(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(jr)||(e+=jr),e+=this.type(),new $r(e)}parent(){const e=this.list();return 1===e.length?new $r(jr):new $r(e.slice(0,-1).join(jr))}child(e){return this.toString()===jr?e:e.toString()===jr?this:new $r(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return $r.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}const Kr=ae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vr=ae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),qr=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?Yr(r,Hr(e),t||be.encoder):Zr(r,Hr(e),t||ue.encoder)},Wr=new WeakMap,Hr=e=>{const t=Wr.get(e);if(null==t){const t=new Map;return Wr.set(e,t),t}return t};class Gr{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Xr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Qr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Gr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Je(e,t);return Gr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Gr.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return qr(this,e)}toJSON(){return{"/":qr(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Gr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Gr(e,r,n,i||en(e,r,n.bytes))}if(!0===t[tn]){const{version:e,multihash:r,code:n}=t,i=Ye(r);return Gr.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Xr)throw new Error(`Version 0 CID must use dag-pb (code: ${Xr}) block encoding`);return new Gr(e,t,r,r.bytes);case 1:{const n=en(e,t,r.bytes);return new Gr(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Gr.create(0,Xr,e)}static createV1(e,t){return Gr.create(1,e,t)}static decode(e){const[t,r]=Gr.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Gr.inspectBytes(e),r=t.size-t.multihashSize,n=ee(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Ze(t.multihashCode,t.digestSize,i,n);return[0===t.version?Gr.createV0(s):Gr.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=We(e.subarray(t));return t+=n,r};let n=r(),i=Xr;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=Jr(e,t),i=Gr.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Hr(i).set(r,e),i}}const Jr=(e,t)=>{switch(e[0]){case"Q":{const r=t||be;return[be.prefix,r.decode(`${be.prefix}${e}`)]}case be.prefix:{const r=t||be;return[be.prefix,r.decode(e)]}case ue.prefix:{const r=t||ue;return[ue.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Yr=(e,t,r)=>{const{prefix:n}=r;if(n!==be.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},Zr=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},Xr=112,Qr=18,en=(e,t,r)=>{const n=Ge(e),i=n+Ge(t),s=new Uint8Array(i+r.byteLength);return He(e,s,0),He(t,s,n),s.set(r,i),s},tn=Symbol.for("@ipld/js-cid/CID");var rn=r(97313),nn=r(77011),sn=r.n(nn),on=r(72030);var an,cn=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};an=new WeakMap;var un,ln,hn,dn,fn,pn,yn,gn,mn,bn,wn,vn,_n,En,Sn,xn,An,kn,In,Tn,Pn,Cn,Rn,On,Dn,Bn,Nn=class{constructor(){an.set(this,[])}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&cn(this,an,"f")[this.size-1].priority>=t.priority)return void cn(this,an,"f").push(r);const n=function(e,t,r){let n=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}(cn(this,an,"f"),r,((e,t)=>t.priority-e.priority));cn(this,an,"f").splice(n,0,r)}dequeue(){const e=cn(this,an,"f").shift();return null==e?void 0:e.run}filter(e){return cn(this,an,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return cn(this,an,"f").length}},Mn=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Un=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class Ln extends Error{}class jn extends(sn()){constructor(e){var t,r,n,i;if(super(),un.add(this),ln.set(this,void 0),hn.set(this,void 0),dn.set(this,0),fn.set(this,void 0),pn.set(this,void 0),yn.set(this,0),gn.set(this,void 0),mn.set(this,void 0),bn.set(this,void 0),wn.set(this,void 0),vn.set(this,0),_n.set(this,void 0),En.set(this,void 0),Sn.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Nn,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);Mn(this,ln,e.carryoverConcurrencyCount,"f"),Mn(this,hn,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),Mn(this,fn,e.intervalCap,"f"),Mn(this,pn,e.interval,"f"),Mn(this,bn,new e.queueClass,"f"),Mn(this,wn,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,Mn(this,Sn,!0===e.throwOnTimeout,"f"),Mn(this,En,!1===e.autoStart,"f")}get concurrency(){return Un(this,_n,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Mn(this,_n,e,"f"),Un(this,un,"m",On).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:Un(this,Sn,"f"),...t},new Promise(((r,n)=>{Un(this,bn,"f").enqueue((async()=>{var i,s,o;Mn(this,vn,(s=Un(this,vn,"f"),++s),"f"),Mn(this,dn,(o=Un(this,dn,"f"),++o),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new Ln("The task was aborted.");let n=e({signal:t.signal});t.timeout&&(n=(0,on.Ay)(Promise.resolve(n),t.timeout)),t.signal&&(n=Promise.race([n,Un(this,un,"m",Dn).call(this,t.signal)]));const s=await n;r(s),this.emit("completed",s)}catch(e){if(e instanceof on.MU&&!t.throwOnTimeout)return void r();n(e),this.emit("error",e)}finally{Un(this,un,"m",kn).call(this)}}),t),this.emit("add"),Un(this,un,"m",Pn).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return Un(this,En,"f")?(Mn(this,En,!1,"f"),Un(this,un,"m",On).call(this),this):this}pause(){Mn(this,En,!0,"f")}clear(){Mn(this,bn,new(Un(this,wn,"f")),"f")}async onEmpty(){0!==Un(this,bn,"f").size&&await Un(this,un,"m",Bn).call(this,"empty")}async onSizeLessThan(e){Un(this,bn,"f").size<e||await Un(this,un,"m",Bn).call(this,"next",(()=>Un(this,bn,"f").size<e))}async onIdle(){0===Un(this,vn,"f")&&0===Un(this,bn,"f").size||await Un(this,un,"m",Bn).call(this,"idle")}get size(){return Un(this,bn,"f").size}sizeBy(e){return Un(this,bn,"f").filter(e).length}get pending(){return Un(this,vn,"f")}get isPaused(){return Un(this,En,"f")}}ln=new WeakMap,hn=new WeakMap,dn=new WeakMap,fn=new WeakMap,pn=new WeakMap,yn=new WeakMap,gn=new WeakMap,mn=new WeakMap,bn=new WeakMap,wn=new WeakMap,vn=new WeakMap,_n=new WeakMap,En=new WeakMap,Sn=new WeakMap,un=new WeakSet,xn=function(){return Un(this,hn,"f")||Un(this,dn,"f")<Un(this,fn,"f")},An=function(){return Un(this,vn,"f")<Un(this,_n,"f")},kn=function(){var e;Mn(this,vn,(e=Un(this,vn,"f"),--e),"f"),Un(this,un,"m",Pn).call(this),this.emit("next")},In=function(){Un(this,un,"m",Rn).call(this),Un(this,un,"m",Cn).call(this),Mn(this,mn,void 0,"f")},Tn=function(){const e=Date.now();if(void 0===Un(this,gn,"f")){const t=Un(this,yn,"f")-e;if(!(t<0))return void 0===Un(this,mn,"f")&&Mn(this,mn,setTimeout((()=>{Un(this,un,"m",In).call(this)}),t),"f"),!0;Mn(this,dn,Un(this,ln,"f")?Un(this,vn,"f"):0,"f")}return!1},Pn=function(){if(0===Un(this,bn,"f").size)return Un(this,gn,"f")&&clearInterval(Un(this,gn,"f")),Mn(this,gn,void 0,"f"),this.emit("empty"),0===Un(this,vn,"f")&&this.emit("idle"),!1;if(!Un(this,En,"f")){const e=!Un(this,un,"a",Tn);if(Un(this,un,"a",xn)&&Un(this,un,"a",An)){const t=Un(this,bn,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&Un(this,un,"m",Cn).call(this),!0)}}return!1},Cn=function(){Un(this,hn,"f")||void 0!==Un(this,gn,"f")||(Mn(this,gn,setInterval((()=>{Un(this,un,"m",Rn).call(this)}),Un(this,pn,"f")),"f"),Mn(this,yn,Date.now()+Un(this,pn,"f"),"f"))},Rn=function(){0===Un(this,dn,"f")&&0===Un(this,vn,"f")&&Un(this,gn,"f")&&(clearInterval(Un(this,gn,"f")),Mn(this,gn,void 0,"f")),Mn(this,dn,Un(this,ln,"f")?Un(this,vn,"f"):0,"f"),Un(this,un,"m",On).call(this)},On=function(){for(;Un(this,un,"m",Pn).call(this););},Dn=async function(e){return new Promise(((t,r)=>{e.addEventListener("abort",(()=>{r(new Ln("The task was aborted."))}),{once:!0})}))},Bn=async function(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))};var Fn=jn,zn=r(94145),$n=r(74868);class Kn extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===ut.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===ut.map&&(t.elements++,1!==t.elements&&(t.elements%2==1?e.push([44]):e.push([58]))))}[ut.uint.major](e,t){this.prefix(e);const r=String(t.value),n=[];for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);e.push(n)}[ut.negint.major](e,t){this[ut.uint.major](e,t)}[ut.bytes.major](e,t){throw new Error(`${Tt} unsupported type: Uint8Array`)}[ut.string.major](e,t){this.prefix(e);const r=mt(JSON.stringify(t.value));e.push(r.length>32?yt(r):r)}[ut.array.major](e,t){this.prefix(e),this.inRecursive.push({type:ut.array,elements:0}),e.push([91])}[ut.map.major](e,t){this.prefix(e),this.inRecursive.push({type:ut.map,elements:0}),e.push([123])}[ut.tag.major](e,t){}[ut.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===ut.array)e.push([93]);else{if(t.type!==ut.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${Tt} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const r=String(t.value),n=[];let i=!1;for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e),i||46!==n[e]&&101!==n[e]&&69!==n[e]||(i=!0);i||(n.push(46),n.push(48)),e.push(n)}}class Vn{constructor(e,t={}){this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${It} unexpected end of input at position ${this._pos}`);for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error(`${It} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let t=!1,r=!1;const n=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new lt(ut.uint,0,this._pos-e);this._pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error(`${It} unexpected token at position ${this._pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${It} unexpected token at position ${this._pos}`);r=!0,this._pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,n([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),s=parseFloat(i);return r?new lt(ut.float,s,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(s)?new lt(s>=0?ut.uint:ut.negint,s,this._pos-e):new lt(s>=0?ut.uint:ut.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error(`${It} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let e=this._pos,t=0;e<this.data.length&&t<65536;e++,t++){const r=this.data[e];if(92===r||r<32||r>=128)break;if(34===r){const r=String.fromCharCode.apply(null,this.data.subarray(this._pos,e));return this._pos=e+1,new lt(ut.string,r,t)}}const e=this._pos,t=[],r=()=>{if(this._pos+4>=this.data.length)throw new Error(`${It} unexpected end of unicode escape sequence at position ${this._pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${It} unexpected unicode escape character at position ${this._pos}`);t=t-65+10}e=16*e+t,this._pos++}return e},n=()=>{const e=this.ch();let r,n,i,s,o=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${It} unexpected unicode sequence at position ${this._pos}`);switch(a){case 1:e<128&&(o=e);break;case 2:r=this.data[this._pos+1],128==(192&r)&&(s=(31&e)<<6|63&r,s>127&&(o=s));break;case 3:r=this.data[this._pos+1],n=this.data[this._pos+2],128==(192&r)&&128==(192&n)&&(s=(15&e)<<12|(63&r)<<6|63&n,s>2047&&(s<55296||s>57343)&&(o=s));break;case 4:r=this.data[this._pos+1],n=this.data[this._pos+2],i=this.data[this._pos+3],128==(192&r)&&128==(192&n)&&128==(192&i)&&(s=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&i,s>65535&&s<1114112&&(o=s))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this._pos+=a};for(;!this.done();){const i=this.ch();let s;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${It} unexpected string termination at position ${this._pos}`);switch(s=this.ch(),this._pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${It} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new lt(ut.string,At(t),this._pos-e);default:if(i<32)throw new Error(`${It} invalid control character at position ${this._pos}`);i<128?(t.push(i),this._pos++):n()}}throw new Error(`${It} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new lt(ut.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new lt(ut.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new lt(ut.null,null,4);case 102:return this.expect([102,97,108,115,101]),new lt(ut.false,!1,5);case 116:return this.expect([116,114,117,101]),new lt(ut.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${It} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new lt(ut.break,void 0,1);if(44!==this.ch())throw new Error(`${It} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new lt(ut.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new lt(ut.break,void 0,1);if(44!==this.ch())throw new Error(`${It} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new lt(ut.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${It} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${It} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}const qn={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};qn.tags[42]=Gr.parse;new TextDecoder,new TextEncoder;const Wn=new TextDecoder;function Hn(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(r+=n<28?(127&i)<<n:(127&i)*2**n,i<128)break}return[r,t]}function Gn(e,t){let r;[r,t]=Hn(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function Jn(e,t){let r;return[r,t]=Hn(e,t),[7&r,r>>3,t]}function Yn(e){const t={},r=e.length;let n=0;for(;n<r;){let r,i;if([r,i,n]=Jn(e,n),1===i){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Gn(e,n)}else if(2===i){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=Gn(e,n),t.Name=Wn.decode(i)}else{if(3!==i)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=Hn(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}new TextEncoder;new TextEncoder;function Zn(e){const t=function(e){const t=e.length;let r,n,i=0,s=!1;for(;i<t;){let t,o;if([t,o,i]=Jn(e,i),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===o){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,i]=Gn(e,i),r&&(s=!0)}else{if(2!==o)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${o}`);{if(s)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,i]=Gn(e,i),r.push(Yn(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return n&&(o.Data=n),o.Links=r||[],o}(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=Gr.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}const Xn=new TextEncoder,Qn=new TextDecoder,ei="json",ti=512,ri=e=>Xn.encode(JSON.stringify(e)),ni=e=>JSON.parse(Qn.decode(e)),ii="raw",si=85,oi=e=>ee(e),ai=e=>ee(e),ci={codec:112,async*walk(e){const t=Zn(e);yield*t.Links.map((e=>e.Hash))}},ui={codec:si,async*walk(){}},li={codec:$n.code,async*walk(e){const t=[],r=[];r[42]=e=>{if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");const r=Gr.decode(e.subarray(1));return t.push(r),r},Mr(e,{tags:r}),yield*t}};class hi extends Vn{tokenBuffer;constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===ut.map){const e=this._next();if(e.type===ut.string&&"/"===e.value){const e=this._next();if(e.type===ut.string){if(this._next().type!==ut.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new lt(ut.tag,42,0)}if(e.type===ut.map){const e=this._next();if(e.type===ut.string&&"bytes"===e.value){const e=this._next();if(e.type===ut.string){for(let e=0;e<2;e++){if(this._next().type!==ut.break)throw new Error("Invalid encoded Bytes form")}const t=ve.decode(`m${e.value}`);return new lt(ut.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const di={codec:297,async*walk(e){const t=[],r=[];var n,i;r[42]=e=>{const r=Gr.parse(e);return t.push(r),r},n=e,i={tags:r,tokenizer:new hi(e,{tags:r,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})},Mr(n,i=Object.assign({tokenizer:new Vn(n,i)},i)),yield*t}},fi=[ui,ci,li,di,{codec:ti,async*walk(){}}],pi="/pin/",yi="/pinned-block/",gi=Kr;function mi(e){return 0===e.version&&(e=e.toV1()),new $r(`${pi}${e.toString(gi)}`)}class bi{datastore;blockstore;dagWalkers;constructor(e,t,r){this.datastore=e,this.blockstore=t,this.dagWalkers={},[...fi,...r].forEach((e=>{this.dagWalkers[e.codec]=e}))}async add(e,t={}){const r=mi(e);if(await this.datastore.has(r))throw new Error("Already pinned");const n=Math.round(t.depth??1/0);if(n<0)throw new Error("Depth must be greater than or equal to 0");const i=new Fn({concurrency:1});i.add((async()=>{await this.#n(e,i,(t=>{null==t.pinnedBy.find((t=>(0,zn.a)(t,e.bytes)))&&(t.pinCount++,t.pinnedBy.push(e.bytes))}),{...t,depth:n})}));const s=(0,rn.A)();i.on("error",(e=>{i.clear(),s.reject(e)})),await Promise.race([i.onIdle(),s.promise]);const o={depth:n,metadata:t.metadata??{}};return await this.datastore.put(r,Cr(o),t),{cid:e,...o}}async#n(e,t,r,n){if(-1===n.depth)return;const i=this.dagWalkers[e.code];if(null==i)throw new Error(`No dag walker found for cid codec ${e.code}`);const s=await this.blockstore.get(e,n);await this.#i(e,r,n);for await(const e of i.walk(s))t.add((async()=>{await this.#n(e,t,r,{...n,depth:n.depth-1})}))}async#i(e,t,r){const n=new $r(`${yi}${gi.encode(e.multihash.bytes)}`);let i={pinCount:0,pinnedBy:[]};try{i=Mr(await this.datastore.get(n,r))}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}t(i),0===i.pinCount&&await this.datastore.has(n)?await this.datastore.delete(n):(await this.datastore.put(n,Cr(i),r),r.onProgress?.(new st.j("helia:pin:add",{detail:e})))}async rm(e,t={}){const r=mi(e),n=Mr(await this.datastore.get(r,t));await this.datastore.delete(r,t);const i=new Fn({concurrency:1});return i.add((async()=>{await this.#n(e,i,(t=>{t.pinCount--,t.pinnedBy=t.pinnedBy.filter((t=>(0,zn.a)(t,e.bytes)))}),{...t,depth:n.depth})})),await i.onIdle(),{cid:e,...n}}async*ls(e={}){for await(const{key:t,value:r}of this.datastore.query({prefix:pi+(null!=e.cid?`${e.cid.toString(Kr)}`:"")},e)){const e=Gr.parse(t.toString().substring(5),Kr),n=Mr(r);yield{cid:e,...n}}}async isPinned(e,t={}){const r=new $r(`${yi}${gi.encode(e.multihash.bytes)}`);return this.datastore.has(r,t)}}var wi=r(56742);class vi{lock;child;pins;constructor(e,t,r={}){this.child=e,this.pins=t,this.lock=(0,wi.A)({singleProcess:r.holdGcLock})}unwrap(){return this.child}async put(e,t,r={}){const n=await this.lock.readLock();try{return await this.child.put(e,t,r)}finally{n()}}async*putMany(e,t={}){const r=await this.lock.readLock();try{yield*this.child.putMany(e,t)}finally{r()}}async get(e,t={}){const r=await this.lock.readLock();try{return await this.child.get(e,t)}finally{r()}}async*getMany(e,t={}){const r=await this.lock.readLock();try{yield*this.child.getMany(e,t)}finally{r()}}async delete(e,t={}){const r=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");await this.child.delete(e,t)}finally{r()}}async*deleteMany(e,t={}){const r=await this.lock.writeLock();try{const r=this;yield*this.child.deleteMany(async function*(){for await(const t of e){if(await r.pins.isPinned(t))throw new Error("CID was pinned");yield t}}(),t)}finally{r()}}async has(e,t={}){const r=await this.lock.readLock();try{return await this.child.has(e,t)}finally{r()}}async*getAll(e={}){const t=await this.lock.readLock();try{yield*this.child.getAll(e)}finally{t()}}}const _i=new $r("/version");var Ei=r(97101);var Si=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r)&&(yield r)}();const r=(0,Ei.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s.then)return async function*(){await s&&(yield n);for await(const e of r)await t(e)&&(yield e)}();const o=t;return function*(){!0===s&&(yield n);for(const e of r)o(e)&&(yield e)}()};var xi=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r),yield r}();const r=(0,Ei.A)(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const s=t(n);if("function"==typeof s?.then)return async function*(){yield n;for await(const e of r)await t(e),yield e}();const o=t;return function*(){yield n;for(const e of r)o(e),yield e}()};class Ai{child;bitswap;constructor(e,t={}){this.child=e,this.bitswap=t.bitswap}unwrap(){return this.child}async put(e,t,r={}){return await this.child.has(e)?(r.onProgress?.(new st.j("blocks:put:duplicate",e)),e):(!0===this.bitswap?.isStarted()&&(r.onProgress?.(new st.j("blocks:put:bitswap:notify",e)),this.bitswap.notify(e,t,r)),r.onProgress?.(new st.j("blocks:put:blockstore:put",e)),this.child.put(e,t,r))}async*putMany(e,t={}){const r=Si(e,(async({cid:e})=>{const r=await this.child.has(e);return r&&t.onProgress?.(new st.j("blocks:put-many:duplicate",e)),!r})),n=xi(r,(({cid:e,block:r})=>{t.onProgress?.(new st.j("blocks:put-many:bitswap:notify",e)),this.bitswap?.notify(e,r,t)}));t.onProgress?.(new st.j("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(n,t)}async get(e,t={}){if(!0!==t.offline&&null!=this.bitswap?.isStarted()&&!await this.child.has(e)){t.onProgress?.(new st.j("blocks:get:bitswap:get",e));const r=await this.bitswap.want(e,t);return t.onProgress?.(new st.j("blocks:get:blockstore:put",e)),await this.child.put(e,r,t),r}return t.onProgress?.(new st.j("blocks:get:blockstore:get",e)),this.child.get(e,t)}async*getMany(e,t={}){t.onProgress?.(new st.j("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(xi(e,(async e=>{if(!0!==t.offline&&!0===this.bitswap?.isStarted()&&!await this.child.has(e)){t.onProgress?.(new st.j("blocks:get-many:bitswap:get",e));const r=await this.bitswap.want(e,t);t.onProgress?.(new st.j("blocks:get-many:blockstore:put",e)),await this.child.put(e,r,t)}})))}async delete(e,t={}){t.onProgress?.(new st.j("blocks:delete:blockstore:delete",e)),await this.child.delete(e,t)}async*deleteMany(e,t={}){t.onProgress?.(new st.j("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany(async function*(){for await(const t of e)yield t}(),t)}async has(e,t={}){return this.child.has(e,t)}async*getAll(e={}){e.onProgress?.(new st.j("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(e)}}const ki=xe("helia");class Ii{libp2p;blockstore;datastore;pins;#s;constructor(e){const t=[nt,it,Qe,...e.hashers??[]];this.#s=(0,Ie.T)(e.libp2p,e.blockstore,{hashLoader:{getHasher:async e=>{const r=t.find((t=>t.code===e||t.name===e));if(null!=r)return r;throw new Error(`Could not load hasher for code/name "${e}"`)}}});const r=new Ai(e.blockstore,{bitswap:this.#s});this.pins=new bi(e.datastore,r,e.dagWalkers??[]),this.libp2p=e.libp2p,this.blockstore=new vi(r,this.pins,{holdGcLock:e.holdGcLock}),this.datastore=e.datastore}async start(){await async function(e){if(!await e.has(_i))return void await e.put(_i,(0,Lr.s)("1"));const t=await e.get(_i),r=(0,Ur.d)(t);if(1!==parseInt(r,10))throw new Error("Unknown datastore version, a datastore migration may be required")}(this.datastore),await(this.#s?.start()),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await(this.#s?.stop())}async gc(e={}){const t=await this.blockstore.lock.writeLock();try{const t=this,r=this.blockstore.unwrap();ki("gc start"),await Te(r.deleteMany(async function*(){for await(const{cid:n}of r.getAll())try{if(await t.pins.isPinned(n,e))continue;yield n,e.onProgress?.(new st.j("helia:gc:deleted",n))}catch(t){ki.error("Error during gc",t),e.onProgress?.(new st.j("helia:gc:error",t))}}()))}finally{t()}ki("gc finished")}}var Ti=r(93379),Pi=r(81033),Ci=r(70202),Ri=r(66660);var Oi=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},Di=Oi;new Uint8Array(0);const Bi=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class Ni{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Mi{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Li(this,e)}}class Ui{constructor(e){this.decoders=e}or(e){return Li(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Li=(e,t)=>new Ui({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ji{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Ni(e,t,r),this.decoder=new Mi(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Fi=({name:e,prefix:t,encode:r,decode:n})=>new ji(e,t,r,n),zi=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Di(r,t);return Fi({prefix:e,name:t,encode:n,decode:e=>Bi(i(e))})},$i=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Fi({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),Ki=zi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vi=zi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),qi=zi({prefix:"9",name:"base10",alphabet:"0123456789"}),Wi=$i({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hi=$i({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Gi=$i({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ji=Array.from(""),Yi=Ji.reduce(((e,t,r)=>(e[r]=t,e)),[]),Zi=Ji.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Xi=Fi({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Yi[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Zi[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Qi=$i({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),es=$i({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ts=$i({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rs=$i({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ns=$i({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),is=$i({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ss=$i({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),os=$i({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),as=$i({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),cs=zi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),us=zi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ls=$i({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hs=$i({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ds=$i({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fs=$i({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ps=$i({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ys=Fi({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),gs=new TextEncoder,ms=new TextDecoder,bs="json",ws=512,vs=e=>gs.encode(JSON.stringify(e)),_s=e=>JSON.parse(ms.decode(e)),Es="raw",Ss=85,xs=e=>Bi(e),As=e=>Bi(e);var ks=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=Ps;)r[n++]=255&t|Is,t/=128;for(;t&Ts;)r[n++]=255&t|Is,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Is=128,Ts=-128,Ps=Math.pow(2,31);var Cs=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&Os)<<s:(n&Os)*Math.pow(2,s),s+=7}while(n>=Rs);return e.bytes=o-r,i},Rs=128,Os=127;var Ds=Math.pow(2,7),Bs=Math.pow(2,14),Ns=Math.pow(2,21),Ms=Math.pow(2,28),Us=Math.pow(2,35),Ls=Math.pow(2,42),js=Math.pow(2,49),Fs=Math.pow(2,56),zs=Math.pow(2,63),$s={encode:ks,decode:Cs,encodingLength:function(e){return e<Ds?1:e<Bs?2:e<Ns?3:e<Ms?4:e<Us?5:e<Ls?6:e<js?7:e<Fs?8:e<zs?9:10}};const Ks=(e,t=0)=>[$s.decode(e,t),$s.decode.bytes],Vs=(e,t,r=0)=>($s.encode(e,t,r),t),qs=e=>$s.encodingLength(e),Ws=(e,t)=>{const r=t.byteLength,n=qs(e),i=n+qs(r),s=new Uint8Array(i+r);return Vs(e,s,0),Vs(r,s,n),s.set(t,i),new Gs(e,r,t,s)},Hs=e=>{const t=Bi(e),[r,n]=Ks(t),[i,s]=Ks(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Gs(r,i,o,t)};class Gs{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Js=Bi,Ys={code:0,name:"identity",encode:Js,digest:e=>Ws(0,Js(e))},Zs=({name:e,code:t,encode:r})=>new Xs(e,t,r);class Xs{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ws(this.code,t):t.then((e=>Ws(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Qs=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),eo=Zs({name:"sha2-256",code:18,encode:Qs("SHA-256")}),to=Zs({name:"sha2-512",code:19,encode:Qs("SHA-512")}),ro=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?ao(r,io(e),t||Ki.encoder):co(r,io(e),t||Qi.encoder)},no=new WeakMap,io=e=>{const t=no.get(e);if(null==t){const t=new Map;return no.set(e,t),t}return t};class so{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==uo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==lo)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return so.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Ws(e,t);return so.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return so.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return ro(this,e)}toJSON(){return{"/":ro(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof so)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new so(e,r,n,i||ho(e,r,n.bytes))}if(!0===t[fo]){const{version:e,multihash:r,code:n}=t,i=Hs(r);return so.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==uo)throw new Error(`Version 0 CID must use dag-pb (code: ${uo}) block encoding`);return new so(e,t,r,r.bytes);case 1:{const n=ho(e,t,r.bytes);return new so(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return so.create(0,uo,e)}static createV1(e,t){return so.create(1,e,t)}static decode(e){const[t,r]=so.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=so.inspectBytes(e),r=t.size-t.multihashSize,n=Bi(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Gs(t.multihashCode,t.digestSize,i,n);return[0===t.version?so.createV0(s):so.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Ks(e.subarray(t));return t+=n,r};let n=r(),i=uo;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=oo(e,t),i=so.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return io(i).set(r,e),i}}const oo=(e,t)=>{switch(e[0]){case"Q":{const r=t||Ki;return[Ki.prefix,r.decode(`${Ki.prefix}${e}`)]}case Ki.prefix:{const r=t||Ki;return[Ki.prefix,r.decode(e)]}case Qi.prefix:{const r=t||Qi;return[Qi.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ao=(e,t,r)=>{const{prefix:n}=r;if(n!==Ki.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},co=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},uo=112,lo=18,ho=(e,t,r)=>{const n=qs(e),i=n+qs(t),s=new Uint8Array(i+r.byteLength);return Vs(e,s,0),Vs(t,s,n),s.set(r,i),s},fo=Symbol.for("@ipld/js-cid/CID"),po={...v,...p,...w,...d,...f,...g,...m,...h,...b,...y};function yo(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const go=Symbol.for("nodejs.util.inspect.custom"),mo=Object.values(po).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),po.identity.decoder),bo=114,wo=36,vo=37;class _o{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Ri.H]=!0;toString(){return null==this.string&&(this.string=Ki.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return so.createV1(bo,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return yo(this.multihash.bytes,e);if("string"==typeof e)return Ao(e).equals(this);if(null!=e?.multihash?.bytes)return yo(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[go](){return`PeerId(${this.toString()})`}}class Eo extends _o{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class So extends _o{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class xo extends _o{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function Ao(e,t){if(t=t??mo,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Hs(Ki.decode(`z${e}`));return e.startsWith("12D")?new So({multihash:t}):e.startsWith("16U")?new xo({multihash:t}):new Eo({multihash:t})}return ko(mo.decode(e))}function ko(e){try{const t=Hs(e);if(t.code===Ys.code){if(t.digest.length===wo)return new So({multihash:t});if(t.digest.length===vo)return new xo({multihash:t})}if(t.code===eo.code)return new Eo({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==bo)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===eo.code)return new Eo({multihash:e.multihash});if(t.code===Ys.code){if(t.digest.length===wo)return new So({multihash:e.multihash});if(t.digest.length===vo)return new xo({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(so.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Io(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return Z.enabled(`${e}:trace`)&&null!=Z.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=Z(`${e}:trace`)),Object.assign(Z(e),{error:Z(`${e}:error`),trace:t})}Z.formatters.b=e=>null==e?"undefined":Ki.baseEncode(e),Z.formatters.t=e=>null==e?"undefined":Qi.baseEncode(e),Z.formatters.m=e=>null==e?"undefined":ls.baseEncode(e),Z.formatters.p=e=>null==e?"undefined":e.toString(),Z.formatters.c=e=>null==e?"undefined":e.toString(),Z.formatters.k=e=>null==e?"undefined":e.toString(),Z.formatters.a=e=>null==e?"undefined":e.toString();var To=r(61144);class Po{gossip;msgs=new Map;msgIdToStrFn;history=[];notValidatedCount=0;constructor(e,t,r){this.gossip=e,this.msgIdToStrFn=r;for(let e=0;e<t;e++)this.history[e]=[]}get size(){return this.msgs.size}put(e,t,r=!1){const{msgIdStr:n}=e;return!this.msgs.has(n)&&(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),r||this.notValidatedCount++,!0)}observeDuplicate(e,t){const r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){const r=this.msgs.get(e);if(!r)return null;const n=(r.iwantCounts.get(t)??0)+1;return r.iwantCounts.set(t,n),{msg:r.message,count:n}}getGossipIDs(e){const t=new Map;for(let r=0;r<this.gossip;r++)this.history[r].forEach((r=>{const n=this.msgs.get(r.msgIdStr);if(n&&n.validated&&e.has(r.topic)){let e=t.get(r.topic);e||(e=[],t.set(r.topic,e)),e.push(r.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(!t)return null;t.validated||this.notValidatedCount--;const{message:r,originatingPeers:n}=t;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}shift(){this.history[this.history.length-1].forEach((e=>{const t=this.msgs.get(e.msgIdStr);t&&(this.msgs.delete(e.msgIdStr),t.validated||this.notValidatedCount--)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var Co=r(28732);const{RPC:Ro}=Co,Oo="/floodsub/1.0.0",Do="/meshsub/1.0.0",Bo="/meshsub/1.1.0",No=5e3;function Mo(e){if(e.length<=1)return e;for(let t=0;t<e.length;t++){const r=Math.floor(Math.random()*Math.floor(e.length)),n=e[t];e[t]=e[r],e[r]=n}return e}function Uo(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Lo(e=0){return null!=globalThis.Buffer?.allocUnsafe?Uo(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function jo(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Fo=jo("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),zo=jo("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Lo((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var $o={utf8:Fo,"utf-8":Fo,hex:po.base16,latin1:zo,ascii:zo,binary:zo,...po};function Ko(e,t="utf8"){const r=$o[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Vo(e){return Ko(e,"base64")}r(12746),r(12698);var qo=r(50276);function Wo(e,t="utf8"){const r=$o[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Uo(globalThis.Buffer.from(e,"utf-8"))}var Ho=r(80497);const Go=32,Jo=64,Yo=32;function Zo(e,t){const r=new Uint8Array(Jo);for(let n=0;n<Yo;n++)r[n]=e[n],r[Yo+n]=t[n];return r}function Xo(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Lo(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Uo(r)}var Qo={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};const ea={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function ta(e,t){const r=function(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=Qo.get();return r*=8,{encrypt:async function(e,c){const u=a.getRandomValues(new Uint8Array(s)),l=a.getRandomValues(new Uint8Array(n)),h={name:t,iv:l};let d;if("string"==typeof c&&(c=Wo(c)),0===c.length){d=await a.subtle.importKey("jwk",ea,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}catch{d=await a.subtle.importKey("jwk",ea,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}const f=await a.subtle.encrypt(h,d,e);return Xo([u,h.iv,new Uint8Array(f)])},decrypt:async function(e,c){const u=e.subarray(0,s),l=e.subarray(s,s+n),h=e.subarray(s+n),d={name:t,iv:l};let f;if("string"==typeof c&&(c=Wo(c)),0===c.length)try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}catch{f=await a.subtle.importKey("jwk",ea,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}const p=await a.subtle.decrypt(d,f,h);return new Uint8Array(p)}}}(),n=await r.encrypt(e,t);return ls.encode(n)}var ra,na,ia,sa,oa=r(59110);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(ra||(ra={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(na||(na={})),function(e){e.codec=()=>(0,oa.eG)(na)}(ra||(ra={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,oa.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),ra.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=ra.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,oa.mH)(t,e.codec()),e.decode=t=>(0,oa.Y8)(t,e.codec())}(ia||(ia={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,oa.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),ra.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=ra.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,oa.mH)(t,e.codec()),e.decode=t=>(0,oa.Y8)(t,e.codec())}(sa||(sa={}));class aa{_key;constructor(e){this._key=fa(e,Go)}async verify(e,t){return async function(e,t,r){return Ho.ev.verify(t,r,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return ia.encode({Type:ra.Ed25519,Data:this.marshal()}).subarray()}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}}class ca{_key;_publicKey;constructor(e,t){this._key=fa(e,Jo),this._publicKey=fa(t,Go)}async sign(e){return async function(e,t){const r=e.subarray(0,Yo);return Ho.ev.sign(t,r)}(this._key,e)}get public(){return new aa(this._publicKey)}marshal(){return this._key}get bytes(){return sa.encode({Type:ra.Ed25519,Data:this.marshal()}).subarray()}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}async id(){const e=Ys.digest(this.public.bytes);return Ki.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return ta(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function ua(e){if(e.length>Jo){const t=(e=fa(e,Jo+Go)).subarray(0,Jo),r=e.subarray(Jo,e.length);return new ca(t,r)}const t=(e=fa(e,Jo)).subarray(0,Jo),r=e.subarray(Go);return new ca(t,r)}function la(e){return e=fa(e,Go),new aa(e)}async function ha(){const{privateKey:e,publicKey:t}=await async function(){const e=Ho.ev.utils.randomPrivateKey(),t=Ho.ev.getPublicKey(e);return{privateKey:Zo(e,t),publicKey:t}}();return new ca(e,t)}async function da(e){const{privateKey:t,publicKey:r}=await async function(e){if(e.length!==Yo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=Ho.ev.getPublicKey(t);return{privateKey:Zo(t,r),publicKey:r}}(e);return new ca(t,r)}function fa(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw new Ci.Ak(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}r(7619),r(43736);function pa(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.subarray(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Xo([new Uint8Array(t-r.length),r])}return Ko(r,"base64url")}function ya(e){const t=function(e,t){let r=Wo(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Xo([new Uint8Array(t-r.length),r])}return r}(e);return new qo.jsbn.BigInteger(Ko(t,"base16"),16)}const ga={"P-256":256,"P-384":384,"P-521":521};Object.keys(ga).join(" / ");r(72313);const ma="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function ba(e){if(isNaN(e)||e<=0)throw new Ci.Ak("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return function(e=32){if(ma&&"function"==typeof ma.getRandomValues)return ma.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(e)}r(15805);function wa(e,t){return t.map((t=>ya(e[t])))}async function va(e){const t=[await Qo.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Ea(e)],r=await _a({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function _a(e){if(null==e.privateKey||null==e.publicKey)throw new Ci.Ak("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Qo.get().subtle.exportKey("jwk",e.privateKey),Qo.get().subtle.exportKey("jwk",e.publicKey)])}async function Ea(e){return Qo.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Sa(e,t,r,n){const i=t?function(e){return qo.pki.setRsaPublicKey(...wa(e,["n","e"]))}(e):function(e){return qo.pki.setRsaPrivateKey(...wa(e,["n","e","d","p","q","dp","dq","qi"]))}(e);return Wo(n(Ko(Uint8Array.from(r),"ascii"),i),"ascii")}function xa(e){if("RSA"!==e.kty)throw new Ci.Ak("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new Ci.Ak("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*Wo(e.n,"base64url").length}const Aa=8192;class ka{_key;constructor(e){this._key=e}async verify(e,t){return async function(e,t,r){const n=await Qo.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Qo.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new Ci.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=qo.pki.publicKeyToAsn1({n:ya(e.n),e:ya(e.e)});return Wo(qo.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return ia.encode({Type:ra.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Sa(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}}class Ia{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return ba(16)}async sign(e){return async function(e,t){const r=await Qo.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Qo.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new Ci.Ak("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new ka(this._publicKey)}decrypt(e){return Sa(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new Ci.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=qo.pki.privateKeyToAsn1({n:ya(e.n),e:ya(e.e),d:ya(e.d),p:ya(e.p),q:ya(e.q),dP:ya(e.dp),dQ:ya(e.dq),qInv:ya(e.qi)});return Wo(qo.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return sa.encode({Type:ra.RSA,Data:this.marshal()}).subarray()}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}async id(){return Ko(await this.public.hash(),"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new qo.util.ByteBuffer(this.marshal()),r=qo.asn1.fromDer(t),n=qo.pki.privateKeyFromAsn1(r),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return qo.pki.encryptRsaPrivateKey(n,e,i)}if("libp2p-key"===t)return ta(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function Ta(e){const t=function(e){const t=qo.asn1.fromDer(Ko(e,"ascii")),r=qo.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:pa(r.n),e:pa(r.e),d:pa(r.d),p:pa(r.p),q:pa(r.q),dp:pa(r.dP),dq:pa(r.dQ),qi:pa(r.qInv),alg:"RS256"}}(e);if(xa(t)>Aa)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await va(t);return new Ia(r.privateKey,r.publicKey)}function Pa(e){const t=function(e){const t=qo.asn1.fromDer(Ko(e,"ascii")),r=qo.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:pa(r.n),e:pa(r.e)}}(e);if(xa(t)>Aa)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new ka(t)}async function Ca(e){if(xa(e)>Aa)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await va(e);return new Ia(t.privateKey,t.publicKey)}async function Ra(e){if(e>Aa)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await Qo.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await _a(t);return{privateKey:r[0],publicKey:r[1]}}(e);return new Ia(t.privateKey,t.publicKey)}var Oa=r(64544);function Da(e){try{Oa.bI.ProjectivePoint.fromHex(e)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PUBLIC_KEY")}}class Ba{_key;constructor(e){Da(e),this._key=e}async verify(e,t){return async function(e,t,r){try{const{digest:n}=await eo.digest(r);return Oa.bI.verify(t,n,e)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Oa.bI.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return ia.encode({Type:ra.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}}class Na{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return Oa.bI.getPublicKey(e,!0)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Oa.bI.getPublicKey(e,!0)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Da(this._publicKey)}async sign(e){return async function(e,t){const{digest:r}=await eo.digest(t);try{return Oa.bI.sign(r,e).toDERRawBytes()}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Ba(this._publicKey)}marshal(){return this._key}get bytes(){return sa.encode({Type:ra.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return yo(this.bytes,e.bytes)}async hash(){const{bytes:e}=await eo.digest(this.bytes);return e}async id(){return Ko(await this.public.hash(),"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return ta(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function Ma(e){return new Na(e)}function Ua(e){return new Ba(e)}async function La(){const e=Oa.bI.utils.randomPrivateKey();return new Na(e)}const ja={rsa:k,ed25519:A,secp256k1:I};function Fa(e){const t=Object.keys(ja).join(" / ");return new Ci.Ak(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function za(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return ja[e];throw Fa(e)}function $a(e){const t=ia.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ra.RSA:return ja.rsa.unmarshalRsaPublicKey(r);case ra.Ed25519:return ja.ed25519.unmarshalEd25519PublicKey(r);case ra.Secp256k1:return ja.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Fa(t.Type??"unknown")}}async function Ka(e){const t=sa.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ra.RSA:return ja.rsa.unmarshalRsaPrivateKey(r);case ra.Ed25519:return ja.ed25519.unmarshalEd25519PrivateKey(r);case ra.Secp256k1:return ja.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Fa(t.Type??"RSA")}}var Va,qa,Wa,Ha,Ga,Ja=r(44125);function Ya(e){switch(e){case Ja.z8.Ignore:return Wa.Ignore;case Ja.z8.Reject:return Wa.Reject}}!function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"}(Va||(Va={})),function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"}(qa||(qa={})),function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"}(Wa||(Wa={})),function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"}(Ha||(Ha={})),function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"}(Ga||(Ga={}));const Za="ERR_INVALID_PEER_SCORE_PARAMS",Xa={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},Qa={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function ec(e={}){return{...Xa,...e,topics:e.topics?Object.entries(e.topics).reduce(((e,[t,r])=>(e[t]=function(e={}){return{...Qa,...e}}(r),e)),{}):{}}}function tc(e){if(e.topicWeight<0)throw new Ci.Ak("invalid topic weight; must be >= 0",Za);if(0===e.timeInMeshQuantum)throw new Ci.Ak("invalid TimeInMeshQuantum; must be non zero",Za);if(e.timeInMeshWeight<0)throw new Ci.Ak("invalid TimeInMeshWeight; must be positive (or 0 to disable)",Za);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw new Ci.Ak("invalid TimeInMeshQuantum; must be positive",Za);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw new Ci.Ak("invalid TimeInMeshCap; must be positive",Za);if(e.firstMessageDeliveriesWeight<0)throw new Ci.Ak("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",Za);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new Ci.Ak("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",Za);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw new Ci.Ak("invalid FirstMessageDeliveriesCap; must be positive",Za);if(e.meshMessageDeliveriesWeight>0)throw new Ci.Ak("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",Za);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new Ci.Ak("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",Za);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw new Ci.Ak("invalid MeshMessageDeliveriesCap; must be positive",Za);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw new Ci.Ak("invalid MeshMessageDeliveriesThreshold; must be positive",Za);if(e.meshMessageDeliveriesWindow<0)throw new Ci.Ak("invalid MeshMessageDeliveriesWindow; must be non-negative",Za);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw new Ci.Ak("invalid MeshMessageDeliveriesActivation; must be at least 1s",Za);if(e.meshFailurePenaltyWeight>0)throw new Ci.Ak("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",Za);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new Ci.Ak("invalid MeshFailurePenaltyDecay; must be between 0 and 1",Za);if(e.invalidMessageDeliveriesWeight>0)throw new Ci.Ak("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",Za);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new Ci.Ak("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",Za)}const rc={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function nc(e={}){return{...rc,...e}}function ic(e,t,r,n){let i=0;Object.entries(t.topics).forEach((([e,t])=>{const n=r.topics[e];if(void 0===n)return;let s=0;if(t.inMesh){let e=t.meshTime/n.timeInMeshQuantum;e>n.timeInMeshCap&&(e=n.timeInMeshCap),s+=e*n.timeInMeshWeight}let o=t.firstMessageDeliveries;if(o>n.firstMessageDeliveriesCap&&(o=n.firstMessageDeliveriesCap),s+=o*n.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<n.meshMessageDeliveriesThreshold){const e=n.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;s+=e*e*n.meshMessageDeliveriesWeight}s+=t.meshFailurePenalty*n.meshFailurePenaltyWeight;s+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*n.invalidMessageDeliveriesWeight,i+=s*n.topicWeight})),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap);const s=r.appSpecificScore(e);if(i+=s*r.appSpecificWeight,t.knownIPs.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),s=t?t.size:0;if(s>r.IPColocationFactorThreshold){const e=s-r.IPColocationFactorThreshold;i+=e*e*r.IPColocationFactorWeight}})),t.behaviourPenalty>r.behaviourPenaltyThreshold){const e=t.behaviourPenalty-r.behaviourPenaltyThreshold;i+=e*e*r.behaviourPenaltyWeight}return i}var sc,oc=r(44534);!function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"}(sc||(sc={}));class ac{records;queue;constructor(){this.records=new Map,this.queue=new oc}getRecord(e){return this.records.get(e)}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:sc.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const r={msgId:e,expire:Date.now()+12e4};return this.queue.push(r),t}gc(){const e=Date.now();let t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function cc(e,t,r=(()=>!0)){const n=new Set;if(t<=0)return n;for(const i of e){if(n.size>=t)break;r(i)&&(n.add(i),e.delete(i))}return n}class uc extends Map{getDefault;constructor(e){super(),this.getDefault=e}getOrDefault(e){let t=super.get(e);return void 0===t&&(t=this.getDefault(),this.set(e,t)),t}}const lc=Io("libp2p:gossipsub:score");class hc{params;metrics;peerStats=new Map;peerIPs=new uc((()=>new Set));scoreCache=new Map;deliveryRecords=new ac;_backgroundInterval;scoreCacheValidityMs;computeScore;constructor(e,t,r){this.params=e,this.metrics=t,function(e){for(const[t,r]of Object.entries(e.topics))try{tc(r)}catch(e){throw new Ci.Ak(`invalid score parameters for topic ${t}: ${e.message}`,Za)}if(e.topicScoreCap<0)throw new Ci.Ak("invalid topic score cap; must be positive (or 0 for no cap)",Za);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw new Ci.Ak("missing application specific score function",Za);if(e.IPColocationFactorWeight>0)throw new Ci.Ak("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",Za);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw new Ci.Ak("invalid IPColocationFactorThreshold; must be at least 1",Za);if(e.behaviourPenaltyWeight>0)throw new Ci.Ak("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",Za);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new Ci.Ak("invalid BehaviourPenaltyDecay; must be between 0 and 1",Za);if(e.decayInterval<1e3)throw new Ci.Ak("invalid DecayInterval; must be at least 1s",Za);if(e.decayToZero<=0||e.decayToZero>=1)throw new Ci.Ak("invalid DecayToZero; must be between 0 and 1",Za)}(e),this.scoreCacheValidityMs=r.scoreCacheValidityMs,this.computeScore=r.computeScore??ic}get size(){return this.peerStats.size}start(){this._backgroundInterval?lc("Peer score already running"):(this._backgroundInterval=setInterval((()=>this.background()),this.params.decayInterval),lc("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),lc("stopped")):lc("Peer score already stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((([e,t])=>[e,t])))}messageFirstSeenTimestampMs(e){const t=this.deliveryRecords.getRecord(e);return t?t.firstSeenTsMs:null}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((r,n)=>{r.connected?(Object.entries(r.topics).forEach((([r,n])=>{const i=this.params.topics[r];void 0!==i&&(n.firstMessageDeliveries*=i.firstMessageDeliveriesDecay,n.firstMessageDeliveries<t&&(n.firstMessageDeliveries=0),n.meshMessageDeliveries*=i.meshMessageDeliveriesDecay,n.meshMessageDeliveries<t&&(n.meshMessageDeliveries=0),n.meshFailurePenalty*=i.meshFailurePenaltyDecay,n.meshFailurePenalty<t&&(n.meshFailurePenalty=0),n.invalidMessageDeliveries*=i.invalidMessageDeliveriesDecay,n.invalidMessageDeliveries<t&&(n.invalidMessageDeliveries=0),n.inMesh&&(n.meshTime=e-n.graftTime,n.meshTime>i.meshMessageDeliveriesActivation&&(n.meshMessageDeliveriesActive=!0)))})),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)):e>r.expire&&(this.removeIPsForPeer(n,r.knownIPs),this.peerStats.delete(n),this.scoreCache.delete(n))}))}score(e){this.metrics?.scoreFnCalls.inc();const t=this.peerStats.get(e);if(!t)return 0;const r=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>r)return n.score;this.metrics?.scoreFnRuns.inc();const i=this.computeScore(e,t,this.params,this.peerIPs),s=r+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-n.score)),n.score=i,n.cacheUntil=s):this.scoreCache.set(e,{score:i,cacheUntil:s}),i}addPenalty(e,t,r){const n=this.peerStats.get(e);n&&(n.behaviourPenalty+=t,this.metrics?.onScorePenalty(r))}addPeer(e){const t={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,t)}addIP(e,t){const r=this.peerStats.get(e);r&&r.knownIPs.add(t),this.peerIPs.getOrDefault(t).add(e)}removeIP(e,t){const r=this.peerStats.get(e);r&&r.knownIPs.delete(t);const n=this.peerIPs.get(t);n&&(n.delete(e),0===n.size&&this.peerIPs.delete(t))}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPsForPeer(e,t.knownIPs),void this.peerStats.delete(e);Object.entries(t.topics).forEach((([e,t])=>{t.firstMessageDeliveries=0;const r=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r){const e=r-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1,t.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){const r=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<r){const t=r-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,r){this.markFirstMessageDelivery(e,r);const n=this.deliveryRecords.ensureRecord(t),i=Date.now();n.status===sc.unknown?(n.status=sc.valid,n.validated=i,n.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,r)}))):lc("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-n.firstSeenTsMs,sc[n.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,r,n){switch(n){case Wa.Error:return void this.markInvalidMessageDelivery(e,r);case Wa.Blacklisted:return}const i=this.deliveryRecords.ensureRecord(t);if(i.status===sc.unknown){if(n===Wa.Ignore)return i.status=sc.ignored,void i.peers.clear();i.status=sc.invalid,this.markInvalidMessageDelivery(e,r),i.peers.forEach((e=>{this.markInvalidMessageDelivery(e,r)})),i.peers.clear()}else lc("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeenTsMs,sc[i.status])}duplicateMessage(e,t,r){const n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case sc.unknown:n.peers.add(e);break;case sc.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case sc.invalid:this.markInvalidMessageDelivery(e,r);case sc.ignored:}}markInvalidMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){let r=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(r,e.firstMessageDeliveries+1),e.inMesh&&(r=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(r,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,r){const n=this.peerStats.get(e);if(n){const e=void 0!==r?Date.now():0,i=this.getPtopicStats(n,t);if(i&&i.inMesh){const n=this.params.topics[t];if(void 0!==r){const i=e-r,s=i>n.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,i,s),s)return}const s=n.meshMessageDeliveriesCap;i.meshMessageDeliveries=Math.min(s,i.meshMessageDeliveries+1)}}}removeIPsForPeer(e,t){for(const r of t){const t=this.peerIPs.get(r);t&&(t.delete(e),0===t.size&&this.peerIPs.delete(r))}}getPtopicStats(e,t){let r=e.topics[t];return void 0!==r?r:void 0!==this.params.topics[t]?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}}class dc{gossipsubIWantFollowupMs;msgIdToStrFn;metrics;promises=new Map;requestMsByMsg=new Map;requestMsByMsgExpire;constructor(e,t,r){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=r,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const r=t[Math.floor(Math.random()*t.length)],n=this.msgIdToStrFn(r);let i=this.promises.get(n);i||(i=new Map,this.promises.set(n,i));const s=Date.now();i.has(e)||(i.set(e,s+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(n)||this.requestMsByMsg.set(n,s)))}getBrokenPromises(){const e=Date.now(),t=new Map;let r=0;return this.promises.forEach(((n,i)=>{n.forEach(((i,s)=>{i<e&&(t.set(s,(t.get(s)??0)+1),n.delete(s),r++)})),n.size||this.promises.delete(i)})),this.metrics?.iwantPromiseBroken.inc(r),t}deliverMessage(e,t=!1){this.trackMessage(e);const r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),t&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,t){this.trackMessage(e),t!==Wa.Error&&this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;let t=0;for(const[r,n]of this.requestMsByMsg.entries()){if(!(n<e))break;this.requestMsByMsg.delete(r),t++}this.metrics?.iwantMessagePruned.inc(t)}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class fc{entries=new Map;validityMs;constructor(e){this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){return!!this.entries.has(e)||(this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const e=Date.now();for(const[t,r]of this.entries.entries()){if(!(r.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var pc,yc,gc,mc,bc,wc;!function(e){e.forward="forward",e.publish="publish"}(pc||(pc={})),function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"}(yc||(yc={})),function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Excess="excess"}(gc||(gc={})),function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"}(mc||(mc={})),function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"}(bc||(bc={})),function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"}(wc||(wc={}));r(39504);r(3254);const vc=Wo("libp2p-pubsub:");function _c(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return((e,t)=>{const r=Wo(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n})(e.from.toBytes(),e.sequenceNumber)}async function Ec(e){return await eo.encode(e.data)}function Sc(e,t,r,n,i){let s=0;const o=new Map;if(Object.entries(t.topics).forEach((([e,t])=>{const n=i.get(e)??"unknown",a=r.topics[e];if(void 0===a)return;let c=o.get(n);c||(c={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(n,c));let u=0,l=0,h=0,d=0,f=0;if(t.inMesh){u+=Math.max(t.meshTime/a.timeInMeshQuantum,a.timeInMeshCap)*a.timeInMeshWeight}let p=t.firstMessageDeliveries;if(p>a.firstMessageDeliveriesCap&&(p=a.firstMessageDeliveriesCap),l+=p*a.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<a.meshMessageDeliveriesThreshold){const e=a.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;h+=e*e*a.meshMessageDeliveriesWeight}d+=t.meshFailurePenalty*a.meshFailurePenaltyWeight;f+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*a.invalidMessageDeliveriesWeight,s+=(u+l+h+d+f)*a.topicWeight,c.p1w+=u,c.p2w+=l,c.p3w+=h,c.p3bw+=d,c.p4w+=f})),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;const e=r.topicScoreCap/s;for(const t of o.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,c=0,u=0;a+=r.appSpecificScore(e)*r.appSpecificWeight,t.knownIPs.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){const e=i-r.IPColocationFactorThreshold;c+=e*e*r.IPColocationFactorWeight}}));return u+=t.behaviourPenalty*t.behaviourPenalty*r.behaviourPenaltyWeight,s+=a+c+u,{byTopic:o,p5w:a,p6w:c,p7w:u,score:s}}class xc{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Ac{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new xc(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new xc(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}class kc extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Ic(e={}){return Tc((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function Tc(e,t){let r,n,i,s=(t=t??{}).onEnd,o=new Ac,a=(0,rn.A)();const c=e=>null!=n?n(e):(o.push(e),r),u=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?r:(i=!0,null!=e?(e=>(o=new Ac,null!=n?n({error:e}):(o.push({error:e}),r)))(e):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{n=s=>{n=null,o.push(s);try{t(e(o))}catch(e){i(e)}return r}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,rn.A)()}))}},return:()=>(o=new Ac,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let r,n;null!=t&&(r=new Promise(((e,r)=>{n=()=>{r(new kc)},t.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=t&&t?.removeEventListener("abort",n)}}},null==s)return r;const h=r;return r={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return h.readableLength}},r}class Pc extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Cc(e,t,r){const n=r??{},i=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const s=()=>{null!=r&&r()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=n;throw new Pc(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=n;t(new Pc(e,r))}}));o=await Promise.race([e,i.next()]),r=null}catch(r){t.removeEventListener("abort",s);const o="aborted"===r.type&&t.aborted;if(o&&null!=n.onAbort&&n.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=n.onReturnError&&n.onReturnError(e)}))}catch(e){null!=n.onReturnError&&n.onReturnError(e)}if(o&&!0===n.returnOnAbort)return;throw r}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}var Rc=r(89754);class Oc{rawStream;pushable;closeController;maxBufferSize;constructor(e,t,r){this.rawStream=e,this.pushable=Ic({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=r.maxBufferSize??1/0,(0,Pi.F)(Cc(this.pushable,this.closeController.signal,{returnOnAbort:!0}),(e=>(0,Rc.l)(e)),this.rawStream).catch(t)}get protocol(){return this.rawStream.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class Dc{source;rawStream;closeController;constructor(e,t={}){this.rawStream=e,this.closeController=new AbortController,this.source=Cc((0,Pi.F)(this.rawStream,(e=>(0,Rc.D)(e,t))),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var Bc=r(85590);const Nc={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function Mc(e,t){t={...t};const r=Bc.Reader.create(e),n=e.length,i=void 0===n?r.len:r.pos+n,s={};for(;r.pos<i;){const e=r.uint32();switch(e>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.length<t.maxSubscriptions?s.subscriptions.push(Uc(r,r.uint32())):r.skipType(7&e);break;case 2:s.messages&&s.messages.length||(s.messages=[]),s.messages.length<t.maxMessages?s.messages.push(Lc(r,r.uint32())):r.skipType(7&e);break;case 3:s.control=jc(r,r.uint32(),t);break;default:r.skipType(7&e)}}return s}function Uc(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.subscribe=e.bool();break;case 2:n.topic=e.string();break;default:e.skipType(7&t)}}return n}function Lc(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.from=e.bytes();break;case 2:n.data=e.bytes();break;case 3:n.seqno=e.bytes();break;case 4:n.topic=e.string();break;case 5:n.signature=e.bytes();break;case 6:n.key=e.bytes();break;default:e.skipType(7&t)}}if(!n.topic)throw Error("missing required 'topic'");return n}function jc(e,t,r){const n=void 0===t?e.len:e.pos+t,i={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.length<r.maxControlMessages?i.ihave.push(Fc(e,e.uint32(),r)):e.skipType(7&t);break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.length<r.maxControlMessages?i.iwant.push(zc(e,e.uint32(),r)):e.skipType(7&t);break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.length<r.maxControlMessages?i.graft.push($c(e,e.uint32())):e.skipType(7&t);break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.length<r.maxControlMessages?i.prune.push(Kc(e,e.uint32(),r)):e.skipType(7&t);break;default:e.skipType(7&t)}}return i}function Fc(e,t,r){const n=void 0===t?e.len:e.pos+t,i={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),r.maxIhaveMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&t);break;default:e.skipType(7&t)}}return i}function zc(e,t,r){const n=void 0===t?e.len:e.pos+t,i={};for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),r.maxIwantMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&t);else e.skipType(7&t)}return i}function $c(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();if(t>>>3==1)n.topicID=e.string();else e.skipType(7&t)}return n}function Kc(e,t,r){const n=void 0===t?e.len:e.pos+t,i={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),r.maxPeerInfos-- >0?i.peers.push(Vc(e,e.uint32())):e.skipType(7&t);break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&t)}}return i}function Vc(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.peerID=e.bytes();break;case 2:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}r(48874);var qc=r(38231);var Wc=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*u+1>>>0,o=new Uint8Array(s);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,d=s-1;(0!==l||h<i)&&-1!==d;d--,h++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=s-i;f!==s&&0===o[f];)f++;for(var p=new Uint8Array(n+(s-f)),y=n;f!==s;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*l+1>>>0,u=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=o-n;p!==o&&0===u[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},Hc=Wc;new Uint8Array(0);const Gc=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class Jc{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Yc{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Xc(this,e)}}class Zc{constructor(e){this.decoders=e}or(e){return Xc(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Xc=(e,t)=>new Zc({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Qc{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Jc(e,t,r),this.decoder=new Yc(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const eu=({name:e,prefix:t,encode:r,decode:n})=>new Qc(e,t,r,n),tu=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Hc(r,t);return eu({prefix:e,name:t,encode:n,decode:e=>Gc(i(e))})},ru=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>eu({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),nu=eu({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),iu=ru({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),su=ru({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ou=tu({prefix:"9",name:"base10",alphabet:"0123456789"}),au=ru({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cu=ru({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),uu=ru({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lu=ru({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hu=ru({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),du=ru({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fu=ru({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pu=ru({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yu=ru({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gu=ru({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mu=ru({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bu=tu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),wu=tu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),vu=tu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_u=tu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Eu=ru({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Su=ru({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xu=ru({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Au=ru({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ku=Array.from(""),Iu=ku.reduce(((e,t,r)=>(e[r]=t,e)),[]),Tu=ku.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Pu=eu({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Iu[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Tu[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var Cu=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=Du;)r[n++]=255&t|Ru,t/=128;for(;t&Ou;)r[n++]=255&t|Ru,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Ru=128,Ou=-128,Du=Math.pow(2,31);var Bu=function e(t,r){var n,i=0,s=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&Mu)<<s:(n&Mu)*Math.pow(2,s),s+=7}while(n>=Nu);return e.bytes=o-r,i},Nu=128,Mu=127;var Uu=Math.pow(2,7),Lu=Math.pow(2,14),ju=Math.pow(2,21),Fu=Math.pow(2,28),zu=Math.pow(2,35),$u=Math.pow(2,42),Ku=Math.pow(2,49),Vu=Math.pow(2,56),qu=Math.pow(2,63),Wu={encode:Cu,decode:Bu,encodingLength:function(e){return e<Uu?1:e<Lu?2:e<ju?3:e<Fu?4:e<zu?5:e<$u?6:e<Ku?7:e<Vu?8:e<qu?9:10}};const Hu=(e,t,r=0)=>(Wu.encode(e,t,r),t),Gu=e=>Wu.encodingLength(e),Ju=(e,t)=>{const r=t.byteLength,n=Gu(e),i=n+Gu(r),s=new Uint8Array(i+r);return Hu(e,s,0),Hu(r,s,n),s.set(t,i),new Yu(e,r,t,s)};class Yu{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Zu=({name:e,code:t,encode:r})=>new Xu(e,t,r);class Xu{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ju(this.code,t):t.then((e=>Ju(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Qu=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),el=Zu({name:"sha2-256",code:18,encode:Qu("SHA-256")}),tl=Zu({name:"sha2-512",code:19,encode:Qu("SHA-512")}),rl=Gc,nl={code:0,name:"identity",encode:rl,digest:e=>Ju(0,rl(e))},il="raw",sl=85,ol=e=>Gc(e),al=e=>Gc(e),cl=new TextEncoder,ul=new TextDecoder,ll="json",hl=512,dl=e=>cl.encode(JSON.stringify(e)),fl=e=>JSON.parse(ul.decode(e));new WeakMap;class pl{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return pl.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Ju(e,t);return pl.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return pl.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return src_cid_format(this,e)}toJSON(){return{"/":src_cid_format(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof pl)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new pl(e,r,n,i||src_cid_encodeCID(e,r,n.bytes))}if(!0===t[src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=(e=>{const t=Gc(e),[r,n]=node_modules_multiformats_src_varint_decode(t),[i,s]=node_modules_multiformats_src_varint_decode(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Yu(r,i,o,t)})(r);return pl.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${src_cid_DAG_PB_CODE}) block encoding`);return new pl(e,t,r,r.bytes);case 1:{const n=src_cid_encodeCID(e,t,r.bytes);return new pl(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return pl.create(0,src_cid_DAG_PB_CODE,e)}static createV1(e,t){return pl.create(1,e,t)}static decode(e){const[t,r]=pl.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=pl.inspectBytes(e),r=t.size-t.multihashSize,n=Gc(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Yu(t.multihashCode,t.digestSize,i,n);return[0===t.version?pl.createV0(s):pl.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=node_modules_multiformats_src_varint_decode(e.subarray(t));return n,r};let n=r(),i=src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){const[r,n]=src_cid_parseCIDtoBytes(e,t),i=pl.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const yl={...T,...P,...C,...R,...O,...D,...B,...N,...M,...U};function gl(e=0){return null!=globalThis.Buffer?.allocUnsafe?function(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ml(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const bl=ml("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),wl=ml("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=gl((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var vl={utf8:bl,"utf-8":bl,hex:yl.base16,latin1:wl,ascii:wl,binary:wl,...yl};function _l(e,t="utf8"){const r=vl[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var El=r(71675);const Sl=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(4===r){const n=[];for(let i=0;i<r;i++)n.push(e[t+i]);return n.join(".")}if(16===r){const e=[];for(let i=0;i<r;i+=2)e.push(n.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},xl=-1,Al={},kl={};function Il(e){if("number"==typeof e){if(null!=kl[e])return kl[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=Al[e])return Al[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,xl,"ip6zone"],[43,8,"ipcidr"],[53,xl,"dns",!0],[54,xl,"dns4",!0],[55,xl,"dns6",!0],[56,xl,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,xl,"unix",!1,!0],[421,xl,"ipfs"],[421,xl,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,xl,"garlic64"],[448,0,"tls"],[449,xl,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,xl,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,xl,"memory"]].forEach((e=>{const t=function(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}(...e);kl[t.code]=t,Al[t.name]=t}));Il("ip4"),Il("ip6"),Il("ipcidr");function Tl(e,t){switch(Il(e).code){case 4:case 41:return function(e){const t=Sl(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!El.ei(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Rl(t);case 6:case 273:case 33:case 132:return Cl(t).toString();case 421:return function(e){const t=qc.D4(e),r=e.slice(qc.OY(t));if(r.length!==t)throw new Error("inconsistent lengths");return _l(r,"base58btc")}(t);case 444:case 445:return Ol(t);case 466:return function(e){const t=qc.D4(e),r=e.slice(qc.OY(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+_l(r,"base64url")}(t);default:return _l(t,"base16")}}const Pl=Object.values(po).map((e=>e.decoder));!function(){let e=Pl[0].or(Pl[1]);Pl.slice(2).forEach((t=>e=e.or(t)))}();function Cl(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function Rl(e){const t=qc.D4(e);if((e=e.slice(qc.OY(t))).length!==t)throw new Error("inconsistent lengths");return _l(e)}function Ol(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return`${_l(t,"base32")}:${Cl(r)}`}var Dl;!function(e){e[e.ip4=4]="ip4",e[e.ip6=41]="ip6"}(Dl||(Dl={}));var Bl;!function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"}(Bl||(Bl={}));class Nl extends To.b{globalSignaturePolicy;multicodecs=[Bo,Do];publishConfig;dataTransform;peers=new Set;streamsInbound=new Map;streamsOutbound=new Map;outboundInflightQueue=Ic({objectMode:!0});direct=new Set;floodsubPeers=new Set;seenCache;acceptFromWhitelist=new Map;topics=new Map;subscriptions=new Set;mesh=new Map;fanout=new Map;fanoutLastpub=new Map;gossip=new Map;control=new Map;peerhave=new Map;iasked=new Map;backoff=new Map;outbound=new Map;msgIdFn;fastMsgIdFn;msgIdToStrFn;fastMsgIdCache;publishedMessageIds;mcache;score;topicValidators=new Map;log;heartbeatTicks=0;gossipTracer;components;directPeerInitial=null;static multicodec=Bo;opts;decodeRpcLimits;metrics;status={code:Bl.stopped};maxInboundStreams;maxOutboundStreams;allowedTopics;heartbeatTimer=null;constructor(e,t={}){super();const r={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...t,scoreParams:ec(t.scoreParams),scoreThresholds:nc(t.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=r.decodeRpcLimits??Nc,this.globalSignaturePolicy=r.globalSignaturePolicy??Ja.rv,r.fallbackToFloodsub&&this.multicodecs.push(Oo),this.log=Io(r.debugName??"libp2p:gossipsub"),this.opts=r,this.direct=new Set(r.directPeers.map((e=>e.id.toString()))),this.seenCache=new fc({validityMs:r.seenTTL}),this.publishedMessageIds=new fc({validityMs:r.seenTTL}),t.msgIdFn)this.msgIdFn=t.msgIdFn;else switch(this.globalSignaturePolicy){case Ja.rv:this.msgIdFn=_c;break;case Ja.G$:this.msgIdFn=Ec}if(t.fastMsgIdFn&&(this.fastMsgIdFn=t.fastMsgIdFn,this.fastMsgIdCache=new fc({validityMs:r.seenTTL})),this.msgIdToStrFn=t.msgIdToStrFn??Vo,this.mcache=t.messageCache||new Po(r.mcacheGossip,r.mcacheLength,this.msgIdToStrFn),t.dataTransform&&(this.dataTransform=t.dataTransform),t.metricsRegister){if(!t.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const e=Math.max(...Object.values(r.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),1e3),n=function(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:e.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:e.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:e.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:e.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:e.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:e.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:e.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:e.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:e.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:e.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",labelNames:["topic"],buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:e.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:e.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:e.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:e.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:e.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:e.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:e.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:e.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:e.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:e.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:e.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:e.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:e.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:e.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:e.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:e.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),iwantPromiseUntracked:e.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:e.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic(e){return this.topicStrToLabel.get(e)??e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,r){const n=this.toTopic(e);switch(t){case yc.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:n},r);break;case yc.Random:this.meshPeerInclusionEventsRandom.inc({topic:n},r);break;case yc.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:n},r);break;case yc.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:n},r);break;case yc.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:n},r);break;case yc.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:n},r);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:n},r)}},onRemoveFromMesh(e,t,r){const n=this.toTopic(e);switch(t){case gc.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:n},r);break;case gc.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:n},r);break;case gc.Prune:this.meshPeerChurnEventsPrune.inc({topic:n},r);break;case gc.Excess:this.meshPeerChurnEventsExcess.inc({topic:n},r);break;default:this.meshPeerChurnEventsUnknown.inc({topic:n},r)}},onReportValidation(e,t,r){if(this.asyncValidationMcacheHit.inc({hit:null!=e?"hit":"miss"}),null!=e){const r=this.toTopic(e.message.topic);switch(t){case Ja.z8.Accept:this.acceptedMessagesTotal.inc({topic:r});break;case Ja.z8.Ignore:this.ignoredMessagesTotal.inc({topic:r});break;case Ja.z8.Reject:this.rejectedMessagesTotal.inc({topic:r});break;default:this.unknownValidationResultsTotal.inc({topic:r})}}null!=r?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-r)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,r){const n=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:n},t),this.ihaveRcvNotSeenMsgids.inc({topic:n},r)},onIwantRcv(e,t){for(const[t,r]of e){const e=this.toTopic(t);this.iwantRcvMsgids.inc({topic:e},r)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const r=this.toTopic(e);this.msgForwardCount.inc({topic:r},1),this.msgForwardPeers.inc({topic:r},t)},onPublishMsg(e,t,r,n,i){const s=this.toTopic(e);this.msgPublishCount.inc({topic:s},1),this.msgPublishBytes.inc({topic:s},r*n),this.msgPublishPeersByTopic.inc({topic:s},r),this.directPeersPublishedTotal.inc({topic:s},t.direct),this.floodsubPeersPublishedTotal.inc({topic:s},t.floodsub),this.meshPeersPublishedTotal.inc({topic:s},t.mesh),this.fanoutPeersPublishedTotal.inc({topic:s},t.fanout),this.msgPublishTime.observe({topic:s},i/1e3)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvError(e){const t=this.toTopic(e);this.msgReceivedError.inc({topic:t},1)},onPrevalidationResult(e,t){const r=this.toTopic(e);switch(t){case Ga.duplicate:this.prevalidationDuplicateTotal.inc({topic:r});break;case Ga.invalid:this.prevalidationInvalidTotal.inc({topic:r});break;case Ga.valid:this.prevalidationValidTotal.inc({topic:r});break;default:this.prevalidationUnknownTotal.inc({topic:r})}},onMsgRecvInvalid(e,t){const r=this.toTopic(e),n=t.reason===Wa.Error?t.error:t.reason;this.msgReceivedInvalid.inc({error:n},1),this.msgReceivedInvalidByTopic.inc({topic:r},1)},onDuplicateMsgDelivery(e,t,r){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),r){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onPublishDuplicateMsg(e){const t=this.toTopic(e);this.duplicateMsgIgnored.inc({topic:t},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){const t=e.control.ihave?.length??0,r=e.control.iwant?.length??0,n=e.control.graft?.length??0,i=e.control.prune?.length??0;t>0&&this.rpcSentIHave.inc(t),r>0&&this.rpcSentIWant.inc(r),n>0&&this.rpcSentGraft.inc(n),i>0&&this.rpcSentPrune.inc(i),(t>0||r>0||n>0||i>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let r=0,n=0,i=0,s=0;for(const o of e)o>=t.graylistThreshold&&r++,o>=t.publishThreshold&&n++,o>=t.gossipThreshold&&i++,o>=0&&s++;this.peersByScoreThreshold.set({threshold:wc.graylist},r),this.peersByScoreThreshold.set({threshold:wc.publish},n),this.peersByScoreThreshold.set({threshold:wc.gossip},i),this.peersByScoreThreshold.set({threshold:wc.mesh},s),this.score.set(e)},registerScoreWeights(e){for(const[t,r]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},r.p1w),this.scoreWeights.set({topic:t,p:"p2"},r.p2w),this.scoreWeights.set({topic:t,p:"p3"},r.p3w),this.scoreWeights.set({topic:t,p:"p3b"},r.p3bw),this.scoreWeights.set({topic:t,p:"p4"},r.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const r=new Map;e.forEach(((e,t)=>{const n=this.topicStrToLabel.get(t)??"unknown";let i=r.get(n);i||(i=new Set,r.set(n,i)),e.forEach((e=>i?.add(e)))}));for(const[e,n]of r){const r=[];n.forEach((e=>{r.push(t.get(e)??0)})),this.scorePerMesh.set({topic:e},r)}}}}(t.metricsRegister,t.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:r.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:e/1e3});n.mcacheSize.addCollect((()=>this.onScrapeMetrics(n)));for(const e of this.multicodecs)n.protocolsEnabled.set({protocol:e},1);this.metrics=n}else this.metrics=null;this.gossipTracer=new dc(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new hc(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:r.heartbeatInterval}),this.maxInboundStreams=t.maxInboundStreams,this.maxOutboundStreams=t.maxOutboundStreams,this.allowedTopics=r.allowedTopics?new Set(r.allowedTopics):null}getPeers(){return[...this.peers.keys()].map((e=>Ao(e)))}isStarted(){return this.status.code===Bl.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await async function(e,t){switch(e){case Ja.rv:{if(!t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await Ka(t.privateKey);return{type:qa.Signing,author:t,key:t.publicKey,privateKey:e}}case Ja.G$:return{type:qa.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=Ic({objectMode:!0}),(0,Pi.F)(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:r}of e)await this.createOutboundStream(t,r)})).catch((e=>this.log.error("outbound inflight queue error",e))),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.peerStore.merge(e.id,{multiaddrs:e.addrs})})));const e=this.components.registrar;await Promise.all(this.multicodecs.map((t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)},r=await Promise.all(this.multicodecs.map((r=>e.register(r,t)))),n=setTimeout(this.runHeartbeat,100);this.status={code:Bl.started,registrarTopologyIds:r,heartbeatTimeout:n,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>await this.connect(e))))})).catch((e=>{this.log(e)}))}),1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==Bl.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:Bl.stopped};const t=this.components.registrar;await Promise.all(this.multicodecs.map((e=>t.unhandle(e)))),e.forEach((e=>t.unregister(e))),this.outboundInflightQueue.end();for(const e of this.streamsOutbound.values())e.close();this.streamsOutbound.clear();for(const e of this.streamsInbound.values())e.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const r=t.remotePeer;this.addPeer(r,t.direction,t.remoteAddr),this.createInboundStream(r,e),this.outboundInflightQueue.push({peerId:r,connection:t})}onPeerConnected(e,t){this.metrics?.newConnectionCount.inc({status:t.status}),this.isStarted()&&"open"===t.status&&(this.addPeer(e,t.direction,t.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(this.peers.has(r)&&!this.streamsOutbound.has(r))try{const n=new Oc(await t.newStream(this.multicodecs),(e=>this.log.error("outbound pipe error",e)),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(r,n);const i=n.protocol;i===Oo&&this.floodsubPeers.add(r),this.metrics?.peersPerProtocol.inc({protocol:i},1),this.subscriptions.size>0&&(this.log("send subscriptions to",r),this.sendSubscriptions(r,Array.from(this.subscriptions),!0))}catch(e){this.log.error("createOutboundStream error",e)}}async createInboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(!this.peers.has(r))return;const n=this.streamsInbound.get(r);void 0!==n&&(this.log("replacing existing inbound steam %s",r),n.close()),this.log("create inbound stream %s",r);const i=new Dc(t,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(r,i),this.pipePeerReadStream(e,i.source).catch((e=>this.log(e)))}addPeer(e,t,r){const n=e.toString();if(!this.peers.has(n)){this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n);const i=function(e){for(const t of e.tuples())switch(t[0]){case Dl.ip4:case Dl.ip6:return Tl(t[0],t[1])}return null}(r);null!==i?this.score.addIP(n,i):this.log("Added peer has no IP in current address %s %s",n,r.toString()),this.outbound.has(n)||this.outbound.set(n,"outbound"===t)}}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const r=this.streamsOutbound.get(t),n=this.streamsInbound.get(t);r&&this.metrics?.peersPerProtocol.inc({protocol:r.protocol},-1),r?.close(),n?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const e of this.topics.values())e.delete(t);for(const[e,r]of this.mesh)!0===r.delete(t)&&this.metrics?.onRemoveFromMesh(e,gc.Dc,1);for(const e of this.fanout.values())e.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===Bl.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map((e=>Ao(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await(0,Pi.F)(t,(async t=>{for await(const r of t)try{const t=r.subarray(),n=Mc(t,this.decodeRpcLimits);if(this.metrics?.onRpcRecv(n,t.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(e,n)}catch(e){this.metrics?.onRpcRecvError(),this.log(e)}else this.handleReceivedRpc(e,n).catch((e=>{this.metrics?.onRpcRecvError(),this.log(e)}))}catch(e){this.metrics?.onRpcDataError(),this.log(e)}}))}catch(t){this.metrics?.onPeerReadStreamError(),this.handlePeerReadStreamError(t,e)}}handlePeerReadStreamError(e,t){this.log.error(e),this.onPeerDisconnected(t)}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void this.metrics?.rpcRecvNotAccepted.inc();const r=t.subscriptions?t.subscriptions.length:0,n=t.messages?t.messages.length:0;let i=0,s=0,o=0,a=0;if(t.control&&(t.control.ihave&&(i=t.control.ihave.length),t.control.iwant&&(s=t.control.iwant.length),t.control.graft&&(o=t.control.graft.length),t.control.prune&&(a=t.control.prune.length)),this.log(`rpc.from ${e.toString()} subscriptions ${r} messages ${n} ihave ${i} iwant ${s} graft ${o} prune ${a}`),t.subscriptions&&t.subscriptions.length>0){const r=[];t.subscriptions.forEach((t=>{const n=t.topic,i=!0===t.subscribe;if(null!=n){if(this.allowedTopics&&!this.allowedTopics.has(n))return;this.handleReceivedSubscription(e,n,i),r.push({topic:n,subscribe:i})}})),this.dispatchEvent(new To.u("subscription-change",{detail:{peerId:e,subscriptions:r}}))}if(t.messages)for(const r of t.messages){if(this.allowedTopics&&!this.allowedTopics.has(r.topic))continue;const t=this.handleReceivedMessage(e,r).catch((e=>{this.metrics?.onMsgRecvError(r.topic),this.log(e)}));this.opts.awaitRpcMessageHandler&&await t}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t,r){this.log("subscription update from %p topic %s",e,t);let n=this.topics.get(t);null==n&&(n=new Set,this.topics.set(t,n)),r?n.add(e.toString()):n.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);const r=await this.validateReceivedMessage(e,t);switch(this.metrics?.onPrevalidationResult(t.topic,r.code),r.code){case Ga.duplicate:return this.score.duplicateMessage(e.toString(),r.msgIdStr,t.topic),this.gossipTracer.deliverMessage(r.msgIdStr,!0),void this.mcache.observeDuplicate(r.msgIdStr,e.toString());case Ga.invalid:if(r.msgIdStr){const n=r.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,r.reason),this.gossipTracer.rejectMessage(n,r.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void this.metrics?.onMsgRecvInvalid(t.topic,r);case Ga.valid:if(this.score.validateMessage(r.messageId.msgIdStr),this.gossipTracer.deliverMessage(r.messageId.msgIdStr),this.mcache.put(r.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){this.components.peerId.equals(e)&&!this.opts.emitSelf||(super.dispatchEvent(new To.u("gossipsub:message",{detail:{propagationSource:e,msgId:r.messageId.msgIdStr,msg:r.msg}})),super.dispatchEvent(new To.u("message",{detail:r.msg})))}this.opts.asyncValidation||this.forwardMessage(r.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){const r=this.fastMsgIdFn?.(t),n=void 0!==r?this.fastMsgIdCache?.get(r):void 0;if(n)return{code:Ga.duplicate,msgIdStr:n};const i=await async function(e,t){switch(e){case Ja.G$:return null!=t.signature?{valid:!1,error:Ha.SignaturePresent}:null!=t.seqno?{valid:!1,error:Ha.SeqnoPresent}:null!=t.key?{valid:!1,error:Ha.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case Ja.rv:{if(null==t.seqno)return{valid:!1,error:Ha.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:Ha.InvalidSeqno};if(null==t.signature)return{valid:!1,error:Ha.InvalidSignature};if(null==t.from)return{valid:!1,error:Ha.InvalidPeerId};let e,i;try{e=ko(t.from)}catch(e){return{valid:!1,error:Ha.InvalidPeerId}}if(t.key){if(i=$a(t.key),void 0!==e.publicKey&&!yo(i.bytes,e.publicKey))return{valid:!1,error:Ha.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:Ha.InvalidPeerId};i=$a(e.publicKey)}const s={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},o=Xo([vc,Ro.Message.encode(s).finish()]);return await i.verify(o,t.signature)?{valid:!0,message:{type:"signed",from:e,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${Ko(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??(r=i,za(n=(n??"rsa").toLowerCase()),r.bytes)}}:{valid:!1,error:Ha.InvalidSignature}}}var r,n}(this.globalSignaturePolicy,t);if(!i.valid)return{code:Ga.invalid,reason:Wa.Error,error:i.error};const s=i.message;try{this.dataTransform&&(s.data=this.dataTransform.inboundTransform(t.topic,s.data))}catch(e){return this.log("Invalid message, transform failed",e),{code:Ga.invalid,reason:Wa.Error,error:Ha.TransformFailed}}const o=await this.msgIdFn(s),a=this.msgIdToStrFn(o),c={msgId:o,msgIdStr:a};if(void 0!==r&&this.fastMsgIdCache){this.fastMsgIdCache.put(r,a)&&this.metrics?.fastMsgIdCacheCollision.inc()}if(this.seenCache.has(a))return{code:Ga.duplicate,msgIdStr:a};this.seenCache.put(a);const u=this.topicValidators.get(t.topic);if(null!=u){let t;try{t=await u(e,s)}catch(e){const r=e.code;"ERR_TOPIC_VALIDATOR_IGNORE"===r&&(t=Ja.z8.Ignore),t="ERR_TOPIC_VALIDATOR_REJECT"===r?Ja.z8.Reject:Ja.z8.Ignore}if(t!==Ja.z8.Accept)return{code:Ga.invalid,reason:Ya(t),msgIdStr:a}}return{code:Ga.valid,messageId:c,msg:s}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,r){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:r})))})}async handleControlMessage(e,t){if(void 0===t)return;const r=t.ihave?this.handleIHave(e,t.ihave):[],n=t.iwant?this.handleIWant(e,t.iwant):[],i=t.graft?await this.handleGraft(e,t.graft):[];if(t.prune&&await this.handlePrune(e,t.prune),!r.length&&!n.length&&!i.length)return;const s=this.sendRpc(e,{messages:n,control:{iwant:r,prune:i}}),o=r[0]?.messageIDs;o&&(s?this.gossipTracer.addPromise(e,o):this.metrics?.iwantPromiseUntracked.inc(1))}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<128&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;const n=this.score.score(e);return n>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:bc.LowScore}),[];const n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:bc.MaxIhave}),[];const i=this.iasked.get(e)??0;if(i>=No)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:bc.MaxIasked}),[];const s=new Map;if(t.forEach((({topicID:e,messageIDs:t})=>{if(!e||!t||!this.mesh.has(e))return;let r=0;t.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(s.set(t,e),r++)})),this.metrics?.onIhaveRcv(e,t.length,r)})),!s.size)return[];let o=s.size;o+i>No&&(o=No-i),this.log("IHAVE: Asking for %d out of %d messages from %s",o,s.size,e);let a=Array.from(s.values());return Mo(a),a=a.slice(0,o),this.iasked.set(e,i+o),[{messageIDs:a}]}handleIWant(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const n=new Map,i=new Map;let s=0;return t.forEach((({messageIDs:t})=>{t&&t.forEach((t=>{const r=this.msgIdToStrFn(t),o=this.mcache.getWithIWantCount(r,e);null!=o?(i.set(o.msg.topic,1+(i.get(o.msg.topic)??0)),o.count>3?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):n.set(r,o.msg)):s++}))})),this.metrics?.onIwantRcv(i,s),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){const r=[],n=this.score.score(e),i=Date.now();let s=this.opts.doPX;if(t.forEach((({topicID:t})=>{if(!t)return;const o=this.mesh.get(t);if(!o)return void(s=!1);if(o.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),r.push(t),void(s=!1);const a=this.backoff.get(t)?.get(e);if("number"==typeof a&&i<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,mc.GraftBackoff),s=!1;const n=a+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return i<n&&this.score.addPenalty(e,1,mc.GraftBackoff),this.addBackoff(e,t),void r.push(t)}return n<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,t),r.push(t),s=!1,void this.addBackoff(e,t)):o.size>=this.opts.Dhi&&!this.outbound.get(e)?(r.push(t),void this.addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),o.add(e),void this.metrics?.onAddToMesh(t,yc.Subscribed,1))})),!r.length)return[];return await Promise.all(r.map((t=>this.makePrune(e,t,s,false))))}async handlePrune(e,t){const r=this.score.score(e);for(const{topicID:n,backoff:i,peers:s}of t){if(null==n)continue;const t=this.mesh.get(n);if(!t)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),t.has(e)&&(t.delete(e),this.metrics?.onRemoveFromMesh(n,gc.Prune,1)),"number"==typeof i&&i>0?this.doAddBackoff(e,n,1e3*i):this.addBackoff(e,n),s&&s.length){if(r<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,n);continue}await this.pxConnect(s)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,r){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));const i=Date.now()+r;(n.get(e)??0)<i&&n.set(e,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,mc.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%15!=0)return;const e=Date.now();this.backoff.forEach(((t,r)=>{t.forEach(((r,n)=>{r+1*this.opts.heartbeatInterval<e&&t.delete(n)})),0===t.size&&this.backoff.delete(r)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>await this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(Mo(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(!e.peerID)return;const r=ko(e.peerID),n=r.toString();if(!this.peers.has(n))if(e.signedPeerRecord)try{if(!await this.components.peerStore.consumePeerRecord(e.signedPeerRecord,r))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(n)}catch(e){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(n)}))),t.length&&await Promise.all(t.map((async e=>await this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=Ao(e),r=await this.components.connectionManager.openConnection(t);for(const e of this.multicodecs)for(const n of this.components.registrar.getTopologies(e))n.onConnect?.(t,r)}subscribe(e){if(this.status.code!==Bl.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==Bl.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!1);this.leave(e)}join(e){if(this.status.code!==Bl.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);const t=new Set,r=this.backoff.get(e),n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach((e=>{this.direct.has(e)||!(this.score.score(e)>=0)||r&&r.has(e)||t.add(e)})),this.metrics?.onAddToMesh(e,yc.Fanout,t.size)),t.size<this.opts.D){const n=t.size;this.getRandomGossipPeers(e,this.opts.D,(e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0&&(!r||!r.has(e)))).forEach((e=>{t.add(e)})),this.metrics?.onAddToMesh(e,yc.Random,t.size-n)}this.mesh.set(e,t),t.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}leave(e){if(this.status.code!==Bl.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);const t=this.mesh.get(e);t&&(Promise.all(Array.from(t).map((async t=>(this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e))))).catch((e=>{this.log("Error sending prunes to mesh peers",e)})),this.mesh.delete(e))}selectPeersToForward(e,t,r){const n=new Set,i=this.topics.get(e);i&&(this.direct.forEach((e=>{i.has(e)&&t!==e&&!r?.has(e)&&n.add(e)})),this.floodsubPeers.forEach((e=>{i.has(e)&&t!==e&&!r?.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&n.add(e)})));const s=this.mesh.get(e);return s&&s.size>0&&s.forEach((e=>{t===e||r?.has(e)||n.add(e)})),n}selectPeersToPublish(e){const t=new Set,r={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach((e=>{this.direct.has(e)?(t.add(e),r.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));else{this.direct.forEach((e=>{n.has(e)&&(t.add(e),r.direct++)})),this.floodsubPeers.forEach((e=>{n.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));const i=this.mesh.get(e);if(i&&i.size>0)i.forEach((e=>{t.add(e),r.mesh++}));else{const n=this.fanout.get(e);if(n&&n.size>0)n.forEach((e=>{t.add(e),r.fanout++}));else{const n=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));n.size>0&&(this.fanout.set(e,n),n.forEach((e=>{t.add(e),r.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:r}}forwardMessage(e,t,r,n){r&&this.score.deliverMessage(r,e,t.topic);const i=this.selectPeersToForward(t.topic,r,n);i.forEach((e=>{this.sendRpc(e,{messages:[t]})})),this.metrics?.onForwardMsg(t.topic,i.size)}async publish(e,t,r){const n=Date.now(),i=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:s,msg:o}=await async function(e,t,r,n){switch(e.type){case qa.Signing:{const i={from:e.author.toBytes(),data:n,seqno:ba(8),topic:t,signature:void 0,key:void 0},s=Xo([vc,Ro.Message.encode(i).finish()]);return i.signature=await e.privateKey.sign(s),i.key=e.key,{raw:i,msg:{type:"signed",from:e.author,data:r,sequenceNumber:BigInt(`0x${Ko(i.seqno,"base16")}`),topic:t,signature:i.signature,key:i.key}}}case qa.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:t}}}}(this.publishConfig,e,t,i),a=await this.msgIdFn(o),c=this.msgIdToStrFn(a),u=r?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(c)){if(u)return this.metrics?.onPublishDuplicateMsg(e),{recipients:[]};throw Error("PublishError.Duplicate")}const{tosend:l,tosendCount:h}=this.selectPeersToPublish(e),d=!0===this.opts.emitSelf&&this.subscriptions.has(e),f=r?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(0===l.size&&!f&&!d)throw Error("PublishError.InsufficientPeers");this.seenCache.put(c),this.mcache.put({msgId:a,msgIdStr:c},s,!0),this.publishedMessageIds.put(c);for(const e of l){this.sendRpc(e,{messages:[s]})||l.delete(e)}const p=Date.now()-n;return this.metrics?.onPublishMsg(e,h,l.size,null!=s.data?s.data.length:0,p),d&&(l.add(this.components.peerId.toString()),super.dispatchEvent(new To.u("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:c,msg:o}})),super.dispatchEvent(new To.u("message",{detail:o}))),{recipients:Array.from(l.values()).map((e=>Ao(e)))}}reportMessageValidationResult(e,t,r){let n;if(r===Ja.z8.Accept){if(n=this.mcache.validate(e),null!=n){const{message:r,originatingPeers:i}=n;this.score.deliverMessage(t,e,r.topic),this.forwardMessage(e,n.message,t,i)}}else if(n=this.mcache.remove(e),n){const i=Ya(r),{message:s,originatingPeers:o}=n;this.score.rejectMessage(t,e,s.topic,i);for(const t of o)this.score.rejectMessage(t,e,s.topic,i)}const i=this.score.messageFirstSeenTimestampMs(e);this.metrics?.onReportValidation(n,r,i)}sendGraft(e,t){const r=[{topicID:t}];this.sendRpc(e,{control:{graft:r}})}async sendPrune(e,t){const r=[await this.makePrune(e,t,this.opts.doPX,!0)];this.sendRpc(e,{control:{prune:r}})}sendRpc(e,t){const r=this.streamsOutbound.get(e);if(!r)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const n=this.control.get(e);n&&(this.piggybackControl(e,t,n),this.control.delete(e));const i=this.gossip.get(e);i&&(this.piggybackGossip(e,t,i),this.gossip.delete(e));const s=Ro.encode(t).finish();try{r.push(s)}catch(t){return this.log.error(`Cannot send rpc to ${e}`,t),n&&this.control.set(e,n),i&&this.gossip.set(e,i),!1}return this.metrics?.onRpcSent(t,s.length),!0}piggybackControl(e,t,r){if(r.graft){t.control||(t.control={}),t.control.graft||(t.control.graft=[]);for(const n of r.graft)n.topicID&&this.mesh.get(n.topicID)?.has(e)&&t.control.graft.push(n)}if(r.prune){t.control||(t.control={}),t.control.prune||(t.control.prune=[]);for(const n of r.prune)n.topicID&&!this.mesh.get(n.topicID)?.has(e)&&t.control.prune.push(n)}}piggybackGossip(e,t,r){t.control||(t.control={}),t.control.ihave=r}async sendGraftPrune(e,t,r){const n=this.opts.doPX;for(const[i,s]of e){const e=s.map((e=>({topicID:e})));let o=[];const a=t.get(i);a&&(o=await Promise.all(a.map((async e=>await this.makePrune(i,e,n&&!r.get(i),false)))),t.delete(i)),this.sendRpc(i,{control:{graft:e,prune:o}})}for(const[e,i]of t){const t=await Promise.all(i.map((async t=>await this.makePrune(e,t,n&&!r.get(e),false))));this.sendRpc(e,{control:{prune:t}})}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[r,n]of e)this.doEmitGossip(r,n,t.get(r)??[])}doEmitGossip(e,t,r){if(!r.length)return;if(Mo(r),r.length>No&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),!t.size)return;let n=this.opts.Dlazy;const i=.25*t.size;let s=t;i>n&&(n=i),n>s.size?n=s.size:s=Mo(Array.from(s)).slice(0,n),s.forEach((t=>{let n=r;r.length>No&&(n=Mo(n.slice()).slice(0,No)),this.pushGossip(t,{topicID:e,messageIDs:n})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:t}});for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:t.graft,prune:t.prune}})}pushGossip(e,t){this.log("Add gossip to %s",e);const r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,r,n){if(this.score.prune(e,t),this.streamsOutbound.get(e).protocol===Do)return{topicID:t,peers:[]};const i=n?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,s=i/1e3;if(this.doAddBackoff(e,t,i),!r)return{topicID:t,peers:[],backoff:s};const o=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),a=await Promise.all(Array.from(o).map((async e=>{const t=Ao(e);let r;try{r=await this.components.peerStore.get(t)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return{peerID:t.toBytes(),signedPeerRecord:r?.peerRecordEnvelope}})));return{topicID:t,peers:a,backoff:s}}runHeartbeat=()=>{const e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=e&&e(),this.status.code===Bl.started){clearTimeout(this.status.heartbeatTimeout);let e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;e<.25*this.opts.heartbeatInterval&&(e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,e)}}))};async heartbeat(){const{D:e,Dlo:t,Dhi:r,Dscore:n,Dout:i,fanoutTTL:s}=this.opts;this.heartbeatTicks++;const o=new Map,a=e=>{let t=o.get(e);return void 0===t&&(t=this.score.score(e),o.set(e,t)),t},c=new Map,u=new Map,l=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks==0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const h=new Map;this.mesh.forEach(((s,o)=>{const d=this.topics.get(o),f=new Set,p=new Set;if(h.set(o,p),d){const e=Mo(Array.from(d)),t=this.backoff.get(o);for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!s.has(r)&&!this.direct.has(r)){const e=a(r);t&&t.has(r)||!(e>=0)||f.add(r),e>=this.opts.scoreThresholds.gossipThreshold&&p.add(r)}}}const y=(e,t)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",e,o),this.addBackoff(e,o),s.delete(e),a(e)>=this.opts.scoreThresholds.gossipThreshold&&p.add(e),this.metrics?.onRemoveFromMesh(o,t,1);const r=u.get(e);r?r.push(o):u.set(e,[o])},g=(e,t)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",e,o),this.score.graft(e,o),s.add(e),p.delete(e),this.metrics?.onAddToMesh(o,t,1);const r=c.get(e);r?r.push(o):c.set(e,[o])};if(s.forEach((e=>{const t=a(e);t<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,o),y(e,gc.BadScore),l.set(e,!0))})),s.size<t){const t=function(e,t){return cc(e,t,(()=>!0))}(f,e-s.size);t.forEach((e=>{g(e,yc.NotEnough)}))}if(s.size>r){let t=Array.from(s);t.sort(((e,t)=>a(t)-a(e))),t=t.slice(0,n).concat(Mo(t.slice(n)));let r=0;if(t.slice(0,e).forEach((e=>{this.outbound.get(e)&&r++})),r<i){const n=e=>{const r=t[e];for(let r=e;r>0;r--)t[r]=t[r-1];t[0]=r};if(r>0){let i=r;for(let r=1;r<e&&i>0;r++)this.outbound.get(t[r])&&(n(r),i--)}let i=e-r;for(let r=e;r<t.length&&i>0;r++)this.outbound.get(t[r])&&(n(r),i--)}t.slice(e).forEach((e=>{y(e,gc.Excess)}))}if(s.size>=t){let e=0;if(s.forEach((t=>{this.outbound.get(t)&&e++})),e<i){cc(f,i-e,(e=>!0===this.outbound.get(e))).forEach((e=>{g(e,yc.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks==0&&s.size>1){const e=Array.from(s).sort(((e,t)=>a(e)-a(t))),t=Math.floor(s.size/2),r=a(e[t]);if(r<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=cc(f,this.opts.opportunisticGraftPeers,(e=>a(e)>r));for(const t of e)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",t,o),g(t,yc.Opportunistic)}}}));const d=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+s<d&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((t,r)=>{const n=this.topics.get(r);t.forEach((e=>{(!n.has(e)||a(e)<this.opts.scoreThresholds.publishThreshold)&&t.delete(e)}));const i=this.topics.get(r),s=[],o=new Set;if(h.set(r,o),i){const e=Mo(Array.from(i));for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!t.has(r)&&!this.direct.has(r)){const e=a(r);e>=this.opts.scoreThresholds.publishThreshold&&s.push(r),e>=this.opts.scoreThresholds.gossipThreshold&&o.add(r)}}}if(t.size<e){const r=e-t.size;s.slice(0,r).forEach((e=>{t.add(e),o?.delete(e)}))}})),this.emitGossip(h),await this.sendGraftPrune(c,u,l),this.flush(),this.mcache.shift(),this.dispatchEvent(new To.u("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,r=(()=>!0)){const n=this.topics.get(e);if(!n)return new Set;let i=[];return n.forEach((e=>{const t=this.streamsOutbound.get(e);t&&this.multicodecs.includes(t.protocol)&&r(e)&&i.push(e)})),i=Mo(i),t>0&&i.length>t&&(i=i.slice(0,t)),new Set(i)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;const r=Date.now();e.connectedPeersBackoffSec.reset();for(const n of this.backoff.values()){t+=n.size;for(const[t,i]of n.entries())this.peers.has(t)&&e.connectedPeersBackoffSec.observe(Math.max(0,i-r)/1e3)}e.cacheSize.set({cache:"backoff"},t);for(const[t,r]of this.topics)e.topicPeersCount.set({topicStr:t},r.size);for(const[t,r]of this.mesh)e.meshPeerCounts.set({topicStr:t},r.size);const n=[],i=new Map;e.behaviourPenalty.reset();for(const t of this.peers.keys()){const r=this.score.score(t);n.push(r),i.set(t,r),e.behaviourPenalty.observe(this.score.peerStats.get(t)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,i);const s=function(e,t,r,n,i){const s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of e){const e=t.get(o);if(e){const t=Sc(o,e,r,n,i);for(const[e,r]of t.byTopic){let t=s.byTopic.get(e);t||(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(e,t)),t.p1w.push(r.p1w),t.p2w.push(r.p2w),t.p3w.push(r.p3w),t.p3bw.push(r.p3bw),t.p4w.push(r.p4w)}s.p5w.push(t.p5w),s.p6w.push(t.p6w),s.p7w.push(t.p7w),s.score.push(t.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}}function Ml(e={}){return t=>new Nl(t,e)}var Ul=r(86320),Ll=r(84419),jl=r(49736),Fl=r(11741),zl=r(2791);class $l extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Kl(e,t,r){const n=r??{},i=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const s=()=>{null!=r&&r()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=n;throw new $l(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=n;t(new $l(e,r))}}));o=await Promise.race([e,i.next()]),r=null}catch(r){t.removeEventListener("abort",s);const o="aborted"===r.type&&t.aborted;if(o&&null!=n.onAbort&&n.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=n.onReturnError&&n.onReturnError(e)}))}catch(e){null!=n.onReturnError&&n.onReturnError(e)}if(o&&!0===n.returnOnAbort)return;throw r}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}class Vl{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class ql{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Vl(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Vl(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}class Wl extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Hl(e,t){let r,n,i,s=(t=t??{}).onEnd,o=new ql,a=(0,rn.A)();const c=e=>null!=n?n(e):(o.push(e),r),u=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?r:(i=!0,null!=e?(e=>(o=new ql,null!=n?n({error:e}):(o.push({error:e}),r)))(e):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{n=s=>{n=null,o.push(s);try{t(e(o))}catch(e){i(e)}return r}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,rn.A)()}))}},return:()=>(o=new ql,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let r,n;null!=t&&(r=new Promise(((e,r)=>{n=()=>{r(new Wl)},t.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=t&&t?.removeEventListener("abort",n)}}},null==s)return r;const h=r;return r={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return h.readableLength}},r}var Gl=r(93157);function Jl(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}const Yl=ae({prefix:"9",name:"base10",alphabet:"0123456789"}),Zl=ce({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Xl=ce({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ql=ce({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),eh=Array.from(""),th=eh.reduce(((e,t,r)=>(e[r]=t,e)),[]),rh=eh.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const nh=oe({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=th[t]),"")},decode:function(e){const t=[];for(const r of e){const e=rh[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),ih=ce({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),sh=oe({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),oh={...H,...V,...W,...$,...K,...n,...c,...i,...s,...q};function ah(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ch=ah("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),uh=ah("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Jl(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var lh={utf8:ch,"utf-8":ch,hex:oh.base16,latin1:uh,ascii:uh,binary:uh,...oh};function hh(e,t="utf8"){const r=lh[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Jl(globalThis.Buffer.from(e,"utf-8"))}function dh(e,t="utf8"){const r=lh[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var fh,ph=r(40859);!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(fh||(fh={}));const yh=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),gh=Object.freeze({NEW_STREAM:fh.NEW_STREAM,MESSAGE:fh.MESSAGE_INITIATOR,CLOSE:fh.CLOSE_INITIATOR,RESET:fh.RESET_INITIATOR}),mh=Object.freeze({MESSAGE:fh.MESSAGE_RECEIVER,CLOSE:fh.CLOSE_RECEIVER,RESET:fh.RESET_RECEIVER}),bh=1<<20;class wh{_buffer;_headerInfo;_maxMessageSize;_maxUnprocessedMessageQueueSize;constructor(e=bh,t=4194304){this._buffer=new ph.I,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(e){if("ERR_MSG_TOO_BIG"===e.code)throw e;break}const{id:e,type:r,length:n,offset:i}=this._headerInfo;if(this._buffer.length-i<n)break;const s={id:e,type:r};r!==fh.NEW_STREAM&&r!==fh.MESSAGE_INITIATOR&&r!==fh.MESSAGE_RECEIVER||(s.data=this._buffer.sublist(i,i+n)),t.push(s),this._buffer.consume(i+n),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:r}=Eh(e),{value:n,offset:i}=Eh(e,r),s=7&t;if(null==yh[s])throw new Error(`Invalid type received: ${s}`);if(n>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:s,offset:r+i,length:n}}}const vh=128,_h=127;function Eh(e,t=0){let r,n=0,i=0,s=t;const o=e.length;do{if(s>=o||i>49)throw t=0,new RangeError("Could not decode varint");r=e.get(s++),n+=i<28?(r&_h)<<i:(r&_h)*Math.pow(2,i),i+=7}while(r>=vh);return{value:n,offset:t=s-t}}const Sh=1048576,xh=(e,t)=>{t.append(e)};var Ah=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let r=new ph.I,n=!1,i=(0,rn.A)(),s=Number(t?.size??Sh);if((isNaN(s)||0===s||s<0)&&(s=Sh),s!==Math.round(s))throw new Error("Batch size must be an integer");const o=t?.yieldAfter??0,a=t?.serialize??xh;for(Promise.resolve().then((async()=>{try{let t;for await(const n of e)a(n,r),r.byteLength>=s?(clearTimeout(t),i.resolve()):t=setTimeout((()=>{i.resolve()}),o);clearTimeout(t),i.resolve()}catch(e){i.reject(e)}finally{n=!0}}));!n;)if(await i.promise,i=(0,rn.A)(),r.byteLength>0){const e=r;r=new ph.I,yield e.subarray()}}():function*(){const r=new ph.I;let n=Number(t?.size??Sh);if((isNaN(n)||0===n||n<0)&&(n=Sh),n!==Math.round(n))throw new Error("Batch size must be an integer");const i=t?.serialize??xh;for(const t of e)i(t,r),r.byteLength>=n&&(yield r.subarray(0,n),r.consume(n));r.byteLength>0&&(yield r.subarray())}()};function kh(e){return new Uint8Array(e)}const Ih=10240;const Th=new class{_pool;_poolOffset;constructor(){this._pool=kh(Ih),this._poolOffset=0}write(e,t){const r=this._pool;let n=this._poolOffset;qc.lF(e.id<<3|e.type,r,n),n+=qc.OY(e.id<<3|e.type),e.type!==fh.NEW_STREAM&&e.type!==fh.MESSAGE_INITIATOR&&e.type!==fh.MESSAGE_RECEIVER||null==e.data?(qc.lF(0,r,n),n+=qc.OY(0)):(qc.lF(e.data.length,r,n),n+=qc.OY(e.data.length));const i=r.subarray(this._poolOffset,n);Ih-n<100?(this._pool=kh(Ih),this._poolOffset=0):this._poolOffset=n,t.append(i),e.type!==fh.NEW_STREAM&&e.type!==fh.MESSAGE_INITIATOR&&e.type!==fh.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};var Ph=r(70296);class Ch extends Ph.l{name;streamId;send;types;maxDataSize;constructor(e){super(e),this.types="outbound"===e.direction?gh:mh,this.send=e.send,this.name=e.name,this.streamId=e.streamId,this.maxDataSize=e.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:gh.NEW_STREAM,data:new ph.I(hh(this.name))})}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:e.sublist(0,t)}),e.consume(t)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}}const Rh=xe("libp2p:mplex");function Oh(e){const t={...e,type:`${yh[e.type]} (${e.type})`};return e.type===fh.NEW_STREAM&&(t.data=dh(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==fh.MESSAGE_INITIATOR&&e.type!==fh.MESSAGE_RECEIVER||(t.data=dh(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class Dh{protocol="/mplex/6.7.0";sink;source;_streamId;_streams;_init;_source;closeController;rateLimiter;closeTimeout;constructor(e){e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.closeTimeout=e.closeTimeout??500,this.sink=this._createSink(),this._source=function(e={}){return Hl((e=>{let t;const r=[];for(;!e.isEmpty()&&(t=e.shift(),null!=t);){if(null!=t.error)throw t.error;!1===t.done&&r.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:r}}),e)}({objectMode:!0,onEnd:()=>{for(const e of this._streams.initiators.values())e.destroy();for(const e of this._streams.receivers.values())e.destroy()}}),this.source=(0,Pi.F)(this._source,(e=>async function*(e,t=0){if(null!=t&&0!==t)yield*Ah(e,{size:t,serialize:(e,t)=>{for(const r of e)Th.write(r,t)}});else for await(const t of e){const e=new ph.I;for(const r of t)Th.write(r,e);yield e.subarray()}}(e,this._init.minSendBytes))),this.closeController=new AbortController,this.rateLimiter=new Gl.RateLimiterMemory({points:e.disconnectThreshold??5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}async close(e){if(this.closeController.signal.aborted)return;const t=e?.signal??AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map((async e=>e.close({signal:t})))),this._source.end(),await this._source.onEmpty({signal:t}),this.closeController.abort()}catch(e){this.abort(e)}}abort(e){this.closeController.signal.aborted||(this.streams.forEach((t=>{t.abort(e)})),this.closeController.abort(e))}_newReceiverStream(e){const{id:t,name:r}=e,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}_newStream(e){const{id:t,name:r,type:n,registry:i}=e;if(Rh("new %s stream %s",n,t),"initiator"===n&&this._streams.initiators.size===(this._init.maxOutboundStreams??1024))throw new Ci.Ak("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(i.has(t))throw new Error(`${n} stream ${t} already exists!`);const s=function(e){const{id:t,name:r,send:n,onEnd:i,type:s="initiator",maxMsgSize:o=bh}=e;return new Ch({id:"initiator"===s?`i${t}`:`r${t}`,streamId:t,name:`${null==r?t:r}`,direction:"initiator"===s?"outbound":"inbound",maxDataSize:o,onEnd:i,send:n,log:xe(`libp2p:mplex:stream:${s}:${t}`)})}({id:t,name:r,send:async e=>{Rh.enabled&&Rh.trace("%s stream %s send",n,t,Oh(e)),this._source.push(e)},type:n,onEnd:()=>{Rh("%s stream with id %s and protocol %s ended",n,t,s.protocol),i.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(s)},maxMsgSize:this._init.maxMsgSize});return i.set(t,s),s}_createSink(){return async e=>{try{e=Kl(e,this.closeController.signal,{returnOnAbort:!0});const t=new wh(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const r of e)for(const e of t.write(r))await this._handleIncoming(e);this._source.end()}catch(e){Rh("error in sink",e),this._source.end(e)}}}async _handleIncoming(e){const{id:t,type:r}=e;if(Rh.enabled&&Rh.trace("incoming message",Oh(e)),e.type===fh.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??1024)){Rh("too many inbound streams open"),this._source.push({id:t,type:fh.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return Rh("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this.abort(new Error("Too many open streams"))}return}const r=this._newReceiverStream({id:t,name:dh(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(r))}const n=(1==(1&r)?this._streams.initiators:this._streams.receivers).get(t);if(null==n){Rh("missing stream %s for message type %s",t,yh[r]);try{await this.rateLimiter.consume("missing-stream",1)}catch{return Rh("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),void this.abort(new Error("Too many messages for missing streams"))}return}const i=this._init.maxStreamBufferSize??4194304;try{switch(r){case fh.MESSAGE_INITIATOR:case fh.MESSAGE_RECEIVER:if(n.sourceReadableLength()>i)throw this._source.push({id:e.id,type:r===fh.MESSAGE_INITIATOR?fh.RESET_RECEIVER:fh.RESET_INITIATOR}),new Ci.Ak("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");n.sourcePush(e.data);break;case fh.CLOSE_INITIATOR:case fh.CLOSE_RECEIVER:n.remoteCloseWrite();break;case fh.RESET_INITIATOR:case fh.RESET_RECEIVER:n.reset();break;default:Rh("unknown message type %s",r)}}catch(e){Rh.error("error while processing message",e),n.abort(e)}}}class Bh{protocol="/mplex/6.7.0";_init;constructor(e={}){this._init=e}createStreamMuxer(e={}){return new Dh({...e,...this._init})}}function Nh(e={}){return()=>new Bh(e)}var Mh=r(13231),Uh=r(52049),Lh=r(98010);function jh(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Fh(e=0){return null!=globalThis.Buffer?.allocUnsafe?jh(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function zh(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const $h=zh("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Kh=zh("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Fh((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var Vh={utf8:$h,"utf-8":$h,hex:oh.base16,latin1:Kh,ascii:Kh,binary:Kh,...oh};function qh(e,t="utf8"){const r=Vh[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):jh(globalThis.Buffer.from(e,"utf-8"))}function Wh(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const Hh=32,Gh=64,Jh=32;function Yh(e,t){const r=new Uint8Array(Gh);for(let n=0;n<Jh;n++)r[n]=e[n],r[Jh+n]=t[n];return r}function Zh(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Fh(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return jh(r)}var Xh={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};const Qh={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};async function ed(e,t){const r=function(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=Xh.get();return r*=8,{encrypt:async function(e,c){const u=a.getRandomValues(new Uint8Array(s)),l=a.getRandomValues(new Uint8Array(n)),h={name:t,iv:l};let d;if("string"==typeof c&&(c=qh(c)),0===c.length){d=await a.subtle.importKey("jwk",Qh,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}catch{d=await a.subtle.importKey("jwk",Qh,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);d=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["encrypt"])}const f=await a.subtle.encrypt(h,d,e);return Zh([u,h.iv,new Uint8Array(f)])},decrypt:async function(e,c){const u=e.subarray(0,s),l=e.subarray(s,s+n),h=e.subarray(s+n),d={name:t,iv:l};let f;if("string"==typeof c&&(c=qh(c)),0===c.length)try{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}catch{f=await a.subtle.importKey("jwk",Qh,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},n=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]);f=await a.subtle.deriveKey(e,n,{name:t,length:r},!0,["decrypt"])}const p=await a.subtle.decrypt(d,f,h);return new Uint8Array(p)}}}(),n=await r.encrypt(e,t);return ve.encode(n)}var td,rd,nd,id;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(td||(td={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(rd||(rd={})),function(e){e.codec=()=>(0,oa.eG)(rd)}(td||(td={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,oa.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),td.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=td.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,oa.mH)(t,e.codec()),e.decode=t=>(0,oa.Y8)(t,e.codec())}(nd||(nd={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,oa.iU)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),td.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=td.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,oa.mH)(t,e.codec()),e.decode=t=>(0,oa.Y8)(t,e.codec())}(id||(id={}));class sd{_key;constructor(e){this._key=hd(e,Hh)}async verify(e,t){return async function(e,t,r){return Ho.ev.verify(t,r,e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return nd.encode({Type:td.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}}class od{_key;_publicKey;constructor(e,t){this._key=hd(e,Gh),this._publicKey=hd(t,Hh)}async sign(e){return async function(e,t){const r=e.subarray(0,Jh);return Ho.ev.sign(t,r)}(this._key,e)}get public(){return new sd(this._publicKey)}marshal(){return this._key}get bytes(){return id.encode({Type:td.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}async id(){const e=Qe.digest(this.public.bytes);return be.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return ed(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function ad(e){if(e.length>Gh){const t=(e=hd(e,Gh+Hh)).subarray(0,Gh),r=e.subarray(Gh,e.length);return new od(t,r)}const t=(e=hd(e,Gh)).subarray(0,Gh),r=e.subarray(Hh);return new od(t,r)}function cd(e){return e=hd(e,Hh),new sd(e)}async function ud(){const{privateKey:e,publicKey:t}=await async function(){const e=Ho.ev.utils.randomPrivateKey(),t=Ho.ev.getPublicKey(e);return{privateKey:Yh(e,t),publicKey:t}}();return new od(e,t)}async function ld(e){const{privateKey:t,publicKey:r}=await async function(e){if(e.length!==Jh)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=Ho.ev.getPublicKey(t);return{privateKey:Yh(t,r),publicKey:r}}(e);return new od(t,r)}function hd(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw new Ci.Ak(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function dd(e,t="utf8"){const r=Vh[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function fd(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.subarray(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Zh([new Uint8Array(t-r.length),r])}return dd(r,"base64url")}function pd(e){const t=function(e,t){let r=qh(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Zh([new Uint8Array(t-r.length),r])}return r}(e);return new qo.jsbn.BigInteger(dd(t,"base16"),16)}const yd={"P-256":256,"P-384":384,"P-521":521};Object.keys(yd).join(" / ");const gd="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function md(e){if(isNaN(e)||e<=0)throw new Ci.Ak("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return function(e=32){if(gd&&"function"==typeof gd.getRandomValues)return gd.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(e)}function bd(e,t){return t.map((t=>pd(e[t])))}async function wd(e){const t=[await Xh.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await _d(e)],r=await vd({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function vd(e){if(null==e.privateKey||null==e.publicKey)throw new Ci.Ak("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Xh.get().subtle.exportKey("jwk",e.privateKey),Xh.get().subtle.exportKey("jwk",e.publicKey)])}async function _d(e){return Xh.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Ed(e,t,r,n){const i=t?function(e){return qo.pki.setRsaPublicKey(...bd(e,["n","e"]))}(e):function(e){return qo.pki.setRsaPrivateKey(...bd(e,["n","e","d","p","q","dp","dq","qi"]))}(e);return qh(n(dd(Uint8Array.from(r),"ascii"),i),"ascii")}function Sd(e){if("RSA"!==e.kty)throw new Ci.Ak("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new Ci.Ak("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*qh(e.n,"base64url").length}const xd=8192;class Ad{_key;constructor(e){this._key=e}async verify(e,t){return async function(e,t,r){const n=await Xh.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Xh.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new Ci.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=qo.pki.publicKeyToAsn1({n:pd(e.n),e:pd(e.e)});return qh(qo.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return nd.encode({Type:td.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Ed(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}}class kd{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return md(16)}async sign(e){return async function(e,t){const r=await Xh.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Xh.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new Ci.Ak("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Ad(this._publicKey)}decrypt(e){return Ed(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new Ci.Ak("JWK was missing components","ERR_INVALID_PARAMETERS");const t=qo.pki.privateKeyToAsn1({n:pd(e.n),e:pd(e.e),d:pd(e.d),p:pd(e.p),q:pd(e.q),dP:pd(e.dp),dQ:pd(e.dq),qInv:pd(e.qi)});return qh(qo.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return id.encode({Type:td.RSA,Data:this.marshal()}).subarray()}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}async id(){return dd(await this.public.hash(),"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new qo.util.ByteBuffer(this.marshal()),r=qo.asn1.fromDer(t),n=qo.pki.privateKeyFromAsn1(r),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return qo.pki.encryptRsaPrivateKey(n,e,i)}if("libp2p-key"===t)return ed(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function Id(e){const t=function(e){const t=qo.asn1.fromDer(dd(e,"ascii")),r=qo.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:fd(r.n),e:fd(r.e),d:fd(r.d),p:fd(r.p),q:fd(r.q),dp:fd(r.dP),dq:fd(r.dQ),qi:fd(r.qInv),alg:"RS256"}}(e);if(Sd(t)>xd)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await wd(t);return new kd(r.privateKey,r.publicKey)}function Td(e){const t=function(e){const t=qo.asn1.fromDer(dd(e,"ascii")),r=qo.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:fd(r.n),e:fd(r.e)}}(e);if(Sd(t)>xd)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Ad(t)}async function Pd(e){if(Sd(e)>xd)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await wd(e);return new kd(t.privateKey,t.publicKey)}async function Cd(e){if(e>xd)throw new Ci.Ak("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await Xh.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await vd(t);return{privateKey:r[0],publicKey:r[1]}}(e);return new kd(t.privateKey,t.publicKey)}function Rd(e){try{Oa.bI.ProjectivePoint.fromHex(e)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PUBLIC_KEY")}}class Od{_key;constructor(e){Rd(e),this._key=e}async verify(e,t){return async function(e,t,r){try{const{digest:n}=await nt.digest(r);return Oa.bI.verify(t,n,e)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,Oa.bI.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return nd.encode({Type:td.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}}class Dd{_key;_publicKey;constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return Oa.bI.getPublicKey(e,!0)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{Oa.bI.getPublicKey(e,!0)}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_PRIVATE_KEY")}}(this._key),Rd(this._publicKey)}async sign(e){return async function(e,t){const{digest:r}=await nt.digest(t);try{return Oa.bI.sign(r,e).toDERRawBytes()}catch(e){throw new Ci.Ak(String(e),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new Od(this._publicKey)}marshal(){return this._key}get bytes(){return id.encode({Type:td.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Wh(this.bytes,e.bytes)}async hash(){const{bytes:e}=await nt.digest(this.bytes);return e}async id(){return dd(await this.public.hash(),"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return ed(this.bytes,e);throw new Ci.Ak(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function Bd(e){return new Dd(e)}function Nd(e){return new Od(e)}async function Md(){const e=Oa.bI.utils.randomPrivateKey();return new Dd(e)}const Ud={rsa:J,ed25519:G,secp256k1:Y};function Ld(e){const t=Object.keys(Ud).join(" / ");return new Ci.Ak(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function jd(e){const t=nd.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case td.RSA:return Ud.rsa.unmarshalRsaPublicKey(r);case td.Ed25519:return Ud.ed25519.unmarshalEd25519PublicKey(r);case td.Secp256k1:return Ud.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Ld(t.Type??"unknown")}}function Fd(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const zd=Symbol.for("nodejs.util.inspect.custom"),$d=Object.values(oh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),oh.identity.decoder),Kd=114,Vd=36,qd=37;class Wd{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Ri.H]=!0;toString(){return null==this.string&&(this.string=be.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Gr.createV1(Kd,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Fd(this.multihash.bytes,e);if("string"==typeof e)return function(e,t){if(t=t??$d,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Ye(be.decode(`z${e}`));return e.startsWith("12D")?new Gd({multihash:t}):e.startsWith("16U")?new Jd({multihash:t}):new Hd({multihash:t})}return Yd($d.decode(e))}(e).equals(this);if(null!=e?.multihash?.bytes)return Fd(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[zd](){return`PeerId(${this.toString()})`}}class Hd extends Wd{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class Gd extends Wd{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class Jd extends Wd{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function Yd(e){try{const t=Ye(e);if(t.code===Qe.code){if(t.digest.length===Vd)return new Gd({multihash:t});if(t.digest.length===qd)return new Jd({multihash:t})}if(t.code===nt.code)return new Hd({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Kd)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===nt.code)return new Hd({multihash:e.multihash});if(t.code===Qe.code){if(t.digest.length===Vd)return new Gd({multihash:e.multihash});if(t.digest.length===qd)return new Jd({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Gr.decode(e))}throw new Error("Supplied PeerID CID is invalid")}var Zd=r(66310),Xd=r(5454),Qd=r(44008);const ef="ERR_UNRECOGNIZED_VALIDITY",tf="ERR_SIGNATURE_VERIFICATION",rf="ERR_UNRECOGNIZED_FORMAT",nf="ERR_UNDEFINED_PARAMETER",sf="ERR_RECORD_TOO_LARGE";var of;!function(e){let t,r,n;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(r||(r={})),function(e){e.codec=()=>(0,oa.eG)(r)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==n&&(n=(0,oa.iU)(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.value&&(r.uint32(10),r.bytes(t.value)),null!=t.signatureV1&&(r.uint32(18),r.bytes(t.signatureV1)),null!=t.validityType&&(r.uint32(24),e.ValidityType.codec().encode(t.validityType,r)),null!=t.validity&&(r.uint32(34),r.bytes(t.validity)),null!=t.sequence&&(r.uint32(40),r.uint64(t.sequence)),null!=t.ttl&&(r.uint32(48),r.uint64(t.ttl)),null!=t.pubKey&&(r.uint32(58),r.bytes(t.pubKey)),null!=t.signatureV2&&(r.uint32(66),r.bytes(t.signatureV2)),null!=t.data&&(r.uint32(74),r.bytes(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},i=null==r?t.len:t.pos+r;for(;t.pos<i;){const r=t.uint32();switch(r>>>3){case 1:n.value=t.bytes();break;case 2:n.signatureV1=t.bytes();break;case 3:n.validityType=e.ValidityType.codec().decode(t);break;case 4:n.validity=t.bytes();break;case 5:n.sequence=t.uint64();break;case 6:n.ttl=t.uint64();break;case 7:n.pubKey=t.bytes();break;case 8:n.signatureV2=t.bytes();break;case 9:n.data=t.bytes();break;default:t.skipType(7&r)}}return n}))),n),e.encode=t=>(0,oa.mH)(t,e.codec()),e.decode=t=>(0,oa.Y8)(t,e.codec())}(of||(of={}));const af=xe("ipns:utils"),cf=(0,Lr.s)("/ipns/");const uf=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw af.error(e),Zd(e,nf)}let r;if(null!=t.pubKey){try{r=jd(t.pubKey)}catch(e){throw af.error(e),e}if(!(await async function(e,t){return e.length===Vd?new Gd({multihash:Je(Qe.code,e),privateKey:t}):e.length===qd?new Jd({multihash:Je(Qe.code,e),privateKey:t}):new Hd({multihash:await nt.digest(e),publicKey:e,privateKey:t})}(t.pubKey)).equals(e))throw Zd(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(r=jd(e.publicKey));if(null!=r)return r;throw Zd(new Error("no public key is available"),nf)};function lf(e){const t=of.decode(e);if(null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),null==t.signatureV2||null==t.data)throw Zd(new Error("missing data or signatureV2"),tf);const r=df(t.data),n=ff(r.Value);let i;try{i=Xd.fromDate(function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(n,i,s,o,a,c,u))}((0,Ur.d)(r.Validity)))}catch(e){throw af.error("unrecognized validity format (not an rfc3339 format)"),Zd(new Error("unrecognized validity format (not an rfc3339 format)"),rf)}if(null!=t.value&&null!=t.signatureV1)return pf(t),{value:n,validityType:of.ValidityType.EOL,validity:i,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(null!=t.signatureV2)return{value:n,validityType:of.ValidityType.EOL,validity:i,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const hf=e=>Yd(e.slice(cf.length)),df=e=>{const t=Mr(e);if(0!==t.ValidityType)throw Zd(new Error("Unknown validity type"),ef);return t.ValidityType=of.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},ff=e=>{if(null!=e){if((0,Ri.Q)(e))return`/ipns/${e.toCID().toString(Kr)}`;if(e instanceof Uint8Array){const t=(0,Ur.d)(e);t.startsWith("/")&&(e=t)}const t=e.toString().trim();if(t.startsWith("/")&&t.length>1)return t;const r=Gr.asCID(e);if(null!=r)return 114===r.code?`/ipns/${r.toString(Kr)}`:`/ipfs/${r.toV1().toString()}`;try{return e instanceof Uint8Array?`/ipfs/${Gr.decode(e).toV1().toString()}`:`/ipfs/${Gr.parse(t).toV1().toString()}`}catch{}}throw Zd(new Error("Value must be a valid content path starting with /"),"ERR_INVALID_VALUE")},pf=e=>{if(null==e.data)throw Zd(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const t=df(e.data);if(!(0,zn.a)(t.Value,e.value??new Uint8Array(0)))throw Zd(new Error('Field "value" did not match between protobuf and CBOR'),tf);if(!(0,zn.a)(t.Validity,e.validity??new Uint8Array(0)))throw Zd(new Error('Field "validity" did not match between protobuf and CBOR'),tf);if(t.ValidityType!==e.validityType)throw Zd(new Error('Field "validityType" did not match between protobuf and CBOR'),tf);if(t.Sequence!==e.sequence)throw Zd(new Error('Field "sequence" did not match between protobuf and CBOR'),tf);if(t.TTL!==e.ttl)throw Zd(new Error('Field "ttl" did not match between protobuf and CBOR'),tf)};function yf(e,t){const r=t.map(((e,t)=>({record:lf(e),index:t})));return r.sort(((e,t)=>{const r=e.record.sequence,n=t.record.sequence;if(r>n)return-1;if(r<n)return 1;const i=e.record.validity.toDate(),s=t.record.validity.toDate();return i.getTime()>s.getTime()?-1:i.getTime()<s.getTime()?1:0})),r[0].index}const gf=xe("ipns:validator"),mf=10240,bf=async(e,t)=>{const r=lf(t);let n;try{const t=(e=>{const t=(0,Lr.s)("ipns-signature:");return(0,Qd.x)([t,e])})(r.data);n=await e.verify(t,r.signatureV2)}catch(e){n=!1}if(!n)throw gf.error("record signature verification failed"),Zd(new Error("record signature verification failed"),tf);if(r.validityType===of.ValidityType.EOL){if(r.validity.toDate().getTime()<Date.now())throw gf.error("record has expired"),Zd(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=r.validityType)throw gf.error("unrecognized validity type"),Zd(new Error("unrecognized validity type"),ef);gf("ipns record for %b is valid",r.value)};async function wf(e,t){if(t.byteLength>mf)throw Zd(new Error("record too large"),sf);const r=hf(e),n=lf(t),i=await uf(r,n);await bf(i,t)}var vf=r(78350),_f=r(41908),Ef=r(20035),Sf=r(61336),xf=r(90754);const Af={list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ"]};async function kf(e,t){const r={addresses:{listen:["/webrtc"]},transports:[(0,_f.y)({discoverRelays:1}),(0,Mh.c)(),(0,Mh.b)(),(0,Lh.q)(),(0,Uh.h)()],connectionEncryption:[(0,Ul.f)()],streamMuxers:[(0,Ll.N)(),Nh()],peerDiscovery:[(0,jl.N)(Af)],contentRouters:[(0,Fl.w)("https://cid.contact")],services:{identify:(0,Sf.iQ)(),autoNAT:(0,vf.I)(),pubsub:Ml(),dcutr:(0,Ef.I)(),dht:(0,zl.dU)({clientMode:!0,validators:{ipns:wf},selectors:{ipns:yf}}),ping:(0,xf.w)()}};return t=t??{},(0,Ti.E)({datastore:e,...r,...t,start:!1})}const If="2.0.3",Tf="helia",Pf=xe("helia");async function Cf(e={}){const t=e.datastore??new ke.bk,r=e.blockstore??new Ae.ED;let n;n=function(e){if(null==e)return!1;return["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"].every((t=>"function"==typeof e[t]))}(e.libp2p)?e.libp2p:await kf(t,e.libp2p);const i=new Ii({...e,datastore:t,blockstore:r,libp2p:n});return!1!==e.start&&await i.start(),function(e){try{if(null==e.libp2p.services.identify.host.agentVersion.match(/js-libp2p\/\d+\.\d+\.\d+\sUserAgent=/))return;e.libp2p.services.identify.host.agentVersion=`${Tf}/${If} ${e.libp2p.services.identify.host.agentVersion}`}catch(e){Pf.error("could not add Helia to agent version",e)}}(i),i}},96148:function(e,t,r){"use strict";r.d(t,{MR:function(){return m},P2:function(){return g}});const n=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return p(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(y(this),t),p(o.get(this))}:function(...t){return p(e.apply(y(this),t))}:function(t,...r){const n=e.call(y(this),t,...r);return c.set(n,t.sort?t.sort():[t]),p(n)}}function f(e){return"function"==typeof e?d(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),n(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(p(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=f(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const y=e=>l.get(e);function g(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=p(o);return n&&o.addEventListener("upgradeneeded",(e=>{n(p(o.result),e.oldVersion,e.newVersion,p(o.transaction),e)})),r&&o.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function m(e,{blocked:t}={}){const r=indexedDB.deleteDatabase(e);return t&&r.addEventListener("blocked",(e=>t(e.oldVersion,e))),p(r).then((()=>{}))}const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],v=new Map;function _(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(v.get(t))return v.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=w.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(r))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return n&&(o=o.index(t.shift())),(await Promise.all([o[r](...t),i&&s.done]))[0]};return v.set(t,s),s}h=(e=>({...e,get:(t,r,n)=>_(t,r)||e.get(t,r,n),has:(t,r)=>!!_(t,r)||e.has(t,r)}))(h)},53301:function(e,t,r){"use strict";r.d(t,{U:function(){return n.U}});var n=r(30256)},30256:function(e,t,r){"use strict";r.d(t,{U:function(){return c}});var n=r(98067),i=r(16676);const s="/",o=(new TextEncoder).encode(s),a=o[0];class c{constructor(e,t){if("string"==typeof e)this._buf=(0,i.s)(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==a)throw new Error("Invalid key")}toString(e="utf8"){return(0,n.d)(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new c(e.join(s))}static random(){return new c(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new c(e):"function"==typeof e.uint8Array?new c(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=o),this._buf[0]!==a){const e=new Uint8Array(this._buf.byteLength+1);e.fill(a,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===a;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],i=r[e];if(n<i)return!0;if(n>i)return!1}return t.length<r.length}reverse(){return c.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(s).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new c(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(s)||(e+=s),e+=this.type(),new c(e)}parent(){const e=this.list();return 1===e.length?new c(s):new c(e.slice(0,-1).join(s))}child(e){return this.toString()===s?e:e.toString()===s?this:new c(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return c.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}}}]);
//# sourceMappingURL=168.0ce26f6d.chunk.js.map