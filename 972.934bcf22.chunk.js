/*! For license information please see 972.934bcf22.chunk.js.LICENSE.txt */
(self.webpackChunkcyb=self.webpackChunkcyb||[]).push([[972],{96945:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,o),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},36026:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,o),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},73223:function(e){e.exports=function e(r,i){var s,o=0,a=0,c=i=i||0,u=r.length;do{if(c>=u||a>49)throw e.bytes=0,new RangeError("Could not decode varint");s=r[c++],o+=a<28?(s&n)<<a:(s&n)*Math.pow(2,a),a+=7}while(s>=t);return e.bytes=c-i,o};var t=128,n=127},81557:function(e){e.exports=function e(i,s,o){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");s=s||[];var a=o=o||0;for(;i>=r;)s[o++]=255&i|t,i/=128;for(;i&n;)s[o++]=255&i|t,i>>>=7;return s[o]=0|i,e.bytes=o-a+1,s};var t=128,n=-128,r=Math.pow(2,31)},59379:function(e,t,n){e.exports={encode:n(81557),decode:n(73223),encodingLength:n(35374)}},35374:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<u?9:10}},76915:function(e){e.exports=function e(r,i){var s,o=0,a=0,c=i=i||0,u=r.length;do{if(c>=u||a>49)throw e.bytes=0,new RangeError("Could not decode varint");s=r[c++],o+=a<28?(s&n)<<a:(s&n)*Math.pow(2,a),a+=7}while(s>=t);return e.bytes=c-i,o};var t=128,n=127},1824:function(e){e.exports=function e(i,s,o){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");s=s||[];var a=o=o||0;for(;i>=r;)s[o++]=255&i|t,i/=128;for(;i&n;)s[o++]=255&i|t,i>>>=7;return s[o]=0|i,e.bytes=o-a+1,s};var t=128,n=-128,r=Math.pow(2,31)},31617:function(e,t,n){e.exports={encode:n(1824),decode:n(76915),encodingLength:n(19145)}},19145:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<u?9:10}},404:function(e){e.exports=function e(r,i){var s,o=0,a=0,c=i=i||0,u=r.length;do{if(c>=u||a>49)throw e.bytes=0,new RangeError("Could not decode varint");s=r[c++],o+=a<28?(s&n)<<a:(s&n)*Math.pow(2,a),a+=7}while(s>=t);return e.bytes=c-i,o};var t=128,n=127},27666:function(e){e.exports=function e(i,s,o){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");s=s||[];var a=o=o||0;for(;i>=r;)s[o++]=255&i|t,i/=128;for(;i&n;)s[o++]=255&i|t,i>>>=7;return s[o]=0|i,e.bytes=o-a+1,s};var t=128,n=-128,r=Math.pow(2,31)},9027:function(e,t,n){e.exports={encode:n(27666),decode:n(404),encodingLength:n(40194)}},40194:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<u?9:10}},9886:function(e,t,n){"use strict";const r=n(26869),i=n(94676),{names:s}=n(22465),{toString:o}=n(26467),{fromString:a}=n(81848),{concat:c}=n(47),u={};for(const e in s){const t=e;u[s[t]]=t}function l(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=i.decode(e);if(!f(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(i.decode.bytes);const n=i.decode(e);if(n<0)throw new Error(`multihash invalid length: ${n}`);if((e=e.slice(i.decode.bytes)).length!==n)throw new Error(`multihash length inconsistent: 0x${o(e,"base16")}`);return{code:t,name:u[t],length:n,digest:e}}function h(e){let t=e;if("string"==typeof e){if(void 0===s[e])throw new Error(`Unrecognized hash function named: ${e}`);t=s[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(void 0===u[t]&&!d(t))throw new Error(`Unrecognized function code: ${t}`);return t}function d(e){return e>0&&e<16}function f(e){return!!d(e)||!!u[e]}function p(e){l(e)}Object.freeze(u),e.exports={names:s,codes:u,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(r.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?o(e):e;return r.decode("z"+t)},decode:l,encode:function(e,t,n){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");const r=h(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==n&&(n=e.length),n&&e.length!==n)throw new Error("digest length should be equal to specified length.");const s=i.encode(r),o=i.encode(n);return c([s,o,e],s.length+o.length+e.length)},coerceCode:h,isAppCode:d,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}},90309:function(e,t,n){e.exports={encode:n(3582),decode:n(17221),encodingLength:n(22375)}},20393:function(e){e.exports=function e(r,i){var s,o=0,a=0,c=i=i||0,u=r.length;do{if(c>=u||a>49)throw e.bytes=0,new RangeError("Could not decode varint");s=r[c++],o+=a<28?(s&n)<<a:(s&n)*Math.pow(2,a),a+=7}while(s>=t);return e.bytes=c-i,o};var t=128,n=127},48645:function(e){e.exports=function e(i,s,o){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");s=s||[];var a=o=o||0;for(;i>=r;)s[o++]=255&i|t,i/=128;for(;i&n;)s[o++]=255&i|t,i>>>=7;return s[o]=0|i,e.bytes=o-a+1,s};var t=128,n=-128,r=Math.pow(2,31)},93649:function(e,t,n){e.exports={encode:n(48645),decode:n(20393),encodingLength:n(95306)}},95306:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<u?9:10}},99748:function(e,t,n){"use strict";function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}n.d(t,{Q:function(){return r}}),r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.emitReserved=r.prototype.emit,r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},98099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97117);function i(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function s(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function o(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function a(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function c(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function u(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function l(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function h(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function d(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),l(e/4294967296>>>0,t,n),l(e>>>0,t,n+4),t}function f(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),h(e>>>0,t,n),h(e/4294967296>>>0,t,n+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=i,t.writeInt16BE=i,t.writeUint16LE=s,t.writeInt16LE=s,t.readInt32BE=o,t.readUint32BE=a,t.readInt32LE=c,t.readUint32LE=u,t.writeUint32BE=l,t.writeInt32BE=l,t.writeUint32LE=h,t.writeInt32LE=h,t.readInt64BE=function(e,t){void 0===t&&(t=0);var n=o(e,t),r=o(e,t+4);return 4294967296*n+r-4294967296*(r>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*a(e,t)+a(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var n=c(e,t);return 4294967296*c(e,t+4)+n-4294967296*(n>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var n=u(e,t);return 4294967296*u(e,t+4)+n},t.writeUint64BE=d,t.writeInt64BE=d,t.writeUint64LE=f,t.writeInt64LE=f,t.readUintBE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,i=1,s=e/8+n-1;s>=n;s--)r+=t[s]*i,i*=256;return r},t.readUintLE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,i=1,s=n;s<n+e/8;s++)r+=t[s]*i,i*=256;return r},t.writeUintBE=function(e,t,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var s=1,o=e/8+i-1;o>=i;o--)n[o]=t/s&255,s*=256;return n},t.writeUintLE=function(e,t,n,i){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var s=1,o=i;o<i+e/8;o++)n[o]=t/s&255,s*=256;return n},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e),t},t.writeFloat32LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),t},t.writeFloat64BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e),t},t.writeFloat64LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),t}},25439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98099),i=n(17309),s=20;function o(e,t,n){for(var i=1634760805,o=857760878,a=2036477234,c=1797285236,u=n[3]<<24|n[2]<<16|n[1]<<8|n[0],l=n[7]<<24|n[6]<<16|n[5]<<8|n[4],h=n[11]<<24|n[10]<<16|n[9]<<8|n[8],d=n[15]<<24|n[14]<<16|n[13]<<8|n[12],f=n[19]<<24|n[18]<<16|n[17]<<8|n[16],p=n[23]<<24|n[22]<<16|n[21]<<8|n[20],y=n[27]<<24|n[26]<<16|n[25]<<8|n[24],g=n[31]<<24|n[30]<<16|n[29]<<8|n[28],m=t[3]<<24|t[2]<<16|t[1]<<8|t[0],w=t[7]<<24|t[6]<<16|t[5]<<8|t[4],b=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],v=i,_=o,S=a,R=c,A=u,I=l,T=h,C=d,P=f,k=p,N=y,x=g,D=m,L=w,O=b,U=E,M=0;M<s;M+=2)A=(A^=P=P+(D=(D^=v=v+A|0)>>>16|D<<16)|0)>>>20|A<<12,I=(I^=k=k+(L=(L^=_=_+I|0)>>>16|L<<16)|0)>>>20|I<<12,T=(T^=N=N+(O=(O^=S=S+T|0)>>>16|O<<16)|0)>>>20|T<<12,C=(C^=x=x+(U=(U^=R=R+C|0)>>>16|U<<16)|0)>>>20|C<<12,T=(T^=N=N+(O=(O^=S=S+T|0)>>>24|O<<8)|0)>>>25|T<<7,C=(C^=x=x+(U=(U^=R=R+C|0)>>>24|U<<8)|0)>>>25|C<<7,I=(I^=k=k+(L=(L^=_=_+I|0)>>>24|L<<8)|0)>>>25|I<<7,A=(A^=P=P+(D=(D^=v=v+A|0)>>>24|D<<8)|0)>>>25|A<<7,I=(I^=N=N+(U=(U^=v=v+I|0)>>>16|U<<16)|0)>>>20|I<<12,T=(T^=x=x+(D=(D^=_=_+T|0)>>>16|D<<16)|0)>>>20|T<<12,C=(C^=P=P+(L=(L^=S=S+C|0)>>>16|L<<16)|0)>>>20|C<<12,A=(A^=k=k+(O=(O^=R=R+A|0)>>>16|O<<16)|0)>>>20|A<<12,C=(C^=P=P+(L=(L^=S=S+C|0)>>>24|L<<8)|0)>>>25|C<<7,A=(A^=k=k+(O=(O^=R=R+A|0)>>>24|O<<8)|0)>>>25|A<<7,T=(T^=x=x+(D=(D^=_=_+T|0)>>>24|D<<8)|0)>>>25|T<<7,I=(I^=N=N+(U=(U^=v=v+I|0)>>>24|U<<8)|0)>>>25|I<<7;r.writeUint32LE(v+i|0,e,0),r.writeUint32LE(_+o|0,e,4),r.writeUint32LE(S+a|0,e,8),r.writeUint32LE(R+c|0,e,12),r.writeUint32LE(A+u|0,e,16),r.writeUint32LE(I+l|0,e,20),r.writeUint32LE(T+h|0,e,24),r.writeUint32LE(C+d|0,e,28),r.writeUint32LE(P+f|0,e,32),r.writeUint32LE(k+p|0,e,36),r.writeUint32LE(N+y|0,e,40),r.writeUint32LE(x+g|0,e,44),r.writeUint32LE(D+m|0,e,48),r.writeUint32LE(L+w|0,e,52),r.writeUint32LE(O+b|0,e,56),r.writeUint32LE(U+E|0,e,60)}function a(e,t,n,r,s){if(void 0===s&&(s=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(r.length<n.length)throw new Error("ChaCha: destination is shorter than source");var a,u;if(0===s){if(8!==t.length&&12!==t.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=(a=new Uint8Array(16)).length-t.length,a.set(t,u)}else{if(16!==t.length)throw new Error("ChaCha nonce with counter must be 16 bytes");a=t,u=s}for(var l=new Uint8Array(64),h=0;h<n.length;h+=64){o(l,a,e);for(var d=h;d<h+64&&d<n.length;d++)r[d]=n[d]^l[d-h];c(a,0,u)}return i.wipe(l),0===s&&i.wipe(a),r}function c(e,t,n){for(var r=1;n--;)r=r+(255&e[t])|0,e[t]=255&r,r>>>=8,t++;if(r>0)throw new Error("ChaCha: counter overflow")}t.streamXOR=a,t.stream=function(e,t,n,r){return void 0===r&&(r=0),i.wipe(n),a(e,t,n,n,r)}},15501:function(e,t,n){"use strict";var r=n(25439),i=n(63027),s=n(17309),o=n(98099),a=n(4153);t.Cv=32,t.WH=12,t.pg=16;var c=new Uint8Array(16),u=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);r.stream(this._key,o,a,4);var c,u=t.length+this.tagLength;if(i){if(i.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(u);return r.streamXOR(this._key,o,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),n),s.wipe(o),c},e.prototype.open=function(e,t,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var c=new Uint8Array(32);r.stream(this._key,o,c,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,c,t.subarray(0,t.length-this.tagLength),n),!a.equal(u,t.subarray(t.length-this.tagLength,t.length)))return null;var l,h=t.length-this.tagLength;if(i){if(i.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");l=i}else l=new Uint8Array(h);return r.streamXOR(this._key,o,t.subarray(0,t.length-this.tagLength),l,4),s.wipe(o),l},e.prototype.clean=function(){return s.wipe(this._key),this},e.prototype._authenticate=function(e,t,n,r){var a=new i.Poly1305(t);r&&(a.update(r),r.length%16>0&&a.update(c.subarray(r.length%16))),a.update(n),n.length%16>0&&a.update(c.subarray(n.length%16));var u=new Uint8Array(8);r&&o.writeUint64LE(r.length,u),a.update(u),o.writeUint64LE(n.length,u),a.update(u);for(var l=a.digest(),h=0;h<l.length;h++)e[h]=l[h];a.clean(),s.wipe(l),s.wipe(u)},e}();t.OK=u},4153:function(e,t){"use strict";function n(e,t){if(e.length!==t.length)return 0;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 1&n-1>>>8}Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t,n){return~(e-1)&t|e-1&n},t.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},t.compare=n,t.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==n(e,t)}},79984:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableHash=function(e){return void 0!==e.saveState&&void 0!==e.restoreState&&void 0!==e.cleanSavedState}},512:function(e,t,n){"use strict";var r=n(25629),i=n(17309),s=function(){function e(e,t,n,i){void 0===n&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=r.hmac(this._hash,n,t);this._hmac=new r.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[n]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),i.wipe(this._buffer),i.wipe(this._counter),this._bufpos=0},e}();t.t=s},25629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(79984),i=n(4153),s=n(17309),o=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(n).clean():n.set(t);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),r.isSerializableHash(this._inner)&&r.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),s.wipe(n)}return e.prototype.reset=function(){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){r.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),r.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();t.HMAC=o,t.hmac=function(e,t,n){var r=new o(e,t);r.update(n);var i=r.digest();return r.clean(),i},t.equal=i.equal},97117:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},63027:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4153),i=n(17309);t.DIGEST_LENGTH=16;var s=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var n=e[0]|e[1]<<8;this._r[0]=8191&n;var r=e[2]|e[3]<<8;this._r[1]=8191&(n>>>13|r<<3);var i=e[4]|e[5]<<8;this._r[2]=7939&(r>>>10|i<<6);var s=e[6]|e[7]<<8;this._r[3]=8191&(i>>>7|s<<9);var o=e[8]|e[9]<<8;this._r[4]=255&(s>>>4|o<<12),this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var c=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var u=e[14]|e[15]<<8;this._r[8]=8191&(c>>>8|u<<8),this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,n){for(var r=this._fin?0:2048,i=this._h[0],s=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],u=this._h[5],l=this._h[6],h=this._h[7],d=this._h[8],f=this._h[9],p=this._r[0],y=this._r[1],g=this._r[2],m=this._r[3],w=this._r[4],b=this._r[5],E=this._r[6],v=this._r[7],_=this._r[8],S=this._r[9];n>=16;){var R=e[t+0]|e[t+1]<<8;i+=8191&R;var A=e[t+2]|e[t+3]<<8;s+=8191&(R>>>13|A<<3);var I=e[t+4]|e[t+5]<<8;o+=8191&(A>>>10|I<<6);var T=e[t+6]|e[t+7]<<8;a+=8191&(I>>>7|T<<9);var C=e[t+8]|e[t+9]<<8;c+=8191&(T>>>4|C<<12),u+=C>>>1&8191;var P=e[t+10]|e[t+11]<<8;l+=8191&(C>>>14|P<<2);var k=e[t+12]|e[t+13]<<8;h+=8191&(P>>>11|k<<5);var N=e[t+14]|e[t+15]<<8,x=0,D=x;D+=i*p,D+=s*(5*S),D+=o*(5*_),D+=a*(5*v),x=(D+=c*(5*E))>>>13,D&=8191,D+=u*(5*b),D+=l*(5*w),D+=h*(5*m),D+=(d+=8191&(k>>>8|N<<8))*(5*g);var L=x+=(D+=(f+=N>>>5|r)*(5*y))>>>13;L+=i*y,L+=s*p,L+=o*(5*S),L+=a*(5*_),x=(L+=c*(5*v))>>>13,L&=8191,L+=u*(5*E),L+=l*(5*b),L+=h*(5*w),L+=d*(5*m),x+=(L+=f*(5*g))>>>13,L&=8191;var O=x;O+=i*g,O+=s*y,O+=o*p,O+=a*(5*S),x=(O+=c*(5*_))>>>13,O&=8191,O+=u*(5*v),O+=l*(5*E),O+=h*(5*b),O+=d*(5*w);var U=x+=(O+=f*(5*m))>>>13;U+=i*m,U+=s*g,U+=o*y,U+=a*p,x=(U+=c*(5*S))>>>13,U&=8191,U+=u*(5*_),U+=l*(5*v),U+=h*(5*E),U+=d*(5*b);var M=x+=(U+=f*(5*w))>>>13;M+=i*w,M+=s*m,M+=o*g,M+=a*y,x=(M+=c*p)>>>13,M&=8191,M+=u*(5*S),M+=l*(5*_),M+=h*(5*v),M+=d*(5*E);var B=x+=(M+=f*(5*b))>>>13;B+=i*b,B+=s*w,B+=o*m,B+=a*g,x=(B+=c*y)>>>13,B&=8191,B+=u*p,B+=l*(5*S),B+=h*(5*_),B+=d*(5*v);var z=x+=(B+=f*(5*E))>>>13;z+=i*E,z+=s*b,z+=o*w,z+=a*m,x=(z+=c*g)>>>13,z&=8191,z+=u*y,z+=l*p,z+=h*(5*S),z+=d*(5*_);var V=x+=(z+=f*(5*v))>>>13;V+=i*v,V+=s*E,V+=o*b,V+=a*w,x=(V+=c*m)>>>13,V&=8191,V+=u*g,V+=l*y,V+=h*p,V+=d*(5*S);var $=x+=(V+=f*(5*_))>>>13;$+=i*_,$+=s*v,$+=o*E,$+=a*b,x=($+=c*w)>>>13,$&=8191,$+=u*m,$+=l*g,$+=h*y,$+=d*p;var F=x+=($+=f*(5*S))>>>13;F+=i*S,F+=s*_,F+=o*v,F+=a*E,x=(F+=c*b)>>>13,F&=8191,F+=u*w,F+=l*m,F+=h*g,F+=d*y,i=D=8191&(x=(x=((x+=(F+=f*p)>>>13)<<2)+x|0)+(D&=8191)|0),s=L+=x>>>=13,o=O&=8191,a=U&=8191,c=M&=8191,u=B&=8191,l=z&=8191,h=V&=8191,d=$&=8191,f=F&=8191,t+=16,n-=16}this._h[0]=i,this._h[1]=s,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=u,this._h[6]=l,this._h[7]=h,this._h[8]=d,this._h[9]=f},e.prototype.finish=function(e,t){void 0===t&&(t=0);var n,r,i,s,o=new Uint16Array(10);if(this._leftover){for(s=this._leftover,this._buffer[s++]=1;s<16;s++)this._buffer[s]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,s=2;s<10;s++)this._h[s]+=n,n=this._h[s]>>>13,this._h[s]&=8191;for(this._h[0]+=5*n,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,o[0]=this._h[0]+5,n=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this._h[s]+n,n=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,r=(1^n)-1,s=0;s<10;s++)o[s]&=r;for(r=~r,s=0;s<10;s++)this._h[s]=this._h[s]&r|o[s];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,s=1;s<8;s++)i=(this._h[s]+this._pad[s]|0)+(i>>>16)|0,this._h[s]=65535&i;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,n=0,r=e.length;if(this._leftover){(t=16-this._leftover)>r&&(t=r);for(var i=0;i<t;i++)this._buffer[this._leftover+i]=e[n+i];if(r-=t,n+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(r>=16&&(t=r-r%16,this._blocks(e,n,t),n+=t,r-=t),r){for(i=0;i<r;i++)this._buffer[this._leftover+i]=e[n+i];this._leftover+=r}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=s,t.oneTimeAuth=function(e,t){var n=new s(e);n.update(t);var r=n.digest();return n.clean(),r},t.equal=function(e,n){return e.length===t.DIGEST_LENGTH&&n.length===t.DIGEST_LENGTH&&r.equal(e,n)}},31416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const r=n(46008),i=n(98099),s=n(17309);function o(e,n=t.defaultRandomSource){return n.randomBytes(e)}t.defaultRandomSource=new r.SystemRandomSource,t.randomBytes=o,t.randomUint32=function(e=t.defaultRandomSource){const n=o(4,e),r=(0,i.readUint32LE)(n);return(0,s.wipe)(n),r};const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,n=a,r=t.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let i="";const c=n.length,u=256-256%c;for(;e>0;){const t=o(Math.ceil(256*e/u),r);for(let r=0;r<t.length&&e>0;r++){const s=t[r];s<u&&(i+=n.charAt(s%c),e--)}(0,s.wipe)(t)}return i}t.randomString=c,t.randomStringForEntropy=function(e,n=a,r=t.defaultRandomSource){return c(Math.ceil(e/(Math.log(n.length)/Math.LN2)),n,r)}},75455:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;t.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}}},58871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const r=n(17309);t.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=n(35883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let e=0;e<n.length;e++)n[e]=t[e];return(0,r.wipe)(t),n}}},46008:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const r=n(75455),i=n(58871);t.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new i.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}},73294:function(e,t,n){"use strict";var r=n(98099),i=n(17309);t.k=32,t.cn=64;var s=function(){function e(){this.digestLength=t.k,this.blockSize=t.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[n++],t--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(n=a(this._temp,this._state,e,n,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[n++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,n=this._bufferLength,i=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[n]=128;for(var c=n+1;c<o-8;c++)this._buffer[c]=0;r.writeUint32BE(i,this._buffer,o-8),r.writeUint32BE(s,this._buffer,o-4),a(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(c=0;c<this.digestLength/4;c++)r.writeUint32BE(this._state[c],e,4*c);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){i.wipe(e.state),e.buffer&&i.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.mE=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(e,t,n,i,s){for(;s>=64;){for(var a=t[0],c=t[1],u=t[2],l=t[3],h=t[4],d=t[5],f=t[6],p=t[7],y=0;y<16;y++){var g=i+4*y;e[y]=r.readUint32BE(n,g)}for(y=16;y<64;y++){var m=e[y-2],w=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,b=((m=e[y-15])>>>7|m<<25)^(m>>>18|m<<14)^m>>>3;e[y]=(w+e[y-7]|0)+(b+e[y-16]|0)}for(y=0;y<64;y++){w=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&f)|0)+(p+(o[y]+e[y]|0)|0)|0,b=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&u^c&u)|0;p=f,f=d,d=h,h=l+w|0,l=u,u=c,c=a,a=w+b|0}t[0]+=a,t[1]+=c,t[2]+=u,t[3]+=l,t[4]+=h,t[5]+=d,t[6]+=f,t[7]+=p,i+=64,s-=64}return i}t.vp=function(e){var t=new s;t.update(e);var n=t.digest();return t.clean(),n}},17309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},57664:function(e,t,n){"use strict";t.gi=t.Au=t._w=t.KS=t.kz=void 0;const r=n(31416),i=n(17309);function s(e){const t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}t.kz=32,t.KS=32;const o=new Uint8Array(32);o[0]=9;const a=s([56129,1]);function c(e){let t=1;for(let n=0;n<16;n++){let r=e[n]+t+65535;t=Math.floor(r/65536),e[n]=r-65536*t}e[0]+=t-1+37*(t-1)}function u(e,t,n){const r=~(n-1);for(let n=0;n<16;n++){const i=r&(e[n]^t[n]);e[n]^=i,t[n]^=i}}function l(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]+n[r]}function h(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]-n[r]}function d(e,t,n){let r,i,s=0,o=0,a=0,c=0,u=0,l=0,h=0,d=0,f=0,p=0,y=0,g=0,m=0,w=0,b=0,E=0,v=0,_=0,S=0,R=0,A=0,I=0,T=0,C=0,P=0,k=0,N=0,x=0,D=0,L=0,O=0,U=n[0],M=n[1],B=n[2],z=n[3],V=n[4],$=n[5],F=n[6],j=n[7],K=n[8],q=n[9],H=n[10],G=n[11],Z=n[12],W=n[13],Q=n[14],Y=n[15];r=t[0],s+=r*U,o+=r*M,a+=r*B,c+=r*z,u+=r*V,l+=r*$,h+=r*F,d+=r*j,f+=r*K,p+=r*q,y+=r*H,g+=r*G,m+=r*Z,w+=r*W,b+=r*Q,E+=r*Y,r=t[1],o+=r*U,a+=r*M,c+=r*B,u+=r*z,l+=r*V,h+=r*$,d+=r*F,f+=r*j,p+=r*K,y+=r*q,g+=r*H,m+=r*G,w+=r*Z,b+=r*W,E+=r*Q,v+=r*Y,r=t[2],a+=r*U,c+=r*M,u+=r*B,l+=r*z,h+=r*V,d+=r*$,f+=r*F,p+=r*j,y+=r*K,g+=r*q,m+=r*H,w+=r*G,b+=r*Z,E+=r*W,v+=r*Q,_+=r*Y,r=t[3],c+=r*U,u+=r*M,l+=r*B,h+=r*z,d+=r*V,f+=r*$,p+=r*F,y+=r*j,g+=r*K,m+=r*q,w+=r*H,b+=r*G,E+=r*Z,v+=r*W,_+=r*Q,S+=r*Y,r=t[4],u+=r*U,l+=r*M,h+=r*B,d+=r*z,f+=r*V,p+=r*$,y+=r*F,g+=r*j,m+=r*K,w+=r*q,b+=r*H,E+=r*G,v+=r*Z,_+=r*W,S+=r*Q,R+=r*Y,r=t[5],l+=r*U,h+=r*M,d+=r*B,f+=r*z,p+=r*V,y+=r*$,g+=r*F,m+=r*j,w+=r*K,b+=r*q,E+=r*H,v+=r*G,_+=r*Z,S+=r*W,R+=r*Q,A+=r*Y,r=t[6],h+=r*U,d+=r*M,f+=r*B,p+=r*z,y+=r*V,g+=r*$,m+=r*F,w+=r*j,b+=r*K,E+=r*q,v+=r*H,_+=r*G,S+=r*Z,R+=r*W,A+=r*Q,I+=r*Y,r=t[7],d+=r*U,f+=r*M,p+=r*B,y+=r*z,g+=r*V,m+=r*$,w+=r*F,b+=r*j,E+=r*K,v+=r*q,_+=r*H,S+=r*G,R+=r*Z,A+=r*W,I+=r*Q,T+=r*Y,r=t[8],f+=r*U,p+=r*M,y+=r*B,g+=r*z,m+=r*V,w+=r*$,b+=r*F,E+=r*j,v+=r*K,_+=r*q,S+=r*H,R+=r*G,A+=r*Z,I+=r*W,T+=r*Q,C+=r*Y,r=t[9],p+=r*U,y+=r*M,g+=r*B,m+=r*z,w+=r*V,b+=r*$,E+=r*F,v+=r*j,_+=r*K,S+=r*q,R+=r*H,A+=r*G,I+=r*Z,T+=r*W,C+=r*Q,P+=r*Y,r=t[10],y+=r*U,g+=r*M,m+=r*B,w+=r*z,b+=r*V,E+=r*$,v+=r*F,_+=r*j,S+=r*K,R+=r*q,A+=r*H,I+=r*G,T+=r*Z,C+=r*W,P+=r*Q,k+=r*Y,r=t[11],g+=r*U,m+=r*M,w+=r*B,b+=r*z,E+=r*V,v+=r*$,_+=r*F,S+=r*j,R+=r*K,A+=r*q,I+=r*H,T+=r*G,C+=r*Z,P+=r*W,k+=r*Q,N+=r*Y,r=t[12],m+=r*U,w+=r*M,b+=r*B,E+=r*z,v+=r*V,_+=r*$,S+=r*F,R+=r*j,A+=r*K,I+=r*q,T+=r*H,C+=r*G,P+=r*Z,k+=r*W,N+=r*Q,x+=r*Y,r=t[13],w+=r*U,b+=r*M,E+=r*B,v+=r*z,_+=r*V,S+=r*$,R+=r*F,A+=r*j,I+=r*K,T+=r*q,C+=r*H,P+=r*G,k+=r*Z,N+=r*W,x+=r*Q,D+=r*Y,r=t[14],b+=r*U,E+=r*M,v+=r*B,_+=r*z,S+=r*V,R+=r*$,A+=r*F,I+=r*j,T+=r*K,C+=r*q,P+=r*H,k+=r*G,N+=r*Z,x+=r*W,D+=r*Q,L+=r*Y,r=t[15],E+=r*U,v+=r*M,_+=r*B,S+=r*z,R+=r*V,A+=r*$,I+=r*F,T+=r*j,C+=r*K,P+=r*q,k+=r*H,N+=r*G,x+=r*Z,D+=r*W,L+=r*Q,O+=r*Y,s+=38*v,o+=38*_,a+=38*S,c+=38*R,u+=38*A,l+=38*I,h+=38*T,d+=38*C,f+=38*P,p+=38*k,y+=38*N,g+=38*x,m+=38*D,w+=38*L,b+=38*O,i=1,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,r=b+i+65535,i=Math.floor(r/65536),b=r-65536*i,r=E+i+65535,i=Math.floor(r/65536),E=r-65536*i,s+=i-1+37*(i-1),i=1,r=s+i+65535,i=Math.floor(r/65536),s=r-65536*i,r=o+i+65535,i=Math.floor(r/65536),o=r-65536*i,r=a+i+65535,i=Math.floor(r/65536),a=r-65536*i,r=c+i+65535,i=Math.floor(r/65536),c=r-65536*i,r=u+i+65535,i=Math.floor(r/65536),u=r-65536*i,r=l+i+65535,i=Math.floor(r/65536),l=r-65536*i,r=h+i+65535,i=Math.floor(r/65536),h=r-65536*i,r=d+i+65535,i=Math.floor(r/65536),d=r-65536*i,r=f+i+65535,i=Math.floor(r/65536),f=r-65536*i,r=p+i+65535,i=Math.floor(r/65536),p=r-65536*i,r=y+i+65535,i=Math.floor(r/65536),y=r-65536*i,r=g+i+65535,i=Math.floor(r/65536),g=r-65536*i,r=m+i+65535,i=Math.floor(r/65536),m=r-65536*i,r=w+i+65535,i=Math.floor(r/65536),w=r-65536*i,r=b+i+65535,i=Math.floor(r/65536),b=r-65536*i,r=E+i+65535,i=Math.floor(r/65536),E=r-65536*i,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=y,e[11]=g,e[12]=m,e[13]=w,e[14]=b,e[15]=E}function f(e,t){d(e,t,t)}function p(e,t){const n=new Uint8Array(32),r=new Float64Array(80),i=s(),o=s(),p=s(),y=s(),g=s(),m=s();for(let t=0;t<31;t++)n[t]=e[t];n[31]=127&e[31]|64,n[0]&=248,function(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}(r,t);for(let e=0;e<16;e++)o[e]=r[e];i[0]=y[0]=1;for(let e=254;e>=0;--e){const t=n[e>>>3]>>>(7&e)&1;u(i,o,t),u(p,y,t),l(g,i,p),h(i,i,p),l(p,o,y),h(o,o,y),f(y,g),f(m,i),d(i,p,i),d(p,o,g),l(g,i,p),h(i,i,p),f(o,i),h(p,y,m),d(i,p,a),l(i,i,y),d(p,p,i),d(i,y,m),d(y,o,r),f(o,g),u(i,o,t),u(p,y,t)}for(let e=0;e<16;e++)r[e+16]=i[e],r[e+32]=p[e],r[e+48]=o[e],r[e+64]=y[e];const w=r.subarray(32),b=r.subarray(16);!function(e,t){const n=s();for(let e=0;e<16;e++)n[e]=t[e];for(let e=253;e>=0;e--)f(n,n),2!==e&&4!==e&&d(n,n,t);for(let t=0;t<16;t++)e[t]=n[t]}(w,w),d(b,b,w);const E=new Uint8Array(32);return function(e,t){const n=s(),r=s();for(let e=0;e<16;e++)r[e]=t[e];c(r),c(r),c(r);for(let e=0;e<2;e++){n[0]=r[0]-65517;for(let e=1;e<15;e++)n[e]=r[e]-65535-(n[e-1]>>16&1),n[e-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const e=n[15]>>16&1;n[14]&=65535,u(r,n,1-e)}for(let t=0;t<16;t++)e[2*t]=255&r[t],e[2*t+1]=r[t]>>8}(E,b),E}function y(e){return p(e,o)}function g(e){if(e.length!==t.KS)throw new Error(`x25519: seed must be ${t.KS} bytes`);const n=new Uint8Array(e);return{publicKey:y(n),secretKey:n}}t._w=g,t.Au=function(e){const t=(0,r.randomBytes)(32,e),n=g(t);return(0,i.wipe)(t),n},t.gi=function(e,n,r=!1){if(e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(n.length!==t.kz)throw new Error("X25519: incorrect public key length");const i=p(e,n);if(r){let e=0;for(let t=0;t<i.length;t++)e|=i[t];if(0===e)throw new Error("X25519: invalid shared key")}return i}},63573:function(e,t){"use strict";const n=Math.exp;e.exports=function(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,r,i=0,s=0,o=0,a={};return a.push=function(a,c){if(r){const u=1-n(-(a-r)/e),l=c-t;t=u*c+(1-u)*t,i=(1-u)*(i+l*(u*l)),s=Math.sqrt(i),o=t+u*l}else t=c;r=a},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return s},a.forecast=function(){return o},a}},71993:function(e){"use strict";e.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:805306496,SSL_OP_ALL:2147485776,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,defaultCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA"}},1914:function(e){"use strict";const t=65536;e.exports=function(e){const n=new Uint8Array(e);let r=0;if(e>0)if(e>t)for(;r<e;)r+t>e?(crypto.getRandomValues(n.subarray(r,r+(e-r))),r+=e-r):(crypto.getRandomValues(n.subarray(r,r+t)),r+=t);else crypto.getRandomValues(n);return n}},17745:function(e,t,n){"use strict";const{URLWithLegacySupport:r,format:i,URLSearchParams:s,defaultBase:o}=n(82049),a=n(15939);e.exports={URL:r,URLSearchParams:s,format:i,relative:a,defaultBase:o}},24094:function(e,t,n){e.exports=n(69065),e.exports.parse=n(69065),e.exports.stringify=n(11876)},69065:function(e){e.exports=e=>async function*(){const t=/\r?\n/,n=new TextDecoder("utf8");let r="";for await(let i of e){"string"==typeof i&&(i=(new TextEncoder).encode(i)),r+=n.decode(i,{stream:!0});const e=r.split(t);r=e.pop();for(let t=0;t<e.length;t++)yield JSON.parse(e[t])}r+=n.decode(),r&&(yield JSON.parse(r))}()},11876:function(e){e.exports=e=>async function*(){for await(const t of e)yield JSON.stringify(t)+"\n"}()},24810:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(e,t,n){var r=null,i=null,s=function(){r&&(clearTimeout(r),i=null,r=null)},o=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,c=n&&!r;return s(),i=function(){e.apply(o,a)},r=setTimeout((function(){if(r=null,!c){var e=i;return i=null,e()}}),t),c?i():void 0};return o.cancel=s,o.flush=function(){var e=i;s(),e&&e()},o}},91589:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(e,t,n){if(!e)return n;var r,i;Array.isArray(t)&&(r=t.slice(0));"string"==typeof t&&(r=t.split("."));"symbol"==typeof t&&(r=[t]);if(!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");for(;r.length;){if(i=r.shift(),!e)return n;if(void 0===(e=e[i]))return n}return e}},2302:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(e,t,n){var r,s,o;Array.isArray(t)&&(r=t.slice(0));"string"==typeof t&&(r=t.split("."));"symbol"==typeof t&&(r=[t]);if(!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");if(!(s=r.pop()))return!1;i(s);for(;o=r.shift();)if(i(o),void 0===e[o]&&(e[o]={}),!(e=e[o])||"object"!=typeof e)return!1;return e[s]=n,!0};function i(e){if("__proto__"==e||"constructor"==e||"prototype"==e)throw new Error("setting of prototype values not supported")}},99507:function(e,t,n){"use strict";const r=n(61798),{EventEmitter:i}=n(17187);function s(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function o(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class a extends i{constructor(e={}){super(),this.localNodeId=e.localNodeId||r(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||a.distance,this.arbiter=e.arbiter||a.arbiter,this.metadata=Object.assign({},e.metadata),o("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let n=0,r=0;const i=Math.min(e.length,t.length),s=Math.max(e.length,t.length);for(;r<i;++r)n=256*n+(e[r]^t[r]);for(;r<s;++r)n=256*n+255;return n}add(e){o("contact.id",(e||{}).id);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e.id,t++);const r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.emit("added",e),this):n.dontSplit?(this.emit("ping",n.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(n,t),this.add(e))}closest(e,t=1/0){if(o("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let n=[];for(let r=[this.root],i=0;r.length>0&&n.length<t;){const t=r.pop();if(null===t.contacts){const n=this._determineNode(t,e,i++);r.push(t.left===n?t.right:t.left),r.push(n)}else n=n.concat(t.contacts)}return n.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const n=t.pop();null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length}return e}_determineNode(e,t,n){const r=n>>3,i=n%8;if(t.length<=r&&0!==i)return e.left;return t[r]&1<<7-i?e.right:e.left}get(e){o("id",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);return r>=0?n.contacts[r]:null}_indexOf(e,t){for(let n=0;n<e.contacts.length;++n)if(s(e.contacts[n].id,t))return n;return-1}remove(e){o("the id as parameter 1",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);if(r>=0){const e=n.contacts.splice(r,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const n of e.contacts)this._determineNode(e,n.id,t).contacts.push(n);e.contacts=null;const n=this._determineNode(e,this.localNodeId,t);(e.left===n?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const n=t.pop();null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,n){if(!s(e.contacts[t].id,n.id))throw new Error("wrong index for _update");const r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.emit("updated",r,i))}}e.exports=a},80724:function(e,t){"use strict";t.supports=function(...e){const t=e.reduce(((e,t)=>Object.assign(e,t)),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}},58499:function(e,t,n){"use strict";const r=n(31648),i=n(27971),{Encoding:s}=n(8266),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=n(89754),u=Symbol("formats"),l=Symbol("encodings"),h=new Set(["buffer","view","utf8"]);t.Transcoder=class{constructor(e){if(!Array.isArray(e))throw new TypeError("The first argument 'formats' must be an array");if(!e.every((e=>h.has(e))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[l]=new Map,this[u]=new Set(e);for(const e in i)try{this.encoding(e)}catch(e){if("LEVEL_ENCODING_NOT_SUPPORTED"!==e.code)throw e}}encodings(){return Array.from(new Set(this[l].values()))}encoding(e){let t=this[l].get(e);if(void 0===t){if("string"==typeof e&&""!==e){if(t=f[e],!t)throw new r(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof e||null===e)throw new TypeError("First argument 'encoding' must be a string or object");t=function(e){if(e instanceof s)return e;const t="type"in e&&"string"==typeof e.type?e.type:void 0,n=e.name||t||"anonymous-"+p++;switch(function(e){return"format"in e&&void 0!==e.format?e.format:"buffer"in e&&"boolean"==typeof e.buffer?e.buffer?"buffer":"utf8":"code"in e&&Number.isInteger(e.code)?"view":"buffer"}(e)){case"view":return new a({...e,name:n});case"utf8":return new c({...e,name:n});case"buffer":return new o({...e,name:n});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(e)}const{name:n,format:i}=t;if(!this[u].has(i))if(this[u].has("view"))t=t.createViewTranscoder();else if(this[u].has("buffer"))t=t.createBufferTranscoder();else{if(!this[u].has("utf8"))throw new r(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});t=t.createUTF8Transcoder()}for(const r of[e,n,t.name,t.commonName])this[l].set(r,t)}return t}};const d={binary:i.buffer,"utf-8":i.utf8},f={...i,...d};let p=0},8266:function(e,t,n){"use strict";const r=n(31648),i=new Set(["buffer","view","utf8"]);t.Encoding=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!i.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},27971:function(e,t,n){"use strict";const{Buffer:r}=n(35275)||{Buffer:{isBuffer:()=>!1}},{textEncoder:i,textDecoder:s}=n(85850)(),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=n(89754),u=e=>e;t.utf8=new c({encode:function(e){return r.isBuffer(e)?e.toString("utf8"):ArrayBuffer.isView(e)?s.decode(e):String(e)},decode:u,name:"utf8",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:i.encode(e)},decode:function(e){return s.decode(e)},name:`${this.name}+view`})},createBufferTranscoder(){return new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:function(e){return e.toString("utf8")},name:`${this.name}+buffer`})}}),t.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),t.buffer=new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:u,name:"buffer",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:r.from(String(e),"utf8")},decode:function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)},name:`${this.name}+view`})}}),t.view=new a({encode:function(e){return ArrayBuffer.isView(e)?e:i.encode(e)},decode:u,name:"view",createBufferTranscoder(){return new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:u,name:`${this.name}+buffer`})}}),t.hex=new o({encode:function(e){return r.isBuffer(e)?e:r.from(String(e),"hex")},decode:function(e){return e.toString("hex")},name:"hex"}),t.base64=new o({encode:function(e){return r.isBuffer(e)?e:r.from(String(e),"base64")},decode:function(e){return e.toString("base64")},name:"base64"})},89754:function(e,t,n){"use strict";const{Buffer:r}=n(35275)||{},{Encoding:i}=n(8266),s=n(85850);class o extends i{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:e=>this.decode(r.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends i{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new o({encode:e=>{const t=this.encode(e);return r.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}t.BufferFormat=o,t.ViewFormat=a,t.UTF8Format=class extends i{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new o({encode:e=>r.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=s();return new a({encode:t=>e.encode(this.encode(t)),decode:e=>this.decode(t.decode(e)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},85850:function(e){"use strict";let t=null;e.exports=function(){return null===t&&(t={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),t}},35275:function(e,t,n){"use strict";var r=n(25108);const i=n(79742),s=n(80645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function c(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|g(e,t);let r=c(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Q(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,ArrayBuffer)||e&&Q(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Q(e,SharedArrayBuffer)||e&&Q(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return u.from(r,t,n);const i=function(e){if(u.isBuffer(e)){const t=0|y(e.length),n=c(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?c(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),c(e<0?0:0|y(e))}function f(e){const t=e.length<0?0:0|y(e.length),n=c(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,u.prototype),r}function y(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function g(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(e).length;default:if(i)return r?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function w(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:E(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):E(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,n,r,i){let s,o=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let r=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===c)return r*o}else-1!==r&&(s-=s-r),r=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){let n=!0;for(let r=0;r<c;r++)if(u(e,s+r)!==u(t,r)){n=!1;break}if(n)return s}return-1}function v(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const s=t.length;let o;for(r>s/2&&(r=s/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(Y(r))return o;e[n+o]=r}return o}function _(e,t,n,r){return W(G(t,e.length-n),e,n,r)}function S(e,t,n,r){return W(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function R(e,t,n,r){return W(Z(t),e,n,r)}function A(e,t,n,r){return W(function(e,t){let n,r,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,r,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(s=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=o}return function(e){const t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===r||"function"!=typeof r.error||r.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,n){return function(e,t,n){return h(e),e<=0?c(e):void 0!==t?"string"==typeof n?c(e).fill(t,n):c(e).fill(t):c(e)}(e,t,n)},u.allocUnsafe=function(e){return d(e)},u.allocUnsafeSlow=function(e){return d(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(Q(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=u.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Q(t,Uint8Array))i+t.length>r.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)w(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,n,r,i){if(Q(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(r,i),l=e.slice(t,n);for(let e=0;e<a;++e)if(c[e]!==l[e]){s=c[e],o=l[e];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return S(this,e,t,n);case"base64":return R(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function P(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function k(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=J[e[r]];return i}function x(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,s){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r,i){j(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function U(e,t,n,r,i){j(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function M(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return t=+t,n>>>=0,i||M(e,0,n,4),s.write(e,t,n,r,23,4),n+4}function z(e,t,n,r,i){return t=+t,n>>>=0,i||M(e,0,n,8),s.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=X((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=X((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=X((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=X((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=X((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=X((function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=X((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=X((function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return z(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return z(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const s=u.isBuffer(e)?e:u.from(e,r),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%o]}return this};const V={};function $(e,t,n){V[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function j(e,t,n,r,i,s){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(s+1)}${r}`:`>= -(2${r} ** ${8*(s+1)-1}${r}) and < 2 ** ${8*(s+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new V.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){K(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||q(t,e.length-(n+1))}(r,i,s)}function K(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,n){if(Math.floor(e)!==e)throw K(e,n),new V.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new V.ERR_BUFFER_OUT_OF_BOUNDS;throw new V.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}$("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),$("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),$("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=F(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function G(e,t){let n;t=t||1/0;const r=e.length;let i=null;const s=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Z(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function X(e){return"undefined"==typeof BigInt?ee:e}function ee(){throw new Error("BigInt not supported")}},21301:function(e,t,n){t.Level=n(11708).BrowserLevel},72287:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,o),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},60644:function(e,t,n){const r=n(91240),i=n(9400),s=n(44862),o=n(49489),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u}=n(76190),l=n(86823),h=n(50653),d=n(39121),f=n(14574),p=n(90126),y=n(66354),g=n(19853);e.exports={RateLimiterRedis:r,RateLimiterMongo:i,RateLimiterMySQL:s,RateLimiterPostgres:o,RateLimiterMemory:l,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:y,RateLimiterRes:g}},70942:function(e,t,n){"use strict";const r=n(49727),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:s}=Object,o=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},u=e=>{const t=[];for(const n in e)i.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)s.call(e,r)&&t.push(r)}return t};function l(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return u(e).forEach((n=>{o(t,n,l(e[n]))})),t}(e):r(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return u(e).forEach((n=>{o(t,n,l(e[n]))})),t}(e):e}const h=(e,t,n,r)=>(n.forEach((n=>{void 0===t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?o(e,n,f(e[n],t[n],r)):o(e,n,l(t[n])))})),e),d=(e,t,n)=>{let r=e.slice(0,0),s=0;return[e,t].forEach((t=>{const a=[];for(let n=0;n<t.length;n++)i.call(t,n)&&(a.push(String(n)),o(r,s++,t===e?t[n]:l(t[n])));r=h(r,t,u(t).filter((e=>!a.includes(e))),n)})),r};function f(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?d(e,t,n):r(t)&&r(e)?h(e,t,u(t),n):l(t)}e.exports=function(...e){const t=f(l(c),this!==a&&this||{},c);let n={_:{}};for(const i of e)if(void 0!==i){if(!r(i))throw new TypeError("`"+i+"` is not an Option Object");n=f(n,{_:i},t)}return n._}},79221:function(e,t,n){"use strict";var r=n(70942),i=n.n(r);t.Z=i()},31648:function(e){"use strict";e.exports=class extends Error{constructor(e,t){super(e||""),"object"==typeof t&&null!==t&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},40469:function(e,t,n){e.exports=n(18027)},18027:function(e,t){!function(n,r){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function s(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e=o(e^=e>>>16,2246822507),e=o(e^=e>>>13,3266489909),e^=e>>>16}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function h(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function d(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=f(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=f(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!s(e))return r;t=t||0;for(var n=e.length%4,u=e.length-n,l=t,h=0,d=3432918353,f=461845907,p=0;p<u;p+=4)h=o(h=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,d),h=o(h=a(h,15),f),l=o(l=a(l^=h,13),5)+3864292196;switch(h=0,n){case 3:h^=e[p+2]<<16;case 2:h^=e[p+1]<<8;case 1:h=o(h^=e[p],d),l^=h=o(h=a(h,15),f)}return(l=c(l^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!s(e))return r;t=t||0;for(var n=e.length%16,u=e.length-n,l=t,h=t,d=t,f=t,p=0,y=0,g=0,m=0,w=597399067,b=2869860233,E=951274213,v=2716044179,_=0;_<u;_+=16)p=e[_]|e[_+1]<<8|e[_+2]<<16|e[_+3]<<24,y=e[_+4]|e[_+5]<<8|e[_+6]<<16|e[_+7]<<24,g=e[_+8]|e[_+9]<<8|e[_+10]<<16|e[_+11]<<24,m=e[_+12]|e[_+13]<<8|e[_+14]<<16|e[_+15]<<24,p=a(p=o(p,w),15),l=a(l^=p=o(p,b),19),l=o(l+=h,5)+1444728091,y=a(y=o(y,b),16),h=a(h^=y=o(y,E),17),h=o(h+=d,5)+197830471,g=a(g=o(g,E),17),d=a(d^=g=o(g,v),15),d=o(d+=f,5)+2530024501,m=a(m=o(m,v),18),f=a(f^=m=o(m,w),13),f=o(f+=l,5)+850148119;switch(p=0,y=0,g=0,m=0,n){case 15:m^=e[_+14]<<16;case 14:m^=e[_+13]<<8;case 13:m=o(m^=e[_+12],v),f^=m=o(m=a(m,18),w);case 12:g^=e[_+11]<<24;case 11:g^=e[_+10]<<16;case 10:g^=e[_+9]<<8;case 9:g=o(g^=e[_+8],E),d^=g=o(g=a(g,17),v);case 8:y^=e[_+7]<<24;case 7:y^=e[_+6]<<16;case 6:y^=e[_+5]<<8;case 5:y=o(y^=e[_+4],b),h^=y=o(y=a(y,16),E);case 4:p^=e[_+3]<<24;case 3:p^=e[_+2]<<16;case 2:p^=e[_+1]<<8;case 1:p=o(p^=e[_],w),l^=p=o(p=a(p,15),b)}return l^=e.length,l+=h^=e.length,l+=d^=e.length,h+=l+=f^=e.length,d+=l,f+=l,l=c(l),l+=h=c(h),l+=d=c(d),h+=l+=f=c(f),d+=l,f+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!s(e))return r;t=t||0;for(var n=e.length%16,o=e.length-n,a=[0,t],c=[0,t],y=[0,0],g=[0,0],m=[2277735313,289559509],w=[1291169091,658871167],b=0;b<o;b+=16)y=[e[b+4]|e[b+5]<<8|e[b+6]<<16|e[b+7]<<24,e[b]|e[b+1]<<8|e[b+2]<<16|e[b+3]<<24],g=[e[b+12]|e[b+13]<<8|e[b+14]<<16|e[b+15]<<24,e[b+8]|e[b+9]<<8|e[b+10]<<16|e[b+11]<<24],y=h(y=l(y,m),31),a=u(a=h(a=f(a,y=l(y,w)),27),c),a=u(l(a,[0,5]),[0,1390208809]),g=h(g=l(g,w),33),c=u(c=h(c=f(c,g=l(g,m)),31),a),c=u(l(c,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],n){case 15:g=f(g,d([0,e[b+14]],48));case 14:g=f(g,d([0,e[b+13]],40));case 13:g=f(g,d([0,e[b+12]],32));case 12:g=f(g,d([0,e[b+11]],24));case 11:g=f(g,d([0,e[b+10]],16));case 10:g=f(g,d([0,e[b+9]],8));case 9:g=l(g=f(g,[0,e[b+8]]),w),c=f(c,g=l(g=h(g,33),m));case 8:y=f(y,d([0,e[b+7]],56));case 7:y=f(y,d([0,e[b+6]],48));case 6:y=f(y,d([0,e[b+5]],40));case 5:y=f(y,d([0,e[b+4]],32));case 4:y=f(y,d([0,e[b+3]],24));case 3:y=f(y,d([0,e[b+2]],16));case 2:y=f(y,d([0,e[b+1]],8));case 1:y=l(y=f(y,[0,e[b]]),m),a=f(a,y=l(y=h(y,31),w))}return a=u(a=f(a,[0,e.length]),c=f(c,[0,e.length])),c=u(c,a),a=u(a=p(a),c=p(c)),c=u(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},30700:function(e,t,n){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:n(83300).default,Headers:n(83300).Headers,Request:n(83300).Request,Response:n(83300).Response}},83300:function(e,t,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,r.fetch&&(t.default=r.fetch.bind(r)),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},86971:function(e,t,n){var r=n(3832);n(83453),e.exports=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1},83453:function(e,t,n){var r=n(3832);n(97116),r.mgf=r.mgf||{},(e.exports=r.mgf.mgf1=r.mgf1=r.mgf1||{}).create=function(e){return{generate:function(t,n){for(var i=new r.util.ByteBuffer,s=Math.ceil(n/e.digestLength),o=0;o<s;o++){var a=new r.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-n),i.getBytes()}}}},79437:function(e,t,n){var r=n(3832);n(8925),n(3068),n(33480),n(66270),n(26953),n(95496),n(49563),n(97116),n(25414);var i=r.asn1,s=e.exports=r.pkcs7=r.pkcs7||{};function o(e){var t={},n=[];if(!i.validate(e,s.asn1.recipientInfoValidator,t,n)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=n,o}return{version:t.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(t.issuer),serialNumber:r.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){for(var t,n=[],s=0;s<e.length;++s)n.push((t=e[s],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:t.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,r.util.hexToBytes(t.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return n}function c(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,r.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var n=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),s=0;s<e.unauthenticatedAttributes.length;++s){var o=e.unauthenticatedAttributes[s];n.values.push(u(o))}t.value.push(n)}return t}function u(e){var t;if(e.type===r.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===r.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===r.pki.oids.signingTime){var n=new Date("1950-01-01T00:00:00Z"),s=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"==typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?i.utcTimeToDate(o):i.generalizedTimeToDate(o):new Date(a)}t=o>=n&&o<s?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(o)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(o))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function l(e,t,n){var s={};if(!i.validate(t,n,s,[])){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}if(i.derToOid(s.contentType)!==r.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(s.encryptedContent){var a="";if(r.util.isArray(s.encryptedContent))for(var c=0;c<s.encryptedContent.length;++c){if(s.encryptedContent[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=s.encryptedContent[c].value}else a=s.encryptedContent;e.encryptedContent={algorithm:i.derToOid(s.encAlgorithm),parameter:r.util.createBuffer(s.encParameter.value),content:r.util.createBuffer(a)}}if(s.content){a="";if(r.util.isArray(s.content))for(c=0;c<s.content.length;++c){if(s.content[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=s.content[c].value}else a=s.content;e.content=r.util.createBuffer(a)}return e.version=s.version.charCodeAt(0),e.rawCapture=s,s}function h(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:t=r.aes.createDecryptionCipher(e.encryptedContent.key);break;case r.pki.oids.desCBC:case r.pki.oids["des-EDE3-CBC"]:t=r.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}s.messageFromPem=function(e){var t=r.pem.decode(e)[0];if("PKCS7"!==t.type){var n=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return s.messageFromAsn1(o)},s.messageToPem=function(e,t){var n={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return r.pem.encode(n,{maxline:t})},s.messageFromAsn1=function(e){var t={},n=[];if(!i.validate(e,s.asn1.contentInfoValidator,t,n)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=n,o}var a,c=i.derToOid(t.contentType);switch(c){case r.pki.oids.envelopedData:a=s.createEnvelopedData();break;case r.pki.oids.encryptedData:a=s.createEncryptedData();break;case r.pki.oids.signedData:a=s.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},s.createSignedData=function(){var e=null;return e={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,s.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,i=0;i<n.length;++i)e.certificates.push(r.pki.certificateFromAsn1(n[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],n=0;n<e.certificates.length;++n)t.push(r.pki.certificateToAsn1(e.certificates[n]));var s=[],o=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),s.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var n=t.issuer,i=t.serialNumber;if(t.certificate){var s=t.certificate;"string"==typeof s&&(s=r.pki.certificateFromPem(s)),n=s.issuer.attributes,i=s.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof o&&(o=r.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||r.pki.oids.sha1;switch(a){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,h=0;h<c.length;++h){var d=c[h];if(u||d.type!==r.pki.oids.contentType){if(l||d.type!==r.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:n,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var n;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(r.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof r.util.ByteBuffer?n=e.content.bytes():"string"==typeof e.content&&(n=r.util.encodeUtf8(e.content)),t.detached?e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,n):e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,n)]))));0!==e.signers.length&&function(t){var n;n=e.detachedContent?e.detachedContent:(n=e.contentInfo.value[1]).value[0];if(!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=i.derToOid(e.contentInfo.value[0].value),o=i.toDer(n);for(var a in o.getByte(),i.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var l=new Date,h=0;h<e.signers.length;++h){var d=e.signers[h];if(0===d.authenticatedAttributes.length){if(s!==r.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),p=0;p<d.authenticatedAttributes.length;++p){var y=d.authenticatedAttributes[p];y.type===r.pki.oids.messageDigest?y.value=t[d.digestAlgorithm].digest():y.type===r.pki.oids.signingTime&&(y.value||(y.value=l)),f.value.push(u(y)),d.authenticatedAttributesAsn1.value.push(u(y))}o=i.toDer(f).getBytes(),d.md.start().update(o)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],n=0;n<e.length;++n)t.push(c(e[n]));return t}(e.signers)}(function(){for(var t={},n=0;n<e.signers.length;++n){var s=e.signers[n];(o=s.digestAlgorithm)in t||(t[o]=r.md[r.pki.oids[o]].create()),0===s.authenticatedAttributes.length?s.md=t[o]:s.md=r.md[r.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=r.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},s.createEncryptedData=function(){var e=null;return e={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,s.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),h(e)}}},s.createEnvelopedData=function(){var e=null;return e={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(t){var n=l(e,t,s.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],n=0;n<e.length;++n)t.push(o(e[n]));return t}(n.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,a(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(r.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),t.parameter?i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var n=t.issuer.attributes,r=0;r<e.recipients.length;++r){var i=e.recipients[r],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===n.length){for(var o=!0,a=0;a<n.length;++a)if(s[a].type!==n[a].type||s[a].value!==n[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(t,n){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==n)switch(t.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var i=n.decrypt(t.encryptedContent.content);e.encryptedContent.key=r.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}h(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,n){if(void 0===e.encryptedContent.content){var i,s,o;switch(n=n||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,n){case r.pki.oids["aes128-CBC"]:i=16,s=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:i=24,s=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:i=32,s=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:i=24,s=8,o=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(void 0===t)t=r.util.createBuffer(r.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=n,e.encryptedContent.key=t,e.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(s));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content){if(u.encryptedContent.algorithm!==r.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm);u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},95496:function(e,t,n){var r=n(3832);n(3068),n(97116);var i=r.asn1,s=e.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=s;var o={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},s.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},96007:function(e,t,n){var r=n(3832);n(49563),n(97116),(e.exports=r.pss=r.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,n=e.md,i=e.mgf,s=n.digestLength,o=e.salt||null;if("string"==typeof o&&(o=r.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||r.random,c={encode:function(e,c){var u,l,h=c-1,d=Math.ceil(h/8),f=e.digest().getBytes();if(d<s+t+2)throw new Error("Message is too long to encrypt.");l=null===o?a.getBytesSync(t):o.bytes();var p=new r.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(f),p.putBytes(l),n.start(),n.update(p.getBytes());var y=n.digest().getBytes(),g=new r.util.ByteBuffer;g.fillWithByte(0,d-t-s-2),g.putByte(1),g.putBytes(l);var m=g.getBytes(),w=d-s-1,b=i.generate(y,w),E="";for(u=0;u<w;u++)E+=String.fromCharCode(m.charCodeAt(u)^b.charCodeAt(u));var v=65280>>8*d-h&255;return(E=String.fromCharCode(E.charCodeAt(0)&~v)+E.substr(1))+y+String.fromCharCode(188)},verify:function(e,o,a){var c,u=a-1,l=Math.ceil(u/8);if(o=o.substr(-l),l<s+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var h=l-s-1,d=o.substr(0,h),f=o.substr(h,s),p=65280>>8*l-u&255;if(0!=(d.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var y=i.generate(f,h),g="";for(c=0;c<h;c++)g+=String.fromCharCode(d.charCodeAt(c)^y.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~p)+g.substr(1);var m=l-s-t-2;for(c=0;c<m;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=g.substr(-t),b=new r.util.ByteBuffer;return b.fillWithByte(0,8),b.putBytes(e),b.putBytes(w),n.start(),n.update(b.getBytes()),f===n.digest().getBytes()}};return c}},25414:function(e,t,n){var r=n(3832);n(8925),n(3068),n(33480),n(28991),n(86971),n(66270),n(26953),n(96007),n(28095),n(97116);var i=r.asn1,s=e.exports=r.pki=r.pki||{},o=s.oids,a={};a.CN=o.commonName,a.commonName="CN",a.C=o.countryName,a.countryName="C",a.L=o.localityName,a.localityName="L",a.ST=o.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=o.organizationName,a.organizationName="O",a.OU=o.organizationalUnitName,a.organizationalUnitName="OU",a.E=o.emailAddress,a.emailAddress="E";var c=r.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},d={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"==typeof t&&(t={shortName:t});for(var n,r=null,i=0;null===r&&i<e.attributes.length;++i)n=e.attributes[i],(t.type&&t.type===n.type||t.name&&t.name===n.name||t.shortName&&t.shortName===n.shortName)&&(r=n);return r}s.RDNAttributesAsArray=function(e,t){for(var n,r,s,c=[],u=0;u<e.value.length;++u){n=e.value[u];for(var l=0;l<n.value.length;++l)s={},r=n.value[l],s.type=i.derToOid(r.value[0].value),s.value=r.value[1].value,s.valueTagClass=r.value[1].type,s.type in o&&(s.name=o[s.type],s.name in a&&(s.shortName=a[s.name])),t&&(t.update(s.type),t.update(s.value)),c.push(s)}return c},s.CRIAttributesAsArray=function(e){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],c=i.derToOid(r.value[0].value),u=r.value[1].value,l=0;l<u.length;++l){var h={};if(h.type=c,h.value=u[l].value,h.valueTagClass=u[l].type,h.type in o&&(h.name=o[h.type],h.name in a&&(h.shortName=a[h.name])),h.type===o.extensionRequest){h.extensions=[];for(var d=0;d<h.value.length;++d)h.extensions.push(s.certificateExtensionFromAsn1(h.value[d]))}t.push(h)}return t};var p=function(e,t,n){var r={};if(e!==o["RSASSA-PSS"])return r;n&&(r={hash:{algorithmOid:o.sha1},mgf:{algorithmOid:o.mgf1,hash:{algorithmOid:o.sha1}},saltLength:20});var s={},a=[];if(!i.validate(t,l,s,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==s.hashOid&&(r.hash=r.hash||{},r.hash.algorithmOid=i.derToOid(s.hashOid)),void 0!==s.maskGenOid&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=i.derToOid(s.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=i.derToOid(s.maskGenHashOid)),void 0!==s.saltLength&&(r.saltLength=s.saltLength.charCodeAt(0)),r},y=function(e){switch(o[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return r.md.sha1.create();case"md5WithRSAEncryption":return r.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return r.md.sha256.create();case"sha384WithRSAEncryption":return r.md.sha384.create();case"sha512WithRSAEncryption":return r.md.sha512.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,n=e.certificate;switch(n.signatureOid){case o.sha1WithRSAEncryption:case o.sha1WithRSASignature:break;case o["RSASSA-PSS"]:var i,s,a;if(void 0===(i=o[n.signatureParameters.mgf.hash.algorithmOid])||void 0===r.md[i])throw(a=new Error("Unsupported MGF hash function.")).oid=n.signatureParameters.mgf.hash.algorithmOid,a.name=i,a;if(void 0===(s=o[n.signatureParameters.mgf.algorithmOid])||void 0===r.mgf[s])throw(a=new Error("Unsupported MGF function.")).oid=n.signatureParameters.mgf.algorithmOid,a.name=s,a;if(s=r.mgf[s].create(r.md[i].create()),void 0===(i=o[n.signatureParameters.hash.algorithmOid])||void 0===r.md[i])throw(a=new Error("Unsupported RSASSA-PSS hash function.")).oid=n.signatureParameters.hash.algorithmOid,a.name=i,a;t=r.pss.create(r.md[i].create(),s,n.signatureParameters.saltLength)}return n.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function m(e){for(var t,n,s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){var c=(t=o[a]).value,u=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass)===i.Type.UTF8&&(c=r.util.encodeUtf8(c)),n=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,u,!1,c)])]),s.value.push(n)}return s}function w(e){for(var t,n=0;n<e.length;++n){if(void 0===(t=e[n]).name&&(t.type&&t.type in s.oids?t.name=s.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=s.oids[a[t.shortName]])),void 0===t.type){if(!t.name||!(t.name in s.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=s.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var r=0;r<t.extensions.length;++r)t.value.push(s.certificateExtensionToAsn1(b(t.extensions[r])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function b(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in s.oids&&(e.name=s.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in s.oids))throw(v=new Error("Extension ID not specified.")).extension=e,v;e.id=s.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var n=0,a=0,c=0;e.digitalSignature&&(a|=128,n=7),e.nonRepudiation&&(a|=64,n=6),e.keyEncipherment&&(a|=32,n=5),e.dataEncipherment&&(a|=16,n=4),e.keyAgreement&&(a|=8,n=3),e.keyCertSign&&(a|=4,n=2),e.cRLSign&&(a|=2,n=1),e.encipherOnly&&(a|=1,n=0),e.decipherOnly&&(c|=128,n=7);var u=String.fromCharCode(n);0!==c?u+=String.fromCharCode(a)+String.fromCharCode(c):0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var h in e)!0===e[h]&&(h in o?l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o[h]).getBytes())):-1!==h.indexOf(".")&&l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(h).getBytes())))}else if("nsCertType"===e.name){n=0,a=0;e.client&&(a|=128,n=7),e.server&&(a|=64,n=6),e.email&&(a|=32,n=5),e.objsign&&(a|=16,n=4),e.reserved&&(a|=8,n=3),e.sslCA&&(a|=4,n=2),e.emailCA&&(a|=2,n=1),e.objCA&&(a|=1,n=0);u=String.fromCharCode(n);0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var d=0;d<e.altNames.length;++d){u=(w=e.altNames[d]).value;if(7===w.type&&w.ip){if(null===(u=r.util.bytesFromIP(w.ip)))throw(v=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,v}else 8===w.type&&(u=w.oid?i.oidToDer(i.oidToDer(w.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,w.type,!1,u))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var p=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,p))}if(e.authorityCertIssuer){var y=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[m(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,y))}if(e.serialNumber){var g=r.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;var w,b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),E=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(d=0;d<e.altNames.length;++d){u=(w=e.altNames[d]).value;if(7===w.type&&w.ip){if(null===(u=r.util.bytesFromIP(w.ip)))throw(v=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,v}else 8===w.type&&(u=w.oid?i.oidToDer(i.oidToDer(w.oid)):i.oidToDer(u));E.value.push(i.create(i.Class.CONTEXT_SPECIFIC,w.type,!1,u))}b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[E])),l.push(b)}var v;if(void 0===e.value)throw(v=new Error("Extension value not specified.")).extension=e,v;return e}function E(e,t){if(e===o["RSASSA-PSS"]){var n=[];return void 0!==t.hash.algorithmOid&&n.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&n.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&n.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,n)}return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}function v(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var n=e.attributes,s=0;s<n.length;++s){var o=n[s],a=o.value,c=i.Type.UTF8;"valueTagClass"in o&&(c=o.valueTagClass),c===i.Type.UTF8&&(a=r.util.encodeUtf8(a));var u=!1;"valueConstructed"in o&&(u=o.valueConstructed);var l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,u,a)])]);t.value.push(l)}return t}s.certificateFromPem=function(e,t,n){var o=r.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(o.body,n);return s.certificateFromAsn1(c,t)},s.certificateToPem=function(e,t){var n={type:"CERTIFICATE",body:i.toDer(s.certificateToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},s.publicKeyFromPem=function(e){var t=r.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var n=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return s.publicKeyFromAsn1(o)},s.publicKeyToPem=function(e,t){var n={type:"PUBLIC KEY",body:i.toDer(s.publicKeyToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},s.publicKeyToRSAPublicKeyPem=function(e,t){var n={type:"RSA PUBLIC KEY",body:i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes()};return r.pem.encode(n,{maxline:t})},s.getPublicKeyFingerprint=function(e,t){var n,o=(t=t||{}).md||r.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":n=i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":n=i.toDer(s.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(n);var a=o.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},s.certificationRequestFromPem=function(e,t,n){var o=r.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(o.body,n);return s.certificationRequestFromAsn1(c,t)},s.certificationRequestToPem=function(e,t){var n={type:"CERTIFICATE REQUEST",body:i.toDer(s.certificationRequestToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},s.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){w([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,n){w(t),e.subject.attributes=t,delete e.subject.uniqueId,n&&(e.subject.uniqueId=n),e.subject.hash=null},e.setIssuer=function(t,n){w(t),e.issuer.attributes=t,delete e.issuer.uniqueId,n&&(e.issuer.uniqueId=n),e.issuer.hash=null},e.setExtensions=function(t){for(var n=0;n<t.length;++n)b(t[n],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var n,r=null,i=0;null===r&&i<e.extensions.length;++i)n=e.extensions[i],(t.id&&n.id===t.id||t.name&&n.name===t.name)&&(r=n);return r},e.sign=function(t,n){e.md=n||r.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=s.getTBSCertificate(e);var u=i.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var n=!1;if(!e.issued(t)){var r=t.issuer,o=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=o.attributes,a.actualIssuer=r.attributes,a}var c=t.md;if(null===c){c=y({signatureOid:t.signatureOid,type:"certificate"});var u=t.tbsCertificate||s.getTBSCertificate(t),l=i.toDer(u);c.update(l.getBytes())}return null!==c&&(n=g({certificate:e,md:c,signature:t.signature})),n},e.isIssuer=function(t){var n=!1,r=e.issuer,i=t.subject;if(r.hash&&i.hash)n=r.hash===i.hash;else if(r.attributes.length===i.attributes.length){var s,o;n=!0;for(var a=0;n&&a<r.attributes.length;++a)s=r.attributes[a],o=i.attributes[a],s.type===o.type&&s.value===o.value||(n=!1)}return n},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return s.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o.subjectKeyIdentifier,n=0;n<e.extensions.length;++n){var i=e.extensions[n];if(i.id===t){var s=e.generateSubjectKeyIdentifier().getBytes();return r.util.hexToBytes(i.subjectKeyIdentifier)===s}}return!1},e},s.certificateFromAsn1=function(e,t){var n={},o=[];if(!i.validate(e,u,n,o)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=o,a}if(i.derToOid(n.publicKeyOid)!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=s.createCertificate();c.version=n.certVersion?n.certVersion.charCodeAt(0):0;var l=r.util.createBuffer(n.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=r.asn1.derToOid(n.certSignatureOid),c.signatureParameters=p(c.signatureOid,n.certSignatureParams,!0),c.siginfo.algorithmOid=r.asn1.derToOid(n.certinfoSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,n.certinfoSignatureParams,!1),c.signature=n.certSignature;var h=[];if(void 0!==n.certValidity1UTCTime&&h.push(i.utcTimeToDate(n.certValidity1UTCTime)),void 0!==n.certValidity2GeneralizedTime&&h.push(i.generalizedTimeToDate(n.certValidity2GeneralizedTime)),void 0!==n.certValidity3UTCTime&&h.push(i.utcTimeToDate(n.certValidity3UTCTime)),void 0!==n.certValidity4GeneralizedTime&&h.push(i.generalizedTimeToDate(n.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=h[0],c.validity.notAfter=h[1],c.tbsCertificate=n.tbsCertificate,t){c.md=y({signatureOid:c.signatureOid,type:"certificate"});var d=i.toDer(c.tbsCertificate);c.md.update(d.getBytes())}var g=r.md.sha1.create(),m=i.toDer(n.certIssuer);g.update(m.getBytes()),c.issuer.getField=function(e){return f(c.issuer,e)},c.issuer.addField=function(e){w([e]),c.issuer.attributes.push(e)},c.issuer.attributes=s.RDNAttributesAsArray(n.certIssuer),n.certIssuerUniqueId&&(c.issuer.uniqueId=n.certIssuerUniqueId),c.issuer.hash=g.digest().toHex();var b=r.md.sha1.create(),E=i.toDer(n.certSubject);return b.update(E.getBytes()),c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){w([e]),c.subject.attributes.push(e)},c.subject.attributes=s.RDNAttributesAsArray(n.certSubject),n.certSubjectUniqueId&&(c.subject.uniqueId=n.certSubjectUniqueId),c.subject.hash=b.digest().toHex(),n.certExtensions?c.extensions=s.certificateExtensionsFromAsn1(n.certExtensions):c.extensions=[],c.publicKey=s.publicKeyFromAsn1(n.subjectPublicKeyInfo),c},s.certificateExtensionsFromAsn1=function(e){for(var t=[],n=0;n<e.value.length;++n)for(var r=e.value[n],i=0;i<r.value.length;++i)t.push(s.certificateExtensionFromAsn1(r.value[i]));return t},s.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var n=0,s=0;(c=i.fromDer(t.value)).value.length>1&&(n=c.value.charCodeAt(1),s=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=128==(128&n),t.nonRepudiation=64==(64&n),t.keyEncipherment=32==(32&n),t.dataEncipherment=16==(16&n),t.keyAgreement=8==(8&n),t.keyCertSign=4==(4&n),t.cRLSign=2==(2&n),t.encipherOnly=1==(1&n),t.decipherOnly=128==(128&s)}else if("basicConstraints"===t.name){(c=i.fromDer(t.value)).value.length>0&&c.value[0].type===i.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var a=null;c.value.length>0&&c.value[0].type===i.Type.INTEGER?a=c.value[0].value:c.value.length>1&&(a=c.value[1].value),null!==a&&(t.pathLenConstraint=i.derToInteger(a))}else if("extKeyUsage"===t.name)for(var c=i.fromDer(t.value),u=0;u<c.value.length;++u){var l=i.derToOid(c.value[u].value);l in o?t[o[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){n=0;(c=i.fromDer(t.value)).value.length>1&&(n=c.value.charCodeAt(1)),t.client=128==(128&n),t.server=64==(64&n),t.email=32==(32&n),t.objsign=16==(16&n),t.reserved=8==(8&n),t.sslCA=4==(4&n),t.emailCA=2==(2&n),t.objCA=1==(1&n)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];c=i.fromDer(t.value);for(var d=0;d<c.value.length;++d){var f={type:(h=c.value[d]).type,value:h.value};switch(t.altNames.push(f),h.type){case 1:case 2:case 6:break;case 7:f.ip=r.util.bytesToIP(h.value);break;case 8:f.oid=i.derToOid(h.value)}}}else if("subjectKeyIdentifier"===t.name){c=i.fromDer(t.value);t.subjectKeyIdentifier=r.util.bytesToHex(c.value)}return t},s.certificationRequestFromAsn1=function(e,t){var n={},o=[];if(!i.validate(e,d,n,o)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=o,a}if(i.derToOid(n.publicKeyOid)!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=s.createCertificationRequest();if(c.version=n.csrVersion?n.csrVersion.charCodeAt(0):0,c.signatureOid=r.asn1.derToOid(n.csrSignatureOid),c.signatureParameters=p(c.signatureOid,n.csrSignatureParams,!0),c.siginfo.algorithmOid=r.asn1.derToOid(n.csrSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,n.csrSignatureParams,!1),c.signature=n.csrSignature,c.certificationRequestInfo=n.certificationRequestInfo,t){c.md=y({signatureOid:c.signatureOid,type:"certification request"});var u=i.toDer(c.certificationRequestInfo);c.md.update(u.getBytes())}var l=r.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){w([e]),c.subject.attributes.push(e)},c.subject.attributes=s.RDNAttributesAsArray(n.certificationRequestInfoSubject,l),c.subject.hash=l.digest().toHex(),c.publicKey=s.publicKeyFromAsn1(n.subjectPublicKeyInfo),c.getAttribute=function(e){return f(c,e)},c.addAttribute=function(e){w([e]),c.attributes.push(e)},c.attributes=s.CRIAttributesAsArray(n.certificationRequestInfoAttributes||[]),c},s.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){w([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){w(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){w(t),e.attributes=t},e.sign=function(t,n){e.md=n||r.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=s.getCertificationRequestInfo(e);var u=i.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,n=e.md;if(null===n){n=y({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||s.getCertificationRequestInfo(e),o=i.toDer(r);n.update(o.getBytes())}return null!==n&&(t=g({certificate:e,md:n,signature:e.signature})),t},e};var _=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z");function R(e){return e>=_&&e<S?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(e))}s.getTBSCertificate=function(e){var t=R(e.validity.notBefore),n=R(e.validity.notAfter),o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,r.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),E(e.siginfo.algorithmOid,e.siginfo.parameters)]),m(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,n]),m(e.subject),s.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(s.certificateExtensionsToAsn1(e.extensions)),o},s.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),m(e.subject),s.publicKeyToAsn1(e.publicKey),v(e)])},s.distinguishedNameToAsn1=function(e){return m(e)},s.certificateToAsn1=function(e){var t=e.tbsCertificate||s.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),E(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),n=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(n);for(var r=0;r<e.length;++r)n.value.push(s.certificateExtensionToAsn1(e[r]));return t},s.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var n=e.value;return"string"!=typeof e.value&&(n=i.toDer(n).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,n)),t},s.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||s.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),E(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.createCaStore=function(e){var t={certs:{}};function n(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=r.md.sha1.create();e.attributes=s.RDNAttributesAsArray(m(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return n(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=r.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var n=t.certs[e.subject.hash];r.util.isArray(n)||(n=[n]),n.push(e),t.certs[e.subject.hash]=n}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=r.pki.certificateFromPem(e));var t=n(e.subject);if(!t)return!1;r.util.isArray(t)||(t=[t]);for(var o=i.toDer(s.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(o===i.toDer(s.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var n in t.certs)if(t.certs.hasOwnProperty(n)){var i=t.certs[n];if(r.util.isArray(i))for(var s=0;s<i.length;++s)e.push(i[s]);else e.push(i)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=r.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var c=n(e.subject);if(!r.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var u=i.toDer(s.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){u===i.toDer(s.certificateToAsn1(c[l])).getBytes()&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},s.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},s.verifyCertificateChain=function(e,t,n){"function"==typeof n&&(n={verify:n}),n=n||{};var i=(t=t.slice(0)).slice(0),o=n.validityCheckDate;void 0===o&&(o=new Date);var a=!0,c=null,u=0;do{var l=t.shift(),h=null,d=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:s.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),null===c){if(null===(h=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(d=!0,h=l),h){var f=h;r.util.isArray(f)||(f=[f]);for(var p=!1;!p&&f.length>0;){h=f.shift();try{p=h.verify(l)}catch(e){}}p||(c={message:"Certificate signature is invalid.",error:s.certificateError.bad_certificate})}null!==c||h&&!d||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:s.certificateError.unknown_ca})}if(null===c&&h&&!l.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:s.certificateError.bad_certificate}),null===c)for(var y={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<l.extensions.length;++g){var m=l.extensions[g];m.critical&&!(m.name in y)&&(c={message:"Certificate has an unsupported critical extension.",error:s.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!h||d))){var w=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==w||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:s.certificateError.bad_certificate})),null!==c||null===w||w.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:s.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in w)u-1>w.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:s.certificateError.bad_certificate})}var E=null===c||c.error,v=n.verify?n.verify(E,u,i):E;if(!0!==v)throw!0===E&&(c={message:"The application rejected the certificate.",error:s.certificateError.bad_certificate}),(v||0===v)&&("object"!=typeof v||r.util.isArray(v)?"string"==typeof v&&(c.error=v):(v.message&&(c.message=v.message),v.error&&(c.error=v.error))),c;c=null,a=!1,++u}while(t.length>0);return!0}},35103:function(e,t,n){const r=n(91607),i=n(50603);e.exports=class{constructor(){this._buffer=new r,this._waitingConsumers=new r}push(e){const{promise:t,resolve:n}=i();return this._buffer.push({chunk:e,resolve:n}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=i();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},50603:function(e){"use strict";e.exports=()=>{const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}},78939:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,o),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},88424:function(e,t,n){"use strict";n.d(t,{ZP:function(){return mn}});function r(e){let t=e.length;for(;--t>=0;)e[t]=0}const i=256,s=286,o=30,a=15,c=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),u=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new Array(576);r(d);const f=new Array(60);r(f);const p=new Array(512);r(p);const y=new Array(256);r(y);const g=new Array(29);r(g);const m=new Array(o);function w(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let b,E,v;function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}r(m);const S=e=>e<256?p[e]:p[256+(e>>>7)],R=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},A=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,R(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},I=(e,t,n)=>{A(e,n[2*t],n[2*t+1])},T=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},C=(e,t,n)=>{const r=new Array(16);let i,s,o=0;for(i=1;i<=a;i++)o=o+n[i-1]<<1,r[i]=o;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=T(r[t]++,t))}},P=e=>{let t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},k=e=>{e.bi_valid>8?R(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},N=(e,t,n,r)=>{const i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},x=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&N(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!N(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},D=(e,t,n)=>{let r,s,o,a,l=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+l++],r+=(255&e.pending_buf[e.sym_buf+l++])<<8,s=e.pending_buf[e.sym_buf+l++],0===r?I(e,s,t):(o=y[s],I(e,o+i+1,t),a=c[o],0!==a&&(s-=g[o],A(e,s,a)),r--,o=S(r),I(e,o,n),a=u[o],0!==a&&(r-=m[o],A(e,r,a)))}while(l<e.sym_next);I(e,256,t)},L=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,c,u,l=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)x(e,n,o);u=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],x(e,n,1),c=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=c,n[2*u]=n[2*o]+n[2*c],e.depth[u]=(e.depth[o]>=e.depth[c]?e.depth[o]:e.depth[c])+1,n[2*o+1]=n[2*c+1]=u,e.heap[1]=u++,x(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,u=t.stat_desc.max_length;let l,h,d,f,p,y,g=0;for(f=0;f<=a;f++)e.bl_count[f]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)h=e.heap[l],f=n[2*n[2*h+1]+1]+1,f>u&&(f=u,g++),n[2*h+1]=f,h>r||(e.bl_count[f]++,p=0,h>=c&&(p=o[h-c]),y=n[2*h],e.opt_len+=y*(f+p),s&&(e.static_len+=y*(i[2*h+1]+p)));if(0!==g){do{for(f=u-1;0===e.bl_count[f];)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[u]--,g-=2}while(g>0);for(f=u;0!==f;f--)for(h=e.bl_count[f];0!==h;)d=e.heap[--l],d>r||(n[2*d+1]!==f&&(e.opt_len+=(f-n[2*d+1])*n[2*d],n[2*d+1]=f),h--)}})(e,t),C(n,l,e.bl_count)},O=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,c=7,u=4;for(0===o&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++a<c&&i===o||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=i,0===o?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4))},U=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,c=7,u=4;for(0===o&&(c=138,u=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++a<c&&i===o)){if(a<u)do{I(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(I(e,i,e.bl_tree),a--),I(e,16,e.bl_tree),A(e,a-3,2)):a<=10?(I(e,17,e.bl_tree),A(e,a-3,3)):(I(e,18,e.bl_tree),A(e,a-11,7));a=0,s=i,0===o?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4)}};let M=!1;const B=(e,t,n,r)=>{A(e,0+(r?1:0),3),k(e),R(e,n),R(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var z=(e,t,n,r)=>{let s,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<i;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),L(e,e.l_desc),L(e,e.d_desc),a=(e=>{let t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),L(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=n+5,n+4<=s&&-1!==t?B(e,t,n,r):4===e.strategy||o===s?(A(e,2+(r?1:0),3),D(e,d,f)):(A(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(A(e,t-257,5),A(e,n-1,5),A(e,r-4,4),i=0;i<r;i++)A(e,e.bl_tree[2*h[i]+1],3);U(e,e.dyn_ltree,t-1),U(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),D(e,e.dyn_ltree,e.dyn_dtree)),P(e),r&&k(e)},V={_tr_init:e=>{M||((()=>{let e,t,n,r,i;const h=new Array(16);for(n=0,r=0;r<28;r++)for(g[r]=n,e=0;e<1<<c[r];e++)y[n++]=r;for(y[n-1]=r,i=0,r=0;r<16;r++)for(m[r]=i,e=0;e<1<<u[r];e++)p[i++]=r;for(i>>=7;r<o;r++)for(m[r]=i<<7,e=0;e<1<<u[r]-7;e++)p[256+i++]=r;for(t=0;t<=a;t++)h[t]=0;for(e=0;e<=143;)d[2*e+1]=8,e++,h[8]++;for(;e<=255;)d[2*e+1]=9,e++,h[9]++;for(;e<=279;)d[2*e+1]=7,e++,h[7]++;for(;e<=287;)d[2*e+1]=8,e++,h[8]++;for(C(d,287,h),e=0;e<o;e++)f[2*e+1]=5,f[2*e]=T(e,5);b=new w(d,c,257,s,a),E=new w(f,u,0,o,a),v=new w(new Array(0),l,0,19,7)})(),M=!0),e.l_desc=new _(e.dyn_ltree,b),e.d_desc=new _(e.dyn_dtree,E),e.bl_desc=new _(e.bl_tree,v),e.bi_buf=0,e.bi_valid=0,P(e)},_tr_stored_block:B,_tr_flush_block:z,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(y[n]+i+1)]++,e.dyn_dtree[2*S(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{A(e,2,3),I(e,256,d),(e=>{16===e.bi_valid?(R(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var $=(e,t,n,r)=>{let i=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+t[r++]|0,s=s+i|0}while(--o);i%=65521,s%=65521}return i|s<<16|0};const F=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var j=(e,t,n,r)=>{const i=F,s=r+n;e^=-1;for(let n=r;n<s;n++)e=e>>>8^i[255&(e^t[n])];return-1^e},K={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},q={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:H,_tr_stored_block:G,_tr_flush_block:Z,_tr_tally:W,_tr_align:Q}=V,{Z_NO_FLUSH:Y,Z_PARTIAL_FLUSH:J,Z_FULL_FLUSH:X,Z_FINISH:ee,Z_BLOCK:te,Z_OK:ne,Z_STREAM_END:re,Z_STREAM_ERROR:ie,Z_DATA_ERROR:se,Z_BUF_ERROR:oe,Z_DEFAULT_COMPRESSION:ae,Z_FILTERED:ce,Z_HUFFMAN_ONLY:ue,Z_RLE:le,Z_FIXED:he,Z_DEFAULT_STRATEGY:de,Z_UNKNOWN:fe,Z_DEFLATED:pe}=q,ye=258,ge=262,me=42,we=113,be=666,Ee=(e,t)=>(e.msg=K[t],t),ve=e=>2*e-(e>4?9:0),_e=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Se=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let Re=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Ae=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Ie=(e,t)=>{Z(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ae(e.strm)},Te=(e,t)=>{e.pending_buf[e.pending++]=t},Ce=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Pe=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=$(e.adler,t,i,n):2===e.state.wrap&&(e.adler=j(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},ke=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-ge?e.strstart-(e.w_size-ge):0,u=e.window,l=e.w_mask,h=e.prev,d=e.strstart+ye;let f=u[s+o-1],p=u[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,u[n+o]===p&&u[n+o-1]===f&&u[n]===u[s]&&u[++n]===u[s+1]){s+=2,n++;do{}while(u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&s<d);if(r=ye-(d-s),s=d-ye,r>o){if(e.match_start=t,o=r,r>=a)break;f=u[s+o-1],p=u[s+o]}}}while((t=h[t&l])>c&&0!=--i);return o<=e.lookahead?o:e.lookahead},Ne=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ge)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Se(e),r+=t),0===e.strm.avail_in)break;if(n=Pe(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Re(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Re(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<ge&&0!==e.strm.avail_in)},xe=(e,t)=>{let n,r,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,a=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<s&&(0===n&&t!==ee||t===Y||n!==r+e.strm.avail_in))break;o=t===ee&&n===r+e.strm.avail_in?1:0,G(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Ae(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Pe(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===o);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==Y&&t!==ee&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Pe(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,s=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=s||(r||t===ee)&&t!==Y&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,o=t===ee&&0===e.strm.avail_in&&n===r?1:0,G(e,e.block_start,n,o),e.block_start+=n,Ae(e.strm)),o?3:1)},De=(e,t)=>{let n,r;for(;;){if(e.lookahead<ge){if(Ne(e),e.lookahead<ge&&t===Y)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Re(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-ge&&(e.match_length=ke(e,n)),e.match_length>=3)if(r=W(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Re(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Re(e,e.ins_h,e.window[e.strstart+1]);else r=W(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Ie(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ee?(Ie(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ie(e,!1),0===e.strm.avail_out)?1:2},Le=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<ge){if(Ne(e),e.lookahead<ge&&t===Y)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Re(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ge&&(e.match_length=ke(e,n),e.match_length<=5&&(e.strategy===ce||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=W(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Re(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Ie(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=W(e,0,e.window[e.strstart-1]),r&&Ie(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=W(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ee?(Ie(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ie(e,!1),0===e.strm.avail_out)?1:2};function Oe(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const Ue=[new Oe(0,0,0,0,xe),new Oe(4,4,8,4,De),new Oe(4,5,16,8,De),new Oe(4,6,32,32,De),new Oe(4,4,16,16,Le),new Oe(8,16,32,32,Le),new Oe(8,16,128,128,Le),new Oe(8,32,128,256,Le),new Oe(32,128,258,1024,Le),new Oe(32,258,258,4096,Le)];function Me(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),_e(this.dyn_ltree),_e(this.dyn_dtree),_e(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),_e(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),_e(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Be=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==me&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==we&&t.status!==be?1:0},ze=e=>{if(Be(e))return Ee(e,ie);e.total_in=e.total_out=0,e.data_type=fe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?me:we,e.adler=2===t.wrap?0:1,t.last_flush=-2,H(t),ne},Ve=e=>{const t=ze(e);var n;return t===ne&&((n=e.state).window_size=2*n.w_size,_e(n.head),n.max_lazy_match=Ue[n.level].max_lazy,n.good_match=Ue[n.level].good_length,n.nice_match=Ue[n.level].nice_length,n.max_chain_length=Ue[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},$e=(e,t,n,r,i,s)=>{if(!e)return ie;let o=1;if(t===ae&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==pe||r<8||r>15||t<0||t>9||s<0||s>he||8===r&&1!==o)return Ee(e,ie);8===r&&(r=9);const a=new Me;return e.state=a,a.strm=e,a.status=me,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=s,a.method=n,Ve(e)};var Fe={deflateInit:(e,t)=>$e(e,t,pe,15,8,de),deflateInit2:$e,deflateReset:Ve,deflateResetKeep:ze,deflateSetHeader:(e,t)=>Be(e)||2!==e.state.wrap?ie:(e.state.gzhead=t,ne),deflate:(e,t)=>{if(Be(e)||t>te||t<0)return e?Ee(e,ie):ie;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===be&&t!==ee)return Ee(e,0===e.avail_out?oe:ie);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Ae(e),0===e.avail_out)return n.last_flush=-1,ne}else if(0===e.avail_in&&ve(t)<=ve(r)&&t!==ee)return Ee(e,oe);if(n.status===be&&0!==e.avail_in)return Ee(e,oe);if(n.status===me&&0===n.wrap&&(n.status=we),n.status===me){let t=pe+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=ue||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Ce(n,t),0!==n.strstart&&(Ce(n,e.adler>>>16),Ce(n,65535&e.adler)),e.adler=1,n.status=we,Ae(e),0!==n.pending)return n.last_flush=-1,ne}if(57===n.status)if(e.adler=0,Te(n,31),Te(n,139),Te(n,8),n.gzhead)Te(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Te(n,255&n.gzhead.time),Te(n,n.gzhead.time>>8&255),Te(n,n.gzhead.time>>16&255),Te(n,n.gzhead.time>>24&255),Te(n,9===n.level?2:n.strategy>=ue||n.level<2?4:0),Te(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Te(n,255&n.gzhead.extra.length),Te(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=j(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Te(n,0),Te(n,0),Te(n,0),Te(n,0),Te(n,0),Te(n,9===n.level?2:n.strategy>=ue||n.level<2?4:0),Te(n,3),n.status=we,Ae(e),0!==n.pending)return n.last_flush=-1,ne;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=j(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,Ae(e),0!==n.pending)return n.last_flush=-1,ne;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=j(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=j(e.adler,n.pending_buf,n.pending-r,r)),Ae(e),0!==n.pending)return n.last_flush=-1,ne;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Te(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=j(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=j(e.adler,n.pending_buf,n.pending-r,r)),Ae(e),0!==n.pending)return n.last_flush=-1,ne;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Te(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=j(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Ae(e),0!==n.pending))return n.last_flush=-1,ne;Te(n,255&e.adler),Te(n,e.adler>>8&255),e.adler=0}if(n.status=we,Ae(e),0!==n.pending)return n.last_flush=-1,ne}if(0!==e.avail_in||0!==n.lookahead||t!==Y&&n.status!==be){let r=0===n.level?xe(n,t):n.strategy===ue?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Ne(e),0===e.lookahead)){if(t===Y)return 1;break}if(e.match_length=0,n=W(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ie(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(Ie(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ie(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===le?((e,t)=>{let n,r,i,s;const o=e.window;for(;;){if(e.lookahead<=ye){if(Ne(e),e.lookahead<=ye&&t===Y)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){s=e.strstart+ye;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);e.match_length=ye-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=W(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=W(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ie(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(Ie(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ie(e,!1),0===e.strm.avail_out)?1:2})(n,t):Ue[n.level].func(n,t);if(3!==r&&4!==r||(n.status=be),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),ne;if(2===r&&(t===J?Q(n):t!==te&&(G(n,0,0,!1),t===X&&(_e(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Ae(e),0===e.avail_out))return n.last_flush=-1,ne}return t!==ee?ne:n.wrap<=0?re:(2===n.wrap?(Te(n,255&e.adler),Te(n,e.adler>>8&255),Te(n,e.adler>>16&255),Te(n,e.adler>>24&255),Te(n,255&e.total_in),Te(n,e.total_in>>8&255),Te(n,e.total_in>>16&255),Te(n,e.total_in>>24&255)):(Ce(n,e.adler>>>16),Ce(n,65535&e.adler)),Ae(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?ne:re)},deflateEnd:e=>{if(Be(e))return ie;const t=e.state.status;return e.state=null,t===we?Ee(e,se):ne},deflateSetDictionary:(e,t)=>{let n=t.length;if(Be(e))return ie;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==me||r.lookahead)return ie;if(1===i&&(e.adler=$(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(_e(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Ne(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Re(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Ne(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,r.wrap=i,ne},deflateInfo:"pako deflate (from Nodeca project)"};const je=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ke={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)je(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n}};let qe=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){qe=!1}const He=new Uint8Array(256);for(let e=0;e<256;e++)He[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;He[254]=He[254]=1;var Ge={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,s,o=e.length,a=0;for(i=0;i<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const s=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){s[i++]=t;continue}let o=He[t];if(o>4)s[i++]=65533,r+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&r<n;)t=t<<6|63&e[r++],o--;o>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&qe)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(s,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+He[e[n]]>t?n:t}};var Ze=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const We=Object.prototype.toString,{Z_NO_FLUSH:Qe,Z_SYNC_FLUSH:Ye,Z_FULL_FLUSH:Je,Z_FINISH:Xe,Z_OK:et,Z_STREAM_END:tt,Z_DEFAULT_COMPRESSION:nt,Z_DEFAULT_STRATEGY:rt,Z_DEFLATED:it}=q;function st(e){this.options=Ke.assign({level:nt,method:it,chunkSize:16384,windowBits:15,memLevel:8,strategy:rt},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ze,this.strm.avail_out=0;let n=Fe.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==et)throw new Error(K[n]);if(t.header&&Fe.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Ge.string2buf(t.dictionary):"[object ArrayBuffer]"===We.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Fe.deflateSetDictionary(this.strm,e),n!==et)throw new Error(K[n]);this._dict_set=!0}}function ot(e,t){const n=new st(t);if(n.push(e,!0),n.err)throw n.msg||K[n.err];return n.result}st.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Xe:Qe,"string"==typeof e?n.input=Ge.string2buf(e):"[object ArrayBuffer]"===We.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===Ye||s===Je)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=Fe.deflate(n,s),i===tt)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=Fe.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===et;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},st.prototype.onData=function(e){this.chunks.push(e)},st.prototype.onEnd=function(e){e===et&&(this.result=Ke.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var at={Deflate:st,deflate:ot,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ot(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ot(e,t)},constants:q};const ct=16209;var ut=function(e,t){let n,r,i,s,o,a,c,u,l,h,d,f,p,y,g,m,w,b,E,v,_,S,R,A;const I=e.state;n=e.next_in,R=e.input,r=n+(e.avail_in-5),i=e.next_out,A=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),a=I.dmax,c=I.wsize,u=I.whave,l=I.wnext,h=I.window,d=I.hold,f=I.bits,p=I.lencode,y=I.distcode,g=(1<<I.lenbits)-1,m=(1<<I.distbits)-1;e:do{f<15&&(d+=R[n++]<<f,f+=8,d+=R[n++]<<f,f+=8),w=p[d&g];t:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,0===b)A[i++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(d&(1<<b)-1)];continue t}if(32&b){I.mode=16191;break e}e.msg="invalid literal/length code",I.mode=ct;break e}E=65535&w,b&=15,b&&(f<b&&(d+=R[n++]<<f,f+=8),E+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=R[n++]<<f,f+=8,d+=R[n++]<<f,f+=8),w=y[d&m];n:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0==(64&b)){w=y[(65535&w)+(d&(1<<b)-1)];continue n}e.msg="invalid distance code",I.mode=ct;break e}if(v=65535&w,b&=15,f<b&&(d+=R[n++]<<f,f+=8,f<b&&(d+=R[n++]<<f,f+=8)),v+=d&(1<<b)-1,v>a){e.msg="invalid distance too far back",I.mode=ct;break e}if(d>>>=b,f-=b,b=i-s,v>b){if(b=v-b,b>u&&I.sane){e.msg="invalid distance too far back",I.mode=ct;break e}if(_=0,S=h,0===l){if(_+=c-b,b<E){E-=b;do{A[i++]=h[_++]}while(--b);_=i-v,S=A}}else if(l<b){if(_+=c+l-b,b-=l,b<E){E-=b;do{A[i++]=h[_++]}while(--b);if(_=0,l<E){b=l,E-=b;do{A[i++]=h[_++]}while(--b);_=i-v,S=A}}}else if(_+=l-b,b<E){E-=b;do{A[i++]=h[_++]}while(--b);_=i-v,S=A}for(;E>2;)A[i++]=S[_++],A[i++]=S[_++],A[i++]=S[_++],E-=3;E&&(A[i++]=S[_++],E>1&&(A[i++]=S[_++]))}else{_=i-v;do{A[i++]=A[_++],A[i++]=A[_++],A[i++]=A[_++],E-=3}while(E>2);E&&(A[i++]=A[_++],E>1&&(A[i++]=A[_++]))}break}}break}}while(n<r&&i<o);E=f>>3,n-=E,f-=E<<3,d&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<o?o-i+257:257-(i-o),I.hold=d,I.bits=f};const lt=15,ht=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ft=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var yt=(e,t,n,r,i,s,o,a)=>{const c=a.bits;let u,l,h,d,f,p,y=0,g=0,m=0,w=0,b=0,E=0,v=0,_=0,S=0,R=0,A=null;const I=new Uint16Array(16),T=new Uint16Array(16);let C,P,k,N=null;for(y=0;y<=lt;y++)I[y]=0;for(g=0;g<r;g++)I[t[n+g]]++;for(b=c,w=lt;w>=1&&0===I[w];w--);if(b>w&&(b=w),0===w)return i[s++]=20971520,i[s++]=20971520,a.bits=1,0;for(m=1;m<w&&0===I[m];m++);for(b<m&&(b=m),_=1,y=1;y<=lt;y++)if(_<<=1,_-=I[y],_<0)return-1;if(_>0&&(0===e||1!==w))return-1;for(T[1]=0,y=1;y<lt;y++)T[y+1]=T[y]+I[y];for(g=0;g<r;g++)0!==t[n+g]&&(o[T[t[n+g]]++]=g);if(0===e?(A=N=o,p=20):1===e?(A=ht,N=dt,p=257):(A=ft,N=pt,p=0),R=0,g=0,y=m,f=s,E=b,v=0,h=-1,S=1<<b,d=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){C=y-v,o[g]+1<p?(P=0,k=o[g]):o[g]>=p?(P=N[o[g]-p],k=A[o[g]-p]):(P=96,k=0),u=1<<y-v,l=1<<E,m=l;do{l-=u,i[f+(R>>v)+l]=C<<24|P<<16|k|0}while(0!==l);for(u=1<<y-1;R&u;)u>>=1;if(0!==u?(R&=u-1,R+=u):R=0,g++,0==--I[y]){if(y===w)break;y=t[n+o[g]]}if(y>b&&(R&d)!==h){for(0===v&&(v=b),f+=m,E=y-v,_=1<<E;E+v<w&&(_-=I[E+v],!(_<=0));)E++,_<<=1;if(S+=1<<E,1===e&&S>852||2===e&&S>592)return 1;h=R&d,i[h]=b<<24|E<<16|f-s|0}}return 0!==R&&(i[f+R]=y-v<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:gt,Z_BLOCK:mt,Z_TREES:wt,Z_OK:bt,Z_STREAM_END:Et,Z_NEED_DICT:vt,Z_STREAM_ERROR:_t,Z_DATA_ERROR:St,Z_MEM_ERROR:Rt,Z_BUF_ERROR:At,Z_DEFLATED:It}=q,Tt=16180,Ct=16190,Pt=16191,kt=16192,Nt=16194,xt=16199,Dt=16200,Lt=16206,Ot=16209,Ut=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Mt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bt=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Tt||t.mode>16211?1:0},zt=e=>{if(Bt(e))return _t;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Tt,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,bt},Vt=e=>{if(Bt(e))return _t;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,zt(e)},$t=(e,t)=>{let n;if(Bt(e))return _t;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_t:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Vt(e))},Ft=(e,t)=>{if(!e)return _t;const n=new Mt;e.state=n,n.strm=e,n.window=null,n.mode=Tt;const r=$t(e,t);return r!==bt&&(e.state=null),r};let jt,Kt,qt=!0;const Ht=e=>{if(qt){jt=new Int32Array(512),Kt=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(yt(1,e.lens,0,288,jt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;yt(2,e.lens,0,32,Kt,0,e.work,{bits:5}),qt=!1}e.lencode=jt,e.lenbits=9,e.distcode=Kt,e.distbits=5},Gt=(e,t,n,r)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),(r-=i)?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0};var Zt={inflateReset:Vt,inflateReset2:$t,inflateResetKeep:zt,inflateInit:e=>Ft(e,15),inflateInit2:Ft,inflate:(e,t)=>{let n,r,i,s,o,a,c,u,l,h,d,f,p,y,g,m,w,b,E,v,_,S,R=0;const A=new Uint8Array(4);let I,T;const C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bt(e)||!e.output||!e.input&&0!==e.avail_in)return _t;n=e.state,n.mode===Pt&&(n.mode=kt),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,u=n.hold,l=n.bits,h=a,d=c,S=bt;e:for(;;)switch(n.mode){case Tt:if(0===n.wrap){n.mode=kt;break}for(;l<16;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,A[0]=255&u,A[1]=u>>>8&255,n.check=j(n.check,A,2,0),u=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=Ot;break}if((15&u)!==It){e.msg="unknown compression method",n.mode=Ot;break}if(u>>>=4,l-=4,_=8+(15&u),0===n.wbits&&(n.wbits=_),_>15||_>n.wbits){e.msg="invalid window size",n.mode=Ot;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&u?16189:Pt,u=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(n.flags=u,(255&n.flags)!==It){e.msg="unknown compression method",n.mode=Ot;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Ot;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(A[0]=255&u,A[1]=u>>>8&255,n.check=j(n.check,A,2,0)),u=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(A[0]=255&u,A[1]=u>>>8&255,A[2]=u>>>16&255,A[3]=u>>>24&255,n.check=j(n.check,A,4,0)),u=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(A[0]=255&u,A[1]=u>>>8&255,n.check=j(n.check,A,2,0)),u=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(A[0]=255&u,A[1]=u>>>8&255,n.check=j(n.check,A,2,0)),u=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>a&&(f=a),f&&(n.head&&(_=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+f),_)),512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,f,s)),a-=f,s+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break e;f=0;do{_=r[s+f++],n.head&&_&&n.length<65536&&(n.head.name+=String.fromCharCode(_))}while(_&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,f,s)),a-=f,s+=f,_)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break e;f=0;do{_=r[s+f++],n.head&&_&&n.length<65536&&(n.head.comment+=String.fromCharCode(_))}while(_&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,f,s)),a-=f,s+=f,_)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(4&n.wrap&&u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Ot;break}u=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Pt;break;case 16189:for(;l<32;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}e.adler=n.check=Ut(u),u=0,l=0,n.mode=Ct;case Ct:if(0===n.havedict)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=u,n.bits=l,vt;e.adler=n.check=1,n.mode=Pt;case Pt:if(t===mt||t===wt)break e;case kt:if(n.last){u>>>=7&l,l-=7&l,n.mode=Lt;break}for(;l<3;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}switch(n.last=1&u,u>>>=1,l-=1,3&u){case 0:n.mode=16193;break;case 1:if(Ht(n),n.mode=xt,t===wt){u>>>=2,l-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Ot}u>>>=2,l-=2;break;case 16193:for(u>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Ot;break}if(n.length=65535&u,u=0,l=0,n.mode=Nt,t===wt)break e;case Nt:n.mode=16195;case 16195:if(f=n.length,f){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;i.set(r.subarray(s,s+f),o),a-=f,s+=f,c-=f,o+=f,n.length-=f;break}n.mode=Pt;break;case 16196:for(;l<14;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Ot;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.lens[C[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[C[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},S=yt(0,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,S){e.msg="invalid code lengths set",n.mode=Ot;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;R=n.lencode[u&(1<<n.lenbits)-1],g=R>>>24,m=R>>>16&255,w=65535&R,!(g<=l);){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(w<16)u>>>=g,l-=g,n.lens[n.have++]=w;else{if(16===w){for(T=g+2;l<T;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(u>>>=g,l-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=Ot;break}_=n.lens[n.have-1],f=3+(3&u),u>>>=2,l-=2}else if(17===w){for(T=g+3;l<T;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}u>>>=g,l-=g,_=0,f=3+(7&u),u>>>=3,l-=3}else{for(T=g+7;l<T;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}u>>>=g,l-=g,_=0,f=11+(127&u),u>>>=7,l-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Ot;break}for(;f--;)n.lens[n.have++]=_}}if(n.mode===Ot)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Ot;break}if(n.lenbits=9,I={bits:n.lenbits},S=yt(1,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,S){e.msg="invalid literal/lengths set",n.mode=Ot;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},S=yt(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,S){e.msg="invalid distances set",n.mode=Ot;break}if(n.mode=xt,t===wt)break e;case xt:n.mode=Dt;case Dt:if(a>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=u,n.bits=l,ut(e,d),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,r=e.input,a=e.avail_in,u=n.hold,l=n.bits,n.mode===Pt&&(n.back=-1);break}for(n.back=0;R=n.lencode[u&(1<<n.lenbits)-1],g=R>>>24,m=R>>>16&255,w=65535&R,!(g<=l);){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(m&&0==(240&m)){for(b=g,E=m,v=w;R=n.lencode[v+((u&(1<<b+E)-1)>>b)],g=R>>>24,m=R>>>16&255,w=65535&R,!(b+g<=l);){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}u>>>=b,l-=b,n.back+=b}if(u>>>=g,l-=g,n.back+=g,n.length=w,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=Pt;break}if(64&m){e.msg="invalid literal/length code",n.mode=Ot;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(T=n.extra;l<T;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;R=n.distcode[u&(1<<n.distbits)-1],g=R>>>24,m=R>>>16&255,w=65535&R,!(g<=l);){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(0==(240&m)){for(b=g,E=m,v=w;R=n.distcode[v+((u&(1<<b+E)-1)>>b)],g=R>>>24,m=R>>>16&255,w=65535&R,!(b+g<=l);){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}u>>>=b,l-=b,n.back+=b}if(u>>>=g,l-=g,n.back+=g,64&m){e.msg="invalid distance code",n.mode=Ot;break}n.offset=w,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(T=n.extra;l<T;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Ot;break}n.mode=16204;case 16204:if(0===c)break e;if(f=d-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Ot;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),y=n.window}else y=i,p=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do{i[o++]=y[p++]}while(--f);0===n.length&&(n.mode=Dt);break;case 16205:if(0===c)break e;i[o++]=n.length,c--,n.mode=Dt;break;case Lt:if(n.wrap){for(;l<32;){if(0===a)break e;a--,u|=r[s++]<<l,l+=8}if(d-=c,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?j(n.check,i,d,o-d):$(n.check,i,d,o-d)),d=c,4&n.wrap&&(n.flags?u:Ut(u))!==n.check){e.msg="incorrect data check",n.mode=Ot;break}u=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break e;a--,u+=r[s++]<<l,l+=8}if(4&n.wrap&&u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Ot;break}u=0,l=0}n.mode=16208;case 16208:S=Et;break e;case Ot:S=St;break e;case 16210:return Rt;default:return _t}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,n.hold=u,n.bits=l,(n.wsize||d!==e.avail_out&&n.mode<Ot&&(n.mode<Lt||t!==gt))&&Gt(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?j(n.check,i,d,e.next_out-d):$(n.check,i,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Pt?128:0)+(n.mode===xt||n.mode===Nt?256:0),(0===h&&0===d||t===gt)&&S===bt&&(S=At),S},inflateEnd:e=>{if(Bt(e))return _t;let t=e.state;return t.window&&(t.window=null),e.state=null,bt},inflateGetHeader:(e,t)=>{if(Bt(e))return _t;const n=e.state;return 0==(2&n.wrap)?_t:(n.head=t,t.done=!1,bt)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,s;return Bt(e)?_t:(r=e.state,0!==r.wrap&&r.mode!==Ct?_t:r.mode===Ct&&(i=1,i=$(i,t,n,0),i!==r.check)?St:(s=Gt(e,t,n,n),s?(r.mode=16210,Rt):(r.havedict=1,bt)))},inflateInfo:"pako inflate (from Nodeca project)"};var Wt=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Qt=Object.prototype.toString,{Z_NO_FLUSH:Yt,Z_FINISH:Jt,Z_OK:Xt,Z_STREAM_END:en,Z_NEED_DICT:tn,Z_STREAM_ERROR:nn,Z_DATA_ERROR:rn,Z_MEM_ERROR:sn}=q;function on(e){this.options=Ke.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ze,this.strm.avail_out=0;let n=Zt.inflateInit2(this.strm,t.windowBits);if(n!==Xt)throw new Error(K[n]);if(this.header=new Wt,Zt.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ge.string2buf(t.dictionary):"[object ArrayBuffer]"===Qt.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Zt.inflateSetDictionary(this.strm,t.dictionary),n!==Xt)))throw new Error(K[n])}function an(e,t){const n=new on(t);if(n.push(e),n.err)throw n.msg||K[n.err];return n.result}on.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?Jt:Yt,"[object ArrayBuffer]"===Qt.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=Zt.inflate(n,o),s===tn&&i&&(s=Zt.inflateSetDictionary(n,i),s===Xt?s=Zt.inflate(n,o):s===rn&&(s=tn));n.avail_in>0&&s===en&&n.state.wrap>0&&0!==e[n.next_in];)Zt.inflateReset(n),s=Zt.inflate(n,o);switch(s){case nn:case rn:case tn:case sn:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||s===en))if("string"===this.options.to){let e=Ge.utf8border(n.output,n.next_out),t=n.next_out-e,i=Ge.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==Xt||0!==a){if(s===en)return s=Zt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},on.prototype.onData=function(e){this.chunks.push(e)},on.prototype.onEnd=function(e){e===Xt&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ke.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var cn={Inflate:on,inflate:an,inflateRaw:function(e,t){return(t=t||{}).raw=!0,an(e,t)},ungzip:an,constants:q};const{Deflate:un,deflate:ln,deflateRaw:hn,gzip:dn}=at,{Inflate:fn,inflate:pn,inflateRaw:yn,ungzip:gn}=cn;var mn={Deflate:un,deflate:ln,deflateRaw:hn,gzip:dn,Inflate:fn,inflate:pn,inflateRaw:yn,ungzip:gn,constants:q}},90072:function(e,t){"use strict";let n=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function r(e="",t="ms"){var r=null;return(e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2")).replace(n,(function(e,t,n){(n=i(n))&&(r=(r||0)+parseFloat(t,10)*n)})),r&&r/(i(t)||1)}function i(e){return r[e]||r[e.toLowerCase().replace(/s$/,"")]}r.nanosecond=r.ns=1e-6,r["s"]=r["s"]=r.us=r.microsecond=.001,r.millisecond=r.ms=r[""]=1,r.second=r.sec=r.s=1e3*r.ms,r.minute=r.min=r.m=60*r.s,r.hour=r.hr=r.h=60*r.m,r.day=r.d=24*r.h,r.week=r.wk=r.w=7*r.d,r.month=r.b=30.4375*r.d,r.year=r.yr=r.y=365.25*r.d,t.Z=r},54375:function(e,t,n){let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},33286:function(e,t,n){const{instantiate:r}=n(19824);function i(e={}){if(!i.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return r(new Response(new Blob([t],{type:"application/wasm"})),e)}i.supported="undefined"!=typeof WebAssembly,e.exports=i},63060:function(e,t,n){const r=n(57118),i=n(33286);e.exports={Rabin:r,create:async(e,t,n,s,o)=>{const a=await i();return new r(a,e,t,n,s,o)}}},57118:function(e){e.exports=class{constructor(e,t=12,n=8192,r=32768,i=64,s){this.bits=t,this.min=n,this.max=r,this.asModule=e,this.rabin=new e.Rabin(t,n,r,i,s),this.polynomial=s}fingerprint(e){const{__retain:t,__release:n,__allocArray:r,__getInt32Array:i,Int32Array_ID:s,Uint8Array_ID:o}=this.asModule,a=t(r(s,new Int32Array(Math.ceil(e.length/this.min)))),c=t(r(o,e)),u=i(this.rabin.fingerprint(c,a));n(c),n(a);const l=u.indexOf(0);return l>=0?u.subarray(0,l):u}}},61798:function(e,t,n){"use strict";var r=n(34155),i=65536,s=4294967295;var o=n(89509).Buffer,a=n.g.crypto||n.g.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>s)throw new RangeError("requested too many random bytes");var n=o.allocUnsafe(e);if(e>0)if(e>i)for(var c=0;c<e;c+=i)a.getRandomValues(n.slice(c,c+i));else a.getRandomValues(n);if("function"==typeof t)return r.nextTick((function(){t(null,n)}));return n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},8558:function(e,t,n){const r=n(80640),i=n(81391),s=n(54156),o=n(4832),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u}=n(91713),l=n(22288),h=n(45105),d=n(60911),f=n(33766),p=n(78686),y=n(73328),g=n(15155);e.exports={RateLimiterRedis:r,RateLimiterMongo:i,RateLimiterMySQL:s,RateLimiterPostgres:o,RateLimiterMemory:l,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:u,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:y,RateLimiterRes:g}},73328:function(e,t,n){const r=n(15155);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return new r(e.remainingPoints,Math.min(e.msBeforeNext,t.msBeforeNext),e.consumedPoints,e.isFirstInDuration)}consume(e,t=1,n={}){return this._rateLimiter.consume(e,t,n).catch((i=>i instanceof r?this._burstLimiter.consume(e,t,n).then((e=>Promise.resolve(this._combineRes(i,e)))).catch((e=>e instanceof r?Promise.reject(this._combineRes(i,e)):Promise.reject(e))):Promise.reject(i)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},60911:function(e,t,n){const r=n(15155);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if(void 0===e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway=void 0!==e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new r(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new r(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.rejectBlack()),void 0===n?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),n)}block(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),void 0===n?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),n)}penalty(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),void 0===n?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),n)}reward(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),void 0===n?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),n)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),void 0===t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},81352:function(e){e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration=void 0===e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration=void 0===e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly=void 0!==e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs=void 0===e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if(void 0===e&&(e="rlflx"),"string"!=typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},91713:function(e,t,n){var r=n(34155),i=n(25108);const s=n(81265),o=n(35539),a=n(81352),c=n(22288),u=n(15155),l="rate_limiter_flexible";let h=null;const d=function(e,t,n,r){let i;i=null===r||!0===r||!1===r?r:{remainingPoints:r.remainingPoints,msBeforeNext:r.msBeforeNext,consumedPoints:r.consumedPoints,isFirstInDuration:r.isFirstInDuration},e.send({channel:l,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:n,data:i})},f=function(e){setTimeout((()=>{this._initiated?r.send(e):void 0!==this._promises[e.promiseId]&&f.call(this,e)}),30)},p=function(e,t,n,i,s){const o={channel:l,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:n,arg:i,opts:s}};this._initiated?r.send(o):f.call(this,o)},y=function(e,t){if(!t||t.channel!==l||void 0===this._rateLimiters[t.keyPrefix])return!1;let n;switch(t.func){case"consume":n=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":n=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":n=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":n=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":n=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":n=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}n&&n.then((n=>{d(e,t,"resolve",n)})).catch((n=>{d(e,t,"reject",n)}))},g=function(e){if(!e||e.channel!==l||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new u(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},m=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},w=function(e,t){const n=r.hrtime();let i=n[0].toString()+n[1].toString();return void 0!==this._promises[i]&&(i+=o.randomBytes(12).toString("base64")),this._promises[i]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[i],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},i};e.exports={RateLimiterClusterMaster:class{constructor(){if(h)return h;this._rateLimiters={},s.setMaxListeners(0),s.on("message",((e,t)=>{t&&t.channel===l&&"init"===t.type?(void 0===this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new c(t.opts)),e.send({channel:l,type:"init",keyPrefix:t.opts.keyPrefix})):y.call(this,e,t)})),h=this}},RateLimiterClusterMasterPM2:class{constructor(e){if(h)return h;this._rateLimiters={},e.launchBus(((t,n)=>{n.on("process:msg",(t=>{const n=t.raw;if(n&&n.channel===l&&"init"===n.type)void 0===this._rateLimiters[n.opts.keyPrefix]&&(this._rateLimiters[n.opts.keyPrefix]=new c(n.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:l,channel:l,type:"init",keyPrefix:n.opts.keyPrefix},((e,t)=>{e&&i.log(e,t)}));else{y.call(this,{send:n=>{const r=n;r.topic=l,void 0===r.data&&(r.data={}),e.sendDataToProcessId(t.process.pm_id,r,((e,t)=>{e&&i.log(e,t)}))}},n)}}))})),h=this}},RateLimiterCluster:class extends a{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs=void 0===e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),r.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,r.on("message",(e=>{e&&e.channel===l&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:g.call(this,e)})),r.send({channel:l,type:"init",opts:m.call(this)}),this._promises={}}consume(e,t=1,n={}){return new Promise(((r,i)=>{const s=w.call(this,r,i);p.call(this,"consume",s,e,t,n)}))}penalty(e,t=1,n={}){return new Promise(((r,i)=>{const s=w.call(this,r,i);p.call(this,"penalty",s,e,t,n)}))}reward(e,t=1,n={}){return new Promise(((r,i)=>{const s=w.call(this,r,i);p.call(this,"reward",s,e,t,n)}))}block(e,t,n={}){return new Promise(((r,i)=>{const s=w.call(this,r,i);p.call(this,"block",s,e,t,n)}))}get(e,t={}){return new Promise(((n,r)=>{const i=w.call(this,n,r);p.call(this,"get",i,e,t)}))}delete(e,t={}){return new Promise(((n,r)=>{const i=w.call(this,n,r);p.call(this,"delete",i,e,t)}))}}}},45105:function(e,t,n){const r=n(91090),i=n(15155);e.exports=class extends r{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,n){const r=new i;return r.consumedPoints=parseInt(n.consumedPoints),r.isFirstInDuration=n.consumedPoints===t,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=n.msBeforeNext,r}_upsert(e,t,n,r=!1,i={}){return new Promise(((s,o)=>{const a=Date.now(),c=Math.floor(n/1e3);r?this.client.set(e,t,c,(n=>{n?o(n):this.client.set(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.incr(e,t,((u,l)=>{u||!1===l?this.client.add(e,t,c,((u,l)=>{if(u||!l)if(void 0===i.attemptNumber||i.attemptNumber<3){const a=Object.assign({},i);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,n,r,a).then((e=>s(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,n={consumedPoints:l,msBeforeNext:e>=0?Math.max(e-a,0):-1};s(n)}}))}))}))}_get(e){return new Promise(((t,n)=>{const r=Date.now();this.client.get(e,((i,s)=>{s?this.client.get(`${e}_expire`,((e,i)=>{if(e)n(e);else{const e=!1===i?0:i,n={consumedPoints:s,msBeforeNext:e>=0?Math.max(e-r,0):-1};t(n)}})):t(null)}))}))}_delete(e){return new Promise(((t,n)=>{this.client.del(e,((r,i)=>{r?n(r):!1===i?t(i):this.client.del(`${e}_expire`,(e=>{e?n(e):t(i)}))}))}))}}},22288:function(e,t,n){const r=n(81352),i=n(58425),s=n(15155);e.exports=class extends r{constructor(e={}){super(e),this._memoryStorage=new i}consume(e,t=1,n={}){return new Promise(((r,i)=>{const s=this.getKey(e),o=this._getKeySecDuration(n);let a=this._memoryStorage.incrby(s,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(s,a.consumedPoints,this.blockDuration)),i(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(r,e,a)}else r(a)}))}penalty(e,t=1,n={}){const r=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(n),s=this._memoryStorage.incrby(r,t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}reward(e,t=1,n={}){const r=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(n),s=this._memoryStorage.incrby(r,-t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}block(e,t){const n=1e3*t,r=this.points+1;return this._memoryStorage.set(this.getKey(e),r,t),Promise.resolve(new s(0,0===n?-1:n,r))}set(e,t,n){const r=1e3*(n>=0?n:this.duration);return this._memoryStorage.set(this.getKey(e),t,n),Promise.resolve(new s(0,0===r?-1:r,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}},81391:function(e,t,n){const r=n(91090),i=n(15155);function s(e){try{const t=e.client?e.client:e,{version:n}=t.topology.s.options.metadata.driver,r=n.split(".").map((e=>parseInt(e)));return{major:r[0],feature:r[1],patch:r[2]}}catch(e){return{major:0,feature:0,patch:0}}}class o extends r{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"==typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=s(this.client)})):(this._initCollection(),this._driverVersion=s(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get client(){return this._client}set client(e){if(void 0===e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e=("function"==typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}_getRateLimiterRes(e,t,n){const r=new i;let s;return s=void 0===n.value?n:n.value,r.isFirstInDuration=s.points===t,r.consumedPoints=s.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=null!==s.expire?Math.max(new Date(s.expire).getTime()-Date.now(),0):-1,r}_upsert(e,t,n,r=!1,i={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const s=i.attrs||{};let o,a;r?(o={key:e},o=Object.assign(o,s),a={$set:{key:e,points:t,expire:n>0?new Date(Date.now()+n):null}},a.$set=Object.assign(a.$set,s)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,s),a={$setOnInsert:{key:e,expire:n>0?new Date(Date.now()+n):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,s));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((i,u)=>{this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},s),a={$set:Object.assign({key:e,points:t,expire:n>0?new Date(Date.now()+n):null},s)};this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((s=>{s&&11e3===s.code?this._upsert(e,t,n,r).then((e=>i(e))).catch((e=>u(e))):u(s)}))}else u(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},n);return this._collection.findOne(r)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e},n);return this._collection.deleteOne(r).then((e=>e.deletedCount>0))}}e.exports=o},54156:function(e,t,n){const r=n(91090),i=n(15155);e.exports=class extends r{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(n),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((n,r)=>{if(n)return t(n);e(r)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((n=>{n.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(r=>{if(r)return this._releaseConnection(n),t(r);n.query(this._getCreateTableStmt(),(r=>{if(r)return this._releaseConnection(n),t(r);this._releaseConnection(n),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if(void 0===e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new i,[s]=n;return r.isFirstInDuration=t===s.points,r.consumedPoints=r.isFirstInDuration?t:s.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,r}_upsertTransaction(e,t,n,r,i){return new Promise(((s,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const c=Date.now(),u=r>0?c+r:null;let l,h;i?(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",h=[this.dbName,this.tableName,t,n,u,n,u]):(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",h=[this.dbName,this.tableName,t,n,u,c,n,n,c,u]),e.query(l,h,(n=>{if(n)return e.rollback(),o(n);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,n)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);s(n)}))}))}))}))}))}_upsert(e,t,n,r=!1){return this.tableCreated?new Promise(((i,s)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,n,r).then((e=>{i(e),this._releaseConnection(o)})).catch((e=>{s(e),this._releaseConnection(o)}))})).catch((e=>{s(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,i)=>{e?n(e):0===i.length?t(null):t(i),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,i)=>{e?n(e):t(i.affectedRows>0),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}}},4832:function(e,t,n){const r=n(91090),i=n(15155);e.exports=class extends r{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"==typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const n={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(n).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((n=>{"23505"===n.code?e():t(n)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if(void 0===e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new i,s=n.rows[0];return r.isFirstInDuration=t===s.points,r.consumedPoints=r.isFirstInDuration?t:s.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,r}_query(e){const t={name:`${this.tableName.toLowerCase()}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,n)=>{this._getConnection().then((r=>{r.query(t).then((t=>{e(t),this._releaseConnection(r)})).catch((e=>{n(e),this._releaseConnection(r)}))})).catch((e=>{n(e)}))}))}_upsert(e,t,n,r=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const i=n>0?Date.now()+n:null,s=r?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:r?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${r?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${s}\n            RETURNING points, expire;`,values:[e,t,i,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}},78686:function(e,t,n){const r=n(45255),i=4294967295,s="limiter";e.exports=class{constructor(e,t={maxQueueSize:i}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e=s){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t=s){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:i,key:s}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((n,i)=>{e>t._limiterFlexible.points?i(new r(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,n,i,e):t._limiterFlexible.consume(t._key,e).then((e=>{n(e.remainingPoints)})).catch((r=>{r instanceof Error?i(r):(t._queueRequest.call(t,n,i,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),r.msBeforeNext)))}))}))}_queueRequest(e,t,n){const i=this;i._queue.length<i._maxQueueSize?i._queue.push({resolve:e,reject:t,tokens:n}):t(new r(`Number of requests reached it's maximum ${i._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((n=>{t.resolve(n.remainingPoints),e._processFIFO.call(e)})).catch((n=>{n instanceof Error?(t.reject(n),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),n.msBeforeNext)))}))}}},80640:function(e,t,n){const r=n(91090),i=n(15155),s="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";e.exports=class extends r{constructor(e){super(e),e.redis?this.client=e.redis:this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,"function"==typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:s})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"==typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,n){let[r,s]=n;Array.isArray(r)&&([,r]=r,[,s]=s);const o=new i;return o.consumedPoints=parseInt(r),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s,o}_upsert(e,t,n,r=!1){return new Promise(((i,o)=>{if(!this._isRedisReady())return o(new Error("Redis connection is not ready"));const a=Math.floor(n/1e3),c=this.client.multi();if(r)a>0?c.set(e,t,"EX",a):c.set(e,t),c.pttl(e).exec(((e,t)=>e?o(e):i(t)));else if(a>0){const n=function(e,t){return e?o(e):i(t)};"function"==typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,a,n):this.client.eval(s,1,e,t,a,n)}else c.incrby(e,t).pttl(e).exec(((e,t)=>e?o(e):i(t)))}))}_get(e){return new Promise(((t,n)=>{if(!this._isRedisReady())return n(new Error("Redis connection is not ready"));this.client.multi().get(e).pttl(e).exec(((e,r)=>{if(e)n(e);else{const[e]=r;if(null===e)return t(null);t(r)}}))}))}_delete(e){return new Promise(((t,n)=>{this.client.del(e,((e,r)=>{e?n(e):t(r>0)}))}))}}},15155:function(e){e.exports=class{constructor(e,t,n,r){this.remainingPoints=void 0===e?0:e,this.msBeforeNext=void 0===t?0:t,this.consumedPoints=void 0===n?0:n,this.isFirstInDuration=void 0!==r&&r}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},91090:function(e,t,n){const r=n(81352),i=n(52423),s=n(15155);e.exports=class extends r{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed||e.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration||e.inmemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new i}get client(){return this._client}set client(e){if(void 0===e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,n,r,i,s={}){const o=this._getRateLimiterRes(n,r,i);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(n,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+r&&(o.msBeforeNext=this.msBlockDuration,e=this._block(n,o.consumedPoints,this.msBlockDuration,s)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(n,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,n,i,s,o=!1,a={}){this.insuranceLimiter instanceof r?this.insuranceLimiter[t](s,o,a).then((e=>{n(e)})).catch((e=>{i(e)})):i(e)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(e){return this.getInMemoryBlockMsBeforeExpire(e)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(e){this.inMemoryBlockOnConsumed=e}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(e){this.inMemoryBlockDuration=e}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if(void 0!==e&&!(e instanceof r))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,n={}){const r=1e3*t;return this._block(this.getKey(e),this.points+1,r,n)}set(e,t,n,r={}){const i=1e3*(n>=0?n:this.duration);return this._block(this.getKey(e),t,i,r)}consume(e,t=1,n={}){return new Promise(((r,i)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return i(new s(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{this._afterConsume(r,i,o,t,e)})).catch((s=>{this._handleError(s,"consume",r,i,e,t,n)}))}))}penalty(e,t=1,n={}){const r=this.getKey(e);return new Promise(((i,s)=>{this._upsert(r,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{i(this._getRateLimiterRes(r,t,e))})).catch((r=>{this._handleError(r,"penalty",i,s,e,t,n)}))}))}reward(e,t=1,n={}){const r=this.getKey(e);return new Promise(((i,s)=>{this._upsert(r,-t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{i(this._getRateLimiterRes(r,-t,e))})).catch((r=>{this._handleError(r,"reward",i,s,e,t,n)}))}))}get(e,t={}){const n=this.getKey(e);return new Promise(((r,i)=>{this._get(n,t).then((e=>{r(null==e?null:this._getRateLimiterRes(n,0,e))})).catch((n=>{this._handleError(n,"get",r,i,e,t)}))}))}delete(e,t={}){const n=this.getKey(e);return new Promise(((r,i)=>{this._delete(n,t).then((e=>{this._inMemoryBlockedKeys.delete(n),r(e)})).catch((n=>{this._handleError(n,"delete",r,i,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,n){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,n,r={}){return new Promise(((i,o)=>{this._upsert(e,t,n,!0,r).then((()=>{i(new s(0,n>0?n:-1,t))})).catch((t=>{this._handleError(t,"block",i,o,this.parseKey(e),n/1e3,r)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,n,r=!1,i={}){throw new Error("You have to implement the method '_upsert'!")}}},33766:function(e,t,n){const r=n(81352);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof r))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((n,r)=>{const i=[];this._limiters.forEach((n=>{i.push(n.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(i).then((e=>{const t={};let i=!1;e.forEach((e=>{!0===e.rejected&&(i=!0)}));for(let n=0;n<e.length;n++)i&&!0===e[n].rejected?t[this._limiters[n].keyPrefix]=e[n].rej:i||(t[this._limiters[n].keyPrefix]=e[n]);i?r(t):n(t)}))}))}}},78894:function(e){e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},52423:function(e,t,n){const r=n(78894);e.exports=r},58425:function(e,t,n){const r=n(9250),i=n(15155);e.exports=class{constructor(){this._storage={}}incrby(e,t,n){if(this._storage[e]){const r=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==r?(this._storage[e].value=this._storage[e].value+t,new i(0,r,this._storage[e].value,!1)):this.set(e,t,n)}return this.set(e,t,n)}set(e,t,n){const s=1e3*n;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new r(t,s>0?new Date(Date.now()+s):null),s>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),s),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new i(0,0===s?-1:s,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new i(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},9250:function(e){e.exports=class{constructor(e,t,n=null){this.value=e,this.expiresAt=t,this.timeoutId=n}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},45255:function(e){e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},58090:function(e,t,n){"use strict";const r=n(2463);class i extends r.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}},11281:function(e){"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,s,o,a;if("string"==typeof t&&(s="not ",t.substr(!o||o<0?0:+o,s.length)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var c=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(r(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},96201:function(e,t,n){"use strict";var r=n(34155),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var s=n(62460),o=n(1103);n(35717)(l,s);for(var a=i(o.prototype),c=0;c<a.length;c++){var u=a[c];l.prototype[u]||(l.prototype[u]=o.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);s.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},24404:function(e,t,n){"use strict";e.exports=i;var r=n(67749);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(35717)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},62460:function(e,t,n){"use strict";var r,i=n(34155);e.exports=A,A.ReadableState=R;n(17187).EventEmitter;var s=function(e,t){return e.listeners(t).length},o=n(28114),a=n(48764).Buffer,c=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var u,l=n(43838);u=l&&l.debuglog?l.debuglog("stream"):function(){};var h,d,f,p=n(30597),y=n(80358),g=n(75267).getHighWaterMark,m=n(11281).q,w=m.ERR_INVALID_ARG_TYPE,b=m.ERR_STREAM_PUSH_AFTER_EOF,E=m.ERR_METHOD_NOT_IMPLEMENTED,v=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(35717)(A,o);var _=y.errorOrDestroy,S=["error","close","destroy","pause","resume"];function R(e,t,i){r=r||n(96201),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=n(32553).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function A(e){if(r=r||n(96201),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new R(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function I(e,t,n,r,i){u("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?k(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}(e,o);else if(i||(s=function(e,t){var n;r=t,a.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new w("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(o,t)),s)_(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),r)o.endEmitted?_(e,new v):T(e,o,t,!0);else if(o.ended)_(e,new b);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?T(e,o,t,!1):x(e,o)):T(e,o,t,!1)}else r||(o.reading=!1,x(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function T(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&k(e)),x(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=a.from(e,t),t=""),n=!0),I(this,e,t,!1,n)},A.prototype.unshift=function(e){return I(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){h||(h=n(32553).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function P(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function k(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(N,e))}function N(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,M(e)}function x(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(D,e,t))}function D(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(u("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function O(e){u("readable nexttick read 0"),e.read(0)}function U(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function z(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(V,t,e))}function V(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function $(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}A.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):k(this),null;if(0===(e=P(e,t))&&t.ended)return 0===t.length&&z(this),null;var r,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=P(n,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&z(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(e){_(this,new E("_read()"))},A.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,u("pipe count=%d opts=%j",r.pipesCount,t);var o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?c:g;function a(t,i){u("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,u("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",l),e.removeListener("error",f),e.removeListener("unpipe",a),n.removeListener("end",c),n.removeListener("end",g),n.removeListener("data",d),h=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function c(){u("onend"),e.end()}r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,M(e))}}(n);e.on("drain",l);var h=!1;function d(t){u("ondata");var i=e.write(t);u("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==$(r.pipes,e))&&!h&&(u("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function f(t){u("onerror",t),g(),e.removeListener("error",f),0===s(e,"error")&&_(e,t)}function p(){e.removeListener("finish",y),g()}function y(){u("onfinish"),e.removeListener("close",p),g()}function g(){u("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",p),e.once("finish",y),e.emit("pipe",n),r.flowing||(u("pipe resume"),n.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=$(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},A.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,u("on readable",r.length,r.reading),r.length?k(this):r.reading||i.nextTick(O,this))),n},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(L,this),n},A.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(L,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(U,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){u("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=n(26913)),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=B,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===f&&(f=n(92887)),f(A,e,t)})},67749:function(e,t,n){"use strict";e.exports=l;var r=n(11281).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,c=n(96201);function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,n){d(e,t,n)}))}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}n(35717)(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},1103:function(e,t,n){"use strict";var r,i=n(34155);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=A,A.WritableState=R;var o={deprecate:n(94927)},a=n(28114),c=n(48764).Buffer,u=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,h=n(80358),d=n(75267).getHighWaterMark,f=n(11281).q,p=f.ERR_INVALID_ARG_TYPE,y=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,m=f.ERR_STREAM_CANNOT_PIPE,w=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,E=f.ERR_STREAM_WRITE_AFTER_END,v=f.ERR_UNKNOWN_ENCODING,_=h.errorOrDestroy;function S(){}function R(e,t,o){r=r||n(96201),e=e||{},"boolean"!=typeof o&&(o=t instanceof r),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,s=n.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,s){--t.pendingcb,n?(i.nextTick(s,r),i.nextTick(N,e,t),e._writableState.errorEmitted=!0,_(e,r)):(s(r),e._writableState.errorEmitted=!0,_(e,r),N(e,t))}(e,n,r,t,s);else{var o=P(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||C(e,n),r?i.nextTick(T,e,n,o,s):T(e,n,o,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function A(e){var t=this instanceof(r=r||n(96201));if(!t&&!l.call(A,this))return new A(e);this._writableState=new R(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function I(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new w("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function T(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),N(e,t)}function C(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,I(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,h=n.callback;if(I(e,t,!1,t.objectMode?1:u.length,u,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function P(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),N(e,t)}))}function N(e,t){var n=P(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(k,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(35717)(A,a),R.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(R.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===A&&(e&&e._writableState instanceof R)}})):l=function(e){return e instanceof this},A.prototype.pipe=function(){_(this,new m)},A.prototype.write=function(e,t,n){var r,s=this._writableState,o=!1,a=!s.objectMode&&(r=e,c.isBuffer(r)||r instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=S),s.ending?function(e,t){var n=new E;_(e,n),i.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var s;return null===n?s=new b:"string"==typeof n||t.objectMode||(s=new p("chunk",["string","Buffer"],n)),!s||(_(e,s),i.nextTick(r,s),!1)}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,n,r,i,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,a,r,i,s);return u}(this,s,a,e,t,n)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new v(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,n){n(new y("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,N(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e)}},26913:function(e,t,n){"use strict";var r,i=n(34155);function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(22880),a=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function y(e){var t=e[a];if(null!==t){var n=e[f].read();null!==n&&(e[h]=null,e[a]=null,e[c]=null,t(p(n,!1)))}}function g(e){i.nextTick(y,e)}var m=Object.getPrototypeOf((function(){})),w=Object.setPrototypeOf((s(r={get stream(){return this[f]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(t,n){i.nextTick((function(){e[u]?n(e[u]):t(p(void 0,!0))}))}));var n,r=this[h];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[d](n,r)}),r)}}(r,this));else{var s=this[f].read();if(null!==s)return Promise.resolve(p(s,!1));n=new Promise(this[d])}return this[h]=n,n}},Symbol.asyncIterator,(function(){return this})),s(r,"return",(function(){var e=this;return new Promise((function(t,n){e[f].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),m);e.exports=function(e){var t,n=Object.create(w,(s(t={},f,{value:e,writable:!0}),s(t,a,{value:null,writable:!0}),s(t,c,{value:null,writable:!0}),s(t,u,{value:null,writable:!0}),s(t,l,{value:e._readableState.endEmitted,writable:!0}),s(t,d,{value:function(e,t){var r=n[f].read();r?(n[h]=null,n[a]=null,n[c]=null,e(p(r,!1))):(n[a]=e,n[c]=t)},writable:!0}),t));return n[h]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[c];return null!==t&&(n[h]=null,n[a]=null,n[c]=null,t(e)),void(n[u]=e)}var r=n[a];null!==r&&(n[h]=null,n[a]=null,n[c]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",g.bind(null,n)),n}},30597:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=n(48764).Buffer,u=n(99283).inspect,l=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t,n,r,i=c.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,c.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return u(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},80358:function(e,t,n){"use strict";var r=n(34155);function i(e,t){o(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(o,this,e)):r.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted?r.nextTick(s,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,e)):r.nextTick(i,n,e):t?(r.nextTick(s,n),t(e)):r.nextTick(s,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},22880:function(e,t,n){"use strict";var r=n(11281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,h=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},y=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",d),t.on("finish",l),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},92887:function(e){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},60677:function(e,t,n){"use strict";var r;var i=n(11281).q,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var l,h=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var d=t.map((function(e,i){var s=i<t.length-1;return function(e,t,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=n(22880)),r(e,{readable:t,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}(e,s,i>0,(function(e){l||(l=e),e&&d.forEach(c),s||(d.forEach(c),h(l))}))}));return t.reduce(u)}},75267:function(e,t,n){"use strict";var r=n(11281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},28114:function(e,t,n){e.exports=n(17187).EventEmitter},2463:function(e,t,n){(t=e.exports=n(62460)).Stream=t,t.Readable=t,t.Writable=n(1103),t.Duplex=n(96201),t.Transform=n(67749),t.PassThrough=n(24404),t.finished=n(22880),t.pipeline=n(60677)},29967:function(e,t,n){e.exports=function(e,t,n){if("number"!=typeof t)throw new Error("second argument must be a Number");let i,s,o,a,c,u,l=!0;Array.isArray(e)?(i=[],o=s=e.length):(a=Object.keys(e),i={},o=s=a.length);function h(e){function t(){n&&n(e,i),n=null}l?r(t):t()}function d(t,n,r){if(i[t]=r,n&&(c=!0),0==--o||n)h(n);else if(!c&&u<s){let t;a?(t=a[u],u+=1,e[t]((function(e,n){d(t,e,n)}))):(t=u,u+=1,e[t]((function(e,n){d(t,e,n)})))}}u=t,o?a?a.some((function(n,r){return e[n]((function(e,t){d(n,e,t)})),r===t-1})):e.some((function(e,n){return e((function(e,t){d(n,e,t)})),n===t-1})):h(null);l=!1};const r=n(54375)},37386:function(e,t,n){"use strict";n.d(t,{X:function(){return h}});var r=n(70655),i=n(81480),s=n(35720),o=(0,n(1819).d)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),a=n(3699),c=n(68846),u=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.ZT)(t,e),t.prototype.lift=function(e){var t=new l(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new o},t.prototype.next=function(e){var t=this;(0,c.x)((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=(0,r.XA)(t.currentObservers),o=s.next();!o.done;o=s.next()){o.value.next(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,c.x)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,c.x)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?s.Lc:(this.currentObservers=null,o.push(e),new s.w0((function(){t.currentObservers=null,(0,a.P)(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new i.y;return e.source=this,e},t.create=function(e,t){return new l(e,t)},t}(i.y),l=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.ZT)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:s.Lc},t}(u),h=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(u)},81480:function(e,t,n){"use strict";n.d(t,{y:function(){return h}});var r=n(15642),i=n(35720),s=n(46766),o=n(90278);function a(e){return 0===e.length?o.y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var c=n(53912),u=n(58474),l=n(68846),h=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var s,o=this,a=(s=e)&&s instanceof r.Lv||function(e){return e&&(0,u.m)(e.next)&&(0,u.m)(e.error)&&(0,u.m)(e.complete)}(s)&&(0,i.Nn)(s)?e:new r.Hp(e,t,n);return(0,l.x)((function(){var e=o,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?o._subscribe(a):o._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=d(t))((function(t,i){var s=new r.Hp({next:function(t){try{e(t)}catch(e){i(e),s.unsubscribe()}},error:i,complete:t});n.subscribe(s)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[s.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function d(e){var t;return null!==(t=null!=e?e:c.v.Promise)&&void 0!==t?t:Promise}},15642:function(e,t,n){"use strict";n.d(t,{Hp:function(){return m},Lv:function(){return f}});var r=n(70655),i=n(58474),s=n(35720),o=n(53912),a=n(40005);function c(){}var u=l("C",void 0,void 0);function l(e,t,n){return{kind:e,value:t,error:n}}var h=n(68380),d=n(68846),f=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,(0,s.Nn)(t)&&t.add(n)):n.destination=E,n}return(0,r.ZT)(t,e),t.create=function(e,t,n){return new m(e,t,n)},t.prototype.next=function(e){this.isStopped?b(function(e){return l("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?b(l("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?b(u,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(s.w0),p=Function.prototype.bind;function y(e,t){return p.call(e,t)}var g=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){w(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){w(e)}else w(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){w(e)}},e}(),m=function(e){function t(t,n,r){var s,a,c=e.call(this)||this;(0,i.m)(t)||!t?s={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:c&&o.v.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return c.unsubscribe()},s={next:t.next&&y(t.next,a),error:t.error&&y(t.error,a),complete:t.complete&&y(t.complete,a)}):s=t;return c.destination=new g(s),c}return(0,r.ZT)(t,e),t}(f);function w(e){o.v.useDeprecatedSynchronousErrorHandling?(0,d.O)(e):(0,a.h)(e)}function b(e,t){var n=o.v.onStoppedNotification;n&&h.z.setTimeout((function(){return n(e,t)}))}var E={closed:!0,next:c,error:function(e){throw e},complete:c}},35720:function(e,t,n){"use strict";n.d(t,{Lc:function(){return c},w0:function(){return a},Nn:function(){return u}});var r=n(70655),i=n(58474),s=(0,n(1819).d)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),o=n(3699),a=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,o,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var u=(0,r.XA)(c),h=u.next();!h.done;h=u.next()){h.value.remove(this)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else c.remove(this);var d=this.initialTeardown;if((0,i.m)(d))try{d()}catch(e){a=e instanceof s?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var p=(0,r.XA)(f),y=p.next();!y.done;y=p.next()){var g=y.value;try{l(g)}catch(e){a=null!=a?a:[],e instanceof s?a=(0,r.ev)((0,r.ev)([],(0,r.CR)(a)),(0,r.CR)(e.errors)):a.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}if(a)throw new s(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,o.P)(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&(0,o.P)(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),c=a.EMPTY;function u(e){return e instanceof a||e&&"closed"in e&&(0,i.m)(e.remove)&&(0,i.m)(e.add)&&(0,i.m)(e.unsubscribe)}function l(e){(0,i.m)(e)?e():e.unsubscribe()}},53912:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var r={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},1545:function(e,t,n){"use strict";n.d(t,{E:function(){return r}});var r=new(n(81480).y)((function(e){return e.complete()}))},11954:function(e,t,n){"use strict";n.d(t,{D:function(){return v}});var r=n(87878),i=n(47845),s=n(96798),o=n(2566);function a(e,t){return void 0===t&&(t=0),(0,s.e)((function(n,r){n.subscribe((0,o.x)(r,(function(n){return(0,i.f)(r,e,(function(){return r.next(n)}),t)}),(function(){return(0,i.f)(r,e,(function(){return r.complete()}),t)}),(function(n){return(0,i.f)(r,e,(function(){return r.error(n)}),t)})))}))}function c(e,t){return void 0===t&&(t=0),(0,s.e)((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}var u=n(81480);var l=n(39768),h=n(58474);function d(e,t){if(!e)throw new Error("Iterable cannot be null");return new u.y((function(n){(0,i.f)(n,t,(function(){var r=e[Symbol.asyncIterator]();(0,i.f)(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}var f=n(71764),p=n(53841),y=n(45685),g=n(1837),m=n(58430),w=n(88729),b=n(48671);function E(e,t){if(null!=e){if((0,f.c)(e))return function(e,t){return(0,r.Xf)(e).pipe(c(t),a(t))}(e,t);if((0,y.z)(e))return function(e,t){return new u.y((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if((0,p.t)(e))return function(e,t){return(0,r.Xf)(e).pipe(c(t),a(t))}(e,t);if((0,m.D)(e))return d(e,t);if((0,g.T)(e))return function(e,t){return new u.y((function(n){var r;return(0,i.f)(n,t,(function(){r=e[l.h](),(0,i.f)(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return(0,h.m)(null==r?void 0:r.return)&&r.return()}}))}(e,t);if((0,b.L)(e))return function(e,t){return d((0,b.Q)(e),t)}(e,t)}throw(0,w.z)(e)}function v(e,t){return t?E(e,t):(0,r.Xf)(e)}},87878:function(e,t,n){"use strict";n.d(t,{Xf:function(){return y}});var r=n(70655),i=n(45685),s=n(53841),o=n(81480),a=n(71764),c=n(58430),u=n(88729),l=n(1837),h=n(48671),d=n(58474),f=n(40005),p=n(46766);function y(e){if(e instanceof o.y)return e;if(null!=e){if((0,a.c)(e))return w=e,new o.y((function(e){var t=w[p.L]();if((0,d.m)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,i.z)(e))return m=e,new o.y((function(e){for(var t=0;t<m.length&&!e.closed;t++)e.next(m[t]);e.complete()}));if((0,s.t)(e))return y=e,new o.y((function(e){y.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,f.h)}));if((0,c.D)(e))return g(e);if((0,l.T)(e))return n=e,new o.y((function(e){var t,i;try{for(var s=(0,r.XA)(n),o=s.next();!o.done;o=s.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}e.complete()}));if((0,h.L)(e))return t=e,g((0,h.Q)(t))}var t,n,y,m,w;throw(0,u.z)(e)}function g(e){return new o.y((function(t){(function(e,t){var n,i,s,o;return(0,r.mG)(this,void 0,void 0,(function(){var a,c;return(0,r.Jh)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=(0,r.KL)(e),u.label=1;case 1:return[4,n.next()];case 2:if((i=u.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),s={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},51706:function(e,t,n){"use strict";n.d(t,{F:function(){return a}});var r=n(78639),i=n(81480),s=n(64865),o=n(31454);function a(e,t){return void 0===e&&(e=0),void 0===t&&(t=r.z),e<0&&(e=0),function(e,t,n){void 0===e&&(e=0),void 0===n&&(n=r.P);var a=-1;return null!=t&&((0,s.K)(t)?n=t:a=t),new i.y((function(t){var r=(0,o.q)(e)?+e-n.now():e;r<0&&(r=0);var i=0;return n.schedule((function(){t.closed||(t.next(i++),0<=a?this.schedule(void 0,a):t.complete())}),r)}))}(e,e,t)}},31751:function(e,t,n){"use strict";n.d(t,{T:function(){return u}});var r=n(87877),i=n(90278);var s=n(87878),o=n(1545),a=n(22457),c=n(11954);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,a.yG)(e),u=(0,a._6)(e,1/0),l=e;return l.length?1===l.length?(0,s.Xf)(l[0]):function(e){return void 0===e&&(e=1/0),(0,r.z)(i.y,e)}(u)((0,c.D)(l,n)):o.E}},32817:function(e,t,n){"use strict";n.d(t,{of:function(){return s}});var r=n(22457),i=n(11954);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,r.yG)(e);return(0,i.D)(e,n)}},28368:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(81480),i=n(58474);function s(e,t){var n=(0,i.m)(e)?e:function(){return e},s=function(e){return e.error(n())};return new r.y(t?function(e){return t.schedule(s,0,e)}:s)}},2566:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var r=n(70655);function i(e,t,n,r,i){return new s(e,t,n,r,i)}var s=function(e){function t(t,n,r,i,s,o){var a=e.call(this,t)||this;return a.onFinalize=s,a.shouldUnsubscribe=o,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,r.ZT)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(n(15642).Lv)},79878:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(87878),i=n(2566),s=n(96798);function o(e){return(0,s.e)((function(t,n){var s,a=null,c=!1;a=t.subscribe((0,i.x)(n,void 0,void 0,(function(i){s=(0,r.Xf)(e(i,o(e)(t))),a?(a.unsubscribe(),a=null,s.subscribe(n)):c=!0}))),c&&(a.unsubscribe(),a=null,s.subscribe(n))}))}},42965:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(78639),i=n(96798),s=n(2566);function o(e,t){return void 0===t&&(t=r.z),(0,i.e)((function(n,r){var i=null,o=null,a=null,c=function(){if(i){i.unsubscribe(),i=null;var e=o;o=null,r.next(e)}};function u(){var n=a+e,s=t.now();if(s<n)return i=this.schedule(void 0,n-s),void r.add(i);c()}n.subscribe((0,s.x)(r,(function(n){o=n,a=t.now(),i||(i=t.schedule(u,e),r.add(i))}),(function(){c(),r.complete()}),void 0,(function(){o=i=null})))}))}},94975:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(96798),i=n(2566);function s(e,t){return(0,r.e)((function(n,r){var s=0;n.subscribe((0,i.x)(r,(function(n){return e.call(t,n,s++)&&r.next(n)})))}))}},29127:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var r=n(96798),i=n(2566);function s(e,t){return(0,r.e)((function(n,r){var s=0;n.subscribe((0,i.x)(r,(function(n){r.next(e.call(t,n,s++))})))}))}},87877:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(29127),i=n(87878),s=n(96798),o=n(47845),a=n(2566);var c=n(58474);function u(e,t,n){return void 0===n&&(n=1/0),(0,c.m)(t)?u((function(n,s){return(0,r.U)((function(e,r){return t(n,e,s,r)}))((0,i.Xf)(e(n,s)))}),n):("number"==typeof t&&(n=t),(0,s.e)((function(t,r){return function(e,t,n,r,s,c,u,l){var h=[],d=0,f=0,p=!1,y=function(){!p||h.length||d||t.complete()},g=function(e){return d<r?m(e):h.push(e)},m=function(e){c&&t.next(e),d++;var l=!1;(0,i.Xf)(n(e,f++)).subscribe((0,a.x)(t,(function(e){null==s||s(e),c?g(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{d--;for(var e=function(){var e=h.shift();u?(0,o.f)(t,u,(function(){return m(e)})):m(e)};h.length&&d<r;)e();y()}catch(e){t.error(e)}})))};return e.subscribe((0,a.x)(t,g,(function(){p=!0,y()}))),function(){null==l||l()}}(t,r,e,n)})))}},25211:function(e,t,n){"use strict";n.d(t,{V:function(){return h}});var r=n(78639),i=n(31454),s=n(96798),o=n(87878),a=n(1819),c=n(2566),u=n(47845),l=(0,a.d)((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function h(e,t){var n=(0,i.q)(e)?{first:e}:"number"==typeof e?{each:e}:e,a=n.first,l=n.each,h=n.with,f=void 0===h?d:h,p=n.scheduler,y=void 0===p?null!=t?t:r.z:p,g=n.meta,m=void 0===g?null:g;if(null==a&&null==l)throw new TypeError("No timeout provided.");return(0,s.e)((function(e,t){var n,r,i=null,s=0,h=function(e){r=(0,u.f)(t,y,(function(){try{n.unsubscribe(),(0,o.Xf)(f({meta:m,lastValue:i,seen:s})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe((0,c.x)(t,(function(e){null==r||r.unsubscribe(),s++,t.next(i=e),l>0&&h(l)}),void 0,void 0,(function(){(null==r?void 0:r.closed)||null==r||r.unsubscribe(),i=null}))),!s&&h(null!=a?"number"==typeof a?a:+a-y.now():l)}))}function d(e){throw new l(e)}},78639:function(e,t,n){"use strict";n.d(t,{P:function(){return h},z:function(){return l}});var r=n(70655),i=function(e){function t(t,n){return e.call(this)||this}return(0,r.ZT)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(35720).w0),s={setInterval:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=s.delegate;return(null==o?void 0:o.setInterval)?o.setInterval.apply(o,(0,r.ev)([e,t],(0,r.CR)(n))):setInterval.apply(void 0,(0,r.ev)([e,t],(0,r.CR)(n)))},clearInterval:function(e){var t=s.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},o=n(3699),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,r.ZT)(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),s.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&s.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,o.P)(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(i),c={now:function(){return(c.delegate||Date).now()},delegate:void 0},u=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=c.now,e}(),l=new(function(e){function t(t,n){void 0===n&&(n=u.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,r.ZT)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(u))(a),h=l},68380:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r=n(70655),i={setTimeout:function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var o=i.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,(0,r.ev)([e,t],(0,r.CR)(n))):setTimeout.apply(void 0,(0,r.ev)([e,t],(0,r.CR)(n)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},39768:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var r="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},46766:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},22457:function(e,t,n){"use strict";n.d(t,{_6:function(){return o},yG:function(){return s}});var r=n(64865);function i(e){return e[e.length-1]}function s(e){return(0,r.K)(i(e))?e.pop():void 0}function o(e,t){return"number"==typeof i(e)?e.pop():t}},3699:function(e,t,n){"use strict";function r(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}n.d(t,{P:function(){return r}})},1819:function(e,t,n){"use strict";function r(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}n.d(t,{d:function(){return r}})},68846:function(e,t,n){"use strict";n.d(t,{O:function(){return o},x:function(){return s}});var r=n(53912),i=null;function s(e){if(r.v.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,s=n.errorThrown,o=n.error;if(i=null,s)throw o}}else e()}function o(e){r.v.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},47845:function(e,t,n){"use strict";function r(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var s=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(s),!i)return s}n.d(t,{f:function(){return r}})},90278:function(e,t,n){"use strict";function r(e){return e}n.d(t,{y:function(){return r}})},45685:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},58430:function(e,t,n){"use strict";n.d(t,{D:function(){return i}});var r=n(58474);function i(e){return Symbol.asyncIterator&&(0,r.m)(null==e?void 0:e[Symbol.asyncIterator])}},31454:function(e,t,n){"use strict";function r(e){return e instanceof Date&&!isNaN(e)}n.d(t,{q:function(){return r}})},58474:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,{m:function(){return r}})},71764:function(e,t,n){"use strict";n.d(t,{c:function(){return s}});var r=n(46766),i=n(58474);function s(e){return(0,i.m)(e[r.L])}},1837:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(39768),i=n(58474);function s(e){return(0,i.m)(null==e?void 0:e[r.h])}},53841:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var r=n(58474);function i(e){return(0,r.m)(null==e?void 0:e.then)}},48671:function(e,t,n){"use strict";n.d(t,{L:function(){return o},Q:function(){return s}});var r=n(70655),i=n(58474);function s(e){return(0,r.FC)(this,arguments,(function(){var t,n,i;return(0,r.Jh)(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,(0,r.qq)(t.read())];case 3:return n=s.sent(),i=n.value,n.done?[4,(0,r.qq)(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,(0,r.qq)(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function o(e){return(0,i.m)(null==e?void 0:e.getReader)}},64865:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n(58474);function i(e){return e&&(0,r.m)(e.schedule)}},96798:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(58474);function i(e){return function(t){if(function(e){return(0,r.m)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},40005:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(53912),i=n(68380);function s(e){i.z.setTimeout((function(){var t=r.v.onUnhandledError;if(!t)throw e;t(e)}))}},88729:function(e,t,n){"use strict";function r(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}n.d(t,{z:function(){return r}})},89509:function(e,t,n){var r=n(48764),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},50202:function(e,t,n){"use strict";var r=n(63700),i=/[\/\?<>\\:\*\|"]/g,s=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function u(e,t){if("string"!=typeof e)throw new Error("Input must be string");var n=e.replace(i,t).replace(s,t).replace(o,t).replace(a,t).replace(c,t);return r(n,255)}e.exports=function(e,t){var n=t&&t.replacement||"",r=u(e,n);return""===n?r:u(r,"")}},27695:function(e){"use strict";const t=new Map;e.exports={setDelayedInterval:function(e,n,r){r=r||n;const i=`${Date.now()}:${Math.floor(1e6*Math.random())}`,s=setTimeout((()=>{!async function(e,n,r){for(;t.get(r);){try{await e()}catch(e){setTimeout((()=>{throw e}),1);break}if(!t.get(r))break;await new Promise((e=>{const i=setTimeout(e,n);t.set(r,i)}))}}(e,n,i)}),r);return t.set(i,s),i},clearDelayedInterval:function(e){const n=t.get(e);n&&(clearTimeout(n),t.delete(e))}}},20544:function(e){"use strict";function t(e,t){return e+n(t)}function n(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function r(e,t){return e[0]-t[0]}function i(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let n=this._internalPositionFor(e,!1);if(void 0===t)-1!==n&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let r=!1;-1===n?(n=this._data.length,this._setBit(e),this._changedData=!0):r=!0,this._setInternalPos(n,e,t,r),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,n=new Array(this.length);for(;t<this.length;)n[t]=e(this.get(t),t,this),t++;return n}reduce(e,t){let n=0,r=t;for(;n<this.length;){r=e(r,this.get(n),n),n++}return r}find(e){let t,n,r=0;for(;r<this.length&&!t;)n=this.get(r),t=e(n),r++;return t?n:void 0}_internalPositionFor(e,r){const i=this._bytePosFor(e,r);if(i>=this._bitArrays.length)return-1;const s=this._bitArrays[i],o=e-7*i;if(!((s&1<<o)>0))return-1;return this._bitArrays.slice(0,i).reduce(t,0)+n(s&~(4294967295<<o+1))-1}_bytePosFor(e,t){const n=Math.floor(e/7),r=n+1;for(;!t&&this._bitArrays.length<r;)this._bitArrays.push(0);return n}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,n,r){const i=this._data,s=[t,n];if(r)this._sortData(),i[e]=s;else{if(i.length)if(i[i.length-1][0]>=t)i.push(s);else if(i[0][0]<=t)i.unshift(s);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(s).concat(i.slice(e))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(r),this._changedData=!1}bitField(){const e=[];let t,n=8,r=0,i=0;const s=this._bitArrays.slice();for(;s.length||r;){0===r&&(t=s.shift(),r=7);const o=Math.min(r,n);i|=(t&~(255<<o))<<8-n,t>>>=o,r-=o,n-=o,n&&(r||s.length)||(e.push(i),i=0,n=8)}for(var o=e.length-1;o>0;o--){if(0!==e[o])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(i)}}},50590:function(e){e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},32553:function(e,t,n){"use strict";var r=n(89509).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(i=o(t[r]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(i=o(t[r]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},14153:function(e){const t=/^[-+]?0x[a-fA-F0-9]+$/,n=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const r={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};e.exports=function(e,i={}){if(i=Object.assign({},r,i),!e||"string"!=typeof e)return e;let s=e.trim();if(void 0!==i.skipLike&&i.skipLike.test(s))return e;if(i.hex&&t.test(s))return Number.parseInt(s,16);{const t=n.exec(s);if(t){const n=t[1],r=t[2];let o=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e;return e}(t[3]);const a=t[4]||t[6];if(!i.leadingZeros&&r.length>0&&n&&"."!==s[2])return e;if(!i.leadingZeros&&r.length>0&&!n&&"."!==s[1])return e;{const t=Number(s),c=""+t;return-1!==c.search(/[eE]/)||a?i.eNotation?t:e:-1!==s.indexOf(".")?"0"===c&&""===o||c===o||n&&c==="-"+o?t:e:r?o===c||n+o===c?t:e:s===c||s===n+c?t:e}}return e}}},10715:function(e,t,n){"use strict";const{AbortController:r}=globalThis,i=n(82916);class s extends r{constructor(e){super(),this._ms=e,this._timer=i((()=>this.abort()),e),Object.setPrototypeOf(this,s.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=i((()=>this.abort()),this._ms)}}e.exports={TimeoutController:s}},70655:function(e,t,n){"use strict";n.d(t,{CR:function(){return u},FC:function(){return d},Jh:function(){return a},KL:function(){return f},XA:function(){return c},ZT:function(){return i},ev:function(){return l},mG:function(){return o},pi:function(){return s},qq:function(){return h}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function d(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof h?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=c(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create},94927:function(e,t,n){var r=n(25108);function i(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?r.trace(t):r.warn(t),n=!0}return e.apply(this,arguments)}}},79297:function(e){!function(){e.exports=g;var t=86400,n=3200,r=146097*n/400,i=t*r,s=1e3*i,o=864e13,a=4294967296,c=1e6,u="000000000",l=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},h=g.prototype,d=(g.fromDate=function(e){return new g(+e)},g.fromInt64BE=v(0,1,2,3,0,4),g.fromInt64LE=v(3,2,1,0,4,0),g.fromString=function(e){var t,n=new g;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=1970+((e=+e)-1970)%400;return n.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,n,r){return n<0&&(r*=-1),t=6e4*(60*+n+ +r),""})).replace(/\.\d+$/,(function(e){return n.nano=+(e+u).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,n.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return m(n)},g.fromTimeT=function(e){return b(e,0)},h.year=0,h.time=0,h.nano=0,h.addNano=function(e){return this.nano+=+e||0,this},h.getNano=function(){var e=m(this);return(e.time%1e3*c+ +e.nano+1e9)%1e9},h.getTimeT=function(){var e=m(this),i=Math.floor(e.time/1e3);return(e=e.year)&&(i+=e*r*t/n),i},h.getYear=function(){return this.toDate().getUTCFullYear()+this.year},h.toDate=function(){return w(m(this).time)},h.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},h.toString=function(e){var t=this,n=t.toDate(),r={H:function(){return S(n.getUTCHours())},L:function(){return R(n.getUTCMilliseconds(),3)},M:function(){return S(n.getUTCMinutes())},N:function(){return R(t.getNano(),9)},S:function(){return S(n.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+R(e,6):0<=e?R(e,4):-999999<=e?"-"+R(-e,6):e},a:function(){return p[n.getUTCDay()]},b:function(){return f[n.getUTCMonth()]},d:function(){return S(n.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(n.getUTCDate())},m:function(){return S(n.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var n=t[1],i=y[n];n=r[n];return i?e(i):n?n():t}))}(e||d)},h.writeInt64BE=E(0,1,2,3,0,4),h.writeInt64LE=E(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],y={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return g;function g(e,t,n){var r=this;if(!(r instanceof g))return new g(e,t,n);r.time=+e||0,r.nano=+t||0,r.year=+n||0,m(r)}function m(e){var t,r,i,a=e.year,u=e.time,h=e.nano,d=((h<0||c<=h)&&(h-=(r=Math.floor(h/c))*c,u+=r,r=1),a%n);return(u<-o||o<u||d)&&((t=l(u/s))&&(a+=t*n,u-=t*s),(i=w(u)).setUTCFullYear(d+i.getUTCFullYear()),i=(u=+i)+(t=l((a-=d)/n))*s,t&&-o<=i&&i<=o&&(a-=t*n,u=i),r=1),r&&(e.year=a,e.time=u,e.nano=h),e}function w(e){var t=new Date(0);return t.setTime(e),t}function b(e,t){e=+e||0;var r=l((t=(0|t)*a)/i)+l(e/i);return(e=l((t=t%i+e%i)/i))&&(r+=e,t-=e*i),new g(1e3*t,0,r*n)}function E(e,i,s,o,c,u){return function(e,i){var s=m(this);_(e=e||new Array(8),i|=0);var o=Math.floor(s.time/1e3),d=(s=s.year*(r*t/n),l(s/a)+l(o/a));s=s%a+o%a;return(o=Math.floor(s/a))&&(d+=o,s-=o*a),h(e,i+c,d),h(e,i+u,s),e};function h(t,n,r){t[n+e]=r>>24&255,t[n+i]=r>>16&255,t[n+s]=r>>8&255,t[n+o]=255&r}}function v(e,t,n,r,i,s){return function(e,t){_(e,t|=0);var n=o(e,t+i);return b(o(e,t+s),n)};function o(i,s){return 16777216*i[s+e]+(i[s+t]<<16|i[s+n]<<8|i[s+r])}}function _(e,t){if(null==(e=e&&e.length))throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function S(e){return(9<e?"":"0")+(0|e)}function R(e,t){return(u+(0|e)).substr(-t)}}()},75845:function(e,t,n){"use strict";n.d(t,{U:function(){return C}});var r=n(23247),i=n(85521),s=n(87425),o=(n(49541),n(5681)),a=n(51926),c=n(88763),u=n(44223),l=n(52477),h=n(95272),d=n(27588),f=n(99937);const p=Symbol.for("nodejs.util.inspect.custom"),y=Object.values(c.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),c.gh.identity.decoder),g=114,m=36,w=37;class b{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[o.N]=!0;toString(){return null==this.string&&(this.string=a.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return u.k0.createV1(g,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,f.f)(this.multihash.bytes,e);if("string"==typeof e)return S(e).equals(this);if(null!=e?.multihash?.bytes)return(0,f.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[p](){return`PeerId(${this.toString()})`}}class E extends b{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class v extends b{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class _ extends b{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function S(e,t){if(t=t??y,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=l.Jx(a.base58btc.decode(`z${e}`));return e.startsWith("12D")?new v({multihash:t}):e.startsWith("16U")?new _({multihash:t}):new E({multihash:t})}return function(e){try{const t=l.Jx(e);if(t.code===h.identity.code){if(t.digest.length===m)return new v({multihash:t});if(t.digest.length===w)return new _({multihash:t})}if(t.code===d.sha256.code)return new E({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==g)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===d.sha256.code)return new E({multihash:e.multihash});if(t.code===h.identity.code){if(t.digest.length===m)return new v({multihash:e.multihash});if(t.digest.length===w)return new _({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(u.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(y.decode(e))}var R=n(76237),A=n(82199);const I=(0,s.kg)("libp2p:bootstrap");class T extends r.v{static tag="bootstrap";timer;list;timeout;components;_init;constructor(e,t={list:[]}){if(null==t.list||0===t.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=e,this.timeout=t.timeout??1e3,this.list=[];for(const e of t.list){if(!R.Ul.matches(e)){I.error("Invalid multiaddr");continue}const t=(0,A.HM)(e),n=t.getPeerId();if(null==n){I.error("Invalid bootstrap multiaddr without peer id");continue}const r={id:S(n),multiaddrs:[t],protocols:[]};this.list.push(r)}this._init=t}[i.O]=this;[Symbol.toStringTag]="@libp2p/bootstrap";isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(I("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{I.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const e of this.list){if(await this.components.peerStore.merge(e.id,{tags:{[this._init.tagName??"bootstrap"]:{value:this._init.tagValue??50,ttl:this._init.tagTTL??12e4}}}),null==this.timer)return;this.safeDispatchEvent("peer",{detail:e})}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}function C(e){return t=>new T(t,e)}},99937:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},813:function(e,t,n){"use strict";n.d(t,{Fm:function(){return b},xV:function(){return w}});n(9839);var r=n(15179),i=n(51926),s=n(88763),o=n(44223),a=n(52477),c=n(57050),u=n(41690),l=n(77408),h=n(49784),d=n(49736);const f=d.C,p=d.aY,y=function(e){let t=0;if(e=e.toString().trim(),f(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(p(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;f(n[r])&&(e=y(n[r]),n[r]=(0,h.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,h.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},g=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var m=n(47500);(0,m.Ev)("ip4"),(0,m.Ev)("ip6"),(0,m.Ev)("ipcidr");function w(e,t){switch((0,m.Ev)(e).code){case 4:case 41:return function(e){const t=g(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!d.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return I(t);case 6:case 273:case 33:case 132:return R(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,h.B)(n,"base58btc")}(t);case 444:case 445:return T(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,h.B)(n,"base64url")}(t);default:return(0,h.B)(t,"base16")}}function b(e,t){switch((0,m.Ev)(e).code){case 4:case 41:return _(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return A(t);case 6:case 273:case 33:case 132:return S(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=S(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=S(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=v.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return(0,l.m)(t,"base16")}}const E=Object.values(s.gh).map((e=>e.decoder)),v=function(){let e=E[0].or(E[1]);return E.slice(2).forEach((t=>e=e.or(t))),e}();function _(e){if(!d.h6(e))throw new Error("invalid ip address");return y(e)}function S(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function R(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function A(e){const t=(0,l.m)(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function I(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,h.B)(e)}function T(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,h.B)(t,"base32")}:${R(n)}`}},82199:function(e,t,n){"use strict";n.d(t,{HM:function(){return R}});var r=n(49541),i=n(51926),s=n(44223),o=n(73062),a=n(49784),c=n(57050),u=n(41690),l=n(813),h=n(47500);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(68020);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},47500:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},15179:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(89366);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},51926:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(89366);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},32329:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},44223:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(15179),i=n(51926),s=n(32329),o=n(52477),a=n(87593);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},52477:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(32329),i=n(87593);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},95272:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(32329),i=n(52477);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},27588:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(44641);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},87593:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},63042:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(44234),i={SHA1:20,SHA256:32,SHA512:64};const s={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},o=async(e,t)=>{const n=await r.Z.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(n,0,n.byteLength)};async function a(e,t){const n=s[e],a=await r.Z.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:n}},!1,["sign"]);return{digest:async e=>await o(a,e),length:i[e]}}},79944:function(e,t,n){"use strict";n.d(t,{XP:function(){return i},nk:function(){return u},O6:function(){return s.Z}});n(63042),n(8925),n(3832),n(49784),n(77408);var r=n(52770);var i=n(86906),s=n(95887),o=n(98960),a=n(97116);const c={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function u(e,t,n,i,s){if("sha1"!==s&&"sha2-256"!==s&&"sha2-512"!==s){const e=Object.keys(c).join(" / ");throw new r.s(`Hash '${s}' is unknown or not supported. Must be ${e}`,"ERR_UNSUPPORTED_HASH_TYPE")}const u=c[s],l=o(e,t,n,i,u);return a.encode64(l,null)}},86906:function(e,t,n){"use strict";n.r(t),n.d(t,{generateEphemeralKeyPair:function(){return N},generateKeyPair:function(){return mt},generateKeyPairFromSeed:function(){return wt},importKey:function(){return St},keyStretcher:function(){return w},keysPBM:function(){return r},marshalPrivateKey:function(){return _t},marshalPublicKey:function(){return Et},supportedKeys:function(){return pt},unmarshalPrivateKey:function(){return vt},unmarshalPublicKey:function(){return bt}});var r={};n.r(r),n.d(r,{KeyType:function(){return a},PrivateKey:function(){return l},PublicKey:function(){return u}});var i={};n.r(i),n.d(i,{RsaPrivateKey:function(){return j},RsaPublicKey:function(){return F},fromJwk:function(){return H},generateKeyPair:function(){return G},unmarshalRsaPrivateKey:function(){return K},unmarshalRsaPublicKey:function(){return q}});var s={};n.r(s),n.d(s,{Ed25519PrivateKey:function(){return tt},Ed25519PublicKey:function(){return et},generateKeyPair:function(){return it},generateKeyPairFromSeed:function(){return st},unmarshalEd25519PrivateKey:function(){return nt},unmarshalEd25519PublicKey:function(){return rt}});var o={};n.r(o),n.d(o,{Secp256k1PrivateKey:function(){return lt},Secp256k1PublicKey:function(){return ut},generateKeyPair:function(){return ft},unmarshalSecp256k1PrivateKey:function(){return ht},unmarshalSecp256k1PublicKey:function(){return dt}});var a,c,u,l,h=n(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(a||(a={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(c||(c={})),function(e){e.codec=()=>(0,h.Ji)(c)}(a||(a={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),a.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=a.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(u||(u={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),a.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=a.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(l||(l={}));n(3068),n(97450);var d=n(3832),f=n(52770),p=n(77408),y=n(41690),g=n(63042);const m={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function w(e,t,n){const r=m[e];if(null==r){const t=Object.keys(m).join(" / ");throw new f.s(`unknown cipher type '${e}'. Must be ${t}`,"ERR_INVALID_CIPHER_TYPE")}if(null==t)throw new f.s("missing hash type","ERR_MISSING_HASH_TYPE");const i=r.keySize,s=r.ivSize,o=(0,p.m)("key expansion"),a=2*(s+i+20),c=await g.U(t,n);let u=await c.digest(o);const l=[];let h=0;for(;h<a;){const e=await c.digest((0,y.z)([u,o]));let t=e.length;h+t>a&&(t=a-h),l.push(e),h+=t,u=await c.digest(u)}const d=a/2,w=(0,y.z)(l),b=w.subarray(0,d),E=w.subarray(d,a),v=e=>({iv:e.subarray(0,s),cipherKey:e.subarray(s,s+i),macKey:e.subarray(s+i)});return{k1:v(b),k2:v(E)}}var b=n(44234),E=(n(97116),n(15764),n(49784));function v(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,y.z)([new Uint8Array(t-n.length),n])}return(0,E.B)(n,"base64url")}function _(e){const t=S(e);return new d.jsbn.BigInteger((0,E.B)(t,"base16"),16)}function S(e,t){let n=(0,p.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,y.z)([new Uint8Array(t-n.length),n])}return n}var R=n(73062);const A={"P-256":256,"P-384":384,"P-521":521},I=Object.keys(A).join(" / ");const T={"P-256":32,"P-384":48,"P-521":66};function C(e){if(null==e.crv||null==e.x||null==e.y)throw new f.s("JWK was missing components","ERR_INVALID_PARAMETERS");if("P-256"!==e.crv&&"P-384"!==e.crv&&"P-521"!==e.crv)throw new f.s(`Unknown curve: ${e.crv}. Must be ${I}`,"ERR_INVALID_CURVE");const t=T[e.crv];return(0,y.z)([Uint8Array.from([4]),S(e.x,t),S(e.y,t)],1+2*t)}function P(e,t){if("P-256"!==e&&"P-384"!==e&&"P-521"!==e)throw new f.s(`Unknown curve: ${e}. Must be ${I}`,"ERR_INVALID_CURVE");const n=T[e];if(!(0,R.f)(t.subarray(0,1),Uint8Array.from([4])))throw new f.s("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:(0,E.B)(t.subarray(1,n+1),"base64url"),y:(0,E.B)(t.subarray(1+n),"base64url"),ext:!0}}const k=(e,t)=>({...P(e,t.public),d:(0,E.B)(t.private,"base64url")});var N=async function(e){if("P-256"!==e&&"P-384"!==e&&"P-521"!==e)throw new f.s(`Unknown curve: ${e}. Must be ${I}`,"ERR_INVALID_CURVE");const t=await b.Z.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]);return{key:C(await b.Z.get().subtle.exportKey("jwk",t.publicKey)),genSharedKey:async(n,r)=>{let i;i=null!=r?await b.Z.get().subtle.importKey("jwk",k(e,r),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):t.privateKey;const s=await b.Z.get().subtle.importKey("jwk",P(e,n),{name:"ECDH",namedCurve:e},!1,[]),o=await b.Z.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:s},i,A[e]);return new Uint8Array(o,0,o.byteLength)}}},x=n(99382);function D(e){const t=e?.algorithm??"AES-GCM";let n=e?.keyLength??16;const r=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=b.Z.get();n*=8;return{encrypt:async function(e,c){const u=a.getRandomValues(new Uint8Array(s)),l=a.getRandomValues(new Uint8Array(r)),h={name:t,iv:l};"string"==typeof c&&(c=(0,p.m)(c));const d={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},f=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),g=await a.subtle.deriveKey(d,f,{name:t,length:n},!0,["encrypt"]),m=await a.subtle.encrypt(h,g,e);return(0,y.z)([u,h.iv,new Uint8Array(m)])},decrypt:async function(e,c){const u=e.subarray(0,s),l=e.subarray(s,s+r),h=e.subarray(s+r),d={name:t,iv:l};"string"==typeof c&&(c=(0,p.m)(c));const f={name:"PBKDF2",salt:u,iterations:o,hash:{name:i}},y=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),g=await a.subtle.deriveKey(f,y,{name:t,length:n},!0,["decrypt"]),m=await a.subtle.decrypt(d,g,h);return new Uint8Array(m)}}}var L=n(27353),O=(n(63219),n(95887));n(28095);function U(e,t){return t.map((t=>_(e[t])))}async function M(e){const t=[await b.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await z(e)],n=await B({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function B(e){if(null==e.privateKey||null==e.publicKey)throw new f.s("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([b.Z.get().subtle.exportKey("jwk",e.privateKey),b.Z.get().subtle.exportKey("jwk",e.publicKey)])}async function z(e){return await b.Z.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function V(e,t,n,r){const i=t?function(e){return d.pki.setRsaPublicKey(...U(e,["n","e"]))}(e):function(e){return d.pki.setRsaPrivateKey(...U(e,["n","e","d","p","q","dp","dq","qi"]))}(e),s=r((0,E.B)(Uint8Array.from(n),"ascii"),i);return(0,p.m)(s,"ascii")}async function $(e,t){const n=D(),r=await n.encrypt(e,t);return x.base64.encode(r)}class F{constructor(e){this._key=e}async verify(e,t){return await async function(e,t,n){const r=await b.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await b.Z.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new f.s("JWK was missing components","ERR_INVALID_PARAMETERS");const t=d.pki.publicKeyToAsn1({n:_(e.n),e:_(e.e)});return(0,p.m)(d.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return u.encode({Type:a.RSA,Data:this.marshal()}).subarray()}encrypt(e){return V(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}}class j{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return O.Z(16)}async sign(e){return await async function(e,t){const n=await b.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await b.Z.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new f.s("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new F(this._publicKey)}decrypt(e){return V(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new f.s("JWK was missing components","ERR_INVALID_PARAMETERS");const t=d.pki.privateKeyToAsn1({n:_(e.n),e:_(e.e),d:_(e.d),p:_(e.p),q:_(e.q),dP:_(e.dp),dQ:_(e.dq),qInv:_(e.qi)});return(0,p.m)(d.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return l.encode({Type:a.RSA,Data:this.marshal()}).subarray()}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,E.B)(e,"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new d.util.ByteBuffer(this.marshal()),n=d.asn1.fromDer(t),r=d.pki.privateKeyFromAsn1(n),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return d.pki.encryptRsaPrivateKey(r,e,i)}if("libp2p-key"===t)return await $(this.bytes,e);throw new f.s(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function K(e){const t=function(e){const t=d.asn1.fromDer((0,E.B)(e,"ascii")),n=d.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:v(n.n),e:v(n.e),d:v(n.d),p:v(n.p),q:v(n.q),dp:v(n.dP),dq:v(n.dQ),qi:v(n.qInv),alg:"RS256"}}(e),n=await M(t);return new j(n.privateKey,n.publicKey)}function q(e){const t=function(e){const t=d.asn1.fromDer((0,E.B)(e,"ascii")),n=d.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:v(n.n),e:v(n.e)}}(e);return new F(t)}async function H(e){const t=await M(e);return new j(t.privateKey,t.publicKey)}async function G(e){const t=await async function(e){const t=await b.Z.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await B(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new j(t.privateKey,t.publicKey)}var Z=n(81653),W=n(38566),Q=n(81949),Y=n.t(Q,2);const J=BigInt(0),X=BigInt(1),ee=BigInt(2),te=BigInt(8),ne=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),re=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:ne,n:ne,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),ie=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),se=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),oe=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),ae=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),ce=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ue=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class le{constructor(e,t,n,r){this.x=e,this.y=t,this.z=n,this.t=r}static fromAffine(e){if(!(e instanceof me))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(me.ZERO)?le.ZERO:new le(e.x,e.y,X,Pe(e.x*e.y))}static toAffineBatch(e){const t=function(e,t=re.P){const n=new Array(e.length),r=ke(e.reduce(((e,r,i)=>r===J?e:(n[i]=e,Pe(e*r,t))),X),t);return e.reduceRight(((e,r,i)=>r===J?e:(n[i]=Pe(e*n[i],t),Pe(e*r,t))),r),n}(e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){de(e);const{x:t,y:n,z:r}=this,{x:i,y:s,z:o}=e,a=Pe(t*o),c=Pe(i*r),u=Pe(n*o),l=Pe(s*r);return a===c&&u===l}negate(){return new le(Pe(-this.x),this.y,this.z,Pe(-this.t))}double(){const{x:e,y:t,z:n}=this,{a:r}=re,i=Pe(e*e),s=Pe(t*t),o=Pe(ee*Pe(n*n)),a=Pe(r*i),c=e+t,u=Pe(Pe(c*c)-i-s),l=a+s,h=l-o,d=a-s,f=Pe(u*h),p=Pe(l*d),y=Pe(u*d),g=Pe(h*l);return new le(f,p,g,y)}add(e){de(e);const{x:t,y:n,z:r,t:i}=this,{x:s,y:o,z:a,t:c}=e,u=Pe((n-t)*(o+s)),l=Pe((n+t)*(o-s)),h=Pe(l-u);if(h===J)return this.double();const d=Pe(r*ee*c),f=Pe(i*ee*a),p=f+d,y=l+u,g=f-d,m=Pe(p*h),w=Pe(y*g),b=Pe(p*g),E=Pe(h*y);return new le(m,w,E,b)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,n=[];let r=this,i=r;for(let s=0;s<t;s++){i=r,n.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(r),n.push(i);r=i.double()}return n}wNAF(e,t){!t&&this.equals(le.BASE)&&(t=me.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=t&&ge.get(t);r||(r=this.precomputeWindow(n),t&&1!==n&&(r=le.normalizeZ(r),ge.set(t,r)));let i=le.ZERO,s=le.BASE;const o=1+256/n,a=2**(n-1),c=BigInt(2**n-1),u=2**n,l=BigInt(n);for(let t=0;t<o;t++){const n=t*a;let o=Number(e&c);e>>=l,o>a&&(o-=u,e+=X);const h=n,d=n+Math.abs(o)-1,f=t%2!=0,p=o<0;0===o?s=s.add(he(f,r[h])):i=i.add(he(p,r[d]))}return le.normalizeZ([i,s])[0]}multiply(e,t){return this.wNAF(Me(e,re.l),t)}multiplyUnsafe(e){let t=Me(e,re.l,!1);const n=le.BASE,r=le.ZERO;if(t===J)return r;if(this.equals(r)||t===X)return this;if(this.equals(n))return this.wNAF(t);let i=r,s=this;for(;t>J;)t&X&&(i=i.add(s)),s=s.double(),t>>=X;return i}isSmallOrder(){return this.multiplyUnsafe(re.h).equals(le.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(re.l/ee).double();return re.l%ee&&(e=e.add(this)),e.equals(le.ZERO)}toAffine(e){const{x:t,y:n,z:r}=this,i=this.equals(le.ZERO);null==e&&(e=i?te:ke(r));const s=Pe(t*e),o=Pe(n*e),a=Pe(r*e);if(i)return me.ZERO;if(a!==X)throw new Error("invZ was invalid");return new me(s,o)}fromRistrettoBytes(){pe()}toRistrettoBytes(){pe()}fromRistrettoHash(){pe()}}function he(e,t){const n=t.negate();return e?n:t}function de(e){if(!(e instanceof le))throw new TypeError("ExtendedPoint expected")}function fe(e){if(!(e instanceof ye))throw new TypeError("RistrettoPoint expected")}function pe(){throw new Error("Legacy method: switch to RistrettoPoint")}le.BASE=new le(re.Gx,re.Gy,X,Pe(re.Gx*re.Gy)),le.ZERO=new le(J,X,X,J);class ye{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=re,n=Pe(se*e*e),r=Pe((n+X)*ce);let i=BigInt(-1);const s=Pe((i-t*n)*Pe(n+t));let{isValid:o,value:a}=De(r,s),c=Pe(a*e);Ae(c)||(c=Pe(-c)),o||(a=c),o||(i=n);const u=Pe(i*(n-X)*ue-s),l=a*a,h=Pe((a+a)*s),d=Pe(u*oe),f=Pe(X-l),p=Pe(X+l);return new le(Pe(h*p),Pe(f*d),Pe(d*p),Pe(h*f))}static hashToCurve(e){const t=Ce((e=Ue(e,64)).slice(0,32)),n=this.calcElligatorRistrettoMap(t),r=Ce(e.slice(32,64)),i=this.calcElligatorRistrettoMap(r);return new ye(n.add(i))}static fromHex(e){e=Ue(e,32);const{a:t,d:n}=re,r="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=Ce(e);if(!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(Re(i),e)||Ae(i))throw new Error(r);const s=Pe(i*i),o=Pe(X+t*s),a=Pe(X-t*s),c=Pe(o*o),u=Pe(a*a),l=Pe(t*n*c-u),{isValid:h,value:d}=Le(Pe(l*u)),f=Pe(d*a),p=Pe(d*f*l);let y=Pe((i+i)*f);Ae(y)&&(y=Pe(-y));const g=Pe(o*p),m=Pe(y*g);if(!h||Ae(m)||g===J)throw new Error(r);return new ye(new le(y,g,X,m))}toRawBytes(){let{x:e,y:t,z:n,t:r}=this.ep;const i=Pe(Pe(n+t)*Pe(n-t)),s=Pe(e*t),o=Pe(s*s),{value:a}=Le(Pe(i*o)),c=Pe(a*i),u=Pe(a*s),l=Pe(c*u*r);let h;if(Ae(r*l)){let n=Pe(t*se),r=Pe(e*se);e=n,t=r,h=Pe(c*ae)}else h=u;Ae(e*l)&&(t=Pe(-t));let d=Pe((n-t)*h);return Ae(d)&&(d=Pe(-d)),Re(d)}toHex(){return ve(this.toRawBytes())}toString(){return this.toHex()}equals(e){fe(e);const t=this.ep,n=e.ep,r=Pe(t.x*n.y)===Pe(t.y*n.x),i=Pe(t.y*n.y)===Pe(t.x*n.x);return r||i}add(e){return fe(e),new ye(this.ep.add(e.ep))}subtract(e){return fe(e),new ye(this.ep.subtract(e.ep))}multiply(e){return new ye(this.ep.multiply(e))}multiplyUnsafe(e){return new ye(this.ep.multiplyUnsafe(e))}}ye.BASE=new ye(le.BASE),ye.ZERO=new ye(le.ZERO);const ge=new WeakMap;class me{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,ge.delete(this)}static fromHex(e,t=!0){const{d:n,P:r}=re,i=(e=Ue(e,32)).slice();i[31]=-129&e[31];const s=Ie(i);if(t&&s>=r)throw new Error("Expected 0 < hex < P");if(!t&&s>=ie)throw new Error("Expected 0 < hex < 2**256");const o=Pe(s*s),a=Pe(o-X),c=Pe(n*o+X);let{isValid:u,value:l}=De(a,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");const h=(l&X)===X;return 0!=(128&e[31])!==h&&(l=Pe(-l)),new me(l,s)}static async fromPrivateKey(e){return(await Fe(e)).point}toRawBytes(){const e=Re(this.y);return e[31]|=this.x&X?128:0,e}toHex(){return ve(this.toRawBytes())}toX25519(){const{y:e}=this;return Re(Pe((X+e)*ke(X-e)))}isTorsionFree(){return le.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new me(Pe(-this.x),this.y)}add(e){return le.fromAffine(this).add(le.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return le.fromAffine(this).multiply(e,this).toAffine()}}me.BASE=new me(re.Gx,re.Gy),me.ZERO=new me(J,X);class we{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=Ue(e,64),n=me.fromHex(t.slice(0,32),!1),r=Ie(t.slice(32,64));return new we(n,r)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof me))throw new Error("Expected Point instance");return Me(t,re.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Re(this.s),32),e}toHex(){return ve(this.toRawBytes())}}function be(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}const Ee=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function ve(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Ee[e[n]];return t}function _e(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,i=e.slice(r,r+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function Se(e){return _e(e.toString(16).padStart(64,"0"))}function Re(e){return Se(e).reverse()}function Ae(e){return(Pe(e)&X)===X}function Ie(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+ve(Uint8Array.from(e).reverse()))}const Te=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Ce(e){return Pe(Ie(e)&Te)}function Pe(e,t=re.P){const n=e%t;return n>=J?n:t+n}function ke(e,t=re.P){if(e===J||t<=J)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Pe(e,t),r=t,i=J,s=X,o=X,a=J;for(;n!==J;){const e=r/n,t=r%n,c=i-o*e,u=s-a*e;r=n,n=t,i=o,s=a,o=c,a=u}if(r!==X)throw new Error("invert: does not exist");return Pe(i,t)}function Ne(e,t){const{P:n}=re;let r=e;for(;t-- >J;)r*=r,r%=n;return r}function xe(e){const{P:t}=re,n=BigInt(5),r=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),a=e*e%t*e%t,c=Ne(a,ee)*a%t,u=Ne(c,X)*e%t,l=Ne(u,n)*u%t,h=Ne(l,r)*l%t,d=Ne(h,i)*h%t,f=Ne(d,s)*d%t,p=Ne(f,o)*f%t,y=Ne(p,o)*f%t,g=Ne(y,r)*l%t;return{pow_p_5_8:Ne(g,ee)*e%t,b2:a}}function De(e,t){const n=Pe(t*t*t),r=Pe(n*n*t);let i=Pe(e*n*xe(e*r).pow_p_5_8);const s=Pe(t*i*i),o=i,a=Pe(i*se),c=s===e,u=s===Pe(-e),l=s===Pe(-e*se);return c&&(i=o),(u||l)&&(i=a),Ae(i)&&(i=Pe(-i)),{isValid:c||u,value:i}}function Le(e){return De(X,e)}function Oe(e){return Pe(Ie(e),re.l)}function Ue(e,t){const n=e instanceof Uint8Array?Uint8Array.from(e):_e(e);if("number"==typeof t&&n.length!==t)throw new Error(`Expected ${t} bytes`);return n}function Me(e,t,n=!0){if(!t)throw new TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t)if(n){if(J<e)return e}else if(J<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Be(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function ze(e){if(32!==(e="bigint"==typeof e||"number"==typeof e?Se(Me(e,ie)):Ue(e)).length)throw new Error("Expected 32 bytes");return e}function Ve(e){const t=Be(e.slice(0,32)),n=e.slice(32,64),r=Oe(t),i=me.BASE.multiply(r),s=i.toRawBytes();return{head:t,prefix:n,scalar:r,point:i,pointBytes:s}}let $e;async function Fe(e){return Ve(await Ge.sha512(ze(e)))}async function je(e){return(await Fe(e)).pointBytes}function Ke(e,t,n){t=Ue(t),n instanceof me||(n=me.fromHex(n,!1));const{r:r,s:i}=e instanceof we?e.assertValidity():we.fromHex(e);return{r:r,s:i,SB:le.BASE.multiplyUnsafe(i),pub:n,msg:t}}function qe(e,t,n,r){const i=Oe(r),s=le.fromAffine(e).multiplyUnsafe(i);return le.fromAffine(t).add(s).subtract(n).multiplyUnsafe(re.h).equals(le.ZERO)}me.BASE._setWindowSize(8);const He={node:Y,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Ge={bytesToHex:ve,hexToBytes:_e,concatBytes:be,getExtendedPublicKey:Fe,mod:Pe,invert:ke,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if((e=Ue(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Pe(Ie(e),re.l-X)+X},randomBytes:(e=32)=>{if(He.web)return He.web.getRandomValues(new Uint8Array(e));if(He.node){const{randomBytes:t}=He.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ge.randomBytes(32),sha512:async(...e)=>{const t=be(...e);if(He.web){const e=await He.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(He.node)return Uint8Array.from(He.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=me.BASE){const n=t.equals(me.BASE)?t:new me(t.x,t.y);return n._setWindowSize(e),n.multiply(ee),n},sha512Sync:void 0};Object.defineProperties(Ge,{sha512Sync:{configurable:!1,get:()=>$e,set(e){$e||($e=e)}}});const Ze=32,We=64,Qe=32;async function Ye(e,t){const n=e.subarray(0,Qe);return await async function(e,t){e=Ue(e);const{prefix:n,scalar:r,pointBytes:i}=await Fe(t),s=Oe(await Ge.sha512(n,e)),o=me.BASE.multiply(s),a=Pe(s+Oe(await Ge.sha512(o.toRawBytes(),i,e))*r,re.l);return new we(o,a).toRawBytes()}(t,n)}async function Je(e,t,n){return await async function(e,t,n){const{r:r,SB:i,msg:s,pub:o}=Ke(e,t,n),a=await Ge.sha512(r.toRawBytes(),o.toRawBytes(),s);return qe(o,r,i,a)}(t,n,e)}function Xe(e,t){const n=new Uint8Array(We);for(let r=0;r<Qe;r++)n[r]=e[r],n[Qe+r]=t[r];return n}class et{constructor(e){this._key=ot(e,Ze)}async verify(e,t){return await Je(this._key,t,e)}marshal(){return this._key}get bytes(){return u.encode({Type:a.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}}class tt{constructor(e,t){this._key=ot(e,We),this._publicKey=ot(t,Ze)}async sign(e){return await Ye(this._key,e)}get public(){return new et(this._publicKey)}marshal(){return this._key}get bytes(){return l.encode({Type:a.Ed25519,Data:this.marshal()}).subarray()}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}async id(){const e=W.identity.digest(this.public.bytes);return Z.base58btc.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await $(this.bytes,e);throw new f.s(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function nt(e){if(e.length>We){const t=(e=ot(e,We+Ze)).subarray(0,We),n=e.subarray(We,e.length);return new tt(t,n)}const t=(e=ot(e,We)).subarray(0,We),n=e.subarray(Ze);return new tt(t,n)}function rt(e){return e=ot(e,Ze),new et(e)}async function it(){const{privateKey:e,publicKey:t}=await async function(){const e=Ge.randomPrivateKey(),t=await je(e);return{privateKey:Xe(e,t),publicKey:t}}();return new tt(e,t)}async function st(e){const{privateKey:t,publicKey:n}=await async function(e){if(e.length!==Qe)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=await je(t);return{privateKey:Xe(t,n),publicKey:n}}(e);return new tt(t,n)}function ot(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw new f.s(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var at=n(27760);function ct(e){try{at.E9.fromHex(e)}catch(e){throw new f.s(String(e),"ERR_INVALID_PUBLIC_KEY")}}class ut{constructor(e){ct(e),this._key=e}async verify(e,t){return await async function(e,t,n){try{const{digest:r}=await L.sha256.digest(n);return at.T(t,r,e)}catch(e){throw new f.s(String(e),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,at.E9.fromHex(e).toRawBytes(!0);var e}get bytes(){return u.encode({Type:a.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}}class lt{constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return at.$3(e,!0)}catch(e){throw new f.s(String(e),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{at.$3(e,!0)}catch(e){throw new f.s(String(e),"ERR_INVALID_PRIVATE_KEY")}}(this._key),ct(this._publicKey)}async sign(e){return await async function(e,t){const{digest:n}=await L.sha256.digest(t);try{return await at.Xx(n,e)}catch(e){throw new f.s(String(e),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new ut(this._publicKey)}marshal(){return this._key}get bytes(){return l.encode({Type:a.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return(0,R.f)(this.bytes,e.bytes)}async hash(){const{bytes:e}=await L.sha256.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,E.B)(e,"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await $(this.bytes,e);throw new f.s(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function ht(e){return new lt(e)}function dt(e){return new ut(e)}async function ft(){const e=at.P6.randomPrivateKey();return new lt(e)}const pt={rsa:i,ed25519:s,secp256k1:o};function yt(e){const t=Object.keys(pt).join(" / ");return new f.s(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function gt(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return pt[e];throw yt(e)}async function mt(e,t){return await gt(e).generateKeyPair(t??2048)}async function wt(e,t,n){if("ed25519"!==e.toLowerCase())throw new f.s("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await st(t)}function bt(e){const t=u.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case a.RSA:return pt.rsa.unmarshalRsaPublicKey(n);case a.Ed25519:return pt.ed25519.unmarshalEd25519PublicKey(n);case a.Secp256k1:return pt.secp256k1.unmarshalSecp256k1PublicKey(n);default:throw yt(t.Type??"RSA")}}function Et(e,t){return gt(t=(t??"rsa").toLowerCase()),e.bytes}async function vt(e){const t=l.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case a.RSA:return await pt.rsa.unmarshalRsaPrivateKey(n);case a.Ed25519:return pt.ed25519.unmarshalEd25519PrivateKey(n);case a.Secp256k1:return pt.secp256k1.unmarshalSecp256k1PrivateKey(n);default:throw yt(t.Type??"RSA")}}function _t(e,t){return gt(t=(t??"rsa").toLowerCase()),e.bytes}async function St(e,t){try{const n=await async function(e,t){const n=x.base64.decode(e),r=D();return await r.decrypt(n,t)}(e,t);return await vt(n)}catch(e){}const n=d.pki.decryptRsaPrivateKey(e,t);if(null===n)throw new f.s("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let r=d.asn1.toDer(d.pki.privateKeyToAsn1(n));return r=(0,p.m)(r.getBytes(),"ascii"),await pt.rsa.unmarshalRsaPrivateKey(r)}},95887:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(27760),i=n(52770);function s(e){if(isNaN(e)||e<=0)throw new i.s("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return r.P6.randomBytes(e)}},44234:function(e,t){"use strict";t.Z={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}}},35505:function(e,t,n){"use strict";n.d(t,{OP:function(){return p}});var r=n(69860),i=n(93361),s=n(95972),o=n(85275),a=n(32114),c=n(32044);const u=(0,r.kg)("libp2p:delegated-content-routing"),l=3e4;var h,d;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(h||(h={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(d||(d={}));class f{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new s.Z({concurrency:4}),this.httpQueueRefs=new s.Z({concurrency:2});const{protocol:t,host:n,port:r}=e.getEndpointConfig();u(`enabled DelegatedContentRouting via ${t}://${n}:${r}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){u("findProviders starts: %c",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=(0,o.Z)(),r=(0,o.Z)();this.httpQueue.add((async()=>(n.resolve(),await r.promise)));try{await n.promise;for await(const n of this.client.dht.findProvs(e,t))"PROVIDER"===n.name&&(yield*n.providers.map((e=>({id:e.id,protocols:[],multiaddrs:e.multiaddrs}))))}catch(e){throw u.error("findProviders errored:",e),e}finally{r.resolve(),u("findProviders finished: %c",e)}}async provide(e,t={}){u("provide starts: %c",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueueRefs.add((async()=>{await this.client.block.stat(e,t),await(0,i.Z)(this.client.dht.provide(e,t))})),u("provide finished: %c",e)}async put(e,t,n={}){u("put value start: %b",e),n.timeout=n.timeout??l,n.signal=c([this.abortController.signal].concat(null!=n.signal?[n.signal]:[])),await this.httpQueue.add((async()=>{await(0,i.Z)(this.client.dht.put(e,t,n))})),u("put value finished: %b",e)}async get(e,t={}){u("get value start: %b",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=await this.httpQueue.add((async()=>{for await(const n of this.client.dht.get(e,t))if("VALUE"===n.name)return u("get value finished: %b",e),n.value;throw a(new Error("Not found"),"ERR_NOT_FOUND")}));if(void 0===n)throw a(new Error("Not found"),"ERR_NOT_FOUND");return n}}function p(e){return()=>new f(e)}},38532:function(e,t,n){"use strict";n.d(t,{e8:function(){return p}});var r=n(69860),i=n(38161),s=n(95972),o=n(85275),a=n(52770),c=n(32044),u=n(23366);const l=(0,r.kg)("libp2p:delegated-peer-routing");var h,d;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(h||(h={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(d||(d={}));class f{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new s.Z({concurrency:4});const{protocol:t,host:n,port:r}=e.getEndpointConfig();l(`enabled DelegatedPeerRouting via ${t}://${n}:${r}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){l("findPeer starts: %p",e),t.timeout=t.timeout??3e4,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=(0,o.Z)(),r=(0,o.Z)();this.httpQueue.add((async()=>(n.resolve(),await r.promise)));try{await n.promise;for await(const n of this.client.dht.findPeer(e,t))if("FINAL_PEER"===n.name){return{id:n.peer.id,multiaddrs:n.peer.multiaddrs,protocols:[]}}}catch(e){throw l.error("findPeer errored: %o",e),e}finally{r.resolve(),l("findPeer finished: %p",e)}throw new a.s("Not found","ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let n;const r=i.k0.asCID(e);n=null!=r?r:(0,u.cv)(e),l("getClosestPeers starts: %s",n),t.timeout=t.timeout??3e4,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const s=(0,o.Z)(),a=(0,o.Z)();this.httpQueue.add((async()=>(s.resolve(),await a.promise)));try{await s.promise;for await(const e of this.client.dht.query(n,t))"PEER_RESPONSE"===e.name&&(yield*e.closer.map((e=>({id:e.id,multiaddrs:e.multiaddrs,protocols:[]}))))}catch(e){throw l.error("getClosestPeers errored:",e),e}finally{a.resolve(),l("getClosestPeers finished: %b",e)}}}function p(e){return()=>new f(e)}},19859:function(e,t,n){"use strict";n.d(t,{kT:function(){return r},kz:function(){return i}});class r extends Error{constructor(e="Unexpected Peer"){super(e),this.code=r.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class i extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=i.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class s extends Error{constructor(e="Invalid crypto transmission"){super(e),this.code=s.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}},48302:function(e,t,n){"use strict";n.d(t,{N:function(){return r}});const r=Symbol.for("@libp2p/connection")},80486:function(e,t,n){"use strict";n.d(t,{Z5:function(){return i},m$:function(){return s},o1:function(){return r}});const r="OPEN",i="CLOSING",s="CLOSED"},59769:function(e,t,n){"use strict";n.d(t,{N:function(){return r}});const r=Symbol.for("@libp2p/peer-discovery")},682:function(e,t,n){"use strict";n.d(t,{I:function(){return i},N:function(){return r}});const r=Symbol.for("@libp2p/peer-id");function i(e){return null!=e&&Boolean(e[r])}},43710:function(e,t,n){"use strict";n.d(t,{$:function(){return r}});const r="keep-alive"},6834:function(e,t,n){"use strict";n.d(t,{Ct:function(){return s},Q_:function(){return i},xq:function(){return r}});const r="StrictSign",i="StrictNoSign";var s;!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(s||(s={}))},1388:function(e,t,n){"use strict";n.d(t,{d:function(){return r},w:function(){return i}});const r=Symbol.for("@libp2p/topology");function i(e){return null!=e&&Boolean(e[r])}},12348:function(e,t,n){"use strict";n.d(t,{NA:function(){return r},P7:function(){return i}});const r=Symbol.for("@libp2p/transport");var i;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(i||(i={}))},27710:function(e,t,n){"use strict";n.d(t,{J:function(){return r}});const r=Symbol.for("@libp2p/content-routing")},49541:function(e,t,n){"use strict";n.d(t,{_L:function(){return r},kT:function(){return s},kz:function(){return o},sv:function(){return i}});class r extends Error{code;type;constructor(e="The operation was aborted"){super(e),this.code=r.code,this.type=r.type}static code="ABORT_ERR";static type="aborted"}class i extends Error{code;props;constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}}class s extends Error{code;constructor(e="Unexpected Peer"){super(e),this.code=s.code}static code="ERR_UNEXPECTED_PEER"}class o extends Error{code;constructor(e="Invalid crypto exchange"){super(e),this.code=o.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"}class a extends Error{code;constructor(e="Invalid crypto transmission"){super(e),this.code=a.code}static code=null}},23247:function(e,t,n){"use strict";n.d(t,{A:function(){return s},v:function(){return r}});class r extends EventTarget{#i=new Map;listenerCount(e){const t=this.#i.get(e);return null==t?0:t.length}addEventListener(e,t,n){super.addEventListener(e,t,n);let r=this.#i.get(e);null==r&&(r=[],this.#i.set(e,r)),r.push({callback:t,once:(!0!==n&&!1!==n&&n?.once)??!1})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),t??null,n);let r=this.#i.get(e);null!=r&&(r=r.filter((({callback:e})=>e!==t)),this.#i.set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=this.#i.get(e.type);return null==n||(n=n.filter((({once:e})=>!e)),this.#i.set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new s(e,t))}}class i extends Event{detail;constructor(e,t){super(e,t),this.detail=t?.detail}}const s=globalThis.CustomEvent??i},40480:function(e,t,n){"use strict";n.d(t,{s:function(){return i}});class r extends Map{metric;constructor(e){super();const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function i(e){const{name:t,metrics:n}=e;let i;return i=null!=n?new r({name:t,metrics:n}):new Map,i}},85521:function(e,t,n){"use strict";n.d(t,{O:function(){return r}});const r=Symbol.for("@libp2p/peer-discovery")},5681:function(e,t,n){"use strict";n.d(t,{I:function(){return i},N:function(){return r}});const r=Symbol.for("@libp2p/peer-id");function i(e){return null!=e&&Boolean(e[r])}},77309:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});const r=Symbol.for("@libp2p/peer-routing")},11940:function(e,t,n){"use strict";n.d(t,{$:function(){return r}});const r="keep-alive"},92679:function(e,t,n){"use strict";n.d(t,{Ct:function(){return s},Q_:function(){return i},xq:function(){return r}});const r="StrictSign",i="StrictNoSign";var s;!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(s||(s={}))},86125:function(e,t,n){"use strict";function r(e){return null!=e&&"function"==typeof e.start&&"function"==typeof e.stop}n.d(t,{qK:function(){return r}})},6146:function(e,t,n){"use strict";n.d(t,{b:function(){return f}});class r extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}var i=n(94791);function s(e,t,n){const s=n??{},o=(0,i.A)(e);return async function*(){let n;const i=()=>{null!=n&&n()};for(t.addEventListener("abort",i);;){let a;try{if(t.aborted){const{abortMessage:e,abortCode:t}=s;throw new r(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=s;t(new r(e,n))}}));a=await Promise.race([e,o.next()]),n=null}catch(n){t.removeEventListener("abort",i);const r="aborted"===n.type&&t.aborted;if(r&&null!=s.onAbort&&s.onAbort(e),"function"==typeof o.return)try{const e=o.return();e instanceof Promise&&e.catch((e=>{null!=s.onReturnError&&s.onReturnError(e)}))}catch(e){null!=s.onReturnError&&s.onReturnError(e)}if(r&&!0===s.returnOnAbort)return;throw n}if(!0===a.done)break;yield a.value}t.removeEventListener("abort",i)}()}var o=n(85275),a=n(59217);class c extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function u(e,t){let n,r,i,s=(t=t??{}).onEnd,u=new a.u,l=(0,o.Z)();const h=e=>null!=r?r(e):(u.push(e),n),d=e=>{if(i)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return h({done:!1,value:e})},f=e=>i?n:(i=!0,null!=e?(e=>(u=new a.u,null!=r?r({error:e}):(u.push({error:e}),n)))(e):h({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return u.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,u.push(s);try{t(e(u))}catch(e){i(e)}return n}})):e(u)}finally{u.isEmpty()&&queueMicrotask((()=>{l.resolve(),l=(0,o.Z)()}))}},return:()=>(u=new a.u,f(),{done:!0}),throw:e=>(f(e),{done:!0}),push:d,end:f,get readableLength(){return u.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),u.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new c)},t.addEventListener("abort",r)})));try{await Promise.race([l.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==s)return n;const p=n;return n={[Symbol.asyncIterator](){return this},next:()=>p.next(),throw:e=>(p.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(p.return(),null!=s&&(s(),s=void 0),{done:!0}),push:d,end:e=>(p.end(e),null!=s&&(s(e),s=void 0),n),get readableLength(){return p.readableLength}},n}var l=n(62308),h=n(49541);function d(e){return null!=e&&"function"==typeof e.then}class f{id;direction;timeline;protocol;metadata;source;status;readStatus;writeStatus;sinkController;sinkEnd;endErr;streamSource;onEnd;onCloseRead;onCloseWrite;onReset;onAbort;log;constructor(e){this.sinkController=new AbortController,this.sinkEnd=(0,o.Z)(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=e.metadata??{},this.direction=e.direction,this.timeline={open:Date.now()},this.onEnd=e.onEnd,this.onCloseRead=e?.onCloseRead,this.onCloseWrite=e?.onCloseWrite,this.onReset=e?.onReset,this.onAbort=e?.onAbort,this.source=this.streamSource=function(e={}){return u((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.readStatus="closed",this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new h.sv(`writable end state is "${this.writeStatus}" not "ready"`,"ERR_SINK_INVALID_STATE");try{this.writeStatus="writing";const t={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(t);d(e)&&await e}e=s(e,this.sinkController.signal,{returnOnAbort:!0}),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new l.H(n):n;const e=this.sendData(n,t);d(e)&&await e}this.log.trace("sink finished reading from source"),this.writeStatus="done",this.log.trace("sink calling closeWrite"),await this.closeWrite(t),this.onSinkEnd()}catch(e){throw this.log.trace("sink ended with error, calling abort with error",e),this.abort(e),e}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),null!=e&&null==this.endErr&&(this.endErr=e),this.onCloseRead?.(),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),null!=e&&null==this.endErr&&(this.endErr=e),this.onCloseWrite?.(),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await Promise.all([this.closeRead(e),this.closeWrite(e)]),this.status="closed",this.log.trace("closed gracefully")}async closeRead(e={}){if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","ready"===t&&(this.log.trace("ending internal source queue"),this.streamSource.end()),"reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),this.log.trace("closed readable end of stream")}async closeWrite(e={}){if("closing"===this.writeStatus||"closed"===this.writeStatus)return;this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus);const t=this.writeStatus;"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await this.sink([])),this.writeStatus="closing","writing"===t&&await new Promise(((e,t)=>{queueMicrotask((()=>{this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),this.sinkEnd.promise.then(e,t)}))})),"reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeWrite&&(this.log.trace("send close write to remote"),await this.sendCloseWrite(e)),this.writeStatus="closed",this.log.trace("closed writable end of stream")}abort(e){if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const t=this.sendReset();d(t)&&t.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),this.onAbort?.(e)}reset(){if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const e=new h.sv("stream reset","ERR_STREAM_RESET");this.status="reset",this._closeSinkAndSource(e),this.onReset?.()}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("muxer destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}},55265:function(e,t,n){"use strict";n.d(t,{NA:function(){return r},P7:function(){return i}});const r=Symbol.for("@libp2p/transport");var i;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(i||(i={}))},94791:function(e,t,n){"use strict";function r(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}n.d(t,{A:function(){return r}})},59217:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},52770:function(e,t,n){"use strict";n.d(t,{_:function(){return r},s:function(){return i}});class r extends Error{constructor(e="The operation was aborted"){super(e),this.code=r.code,this.type=r.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}class i extends Error{constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}}},46857:function(e,t,n){"use strict";n.d(t,{A:function(){return a},v:function(){return s}});var r,i=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class s extends EventTarget{constructor(){super(...arguments),r.set(this,new Map)}listenerCount(e){const t=i(this,r,"f").get(e);return null==t?0:t.length}addEventListener(e,t,n){super.addEventListener(e,t,n);let s=i(this,r,"f").get(e);null==s&&(s=[],i(this,r,"f").set(e,s)),s.push({callback:t,once:(!0!==n&&!1!==n&&n?.once)??!1})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),t??null,n);let s=i(this,r,"f").get(e);null!=s&&(s=s.filter((({callback:e})=>e!==t)),i(this,r,"f").set(e,s))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=i(this,r,"f").get(e.type);return null==n||(n=n.filter((({once:e})=>!e)),i(this,r,"f").set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new a(e,t))}}r=new WeakMap;class o extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const a=globalThis.CustomEvent??o},57447:function(e,t,n){"use strict";function r(e){return null!=e&&"function"==typeof e.start&&"function"==typeof e.stop}n.d(t,{qK:function(){return r}})},49796:function(e,t,n){"use strict";n.d(t,{$:function(){return ge}});var r=n(49541),i=n(54080),s=n(5681),o=n(1562),a=n(68723),c=n(63579),u=n(80394),l=n(38923),h=n(13341),d=n(47263);const f=Symbol.for("nodejs.util.inspect.custom"),p=Object.values(a.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),a.gh.identity.decoder),y=114,g=36,m=37;class w{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[s.N]=!0;toString(){return null==this.string&&(this.string=o.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return c.k0.createV1(y,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,d.f)(this.multihash.bytes,e);if("string"==typeof e)return _(e).equals(this);if(null!=e?.multihash?.bytes)return(0,d.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[f](){return`PeerId(${this.toString()})`}}class b extends w{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class E extends w{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class v extends w{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function _(e,t){if(t=t??p,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=u.Jx(o.base58btc.decode(`z${e}`));return e.startsWith("12D")?new E({multihash:t}):e.startsWith("16U")?new v({multihash:t}):new b({multihash:t})}return function(e){try{const t=u.Jx(e);if(t.code===l.identity.code){if(t.digest.length===g)return new E({multihash:t});if(t.digest.length===m)return new v({multihash:t})}if(t.code===h.sha256.code)return new b({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==y)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===h.sha256.code)return new b({multihash:e.multihash});if(t.code===l.identity.code){if(t.digest.length===g)return new E({multihash:e.multihash});if(t.digest.length===m)return new v({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(c.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(p.decode(e))}var S,R=n(47674),A=n(10673),I=n(38156),T=n(24094),C=n(85275),P=n(96945),k=n.n(P),N=n(71198),x=n(63497),D=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};S=new WeakMap;var L,O,U,M,B,z,V,$,F,j,K,q,H,G,Z,W,Q,Y,J,X,ee,te,ne,re,ie,se,oe=class{constructor(){S.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&D(this,S,"f")[this.size-1].priority>=t.priority)return void D(this,S,"f").push(n);const r=(0,x.Z)(D(this,S,"f"),n,((e,t)=>t.priority-e.priority));D(this,S,"f").splice(r,0,n)}dequeue(){const e=D(this,S,"f").shift();return null==e?void 0:e.run}filter(e){return D(this,S,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return D(this,S,"f").length}},ae=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},ce=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class ue extends Error{}class le extends(k()){constructor(e){var t,n,r,i;if(super(),L.add(this),O.set(this,void 0),U.set(this,void 0),M.set(this,0),B.set(this,void 0),z.set(this,void 0),V.set(this,0),$.set(this,void 0),F.set(this,void 0),j.set(this,void 0),K.set(this,void 0),q.set(this,0),H.set(this,void 0),G.set(this,void 0),Z.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:oe,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);ae(this,O,e.carryoverConcurrencyCount,"f"),ae(this,U,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),ae(this,B,e.intervalCap,"f"),ae(this,z,e.interval,"f"),ae(this,j,new e.queueClass,"f"),ae(this,K,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,ae(this,Z,!0===e.throwOnTimeout,"f"),ae(this,G,!1===e.autoStart,"f")}get concurrency(){return ce(this,H,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);ae(this,H,e,"f"),ce(this,L,"m",re).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:ce(this,Z,"f"),...t},new Promise(((n,r)=>{ce(this,j,"f").enqueue((async()=>{var i,s,o;ae(this,q,(s=ce(this,q,"f"),++s),"f"),ae(this,M,(o=ce(this,M,"f"),++o),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new ue("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=(0,N.ZP)(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,ce(this,L,"m",ie).call(this,t.signal)]));const s=await r;n(s),this.emit("completed",s)}catch(e){if(e instanceof N.W5&&!t.throwOnTimeout)return void n();r(e),this.emit("error",e)}finally{ce(this,L,"m",Y).call(this)}}),t),this.emit("add"),ce(this,L,"m",ee).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return ce(this,G,"f")?(ae(this,G,!1,"f"),ce(this,L,"m",re).call(this),this):this}pause(){ae(this,G,!0,"f")}clear(){ae(this,j,new(ce(this,K,"f")),"f")}async onEmpty(){0!==ce(this,j,"f").size&&await ce(this,L,"m",se).call(this,"empty")}async onSizeLessThan(e){ce(this,j,"f").size<e||await ce(this,L,"m",se).call(this,"next",(()=>ce(this,j,"f").size<e))}async onIdle(){0===ce(this,q,"f")&&0===ce(this,j,"f").size||await ce(this,L,"m",se).call(this,"idle")}get size(){return ce(this,j,"f").size}sizeBy(e){return ce(this,j,"f").filter(e).length}get pending(){return ce(this,q,"f")}get isPaused(){return ce(this,G,"f")}}O=new WeakMap,U=new WeakMap,M=new WeakMap,B=new WeakMap,z=new WeakMap,V=new WeakMap,$=new WeakMap,F=new WeakMap,j=new WeakMap,K=new WeakMap,q=new WeakMap,H=new WeakMap,G=new WeakMap,Z=new WeakMap,L=new WeakSet,W=function(){return ce(this,U,"f")||ce(this,M,"f")<ce(this,B,"f")},Q=function(){return ce(this,q,"f")<ce(this,H,"f")},Y=function(){var e;ae(this,q,(e=ce(this,q,"f"),--e),"f"),ce(this,L,"m",ee).call(this),this.emit("next")},J=function(){ce(this,L,"m",ne).call(this),ce(this,L,"m",te).call(this),ae(this,F,void 0,"f")},X=function(){const e=Date.now();if(void 0===ce(this,$,"f")){const t=ce(this,V,"f")-e;if(!(t<0))return void 0===ce(this,F,"f")&&ae(this,F,setTimeout((()=>{ce(this,L,"m",J).call(this)}),t),"f"),!0;ae(this,M,ce(this,O,"f")?ce(this,q,"f"):0,"f")}return!1},ee=function(){if(0===ce(this,j,"f").size)return ce(this,$,"f")&&clearInterval(ce(this,$,"f")),ae(this,$,void 0,"f"),this.emit("empty"),0===ce(this,q,"f")&&this.emit("idle"),!1;if(!ce(this,G,"f")){const e=!ce(this,L,"a",X);if(ce(this,L,"a",W)&&ce(this,L,"a",Q)){const t=ce(this,j,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&ce(this,L,"m",te).call(this),!0)}}return!1},te=function(){ce(this,U,"f")||void 0!==ce(this,$,"f")||(ae(this,$,setInterval((()=>{ce(this,L,"m",ne).call(this)}),ce(this,z,"f")),"f"),ae(this,V,Date.now()+ce(this,z,"f"),"f"))},ne=function(){0===ce(this,M,"f")&&0===ce(this,q,"f")&&ce(this,$,"f")&&(clearInterval(ce(this,$,"f")),ae(this,$,void 0,"f")),ae(this,M,ce(this,O,"f")?ce(this,q,"f"):0,"f"),ce(this,L,"m",re).call(this)},re=function(){for(;ce(this,L,"m",ee).call(this););},ie=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new ue("The task was aborted."))}),{once:!0})}))},se=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};var he=le;const de=(0,i.kg)("ipni-content-routing"),fe=4,pe=3e4;class ye{started;httpQueue;shutDownController;clientUrl;timeout;constructor(e,t={}){de("enabled IPNI routing via",e),this.started=!1,this.shutDownController=new AbortController,this.httpQueue=new he({concurrency:t.concurrentRequests??fe}),this.clientUrl=e instanceof URL?e:new URL(e),this.timeout=t.timeout??pe}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}async*findProviders(e,t={}){de("findProviders starts: %c",e);const n=(0,A.N)([this.shutDownController.signal,t.signal,AbortSignal.timeout(this.timeout)]),i=(0,C.Z)(),s=(0,C.Z)();this.httpQueue.add((async()=>(i.resolve(),s.promise)));try{await i.promise;const t=`${this.clientUrl}cid/${e.toString()}?cascade=ipfs-dht`,s={headers:{Accept:"application/x-ndjson"},signal:n},o=await fetch(t,s);if(null==o.body)throw new r.sv("IPNI response had no body","ERR_BAD_RESPONSE");for await(const e of T((0,I.Z)(o.body)))"gBI="===e.Metadata&&(yield this.mapEvent(e))}catch(e){de.error("findProviders errored:",e)}finally{n.clear(),s.resolve(),de("findProviders finished: %c",e)}}mapEvent(e){const t=_(e.Provider.ID),n=[];for(const t of e.Provider.Addrs){const e=(0,R.HM)(t);n.push(e)}return{id:t,multiaddrs:n,protocols:[]}}async provide(){}async put(){}async get(){throw new r.sv("Not found","ERR_NOT_FOUND")}}function ge(e,t={}){return()=>new ye(e,t)}},47263:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},45831:function(e,t,n){"use strict";n.d(t,{Fm:function(){return b},xV:function(){return w}});n(9839);var r=n(17023),i=n(1562),s=n(68723),o=n(63579),a=n(80394),c=n(57050),u=n(41690),l=n(77408),h=n(49784),d=n(49736);const f=d.C,p=d.aY,y=function(e){let t=0;if(e=e.toString().trim(),f(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(p(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;f(n[r])&&(e=y(n[r]),n[r]=(0,h.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,h.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},g=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var m=n(31958);(0,m.Ev)("ip4"),(0,m.Ev)("ip6"),(0,m.Ev)("ipcidr");function w(e,t){switch((0,m.Ev)(e).code){case 4:case 41:return function(e){const t=g(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!d.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return I(t);case 6:case 273:case 33:case 132:return R(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,h.B)(n,"base58btc")}(t);case 444:case 445:return T(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,h.B)(n,"base64url")}(t);default:return(0,h.B)(t,"base16")}}function b(e,t){switch((0,m.Ev)(e).code){case 4:case 41:return _(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return A(t);case 6:case 273:case 33:case 132:return S(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=S(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=S(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=v.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return(0,l.m)(t,"base16")}}const E=Object.values(s.gh).map((e=>e.decoder)),v=function(){let e=E[0].or(E[1]);return E.slice(2).forEach((t=>e=e.or(t))),e}();function _(e){if(!d.h6(e))throw new Error("invalid ip address");return y(e)}function S(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function R(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function A(e){const t=(0,l.m)(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function I(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,h.B)(e)}function T(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,h.B)(t,"base32")}:${R(n)}`}},47674:function(e,t,n){"use strict";n.d(t,{HM:function(){return R}});var r=n(49541),i=n(1562),s=n(63579),o=n(73062),a=n(49784),c=n(57050),u=n(41690),l=n(45831),h=n(31958);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(80280);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},31958:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},10673:function(e,t,n){"use strict";function r(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)}for(const t of e){if(!0===t?.aborted){n();break}null!=t?.addEventListener&&t.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)},r}n.d(t,{N:function(){return r}})},38156:function(e,t,n){"use strict";async function*r(e,t={}){const n=e.getReader();try{for(;;){const e=await n.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await n.cancel(),n.releaseLock()}}n.d(t,{Z:function(){return r}})},17023:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(65784);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},1562:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(65784);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},29540:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},63579:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(17023),i=n(1562),s=n(29540),o=n(80394),a=n(75710);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},80394:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(29540),i=n(75710);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},38923:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(29540),i=n(80394);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},13341:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(67411);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},75710:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},63497:function(e,t,n){"use strict";function r(e,t,n){let r=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=r+s;n(e[o],t)<=0?(r=++o,i-=s+1):i=s}return r}n.d(t,{Z:function(){return r}})},90391:function(e,t,n){"use strict";n.d(t,{p7:function(){return Bn}});var r=n(27710),i=n(49541),s=n(23247),o=n(85521),a=n(77309),c=n(11227),u=n(85322),l=n(69620),h=n(8063);function d(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return c.enabled(`${e}:trace`)&&null!=c.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=c(`${e}:trace`)),Object.assign(c(e),{error:c(`${e}:error`),trace:t})}c.formatters.b=e=>null==e?"undefined":l.base58btc.baseEncode(e),c.formatters.t=e=>null==e?"undefined":u.base32.baseEncode(e),c.formatters.m=e=>null==e?"undefined":h.base64.baseEncode(e),c.formatters.p=e=>null==e?"undefined":e.toString(),c.formatters.c=e=>null==e?"undefined":e.toString(),c.formatters.k=e=>null==e?"undefined":e.toString(),c.formatters.a=e=>null==e?"undefined":e.toString();var f=n(39454),p=n(85275),y=n(76061);class g extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function m(e,t){let n,r,i,s=(t=t??{}).onEnd,o=new y.u,a=(0,p.Z)();const c=e=>null!=r?r(e):(o.push(e),n),u=e=>{if(i)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?n:(i=!0,null!=e?(e=>(o=new y.u,null!=r?r({error:e}):(o.push({error:e}),n)))(e):c({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,o.push(s);try{t(e(o))}catch(e){i(e)}return n}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,p.Z)()}))}},return:()=>(o=new y.u,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new g)},t.addEventListener("abort",r)})));try{await Promise.race([a.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==s)return n;const h=n;return n={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),n),get readableLength(){return h.readableLength}},n}var w=function(...e){const t=[];for(const n of e)null==n[Symbol.asyncIterator]&&t.push(n);return t.length===e.length?function*(){for(const e of t)yield*e}():async function*(){const t=function(e={}){return m((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const n of e)t.push(n)}))),t.end()}catch(e){t.end(e)}})),yield*t}()},b=n(53749);const E=1e3,v="/dht/provider",_=20,S=3,R=Number(3e5),A=Number(Number(E)),I=Number(5e3),T=Number(3e5),C=Number(3e4),P=Number(3e4);var k=n(3858),N=n(69849),x=n(90212),D=n(482),L=n(5681),O=n(24005),U=n(18616),M=n(7188),B=n(87222),z=n(28769);const V=Symbol.for("nodejs.util.inspect.custom"),$=Object.values(O.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),O.gh.identity.decoder),F=114,j=36,K=37;class q{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[L.N]=!0;toString(){return null==this.string&&(this.string=l.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return U.k0.createV1(F,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,D.f)(this.multihash.bytes,e);if("string"==typeof e)return W(e).equals(this);if(null!=e?.multihash?.bytes)return(0,D.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[V](){return`PeerId(${this.toString()})`}}class H extends q{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class G extends q{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class Z extends q{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function W(e,t){if(t=t??$,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=M.Jx(l.base58btc.decode(`z${e}`));return e.startsWith("12D")?new G({multihash:t}):e.startsWith("16U")?new Z({multihash:t}):new H({multihash:t})}return Q($.decode(e))}function Q(e){try{const t=M.Jx(e);if(t.code===B.identity.code){if(t.digest.length===j)return new G({multihash:t});if(t.digest.length===K)return new Z({multihash:t})}if(t.code===z.sha256.code)return new H({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==F)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===z.sha256.code)return new H({multihash:e.multihash});if(t.code===B.identity.code){if(t.digest.length===j)return new G({multihash:e.multihash});if(t.digest.length===K)return new Z({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(U.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function Y(e,t){return e.length===j?new G({multihash:M.Ue(B.identity.code,e),privateKey:t}):e.length===K?new Z({multihash:M.Ue(B.identity.code,e),privateKey:t}):new H({multihash:await z.sha256.digest(e),publicKey:e,privateKey:t})}var J,X=n(18047),ee=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,ee.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,ee.LE)(t,e.codec()),e.decode=t=>(0,ee.C6)(t,e.codec())}(J||(J={}));var te=n(25329);class ne{key;value;timeReceived;constructor(e,t,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return J.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:te.D(this.timeReceived)}}static deserialize(e){const t=J.decode(e);return new ne(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=te.r(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new ne(e.key,e.value,t)}}var re=n(93025);const ie=re.v.MessageType,se=re.v.ConnectionType,oe=Object.keys(ie);class ae{type;key;clusterLevelRaw;closerPeers;providerPeers;record;constructor(e,t,n){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return re.v.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(ce),providerPeers:this.providerPeers.map(ce),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){const t=re.v.decode(e),n=new ae(t.type??re.v.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return n.closerPeers=t.closerPeers.map(ue),n.providerPeers=t.providerPeers.map(ue),null!=t.record?.length&&(n.record=ne.deserialize(t.record)),n}}function ce(e){return{id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map((e=>e.bytes)),connection:se.CONNECTED}}function ue(e){if(null==e.id)throw new Error("Invalid peer in message");return{id:Q(e.id),multiaddrs:(e.addrs??[]).map((e=>(0,X.HM)(e))),protocols:[]}}function le(e,t={}){const n={...e,name:"SEND_QUERY",type:0,messageName:e.type,messageType:oe.indexOf(e.type.toString())};return t.onProgress?.(new s.A("kad-dht:query:send-query",{detail:n})),n}function he(e,t={}){const n={...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]};return t.onProgress?.(new s.A("kad-dht:query:peer-response",{detail:n})),n}function de(e,t={}){const n={...e,name:"FINAL_PEER",type:2};return t.onProgress?.(new s.A("kad-dht:query:final-peer",{detail:n})),n}function fe(e,t={}){const n={...e,name:"QUERY_ERROR",type:3};return t.onProgress?.(new s.A("kad-dht:query:query-error",{detail:n})),n}function pe(e,t={}){const n={...e,name:"PROVIDER",type:4};return t.onProgress?.(new s.A("kad-dht:query:provider",{detail:n})),n}function ye(e,t={}){const n={...e,name:"VALUE",type:5};return t.onProgress?.(new s.A("kad-dht:query:value",{detail:n})),n}function ge(e,t={}){const n={...e,name:"DIAL_PEER",type:7};return t.onProgress?.(new s.A("kad-dht:query:dial-peer",{detail:n})),n}var me=n(41354);const we={pk:function(e,t){return 0}};async function be(e,t){const n=t.key,r=(0,me.B)(n).split("/");if(r.length<3)return;const s=e[r[1].toString()];if(null==s){const e="Invalid record keytype";throw new i.sv(e,"ERR_INVALID_RECORD_KEY_TYPE")}await s(n,t.value)}const Ee={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw new i.sv('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw new i.sv("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==(0,me.B)(e.subarray(0,4)))throw new i.sv("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");const n=e.slice(4),r=await z.sha256.digest(t);if(!(0,D.f)(n,r.bytes))throw new i.sv("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")}};var ve=n(53416),_e=n(94061),Se=n(8681);function Re(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Ae=Re("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ie=Re("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,Se.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}));var Te={utf8:Ae,"utf-8":Ae,hex:_e.gh.base16,latin1:Ie,ascii:Ie,binary:Ie,..._e.gh},Ce=n(60376);const Pe="/",ke=(new TextEncoder).encode(Pe),Ne=ke[0];class xe{_buf;constructor(e,t){if("string"==typeof e)this._buf=function(e,t="utf8"){const n=Te[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,Ce.P)(globalThis.Buffer.from(e,"utf-8"))}(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==Ne)throw new Error("Invalid key")}toString(e="utf8"){return function(e,t="utf8"){const n=Te[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new xe(e.join(Pe))}static random(){return new xe((0,ve.x0)().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new xe(e):"function"==typeof e.uint8Array?new xe(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=ke),this._buf[0]!==Ne){const e=new Uint8Array(this._buf.byteLength+1);e.fill(Ne,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Ne;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let e=0;e<t.length;e++){if(n.length<e+1)return!1;const r=t[e],i=n[e];if(r<i)return!0;if(r>i)return!1}return t.length<n.length}reverse(){return xe.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Pe).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new xe(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Pe)||(e+=Pe),e+=this.type(),new xe(e)}parent(){const e=this.list();return 1===e.length?new xe(Pe):new xe(e.slice(0,-1).join(Pe))}child(e){return this.toString()===Pe?e:e.toString()===Pe?this:new xe(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return xe.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}var De=n(66648),Le=n(28517);const Oe=(0,Le.m)("/pk/");function Ue(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==n;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=(0,b.Z)(n);return null==r||!r}))}}function Me(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if("localhost"===n)return!0;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=(0,b.Z)(n);return null!=r&&r}))}}async function Be(e){return(await z.sha256.digest(e)).digest}async function ze(e){return Be(e.toBytes())}function Ve(e){return new xe(`/dht/record/${(0,me.B)(e,"base32")}`,!1)}function $e(e,t){const n=new Date;return new ne(e,t,n).serialize()}class Fe{log;components;validators;selectors;peerRouting;queryManager;network;constructor(e,t){const{validators:n,selectors:r,peerRouting:i,queryManager:s,network:o,lan:a}=t;this.components=e,this.log=d(`libp2p:kad-dht:${a?"lan":"wan"}:content-fetching`),this.validators=n,this.selectors=r,this.peerRouting=i,this.queryManager=s,this.network=o}async putLocal(e,t){const n=Ve(e);await this.components.datastore.put(n,t)}async getLocal(e){this.log("getLocal %b",e);const t=Ve(e);this.log("fetching record for key %k",t);const n=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const r=ne.deserialize(n);return await be(this.validators,r),r}async*sendCorrectionRecord(e,t,n,r={}){this.log("sendCorrection for %b",e);const s=$e(e,n);for(const{value:o,from:a}of t){if((0,D.f)(o,n)){this.log("record was ok");continue}if(this.components.peerId.equals(a)){try{const t=Ve(e);this.log(`Storing corrected record for key ${t.toString()}`),await this.components.datastore.put(t,s.subarray())}catch(e){this.log.error("Failed error correcting self",e)}continue}let t=!1;const c=new ae(ie.PUT_VALUE,e,0);c.record=ne.deserialize(s);for await(const e of this.network.sendRequest(a,c,r))"PEER_RESPONSE"===e.name&&null!=e.record&&(0,D.f)(e.record.value,ne.deserialize(s).value)&&(t=!0),yield e;t||(yield fe({from:a,error:new i.sv("value not put correctly","ERR_PUT_VALUE_INVALID")},r)),this.log.error("Failed error correcting entry")}}async*put(e,t,n={}){this.log("put key %b value %b",e,t);const r=$e(e,t),s=Ve(e);this.log(`storing record for key ${s.toString()}`),await this.components.datastore.put(s,r.subarray()),yield*(0,x.z)(this.peerRouting.getClosestPeers(e,{signal:n.signal}),(t=>(0,k.Z)(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[],o=new ae(ie.PUT_VALUE,e,0);o.record=ne.deserialize(r),this.log("send put to %p",t.peer.id);for await(const e of this.network.sendRequest(t.peer.id,o,n))s.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&(0,D.f)(e.record.value,ne.deserialize(r).value)||s.push(fe({from:t.peer.id,error:new i.sv("value not put correctly","ERR_PUT_VALUE_INVALID")},n)));return s}))),(e=>(0,N.Z)(e,{ordered:!1,concurrency:S})),(async function*(e){for await(const t of e)yield*t}))}async*get(e,t={}){this.log("get %b",e);const n=[];for await(const r of this.getMany(e,t))"VALUE"===r.name&&n.push(r),yield r;if(0===n.length)return;const r=n.map((e=>e.value));let s=0;try{s=function(e,t,n){if(0===n.length){const e="No records given";throw new i.sv(e,"ERR_NO_RECORDS_RECEIVED")}const r=(0,me.B)(t).split("/");if(r.length<3){const e="Record key does not have a selector function";throw new i.sv(e,"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const s=e[r[1].toString()];if(null==s){const e=`Unrecognized key prefix: ${r[1]}`;throw new i.sv(e,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:s(t,n)}(this.selectors,e,r)}catch(e){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==e.code)throw e}const o=r[s];if(this.log("GetValue %b %b",e,o),null==o)throw new i.sv("best value was not found","ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,n,o,t),yield n[s]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{const n=await this.getLocal(e);yield ye({value:n.value,from:this.components.peerId},t)}catch(t){this.log("error getting local value for %b",e,t)}const n=this;yield*this.queryManager.run(e,(async function*({peer:r,signal:i}){for await(const s of n.peerRouting.getValueOrPeers(r,e,{signal:i}))yield s,"PEER_RESPONSE"===s.name&&null!=s.record&&(yield ye({from:r,value:s.record.value},t))}),t)}}class je{log;components;network;peerRouting;queryManager;routingTable;providers;constructor(e,t){const{network:n,peerRouting:r,queryManager:i,routingTable:s,providers:o,lan:a}=t;this.components=e,this.log=d(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=n,this.peerRouting=r,this.queryManager=i,this.routingTable=s,this.providers=o}async*provide(e,t,n={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.peerId);const r=new ae(ie.ADD_PROVIDER,e.multihash.bytes,0);r.providerPeers=[{id:this.components.peerId,multiaddrs:t,protocols:[]}];let i=0;const s=t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[];this.log("putProvider %s to %p",e,t.peer.id);try{this.log("sending provider record for %s to %p",e,t.peer.id);for await(const o of this.network.sendMessage(t.peer.id,r,n))"PEER_RESPONSE"===o.name&&(this.log("sent provider record for %s to %p",e,t.peer.id),i++),s.push(o)}catch(e){this.log.error("error sending provide record to peer %p",t.peer.id,e),s.push(fe({from:t.peer.id,error:e},n))}return s};yield*(0,x.z)(this.peerRouting.getClosestPeers(e.multihash.bytes,n),(e=>(0,k.Z)(e,(e=>s(e)))),(e=>(0,N.Z)(e,{ordered:!1,concurrency:S})),(async function*(e){for await(const t of e)yield*t})),this.log("sent provider records to %d peers",i)}async*findProviders(e,t){const n=this.routingTable.kBucketSize,r=e.multihash.bytes,i=this;this.log("findProviders %c",e);const s=await this.providers.getProviders(e);if(s.length>0){const e=[];for(const t of s.slice(0,n))try{const n=await this.components.peerStore.get(t);e.push({id:t,multiaddrs:n.addresses.map((({multiaddr:e})=>e)),protocols:n.protocols})}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e;this.log("no peer store entry for %p",t)}yield he({from:this.components.peerId,messageType:ie.GET_PROVIDERS,providers:e},t),yield pe({from:this.components.peerId,providers:e},t)}if(s.length>=n)return;const o=async function*({peer:e,signal:n}){const s=new ae(ie.GET_PROVIDERS,r,0);yield*i.network.sendRequest(e,s,{...t,signal:n})},a=new Set(s.map((e=>e.toString())));for await(const i of this.queryManager.run(r,o,t))if(yield i,"PEER_RESPONSE"===i.name){this.log("Found %d provider entries for %c and %d closer peers",i.providers.length,e,i.closer.length);const r=[];for(const e of i.providers)a.has(e.id.toString())||(a.add(e.id.toString()),r.push(e));if(r.length>0&&(yield pe({from:i.from,providers:r},t)),a.size===n)return}}}class Ke extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}var qe=n(24084);function He(e,t,n){const r=n??{},i=(0,qe.A)(e);return async function*(){let n;const s=()=>{null!=n&&n()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new Ke(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new Ke(e,n))}}));o=await Promise.race([e,i.next()]),n=null}catch(n){t.removeEventListener("abort",s);const o="aborted"===n.type&&t.aborted;if(o&&null!=r.onAbort&&r.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(e){null!=r.onReturnError&&r.onReturnError(e)}if(o&&!0===r.returnOnAbort)return;throw n}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}function Ge(e,t,n){return r=>e(He(r,t,n))}function Ze(e,t,n){return{sink:Ge(e.sink,t,{...n,onAbort:void 0}),source:He(e.source,t,n)}}var We=n(1214),Qe=n(91893);class Ye extends s.v{log;protocol;running;components;constructor(e,t){super();const{protocol:n,lan:r}=t;this.components=e,this.log=d(`libp2p:kad-dht:${r?"lan":"wan"}:network`),this.running=!1,this.protocol=n}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,n={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield ge({peer:e},n),yield le({to:e,type:t.type},n);try{const r=await this.components.connectionManager.openConnection(e,n),i=await r.newStream(this.protocol,n),s=await this._writeReadMessage(i,t.serialize(),n);yield he({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record},n)}catch(t){yield fe({from:e,error:t},n)}finally{0}}async*sendMessage(e,t,n={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield ge({peer:e},n),yield le({to:e,type:t.type},n);try{const r=await this.components.connectionManager.openConnection(e,n),i=await r.newStream(this.protocol,n);await this._writeMessage(i,t.serialize(),n),yield he({from:e,messageType:t.type},n)}catch(t){yield fe({from:e,error:t},n)}finally{0}}async _writeMessage(e,t,n){null!=n.signal&&(e=Ze(e,n.signal)),await(0,x.z)([t],(e=>Qe.c(e)),e,f.Z)}async _writeReadMessage(e,t,n){null!=n.signal&&(e=Ze(e,n.signal));const r=await(0,x.z)([t],(e=>Qe.c(e)),e,(e=>Qe.J(e)),(async e=>{const t=await(0,We.Z)(e);if(null!=t)return t;throw new i.sv("No message received","ERR_NO_MESSAGE_RECEIVED")})),o=ae.deserialize(r);return o.closerPeers.forEach((e=>{this.dispatchEvent(new s.A("peer",{detail:e}))})),o.providerPeers.forEach((e=>{this.dispatchEvent(new s.A("peer",{detail:e}))})),o}}n(67038),n(21894);n(3068),n(97450),n(3832);var Je=n(9961);n(33062);const Xe={"P-256":256,"P-384":384,"P-521":521};Object.keys(Xe).join(" / ");n(25041);n(51288);var et=n(17405),tt=n(54817);const nt={rsa:et,ed25519:Je,secp256k1:tt};function rt(e){const t=Object.keys(nt).join(" / ");return new i.sv(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function it(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return nt[e];throw rt(e)}n(45809);var st=n(68038),ot=n(85680),at=n(80437);class ct{originDhtKey;capacity;peerDistances;constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await ze(e),n={peerId:e,distance:(0,at.d)(this.originDhtKey,t)};this.peerDistances.push(n),this.peerDistances.sort(((e,t)=>(0,ot.q)(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(ze)),n=this.peerDistances[this.peerDistances.length-1].distance;for(const e of t){const t=(0,at.d)(this.originDhtKey,e);if((0,ot.q)(t,n)<0)return!0}return!1}}class ut{components;log;routingTable;network;validators;queryManager;constructor(e,t){const{routingTable:n,network:r,validators:i,queryManager:s,lan:o}=t;this.components=e,this.routingTable=n,this.network=r,this.validators=i,this.queryManager=s,this.log=d(`libp2p:kad-dht:${o?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t;const n=await this.routingTable.find(e);if(null!=n){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(n)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}async*_getValueSingle(e,t,n={}){const r=new ae(ie.GET_VALUE,t,0);yield*this.network.sendRequest(e,r,n)}async*getPublicKeyFromNode(e,t={}){const n=function(e){return(0,De.z)([Oe,e.toBytes()])}(e);for await(const o of this._getValueSingle(e,n,t))if(yield o,"PEER_RESPONSE"===o.name&&null!=o.record){const n=await Y((r={bytes:o.record.value},s=void 0,it(s=(s??"rsa").toLowerCase()),r.bytes));if(!n.equals(e))throw new i.sv("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==n.publicKey)throw new i.sv("public key missing","ERR_PUBLIC_KEY_MISSING");yield ye({from:e,value:n.publicKey},t)}var r,s;throw new i.sv(`Node not responding with its public key: ${e.toString()}`,"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);const n=await this.findPeerLocal(e);if(null!=n)return this.log("found local"),void(yield de({from:this.components.peerId,peer:n},t));const r=this,s=async function*({peer:n,signal:i}){const s=new ae(ie.FIND_NODE,e.toBytes(),0);for await(const o of r.network.sendRequest(n,s,{...t,signal:i}))if(yield o,"PEER_RESPONSE"===o.name){const n=o.closer.find((t=>t.id.equals(e)));null!=n&&(yield de({from:o.from,peer:n},t))}};let o=!1;for await(const n of this.queryManager.run(e.toBytes(),s,t))"FINAL_PEER"===n.name&&(o=!0),yield n;o||(yield fe({from:this.components.peerId,error:new i.sv("Not found","ERR_NOT_FOUND")},t))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);const n=await Be(e),r=this.routingTable.closestPeers(n),i=this,s=new ct(n,this.routingTable.kBucketSize);await Promise.all(r.map((async e=>{await s.add(e)})));const o=async function*({peer:n,signal:r}){i.log("closerPeersSingle %s from %p",(0,me.B)(e,"base32"),n);const s=new ae(ie.FIND_NODE,e,0);yield*i.network.sendRequest(n,s,{...t,signal:r})};for await(const n of this.queryManager.run(e,o,t))yield n,"PEER_RESPONSE"===n.name&&await Promise.all(n.closer.map((async e=>{await s.add(e.id)})));this.log("found %d peers close to %b",s.length,e);for(const e of s.peers)try{const n=await this.components.peerStore.get(e);yield de({from:this.components.peerId,peer:{id:e,multiaddrs:n.addresses.map((({multiaddr:e})=>e)),protocols:n.protocols}},t)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}async*getValueOrPeers(e,t,n={}){for await(const r of this._getValueSingle(e,t,n)){if("PEER_RESPONSE"===r.name&&null!=r.record)try{await this._verifyRecordOnline(r.record)}catch(e){const t="invalid record received, discarded";this.log(t),yield fe({from:r.from,error:new i.sv(t,"ERR_INVALID_RECORD")},n);continue}yield r}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw new i.sv("invalid record received","ERR_INVALID_RECORD");await be(this.validators,new ne(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const n=await Be(e),r=this.routingTable.closestPeers(n),i=[];for(const e of r)if(!e.equals(t))try{const t=await this.components.peerStore.get(e);i.push({id:e,multiaddrs:t.addresses.map((({multiaddr:e})=>e)),protocols:t.protocols})}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return i.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",i.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),i}}var lt,ht=n(70248),dt=n(36026),ft=n.n(dt),pt=n(71198),yt=n(19060),gt=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};lt=new WeakMap;var mt,wt,bt,Et,vt,_t,St,Rt,At,It,Tt,Ct,Pt,kt,Nt,xt,Dt,Lt,Ot,Ut,Mt,Bt,zt,Vt,$t,Ft,jt=class{constructor(){lt.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&gt(this,lt,"f")[this.size-1].priority>=t.priority)return void gt(this,lt,"f").push(n);const r=(0,yt.Z)(gt(this,lt,"f"),n,((e,t)=>t.priority-e.priority));gt(this,lt,"f").splice(r,0,n)}dequeue(){const e=gt(this,lt,"f").shift();return null==e?void 0:e.run}filter(e){return gt(this,lt,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return gt(this,lt,"f").length}},Kt=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},qt=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ht extends Error{}class Gt extends(ft()){constructor(e){var t,n,r,i;if(super(),mt.add(this),wt.set(this,void 0),bt.set(this,void 0),Et.set(this,0),vt.set(this,void 0),_t.set(this,void 0),St.set(this,0),Rt.set(this,void 0),At.set(this,void 0),It.set(this,void 0),Tt.set(this,void 0),Ct.set(this,0),Pt.set(this,void 0),kt.set(this,void 0),Nt.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:jt,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);Kt(this,wt,e.carryoverConcurrencyCount,"f"),Kt(this,bt,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),Kt(this,vt,e.intervalCap,"f"),Kt(this,_t,e.interval,"f"),Kt(this,It,new e.queueClass,"f"),Kt(this,Tt,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,Kt(this,Nt,!0===e.throwOnTimeout,"f"),Kt(this,kt,!1===e.autoStart,"f")}get concurrency(){return qt(this,Pt,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Kt(this,Pt,e,"f"),qt(this,mt,"m",Vt).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:qt(this,Nt,"f"),...t},new Promise(((n,r)=>{qt(this,It,"f").enqueue((async()=>{var i,s,o;Kt(this,Ct,(s=qt(this,Ct,"f"),++s),"f"),Kt(this,Et,(o=qt(this,Et,"f"),++o),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new Ht("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=(0,pt.ZP)(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,qt(this,mt,"m",$t).call(this,t.signal)]));const s=await r;n(s),this.emit("completed",s)}catch(e){if(e instanceof pt.W5&&!t.throwOnTimeout)return void n();r(e),this.emit("error",e)}finally{qt(this,mt,"m",Lt).call(this)}}),t),this.emit("add"),qt(this,mt,"m",Mt).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return qt(this,kt,"f")?(Kt(this,kt,!1,"f"),qt(this,mt,"m",Vt).call(this),this):this}pause(){Kt(this,kt,!0,"f")}clear(){Kt(this,It,new(qt(this,Tt,"f")),"f")}async onEmpty(){0!==qt(this,It,"f").size&&await qt(this,mt,"m",Ft).call(this,"empty")}async onSizeLessThan(e){qt(this,It,"f").size<e||await qt(this,mt,"m",Ft).call(this,"next",(()=>qt(this,It,"f").size<e))}async onIdle(){0===qt(this,Ct,"f")&&0===qt(this,It,"f").size||await qt(this,mt,"m",Ft).call(this,"idle")}get size(){return qt(this,It,"f").size}sizeBy(e){return qt(this,It,"f").filter(e).length}get pending(){return qt(this,Ct,"f")}get isPaused(){return qt(this,kt,"f")}}wt=new WeakMap,bt=new WeakMap,Et=new WeakMap,vt=new WeakMap,_t=new WeakMap,St=new WeakMap,Rt=new WeakMap,At=new WeakMap,It=new WeakMap,Tt=new WeakMap,Ct=new WeakMap,Pt=new WeakMap,kt=new WeakMap,Nt=new WeakMap,mt=new WeakSet,xt=function(){return qt(this,bt,"f")||qt(this,Et,"f")<qt(this,vt,"f")},Dt=function(){return qt(this,Ct,"f")<qt(this,Pt,"f")},Lt=function(){var e;Kt(this,Ct,(e=qt(this,Ct,"f"),--e),"f"),qt(this,mt,"m",Mt).call(this),this.emit("next")},Ot=function(){qt(this,mt,"m",zt).call(this),qt(this,mt,"m",Bt).call(this),Kt(this,At,void 0,"f")},Ut=function(){const e=Date.now();if(void 0===qt(this,Rt,"f")){const t=qt(this,St,"f")-e;if(!(t<0))return void 0===qt(this,At,"f")&&Kt(this,At,setTimeout((()=>{qt(this,mt,"m",Ot).call(this)}),t),"f"),!0;Kt(this,Et,qt(this,wt,"f")?qt(this,Ct,"f"):0,"f")}return!1},Mt=function(){if(0===qt(this,It,"f").size)return qt(this,Rt,"f")&&clearInterval(qt(this,Rt,"f")),Kt(this,Rt,void 0,"f"),this.emit("empty"),0===qt(this,Ct,"f")&&this.emit("idle"),!1;if(!qt(this,kt,"f")){const e=!qt(this,mt,"a",Ut);if(qt(this,mt,"a",xt)&&qt(this,mt,"a",Dt)){const t=qt(this,It,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&qt(this,mt,"m",Bt).call(this),!0)}}return!1},Bt=function(){qt(this,bt,"f")||void 0!==qt(this,Rt,"f")||(Kt(this,Rt,setInterval((()=>{qt(this,mt,"m",zt).call(this)}),qt(this,_t,"f")),"f"),Kt(this,St,Date.now()+qt(this,_t,"f"),"f"))},zt=function(){0===qt(this,Et,"f")&&0===qt(this,Ct,"f")&&qt(this,Rt,"f")&&(clearInterval(qt(this,Rt,"f")),Kt(this,Rt,void 0,"f")),Kt(this,Et,qt(this,wt,"f")?qt(this,Ct,"f"):0,"f"),qt(this,mt,"m",Vt).call(this)},Vt=function(){for(;qt(this,mt,"m",Mt).call(this););},$t=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new Ht("The task was aborted."))}),{once:!0})}))},Ft=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};var Zt=Gt,Wt=n(57050);const Qt=d("libp2p:kad-dht:providers");class Yt{components;cache;cleanupInterval;provideValidity;syncQueue;started;cleaner;constructor(e,t={}){const{cacheSize:n,cleanupInterval:r,provideValidity:i}=t;this.components=e,this.cleanupInterval=r??36e5,this.provideValidity=i??864e5,this.cache=ht(n??256),this.syncQueue=new Zt({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{Qt.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){await this.syncQueue.add((async()=>{const e=Date.now();let t=0,n=0;const r=new Map,i=this.components.datastore.batch(),s=this.components.datastore.query({prefix:v});for await(const e of s)try{const{cid:s,peerId:o}=Xt(e.key),a=en(e.value).getTime(),c=Date.now(),u=c-a,l=u>this.provideValidity;if(Qt("comparing: %d - %d = %d > %d %s",c,a,u,this.provideValidity,l?"(expired)":""),l){n++,i.delete(e.key);const t=r.get(s)??new Set;t.add(o),r.set(s,t)}t++}catch(e){Qt.error(e.message)}r.size>0?(Qt("deleting %d / %d entries",n,t),await i.commit()):Qt("nothing to delete");for(const[e,t]of r){const n=Jt(e),r=this.cache.get(n);if(null!=r){for(const e of t)r.delete(e);0===r.size?this.cache.remove(n):this.cache.set(n,r)}}Qt("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=Jt(e);let n=this.cache.get(t);return null==n&&(n=await async function(e,t){const n=new Map,r=e.query({prefix:Jt(t)});for await(const e of r){const{peerId:t}=Xt(e.key);n.set(t,en(e.value))}return n}(this.components.datastore,e),this.cache.set(t,n)),n}async addProvider(e,t){await this.syncQueue.add((async()=>{Qt("%p provides %s",t,e);const n=await this._getProvidersMap(e);Qt("loaded %s provs",n.size);const r=new Date;n.set(t.toString(),r);const i=Jt(e);this.cache.set(i,n),await async function(e,t,n,r){const i=[Jt(t),"/",n.toString()].join(""),s=new xe(i),o=Wt.cv(r.getTime());await e.put(s,o)}(this.components.datastore,e,t,r)}))}async getProviders(e){return this.syncQueue.add((async()=>{Qt("get providers for %s",e);return[...(await this._getProvidersMap(e)).keys()].map((e=>W(e)))}),{throwOnTimeout:!0})}}function Jt(e){const t="string"==typeof e?e:(0,me.B)(e.multihash.bytes,"base32");return`${v}/${t}`}function Xt(e){const t=e.toString().split("/");if(5!==t.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}function en(e){return new Date(Wt.Jx(e))}var tn=n(17187),nn=n(67483),rn=n(40826);const sn=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*on(e){const{key:t,startingPeer:n,ourPeerId:r,signal:s,query:o,alpha:a,pathIndex:c,numPaths:u,cleanUp:l,queryFuncTimeout:h,log:d,peersSeen:f}=e,y=new Zt({concurrency:a}),g=await Be(t);!function n(i,a){if(null==i)return;f.add(i);const l=BigInt("0x"+(0,me.B)((0,at.d)(a,g),"base16"));y.add((async()=>{const a=[s];null!=h&&a.push(AbortSignal.timeout(h));const p=(0,rn.N)(a);try{for await(const e of o({key:t,peer:i,signal:p,pathIndex:c,numPaths:u})){if(p.aborted)return;if("PEER_RESPONSE"===e.name)for(const s of e.closer){if(f.has(s.id)){d("already seen %p in query",s.id);continue}if(r.equals(s.id)){d("not querying ourselves");continue}const e=await ze(s.id);BigInt("0x"+(0,me.B)((0,at.d)(e,g),"base16"))>l?d("skipping %p as they are not closer to %b than %p",s.id,t,i):(d("querying closer peer %p",s.id),n(s.id,e))}y.emit("completed",e)}}catch(t){if(!s.aborted)return fe({from:i,error:t},e)}finally{p.clear()}}),{priority:sn-l}).catch((e=>{d.error(e)}))}(n,await ze(n)),yield*async function*(e,t,n,r){let s=(0,p.Z)(),o=!0;const a=[],c=()=>{o&&(r("clean up queue, results %d, queue size %d, pending tasks %d",a.length,e.size,e.pending),o=!1,e.clear(),a.splice(0,a.length))};e.on("completed",(e=>{a.push(e),s.resolve()})),e.on("error",(e=>{r("queue error",e),c(),s.reject(e)})),e.on("idle",(()=>{r("queue idle"),o=!1,s.resolve()})),t.addEventListener("abort",(()=>{r("abort queue");const e=o;c(),e&&s.reject(new i.sv("Query aborted","ERR_QUERY_ABORTED"))})),n.addEventListener("cleanup",(()=>{c(),s.resolve()}));for(;o;)for(await s.promise,s=(0,p.Z)();a.length>0;){const e=a.shift();null!=e&&(yield e)}yield*a}(y,s,l,d)}class an{components;lan;disjointPaths;alpha;shutDownController;running;queries;metrics;routingTable;initialQuerySelfHasRun;constructor(e,t){const{lan:n=!1,disjointPaths:r=_,alpha:i=S}=t;this.components=e,this.disjointPaths=r??_,this.running=!1,this.alpha=i??S,this.lan=n,this.queries=0,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun,this.routingTable=t.routingTable,this.shutDownController=new AbortController;try{null!=tn.setMaxListeners&&(0,tn.setMaxListeners)(1/0,this.shutDownController.signal)}catch{}}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_running_queries`),queryTime:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_query_time_seconds`)})}async stop(){this.running=!1,this.shutDownController.abort()}async*run(e,t,n={}){if(!this.running)throw new Error("QueryManager not started");const r=this.metrics?.queryTime.timer();if(null==n.signal){n.signal=AbortSignal.timeout(P);try{null!=tn.setMaxListeners&&(0,tn.setMaxListeners)(1/0,n.signal)}catch{}}const o=(0,rn.N)([this.shutDownController.signal,n.signal]);try{null!=tn.setMaxListeners&&(0,tn.setMaxListeners)(1/0,o)}catch{}const a=d(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+(0,me.B)(e,"base58btc")),c=Date.now(),u=new s.v;try{!0!==n.isSelfQuery&&null!=this.initialQuerySelfHasRun&&(a("waiting for initial query-self query before continuing"),await Promise.race([new Promise(((e,t)=>{o.addEventListener("abort",(()=>{t(new i._L("Query was aborted before self-query ran"))}))})),this.initialQuerySelfHasRun.promise]),this.initialQuerySelfHasRun=void 0),a("query:start"),this.queries++,this.metrics?.runningQueries.update(this.queries);const r=await Be(e),s=this.routingTable.closestPeers(r),c=s.slice(0,Math.min(this.disjointPaths,s.length));if(0===s.length)return void a.error("Running query with no peers");const l=new nn.fd,h=c.map(((r,i)=>on({key:e,startingPeer:r,ourPeerId:this.components.peerId,signal:o,query:t,pathIndex:i,numPaths:c.length,alpha:this.alpha,cleanUp:u,queryFuncTimeout:n.queryFuncTimeout,log:a,peersSeen:l,onProgress:n.onProgress})));for await(const e of w(...h))yield e,"QUERY_ERROR"===e.name&&a("error",e.error)}catch(e){if(this.running||"ERR_QUERY_ABORTED"!==e.code)throw e}finally{o.clear(),this.queries--,this.metrics?.runningQueries.update(this.queries),null!=r&&r(),u.dispatchEvent(new s.A("cleanup")),a("query:done in %dms",Date.now()-c)}}}var cn=n(90225),un=n(55001),ln=n(90954);class hn{log;components;peerRouting;routingTable;count;interval;initialInterval;queryTimeout;started;timeoutId;controller;initialQuerySelfHasRun;querySelfPromise;constructor(e,t){const{peerRouting:n,lan:r,count:i,interval:s,queryTimeout:o,routingTable:a}=t;this.components=e,this.log=d(`libp2p:kad-dht:${r?"lan":"wan"}:query-self`),this.started=!1,this.peerRouting=n,this.routingTable=a,this.count=i??_,this.interval=s??R,this.initialInterval=t.initialInterval??A,this.queryTimeout=o??I,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun}isStarted(){return this.started}start(){this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.initialInterval))}stop(){this.started=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}async querySelf(){if(this.started){if(null!=this.querySelfPromise)return this.log("joining existing self query"),this.querySelfPromise.promise;if(this.querySelfPromise=(0,p.Z)(),0===this.routingTable.size&&await(0,ln.yM)(this.routingTable,"peer:add"),this.started){this.controller=new AbortController;const e=(0,rn.N)([this.controller.signal,AbortSignal.timeout(this.queryTimeout)]);try{null!=tn.setMaxListeners&&(0,tn.setMaxListeners)(1/0,e)}catch{}try{this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout);const t=await(0,x.z)(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:e,isSelfQuery:!0}),(e=>(0,un.Z)(e,this.count)),(async e=>(0,cn.Z)(e)));this.log("self-query ran successfully - found %d peers",t),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0)}catch(e){this.log.error("self-query error",e)}finally{e.clear()}}this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started&&(this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.interval))}else this.log("skip self-query because we are not started")}}function dn(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function fn(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class pn extends s.v{localNodeId;root;numberOfNodesPerKBucket;numberOfNodesToPing;distance;arbiter;constructor(e){super(),this.localNodeId=e.localNodeId,this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket??20,this.numberOfNodesToPing=e.numberOfNodesToPing??3,this.distance=e.distance??pn.distance,this.arbiter=e.arbiter??pn.arbiter,fn("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){return(e.vectorClock??0)>(t.vectorClock??0)?e:t}static distance(e,t){let n=0,r=0;const i=Math.min(e.length,t.length),s=Math.max(e.length,t.length);for(;r<i;++r)n=256*n+(e[r]^t[r]);for(;r<s;++r)n=256*n+255;return n}add(e){fn("contact.id",e?.id);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e.id,t++);const r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.safeDispatchEvent("added",{detail:e}),this):n.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:n.contacts.slice(0,this.numberOfNodesToPing),newContact:e}}),this):(this._split(n,t),this.add(e))}closest(e,t=1/0){if(fn("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let n=[];for(let r=[this.root],i=0;r.length>0&&n.length<t;){const t=r.pop();if(null!=t)if(null===t.contacts){const n=this._determineNode(t,e,i++);r.push(t.left===n?t.right:t.left),r.push(n)}else n=n.concat(t.contacts)}return n.map((t=>({distance:this.distance(t.id,e),contact:t}))).sort(((e,t)=>e.distance-t.distance)).slice(0,t).map((e=>e.contact))}count(){let e=0;for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length)}return e}_determineNode(e,t,n){const r=n>>3,i=n%8;if(t.length<=r&&0!==i)return e.left;return 0!=(t[r]&1<<7-i)?e.right:e.left}get(e){fn("id",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);return r>=0?n.contacts[r]:void 0}_indexOf(e,t){for(let n=0;n<e.contacts.length;++n)if(dn(e.contacts[n].id,t))return n;return-1}remove(e){fn("the id as parameter 1",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);if(r>=0){const e=n.contacts.splice(r,1)[0];this.safeDispatchEvent("removed",{detail:e})}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const n of e.contacts)this._determineNode(e,n.id,t).contacts.push(n);e.contacts=null;const n=this._determineNode(e,this.localNodeId,t);(e.left===n?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts))}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null!=t&&(null===t.contacts?e.push(t.right,t.left):yield*t.contacts)}}_update(e,t,n){if(!dn(e.contacts[t].id,n.id))throw new Error("wrong index for _update");const r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.safeDispatchEvent("updated",{detail:{incumbent:r,selection:i}}))}}class yn extends s.v{kBucketSize;kb;pingQueue;log;components;lan;pingTimeout;pingConcurrency;running;protocol;tagName;tagValue;metrics;constructor(e,t){super();const{kBucketSize:n,pingTimeout:r,lan:i,pingConcurrency:s,protocol:o,tagName:a,tagValue:c}=t;this.components=e,this.log=d(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table`),this.kBucketSize=n??20,this.pingTimeout=r??1e4,this.pingConcurrency=s??10,this.lan=i,this.running=!1,this.protocol=o,this.tagName=a??"kad-close",this.tagValue=c??50;const u=()=>{this.metrics?.pingQueueSize.update(this.pingQueue.size),this.metrics?.pingRunning.update(this.pingQueue.pending)};this.pingQueue=new Zt({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",u),this.pingQueue.addListener("next",u),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_routing_table_size`),pingQueueSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_queue_size`),pingRunning:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_running`)});const e=new pn({localNodeId:await ze(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.addEventListener("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new nn.fd;const n=function(e,t=100){let n;return()=>{clearTimeout(n),n=setTimeout((()=>{e()}),t)}}((()=>{const n=new nn.fd(e.closest(e.localNodeId,20).map((e=>e.peer))),r=n.difference(t),i=t.difference(n);Promise.resolve().then((async()=>{for(const e of r)await this.components.peerStore.merge(e,{tags:{[this.tagName]:{value:this.tagValue}}});for(const e of i)await this.components.peerStore.merge(e,{tags:{[this.tagName]:void 0}})})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=n}));e.addEventListener("added",(e=>{n(),this.safeDispatchEvent("peer:add",{detail:e.detail.peer})})),e.addEventListener("removed",(e=>{n(),this.safeDispatchEvent("peer:remove",{detail:e.detail.peer})}))}_onPing(e){const{oldContacts:t,newContact:n}=e.detail;this.pingQueue.add((async()=>{if(!this.running)return;let e=0;try{await Promise.all(t.map((async t=>{try{const n={signal:AbortSignal.timeout(this.pingTimeout)};this.log("pinging old contact %p",t.peer);const r=await this.components.connectionManager.openConnection(t.peer,n),i=await r.newStream(this.protocol,n);await i.close(),e++}catch(e){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",t.peer,e),this.log("evicting old contact after ping failed %p",t.peer),this.kb.remove(t.id))}finally{this.metrics?.routingTableSize.update(this.size)}}))),this.running&&e<t.length&&null!=this.kb&&(this.log("adding new contact %p",n.peer),this.kb.add(n))}catch(e){this.log.error("could not process k-bucket ping event",e)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await ze(e),n=this.closestPeer(t);if(null!=n&&e.equals(n))return n}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){if(null==this.kb)return[];return this.kb.closest(e,t).map((e=>e.peer))}async add(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await ze(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.metrics?.routingTableSize.update(this.size)}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await ze(e);this.kb.remove(t),this.metrics?.routingTableSize.update(this.size)}}var gn=n(14750);class mn{log;peerRouting;routingTable;refreshInterval;refreshQueryTimeout;commonPrefixLengthRefreshedAt;refreshTimeoutId;constructor(e){const{peerRouting:t,routingTable:n,refreshInterval:r,refreshQueryTimeout:i,lan:s}=e;this.log=d(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=n,this.refreshInterval=r??T,this.refreshQueryTimeout=i??C,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");const t=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${n.map((e=>e.toISOString())).join(", ")} ]`),Promise.all(n.map((async(r,i)=>{try{if(await this._refreshCommonPrefixLength(i,r,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(i+1),n.length-1);for(let n=i+1;n<t+1;n++)try{await this._refreshCommonPrefixLength(n,r,e)}catch(e){this.log.error(e)}}}catch(e){this.log.error(e)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,n){if(!n&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const r=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,r,this.routingTable.size);const i=await(0,cn.Z)(this.peerRouting.getClosestPeers(r.toBytes(),{signal:AbortSignal.timeout(this.refreshQueryTimeout)}));this.log(`found ${i} peers that were close to imaginary peer %p`,r),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,r,this.routingTable.size)}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let n=0;n<=e;n++)t[n]=this.commonPrefixLengthRefreshedAt[n]??new Date;return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=(0,st.Z)(2),n=(t[1]<<8)+t[0];return Q(await this._makePeerId(this.routingTable.kb.localNodeId,n,e))}async _makePeerId(e,t,n){if(n>15)throw new Error("Cannot generate peer ID for common prefix length greater than 15");const r=65535<<16-(n+1),i=(new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>n)&r|t&~r,s=gn.Z[i],o=new ArrayBuffer(34),a=new DataView(o,0,o.byteLength);return a.setUint8(0,z.sha256.code),a.setUint8(1,32),a.setUint32(2,s,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=(0,at.d)(this.routingTable.kb.localNodeId,e);let n=0;for(const e of t){if(0!==e)break;n++}yield n}}}const wn=d("libp2p:kad-dht:rpc:handlers:add-provider");class bn{providers;constructor(e){const{providers:t}=e;this.providers=t}async handle(e,t){if(wn("start"),null==t.key||0===t.key.length)throw new i.sv("Missing key","ERR_MISSING_KEY");let n;try{n=U.k0.decode(t.key)}catch(e){throw new i.sv("Invalid CID","ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||wn.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?wn("no valid addresses for provider %p. Ignore",e):(wn("received provider %p for %s (addrs %s)",e,n,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(n,t.id)):wn("invalid provider peer %p from %p",t.id,e)})))}}const En=d("libp2p:kad-dht:rpc:handlers:find-node");class vn{peerRouting;lan;components;constructor(e,t){const{peerRouting:n,lan:r}=t;this.components=e,this.peerRouting=n,this.lan=Boolean(r)}async handle(e,t){En("incoming request from %p for peers closer to %b",e,t.key);let n=[];n=(0,D.f)(this.components.peerId.toBytes(),t.key)?[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode((0,X.a_)("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),n=n.map(this.lan?Me:Ue).filter((({multiaddrs:e})=>e.length));const r=new ae(t.type,new Uint8Array(0),t.clusterLevel);return n.length>0?r.closerPeers=n:En("could not find any peers closer to %b than %p",t.key,e),r}}const _n=d("libp2p:kad-dht:rpc:handlers:get-providers");class Sn{components;peerRouting;providers;lan;constructor(e,t){const{peerRouting:n,providers:r,lan:i}=t;this.components=e,this.peerRouting=n,this.providers=r,this.lan=Boolean(i)}async handle(e,t){let n;try{n=U.k0.decode(t.key)}catch(e){throw new i.sv("Invalid CID","ERR_INVALID_CID")}_n("%p asking for providers for %s",e,n);const[r,s]=await Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(t.key,e)]),o=await this._getPeers(r),a=await this._getPeers(s.map((({id:e})=>e))),c=new ae(t.type,t.key,t.clusterLevel);return o.length>0&&(c.providerPeers=o),a.length>0&&(c.closerPeers=a),_n("got %s providers %s closerPeers",o.length,a.length),c}async _getAddresses(e){return[]}async _getPeers(e){const t=[],n=this.lan?Me:Ue;for(const r of e)try{const e=await this.components.peerStore.get(r),i=n({id:r,multiaddrs:e.addresses.map((({multiaddr:e})=>e)),protocols:e.protocols});i.multiaddrs.length>0&&t.push(i)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return t}}const Rn=d("libp2p:kad-dht:rpc:handlers:get-value");class An{components;peerRouting;constructor(e,t){const{peerRouting:n}=t;this.components=e,this.peerRouting=n}async handle(e,t){const n=t.key;if(Rn("%p asked for key %b",e,n),null==n||0===n.length)throw new i.sv("Invalid key","ERR_INVALID_KEY");const r=new ae(ie.GET_VALUE,n,t.clusterLevel);if(function(e){return"/pk/"===(0,me.B)(e.subarray(0,4))}(n)){Rn("is public key");const e=function(e){return Q(e.subarray(4))}(n);let t;try{const n=await this.components.peerStore.get(e);if(null==n.id.publicKey)throw new i.sv("No public key found in key book","ERR_NOT_FOUND");t=n.id.publicKey}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return Rn("returning found public key"),r.record=new ne(n,t,new Date),r}const[s,o]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=s&&(Rn("had record for %b in local datastore",n),r.record=s),o.length>0&&(Rn("had %s closer peers in routing table",o.length),r.closerPeers=o),r}async _checkLocalDatastore(e){Rn("checkLocalDatastore looking for %b",e);const t=Ve(e);let n;try{n=await this.components.datastore.get(t)}catch(e){if("ERR_NOT_FOUND"===e.code)return;throw e}const r=ne.deserialize(n);if(null==r)throw new i.sv("Invalid record","ERR_INVALID_RECORD");if(!(null==r.timeReceived||Date.now()-r.timeReceived.getTime()>1296e5))return r;await this.components.datastore.delete(t)}}const In=d("libp2p:kad-dht:rpc:handlers:ping");class Tn{async handle(e,t){return In("ping from %p",e),t}}class Cn{log;components;validators;constructor(e,t){const{validators:n}=t;this.components=e,this.log=d("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=n}async handle(e,t){const n=t.key;this.log("%p asked us to store value for key %b",e,n);const r=t.record;if(null==r){const t=`Empty record from: ${e.toString()}`;throw this.log.error(t),new i.sv(t,"ERR_EMPTY_RECORD")}try{await be(this.validators,r),r.timeReceived=new Date;const e=Ve(r.key);await this.components.datastore.put(e,r.serialize().subarray()),this.log("put record for %b into datastore under key %k",n,e)}catch(e){this.log("did not put record for key %b into datastore %o",n,e)}return t}}class Pn{handlers;routingTable;log;constructor(e,t){const{providers:n,peerRouting:r,validators:i,lan:s}=t;this.log=d("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[ie.GET_VALUE]:new An(e,{peerRouting:r}),[ie.PUT_VALUE]:new Cn(e,{validators:i}),[ie.FIND_NODE]:new vn(e,{peerRouting:r,lan:s}),[ie.ADD_PROVIDER]:new bn({providers:n}),[ie.GET_PROVIDERS]:new Sn(e,{peerRouting:r,providers:n,lan:s}),[ie.PING]:new Tn}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(e){this.log.error("Failed to update the kbucket store",e)}const n=this.handlers[t.type];if(null!=n)return n.handle(e,t);this.log.error(`no handler found for message type: ${t.type}`)}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:n}=e,r=n.remotePeer;try{await this.routingTable.add(r)}catch(e){this.log.error(e)}const i=this;await(0,x.z)(t,(e=>Qe.J(e)),(async function*(e){for await(const t of e){const e=ae.deserialize(t);i.log("incoming %s from %p",e.type,r);const n=await i.handleMessage(r,e);null!=n&&(yield n.serialize())}}),(e=>Qe.c(e)),t)})).catch((e=>{this.log.error(e)}))}}class kn extends s.v{log;components;protocol;running;registrarId;constructor(e,t){super();const{protocol:n,lan:r}=t;this.components=e,this.log=d("libp2p:kad-dht:topology-listener:"+(r?"lan":"wan")),this.running=!1,this.protocol=n}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.registrarId=await this.components.registrar.register(this.protocol,{onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new s.A("peer",{detail:e}))}}))}async stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class Nn extends s.v{protocol;routingTable;providers;network;peerRouting;components;log;running;kBucketSize;clientMode;lan;validators;selectors;queryManager;contentFetching;contentRouting;routingTableRefresh;rpc;topologyListener;querySelf;maxInboundStreams;maxOutboundStreams;constructor(e,t){super();const{kBucketSize:n,clientMode:r,validators:i,selectors:o,querySelfInterval:a,lan:c,protocolPrefix:u,pingTimeout:l,pingConcurrency:h,maxInboundStreams:f,maxOutboundStreams:y,providers:g}=t;this.running=!1,this.components=e,this.lan=Boolean(c),this.log=d("libp2p:kad-dht:"+(!0===c?"lan":"wan")),this.protocol=`${u??"/ipfs"}${!0===c?"/lan":""}/kad/1.0.0`,this.kBucketSize=n??20,this.clientMode=r??!0,this.maxInboundStreams=f??32,this.maxOutboundStreams=y??64,this.routingTable=new yn(e,{kBucketSize:n,lan:this.lan,pingTimeout:l,pingConcurrency:h,protocol:this.protocol}),this.providers=new Yt(e,g??{}),this.validators={...Ee,...i},this.selectors={...we,...o},this.network=new Ye(e,{protocol:this.protocol,lan:this.lan});const m=(0,p.Z)();!0===t.allowQueryWithZeroPeers&&m.resolve(),this.queryManager=new an(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:c,initialQuerySelfHasRun:m,routingTable:this.routingTable}),this.peerRouting=new ut(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new Fe(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,network:this.network,lan:this.lan}),this.contentRouting=new je(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new mn({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new Pn(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new kn(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new hn(e,{peerRouting:this.peerRouting,interval:a,initialInterval:t.initialQuerySelfInterval,lan:this.lan,initialQuerySelfHasRun:m,routingTable:this.routingTable}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new s.A("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.get(t),n={id:t,multiaddrs:e.addresses.map((({multiaddr:e})=>e)),protocols:e.protocols};await this.onPeerConnect(n)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}async onPeerConnect(e){if(this.log("peer %p connected with protocols",e.id,e.protocols),0!==(e=this.lan?Me(e):Ue(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start()]),this.querySelf.start(),await this.routingTableRefresh.start()}async stop(){this.running=!1,this.querySelf.stop(),await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop()])}async*put(e,t,n={}){yield*this.contentFetching.put(e,t,n)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.addressManager.getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}}const xn=d("libp2p:kad-dht");class Dn{dht;constructor(e){this.dht=e}async provide(e,t={}){await(0,f.Z)(this.dht.provide(e,t))}async*findProviders(e,t={}){for await(const n of this.dht.findProviders(e,t))"PROVIDER"===n.name&&(yield*n.providers)}async put(e,t,n){await(0,f.Z)(this.dht.put(e,t,n))}async get(e,t){for await(const n of this.dht.get(e,t))if("VALUE"===n.name)return n.value;throw new i.sv("Not found","ERR_NOT_FOUND")}}class Ln{dht;constructor(e){this.dht=e}async findPeer(e,t={}){for await(const n of this.dht.findPeer(e,t))if("FINAL_PEER"===n.name)return n.peer;throw new i.sv("Not found","ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){for await(const n of this.dht.getClosestPeers(e,t))"FINAL_PEER"===n.name&&(yield n.peer)}}class On extends s.v{wan;lan;components;contentRouting;peerRouting;constructor(e,t={}){super(),this.components=e,this.wan=new Nn(e,{protocolPrefix:"/ipfs",...t,lan:!1}),this.lan=new Nn(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}),this.contentRouting=new Dn(this),this.peerRouting=new Ln(this),this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new s.A("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new s.A("peer",{detail:e.detail}))})),null==t.clientMode&&e.events.addEventListener("self:peer:update",(e=>{xn("received update of self-peer info");const t=e.detail.peer.addresses.some((({multiaddr:e})=>{const t=function(e){const t=e.stringTuples();for(const e of t)if(290===e[0])return!1;if(54===t[0][0]||55===t[0][0]||56===t[0][0])return xn("%m is public %s",e,!0),!0;if(4===t[0][0]||41===t[0][0]){const n=(0,b.Z)(`${t[0][1]}`),r=null==n||!n;return xn("%m is public %s",e,r),r}return!1}(e);return xn("%m is public %s",e,t),t}));this.getMode().then((async e=>{t&&"client"===e?await this.setMode("server"):"server"!==e||t||await this.setMode("client")})).catch((e=>{xn.error("error setting dht server mode",e)}))}))}[Symbol.toStringTag]="@libp2p/dual-kad-dht";get[r.J](){return this.contentRouting}get[a.z](){return this.peerRouting}get[o.O](){return this}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,n={}){for await(const r of w(this.lan.put(e,t,n),this.wan.put(e,t,n)))yield r}async*get(e,t={}){let n=!1,r=!1;for await(const i of w(this.lan.get(e,t),this.wan.get(e,t)))yield i,"DIAL_PEER"===i.name&&(n=!0),"VALUE"===i.name&&(n=!0,null!=i.value&&(r=!0)),"SEND_QUERY"===i.name&&(n=!0);if(!n)throw new i.sv("No peers found in routing table!","ERR_NO_PEERS_IN_ROUTING_TABLE");r||(yield fe({from:this.components.peerId,error:new i.sv("Not found","ERR_NOT_FOUND")},t))}async*provide(e,t={}){let n=0,r=0;const s=[],o=[this.lan];"server"===await this.wan.getMode()&&o.push(this.wan);for await(const i of w(...o.map((n=>n.provide(e,t)))))yield i,"SEND_QUERY"===i.name&&n++,"QUERY_ERROR"===i.name&&s.push(i.error),"PEER_RESPONSE"===i.name&&"ADD_PROVIDER"===i.messageName&&(xn("sent provider record for %s to %p",e,i.from),r++);if(0===r){if(s.length>0)throw new i.sv(`Failed to provide to ${s.length} of ${n} peers`,"ERR_PROVIDES_FAILED",{errors:s});throw new i.sv("Failed to provide - no peers found","ERR_PROVIDES_FAILED")}}async*findProviders(e,t={}){yield*w(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let n=!1;for await(const r of w(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield r,"SEND_QUERY"!==r.name&&"FINAL_PEER"!==r.name||(n=!0);if(!n)throw new i.sv("Peer lookup failed","ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*w(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}var Un,Mn;function Bn(e){return t=>new On(t,e)}!function(e){e[e.SEND_QUERY=0]="SEND_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADD_PEER=6]="ADD_PEER",e[e.DIAL_PEER=7]="DIAL_PEER"}(Un||(Un={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(Mn||(Mn={}))},25329:function(e,t,n){"use strict";function r(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds();return`${t}-${n}-${r}T${i}:${s}:${o}.${String(1e3*a*1e3).padStart(9,"0")}Z`}function i(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,s=parseInt(n[3],10),o=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),u=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,s,o,a,c,u))}n.d(t,{D:function(){return r},r:function(){return i}})},14750:function(e,t){"use strict";t.Z=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782]},25041:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(66648),i=n(28517),s=n(21894);const o={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function a(e){const t=e?.algorithm??"AES-GCM";let n=e?.keyLength??16;const a=e?.nonceLength??12,c=e?.digest??"SHA-256",u=e?.saltLength??16,l=e?.iterations??32767,h=s.Z.get();n*=8;return{encrypt:async function(e,s){const d=h.getRandomValues(new Uint8Array(u)),f=h.getRandomValues(new Uint8Array(a)),p={name:t,iv:f};let y;if("string"==typeof s&&(s=(0,i.m)(s)),0===s.length){y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:d,iterations:l,hash:{name:c}},r=await h.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,r,{name:t,length:n},!0,["encrypt"])}catch{y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:d,iterations:l,hash:{name:c}},r=await h.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,r,{name:t,length:n},!0,["encrypt"])}const g=await h.subtle.encrypt(p,y,e);return(0,r.z)([d,p.iv,new Uint8Array(g)])},decrypt:async function(e,r){const s=e.subarray(0,u),d=e.subarray(u,u+a),f=e.subarray(u+a),p={name:t,iv:d};let y;if("string"==typeof r&&(r=(0,i.m)(r)),0===r.length)try{const e={name:"PBKDF2",salt:s,iterations:l,hash:{name:c}},i=await h.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,i,{name:t,length:n},!0,["decrypt"])}catch{y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:s,iterations:l,hash:{name:c}},i=await h.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,i,{name:t,length:n},!0,["decrypt"])}const g=await h.subtle.decrypt(p,y,f);return new Uint8Array(g)}}}},51288:function(e,t,n){"use strict";n.r(t),n.d(t,{KeyType:function(){return r},PrivateKey:function(){return o},PublicKey:function(){return s}});var r,i,s,o,a=n(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(r||(r={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(i||(i={})),function(e){e.codec=()=>(0,a.Ji)(i)}(r||(r={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(s||(s={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(o||(o={}))},68038:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(49541),i=n(90519);function s(e){if(isNaN(e)||e<=0)throw new r.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return(0,i.O6)(e)}},33062:function(e,t,n){"use strict";n.d(t,{YO:function(){return a},kI:function(){return u},rT:function(){return c}});n(97116),n(15764);var r=n(3832),i=n(66648),s=n(28517),o=n(41354);function a(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,i.z)([new Uint8Array(t-n.length),n])}return(0,o.B)(n,"base64url")}function c(e){const t=u(e);return new r.jsbn.BigInteger((0,o.B)(t,"base16"),16)}function u(e,t){let n=(0,s.m)(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=(0,i.z)([new Uint8Array(t-n.length),n])}return n}},56708:function(e,t,n){"use strict";n.d(t,{Fm:function(){return v},xV:function(){return E}});n(9839);var r=n(85322),i=n(69620),s=n(24005),o=n(18616),a=n(7188),c=n(57050),u=n(32161),l=n(72078),h=n(12971);function d(e,t="utf8"){const n=l.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,h.P)(globalThis.Buffer.from(e,"utf-8"))}var f=n(16978),p=n(49736);const y=p.C,g=p.aY,m=function(e){let t=0;if(e=e.toString().trim(),y(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(g(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;y(n[r])&&(e=m(n[r]),n[r]=(0,f.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,f.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},w=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var b=n(4525);(0,b.Ev)("ip4"),(0,b.Ev)("ip6"),(0,b.Ev)("ipcidr");function E(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return function(e){const t=w(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!p.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return C(t);case 6:case 273:case 33:case 132:return I(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,f.B)(n,"base58btc")}(t);case 444:case 445:return P(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,f.B)(n,"base64url")}(t);default:return(0,f.B)(t,"base16")}}function v(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return R(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return T(t);case 6:case 273:case 33:case 132:return A(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=S.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return d(t,"base16")}}const _=Object.values(s.gh).map((e=>e.decoder)),S=function(){let e=_[0].or(_[1]);return _.slice(2).forEach((t=>e=e.or(t))),e}();function R(e){if(!p.h6(e))throw new Error("invalid ip address");return m(e)}function A(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function I(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function T(e){const t=d(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function C(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,f.B)(e)}function P(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,f.B)(t,"base32")}:${I(n)}`}},18047:function(e,t,n){"use strict";n.d(t,{HM:function(){return R},a_:function(){return h.Ev}});var r=n(49541),i=n(69620),s=n(18616),o=n(61876),a=n(16978),c=n(57050),u=n(32161),l=n(56708),h=n(4525);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(83640);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},4525:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},32161:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(74078),i=n(12971);function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return(0,i.P)(n)}},61876:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},16978:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(72078);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},72078:function(e,t,n){"use strict";var r=n(25926),i=n(74078);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},40826:function(e,t,n){"use strict";function r(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)}for(const t of e){if(!0===t?.aborted){n();break}null!=t?.addEventListener&&t.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)},r}n.d(t,{N:function(){return r}})},24084:function(e,t,n){"use strict";function r(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}n.d(t,{A:function(){return r}})},39454:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);}},1214:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t}},90225:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t=0;for await(const n of e)t++;return t})();{let t=0;for(const n of e)t++;return t}}},3858:function(e,t,n){"use strict";var r=n(75671);t.Z=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=(0,r.Z)(e),{value:i,done:s}=n.next();if(!0===s)return function*(){}();const o=t(i);if("function"==typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const a=t;return function*(){yield o;for(const e of n)yield a(e)}()}},76061:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},55001:function(e,t){"use strict";t.Z=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()}},85322:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(59902);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},69620:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(59902);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},8063:function(e,t,n){"use strict";n.r(t),n.d(t,{base64:function(){return i},base64pad:function(){return s},base64url:function(){return o},base64urlpad:function(){return a}});var r=n(59902);const i=(0,r.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),s=(0,r.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o=(0,r.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=(0,r.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},33780:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},18616:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(85322),i=n(69620),s=n(33780),o=n(7188),a=n(83860);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},7188:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(33780),i=n(83860);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},87222:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(33780),i=n(7188);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},28769:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(92969);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},83860:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},19060:function(e,t,n){"use strict";function r(e,t,n){let r=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=r+s;n(e[o],t)<=0?(r=++o,i-=s+1):i=s}return r}n.d(t,{Z:function(){return r}})},85680:function(e,t,n){"use strict";function r(e,t){for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}n.d(t,{q:function(){return r}})},80437:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(12481),i=n(40567);function s(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=(0,r.E)(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return(0,i.P)(n)}},13651:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(15291),i=n(61743),s=n(42999);const o={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function a(e){const t=e?.algorithm??"AES-GCM";let n=e?.keyLength??16;const a=e?.nonceLength??12,c=e?.digest??"SHA-256",u=e?.saltLength??16,l=e?.iterations??32767,h=s.Z.get();n*=8;return{encrypt:async function(e,s){const d=h.getRandomValues(new Uint8Array(u)),f=h.getRandomValues(new Uint8Array(a)),p={name:t,iv:f};let y;if("string"==typeof s&&(s=(0,i.m)(s)),0===s.length){y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:d,iterations:l,hash:{name:c}},r=await h.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,r,{name:t,length:n},!0,["encrypt"])}catch{y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:d,iterations:l,hash:{name:c}},r=await h.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,r,{name:t,length:n},!0,["encrypt"])}const g=await h.subtle.encrypt(p,y,e);return(0,r.z)([d,p.iv,new Uint8Array(g)])},decrypt:async function(e,r){const s=e.subarray(0,u),d=e.subarray(u,u+a),f=e.subarray(u+a),p={name:t,iv:d};let y;if("string"==typeof r&&(r=(0,i.m)(r)),0===r.length)try{const e={name:"PBKDF2",salt:s,iterations:l,hash:{name:c}},i=await h.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,i,{name:t,length:n},!0,["decrypt"])}catch{y=await h.subtle.importKey("jwk",o,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:s,iterations:l,hash:{name:c}},i=await h.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);y=await h.subtle.deriveKey(e,i,{name:t,length:n},!0,["decrypt"])}const g=await h.subtle.decrypt(p,y,f);return new Uint8Array(g)}}}},51097:function(e,t,n){"use strict";n.d(t,{Jz:function(){return r},_q:function(){return o},nh:function(){return s}});var r,i,s,o,a=n(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(r||(r={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(i||(i={})),function(e){e.codec=()=>(0,a.Ji)(i)}(r||(r={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(s||(s={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(o||(o={}))},29727:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(49541),i=n(40909);function s(e){if(isNaN(e)||e<=0)throw new r.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return(0,i.O6)(e)}},71301:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(67583);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},39646:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(67583);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},1337:function(e,t,n){"use strict";n.r(t),n.d(t,{base64:function(){return i},base64pad:function(){return s},base64url:function(){return o},base64urlpad:function(){return a}});var r=n(67583);const i=(0,r.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),s=(0,r.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o=(0,r.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=(0,r.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},71855:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},71030:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(71301),i=n(39646),s=n(71855),o=n(88580),a=n(64447);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},88580:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(71855),i=n(64447);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},28214:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(71855),i=n(88580);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},14413:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(59635);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},64447:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},83633:function(e,t,n){"use strict";var r=n(98721),i=n(64701);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},69860:function(e,t,n){"use strict";n.d(t,{kg:function(){return a}});var r=n(11227),i=n(81653),s=n(14249),o=n(99382);function a(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return r.enabled(`${e}:trace`)&&null!=r.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=r(`${e}:trace`)),Object.assign(r(e),{error:r(`${e}:error`),trace:t})}r.formatters.b=e=>null==e?"undefined":i.base58btc.baseEncode(e),r.formatters.t=e=>null==e?"undefined":s.base32.baseEncode(e),r.formatters.m=e=>null==e?"undefined":o.base64.baseEncode(e),r.formatters.p=e=>null==e?"undefined":e.toString(),r.formatters.c=e=>null==e?"undefined":e.toString(),r.formatters.k=e=>null==e?"undefined":e.toString()},66978:function(e,t,n){"use strict";n.d(t,{R:function(){return O}});var r,i=n(37430),s=n(28391),o=n(59379),a=n(62308);function c(e){return new Uint8Array(e)}!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(r||(r={}));const u=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),l=Object.freeze({NEW_STREAM:r.NEW_STREAM,MESSAGE:r.MESSAGE_INITIATOR,CLOSE:r.CLOSE_INITIATOR,RESET:r.RESET_INITIATOR}),h=Object.freeze({MESSAGE:r.MESSAGE_RECEIVER,CLOSE:r.CLOSE_RECEIVER,RESET:r.RESET_RECEIVER});var d=n(85275);const f=1048576,p=(e,t)=>{t.append(e)};var y=async function*(e,t={}){let n=new a.H,r=!1,i=(0,d.Z)(),s=Number(t.size??f);(isNaN(s)||0===s||s<0)&&(s=f);const o=t.yieldAfter??0,c=t.serialize??p;for(Promise.resolve().then((async()=>{try{let t;for await(const r of e)c(r,n),n.byteLength>=s?(clearTimeout(t),i.resolve()):t=setTimeout((()=>{i.resolve()}),o);clearTimeout(t),i.resolve()}catch(e){i.reject(e)}finally{r=!0}}));!r;)if(await i.promise,i=(0,d.Z)(),n.byteLength>0){const e=n;n=new a.H,yield e.subarray()}};const g=10240;const m=new class{constructor(){this._pool=c(g),this._poolOffset=0}write(e,t){const n=this._pool;let i=this._poolOffset;o.encode(e.id<<3|e.type,n,i),i+=o.encode.bytes??0,e.type!==r.NEW_STREAM&&e.type!==r.MESSAGE_INITIATOR&&e.type!==r.MESSAGE_RECEIVER||null==e.data?o.encode(0,n,i):o.encode(e.data.length,n,i),i+=o.encode.bytes??0;const s=n.subarray(this._poolOffset,i);g-i<100?(this._pool=c(g),this._poolOffset=0):this._poolOffset=i,t.append(s),e.type!==r.NEW_STREAM&&e.type!==r.MESSAGE_INITIATOR&&e.type!==r.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};const w=1<<20;class b{constructor(e=w,t=4194304){this._buffer=new a.H,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(e){if("ERR_MSG_TOO_BIG"===e.code)throw e;break}const{id:e,type:n,length:i,offset:s}=this._headerInfo;if(this._buffer.length-s<i)break;const o={id:e,type:n};n!==r.NEW_STREAM&&n!==r.MESSAGE_INITIATOR&&n!==r.MESSAGE_RECEIVER||(o.data=this._buffer.sublist(s,s+i)),t.push(o),this._buffer.consume(s+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=_(e),{value:r,offset:i}=_(e,n),s=7&t;if(null==u[s])throw new Error(`Invalid type received: ${s}`);if(r>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:s,offset:n+i,length:r}}}const E=128,v=127;function _(e,t=0){let n,r=0,i=0,s=t;const o=e.length;do{if(s>=o||i>49)throw t=0,new RangeError("Could not decode varint");n=e.get(s++),r+=i<28?(n&v)<<i:(n&v)*Math.pow(2,i),i+=7}while(n>=E);return{value:r,offset:t=s-t}}var S=n(52770),R=n(32044),A=n(77408),I=n(69860);const T=(0,I.kg)("libp2p:mplex:stream"),C="ERR_STREAM_RESET";var P=n(738),k=n(8558);const N=(0,I.kg)("libp2p:mplex");function x(e){const t={...e,type:`${u[e.type]} (${e.type})`};return e.type===r.NEW_STREAM&&(t.data=(0,P.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==r.MESSAGE_INITIATOR&&e.type!==r.MESSAGE_RECEIVER||(t.data=(0,P.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class D{constructor(e){this.protocol="/mplex/6.7.0",e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.sink=this._createSink();const t=this._createSource();this._source=t,this.source=t,this.closeController=new AbortController,this.rateLimiter=new k.RateLimiterMemory({points:e.disconnectThreshold??5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}close(e){this.closeController.signal.aborted||(null!=e?this.streams.forEach((t=>{t.abort(e)})):this.streams.forEach((e=>{e.close()})),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:n}=e,r=this._streams.receivers;return this._newStream({id:t,name:n,type:"receiver",registry:r})}_newStream(e){const{id:t,name:n,type:r,registry:o}=e;if(N("new %s stream %s",r,t),"initiator"===r&&this._streams.initiators.size===(this._init.maxOutboundStreams??1024))throw new S.s("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(o.has(t))throw new Error(`${r} stream ${t} already exists!`);const c=function(e){const{id:t,name:n,send:r,onEnd:o,type:c="initiator",maxMsgSize:u=w}=e,d=new AbortController,f=new AbortController,p=new AbortController,y="initiator"===c?l:h,g="initiator"===c?`i${t}`:`r${t}`,m=`${null==n?t:n}`;let b,E=!1,v=!1,_=!1;const I={open:Date.now()},P=e=>{v||(v=!0,T.trace("%s stream %s sink end - err: %o",c,m,e),null!=e&&null==b&&(b=e),E&&(I.close=Date.now(),null!=o&&o(b)))},k=(0,i.d)({onEnd:e=>{E||(E=!0,T.trace("%s stream %s source end - err: %o",c,m,e),null!=e&&null==b&&(b=e),v&&(N.stat.timeline.close=Date.now(),null!=o&&o(b)))}}),N={close:()=>{T.trace("%s stream %s close",c,m),N.closeRead(),N.closeWrite()},closeRead:()=>{T.trace("%s stream %s closeRead",c,m),E||k.end()},closeWrite:()=>{if(T.trace("%s stream %s closeWrite",c,m),!v){p.abort();try{r({id:t,type:y.CLOSE})}catch(e){T.trace("%s stream %s error sending close",c,n,e)}P()}},abort:e=>{T.trace("%s stream %s abort",c,m,e),k.end(e),d.abort(),P(e)},reset:()=>{const e=new S.s("stream reset",C);f.abort(),k.end(e),P(e)},sink:async e=>{if(_)throw new S.s("sink already called on stream","ERR_DOUBLE_SINK");if(_=!0,v)throw new S.s("stream closed for writing","ERR_SINK_ENDED");e=(0,s.wJ)(e,(0,R.anySignal)([d.signal,f.signal,p.signal]));try{"initiator"===c&&r({id:t,type:l.NEW_STREAM,data:new a.H((0,A.m)(m))});for await(let n of e)for(;n.length>0;){if(n.length<=u){r({id:t,type:y.MESSAGE,data:n instanceof Uint8Array?new a.H(n):n});break}n=n instanceof Uint8Array?new a.H(n):n,r({id:t,type:y.MESSAGE,data:n.sublist(0,u)}),n.consume(u)}}catch(e){if("aborted"===e.type&&"The operation was aborted"===e.message){if(p.signal.aborted)return;f.signal.aborted&&(e.message="stream reset",e.code=C),d.signal.aborted&&(e.message="stream aborted",e.code="ERR_STREAM_ABORT")}if(e.code===C)T.trace("%s stream %s reset",c,n);else{T.trace("%s stream %s error",c,n,e);try{r({id:t,type:y.RESET})}catch(e){T.trace("%s stream %s error sending reset",c,n,e)}}return k.end(e),void P(e)}try{r({id:t,type:y.CLOSE})}catch(e){T.trace("%s stream %s error sending close",c,n,e)}P()},source:k,sourcePush:e=>{k.push(e)},sourceReadableLength:()=>k.readableLength,stat:{direction:"initiator"===c?"outbound":"inbound",timeline:I},metadata:{},id:g};return N}({id:t,name:n,send:e=>{N.enabled&&N.trace("%s stream %s send",r,t,x(e)),this._source.push(e)},type:r,onEnd:()=>{N("%s stream with id %s and protocol %s ended",r,t,c.stat.protocol),o.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(c)},maxMsgSize:this._init.maxMsgSize});return o.set(t,c),c}_createSink(){return async e=>{const t=[this.closeController.signal];null!=this._init.signal&&t.push(this._init.signal),e=(0,s.wJ)(e,R(t));try{const t=new b(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const n of e)for(const e of t.write(n))await this._handleIncoming(e);this._source.end()}catch(e){N("error in sink",e),this._source.end(e)}}}_createSource(){const e=(0,i.e)({objectMode:!0,onEnd:e=>{this.close(e)}});return Object.assign(async function*(e,t=0){if(null!=t&&0!==t)yield*y(e,{size:t,serialize:(e,t)=>{for(const n of e)m.write(n,t)}});else for await(const t of e){const e=new a.H;for(const n of t)m.write(n,e);yield e.subarray()}}(e,this._init.minSendBytes),{push:e.push,end:e.end,return:e.return})}async _handleIncoming(e){const{id:t,type:n}=e;if(N.enabled&&N.trace("incoming message",x(e)),e.type===r.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??1024)){N("too many inbound streams open"),this._source.push({id:t,type:r.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return N("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this._source.end(new Error("Too many open streams"))}return}const n=this._newReceiverStream({id:t,name:(0,P.BB)(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(n))}const i=(1==(1&n)?this._streams.initiators:this._streams.receivers).get(t);if(null==i)return void N("missing stream %s for message type %s",t,u[n]);const s=this._init.maxStreamBufferSize??4194304;switch(n){case r.MESSAGE_INITIATOR:case r.MESSAGE_RECEIVER:if(i.sourceReadableLength()>s){this._source.push({id:e.id,type:n===r.MESSAGE_INITIATOR?r.RESET_RECEIVER:r.RESET_INITIATOR});const t=new S.s("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");return void i.abort(t)}i.sourcePush(e.data);break;case r.CLOSE_INITIATOR:case r.CLOSE_RECEIVER:i.closeRead();break;case r.RESET_INITIATOR:case r.RESET_RECEIVER:i.reset();break;default:N("unknown message type %s",n)}}}class L{constructor(e={}){this.protocol="/mplex/6.7.0",this._init=e}createStreamMuxer(e={}){return new D({...e,...this._init})}}function O(e={}){return()=>new L(e)}},90770:function(e,t,n){"use strict";n.d(t,{T:function(){return r},Y:function(){return i}});const r="/multistream/1.0.0",i=1024},15086:function(e,t,n){"use strict";function r(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}n.d(t,{A:function(){return r}})},56546:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t}},87199:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});class r{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function s(e={}){return o((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function o(e,t){let n,r,s,o=(t=t??{}).onEnd,a=new i;const c=e=>null!=r?r(e):(a.push(e),n),u=e=>{if(s)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>s?n:(s=!0,null!=e?(e=>(a=new i,null!=r?r({error:e}):(a.push({error:e}),n)))(e):c({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>a.isEmpty()?s?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,a.push(s);try{t(e(a))}catch(e){i(e)}return n}})):e(a),return:()=>(a=new i,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return a.size}},null==o)return n;const h=n;return n={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(h.return(),null!=o&&(o(),o=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=o&&(o(e),o=void 0),n),get readableLength(){return h.readableLength}},n}},67483:function(e,t,n){"use strict";n.d(t,{ji:function(){return s},fd:function(){return o}});var r=n(39729),i=n(17512);class s{map;constructor(e){if(this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return(0,i.D)(this.map.entries(),(e=>[(0,r.jE)(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,n)=>{e(t,(0,r.jE)(n),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return(0,i.D)(this.map.keys(),(e=>(0,r.jE)(e)))}values(){return this.map.values()}get size(){return this.map.size}}class o{set;constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return(0,i.D)(this.set.entries(),(e=>{const t=(0,r.jE)(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const n=(0,r.jE)(t);e(n,n,this)}))}has(e){return this.set.has(e.toString())}values(){return(0,i.D)(this.set.values(),(e=>(0,r.jE)(e)))}intersection(e){const t=new o;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new o;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new o;for(const n of e)t.add(n);for(const e of this)t.add(e);return t}}n(35269)},17512:function(e,t,n){"use strict";function r(e,t){const n={[Symbol.iterator]:()=>n,next:()=>{const n=e.next(),r=n.value;if(!0===n.done||null==r){return{done:!0,value:void 0}}return{done:!1,value:t(r)}}};return n}n.d(t,{D:function(){return r}})},39729:function(e,t,n){"use strict";n.d(t,{jE:function(){return E}});n(49541);var r=n(5681),i=n(27483),s=n(3010),o=n(73500),a=n(8824),c=n(43550),u=n(27658),l=n(82953);const h=Symbol.for("nodejs.util.inspect.custom"),d=Object.values(s.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),s.gh.identity.decoder),f=114,p=36,y=37;class g{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[r.N]=!0;toString(){return null==this.string&&(this.string=i.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return o.k0.createV1(f,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,l.f)(this.multihash.bytes,e);if("string"==typeof e)return E(e).equals(this);if(null!=e?.multihash?.bytes)return(0,l.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[h](){return`PeerId(${this.toString()})`}}class m extends g{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class w extends g{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class b extends g{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function E(e,t){if(t=t??d,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=a.Jx(i.base58btc.decode(`z${e}`));return e.startsWith("12D")?new w({multihash:t}):e.startsWith("16U")?new b({multihash:t}):new m({multihash:t})}return function(e){try{const t=a.Jx(e);if(t.code===c.identity.code){if(t.digest.length===p)return new w({multihash:t});if(t.digest.length===y)return new b({multihash:t})}if(t.code===u.sha256.code)return new m({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==f)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===u.sha256.code)return new m({multihash:e.multihash});if(t.code===c.identity.code){if(t.digest.length===p)return new w({multihash:e.multihash});if(t.digest.length===y)return new b({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(o.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(d.decode(e))}},2310:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(87532);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},27483:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(87532);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},33340:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},73500:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(2310),i=n(27483),s=n(33340),o=n(8824),a=n(35932);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},8824:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(33340),i=n(35932);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},43550:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(33340),i=n(8824);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},27658:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(47763);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},35932:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},82953:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},21017:function(e,t,n){"use strict";n.d(t,{n9:function(){return a},W$:function(){return c}});var r,i=n(86906),s=(n(77408),n(23366)),o=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,o.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.pubKey=e.bytes();break;case 3:n.privKey=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,o.LE)(t,e.codec()),e.decode=t=>(0,o.C6)(t,e.codec())}(r||(r={}));const a=async()=>{const e=await(0,i.generateKeyPair)("Ed25519"),t=await u(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)},c=async e=>{const t=await(0,i.generateKeyPair)("RSA",e?.bits??2048),n=await u(t);if("RSA"===n.type)return n;throw new Error(`Generated unexpected PeerId type "${n.type}"`)};async function u(e){return await(0,s.y5)((0,i.marshalPublicKey)(e.public),(0,i.marshalPrivateKey)(e))}},23366:function(e,t,n){"use strict";n.d(t,{cv:function(){return S},jE:function(){return _},vL:function(){return v},y5:function(){return R}});var r=n(38161),i=n(93387),s=n(81653),o=n(29094),a=n(38566),c=n(73062),u=n(27353),l=n(52770),h=n(682);const d=Symbol.for("nodejs.util.inspect.custom"),f=Object.values(i.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),i.gh.identity.decoder),p=114,y=36,g=37;class m{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[h.N](){return!0}toString(){return null==this.string&&(this.string=s.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return r.k0.createV1(p,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,c.f)(this.multihash.bytes,e);if("string"==typeof e)return _(e).equals(this);if(null!=e?.multihash?.bytes)return(0,c.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[d](){return`PeerId(${this.toString()})`}}class w extends m{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class b extends m{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class E extends m{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function v(e){if("RSA"===e.type)return new w(e);if("Ed25519"===e.type)return new b(e);if("secp256k1"===e.type)return new E(e);throw new l.s("Not a PeerId","ERR_INVALID_PARAMETERS")}function _(e,t){if(t=t??f,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=o.Jx(s.base58btc.decode(`z${e}`));return e.startsWith("12D")?new b({multihash:t}):e.startsWith("16U")?new E({multihash:t}):new w({multihash:t})}return S(f.decode(e))}function S(e){try{const t=o.Jx(e);if(t.code===a.identity.code){if(t.digest.length===y)return new b({multihash:t});if(t.digest.length===g)return new E({multihash:t})}if(t.code===u.sha256.code)return new w({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==p)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===u.sha256.code)return new w({multihash:e.multihash});if(t.code===a.identity.code){if(t.digest.length===y)return new b({multihash:e.multihash});if(t.digest.length===g)return new E({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(r.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function R(e,t){return e.length===y?new b({multihash:o.Ue(a.identity.code,e),privateKey:t}):e.length===g?new E({multihash:o.Ue(a.identity.code,e),privateKey:t}):new w({multihash:await u.sha256.digest(e),publicKey:e,privateKey:t})}},64306:function(e,t,n){"use strict";n.d(t,{K:function(){return Ae},X:function(){return R}});var r=n(52770),i=n(77408),s=n(73062),o=n(86906);const a="ERR_SIGNATURE_NOT_VALID";var c,u=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,u.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,u.LE)(t,e.codec()),e.decode=t=>(0,u.C6)(t,e.codec())}(c||(c={}));var l=n(23366),h=n(62308),d=n(72004),f=n(66574);const p=Math.pow(2,7),y=Math.pow(2,14),g=Math.pow(2,21),m=Math.pow(2,28),w=Math.pow(2,35),b=Math.pow(2,42),E=Math.pow(2,49),v=Math.pow(2,56),_=Math.pow(2,63),S={encodingLength:e=>e<p?1:e<y?2:e<g?3:e<m?4:e<w?5:e<b?6:e<E?7:e<v?8:e<_?9:10,encode(e,t,n=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=(0,f.E)(S.encodingLength(e))),d.Z.fromNumber(e).toBytes(t,n),t},decode:(e,t=0)=>d.Z.fromBytes(e,t).toNumber(!0)};class R{constructor(e){const{peerId:t,payloadType:n,payload:r,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=c.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return(0,s.f)(this.marshal(),e.marshal())}async validate(e){const t=A(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const n=(0,o.unmarshalPublicKey)(this.peerId.publicKey);return await n.verify(t.subarray(),this.signature)}}R.createFromProtobuf=async e=>{const t=c.decode(e),n=await(0,l.y5)(t.publicKey);return new R({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},R.seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,r=e.codec,i=e.marshal(),s=A(n,r,i),a=await(0,o.unmarshalPrivateKey)(t.privateKey),c=await a.sign(s.subarray());return new R({peerId:t,payloadType:r,payload:i,signature:c})},R.openAndCertify=async(e,t)=>{const n=await R.createFromProtobuf(e);if(!await n.validate(t))throw new r.s("envelope signature is not valid for the given domain",a);return n};const A=(e,t,n)=>{const r=(0,i.m)(e),s=S.encode(r.byteLength),o=S.encode(t.length),a=S.encode(n.length);return new h.H(s,r,o,t,a,n)};var I=n(49736),T=n(49784);const C=I.C,P=I.aY,k=function(e){let t=0;if(e=e.toString().trim(),C(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(P(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;C(n[r])&&(e=k(n[r]),n[r]=(0,T.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,T.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},N=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},x=-1,D={},L={};function O(e){if("number"==typeof e){if(null!=L[e])return L[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=D[e])return D[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,x,"ip6zone"],[43,8,"ipcidr"],[53,x,"dns",!0],[54,x,"dns4",!0],[55,x,"dns6",!0],[56,x,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,x,"unix",!1,!0],[421,x,"ipfs"],[421,x,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,x,"garlic64"],[448,0,"tls"],[449,x,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,x,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,x,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);L[t.code]=t,D[t.name]=t}));var U=n(38161),M=n(14249),B=n(81653),z=n(93387),V=n(29094),$=n(31617),F=n(41690);n(9839);O("ip4"),O("ip6"),O("ipcidr");function j(e,t){switch(O(e).code){case 4:case 41:return function(e){const t=N(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!I.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Y(t);case 6:case 273:case 33:case 132:return W(t).toString();case 421:return function(e){const t=$.decode(e),n=e.slice($.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return(0,T.B)(n,"base58btc")}(t);case 444:case 445:return J(t);case 466:return function(e){const t=$.decode(e),n=e.slice($.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,T.B)(n,"base64url")}(t);default:return(0,T.B)(t,"base16")}}function K(e,t){switch(O(e).code){case 4:case 41:return G(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Q(t);case 6:case 273:case 33:case 132:return Z(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?V.Jx(B.base58btc.decode(`z${e}`)).bytes:U.k0.parse(e).multihash.bytes;const n=Uint8Array.from($.encode(t.length));return(0,F.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=M.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=Z(r);return(0,F.z)([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=M.base32.decode(`b${t[0]}`),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=Z(r);return(0,F.z)([n,i],n.length+i.length)}(t);case 466:return function(e){const t=H.decode(e),n=Uint8Array.from($.encode(t.length));return(0,F.z)([n,t],n.length+t.length)}(t);default:return(0,i.m)(t,"base16")}}const q=Object.values(z.gh).map((e=>e.decoder)),H=function(){let e=q[0].or(q[1]);return q.slice(2).forEach((t=>e=e.or(t))),e}();function G(e){if(!I.h6(e))throw new Error("invalid ip address");return k(e)}function Z(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function W(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function Q(e){const t=(0,i.m)(e),n=Uint8Array.from($.encode(t.length));return(0,F.z)([n,t],n.length+t.length)}function Y(e){const t=$.decode(e);if((e=e.slice($.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return(0,T.B)(e)}function J(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,T.B)(t,"base32")}:${W(n)}`}function X(e){return e.map((e=>{const t=ue(e);return null!=e[1]?[t.code,j(t.code,e[1])]:[t.code]}))}function ee(e){return se((0,F.z)(e.map((e=>{const t=ue(e);let n=Uint8Array.from($.encode(t.code));return e.length>1&&null!=e[1]&&(n=(0,F.z)([n,e[1]])),n}))))}function te(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return $.decode(t)+($.decode.bytes??0)}function ne(e){const t=[];let n=0;for(;n<e.length;){const r=$.decode(e,n),i=$.decode.bytes??0,s=te(O(r),e.slice(n+i));if(0===s){t.push([r]),n+=i;continue}const o=e.slice(n+i,n+i+s);if(n+=s+i,n>e.length)throw ce("Invalid address Uint8Array: "+(0,T.B)(e,"base16"));t.push([r,o])}return t}function re(e){return function(e){const t=[];return e.map((e=>{const n=ue(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),ae(t.join("/"))}(X(ne(e)))}function ie(e){const t=function(e){const t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(let r=0;r<n.length;r++){const i=n[r],s=O(i);if(0!==s.size){if(r++,r>=n.length)throw ce("invalid address: "+e);if(!0===s.path){t.push([i,ae(n.slice(r).join("/"))]);break}t.push([i,n[r]])}else t.push([i])}return t}(e=ae(e));return ee(t.map((e=>{Array.isArray(e)||(e=[e]);const t=ue(e);return e.length>1?[t.code,K(t.code,e[1])]:[t.code]})))}function se(e){const t=oe(e);if(null!=t)throw t;return Uint8Array.from(e)}function oe(e){try{ne(e)}catch(e){return e}}function ae(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function ce(e){return new Error("Error parsing address: "+e)}function ue(e){return O(e[0])}var le=n(32114);var he,de,fe,pe,ye=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},ge=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const me=Symbol.for("nodejs.util.inspect.custom"),we=[O("dns").code,O("dns4").code,O("dns6").code,O("dnsaddr").code],be=new Map,Ee=Symbol.for("@multiformats/js-multiaddr/multiaddr");function ve(e){return Boolean(e?.[Ee])}class _e{constructor(e){if(he.set(this,void 0),de.set(this,void 0),fe.set(this,void 0),this[pe]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=se(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=ie(e)}else{if(!ve(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=se(e.bytes)}}toString(){return null==ye(this,he,"f")&&ge(this,he,re(this.bytes),"f"),ye(this,he,"f")}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=O("tcp"),o=O("udp"),a=O("ip4"),c=O("ip6"),u=O("dns6"),l=O("ip6zone");for(const[h,d]of this.stringTuples())h===l.code&&(i=`%${d??""}`),we.includes(h)&&(t=s.name,r=443,n=`${d??""}${i}`,e=h===u.code?6:4),h!==s.code&&h!==o.code||(t=O(h).name,r=parseInt(d??"")),h!==a.code&&h!==c.code||(t=O(h).name,n=`${d??""}${i}`,e=h===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.protoCodes().map((e=>Object.assign({},O(e))))}protoCodes(){const e=[],t=this.bytes;let n=0;for(;n<t.length;){const r=$.decode(t,n),i=$.decode.bytes??0;n+=te(O(r),t.slice(n+i))+i,e.push(r)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==ye(this,de,"f")&&ge(this,de,ne(this.bytes),"f"),ye(this,de,"f")}stringTuples(){return null==ye(this,fe,"f")&&ge(this,fe,X(this.tuples()),"f"),ye(this,fe,"f")}encapsulate(e){return e=new _e(e),new _e(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new _e(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new _e(ee(t.slice(0,n)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===D.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,T.B)(B.base58btc.decode(`z${e}`),"base58btc"):(0,T.B)(U.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===O(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return(0,s.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=be.get(t.name);if(null==n)throw le(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new _e(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(he=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=Ee,me)](){return`Multiaddr(${re(this.bytes)})`}}var Se;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=(0,u.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3==1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>(0,u.LE)(t,e.codec()),e.decode=t=>(0,u.C6)(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=(0,u.yw)(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const r of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(r,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),n),e.encode=t=>(0,u.LE)(t,e.codec()),e.decode=t=>(0,u.C6)(t,e.codec())}(Se||(Se={}));const Re=Uint8Array.from([3,1]);class Ae{constructor(e){this.domain=Ae.DOMAIN,this.codec=Ae.CODEC;const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=n??[],this.seqNumber=r??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=Se.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof Ae&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}Ae.createFromProtobuf=e=>{const t=Se.decode(e),n=(0,l.cv)(t.peerId),r=(t.addresses??[]).map((e=>{return t=e.multiaddr,new _e(t);var t})),i=t.seq;return new Ae({peerId:n,multiaddrs:r,seqNumber:i})},Ae.DOMAIN="libp2p-peer-record",Ae.CODEC=Re},10618:function(e,t,n){"use strict";n.d(t,{Jz:function(){return r},_q:function(){return o},nh:function(){return s}});var r,i,s,o,a=n(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(r||(r={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(i||(i={})),function(e){e.codec=()=>(0,a.Ji)(i)}(r||(r={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(s||(s={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(o||(o={}))},55643:function(e,t,n){"use strict";function r(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}n.d(t,{_:function(){return r}})},94365:function(e,t,n){"use strict";n.d(t,{Fm:function(){return v},xV:function(){return E}});n(9839);var r=n(17314),i=n(99858),s=n(834),o=n(55609),a=n(52528),c=n(57050),u=n(36388),l=n(13274),h=n(657);function d(e,t="utf8"){const n=l.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,h.P)(globalThis.Buffer.from(e,"utf-8"))}var f=n(60615),p=n(49736);const y=p.C,g=p.aY,m=function(e){let t=0;if(e=e.toString().trim(),y(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(g(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;y(n[r])&&(e=m(n[r]),n[r]=(0,f.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,f.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},w=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var b=n(96587);(0,b.Ev)("ip4"),(0,b.Ev)("ip6"),(0,b.Ev)("ipcidr");function E(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return function(e){const t=w(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!p.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return C(t);case 6:case 273:case 33:case 132:return I(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,f.B)(n,"base58btc")}(t);case 444:case 445:return P(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,f.B)(n,"base64url")}(t);default:return(0,f.B)(t,"base16")}}function v(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return R(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return T(t);case 6:case 273:case 33:case 132:return A(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=S.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return d(t,"base16")}}const _=Object.values(s.gh).map((e=>e.decoder)),S=function(){let e=_[0].or(_[1]);return _.slice(2).forEach((t=>e=e.or(t))),e}();function R(e){if(!p.h6(e))throw new Error("invalid ip address");return m(e)}function A(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function I(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function T(e){const t=d(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function C(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,f.B)(e)}function P(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,f.B)(t,"base32")}:${I(n)}`}},55728:function(e,t,n){"use strict";n.d(t,{h2:function(){return _},HM:function(){return R}});var r=n(49541),i=n(99858),s=n(55609),o=n(14989),a=n(60615),c=n(57050),u=n(36388),l=n(94365),h=n(96587);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(6294);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},96587:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},36388:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(87388),i=n(657);function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return(0,i.P)(n)}},14989:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},60615:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(13274);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},13274:function(e,t,n){"use strict";var r=n(48620),i=n(87388);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},86731:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const n of e)t.push(n);return t})();const t=[];for(const n of e)t.push(n);return t}},17314:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(15641);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},99858:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(15641);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},66552:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},55609:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(17314),i=n(99858),s=n(66552),o=n(52528),a=n(58990);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},52528:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(66552),i=n(58990);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},44108:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(66552),i=n(52528);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},37566:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(86782);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},58990:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},10023:function(e,t,n){"use strict";var r=n(834),i=n(20273);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},86257:function(e,t,n){"use strict";n.d(t,{Pc:function(){return i}});n(79944);var r=n(77408);n(49784),n(27353),n(23366);n(52770);const i=(e,t)=>{const n=(0,r.m)(t.toString(16).padStart(16,"0"),"base16"),i=new Uint8Array(e.length+n.length);return i.set(e,0),i.set(n,e.length),i}},21177:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r,i=n(46888);function s(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds();return`${t}-${n}-${r}T${i}:${s}:${o}.${String(1e3*a*1e3).padStart(9,"0")}Z`}!function(e){let t;e.codec=()=>(null==t&&(t=(0,i.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,i.LE)(t,e.codec()),e.decode=t=>(0,i.C6)(t,e.codec())}(r||(r={}));class o{constructor(e,t,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return r.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:s(this.timeReceived)}}static deserialize(e){const t=r.decode(e);return new o(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,s=parseInt(n[3],10),o=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),u=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,s,o,a,c,u))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new o(e.key,e.value,t)}}},90153:function(e,t,n){"use strict";n.d(t,{o:function(){return s},w:function(){return o}});var r=n(52770),i=n(49784);function s(e,t,n){if(0===n.length){const e="No records given";throw new r.s(e,"ERR_NO_RECORDS_RECEIVED")}const s=(0,i.B)(t).split("/");if(s.length<3){const e="Record key does not have a selector function";throw new r.s(e,"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const o=e[s[1].toString()];if(null==o){const e=`Unrecognized key prefix: ${s[1]}`;throw new r.s(e,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:o(t,n)}const o={pk:function(e,t){return 0}}},69256:function(e,t,n){"use strict";n.d(t,{c:function(){return a},z:function(){return c}});var r=n(52770),i=n(49784),s=n(27353),o=n(73062);async function a(e,t){const n=t.key,s=(0,i.B)(n).split("/");if(s.length<3)return;const o=e[s[1].toString()];if(null==o){const e="Invalid record keytype";throw new r.s(e,"ERR_INVALID_RECORD_KEY_TYPE")}await o(n,t.value)}const c={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw new r.s('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw new r.s("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==(0,i.B)(e.subarray(0,4)))throw new r.s("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");const n=e.slice(4),a=await s.sha256.digest(t);if(!(0,o.f)(n,a.bytes))throw new r.s("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")}}},55305:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(1388);const i=()=>{};class s{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??i,this.onDisconnect=e.onDisconnect??i}get[Symbol.toStringTag](){return r.d.toString()}get[r.d](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}}function o(e){return new s(e)}},20199:function(e,t,n){"use strict";n.d(t,{s:function(){return i}});class r extends Map{constructor(e){super();const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function i(e){const{name:t,metrics:n}=e;let i;return i=null!=n?new r({name:t,metrics:n}):new Map,i}},37706:function(e,t,n){"use strict";n.d(t,{F:function(){return s}});var r=n(53749);function i(e){try{const{address:t}=e.nodeAddress();return Boolean((0,r.Z)(t))}catch{return!0}}function s(e,t){const n=i(e.multiaddr),r=i(t.multiaddr);return n&&!r?1:!n&&r||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}},72265:function(e,t,n){"use strict";n.d(t,{Y:function(){return i}});var r=n(67031);function i(e){const{address:t}=e.nodeAddress();return(0,r.B)(t)}},66146:function(e,t,n){"use strict";n.d(t,{j:function(){return s}});var r=n(28391);const i=(0,n(69860).kg)("libp2p:stream:converter");function s(e,t={}){const{stream:n,remoteAddr:s}=e,{sink:o,source:a}=n,c=async function*(){for await(const e of a)yield*e}(),u={async sink(e){null!=t.signal&&(e=(0,r.wJ)(e,t.signal));try{await o(e),await l()}catch(e){"aborted"!==e.type&&i(e)}},source:null!=t.signal?(0,r.wJ)(c,t.signal):c,remoteAddr:s,timeline:{open:Date.now(),close:void 0},async close(){await o(async function*(){yield new Uint8Array(0)}()),await l()}};async function l(){null==u.timeline.close&&(u.timeline.close=Date.now()),await Promise.resolve()}return u}},64584:function(e,t,n){"use strict";n.d(t,{n:function(){return Bt}});var r={};n.r(r),n.d(r,{Decoder:function(){return We},Encoder:function(){return Ze},PacketType:function(){return Ge},protocol:function(){return He}});var i=n(69860),s=n(32114),o=n(28391),a=n(91026),c=n(49736),u=n(49784);const l=c.C,h=c.aY,d=function(e){let t=0;if(e=e.toString().trim(),l(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(h(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;l(n[r])&&(e=d(n[r]),n[r]=(0,u.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,u.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},f=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},p=-1,y={},g={};function m(e){if("number"==typeof e){if(null!=g[e])return g[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=y[e])return y[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,p,"ip6zone"],[43,8,"ipcidr"],[53,p,"dns",!0],[54,p,"dns4",!0],[55,p,"dns6",!0],[56,p,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,p,"unix",!1,!0],[421,p,"ipfs"],[421,p,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,p,"garlic64"],[448,0,"tls"],[449,p,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,p,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,p,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);g[t.code]=t,y[t.name]=t}));var w=n(38161),b=n(14249),E=n(81653),v=n(93387),_=n(29094),S=n(9027),R=n(77408),A=n(41690);n(9839);m("ip4"),m("ip6"),m("ipcidr");function I(e,t){switch(m(e).code){case 4:case 41:return function(e){const t=f(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!c.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return L(t);case 6:case 273:case 33:case 132:return x(t).toString();case 421:return function(e){const t=S.decode(e),n=e.slice(S.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return(0,u.B)(n,"base58btc")}(t);case 444:case 445:return O(t);case 466:return function(e){const t=S.decode(e),n=e.slice(S.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,u.B)(n,"base64url")}(t);default:return(0,u.B)(t,"base16")}}function T(e,t){switch(m(e).code){case 4:case 41:return k(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return D(t);case 6:case 273:case 33:case 132:return N(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?_.Jx(E.base58btc.decode(`z${e}`)).bytes:w.k0.parse(e).multihash.bytes;const n=Uint8Array.from(S.encode(t.length));return(0,A.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=b.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=N(r);return(0,A.z)([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=b.base32.decode(`b${t[0]}`),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=N(r);return(0,A.z)([n,i],n.length+i.length)}(t);case 466:return function(e){const t=P.decode(e),n=Uint8Array.from(S.encode(t.length));return(0,A.z)([n,t],n.length+t.length)}(t);default:return(0,R.m)(t,"base16")}}const C=Object.values(v.gh).map((e=>e.decoder)),P=function(){let e=C[0].or(C[1]);return C.slice(2).forEach((t=>e=e.or(t))),e}();function k(e){if(!c.h6(e))throw new Error("invalid ip address");return d(e)}function N(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function x(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function D(e){const t=(0,R.m)(e),n=Uint8Array.from(S.encode(t.length));return(0,A.z)([n,t],n.length+t.length)}function L(e){const t=S.decode(e);if((e=e.slice(S.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return(0,u.B)(e)}function O(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,u.B)(t,"base32")}:${x(n)}`}function U(e){return e.map((e=>{const t=H(e);return null!=e[1]?[t.code,I(t.code,e[1])]:[t.code]}))}function M(e){return F((0,A.z)(e.map((e=>{const t=H(e);let n=Uint8Array.from(S.encode(t.code));return e.length>1&&null!=e[1]&&(n=(0,A.z)([n,e[1]])),n}))))}function B(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return S.decode(t)+(S.decode.bytes??0)}function z(e){const t=[];let n=0;for(;n<e.length;){const r=S.decode(e,n),i=S.decode.bytes??0,s=B(m(r),e.slice(n+i));if(0===s){t.push([r]),n+=i;continue}const o=e.slice(n+i,n+i+s);if(n+=s+i,n>e.length)throw q("Invalid address Uint8Array: "+(0,u.B)(e,"base16"));t.push([r,o])}return t}function V(e){return function(e){const t=[];return e.map((e=>{const n=H(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),K(t.join("/"))}(U(z(e)))}function $(e){const t=function(e){const t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(let r=0;r<n.length;r++){const i=n[r],s=m(i);if(0!==s.size){if(r++,r>=n.length)throw q("invalid address: "+e);if(!0===s.path){t.push([i,K(n.slice(r).join("/"))]);break}t.push([i,n[r]])}else t.push([i])}return t}(e=K(e));return M(t.map((e=>{Array.isArray(e)||(e=[e]);const t=H(e);return e.length>1?[t.code,T(t.code,e[1])]:[t.code]})))}function F(e){const t=j(e);if(null!=t)throw t;return Uint8Array.from(e)}function j(e){try{z(e)}catch(e){return e}}function K(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function q(e){return new Error("Error parsing address: "+e)}function H(e){return m(e[0])}var G=n(73062);var Z,W,Q,Y,J=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},X=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const ee=Symbol.for("nodejs.util.inspect.custom"),te=[m("dns").code,m("dns4").code,m("dns6").code,m("dnsaddr").code],ne=new Map,re=Symbol.for("@multiformats/js-multiaddr/multiaddr");function ie(e){return Boolean(e?.[re])}class se{constructor(e){if(Z.set(this,void 0),W.set(this,void 0),Q.set(this,void 0),this[Y]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=F(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=$(e)}else{if(!ie(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=F(e.bytes)}}toString(){return null==J(this,Z,"f")&&X(this,Z,V(this.bytes),"f"),J(this,Z,"f")}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=m("tcp"),o=m("udp"),a=m("ip4"),c=m("ip6"),u=m("dns6"),l=m("ip6zone");for(const[h,d]of this.stringTuples())h===l.code&&(i=`%${d??""}`),te.includes(h)&&(t=s.name,r=443,n=`${d??""}${i}`,e=h===u.code?6:4),h!==s.code&&h!==o.code||(t=m(h).name,r=parseInt(d??"")),h!==a.code&&h!==c.code||(t=m(h).name,n=`${d??""}${i}`,e=h===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.protoCodes().map((e=>Object.assign({},m(e))))}protoCodes(){const e=[],t=this.bytes;let n=0;for(;n<t.length;){const r=S.decode(t,n),i=S.decode.bytes??0;n+=B(m(r),t.slice(n+i))+i,e.push(r)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==J(this,W,"f")&&X(this,W,z(this.bytes),"f"),J(this,W,"f")}stringTuples(){return null==J(this,Q,"f")&&X(this,Q,U(this.tuples()),"f"),J(this,Q,"f")}encapsulate(e){return e=new se(e),new se(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new se(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new se(M(t.slice(0,n)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===y.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,u.B)(E.base58btc.decode(`z${e}`),"base58btc"):(0,u.B)(w.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===m(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return(0,G.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=ne.get(t.name);if(null==n)throw s(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new se(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(Z=new WeakMap,W=new WeakMap,Q=new WeakMap,Y=re,ee)](){return`Multiaddr(${V(this.bytes)})`}}function oe(e){return new se(e)}const ae=xe("dns4"),ce=xe("dns6"),ue=xe("dnsaddr"),le=Ne(xe("dns"),ue,ae,ce),he=Ne(xe("ip4"),xe("ip6")),de=Ne(ke(he,xe("tcp")),ke(le,xe("tcp"))),fe=ke(he,xe("udp")),pe=ke(fe,xe("utp")),ye=ke(fe,xe("quic")),ge=Ne(ke(de,xe("ws")),ke(le,xe("ws"))),me=Ne(ke(de,xe("wss")),ke(le,xe("wss")),ke(de,xe("tls"),xe("ws")),ke(le,xe("tls"),xe("ws"))),we=Ne(ke(de,xe("http")),ke(he,xe("http")),ke(le,xe("http"))),be=Ne(ke(de,xe("https")),ke(he,xe("https")),ke(le,xe("https"))),Ee=ke(fe,xe("webrtc"),xe("certhash")),ve=Ne(ke(Ee,xe("p2p")),Ee),_e=Ne(ke(ge,xe("p2p-webrtc-star"),xe("p2p")),ke(me,xe("p2p-webrtc-star"),xe("p2p")),ke(ge,xe("p2p-webrtc-star")),ke(me,xe("p2p-webrtc-star"))),Se=(Ne(ke(ge,xe("p2p-websocket-star"),xe("p2p")),ke(me,xe("p2p-websocket-star"),xe("p2p")),ke(ge,xe("p2p-websocket-star")),ke(me,xe("p2p-websocket-star"))),Ne(ke(we,xe("p2p-webrtc-direct"),xe("p2p")),ke(be,xe("p2p-webrtc-direct"),xe("p2p")),ke(we,xe("p2p-webrtc-direct")),ke(be,xe("p2p-webrtc-direct")))),Re=Ne(ge,me,we,be,_e,Se,de,pe,ye,le,ve),Ae=(Ne(ke(Re,xe("p2p-stardust"),xe("p2p")),ke(Re,xe("p2p-stardust"))),Ne(ke(Re,xe("p2p")),_e,Se,ve,xe("p2p"))),Ie=Ne(ke(Ae,xe("p2p-circuit"),Ae),ke(Ae,xe("p2p-circuit")),ke(xe("p2p-circuit"),Ae),ke(Re,xe("p2p-circuit")),ke(xe("p2p-circuit"),Re),xe("p2p-circuit")),Te=()=>Ne(ke(Ie,Te),Ie),Ce=Te();Ne(ke(Ce,Ae,Ce),ke(Ae,Ce),ke(Ce,Ae),Ce,Ae);function Pe(e){return function(t){let n;try{n=oe(t)}catch(e){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function ke(...e){function t(t){if(t.length<e.length)return null;let n=t;return e.some((e=>(n="function"==typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(n)&&(t=n),null===n))),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:Pe(t),partialMatch:t}}function Ne(...e){function t(t){let n=null;return e.some((e=>{const r="function"==typeof e?e().partialMatch(t):e.partialMatch(t);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:Pe(t),partialMatch:t}}function xe(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=oe(e)}catch(e){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}var De=n(85965);var Le=n(99748);const Oe="function"==typeof ArrayBuffer,Ue=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Me=Object.prototype.toString,Be="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Me.call(Blob),ze="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Me.call(File);function Ve(e){return Oe&&(e instanceof ArrayBuffer||Ue(e))||Be&&e instanceof Blob||ze&&e instanceof File}function $e(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if($e(e[t]))return!0;return!1}if(Ve(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return $e(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&$e(e[t]))return!0;return!1}function Fe(e){const t=[],n=e.data,r=e;return r.data=je(n,t),r.attachments=t.length,{packet:r,buffers:t}}function je(e,t){if(!e)return e;if(Ve(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=je(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=je(e[r],t));return n}return e}function Ke(e,t){return e.data=qe(e.data,t),delete e.attachments,e}function qe(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=qe(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=qe(e[n],t));return e}const He=5;var Ge;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Ge||(Ge={}));class Ze{constructor(e){this.replacer=e}encode(e){return e.type!==Ge.EVENT&&e.type!==Ge.ACK||!$e(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Ge.EVENT?Ge.BINARY_EVENT:Ge.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Ge.BINARY_EVENT&&e.type!==Ge.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Fe(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}class We extends Le.Q{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Ge.BINARY_EVENT;n||t.type===Ge.BINARY_ACK?(t.type=n?Ge.EVENT:Ge.ACK,this.reconstructor=new Qe(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Ve(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===Ge[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Ge.BINARY_EVENT||n.type===Ge.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!We.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case Ge.CONNECT:return"object"==typeof t;case Ge.DISCONNECT:return void 0===t;case Ge.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case Ge.EVENT:case Ge.BINARY_EVENT:return Array.isArray(t)&&("string"==typeof t[0]||"number"==typeof t[0]);case Ge.ACK:case Ge.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Qe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Ke(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Ye(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Je=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xe extends Le.Q{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ye(e,"open",this.onopen.bind(this)),Ye(e,"packet",this.onpacket.bind(this)),Ye(e,"error",this.onerror.bind(this)),Ye(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Je.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:Ge.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Ge.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ge.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ge.EVENT:case Ge.BINARY_EVENT:this.onevent(e);break;case Ge.ACK:case Ge.BINARY_ACK:this.onack(e);break;case Ge.DISCONNECT:this.ondisconnect();break;case Ge.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:Ge.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ge.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function et(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}et.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},et.prototype.reset=function(){this.attempts=0},et.prototype.setMin=function(e){this.ms=e},et.prototype.setMax=function(e){this.max=e},et.prototype.setJitter=function(e){this.jitter=e};class tt extends Le.Q{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,(0,De.Vq)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new et({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new De.sk(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Ye(t,"open",(function(){n.onopen(),e&&e()})),i=Ye(t,"error",(t=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",t),e?e(t):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&r();const n=this.setTimeoutFn((()=>{r(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ye(e,"ping",this.onping.bind(this)),Ye(e,"data",this.ondata.bind(this)),Ye(e,"error",this.onerror.bind(this)),Ye(e,"close",this.onclose.bind(this)),Ye(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){(0,De.Y3)((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Xe(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const nt={};function rt(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=(0,De.Qc)(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,s=n.path,o=nt[i]&&s in nt[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?a=new tt(r,t):(nt[i]||(nt[i]=new tt(r,t)),a=nt[i]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(rt,{Manager:tt,Socket:Xe,io:rt,connect:rt});var it=n(85275),st=n(46857),ot=n(1914),at=n(37430);class ct{constructor(e,t){this.label=e.label,this.open=(0,it.Z)(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"==typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=65536),e.addEventListener("message",(e=>{t.onMessage(e)})),e.addEventListener("bufferedamountlow",(()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()})),e.addEventListener("open",(()=>{this.open.resolve(),t.onOpen()})),e.addEventListener("close",(()=>{t.onClose()})),e.addEventListener("error",(n=>{if("Transport channel closed"===n.error?.message)return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,n.error?.message,n.error?.errorDetail);const r=n.error instanceof Error?n.error:new Error(`datachannel error: ${n.error?.message} ${n.error?.errorDetail}`);t.onError(s(r,"ERR_DATA_CHANNEL"))}));let n=!1;this.closingInterval=setInterval((()=>{"closing"===e.readyState?(n&&t.onClose(),n=!0):n=!1}),5e3)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>65536&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=(0,it.Z)())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var ut=n(65780);const lt={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};class ht extends st.v{constructor(e){super(),this.id=e.id??(0,u.B)(ot(4),"hex").slice(0,7),this.log=(0,i.kg)(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??function(){if("undefined"==typeof globalThis)throw s(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(null==e.RTCPeerConnection)throw s(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},lt,e.peerConnectionConfig)),this.closed=!1,this.connected=(0,it.Z)(),this.source=(0,at.d)(),this.sink=async e=>{if(await this.connected.promise,null==this.channel)throw s(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const t of e)await this.channel.send(t);await this.close()}}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new ct(t,{log:this.log,onMessage:e=>{this.source.push(new Uint8Array(e.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new st.A("ready"))},onClose:()=>{this.close().catch((e=>{this.log("error closing connection after channel close",e)}))},onError:e=>{this.close(e).catch((e=>{this.log("error closing connection after channel error",e)}))}}):this.close(s(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((e=>{this.log("Error closing after event channel was found to be null",e)}))}async close(e){if(this.closed=!0,null==e&&null!=this.channel)for(;this.channel.bufferedAmount>0;)await ut(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new st.A("close"))}}class dt extends st.v{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",(()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch((e=>{this.log.error("could not renegotiate %o",e)}))}))}async handleSignal(e){return this.log('incoming signal "%s"',e.type),"offer"===e.type?await this.handleOffer(e):"answer"===e.type?await this.handleAnswer(e):"candidate"===e.type?await this.handleCandidate(e):"renegotiate"===e.type?await this.handleRenegotiate(e):"goodbye"===e.type?await this.handleGoodye(e):void this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){const t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(e){if(null!=t.address&&!t.address.endsWith(".local"))throw s(e,"ERR_ADD_ICE_CANDIDATE");this.log("ignoring unsupported ICE candidate.")}}}const ft=(0,i.kg)("libp2p:webrtc-peer:receiver");class pt extends ht{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new yt({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",(e=>this.dispatchEvent(new st.A("signal",{detail:e.detail})))),this.peerConnection.addEventListener("datachannel",(e=>{this.handleDataChannelEvent(e)}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class yt extends dt{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){ft.trace("renegotiate"),this.dispatchEvent(new st.A("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(const e of this.iceCandidates)await this.handleCandidate(e);this.iceCandidates=[];const t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),ft.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new st.A("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type?await super.handleCandidate(e):this.iceCandidates.push(e)}}var gt=n(71198);const mt=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function wt(e,t,n){"function"==typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,s)=>{if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");const o=[t].flat(),a=[],{addListener:c,removeListener:u}=mt(e),l=(...e)=>{const t=n.multiArgs?e:e[0];n.filter&&!n.filter(t)||(a.push(t),n.count===a.length&&(r(),i(a)))},h=e=>{r(),s(e)};r=()=>{for(const e of o)u(e,l);for(const e of n.rejectionEvents)u(e,h)};for(const e of o)c(e,l);for(const e of n.rejectionEvents)c(e,h);n.resolveImmediately&&i(a)}));if(i.cancel=r,"number"==typeof n.timeout){const e=(0,gt.ZP)(i,n.timeout);return e.cancel=r,e}return i}(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}const bt=(0,i.kg)("libp2p:webrtc-peer:initator");class Et extends ht{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??(0,u.B)(ot(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new vt({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",(e=>{this.dispatchEvent(new st.A("signal",{detail:e.detail}))}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class vt extends dt{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",(e=>{if(null==e.candidate)return;const t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};bt.trace("create candidate",t),this.dispatchEvent(new st.A("signal",{detail:t})),this.dispatchEvent(new st.A("ice-candidate"))}))}async handleRenegotiate(){if("negotiating"===this.status)return void this.log("already negotiating, queueing");this.status="negotiating";const e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await wt(this,"ice-candidate"),await ut(1e3),bt.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new st.A("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){bt.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}}const _t=(0,i.kg)("libp2p:webrtc-star:socket");function St(e,t){const{sink:n,source:r}=e,i={remoteAddr:t.remoteAddr,async sink(e){null!=t.signal&&(e=(0,o.wJ)(e,t.signal));try{await n(e)}catch(e){"aborted"!==e.type&&_t.error(e)}},source:null!=t.signal?(0,o.wJ)(r,t.signal):r,timeline:{open:Date.now()},async close(){if(e.closed)return;const t=Date.now(),n=setTimeout((()=>{if(null!=i.remoteAddr){const{host:e,port:n}=i.remoteAddr.toOptions();_t("timeout closing socket to %s:%s after %dms, destroying it manually",e,n,Date.now()-t)}e.closed||e.close().catch((e=>{_t.error("could not close socket",e)}))}),2e3);try{await e.close()}finally{clearTimeout(n)}}};return e.addEventListener("close",(()=>{null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}function Rt(e){const t=e.toString().split("/"),n=e.protos()[1].name,r=e.protos()[2].name,i=e.stringTuples()[1][1];if("tcp"!==n||"ws"!==r&&"wss"!==r)throw new Error(`invalid multiaddr: ${e.toString()}`);if(!(0,a.K9)(e))return`http://${t[2]}:${t[4]}`;if("ws"===r)return`http://${t[2]}${null==i||"80"===i?"":`:${i}`}`;if("wss"===r)return`https://${t[2]}${null==i||"443"===i?"":`:${i}`}`;throw new Error("invalid multiaddr: "+e.toString())}const At=(0,i.kg)("libp2p:webrtc-star:listener"),It={transports:["websocket"],path:"/socket.io-next/"};class Tt extends st.v{constructor(e,t,n,r,i){super(),this.signallingAddr=t,this.socket=rt(e,It),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=n,this.handler=r,this.channelOptions=i,this.handleWsHandshake=this.handleWsHandshake.bind(this);let s=!1;this.socket.on("connect_error",(e=>{s&&"TransportError"===e.type||this.dispatchEvent(new st.A("error",{detail:e}))})),this.socket.on("error",(e=>{this.dispatchEvent(new st.A("error",{detail:e}))})),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",(e=>{this.dispatchEvent(new st.A("peer",{detail:e}))})),this.socket.on("connect",(()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),s&&this.dispatchEvent(new st.A("reconnect"))})),this.socket.once("connect",(()=>{s=!0,this.dispatchEvent(new st.A("listening"))})),this.socket.on("disconnect",(()=>{this.dispatchEvent(new st.A("disconnect"))}))}_createChannel(e,t,n){const r={...this.channelOptions},i=new pt(r),s=e=>{const t=e.detail;At.error("incoming connection errored",t)};return i.addEventListener("error",s),i.addEventListener("close",(()=>{i.removeEventListener("error",s)}),{once:!0}),i.addEventListener("signal",(r=>{const i=r.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:n,answer:!0,signal:i})})),i.addEventListener("ready",(()=>{const t=St(i,{remoteAddr:this.signallingAddr});At("new inbound connection %s",t.remoteAddr);try{this.upgrader.upgradeInbound(t).then((n=>{At("inbound connection %s upgraded",t.remoteAddr),this.connections.push(t);i.addEventListener("close",(()=>{this.connections=this.connections.filter((e=>e!==t)),this.channels.delete(e),this.pendingSignals.delete(e)}),{once:!0}),this.dispatchEvent(new st.A("connection",{detail:n})),this.handler(n)})).catch((e=>{At.error("inbound connection failed to upgrade",e),t.close().catch((e=>{At.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(e){At.error("inbound connection failed to upgrade",e),t.close().catch((e=>{At.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),i}handleWsHandshake(e){if(At('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let n=this.pendingSignals.get(t);null==n&&(n=[],this.pendingSignals.set(t,n)),n.push(e);let r=this.channels.get(t);if(null==r){if("offer"!==e.signal.type)return void At("handshake is not an offer and channel does not exist, buffering until we receive an offer");At("creating new channel to handle offer handshake"),r=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,r)}else At("channel already exists, using it to handle handshake");for(;n.length>0;){const e=n.shift();null!=e?.signal&&r.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map((async e=>await e.close())),...Array.from(this.channels.values()).map((async e=>await e.close()))]),this.dispatchEvent(new st.A("close"))}}class Ct extends st.v{constructor(e,t,n,r,i){super(),this.upgrader=e,this.handler=t,this.peerId=n,this.transport=r,this.options=i}async listen(e){if(null!=this.listeningAddr)throw s(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const t=(0,it.Z)();let n;this.listeningAddr=e,n=e.protoCodes().includes(421)?e:e.encapsulate(`/p2p/${this.peerId.toString()}`);const r=this.signallingUrl=Rt(e);At("connecting to signalling server on: %s",this.signallingUrl);const i=new Tt(this.signallingUrl,n,this.upgrader,this.handler,this.options.channelOptions);return i.addEventListener("error",(e=>{const n=e.detail;At("error connecting to signalling server %o",n),i.close().catch((e=>{At.error("error closing server after error",e)})),t.reject(n)})),i.addEventListener("listening",(()=>{At("connected to signalling server"),this.dispatchEvent(new st.A("listening")),t.resolve()})),i.addEventListener("peer",(e=>{this.transport.peerDiscovered(e.detail)})),i.addEventListener("connection",(t=>{const n=t.detail;if(null==n.remoteAddr)try{n.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${n.remotePeer.toString()}`)}catch(e){At.error("could not determine remote address",e)}this.dispatchEvent(new st.A("connection",{detail:n}))})),i.addEventListener("disconnect",(()=>{this.transport.sigServers.delete(r)})),i.addEventListener("reconnect",(()=>{this.transport.sigServers.set(r,i)})),this.transport.sigServers.set(this.signallingUrl,i),await t.promise}async close(){if(null!=this.signallingUrl){const e=this.transport.sigServers.get(this.signallingUrl);null!=e&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new st.A("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}var Pt=n(738),kt=n(23366),Nt=n(12348),xt=n(59769);const Dt="RTCPeerConnection"in globalThis,Lt=(0,i.kg)("libp2p:webrtc-star"),Ot=()=>{};class Ut extends st.v{constructor(){super(...arguments),this.started=!1}get[xt.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class Mt{constructor(e){null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this._discovery=new Ut,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[Nt.NA](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(e,t){const n=St(await this._connect(e,t),{remoteAddr:e,signal:t.signal});Lt("new outbound connection %s",n.remoteAddr);const r=await t.upgrader.upgradeOutbound(n);return Lt("outbound connection %s upgraded",n.remoteAddr),r}async _connect(e,t){if(!0===t.signal?.aborted)throw new o._L;const n={...t.channelOptions??{}};null!=this.wrtc&&(n.wrtc=this.wrtc);const r=e.toOptions(),i=(0,Pt.BB)(ot(36),"hex");return await new Promise(((a,c)=>{const u=this.sigServers.get(Rt(e));if(null==u?.socket)return c(s(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let l=!1;Lt("dialing %s:%s",r.host,r.port);const h=new Et(n),d=e=>{const t=e.detail;if(!l){const e=`connection error ${r.host}:${r.port}: ${t.message}`;Lt.error(e),y(t)}},f=()=>{l=!0,Lt("connection opened %s:%s",r.host,r.port),y()},p=()=>{Lt.error("connection aborted %s:%s",r.host,r.port),h.close().finally((()=>{y(new o._L)}))},y=e=>{h.removeEventListener("ready",f),t.signal?.removeEventListener("abort",p),null==e?a(h):c(e)};h.addEventListener("ready",f,{once:!0}),h.addEventListener("close",(()=>{h.removeEventListener("error",d)})),t.signal?.addEventListener("abort",p),h.addEventListener("signal",(t=>{const n=t.detail;u.socket.emit("ss-handshake",{intentId:i,srcMultiaddr:u.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:n})})),u.socket.on("ws-handshake",(e=>{e.intentId===i&&null!=e.err&&h.close().finally((()=>{c(s(new Error(e.err),"ERR_SIGNALLING_FAILED"))})),e.intentId!==i||null==e.answer||h.closed||h.handleSignal(e.signal)}))}))}createListener(e){if(!Dt&&null==this.wrtc)throw s(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(e.channelOptions=e.channelOptions??{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),null==this.peerId)throw s(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return function(e,t,n,r,i){return new Ct(e,t,n,r,i)}(e.upgrader,e.handler??Ot,this.peerId,this,e)}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>!e.protoCodes().includes(290)&&_e.matches(e)))}peerDiscovered(e){Lt("peer discovered: %s",e),e=function(e){const t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let n=(0,a.HM)(e);const r=n.stringTuples().filter((e=>421===e[0]))[0];if(null==r[1])throw new Error("invalid multiaddr: "+e);n=n.decapsulate("p2p"),n=n.encapsulate("/p2p-webrtc-star"),n=n.encapsulate(`/p2p/${r[1]}`),e=n.toString()}return e}(e);const t=(0,a.HM)(e),n=t.getPeerId();if(null==n)return;const r=(0,kt.jE)(n);this._discovery.dispatchEvent(new st.A("peer",{detail:{id:r,multiaddrs:[t],protocols:[]}}))}}function Bt(e={}){const t=new Mt(e);return{transport:e=>(t.peerId=e.peerId,t),discovery:t.discovery}}},27734:function(e,t,n){"use strict";n.d(t,{Z:function(){return et},R:function(){return Xe}});var r=n(49541),i=n(55265),s=n(11227),o=n(62630),a=n(52880),c=n(91168);function u(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return s.enabled(`${e}:trace`)&&null!=s.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=s(`${e}:trace`)),Object.assign(s(e),{error:s(`${e}:error`),trace:t})}s.formatters.b=e=>null==e?"undefined":a.base58btc.baseEncode(e),s.formatters.t=e=>null==e?"undefined":o.base32.baseEncode(e),s.formatters.m=e=>null==e?"undefined":c.base64.baseEncode(e),s.formatters.p=e=>null==e?"undefined":e.toString(),s.formatters.c=e=>null==e?"undefined":e.toString(),s.formatters.k=e=>null==e?"undefined":e.toString(),s.formatters.a=e=>null==e?"undefined":e.toString();var l=n(5681),h=n(23235),d=n(96158),f=n(46364),p=n(95955),y=n(16834),g=n(43850);const m=Symbol.for("nodejs.util.inspect.custom"),w=Object.values(h.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),h.gh.identity.decoder),b=114,E=36,v=37;class _{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[l.N]=!0;toString(){return null==this.string&&(this.string=a.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return d.k0.createV1(b,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,g.f)(this.multihash.bytes,e);if("string"==typeof e)return I(e).equals(this);if(null!=e?.multihash?.bytes)return(0,g.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[m](){return`PeerId(${this.toString()})`}}class S extends _{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class R extends _{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class A extends _{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function I(e,t){if(t=t??w,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=f.Jx(a.base58btc.decode(`z${e}`));return e.startsWith("12D")?new R({multihash:t}):e.startsWith("16U")?new A({multihash:t}):new S({multihash:t})}return function(e){try{const t=f.Jx(e);if(t.code===p.identity.code){if(t.digest.length===E)return new R({multihash:t});if(t.digest.length===v)return new A({multihash:t})}if(t.code===y.sha256.code)return new S({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==b)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===y.sha256.code)return new S({multihash:e.multihash});if(t.code===p.identity.code){if(t.digest.length===E)return new R({multihash:e.multihash});if(t.digest.length===v)return new A({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(d.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(w.decode(e))}var T,C=n(34306),P=n(76201);!function(e){e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",e.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",e.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"}(T||(T={}));class k extends r.sv{constructor(e,t){super(`WebRTC transport error: ${e}`,t??""),this.name="WebRTCTransportError"}}class N extends k{constructor(e,t){super(`[stream: ${e}] data channel error: ${t}`,T.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}}function x(e,t){return new N(e,t)}class D extends k{constructor(e){super(`There was a problem with the Multiaddr which was passed in: ${e}`,T.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}}function L(e){return new D(e)}class O extends k{constructor(e){super(`There was a problem with a provided argument: ${e}`,T.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}}function U(e){return new O(e)}class M extends k{constructor(e,t){super(`Invalid fingerprint "${e}" within ${t}`,T.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}}function B(e,t){return new M(e,t)}class z extends k{constructor(e){super(`A method (${e}) was called though it has been intentionally left unimplemented.`,T.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}}class V extends k{constructor(e){super(`unsupported hash algorithm: ${e}`,T.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}}const $=(0,n(43631).qY)(),F=null!=$&&"firefox"===$.name,j=async function*(){},K=async e=>{},q=u("libp2p:webrtc:connection");class H{peerConnection;remoteAddr;timeline;metrics;source=j();sink=K;constructor(e){this.remoteAddr=e.remoteAddr,this.timeline=e.timeline,this.peerConnection=e.peerConnection,this.peerConnection.onconnectionstatechange=()=>{"closed"!==this.peerConnection.connectionState&&"disconnected"!==this.peerConnection.connectionState&&"failed"!==this.peerConnection.connectionState||(this.timeline.close=Date.now())}}async close(e){q.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({close:!0})}abort(e){q.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({abort:!0})}}const G=globalThis.RTCPeerConnection,Z=globalThis.RTCSessionDescription,W=globalThis.RTCIceCandidate;class Q extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}var Y=n(23958);function J(e,t,n){const r=n??{},i=(0,Y.A)(e);return async function*(){let n;const s=()=>{null!=n&&n()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new Q(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new Q(e,n))}}));o=await Promise.race([e,i.next()]),n=null}catch(n){t.removeEventListener("abort",s);const o="aborted"===n.type&&t.aborted;if(o&&null!=r.onAbort&&r.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(e){null!=r.onReturnError&&r.onReturnError(e)}if(o&&!0===r.returnOnAbort)return;throw n}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}function X(e,t,n){return r=>e(J(r,t,n))}function ee(e,t,n){return{sink:X(e.sink,t,{...n,onAbort:void 0}),source:J(e.source,t,n)}}var te=n(41455),ne=n(85275),re=n(6146),ie=n(91893),se=n(54296);class oe extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function ae(e,t){let n,r,i,s=(t=t??{}).onEnd,o=new se.u,a=(0,ne.Z)();const c=e=>null!=r?r(e):(o.push(e),n),u=e=>{if(i)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?n:(i=!0,null!=e?(e=>(o=new se.u,null!=r?r({error:e}):(o.push({error:e}),n)))(e):c({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,o.push(s);try{t(e(o))}catch(e){i(e)}return n}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,ne.Z)()}))}},return:()=>(o=new se.u,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new oe)},t.addEventListener("abort",r)})));try{await Promise.race([a.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==s)return n;const h=n;return n={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),n),get readableLength(){return h.readableLength}},n}var ce,ue=n(90954),le=n(62308),he=n(46888);!function(e){let t,n,r;!function(e){e.FIN="FIN",e.STOP_SENDING="STOP_SENDING",e.RESET="RESET"}(t=e.Flag||(e.Flag={})),function(e){e[e.FIN=0]="FIN",e[e.STOP_SENDING=1]="STOP_SENDING",e[e.RESET=2]="RESET"}(n||(n={})),function(e){e.codec=()=>(0,he.Ji)(n)}(t=e.Flag||(e.Flag={})),e.codec=()=>(null==r&&(r=(0,he.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.flag&&(n.uint32(8),e.Flag.codec().encode(t.flag,n)),null!=t.message&&(n.uint32(18),n.bytes(t.message)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.flag=e.Flag.codec().decode(t);break;case 2:r.message=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,he.LE)(t,e.codec()),e.decode=t=>(0,he.C6)(t,e.codec())}(ce||(ce={}));class de extends re.b{channel;dataChannelOptions;incomingData;messageQueue;maxDataSize;constructor(e){switch(super(e),this.channel=e.channel,this.channel.binaryType="arraybuffer",this.incomingData=function(e={}){return ae((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}(),this.messageQueue=new le.H,this.dataChannelOptions={bufferedAmountLowEventTimeout:e.dataChannelOptions?.bufferedAmountLowEventTimeout??3e4,maxBufferedAmount:e.dataChannelOptions?.maxBufferedAmount??16777216,maxMessageSize:e.dataChannelOptions?.maxMessageSize??e.maxDataSize},this.maxDataSize=e.maxDataSize,this.channel.readyState){case"open":case"connecting":break;case"closed":case"closing":void 0!==this.timeline.close&&0!==this.timeline.close||(this.timeline.close=Date.now());break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new r.sv("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=e=>{this.timeline.open=(new Date).getTime(),null!=this.messageQueue&&(this._sendMessage(this.messageQueue).catch((e=>{this.abort(e)})),this.messageQueue=void 0)},this.channel.onclose=e=>{this.close().catch((e=>{this.log.error("error closing stream after channel closed",e)}))},this.channel.onerror=e=>{const t=e.error;this.abort(t)};const t=this;this.channel.onmessage=async e=>{const{data:t}=e;null!==t&&0!==t.byteLength&&this.incomingData.push(new Uint8Array(t,0,t.byteLength))},Promise.resolve().then((async()=>{for await(const e of ie.J(this.incomingData)){const n=t.processIncomingProtobuf(e.subarray());null!=n&&t.sourcePush(new le.H(n))}})).catch((e=>{this.log.error("error processing incoming data channel messages",e)}))}sendNewStream(){}async _sendMessage(e,t=!0){if(t&&this.channel.bufferedAmount>this.dataChannelOptions.maxBufferedAmount)try{await(0,ue.yM)(this.channel,"bufferedamountlow",{timeout:this.dataChannelOptions.bufferedAmountLowEventTimeout})}catch(e){if(e instanceof ue.W5)throw new Error("Timed out waiting for DataChannel buffer to clear");throw e}if("closed"===this.channel.readyState||"closing"===this.channel.readyState)throw new r.sv("Invalid datachannel state - closed or closing","ERR_INVALID_STATE");if("open"===this.channel.readyState)for(const t of e)this.channel.send(t);else{if("connecting"!==this.channel.readyState)throw this.log.error("unknown datachannel state %s",this.channel.readyState),new r.sv("Unknown datachannel state","ERR_INVALID_STATE");null==this.messageQueue&&(this.messageQueue=new le.H),this.messageQueue.append(e)}}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxDataSize),n=e.subarray(0,t),r=ce.encode({message:n}),i=ie.c.single(r);await this._sendMessage(i),e.consume(t)}}async sendReset(){await this._sendFlag(ce.Flag.RESET)}async sendCloseWrite(){await this._sendFlag(ce.Flag.FIN)}async sendCloseRead(){await this._sendFlag(ce.Flag.STOP_SENDING)}processIncomingProtobuf(e){const t=ce.decode(e);return void 0!==t.flag&&(t.flag===ce.Flag.FIN&&(this.incomingData.end(),this.remoteCloseWrite()),t.flag===ce.Flag.RESET&&this.reset(),t.flag===ce.Flag.STOP_SENDING&&this.remoteCloseRead()),t.message}async _sendFlag(e){this.log.trace("Sending flag: %s",e.toString());const t=ce.encode({flag:e}),n=ie.c.single(t);await this._sendMessage(n,!1)}}function fe(e){const{channel:t,direction:n,onEnd:r,dataChannelOptions:i}=e;return new de({id:"inbound"===n?`i${t.id}`:`r${t.id}`,direction:n,maxDataSize:(i?.maxMessageSize??16384)-5-2,dataChannelOptions:i,onEnd:r,channel:t,log:u(`libp2p:webrtc:stream:${n}:${t.id}`)})}const pe="/webrtc";class ye{protocol;peerConnection;streamBuffer=[];metrics;dataChannelOptions;constructor(e){this.peerConnection=e.peerConnection,this.metrics=e.metrics,this.protocol=e.protocol??pe,this.dataChannelOptions=e.dataChannelOptions,this.peerConnection.ondatachannel=({channel:t})=>{const n=fe({channel:t,direction:"inbound",dataChannelOptions:e.dataChannelOptions,onEnd:()=>{this.streamBuffer=this.streamBuffer.filter((e=>e.id!==n.id))}});this.streamBuffer.push(n)}}createStreamMuxer(e){return new ge({...e,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.streamBuffer,protocol:this.protocol})}}class ge{init;streams;protocol;peerConnection;dataChannelOptions;metrics;close=async()=>{};abort=()=>{};source=j();sink=K;constructor(e){this.init=e,this.streams=e.streams,this.peerConnection=e.peerConnection,this.protocol=e.protocol??pe,this.metrics=e.metrics,this.peerConnection.ondatachannel=({channel:t})=>{const n=fe({channel:t,direction:"inbound",dataChannelOptions:this.dataChannelOptions,onEnd:()=>{this.streams=this.streams.filter((e=>e.id!==n.id)),this.metrics?.increment({stream_end:!0}),e?.onStreamEnd?.(n)}});this.streams.push(n),null!=e?.onIncomingStream&&(this.metrics?.increment({incoming_stream:!0}),e.onIncomingStream(n))};const t=e?.onIncomingStream;null!=t&&this.streams.forEach((e=>{t(e)}))}newStream(){const e=this.peerConnection.createDataChannel(""),t=fe({channel:e,direction:"outbound",dataChannelOptions:this.dataChannelOptions,onEnd:()=>{e.close(),this.streams=this.streams.filter((e=>e.id!==t.id)),this.metrics?.increment({stream_end:!0}),this.init?.onStreamEnd?.(t)}});return this.streams.push(t),this.metrics?.increment({outgoing_stream:!0}),t}}var me;!function(e){let t,n,r;!function(e){e.SDP_OFFER="SDP_OFFER",e.SDP_ANSWER="SDP_ANSWER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(t=e.Type||(e.Type={})),function(e){e[e.SDP_OFFER=0]="SDP_OFFER",e[e.SDP_ANSWER=1]="SDP_ANSWER",e[e.ICE_CANDIDATE=2]="ICE_CANDIDATE"}(n||(n={})),function(e){e.codec=()=>(0,he.Ji)(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=(0,he.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.data&&(n.uint32(18),n.string(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.data=t.string();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,he.LE)(t,e.codec()),e.decode=t=>(0,he.C6)(t,e.codec())}(me||(me={}));const we=u("libp2p:webrtc:peer:util"),be=async(e,t,n)=>{for(;;){const r=await Promise.race([e.promise,n.read()]);if(!(r instanceof Object))break;{const e=r;if(e.type!==me.Type.ICE_CANDIDATE)throw new Error("expected only ice candidates");if(null==e.data||""===e.data){we.trace("end-of-candidates received");break}we.trace("received new ICE candidate: %s",e.data);try{await t.addIceCandidate(new W(JSON.parse(e.data)))}catch(e){throw we.error("bad candidate received: ",e),new Error("bad candidate received")}}}await e.promise};function Ee(e,t){e[F?"oniceconnectionstatechange":"onconnectionstatechange"]=n=>{switch(we.trace("receiver peerConnectionState state: ",e.connectionState),F?e.iceConnectionState:e.connectionState){case"connected":t.resolve();break;case"failed":case"disconnected":case"closed":t.reject(new Error("RTCPeerConnection was closed"))}}}const ve=u("libp2p:webrtc:peer");function _e(e){const t=e.split("\r\n").filter((e=>e.startsWith("a=candidate"))).pop(),n=t?.split(" ");return null==t||null==n||n.length<5?(ve("could not parse remote address from",t),"/webrtc"):`/dnsaddr/${n[4]}/${n[2].toLowerCase()}/${n[5]}/webrtc`}var Se=n(23247),Re=n(76237);class Ae extends Se.v{peerId;transportManager;constructor(e){super(),this.peerId=e.peerId,this.transportManager=e.transportManager}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter((e=>e!==this)).map((e=>e.getAddrs().filter((e=>Re.dx.matches(e))).map((e=>e.encapsulate(`/webrtc/p2p/${this.peerId}`))))).flat()}async close(){this.safeDispatchEvent("close",{})}}const Ie=u("libp2p:webrtc:peer"),Te="/webrtc",Ce="/p2p-circuit",Pe="/webrtc-signaling/0.0.1";class ke{components;init;_started=!1;metrics;constructor(e,t={}){this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(Pe,(e=>{this._onProtocol(e).catch((t=>{Ie.error("failed to handle incoming connect from %p",e.connection.remotePeer,t)}))}),{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(Pe),this._started=!1}createListener(e){return new Ae(this.components)}[Symbol.toStringTag]="@libp2p/webrtc";[i.NA]=!0;filter(e){return e.filter(P.uF.exactMatch)}async dial(e,t){Ie.trace("dialing address: ",e);const{baseAddr:n,peerId:i}=function(e){const t=e.toString().split(Te+"/");if(2!==t.length)throw new r.sv("webrtc protocol was not present in multiaddr",T.ERR_INVALID_MULTIADDR);if(!t[0].includes(Ce))throw new r.sv("p2p-circuit protocol was not present in multiaddr",T.ERR_INVALID_MULTIADDR);let n=(0,C.HM)(t[0]);const i=(0,C.HM)("/"+t[1]).getPeerId();if(null==i)throw new r.sv("destination peer id was missing",T.ERR_INVALID_MULTIADDR);const s=n.protos().pop();if(void 0===s)throw new r.sv("invalid multiaddr",T.ERR_INVALID_MULTIADDR);"p2p"!==s.name&&(n=n.encapsulate(`/p2p/${i}`));return{baseAddr:n,peerId:I(i)}}(e);if(null==t.signal){const e=new AbortController;t.signal=e.signal}this.metrics?.dialerEvents.increment({open:!0});const s=await this.components.transportManager.dial(n,t),o=await s.newStream(Pe,{...t,runOnTransientConnection:!0});try{const{pc:e,muxerFactory:n,remoteAddress:r}=await async function({rtcConfiguration:e,dataChannelOptions:t,signal:n,stream:r}){const i=(0,te.z)(ee(r,n)).pb(me),s=new G(e);try{const e=new ye({peerConnection:s,dataChannelOptions:t}),r=(0,ne.Z)();Ee(s,r),n.onabort=r.reject;const o=s.createDataChannel("init");s.onicecandidate=({candidate:e})=>{i.write({type:me.Type.ICE_CANDIDATE,data:null!=e?JSON.stringify(e.toJSON()):""}).catch((e=>{ve.error("error sending ICE candidate",e)}))};const a=await s.createOffer();await i.write({type:me.Type.SDP_OFFER,data:a.sdp}),await s.setLocalDescription(a).catch((e=>{throw ve.error("could not execute setLocalDescription",e),new Error("Failed to set localDescription")}));const c=await i.read();if(c.type!==me.Type.SDP_ANSWER)throw new Error("remote should send an SDP answer");const u=new Z({type:"answer",sdp:c.data});return await s.setRemoteDescription(u).catch((e=>{throw ve.error("could not execute setRemoteDescription",e),new Error("Failed to set remoteDescription")})),await be(r,s,i),o.close(),{pc:s,muxerFactory:e,remoteAddress:_e(s.currentRemoteDescription?.sdp??"")}}catch(e){throw s.close(),e}}({stream:o,rtcConfiguration:this.init.rtcConfiguration,dataChannelOptions:this.init.dataChannel,signal:t.signal}),s=await t.upgrader.upgradeOutbound(new H({peerConnection:e,timeline:{open:Date.now()},remoteAddr:(0,C.HM)(r).encapsulate(`/p2p/${i.toString()}`),metrics:this.metrics?.dialerEvents}),{skipProtection:!0,skipEncryption:!0,muxerFactory:n});return await o.close(),s}catch(e){throw this.metrics?.dialerEvents.increment({error:!0}),o.abort(e),e}finally{await s.close()}}async _onProtocol({connection:e,stream:t}){try{const{pc:n,muxerFactory:i,remoteAddress:s}=await async function({rtcConfiguration:e,dataChannelOptions:t,stream:n}){const i=AbortSignal.timeout(3e4),s=(0,te.z)(ee(n,i)).pb(me),o=new G(e);try{const e=new ye({peerConnection:o,dataChannelOptions:t}),n=(0,ne.Z)(),a=(0,ne.Z)();i.onabort=()=>{n.reject(new r.sv("Timed out while trying to connect","ERR_TIMEOUT"))},o.onicecandidate=({candidate:e})=>{a.promise.then((async()=>{await s.write({type:me.Type.ICE_CANDIDATE,data:null!=e?JSON.stringify(e.toJSON()):""})}),(e=>{ve.error("cannot set candidate since sending answer failed",e),n.reject(e)}))},Ee(o,n);const c=await s.read();if(c.type!==me.Type.SDP_OFFER)throw new Error(`expected message type SDP_OFFER, received: ${c.type??"undefined"} `);const u=new Z({type:"offer",sdp:c.data});await o.setRemoteDescription(u).catch((e=>{throw ve.error("could not execute setRemoteDescription",e),new Error("Failed to set remoteDescription")}));const l=await o.createAnswer().catch((e=>{throw ve.error("could not execute createAnswer",e),a.reject(e),new Error("Failed to create answer")}));return await s.write({type:me.Type.SDP_ANSWER,data:l.sdp}),await o.setLocalDescription(l).catch((e=>{throw ve.error("could not execute setLocalDescription",e),a.reject(e),new Error("Failed to set localDescription")})),a.resolve(),await be(n,o,s),{pc:o,muxerFactory:e,remoteAddress:_e(o.currentRemoteDescription?.sdp??"")}}catch(e){throw o.close(),e}}({rtcConfiguration:this.init.rtcConfiguration,connection:e,stream:t,dataChannelOptions:this.init.dataChannel});await this.components.upgrader.upgradeInbound(new H({peerConnection:n,timeline:{open:(new Date).getTime()},remoteAddr:(0,C.HM)(s).encapsulate(`/p2p/${e.remotePeer.toString()}`),metrics:this.metrics?.listenerEvents}),{skipEncryption:!0,skipProtection:!0,muxerFactory:i})}catch(e){throw t.abort(e),e}finally{await e.close()}}}var Ne=n(6329),xe=n(9886),De=n(72178),Le=n(93187),Oe=n(91325);function Ue(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Me=Ue("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Be=Ue("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,Oe.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}));var ze={utf8:Me,"utf-8":Me,hex:h.gh.base16,latin1:Be,ascii:Be,binary:Be,...h.gh};function Ve(e,t="utf8"){const n=ze[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,Le.P)(globalThis.Buffer.from(e,"utf-8"))}const $e=u("libp2p:webrtc:sdp"),Fe=Object.values(h.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function je(e){const t=e.getConfiguration().certificates?.at(0);if(null==t||null==t.getFingerprints){$e.trace("fetching fingerprint from local SDP");const t=e.localDescription;if(null==t)return;return function(e){const t=e.match(Ke);return t?.groups?.fingerprint}(t.sdp)}if($e.trace("fetching fingerprint from local certificate"),0===t.getFingerprints().length)return;const n=t.getFingerprints()[0].value;if(null==n)throw B("","no fingerprint on local certificate");return n}const Ke=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function qe(e){const t=e.stringTuples().filter((e=>e[0]===Ye)).map((e=>e[1]))[0];if(void 0===t||""===t)throw L(`Couldn't find a certhash component of multiaddr: ${e.toString()}`);return t}function He(e){const t=Fe.decode(e);return xe.decode(t)}function Ge(e){switch(e){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw new V(e)}}function Ze(e,t){const{host:n,port:r}=e.toOptions(),i=function(e){for(const t of e.protoNames())if(t.startsWith("ip"))return t.toUpperCase();return $e("Warning: multiaddr does not appear to contain IP4 or IP6, defaulting to IP6",e),"IP6"}(e),[s]=function(e){const t=He(qe(e)),n=Ge(t.name),r=t.digest.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=r.match(/.{1,2}/g);if(null==i)throw B(r,e.toString());return[`${n.toUpperCase()} ${i.join(":").toUpperCase()}`,r]}(e);return`v=0\no=- 0 0 IN ${i} ${n}\ns=-\nc=IN ${i} ${n}\nt=0 0\na=ice-lite\nm=application ${r} UDP/DTLS/SCTP webrtc-datachannel\na=mid:0\na=setup:passive\na=ice-ufrag:${t}\na=ice-pwd:${t}\na=fingerprint:${s}\na=sctp-port:5000\na=max-message-size:16384\na=candidate:1467250027 1 UDP 1467250027 ${n} ${r} typ host\r\n`}const We=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Qe=u("libp2p:webrtc:transport"),Ye=((0,C.a_)("webrtc-direct").code,(0,C.a_)("certhash").code);class Je{metrics;components;init;constructor(e,t={}){this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(e,t){const n=await this._connect(e,t);return Qe(`dialing address - ${e.toString()}`),n}createListener(e){throw new z("WebRTCTransport.createListener")}filter(e){return e.filter(P.Ih.exactMatch)}[Symbol.toStringTag]="@libp2p/webrtc-direct";[i.NA]=!0;async _connect(e,t){const n=new AbortController,r=n.signal,i=e.getPeerId();if(null===i)throw L("we need to have the remote's PeerId");const s=I(i),o=He(qe(e)),a=await G.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:Ge(o.name)}),c=new G({certificates:[a]});try{const i=new Promise(((e,t)=>{const n=c.createDataChannel("",{negotiated:!0,id:0}),r=setTimeout((()=>{const e=`Data channel was never opened: state: ${n.readyState}`;Qe.error(e),this.metrics?.dialerEvents.increment({open_error:!0}),t(x("data",e))}),1e4);n.onopen=t=>{clearTimeout(r),e(n)},n.onerror=e=>{clearTimeout(r);const n=`Error opening a data channel for handshaking: ${e.target?.toString()??"not specified"}`;Qe.error(n),this.metrics?.dialerEvents.increment({unknown_error:!0}),t(x("data",n))}})),a="libp2p+webrtc+v1/"+[...Array(32)].map((()=>We.at(Math.floor(Math.random()*We.length)))).join(""),u=function(e,t){if(void 0===e.sdp)throw U("Can't munge a missing SDP");return e.sdp=e.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,"\na=ice-ufrag:"+t+"\n").replace(/\na=ice-pwd:[^\n]*\n/,"\na=ice-pwd:"+t+"\n"),e}(await c.createOffer(),a);await c.setLocalDescription(u);const l=function(e,t){return{type:"answer",sdp:Ze(e,t)}}(e,a);await c.setRemoteDescription(l);const h=await i,d=this.components.peerId,f=this.generateNoisePrologue(c,o.code,e),p=(0,Ne.t)({prologueBytes:f})(),y=fe({channel:h,direction:"inbound",dataChannelOptions:this.init.dataChannel}),g={...y,sink:y.sink.bind(y),source:async function*(){for await(const e of y.source)for(const t of e)yield t}()},m=new H({peerConnection:c,remoteAddr:e,timeline:{open:Date.now()},metrics:this.metrics?.dialerEvents}),w=F?"iceconnectionstatechange":"connectionstatechange";c.addEventListener(w,(()=>{switch(c.connectionState){case"failed":case"disconnected":case"closed":m.close().catch((e=>{Qe.error("error closing connection",e)})).finally((()=>{n.abort()}))}}),{signal:r}),this.metrics?.dialerEvents.increment({peer_connection:!0});const b=new ye({peerConnection:c,metrics:this.metrics?.dialerEvents,dataChannelOptions:this.init.dataChannel});return await p.secureInbound(d,g,s),await t.upgrader.upgradeOutbound(m,{skipProtection:!0,skipEncryption:!0,muxerFactory:b})}catch(e){throw c.close(),e}}generateNoisePrologue(e,t,n){if(0===e.getConfiguration().certificates?.length)throw U("no local certificate");const r=je(e);if(null==r)throw U("no local fingerprint found");const i=Ve(r.trim().toLowerCase().replaceAll(":",""),"hex"),s=xe.encode(i,t),o=Fe.decode(qe(n)),a=Ve("libp2p-webrtc-noise:");return(0,De.z)([a,s,o])}}function Xe(e){return t=>new Je(t,e)}function et(e){return t=>new ke(t,e)}},73289:function(e,t,n){"use strict";n.d(t,{Fm:function(){return v},xV:function(){return E}});n(9839);var r=n(62630),i=n(52880),s=n(23235),o=n(96158),a=n(46364),c=n(57050),u=n(43321),l=n(5799),h=n(63171);function d(e,t="utf8"){const n=l.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,h.P)(globalThis.Buffer.from(e,"utf-8"))}var f=n(60731),p=n(49736);const y=p.C,g=p.aY,m=function(e){let t=0;if(e=e.toString().trim(),y(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(g(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;y(n[r])&&(e=m(n[r]),n[r]=(0,f.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,f.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},w=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var b=n(14900);(0,b.Ev)("ip4"),(0,b.Ev)("ip6"),(0,b.Ev)("ipcidr");function E(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return function(e){const t=w(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!p.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return C(t);case 6:case 273:case 33:case 132:return I(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,f.B)(n,"base58btc")}(t);case 444:case 445:return P(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,f.B)(n,"base64url")}(t);default:return(0,f.B)(t,"base16")}}function v(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return R(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return T(t);case 6:case 273:case 33:case 132:return A(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=S.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return d(t,"base16")}}const _=Object.values(s.gh).map((e=>e.decoder)),S=function(){let e=_[0].or(_[1]);return _.slice(2).forEach((t=>e=e.or(t))),e}();function R(e){if(!p.h6(e))throw new Error("invalid ip address");return m(e)}function A(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function I(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function T(e){const t=d(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function C(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,f.B)(e)}function P(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,f.B)(t,"base32")}:${I(n)}`}},34306:function(e,t,n){"use strict";n.d(t,{HM:function(){return R},a_:function(){return h.Ev}});var r=n(49541),i=n(52880),s=n(96158),o=n(24048),a=n(60731),c=n(57050),u=n(43321),l=n(73289),h=n(14900);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(80747);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},14900:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},43321:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(42103),i=n(63171);function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return(0,i.P)(n)}},24048:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},60731:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(5799);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},5799:function(e,t,n){"use strict";var r=n(81120),i=n(42103);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},23958:function(e,t,n){"use strict";function r(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}n.d(t,{A:function(){return r}})},54296:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},62630:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(29363);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},52880:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(29363);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},37604:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},96158:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(62630),i=n(52880),s=n(37604),o=n(46364),a=n(31983);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},46364:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(37604),i=n(31983);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},95955:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(37604),i=n(46364);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},16834:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(86593);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},31983:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},72178:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(91325),i=n(93187);function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return(0,i.P)(n)}},43850:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},87960:function(e,t,n){"use strict";n.d(t,{$K:function(){return o},MQ:function(){return s},U1:function(){return i},fJ:function(){return r},fS:function(){return a}});const r=421,i=290,s=6,o=478,a=500},38134:function(e,t,n){"use strict";n.d(t,{$6:function(){return s},FR:function(){return a},xt:function(){return o}});var r=n(76237),i=n(87960);function s(e){return e.filter((e=>{if(e.protoCodes().includes(i.U1))return!1;const t=e.decapsulateCode(i.fJ);return r.Ce.matches(t)||r.th.matches(t)}))}function o(e){return e.filter((e=>{if(e.protoCodes().includes(i.U1))return!1;const t=e.decapsulateCode(i.fJ);return r.th.matches(t)}))}function a(e){return e.filter((e=>{if(e.protoCodes().includes(i.U1))return!1;const t=e.decapsulateCode(i.fJ);return r.th.matches(t)&&r.Rk.matches(t.decapsulateCode(i.MQ).decapsulateCode(i.$K))}))}},36985:function(e,t,n){"use strict";n.d(t,{E:function(){return T}});var r=n(49541),i=n(55265),s=n(9183),o=n(45182),a=n(51723),c=n(90507),u=n(77408);function l(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name&&"number"==typeof e?.byteLength}var h=(e,t)=>{t=t??{};const n=(e=>{e.binaryType="arraybuffer";const t=async()=>{await new Promise(((t,n)=>{if(i)return void t();if(null!=r)return void n(r);const s=t=>{e.removeEventListener("open",o),e.removeEventListener("error",a),t()},o=()=>{s(t)},a=t=>{s((()=>{n(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}))};e.addEventListener("open",o),e.addEventListener("error",a)}))},n=async function*(){const n=new c.zN((({push:t,stop:n,fail:r})=>{const i=e=>{let n=null;"string"==typeof e.data&&(n=(0,u.m)(e.data)),l(e.data)&&(n=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(n=e.data),null!=n&&t(n)},s=e=>{r(e.error??new Error("Socket error"))};return e.addEventListener("message",i),e.addEventListener("error",s),e.addEventListener("close",n),()=>{e.removeEventListener("message",i),e.removeEventListener("error",s),e.removeEventListener("close",n)}}),{highWaterMark:1/0});await t();for await(const e of n)yield l(e)?new Uint8Array(e):e}();let r,i=1===e.readyState;return e.addEventListener("open",(()=>{i=!0,r=null})),e.addEventListener("close",(()=>{i=!1,r=null})),e.addEventListener("error",(t=>{i||(r=t.error??new Error(`connect ECONNREFUSED ${e.url}`))})),Object.assign(n,{connected:t})})(e);let r=t.remoteAddress,i=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);r=t.hostname,i=parseInt(t.port,10)}catch{}if(null==r||null==i)throw new Error("Remote connection did not have address and/or port");return{sink:(0,a.Z)(e,t),source:n,connected:async()=>{await n.connected()},close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:r,remotePort:i,socket:e}},d=WebSocket,f=n(17745);const p={http:"ws",https:"wss"};function y(e,t){t=t??{};const n=((e,t)=>(0,f.relative)(e,t,p,"ws"))(e,("undefined"==typeof window?"":window.location).toString()),r=new d(n,t.websocket);return h(r,t)}var g=n(85275),m=n(14560),w=n(38134),b=n(34184);class E extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}var v=n(88467);function _(e,t,n){const r=n??{},i=(0,v.A)(e);return async function*(){let n;const s=()=>{null!=n&&n()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new E(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new E(e,n))}}));o=await Promise.race([e,i.next()]),n=null}catch(n){t.removeEventListener("abort",s);const o="aborted"===n.type&&t.aborted;if(o&&null!=r.onAbort&&r.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(e){null!=r.onReturnError&&r.onReturnError(e)}if(o&&!0===r.returnOnAbort)return;throw n}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}var S=n(87960);const R=(0,s.kg)("libp2p:websockets:socket");const A=(0,s.kg)("libp2p:websockets");class I{init;constructor(e){this.init=e}[Symbol.toStringTag]="@libp2p/websockets";[i.NA]=!0;async dial(e,t){A("dialing %s",e),t=t??{};const n=function(e,t,n){const i={async sink(t){null!=n?.signal&&(t=_(t,n.signal));try{await e.sink(t)}catch(e){"aborted"!==e.type&&R.error(e)}},source:null!=(n=n??{}).signal?_(e.source,n.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(t={}){const n=Date.now();t.signal=t.signal??AbortSignal.timeout(S.fS);const s=()=>{const{host:e,port:t}=i.remoteAddr.toOptions();R("timeout closing stream to %s:%s after %dms, destroying it manually",e,t,Date.now()-n),this.abort(new r.sv("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))};t.signal.addEventListener("abort",s);try{await e.close()}catch(e){R.error("error closing WebSocket gracefully",e),this.abort(e)}finally{t.signal.removeEventListener("abort",s),i.timeline.close=Date.now()}},abort(t){const{host:n,port:r}=i.remoteAddr.toOptions();R("timeout closing stream to %s:%s due to error",n,r,t),e.destroy(),i.timeline.close=Date.now()}};return e.socket.addEventListener("close",(()=>{null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}(await this._connect(e,t),e);A("new outbound connection %s",n.remoteAddr);const i=await t.upgrader.upgradeOutbound(n);return A("outbound connection %s upgraded",n.remoteAddr),i}async _connect(e,t){if(!0===t?.signal?.aborted)throw new r._L;const n=e.toOptions();A("dialing %s:%s",n.host,n.port);const i=(0,g.Z)(),s=y((0,o.k)(e),this.init);if(s.socket.addEventListener("error",(()=>{const t=new r.sv(`Could not connect to ${e.toString()}`,"ERR_CONNECTION_FAILED");A.error("connection error:",t),i.reject(t)})),null==t.signal)return await Promise.race([s.connected(),i.promise]),A("connected %s",e),s;let a;const c=new Promise(((e,n)=>{a=()=>{n(new r._L),s.close().catch((e=>{A.error("error closing raw socket",e)}))},!0!==t?.signal?.aborted?t?.signal?.addEventListener("abort",a):a()}));try{await Promise.race([c,i.promise,s.connected()])}finally{null!=a&&t?.signal?.removeEventListener("abort",a)}return A("connected %s",e),s}createListener(e){return(0,b.y)({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],null!=this.init?.filter?this.init?.filter(e):m.jU||m.n2?w.xt(e):w.$6(e)}}function T(e={}){return()=>new I(e)}},34184:function(e,t,n){"use strict";function r(){throw new Error("WebSocket Servers can not be created in the browser!")}n.d(t,{y:function(){return r}})},88467:function(e,t,n){"use strict";function r(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}n.d(t,{A:function(){return r}})},98399:function(e,t,n){"use strict";n.d(t,{d:function(){return U}});var r=n(6329),i=n(55265),s=n(38203),o=n(46631),a=n(76201),c=n(62308);const u=(0,s.kg)("libp2p:webtransport:stream");async function l(e,t,n,r,i){const s=e.writable.getWriter(),o=e.readable.getReader();function a(){const e=r.findIndex((e=>e===f));-1!==e&&(r.splice(e,1),f.timeline.close=Date.now(),i?.(f))}await s.ready;let l=!1,h=!1;(async function(){const e=await s.closed.catch((e=>e));if(null!=e){const n=e.message;n.includes("aborted by the remote server")||n.includes("STOP_SENDING")||u.error(`WebTransport writer closed unexpectedly: streamId=${t} err=${e.message}`)}l=!0,l&&h&&a()})().catch((()=>{u.error("WebTransport failed to cleanup closed stream")})),async function(){const e=await o.closed.catch((e=>e));null!=e&&u.error(`WebTransport reader closed unexpectedly: streamId=${t} err=${e.message}`),h=!0,l&&h&&a()}().catch((()=>{u.error("WebTransport failed to cleanup closed stream")}));let d=!1;const f={id:t,status:"open",writeStatus:"ready",readStatus:"ready",abort(e){l||(s.abort(e).catch((e=>{u.error("could not abort stream",e)})),l=!0),h=!0,this.status="aborted",this.writeStatus="closed",this.readStatus="closed",this.timeline.reset=this.timeline.close=this.timeline.closeRead=this.timeline.closeWrite=Date.now(),a()},async close(e){this.status="closing",await Promise.all([f.closeRead(e),f.closeWrite(e)]),a(),this.status="closed",this.timeline.close=Date.now()},async closeRead(e){if(!h){this.readStatus="closing";try{await o.cancel()}catch(e){!0===e.toString().includes("RESET_STREAM")&&(l=!0)}this.timeline.closeRead=Date.now(),this.readStatus="closed",h=!0}l&&a()},async closeWrite(e){if(!l){l=!0,this.writeStatus="closing";try{await s.close()}catch(e){!0===e.toString().includes("RESET_STREAM")&&(h=!0)}this.timeline.closeWrite=Date.now(),this.writeStatus="closed"}h&&a()},direction:n,timeline:{open:Date.now()},metadata:{},source:async function*(){for(;;){const e=await o.read();if(e.done)return h=!0,void(l&&a());yield new c.H(e.value)}}(),sink:async function(e){if(d)throw new Error("sink already called on stream");d=!0;try{this.writeStatus="writing";for await(const t of e)if(t instanceof Uint8Array)await s.write(t);else for(const e of t)await s.write(e);this.writeStatus="done"}finally{this.timeline.closeWrite=Date.now(),this.writeStatus="closed",await f.closeWrite()}}};return f}var h=n(48767),d=n(72860),f=n(49541),p=n(5681),y=n(3901),g=n(11822),m=n(50872),w=n(69890),b=n(15879),E=n(79467),v=n(23384);const _=Symbol.for("nodejs.util.inspect.custom"),S=Object.values(g.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),g.gh.identity.decoder),R=114,A=36,I=37;class T{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[p.N]=!0;toString(){return null==this.string&&(this.string=y.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return m.k0.createV1(R,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,v.f)(this.multihash.bytes,e);if("string"==typeof e)return N(e).equals(this);if(null!=e?.multihash?.bytes)return(0,v.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[_](){return`PeerId(${this.toString()})`}}class C extends T{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class P extends T{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class k extends T{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function N(e,t){if(t=t??S,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=w.decode(y.base58btc.decode(`z${e}`));return e.startsWith("12D")?new P({multihash:t}):e.startsWith("16U")?new k({multihash:t}):new C({multihash:t})}return function(e){try{const t=w.decode(e);if(t.code===b.identity.code){if(t.digest.length===A)return new P({multihash:t});if(t.digest.length===I)return new k({multihash:t})}if(t.code===E.sha256.code)return new C({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==R)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===E.sha256.code)return new C({multihash:e.multihash});if(t.code===b.identity.code){if(t.digest.length===A)return new P({multihash:e.multihash});if(t.digest.length===I)return new k({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(m.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(S.decode(e))}const x=Object.values(g.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function D(e){if(!a.Mk.matches(e))throw new f.sv("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");const t=e.stringTuples(),n=t.filter((([e,t])=>e===(0,o.a_)("certhash").code)).map((([e,t])=>{return n=t??"",g.uR.decode(x.decode(n));var n})),r=t.filter((([e,t])=>e===(0,o.a_)("p2p").code)).map((([e,t])=>N(t??"")))[0],i=e.toOptions();let s=i.host;return 6===i.family&&s?.includes(":")&&(s=`[${s}]`),{url:`https://${s}:${i.port}`,certhashes:n,remotePeer:r}}const L=(0,s.kg)("libp2p:webtransport");class O{components;config;metrics;constructor(e,t={}){this.components=e,this.config={maxInboundStreams:t.maxInboundStreams??1e3},null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}[Symbol.toStringTag]="@libp2p/webtransport";[i.NA]=!0;async dial(e,t){t?.signal?.throwIfAborted(),L("dialing %s",e);const n=this.components.peerId;if(void 0===n)throw new Error("Need a local peerid");t=t??{};const{url:r,certhashes:i,remotePeer:s}=D(e);if(null==s)throw new Error("Need a target peerid");if(0===i.length)throw new Error("Expected multiaddr to contain certhashes");let o,a,c=()=>{},u=!1,l=!1,d=!1;try{this.metrics?.dialerEvents.increment({pending:!0});const f=new WebTransport(`${r}/.well-known/libp2p-webtransport?type=noise`,{serverCertificateHashes:i.map((e=>({algorithm:"sha-256",value:e.digest})))});if(c=e=>{if(!u)try{this.metrics?.dialerEvents.increment({[e]:!0}),f.close()}catch(e){L.error("error closing wt session",e)}finally{null!=a&&(a.timeline.close=Date.now()),u=!0}},o=()=>{c(l?"noise_timeout":"ready_timeout")},t.signal?.addEventListener("abort",o,{once:!0}),await Promise.race([f.closed,f.ready]),l=!0,this.metrics?.dialerEvents.increment({ready:!0}),f.closed.catch((e=>{L.error("error on remote wt session close",e)})).finally((()=>{c("remote_close")})),!await this.authenticateWebTransport(f,n,s,i))throw new Error("Failed to authenticate webtransport");return this.metrics?.dialerEvents.increment({open:!0}),a={close:async()=>{L("Closing webtransport"),c("close")},abort:e=>{L("aborting webtransport due to passed err",e),c("abort")},remoteAddr:e,timeline:{open:Date.now()},...(0,h.a)()},d=!0,await t.upgrader.upgradeOutbound(a,{skipEncryption:!0,muxerFactory:this.webtransportMuxer(f),skipProtection:!0})}catch(e){throw L.error("caught wt session err",e),c(d?"upgrade_error":l?"noise_error":"ready_error"),e}finally{null!=o&&t.signal?.removeEventListener("abort",o)}}async authenticateWebTransport(e,t,n,i){const s=await e.createBidirectionalStream(),o=s.writable.getWriter(),a=s.readable.getReader();await o.ready;const c={source:async function*(){for(;;){const e=await a.read();if(null!=e.value&&(yield e.value),e.done)break}}(),sink:async function(e){for await(const t of e)await o.write(t)}},u=(0,r.t)()(),{remoteExtensions:l}=await u.secureOutbound(t,c,n);if(o.close().catch((e=>{L.error(`Failed to close authentication stream writer: ${e.message}`)})),a.cancel().catch((e=>{L.error(`Failed to close authentication stream reader: ${e.message}`)})),!(0,d.K)(l?.webtransportCerthashes??[],i.map((e=>e.bytes))))throw new Error("Our certhashes are not a subset of the remote's reported certhashes");return!0}webtransportMuxer(e){let t=0;const n=this.config;return{protocol:"webtransport",createStreamMuxer:r=>{"function"==typeof r&&(r={onIncomingStream:r});const i=[];(async function(){const s=e.incomingBidirectionalStreams.getReader();for(;;){const{done:e,value:o}=await s.read();if(e)break;if(i.length>=n.maxInboundStreams)o.writable.close().catch((e=>{L.error(`Failed to close inbound stream that crossed our maxInboundStream limit: ${e.message}`)})),o.readable.cancel().catch((e=>{L.error(`Failed to close inbound stream that crossed our maxInboundStream limit: ${e.message}`)}));else{const e=await l(o,String(t++),"inbound",i,r?.onStreamEnd);i.push(e),r?.onIncomingStream?.(e)}}})().catch((()=>{L.error("WebTransport failed to receive incoming stream")}));return{protocol:"webtransport",streams:i,newStream:async n=>{const s=await e.createBidirectionalStream(),o=await l(s,String(t++),r?.direction??"outbound",i,r?.onStreamEnd);return i.push(o),o},close:async e=>{L("Closing webtransport muxer"),await Promise.all(i.map((async t=>t.close(e))))},abort:e=>{L("Aborting webtransport muxer with err:",e);for(const t of i)t.abort(e)},...(0,h.a)()}}}}createListener(e){throw new Error("Webtransport servers are not supported in Node or the browser")}filter(e){return e.filter(a.Mk.exactMatch)}}function U(e={}){return t=>new O(t,e)}},48767:function(e,t,n){"use strict";function r(){return{source:{[Symbol.asyncIterator]:()=>({next:async()=>new Promise((()=>{}))})},sink:async e=>new Promise((()=>{}))}}n.d(t,{a:function(){return r}})},72860:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n(23384);function i(e,t){return t.filter((t=>Boolean(e.find((e=>(0,r.f)(t,e)))))).length===t.length}},46631:function(e,t,n){"use strict";n.d(t,{a_:function(){return r.Ev}});n(49541),n(3901),n(50872),n(33064),n(79407);var r=n(46598);n(89560);Symbol.for("nodejs.util.inspect.custom"),(0,r.Ev)("dns").code,(0,r.Ev)("dns4").code,(0,r.Ev)("dns6").code,(0,r.Ev)("dnsaddr").code,new Map,Symbol.for("@multiformats/js-multiaddr/multiaddr")},11822:function(e,t,n){"use strict";n.d(t,{gh:function(){return g},uR:function(){return y}});var r=n(45027),i=n(66316),s=n(10527),o=n(6788),a=n(3746),c=n(60671),u=n(3901),l=n(36702),h=n(93458),d=n(29466),f=(n(12693),n(44745),n(15879)),p=n(79467),y=(n(63129),n(50872),n(69890));n(37562),n(36043);const g={...d,...s,...h,...r,...i,...a,...c,...u,...l,...o}},63129:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},50872:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(3746),i=n(3901),s=n(63129),o=n(69890),a=n(36043);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.create(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.equals(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.decode(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.Digest(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},69890:function(e,t,n){"use strict";n.r(t),n.d(t,{Digest:function(){return c},create:function(){return s},decode:function(){return o},equals:function(){return a}});var r=n(63129),i=n(36043);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},15879:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(63129),i=n(69890);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.create(0,s(e))}},79467:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(37562);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},36043:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},23384:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},76237:function(e,t,n){"use strict";n.d(t,{Ce:function(){return y},Rk:function(){return a},Ul:function(){return N},dx:function(){return k},th:function(){return m}});var r=n(67387);const i=O("dns4"),s=O("dns6"),o=O("dnsaddr"),a=L(O("dns"),o,i,s),c=L(O("ip4"),O("ip6")),u=L(D(c,O("tcp")),D(a,O("tcp"))),l=D(c,O("udp")),h=D(l,O("utp")),d=D(l,O("quic")),f=D(l,O("quic-v1")),p=L(D(u,O("ws")),D(a,O("ws"))),y=L(D(p,O("p2p")),p),g=L(D(u,O("wss")),D(a,O("wss")),D(u,O("tls"),O("ws")),D(a,O("tls"),O("ws"))),m=L(D(g,O("p2p")),g),w=L(D(u,O("http")),D(c,O("http")),D(a,O("http"))),b=L(D(u,O("https")),D(c,O("https")),D(a,O("https"))),E=D(l,O("webrtc-direct"),O("certhash")),v=L(D(E,O("p2p")),E),_=D(f,O("webtransport"),O("certhash"),O("certhash")),S=L(D(_,O("p2p")),_),R=L(D(y,O("p2p-webrtc-star"),O("p2p")),D(m,O("p2p-webrtc-star"),O("p2p")),D(y,O("p2p-webrtc-star")),D(m,O("p2p-webrtc-star"))),A=(L(D(y,O("p2p-websocket-star"),O("p2p")),D(m,O("p2p-websocket-star"),O("p2p")),D(y,O("p2p-websocket-star")),D(m,O("p2p-websocket-star"))),L(D(w,O("p2p-webrtc-direct"),O("p2p")),D(b,O("p2p-webrtc-direct"),O("p2p")),D(w,O("p2p-webrtc-direct")),D(b,O("p2p-webrtc-direct")))),I=L(p,g,w,b,R,A,u,h,d,a,v,S),T=(L(D(I,O("p2p-stardust"),O("p2p")),D(I,O("p2p-stardust"))),L(D(I,O("p2p")),R,A,v,S,O("p2p"))),C=L(D(T,O("p2p-circuit"),T),D(T,O("p2p-circuit")),D(O("p2p-circuit"),T),D(I,O("p2p-circuit")),D(O("p2p-circuit"),I),O("p2p-circuit")),P=()=>L(D(C,P),C),k=P(),N=L(D(k,T,k),D(T,k),D(k,T),k,T);L(D(k,O("webrtc"),O("p2p")),D(k,O("webrtc")),D(I,O("webrtc"),O("p2p")),D(I,O("webrtc")),O("webrtc"));function x(e){return function(t){let n;try{n=(0,r.HM)(t)}catch(e){return!1}const i=e(n.protoNames());return null!==i&&(!0===i||!1===i?i:0===i.length)}}function D(...e){function t(t){if(t.length<e.length)return null;let n=t;return e.some((e=>(n="function"==typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(n)&&(t=n),null===n))),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:x(t),partialMatch:t}}function L(...e){function t(t){let n=null;return e.some((e=>{const r="function"==typeof e?e().partialMatch(t):e.partialMatch(t);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:x(t),partialMatch:t}}function O(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=(0,r.HM)(e)}catch(e){return!1}const i=n.protoNames();return 1===i.length&&i[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}},76201:function(e,t,n){"use strict";n.d(t,{IP:function(){return A},Ih:function(){return U},Mk:function(){return B},Rk:function(){return E},dx:function(){return V},uF:function(){return $}});var r=n(49736),i=(n(29074),n(7187)),s=n(37649);const o=e=>({match:t=>!(t.length<1)&&(!!e(t[0])&&t.slice(1)),pattern:"fn"}),a=e=>({match:t=>o((t=>t===e)).match(t),pattern:e}),c=()=>({match:e=>o((e=>"string"==typeof e)).match(e),pattern:"{string}"}),u=()=>({match:e=>o((e=>!isNaN(parseInt(e)))).match(e),pattern:"{number}"}),l=()=>({match:e=>{if(e.length<2)return!1;if("p2p"!==e[0]&&"ipfs"!==e[0])return!1;if(!e[1].startsWith("Q")&&!e[1].startsWith("1"))return!1;try{i.i.decode(`z${e[1]}`)}catch(e){return!1}return e.slice(2)},pattern:"/p2p/{peerid}"}),h=()=>({match:e=>{if(e.length<2)return!1;if("certhash"!==e[0])return!1;try{s.tH.decode(e[1])}catch{return!1}return e.slice(2)},pattern:"/certhash/{certhash}"}),d=e=>({match:t=>{const n=e.match(t);return!1===n?t:n},pattern:`optional(${e.pattern})`}),f=(...e)=>({match:t=>{let n;for(const r of e){const e=r.match(t);!1!==e&&((null==n||e.length<n.length)&&(n=e))}return null!=n&&n},pattern:`or(${e.map((e=>e.pattern)).join(", ")})`}),p=(...e)=>({match:t=>{for(const n of e){const e=n.match(t);if(!1===e)return!1;t=e}return t},pattern:`and(${e.map((e=>e.pattern)).join(", ")})`});function y(...e){function t(t){let n=(e=>e.toString().split("/").slice(1))(t);for(const t of e){const e=t.match(n);if(!1===e)return!1;n=e}return n}return{matches:function(e){return!1!==t(e)},exactMatch:function(e){const n=t(e);return!1!==n&&0===n.length}}}const g=p(a("dns4"),c()),m=p(a("dns6"),c()),w=p(a("dnsaddr"),c()),b=p(a("dns"),c()),E=(y(g),y(m),y(w),y(f(b,w,g,m))),v=p(a("ip4"),o(r.C)),_=p(a("ip6"),o(r.aY)),S=f(v,_),R=f(S,b,g,m,w),A=(y(v),y(_),y(S)),I=p(R,a("tcp"),u()),T=p(R,a("udp"),u()),C=f(I,T),P=(y(I),y(T),p(T,a("quic"))),k=p(T,a("quic-v1")),N=f(P,k),x=(y(P),y(k),f(R,I,T,P,k)),D=f(p(x,a("ws"),d(l()))),L=(y(D),f(p(x,a("wss"),d(l())),p(x,a("tls"),a("ws"),d(l())))),O=(y(L),p(C,a("webrtc-direct"),h(),d(h()),d(l()))),U=y(O),M=p(k,a("webtransport"),h(),h(),d(l())),B=y(M),z=f(D,L,p(I,d(l())),p(N,d(l())),p(R,d(l())),O,M,l()),V=(y(z),y(p(z,a("p2p-circuit"),l()))),$=y(f(p(z,a("p2p-circuit"),a("webrtc"),l()),p(z,a("webrtc"),d(l())),a("webrtc")))},45182:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(63058);const i=(e,t)=>t,s={ip4:i,ip6:(e,t,n,r)=>1===r.length&&"ip6"===r[0].protocol?t:`[${t}]`,tcp:(e,t,n,r,i)=>r.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:((e,t,n,r)=>{if(null!=r&&!1===r.assumeHttp)return`tcp://${e}:${t}`;let i="tcp",s=`:${t}`;return"tcp"===n[n.length-1].protocol&&(i="443"===t?"https":"http",s="443"===t||"80"===t?"":s),`${i}://${e}${s}`})(e,t,r,i),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:i,dns4:i,dns6:i,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function o(e,t){const n=(0,r.HM)(e),i=n.toString().split("/").slice(1);return n.tuples().map((e=>({protocol:i.shift()??"",content:null!=e[1]?i.shift()??"":""}))).reduce(((e,n,r,i)=>{const o=s[n.protocol];if(null==o)throw new Error(`Unsupported protocol ${n.protocol}`);return o(e,n.content,r,i,t)}),"")}},11133:function(e,t,n){"use strict";n.d(t,{Fm:function(){return b},xV:function(){return w}});var r=n(49736),i=n(49784);const s=r.C,o=r.aY,a=function(e){let t=0;if(e=e.toString().trim(),s(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(o(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;s(n[r])&&(e=a(n[r]),n[r]=(0,i.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,i.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const o=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);o[t++]=e>>8&255,o[t++]=255&e}return o}throw new Error("invalid ip address")},c=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var u=n(55986),l=n(38161),h=n(14249),d=n(81653),f=n(93387),p=n(29094),y=n(90309),g=n(77408),m=n(41690);n(9839);(0,u.Ev)("ip4"),(0,u.Ev)("ip6"),(0,u.Ev)("ipcidr");function w(e,t){switch((0,u.Ev)(e).code){case 4:case 41:return function(e){const t=c(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!r.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return I(t);case 6:case 273:case 33:case 132:return R(t).toString();case 421:return function(e){const t=y.decode(e),n=e.slice(y.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return(0,i.B)(n,"base58btc")}(t);case 444:case 445:return T(t);case 466:return function(e){const t=y.decode(e),n=e.slice(y.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,i.B)(n,"base64url")}(t);default:return(0,i.B)(t,"base16")}}function b(e,t){switch((0,u.Ev)(e).code){case 4:case 41:return _(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return A(t);case 6:case 273:case 33:case 132:return S(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?p.Jx(d.base58btc.decode(`z${e}`)).bytes:l.k0.parse(e).multihash.bytes;const n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=h.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=S(r);return(0,m.z)([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=h.base32.decode(`b${t[0]}`),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=S(r);return(0,m.z)([n,i],n.length+i.length)}(t);case 466:return function(e){const t=v.decode(e),n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}(t);default:return(0,g.m)(t,"base16")}}const E=Object.values(f.gh).map((e=>e.decoder)),v=function(){let e=E[0].or(E[1]);return E.slice(2).forEach((t=>e=e.or(t))),e}();function _(e){if(!r.h6(e))throw new Error("invalid ip address");return a(e)}function S(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function R(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function A(e){const t=(0,g.m)(e),n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}function I(e){const t=y.decode(e);if((e=e.slice(y.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return(0,i.B)(e)}function T(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,i.B)(t,"base32")}:${R(n)}`}},63058:function(e,t,n){"use strict";n.d(t,{HM:function(){return O}});var r=n(11133),i=n(55986),s=n(90309),o=n(41690),a=n(49784);function c(e){return e.map((e=>{const t=w(e);return null!=e[1]?[t.code,(0,r.xV)(t.code,e[1])]:[t.code]}))}function u(e){return p((0,o.z)(e.map((e=>{const t=w(e);let n=Uint8Array.from(s.encode(t.code));return e.length>1&&null!=e[1]&&(n=(0,o.z)([n,e[1]])),n}))))}function l(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return s.decode(t)+(s.decode.bytes??0)}function h(e){const t=[];let n=0;for(;n<e.length;){const r=s.decode(e,n),o=s.decode.bytes??0,c=l((0,i.Ev)(r),e.slice(n+o));if(0===c){t.push([r]),n+=o;continue}const u=e.slice(n+o,n+o+c);if(n+=c+o,n>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([r,u])}return t}function d(e){return function(e){const t=[];return e.map((e=>{const n=w(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}(c(h(e)))}function f(e){const t=function(e){const t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(let r=0;r<n.length;r++){const s=n[r],o=(0,i.Ev)(s);if(0!==o.size){if(r++,r>=n.length)throw m("invalid address: "+e);if(!0===o.path){t.push([s,g(n.slice(r).join("/"))]);break}t.push([s,n[r]])}else t.push([s])}return t}(e=g(e));return u(t.map((e=>{Array.isArray(e)||(e=[e]);const t=w(e);return e.length>1?[t.code,(0,r.Fm)(t.code,e[1])]:[t.code]})))}function p(e){const t=y(e);if(null!=t)throw t;return Uint8Array.from(e)}function y(e){try{h(e)}catch(e){return e}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}function w(e){return(0,i.Ev)(e[0])}var b,E,v,_,S=n(38161),R=n(81653),A=n(32114),I=n(73062),T=(n(8710),function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}),C=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const P=Symbol.for("nodejs.util.inspect.custom"),k=[(0,i.Ev)("dns").code,(0,i.Ev)("dns4").code,(0,i.Ev)("dns6").code,(0,i.Ev)("dnsaddr").code],N=new Map,x=Symbol.for("@multiformats/js-multiaddr/multiaddr");function D(e){return Boolean(e?.[x])}class L{constructor(e){if(b.set(this,void 0),E.set(this,void 0),v.set(this,void 0),this[_]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=p(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=f(e)}else{if(!D(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=p(e.bytes)}}toString(){return null==T(this,b,"f")&&C(this,b,d(this.bytes),"f"),T(this,b,"f")}toJSON(){return this.toString()}toOptions(){let e,t,n,r,s="";const o=(0,i.Ev)("tcp"),a=(0,i.Ev)("udp"),c=(0,i.Ev)("ip4"),u=(0,i.Ev)("ip6"),l=(0,i.Ev)("dns6"),h=(0,i.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===h.code&&(s=`%${f??""}`),k.includes(d)&&(t=o.name,r=443,n=`${f??""}${s}`,e=d===l.code?6:4),d!==o.code&&d!==a.code||(t=(0,i.Ev)(d).name,r=parseInt(f??"")),d!==c.code&&d!==u.code||(t=(0,i.Ev)(d).name,n=`${f??""}${s}`,e=d===u.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.protoCodes().map((e=>Object.assign({},(0,i.Ev)(e))))}protoCodes(){const e=[],t=this.bytes;let n=0;for(;n<t.length;){const r=s.decode(t,n),o=s.decode.bytes??0;n+=l((0,i.Ev)(r),t.slice(n+o))+o,e.push(r)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==T(this,E,"f")&&C(this,E,h(this.bytes),"f"),T(this,E,"f")}stringTuples(){return null==T(this,v,"f")&&C(this,v,c(this.tuples()),"f"),T(this,v,"f")}encapsulate(e){return e=new L(e),new L(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new L(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new L(u(t.slice(0,n)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===i.R5.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(R.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(S.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===(0,i.Ev)(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return(0,I.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=N.get(t.name);if(null==n)throw A(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new L(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(b=new WeakMap,E=new WeakMap,v=new WeakMap,_=x,P)](){return`Multiaddr(${d(this.bytes)})`}}function O(e){return new L(e)}},55986:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},72835:function(e,t,n){"use strict";n.d(t,{Fm:function(){return b},xV:function(){return w}});var r=n(49736),i=n(49784);const s=r.C,o=r.aY,a=function(e){let t=0;if(e=e.toString().trim(),s(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(o(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;s(n[r])&&(e=a(n[r]),n[r]=(0,i.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,i.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const o=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);o[t++]=e>>8&255,o[t++]=255&e}return o}throw new Error("invalid ip address")},c=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var u=n(20030),l=n(38161),h=n(14249),d=n(81653),f=n(93387),p=n(29094),y=n(93649),g=n(77408),m=n(41690);function w(e,t){switch((0,u.Ev)(e).code){case 4:case 41:return function(e){const t=c(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!r.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return I(t);case 6:case 273:case 33:case 132:return R(t).toString();case 421:return function(e){const t=y.decode(e),n=e.slice(y.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return(0,i.B)(n,"base58btc")}(t);case 444:case 445:return T(t);case 466:return function(e){const t=y.decode(e),n=e.slice(y.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,i.B)(n,"base64url")}(t);default:return(0,i.B)(t,"base16")}}function b(e,t){switch((0,u.Ev)(e).code){case 4:case 41:return _(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return A(t);case 6:case 273:case 33:case 132:return S(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?p.Jx(d.base58btc.decode(`z${e}`)).bytes:l.k0.parse(e).multihash.bytes;const n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=h.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=S(r);return(0,m.z)([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=h.base32.decode(`b${t[0]}`),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=S(r);return(0,m.z)([n,i],n.length+i.length)}(t);case 466:return function(e){const t=v.decode(e),n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}(t);default:return(0,g.m)(t,"base16")}}const E=Object.values(f.gh).map((e=>e.decoder)),v=function(){let e=E[0].or(E[1]);return E.slice(2).forEach((t=>e=e.or(t))),e}();function _(e){if(!r.h6(e))throw new Error("invalid ip address");return a(e)}function S(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function R(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function A(e){const t=(0,g.m)(e),n=Uint8Array.from(y.encode(t.length));return(0,m.z)([n,t],n.length+t.length)}function I(e){const t=y.decode(e);if((e=e.slice(y.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return(0,i.B)(e)}function T(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,i.B)(t,"base32")}:${R(n)}`}},91026:function(e,t,n){"use strict";n.d(t,{uv:function(){return D},h2:function(){return O},K9:function(){return L},HM:function(){return M},a_:function(){return i.Ev},s_:function(){return N}});var r=n(72835),i=n(20030),s=n(93649),o=n(41690),a=n(49784);function c(e){return e.map((e=>{const t=w(e);return null!=e[1]?[t.code,(0,r.xV)(t.code,e[1])]:[t.code]}))}function u(e){return p((0,o.z)(e.map((e=>{const t=w(e);let n=Uint8Array.from(s.encode(t.code));return e.length>1&&null!=e[1]&&(n=(0,o.z)([n,e[1]])),n}))))}function l(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return s.decode(t)+(s.decode.bytes??0)}function h(e){const t=[];let n=0;for(;n<e.length;){const r=s.decode(e,n),o=s.decode.bytes??0,c=l((0,i.Ev)(r),e.slice(n+o));if(0===c){t.push([r]),n+=o;continue}const u=e.slice(n+o,n+o+c);if(n+=c+o,n>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([r,u])}return t}function d(e){return function(e){const t=[];return e.map((e=>{const n=w(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}(c(h(e)))}function f(e){const t=function(e){const t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(let r=0;r<n.length;r++){const s=n[r],o=(0,i.Ev)(s);if(0!==o.size){if(r++,r>=n.length)throw m("invalid address: "+e);if(!0===o.path){t.push([s,g(n.slice(r).join("/"))]);break}t.push([s,n[r]])}else t.push([s])}return t}(e=g(e));return u(t.map((e=>{Array.isArray(e)||(e=[e]);const t=w(e);return e.length>1?[t.code,(0,r.Fm)(t.code,e[1])]:[t.code]})))}function p(e){const t=y(e);if(null!=t)throw t;return Uint8Array.from(e)}function y(e){try{h(e)}catch(e){return e}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}function w(e){return(0,i.Ev)(e[0])}var b,E,v,_,S=n(38161),R=n(81653),A=n(32114),I=n(73062),T=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},C=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const P=Symbol.for("nodejs.util.inspect.custom"),k=[(0,i.Ev)("dns").code,(0,i.Ev)("dns4").code,(0,i.Ev)("dns6").code,(0,i.Ev)("dnsaddr").code],N=new Map,x=Symbol.for("@multiformats/js-multiaddr/multiaddr");function D(e,t){if(null==e)throw new Error("requires node address object");if(null==t)throw new Error("requires transport protocol");let n,r=e.address;switch(e.family){case 4:n="ip4";break;case 6:if(n="ip6",r.includes("%")){const e=r.split("%");if(2!==e.length)throw Error("Multiple ip6 zones in multiaddr");r=e[0];n=`/ip6zone/${e[1]}/ip6`}break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new U("/"+[n,r,t,e.port].join("/"))}function L(e){return!!O(e)&&e.protos().some((e=>e.resolvable))}function O(e){return Boolean(e?.[x])}class U{constructor(e){if(b.set(this,void 0),E.set(this,void 0),v.set(this,void 0),this[_]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=p(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=f(e)}else{if(!O(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=p(e.bytes)}}toString(){return null==T(this,b,"f")&&C(this,b,d(this.bytes),"f"),T(this,b,"f")}toJSON(){return this.toString()}toOptions(){let e,t,n,r,s="";const o=(0,i.Ev)("tcp"),a=(0,i.Ev)("udp"),c=(0,i.Ev)("ip4"),u=(0,i.Ev)("ip6"),l=(0,i.Ev)("dns6"),h=(0,i.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===h.code&&(s=`%${f??""}`),k.includes(d)&&(t=o.name,r=443,n=`${f??""}${s}`,e=d===l.code?6:4),d!==o.code&&d!==a.code||(t=(0,i.Ev)(d).name,r=parseInt(f??"")),d!==c.code&&d!==u.code||(t=(0,i.Ev)(d).name,n=`${f??""}${s}`,e=d===u.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.protoCodes().map((e=>Object.assign({},(0,i.Ev)(e))))}protoCodes(){const e=[],t=this.bytes;let n=0;for(;n<t.length;){const r=s.decode(t,n),o=s.decode.bytes??0;n+=l((0,i.Ev)(r),t.slice(n+o))+o,e.push(r)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==T(this,E,"f")&&C(this,E,h(this.bytes),"f"),T(this,E,"f")}stringTuples(){return null==T(this,v,"f")&&C(this,v,c(this.tuples()),"f"),T(this,v,"f")}encapsulate(e){return e=new U(e),new U(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new U(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new U(u(t.slice(0,n)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===i.R5.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(R.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(S.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===(0,i.Ev)(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return(0,I.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=N.get(t.name);if(null==n)throw A(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new U(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(b=new WeakMap,E=new WeakMap,v=new WeakMap,_=x,P)](){return`Multiaddr(${d(this.bytes)})`}}function M(e){return new U(e)}},20030:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},78431:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(20030),i=n(41309).Z;const{code:s}=(0,r.Ev)("dnsaddr");async function o(e,t={}){const n=new i;null!=t.signal&&t.signal.addEventListener("abort",(()=>{n.cancel()}));const r=e.getPeerId(),[,o]=e.stringTuples().find((([e])=>e===s))??[];if(null==o)throw new Error("No hostname found in multiaddr");let a=(await n.resolveTxt(`_dnsaddr.${o}`)).flat().map((e=>e.split("=")[1])).filter(Boolean);return null!=r&&(a=a.filter((e=>e.includes(r)))),a}},12619:function(e,t,n){"use strict";n.d(t,{Pv:function(){return o}});var r=n(22688),i=n(11015),s=n(40469);(0,r.D)({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let n=0;n<4;n++)t[n]=255&e,e>>=8;return new Uint8Array(t)}(s.x86.hash32(e))});const o=(0,r.D)({name:"murmur3-128",code:34,encode:e=>i.aI.fromHex(s.x64.hash128(e))});(0,r.D)({name:"murmur3-x64-64",code:34,encode:e=>i.aI.fromHex(s.x64.hash128(e)).subarray(0,8)})},86107:function(e,t,n){"use strict";n.d(t,{vu:function(){return o}});const r=async(e,t,n={})=>{if(!(t instanceof File||t instanceof Blob))throw new Error("invalid file");const r=new FormData;r.append("file",t,p(t));const s=a(n);try{const t=await i(e,"add",{params:s,method:"POST",body:r,signal:n.signal}),o=s["stream-channels"]?t:t[0];return{...o,cid:o.cid}}catch(e){const t=e;throw t.response?.ok?new Error(`failed to parse response body from cluster add ${t.stack}`):t}},i=async({url:e,headers:t},n,{method:r,params:i,body:s,signal:o})=>{const a=new URL(n,e);for(const[e,t]of Object.entries(i||{}))null!=t&&a.searchParams.set(e,String(t));const c=await fetch(a.href,{method:r||"GET",headers:t,body:s,signal:o});if(c.ok)return await c.json();throw Object.assign(new Error(`${c.status}: ${c.statusText}`),{response:c})},s=async function*({url:e,headers:t},n,{method:r,params:i,body:s,signal:o}){const a=new URL(n,e);for(const[e,t]of Object.entries(i||{}))null!=t&&a.searchParams.set(e,String(t));r=r||"GET";const c=await fetch(a.href,{method:r,headers:t,body:s,signal:o});if(!c.ok){const e=`${c.status}: ${c.statusText}`;throw Object.assign(new Error(e),{response:c})}if(!c.body)throw Object.assign(new Error("Missing response body"),{response:c});yield*y(c.body)};class o{constructor(e,{headers:t}={}){this.url=new URL(e),this.headers=t}version(e){return(async(e,{signal:t}={})=>{const n=await i(e,"version",{method:"GET",signal:t});if("string"!=typeof n.version)throw new Error(`failed to parse version from response the body: ${JSON.stringify(n,null,2)}`);return n.version})(this,e)}info(e){return(async(e,{signal:t}={})=>{const n=await i(e,"id",{method:"GET",signal:t});if((n.error||n.ipfs?.error||"").length>0)throw new Error(`cluster id response has failure: ${JSON.stringify(n,null,2)}`);return f(n)})(this,e)}add(e,t){return r(this,e,t)}addDirectory(e,t){return(async(e,t,n={})=>{const r=new FormData;for(const e of t){if(!(e instanceof File||e instanceof Blob))throw new Error("invalid file");r.append("file",e,p(e))}return await i(e,"add",{params:{...a(n),"stream-channels":!1,"wrap-with-directory":!0},method:"POST",body:r,signal:n.signal})})(this,e,t)}addCAR(e,t={}){return((e,t,n={})=>r(e,t,{...n,format:"car"}))(this,e,{...t,format:"car"})}pin(e,t){return(async(e,t,n={})=>{const r=t.startsWith("/")?`pins${t}`:`pins/${t}`,s=await i(e,r,{params:c(n),method:"POST",signal:n.signal});return h(s)})(this,e,t)}unpin(e,t){return(async(e,t,{signal:n}={})=>{const r=t.startsWith("/")?`pins${t}`:`pins/${t}`,s=await i(e,r,{method:"DELETE",signal:n});return h(s)})(this,e,t)}status(e,t){return(async(e,t,{local:n,signal:r}={})=>{const s=`pins/${encodeURIComponent(t)}`,o=await i(e,s,{params:null!=n?{local:n}:void 0,signal:r});return d(o)})(this,e,t)}statusAll(e){return(async(e,{local:t,filter:n,cids:r,signal:i}={})=>{const o=s(e,"pins",{params:{local:t,filter:n?String(n):null,cids:r?String(r):null},signal:i}),a=[];for await(const e of o)a.push(d(e));return a})(this,e)}allocation(e,t){return(async(e,t,{signal:n}={})=>{const r=`allocations/${encodeURIComponent(t)}`,s=await i(e,r,{signal:n});return h(s)})(this,e,t)}recover(e,t){return(async(e,t,{local:n,signal:r}={})=>{const s=`pins/${encodeURIComponent(t)}/recover`,o=await i(e,s,{method:"POST",params:null!=n?{local:n}:void 0,signal:r});return d(o)})(this,e,t)}metricNames(e){return((e,{signal:t}={})=>i(e,"monitor/metrics",{signal:t}))(this,e)}peerList(e){return(async(e,t={})=>{const n=s(e,"peers",{signal:t.signal}),r=[];for await(const e of n)r.push(f(e));return r})(this,e)}}const a=(e={})=>l({...c(e),local:e.local,recursive:e.recursive,hidden:e.hidden,wrap:e.wrap,shard:e.shard,"stream-channels":null!=e.streamChannels&&e.streamChannels,format:e.format,layout:e.layout,chunker:e.chunker,"raw-leaves":null==e.rawLeaves||e.rawLeaves,progress:e.progress,"cid-version":null!=e.cidVersion?e.cidVersion:1,hash:e.hashFun,"no-copy":e.noCopy}),c=(e={})=>l({name:e.name,mode:e.mode,"replication-min":e.replicationFactorMin,"replication-max":e.replicationFactorMax,"shard-size":e.shardSize,"user-allocations":e.userAllocations?.join(","),"expire-at":e.expireAt?.toISOString(),"pin-update":e.pinUpdate,origins:e.origins?.join(","),...u(e.metadata||{})}),u=(e={})=>Object.fromEntries(Object.entries(e).map((([e,t])=>[`meta-${e}`,t]))),l=e=>Object.fromEntries(Object.entries(e).filter((([,e])=>null!=e))),h=e=>({replicationFactorMin:e.replication_factor_min,replicationFactorMax:e.replication_factor_max,name:e.name,mode:e.mode,shardSize:e.shard_size,userAllocations:e.user_allocations,expireAt:new Date(e.expire_at),metadata:e.metadata,pinUpdate:e.pin_update,cid:e.cid,type:e.type,allocations:e.allocations,maxDepth:e.max_depth,reference:e.reference}),d=e=>{let t=e.peer_map;return t&&(t=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,{peerName:t.peername,ipfsPeerId:t.ipfs_peer_id,status:t.status,timestamp:new Date(t.timestamp),error:t.error}])))),{cid:e.cid,name:e.name,peerMap:t}},f=({id:e,addresses:t,version:n,commit:r,peername:i,rpc_protocol_version:s,cluster_peers:o,cluster_peers_addresses:a,ipfs:c,error:u})=>({id:e,addresses:t,version:n,commit:r,peerName:i,rpcProtocolVersion:s,clusterPeers:o,clusterPeersAddresses:a,ipfs:c,error:u}),p=e=>e.name,y=async function*(e){const t=e.getReader(),n=/\r?\n/,r=new TextDecoder("utf8");let i="";try{for(;;){const e=await t.read();if(e.done)break;i+=r.decode(e.value,{stream:!0});const s=i.split(n);i=s.pop()||"";for(const e of s)yield JSON.parse(e)}}finally{t.cancel(),t.releaseLock()}i+=r.decode(void 0,{stream:!1}),i&&(yield JSON.parse(i))}},27760:function(e,t,n){"use strict";var r;n.d(t,{$3:function(){return ee},E9:function(){return A},P6:function(){return he},T:function(){return ce},Xx:function(){return oe}});var i=n(95856);const s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(3),u=BigInt(8),l=Object.freeze({a:s,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:o,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),h=(e,t)=>(e+t/a)/t,d={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){const{n:t}=l,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-o*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,a=BigInt("0x100000000000000000000000000000000"),c=h(s*e,t),u=h(-r*e,t);let d=$(e-c*n-u*i,t),f=$(-c*r-u*s,t);const p=d>a,y=f>a;if(p&&(d=t-d),y&&(f=t-f),d>a||f>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:p,k1:d,k2neg:y,k2:f}}},f=32,p=32,y=32,g=f+1,m=2*f+1;function w(e){const{a:t,b:n}=l,r=$(e*e),i=$(r*e);return $(i+t*e+n)}const b=l.a===s;class E extends Error{constructor(e){super(e)}}function v(e){if(!(e instanceof _))throw new TypeError("JacobianPoint expected")}class _{constructor(e,t,n){this.x=e,this.y=t,this.z=n}static fromAffine(e){if(!(e instanceof A))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(A.ZERO)?_.ZERO:new _(e.x,e.y,o)}static toAffineBatch(e){const t=function(e,t=l.P){const n=new Array(e.length),r=j(e.reduce(((e,r,i)=>r===s?e:(n[i]=e,$(e*r,t))),o),t);return e.reduceRight(((e,r,i)=>r===s?e:(n[i]=$(e*n[i],t),$(e*r,t))),r),n}(e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}static normalizeZ(e){return _.toAffineBatch(e).map(_.fromAffine)}equals(e){v(e);const{x:t,y:n,z:r}=this,{x:i,y:s,z:o}=e,a=$(r*r),c=$(o*o),u=$(t*c),l=$(i*a),h=$($(n*o)*c),d=$($(s*r)*a);return u===l&&h===d}negate(){return new _(this.x,$(-this.y),this.z)}double(){const{x:e,y:t,z:n}=this,r=$(e*e),i=$(t*t),s=$(i*i),o=e+i,l=$(a*($(o*o)-r-s)),h=$(c*r),d=$(h*h),f=$(d-a*l),p=$(h*(l-f)-u*s),y=$(a*t*n);return new _(f,p,y)}add(e){v(e);const{x:t,y:n,z:r}=this,{x:i,y:o,z:c}=e;if(i===s||o===s)return this;if(t===s||n===s)return e;const u=$(r*r),l=$(c*c),h=$(t*l),d=$(i*u),f=$($(n*c)*l),p=$($(o*r)*u),y=$(d-h),g=$(p-f);if(y===s)return g===s?this.double():_.ZERO;const m=$(y*y),w=$(y*m),b=$(h*m),E=$(g*g-w-a*b),S=$(g*(b-E)-f*w),R=$(r*c*y);return new _(E,S,R)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=_.ZERO;if("bigint"==typeof e&&e===s)return t;let n=V(e);if(n===o)return this;if(!b){let e=t,r=this;for(;n>s;)n&o&&(e=e.add(r)),r=r.double(),n>>=o;return e}let{k1neg:r,k1:i,k2neg:a,k2:c}=d.splitScalar(n),u=t,l=t,h=this;for(;i>s||c>s;)i&o&&(u=u.add(h)),c&o&&(l=l.add(h)),h=h.double(),i>>=o,c>>=o;return r&&(u=u.negate()),a&&(l=l.negate()),l=new _($(l.x*d.beta),l.y,l.z),u.add(l)}precomputeWindow(e){const t=b?128/e+1:256/e+1,n=[];let r=this,i=r;for(let s=0;s<t;s++){i=r,n.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(r),n.push(i);r=i.double()}return n}wNAF(e,t){!t&&this.equals(_.BASE)&&(t=A.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=t&&R.get(t);r||(r=this.precomputeWindow(n),t&&1!==n&&(r=_.normalizeZ(r),R.set(t,r)));let i=_.ZERO,s=_.BASE;const a=1+(b?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),l=2**n,h=BigInt(n);for(let t=0;t<a;t++){const n=t*c;let a=Number(e&u);e>>=h,a>c&&(a-=l,e+=o);const d=n,f=n+Math.abs(a)-1,p=t%2!=0,y=a<0;0===a?s=s.add(S(p,r[d])):i=i.add(S(y,r[f]))}return{p:i,f:s}}multiply(e,t){let n,r,i=V(e);if(b){const{k1neg:e,k1:s,k2neg:o,k2:a}=d.splitScalar(i);let{p:c,f:u}=this.wNAF(s,t),{p:l,f:h}=this.wNAF(a,t);c=S(e,c),l=S(o,l),l=new _($(l.x*d.beta),l.y,l.z),n=c.add(l),r=u.add(h)}else{const{p:e,f:s}=this.wNAF(i,t);n=e,r=s}return _.normalizeZ([n,r])[0]}toAffine(e){const{x:t,y:n,z:r}=this,i=this.equals(_.ZERO);null==e&&(e=i?u:j(r));const s=e,a=$(s*s),c=$(a*s),l=$(t*a),h=$(n*c),d=$(r*s);if(i)return A.ZERO;if(d!==o)throw new Error("invZ was invalid");return new A(l,h)}}function S(e,t){const n=t.negate();return e?n:t}_.BASE=new _(l.Gx,l.Gy,o),_.ZERO=new _(s,o,s);const R=new WeakMap;class A{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,R.delete(this)}hasEvenY(){return this.y%a===s}static fromCompressedHex(e){const t=32===e.length,n=B(t?e:e.subarray(1));if(!W(n))throw new Error("Point is not on curve");let r=function(e){const{P:t}=l,n=BigInt(6),r=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),u=BigInt(88),h=e*e*e%t,d=h*h*e%t,f=F(d,c)*d%t,p=F(f,c)*d%t,y=F(p,a)*h%t,g=F(y,r)*y%t,m=F(g,i)*g%t,w=F(m,o)*m%t,b=F(w,u)*w%t,E=F(b,o)*m%t,v=F(E,c)*d%t,_=F(v,s)*g%t,S=F(_,n)*h%t,R=F(S,a);if(R*R%t!==e)throw new Error("Cannot find square root");return R}(w(n));const i=(r&o)===o;if(t)i&&(r=$(-r));else{1==(1&e[0])!==i&&(r=$(-r))}const s=new A(n,r);return s.assertValidity(),s}static fromUncompressedHex(e){const t=B(e.subarray(1,f+1)),n=B(e.subarray(f+1,2*f+1)),r=new A(t,n);return r.assertValidity(),r}static fromHex(e){const t=z(e),n=t.length,r=t[0];if(n===f)return this.fromCompressedHex(t);if(n===g&&(2===r||3===r))return this.fromCompressedHex(t);if(n===m&&4===r)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-${g} compressed bytes or ${m} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return A.BASE.multiply(Y(e))}static fromSignature(e,t,n){const{r:r,s:i}=X(t);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");const s=K(z(e)),{n:o}=l,a=2===n||3===n?r+o:r,c=j(a,o),u=$(-s*c,o),h=$(i*c,o),d=1&n?"03":"02",f=A.fromHex(d+D(a)),p=A.BASE.multiplyAndAddUnsafe(f,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return M(this.toHex(e))}toHex(e=!1){const t=D(this.x);if(e){return`${this.hasEvenY()?"02":"03"}${t}`}return`04${t}${D(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:n}=this;if(!W(t)||!W(n))throw new Error(e);const r=$(n*n);if($(r-w(t))!==s)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new A(this.x,$(-this.y))}double(){return _.fromAffine(this).double().toAffine()}add(e){return _.fromAffine(this).add(_.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return _.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,n){const r=_.fromAffine(this),i=t===s||t===o||this!==A.BASE?r.multiplyUnsafe(t):r.multiply(t),a=_.fromAffine(e).multiplyUnsafe(n),c=i.add(a);return c.equals(_.ZERO)?void 0:c.toAffine()}}function I(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function T(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${N(e)}`);const t=e[1],n=e.subarray(2,t+2);if(!t||n.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===n[0]&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:B(n),left:e.subarray(t+2)}}A.BASE=new A(l.Gx,l.Gy),A.ZERO=new A(s,s);class C{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,n="Signature.fromCompact";if("string"!=typeof e&&!t)throw new TypeError(`${n}: Expected string or Uint8Array`);const r=t?N(e):e;if(128!==r.length)throw new Error(`${n}: Expected 64-byte hex`);return new C(U(r.slice(0,64)),U(r.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!=typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:n,s:r}=function(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${N(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:n}=T(e.subarray(2)),{data:r,left:i}=T(n);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${N(i)}`);return{r:t,s:r}}(t?e:M(e));return new C(n,r)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!Z(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Z(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=l.n>>o;return this.s>e}normalizeS(){return this.hasHighS()?new C(this.r,$(-this.s,l.n)):this}toDERRawBytes(){return M(this.toDERHex())}toDERHex(){const e=I(O(this.s)),t=I(O(this.r)),n=e.length/2,r=t.length/2,i=O(n),s=O(r);return`30${O(r+n+4)}02${s}${t}02${i}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return M(this.toCompactHex())}toCompactHex(){return D(this.r)+D(this.s)}}function P(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}const k=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function N(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let n=0;n<e.length;n++)t+=k[e[n]];return t}const x=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function D(e){if("bigint"!=typeof e)throw new Error("Expected bigint");if(!(s<=e&&e<x))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function L(e){const t=M(D(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function O(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function U(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function M(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,i=e.slice(r,r+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function B(e){return U(N(e))}function z(e){return e instanceof Uint8Array?Uint8Array.from(e):M(e)}function V(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==typeof e&&Z(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function $(e,t=l.P){const n=e%t;return n>=s?n:t+n}function F(e,t){const{P:n}=l;let r=e;for(;t-- >s;)r*=r,r%=n;return r}function j(e,t=l.P){if(e===s||t<=s)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=$(e,t),r=t,i=s,a=o,c=o,u=s;for(;n!==s;){const e=r/n,t=r%n,s=i-c*e,o=a-u*e;r=n,n=t,i=c,a=u,c=s,u=o}if(r!==o)throw new Error("invert: does not exist");return $(i,t)}function K(e,t=!1){const n=function(e){const t=8*e.length-8*p,n=B(e);return t>0?n>>BigInt(t):n}(e);if(t)return n;const{n:r}=l;return n>=r?n-r:n}let q,H;class G{constructor(e,t){if(this.hashLen=e,this.qByteLen=t,"number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return he.hmacSha256(this.k,...e)}hmacSync(...e){return H(this.k,...e)}checkSync(){if("function"!=typeof H)throw new E("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0;const t=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);const n=this.v.slice();t.push(n),e+=this.v.length}return P(...t)}generateSync(){this.checkSync(),this.incr();let e=0;const t=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);const n=this.v.slice();t.push(n),e+=this.v.length}return P(...t)}}function Z(e){return s<e&&e<l.n}function W(e){return s<e&&e<l.P}function Q(e,t,n,r=!0){const{n:i}=l,a=K(e,!0);if(!Z(a))return;const c=j(a,i),u=A.BASE.multiply(a),h=$(u.x,i);if(h===s)return;const d=$(c*$(t+n*h,i),i);if(d===s)return;let f=new C(h,d),p=(u.x===f.r?0:2)|Number(u.y&o);return r&&f.hasHighS()&&(f=f.normalizeS(),p^=1),{sig:f,recovery:p}}function Y(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"==typeof e){if(e.length!==2*p)throw new Error("Expected 32 bytes of private key");t=U(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==p)throw new Error("Expected 32 bytes of private key");t=B(e)}if(!Z(t))throw new Error("Expected private key: 0 < key < n");return t}function J(e){return e instanceof A?(e.assertValidity(),e):A.fromHex(e)}function X(e){if(e instanceof C)return e.assertValidity(),e;try{return C.fromDER(e)}catch(t){return C.fromCompact(e)}}function ee(e,t=!1){return A.fromPrivateKey(e).toRawBytes(t)}function te(e){return B(e.length>f?e.slice(0,f):e)}function ne(e){const t=te(e),n=$(t,l.n);return re(n<s?t:n)}function re(e){return L(e)}function ie(e,t,n){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const r=z(e),i=Y(t),s=[re(i),ne(r)];if(null!=n){!0===n&&(n=he.randomBytes(f));const e=z(n);if(e.length!==f)throw new Error(`sign: Expected ${f} bytes of extra data`);s.push(e)}return{seed:P(...s),m:te(r),d:i}}function se(e,t){const{sig:n,recovery:r}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),o=i?n.toDERRawBytes():n.toCompactRawBytes();return s?[o,r]:o}async function oe(e,t,n={}){const{seed:r,m:i,d:s}=ie(e,t,n.extraEntropy),o=new G(y,p);let a;for(await o.reseed(r);!(a=Q(await o.generate(),i,s,n.canonical));)await o.reseed();return se(a,n)}const ae={strict:!0};function ce(e,t,n,r=ae){let i;try{i=X(e),t=z(t)}catch(e){return!1}const{r:s,s:o}=i;if(r.strict&&i.hasHighS())return!1;const a=K(t);let c;try{c=J(n)}catch(e){return!1}const{n:u}=l,h=j(o,u),d=$(a*h,u),f=$(s*h,u),p=A.BASE.multiplyAndAddUnsafe(c,d,f);if(!p)return!1;return $(p.x,u)===s}A.BASE._setWindowSize(8);const ue={node:r||(r=n.t(i,2)),web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},le={},he={bytesToHex:N,hexToBytes:M,concatBytes:P,mod:$,invert:j,isValidPrivateKey(e){try{return Y(e),!0}catch(e){return!1}},_bigintTo32Bytes:L,_normalizePrivateKey:Y,hashToPrivateKey:e=>{e=z(e);const t=p+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return L($(B(e),l.n-o)+o)},randomBytes:(e=32)=>{if(ue.web)return ue.web.getRandomValues(new Uint8Array(e));if(ue.node){const{randomBytes:t}=ue.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>he.hashToPrivateKey(he.randomBytes(p+8)),precompute(e=8,t=A.BASE){const n=t===A.BASE?t:new A(t.x,t.y);return n._setWindowSize(e),n.multiply(c),n},sha256:async(...e)=>{if(ue.web){const t=await ue.web.subtle.digest("SHA-256",P(...e));return new Uint8Array(t)}if(ue.node){const{createHash:t}=ue.node,n=t("sha256");return e.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ue.web){const n=await ue.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=P(...t),i=await ue.web.subtle.sign("HMAC",n,r);return new Uint8Array(i)}if(ue.node){const{createHmac:n}=ue.node,r=n("sha256",e);return t.forEach((e=>r.update(e))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let n=le[e];if(void 0===n){const t=await he.sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=P(t,t),le[e]=n}return he.sha256(n,...t)},taggedHashSync:(e,...t)=>{if("function"!=typeof q)throw new E("sha256Sync is undefined, you need to set it");let n=le[e];if(void 0===n){const t=q(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=P(t,t),le[e]=n}return q(n,...t)},_JacobianPoint:_};Object.defineProperties(he,{sha256Sync:{configurable:!1,get:()=>q,set(e){q||(q=e)}},hmacSha256Sync:{configurable:!1,get:()=>H,set(e){H||(H=e)}}})},14205:function(e,t,n){"use strict";async function*r(e,t=1){let n=[];t<1&&(t=1);for await(const r of e)for(n.push(r);n.length>=t;)yield n.slice(0,t),n=n.slice(t);for(;n.length>0;)yield n.slice(0,t),n=n.slice(t)}n.d(t,{Z:function(){return r}})},90903:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},93361:function(e,t,n){"use strict";async function r(e){for await(const t of e);}n.d(t,{Z:function(){return r}})},44752:function(e,t,n){"use strict";async function*r(e,t){for await(const n of e)await t(n)&&(yield n)}n.d(t,{Z:function(){return r}})},91486:function(e,t,n){"use strict";async function r(e){for await(const t of e)return t}n.d(t,{Z:function(){return r}})},51816:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(93489),i=n(37430),s=n(85275);function o(e){const t=(0,i.d)(),n=(0,r.r)(e.source),o=(0,s.Z)();let a;const c=e.sink(async function*(){yield*t;const e=await o.promise;yield*e}());c.catch((e=>{a=e}));return{reader:n,writer:t,stream:{sink:async e=>null!=a?await Promise.reject(a):(o.resolve(e),await c),source:n},rest:()=>t.end(),write:t.push,read:async()=>{const e=await n.next();if(null!=e.value)return e.value}}}},68883:function(e,t,n){"use strict";async function r(e){let t;for await(const n of e)t=n;return t}n.d(t,{Z:function(){return r}})},36638:function(e,t,n){"use strict";n.d(t,{p:function(){return y}});var r=n(85275),i=n(90903);class s extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function o(e,t){let n,o,a,c=(t=t??{}).onEnd,u=new i.u,l=(0,r.Z)();const h=e=>null!=o?o(e):(u.push(e),n),d=e=>{if(a)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return h({done:!1,value:e})},f=e=>a?n:(a=!0,null!=e?(e=>(u=new i.u,null!=o?o({error:e}):(u.push({error:e}),n)))(e):h({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return u.isEmpty()?a?{done:!0}:await new Promise(((t,r)=>{o=i=>{o=null,u.push(i);try{t(e(u))}catch(e){r(e)}return n}})):e(u)}finally{u.isEmpty()&&queueMicrotask((()=>{l.resolve(),l=(0,r.Z)()}))}},return:()=>(u=new i.u,f(),{done:!0}),throw:e=>(f(e),{done:!0}),push:d,end:f,get readableLength(){return u.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),u.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new s)},t.addEventListener("abort",r)})));try{await Promise.race([l.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==c)return n;const p=n;return n={[Symbol.asyncIterator](){return this},next:()=>p.next(),throw:e=>(p.throw(e),null!=c&&(c(e),c=void 0),{done:!0}),return:()=>(p.return(),null!=c&&(c(),c=void 0),{done:!0}),push:d,end:e=>(p.end(e),null!=c&&(c(e),c=void 0),n),get readableLength(){return p.readableLength}},n}var a=n(62308);class c extends Error{code;constructor(e,t){super(e),this.code=t}}class u extends c{type;constructor(e){super(e,"ABORT_ERR"),this.type="aborted"}}function l(e){const t=function(e={}){return o((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}();e.sink(t).catch((e=>{t.end(e)})),e.sink=async e=>{for await(const n of e)t.push(n);t.end()};let n=e.source;null!=e.source[Symbol.iterator]?n=e.source[Symbol.iterator]():null!=e.source[Symbol.asyncIterator]&&(n=e.source[Symbol.asyncIterator]());const r=new a.H;return{read:async(e,t)=>{let i;t?.signal?.throwIfAborted();const s=new Promise(((e,n)=>{i=()=>{n(new u("Read aborted"))},t?.signal?.addEventListener("abort",i)}));try{if(null==e){const{done:e,value:t}=await Promise.race([n.next(),s]);return!0===e?new a.H:t}for(;r.byteLength<e;){const{value:e,done:t}=await Promise.race([n.next(),s]);if(!0===t)throw new c("unexpected end of input","ERR_UNEXPECTED_EOF");r.append(e)}const t=r.sublist(0,e);return r.consume(e),t}finally{null!=i&&t?.signal?.removeEventListener("abort",i)}},write:async(e,n)=>{n?.signal?.throwIfAborted(),e instanceof Uint8Array?t.push(e):t.push(e.subarray()),await t.onEmpty(n)},unwrap:()=>{const t=e.source;return e.source=async function*(){yield*r,yield*t}(),e}}}var h=n(91893),d=n(57050);class f extends Error{code;constructor(e,t){super(e),this.code=t}}const p=e=>d.Jx(e);function y(e,t){const n=l(e);return{read:async e=>{let r=-1;const i=new a.H,s=t?.lengthDecoder??p;for(;;){i.append(await n.read(1,e));try{r=s(i)}catch(e){if(e instanceof RangeError)continue;throw e}if(r>-1)break;if(null!=t?.maxLengthLength&&i.byteLength>t.maxLengthLength)throw new f("message length length too long","ERR_MSG_LENGTH_TOO_LONG")}if(null!=t?.maxDataLength&&r>t.maxDataLength)throw new f("message length too long","ERR_MSG_DATA_TOO_LONG");return n.read(r,e)},write:async(e,r)=>{await n.write(h.c.single(e,t),r)},unwrap:()=>n.unwrap()}}p.bytes=0},91893:function(e,t,n){"use strict";n.d(t,{J:function(){return p},c:function(){return c}});var r=n(57050),i=n(62308),s=n(66574),o=n(35946);const a=e=>{const t=r.P$(e),n=(0,s.E)(t);return r.cv(e,n),a.bytes=t,n};function c(e,t){const n=(t=t??{}).lengthEncoder??a;function*r(e){const t=n(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return(0,o.D)(e)?async function*(){for await(const t of e)yield*r(t)}():function*(){for(const t of e)yield*r(t)}()}a.bytes=0,c.single=(e,t)=>{const n=(t=t??{}).lengthEncoder??a;return new i.H(n(e.byteLength),e)};var u=n(32114);const l=8,h=4194304;var d;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(d||(d={}));const f=e=>{const t=r.Jx(e);return f.bytes=r.P$(t),t};function p(e,t){const n=new i.H;let r=d.LENGTH,s=-1;const a=t?.lengthDecoder??f,c=t?.maxLengthLength??l,p=t?.maxDataLength??h;function*y(){for(;n.byteLength>0;){if(r===d.LENGTH)try{if(s=a(n),s<0)throw u(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>p)throw u(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=a.bytes;n.consume(e),null!=t?.onLength&&t.onLength(s),r=d.DATA}catch(e){if(e instanceof RangeError){if(n.byteLength>c)throw u(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(r===d.DATA){if(n.byteLength<s)break;const e=n.sublist(0,s);n.consume(s),null!=t?.onData&&t.onData(e),yield e,r=d.LENGTH}}}return(0,o.D)(e)?async function*(){for await(const t of e)n.append(t),yield*y();if(n.byteLength>0)throw u(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)n.append(t),yield*y();if(n.byteLength>0)throw u(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}f.bytes=0,p.fromReader=(e,t)=>{let n=1;return p(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(e){if("ERR_UNDER_READ"===e.code)return{done:!0,value:null};throw e}finally{n=1}}(),{...t??{},onLength:e=>{n=e}})}},95918:function(e,t,n){"use strict";async function r(e){let t=0;for await(const n of e)t++;return t}n.d(t,{Z:function(){return r}})},21007:function(e,t,n){"use strict";async function*r(e,t){for await(const n of e)yield t(n)}n.d(t,{Z:function(){return r}})},52019:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(37430);async function*i(...e){const t=(0,r.d)({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const n of e)t.push(n)}))),t.end()}catch(e){t.end(e)}})),yield*t}},83204:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var r=n(85275);function i(){const e=(0,r.Z)();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}function s(){const e=i(),t=i();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}},67389:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(14205);async function*i(e,t=1){for await(const n of(0,r.Z)(e,t)){const e=n.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const n=await e[t];if(!n.ok)throw n.err;yield n.value}}}},69849:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(85275);const i=globalThis.CustomEvent??Event;async function*s(e,t={}){let n=t.concurrency??1/0;n<1&&(n=1/0);const s=null!=t.ordered&&t.ordered,o=new EventTarget,a=[];let c,u=(0,r.Z)(),l=(0,r.Z)(),h=!1,d=!1;function f(){return s?a[0]?.done:Boolean(a.find((e=>e.done)))}function*p(){for(;a.length>0&&a[0].done;){const e=a[0];if(a.shift(),!e.ok)throw d=!0,u.resolve(),e.err;yield e.value,u.resolve()}}function*y(){for(;f();)for(let e=0;e<a.length;e++)if(a[e].done){const t=a[e];if(a.splice(e,1),e--,!t.ok)throw d=!0,u.resolve(),t.err;yield t.value,u.resolve()}}for(o.addEventListener("task-complete",(()=>{l.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(a.length===n&&(u=(0,r.Z)(),await u.promise),d)break;const e={done:!1};a.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,o.dispatchEvent(new i("task-complete"))}),(t=>{e.done=!0,e.err=t,o.dispatchEvent(new i("task-complete"))}))}h=!0,o.dispatchEvent(new i("task-complete"))}catch(e){c=e,o.dispatchEvent(new i("task-complete"))}}));;){if(f()||(l=(0,r.Z)(),await l.promise),null!=c)throw c;if(s?yield*p():yield*y(),h&&0===a.length)break}}},85809:function(e,t,n){"use strict";n.d(t,{z:function(){return A}});var r=n(51816),i=n(62308),s=n(72004),o=n(66574);const a=Math.pow(2,7),c=Math.pow(2,14),u=Math.pow(2,21),l=Math.pow(2,28),h=Math.pow(2,35),d=Math.pow(2,42),f=Math.pow(2,49),p=Math.pow(2,56),y=Math.pow(2,63),g={encodingLength:e=>e<a?1:e<c?2:e<u?3:e<l?4:e<h?5:e<d?6:e<f?7:e<p?8:e<y?9:10,encode(e,t,n=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=(0,o.E)(g.encodingLength(e))),s.Z.fromNumber(e).toBytes(t,n),t},decode:(e,t=0)=>s.Z.fromBytes(e,t).toNumber(!0)};const m=e=>{const t=g.encodingLength(e),n=(r=t,null!=globalThis?.Buffer?.allocUnsafe?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r));var r;return g.encode(e,n),m.bytes=t,n};function w(e){const t=(e=e??{}).lengthEncoder??m;return async function*(e){for await(const n of e){const e=t(n.byteLength);e instanceof Uint8Array?yield e:yield*e,n instanceof Uint8Array?yield n:yield*n}}}m.bytes=0,w.single=(e,t)=>{const n=(t=t??{}).lengthEncoder??m;return new i.H(n(e.byteLength),e)};var b=n(32114);const E=8,v=4194304;var _;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(_||(_={}));const S=e=>{const t=g.decode(e);return S.bytes=g.encodingLength(t),t};function R(e){return async function*(t){const n=new i.H;let r=_.LENGTH,s=-1;const o=e?.lengthDecoder??S,a=e?.maxLengthLength??E,c=e?.maxDataLength??v;for await(const i of t)for(n.append(i);n.byteLength>0;){if(r===_.LENGTH)try{if(s=o(n),s<0)throw b(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>c)throw b(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const t=o.bytes;n.consume(t),null!=e?.onLength&&e.onLength(s),r=_.DATA}catch(e){if(e instanceof RangeError){if(n.byteLength>a)throw b(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(r===_.DATA){if(n.byteLength<s)break;const t=n.sublist(0,s);n.consume(s),null!=e?.onData&&e.onData(t),yield t,r=_.LENGTH}}if(n.byteLength>0)throw b(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}function A(e,t={}){const n=(0,r.Y)(e),i=R.fromReader(n.reader,t),s={read:async e=>{const{value:t}=await n.reader.next(e);if(null==t)throw new Error("Value is null");return t},readLP:async()=>{const{value:e}=await i.next();if(null==e)throw new Error("Value is null");return e},readPB:async e=>{const t=await s.readLP();if(null==t)throw new Error("Value is null");const n=t instanceof Uint8Array?t:t.subarray();return e.decode(n)},write:e=>{e instanceof Uint8Array?n.writer.push(e):n.writer.push(e.subarray())},writeLP:e=>{s.write(w.single(e,t))},writePB:(e,t)=>{s.writeLP(t.encode(e))},pb:e=>({read:async()=>await s.readPB(e),write:t=>{s.writePB(t,e)},unwrap:()=>s}),unwrap:()=>(n.rest(),e.source=n.stream.source,e.sink=n.stream.sink,e)};return s}S.bytes=0,R.fromReader=(e,t)=>{let n=1;const r=async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(e){if("ERR_UNDER_READ"===e.code)return{done:!0,value:null};throw e}finally{n=1}}();return R({...t??{},onLength:e=>{n=e}})(r)}},75671:function(e,t){"use strict";t.Z=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}}},90212:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(85275),i=n(49698);class s extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function o(e={}){return a((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function a(e,t){let n,o,a,c=(t=t??{}).onEnd,u=new i.u,l=(0,r.Z)();const h=e=>null!=o?o(e):(u.push(e),n),d=e=>{if(a)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return h({done:!1,value:e})},f=e=>a?n:(a=!0,null!=e?(e=>(u=new i.u,null!=o?o({error:e}):(u.push({error:e}),n)))(e):h({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return u.isEmpty()?a?{done:!0}:await new Promise(((t,r)=>{o=i=>{o=null,u.push(i);try{t(e(u))}catch(e){r(e)}return n}})):e(u)}finally{u.isEmpty()&&queueMicrotask((()=>{l.resolve(),l=(0,r.Z)()}))}},return:()=>(u=new i.u,f(),{done:!0}),throw:e=>(f(e),{done:!0}),push:d,end:f,get readableLength(){return u.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),u.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new s)},t.addEventListener("abort",r)})));try{await Promise.race([l.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==c)return n;const p=n;return n={[Symbol.asyncIterator](){return this},next:()=>p.next(),throw:e=>(p.throw(e),null!=c&&(c(e),c=void 0),{done:!0}),return:()=>(p.return(),null!=c&&(c(),c=void 0),{done:!0}),push:d,end:e=>(p.end(e),null!=c&&(c(e),c=void 0),n),get readableLength(){return p.readableLength}},n}var c=function(...e){const t=[];for(const n of e)null==n[Symbol.asyncIterator]&&t.push(n);return t.length===e.length?function*(){for(const e of t)yield*e}():async function*(){const t=o({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const n of e)t.push(n)}))),t.end()}catch(e){t.end(e)}})),yield*t}()};function u(e,...t){if(null==e)throw new Error("Empty pipeline");if(f(e)){const t=e;e=()=>t.source}else if(d(e)||h(e)){const t=e;e=()=>t}const n=[e,...t];if(n.length>1&&f(n[n.length-1])&&(n[n.length-1]=n[n.length-1].sink),n.length>2)for(let e=1;e<n.length-1;e++)f(n[e])&&(n[e]=p(n[e]));return l(...n)}const l=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},h=e=>null!=e?.[Symbol.asyncIterator],d=e=>null!=e?.[Symbol.iterator],f=e=>null!=e&&(null!=e.sink&&null!=e.source),p=e=>t=>{const n=e.sink(t);if(null!=n?.then){const t=o({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(h(i))r=async function*(){yield*i,t.end()};else{if(!d(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return c(t,r())}return e.source}},49698:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},41455:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r=n(36638);function i(e,t){const n=(0,r.p)(e,t),i={read:async(e,t)=>{const r=await n.read(t);return e.decode(r)},write:async(e,t,r)=>{await n.write(t.encode(e),r)},pb:e=>({read:async t=>i.read(e,t),write:async(t,n)=>i.write(t,e,n),unwrap:()=>i}),unwrap:()=>n.unwrap()};return i}},37430:function(e,t,n){"use strict";n.d(t,{d:function(){return s},e:function(){return o}});class r{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function s(e={}){return a((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function o(e={}){return a((e=>{let t;const n=[];for(;!e.isEmpty()&&(t=e.shift(),null!=t);){if(null!=t.error)throw t.error;!1===t.done&&n.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:n}}),e)}function a(e,t){let n,r,s,o=(t=t??{}).onEnd,a=new i;const c=e=>null!=r?r(e):(a.push(e),n),u=e=>{if(s)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>s?n:(s=!0,null!=e?(e=>(a=new i,null!=r?r({error:e}):(a.push({error:e}),n)))(e):c({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>a.isEmpty()?s?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,a.push(s);try{t(e(a))}catch(e){i(e)}return n}})):e(a),return:()=>(a=new i,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return a.size}},null==o)return n;const h=n;return n={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(h.return(),null!=o&&(o(),o=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=o&&(o(e),o=void 0),n),get readableLength(){return h.readableLength}},n}},93489:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var r=n(62308);function i(e){const t=async function*(){let t=yield,n=new r.H;for await(const i of e)if(null!=t)for(n.append(i);n.length>=t;){const e=n.sublist(0,t);if(n.consume(t),t=yield e,null==t){n.length>0&&(t=yield n,n=new r.H);break}}else n.append(i),t=yield n,n=new r.H;if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return t.next(),t}},34751:function(e,t,n){"use strict";async function*r(e,t){const n=await async function(e){const t=[];for await(const n of e)t.push(n);return t}(e);yield*n.sort(t)}n.d(t,{Z:function(){return r}})},56635:function(e,t,n){"use strict";async function*r(e,t){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}n.d(t,{Z:function(){return r}})},95105:function(e,t,n){"use strict";n.d(t,{P:function(){return N}});var r=n(62308),i=n(49784),s=n(77408);"0".charCodeAt(0),(0,s.m)("ustar\0","binary"),(0,s.m)("ustar ","binary"),(0,s.m)(" \0","binary");n(93489);var o=n(71993),a=n(17833);const c="0".charCodeAt(0),u=(0,s.m)("ustar\0","binary"),l=(0,s.m)("00","binary"),h=parseInt("7777",8),d=257,f=263,p=function(e){switch(e){case"file":default:return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}},y=function(e){let t=256;for(let n=0;n<148;n++)t+=e[n];for(let n=156;n<512;n++)t+=e[n];return t},g=function(e,t){const n=e.toString(8);return n.length>t?(0,s.m)("7777777777777777777".slice(0,t)+" "):(0,s.m)("0000000000000000000".slice(0,t-n.length)+n+" ")},m=function(e){const t=(0,s.m)(e).byteLength;let n=Math.floor(Math.log(t)/Math.log(10))+1;return t+n>=Math.pow(10,n)&&n++,`${t+n}${e}`};function w(e){const t=new Uint8Array(512);let n=e.name,r="";if(5===e.typeflag&&"/"!==n[n.length-1]&&(n+="/"),(0,s.m)(n).byteLength!==n.length)return null;for(;(0,s.m)(n).byteLength>100;){const e=n.indexOf("/");if(-1===e)return null;r+=""!==r?"/"+n.slice(0,e):n.slice(0,e),n=n.slice(e+1)}return(0,s.m)(n).byteLength>100||(0,s.m)(r).byteLength>155||null!=e.linkname&&(0,s.m)(e.linkname).byteLength>100?null:(t.set((0,s.m)(n),0),t.set(g(e.mode&h,6),100),t.set(g(e.uid,6),108),t.set(g(e.gid,6),116),t.set(g(e.size,11),124),t.set(g(e.mtime.getTime()/1e3|0,11),136),t[156]=c+p(e.type),null!=e.linkname&&t.set((0,s.m)(e.linkname),157),t.set(u,d),t.set(l,f),null!=e.uname&&t.set((0,s.m)(e.uname),265),null!=e.gname&&t.set((0,s.m)(e.gname),297),t.set(g(e.devmajor??0,6),329),t.set(g(e.devminor??0,6),337),null!=r&&t.set((0,s.m)(r),345),t.set(g(y(t),6),148),t)}const{S_IFMT:b,S_IFBLK:E,S_IFCHR:v,S_IFDIR:_,S_IFIFO:S,S_IFLNK:R}=o,A=parseInt("755",8),I=parseInt("644",8),T=new Uint8Array(1024);function C(e=0){switch(e&b){case E:return"block-device";case v:return"character-device";case _:return"directory";case S:return"fifo";case R:return"symlink";default:return"file"}}function P(e){return 0!==(e&=511)?T.subarray(0,512-e):new Uint8Array(0)}function k(e){if(null==e.pax){const t=w(e);if(null!=t)return t}return function(e){const t=function(e){let t="";null!=e.name&&(t+=m(" path="+e.name+"\n")),null!=e.linkname&&(t+=m(" linkpath="+e.linkname+"\n"));const n=e.pax;if(null!=n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t+=m(" "+e+"="+n[e]+"\n"));return(0,s.m)(t)}(e),n={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new r.H(w(n)??new Uint8Array(0),t,P(t.length),w({...n,size:e.size,type:e.type})??new Uint8Array(0)).subarray()}(e)}function N(){return async function*(e){for await(let{header:t,body:n}of e){const e={...t,size:"symlink"===t.type?0:t.size??0,type:t.type??C(t.mode),mode:t.mode??("directory"===t.type?A:I),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if("string"==typeof n&&(n=(0,s.m)(n)),n instanceof Uint8Array||(0,r.Z)(n)){e.size=n.length,yield k(e),yield(0,r.Z)(n)?n.subarray():n,yield P(e.size);continue}if("symlink"===e.type&&null==e.linkname){if(null==n)throw new Error("type was symlink but no linkname or body specified");e.linkname=(0,i.B)(await(0,a.Z)(n)),yield k(e);continue}if(yield k(e),"file"!==e.type&&"contiguous-file"!==e.type)continue;let o=0;for await(const e of n??[])o+=e.length,yield(0,r.Z)(e)?e.subarray():e;if(o!==e.size)throw new Error(`size mismatch, wrote ${o} of ${e.size} bytes`);yield P(e.size)}yield T}}},17833:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(41690);async function i(e){let t=new Uint8Array(0);for await(const n of e)t=(0,r.z)([t,n],t.length+n.length);return t}},51723:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=async e=>{if(e.readyState>=2)throw new Error("socket closed");1!==e.readyState&&await new Promise(((t,n)=>{function r(){e.removeEventListener("open",i),e.removeEventListener("error",s)}function i(){r(),t()}function s(t){r(),n(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",i),e.addEventListener("error",s)}))},i=(e,t)=>{(t=t??{}).closeOnEnd=!1!==t.closeOnEnd;return async n=>{for await(const t of n){try{await r(e)}catch(e){if("socket closed"===e.message)break;throw e}if(e.readyState===e.CLOSING||e.readyState===e.CLOSED)break;e.send(t)}null!=t.closeOnEnd&&e.readyState<=1&&await new Promise(((t,n)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});n(t)}})),setTimeout((()=>{e.close()}))}))}}},89546:function(e,t,n){"use strict";n.d(t,{Ue:function(){return $n}});var r=n(51392),i=n(52890),s=n(55101),o=n(33808),a=n(90560),c=n(10993),u=n(84296),l=n(38566),h=n(93387),d=n(38161),f=n(91026),p=n(106),y=n(90072),g=n(69860),m=n(67137),w=n(79221),b=n(63181),E=n(97295);const v=(0,g.kg)("js-kubo-rpc-client:lib:error-handler"),_=w.Z.bind({ignoreUndefined:!0}),S=p.isBrowser||p.isWebWorker?location.protocol:"http",R=p.isBrowser||p.isWebWorker?location.hostname:"localhost",A=p.isBrowser||p.isWebWorker?location.port:"5001",I=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const n=await e.json();v(n),t=n.Message||n.message}else t=await e.text()}catch(e){v("Failed to parse error response",e),t=e.message}let n=new m.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(n=new m.TimeoutError),t&&t.includes("context deadline exceeded")&&(n=new m.TimeoutError)),t&&t.includes("request timed out")&&(n=new m.TimeoutError),t&&(n.message=t),n},T=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,C=e=>e.replace(T,(function(e){return"-"+e.toLowerCase()}));class P extends m{constructor(e={}){const t=((e={})=>{let t,n,r={};if("string"==typeof e||(0,f.h2)(e))t=new URL((0,b.d)(e));else if(e instanceof URL)t=e;else if("string"==typeof e.url||(0,f.h2)(e.url))t=new URL((0,b.d)(e.url)),r=e;else if(e.url instanceof URL)t=e.url,r=e;else{r=e||{};const n=(r.protocol||S).replace(":",""),i=(r.host||R).split(":")[0],s=r.port||A;t=new URL(`${n}://${i}:${s}`)}if(r.apiPath?t.pathname=r.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),p.isNode){const e=(0,E.Z)(t);n=r.agent||new e({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:n}})(e);var n;super({timeout:(n=t.timeout||0,("string"==typeof n?(0,y.Z)(n):n)||void 0),headers:t.headers,base:`${t.url}`,handleError:I,transformSearchParams:e=>{const t=new URLSearchParams;for(const[n,r]of e)"undefined"!==r&&"null"!==r&&"signal"!==n&&t.append(C(n),r),"timeout"!==n||isNaN(r)||t.append(C(n),r);return t},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const r=this.fetch;this.fetch=(e,n={})=>("string"!=typeof e||e.startsWith("/")||(e=`${t.url}/${e}`),r.call(this,e,_(n,{method:"POST"})))}}m.HTTPError;const k=e=>t=>e(new P(t),t);function N(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}var x=n(32114);function D(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const n=e.getTime(),r=Math.floor(n/1e3);t={secs:r,nsecs:1e3*(n-1e3*r)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw x(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function L({arg:e,searchParams:t,hashAlg:n,mtime:r,mode:i,...s}={}){t&&(s={...s,...t}),n&&(s.hash=n),null!=r&&(r=D(r),s.mtime=r.secs,s.mtimeNsecs=r.nsecs),null!=i&&(s.mode=N(i)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),null==e?e=[]:Array.isArray(e)||(e=[e]);const o=new URLSearchParams(s);return e.forEach((e=>o.append("arg",e))),o}const O=k((e=>async function(t={}){return((await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:L(t),headers:t.headers})).json()).Keys||[]).map((e=>d.k0.parse(e["/"])))})),U=k((e=>async function(t,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:L({...n,peer:t.toString()}),headers:n.headers})).json()).Keys||[]).map((e=>d.k0.parse(e["/"])))}));var M=n(23366);const B=k((e=>async function(t={}){const n=await e.post("bitswap/stat",{searchParams:L(t),signal:t.signal,headers:t.headers});return function(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((e=>d.k0.parse(e["/"]))),peers:(e.Peers||[]).map((e=>(0,M.jE)(e))),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}(await n.json())}));const z=k((e=>async function(t,n={}){const r=await e.post("block/get",{signal:n.signal,searchParams:L({arg:t.toString(),...n}),headers:n.headers});return new Uint8Array(await r.arrayBuffer())}));var V=n(47498),$=n(32044);function F(...e){return(0,$.anySignal)(function(e){return e.filter(Boolean)}(e))}const j=k(((e,t)=>async function t(n,r={}){const i=new AbortController,s=F(i.signal,r.signal);let o;try{const t=await e.post("block/put",{signal:s,searchParams:L(r),...await(0,V.x)([n],i,r.headers)});o=await t.json()}catch(e){if("dag-pb"===r.format)return t(n,{...r,format:"protobuf"});if("dag-cbor"===r.format)return t(n,{...r,format:"cbor"});throw e}return d.k0.parse(o.Key)})),K=k((e=>async function*(t,n={}){Array.isArray(t)||(t=[t]);const r=await e.post("block/rm",{signal:n.signal,searchParams:L({arg:t.map((e=>e.toString())),"stream-channels":!0,...n}),headers:n.headers});for await(const e of r.ndjson())yield q(e)}));function q(e){const t={cid:d.k0.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const H=k((e=>async function(t,n={}){const r=await e.post("block/stat",{signal:n.signal,searchParams:L({arg:t.toString(),...n}),headers:n.headers}),i=await r.json();return{cid:d.k0.parse(i.Key),size:i.Size}}));function G(e){return{get:z(e),put:j(e),rm:K(e),stat:H(e)}}const Z=k((e=>async function(t,n={}){const r=await e.post("bootstrap/add",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),{Peers:i}=await r.json();return{Peers:i.map((e=>(0,f.HM)(e)))}})),W=k((e=>async function(t={}){const n=await e.post("bootstrap/list",{signal:t.signal,searchParams:L(t),headers:t.headers}),{Peers:r}=await n.json();return{Peers:r.map((e=>(0,f.HM)(e)))}})),Q=k((e=>async function(t,n={}){const r=await e.post("bootstrap/rm",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),{Peers:i}=await r.json();return{Peers:i.map((e=>(0,f.HM)(e)))}}));function Y(e){return{add:Z(e),list:W(e),rm:Q(e)}}const J=k((e=>async function(t,n={}){const r=await e.post("config/profile/apply",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),i=await r.json();return{original:i.OldCfg,updated:i.NewCfg}}));function X(e){return{apply:J(e)}}const ee=k((e=>async(t,n={})=>{if(!t)throw new Error("key argument is required");const r=await e.post("config",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});return(await r.json()).Value})),te=k((e=>async(t={})=>{const n=await e.post("config/show",{signal:t.signal,searchParams:L({...t}),headers:t.headers});return await n.json()}));var ne=n(77408);const re=k((e=>async(t,n={})=>{const r=new AbortController,i=F(r.signal,n.signal),s=await e.post("config/replace",{signal:i,searchParams:L(n),...await(0,V.x)([(0,ne.m)(JSON.stringify(t))],r,n.headers)});await s.text()})),ie=k((e=>async(t,n,r={})=>{if("string"!=typeof t)throw new Error("Invalid key type");const i={...r,...se(t,n)},s=await e.post("config",{signal:r.signal,searchParams:L(i),headers:r.headers});await s.text()})),se=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function oe(e){return{getAll:te(e),get:ee(e),set:ie(e),replace:re(e),profiles:X(e)}}const ae=k((e=>async function*(t,n={}){const r=await e.post("dag/export",{signal:n.signal,searchParams:L({arg:t.toString()}),headers:n.headers});yield*r.iterator()}));async function*ce(e,t,n,r,i){const s=async e=>{const t=await n.getCodec(e.code),s=await r(e,i);return t.decode(s)},o=t.split("/").filter(Boolean);let a=await s(e),c=e;for(;o.length;){const e=o.shift();if(!e)throw x(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw x(new Error(`no link named "${e}" under ${c}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:o.join("/")};const n=d.k0.asCID(a);n&&(c=n,a=await s(a))}yield{value:a,remainderPath:""}}var ue=n(91486),le=n(68883);const he=(e,t)=>{const n=k(((t,n)=>{const r=z(n);return async(t,n={})=>{if(n.path){const i=n.localResolve?await(0,ue.Z)(ce(t,n.path,e,r,n)):await(0,le.Z)(ce(t,n.path,e,r,n));if(!i)throw x(new Error("Not found"),"ERR_NOT_FOUND");return i}const i=await e.getCodec(t.code),s=await r(t,n);return{value:i.decode(s),remainderPath:""}}}));return n(t)},de=k((e=>async function*(t,n={}){const r=new AbortController,i=F(r.signal,n.signal),{headers:s,body:o}=await(0,V.x)(t,r,n.headers),a=await e.post("dag/import",{signal:i,headers:s,body:o,searchParams:L({"pin-roots":n.pinRoots})});for await(const{Root:e}of a.ndjson())if(void 0!==e){const{Cid:{"/":t},PinErrorMsg:n}=e;yield{root:{cid:d.k0.parse(t),pinErrorMsg:n}}}})),fe=(e,t)=>{const n=k((t=>async(n,r={})=>{const i={storeCodec:"dag-cbor",hashAlg:"sha2-256",...r};let s;if(i.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");s=n}else{s=(await e.getCodec(i.storeCodec)).encode(n),i.inputCodec=i.storeCodec}const o=new AbortController,a=F(o.signal,i.signal),c=await t.post("dag/put",{timeout:i.timeout,signal:a,searchParams:L(i),...await(0,V.x)([s],o,i.headers)}),u=await c.json();return d.k0.parse(u.Cid["/"])}));return n(t)},pe=k((e=>async(t,n={})=>{const r=await e.post("dag/resolve",{signal:n.signal,searchParams:L({arg:`${t}${n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers}),i=await r.json();return{cid:d.k0.parse(i.Cid["/"]),remainderPath:i.RemPath}}));function ye(e,t){return{export:ae(t),get:he(e,t),import:de(t),put:fe(e,t),resolve:pe(t)}}const ge=e=>{if(0===e.Type)return{name:"SENDING_QUERY",type:e.Type};if(1===e.Type)return{from:(0,M.jE)(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:(0,M.jE)(e),multiaddrs:t.map((e=>(0,f.HM)(e))),protocols:[]}))),providers:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:(0,M.jE)(e),multiaddrs:t.map((e=>(0,f.HM)(e))),protocols:[]})))};if(2===e.Type){let t={id:e.ID??(0,M.jE)(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:(0,M.jE)(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((e=>(0,f.HM)(e))),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(3===e.Type)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(4===e.Type)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((({ID:e,Addrs:t})=>({id:(0,M.jE)(e),multiaddrs:t.map((e=>(0,f.HM)(e))),protocols:[]})))};if(5===e.Type)return{name:"VALUE",type:e.Type,value:(0,ne.m)(e.Extra,"base64pad")};if(6===e.Type){const t=e.Responses.map((({ID:e})=>(0,M.jE)(e)));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(7===e.Type)return{name:"DIALING_PEER",type:e.Type,peer:(0,M.jE)(e.ID)};throw new Error("Unknown DHT event type")},me=k((e=>async function*(t,n={}){const r=await e.post("dht/findpeer",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});for await(const e of r.ndjson())yield ge(e)})),we=k((e=>async function*(t,n={}){const r=await e.post("dht/findprovs",{signal:n.signal,searchParams:L({arg:t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield ge(e)}));var be=n(49784);const Ee=k((e=>async function*(t,n={}){const r=await e.post("dht/get",{signal:n.signal,searchParams:L({arg:t instanceof Uint8Array?(0,be.B)(t):t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield ge(e)})),ve=k((e=>async function*(t,n={recursive:!1}){const r=Array.isArray(t)?t:[t],i=await e.post("dht/provide",{signal:n.signal,searchParams:L({arg:r.map((e=>e.toString())),...n}),headers:n.headers});for await(const e of i.ndjson())yield ge(e)})),_e=k((e=>async function*(t,n,r={}){const i=new AbortController,s=F(i.signal,r.signal),o=await e.post("dht/put",{signal:s,searchParams:L({arg:t instanceof Uint8Array?(0,be.B)(t):t.toString(),...r}),...await(0,V.x)([n],i,r.headers)});for await(const e of o.ndjson())yield ge(e)})),Se=k((e=>async function*(t,n={}){const r=await e.post("dht/query",{signal:n.signal,searchParams:L({arg:t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield ge(e)}));function Re(e){return{findPeer:me(e),findProvs:we(e),get:Ee(e),provide:ve(e),put:_e(e),query:Se(e)}}const Ae=k((e=>async function(t={}){return(await e.post("diag/cmds",{signal:t.signal,searchParams:L(t),headers:t.headers})).json()})),Ie=k((e=>async function(t={}){return(await e.post("diag/net",{signal:t.signal,searchParams:L(t),headers:t.headers})).json()})),Te=k((e=>async function(t={}){return(await e.post("diag/sys",{signal:t.signal,searchParams:L(t),headers:t.headers})).json()}));function Ce(e){return{cmds:Ae(e),net:Ie(e),sys:Te(e)}}const Pe=k((e=>async function(t,n,r={}){const i=Array.isArray(t)?t:[t],s=await e.post("files/cp",{signal:r.signal,searchParams:L({arg:i.concat(n).map((e=>d.k0.asCID(e)?`/ipfs/${e}`:e)),...r}),headers:r.headers});await s.text()})),ke=k((e=>async function(t,n={}){if(!t||"string"!=typeof t)throw new Error("ipfs.files.flush requires a path");const r=await e.post("files/flush",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),i=await r.json();return d.k0.parse(i.Cid)}));function Ne(e){if(null==e)return e;const t=/^[A-Z]+$/;return Object.keys(e).reduce(((n,r)=>(t.test(r)?n[r.toLowerCase()]=e[r]:t.test(r[0])?n[r[0].toLowerCase()+r.slice(1)]=e[r]:n[r]=e[r],n)),{})}function xe(e){const t=Ne(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const De=k((e=>async function*(t,n={}){if(!t)throw new Error("ipfs.files.ls requires a path");const r=await e.post("files/ls",{signal:n.signal,searchParams:L({arg:d.k0.asCID(t)?`/ipfs/${t}`:t,long:!0,...n,stream:!0}),headers:n.headers});for await(const e of r.ndjson())if("Entries"in e)for(const t of e.Entries||[])yield Le(xe(t));else yield Le(xe(e))}));function Le(e){return e.hash&&(e.cid=d.k0.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const Oe=k((e=>async function(t,n={}){const r=await e.post("files/mkdir",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});await r.text()})),Ue=k((e=>async function(t,n,r={}){Array.isArray(t)||(t=[t]);const i=await e.post("files/mv",{signal:r.signal,searchParams:L({arg:t.concat(n),...r}),headers:r.headers});await i.text()}));var Me=n(50590);const Be=k((e=>async function*(t,n={}){const r=await e.post("files/read",{signal:n.signal,searchParams:L({arg:t,count:n.length,...n}),headers:n.headers});yield*Me(r.body)})),ze=k((e=>async function(t,n={}){const r=await e.post("files/rm",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),i=await r.text();if(""!==i){const e=new m.HTTPError(r);throw e.message=i,e}})),Ve=k((e=>async function(t,n={}){const r=await e.post("files/stat",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),i=await r.json();return i.WithLocality=i.WithLocality||!1,(s=xe(i)).cid=d.k0.parse(s.hash),delete s.hash,s;var s}));const $e=k((e=>async function(t,n,r={}){const i=new AbortController,s=F(i.signal,r.signal),o=await e.post("files/write",{signal:s,searchParams:L({arg:t,streamChannels:!0,count:r.length,...r}),...await(0,V.x)([{content:n,path:"arg",mode:N(r.mode),mtime:D(r.mtime)}],i,r.headers)});await o.text()}));function Fe(e){return{cp:Pe(e),flush:ke(e),ls:De(e),mkdir:Oe(e),mv:Ue(e),read:Be(e),rm:ze(e),stat:Ve(e),write:$e(e)}}const je=k((e=>async(e,t,n={})=>{throw x(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),Ke={type:"ed25519"},qe=k((e=>async function(t,n=Ke){const r=await e.post("key/gen",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});return Ne(await r.json())})),He=k((e=>async function(t,n,r,i={}){const s=await e.post("key/import",{signal:i.signal,searchParams:L({arg:t,pem:n,password:r,...i}),headers:i.headers});return Ne(await s.json())})),Ge=k((e=>async function(t={}){const n=await e.post("key/list",{signal:t.signal,searchParams:L(t),headers:t.headers});return((await n.json()).Keys||[]).map((e=>Ne(e)))})),Ze=k((e=>async function(t,n,r={}){const i=await e.post("key/rename",{signal:r.signal,searchParams:L({arg:[t,n],...r}),headers:r.headers});return Ne(await i.json())})),We=k((e=>async function(t,n={}){const r=await e.post("key/rm",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});return Ne((await r.json()).Keys[0])}));function Qe(e){return{export:je(e),gen:qe(e),import:He(e),list:Ge(e),rename:Ze(e),rm:We(e)}}const Ye=k((e=>async function(t,n,r={}){const i=await e.post("log/level",{signal:r.signal,searchParams:L({arg:[t,n],...r}),headers:r.headers});return Ne(await i.json())})),Je=k((e=>async function(t={}){const n=await e.post("log/ls",{signal:t.signal,searchParams:L(t),headers:t.headers});return(await n.json()).Strings})),Xe=k((e=>async function*(t={}){const n=await e.post("log/tail",{signal:t.signal,searchParams:L(t),headers:t.headers});yield*n.ndjson()}));function et(e){return{level:Ye(e),ls:Je(e),tail:Xe(e)}}const tt=k((e=>async function(t,n={}){const r=await e.post("name/publish",{signal:n.signal,searchParams:L({arg:`${t}`,...n}),headers:n.headers});return Ne(await r.json())})),nt=k((e=>async function*(t,n={}){const r=await e.post("name/resolve",{signal:n.signal,searchParams:L({arg:t,stream:!0,...n}),headers:n.headers});for await(const e of r.ndjson())yield e.Path})),rt=k((e=>async function(t,n={}){const r=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});return Ne(await r.json())})),it=k((e=>async function(t={}){const n=await e.post("name/pubsub/state",{signal:t.signal,searchParams:L(t),headers:t.headers});return Ne(await n.json())})),st=k((e=>async function(t={}){const n=await e.post("name/pubsub/subs",{signal:t.signal,searchParams:L(t),headers:t.headers});return(await n.json()).Strings||[]}));function ot(e){return{cancel:rt(e),state:it(e),subs:st(e)}}function at(e){return{publish:tt(e),resolve:nt(e),pubsub:ot(e)}}const ct=k((e=>async function(t,n={}){const r=await e.post("object/data",{signal:n.signal,searchParams:L({arg:`${t instanceof Uint8Array?d.k0.decode(t):t}`,...n}),headers:n.headers}),i=await r.arrayBuffer();return new Uint8Array(i,0,i.byteLength)})),ut=k((e=>async function(t,n={}){const r=await e.post("object/get",{signal:n.signal,searchParams:L({arg:`${t instanceof Uint8Array?d.k0.decode(t):t}`,dataEncoding:"base64",...n}),headers:n.headers}),i=await r.json();return{Data:(0,ne.m)(i.Data,"base64pad"),Links:(i.Links||[]).map((e=>({Name:e.Name,Hash:d.k0.parse(e.Hash),Tsize:e.Size})))}})),lt=k((e=>async function(t,n={}){const r=await e.post("object/links",{signal:n.signal,searchParams:L({arg:`${t instanceof Uint8Array?d.k0.decode(t):t}`,...n}),headers:n.headers});return((await r.json()).Links||[]).map((e=>({Name:e.Name,Tsize:e.Size,Hash:d.k0.parse(e.Hash)})))})),ht=k((e=>async function(t={}){const n=await e.post("object/new",{signal:t.signal,searchParams:L({arg:t.template,...t}),headers:t.headers}),{Hash:r}=await n.json();return d.k0.parse(r)})),dt=(e,t)=>{const n=k((n=>{const r=fe(e,t);return async function(e,t={}){return r(e,{...t,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}}));return n(t)},ft=k((e=>async function(t,n={}){const r=await e.post("object/stat",{signal:n.signal,searchParams:L({arg:`${t}`,...n}),headers:n.headers}),i=await r.json();return{...i,Hash:d.k0.parse(i.Hash)}})),pt=k((e=>async function(t,n,r={}){const i=await e.post("object/patch/add-link",{signal:r.signal,searchParams:L({arg:[`${t}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...r}),headers:r.headers}),{Hash:s}=await i.json();return d.k0.parse(s)})),yt=k((e=>async function(t,n,r={}){const i=new AbortController,s=F(i.signal,r.signal),o=await e.post("object/patch/append-data",{signal:s,searchParams:L({arg:`${t}`,...r}),...await(0,V.x)([n],i,r.headers)}),{Hash:a}=await o.json();return d.k0.parse(a)})),gt=k((e=>async function(t,n,r={}){const i=await e.post("object/patch/rm-link",{signal:r.signal,searchParams:L({arg:[`${t}`,n.Name||n.name||null],...r}),headers:r.headers}),{Hash:s}=await i.json();return d.k0.parse(s)})),mt=k((e=>async function(t,n,r={}){const i=new AbortController,s=F(i.signal,r.signal),o=await e.post("object/patch/set-data",{signal:s,searchParams:L({arg:[`${t}`],...r}),...await(0,V.x)([n],i,r.headers)}),{Hash:a}=await o.json();return d.k0.parse(a)}));function wt(e){return{addLink:pt(e),appendData:yt(e),rmLink:gt(e),setData:mt(e)}}function bt(e,t){return{data:ct(t),get:ut(t),links:lt(t),new:ht(t),put:dt(e,t),stat:ft(t),patch:wt(t)}}var Et=n(73297);const vt=k((e=>async function*(t,n={}){for await(const{path:r,recursive:i,metadata:s}of(0,Et.f)(t)){const t=await e.post("pin/add",{signal:n.signal,searchParams:L({...n,arg:r,recursive:i,metadata:s?JSON.stringify(s):void 0,stream:!0}),headers:n.headers});for await(const e of t.ndjson())if(e.Pins)for(const t of e.Pins)yield d.k0.parse(t);else yield d.k0.parse(e)}}));function _t(e){const t=vt(e);return k((()=>async function(e,n={}){return(0,le.Z)(t([{path:e,...n}],n))}))(e)}function St(e,t,n){const r={type:e,cid:d.k0.parse(t)};return n&&(r.metadata=n),r}const Rt=k((e=>async function*(t={}){let n=[];t.paths&&(n=Array.isArray(t.paths)?t.paths:[t.paths]);const r=await e.post("pin/ls",{signal:t.signal,searchParams:L({...t,arg:n.map((e=>`${e}`)),stream:!0}),headers:t.headers});for await(const e of r.ndjson()){if(e.Keys){for(const t of Object.keys(e.Keys))yield St(e.Keys[t].Type,t,e.Keys[t].Metadata);return}yield St(e.Type,e.Cid,e.Metadata)}})),At=k((e=>async function*(t,n={}){for await(const{path:r,recursive:i}of(0,Et.f)(t)){const t=new URLSearchParams(n.searchParams);t.append("arg",`${r}`),null!=i&&t.set("recursive",String(i));const s=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:L({...n,arg:`${r}`,recursive:i})});for await(const e of s.ndjson())e.Pins?yield*e.Pins.map((e=>d.k0.parse(e))):yield d.k0.parse(e)}})),It=e=>{const t=At(e);return k((()=>async function(e,n={}){return(0,le.Z)(t([{path:e,...n}],n))}))(e)},Tt=({Name:e,Status:t,Cid:n})=>({cid:d.k0.parse(n),name:e,status:t}),Ct=e=>{if("string"==typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},Pt=e=>{if(d.k0.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},kt=({service:e,cid:t,name:n,status:r,all:i})=>{const s=L({service:Ct(e),name:n,force:!!i||void 0});if(t)for(const e of t)s.append("cid",Pt(e));if(r)for(const e of r)s.append("status",e);return s},Nt=({cid:e,service:t,background:n,name:r,origins:i})=>{const s=L({arg:Pt(e),service:Ct(t),name:r,background:!!n||void 0});if(i)for(const e of i)s.append("origin",e.toString());return s};function xt(e){return async function(t,{timeout:n,signal:r,headers:i,...s}){const o=await e.post("pin/remote/add",{timeout:n,signal:r,headers:i,searchParams:Nt({cid:t,...s})});return Tt(await o.json())}}function Dt(e){return async function*({timeout:t,signal:n,headers:r,...i}){const s=await e.post("pin/remote/ls",{timeout:t,signal:n,headers:r,searchParams:kt(i)});for await(const e of s.ndjson())yield Tt(e)}}function Lt(e){return async function({timeout:t,signal:n,headers:r,...i}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:r,searchParams:kt({...i,all:!1})})}}function Ot(e){return async function({timeout:t,signal:n,headers:r,...i}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:r,searchParams:kt({...i,all:!0})})}}function Ut(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function Mt(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:Bt(e.Stat)}}}function Bt(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:n,Queued:r,Failed:i}=e.PinCount;return{status:"valid",pinCount:{queued:r,pinning:t,pinned:n,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function zt(e){return async function(t,n){const{endpoint:r,key:i,headers:s,timeout:o,signal:a}=n;await e.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:L({arg:[t,Ut(r),i]}),headers:s})}}function Vt(e){return async function(t={}){const{stat:n,headers:r,timeout:i,signal:s}=t,o=await e.post("pin/remote/service/ls",{timeout:i,signal:s,headers:r,searchParams:!0===n?L({stat:n}):void 0}),{RemoteServices:a}=await o.json();return a.map(Mt)}}function $t(e){return async function(t,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:L({arg:t})})}}function Ft(e){const t=new P(e);return{add:zt(t),ls:Vt(t),rm:$t(t)}}function jt(e){const t=new P(e);return{add:xt(t),ls:Dt(t),rm:Lt(t),rmAll:Ot(t),service:Ft(e)}}function Kt(e){return{addAll:vt(e),add:_t(e),ls:Rt(e),rmAll:At(e),rm:It(e),remote:jt(e)}}var qt=n(99382);const Ht=e=>(0,be.B)(Gt(e)),Gt=e=>qt.base64url.decode(e),Zt=e=>BigInt(`0x${(0,be.B)(qt.base64url.decode(e),"base16")}`),Wt=e=>qt.base64url.encode((0,ne.m)(e)),Qt=k((e=>async function(t={}){const{Strings:n}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:L(t),headers:t.headers})).json();return r=n,(Array.isArray(r)?r.map(Ht):r)||[];var r})),Yt=k((e=>async function(t,n={}){const r=await e.post("pubsub/peers",{signal:n.signal,searchParams:L({arg:Wt(t),...n}),headers:n.headers}),{Strings:i}=await r.json();return i||[]})),Jt=k((e=>async function(t,n,r={}){const i=L({arg:Wt(t),...r}),s=new AbortController,o=F(s.signal,r.signal),a=await e.post("pubsub/pub",{signal:o,searchParams:i,...await(0,V.x)([n],s,r.headers)});await a.text()})),Xt=(0,g.kg)("js-kubo-rpc-client:pubsub:subscribe"),en=(e,t)=>k((e=>async function(n,r,i={}){let s,o;i.signal=t.subscribe(n,r,i.signal);const a=new Promise(((e,t)=>{s=e,o=t})),c=setTimeout((()=>s()),1e3);return e.post("pubsub/sub",{signal:i.signal,searchParams:L({arg:Wt(n),...i}),headers:i.headers}).catch((e=>{t.unsubscribe(n,r),o(e)})).then((e=>{clearTimeout(c),e&&(!async function(e,{onMessage:t,onEnd:n,onError:r}){r=r||Xt;try{for await(const n of e.ndjson())try{if(!n.from)continue;null!=n.from&&null!=n.seqno?t({type:"signed",from:(0,M.jE)(n.from),data:Gt(n.data),sequenceNumber:Zt(n.seqno),topic:Ht(n.topicIDs[0]),key:Gt(n.key??"u"),signature:Gt(n.signature??"u")}):t({type:"unsigned",data:Gt(n.data),topic:Ht(n.topicIDs[0])})}catch(e){e.message=`Failed to parse pubsub message: ${e.message}`,r(e,!1,n)}}catch(e){tn(e)||r(e,!0)}finally{n()}}(e,{onMessage:e=>{r&&("function"!=typeof r?"function"==typeof r.handleEvent&&r.handleEvent(e):r(e))},onEnd:()=>t.unsubscribe(n,r),onError:i.onError}),s())})),a}))(e);const tn=e=>{switch(e.type){case"aborted":case"abort":return!0;default:return"AbortError"===e.name}},nn=(e,t)=>async function(e,n){t.unsubscribe(e,n)};class rn{constructor(){this._subs=new Map}subscribe(e,t,n){const r=this._subs.get(e)||[];if(r.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(r)),n&&n.addEventListener("abort",(()=>this.unsubscribe(e,t))),i.signal}unsubscribe(e,t){const n=this._subs.get(e)||[];let r;t?(this._subs.set(e,n.filter((e=>e.handler!==t))),r=n.filter((e=>e.handler===t))):(this._subs.set(e,[]),r=n),(this._subs.get(e)||[]).length||this._subs.delete(e),r.forEach((e=>e.controller.abort()))}}function sn(e){const t=new rn;return{ls:Qt(e),peers:Yt(e),publish:Jt(e),subscribe:en(e,t),unsubscribe:nn(e,t)}}const on=k((e=>async function*(t={}){const n=await e.post("refs/local",{signal:t.signal,transform:Ne,searchParams:L(t),headers:t.headers});yield*n.ndjson()})),an=k(((e,t)=>Object.assign((async function*(t,n={}){const r=Array.isArray(t)?t:[t],i=await e.post("refs",{signal:n.signal,searchParams:L({arg:r.map((e=>`${e instanceof Uint8Array?d.k0.decode(e):e}`)),...n}),headers:n.headers,transform:Ne});yield*i.ndjson()}),{local:on(t)}))),cn=k((e=>async function*(t={}){const n=await e.post("repo/gc",{signal:t.signal,searchParams:L(t),headers:t.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?d.k0.parse(e.Key["/"]):null})});yield*n.ndjson()})),un=k((e=>async function(t={}){const n=await e.post("repo/stat",{signal:t.signal,searchParams:L(t),headers:t.headers}),r=await n.json();return{numObjects:BigInt(r.NumObjects),repoSize:BigInt(r.RepoSize),repoPath:r.RepoPath,version:r.Version,storageMax:BigInt(r.StorageMax)}})),ln=k((e=>async function(t={}){return(await(await e.post("repo/version",{signal:t.signal,searchParams:L(t),headers:t.headers})).json()).Version}));function hn(e){return{gc:cn(e),stat:un(e),version:ln(e)}}const dn=k((e=>async function*(t={}){const n=await e.post("stats/bw",{signal:t.signal,searchParams:L(t),headers:t.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})});yield*n.ndjson()}));function fn(e){return{bitswap:B(e),repo:un(e),bw:dn(e)}}const pn=k((e=>async function(t={}){const n=await e.post("swarm/addrs",{signal:t.signal,searchParams:L(t),headers:t.headers}),{Addrs:r}=await n.json();return Object.keys(r).map((e=>({id:(0,M.jE)(e),addrs:(r[e]||[]).map((e=>(0,f.HM)(e)))})))})),yn=k((e=>async function(t,n={}){const r=await e.post("swarm/connect",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),{Strings:i}=await r.json();return i||[]})),gn=k((e=>async function(t,n={}){const r=await e.post("swarm/disconnect",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),{Strings:i}=await r.json();return i||[]})),mn=k((e=>async function(t={}){const n=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:L(t),headers:t.headers}),{Strings:r}=await n.json();return(r||[]).map((e=>(0,f.HM)(e)))})),wn=k((e=>async function(t={}){const n=await e.post("swarm/peers",{signal:t.signal,searchParams:L(t),headers:t.headers}),{Peers:r}=await n.json();return(r||[]).map((e=>({addr:(0,f.HM)(e.Addr),peer:(0,M.jE)(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"})))}));function bn(e){return{addrs:pn(e),connect:yn(e),disconnect:gn(e),localAddrs:mn(e),peers:wn(e)}}const En=k((e=>async function*(t,n={}){const r=new AbortController,i=F(r.signal,n.signal),{headers:s,body:o,total:a,parts:c}=await(0,V.x)(t,r,n.headers),[u,l]="function"==typeof n.progress?vn(a,c,n.progress):[void 0,void 0],h=await e.post("add",{searchParams:L({"stream-channels":!0,...n,progress:Boolean(u)}),onUploadProgress:l,signal:i,headers:s,body:o});for await(let e of h.ndjson())e=Ne(e),void 0!==e.hash?yield Sn(e):u&&u(e.bytes||0,e.name)})),vn=(e,t,n)=>t?[void 0,_n(e,t,n)]:[n,void 0],_n=(e,t,n)=>{let r=0;const i=t.length;return({loaded:s,total:o})=>{const a=Math.floor(s/o*e);for(;r<i;){const{start:e,end:i,name:s}=t[r];if(a<i){n(a-e,s);break}n(i-e,s),r+=1}}};function Sn({name:e,hash:t,size:n,mode:r,mtime:i,mtimeNsecs:s}){const o={path:e,cid:d.k0.parse(t),size:parseInt(n)};return null!=r&&(o.mode=parseInt(r,8)),null!=i&&(o.mtime={secs:i,nsecs:s||0}),o}var Rn=n(56740);function An(e){const t=En(e);return k((()=>async function(e,n={}){const r=(0,Rn.f)(e),i=t(r,n);return await(0,le.Z)(i)}))(e)}const In=k((e=>async function*(t,n={}){const r=await e.post("cat",{signal:n.signal,searchParams:L({arg:t.toString(),...n}),headers:n.headers});yield*r.iterator()})),Tn=k((e=>async(t={})=>(await e.post("commands",{signal:t.signal,searchParams:L(t),headers:t.headers})).json())),Cn=k((e=>async(t,n={})=>{const r=await e.post("dns",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers});return(await r.json()).Path})),Pn=k((e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}})),kn=k((e=>async function*(t,n={}){const r={arg:`${t instanceof Uint8Array?d.k0.decode(t):t}`,...n};r.compressionLevel&&(r["compression-level"]=r.compressionLevel,delete r.compressionLevel);const i=await e.post("get",{signal:n.signal,searchParams:L(r),headers:n.headers});yield*i.iterator()})),Nn=k((e=>async function(t={}){const n=await e.post("id",{signal:t.signal,searchParams:L({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers}),r={...Ne(await n.json())};return r.id=(0,M.jE)(r.id),r.addresses&&(r.addresses=r.addresses.map((e=>(0,f.HM)(e)))),r})),xn=e=>{const t=Nn(e);return async function(e={}){const n=await t(e);return Boolean(n&&n.addresses&&n.addresses.length)}},Dn=k(((e,t)=>async function*(n,r={}){const i=`${n instanceof Uint8Array?d.k0.decode(n):n}`;async function s(e){let n=e.Hash;if(n.includes("/")){const e=n.startsWith("/ipfs/")?n:`/ipfs/${n}`;n=(await Ve(t)(e)).cid}else n=d.k0.parse(n);const r={name:e.Name,path:i+(e.Name?`/${e.Name}`:""),size:e.Size,cid:n,type:Ln(e)};return e.Mode&&(r.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(r.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(r.mtime.nsecs=e.MtimeNsecs)),r}const o=await e.post("ls",{signal:r.signal,searchParams:L({arg:i,...r}),headers:r.headers});for await(let e of o.ndjson()){if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const t=e.Links;if(!Array.isArray(t))throw new Error("expected one array in results.Objects[0].Links");if(!t.length)return void(yield s(e));yield*t.map(s)}}));function Ln(e){switch(e.Type){case 1:case 5:return"dir";default:return"file"}}const On=k((e=>async function(t={}){const n=await e.post("dns",{signal:t.signal,searchParams:L(t),headers:t.headers});return Ne(await n.json())})),Un=k((e=>async function*(t,n={}){const r=await e.post("ping",{signal:n.signal,searchParams:L({arg:`${t}`,...n}),headers:n.headers,transform:Ne});yield*r.ndjson()})),Mn=k((e=>async function(t,n={}){const r=await e.post("resolve",{signal:n.signal,searchParams:L({arg:t,...n}),headers:n.headers}),{Path:i}=await r.json();return i})),Bn=k((e=>async(e={})=>{throw x(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),zn=k((e=>async function(t={}){const n=await e.post("shutdown",{signal:t.signal,searchParams:L(t),headers:t.headers});await n.text()})),Vn=k((e=>async function(t={}){const n=await e.post("version",{signal:t.signal,searchParams:L(t),headers:t.headers});return{...Ne(await n.json()),"ipfs-http-client":"1.0.0"}}));n(85104),n(46953);function $n(e={}){const t={name:l.identity.name,code:l.identity.code,encode:e=>e,decode:e=>e},n=Object.values(h.gh);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((e=>n.push(e)));const d=new r.x({bases:n,loadBase:e.ipld&&e.ipld.loadBase}),f=Object.values(h.QB);[o,a,c,u,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>f.push(e)));const p=new i.w({codecs:f,loadCodec:e.ipld&&e.ipld.loadCodec}),y=Object.values(h.kq);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((e=>y.push(e)));const g=new s.d({hashers:y,loadHasher:e.ipld&&e.ipld.loadHasher});var m;return{add:An(e),addAll:En(e),bitswap:(m=e,{wantlist:O(m),wantlistForPeer:U(m),stat:B(m)}),block:G(e),bootstrap:Y(e),cat:In(e),commands:Tn(e),config:oe(e),dag:ye(p,e),dht:Re(e),diag:Ce(e),dns:Cn(e),files:Fe(e),get:kn(e),getEndpointConfig:Pn(e),id:Nn(e),isOnline:xn(e),key:Qe(e),log:et(e),ls:Dn(e),mount:On(e),name:at(e),object:bt(p,e),pin:Kt(e),ping:Un(e),pubsub:sn(e),refs:an(e),repo:hn(e),resolve:Mn(e),start:Bn(e),stats:fn(e),stop:zn(e),swarm:bn(e),version:Vn(e),bases:d,codecs:p,hashers:g}}},2288:function(e,t,n){"use strict";function r(e,t){let n;return function(){clearTimeout(n),n=setTimeout((function(){n=void 0,e()}),t)}}n.d(t,{D:function(){return r}})},97542:function(e,t,n){"use strict";n.d(t,{LX:function(){return o},Rv:function(){return s},cS:function(){return a},tm:function(){return l},vE:function(){return u},vo:function(){return r},wc:function(){return i},yc:function(){return c}});const r="libp2p",i="autonat",s="1.0.0",o=3e4,a=5e3,c=6e4,u=1,l=1},25887:function(e,t,n){"use strict";n.d(t,{D:function(){return v}});var r,i=n(17187),s=n(49541),o=n(38699),a=n(34042),c=n(45045),u=n(6540),l=n(31650),h=n(91893),d=n(34880),f=n(69849),p=n(90212),y=n(53749),g=n(64188),m=n(97542),w=n(46888);!function(e){let t,n,r,i,s,o,a,c;!function(e){e.DIAL="DIAL",e.DIAL_RESPONSE="DIAL_RESPONSE"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.DIAL=0]="DIAL",e[e.DIAL_RESPONSE=1]="DIAL_RESPONSE"}(n||(n={})),function(e){e.codec=()=>(0,w.Ji)(n)}(t=e.MessageType||(e.MessageType={})),function(e){e.OK="OK",e.E_DIAL_ERROR="E_DIAL_ERROR",e.E_DIAL_REFUSED="E_DIAL_REFUSED",e.E_BAD_REQUEST="E_BAD_REQUEST",e.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){e[e.OK=0]="OK",e[e.E_DIAL_ERROR=100]="E_DIAL_ERROR",e[e.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",e[e.E_BAD_REQUEST=200]="E_BAD_REQUEST",e[e.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"}(i||(i={})),function(e){e.codec=()=>(0,w.Ji)(i)}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,w.yw)(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const n of e.addrs)t.uint32(18),t.bytes(n);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,w.LE)(t,e.codec()),e.decode=t=>(0,w.C6)(t,e.codec())}(s=e.PeerInfo||(e.PeerInfo={})),function(t){let n;t.codec=()=>(null==n&&(n=(0,w.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.peer&&(n.uint32(10),e.PeerInfo.codec().encode(t.peer,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();if(n>>>3==1)r.peer=e.PeerInfo.codec().decode(t,t.uint32());else t.skipType(7&n)}return r}))),n),t.encode=e=>(0,w.LE)(e,t.codec()),t.decode=e=>(0,w.C6)(e,t.codec())}(o=e.Dial||(e.Dial={})),function(t){let n;t.codec=()=>(null==n&&(n=(0,w.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.status&&(n.uint32(8),e.ResponseStatus.codec().encode(t.status,n)),null!=t.statusText&&(n.uint32(18),n.string(t.statusText)),null!=t.addr&&(n.uint32(26),n.bytes(t.addr)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.status=e.ResponseStatus.codec().decode(t);break;case 2:r.statusText=t.string();break;case 3:r.addr=t.bytes();break;default:t.skipType(7&n)}}return r}))),n),t.encode=e=>(0,w.LE)(e,t.codec()),t.decode=e=>(0,w.C6)(e,t.codec())}(a=e.DialResponse||(e.DialResponse={})),e.codec=()=>(null==c&&(c=(0,w.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.dial&&(n.uint32(18),e.Dial.codec().encode(t.dial,n)),null!=t.dialResponse&&(n.uint32(26),e.DialResponse.codec().encode(t.dialResponse,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 2:r.dial=e.Dial.codec().decode(t,t.uint32());break;case 3:r.dialResponse=e.DialResponse.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),c),e.encode=t=>(0,w.LE)(t,e.codec()),e.decode=t=>(0,w.C6)(t,e.codec())}(r||(r={}));const b=(0,o.kg)("libp2p:autonat");class E{components;startupDelay;refreshInterval;protocol;timeout;maxInboundStreams;maxOutboundStreams;verifyAddressTimeout;started;constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix??m.vo}/${m.wc}/${m.Rv}`,this.timeout=t.timeout??m.LX,this.maxInboundStreams=t.maxInboundStreams??m.vE,this.maxOutboundStreams=t.maxOutboundStreams??m.tm,this.startupDelay=t.startupDelay??m.cS,this.refreshInterval=t.refreshInterval??m.yc,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}isStarted(){return this.started}async start(){this.started||(await this.components.registrar.handle(this.protocol,(e=>{this.handleIncomingAutonatStream(e).catch((e=>{b.error("error handling incoming autonat stream",e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.protocol),clearTimeout(this.verifyAddressTimeout),this.started=!1}async handleIncomingAutonatStream(e){const t=AbortSignal.timeout(this.timeout),n=()=>{e.stream.abort(new s.sv("handleIncomingAutonatStream timeout",g.q.ERR_TIMEOUT))};t.addEventListener("abort",n,{once:!0});try{(0,i.setMaxListeners)?.(1/0,t)}catch{}const o=this.components.addressManager.getAddresses().map((e=>e.toOptions().host));try{const n=this;await(0,p.z)(e.stream,(e=>h.J(e)),(async function*(i){const s=await(0,l.Z)(i);if(null==s)return b("no message received"),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}}));let c;try{c=r.decode(s)}catch(e){return b.error("could not decode message",e),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}}))}const h=c.dial;if(null==h)return b.error("dial was missing from message"),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}}));let d;const f=h.peer;if(null==f||null==f.id)return b.error("PeerId missing from message"),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}}));try{d=(0,a.cv)(f.id)}catch(e){return b.error("invalid PeerId",e),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}}))}if(b("incoming request from %p",d),!e.connection.remotePeer.equals(d))return b("target peer %p did not equal sending peer %p",d,e.connection.remotePeer),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}}));const p=f.addrs.map((e=>(0,u.HM)(e))).filter((t=>{const n=t.toOptions().host===e.connection.remoteAddr.toOptions().host;return b.trace("request to dial %a was sent from %a is same host %s",t,e.connection.remoteAddr,n),n})).filter((e=>{const t=e.toOptions().host,n=!(0,y.Z)(t);return b.trace("host %s was public %s",t,n),n})).filter((e=>{const t=e.toOptions().host,n=!o.includes(t);return b.trace("host %s was not our host %s",t,n),n})).filter((e=>{const t=Boolean(n.components.transportManager.transportForMultiaddr(e));return b.trace("transport for %a is supported %s",e,t),t})).map((e=>(null==e.getPeerId()&&(e=e.encapsulate(`/p2p/${d.toString()}`)),e)));if(0===p.length)return b("no valid multiaddrs for %p in message",d),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}}));b("dial multiaddrs %s for peer %p",p.map((e=>e.toString())).join(", "),d);let g="",m=p[0];for await(const e of p){let i;m=e;try{if(i=await n.components.connectionManager.openConnection(e,{signal:t}),!i.remoteAddr.equals(e))throw b.error("tried to dial %a but dialed %a",e,i.remoteAddr),new Error("Unexpected remote address");return b("Success %p",d),void(yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.OK,addr:i.remoteAddr.decapsulateCode((0,u.a_)("p2p").code).bytes}}))}catch(e){b("could not dial %p",d,e),g=e.message}finally{null!=i&&await i.close()}}yield r.encode({type:r.MessageType.DIAL_RESPONSE,dialResponse:{status:r.ResponseStatus.E_DIAL_ERROR,statusText:g,addr:m.bytes}})}),(e=>h.c(e)),e.stream)}catch(e){b.error("error handling incoming autonat stream",e)}finally{t.removeEventListener("abort",n)}}_verifyExternalAddresses(){this.verifyExternalAddresses().catch((e=>{b.error("error verifying external address",e)}))}async verifyExternalAddresses(){if(clearTimeout(this.verifyAddressTimeout),!this.isStarted())return;const e=this.components.addressManager,t=e.getObservedAddrs().filter((e=>{const t=e.toOptions();return!(0,y.Z)(t.host)}));if(0===t.length)return b("no public addresses found, not requesting verification"),void(this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval));const n=AbortSignal.timeout(this.timeout);try{(0,i.setMaxListeners)?.(1/0,n)}catch{}const o=this;try{b("verify multiaddrs %s",t.map((e=>e.toString())).join(", "));const i=r.encode({type:r.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:t.map((e=>e.bytes))}}}),a=(await(0,c.n9)()).toBytes(),y={},m=[],w=async e=>{let t=()=>{};try{b("asking %p to verify multiaddr",e.id);const a=await o.components.connectionManager.openConnection(e.id,{signal:n}),c=await a.newStream(this.protocol,{signal:n});t=()=>{c.abort(new s.sv("verifyAddress timeout",g.q.ERR_TIMEOUT))},n.addEventListener("abort",t,{once:!0});const u=await(0,p.z)([i],(e=>h.c(e)),c,(e=>h.J(e)),(async e=>(0,l.Z)(e)));if(null==u)return void b("no response received from %p",a.remotePeer);const d=r.decode(u);if(d.type!==r.MessageType.DIAL_RESPONSE||null==d.dialResponse)return void b("invalid autonat response from %p",a.remotePeer);if(d.dialResponse.status===r.ResponseStatus.OK){const e=a.remoteAddr.toOptions();let t;if(4===e.family){t=e.host.split(".")[0]}else{if(6!==e.family)return void b('remote address "%s" was not IP4 or IP6?',e.host);t=e.host.split(":")[0]}if(m.includes(t))return void b("already have response from network segment %d - %s",t,e.host);m.push(t)}return d.dialResponse}catch(e){b.error("error asking remote to verify multiaddr",e)}finally{n.removeEventListener("abort",t)}};for await(const i of(0,f.Z)((0,d.Z)(this.components.peerRouting.getClosestPeers(a,{signal:n}),(e=>async()=>w(e))),{concurrency:4}))try{if(null==i)continue;const n=null==i.addr?t[0]:(0,u.HM)(i.addr);if(b("autonat response for %a is %s",n,i.status),i.status===r.ResponseStatus.E_BAD_REQUEST)continue;if(i.status===r.ResponseStatus.E_DIAL_REFUSED)continue;if(null==i.addr&&t.length>1)continue;if(!t.some((e=>e.equals(n)))){b("peer reported %a as %s but it was not in our observed address list",n,i.status);continue}const s=n.toString();if(null==y[s]&&(y[s]={success:0,failure:0}),i.status===r.ResponseStatus.OK?y[s].success++:i.status===r.ResponseStatus.E_DIAL_ERROR&&y[s].failure++,4===y[s].success)return b("%a is externally dialable",n),void e.confirmObservedAddr(n);if(4===y[s].failure)return b("%a is not externally dialable",n),void e.removeObservedAddr(n)}catch(e){b.error("could not verify external address",e)}}finally{this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval)}}}function v(e={}){return t=>new E(t,e)}},46289:function(e,t,n){"use strict";n.d(t,{BH:function(){return c},GR:function(){return o},SA:function(){return i},U:function(){return r},ur:function(){return s},w2:function(){return a}});const r=290,i="/libp2p/relay",s=1,o="circuit-relay-relay",a=(BigInt(1<<17),"/libp2p/circuit/relay/0.2.0/hop"),c="/libp2p/circuit/relay/0.2.0/stop"},537:function(e,t,n){"use strict";n.d(t,{f:function(){return P}});n(11353);var r=n(49541),i=n(55265),s=n(38699),o=n(34042);const a=(0,s.kg)("libp2p:stream:converter");function c(e){const{stream:t,remoteAddr:n}=e,{sink:r,source:i}=t,s={async sink(e){try{await r(e),o()}catch(e){"aborted"!==e.type&&a(e)}},source:async function*(){for await(const e of i)e instanceof Uint8Array?yield e:yield*e}(),remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(e){o(),await t.close(e)},abort(e){o(),t.abort(e)}};function o(){null==s.timeline.close&&(s.timeline.close=Date.now())}return s}var u=n(76237),l=n(6540),h=n(41455),d=n(12229),f=n(64188),p=n(46289),y=n(21747),g=n(23247),m=n(52694);const w=(0,s.kg)("libp2p:circuit-relay:discover-relays");class b extends g.v{peerId;peerStore;contentRouting;registrar;started;topologyId;constructor(e){super(),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.contentRouting=e.contentRouting,this.registrar=e.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(p.w2,{onConnect:e=>{this.safeDispatchEvent("relay:discover",{detail:e})}}),this.discover().catch((e=>{w.error("error listening on relays",e)})),this.started=!0}stop(){null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){w("searching peer store for relays");const e=await this.peerStore.all({filters:[e=>e.protocols.includes(p.w2)],orders:[()=>Math.random()<.5?1:-1]});for(const t of e)w("found relay peer %p in content peer store",t.id),this.safeDispatchEvent("relay:discover",{detail:t.id});w("found %d relay peers in peer store",e.length);try{w("searching content routing for relays");const e=await(0,m.X8)(p.SA);let t=0;for await(const n of this.contentRouting.findProviders(e))if(n.multiaddrs.length>0&&!n.id.equals(this.peerId)){const e=n.id;t++,await this.peerStore.merge(e,{multiaddrs:n.multiaddrs}),w("found relay peer %p in content routing",e),this.safeDispatchEvent("relay:discover",{detail:e})}w("found %d relay peers in content routing",t)}catch(e){w.error("failed when finding relays on the network",e)}}}var E=n(67483);const v=(0,s.kg)("libp2p:circuit-relay:transport:listener");class _ extends g.v{connectionManager;relayStore;listeningAddrs;constructor(e){super(),this.connectionManager=e.connectionManager,this.relayStore=e.relayStore,this.listeningAddrs=new E.ji,this.relayStore.addEventListener("relay:removed",(e=>{this.#s(e.detail)}))}async listen(e){v("listen on %a",e);const t=e.getPeerId();let n;if(null!=t){const e=(0,o.jE)(t),r=this.connectionManager.getConnectionsMap().get(e)??[];r.length>0&&(n=r[0])}if(null==n){const t=e.toString().split("/p2p-circuit").find((e=>""!==e)),r=(0,l.HM)(t);n=await this.connectionManager.openConnection(r)}if(!this.relayStore.hasReservation(n.remotePeer))return void await this.relayStore.addRelay(n.remotePeer,"configured");const i=this.relayStore.getReservation(n.remotePeer);if(null==i)throw new r.sv("Did not have reservation after making reservation","ERR_NO_RESERVATION");this.listeningAddrs.has(n.remotePeer)?v("already listening on relay %p",n.remotePeer):(this.listeningAddrs.set(n.remotePeer,i.addrs.map((e=>(0,l.HM)(e).encapsulate("/p2p-circuit")))),this.safeDispatchEvent("listening",{}))}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}#s(e){const t=this.listeningAddrs.has(e);v("relay peer removed %p - had reservation",e,t),this.listeningAddrs.delete(e),t&&this.safeDispatchEvent("close",{})}}var S=n(95554);const R=(0,s.kg)("libp2p:circuit-relay:transport:reservation-store");class A extends g.v{peerId;connectionManager;transportManager;peerStore;events;reserveQueue;reservations;maxDiscoveredRelays;maxReservationQueueLength;reservationCompletionTimeout;started;constructor(e,t){super(),this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.peerStore=e.peerStore,this.events=e.events,this.reservations=new E.ji,this.maxDiscoveredRelays=t?.discoverRelays??0,this.maxReservationQueueLength=t?.maxReservationQueueLength??100,this.reservationCompletionTimeout=t?.reservationCompletionTimeout??1e4,this.started=!1,this.reserveQueue=new S.m({concurrency:t?.reservationConcurrency??p.ur}),this.events.addEventListener("peer:disconnect",(e=>{this.#o(e.detail)}))}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.reserveQueue.clear(),this.reservations.forEach((({timeout:e})=>{clearTimeout(e)})),this.reservations.clear(),this.started=!1}async addRelay(e,t){this.peerId.equals(e)?R("not trying to use self as relay"):this.reserveQueue.size>this.maxReservationQueueLength?R("not adding relay as the queue is full"):this.reserveQueue.hasJob(e)?R("relay peer is already in the reservation queue"):(R("add relay %p",e),await this.reserveQueue.add((async()=>{try{const n=this.reservations.get(e);if(null!=n){if((0,m.EO)(n.reservation.expire)>6e5)return void R("already have reservation on relay peer %p and it expires in more than 10 minutes",e);clearTimeout(n.timeout),this.reservations.delete(e)}if("discovered"===t&&[...this.reservations.values()].reduce(((e,t)=>("discovered"===t.type&&e++,e)),0)>=this.maxDiscoveredRelays)return void R("already have enough discovered relays");const r=AbortSignal.timeout(this.reservationCompletionTimeout),i=await this.connectionManager.openConnection(e,{signal:r});if(i.remoteAddr.protoNames().includes("p2p-circuit"))return void R("not creating reservation over relayed connection");const s=await this.#a(i,{signal:r});R("created reservation on relay peer %p",e);const o=(0,m.EO)(s.expire),a=Math.min(Math.max(o-3e5,3e4),Math.pow(2,31)-1),c=setTimeout((()=>{this.addRelay(e,t).catch((t=>{R.error("could not refresh reservation to relay %p",e,t)}))}),a);this.reservations.set(e,{timeout:c,reservation:s,type:t}),await this.peerStore.merge(e,{tags:{[p.GR]:{value:1,ttl:o}}}),await this.transportManager.listen([(0,l.HM)(`/p2p/${e.toString()}/p2p-circuit`)])}catch(t){R.error("could not reserve slot on %p",e,t);const n=this.reservations.get(e);null!=n&&clearTimeout(n.timeout),this.reservations.delete(e)}}),{peerId:e}))}hasReservation(e){return this.reservations.has(e)}getReservation(e){return this.reservations.get(e)?.reservation}async#a(e,t){t.signal?.throwIfAborted(),R("requesting reservation from %p",e.remotePeer);const n=await e.newStream(p.w2,t),r=(0,h.z)(n).pb(y.AT);let i;await r.write({type:y.AT.Type.RESERVE},t);try{i=await r.read(t)}catch(t){throw R.error("error parsing reserve message response from %p because",e.remotePeer,t),t}finally{await n.close()}if(i.status===y.qb.OK&&null!=i.reservation)return i.reservation;const s=`reservation failed with status ${i.status??"undefined"}`;throw R.error(s),new Error(s)}#o(e){const t=this.reservations.get(e);null!=t&&(R("connection to relay %p closed, removing reservation from local store",e),clearTimeout(t.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(R("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}}const I=(0,s.kg)("libp2p:circuit-relay:transport"),T={maxInboundStopStreams:d.aX,maxOutboundStopStreams:d.aX,stopTimeout:3e4};class C{discovery;registrar;peerStore;connectionManager;peerId;upgrader;addressManager;connectionGater;reservationStore;maxInboundStopStreams;maxOutboundStopStreams;stopTimeout;started;constructor(e,t){this.registrar=e.registrar,this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.upgrader=e.upgrader,this.addressManager=e.addressManager,this.connectionGater=e.connectionGater,this.maxInboundStopStreams=t.maxInboundStopStreams??T.maxInboundStopStreams,this.maxOutboundStopStreams=t.maxOutboundStopStreams??T.maxOutboundStopStreams,this.stopTimeout=t.stopTimeout??T.stopTimeout,null!=t.discoverRelays&&t.discoverRelays>0&&(this.discovery=new b(e),this.discovery.addEventListener("relay:discover",(e=>{this.reservationStore.addRelay(e.detail,"discovered").catch((t=>{I.error("could not add discovered relay %p",e.detail,t)}))}))),this.reservationStore=new A(e,t),this.reservationStore.addEventListener("relay:not-enough-relays",(()=>{this.discovery?.discover().catch((e=>{I.error("could not discover relays",e)}))})),this.started=!1}isStarted(){return this.started}async start(){await this.reservationStore.start(),await(this.discovery?.start()),await this.registrar.handle(p.BH,(e=>{this.onStop(e).catch((t=>{I.error("error while handling STOP protocol",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),this.started=!0}async stop(){this.discovery?.stop(),await this.reservationStore.stop(),await this.registrar.unhandle(p.BH),this.started=!1}[i.NA]=!0;[Symbol.toStringTag]="libp2p/circuit-relay-v2";async dial(e,t={}){if(1!==e.protoCodes().filter((e=>e===p.U)).length){const t="Invalid circuit relay address";throw I.error(t,e),new r.sv(t,f.q.ERR_RELAYED_DIAL)}const n=e.toString().split("/p2p-circuit"),i=(0,l.HM)(n[0]),s=(0,l.HM)(n[n.length-1]),a=i.getPeerId(),c=s.getPeerId();if(null==a||null==c){const t=`Circuit relay dial to ${e.toString()} failed as address did not have peer ids`;throw I.error(t),new r.sv(t,f.q.ERR_RELAYED_DIAL)}const u=(0,o.jE)(a),h=(0,o.jE)(c);let d=!1;let y,g=this.connectionManager.getConnections(u)[0];null==g&&(await this.peerStore.merge(u,{multiaddrs:[i]}),g=await this.connectionManager.openConnection(u,t),d=!0);try{return y=await g.newStream([p.w2]),await this.connectV2({stream:y,connection:g,destinationPeer:h,destinationAddr:s,relayAddr:i,ma:e,disconnectOnFailure:d})}catch(e){throw I.error("circuit relay dial to destination %p via relay %p failed",h,u,e),null!=y&&y.abort(e),d&&await g.close(),e}}async connectV2({stream:e,connection:t,destinationPeer:n,destinationAddr:i,relayAddr:s,ma:o,disconnectOnFailure:a}){try{const t=(0,h.z)(e),a=t.pb(y.AT);await a.write({type:y.AT.Type.CONNECT,peer:{id:n.toBytes(),addrs:[(0,l.HM)(i).bytes]}});const u=await a.read();if(u.status!==y.qb.OK)throw new r.sv(`failed to connect via relay with status ${u?.status?.toString()??"undefined"}`,f.q.ERR_HOP_REQUEST_FAILED);const d=c({stream:t.unwrap(),remoteAddr:o,localAddr:s.encapsulate(`/p2p-circuit/p2p/${this.peerId.toString()}`)});return I("new outbound transient connection %a",d.remoteAddr),await this.upgrader.upgradeOutbound(d,{transient:!0})}catch(e){throw I.error(`Circuit relay dial to destination ${n.toString()} via relay ${t.remotePeer.toString()} failed`,e),a&&await t.close(),e}}createListener(e){return function(e){return new _(e)}({connectionManager:this.connectionManager,relayStore:this.reservationStore})}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>u.dx.matches(e)))}async onStop({connection:e,stream:t}){const n=AbortSignal.timeout(this.stopTimeout),r=(0,h.z)(t).pb(y.Je),i=await r.read({signal:n});if(I("new circuit relay v2 stop stream from %p with type %s",e.remotePeer,i.type),void 0===i?.type)return I.error("type was missing from circuit v2 stop protocol request from %s",e.remotePeer),await r.write({type:y.Je.Type.STATUS,status:y.qb.MALFORMED_MESSAGE},{signal:n}),void await t.close();if(i.type!==y.Je.Type.CONNECT)return I.error("invalid stop connect request via peer %p",e.remotePeer),await r.write({type:y.Je.Type.STATUS,status:y.qb.UNEXPECTED_MESSAGE},{signal:n}),void await t.close();if(!(e=>{if(null==e.peer)return!1;try{e.peer.addrs.forEach(l.HM)}catch{return!1}return!0})(i))return I.error("invalid stop connect request via peer %p",e.remotePeer),await r.write({type:y.Je.Type.STATUS,status:y.qb.MALFORMED_MESSAGE},{signal:n}),void await t.close();const s=(0,o.cv)(i.peer.id);if(!0===await(this.connectionGater.denyInboundRelayedConnection?.(e.remotePeer,s)))return I.error("connection gater denied inbound relayed connection from %p",e.remotePeer),await r.write({type:y.Je.Type.STATUS,status:y.qb.PERMISSION_DENIED},{signal:n}),void await t.close();I.trace("sending success response to %p",e.remotePeer),await r.write({type:y.Je.Type.STATUS,status:y.qb.OK},{signal:n});const a=e.remoteAddr.encapsulate(`/p2p-circuit/p2p/${s.toString()}`),u=this.addressManager.getAddresses()[0],d=c({stream:r.unwrap().unwrap(),remoteAddr:a,localAddr:u});I("new inbound transient connection %a",d.remoteAddr),await this.upgrader.upgradeInbound(d,{transient:!0}),I("%s connection %a upgraded","inbound",d.remoteAddr)}}function P(e={}){return t=>new C(t,e)}},21747:function(e,t,n){"use strict";n.d(t,{AT:function(){return r},Je:function(){return i},qb:function(){return c}});var r,i,s,o,a,c,u,l,h=n(46888);!function(e){let t,n,r;!function(e){e.RESERVE="RESERVE",e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.RESERVE=0]="RESERVE",e[e.CONNECT=1]="CONNECT",e[e.STATUS=2]="STATUS"}(n||(n={})),function(e){e.codec=()=>(0,h.Ji)(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=(0,h.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),s.codec().encode(t.peer,n)),null!=t.reservation&&(n.uint32(26),o.codec().encode(t.reservation,n)),null!=t.limit&&(n.uint32(34),a.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(40),c.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=s.codec().decode(t,t.uint32());break;case 3:r.reservation=o.codec().decode(t,t.uint32());break;case 4:r.limit=a.codec().decode(t,t.uint32());break;case 5:r.status=c.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(r||(r={})),function(e){let t,n,r;!function(e){e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.STATUS=1]="STATUS"}(n||(n={})),function(e){e.codec=()=>(0,h.Ji)(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=(0,h.yw)(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),s.codec().encode(t.peer,n)),null!=t.limit&&(n.uint32(26),a.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(32),c.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=s.codec().decode(t,t.uint32());break;case 3:r.limit=a.codec().decode(t,t.uint32());break;case 4:r.status=c.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(i||(i={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const n of e.addrs)t.uint32(18),t.bytes(n);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0),addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(s||(s={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.expire&&0n!==e.expire&&(t.uint32(8),t.uint64(e.expire)),null!=e.addrs)for(const n of e.addrs)t.uint32(18),t.bytes(n);null!=e.voucher&&(t.uint32(26),t.bytes(e.voucher)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={expire:0n,addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.expire=e.uint64();break;case 2:n.addrs.push(e.bytes());break;case 3:n.voucher=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(o||(o={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.duration&&(t.uint32(8),t.uint32(e.duration)),null!=e.data&&(t.uint32(16),t.uint64(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.duration=e.uint32();break;case 2:n.data=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(a||(a={})),function(e){e.UNUSED="UNUSED",e.OK="OK",e.RESERVATION_REFUSED="RESERVATION_REFUSED",e.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONNECTION_FAILED="CONNECTION_FAILED",e.NO_RESERVATION="NO_RESERVATION",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE",e.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"}(c||(c={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.OK=100]="OK",e[e.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",e[e.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",e[e.PERMISSION_DENIED=202]="PERMISSION_DENIED",e[e.CONNECTION_FAILED=203]="CONNECTION_FAILED",e[e.NO_RESERVATION=204]="NO_RESERVATION",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",e[e.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"}(u||(u={})),function(e){e.codec=()=>(0,h.Ji)(u)}(c||(c={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,h.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.relay&&e.relay.byteLength>0&&(t.uint32(10),t.bytes(e.relay)),null!=e.peer&&e.peer.byteLength>0&&(t.uint32(18),t.bytes(e.peer)),null!=e.expiration&&0n!==e.expiration&&(t.uint32(24),t.uint64(e.expiration)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.relay=e.bytes();break;case 2:n.peer=e.bytes();break;case 3:n.expiration=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,h.LE)(t,e.codec()),e.decode=t=>(0,h.C6)(t,e.codec())}(l||(l={}))},52694:function(e,t,n){"use strict";n.d(t,{EO:function(){return a},X8:function(){return o}});n(49541);var r=n(38699),i=n(25674),s=n(59425);n(64188),n(46289);(0,r.kg)("libp2p:circuit-relay:utils");async function o(e){const t=(new TextEncoder).encode(e),n=await s.sha256.digest(t);return i.k0.createV0(n)}function a(e){const t=e*BigInt(1e3),n=(new Date).getTime();return Number(t-BigInt(n))}},20103:function(e,t,n){"use strict";n.d(t,{Bv:function(){return c},C4:function(){return d},D8:function(){return h},G9:function(){return u},Hi:function(){return o},Lw:function(){return r},Oe:function(){return l},PW:function(){return a},aV:function(){return i},b4:function(){return f},mV:function(){return p},wt:function(){return s}});const r=3e4,i=3e4,s=25,o=1,a=5e3,c=25,u=0,l=100,h=10,d=5,f=10,p="last-dial-failure"},90704:function(e,t,n){"use strict";n.d(t,{P:function(){return S},O:function(){return _}});var r=n(49541),i=n(38699),s=n(6540),o=n(76201);const a=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},c=new WeakMap;const u=function({clearTimeout:e,setTimeout:t}={}){return(n,{value:r,signal:i}={})=>{if(i?.aborted)return Promise.reject(a());let s,o,u;const l=e??clearTimeout,h=()=>{l(s),u(a())},d=new Promise(((e,a)=>{o=()=>{i&&i.removeEventListener("abort",h),e(r)},u=a,s=(t??setTimeout)(o,n)}));return i&&i.addEventListener("abort",h,{once:!0}),c.set(d,(()=>{l(s),s=null,o()})),d}}();var l=u;var h,d=n(41455),f=n(53749),p=n(64188),y=n(46888);!function(e){let t,n,r;!function(e){e.UNUSED="UNUSED",e.CONNECT="CONNECT",e.SYNC="SYNC"}(t=e.Type||(e.Type={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.CONNECT=100]="CONNECT",e[e.SYNC=300]="SYNC"}(n||(n={})),function(e){e.codec=()=>(0,y.Ji)(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=(0,y.yw)(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.observedAddresses)for(const e of t.observedAddresses)n.uint32(18),n.bytes(e);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={observedAddresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.observedAddresses.push(t.bytes());break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,y.LE)(t,e.codec()),e.decode=t=>(0,y.C6)(t,e.codec())}(h||(h={}));const g=(0,i.kg)("libp2p:dcutr"),m=5e3,w=3,b=1,E=1;class v{started;timeout;retries;maxInboundStreams;maxOutboundStreams;peerStore;registrar;connectionManager;addressManager;transportManager;topologyId;constructor(e,t){this.started=!1,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.timeout=t.timeout??m,this.retries=t.retries??w,this.maxInboundStreams=t.maxInboundStreams??b,this.maxOutboundStreams=t.maxOutboundStreams??E}isStarted(){return this.started}async start(){this.started||(this.topologyId=await this.registrar.register(_,{onConnect:(e,t)=>{t.transient&&"inbound"===t.direction&&this.upgradeInbound(t).catch((e=>{g.error("error during outgoing DCUtR attempt",e)}))}}),await this.registrar.handle(_,(e=>{this.handleIncomingUpgrade(e.stream,e.connection).catch((t=>{g.error("error during incoming DCUtR attempt",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:!0}),this.started=!0)}async stop(){await this.registrar.unhandle(_),null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async upgradeInbound(e){if(await this.attemptUnilateralConnectionUpgrade(e))return;let t;for(let n=0;n<this.retries;n++){const i={signal:AbortSignal.timeout(this.timeout)};try{t=await e.newStream([_],{signal:i.signal,runOnTransientConnection:!0});const n=(0,d.z)(t,{maxDataLength:4096}).pb(h);g("B sending connect to %p",e.remotePeer);const s=Date.now();await n.write({type:h.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))},i),g("B receiving connect from %p",e.remotePeer);const o=await n.read(i);if(o.type!==h.Type.CONNECT)throw g("A sent wrong message type"),new r.sv("DCUtR message type was incorrect",p.q.ERR_INVALID_MESSAGE);const a=this.getDialableMultiaddrs(o.observedAddresses);if(0===a.length)throw g("A did not have any dialable multiaddrs"),new r.sv("DCUtR connect message had no multiaddrs",p.q.ERR_INVALID_MESSAGE);const c=Date.now()-s;g("A sending sync, rtt %dms",c),await n.write({type:h.Type.SYNC,observedAddresses:[]},i),g("A waiting for half RTT"),await l(c/2),g("B dialing",a);const u=await this.connectionManager.openConnection(a,{signal:i.signal,priority:100});g("DCUtR to %p succeeded to address %a, closing relayed connection",e.remotePeer,u.remoteAddr),await e.close(i);break}catch(e){if(g.error("error while attempting DCUtR on attempt %d of %d",n+1,this.retries,e),t?.abort(e),n===this.retries)throw e}finally{null!=t&&await t.close(i)}}}async attemptUnilateralConnectionUpgrade(e){const t=(await this.peerStore.get(e.remotePeer)).addresses.map((t=>{const n=t.multiaddr;return null==n.getPeerId()?n.encapsulate(`/p2p/${e.remotePeer}`):n})).filter((e=>this.isPublicAndDialable(e)));if(t.length>0){const n=AbortSignal.timeout(this.timeout);try{g("attempting unilateral connection upgrade to %a",t);const r=await this.connectionManager.openConnection(t,{signal:n,force:!0});if(r.transient)throw new Error("Could not open a new, non-transient, connection");return g("unilateral connection upgrade to %p succeeded via %a, closing relayed connection",e.remotePeer,r.remoteAddr),await e.close(),!0}catch(n){g.error("unilateral connection upgrade to %p on addresses %a failed",e.remotePeer,t,n)}}else g("peer %p has no public addresses, not attempting unilateral connection upgrade",e.remotePeer);return!1}async handleIncomingUpgrade(e,t){const n={signal:AbortSignal.timeout(this.timeout)};try{const i=(0,d.z)(e,{maxDataLength:4096}).pb(h);g("A receiving connect");const s=await i.read(n);if(s.type!==h.Type.CONNECT)throw g("B sent wrong message type"),new r.sv("DCUtR message type was incorrect",p.q.ERR_INVALID_MESSAGE);if(0===s.observedAddresses.length)throw g("B sent no multiaddrs"),new r.sv("DCUtR connect message had no multiaddrs",p.q.ERR_INVALID_MESSAGE);const o=this.getDialableMultiaddrs(s.observedAddresses);if(0===o.length)throw g("B had no dialable multiaddrs"),new r.sv("DCUtR connect message had no dialable multiaddrs",p.q.ERR_INVALID_MESSAGE);g("A sending connect"),await i.write({type:h.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))}),g("A receiving sync");if((await i.read(n)).type!==h.Type.SYNC)throw new r.sv("DCUtR message type was incorrect",p.q.ERR_INVALID_MESSAGE);g("A dialing",o);const a=await this.connectionManager.openConnection(o,{signal:n.signal,priority:100,force:!0});g("DCUtR to %p succeeded via %a, closing relayed connection",t.remotePeer,a.remoteAddr),await t.close(n)}catch(n){g.error("incoming DCUtR from %p failed",t.remotePeer,n),e.abort(n)}finally{await e.close(n)}}getDialableMultiaddrs(e){const t=[];for(const n of e)if(null!=n&&0!==n.length)try{const e=(0,s.HM)(n);if(!this.isPublicAndDialable(e))continue;t.push(e)}catch{}return t}isPublicAndDialable(e){if(o.dx.matches(e))return!1;if(o.Rk.matches(e))return!0;if(!o.IP.matches(e))return!1;if(null==this.transportManager.transportForMultiaddr(e))return!1;const t=e.toOptions();return!1===(0,f.Z)(t.host)}}const _="/libp2p/dcutr";function S(e={}){return t=>new v(t,e)}},64188:function(e,t,n){"use strict";var r,i;n.d(t,{q:function(){return i},s:function(){return r}}),function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(r||(r={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",e.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"}(i||(i={}))},31027:function(e,t,n){"use strict";n.d(t,{HA:function(){return v}});const r=`js-libp2p/${n(11877).i}`;var i,s=n(17187),o=n(49541),a=n(38699),c=n(34042),u=n(76626),l=n(6540),h=n(41455),d=n(97858),f=n(2291),p=n(14560),y=n(64188),g=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,g.yw)(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const n of e.listenAddrs)t.uint32(18),t.bytes(n);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const n of e.protocols)t.uint32(26),t.string(n);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={listenAddrs:[],protocols:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 5:n.protocolVersion=e.string();break;case 6:n.agentVersion=e.string();break;case 1:n.publicKey=e.bytes();break;case 2:n.listenAddrs.push(e.bytes());break;case 4:n.observedAddr=e.bytes();break;case 3:n.protocols.push(e.string());break;case 8:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,g.LE)(t,e.codec()),e.decode=t=>(0,g.C6)(t,e.codec())}(i||(i={}));const m=(0,a.kg)("libp2p:identify"),w=8192,b={protocolPrefix:"ipfs",agentVersion:r,timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1,maxObservedAddresses:10,maxIdentifyMessageSize:8192,runOnConnectionOpen:!0,runOnTransientConnection:!0};class E{identifyProtocolStr;identifyPushProtocolStr;host;started;timeout;peerId;peerStore;registrar;connectionManager;addressManager;maxInboundStreams;maxOutboundStreams;maxPushIncomingStreams;maxPushOutgoingStreams;maxIdentifyMessageSize;maxObservedAddresses;events;runOnTransientConnection;constructor(e,t){this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.events=e.events,this.identifyProtocolStr=`/${t.protocolPrefix??b.protocolPrefix}/id/1.0.0`,this.identifyPushProtocolStr=`/${t.protocolPrefix??b.protocolPrefix}/id/push/1.0.0`,this.timeout=t.timeout??b.timeout,this.maxInboundStreams=t.maxInboundStreams??b.maxInboundStreams,this.maxOutboundStreams=t.maxOutboundStreams??b.maxOutboundStreams,this.maxPushIncomingStreams=t.maxPushIncomingStreams??b.maxPushIncomingStreams,this.maxPushOutgoingStreams=t.maxPushOutgoingStreams??b.maxPushOutgoingStreams,this.maxIdentifyMessageSize=t.maxIdentifyMessageSize??b.maxIdentifyMessageSize,this.maxObservedAddresses=t.maxObservedAddresses??b.maxObservedAddresses,this.runOnTransientConnection=t.runOnTransientConnection??b.runOnTransientConnection,this.host={protocolVersion:`${t.protocolPrefix??b.protocolPrefix}/0.1.0`,agentVersion:t.agentVersion??b.agentVersion},(t.runOnConnectionOpen??b.runOnConnectionOpen)&&e.events.addEventListener("connection:open",(e=>{const t=e.detail;this.identify(t).catch((e=>{m.error("error during identify trigged by connection:open",e)}))})),e.events.addEventListener("self:peer:update",(e=>{this.push().catch((e=>{m.error(e)}))})),this.host.agentVersion===r&&(p.UG||p.$l?this.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(p.jU||p.n2||p.iP||p.b$)&&(this.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`))}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:(0,d.m)(this.host.agentVersion),ProtocolVersion:(0,d.m)(this.host.protocolVersion)}}),await this.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{m.error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),await this.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{m.error(e)}))}),{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.identifyProtocolStr),await this.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async pushToConnections(e){const t=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,l.a_)("p2p").code))),n=new u.K({peerId:this.peerId,multiaddrs:t}),r=await u.X.seal(n,this.peerId),o=this.registrar.getProtocols(),a=await this.peerStore.get(this.peerId),c=(0,f.B)(a.metadata.get("AgentVersion")??(0,d.m)(this.host.agentVersion)),p=(0,f.B)(a.metadata.get("ProtocolVersion")??(0,d.m)(this.host.protocolVersion)),y=e.map((async e=>{let n;const a=AbortSignal.timeout(this.timeout);try{(0,s.setMaxListeners)?.(1/0,a)}catch{}try{n=await e.newStream([this.identifyPushProtocolStr],{signal:a,runOnTransientConnection:this.runOnTransientConnection});const s=(0,h.z)(n,{maxDataLength:this.maxIdentifyMessageSize??w}).pb(i);await s.write({listenAddrs:t.map((e=>e.bytes)),signedPeerRecord:r.marshal(),protocols:o,agentVersion:c,protocolVersion:p},{signal:a}),await n.close({signal:a})}catch(e){m.error("could not push identify update to peer",e),n?.abort(e)}}));await Promise.all(y)}async push(){if(!this.isStarted())return;const e=[];await Promise.all(this.connectionManager.getConnections().map((async t=>{try{if(!(await this.peerStore.get(t.remotePeer)).protocols.includes(this.identifyPushProtocolStr))return;e.push(t)}catch(e){if(e.code!==y.q.ERR_NOT_FOUND)throw e}}))),await this.pushToConnections(e)}async _identify(e,t={}){let n;t.signal=t.signal??AbortSignal.timeout(this.timeout);try{n=await e.newStream([this.identifyProtocolStr],{...t,runOnTransientConnection:this.runOnTransientConnection});const r=(0,h.z)(n,{maxDataLength:this.maxIdentifyMessageSize??w}).pb(i),s=await r.read(t);return await n.close(t),s}catch(e){throw m.error("error while reading identify message",e),n?.abort(e),e}}async identify(e,t={}){const n=await this._identify(e,t),{publicKey:r,protocols:i,observedAddr:s}=n;if(null==r)throw new o.sv("public key was missing from identify message",y.q.ERR_MISSING_PUBLIC_KEY);const a=await(0,c.y5)(r);if(!e.remotePeer.equals(a))throw new o.sv("identified peer does not match the expected peer",y.q.ERR_INVALID_PEER);if(this.peerId.equals(a))throw new o.sv("identified peer is our own peer id?",y.q.ERR_INVALID_PEER);const u=function(e){if(null!=e&&e.length>0)try{return(0,l.HM)(e)}catch{}}(s);m("identify completed for peer %p and protocols %o",a,i),m("our observed address is %a",u),null!=u&&this.addressManager.getObservedAddrs().length<(this.maxObservedAddresses??1/0)&&(m("storing our observed address %a",u),this.addressManager.addObservedAddr(u));const h=await this.#c(e.remotePeer,n),d={peerId:a,protocolVersion:n.protocolVersion,agentVersion:n.agentVersion,publicKey:n.publicKey,listenAddrs:n.listenAddrs.map((e=>(0,l.HM)(e))),observedAddr:null==n.observedAddr?void 0:(0,l.HM)(n.observedAddr),protocols:n.protocols,signedPeerRecord:h};return this.events.safeDispatchEvent("peer:identify",{detail:d}),d}async _handleIdentify(e){const{connection:t,stream:n}=e,r=AbortSignal.timeout(this.timeout);try{(0,s.setMaxListeners)?.(1/0,r)}catch{}try{const e=this.peerId.publicKey??new Uint8Array(0),s=await this.peerStore.get(this.peerId),o=this.addressManager.getAddresses().map((e=>e.decapsulateCode((0,l.a_)("p2p").code)));let a=s.peerRecordEnvelope;if(o.length>0&&null==a){const e=new u.K({peerId:this.peerId,multiaddrs:o});a=(await u.X.seal(e,this.peerId)).marshal().subarray()}const c=(0,h.z)(n).pb(i);await c.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:o.map((e=>e.bytes)),signedPeerRecord:a,observedAddr:t.remoteAddr.bytes,protocols:s.protocols},{signal:r}),await n.close({signal:r})}catch(e){m.error("could not respond to identify request",e),n.abort(e)}}async _handlePush(e){const{connection:t,stream:n}=e;try{if(this.peerId.equals(t.remotePeer))throw new Error("received push from ourselves?");const e={signal:AbortSignal.timeout(this.timeout)},r=(0,h.z)(n,{maxDataLength:this.maxIdentifyMessageSize??w}).pb(i),s=await r.read(e);await n.close(e),await this.#c(t.remotePeer,s)}catch(e){return m.error("received invalid message",e),void n.abort(e)}m("handled push from %p",t.remotePeer)}async#c(e,t){if(m("received identify from %p",e),null==t)throw new Error("Message was null or undefined");const n={addresses:t.listenAddrs.map((e=>({isCertified:!1,multiaddr:(0,l.HM)(e)}))),protocols:t.protocols,metadata:new Map,peerRecordEnvelope:t.signedPeerRecord};let r;if(null!=t.signedPeerRecord){m("received signedPeerRecord in push from %p",e);let i=t.signedPeerRecord;const s=await u.X.openAndCertify(i,u.K.DOMAIN);let o,a=u.K.createFromProtobuf(s.payload);if(!a.peerId.equals(s.peerId))throw new Error("signing key does not match PeerId in the PeerRecord");if(!e.equals(a.peerId))throw new Error("signing key does not match remote PeerId");try{o=await this.peerStore.get(a.peerId)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=o&&(n.metadata=o.metadata,null!=o.peerRecordEnvelope)){const e=await u.X.createFromProtobuf(o.peerRecordEnvelope),t=u.K.createFromProtobuf(e.payload);t.seqNumber>=a.seqNumber&&(m("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,a.seqNumber),a=t,i=o.peerRecordEnvelope)}n.peerRecordEnvelope=i,n.addresses=a.multiaddrs.map((e=>({isCertified:!0,multiaddr:e}))),r={seq:a.seqNumber,addresses:a.multiaddrs}}else m("%p did not send a signed peer record",e);return null!=t.agentVersion&&n.metadata.set("AgentVersion",(0,d.m)(t.agentVersion)),null!=t.protocolVersion&&n.metadata.set("ProtocolVersion",(0,d.m)(t.protocolVersion)),await this.peerStore.patch(e,n),r}}function v(e={}){return t=>new E(t,e)}},12021:function(e,t,n){"use strict";n.d(t,{N:function(){return Dr}});var r=n(17187),i=n(77755),s=n(27710),o=n(49541),a=n(23247),c=n(85521),u=n(77309),l=(n(12899),n(63894),n(3068),n(97450),n(3832)),h=n(61743),d=n(45199),f=(n(41277),n(1337)),p=n(13651);n(3138);var y=n(51097);const g={rsa:n(91618),ed25519:d,secp256k1:n(91882)};function m(e){const t=Object.keys(g).join(" / ");return new o.sv(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function w(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return g[e];throw m(e)}async function b(e){const t=y._q.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case y.Jz.RSA:return g.rsa.unmarshalRsaPrivateKey(n);case y.Jz.Ed25519:return g.ed25519.unmarshalEd25519PrivateKey(n);case y.Jz.Secp256k1:return g.secp256k1.unmarshalSecp256k1PrivateKey(n);default:throw m(t.Type??"RSA")}}async function E(e,t){try{const n=await async function(e,t){const n=f.base64.decode(e);return p.U().decrypt(n,t)}(e,t);return await b(n)}catch(e){}const n=l.pki.decryptRsaPrivateKey(e,t);if(null===n)throw new o.sv("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let r=l.asn1.toDer(l.pki.privateKeyToAsn1(n));return r=(0,h.m)(r.getBytes(),"ascii"),g.rsa.unmarshalRsaPrivateKey(r)}var v=n(98960),_=n(97116);const S={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function R(e,t,n,r,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){const e=Object.keys(S).join(" / ");throw new o.sv(`Hash '${i}' is unknown or not supported. Must be ${e}`,"ERR_UNSUPPORTED_HASH_TYPE")}const s=v(e,t,n,r,S[i]);return _.encode64(s,null)}var A=n(29727),I=n(93480),T=n(5681),C=n(39646),P=n(98721),k=n(71030),N=n(88580),x=n(28214),D=n(14413),L=n(53574);const O=Symbol.for("nodejs.util.inspect.custom"),U=Object.values(P.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),P.gh.identity.decoder),M=114,B=36,z=37;class V{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[T.N]=!0;toString(){return null==this.string&&(this.string=C.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return k.k0.createV1(M,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,L.f)(this.multihash.bytes,e);if("string"==typeof e)return function(e,t){if(t=t??U,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=N.Jx(C.base58btc.decode(`z${e}`));return e.startsWith("12D")?new F({multihash:t}):e.startsWith("16U")?new j({multihash:t}):new $({multihash:t})}return function(e){try{const t=N.Jx(e);if(t.code===x.identity.code){if(t.digest.length===B)return new F({multihash:t});if(t.digest.length===z)return new j({multihash:t})}if(t.code===D.sha256.code)return new $({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==M)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===D.sha256.code)return new $({multihash:e.multihash});if(t.code===x.identity.code){if(t.digest.length===B)return new F({multihash:e.multihash});if(t.digest.length===z)return new j({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(k.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(U.decode(e))}(e).equals(this);if(null!=e?.multihash?.bytes)return(0,L.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[O](){return`PeerId(${this.toString()})`}}class $ extends V{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class F extends V{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class j extends V{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}var K=n(53416),q=n(9135),H=n(58018);function G(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Z=G("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),W=G("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,H.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}));var Q={utf8:Z,"utf-8":Z,hex:q.gh.base16,latin1:W,ascii:W,binary:W,...q.gh},Y=n(63658);const J="/",X=(new TextEncoder).encode(J),ee=X[0];class te{_buf;constructor(e,t){if("string"==typeof e)this._buf=function(e,t="utf8"){const n=Q[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,Y.P)(globalThis.Buffer.from(e,"utf-8"))}(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==ee)throw new Error("Invalid key")}toString(e="utf8"){return function(e,t="utf8"){const n=Q[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new te(e.join(J))}static random(){return new te((0,K.x0)().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new te(e):"function"==typeof e.uint8Array?new te(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=X),this._buf[0]!==ee){const e=new Uint8Array(this._buf.byteLength+1);e.fill(ee,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ee;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let e=0;e<t.length;e++){if(n.length<e+1)return!1;const r=t[e],i=n[e];if(r<i)return!0;if(r>i)return!1}return t.length<n.length}reverse(){return te.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(J).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new te(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(J)||(e+=J),e+=this.type(),new te(e)}parent(){const e=this.list();return 1===e.length?new te(J):new te(e.slice(0,-1).join(J))}child(e){return this.toString()===J?e:e.toString()===J?this:new te(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return te.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}var ne,re=n(79221),ie=n(50202),se=n(42393);!function(e){e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"}(ne||(ne={}));const oe=(0,I.kg)("libp2p:keychain"),ae="/info/",ce=new WeakMap,ue=14,le=16,he=1e3,de={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function fe(e){return null!=e&&("string"==typeof e&&(e===ie(e.trim())&&e.length>0))}async function pe(){const e=800*Math.random()+200;await new Promise((t=>setTimeout(t,e)))}function ye(e){return new te("/pkcs8/"+e)}function ge(e){return new te(ae+e)}class me{components;init;constructor(e,t){if(this.components=e,this.init=(0,re.Z)(de,t),null!=this.init.pass&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(null!=this.init.dek?.keyLength&&this.init.dek.keyLength<ue)throw new Error(`dek.keyLength must be least ${ue} bytes`);if(null!=this.init.dek?.salt?.length&&this.init.dek.salt.length<le)throw new Error(`dek.saltLength must be least ${le} bytes`);if(null!=this.init.dek?.iterationCount&&this.init.dek.iterationCount<he)throw new Error(`dek.iterationCount must be least ${he}`);const n=null!=this.init.pass&&null!=this.init.dek?.salt?R(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";ce.set(this,{dek:n})}static generateOptions(){const e=Object.assign({},de),t=3*Math.ceil(le/3);return e.dek.salt=(0,se.B)((0,A.Z)(t),"base64"),e}static get options(){return de}async createKey(e,t,n=2048){if(!fe(e)||"self"===e)throw await pe(),new o.sv("Invalid key name",ne.ERR_INVALID_KEY_NAME);if("string"!=typeof t)throw await pe(),new o.sv("Invalid key type",ne.ERR_INVALID_KEY_TYPE);const r=ye(e);if(await this.components.datastore.has(r))throw await pe(),new o.sv("Key name already exists",ne.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase())if(!Number.isSafeInteger(n)||n<2048)throw await pe(),new o.sv("Invalid RSA key size",ne.ERR_INVALID_KEY_SIZE);let i;try{const s=await async function(e,t){return w(e).generateKeyPair(t??2048)}(t,n),a=await s.id(),c=ce.get(this);if(null==c)throw new o.sv("dek missing",ne.ERR_INVALID_PARAMETERS);const u=c.dek,l=await s.export(u);i={name:e,id:a};const d=this.components.datastore.batch();d.put(r,(0,h.m)(l)),d.put(ge(e),(0,h.m)(JSON.stringify(i))),await d.commit()}catch(e){throw await pe(),e}return i}async listKeys(){const e={prefix:ae},t=[];for await(const n of this.components.datastore.query(e))t.push(JSON.parse((0,se.B)(n.value)));return t}async findKeyById(e){try{const t=(await this.listKeys()).find((t=>t.id===e));if(null==t)throw new o.sv(`Key with id '${e}' does not exist.`,ne.ERR_KEY_NOT_FOUND);return t}catch(e){throw await pe(),e}}async findKeyByName(e){if(!fe(e))throw await pe(),new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);const t=ge(e);try{const e=await this.components.datastore.get(t);return JSON.parse((0,se.B)(e))}catch(t){throw await pe(),oe.error(t),new o.sv(`Key '${e}' does not exist.`,ne.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!fe(e)||"self"===e)throw await pe(),new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);const t=ye(e),n=await this.findKeyByName(e),r=this.components.datastore.batch();return r.delete(t),r.delete(ge(e)),await r.commit(),n}async renameKey(e,t){if(!fe(e)||"self"===e)throw await pe(),new o.sv(`Invalid old key name '${e}'`,ne.ERR_OLD_KEY_NAME_INVALID);if(!fe(t)||"self"===t)throw await pe(),new o.sv(`Invalid new key name '${t}'`,ne.ERR_NEW_KEY_NAME_INVALID);const n=ye(e),r=ye(t),i=ge(e),s=ge(t);if(await this.components.datastore.has(r))throw await pe(),new o.sv(`Key '${t}' already exists`,ne.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(n),o=await this.components.datastore.get(i),a=JSON.parse((0,se.B)(o));a.name=t;const c=this.components.datastore.batch();return c.put(r,e),c.put(s,(0,h.m)(JSON.stringify(a))),c.delete(n),c.delete(i),await c.commit(),a}catch(e){throw await pe(),e}}async exportKey(e,t){if(!fe(e))throw await pe(),new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);if(null==t)throw await pe(),new o.sv("Password is required",ne.ERR_PASSWORD_REQUIRED);const n=ye(e);try{const e=await this.components.datastore.get(n),r=(0,se.B)(e),i=ce.get(this);if(null==i)throw new o.sv("dek missing",ne.ERR_INVALID_PARAMETERS);const s=i.dek,a=await E(r,s);return await a.export(t)}catch(e){throw await pe(),e}}async exportPeerId(e){const t="temporary-password",n=await this.exportKey(e,t),r=await E(n,t);return async function(e,t){return e.length===B?new F({multihash:N.Ue(x.identity.code,e),privateKey:t}):e.length===z?new j({multihash:N.Ue(x.identity.code,e),privateKey:t}):new $({multihash:await D.sha256.digest(e),publicKey:e,privateKey:t})}(r.public.bytes,r.bytes)}async importKey(e,t,n){if(!fe(e)||"self"===e)throw await pe(),new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);if(null==t)throw await pe(),new o.sv("PEM encoded key is required",ne.ERR_PEM_REQUIRED);const r=ye(e);if(await this.components.datastore.has(r))throw await pe(),new o.sv(`Key '${e}' already exists`,ne.ERR_KEY_ALREADY_EXISTS);let i,s;try{i=await E(t,n)}catch(e){throw await pe(),new o.sv("Cannot read the key, most likely the password is wrong",ne.ERR_CANNOT_READ_KEY)}try{s=await i.id();const e=ce.get(this);if(null==e)throw new o.sv("dek missing",ne.ERR_INVALID_PARAMETERS);const n=e.dek;t=await i.export(n)}catch(e){throw await pe(),e}const a={name:e,id:s},c=this.components.datastore.batch();return c.put(r,(0,h.m)(t)),c.put(ge(e),(0,h.m)(JSON.stringify(a))),await c.commit(),a}async importPeer(e,t){try{if(!fe(e))throw new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);if(null==t)throw new o.sv("PeerId is required",ne.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw new o.sv("PeerId.privKey is required",ne.ERR_MISSING_PRIVATE_KEY);const n=await b(t.privateKey),r=ye(e);if(await this.components.datastore.has(r))throw await pe(),new o.sv(`Key '${e}' already exists`,ne.ERR_KEY_ALREADY_EXISTS);const i=ce.get(this);if(null==i)throw new o.sv("dek missing",ne.ERR_INVALID_PARAMETERS);const s=i.dek,a=await n.export(s),c={name:e,id:t.toString()},u=this.components.datastore.batch();return u.put(r,(0,h.m)(a)),u.put(ge(e),(0,h.m)(JSON.stringify(c))),await u.commit(),c}catch(e){throw await pe(),e}}async getPrivateKey(e){if(!fe(e))throw await pe(),new o.sv(`Invalid key name '${e}'`,ne.ERR_INVALID_KEY_NAME);try{const t=ye(e),n=await this.components.datastore.get(t);return(0,se.B)(n)}catch(t){throw await pe(),oe.error(t),new o.sv(`Key '${e}' does not exist.`,ne.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if("string"!=typeof e)throw await pe(),new o.sv(`Invalid old pass type '${typeof e}'`,ne.ERR_INVALID_OLD_PASS_TYPE);if("string"!=typeof t)throw await pe(),new o.sv(`Invalid new pass type '${typeof t}'`,ne.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await pe(),new o.sv(`Invalid pass length ${t.length}`,ne.ERR_INVALID_PASS_LENGTH);oe("recreating keychain");const n=ce.get(this);if(null==n)throw new o.sv("dek missing",ne.ERR_INVALID_PARAMETERS);const r=n.dek;this.init.pass=t;const i=null!=t&&null!=this.init.dek?.salt?R(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";ce.set(this,{dek:i});const s=await this.listKeys();for(const e of s){const t=await this.components.datastore.get(ye(e.name)),n=(0,se.B)(t),s=await E(n,r),o=i.toString(),a=await s.export(o),c=this.components.datastore.batch(),u={name:e.name,id:e.id};c.put(ye(e.name),(0,h.m)(a)),c.put(ge(e.name),(0,h.m)(JSON.stringify(u))),await c.commit()}oe("keychain reconstructed")}}var we=n(38699),be=n(67483),Ee=n(34042),ve=n(45045),_e=n(81992),Se=n(59526),Re=n(52801),Ae=(n(28619),n(79288),n(94454),n(10618));const Ie={rsa:n(11842),ed25519:Re,secp256k1:n(26253)};function Te(e){const t=Object.keys(Ie).join(" / ");return new o.sv(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}async function Ce(e){const t=Ae._q.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case Ae.Jz.RSA:return Ie.rsa.unmarshalRsaPrivateKey(n);case Ae.Jz.Ed25519:return Ie.ed25519.unmarshalEd25519PrivateKey(n);case Ae.Jz.Secp256k1:return Ie.secp256k1.unmarshalSecp256k1PrivateKey(n);default:throw Te(t.Type??"RSA")}}var Pe=n(99858),ke=n(834),Ne=n(55609),xe=n(52528),De=n(44108),Le=n(37566),Oe=n(55374);const Ue=Symbol.for("nodejs.util.inspect.custom"),Me=Object.values(ke.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),ke.gh.identity.decoder),Be=114,ze=36,Ve=37;class $e{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[T.N]=!0;toString(){return null==this.string&&(this.string=Pe.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ne.k0.createV1(Be,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,Oe.f)(this.multihash.bytes,e);if("string"==typeof e)return function(e,t){if(t=t??Me,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=xe.Jx(Pe.base58btc.decode(`z${e}`));return e.startsWith("12D")?new je({multihash:t}):e.startsWith("16U")?new Ke({multihash:t}):new Fe({multihash:t})}return qe(Me.decode(e))}(e).equals(this);if(null!=e?.multihash?.bytes)return(0,Oe.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Ue](){return`PeerId(${this.toString()})`}}class Fe extends $e{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class je extends $e{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class Ke extends $e{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function qe(e){try{const t=xe.Jx(e);if(t.code===De.identity.code){if(t.digest.length===ze)return new je({multihash:t});if(t.digest.length===Ve)return new Ke({multihash:t})}if(t.code===Le.sha256.code)return new Fe({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Be)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Le.sha256.code)return new Fe({multihash:e.multihash});if(t.code===De.identity.code){if(t.digest.length===ze)return new je({multihash:e.multihash});if(t.digest.length===Ve)return new Ke({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Ne.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}var He=n(57050),Ge=n(62308);const Ze="ERR_SIGNATURE_NOT_VALID";var We,Qe=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(We||(We={}));class Ye{static createFromProtobuf=async e=>{const t=We.decode(e),n=await async function(e,t){return e.length===ze?new je({multihash:xe.Ue(De.identity.code,e),privateKey:t}):e.length===Ve?new Ke({multihash:xe.Ue(De.identity.code,e),privateKey:t}):new Fe({multihash:await Le.sha256.digest(e),publicKey:e,privateKey:t})}(t.publicKey);return new Ye({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})};static seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,r=e.codec,i=e.marshal(),s=Je(n,r,i),o=await Ce(t.privateKey),a=await o.sign(s.subarray());return new Ye({peerId:t,payloadType:r,payload:i,signature:a})};static openAndCertify=async(e,t)=>{const n=await Ye.createFromProtobuf(e);if(!await n.validate(t))throw new o.sv("envelope signature is not valid for the given domain",Ze);return n};peerId;payloadType;payload;signature;marshaled;constructor(e){const{peerId:t,payloadType:n,payload:r,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=We.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return(0,Oe.f)(this.marshal(),e.marshal())}async validate(e){const t=Je(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");return function(e){const t=Ae.nh.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case Ae.Jz.RSA:return Ie.rsa.unmarshalRsaPublicKey(n);case Ae.Jz.Ed25519:return Ie.ed25519.unmarshalEd25519PublicKey(n);case Ae.Jz.Secp256k1:return Ie.secp256k1.unmarshalSecp256k1PublicKey(n);default:throw Te(t.Type??"unknown")}}(this.peerId.publicKey).verify(t.subarray(),this.signature)}}const Je=(e,t,n)=>{const r=(0,Se.m)(e),i=He.cv(r.byteLength),s=He.cv(t.length),o=He.cv(n.length);return new Ge.H(i,r,s,t,o,n)};var Xe=n(55643),et=n(55728);const tt=Uint8Array.from([3,1]);var nt;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3==1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=(0,Qe.yw)(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const r of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(r,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),n),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(nt||(nt={}));class rt{static createFromProtobuf=e=>{const t=nt.decode(e),n=qe(t.peerId),r=(t.addresses??[]).map((e=>(0,et.HM)(e.multiaddr))),i=t.seq;return new rt({peerId:n,multiaddrs:r,seqNumber:i})};static DOMAIN="libp2p-peer-record";static CODEC=tt;peerId;multiaddrs;seqNumber;domain=rt.DOMAIN;codec=rt.CODEC;marshaled;constructor(e){const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=n??[],this.seqNumber=r??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=nt.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof rt&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!(0,Xe._)(this.multiaddrs,e.multiaddrs)))}}var it=n(86731),st=n(56027),ot=n(17314);const at={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var ct,ut,lt;function ht(e,t){const n=ct.decode(t);null!=n.publicKey&&null==e.publicKey&&(e=function(e){if("RSA"===e.type)return new Fe(e);if("Ed25519"===e.type)return new je(e);if("secp256k1"===e.type)return new Ke(e);throw new o.sv("Not a PeerId","ERR_INVALID_PARAMETERS")}({...e,publicKey:e.publicKey}));const r=new Map,i=BigInt(Date.now());for(const[e,t]of n.tags.entries())null!=t.expiry&&t.expiry<i||r.set(e,t);return{...n,id:e,addresses:n.addresses.map((({multiaddr:e,isCertified:t})=>({multiaddr:(0,et.HM)(e),isCertified:t??!1}))),metadata:n.metadata,peerRecordEnvelope:n.peerRecordEnvelope??void 0,tags:r}}!function(e){let t,n,r;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:"",value:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(t=e.Peer$metadataEntry||(e.Peer$metadataEntry={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&(t.uint32(18),lt.codec().encode(e.value,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=lt.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(n=e.Peer$tagsEntry||(e.Peer$tagsEntry={})),e.codec=()=>(null==r&&(r=(0,Qe.yw)(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.addresses)for(const e of t.addresses)n.uint32(10),ut.codec().encode(e,n);if(null!=t.protocols)for(const e of t.protocols)n.uint32(18),n.string(e);if(null!=t.publicKey&&(n.uint32(34),n.bytes(t.publicKey)),null!=t.peerRecordEnvelope&&(n.uint32(42),n.bytes(t.peerRecordEnvelope)),null!=t.metadata&&0!==t.metadata.size)for(const[r,i]of t.metadata.entries())n.uint32(50),e.Peer$metadataEntry.codec().encode({key:r,value:i},n);if(null!=t.tags&&0!==t.tags.size)for(const[r,i]of t.tags.entries())n.uint32(58),e.Peer$tagsEntry.codec().encode({key:r,value:i},n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={addresses:[],protocols:[],metadata:new Map,tags:new Map},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.addresses.push(ut.codec().decode(t,t.uint32()));break;case 2:r.protocols.push(t.string());break;case 4:r.publicKey=t.bytes();break;case 5:r.peerRecordEnvelope=t.bytes();break;case 6:{const n=e.Peer$metadataEntry.codec().decode(t,t.uint32());r.metadata.set(n.key,n.value);break}case 7:{const n=e.Peer$tagsEntry.codec().decode(t,t.uint32());r.tags.set(n.key,n.value);break}default:t.skipType(7&n)}}return r}))),r),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(ct||(ct={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(ut||(ut={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Qe.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.value&&0!==e.value&&(t.uint32(8),t.uint32(e.value)),null!=e.expiry&&(t.uint32(16),t.uint64(e.expiry)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={value:0},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.value=e.uint32();break;case 2:n.expiry=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,Qe.LE)(t,e.codec()),e.decode=t=>(0,Qe.C6)(t,e.codec())}(lt||(lt={}));var dt=n(16163),ft=n(69339);function pt(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const yt=pt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),gt=pt("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,ft.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}));var mt={utf8:yt,"utf-8":yt,hex:dt.gh.base16,latin1:gt,ascii:gt,binary:gt,...dt.gh},wt=n(6513);const bt="/",Et=(new TextEncoder).encode(bt),vt=Et[0];class _t{_buf;constructor(e,t){if("string"==typeof e)this._buf=function(e,t="utf8"){const n=mt[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,wt.P)(globalThis.Buffer.from(e,"utf-8"))}(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==vt)throw new Error("Invalid key")}toString(e="utf8"){return function(e,t="utf8"){const n=mt[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new _t(e.join(bt))}static random(){return new _t((0,K.x0)().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new _t(e):"function"==typeof e.uint8Array?new _t(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Et),this._buf[0]!==vt){const e=new Uint8Array(this._buf.byteLength+1);e.fill(vt,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===vt;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let e=0;e<t.length;e++){if(n.length<e+1)return!1;const r=t[e],i=n[e];if(r<i)return!0;if(r>i)return!1}return t.length<n.length}reverse(){return _t.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(bt).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new _t(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(bt)||(e+=bt),e+=this.type(),new _t(e)}parent(){const e=this.list();return 1===e.length?new _t(bt):new _t(e.slice(0,-1).join(bt))}child(e){return this.toString()===bt?e:e.toString()===bt?this:new _t(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return _t.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}const St="/peers/";function Rt(e){if(!(0,T.I)(e)||null==e.type)throw new o.sv("Invalid PeerId",at.ERR_INVALID_PARAMETERS);const t=e.toCID().toString();return new _t(`${St}${t}`)}async function At(e,t,n){const r=new Map;for(const i of n){if(null==i)continue;if(i.multiaddr instanceof Uint8Array&&(i.multiaddr=(0,et.HM)(i.multiaddr)),!(0,et.h2)(i.multiaddr))throw new o.sv("Multiaddr was invalid",at.ERR_INVALID_PARAMETERS);if(!await t(e,i.multiaddr))continue;const n=i.isCertified??!1,s=i.multiaddr.toString(),a=r.get(s);null!=a?i.isCertified=a.isCertified||n:r.set(s,{multiaddr:i.multiaddr,isCertified:n})}return[...r.values()].sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((({isCertified:e,multiaddr:t})=>({isCertified:e,multiaddr:t.bytes})))}async function It(e,t,n,r){if(null==t)throw new o.sv("Invalid PeerData",at.ERR_INVALID_PARAMETERS);if(null!=t.publicKey&&null!=e.publicKey&&!(0,Oe.f)(t.publicKey,e.publicKey))throw new o.sv("publicKey bytes do not match peer id publicKey bytes",at.ERR_INVALID_PARAMETERS);const i=r.existingPeer;if(null!=i&&!e.equals(i.id))throw new o.sv("peer id did not match existing peer id",at.ERR_INVALID_PARAMETERS);let s=i?.addresses??[],a=new Set(i?.protocols??[]),c=i?.metadata??new Map,u=i?.tags??new Map,l=i?.peerRecordEnvelope;if("patch"===n){if(null==t.multiaddrs&&null==t.addresses||(s=[],null!=t.multiaddrs&&s.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&s.push(...t.addresses)),null!=t.protocols&&(a=new Set(t.protocols)),null!=t.metadata){c=Tt(t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata),{validate:Ct})}if(null!=t.tags){u=Tt(t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),{validate:Pt,map:kt})}null!=t.peerRecordEnvelope&&(l=t.peerRecordEnvelope)}if("merge"===n){if(null!=t.multiaddrs&&s.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&s.push(...t.addresses),null!=t.protocols&&(a=new Set([...a,...t.protocols])),null!=t.metadata){const e=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);for(const[t,n]of e)null==n?c.delete(t):c.set(t,n);c=Tt([...c.entries()],{validate:Ct})}if(null!=t.tags){const e=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),n=new Map(u);for(const[t,r]of e)null==r?n.delete(t):n.set(t,r);u=Tt([...n.entries()],{validate:Pt,map:kt})}null!=t.peerRecordEnvelope&&(l=t.peerRecordEnvelope)}const h={addresses:await At(e,r.addressFilter??(async()=>!0),s),protocols:[...a.values()].sort(((e,t)=>e.localeCompare(t))),metadata:c,tags:u,publicKey:i?.id.publicKey??t.publicKey??e.publicKey,peerRecordEnvelope:l};return"RSA"!==e.type&&delete h.publicKey,h}function Tt(e,t){const n=new Map;for(const[n,r]of e)null!=r&&t.validate(n,r);for(const[r,i]of e.sort((([e],[t])=>e.localeCompare(t))))null!=i&&n.set(r,t.map?.(r,i)??i);return n}function Ct(e,t){if("string"!=typeof e)throw new o.sv("Metadata key must be a string",at.ERR_INVALID_PARAMETERS);if(!(t instanceof Uint8Array))throw new o.sv("Metadata value must be a Uint8Array",at.ERR_INVALID_PARAMETERS)}function Pt(e,t){if("string"!=typeof e)throw new o.sv("Tag name must be a string",at.ERR_INVALID_PARAMETERS);if(null!=t.value){if(parseInt(`${t.value}`,10)!==t.value)throw new o.sv("Tag value must be an integer",at.ERR_INVALID_PARAMETERS);if(t.value<0||t.value>100)throw new o.sv("Tag value must be between 0-100",at.ERR_INVALID_PARAMETERS)}if(null!=t.ttl){if(parseInt(`${t.ttl}`,10)!==t.ttl)throw new o.sv("Tag ttl must be an integer",at.ERR_INVALID_PARAMETERS);if(t.ttl<0)throw new o.sv("Tag ttl must be between greater than 0",at.ERR_INVALID_PARAMETERS)}}function kt(e,t){let n;return null!=t.expiry&&(n=t.expiry),null!=t.ttl&&(n=BigInt(Date.now()+Number(t.ttl))),{value:t.value??0,expiry:n}}function Nt(e,t,n){const r=e.toString().split("/")[2],i=qe(ot.base32.decode(r)),s=n.get(i);if(null!=s)return s;const o=ht(i,t);return n.set(i,o),o}class xt{peerId;datastore;lock;addressFilter;constructor(e,t={}){this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=t.addressFilter,this.lock=(0,st.Z)({name:"peer-store",singleProcess:!0})}async has(e){return this.datastore.has(Rt(e))}async delete(e){if(this.peerId.equals(e))throw new o.sv("Cannot delete self peer",at.ERR_INVALID_PARAMETERS);await this.datastore.delete(Rt(e))}async load(e){return ht(e,await this.datastore.get(Rt(e)))}async save(e,t){const{existingBuf:n,existingPeer:r}=await this.#u(e),i=await It(e,t,"patch",{addressFilter:this.addressFilter});return this.#l(e,i,n,r)}async patch(e,t){const{existingBuf:n,existingPeer:r}=await this.#u(e),i=await It(e,t,"patch",{addressFilter:this.addressFilter,existingPeer:r});return this.#l(e,i,n,r)}async merge(e,t){const{existingBuf:n,existingPeer:r}=await this.#u(e),i=await It(e,t,"merge",{addressFilter:this.addressFilter,existingPeer:r});return this.#l(e,i,n,r)}async*all(e){const t=new be.ji;for await(const{key:n,value:r}of this.datastore.query(function(e,t){return null==e?{}:{prefix:St,filters:(e.filters??[]).map((e=>({key:n,value:r})=>e(Nt(n,r,t)))),orders:(e.orders??[]).map((e=>(n,r)=>e(Nt(n.key,n.value,t),Nt(r.key,r.value,t))))}}(e??{},t))){const e=Nt(n,r,t);e.id.equals(this.peerId)||(yield e)}}async#u(e){try{const t=await this.datastore.get(Rt(e));return{existingBuf:t,existingPeer:ht(e,t)}}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return{}}async#l(e,t,n,r){const i=ct.encode(t);return null!=n&&(0,Oe.f)(i,n)?{peer:ht(e,i),previous:r,updated:!1}:(await this.datastore.put(Rt(e),i),{peer:ht(e,i),previous:r,updated:!0})}}const Dt=(0,_e.kg)("libp2p:peer-store");class Lt{store;events;peerId;constructor(e,t={}){this.events=e.events,this.peerId=e.peerId,this.store=new xt(e,t)}async forEach(e,t){Dt.trace("forEach await read lock");const n=await this.store.lock.readLock();Dt.trace("forEach got read lock");try{for await(const n of this.store.all(t))e(n)}finally{Dt.trace("forEach release read lock"),n()}}async all(e){Dt.trace("all await read lock");const t=await this.store.lock.readLock();Dt.trace("all got read lock");try{return await(0,it.Z)(this.store.all(e))}finally{Dt.trace("all release read lock"),t()}}async delete(e){Dt.trace("delete await write lock");const t=await this.store.lock.writeLock();Dt.trace("delete got write lock");try{await this.store.delete(e)}finally{Dt.trace("delete release write lock"),t()}}async has(e){Dt.trace("has await read lock");const t=await this.store.lock.readLock();Dt.trace("has got read lock");try{return await this.store.has(e)}finally{Dt.trace("has release read lock"),t()}}async get(e){Dt.trace("get await read lock");const t=await this.store.lock.readLock();Dt.trace("get got read lock");try{return await this.store.load(e)}finally{Dt.trace("get release read lock"),t()}}async save(e,t){Dt.trace("save await write lock");const n=await this.store.lock.writeLock();Dt.trace("save got write lock");try{const n=await this.store.save(e,t);return this.#h(e,n),n.peer}finally{Dt.trace("save release write lock"),n()}}async patch(e,t){Dt.trace("patch await write lock");const n=await this.store.lock.writeLock();Dt.trace("patch got write lock");try{const n=await this.store.patch(e,t);return this.#h(e,n),n.peer}finally{Dt.trace("patch release write lock"),n()}}async merge(e,t){Dt.trace("merge await write lock");const n=await this.store.lock.writeLock();Dt.trace("merge got write lock");try{const n=await this.store.merge(e,t);return this.#h(e,n),n.peer}finally{Dt.trace("merge release write lock"),n()}}async consumePeerRecord(e,t){const n=await Ye.openAndCertify(e,rt.DOMAIN);if(!1===t?.equals(n.peerId))return Dt("envelope peer id was not the expected peer id - expected: %p received: %p",t,n.peerId),!1;const r=rt.createFromProtobuf(n.payload);let i;try{i=await this.get(n.peerId)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=i?.peerRecordEnvelope){const e=await Ye.createFromProtobuf(i.peerRecordEnvelope),t=rt.createFromProtobuf(e.payload);if(t.seqNumber>=r.seqNumber)return Dt("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,r.seqNumber),!1}return await this.patch(r.peerId,{peerRecordEnvelope:e,addresses:r.multiaddrs.map((e=>({isCertified:!0,multiaddr:e})))}),!0}#h(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}}var Ot=n(6540),Ut=n(92291),Mt=n(29124),Bt=n(97858),zt=n(2288);const Vt=(0,we.kg)("libp2p:address-manager"),$t=e=>e;function Ft(e,t){const n=e.getPeerId();if(null!=n){(0,Ee.jE)(n).equals(t)&&(e=e.decapsulate((0,Ot.HM)(`/p2p/${t.toString()}`)))}return e}class jt{components;listen;announce;observed;announceFilter;constructor(e,t={}){const{listen:n=[],announce:r=[]}=t;this.components=e,this.listen=n.map((e=>e.toString())),this.announce=new Set(r.map((e=>e.toString()))),this.observed=new Map,this.announceFilter=t.announceFilter??$t,this._updatePeerStoreAddresses=(0,zt.D)(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",(()=>{this._updatePeerStoreAddresses()})),e.events.addEventListener("transport:close",(()=>{this._updatePeerStoreAddresses()}))}_updatePeerStoreAddresses(){const e=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter((([e,t])=>t.confident)).map((([e])=>(0,Ot.HM)(e)))).map((e=>e.getPeerId()===this.components.peerId.toString()?e.decapsulate(`/p2p/${this.components.peerId.toString()}`):e));this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch((e=>{Vt.error("error updating addresses",e)}))}getListenAddrs(){return Array.from(this.listen).map((e=>(0,Ot.HM)(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>(0,Ot.HM)(e)))}getObservedAddrs(){return Array.from(this.observed).map((([e])=>(0,Ot.HM)(e)))}addObservedAddr(e){const t=(e=Ft(e,this.components.peerId)).toString();this.observed.has(t)||this.observed.set(t,{confident:!1})}confirmObservedAddr(e){const t=(e=Ft(e,this.components.peerId)).toString(),n=(this.observed.get(t)??{confident:!1}).confident;this.observed.set(t,{confident:!0}),n||this._updatePeerStoreAddresses()}removeObservedAddr(e){const t=(e=Ft(e,this.components.peerId)).toString();this.observed.delete(t)}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(Array.from(this.observed).filter((([e,t])=>t.confident)).map((([e])=>e)));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>(0,Ot.HM)(e)))).map((e=>!0===e.protos().pop()?.path||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate(`/p2p/${this.components.peerId.toString()}`)))}}var Kt=n(86125);class qt{components={};_started=!1;constructor(e={}){this.components={};for(const[t,n]of Object.entries(e))this.components[t]=n}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter((e=>(0,Kt.qK)(e))).map((async t=>{await(t[e]?.())})))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const Ht=["metrics","connectionProtector"],Gt=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];var Zt=n(53749);function Wt(e={}){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{const t=e.stringTuples();return(4===t[0][0]||41===t[0][0])&&Boolean((0,Zt.Z)(`${t[0][1]}`))},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...e}}var Qt=n(55265),Yt=n(76201),Jt=n(72495);function Xt(e,t){const n=function(e,t){const n=(0,Jt.h)(e.multiaddr),r=(0,Jt.h)(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==n)return n;const r=function(e,t){const n=Yt.dx.exactMatch(e.multiaddr),r=Yt.dx.exactMatch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==r)return r;const i=function(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}(e,t);return i}var en=n(66907),tn=n(73170);const{code:nn}=(0,en.Ev)("dnsaddr");async function rn(e,t={}){const n=new tn.Z;null!=t.signal&&t.signal.addEventListener("abort",(()=>{n.cancel()}));const r=e.getPeerId(),[,i]=e.stringTuples().find((([e])=>e===nn))??[];if(null==i)throw new Error("No hostname found in multiaddr");let s=(await n.resolveTxt(`_dnsaddr.${i}`)).flat().map((e=>e.split("=")[1])).filter(Boolean);return null!=r&&(s=s.filter((e=>e.includes(r)))),s}var sn=n(64188);const on={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{resolvers:{dnsaddr:rn},addressSorter:Xt},transportManager:{faultTolerance:Qt.P7.FATAL_ALL}};var an=n(11940),cn=n(60644);const un=(0,we.kg)("libp2p:get-peer");function ln(e){if((0,T.I)(e))return{peerId:e,multiaddrs:[]};let t;if(Array.isArray(e)||(e=[e]),e.length>0){const n=e[0].getPeerId();t=null==n?void 0:(0,Ee.jE)(n),e.forEach((e=>{if(!(0,Ot.h2)(e))throw un.error("multiaddr %s was invalid",e),new o.sv("Invalid Multiaddr",sn.q.ERR_INVALID_MULTIADDR);const n=e.getPeerId();if(null==n){if(null!=t)throw new o.sv("Multiaddrs must all have the same peer id or have no peer id",sn.q.ERR_INVALID_PARAMETERS)}else{const e=(0,Ee.jE)(n);if(null==t||!t.equals(e))throw new o.sv("Multiaddrs must all have the same peer id or have no peer id",sn.q.ERR_INVALID_PARAMETERS)}}))}return{peerId:t,multiaddrs:e}}var hn=n(2291),dn=n(95554),fn=n(12229),pn=n(20103);const yn=(0,we.kg)("libp2p:connection-manager:auto-dial"),gn={minConnections:fn.iA,maxQueueLength:pn.Oe,autoDialConcurrency:pn.Bv,autoDialPriority:pn.G9,autoDialInterval:pn.PW,autoDialPeerRetryThreshold:fn.Oq,autoDialDiscoveredPeersDebounce:pn.D8};class mn{connectionManager;peerStore;queue;minConnections;autoDialPriority;autoDialIntervalMs;autoDialMaxQueueLength;autoDialPeerRetryThresholdMs;autoDialDiscoveredPeersDebounce;autoDialInterval;started;running;constructor(e,t){let n;this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.minConnections=t.minConnections??gn.minConnections,this.autoDialPriority=t.autoDialPriority??gn.autoDialPriority,this.autoDialIntervalMs=t.autoDialInterval??gn.autoDialInterval,this.autoDialMaxQueueLength=t.maxQueueLength??gn.maxQueueLength,this.autoDialPeerRetryThresholdMs=t.autoDialPeerRetryThreshold??gn.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=t.autoDialDiscoveredPeersDebounce??gn.autoDialDiscoveredPeersDebounce,this.started=!1,this.running=!1,this.queue=new dn.m({concurrency:t.autoDialConcurrency??gn.autoDialConcurrency}),this.queue.addListener("error",(e=>{yn.error("error during auto-dial",e)})),e.events.addEventListener("connection:close",(()=>{this.autoDial().catch((e=>{yn.error(e)}))})),e.events.addEventListener("peer:discovery",(()=>{clearTimeout(n),n=setTimeout((()=>{this.autoDial().catch((e=>{yn.error(e)}))}),this.autoDialDiscoveredPeersDebounce)}))}isStarted(){return this.started}start(){this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{yn.error("error while autodialing",e)}))}),this.autoDialIntervalMs),this.started=!0}afterStart(){this.autoDial().catch((e=>{yn.error("error while autodialing",e)}))}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started)return;const e=this.connectionManager.getConnectionsMap(),t=e.size;if(t>=this.minConnections)return void(this.minConnections>0&&yn.trace("have enough connections %d/%d",t,this.minConnections));if(this.queue.size>this.autoDialMaxQueueLength)return void yn("not enough connections %d/%d but auto dial queue is full",t,this.minConnections);if(this.running)return void yn("not enough connections %d/%d - but skipping autodial as it is already running",t,this.minConnections);this.running=!0,yn("not enough connections %d/%d - will dial peers to increase the number of connections",t,this.minConnections);const n=new be.fd(this.connectionManager.getDialQueue().map((e=>e.peerId)).filter(Boolean)),r=await this.peerStore.all({filters:[t=>0===t.addresses.length?(yn.trace("not autodialing %p because they have no addresses",t.id),!1):e.has(t.id)?(yn.trace("not autodialing %p because they are already connected",t.id),!1):n.has(t.id)?(yn.trace("not autodialing %p because they are already being dialed",t.id),!1):!this.queue.hasJob(t.id)||(yn.trace("not autodialing %p because they are already being autodialed",t.id),!1)]}),i=r.sort((()=>Math.random()>.5?1:-1)),s=new be.ji;for(const e of i)s.has(e.id)||s.set(e.id,[...e.tags.values()].reduce(((e,t)=>e+t.value),0));const o=i.sort(((e,t)=>{const n=s.get(e.id)??0,r=s.get(t.id)??0;return n>r?-1:n<r?1:0})).filter((e=>{const t=e.metadata.get(pn.mV);if(null==t)return!0;const n=parseInt((0,hn.B)(t));return!!isNaN(n)||Date.now()-n>this.autoDialPeerRetryThresholdMs}));yn("selected %d/%d peers to dial",o.length,r.length);for(const e of o)this.queue.add((async()=>{const t=this.connectionManager.getConnectionsMap().size;if(t>=this.minConnections)return yn("got enough connections now %d/%d",t,this.minConnections),void this.queue.clear();yn("connecting to a peerStore stored peer %p",e.id),await this.connectionManager.openConnection(e.id,{priority:this.autoDialPriority})}),{peerId:e.id}).catch((e=>{yn.error("could not connect to peerStore stored peer",e)}));this.running=!1,this.started&&(this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{yn.error("error while autodialing",e)}))}),this.autoDialIntervalMs))}}const wn=(0,we.kg)("libp2p:connection-manager:connection-pruner"),bn={maxConnections:fn.aX,allow:[]};class En{maxConnections;connectionManager;peerStore;allow;events;constructor(e,t={}){this.maxConnections=t.maxConnections??bn.maxConnections,this.allow=t.allow??bn.allow,this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,e.events.addEventListener("connection:open",(()=>{this.maybePruneConnections().catch((e=>{wn.error(e)}))}))}async maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length,n=Math.max(t-this.maxConnections,0);if(wn("checking max connections limit %d/%d",t,this.maxConnections),t<=this.maxConnections)return;wn("max connections limit exceeded %d/%d, pruning %d connection(s)",t,this.maxConnections,n);const r=new be.ji;for(const t of e){const e=t.remotePeer;if(!r.has(e)){r.set(e,0);try{const t=await this.peerStore.get(e);r.set(e,[...t.tags.values()].reduce(((e,t)=>e+t.value),0))}catch(e){"ERR_NOT_FOUND"!==e.code&&wn.error("error loading peer tags",e)}}}const i=e.sort(((e,t)=>{const n=r.get(e.remotePeer)??0,i=r.get(t.remotePeer)??0;if(n>i)return 1;if(n<i)return-1;const s=e.timeline.open,o=t.timeline.open;return s<o?1:s>o?-1:0})),s=[];for(const e of i){wn("too many connections open - closing a connection to %p",e.remotePeer);if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString())))||s.push(e),s.length===n)break}await Promise.all(s.map((async e=>{try{await e.close()}catch(e){wn.error(e)}}))),this.events.safeDispatchEvent("connection:prune",{detail:s})}}var vn=n(57156),_n=n(85275),Sn=n(48347);const Rn=(0,we.kg)("libp2p:connection-manager:utils");async function An(e,t){if(!e.protoNames().includes("dnsaddr"))return[e];const n=await async function(e,t){try{e=(0,Ot.HM)(e.toString());return await e.resolve(t)}catch(t){return Rn.error(`multiaddr ${e.toString()} could not be resolved`,t),[]}}(e,t),r=(await Promise.all(n.map((async e=>An(e,t))))).flat().reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[]);return Rn("resolved %s to",e,r.map((e=>e.toString()))),r}const In=(0,we.kg)("libp2p:connection-manager:dial-queue"),Tn={addressSorter:Xt,maxParallelDials:fn.Ui,maxPeerAddrsToDial:pn.wt,maxParallelDialsPerPeer:pn.Hi,dialTimeout:pn.Lw,resolvers:{dnsaddr:rn}};class Cn{pendingDials;queue;peerId;peerStore;connectionGater;transportManager;addressSorter;maxPeerAddrsToDial;maxParallelDialsPerPeer;dialTimeout;inProgressDialCount;pendingDialCount;shutDownController;constructor(e,t={}){this.addressSorter=t.addressSorter??Tn.addressSorter,this.maxPeerAddrsToDial=t.maxPeerAddrsToDial??Tn.maxPeerAddrsToDial,this.maxParallelDialsPerPeer=t.maxParallelDialsPerPeer??Tn.maxParallelDialsPerPeer,this.dialTimeout=t.dialTimeout??Tn.dialTimeout,this.peerId=e.peerId,this.peerStore=e.peerStore,this.connectionGater=e.connectionGater,this.transportManager=e.transportManager,this.shutDownController=new AbortController;try{(0,r.setMaxListeners)?.(1/0,this.shutDownController.signal)}catch{}this.pendingDialCount=e.metrics?.registerMetric("libp2p_dialler_pending_dials"),this.inProgressDialCount=e.metrics?.registerMetric("libp2p_dialler_in_progress_dials"),this.pendingDials=[];for(const[e,n]of Object.entries(t.resolvers??{}))Ot.s_.set(e,n);this.queue=new Sn.Z({concurrency:t.maxParallelDials??Tn.maxParallelDials}),this.queue.on("add",(()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})),this.queue.on("active",(()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})),this.queue.on("completed",(()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})),this.queue.on("error",(e=>{In.error("error in dial queue",e),this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})),this.queue.on("empty",(()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})),this.queue.on("idle",(()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}))}stop(){this.shutDownController.abort()}async dial(e,t={}){const{peerId:n,multiaddrs:r}=ln(e),i=r.map((e=>({multiaddr:e,isCertified:!1}))),s=this.createDialAbortControllers(t.signal);let a;try{a=await this.calculateMultiaddrs(n,i,{...t,signal:s})}catch(e){throw s.clear(),e}const c=this.pendingDials.find((e=>!(null==e.peerId||null==n||!e.peerId.equals(n))||a.map((({multiaddr:e})=>e.toString())).join()===e.multiaddrs.map((e=>e.toString())).join()));if(null!=c)return In("joining existing dial target for %p",n),s.clear(),c.promise;In("creating dial target for",a.map((({multiaddr:e})=>e.toString())));const u={id:`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`,status:"queued",peerId:n,multiaddrs:a.map((({multiaddr:e})=>e))};return u.promise=this.performDial(u,{...t,signal:s}).finally((()=>{this.pendingDials=this.pendingDials.filter((e=>e.id!==u.id)),s.clear()})).catch((async e=>{if(In.error("dial failed to %s",u.multiaddrs.map((e=>e.toString())).join(", "),e),null!=n)try{await this.peerStore.patch(n,{metadata:{[pn.mV]:(0,Bt.m)(Date.now().toString())}})}catch(e){In.error("could not update last dial failure key for %p",n,e)}if(s.aborted){throw new o.sv(e.message,sn.q.ERR_TIMEOUT)}throw e})),this.pendingDials.push(u),u.promise}createDialAbortControllers(e){const t=(0,vn.N)([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);try{(0,r.setMaxListeners)?.(1/0,t)}catch{}return t}async calculateMultiaddrs(e,t=[],n={}){if(null!=e){if(this.peerId.equals(e))throw new o.sv("Tried to dial self",sn.q.ERR_DIALED_SELF);if(!0===await(this.connectionGater.denyDialPeer?.(e)))throw new o.sv("The dial request is blocked by gater.allowDialPeer",sn.q.ERR_PEER_DIAL_INTERCEPTED);if(0===t.length){In("loading multiaddrs for %p",e);try{const n=await this.peerStore.get(e);t.push(...n.addresses),In("loaded multiaddrs for %p",e,t.map((({multiaddr:e})=>e.toString())))}catch(e){if(e.code!==sn.q.ERR_NOT_FOUND)throw e}}}const r=(await Promise.all(t.map((async e=>{const t=await An(e.multiaddr,n);return 1===t.length&&t[0].equals(e.multiaddr)?e:t.map((e=>({multiaddr:e,isCertified:!1})))})))).flat(),i=r.filter((t=>{if(null==this.transportManager.transportForMultiaddr(t.multiaddr))return!1;const n=t.multiaddr.getPeerId();return null==e||null==n||e.equals(n)})),s=new Map;for(const e of i){const t=e.multiaddr.toString(),n=s.get(t);null==n?s.set(t,e):n.isCertified=n.isCertified||e.isCertified||!1}let a=[...s.values()];if((0===a.length||a.length>this.maxPeerAddrsToDial)&&(In("addresses for %p before filtering",e??"unknown peer",r.map((({multiaddr:e})=>e.toString()))),In("addresses for %p after filtering",e??"unknown peer",a.map((({multiaddr:e})=>e.toString())))),0===a.length)throw new o.sv("The dial request has no valid addresses",sn.q.ERR_NO_VALID_ADDRESSES);if(a.length>this.maxPeerAddrsToDial)throw new o.sv("dial with more addresses than allowed",sn.q.ERR_TOO_MANY_ADDRESSES);if(null!=e){const t=`/p2p/${e.toString()}`;a=a.map((n=>{const r=n.multiaddr.getPeerId(),i=n.multiaddr.protos().pop();return!0===i?.path?n:r!==e.toString()?{multiaddr:n.multiaddr.encapsulate(t),isCertified:n.isCertified}:n}))}const c=[];for(const e of a)null!=this.connectionGater.denyDialMultiaddr&&await this.connectionGater.denyDialMultiaddr(e.multiaddr)||c.push(e);const u=c.sort(this.addressSorter);if(0===u.length)throw new o.sv("The connection gater denied all addresses in the dial request",sn.q.ERR_NO_VALID_ADDRESSES);return u}async performDial(e,t={}){const n=e.multiaddrs.map((()=>new AbortController));try{const i=new Sn.Z({concurrency:this.maxParallelDialsPerPeer});i.on("error",(e=>{In.error("error dialling",e)}));const s=await Promise.any(e.multiaddrs.map((async(s,a)=>{const c=n[a];if(null==c)throw new o.sv("dialAction did not come with an AbortController",sn.q.ERR_INVALID_PARAMETERS);const u=function(...e){const t=[];for(const n of e)if(null!=n){try{(0,r.setMaxListeners)?.(1/0,n)}catch{}t.push(n)}const n=(0,vn.N)(t);try{(0,r.setMaxListeners)?.(1/0,n)}catch{}return n}(c.signal,t.signal);u.addEventListener("abort",(()=>{In("dial to %a aborted",s)}));const l=(0,_n.Z)();return await i.add((async()=>{if(u.aborted)return In("dial to %a was aborted before reaching the head of the peer dial queue",s),void l.reject(new o._L);await this.queue.add((async()=>{try{if(u.aborted)return In("dial to %a was aborted before reaching the head of the dial queue",s),void l.reject(new o._L);e.status="active";const r=await this.transportManager.dial(s,{...t,signal:u});if(c.signal.aborted)return In("multiple dials succeeded, closing superfluous connection"),r.close().catch((e=>{In.error("error closing superfluous connection",e)})),void l.reject(new o._L);n[a]=void 0,n.forEach((e=>{void 0!==e&&e.abort()})),In("dial to %a succeeded",s),l.resolve(r)}catch(e){In.error("error during dial of %a",s,e),l.reject(e)}}),{...t,signal:u}).catch((e=>{l.reject(e)}))}),{signal:u}).catch((e=>{l.reject(e)})).finally((()=>{u.clear()})),l.promise})));if(null==s)throw new o.sv("successful dial led to empty object returned from peer dial queue",sn.q.ERR_TRANSPORT_DIAL_FAILED);return e.status="success",s}catch(t){if(e.status="error",1===e.multiaddrs.length&&"AggregateError"===t.name)throw t.errors[0];throw t}}}const Pn=(0,we.kg)("libp2p:connection-manager"),kn={minConnections:fn.iA,maxConnections:fn.aX,inboundConnectionThreshold:pn.C4,maxIncomingPendingConnections:pn.b4,autoDialConcurrency:pn.Bv,autoDialPriority:pn.G9,autoDialMaxQueueLength:pn.Oe};class Nn{started;connections;allow;deny;maxIncomingPendingConnections;incomingPendingConnections;maxConnections;dialQueue;autoDial;connectionPruner;inboundConnectionRateLimiter;peerStore;metrics;events;constructor(e,t={}){this.maxConnections=t.maxConnections??kn.maxConnections;const n=t.minConnections??kn.minConnections;if(this.maxConnections<n)throw new o.sv("Connection Manager maxConnections must be greater than minConnections",sn.q.ERR_INVALID_PARAMETERS);this.connections=new be.ji,this.started=!1,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(t.allow??[]).map((e=>(0,Ot.HM)(e))),this.deny=(t.deny??[]).map((e=>(0,Ot.HM)(e))),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=t.maxIncomingPendingConnections??kn.maxIncomingPendingConnections,this.inboundConnectionRateLimiter=new cn.RateLimiterMemory({points:t.inboundConnectionThreshold??kn.inboundConnectionThreshold,duration:1}),this.autoDial=new mn({connectionManager:this,peerStore:e.peerStore,events:e.events},{minConnections:n,autoDialConcurrency:t.autoDialConcurrency??kn.autoDialConcurrency,autoDialPriority:t.autoDialPriority??kn.autoDialPriority,maxQueueLength:t.autoDialMaxQueueLength??kn.autoDialMaxQueueLength}),this.connectionPruner=new En({connectionManager:this,peerStore:e.peerStore,events:e.events},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new Cn({peerId:e.peerId,metrics:e.metrics,peerStore:e.peerStore,transportManager:e.transportManager,connectionGater:e.connectionGater},{addressSorter:t.addressSorter??Xt,maxParallelDials:t.maxParallelDials??fn.Ui,maxPeerAddrsToDial:t.maxPeerAddrsToDial??pn.wt,maxParallelDialsPerPeer:t.maxParallelDialsPerPeer??pn.Hi,dialTimeout:t.dialTimeout??pn.Lw,resolvers:t.resolvers??{dnsaddr:rn}})}isStarted(){return this.started}async start(){this.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const n of t)"inbound"===n.direction?e.inbound++:e.outbound++;return e}}),this.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const n of t)for(const t of n.streams){const n=`${t.direction} ${t.protocol??"unnegotiated"}`;e[n]=(e[n]??0)+1}return e}}),this.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const n of t){const t={};for(const e of n.streams){const n=`${e.direction} ${e.protocol??"unnegotiated"}`;t[n]=(t[n]??0)+1}for(const[n,r]of Object.entries(t))e[n]=e[n]??[],e[n].push(r)}const t={};for(let[n,r]of Object.entries(e)){r=r.sort(((e,t)=>e-t));const e=Math.floor(.9*r.length);t[n]=r[e]}return t}}),this.autoDial.start(),this.started=!0,Pn("started")}async afterStart(){Promise.resolve().then((async()=>{const e=await this.peerStore.all({filters:[e=>e.tags.has(an.$)]});await Promise.all(e.map((async e=>{await this.openConnection(e.id).catch((e=>{Pn.error(e)}))})))})).catch((e=>{Pn.error(e)})),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(e){Pn.error(e)}})());Pn("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),Pn("stopped")}onConnect(e){this._onConnect(e).catch((e=>{Pn.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const n=t.remotePeer,r=this.connections.get(n);let i=!1;null!=r?r.push(t):(i=!0,this.connections.set(n,[t])),null!=n.publicKey&&"RSA"===n.type&&await this.peerStore.patch(n,{publicKey:n.publicKey}),i&&this.events.safeDispatchEvent("peer:connect",{detail:t.remotePeer})}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer;let r=this.connections.get(n);null!=r&&r.length>1?(r=r.filter((e=>e.id!==t.id)),this.connections.set(n,r)):null!=r&&(this.connections.delete(n),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}getConnections(e){if(null!=e)return this.connections.get(e)??[];let t=[];for(const e of this.connections.values())t=t.concat(e);return t}getConnectionsMap(){return this.connections}async openConnection(e,t={}){if(!this.isStarted())throw new o.sv("Not started",sn.q.ERR_NODE_NOT_STARTED);t.signal?.throwIfAborted();const{peerId:n}=ln(e);if(null!=n&&!0!==t.force){Pn("dial %p",n);const e=this.getConnections(n);if(e.length>0)return Pn("had an existing connection to %p",n),e[0]}const r=await this.dialQueue.dial(e,{...t,priority:t.priority??50});let i=this.connections.get(r.remotePeer);null==i&&(i=[],this.connections.set(r.remotePeer,i));let s=!1;for(const e of i)e.id===r.id&&(s=!0);return s||i.push(r),r}async closeConnections(e,t={}){const n=this.connections.get(e)??[];await Promise.all(n.map((async e=>{try{await e.close(t)}catch(t){e.abort(t)}})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return Pn("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return Pn("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return Pn("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,t),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(Pn("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){return this.dialQueue.pendingDials}}var xn=n(34456);class Dn extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Ln(e,t){let n,r,i,s=(t=t??{}).onEnd,o=new xn.u,a=(0,_n.Z)();const c=e=>null!=r?r(e):(o.push(e),n),u=e=>{if(i)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?n:(i=!0,null!=e?(e=>(o=new xn.u,null!=r?r({error:e}):(o.push({error:e}),n)))(e):c({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{r=s=>{r=null,o.push(s);try{t(e(o))}catch(e){i(e)}return n}})):e(o)}finally{o.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=(0,_n.Z)()}))}},return:()=>(o=new xn.u,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:u,end:l,get readableLength(){return o.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),o.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new Dn)},t.addEventListener("abort",r)})));try{await Promise.race([a.promise,n])}finally{null!=r&&null!=t&&t?.removeEventListener("abort",r)}}},null==s)return n;const h=n;return n={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),n),get readableLength(){return h.readableLength}},n}var On=function(...e){const t=[];for(const n of e)null==n[Symbol.asyncIterator]&&t.push(n);return t.length===e.length?function*(){for(const e of t)yield*e}():async function*(){const t=function(e={}){return Ln((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const n of e)t.push(n)}))),t.end()}catch(e){t.end(e)}})),yield*t}()},Un=n(90212),Mn=n(12416),Bn=n(34880);async function*zn(e,t){yield*(0,Bn.Z)(e,(async e=>(await t.merge(e.id,{multiaddrs:e.multiaddrs}),e)))}function Vn(e){const t=new Set;return(0,Mn.Z)(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}async function*$n(e,t=1){let n=0;for await(const t of e)n++,yield t;if(n<t)throw new o.sv(`more peers required, seen: ${n}  min: ${t}`,"NOT_FOUND")}class Fn{routers;started;components;constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(0===this.routers.length)throw new o.sv("No content routers available",sn.q.ERR_NO_ROUTERS_AVAILABLE);yield*(0,Un.z)(On(...this.routers.map((n=>n.findProviders(e,t)))),(e=>zn(e,this.components.peerStore)),(e=>Vn(e)),(e=>$n(e)))}async provide(e,t={}){if(0===this.routers.length)throw new o.sv("No content routers available",sn.q.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async n=>{await n.provide(e,t)})))}async put(e,t,n){if(!this.isStarted())throw new o.sv(sn.s.NOT_STARTED_YET,sn.q.DHT_NOT_STARTED);await Promise.all(this.routers.map((async r=>{await r.put(e,t,n)})))}async get(e,t){if(!this.isStarted())throw new o.sv(sn.s.NOT_STARTED_YET,sn.q.DHT_NOT_STARTED);return Promise.any(this.routers.map((async n=>n.get(e,t))))}}var jn=n(31650);const Kn=(0,we.kg)("libp2p:peer-routing");class qn{components;routers;constructor(e,t){this.components=e,this.routers=t.routers??[]}async findPeer(e,t){if(0===this.routers.length)throw new o.sv("No peer routers available",sn.q.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw new o.sv("Should not try to find self",sn.q.ERR_FIND_SELF);const n=await(0,Un.z)(On(...this.routers.map((n=>async function*(){try{yield await n.findPeer(e,t)}catch(e){Kn.error(e)}}()))),(e=>(0,Mn.Z)(e,Boolean)),(e=>zn(e,this.components.peerStore)),(async e=>(0,jn.Z)(e)));if(null!=n)return n;throw new o.sv(sn.s.NOT_FOUND,sn.q.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw new o.sv("No peer routers available",sn.q.ERR_NO_ROUTERS_AVAILABLE);yield*(0,Un.z)(On(...this.routers.map((n=>n.getClosestPeers(e,t)))),(e=>zn(e,this.components.peerStore)),(e=>Vn(e)),(e=>$n(e)))}}const Hn=(0,we.kg)("libp2p:registrar");class Gn{topologies;handlers;components;constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onConnect=this._onConnect.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:connect",this._onConnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw new o.sv(`No handler registered for protocol ${e}`,sn.q.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e))throw new o.sv(`Handler already registered for protocol ${e}`,sn.q.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const r=re.Z.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,t){if(null==t)throw new o.sv("invalid topology",sn.q.ERR_INVALID_PARAMETERS);const n=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{for(const n of e.protocols){const e=this.topologies.get(n);if(null!=e)for(const n of e.values())n.onDisconnect?.(t)}})).catch((e=>{e.code!==sn.q.ERR_NOT_FOUND&&Hn.error("could not inform topologies of disconnecting peer %p",t,e)}))}_onConnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{const n=this.components.connectionManager.getConnections(e.id)[0];if(null!=n)for(const r of e.protocols){const e=this.topologies.get(r);if(null!=e)for(const r of e.values())r.onConnect?.(t,n)}else Hn("peer %p connected but the connection manager did not have a connection",e)})).catch((e=>{e.code!==sn.q.ERR_NOT_FOUND&&Hn.error("could not inform topologies of connecting peer %p",t,e)}))}_onPeerUpdate(e){const{peer:t,previous:n}=e.detail,r=(n?.protocols??[]).filter((e=>!t.protocols.includes(e))),i=t.protocols.filter((e=>!(n?.protocols??[]).includes(e)));for(const e of r){const n=this.topologies.get(e);if(null!=n)for(const e of n.values())e.onDisconnect?.(t.id)}for(const e of i){const n=this.topologies.get(e);if(null!=n)for(const e of n.values()){const n=this.components.connectionManager.getConnections(t.id)[0];null!=n&&e.onConnect?.(t.id,n)}}}}var Zn=n(40480);const Wn=(0,we.kg)("libp2p:transports");class Qn{components;transports;listeners;faultTolerance;started;constructor(e,t={}){this.components=e,this.started=!1,this.transports=new Map,this.listeners=(0,Zn.s)({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=t.faultTolerance??Qt.P7.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw new o.sv("Transport must have a valid tag",sn.q.ERR_INVALID_KEY);if(this.transports.has(t))throw new o.sv(`There is already a transport with the tag ${t}`,sn.q.ERR_DUPLICATE_TRANSPORT);Wn("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,n]of this.listeners)for(Wn("closing listeners for %s",t);n.length>0;){const t=n.pop();null!=t&&e.push(t.close())}await Promise.all(e),Wn("all listeners closed");for(const e of this.listeners.keys())this.listeners.set(e,[]);this.started=!1}async dial(e,t){const n=this.transportForMultiaddr(e);if(null==n)throw new o.sv(`No transport available for address ${String(e)}`,sn.q.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...t,upgrader:this.components.upgrader})}catch(e){throw null==e.code&&(e.code=sn.q.ERR_TRANSPORT_DIAL_FAILED),e}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}transportForMultiaddr(e){for(const t of this.transports.values()){if(t.filter([e]).length>0)return t}}async listen(e){if(!this.isStarted())throw new o.sv("Not started",sn.q.ERR_NODE_NOT_STARTED);if(null==e||0===e.length)return void Wn("no addresses were provided for listening, this node is dial only");const t=[];for(const[n,r]of this.transports.entries()){const i=r.filter(e),s=[];for(const e of i){Wn("creating listener for %s on %a",n,e);const t=r.createListener({upgrader:this.components.upgrader});let i=this.listeners.get(n)??[];null==i&&(i=[],this.listeners.set(n,i)),i.push(t),t.addEventListener("listening",(()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:t})})),t.addEventListener("close",(()=>{const e=i.findIndex((e=>e===t));i.splice(e,1),this.components.events.safeDispatchEvent("transport:close",{detail:t})})),s.push(t.listen(e))}if(0===s.length){t.push(n);continue}if(null==(await Promise.allSettled(s)).find((e=>"fulfilled"===e.status))&&this.faultTolerance!==Qt.P7.NO_FATAL)throw new o.sv(`Transport (${n}) could not listen on any available address`,sn.q.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===Qt.P7.FATAL_ALL)throw new o.sv(e,sn.q.ERR_NO_VALID_ADDRESSES);Wn(`libp2p in dial mode only: ${e}`)}}async remove(e){const t=this.listeners.get(e)??[];Wn.trace("removing transport %s",e);const n=[];for(Wn.trace("closing listeners for %s",e);t.length>0;){const e=t.pop();null!=e&&n.push(e.close())}await Promise.all(n),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}var Yn=n(90770),Jn=n(37953),Xn=n(93489),er=n(87199);function tr(e){const t=(0,er.d)(),n=(0,Xn.r)(e.source),r=(0,_n.Z)();let i;const s=e.sink(async function*(){yield*t;const e=await r.promise;yield*e}());s.catch((e=>{i=e}));return{reader:n,writer:t,stream:{sink:async e=>{null==i?(r.resolve(e),await s):await Promise.reject(i)},source:n},rest:()=>t.end(),write:t.push,read:async()=>{const e=await n.next();if(null!=e.value)return e.value}}}n(48224),n(58287);var nr=n(36165),rr=n(53275),ir=n(39195);function sr(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const or=sr("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ar=sr("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,ir.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}));var cr={utf8:or,"utf-8":or,hex:rr.gh.base16,latin1:ar,ascii:ar,binary:ar,...rr.gh};function ur(e,t="utf8"){const n=cr[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,nr.P)(globalThis.Buffer.from(e,"utf-8"))}class lr extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}var hr=n(15086);function dr(e,t,n){const r=n??{},i=(0,hr.A)(e);return async function*(){let n;const s=()=>{null!=n&&n()};for(t.addEventListener("abort",s);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new lr(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new lr(e,n))}}));o=await Promise.race([e,i.next()]),n=null}catch(n){t.removeEventListener("abort",s);const o="aborted"===n.type&&t.aborted;if(o&&null!=r.onAbort&&r.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(e){null!=r.onReturnError&&r.onReturnError(e)}if(o&&!0===r.returnOnAbort)return;throw n}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}()}var fr=n(56546),pr=n(91893);const yr=(0,Jn.kg)("libp2p:mss"),gr=ur("\n");function mr(e){const t=new Ge.H(e,gr);return pr.c.single(t)}function wr(e,t,n={}){const r=mr(t);!0===n.writeBytes?e.push(r.subarray()):e.push(r)}async function br(e,t){const n=await async function(e,t){let n=1;const r={[Symbol.asyncIterator]:()=>r,next:async()=>e.next(n)};let i=r;null!=t?.signal&&(i=dr(r,t.signal));const s=e=>{n=e},a=await(0,Un.z)(i,(e=>pr.J(e,{onLength:s,maxDataLength:Yn.Y})),(async e=>(0,fr.Z)(e)));if(null==a||0===a.length)throw new o.sv("no buffer returned","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(a.get(a.byteLength-1)!==gr[0])throw yr.error("Invalid mss message - missing newline - %s",a.subarray()),new o.sv("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return a.sublist(0,-1)}(e,t);return function(e,t="utf8"){const n=cr[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(n.subarray())}const Er=(0,Jn.kg)("libp2p:mss:select");async function vr(e,t,n={}){t=Array.isArray(t)?[...t]:[t];const{reader:r,writer:i,rest:s,stream:a}=tr(e),c=t.shift();if(null==c)throw new Error("At least one protocol must be specified");Er.trace('select: write ["%s", "%s"]',Yn.T,c);!function(e,t,n={}){const r=new Ge.H;for(const e of t)r.append(mr(e));!0===n.writeBytes?e.push(r.subarray()):e.push(r)}(i,[ur(Yn.T),ur(c)],n);let u=await br(r,n);if(Er.trace('select: read "%s"',u),u===Yn.T&&(u=await br(r,n),Er.trace('select: read "%s"',u)),u===c)return s(),{stream:a,protocol:c};for(const e of t){Er.trace('select: write "%s"',e),wr(i,ur(e),n);const t=await br(r,n);if(Er.trace('select: read "%s" for "%s"',t,e),t===e)return s(),{stream:a,protocol:e}}throw s(),new o.sv("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}const _r=(0,Jn.kg)("libp2p:mss:handle");async function Sr(e,t,n){t=Array.isArray(t)?t:[t];const{writer:r,reader:i,rest:s,stream:o}=tr(e);for(;;){const e=await br(i,n);if(_r.trace('read "%s"',e),e!==Yn.T){if(t.includes(e))return wr(r,ur(e),n),_r.trace('respond with "%s" for "%s"',e,e),s(),{stream:o,protocol:e};"ls"!==e?(wr(r,ur("na"),n),_r('respond with "na" for "%s"',e)):(wr(r,new Ge.H(...t.map((e=>mr(ur(e))))),n),_r.trace('respond with "%s" for %s',t,e))}else _r.trace('respond with "%s" for "%s"',Yn.T,e),wr(r,ur(Yn.T),n)}}var Rr=n(50508);const Ar=(0,we.kg)("libp2p:connection");class Ir{id;remoteAddr;remotePeer;direction;timeline;multiplexer;encryption;status;transient;tags;_newStream;_close;_abort;_getStreams;constructor(e){const{remoteAddr:t,remotePeer:n,newStream:r,close:i,abort:s,getStreams:o}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=n,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.transient=e.transient??!1,this._newStream=r,this._close=i,this._abort=s,this._getStreams=o,this.tags=[]}[Symbol.toStringTag]="Connection";[Rr.N]=!0;get streams(){return this._getStreams()}async newStream(e,t){if("closing"===this.status)throw new o.sv("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if("closed"===this.status)throw new o.sv("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(e)||(e=[e]),this.transient&&!0!==t?.runOnTransientConnection)throw new o.sv("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");const n=await this._newStream(e,t);return n.direction="outbound",n}async close(e={}){if("closed"!==this.status&&"closing"!==this.status){Ar("closing connection to %a",this.remoteAddr),this.status="closing",e.signal=e?.signal??AbortSignal.timeout(500);try{(0,r.setMaxListeners)?.(1/0,e.signal)}catch{}try{await Promise.all(this.streams.map((async t=>t.close(e)))),await this._close(e),this.timeline.close=Date.now(),this.status="closed"}catch(e){Ar.error("error encountered during graceful close of connection to %a",this.remoteAddr,e),this.abort(e)}}}abort(e){Ar.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach((t=>{t.abort(e)})),Ar.error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}}const Tr=(0,we.kg)("libp2p:upgrader");function Cr(e,t,n){let r=0;return n.streams.forEach((n=>{n.direction===t&&n.protocol===e&&r++})),r}class Pr{components;connectionEncryption;muxers;inboundUpgradeTimeout;events;constructor(e,t){this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout??pn.aV,this.events=e.events}async shouldBlockConnection(e,t,n){const r=this.components.connectionGater[n];if(void 0!==r&&await r(e,t))throw new o.sv(`The multiaddr connection is blocked by gater.${n}`,sn.q.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(e,t){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw new o.sv("connection denied",sn.q.ERR_CONNECTION_DENIED);let n,i,s,a,c;const u=AbortSignal.timeout(this.inboundUpgradeTimeout),l=()=>{e.abort(new o.sv("inbound upgrade timeout",sn.q.ERR_TIMEOUT))};u.addEventListener("abort",l,{once:!0});try{(0,r.setMaxListeners)?.(1/0,u)}catch{}try{if(!0===await(this.components.connectionGater.denyInboundConnection?.(e)))throw new o.sv("The multiaddr connection is blocked by gater.acceptConnection",sn.q.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),Tr("starting the inbound connection upgrade");let r=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(Tr("protecting the inbound connection"),r=await t.protect(e))}try{if(n=r,!0!==t?.skipEncryption){({conn:n,remotePeer:i,protocol:c}=await this._encryptInbound(r));const e={...r,...n};await this.shouldBlockConnection(i,e,"denyInboundEncryptedConnection")}else{const t=e.remoteAddr.getPeerId();if(null==t)throw new o.sv("inbound connection that skipped encryption must have a peer id",sn.q.ERR_INVALID_MULTIADDR);const n=(0,Ee.jE)(t);c="native",i=n}if(s=n,null!=t?.muxerFactory)a=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...r,...n},this.muxers);a=e.muxerFactory,s=e.stream}}catch(e){throw Tr.error("Failed to upgrade inbound connection",e),e}return await this.shouldBlockConnection(i,e,"denyInboundUpgradedConnection"),Tr("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:c,direction:"inbound",maConn:e,upgradedConn:s,muxerFactory:a,remotePeer:i,transient:t?.transient})}finally{u.removeEventListener("abort",l),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){const n=e.remoteAddr.getPeerId();let r,i,s,a,c,u;null!=n&&(r=(0,Ee.jE)(n),await this.shouldBlockConnection(r,e,"denyOutboundConnection")),this.components.metrics?.trackMultiaddrConnection(e),Tr("Starting the outbound connection upgrade");let l=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(l=await t.protect(e))}try{if(i=l,!0!==t?.skipEncryption){({conn:i,remotePeer:s,protocol:c}=await this._encryptOutbound(l,r));const e={...l,...i};await this.shouldBlockConnection(s,e,"denyOutboundEncryptedConnection")}else{if(null==r)throw new o.sv("Encryption was skipped but no peer id was passed",sn.q.ERR_INVALID_PEER);c="native",s=r}if(a=i,null!=t?.muxerFactory)u=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...l,...i},this.muxers);u=e.muxerFactory,a=e.stream}}catch(t){throw Tr.error("Failed to upgrade outbound connection",t),await e.close(t),t}return await this.shouldBlockConnection(s,e,"denyOutboundUpgradedConnection"),Tr("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:e,upgradedConn:a,muxerFactory:u,remotePeer:s,transient:t?.transient})}_createConnection(e){const{cryptoProtocol:t,direction:n,maConn:i,upgradedConn:s,remotePeer:a,muxerFactory:c,transient:u}=e;let l,h,d;null!=c&&(l=c.createStreamMuxer({direction:n,onIncomingStream:e=>{null!=d&&Promise.resolve().then((async()=>{const t=this.components.registrar.getProtocols(),{stream:r,protocol:i}=await Sr(e,t);if(Tr("%s: incoming stream opened on %s",n,i),null==d)return;const s=function(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(e){if(e.code!==sn.q.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return 32}(i,this.components.registrar);if(Cr(i,"inbound",d)===s){const t=new o.sv(`Too many inbound protocol streams for protocol "${i}" - limit ${s}`,sn.q.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw e.abort(t),t}e.source=r.source,e.sink=r.sink,e.protocol=i,await this.components.peerStore.merge(a,{protocols:[i]}),this.components.metrics?.trackProtocolStream(e,d),this._onStream({connection:d,stream:e,protocol:i})})).catch((async t=>{Tr.error(t),null==e.timeline.close&&await e.close()}))}}),h=async(e,t={})=>{if(null==l)throw new o.sv("Stream is not multiplexed",sn.q.ERR_MUXER_UNAVAILABLE);Tr("%s: starting new stream on %s",n,e);const i=await l.newStream();try{if(null==t.signal){Tr("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e),t.signal=AbortSignal.timeout(3e4);try{(0,r.setMaxListeners)?.(1/0,t.signal)}catch{}}const{stream:n,protocol:s}=await vr(i,e,t),c=function(e,t,n={}){try{const{options:n}=t.getHandler(e);if(null!=n.maxOutboundStreams)return n.maxOutboundStreams}catch(e){if(e.code!==sn.q.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return n.maxOutboundStreams??64}(s,this.components.registrar,t);if(Cr(s,"outbound",d)>=c){const e=new o.sv(`Too many outbound protocol streams for protocol "${s}" - limit ${c}`,sn.q.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw i.abort(e),e}return await this.components.peerStore.merge(a,{protocols:[s]}),i.source=n.source,i.sink=n.sink,i.protocol=s,this.components.metrics?.trackProtocolStream(i,d),i}catch(t){if(Tr.error("could not create new stream for protocols %s on connection with address %a",e,d.remoteAddr,t),null==i.timeline.close&&i.abort(t),null!=t.code)throw t;throw new o.sv(String(t),sn.q.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([l.sink(s.source),s.sink(l.source)]).catch((e=>{Tr.error(e)})));const f=i.timeline;i.timeline=new Proxy(f,{set:(...e)=>(null!=d&&"close"===e[1]&&null!=e[2]&&null==f.close&&(async()=>{try{"open"===d.status&&await d.close()}catch(e){Tr.error(e)}finally{this.events.safeDispatchEvent("connection:close",{detail:d})}})().catch((e=>{Tr.error(e)})),Reflect.set(...e))}),i.timeline.upgraded=Date.now();var p;return p={remoteAddr:i.remoteAddr,remotePeer:a,status:"open",direction:n,timeline:i.timeline,multiplexer:l?.protocol,encryption:t,transient:u,newStream:h??(()=>{throw new o.sv("connection is not multiplexed",sn.q.ERR_CONNECTION_NOT_MULTIPLEXED)}),getStreams:()=>null!=l?l.streams:[],close:async e=>{await i.close(e),null!=l&&await l.close(e)},abort:e=>{i.abort(e),null!=l&&l.abort(e)}},d=new Ir(p),this.events.safeDispatchEvent("connection:open",{detail:d}),d}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:i,options:s}=this.components.registrar.getHandler(r);if(t.transient&&!0!==s.runOnTransientConnection)throw new o.sv("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");i({connection:t,stream:n})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());Tr("handling inbound crypto protocol selection",t);try{const{stream:n,protocol:r}=await Sr(e,t,{writeBytes:!0}),i=this.connectionEncryption.get(r);if(null==i)throw new Error(`no crypto module found for ${r}`);return Tr("encrypting inbound connection..."),{...await i.secureInbound(this.components.peerId,n),protocol:r}}catch(e){throw new o.sv(String(e),sn.q.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncryption.keys());Tr("selecting outbound crypto protocol",n);try{const{stream:r,protocol:i}=await vr(e,n,{writeBytes:!0}),s=this.connectionEncryption.get(i);if(null==s)throw new Error(`no crypto module found for ${i}`);return Tr("encrypting outbound connection to %p",t),{...await s.secureOutbound(this.components.peerId,r,t),protocol:i}}catch(e){throw new o.sv(String(e),sn.q.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const n=Array.from(t.keys());Tr("outbound selecting muxer %s",n);try{const{stream:r,protocol:i}=await vr(e,n,{writeBytes:!0});Tr("%s selected as muxer protocol",i);return{stream:r,muxerFactory:t.get(i)}}catch(e){throw Tr.error("error multiplexing outbound stream",e),new o.sv(String(e),sn.q.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const n=Array.from(t.keys());Tr("inbound handling muxers %s",n);try{const{stream:r,protocol:i}=await Sr(e,n,{writeBytes:!0});return{stream:r,muxerFactory:t.get(i)}}catch(e){throw Tr.error("error multiplexing inbound stream",e),new o.sv(String(e),sn.q.ERR_MUXER_UNAVAILABLE)}}}const kr=(0,we.kg)("libp2p");class Nr extends a.v{peerId;peerStore;contentRouting;peerRouting;keychain;metrics;services;components;#d;constructor(e){super();const t=new a.v,n=t.dispatchEvent.bind(t);t.dispatchEvent=e=>{const t=n(e),r=this.dispatchEvent(new a.A(e.type,{detail:e.detail}));return t||r};try{(0,r.setMaxListeners)?.(1/0,t)}catch{}this.#d=!1,this.peerId=e.peerId,this.services={};const i=this.components=function(e={}){const t=new qt(e);return new Proxy(t,{get(e,n,r){if("string"==typeof n&&!Gt.includes(n)){const e=t.components[n];if(null==e&&!Ht.includes(n))throw new o.sv(`${n} not set`,"ERR_SERVICE_MISSING");return e}return Reflect.get(e,n,r)},set:(e,n,r)=>("string"==typeof n?t.components[n]=r:Reflect.set(e,n,r),!0)})}({peerId:e.peerId,events:t,datastore:e.datastore??new Ut.a,connectionGater:Wt(e.connectionGater)});this.peerStore=this.configureComponent("peerStore",new Lt(i,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),null!=e.metrics&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),i.events.addEventListener("peer:update",(e=>{if(null==e.detail.previous){const t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((e=>e.multiaddr)),protocols:e.detail.peer.protocols};i.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&this.configureComponent("connectionProtector",e.connectionProtector(i)),this.components.upgrader=new Pr(this.components,{connectionEncryption:(e.connectionEncryption??[]).map(((e,t)=>this.configureComponent(`connection-encryption-${t}`,e(this.components)))),muxers:(e.streamMuxers??[]).map(((e,t)=>this.configureComponent(`stream-muxers-${t}`,e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new Qn(this.components,e.transportManager)),this.configureComponent("connectionManager",new Nn(this.components,e.connectionManager)),this.configureComponent("registrar",new Gn(this.components)),this.configureComponent("addressManager",new jt(this.components,e.addresses));const l=me.generateOptions();this.keychain=this.configureComponent("keyChain",new me(this.components,{...l,...e.keychain}));const h=(e.peerRouters??[]).map(((e,t)=>this.configureComponent(`peer-router-${t}`,e(this.components))));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new qn(this.components,{routers:h}));const d=(e.contentRouters??[]).map(((e,t)=>this.configureComponent(`content-router-${t}`,e(this.components))));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new Fn(this.components,{routers:d})),(e.peerDiscovery??[]).forEach(((e,t)=>{this.configureComponent(`peer-discovery-${t}`,e(this.components)).addEventListener("peer",(e=>{this.#f(e)}))})),e.transports.forEach(((e,t)=>{this.components.transportManager.add(this.configureComponent(`transport-${t}`,e(this.components)))})),null!=e.services)for(const t of Object.keys(e.services)){const n=(0,e.services[t])(this.components);null!=n?(this.services[t]=n,this.configureComponent(t,n),null!=n[s.J]&&(kr("registering service %s for content routing",t),d.push(n[s.J])),null!=n[u.z]&&(kr("registering service %s for peer routing",t),h.push(n[u.z])),null!=n[c.O]&&(kr("registering service %s for peer discovery",t),n[c.O].addEventListener("peer",(e=>{this.#f(e)})))):kr.error("service factory %s returned null or undefined instance",t)}}configureComponent(e,t){return null==t&&kr.error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if(this.#d)return;this.#d=!0,kr("libp2p is starting");null==(await this.keychain.listKeys()).find((e=>"self"===e.name))&&(kr("importing self key into keychain"),await this.keychain.importPeer("self",this.components.peerId));try{await(this.components.beforeStart?.()),await this.components.start(),await(this.components.afterStart?.()),this.safeDispatchEvent("start",{detail:this}),kr("libp2p has started")}catch(e){throw kr.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){this.#d&&(kr("libp2p is stopping"),this.#d=!1,await(this.components.beforeStop?.()),await this.components.stop(),await(this.components.afterStop?.()),this.safeDispatchEvent("stop",{detail:this}),kr("libp2p has stopped"))}isStarted(){return this.#d}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new be.fd;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){return this.components.connectionManager.openConnection(e,t)}async dialProtocol(e,t,n={}){if(null==t)throw new o.sv("no protocols were provided to open a stream",sn.q.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw new o.sv("no protocols were provided to open a stream",sn.q.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(e,n)).newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e,t={}){(0,Ot.h2)(e)&&(e=(0,Ee.jE)(e.getPeerId()??"")),await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e,t={}){if(kr("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const n=await this.peerStore.get(e);if(null!=n.id.publicKey)return n.id.publicKey;const r=(0,Mt.z)([(0,Bt.m)("/pk/"),e.multihash.digest]),s=await this.contentRouting.get(r,t);return(0,i.lR)(s),await this.peerStore.patch(e,{publicKey:s}),s}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return this.components.registrar.register(e,t)}unregister(e){this.components.registrar.unregister(e)}#f(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs,protocols:t.protocols}).catch((e=>{kr.error(e)})):kr.error(new Error(sn.q.ERR_DISCOVERED_SELF))}}async function xr(e){if(null==e.peerId){const t=e.datastore;if(null!=t)try{const n=new me({datastore:t},(0,re.Z)(me.generateOptions(),e.keychain));e.peerId=await n.exportPeerId("self")}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}return null==e.peerId&&(e.peerId=await(0,ve.n9)()),new Nr(function(e){const t=(0,re.Z)(on,e);if(null==t.transports||t.transports.length<1)throw new o.sv(sn.s.ERR_TRANSPORTS_REQUIRED,sn.q.ERR_TRANSPORTS_REQUIRED);if(null===t.connectionProtector&&null!=globalThis.process?.env?.LIBP2P_FORCE_PNET)throw new o.sv(sn.s.ERR_PROTECTOR_REQUIRED,sn.q.ERR_PROTECTOR_REQUIRED);return t}(e))}async function Dr(e){const t=await xr(e);return!1!==e.start&&await t.start(),t}},66441:function(e,t,n){"use strict";n.d(t,{GW:function(){return r},LX:function(){return a},Rv:function(){return i},tm:function(){return u},vE:function(){return c},vo:function(){return o},wc:function(){return s}});const r=32,i="1.0.0",s="ping",o="ipfs",a=1e4,c=2,u=1},58541:function(e,t,n){"use strict";n.d(t,{J:function(){return f}});n(27002),n(23352),n(77755),n(11643);var r=n(18054),i=n(49541),s=n(38699),o=n(31650),a=n(90212),c=n(8611),u=n(64188),l=n(66441);const h=(0,s.kg)("libp2p:ping");class d{protocol;components;started;timeout;maxInboundStreams;maxOutboundStreams;runOnTransientConnection;constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix??l.vo}/${l.wc}/${l.Rv}`,this.timeout=t.timeout??l.LX,this.maxInboundStreams=t.maxInboundStreams??l.vE,this.maxOutboundStreams=t.maxOutboundStreams??l.tm,this.runOnTransientConnection=t.runOnTransientConnection??!0}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){h("incoming ping from %p",e.connection.remotePeer);const{stream:t}=e,n=Date.now();(0,a.z)(t,t).catch((t=>{h.error("incoming ping from %p failed with error",e.connection.remotePeer,t)})).finally((()=>{const t=Date.now()-n;h("incoming ping from %p complete in %dms",e.connection.remotePeer,t)}))}async ping(e,t={}){h("pinging %p",e);const n=Date.now(),s=(0,r.Z)(l.GW),d=await this.components.connectionManager.openConnection(e,t);let f,p=()=>{};t.signal=t.signal??AbortSignal.timeout(this.timeout);try{f=await d.newStream(this.protocol,{...t,runOnTransientConnection:this.runOnTransientConnection}),p=()=>{f?.abort(new i.sv("ping timeout",u.q.ERR_TIMEOUT))},t.signal.addEventListener("abort",p,{once:!0});const e=await(0,a.z)([s],f,(async e=>(0,o.Z)(e))),r=Date.now()-n;if(null==e)throw new i.sv(`Did not receive a ping ack after ${r}ms`,u.q.ERR_WRONG_PING_ACK);if(!(0,c.f)(s,e.subarray()))throw new i.sv(`Received wrong ping ack after ${r}ms`,u.q.ERR_WRONG_PING_ACK);return h("ping %p complete in %dms",d.remotePeer,r),r}catch(e){throw h.error("error while pinging %p",d.remotePeer,e),f?.abort(e),e}finally{t.signal.removeEventListener("abort",p),null!=f&&await f.close()}}}function f(e={}){return t=>new d(t,e)}},95554:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var r=n(49541),i=n(48347),s=n(64188);class o{#p=[];enqueue(e,t){const n=t?.peerId,i=t?.priority??0;if(null==n)throw new r.sv("missing peer id",s.q.ERR_INVALID_PARAMETERS);const o={priority:i,peerId:n,run:e};if(this.size>0&&this.#p[this.size-1].priority>=i)return void this.#p.push(o);const a=function(e,t,n){let r=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=r+s;n(e[o],t)<=0?(r=++o,i-=s+1):i=s}return r}(this.#p,o,((e,t)=>t.priority-e.priority));this.#p.splice(a,0,o)}dequeue(){const e=this.#p.shift();return e?.run}filter(e){if(null!=e.peerId){const t=e.peerId;return this.#p.filter((e=>t.equals(e.peerId))).map((e=>e.run))}return this.#p.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#p.length}}class a extends i.Z{constructor(e={}){super({...e,queueClass:o})}hasJob(e){return this.sizeBy({peerId:e})>0}}},77755:function(e,t,n){"use strict";n.d(t,{Au:function(){return u},Re:function(){return h},lR:function(){return l},m2:function(){return f},r3:function(){return d}});n(3068),n(97450);var r=n(49541),i=(n(3832),n(97858),n(36536)),s=(n(54638),n(21979),n(92105),n(44216));const o={rsa:n(55363),ed25519:i,secp256k1:n(86995)};function a(e){const t=Object.keys(o).join(" / ");return new r.sv(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function c(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return o[e];throw a(e)}async function u(e,t){return c(e).generateKeyPair(t??2048)}function l(e){const t=s.nh.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case s.Jz.RSA:return o.rsa.unmarshalRsaPublicKey(n);case s.Jz.Ed25519:return o.ed25519.unmarshalEd25519PublicKey(n);case s.Jz.Secp256k1:return o.secp256k1.unmarshalSecp256k1PublicKey(n);default:throw a(t.Type??"unknown")}}function h(e,t){return c(t=(t??"rsa").toLowerCase()),e.bytes}async function d(e){const t=s._q.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case s.Jz.RSA:return o.rsa.unmarshalRsaPrivateKey(n);case s.Jz.Ed25519:return o.ed25519.unmarshalEd25519PrivateKey(n);case s.Jz.Secp256k1:return o.secp256k1.unmarshalSecp256k1PrivateKey(n);default:throw a(t.Type??"RSA")}}function f(e,t){return c(t=(t??"rsa").toLowerCase()),e.bytes}},44216:function(e,t,n){"use strict";n.d(t,{Jz:function(){return r},_q:function(){return o},nh:function(){return s}});var r,i,s,o,a=n(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(r||(r={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(i||(i={})),function(e){e.codec=()=>(0,a.Ji)(i)}(r||(r={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(s||(s={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,a.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),r.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:n.Type=r.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,a.LE)(t,e.codec()),e.decode=t=>(0,a.C6)(t,e.codec())}(o||(o={}))},18054:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(49541),i=n(41105);function s(e){if(isNaN(e)||e<=0)throw new r.sv("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return(0,i.O6)(e)}},45045:function(e,t,n){"use strict";n.d(t,{n9:function(){return s}});var r=n(77755),i=n(34042);n(97858),n(25763);const s=async()=>{const e=await(0,r.Au)("Ed25519"),t=await o(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)};async function o(e){return(0,i.y5)((0,r.Re)(e.public),(0,r.m2)(e))}},34042:function(e,t,n){"use strict";n.d(t,{cv:function(){return v},jE:function(){return E},y5:function(){return _}});n(49541);var r=n(5681),i=n(55729),s=n(13351),o=n(25674),a=n(62550),c=n(60150),u=n(59425),l=n(8611);const h=Symbol.for("nodejs.util.inspect.custom"),d=Object.values(s.gh).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),s.gh.identity.decoder),f=114,p=36,y=37;class g{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[r.N]=!0;toString(){return null==this.string&&(this.string=i.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return o.k0.createV1(f,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return(0,l.f)(this.multihash.bytes,e);if("string"==typeof e)return E(e).equals(this);if(null!=e?.multihash?.bytes)return(0,l.f)(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[h](){return`PeerId(${this.toString()})`}}class m extends g{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class w extends g{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}}class b extends g{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}}function E(e,t){if(t=t??d,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=a.Jx(i.base58btc.decode(`z${e}`));return e.startsWith("12D")?new w({multihash:t}):e.startsWith("16U")?new b({multihash:t}):new m({multihash:t})}return v(d.decode(e))}function v(e){try{const t=a.Jx(e);if(t.code===c.identity.code){if(t.digest.length===p)return new w({multihash:t});if(t.digest.length===y)return new b({multihash:t})}if(t.code===u.sha256.code)return new m({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==f)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===u.sha256.code)return new m({multihash:e.multihash});if(t.code===c.identity.code){if(t.digest.length===p)return new w({multihash:e.multihash});if(t.digest.length===y)return new b({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(o.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function _(e,t){return e.length===p?new w({multihash:a.Ue(c.identity.code,e),privateKey:t}):e.length===y?new b({multihash:a.Ue(c.identity.code,e),privateKey:t}):new m({multihash:await u.sha256.digest(e),publicKey:e,privateKey:t})}},76626:function(e,t,n){"use strict";n.d(t,{K:function(){return b},X:function(){return f}});var r=n(77755),i=n(49541),s=n(34042),o=n(57050),a=n(62308),c=n(8611),u=n(97858);const l="ERR_SIGNATURE_NOT_VALID";var h,d=n(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,d.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>(0,d.LE)(t,e.codec()),e.decode=t=>(0,d.C6)(t,e.codec())}(h||(h={}));class f{static createFromProtobuf=async e=>{const t=h.decode(e),n=await(0,s.y5)(t.publicKey);return new f({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})};static seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,i=e.codec,s=e.marshal(),o=p(n,i,s),a=await(0,r.r3)(t.privateKey),c=await a.sign(o.subarray());return new f({peerId:t,payloadType:i,payload:s,signature:c})};static openAndCertify=async(e,t)=>{const n=await f.createFromProtobuf(e);if(!await n.validate(t))throw new i.sv("envelope signature is not valid for the given domain",l);return n};peerId;payloadType;payload;signature;marshaled;constructor(e){const{peerId:t,payloadType:n,payload:r,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=h.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return(0,c.f)(this.marshal(),e.marshal())}async validate(e){const t=p(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");return(0,r.lR)(this.peerId.publicKey).verify(t.subarray(),this.signature)}}const p=(e,t,n)=>{const r=(0,u.m)(e),i=o.cv(r.byteLength),s=o.cv(t.length),c=o.cv(n.length);return new a.H(i,r,s,t,c,n)};var y=n(95717),g=n(6540);const m=Uint8Array.from([3,1]);var w;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=(0,d.yw)(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3==1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>(0,d.LE)(t,e.codec()),e.decode=t=>(0,d.C6)(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=(0,d.yw)(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const r of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(r,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),n),e.encode=t=>(0,d.LE)(t,e.codec()),e.decode=t=>(0,d.C6)(t,e.codec())}(w||(w={}));class b{static createFromProtobuf=e=>{const t=w.decode(e),n=(0,s.cv)(t.peerId),r=(t.addresses??[]).map((e=>(0,g.HM)(e.multiaddr))),i=t.seq;return new b({peerId:n,multiaddrs:r,seqNumber:i})};static DOMAIN="libp2p-peer-record";static CODEC=m;peerId;multiaddrs;seqNumber;domain=b.DOMAIN;codec=b.CODEC;marshaled;constructor(e){const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=n??[],this.seqNumber=r??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=w.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof b&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!(0,y._)(this.multiaddrs,e.multiaddrs)))}}},95717:function(e,t,n){"use strict";function r(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}n.d(t,{_:function(){return r}})},87744:function(e,t,n){"use strict";n.d(t,{Fm:function(){return v},xV:function(){return E}});n(9839);var r=n(10430),i=n(55729),s=n(13351),o=n(25674),a=n(62550),c=n(57050),u=n(68644),l=n(53890),h=n(48007);function d(e,t="utf8"){const n=l.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):(0,h.P)(globalThis.Buffer.from(e,"utf-8"))}var f=n(20253),p=n(49736);const y=p.C,g=p.aY,m=function(e){let t=0;if(e=e.toString().trim(),y(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(g(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;y(n[r])&&(e=m(n[r]),n[r]=(0,f.B)(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,(0,f.B)(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},w=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var b=n(66907);(0,b.Ev)("ip4"),(0,b.Ev)("ip6"),(0,b.Ev)("ipcidr");function E(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return function(e){const t=w(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!p.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return C(t);case 6:case 273:case 33:case 132:return I(t).toString();case 421:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return(0,f.B)(n,"base58btc")}(t);case 444:case 445:return P(t);case 466:return function(e){const t=c.Jx(e),n=e.slice(c.P$(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+(0,f.B)(n,"base64url")}(t);default:return(0,f.B)(t,"base16")}}function v(e,t){switch((0,b.Ev)(e).code){case 4:case 41:return R(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return T(t);case 6:case 273:case 33:case 132:return A(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?a.Jx(i.base58btc.decode(`z${e}`)).bytes:o.k0.parse(e).multihash.bytes;const n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=r.base32.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=r.base32.decode(`b${t[0]}`),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=A(i);return(0,u.z)([n,s],n.length+s.length)}(t);case 466:return function(e){const t=S.decode(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}(t);default:return d(t,"base16")}}const _=Object.values(s.gh).map((e=>e.decoder)),S=function(){let e=_[0].or(_[1]);return _.slice(2).forEach((t=>e=e.or(t))),e}();function R(e){if(!p.h6(e))throw new Error("invalid ip address");return m(e)}function A(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function I(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function T(e){const t=d(e),n=Uint8Array.from(c.cv(t.length));return(0,u.z)([n,t],n.length+t.length)}function C(e){const t=c.Jx(e);if((e=e.slice(c.P$(t))).length!==t)throw new Error("inconsistent lengths");return(0,f.B)(e)}function P(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2);return`${(0,f.B)(t,"base32")}:${I(n)}`}},6540:function(e,t,n){"use strict";n.d(t,{h2:function(){return _},HM:function(){return R},a_:function(){return h.Ev},s_:function(){return E}});var r=n(49541),i=n(55729),s=n(25674),o=n(37591),a=n(20253),c=n(57050),u=n(68644),l=n(87744),h=n(66907);function d(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const s=c.Jx(e,i),o=c.P$(s),u=(0,h.Ev)(s),d=y(u,e.slice(i+o));if(0===d){t.push([s]),n.push([s]),i+=o;continue}const f=e.slice(i+o,i+o+d);if(i+=d+o,i>e.length)throw m("Invalid address Uint8Array: "+(0,a.B)(e,"base16"));t.push([s,f]);const p=(0,l.xV)(s,f);if(n.push([s,p]),!0===u.path){r=p;break}}return{bytes:Uint8Array.from(e),string:f(n),tuples:t,stringTuples:n,path:r}}function f(e){const t=[];return e.map((e=>{const n=(0,h.Ev)(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),g(t.join("/"))}function p(e){return(0,u.z)(e.map((e=>{const t=(0,h.Ev)(e[0]);let n=Uint8Array.from(c.cv(t.code));return e.length>1&&null!=e[1]&&(n=(0,u.z)([n,e[1]])),n})))}function y(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=c.Jx(t instanceof Uint8Array?t:Uint8Array.from(t));return e+c.P$(e)}}function g(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function m(e){return new Error("Error parsing address: "+e)}n(48098);const w=Symbol.for("nodejs.util.inspect.custom"),b=[(0,h.Ev)("dns").code,(0,h.Ev)("dns4").code,(0,h.Ev)("dns6").code,(0,h.Ev)("dnsaddr").code],E=new Map,v=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _(e){return Boolean(e?.[v])}class S{bytes;#e;#t;#n;#r;[v]=!0;constructor(e){let t;if(null==e&&(e=""),e instanceof Uint8Array)t=d(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);t=function(e){const t=[],n=[];let r=null;const i=(e=g(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){const o=i[s],a=(0,h.Ev)(o);if(0===a.size){t.push([a.code]),n.push([a.code]);continue}if(s++,s>=i.length)throw m("invalid address: "+e);if(!0===a.path){r=g(i.slice(s).join("/")),t.push([a.code,(0,l.Fm)(a.code,r)]),n.push([a.code,r]);break}const c=(0,l.Fm)(a.code,i[s]);t.push([a.code,c]),n.push([a.code,(0,l.xV)(a.code,c)])}return{string:f(n),bytes:p(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!_(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=d(e.bytes)}this.bytes=t.bytes,this.#e=t.string,this.#t=t.tuples,this.#n=t.stringTuples,this.#r=t.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const s=(0,h.Ev)("tcp"),o=(0,h.Ev)("udp"),a=(0,h.Ev)("ip4"),c=(0,h.Ev)("ip6"),u=(0,h.Ev)("dns6"),l=(0,h.Ev)("ip6zone");for(const[d,f]of this.stringTuples())d===l.code&&(i=`%${f??""}`),b.includes(d)&&(t=s.name,r=443,n=`${f??""}${i}`,e=d===u.code?6:4),d!==s.code&&d!==o.code||(t=(0,h.Ev)(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=(0,h.Ev)(d).name,n=`${f??""}${i}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return this.#t.map((([e])=>Object.assign({},(0,h.Ev)(e))))}protoCodes(){return this.#t.map((([e])=>e))}protoNames(){return this.#t.map((([e])=>(0,h.Ev)(e).name))}tuples(){return this.#t}stringTuples(){return this.#n}encapsulate(e){return e=new S(e),new S(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new S(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new S(p(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((([t,n])=>{t===h.R5.p2p.code&&e.push([t,n]),t===h.R5["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?(0,a.B)(i.base58btc.decode(`z${e}`),"base58btc"):(0,a.B)(s.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return this.#r}equals(e){return(0,o.f)(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=E.get(t.name);if(null==n)throw new r.sv(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>new S(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[w](){return`Multiaddr(${this.#e})`}}function R(e){return new S(e)}},66907:function(e,t,n){"use strict";n.d(t,{Ev:function(){return o},R5:function(){return i}});const r=-1,i={},s={};function o(e){if("number"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[43,8,"ipcidr"],[53,r,"dns",!0],[54,r,"dns4",!0],[55,r,"dns6",!0],[56,r,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,!0],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[448,0,"tls"],[449,r,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);s[t.code]=t,i[t.name]=t}))},68644:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(65844),i=n(48007);function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.E)(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return(0,i.P)(n)}},37591:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{f:function(){return r}})},20253:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(53890);function i(e,t="utf8"){const n=r.Z[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},53890:function(e,t,n){"use strict";var r=n(39262),i=n(65844);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},57156:function(e,t,n){"use strict";function r(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)}for(const t of e){if(!0===t?.aborted){n();break}null!=t?.addEventListener&&t.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=t?.removeEventListener&&t.removeEventListener("abort",n)},r}n.d(t,{N:function(){return r}})},12416:function(e,t,n){"use strict";var r=n(75671);t.Z=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)await t(n)&&(yield n)}();const n=(0,r.Z)(e),{value:i,done:s}=n.next();if(!0===s)return function*(){}();const o=t(i);if("function"==typeof o.then)return async function*(){await o&&(yield i);for await(const e of n)await t(e)&&(yield e)}();const a=t;return function*(){!0===o&&(yield i);for(const e of n)a(e)&&(yield e)}()}},31650:function(e,t){"use strict";t.Z=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t}},34880:function(e,t,n){"use strict";var r=n(75671);t.Z=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const n of e)yield t(n)}();const n=(0,r.Z)(e),{value:i,done:s}=n.next();if(!0===s)return function*(){}();const o=t(i);if("function"==typeof o.then)return async function*(){yield await o;for await(const e of n)yield t(e)}();const a=t;return function*(){yield o;for(const e of n)yield a(e)}()}},34456:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});class r{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class i{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new r(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}},10430:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(86317);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},55729:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return i},base58flickr:function(){return s}});var r=n(86317);const i=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},59081:function(e,t,n){"use strict";n.d(t,{BB:function(){return o},fS:function(){return r},mL:function(){return s},oQ:function(){return i}});new Uint8Array(0);const r=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},i=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},25674:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(10430),i=n(55729),s=n(59081),o=n(62550),a=n(24231);const c=(e,t)=>{const{bytes:n,version:s}=e;return 0===s?f(n,l(e),t||i.base58btc.encoder):p(n,l(e),t||r.base32.encoder)},u=new WeakMap,l=e=>{const t=u.get(e);if(null==t){const t=new Map;return u.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==y)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=o.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&o.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new h(e,n,r,i||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=o.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==y)throw new Error(`Version 0 CID must use dag-pb (code: ${y}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,y,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,s.oQ)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),a=new o.zZ(t.multihashCode,t.digestSize,i,r);return[0===t.version?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=a.Jx(e.subarray(t));return t+=r,n};let r=n(),i=y;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const s=t,o=n(),c=n(),u=t+c;return{version:r,codec:i,multihashCode:o,digestSize:c,multihashSize:u-s,size:u}}static parse(e,t){const[n,r]=d(e,t),i=h.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return l(i).set(n,e),i}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case r.base32.prefix:{const n=t||r.base32;return[r.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const i=n.encode(e).slice(1);return t.set(r,i),i}return s},p=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},y=112,g=18,m=(e,t,n)=>{const r=a.P$(e),i=r+a.P$(t),s=new Uint8Array(i+n.byteLength);return a.mL(e,s,0),a.mL(t,s,r),s.set(n,i),s},w=Symbol.for("@ipld/js-cid/CID")},62550:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return s},fS:function(){return a},zZ:function(){return c}});var r=n(59081),i=n(24231);const s=(e,t)=>{const n=t.byteLength,r=i.P$(e),s=r+i.P$(n),o=new Uint8Array(s+n);return i.mL(e,o,0),i.mL(n,o,r),o.set(t,s),new c(e,n,t,o)},o=e=>{const t=(0,r.oQ)(e),[n,s]=i.Jx(t),[o,a]=i.Jx(t.subarray(s)),u=t.subarray(s+a);if(u.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,u,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.fS)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},60150:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(59081),i=n(62550);const s=r.oQ,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},24231:function(e,t,n){"use strict";n.d(t,{Jx:function(){return E},mL:function(){return v},P$:function(){return _}});var r=function e(t,n,r){n=n||[];var a=r=r||0;for(;t>=o;)n[r++]=255&t|i,t/=128;for(;t&s;)n[r++]=255&t|i,t>>>=7;return n[r]=0|t,e.bytes=r-a+1,n},i=128,s=-128,o=Math.pow(2,31);var a=function e(t,n){var r,i=0,s=0,o=n=n||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[o++],i+=s<28?(r&u)<<s:(r&u)*Math.pow(2,s),s+=7}while(r>=c);return e.bytes=o-n,i},c=128,u=127;var l=Math.pow(2,7),h=Math.pow(2,14),d=Math.pow(2,21),f=Math.pow(2,28),p=Math.pow(2,35),y=Math.pow(2,42),g=Math.pow(2,49),m=Math.pow(2,56),w=Math.pow(2,63),b={encode:r,decode:a,encodingLength:function(e){return e<l?1:e<h?2:e<d?3:e<f?4:e<p?5:e<y?6:e<g?7:e<m?8:e<w?9:10}};const E=(e,t=0)=>[b.decode(e,t),b.decode.bytes],v=(e,t,n=0)=>(b.encode(e,t,n),t),_=e=>b.encodingLength(e)},48347:function(e,t,n){"use strict";n.d(t,{Z:function(){return V}});var r,i=n(72287),s=n.n(i),o=n(71198),a=n(41594),c=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};r=new WeakMap;var u,l,h,d,f,p,y,g,m,w,b,E,v,_,S,R,A,I,T,C,P,k,N,x,D,L,O=class{constructor(){r.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&c(this,r,"f")[this.size-1].priority>=t.priority)return void c(this,r,"f").push(n);const i=(0,a.Z)(c(this,r,"f"),n,((e,t)=>t.priority-e.priority));c(this,r,"f").splice(i,0,n)}dequeue(){const e=c(this,r,"f").shift();return null==e?void 0:e.run}filter(e){return c(this,r,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return c(this,r,"f").length}},U=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},M=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class B extends Error{}class z extends(s()){constructor(e){var t,n,r,i;if(super(),u.add(this),l.set(this,void 0),h.set(this,void 0),d.set(this,0),f.set(this,void 0),p.set(this,void 0),y.set(this,0),g.set(this,void 0),m.set(this,void 0),w.set(this,void 0),b.set(this,void 0),E.set(this,0),v.set(this,void 0),_.set(this,void 0),S.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:O,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);U(this,l,e.carryoverConcurrencyCount,"f"),U(this,h,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),U(this,f,e.intervalCap,"f"),U(this,p,e.interval,"f"),U(this,w,new e.queueClass,"f"),U(this,b,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,U(this,S,!0===e.throwOnTimeout,"f"),U(this,_,!1===e.autoStart,"f")}get concurrency(){return M(this,v,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);U(this,v,e,"f"),M(this,u,"m",x).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:M(this,S,"f"),...t},new Promise(((n,r)=>{M(this,w,"f").enqueue((async()=>{var i,s,a;U(this,E,(s=M(this,E,"f"),++s),"f"),U(this,d,(a=M(this,d,"f"),++a),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new B("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=(0,o.ZP)(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,M(this,u,"m",D).call(this,t.signal)]));const s=await r;n(s),this.emit("completed",s)}catch(e){if(e instanceof o.W5&&!t.throwOnTimeout)return void n();r(e),this.emit("error",e)}finally{M(this,u,"m",I).call(this)}}),t),this.emit("add"),M(this,u,"m",P).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return M(this,_,"f")?(U(this,_,!1,"f"),M(this,u,"m",x).call(this),this):this}pause(){U(this,_,!0,"f")}clear(){U(this,w,new(M(this,b,"f")),"f")}async onEmpty(){0!==M(this,w,"f").size&&await M(this,u,"m",L).call(this,"empty")}async onSizeLessThan(e){M(this,w,"f").size<e||await M(this,u,"m",L).call(this,"next",(()=>M(this,w,"f").size<e))}async onIdle(){0===M(this,E,"f")&&0===M(this,w,"f").size||await M(this,u,"m",L).call(this,"idle")}get size(){return M(this,w,"f").size}sizeBy(e){return M(this,w,"f").filter(e).length}get pending(){return M(this,E,"f")}get isPaused(){return M(this,_,"f")}}l=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,y=new WeakMap,g=new WeakMap,m=new WeakMap,w=new WeakMap,b=new WeakMap,E=new WeakMap,v=new WeakMap,_=new WeakMap,S=new WeakMap,u=new WeakSet,R=function(){return M(this,h,"f")||M(this,d,"f")<M(this,f,"f")},A=function(){return M(this,E,"f")<M(this,v,"f")},I=function(){var e;U(this,E,(e=M(this,E,"f"),--e),"f"),M(this,u,"m",P).call(this),this.emit("next")},T=function(){M(this,u,"m",N).call(this),M(this,u,"m",k).call(this),U(this,m,void 0,"f")},C=function(){const e=Date.now();if(void 0===M(this,g,"f")){const t=M(this,y,"f")-e;if(!(t<0))return void 0===M(this,m,"f")&&U(this,m,setTimeout((()=>{M(this,u,"m",T).call(this)}),t),"f"),!0;U(this,d,M(this,l,"f")?M(this,E,"f"):0,"f")}return!1},P=function(){if(0===M(this,w,"f").size)return M(this,g,"f")&&clearInterval(M(this,g,"f")),U(this,g,void 0,"f"),this.emit("empty"),0===M(this,E,"f")&&this.emit("idle"),!1;if(!M(this,_,"f")){const e=!M(this,u,"a",C);if(M(this,u,"a",R)&&M(this,u,"a",A)){const t=M(this,w,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&M(this,u,"m",k).call(this),!0)}}return!1},k=function(){M(this,h,"f")||void 0!==M(this,g,"f")||(U(this,g,setInterval((()=>{M(this,u,"m",N).call(this)}),M(this,p,"f")),"f"),U(this,y,Date.now()+M(this,p,"f"),"f"))},N=function(){0===M(this,d,"f")&&0===M(this,E,"f")&&M(this,g,"f")&&(clearInterval(M(this,g,"f")),U(this,g,void 0,"f")),U(this,d,M(this,l,"f")?M(this,E,"f"):0,"f"),M(this,u,"m",x).call(this)},x=function(){for(;M(this,u,"m",P).call(this););},D=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new B("The task was aborted."))}),{once:!0})}))},L=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};var V=z},41594:function(e,t,n){"use strict";function r(e,t,n){let r=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=r+s;n(e[o],t)<=0?(r=++o,i-=s+1):i=s}return r}n.d(t,{Z:function(){return r}})},7394:function(e,t,n){"use strict";var r=n(13351),i=n(77539);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},72004:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(11067);const i=4294967296;class s{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo),t=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new s(n,t)}zzEncode(){const e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new s(t,n)}toBytes(e,t=0){const n=(0,r.Z)(e);for(;this.hi>0;)n.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(t++,127&this.lo|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new s;const t=e<0;t&&(e=-e);let n=0|Number(e>>32n),r=0|Number(e-(BigInt(n)<<32n));return t&&(n=~n>>>0,r=~r>>>0,++r>i&&(r=0,++n>i&&(n=0))),new s(n,r)}static fromNumber(e){if(0===e)return new s;const t=e<0;t&&(e=-e);let n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new s(r,n)}static fromBytes(e,t=0){const n=(0,r.Z)(e),i=new s;let o=0;if(e.length-t>4){for(;o<4;++o)if(i.lo=(i.lo|(127&n.get(t))<<7*o)>>>0,n.get(t++)<128)return i;if(i.lo=(i.lo|(127&n.get(t))<<28)>>>0,i.hi=(i.hi|(127&n.get(t))>>4)>>>0,n.get(t++)<128)return i;o=0}else for(;o<4;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.lo=(i.lo|(127&n.get(t))<<7*o)>>>0,n.get(t++)<128)return i}if(e.length-t>4){for(;o<5;++o)if(i.hi=(i.hi|(127&n.get(t))<<7*o+3)>>>0,n.get(t++)<128)return i}else if(t<e.byteLength)for(;o<5;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(i.hi=(i.hi|(127&n.get(t))<<7*o+3)>>>0,n.get(t++)<128)return i}throw RangeError("invalid varint encoding")}}},13775:function(e,t,n){"use strict";n.d(t,{Bu:function(){return r},M0:function(){return s},PR:function(){return c},Xj:function(){return o},dU:function(){return i},t4:function(){return a}});const r="lock:worker:request-read",i="lock:worker:release-read",s="lock:master:grant-read",o="lock:worker:request-write",a="lock:worker:release-write",c="lock:master:grant-write"},56027:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(95972);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}class s extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const o=e=>void 0===globalThis.DOMException?new s(e):new DOMException(e),a=e=>{const t=void 0===e.reason?o("This operation was aborted."):e.reason;return t instanceof Error?t:o(t)};var c=n(53416),u=n(13775);const l={},h=e=>{e.addEventListener("message",(t=>{h.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{h.dispatchEvent("message",e,t)}))};h.addEventListener=(e,t)=>{null==l[e]&&(l[e]=[]),l[e].push(t)},h.removeEventListener=(e,t)=>{null!=l[e]&&(l[e]=l[e].filter((e=>e===t)))},h.dispatchEvent=function(e,t,n){null!=l[e]&&l[e].forEach((e=>e(t,n)))};var d=h;const f=(e,t,n,r,i)=>(s,o)=>{if(o.data.type!==n)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==n||null==n.data)return;const i=n.data.type,o=(n.data.name,n.data.identifier);i===r&&o===a.identifier&&(s.removeEventListener("message",t),e())};s.addEventListener("message",t)})))}}))},p=(e,t,n,r)=>async()=>{const i=(0,c.x0)();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise((t=>{const s=o=>{if(null==o||null==o.data)return;const a=o.data.type,c=o.data.identifier;a===n&&c===i&&(globalThis.removeEventListener("message",s),t((()=>{globalThis.postMessage({type:r,identifier:i,name:e})})))};globalThis.addEventListener("message",s)}))},y={singleProcess:!1};var g=e=>{e=Object.assign({},y,e);if(Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return d.addEventListener("message",f(e,"requestReadLock",u.Bu,u.dU,u.M0)),d.addEventListener("message",f(e,"requestWriteLock",u.Xj,u.t4,u.PR)),e}return{isWorker:!0,readLock:e=>p(e,u.Bu,u.M0,u.dU),writeLock:e=>p(e,u.Xj,u.PR,u.t4)}};const m={};let w;async function b(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>await function(e,t){const{milliseconds:n,fallback:r,message:s,customTimers:o={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let c;const u=new Promise(((u,l)=>{if("number"!=typeof n||1!==Math.sign(n))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(n===Number.POSITIVE_INFINITY)return void u(e);if(t.signal){const{signal:e}=t;e.aborted&&l(a(e)),e.addEventListener("abort",(()=>{l(a(e))}))}const h=new i;c=o.setTimeout.call(void 0,(()=>{if(r)try{u(r())}catch(e){l(e)}else"function"==typeof e.cancel&&e.cancel(),!1===s?u():s instanceof Error?l(s):(h.message=s??`Promise timed out after ${n} milliseconds`,l(h))}),n),(async()=>{try{u(await e)}catch(e){l(e)}finally{o.clearTimeout.call(void 0,c)}})()}));return u.clear=()=>{o.clearTimeout.call(void 0,c),c=void 0},u}((async()=>await new Promise((e=>{n((()=>{e()}))})))(),{milliseconds:t.timeout}))),await r}const E=(e,t)=>{if(!0===w.isWorker)return{readLock:w.readLock(e,t),writeLock:w.writeLock(e,t)};const n=new r.Z({concurrency:1});let i;return{async readLock(){if(null!=i)return await b(i,t);i=new r.Z({concurrency:t.concurrency,autoStart:!1});const e=i,s=b(i,t);return n.add((async()=>(e.start(),await e.onIdle().then((()=>{i===e&&(i=null)}))))),await s},writeLock:async()=>(i=null,await b(n,t))}},v={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function _(e){const t=Object.assign({},v,e);return null==w&&(w=g(t),!0!==w.isWorker&&(w.addEventListener("requestReadLock",(e=>{null!=m[e.data.name]&&m[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),w.addEventListener("requestWriteLock",(async e=>{null!=m[e.data.name]&&m[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==m[t.name]&&(m[t.name]=E(t.name,t)),m[t.name]}},14249:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return i},base32hex:function(){return c},base32hexpad:function(){return l},base32hexpadupper:function(){return h},base32hexupper:function(){return u},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return s},base32z:function(){return d}});var r=n(75385);const i=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},68673:function(e,t,n){"use strict";n.r(t),n.d(t,{base36:function(){return i},base36upper:function(){return s}});var r=n(75385);const i=(0,r.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),s=(0,r.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})},99382:function(e,t,n){"use strict";n.r(t),n.d(t,{base64:function(){return i},base64pad:function(){return s},base64url:function(){return o},base64urlpad:function(){return a}});var r=n(75385);const i=(0,r.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),s=(0,r.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o=(0,r.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=(0,r.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},93387:function(e,t,n){"use strict";n.d(t,{QB:function(){return b},gh:function(){return m},kq:function(){return w}});var r=n(6020),i=n(87083),s=n(23173),o=n(40204),a=n(54743),c=n(14249),u=n(68673),l=n(81653),h=n(99382),d=n(66433),f=n(27353),p=n(38566),y=n(53137),g=n(22188);n(11015);const m={...r,...i,...s,...o,...a,...c,...u,...l,...h,...d},w={...f,...p},b={raw:y,json:g}},7618:function(e,t,n){"use strict";n.d(t,{OV:function(){return l}});var r=n(11015);function i({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*s(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[n,i]of t.entries()){const t=[...e,n],s=r.k0.asCID(i);s?yield[t.join("/"),s]:"object"==typeof i&&(yield*o(i,t))}else{const n=r.k0.asCID(t);n?yield[e.join("/"),n]:yield*o(t,e)}}function*o(e,t){if(null==e||e instanceof Uint8Array)return;const n=r.k0.asCID(e);n&&(yield[t.join("/"),n]);for(const[n,r]of Object.entries(e)){const e=[...t,n];yield*s(e,r)}}function*a(e,t){if(Array.isArray(t))for(const[n,i]of t.entries()){const t=[...e,n];yield t.join("/"),"object"!=typeof i||r.k0.asCID(i)||(yield*c(i,t))}else yield*c(t,e)}function*c(e,t){if(null!=e&&"object"==typeof e)for(const[n,i]of Object.entries(e)){const e=[...t,n];yield e.join("/"),null==i||i instanceof Uint8Array||"object"!=typeof i||r.k0.asCID(i)||(yield*a(e,i))}}class u{constructor({cid:e,bytes:t,value:n}){if(!e||!t||void 0===n)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:i(),bytes:i(),value:i(),asBlock:i()})}links(){return o(this.value,[])}tree(){return c(this.value,[])}get(e="/"){return function(e,t){let n=e;for(const[e,i]of t.entries()){if(n=n[i],null==n)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const s=r.k0.asCID(n);if(s)return{value:s,remaining:t.slice(e+1).join("/")}}return{value:n}}(this.value,e.split("/").filter(Boolean))}}function l({bytes:e,cid:t,value:n,codec:r}){const i=void 0!==n?n:r&&r.decode(e);if(void 0===i)throw new Error('Missing required argument, must either provide "value" or "codec"');return new u({cid:t,bytes:e,value:i})}},7176:function(e,t,n){"use strict";n.r(t),n.d(t,{coerce:function(){return a},empty:function(){return r},equals:function(){return o},fromHex:function(){return s},fromString:function(){return u},isBinary:function(){return c},toHex:function(){return i},toString:function(){return l}});const r=new Uint8Array(0),i=e=>e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),s=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):r},o=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},a=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},c=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),u=e=>(new TextEncoder).encode(e),l=e=>(new TextDecoder).decode(e)},22188:function(e,t,n){"use strict";n.r(t),n.d(t,{code:function(){return o},decode:function(){return c},encode:function(){return a},name:function(){return s}});const r=new TextEncoder,i=new TextDecoder,s="json",o=512,a=e=>r.encode(JSON.stringify(e)),c=e=>JSON.parse(i.decode(e))},53137:function(e,t,n){"use strict";n.r(t),n.d(t,{code:function(){return s},decode:function(){return a},encode:function(){return o},name:function(){return i}});var r=n(7176);const i="raw",s=85,o=e=>(0,r.coerce)(e),a=e=>(0,r.coerce)(e)},38566:function(e,t,n){"use strict";n.r(t),n.d(t,{identity:function(){return o}});var r=n(7176),i=n(29094);const s=r.coerce,o={code:0,name:"identity",encode:s,digest:e=>i.Ue(0,s(e))}},27353:function(e,t,n){"use strict";n.r(t),n.d(t,{sha256:function(){return s},sha512:function(){return o}});var r=n(22688);const i=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),s=(0,r.D)({name:"sha2-256",code:18,encode:i("SHA-256")}),o=(0,r.D)({name:"sha2-512",code:19,encode:i("SHA-512")})},11015:function(e,t,n){"use strict";n.d(t,{aI:function(){return i},k0:function(){return r.k0}});var r=n(38161),i=(n(73438),n(7176));n(22688),n(29094)},41232:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var r=n(81653);const i=async({cid:e,load:t,seen:n})=>{n=n||new Set;const s=e.toString(r.base58btc);if(n.has(s))return;const o=await t(e);if(n.add(s),null!==o)for(const[,e]of o.links())await i({cid:e,load:t,seen:n})}},85275:function(e,t,n){"use strict";function r(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}n.d(t,{Z:function(){return r}})},90954:function(e,t,n){"use strict";n.d(t,{W5:function(){return r},yM:function(){return u}});class r extends Error{constructor(e){super(e),this.name="TimeoutError"}}class i extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const s=e=>void 0===globalThis.DOMException?new i(e):new DOMException(e),o=e=>{const t=void 0===e.reason?s("This operation was aborted."):e.reason;return t instanceof Error?t:s(t)};const a=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function c(e,t,n){let i;const s=new Promise(((r,s)=>{if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");n.signal?.throwIfAborted();const o=[t].flat(),c=[],{addListener:u,removeListener:l}=a(e),h=(...e)=>{const t=n.multiArgs?e:e[0];n.filter&&!n.filter(t)||(c.push(t),n.count===c.length&&(i(),r(c)))},d=e=>{i(),s(e)};i=()=>{for(const e of o)l(e,h);for(const e of n.rejectionEvents)l(e,d)};for(const e of o)u(e,h);for(const e of n.rejectionEvents)u(e,d);n.signal&&n.signal.addEventListener("abort",(()=>{d(n.signal.reason)}),{once:!0}),n.resolveImmediately&&r(c)}));if(s.cancel=i,"number"==typeof n.timeout){const e=function(e,t){const{milliseconds:n,fallback:i,message:s,customTimers:a={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let c;const u=new Promise(((u,l)=>{if("number"!=typeof n||1!==Math.sign(n))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(t.signal){const{signal:e}=t;e.aborted&&l(o(e)),e.addEventListener("abort",(()=>{l(o(e))}))}if(n===Number.POSITIVE_INFINITY)return void e.then(u,l);const h=new r;c=a.setTimeout.call(void 0,(()=>{if(i)try{u(i())}catch(e){l(e)}else"function"==typeof e.cancel&&e.cancel(),!1===s?u():s instanceof Error?l(s):(h.message=s??`Promise timed out after ${n} milliseconds`,l(h))}),n),(async()=>{try{u(await e)}catch(e){l(e)}})()})).finally((()=>{u.clear()}));return u.clear=()=>{a.clearTimeout.call(void 0,c),c=void 0},u}(s,{milliseconds:n.timeout});return e.cancel=i,e}return s}function u(e,t,n){"function"==typeof n&&(n={filter:n});const r=c(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}},95972:function(e,t,n){"use strict";n.d(t,{Z:function(){return B}});var r,i=n(78939),s=n(71198),o=n(57328),a=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class c{constructor(){r.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&a(this,r,"f")[this.size-1].priority>=t.priority)return void a(this,r,"f").push(n);const i=(0,o.Z)(a(this,r,"f"),n,((e,t)=>t.priority-e.priority));a(this,r,"f").splice(i,0,n)}dequeue(){const e=a(this,r,"f").shift();return null==e?void 0:e.run}filter(e){return a(this,r,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return a(this,r,"f").length}}r=new WeakMap;var u,l,h,d,f,p,y,g,m,w,b,E,v,_,S,R,A,I,T,C,P,k,N,x,D,L,O=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},U=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class M extends Error{}class B extends i{constructor(e){var t,n,r,i;if(super(),u.add(this),l.set(this,void 0),h.set(this,void 0),d.set(this,0),f.set(this,void 0),p.set(this,void 0),y.set(this,0),g.set(this,void 0),m.set(this,void 0),w.set(this,void 0),b.set(this,void 0),E.set(this,0),v.set(this,void 0),_.set(this,void 0),S.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:c,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);O(this,l,e.carryoverConcurrencyCount,"f"),O(this,h,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),O(this,f,e.intervalCap,"f"),O(this,p,e.interval,"f"),O(this,w,new e.queueClass,"f"),O(this,b,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,O(this,S,!0===e.throwOnTimeout,"f"),O(this,_,!1===e.autoStart,"f")}get concurrency(){return U(this,v,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);O(this,v,e,"f"),U(this,u,"m",x).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:U(this,S,"f"),...t},new Promise(((n,r)=>{U(this,w,"f").enqueue((async()=>{var i,o,a;O(this,E,(o=U(this,E,"f"),++o),"f"),O(this,d,(a=U(this,d,"f"),++a),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new M("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=(0,s.ZP)(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,U(this,u,"m",D).call(this,t.signal)]));const o=await r;n(o),this.emit("completed",o)}catch(e){if(e instanceof s.W5&&!t.throwOnTimeout)return void n();r(e),this.emit("error",e)}finally{U(this,u,"m",I).call(this)}}),t),this.emit("add"),U(this,u,"m",P).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return U(this,_,"f")?(O(this,_,!1,"f"),U(this,u,"m",x).call(this),this):this}pause(){O(this,_,!0,"f")}clear(){O(this,w,new(U(this,b,"f")),"f")}async onEmpty(){0!==U(this,w,"f").size&&await U(this,u,"m",L).call(this,"empty")}async onSizeLessThan(e){U(this,w,"f").size<e||await U(this,u,"m",L).call(this,"next",(()=>U(this,w,"f").size<e))}async onIdle(){0===U(this,E,"f")&&0===U(this,w,"f").size||await U(this,u,"m",L).call(this,"idle")}get size(){return U(this,w,"f").size}sizeBy(e){return U(this,w,"f").filter(e).length}get pending(){return U(this,E,"f")}get isPaused(){return U(this,_,"f")}}l=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,y=new WeakMap,g=new WeakMap,m=new WeakMap,w=new WeakMap,b=new WeakMap,E=new WeakMap,v=new WeakMap,_=new WeakMap,S=new WeakMap,u=new WeakSet,R=function(){return U(this,h,"f")||U(this,d,"f")<U(this,f,"f")},A=function(){return U(this,E,"f")<U(this,v,"f")},I=function(){var e;O(this,E,(e=U(this,E,"f"),--e),"f"),U(this,u,"m",P).call(this),this.emit("next")},T=function(){U(this,u,"m",N).call(this),U(this,u,"m",k).call(this),O(this,m,void 0,"f")},C=function(){const e=Date.now();if(void 0===U(this,g,"f")){const t=U(this,y,"f")-e;if(!(t<0))return void 0===U(this,m,"f")&&O(this,m,setTimeout((()=>{U(this,u,"m",T).call(this)}),t),"f"),!0;O(this,d,U(this,l,"f")?U(this,E,"f"):0,"f")}return!1},P=function(){if(0===U(this,w,"f").size)return U(this,g,"f")&&clearInterval(U(this,g,"f")),O(this,g,void 0,"f"),this.emit("empty"),0===U(this,E,"f")&&this.emit("idle"),!1;if(!U(this,_,"f")){const e=!U(this,u,"a",C);if(U(this,u,"a",R)&&U(this,u,"a",A)){const t=U(this,w,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&U(this,u,"m",k).call(this),!0)}}return!1},k=function(){U(this,h,"f")||void 0!==U(this,g,"f")||(O(this,g,setInterval((()=>{U(this,u,"m",N).call(this)}),U(this,p,"f")),"f"),O(this,y,Date.now()+U(this,p,"f"),"f"))},N=function(){0===U(this,d,"f")&&0===U(this,E,"f")&&U(this,g,"f")&&(clearInterval(U(this,g,"f")),O(this,g,void 0,"f")),O(this,d,U(this,l,"f")?U(this,E,"f"):0,"f"),U(this,u,"m",x).call(this)},x=function(){for(;U(this,u,"m",P).call(this););},D=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new M("The task was aborted."))}),{once:!0})}))},L=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))}},57328:function(e,t,n){"use strict";function r(e,t,n){let r=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let o=r+s;n(e[o],t)<=0?(r=++o,i-=s+1):i=s}return r}n.d(t,{Z:function(){return r}})},16615:function(e,t,n){"use strict";async function r(e){try{return{status:"fulfilled",value:await e,isFulfilled:!0,isRejected:!1}}catch(e){return{status:"rejected",reason:e,isFulfilled:!1,isRejected:!0}}}n.d(t,{Z:function(){return a}});class i{value;next;constructor(e){this.value=e}}class s{#y;#g;#m;constructor(){this.clear()}enqueue(e){const t=new i(e);this.#y?(this.#g.next=t,this.#g=t):(this.#y=t,this.#g=t),this.#m++}dequeue(){const e=this.#y;if(e)return this.#y=this.#y.next,this.#m--,e.value}clear(){this.#y=void 0,this.#g=void 0,this.#m=0}get size(){return this.#m}*[Symbol.iterator](){let e=this.#y;for(;e;)yield e.value,e=e.next}}function o(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new s;let n=0;const r=async(e,r,i)=>{n++;const s=(async()=>e(...i))();r(s);try{await s}catch{}n--,t.size>0&&t.dequeue()()},i=(i,...s)=>new Promise((o=>{((i,s,o)=>{t.enqueue(r.bind(void 0,i,s,o)),(async()=>{await Promise.resolve(),n<e&&t.size>0&&t.dequeue()()})()})(i,o,s)}));return Object.defineProperties(i,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),i}async function a(e,t={}){const{concurrency:n=Number.POSITIVE_INFINITY}=t,i=o(n);return Promise.all(e.map((e=>e&&"function"==typeof e.then?r(e):r("function"==typeof e?i((()=>e())):Promise.resolve(e)))))}},71198:function(e,t,n){"use strict";n.d(t,{W5:function(){return r},ZP:function(){return a}});class r extends Error{constructor(e){super(e),this.name="TimeoutError"}}class i extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const s=e=>void 0===globalThis.DOMException?new i(e):new DOMException(e),o=e=>{const t=void 0===e.reason?s("This operation was aborted."):e.reason;return t instanceof Error?t:s(t)};function a(e,t,n,i){let s;const a=new Promise(((a,c)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((i={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...i}).signal){const{signal:e}=i;e.aborted&&c(o(e)),e.addEventListener("abort",(()=>{c(o(e))}))}s=i.customTimers.setTimeout.call(void 0,(()=>{if("function"==typeof n){try{a(n())}catch(e){c(e)}return}const i=n instanceof Error?n:new r("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),c(i)}),t),(async()=>{try{a(await e)}catch(e){c(e)}finally{i.customTimers.clearTimeout.call(void 0,s)}})()}else a(e)}));return a.clear=()=>{clearTimeout(s),s=void 0},a}},32807:function(e,t,n){"use strict";n.d(t,{d:function(){return r}});class r extends Error{constructor(){super("End-Of-Stream")}}},53749:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(28951),i=n(3287),s=n(49736),o=n(56512);const{isValid:a,parse:c}=o,u=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new r.Netmask(e)));function l(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}var h=e=>{if(a(e)){const t=c(e);if("ipv4"===t.kind())return function(e){for(let t of u)if(t.contains(e))return!0;return!1}(t.toNormalizedString());if("ipv6"===t.kind())return l(e)}else if((0,s.h6)(e)&&i.Z.v6().test(e))return l(e)}},43905:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});class r extends Event{constructor(e,t){super(e),this.detail=t}}},34243:function(e,t,n){"use strict";n.d(t,{VFc:function(){return ie},vMG:function(){return se},UID:function(){return k},zGw:function(){return J},vgT:function(){return L},Zpf:function(){return oe.Z},_Qy:function(){return ce.Z}});var r=n(83707),i=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function s(e,t,n){return function(){if(0===arguments.length)return n();var r=arguments[arguments.length-1];if(!i(r)){for(var s=0;s<e.length;){if("function"==typeof r[e[s]])return r[e[s]].apply(r,Array.prototype.slice.call(arguments,0,-1));s+=1}if(function(e){return null!=e&&"function"==typeof e["@@transducer/step"]}(r))return t.apply(null,Array.prototype.slice.call(arguments,0,-1))(r)}return n.apply(this,arguments)}}function o(e){return e&&e["@@transducer/reduced"]?e:{"@@transducer/value":e,"@@transducer/reduced":!0}}var a=function(){return this.xf["@@transducer/init"]()},c=function(e){return this.xf["@@transducer/result"](e)};var u=n(94443);var l=n(49797);"function"==typeof Object.is&&Object.is;var h=Object.prototype.toString,d=function(){return"[object Arguments]"===h.call(arguments)?function(e){return"[object Arguments]"===h.call(e)}:function(e){return(0,l.Z)("callee",e)}}(),f=d,p=!{toString:null}.propertyIsEnumerable("toString"),y=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],g=function(){return arguments.propertyIsEnumerable("length")}(),m=function(e,t){for(var n=0;n<e.length;){if(e[n]===t)return!0;n+=1}return!1},w="function"!=typeof Object.keys||g?(0,u.Z)((function(e){if(Object(e)!==e)return[];var t,n,r=[],i=g&&f(e);for(t in e)!(0,l.Z)(t,e)||i&&"length"===t||(r[r.length]=t);if(p)for(n=y.length-1;n>=0;)t=y[n],(0,l.Z)(t,e)&&!m(r,t)&&(r[r.length]=t),n-=1;return r})):(0,u.Z)((function(e){return Object(e)!==e?[]:Object.keys(e)})),b=(0,u.Z)((function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)}));function E(e,t){for(var n=0,r=t.length,i=Array(r);n<r;)i[n]=e(t[n]),n+=1;return i}var v=function(e){return(e<10?"0":"")+e};Date.prototype.toISOString;function _(e,t,n){for(var r=0,i=n.length;r<i;)t=e(t,n[r]),r+=1;return t}var S=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=a,e.prototype["@@transducer/result"]=c,e.prototype["@@transducer/step"]=function(e,t){return this.xf["@@transducer/step"](e,this.f(t))},e}(),R=function(e){return function(t){return new S(e,t)}};function A(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,n){return t.apply(this,arguments)};case 3:return function(e,n,r){return t.apply(this,arguments)};case 4:return function(e,n,r,i){return t.apply(this,arguments)};case 5:return function(e,n,r,i,s){return t.apply(this,arguments)};case 6:return function(e,n,r,i,s,o){return t.apply(this,arguments)};case 7:return function(e,n,r,i,s,o,a){return t.apply(this,arguments)};case 8:return function(e,n,r,i,s,o,a,c){return t.apply(this,arguments)};case 9:return function(e,n,r,i,s,o,a,c,u){return t.apply(this,arguments)};case 10:return function(e,n,r,i,s,o,a,c,u,l){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}var I=n(72588);function T(e,t,n){return function(){for(var r=[],i=0,s=e,o=0;o<t.length||i<arguments.length;){var a;o<t.length&&(!(0,I.Z)(t[o])||i>=arguments.length)?a=t[o]:(a=arguments[i],i+=1),r[o]=a,(0,I.Z)(a)||(s-=1),o+=1}return s<=0?n.apply(this,r):A(s,T(e,r,n))}}var C=(0,r.Z)((function(e,t){return 1===e?(0,u.Z)(t):A(e,T(e,[],t))})),P=(0,r.Z)(s(["fantasy-land/map","map"],R,(function(e,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return C(t.length,(function(){return e.call(this,t.apply(this,arguments))}));case"[object Object]":return _((function(n,r){return n[r]=e(t[r]),n}),{},w(t));default:return E(e,t)}}))),k=P,N=Number.isInteger||function(e){return e<<0===e};function x(e){return"[object String]"===Object.prototype.toString.call(e)}var D=(0,r.Z)((function(e,t){var n=e<0?t.length+e:e;return x(t)?t.charAt(n):t[n]})),L=(0,r.Z)((function(e,t){if(null!=t)return N(e)?D(e,t):t[e]})),O=n(1709),U=(0,u.Z)((function(e){return!!i(e)||!!e&&("object"==typeof e&&(!x(e)&&(0===e.length||e.length>0&&(e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)))))})),M="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function B(e,t,n){return function(r,i,s){if(U(s))return e(r,i,s);if(null==s)return i;if("function"==typeof s["fantasy-land/reduce"])return t(r,i,s,"fantasy-land/reduce");if(null!=s[M])return n(r,i,s[M]());if("function"==typeof s.next)return n(r,i,s);if("function"==typeof s.reduce)return t(r,i,s,"reduce");throw new TypeError("reduce: list must be array or iterable")}}function z(e,t,n){for(var r=0,i=n.length;r<i;){if((t=e["@@transducer/step"](t,n[r]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return e["@@transducer/result"](t)}var V=(0,r.Z)((function(e,t){return A(e.length,(function(){return e.apply(t,arguments)}))})),$=V;function F(e,t,n){for(var r=n.next();!r.done;){if((t=e["@@transducer/step"](t,r.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=n.next()}return e["@@transducer/result"](t)}function j(e,t,n,r){return e["@@transducer/result"](n[r]($(e["@@transducer/step"],e),t))}var K=B(z,j,F),q=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},e}();function H(e){return new q(e)}var G=(0,O.Z)((function(e,t,n){return K("function"==typeof e?H(e):e,t,n)}));function Z(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function W(e,t){return function(){var n=arguments.length;if(0===n)return t();var r=arguments[n-1];return i(r)||"function"!=typeof r[e]?t.apply(this,arguments):r[e].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var Q=(0,O.Z)(W("slice",(function(e,t,n){return Array.prototype.slice.call(n,e,t)}))),Y=(0,u.Z)(W("tail",Q(1,1/0)));function J(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return A(arguments[0].length,G(Z,arguments[0],Y(arguments)))}function X(e,t,n){if(n||(n=new ee),function(e){var t=typeof e;return null==e||"object"!=t&&"function"!=t}(e))return e;var r,i=function(r){var i=n.get(e);if(i)return i;for(var s in n.set(e,r),e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=t?X(e[s],!0,n):e[s]);return r};switch(b(e)){case"Object":return i(Object.create(Object.getPrototypeOf(e)));case"Array":return i([]);case"Date":return new Date(e.valueOf());case"RegExp":return r=e,new RegExp(r.source,r.flags?r.flags:(r.global?"g":"")+(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.sticky?"y":"")+(r.unicode?"u":"")+(r.dotAll?"s":""));case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return e.slice();default:return e}}var ee=function(){function e(){this.map={},this.length=0}return e.prototype.set=function(e,t){const n=this.hash(e);let r=this.map[n];r||(this.map[n]=r=[]),r.push([e,t]),this.length+=1},e.prototype.hash=function(e){let t=[];for(var n in e)t.push(Object.prototype.toString.call(e[n]));return t.join()},e.prototype.get=function(e){if(this.length<=180){for(const t in this.map){const n=this.map[t];for(let t=0;t<n.length;t+=1){const r=n[t];if(r[0]===e)return r[1]}}return}const t=this.hash(e),n=this.map[t];if(n)for(let t=0;t<n.length;t+=1){const r=n[t];if(r[0]===e)return r[1]}},e}(),te=function(){function e(e,t,n,r){this.valueFn=e,this.valueAcc=t,this.keyFn=n,this.xf=r,this.inputs={}}return e.prototype["@@transducer/init"]=a,e.prototype["@@transducer/result"]=function(e){var t;for(t in this.inputs)if((0,l.Z)(t,this.inputs)&&(e=this.xf["@@transducer/step"](e,this.inputs[t]))["@@transducer/reduced"]){e=e["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var n=this.keyFn(t);return this.inputs[n]=this.inputs[n]||[n,X(this.valueAcc,!1)],this.inputs[n][1]=this.valueFn(this.inputs[n][1],t),e},e}();function ne(e,t,n){return function(r){return new te(e,t,n,r)}}var re=T(4,[],s([],ne,(function(e,t,n,r){var i=H((function(r,i){var s=n(i),a=e((0,l.Z)(s,r)?r[s]:X(t,!1),i);return a&&a["@@transducer/reduced"]?o(r):(r[s]=a,r)}));return K(i,{},r)}))),ie=re((function(e,t){return e+1}),0);var se=(0,r.Z)(W("groupBy",re((function(e,t){return e.push(t),e}),[])));"function"==typeof Object.assign&&Object.assign;var oe=n(10148),ae="\t\n\v\f\r \u2028\u2029\ufeff";String.prototype.trim;var ce=n(34801)},94443:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(72588);function i(e){return function t(n){return 0===arguments.length||(0,r.Z)(n)?t:e.apply(this,arguments)}}},83707:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(94443),i=n(72588);function s(e){return function t(n,s){switch(arguments.length){case 0:return t;case 1:return(0,i.Z)(n)?t:(0,r.Z)((function(t){return e(n,t)}));default:return(0,i.Z)(n)&&(0,i.Z)(s)?t:(0,i.Z)(n)?(0,r.Z)((function(t){return e(t,s)})):(0,i.Z)(s)?(0,r.Z)((function(t){return e(n,t)})):e(n,s)}}}},1709:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(94443),i=n(83707),s=n(72588);function o(e){return function t(n,o,a){switch(arguments.length){case 0:return t;case 1:return(0,s.Z)(n)?t:(0,i.Z)((function(t,r){return e(n,t,r)}));case 2:return(0,s.Z)(n)&&(0,s.Z)(o)?t:(0,s.Z)(n)?(0,i.Z)((function(t,n){return e(t,o,n)})):(0,s.Z)(o)?(0,i.Z)((function(t,r){return e(n,t,r)})):(0,r.Z)((function(t){return e(n,o,t)}));default:return(0,s.Z)(n)&&(0,s.Z)(o)&&(0,s.Z)(a)?t:(0,s.Z)(n)&&(0,s.Z)(o)?(0,i.Z)((function(t,n){return e(t,n,a)})):(0,s.Z)(n)&&(0,s.Z)(a)?(0,i.Z)((function(t,n){return e(t,o,n)})):(0,s.Z)(o)&&(0,s.Z)(a)?(0,i.Z)((function(t,r){return e(n,t,r)})):(0,s.Z)(n)?(0,r.Z)((function(t){return e(t,o,a)})):(0,s.Z)(o)?(0,r.Z)((function(t){return e(n,t,a)})):(0,s.Z)(a)?(0,r.Z)((function(t){return e(n,o,t)})):e(n,o,a)}}}},49797:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(t,e)}n.d(t,{Z:function(){return r}})},72588:function(e,t,n){"use strict";function r(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}n.d(t,{Z:function(){return r}})},10148:function(e,t,n){"use strict";var r=n(94443),i=n(49797),s=(0,r.Z)((function(e){var t=[];for(var n in e)(0,i.Z)(n,e)&&(t[t.length]=[n,e[n]]);return t}));t.Z=s},34801:function(e,t,n){"use strict";var r=(0,n(83707).Z)((function(e,t){for(var n=0,r=Math.min(e.length,t.length),i={};n<r;)i[e[n]]=t[n],n+=1;return i}));t.Z=r},62794:function(e,t,n){"use strict";function r(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function i(e,t={}){if(!r(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");const{deep:n,compare:i}=t,s=[],o=[],a=e=>{const t=s.indexOf(e);if(-1!==t)return o[t];const n=[];return s.push(e),o.push(n),n.push(...e.map((e=>Array.isArray(e)?a(e):r(e)?c(e):e))),n},c=e=>{const t=s.indexOf(e);if(-1!==t)return o[t];const u={},l=Object.keys(e).sort(i);s.push(e),o.push(u);for(const t of l){const i=e[t];let s;s=n&&Array.isArray(i)?a(i):n&&r(i)?c(i):i,Object.defineProperty(u,t,{...Object.getOwnPropertyDescriptor(e,t),value:s})}return u};return Array.isArray(e)?n?a(e):e.slice():c(e)}n.d(t,{Z:function(){return i}})},94391:function(e,t,n){"use strict";n.d(t,{dL:function(){return r.d},FY:function(){return a}});var r=n(32807),i=n(48764);class s{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const n=i.Buffer.alloc(e.len);if(await this.readBuffer(n,{position:t})<e.len)throw new r.d;return e.get(n,0)}async peekToken(e,t=this.position){const n=i.Buffer.alloc(e.len);if(await this.peekBuffer(n,{position:t})<e.len)throw new r.d;return e.get(n,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new r.d;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new r.d;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}class o extends s{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const n=await this.peekBuffer(e,t);return this.position+=n,n}async peekBuffer(e,t){const n=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-n.position,n.length);if(!n.mayBeLess&&i<n.length)throw new r.d;return e.set(this.uint8Array.subarray(n.position,n.position+i),n.offset),i}async close(){}}function a(e,t){return new o(e,t)}},33606:function(e,t,n){"use strict";n.d(t,{US:function(){return a},ZW:function(){return l},fB:function(){return s},jj:function(){return u},p:function(){return o},uW:function(){return d},xW:function(){return c},zR:function(){return h}});n(80645);var r=n(48764);function i(e){return new DataView(e.buffer,e.byteOffset)}const s={len:1,get:(e,t)=>i(e).getUint8(t),put:(e,t,n)=>(i(e).setUint8(t,n),t+1)},o={len:2,get:(e,t)=>i(e).getUint16(t,!0),put:(e,t,n)=>(i(e).setUint16(t,n,!0),t+2)},a={len:2,get:(e,t)=>i(e).getUint16(t),put:(e,t,n)=>(i(e).setUint16(t,n),t+2)},c={len:4,get:(e,t)=>i(e).getUint32(t,!0),put:(e,t,n)=>(i(e).setUint32(t,n,!0),t+4)},u={len:4,get:(e,t)=>i(e).getUint32(t),put:(e,t,n)=>(i(e).setUint32(t,n),t+4)},l={len:4,get:(e,t)=>i(e).getInt32(t),put:(e,t,n)=>(i(e).setInt32(t,n),t+4)},h={len:8,get:(e,t)=>i(e).getBigUint64(t,!0),put:(e,t,n)=>(i(e).setBigUint64(t,n,!0),t+8)};class d{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return r.Buffer.from(e).toString(this.encoding,t,t+this.len)}}class f{constructor(e){this.len=e}static decode(e,t,n){let r="";for(let i=t;i<n;++i)r+=f.codePointToString(f.singleByteDecoder(e[i]));return r}static inRange(e,t,n){return t<=e&&e<=n}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(f.inRange(e,0,127))return e;const t=f.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return f.decode(e,t,t+this.len)}}f.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},62308:function(e,t,n){"use strict";n.d(t,{H:function(){return u},Z:function(){return c}});var r=n(41690),i=n(73062),s=n(66574);const o=Symbol.for("@achingbrain/uint8arraylist");function a(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let n=0;for(const r of e){const e=n+r.byteLength;if(t<e)return{buf:r,index:t-n};n=e}throw new RangeError("index is out of bounds")}function c(e){return Boolean(e?.[o])}class u{constructor(...e){Object.defineProperty(this,o,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!c(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!c(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=a(this.bufs,e);return t.buf[t.index]}set(e,t){const n=a(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!c(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:n,length:i}=this._subList(e,t);return(0,r.z)(n,i)}subarray(e,t){const{bufs:n,length:i}=this._subList(e,t);return 1===n.length?n[0]:(0,r.z)(n,i)}sublist(e,t){const{bufs:n,length:r}=this._subList(e,t),i=new u;return i.length=r,i.bufs=n,i}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const n=[];let r=0;for(let i=0;i<this.bufs.length;i++){const s=this.bufs[i],o=r,a=o+s.byteLength;if(r=a,e>=a)continue;const c=e>=o&&e<a,u=t>o&&t<=a;if(c&&u){if(e===o&&t===a){n.push(s);break}const r=e-o;n.push(s.subarray(r,r+(t-e)));break}if(c){if(0===e){n.push(s);continue}n.push(s.subarray(e-o))}else{if(u){if(t===a){n.push(s);break}n.push(s.subarray(0,t-o));break}n.push(s)}}return{bufs:n,length:t-e}}indexOf(e,t=0){if(!(c(e)||e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const n=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const r=n.byteLength;if(0===r)throw new TypeError("search must be at least 1 byte long");const i=new Int32Array(256);for(let e=0;e<256;e++)i[e]=-1;for(let e=0;e<r;e++)i[n[e]]=e;const s=i,o=this.byteLength-n.byteLength,a=n.byteLength-1;let u;for(let e=t;e<=o;e+=u){u=0;for(let t=a;t>=0;t--){const r=this.get(e+t);if(n[t]!==r){u=Math.max(1,t-s[r]);break}}if(0===u)return e}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const n=(0,s.E)(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){const r=(0,s.u)(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt16(0,t,n),this.write(r,e)}getInt32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){const r=(0,s.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt32(0,t,n),this.write(r,e)}getBigInt64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){const r=(0,s.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigInt64(0,t,n),this.write(r,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const n=(0,s.E)(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){const r=(0,s.u)(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,t,n),this.write(r,e)}getUint32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){const r=(0,s.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,t,n),this.write(r,e)}getBigUint64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){const r=(0,s.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigUint64(0,t,n),this.write(r,e)}getFloat32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){const r=(0,s.u)(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat32(0,t,n),this.write(r,e)}getFloat64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){const r=(0,s.u)(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat64(0,t,n),this.write(r,e)}equals(e){if(null==e)return!1;if(!(e instanceof u))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!(0,i.f)(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new u;return n.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),n.length=t,n}}},20295:function(e,t,n){"use strict";function r(e,t){for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}n.d(t,{q:function(){return r}})},738:function(e,t,n){"use strict";n.d(t,{BB:function(){return s.B},fS:function(){return r.f},mL:function(){return i.m}});var r=n(73062),i=n(77408),s=n(49784)},13353:function(e,t,n){"use strict";var r=n(93387),i=n(66574);function s(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const o=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=s("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,i.E)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),c={utf8:o,"utf-8":o,hex:r.gh.base16,latin1:a,ascii:a,binary:a,...r.gh};t.Z=c},10460:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(66574),i=n(93304);function s(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=(0,r.E)(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return(0,i.P)(n)}},14560:function(e,t,n){"use strict";n.d(t,{$l:function(){return a},UG:function(){return u},b$:function(){return h},iP:function(){return c},jU:function(){return o},n2:function(){return l}});var r=n(59134);const i="object"==typeof window&&"object"==typeof document&&9===document.nodeType,s=r(),o=i&&!s,a=s&&!i,c=s&&i,u=void 0!==globalThis.process&&void 0!==globalThis.process.release&&"node"===globalThis.process.release.name&&!s,l="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,h=(void 0!==globalThis.process&&void 0!==globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!=typeof navigator&&"ReactNative"===navigator.product)}}]);
//# sourceMappingURL=972.934bcf22.chunk.js.map