!function(){var t,e,s,n,r={67937:function(t,e,s){"use strict";s.d(e,{$G:function(){return o},F$:function(){return u},Gt:function(){return m},TB:function(){return d},ex:function(){return h},j9:function(){return i},jP:function(){return l},sF:function(){return c}});var n=s(85607),r=s(59457);const a=n.p.BOSTROM,i=r.Z[a].LCD_URL,o=r.Z[a].RPC_URL,c=r.Z[a].WEBSOCKET_URL,u=r.Z[a].INDEX_HTTPS,d=r.Z[a].INDEX_WEBSOCKET,l=r.Z[a].BECH32_PREFIX,p=`${l}val`,m=`${p}oper`,h=(r.Z[a].BASE_DENOM,r.Z[a].DENOM_LIQUID,2e5),{MEMO_KEPLR:g}=r.Z[a]},59457:function(t,e,s){"use strict";var n=s(85607),r=s(34155);const a={bostrom:{CHAIN_ID:n.p.BOSTROM,BASE_DENOM:"boot",DENOM_LIQUID:"hydrogen",RPC_URL:r.env.IS_DEV?"https://rpc.arch.bostrom.cybernode.ai:443":"https://rpc.bostrom.cybernode.ai",LCD_URL:r.env.IS_DEV?"https://lcd.arch.bostrom.cybernode.ai:443":"https://lcd.bostrom.cybernode.ai",WEBSOCKET_URL:r.env.IS_DEV?"wss://rpc.arch.bostrom.cybernode.ai:443/websocket":"wss://rpc.bostrom.cybernode.ai/websocket",INDEX_HTTPS:"https://index.bostrom.cybernode.ai/v1/graphql",INDEX_WEBSOCKET:"wss://index.bostrom.cybernode.ai/v1/graphql",BECH32_PREFIX:"bostrom",MEMO_KEPLR:"[bostrom] cyb.ai, using keplr"},"space-pussy":{CHAIN_ID:n.p.SPACE_PUSSY,BASE_DENOM:"pussy",DENOM_LIQUID:"liquidpussy",RPC_URL:"https://rpc.space-pussy.cybernode.ai/",LCD_URL:"https://lcd.space-pussy.cybernode.ai",WEBSOCKET_URL:"wss://rpc.space-pussy.cybernode.ai/websocket",INDEX_HTTPS:"https://index.space-pussy.cybernode.ai/v1/graphql",INDEX_WEBSOCKET:"wss://index.space-pussy.cybernode.ai/v1/graphql",BECH32_PREFIX:"pussy",MEMO_KEPLR:"[space-pussy] cyb.ai, using keplr"}};e.Z=a},66392:function(t,e,s){"use strict";s.d(e,{$T:function(){return r},T6:function(){return i},_2:function(){return o},fo:function(){return a}});var n=s(67937);const r=new RegExp(`^${n.jP}[a-zA-Z0-9]{39}$`,"g"),a=/^Qm[a-zA-Z0-9]{44}$/g,i=(new RegExp(`^${n.jP}[a-zA-Z0-9]{59}$`,"g"),new RegExp(`^${n.Gt}valoper[a-zA-Z0-9]{39}$`,"g"),/^cosmos[a-zA-Z0-9]{39}$/g),o=/^https:\/\/|^http:\/\//g},6998:function(t,e,s){"use strict";s.d(e,{c:function(){return n}});var n=(t=>(t.to="to",t.from="from",t.all="all",t))(n||{})},82455:function(t,e,s){"use strict";s.d(e,{FT:function(){return i}});s(67294),s(85208);var n=s(25108);const r="bostrom1xut80d09q0tgtch8p0z4k5f88d3uvt8cvtzm5h3tu3tsy4jk9xlsfzhxel",a=async(t,e)=>{try{return await t.queryContractSmart(r,e)}catch(t){return n.log("error",t),null}},i=async(t,e)=>{try{const s={passport_by_nickname:{nickname:e}};return await a(t,s)}catch(t){return n.log("error",t),null}}},85208:function(t,e,s){"use strict";s(85893);var n=s(67294);s(6970),s(67937),s(25108);n.createContext(void 0)},69898:function(t,e,s){"use strict";var n=s(99870),r=s(89546),a=s(91026),i=s(38161);const o=t=>i.k0.parse(t),c=t=>`/ipfs/${t}`;const u="QmUgmRxoLtGERot7Y6G7UyF6fwvnusQZfGR15PuE6pY3aB",d=`/dns4/swarm.io.cybernode.ai/tcp/443/wss/p2p/${u}`,l=`/ip4/88.99.105.146/tcp/4001/p2p/${u}`,p="https://gateway.ipfs.cybernode.ai";var m=s(25108);var h=class{constructor(){this.nodeType="external",this._config={},this._isStarted=!1}get config(){return this._config}get isStarted(){return this._isStarted}async initConfig(){const t=await this.node.config.get("Addresses.Gateway");if(!t)return{gatewayUrl:p};const e=(0,a.HM)(t).nodeAddress();return{gatewayUrl:`http://${e.address}:${e.port}`}}async init(t){this.node=(0,r.Ue)(t),this._config=await this.initConfig(),"undefined"!=typeof window&&(window.node=this.node,window.toCid=o),m.log("IPFS - Kubo addrs",(await this.node.swarm.localAddrs()).map((t=>t.toString()))),this._isStarted=!0}async stat(t,e={}){return this.node.files.stat(c(t),{...e,withLocal:!0,size:!0}).then((t=>{const{type:e,size:s,sizeLocal:n,local:r,blocks:a}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:a}}))}cat(t,e={}){return this.node.cat(o(t),e)}async add(t,e={}){return(await this.node.add(t,e)).cid.toString()}async pin(t,e={}){return(await this.node.pin.add(o(t),e)).toString()}async getPeers(){return(await this.node.swarm.peers()).map((t=>t.peer.toString()))}async stop(){}async start(){}async connectPeer(t){const e=(0,a.HM)(t);return await this.node.bootstrap.add(e),await this.node.swarm.connect(e),!0}ls(){return this.node.pin.ls()}async info(){const{repoSize:t}=await this.node.stats.repo(),e=await this.node.id(),{agentVersion:s,id:n}=e;return{id:n.toString(),agentVersion:s,repoSize:t}}},g=s(21771),y=s(33634),f=s(55472),b=s(63718),w=s(99644),v=s(79071),S=s(69850),$=s(53184),x=s(44913),C=s(46177),_=s(57392),A=s(15624),E=s(35092),T=s(25108);const P={cidVersion:0,rawLeaves:!1};var k=class{constructor(){this.nodeType="helia",this._isStarted=!1}get config(){return{gatewayUrl:p}}get isStarted(){return this._isStarted}async init(){const t=new y.Y("helia-bs");await t.open();const e=new f.s("helia-ds");await e.open();const s=await(async(t,e=[])=>await(0,b.N)({datastore:t,transports:[(0,_.E)(),(0,A.d)(),(0,C.Z)({rtcConfiguration:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478","STUN:freestun.net:3479","STUN:stun.bernardoprovenzano.net:3478","STUN:stun.aa.net.uk:3478"]},{credential:"free",username:"free",urls:["TURN:freestun.net:3479","TURNS:freestun.net:5350"]}]}}),(0,C.R)(),(0,S.f)({discoverRelays:1})],connectionEncryption:[(0,w.t)()],streamMuxers:[(0,v.P)()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[(0,x.U)({list:e})],services:{identify:(0,E.HA)()}}))(e,["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/swarm.io.cybernode.ai/tcp/443/wss/p2p/QmUgmRxoLtGERot7Y6G7UyF6fwvnusQZfGR15PuE6pY3aB"]);this.node=await(0,g.F)({blockstore:t,datastore:e,libp2p:s}),this.fs=(0,$.Y4)(this.node),"undefined"!=typeof window&&(window.libp2p=s,window.node=this.node,window.fs=this.fs,window.toCid=o),s.addEventListener("peer:connect",(t=>{const e=t.detail.toString(),n=s.getConnections(e)||[],r=Object.fromEntries(n.map((t=>[t.remoteAddr.toString(),t.remoteAddr.protoCodes().map((t=>(0,a.a_)(t)?.name))])));T.debug(`Connected to ${e}`,r)})),s.addEventListener("peer:disconnect",(t=>{T.debug(`Disconnected from ${t.detail.toString()}`)})),T.log("IPFS - Helia addrs",s.getMultiaddrs().map((t=>t.toString()))),this._isStarted=!0}async stat(t,e={}){return this.fs.stat(o(t),e).then((t=>{const{type:e,fileSize:s,localFileSize:n,blocks:r,dagSize:a,mtime:i}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:r}}))}cat(t,e={}){return this.fs.cat(o(t),e)}async add(t,e={}){const s={...e,...P};let n;if(t instanceof File){const e=t.name,r=await t.arrayBuffer(),a=new Uint8Array(r);n=await this.fs.addFile({path:e,content:a},s)}else{const e=(new TextEncoder).encode(t);n=await this.fs.addBytes(e,s)}return this.pin(n.toString(),e),n.toString()}async pin(t,e={}){const s=o(t);if(!await(this.node?.pins.isPinned(s,e))){(await(this.node?.pins.add(s,e)))?.cid.toString()}}async getPeers(){return this.node.libp2p.getConnections().map((t=>t.remotePeer.toString()))}async stop(){await(this.node?.stop())}async start(){await(this.node?.start())}async connectPeer(t){await this.node.libp2p.dial((0,a.HM)(t));return!0}ls(){const t=async function*(t){for await(const e of t){const{cid:t,metadata:s}=e;yield{cid:t.toV0(),metadata:s,type:"recursive"}}}(this.node.pins.ls());return t}async info(){return{id:this.node.libp2p.peerId.toString(),agentVersion:this.node.libp2p.services.identify.host.agentVersion,repoSize:-1}}},I=s(27864),M=s(38134);var R=()=>({start:!0,repo:"ipfs-repo-cyber-v2",relay:{enabled:!1,hop:{enabled:!1}},preload:{enabled:!1},config:{API:{HTTPHeaders:{"Access-Control-Allow-Methods":["PUT","POST"],"Access-Control-Allow-Origin":["http://localhost:3000","http://127.0.0.1:5001","http://127.0.0.1:8888","http://localhost:8888"]}},Addresses:{Gateway:"/ip4/127.0.0.1/tcp/8080",Swarm:[],Delegates:[]},Discovery:{MDNS:{Enabled:!0,Interval:10},webRTCStar:{Enabled:!1}},Bootstrap:[],Pubsub:{Enabled:!1},Swarm:{ConnMgr:{HighWater:300,LowWater:50},DisableNatPortMap:!1},Routing:{Type:"dhtclient"}},libp2p:{transports:[(0,_.E)({filter:M.FR})],nat:{enabled:!1}},EXPERIMENTAL:{ipnsPubsub:!1}});var O=class{constructor(){this.nodeType="embedded",this._isStarted=!1}get config(){return{gatewayUrl:p}}get isStarted(){return this._isStarted}async init(){this.node=await(0,I.Ue)(R()),"undefined"!=typeof window&&(window.node=this.node,window.toCid=o),this._isStarted=!0}async stat(t,e={}){return this.node.files.stat(c(t),{...e,withLocal:!0,size:!0}).then((t=>{const{type:e,size:s,sizeLocal:n,local:r,blocks:a}=t;return{type:e,size:s||-1,sizeLocal:n||-1,blocks:a}}))}cat(t,e={}){return this.node.cat(o(t),e)}async add(t,e={}){return(await this.node.add(t,e)).cid.toString()}async pin(t,e={}){return(await this.node.pin.add(o(t),e)).toString()}async getPeers(){return(await this.node.swarm.peers()).map((t=>t.peer.toString()))}async stop(){}async start(){}async connectPeer(t){const e=(0,a.HM)(t);return await this.node.bootstrap.add(e),await this.node.swarm.connect(e),!0}ls(){return this.node.pin.ls()}async info(){const t=await this.node.stats.repo(),e=Number(t.repoSize),s=await this.node.id(),{agentVersion:n,id:r}=s;return{id:r.toString(),agentVersion:n,repoSize:e}}},q=s(49784),U=s(41487),D=s.n(U),z=s(66392),B=s(50145),L=s(41690),N=s(25108);const j=async t=>{if(!t)return"unknown";const e=await(0,B.pM)(t);return e?.mime||"text/plain"};function F(t,e=300){return t.length>e?`${t.slice(0,e)}...`:t}const H=/\\u\{[a-fA-F0-9]+\}/g;var Z=s(23085).lW;function Q(t,e){const s=new Blob([t],{type:e});return URL.createObjectURL(s)}function W(t,e){return`data:${e};base64,${(0,q.B)(t,"base64")}`}const G=t=>{if(t){if(t.includes("video"))return"video";if(t.includes("audio"))return"audio"}},V=/\s?<!doctype html>|(<html\b[^>]*>|<body\b[^>]*>|<x-[^>]+>)+/i;const X=t=>{if(!t)return"other";const e=G(t);return e||(-1!==t.indexOf("text/plain")||-1!==t.indexOf("application/xml")?"text":-1!==t.indexOf("image")?"image":-1!==t.indexOf("application/pdf")?"pdf":"other")},K=async(t,e,s)=>{if(!t||!t?.result)return{gateway:!0,text:e.toString(),cid:e};const{result:n,meta:r}=t,{mime:a,contentType:i}=r;if(!a)return{cid:e,gateway:!0,text:`Can't detect MIME for ${e.toString()}`};const o={link:`/ipfs/${e}`,gateway:!1,cid:t.cid,type:i};if(G(a))return{...o,gateway:!0};const c="string"!=typeof n?await(async(t,e)=>{let s=0;try{if(t instanceof Uint8Array)return e&&e(t.byteLength),t;const n=[];if(t instanceof ReadableStream){const r=t.getReader(),a=async({done:t,value:i})=>t?(0,L.z)(n):(n.push(i),s+=i.byteLength,e&&e(s),r.read().then(a));return await r.read().then(a)}if(Symbol.asyncIterator in t){const r=t[Symbol.asyncIterator]();for await(const t of r)t instanceof Uint8Array&&(n.push(t),s+=t.byteLength,e&&e(s));return(0,L.z)(n)}return}catch(t){return void N.error("Error reading stream/iterable.\r\n Probably Hot reload error!",t)}})(n,s):n,u="string"==typeof c;if(!c)return{...o,gateway:!0,text:`Can't parse content for ${e.toString()}`};if("text"===o.type){if(!u&&D()(Z.from(c)))return{...o,type:"image",content:W(c,"image/svg+xml")};const t=u?c:(0,q.B)(c);return t.match(z.fo)?{...o,type:"cid",content:t}:t.match(z._2)?{...o,type:"link",content:t}:function(t){const e=t.trim().slice(0,1e3);return V.test(e)}(t)?{...o,type:"html",gateway:!0,content:e.toString()}:{...o,link:t.length>42?`/ipfs/${e}`:`/search/${t}`,type:"text",text:F(t),content:t}}if(!u){if("image"===o.type)return{...o,content:W(c,a)};if("pdf"===o.type)return{...o,content:Q(c,a),gateway:!0}}return o},Y=(t,e,s=150)=>{if(t)return"string"==typeof t?t.slice(0,s):e&&"text"===e?(0,q.B)(t).slice(0,s):void 0};const J=new(s(39387).ZP)("cyber-page-cash");J.version(3).stores({cid:"cid",following:"cid"});var tt=J;var et={add:async(t,e)=>{if(!await tt.table("cid").get({cid:t})){const s={cid:t,data:e};tt.table("cid").add(s)}},get:async t=>{const e=await tt.table("cid").get({cid:t});return e?.data||e?.content}},st=s(86107);var nt=(()=>{const t=new st.vu("https://io.cybernode.ai");return{add:async e=>{const s="string"==typeof e?new File([e],"file.txt"):e;return t.add(s,{cidVersion:0,rawLeaves:!1})},status:async e=>t.status(e)}})(),rt=s(25108);const at=async t=>{const e=await et.get(t);if(e&&e.length){const s=await j(e),n=X(s),r=Y(e,n);return{result:e,cid:t,meta:{type:"file",size:e.length,sizeLocal:e.length,mime:s,contentType:n},source:"db",textPreview:r}}},it={type:"file",size:void 0,sizeLocal:void 0,blocks:void 0},ot=async(t,e,s)=>{if(e){return await e.stat(t,{signal:s})}return it},ct=async(t,e,s)=>{const n=s||new AbortController,{signal:r}=n;let a;if(e){s||(a=setTimeout((()=>{n.abort()}),6e4));try{const s=Date.now(),n=await ot(t,e,r),i=n,o=Date.now();i.statsTime=o-s;const c=!!n.size&&n.size<2e7;if(a&&clearTimeout(a),"directory"===n.type)return{cid:t,availableDownload:!0,source:"node",meta:n};{const{value:s}=await e.cat(t,{signal:r,length:2048,offset:0})[Symbol.asyncIterator]().next();i.mime=await j(s),i.contentType=X(i.mime);const a=n.size&&n.size>-1&&s.length>=n.size,u=Y(s,i.contentType);a&&await et.add(t,(0,L.z)([s]));const d=a?s:c?e.cat(t,{signal:r}):void 0;return i.catTime=Date.now()-o,!i.local&&c?(e.pin(t),i.pinTime=Date.now()-i.catTime):i.pinTime=-1,{result:d,textPreview:u,cid:t,meta:i,source:"node"}}}catch(e){return rt.debug("error fetchIPFSContentFromNode",e),{cid:t,availableDownload:!0,source:"node",meta:{...it}}}}else rt.log("--------fetchIPFSContentFromNode NO NODE INTIALIZED--------")},ut=async(t,e,s,n)=>{const r="external"===e?.nodeType,a=r?await ot(t,e,s?.signal):it,i=`${p}/ipfs/${t}`,o=await fetch(i,{method:"GET",signal:s?.signal,headers:n});if(o&&o.body){const e=e=>r?Promise.resolve():et.add(t,(0,L.z)(e)),{mime:s,result:n,firstChunk:c}=await async function(t,e){const[s,n]=t.tee(),r=[],a=s.getReader(),{value:i}=await a.read(),o=i?await j(i):void 0,c=n.getReader(),u={async*[Symbol.asyncIterator](){for(;;){const{done:t,value:s}=await c.read();if(t)return void(e&&e(r,o));e&&r.push(s),yield s}}};return{mime:o,result:u,firstChunk:i}}(o.body,e),u=X(s),d=Y(c,u);return{cid:t,textPreview:d,meta:{...a,mime:s,contentType:u},result:n,source:"gateway",contentUrl:i}}};const dt=async(t,e,s,n)=>{const r=await at(t);if(void 0!==r)return r;if(e){n&&n("trying to get with a node");return await ct(t,e,s)}n&&n("trying to get with a gatway");return await ut(t,e,s)},lt=async(t,e)=>{let s;return t&&(s=await t.add(e)),nt.add(e),s&&await et.add(s,await(async t=>new Uint8Array("string"==typeof t?Z.from(t):await t.arrayBuffer()))(e)),s};var pt=s(25108);const mt={helia:k,embedded:O,external:h};async function ht(t){const{ipfsNodeType:e,...s}=t,n=function(t,e){return class extends t{async fetchWithDetails(t,e,s){const n=await dt(t,this,s),r=await K(n,t);return e?r?.type===e?r:void 0:r}async addContent(t){return lt(this,t)}async isConnectedToSwarm(){return!!(await super.getPeers()).find((t=>t===e.swarmPeerId))}async reconnectToSwarm(t=!1){await this.isConnectedToSwarm()&&!t||super.connectPeer(e.swarmPeerAddress).then((()=>(pt.log(`🐝 connected to swarm - ${e.swarmPeerAddress}`),!0))).catch((t=>(pt.log(`Can't connect to swarm ${e.swarmPeerAddress}: ${t.message}`),!1)))}}}(mt[e],{swarmPeerId:u,swarmPeerAddress:"external"===e?l:d}),r=new n;return await r.init({url:s.urlOpts}),await r.reconnectToSwarm(),r}var gt=s(86515),yt=s(16697),ft=s(94975),bt=s(97255),wt=s(29127),vt=s(65583),St=s(63428),$t=s(42965),xt=s(87877),Ct=s(23071),_t=s(1545),At=s(25211),Et=s(28368),Tt=s(79878),Pt=s(32817),kt=s(49870),It=s(81480),Mt=s(25108);class Rt{constructor(t,e){this.settings=t,this.order=e}getNextSource(t){const e=this.order.indexOf(t);return e<this.order.length?this.order[e+1]:void 0}}var Ot=(t=>(t[t.transactions=1]="transactions",t[t.particle=2]="particle",t[t.chat=3]="chat",t))(Ot||{}),qt=(t=>(t[t.pending=0]="pending",t[t.executing=1]="executing",t[t.done=2]="done",t[t.error=-1]="error",t))(qt||{}),Ut=(t=>(t[t.particle=0]="particle",t[t.embedding=1]="embedding",t))(Ut||{}),Dt=(t=>(t[t.ZERO=0]="ZERO",t[t.LOW=.1]="LOW",t[t.MEDIUM=.5]="MEDIUM",t[t.HIGH=.9]="HIGH",t[t.URGENT=1]="URGENT",t))(Dt||{}),zt=s(95196),Bt=s(42006),Lt=s(29829),Nt=s(20573);function jt(t){return Boolean(t.match(/^Qm[a-zA-Z0-9]{44}$/g))}var Ft=s(25108);const Ht={list:{isLoading:!1,data:[],error:void 0},chats:{},summary:{unreadCount:{total:0,particles:0,neurons:0}}};function Zt(t){t.entryType===Ot.chat&&t.meta.to&&(t.entryType=Ot.particle);const{meta:e}=t,s={timestamp:new Date(e.timestamp).toISOString(),transactionHash:t.transactionHash||t.hash||t.meta.transaction_hash||t.meta.hash||t.meta.transactionHash,memo:t.memo||e.memo,senseChatId:t.id,unreadCount:t.unreadCount||0};switch(t.entryType){case Ot.chat:case Ot.transactions:{const e=t.meta,{type:n}=e;let r=t.ownerId;if("cosmos.bank.v1beta1.MsgSend"===n){r=e.value.fromAddress}else if("cosmos.bank.v1beta1.MsgMultiSend"===n){r=e.value.inputs[0].address}Object.assign(s,{type:n,from:r,meta:t.meta.value});break}case Ot.particle:{const e=t.meta;Object.assign(s,{type:"cyber.graph.v1beta1.MsgCyberlink",from:e.neuron,meta:e,fromLog:!0});break}default:return{}}return s}const Qt=(0,Lt.hg)("sense/getSenseList",(async t=>(await t.getList()).map(Zt))),Wt=(0,Lt.hg)("sense/getSenseChat",(async({id:t,senseApi:e})=>{if(jt(t)){return(await e.getLinks(t)).map((e=>{if(0!==e.timestamp)return Zt({...e,id:t,entryType:Ot.particle,meta:e})})).filter(Boolean)}return(await e.getFriendItems(t)).map((e=>{const s=e.to?Ot.particle:Ot.chat;return Zt({...e,entryType:s,id:t,meta:e})}))})),Gt=(0,Lt.hg)("sense/markAsRead",(async({id:t,senseApi:e})=>e.markAsRead(t))),Vt={id:"",isLoading:!1,data:[],error:void 0,unreadCount:0};function Xt(t,e){return t.data.slice(-5).some((t=>t.transactionHash===e.transactionHash))}const Kt=(0,Lt.oM)({name:"sense",initialState:Ht,reducers:{updateSenseList:{reducer:(t,e)=>{e.payload.forEach((e=>{const{senseChatId:s}=e;t.chats[s]||(t.chats[s]={...Vt});const n=t.chats[s];Object.assign(n,{id:s,unreadCount:e.unreadCount||0}),Xt(n,e)||(n.data=n.data.concat(e))})),Kt.caseReducers.orderSenseList(t)},prepare:t=>({payload:t.map(Zt)})},addSenseItem(t,e){const{id:s,item:n}=e.payload;t.chats[s].data.push({...n,meta:n.meta,status:"pending"});const r=t.list.data.filter((t=>t!==s));r.unshift(s),t.list.data=r},updateSenseItem(t,e){const{chatId:s,txHash:n,isSuccess:r}=e.payload,a=t.chats[s].data.find((t=>t.transactionHash===n));a&&(r?delete a.status:a.status="error")},orderSenseList(t){const e=Object.keys(t.chats).reduce(((e,s)=>{const n=t.chats[s];if(!n.data.length)return e;const r=n.data[n.data.length-1];return e.push({id:s,lastMsg:r}),e}),[]).sort(((t,e)=>Date.parse(e.lastMsg.timestamp)-Date.parse(t.lastMsg.timestamp)));t.list.data=e.map((t=>t.id))},reset:()=>Ht},extraReducers:t=>{t.addCase(Qt.pending,(t=>{t.list.isLoading=!0})),t.addCase(Qt.fulfilled,((t,e)=>{t.list.isLoading=!1;const s=[];e.payload.forEach((e=>{const{senseChatId:n}=e;t.chats[n]||(t.chats[n]={...Vt});const r=t.chats[n];Object.assign(r,{id:n,unreadCount:e.unreadCount||0}),Xt(r,e)||(r.data=r.data.concat(e)),s.push(n)})),t.list.data=s})),t.addCase(Qt.rejected,((t,e)=>{Ft.error(e),t.list.isLoading=!1,t.list.error=e.error.message})),t.addCase(Wt.pending,((t,e)=>{const{id:s}=e.meta.arg;t.chats[s]||(t.chats[s]={...Vt}),t.chats[s].isLoading=!0})),t.addCase(Wt.fulfilled,((t,e)=>{const{id:s}=e.meta.arg,n=t.chats[s];n.isLoading=!1,n.id=s,n.data=e.payload})),t.addCase(Wt.rejected,((t,e)=>{Ft.error(e);const s=t.chats[e.meta.arg.id];s.isLoading=!1,s.error=e.error.message})),t.addCase(Gt.fulfilled,((t,e)=>{const{id:s}=e.meta.arg,n=t.chats[s],r=jt(s),{unreadCount:a}=n;t.summary.unreadCount.total-=a,r?t.summary.unreadCount.particles-=a:t.summary.unreadCount.neurons-=a,n.unreadCount=0}))}}),{addSenseItem:Yt,updateSenseItem:Jt,updateSenseList:te,reset:ee}=((0,Nt.P1)((t=>t.sense.chats),(t=>{let e=0,s=0;Object.values(t).forEach((({id:t,unreadCount:n})=>{jt(t)?e+=n:s+=n}));return{total:e+s,particles:e,neurons:s}})),Kt.actions);Kt.reducer;const se={POCKET:"pocket",POCKET_ACCOUNT:"pocketAccount"};const ne={actionBar:{tweet:s(26720).fE.STAGE_TWEET_ACTION_BAR.TWEET},defaultAccount:{name:null,account:null},accounts:null};function re(t){const{defaultAccount:e,accounts:s}=t;e&&localStorage.setItem(se.POCKET,JSON.stringify({[e.name]:e.account})),s&&localStorage.setItem(se.POCKET_ACCOUNT,JSON.stringify(s))}const ae=(0,Lt.oM)({name:"pocket",initialState:ne,reducers:{setDefaultAccount:(t,{payload:{name:e,account:s}})=>{t.defaultAccount={name:e,account:s||t.accounts?.[e]||null},re(t)},setAccounts:(t,{payload:e})=>{t.accounts=e,re(t)},setStageTweetActionBar:(t,{payload:e})=>{t.actionBar.tweet=e},deleteAddress:(t,{payload:e})=>{t.accounts&&Object.keys(t.accounts).forEach((s=>{Object.keys(t.accounts[s]).forEach((n=>{if(t.accounts[s][n].bech32===e){if(delete t.accounts[s][n],0===Object.keys(t.accounts[s]).length&&delete t.accounts[s],t.defaultAccount?.account?.cyber?.bech32===e){const e=Object.entries(t.accounts).find((([,t])=>t.cyber?.bech32));t.defaultAccount=e?{name:e[0],account:e[1]}:{name:null,account:null}}re(t)}}))}))}}}),{setDefaultAccount:ie,setAccounts:oe,setStageTweetActionBar:ce,deleteAddress:ue}=ae.actions;ae.reducer;const de="cyb-queue-channel";var le=class{constructor(){this.channel=new BroadcastChannel("cyb-broadcast-channel")}postServiceStatus(t,e,s){this.channel.postMessage({type:"service_status",value:{name:t,status:e,message:s}})}postSyncEntryProgress(t,e){this.channel.postMessage({type:"sync_entry",value:{entry:t,state:e}})}postMlSyncEntryProgress(t,e){this.channel.postMessage({type:"sync_ml_entry",value:{entry:t,state:e}})}postSenseUpdate(t){t.length>0&&this.channel.postMessage(te(t))}postSetDefaultAccount(t,e){this.channel.postMessage(ie({name:t,account:e}))}post(t){this.channel.postMessage(t)}};const pe=(t,e)=>({sendStatus:(s,n,r)=>{e.postSyncEntryProgress(t,{status:s,message:n,progress:r,done:["active","error","listen"].some((t=>t===s))})}});async function me(t,e,s=10){let n=[];for await(const r of t)n.push(r),n.length===s&&(await e(n),n=[]);n.length>0&&await e(n)}async function*he(t,e){let s=0;for(;;){const n=await t({...e,offset:s});if(0===n.length)break;yield n,s+=n.length}}const ge="QmbdH2WBamyKLPE5zu4mJ9v49qvY8BFfoumoVPMR5V4Rvx",ye="QmPLSA5oPqYxgc8F7EwrM8WS9vKrr1zPoDniSRFh8HSrxx",fe=[ge,ye];var be=s(25108);const we=async t=>{const[e,s]=await(async t=>{const e=t?.meta?.contentType||"";if("text"===e){const s=await K(t,t.cid);if(s?.content)return[e,F(s.content,512)]}return[e,void 0]})(t);let n="text"===e&&!!s;return n=n&&(!s.match(z.T6)||!s.match(z.$T)),n?s:void 0};var ve=class{constructor(t){if(this.statusApi=pe("resolver",new le),this._syncQueue$=new gt.X(new Map),!t.waitForParticleResolve)throw new Error("waitForParticleResolve is not defined");this.waitForParticleResolve=t.waitForParticleResolve,t.getEmbeddingInstance$?.subscribe((t=>{this.getEmbedding=t,this.queue.size>0&&this._syncQueue$.next(this.queue)})),t.dbInstance$.pipe((0,zt.P)((t=>void 0!==t))).subscribe((async t=>{this.db=t,await this.loadSyncQueue()})),this.isInitialized$=(0,bt.a)([t.dbInstance$,t.ipfsInstance$]).pipe((0,wt.U)((([t,e])=>!!e&&!!t)))}get canEmbed(){return!!this.getEmbedding}get queue(){return this._syncQueue$.getValue()}get loop$(){return this._loop$}async resolveIpfsParticle(t,e){return this.waitForParticleResolve(t,e).then((async({status:t,result:e})=>!("not_found"===t||!e)&&(await $e(e),!0))).catch((()=>!1))}async saveEmbedding(t,e){try{if(!await this.db.existEmbedding(t)){const s=await this.getEmbedding(e);await this.db.putEmbedding(t,s)}return!0}catch(s){return be.error(`saveEmbedding error: ${t} - ${e} `,s.toString()),!1}}async processSyncQueue(t){const e=t.length;this.statusApi.sendStatus("in-progress",`processing batch ${e}/${e} batch. ${this.queue.size} pending...`);let s=e;await Promise.all(t.map((async t=>{const{id:n,jobType:r,data:a}=t;let i=Promise.resolve(!1);return r===Ut.embedding&&a?i=this.saveEmbedding(n,a):r===Ut.particle&&(i=this.resolveIpfsParticle(n,Dt.MEDIUM)),i.then((async t=>{t?await this.db.removeSyncQueue({id:n,jobType:r}):await this.db.updateSyncQueue({id:n,jobType:r,status:qt.error});const a=this._syncQueue$.value;a.delete(n),s--,this._syncQueue$.next(a),this.statusApi.sendStatus("in-progress",`processing batch ${e-s}/${e} batch. ${this.queue.size} pending...`)}))})))}start(){const t=this.isInitialized$.pipe((0,Bt.b)((t=>be.log(`sync queue isInitialized - ${t}`))),(0,ft.h)((t=>!0===t)),(0,xt.z)((()=>this._syncQueue$)),(0,ft.h)((t=>t.size>0)),(0,xt.z)((t=>{const e=[...t.values()],s=100-e.filter((t=>t.status===qt.executing)).length,n=t=>t.jobType===Ut.particle||t.jobType===Ut.embedding&&this.canEmbed;if(s>0){const r=e.filter((t=>t.status===qt.pending&&n(t))).sort(((t,e)=>t.priority-e.priority)).slice(0,s);if(r.length>0)return r.forEach((e=>{t.set(e.id,{...e,status:qt.executing})})),this._syncQueue$.next(t),this.statusApi.sendStatus("in-progress","starting..."),this.processSyncQueue(r)}return _t.E})));return this._loop$=t.pipe((0,vt.B)()),this._loop$.subscribe({next:t=>{this.statusApi.sendStatus("active")},error:t=>this.statusApi.sendStatus("error",t.toString())}),this}async enqueueBatch(t,e,s){return me(t,(t=>this.enqueue(t.map((t=>({id:t,priority:s,jobType:e}))))),500)}async enqueue(t){if(0===t.length)return;await this.db.putSyncQueue(t);const e=this._syncQueue$.value;t.forEach((t=>e.set(t.id,{...t,status:qt.pending}))),this._syncQueue$.next(e)}async loadSyncQueue(){const t=await this.db.getSyncQueue({statuses:[qt.pending]}).then((t=>new Map(t.map((t=>[t.id,t])))));this._syncQueue$.next(new Map([...t,...this.queue]))}};const Se=(()=>{const t=new BroadcastChannel(de);return{enqueue:e=>{t.postMessage(e)}}})(),$e=async t=>{const e=await we(t);return e&&Se.enqueue({type:"sync",data:{id:t.cid,data:e,jobType:Ut.embedding,priority:Dt.MEDIUM}}),!!e};var xe=s(25108);const Ce=t=>"text"!==(t?.meta?.contentType||"other")?"":t.result instanceof Uint8Array?(0,q.B)(t.result):t.result;class _e extends Error{constructor(t){super(`Timeout after ${t}`),Object.setPrototypeOf(this,_e.prototype)}}var Ae=s(25108);function Ee(t){return(t.priority||0)+(t.viewPortPriority||0)}const Te={external:new Rt({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e4,maxConcurrentExecutions:30},gateway:{timeout:1e4,maxConcurrentExecutions:11}},["db","node","gateway"]),embedded:new Rt({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e4,maxConcurrentExecutions:30},gateway:{timeout:21e3,maxConcurrentExecutions:11}},["db","gateway","node"]),helia:new Rt({db:{timeout:5e3,maxConcurrentExecutions:999},node:{timeout:6e4,maxConcurrentExecutions:50},gateway:{timeout:1e4,maxConcurrentExecutions:11}},["db","node","gateway"])};var Pe=class{constructor(t,{strategy:e,queueDebounceMs:s,runeInstance$:n}){this.queue$=new gt.X(new Map),this.node=void 0,this.rune=void 0,this.lastNodeCallTime=Date.now(),this.channel=new le,this.executing={db:new Set,node:new Set,gateway:new Set},t.subscribe((t=>{t&&this.setNode(t)})),n.subscribe((t=>{this.rune=t})),this.strategy=e||Te.embedded,this.queueDebounceMs=s||33,(0,yt.F)(15e3).pipe((0,ft.h)((()=>!!this.node&&!![...this.queue$.value.values()].find((t=>"node"===t.source))))).subscribe((()=>{Ae.log("-----reconnect cnt",this.queue$.value.size,this.queue$.value),this.node.reconnectToSwarm(!0)}));const r=(0,bt.a)([n,t]).pipe((0,wt.U)((([t,e])=>!!t&&!!e&&e.isStarted)),(0,vt.B)());r.subscribe((t=>{t&&Ae.log("🚦 Ipfs QueueManager initialized")})),this.queue$.pipe((0,St.M)(r),(0,ft.h)((([,t])=>t)),(0,$t.b)(this.queueDebounceMs),(0,wt.U)((([t])=>this.cancelDeprioritizedItems(t))),(0,xt.z)((t=>{const e=this.getItemBySourceAndPriority(t);return e.length>0?(this.node?.reconnectToSwarm(!1),(0,Ct.T)(...e.map((t=>this.fetchData$(t))))):_t.E}))).subscribe((({item:t,status:e,source:s,result:n})=>{const{cid:r}=t,a=this.queue$.value.get(r)?.callbacks||[];if(a.map((t=>t(r,e,s,n))),"node"===s&&(this.lastNodeCallTime=Date.now()),this.executing[s].delete(r),"completed"===e||"cancelled"===e)this.removeAndNext(r);else{const e=this.strategy.getNextSource(s);e?this.switchSourceAndNext(t,e):(this.removeAndNext(r),a.map((t=>t(r,"not_found",s,n))))}this.postSummary()}))}switchStrategy(t){this.strategy=t}async setNode(t,e){Ae.log(`switch node from ${this.node?.nodeType} to ${t.nodeType}`),this.node=t,this.switchStrategy(e||Te[t.nodeType])}getItemBySourceAndPriority(t){const e=[...t.values()].filter((t=>"pending"===t.status)),s=kt.vMG((t=>t.source),e),n=[];for(const[t,e]of Object.entries(s)){const s=this.strategy.settings[t].maxConcurrentExecutions-this.executing[t].size,r=e.sort(((t,e)=>Ee(e)-Ee(t))).slice(0,s);n.push(...r)}return n}postSummary(){const t=`(total: ${this.queue$.value.size} |  db - ${this.executing.db.size} node - ${this.executing.node.size} gateway - ${this.executing.gateway.size})`;this.channel.postServiceStatus("ipfs","started",t)}fetchData$(t){const{cid:e,source:s,callbacks:n,controller:r}=t,a=this.strategy.settings[s];this.executing[s].add(e),this.postSummary();const i=this.queue$.value.get(e);return this.queue$.value.set(e,{...i,status:"executing",executionTime:Date.now(),controller:new AbortController}),n.map((t=>t(e,"executing",s))),(o=async()=>async function(t,e,s){const{node:n,controller:r,headers:a}=s;try{switch(e){case"db":return at(t);case"node":return ct(t,n,r);case"gateway":return ut(t,n,r,a);default:return}}catch(t){return void rt.log("----fetchIpfsContent error",t)}}(e,s,{controller:r,node:this.node}).then((async e=>{let n=(t=>{if(!t)return;const e=t?.meta?.contentType||"other";return"text"===e&&t.result instanceof Uint8Array?{...t,contentType:e,result:(0,q.B)(t.result)}:{...t,contentType:e}})(e);return n=t.postProcessing?e?await async function(t,e,s,n){try{const{cid:r,controller:a,source:i}=t,{meta:o}=e,c=await s.personalProcessor({cid:r,contentType:o.contentType,content:Ce(e)});if("cid_result"===c.action&&c.cid){const s=await n.enqueueAndWait(c.cid,{postProcessing:!1,priority:Dt.URGENT});if(xe.log("----cid_result",t.cid,e,c,s),s)return{...s.result,cidBefore:r,mutation:"modified"}}if("content_result"===c.action){const t={type:"file",size:c.content?.length,sizeLocal:c.content?.length,mime:"text/plain",contentType:"text"};return{...e,result:c.content,textPreview:Y(c.content,"text"),meta:t,mutation:"modified"}}return"hide"===c.action?{...e,mutation:"hidden"}:"error"===c.action?{...e,mutation:"error"}:e}catch(t){return xe.log("----exc",t),{...e,mutation:"error"}}}(t,e,this.rune,this):void 0:e,n&&"db"!==s&&(t=>{Se.enqueue({type:"particle",data:{...t,result:void 0}})})(n),n})),new It.y((t=>{o().then((e=>{t.next(e),t.complete()})).catch((e=>{Mt.debug("----promiseToObservable error",e),t.error(e)}))}))).pipe((0,At.V)({each:a.timeout,with:()=>(0,Et._)((()=>(r?.abort("timeout"),new _e(a.timeout))))}),(0,wt.U)((e=>({item:t,status:e?"completed":"error",source:s,result:e}))),(0,Tt.K)((e=>e instanceof _e?(0,Pt.of)({item:t,status:"timeout",source:s}):"AbortError"===e?.name?(0,Pt.of)({item:t,status:"cancelled",source:s}):(0,Pt.of)({item:t,status:"error",source:s}))));var o}mutateQueueItem(t,e){const s=this.queue$.value,n=s.get(t);return n&&s.set(t,{...n,...e}),this.queue$.next(s)}removeAndNext(t){const e=this.queue$.value;e.delete(t),this.queue$.next(e)}switchSourceAndNext(t,e){t.callbacks.map((s=>s(t.cid,"pending",e))),this.mutateQueueItem(t.cid,{status:"pending",source:e})}cancelDeprioritizedItems(t){return["node","gateway"].forEach((e=>{Array.from(this.executing[e]).forEach((s=>{const n=t.get(s);n&&Ee(n)<0&&n.controller&&(n.controller.abort("cancelled"),n.callbacks.map((t=>t(n.cid,"pending",n.source))),t.set(s,{...n,status:"pending"}),this.executing[e].delete(s))}))})),t}releaseExecution(t){Object.keys(this.executing).forEach((e=>this.executing[e].delete(t)))}enqueue(t,e,s={}){const n=this.queue$.value,r=n.get(t);if(r)this.mutateQueueItem(t,{callbacks:[...r.callbacks,e]});else{const r=s.initialSource||this.strategy.order[0],a={cid:t,callbacks:[e],source:r,status:"pending",postProcessing:!0,...s};e(t,"pending",r),n.set(t,a),this.queue$.next(n)}}enqueueAndWait(t,e={}){return new Promise((s=>{this.enqueue(t,((t,e,n,r)=>{"completed"!==e&&"not_found"!==e||s({status:e,source:n,result:r})}),e)}))}updateViewPortPriority(t,e){this.mutateQueueItem(t,{viewPortPriority:e})}cancel(t){const e=this.queue$.value.get(t);e&&(e.controller?e.controller.abort("cancelled"):this.removeAndNext(t))}cancelByParent(t){const e=this.queue$.value;e.forEach(((s,n)=>{s.parent===t&&(this.releaseExecution(n),s.controller?.abort("cancelled"),e.delete(n))})),this.queue$.next(e)}clear(){const t=this.queue$.value;t.forEach(((e,s)=>{this.releaseExecution(s),e.controller?.abort("cancelled"),t.delete(s)})),this.queue$.next(new Map)}getQueueMap(){return this.queue$.value}getQueueList(){return Array.from(this.queue$.value.values())}getStats(){return kt.zGw(kt.VFc(kt.vgT("status")),kt.Zpf,kt.UID(kt._Qy(["status","count"])))(this.getQueueList())}},ke=s(12550),Ie=s(37242),Me=s(49734),Re=s(44586);var Oe=s(5662),qe=s(25108);const Ue={budget:1e6,experimental:!1,instructions:!0,options:[]},De=t=>{return e=Object.values(t),Object.fromEntries(Object.values(e).filter((t=>!!t?.key)).map((t=>[t.key,t.value])));var e};const ze=function(){let t={},e={params:{},user:{},secrets:{}};const s=new Map;let n;const r=(t,s)=>{e[t]="secrets"!==t?s:De(s)},a={readOnly:!1,execute:!0,funcName:"main",funcParams:{},config:Ue},i=async(t,n,r)=>{const i=(0,Re.Z)().toString();r&&s.set(i,r);const o={app:e,refId:i},c={...a,...n},u=await(0,Me.MY)(t,'pub fn pass() {\n    #{ "action": "pass" }\n}\n\npub fn hide() {\n    #{ "action": "hide" }\n}\n\npub fn cid_result(cid) {\n    #{ "cid": cid, "action": "cid_result" }\n}\n\npub fn content_result(content) {\n    // #{ "content": json::to_string(content)?, "action": "content_result" }\n    #{ "content": content, "action": "content_result" }\n}\n\npub fn error(message) {\n    #{ "message": message, "action": "error" }\n}\n\npub fn meta_text(text) {\n    #{ "text": text, "type": "text" }\n}\n\npub fn meta_link(url, title) {\n    #{ "url": url, "title": title, "type": "link" }\n}\n\npub async fn async_callback(data) {\n    cyb::log("asyc callback from rune");\n\n    //    cyb::callback(cyb::ref_id, data).await\n}\n',o,c),{result:d,error:l}=u;try{return s.delete(i),{...u,error:l,result:d?JSON.parse((p=d,p.replace(H,""))):{action:"error",message:"No result"}}}catch(t){return s.delete(i),qe.log(`engine.run err ${c.funcName}`,t,u,c),{diagnosticsOutput:`scripting engine error ${t}`,...u,result:{action:"error",message:t?.toString()||"Unknown error"}}}var p},o=()=>{if(!t.particle)return["error",""];const{script:e,enabled:s}=t.particle;return s?["script",e]:["pass",""]};return{load:async e=>{t=e.entrypoints,r("secrets",e.secrets),qe.log("-----------rune engine initializing"),qe.time("⚡️ Rune initialized! 🔋"),n=await(0,Me.ZP)(),qe.timeEnd("⚡️ Rune initialized! 🔋")},run:i,askCompanion:async(t,e,s,n)=>{const[r,a]=o();if("error"===r)return{action:"error",metaItems:[{type:"text",text:"No particle entrypoint"}]};if("pass"===r)return{action:"pass",metaItems:[]};const c=await i(a,{funcName:"ask_companion",funcParams:[t,e,s]},n);return"error"===c.result.action?(qe.error("---askCompanion error",c),{action:"error",metaItems:[{type:"text",text:c.error}]}):{action:"answer",metaItems:c.result.content}},personalProcessor:async t=>{const[e,s]=o();if("error"===e)return{action:"error",message:"No particle entrypoint"};if("script"!==e)return{action:"pass"};const{cid:n,contentType:r,content:a}=t,c=await i(s,{funcName:"personal_processor",funcParams:[n,r,a]}),{action:u,content:d}=c.result;return"error"===u&&qe.error(`RUNE: personalProcessor error: ${t.cid}`,t,c),d?{...c.result,content:d}:c.result},setEntrypoints:e=>{t=(0,kt.IDH)((t=>({...t,script:(0,Oe.P6)(t.script)})),e)},pushContext:r,popContext:t=>{const s=e;t.forEach((t=>{s[t]={}})),e=s},executeFunction:async(t,e,s)=>(await i(t,{funcName:e,funcParams:s,readOnly:!0})).result,executeCallback:async(t,e)=>{const n=s.get(t);n&&await n(e)},getDebug:()=>({context:e,entrypoints:t})}}();var Be=ze,Le=s(60666);function Ne(t){return{async*[Symbol.asyncIterator](){let e=!1;for(;!e;){const s=new Promise((s=>{t.onmessage=t=>{null===t.data?(e=!0,s(null)):s(t.data)}})),n=await s;null!==n&&(yield n)}}}}const je={canHandle:t=>t&&t.result&&"function"==typeof t.result[Symbol.asyncIterator],serialize(t){if(void 0===t)return[null,[]];const{result:e,...s}=t,{port1:n,port2:r}=new MessageChannel;return e&&(async()=>{for await(const t of e)n.postMessage(t);n.postMessage(null),n.close()})(),[{...s,port:r},[r]]},deserialize(t){if(!t)return;const{port:e,...s}=t;return{...s,result:Ne(e)}}};var Fe=s(34155),He=s(25108);"undefined"!=typeof SharedWorker&&Fe.env.IS_DEV;function Ze(){n.Y6.set("IPFSContent",je)}function Qe(t){const e={log:{original:He.log},error:{original:He.error},warn:{original:He.warn}},s=s=>{const{original:n}=e[s];e[s].original=He[s],He[s]=(...e)=>{n.apply(He,e);const r=e.map((t=>function(t){try{return JSON.stringify(t)}catch(e){return String(t)}}(t)));t.postMessage({type:"console",method:s,args:r})}};Object.keys(e).forEach((t=>s(t)))}var We=s(98431),Ge=s(19917),Ve=s(11954),Xe=s(96486),Ke=s(21466);const Ye=(t,e)=>{const{transaction_hash:s,index:n,transaction:{memo:r,block:{timestamp:a,height:i},success:o},type:c,value:u}=e;return{hash:s,index:n,type:c,timestamp:(0,Ke.VE)(a),memo:r,value:u,success:o,neuron:t,blockHeight:i}},Je=({from:t,to:e,neuron:s,timestamp:n,transaction_hash:r})=>({from:t,to:e,neuron:s,timestamp:(0,Ke.VE)(n),transactionHash:r});function ts(t,e){return async(...s)=>{if(e.aborted)throw new DOMException("The operation was aborted.","AbortError");return t(...s)}}var es=s(67937);var ss=s(31230);var ns=(t=>(t.Asc="asc",t.AscNullsFirst="asc_nulls_first",t.AscNullsLast="asc_nulls_last",t.Desc="desc",t.DescNullsFirst="desc_nulls_first",t.DescNullsLast="desc_nulls_last",t))(ns||{});ss.Ps`
    subscription Transactions {
  transaction(offset: 0, limit: 200, order_by: {height: desc}) {
    success
    messages
    height
    hash
  }
}
    `;ss.Ps`
    query accountCount {
  account_aggregate {
    aggregate {
      count(columns: address)
    }
  }
}
    `;ss.Ps`
    query blockByHeight($blockId: bigint) {
  block(where: {height: {_eq: $blockId}}) {
    hash
    height
    proposer_address
    timestamp
    transactions {
      messages
      hash
      height
      success
    }
  }
}
    `;ss.Ps`
    query blocks($limit: Int, $offset: Int, $where: block_bool_exp) {
  block(where: $where, limit: $limit, offset: $offset, order_by: {height: desc}) {
    hash
    height
    proposer_address
    transactions_aggregate {
      aggregate {
        count
      }
    }
    timestamp
  }
}
    `;ss.Ps`
    query contractsCount {
  contracts_aggregate {
    aggregate {
      count
    }
  }
}
    `;const rs=ss.Ps`
    query CyberlinksByParticle($limit: Int, $offset: Int, $orderBy: [cyberlinks_order_by!], $where: cyberlinks_bool_exp) {
  cyberlinks(limit: $limit, offset: $offset, order_by: $orderBy, where: $where) {
    from: particle_from
    to: particle_to
    timestamp
    neuron
    transaction_hash
  }
}
    `;const as=ss.Ps`
    query CyberlinksCountByNeuron($address: String, $particles_from: [String!], $timestamp: timestamp) {
  cyberlinks_aggregate(
    where: {_and: [{neuron: {_eq: $address}}, {particle_from: {_in: $particles_from}}, {timestamp: {_gt: $timestamp}}]}
  ) {
    aggregate {
      count
    }
  }
}
    `;ss.Ps`
    query cyberlinksCountByParticle($cid: String, $where: cyberlinks_bool_exp) {
  cyberlinks_aggregate(where: $where) {
    aggregate {
      count
    }
  }
}
    `;const is=ss.Ps`
    query MessagesByAddressCount($address: _text, $timestamp: timestamp) {
  messages_by_address_aggregate(
    args: {addresses: $address, limit: "100000000", offset: "0", types: "{}"}
    where: {transaction: {block: {timestamp: {_gt: $timestamp}}}}
  ) {
    aggregate {
      count
    }
  }
}
    `;const os=ss.Ps`
    query MessagesByAddressSense($address: _text, $limit: bigint, $offset: bigint, $timestamp_from: timestamp, $types: _text, $order_direction: order_by) {
  messages_by_address(
    args: {addresses: $address, limit: $limit, offset: $offset, types: $types}
    order_by: {transaction: {block: {timestamp: $order_direction}}}
    where: {transaction: {block: {timestamp: {_gt: $timestamp_from}}}}
  ) {
    transaction_hash
    index
    value
    transaction {
      success
      block {
        timestamp
        height
      }
      memo
    }
    type
  }
}
    `;const cs=ss.Ps`
    subscription MessagesByAddressSenseWs($address: _text, $limit: bigint, $offset: bigint, $timestamp_from: timestamp, $types: _text, $order_direction: order_by) {
  messages_by_address(
    args: {addresses: $address, limit: $limit, offset: $offset, types: $types}
    order_by: {transaction: {block: {timestamp: $order_direction}}}
    where: {transaction: {block: {timestamp: {_gt: $timestamp_from}}}}
  ) {
    transaction_hash
    index
    value
    transaction {
      success
      block {
        timestamp
        height
      }
      memo
    }
    type
  }
}
    `;ss.Ps`
    query transactionCount {
  transaction_aggregate {
    aggregate {
      count(columns: hash)
    }
  }
}
    `;ss.Ps`
    query uptimeByAddress($address: String) {
  uptime(where: {consensus_address: {_eq: $address}}) {
    uptime
  }
}
    `;ss.Ps`
    query wasmDashboardPage($offset: Int, $limit: Int) {
  contracts(limit: $limit, offset: $offset, order_by: {tx: desc}) {
    address
    admin
    code_id
    creator
    fees
    gas
    label
    tx
  }
  contracts_aggregate {
    aggregate {
      sum {
        gas
        fees
        tx
      }
      count(columns: address)
    }
  }
}
    `;ss.Ps`
    query MessagesByAddress($address: _text, $limit: bigint, $offset: bigint, $types: _text) {
  messages_by_address(
    args: {addresses: $address, limit: $limit, offset: $offset, types: $types}
    order_by: {transaction: {block: {height: desc}}}
  ) {
    transaction_hash
    value
    transaction {
      success
      height
      logs
      memo
      block {
        timestamp
      }
    }
    type
  }
}
    `;var us=s(29639),ds=s(98994),ls=s(28972);const ps="cosmos.bank.v1beta1.MsgSend",ms="cosmos.bank.v1beta1.MsgMultiSend",hs=(t,e)=>{const{data:s,events:n}=e,r=n["tx.hash"][0],a=n["message.action"][0].slice(1),i=(0,Ke.qQ)(),o=n["tx.height"][0],{memo:c="",messages:u}=(t=>{const e=us.Tx.decode((0,ls.Gh)(t)),s=e.body?.memo,n=e.body?.messages.map((t=>{const e=t.typeUrl.slice(1);return e===ps?ds.MsgSend.decode(t.value):e===ms?ds.MsgMultiSend.decode(t.value):void 0})).filter((t=>void 0!==t));return{memo:s,messages:n}})(s.value.TxResult.tx),d=[];return u.forEach(((e,s)=>{d.push({hash:r,index:s,type:a,timestamp:i,success:!0,value:e,memo:c,neuron:t,blockHeight:o})})),d};var gs=s(6584),ys=s(85185),fs=s(95210),bs=s(78699),ws=s(26461);const vs=new fs.g((0,ws.eI)({url:es.TB,shouldRetry:t=>!0,retryAttempts:10,retryWait:async t=>{setTimeout((()=>Promise.resolve()),Math.min(1e3*2**t,1e4))}})),Ss=t=>new bs.g6(es.F$,{signal:t});const $s=async({particleCid:t,timestampFrom:e,offset:s=0,abortSignal:n})=>(await Ss(n).request(rs,{limit:200,offset:s,orderBy:[{timestamp:ns.Asc}],where:{_or:[{particle_to:{_eq:t}},{particle_from:{_eq:t}}],timestamp:{_gt:(0,Ke.gB)(e)}}})).cyberlinks,xs=async({neuron:t,particlesFrom:e,timestampFrom:s,batchSize:n,offset:r=0,abortSignal:a})=>{const i={_and:[{timestamp:{_gt:(0,Ke.gB)(s)}},{neuron:{_eq:t}},{particle_from:{_in:e}}]};return(await Ss(a).request(rs,{limit:n,offset:r,orderBy:[{timestamp:ns.Asc}],where:i})).cyberlinks},Cs=async(t,e,s,n,r)=>he(xs,{neuron:t,particlesFrom:e,timestampFrom:s,batchSize:n,abortSignal:r}),_s=t=>[...new Set([...t.map((t=>t.to)),...t.map((t=>t.from))])],As=async(t,e,s,n,r)=>{const a=((t,e,s)=>he($s,{particleCid:t,timestampFrom:e,abortSignal:s}))(t,e,r),i=[];for await(const t of a){i.push(...t);const e=_s(t);e.length>0&&await me(e,(t=>s.enqueueBatch(t,Ut.particle,n)),20)}return i};const Es=({neuron:t,timestampFrom:e,offset:s=0,types:n=[],orderDirection:r="desc",limit:a})=>({address:`{${t}}`,limit:a,timestamp_from:(0,Ke.gB)(e),offset:s,types:`{${n.map((t=>`"${t}"`)).join(" ,")}}`,order_direction:r}),Ts=async({neuron:t,timestampFrom:e,offset:s=0,types:n=[],orderDirection:r="desc",limit:a,abortSignal:i})=>{const o=await Ss(i).request(os,Es({neuron:t,timestampFrom:e,offset:s,types:n,orderDirection:r,limit:a,abortSignal:i}));return o?.messages_by_address},Ps=(t,e,s,n,r)=>{const a=t.get(e),i=a?.transactions||[];return i.push(s),t.set(e,{userAddress:e,lastSendTimestamp:r?s.timestamp:a?.lastSendTimestamp||0,last:{amount:n,memo:s.memo,direction:r?"to":"from"},transactions:i}),t},ks=async(t,e,s,n,r=!0)=>{const a=await t.findSyncStatus({ownerId:e,entryType:Ot.chat}),i=new Map(a?.map((t=>[t.id,t]))),o=((t,e)=>{if(0===(e.filter((t=>t.type===ps||t.type===ms))||[]).length)return[];const s=new Map;return e.forEach((e=>{let n="";if(e.type===ms){const{inputs:n,outputs:r}=e.value,a=n.find((e=>e.address===t));(a?r:n).forEach((t=>Ps(s,t.address,e,t.coins,a)))}else if(e.type===ps){const{fromAddress:r,toAddress:a,amount:i}=e.value,o=r===t;n=o?a:r,Ps(s,n,e,i,o)}})),s})(e,await t.getTransactions(e,{order:"asc",timestampFrom:s})),c=[];for(const s of o.values()){const a=i.get(s.userAddress),o=s.transactions.at(-1),{timestamp:u,hash:d,index:l}=o,p={entryType:Ot.chat,ownerId:e,meta:{transactionHash:d,index:l}};if(a){const{id:e,timestampRead:i,timestampUpdate:d,meta:l,unreadCount:m}=a,h=Math.max(i,s.lastSendTimestamp),{timestampUpdateContent:g=0,timestampUpdateChat:y=0}=l,f=Math.max(s.lastSendTimestamp,y),b=m+s.transactions.filter((t=>t.timestamp>f)).length;if(d<u){const s=r?u:y,i={...p,id:e,unreadCount:b,timestampRead:h,timestampUpdate:Math.max(u,g,s),meta:{...p.meta,timestampUpdateChat:s,timestampUpdateContent:g}};await ts(t.updateSyncStatus.bind(t),n)(i),c.push({...a,...i,meta:o})}}else{const e=s.transactions.filter((t=>t.timestamp>s.lastSendTimestamp)).length,a={...p,id:s.userAddress,unreadCount:e,timestampUpdate:r?u:0,timestampRead:s.lastSendTimestamp,disabled:!1};await ts(t.putSyncStatus.bind(t),n)(a),c.push({...a,meta:o})}}return c};var Is=s(98430),Ms=s(34978),Rs=s(93994);class Os{constructor(t){this.requestRecords=[],this.totalRequests=0,this.completedRequests=0,this.estimatedTime=-1,this.batchSize=1,this.onProgressUpdate=t}get progress(){return{totalCount:this.totalRequests,completeCount:this.completedRequests,estimatedTime:this.estimatedTime}}start(t,e=1){return this.totalRequests=t,this.requestRecords=[],this.completedRequests=0,this.estimatedTime=-1,this.batchSize=e,this.progress}add(t){return this.totalRequests+=t,this.progress}trackProgress(t){if(this.addRequestRecord(t),this.requestRecords.length>10&&this.requestRecords.shift(),this.requestRecords.length>1){const e=this.calculateAverageTimePerItem()*((this.totalRequests-this.completedRequests)*t);this.completedRequests+=t,this.estimatedTime=Math.round(e),this.onProgressUpdate&&this.onProgressUpdate(this.progress)}return this.progress}addRequestRecord(t){this.requestRecords.push({timestamp:Date.now(),itemCount:t})}calculateAverageTimePerItem(){let t=0,e=0;for(let s=1;s<this.requestRecords.length;s++){const n=this.requestRecords[s].timestamp-this.requestRecords[s-1].timestamp,{itemCount:r}=this.requestRecords[s];t+=n*r,e+=r}return 0===e?0:t/e}}var qs=class{constructor(t,e,s){if(this.progressTracker=new Os,this.channelApi=new le,this.params={myAddress:null},this.name=t,this.abortController=new AbortController,this.statusApi=pe(t,this.channelApi),this.particlesResolver=s,this.cyblogCh=(0,Rs.B)({thread:"bckd",module:t}),!e.params$)throw new Error("params$ is not defined");e.dbInstance$.subscribe((t=>{this.db=t})),this.particlesResolver=s,this.isInitialized$=this.createIsInitializedObserver(e),this.isInitialized$.subscribe((t=>{this.cyblogCh.info(`>>> ${this.name} - ${t?"initialized":"inactive"}`),this.statusApi.sendStatus(t?"initialized":"inactive")})),this.isInitialized$.pipe((0,Ms.w)((()=>e.params$))).subscribe((t=>{this.params=t,this.cyblogCh.info(`>>> ${this.name} - params updated`,{data:t})})),this.isInitialized$.pipe((0,ft.h)((t=>!!t)),(0,Ms.w)((()=>this.createRestartObserver(e.params$)))).subscribe((()=>{this.restart()}))}initAbortController(){this.abortController=new AbortController}createRestartObserver(t){return t.pipe((0,wt.U)((t=>t.myAddress)),(0,We.x)(((t,e)=>t===e)),(0,wt.U)((t=>!!t)),(0,ft.h)((t=>!!t)))}};const Us=(t,e,s)=>t.pipe((0,We.x)(),(0,Bt.b)((t=>s?.(t))),(0,ft.h)((t=>t)),(0,Ms.w)((()=>e)),(0,vt.B)());var Ds=s(25108);var zs=class extends qs{constructor(t,e,s){super(t,e,s),this.reloadTrigger$=new ke.x;const n=Us(this.isInitialized$,this.reloadTrigger$.pipe((0,Is.O)(null),(0,Bt.b)((()=>{this.initAbortController()})),(0,Ms.w)((()=>this.createInitObservable().pipe((0,Ms.w)((t=>this.createClientObservable(t).pipe((0,Bt.b)((()=>this.statusApi.sendStatus("listen"))),(0,Ms.w)((t=>(0,Ve.D)(this.onUpdate(t,this.params))))))))))),(e=>{Ds.log(`>>> ${t} isInitialized`,e),this.statusApi.sendStatus(e?"initialized":"inactive")}));n.subscribe({next:()=>{this.statusApi.sendStatus("listen")},error:t=>{this.statusApi.sendStatus("error",t)}}),this.source$=n}restart(){this.abortController?.abort(),this.reloadTrigger$.next(),Ds.log(`>>> ${this.name} client restart`)}start(){return this.source$.subscribe((()=>{})),this}};var Bs=class extends zs{createIsInitializedObserver(t){return(0,bt.a)([t.dbInstance$,t.params$.pipe((0,wt.U)((t=>t.myAddress)),(0,We.x)()),this.particlesResolver.isInitialized$]).pipe((0,wt.U)((([t,e,s])=>!!t&&!!s&&!!e)))}createClientObservable(t){const{myAddress:e}=this.params;this.cyblogCh.info(`>>> ${this.name} subscribe ${e} from ${(0,Ke.gB)(t)}`);const s=Es({neuron:e,timestampFrom:t,types:[],orderDirection:"desc",limit:100}),n=function(t,e){const s=new gs.f({link:vs,cache:new ys.h}).subscribe({query:t,variables:e});return new It.y((t=>{const e=s.subscribe({next(e){t.next(e.data)},error(e){t.error(e)},complete(){t.complete()}});return()=>e.unsubscribe()}))}(cs,s).pipe((0,wt.U)((t=>({source:"indexer",transactions:t.messages_by_address.map((t=>Ye(e,t)))})))),r=function(t,e,s){return new It.y((n=>{const r=new WebSocket(es.sF);return r.onopen=()=>{s(`node ws connected to ${es.sF} with ${e}`),r.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",id:"0",params:{query:e}}))},r.onmessage=e=>{const r=JSON.parse(e.data);s(`node ws ${t} onmessage`,r),n.next(r.result)},r.onerror=e=>{s(`node ws ${t} error`,{error:e}),n.error(e)},r.onclose=()=>{s(`node ws ${t} closed`),n.complete()},()=>{r.close()}}))}(e,(a=e,`tm.event='Tx' AND transfer.recipient='${a}'`),((t,e)=>this.cyblogCh.info(t,{unit:"node-ws",...e}))).pipe((0,ft.h)((t=>!(0,Xe.isEmpty)(t))),(0,wt.U)((t=>({source:"node",transactions:hs(e,t)}))));var a;return(0,Ct.T)(n,r)}createInitObservable(){return(0,Ge.P)((()=>(0,Ve.D)(this.initSync())))}async initSync(){const{myAddress:t}=this.params,{signal:e}=this.abortController,s=await this.db.getSyncStatus(t,t),n=await this.syncTransactions(t,t,s);this.statusApi.sendStatus("in-progress","sync my chats");const r=await ks(this.db,t,s.timestampUpdate,e);return this.channelApi.postSenseUpdate(r),this.statusApi.sendStatus("active"),n}async onUpdate({source:t,transactions:e},s){const{myAddress:n}=s,{signal:r}=this.abortController;if(0===e.length)return void this.cyblogCh.info(`>>> ${this.name} ${n} recived 0 updates `);const a=await this.db.getSyncStatus(n,n);await this.processBatchTransactions(n,n,e,a,t),this.statusApi.sendStatus("in-progress","sync my chats");const i=await ks(this.db,n,a.timestampUpdate,r,"node"!==t);this.channelApi.postSenseUpdate(i),this.statusApi.sendStatus("listen")}async processBatchTransactions(t,e,s,{timestampRead:n,unreadCount:r,timestampUpdate:a},i){const{signal:o}=this.abortController,c="node"!==i;this.cyblogCh.info(`   syncTransactions - process ${e}[${i}],  count: ${s.length}, from: ${s.at(0)?.timestamp}, to: ${s.at(-1)?.timestamp}`),await ts(this.db.putTransactions,o)(s),this.syncLinks(s,o);const{hash:u,index:d,timestamp:l}=s.at(-1),p=l,m={ownerId:t,entryType:Ot.transactions,id:e,timestampUpdate:c?p:a,unreadCount:r+s.length,timestampRead:n||0,disabled:!1,meta:{transactionHash:u,index:d}};return await ts(this.db.putSyncStatus,o)(m),p}async syncTransactions(t,e,s){const{unreadCount:n,timestampUpdate:r}=s,a=r+1;this.statusApi.sendStatus("estimating");const i=await(async(t,e,s)=>{const n=await Ss(s).request(is,{address:`{${t}}`,timestamp:(0,Ke.gB)(e)});return n?.messages_by_address_aggregate.aggregate?.count})(e,a,this.abortController.signal);if(this.cyblogCh.info(`>>> syncTransactions - start ${e},  count: ${i}, from: ${a}`),0===i)return a;this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.start(Math.ceil(i/500)));const o=(({neuron:t,timestampFrom:e,types:s,orderDirection:n,limit:r,abortSignal:a})=>he(Ts,{neuron:t,timestampFrom:e,types:s,orderDirection:n,limit:r,abortSignal:a}))({neuron:e,timestampFrom:a,types:[],orderDirection:"asc",limit:500,abortSignal:this.abortController?.signal});let c=0,u=a;for await(const r of o){this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.trackProgress(1)),c+=r.length;const a=r.map((t=>Ye(e,t)));u=await this.processBatchTransactions(t,e,a,{...s,unreadCount:n+c},"indexer")}return u}async syncLinks(t,e){const{tweets:s,particlesFound:n,links:r}=function(t){const e=t.filter((t=>"cyber.graph.v1beta1.MsgCyberlink"===t.type)),s=new Set,n=[];return{tweets:e.reduce(((t,{value:e,hash:r,timestamp:a})=>(e.links.forEach((i=>{s.add(i.to),s.add(i.from);const o={...i,timestamp:a,neuron:e.neuron,transactionHash:r};n.push(o),i.from===ge&&(t[o.to]=o)})),t)),{}),particlesFound:[...s],links:n}}(t);r.length>0&&await me(r,(t=>ts(this.db.putCyberlinks,e)(t)),500);const a=Object.keys(s),i=n.filter((t=>!a.includes(t)));await this.particlesResolver.enqueueBatch(a,Ut.particle,Dt.HIGH),i.length>0&&await this.particlesResolver.enqueueBatch(i,Ut.particle,Dt.LOW)}};const Ls=t=>t.replace(/([-_][a-z])/g,(t=>t.toUpperCase().replace("-","").replace("_","")));function Ns(t){if(!t||"object"!=typeof t)return t;const e={};return Object.keys(t).forEach((s=>{if(Object.prototype.hasOwnProperty.call(t,s)){const n=Ls(s);let r=t[s];Array.isArray(t[s])?r=t[s].map((t=>Ns(t))):"object"==typeof t[s]?r=Ns(t[s]):"string"==typeof t[s]&&(r=r.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\'/g,"'").replace(/\\''/g,'"').replace(/\\\\/g,"\\").replace(/\\!!/g,"#")),e[n]=r}})),e}function js(t,e,s=0,n=0){const r=t.filter((t=>t.timestamp>s)),a=(0,Xe.findLastIndex)(r,(t=>t.neuron===e)),i=a<0?n+r.length:r.length-a-1;return{timestampRead:a<0?s:t[a].timestamp,unreadCount:i}}function Fs(t,e,s,n=!0){const{timestampRead:r,unreadCount:a}=js(e,s,t.timestampRead,t.unreadCount),i=Ns(e[e.length-1]),o=i.timestamp;return{...t,ownerId:s,entryType:Ot.particle,disabled:!1,unreadCount:a,meta:{...i,timestamp:o},timestampRead:r,timestampUpdate:n?o:t.timestampUpdate}}const Hs=t=>t instanceof DOMException&&"AbortError"===t.name;var Zs=s(80833),Qs=s(16899),Ws=s(96371),Gs=s(25108);var Vs=class extends qs{constructor(t,e,s,n,{warmupMs:r}={warmupMs:0}){super(t,s,n);const{loop$:a,restartLoop:i}=((t,e,s={})=>{const{intervalMs:n,warmupMs:r=0,onStartInterval:a,onError:i,retryDelayMs:o=0,onChange:c}=s,u=new ke.x,d=u.pipe((0,Is.O)(null),(0,Ms.w)((()=>(0,yt.F)(n).pipe((0,Is.O)(0),(0,Zs.g)(r)))));return{loop$:Us(t,d.pipe((0,Bt.b)((()=>a&&a())),(0,Qs.z)((()=>e.pipe((0,Ws.X)({delay:t=>(Gs.log("retry",t),i&&i(t),(0,yt.F)(o))}))))),(t=>c?.(t))),restartLoop:()=>{u.next()}}})(this.isInitialized$,(0,Ge.P)((()=>(0,Ve.D)(this.doSync()))),{intervalMs:e,warmupMs:r,onError:e=>{this.cyblogCh.info(`>>> ${t} error`,e.toString()),this.statusApi.sendStatus("error",e.toString())},onChange:e=>{this.cyblogCh.info(`>>> ${t} initialized: ${e}`),this.statusApi.sendStatus(e?"initialized":"inactive")}});this.loop$=a,this.restartLoop=i}restart(){this.abortController?.abort(),this.restartLoop?.(),this.cyblogCh.info(`>>> ${this.name} loop restart`)}start(){return this.loop$.subscribe((()=>this.statusApi.sendStatus("active"))),this}async doSync(){const t=(0,kt.d9v)(this.params);this.initAbortController();try{await this.sync(t)}catch(e){const s=Hs(e);if(this.cyblogCh.info(`>>> ${this.name} ${t.myAddress} sync error [abrt:${s}]:`,{error:e}),!s)throw e}}};var Xs=class extends Vs{createIsInitializedObserver(t){return(0,bt.a)([t.dbInstance$,t.ipfsInstance$,t.params$.pipe((0,wt.U)((t=>t.myAddress)),(0,We.x)()),this.particlesResolver.isInitialized$]).pipe((0,wt.U)((([t,e,s,n])=>!!(e&&t&&n&&s))))}async sync(t){const{myAddress:e}=t,{signal:s}=this.abortController;this.statusApi.sendStatus("estimating");const n=await this.db.findSyncStatus({ownerId:e,entryType:Ot.particle}),r=n.at(0)?.timestampUpdate||0,a=await(async(t,e,s,n)=>{const r=await Ss(n).request(as,{address:t,particles_from:e,timestamp:(0,Ke.gB)(s)});return r.cyberlinks_aggregate.aggregate?.count})(e,[ge],r,s);if(this.cyblogCh.info(`>>> syncMyParticles ${e} count ${a}`),this.progressTracker.start(a+n.length),this.statusApi.sendStatus("in-progress","preparing...",this.progressTracker.progress),a>0){const t=await this.fetchNewTweets(e,r,s);n.push(...t)}await this.syncParticles(e,n,s)}async fetchNewTweets(t,e,s){const n=await Cs(t,[ge],e,200,this.abortController?.signal),r=[],a=await this.db.findSyncStatus({ownerId:t,entryType:Ot.particle}),i=new Map(a.map((t=>[t.id,t])));for await(const e of n){this.statusApi.sendStatus("in-progress","fetching new tweets...",this.progressTracker.trackProgress(1));const n=e.map(Ns).map((e=>{const{timestamp:s,to:n}=e,r=(0,Ke.VE)(s),a=i.get(n)?(0,Ke.VE)(s):0;return{ownerId:t,id:n,entryType:Ot.particle,timestampUpdate:a,timestampRead:r,unreadCount:0,disabled:!1,meta:{...e,timestamp:r}}}));n.length>0&&(await ts(this.db.putSyncStatus,s)(n),r.push(...n))}return r}async syncParticles(t,e,s){const n=[];for(const r of e){const{id:e,timestampUpdate:a}=r;this.statusApi.sendStatus("in-progress","fetching tweet updates...",this.progressTracker.trackProgress(1));const i=await As(e,a,this.particlesResolver,Dt.MEDIUM,this.abortController?.signal);if(i.length>0){const e=i.map(Je);await me(e,(t=>ts(this.db.putCyberlinks,s)(t)),500);const a=Fs(r,e,t);n.push(a)}}n.length>0&&await ts(this.db.putSyncStatus,s)(n),this.channelApi.postSenseUpdate(n)}};var Ks=class extends Vs{constructor(t,e,s,n,{warmupMs:r}={warmupMs:0}){if(!s.followings$)throw new Error("followings$ is required");super(t,e,s,n,{warmupMs:r}),this.followings=[]}createIsInitializedObserver(t){const e=new gt.X(!1);t.params$?.pipe((0,wt.U)((t=>t.myAddress)),(0,We.x)()).subscribe((()=>{e.next(!1)})),t.followings$.subscribe((t=>{this.followings=t,e.next(!0),this.restart()}));return(0,bt.a)([t.dbInstance$,t.params$,this.particlesResolver.isInitialized$,e]).pipe((0,wt.U)((([t,e,s,n])=>!!t&&!!e.myAddress&&!!s&&n)))}async sync(t){const{signal:e}=this.abortController;this.statusApi.sendStatus("in-progress","preparing...");const{myAddress:s}=t,{followings:n}=this;this.statusApi.sendStatus("estimating"),this.cyblogCh.info(`>>> syncMyFriends ${s} count ${n.length}`,{unit:"friends-sync",data:n}),this.progressTracker.start(n.length),this.statusApi.sendStatus("in-progress","sync...",this.progressTracker.progress);for(const t of n)await this.syncLinks(s,t,e)}async syncLinks(t,e,s){let n=[];try{this.statusApi.sendStatus("in-progress",`starting sync ${e}...`,this.progressTracker.progress);const{timestampRead:r,unreadCount:a,meta:i}=await this.db.getSyncStatus(t,e),{timestampUpdateChat:o=0,timestampUpdateContent:c=0}=i||{},u=c+1,d=await Cs(e,fe,u,200,s);for await(const i of d){this.statusApi.sendStatus("in-progress",`sync ${e}...`,this.progressTracker.trackProgress(1));const c=i.map(Je),{timestampRead:u,unreadCount:d}=js(c,t,r,a);if(c.length>0){const r=Ns(c.at(-1)),a=r.timestamp;await ts(this.db.putCyberlinks,s)(c);const i=c.map((t=>t.to));await this.particlesResolver.enqueueBatch(i,Ut.particle,Dt.HIGH);const l={ownerId:t,entryType:Ot.chat,id:e,timestampUpdate:Math.max(a,o),unreadCount:d,timestampRead:u,disabled:!1,meta:{...r,timestampUpdateContent:a,timestampUpdateChat:o}};await ts(this.db.putSyncStatus,s)(l),n.push(l)}}}catch(t){if(this.cyblogCh.error(`>>> SyncMyFriends ${e} error`,{error:t}),Hs(t))throw n=[],t;this.statusApi.sendStatus("error",t.toString())}finally{this.channelApi.postSenseUpdate(n)}}},Ys=s(51573),Js=s(71257);s(25108);const tn=(0,Rs.B)({thread:"bckd",unit:"fetchStoredSyncCommunity"}),en=(t,e,s,n)=>new It.y((r=>{r.next({action:"reset",items:[]}),(async()=>{const a=await t.getCommunity(e);r.next({action:"add",items:a});const i=new Map(a.map((t=>[t.particle,t]))),o=t=>i.get(t)||{ownerId:e,name:"",following:!1,follower:!1},c=await(async(t,e)=>{const s=await(0,Js.Z)({method:"get",url:`${es.j9}/txs?cyberlink.neuron=${t}&cyberlink.particleFrom=${ye}&limit=1000000000`,signal:e});return s.data.txs?s.data.txs.map((t=>t.tx.value.msg[0].value.links[0].to)):[]})(e,n),u=await(async(t,e)=>{const s=await(0,Ys.Uy)(t),n=await(0,Js.Z)({method:"get",url:`${es.j9}/txs?cyberlink.particleFrom=${ye}&cyberlink.particleTo=${s}&limit=1000000000`,signal:e});return n.data.txs?n.data.txs.map((t=>t.tx.value.msg[0].value.neuron)):[]})(e,n),d=c.filter((t=>!a.some((e=>e.particle===t&&e.following)))),l=u.filter((t=>!a.some((e=>e.neuron===t&&e.follower))));tn.info(`>>>$ sync community ${e} processing, stored ${a.length} new followers: ${d.length} new following: ${l.length}`);const p=await Promise.all(l.map((async e=>{const s=await(0,Ys.Uy)(e),n={...o(s),particle:s,neuron:e,follower:!0};return await t.putCommunity(n),i.set(s,n),n})));r.next({action:"add",items:p}),await Promise.all(d.map((async e=>{const n=(await s(e,Dt.URGENT))?.result?.textPreview;if(n&&n.match(z.$T)){const s={...o(e),neuron:n,particle:e,following:!0};await t.putCommunity(s),i.set(e,s),r.next({action:"add",items:[s]})}}))),tn.info(`>>>$ sync community ${e}, done`),r.next({action:"complete",items:[]}),r.complete()})().catch((t=>{tn.error(`>>>$ sync community ${e}, error`,{error:t}),r.error(t)}))}));const sn=(0,Rs.B)({thread:"bckd"});class nn{constructor(t,e){this.channelApi=new le,this.loops={};const{dbInstance$:s,ipfsInstance$:n}=t;this.isInitialized$=(0,bt.a)([s,n]).pipe((0,wt.U)((([t,e])=>!!t&&!!e))),this.isInitialized$.subscribe({next:t=>t&&this.channelApi.postServiceStatus("sync","started"),error:t=>this.channelApi.postServiceStatus("sync","error",t)});const r=function(t){const{dbInstance$:e,ipfsInstance$:s,params$:n}=t,r=new le;return(0,bt.a)([e,n.pipe((0,wt.U)((t=>t.myAddress)),(0,We.x)()),s]).pipe((0,ft.h)((([t,e,s])=>!!t&&!!s&&!!e)),(0,Ms.w)((([e,s,n])=>{const{waitForParticleResolve:a}=t;let i=[];return new It.y((t=>{t.next([]),en(e,s,a).subscribe((({action:e,items:s})=>{r.post({type:"load_community",value:{action:e,items:s}}),"reset"===e?i=[]:["add","complete"].some((t=>t===e))&&i.push(...s),"complete"===e&&(t.next(i),t.complete())}))}))})))}(t);r.subscribe((t=>{sn.info("--\x3e community fetched",{unit:"community",data:t})}));const a=r.pipe((0,wt.U)((t=>t.filter((t=>t.following)))),(0,wt.U)((t=>t.map((t=>t.neuron)))));new Bs("transactions",t,e).start(),new Xs("particles",3e5,t,e).start(),new Ks("my-friends",3e5,{...t,followings$:a},e).start()}restart(t){this.loops[t]?.restart()}}var rn=s(25108);var an=class{constructor(t,e){this.channel=new BroadcastChannel(de),this.particlesResolver=t,this.dbInstance$=e,this.channel.onmessage=t=>this.onMessage(t),this.channel.onmessageerror=t=>rn.error(`${de} error`,t)}async getDeffredDbApi(){return new Promise((t=>{const e=this.dbInstance$.getValue();e&&t(e),this.dbInstance$.pipe((0,zt.P)((t=>void 0!==t))).subscribe((e=>{t(e)}))}))}async saveLinks(t){const e=await this.getDeffredDbApi();await e.putCyberlinks(t)}async saveParticles(t){try{const e=await this.getDeffredDbApi(),s=(t=>{const{cid:e,meta:s,textPreview:n}=t,{size:r,mime:a,type:i,blocks:o,sizeLocal:c}=s;var u;return{cid:e,size:r||0,mime:a||"unknown",type:i,text:n?(u=function(t){let e=t.replace(/^#{1,6}\s+/gm,"");return e=e.replace(/(\*\*|__)(.*?)\1/g,"$2"),e=e.replace(/(\*|_)(.*?)\1/g,"$2"),e=e.replace(/(~~)(.*?)\1/g,"$2"),e=e.replace(/`{1,3}[^`](.*?)`{1,3}/g,"$1"),e=e.replace(/```[\s\S]*?```/g,""),e=e.replace(/^\s{0,3}>\s?/gm,""),e=e.replace(/\[(.*?)\]\(.*?\)/g,"$1"),e=e.replace(/!\[(.*?)\]\(.*?\)/g,"$1"),e=e.replace(/^-{3,}$/gm,""),e=e.replace(/^\s*[-+*]\s+/gm,""),e=e.replace(/^\s*\d+\.\s+/gm,""),e=e.replace(/\n{2,}/g,"\n\n"),e=e.replace(/^\s+|\s+$/g,""),e}(n),u.replace(/"/g,"'")):"",size_local:c||-1,blocks:o||0}})(t);(await e.putParticles(s)).ok&&await $e(t)}catch(e){throw rn.log("---saveParticle e",t,t.textPreview,e.toString()),e}}async enquueSync(t){await this.getDeffredDbApi(),this.particlesResolver.enqueue(Array.isArray(t)?t:[t])}onMessage(t){const{type:e,data:s}=t.data;"link"===e?this.saveLinks(s):"particle"===e?this.saveParticles(s):"sync"===e&&this.enquueSync(s)}},on=s(25108);Ie.OBj.allowLocalModels=!1;const cn={featureExtractor:{name:"feature-extraction",model:"Xenova/all-MiniLM-L6-v2"}},un=(()=>{const t=new gt.X(void 0),e=new ke.x,s=new gt.X(void 0),r=new gt.X({myAddress:null});let a,i;const o={},c=new ke.x;t.subscribe((t=>{i=t}));const u=new Pe(s,{runeInstance$:e}),d=new le,l=async t=>{if(!o[t]){const e=cn[t];return(0,Ie.EUT)(e.name,e.model,{progress_callback:s=>{try{const{status:n,progress:r,loaded:a,total:i}=s,o=a?`${e.model} - ${a}/${i} bytes`:e.model,c={status:n,message:o,done:["ready","error"].some((t=>t===n))};r&&(c.progress=Math.round(r)),d.postMlSyncEntryProgress(t,c)}catch(e){on.log("-------progresss error",t,e.toString())}}}).then((e=>(on.log("----model",t,typeof e),c.next(f),o[t]=e,e)))}return on.log(`${t} - already loaded`),c.next(f),o[t]},p={waitForParticleResolve:async(t,e=Dt.MEDIUM)=>u.enqueueAndWait(t,{postProcessing:!1,priority:e}),dbInstance$:t,ipfsInstance$:s,getEmbeddingInstance$:c,params$:r},m=new ve(p).start(),h=(new an(m,t),new nn(p,m)),g=async()=>(d.postServiceStatus("ml","starting"),Promise.all([l("featureExtractor")]).then((t=>(on.log("-----------init ml",t),d.postServiceStatus("ml","started"),t))).catch((t=>d.postServiceStatus("ml","error",t.toString())))),y=async t=>{d.postServiceStatus("rune","starting"),await Be.load(t).then((()=>{Le.Z.setInternalDeps({rune:Be}),d.postServiceStatus("rune","started")})).catch((t=>d.postServiceStatus("rune","error",t.toString()))),e.next(Be)},f=async t=>(await o.featureExtractor(t,{pooling:"mean",normalize:!0})).data,b={getEmbedding:f,searchByEmbedding:async(t,e)=>{const s=await f(t);return await i.searchByEmbedding(s,e)}},w={start:async t=>{try{return a&&(on.log("Ipfs node already started!"),await a.stop()),d.postServiceStatus("ipfs","starting"),a=await ht(t),s.next(a),setTimeout((()=>d.postServiceStatus("ipfs","started")),0),!0}catch(t){on.log("----ipfs node init error ",t);const e=t instanceof Error?t.message:t;throw d.postServiceStatus("ipfs","error",e),Error(e)}},stop:async()=>{a&&await a.stop(),s.next(void 0),d.postServiceStatus("ipfs","inactive")},getIpfsNode:async()=>a&&(0,n.sj)(a),config:async()=>a?.config,info:async()=>a?.info(),fetchWithDetails:async(t,e,s)=>{if(!a)throw new Error("ipfs node not initialized");return a.fetchWithDetails(t,e,s)},enqueue:async(t,e,s)=>u.enqueue(t,e,s),enqueueAndWait:async(t,e)=>u.enqueueAndWait(t,e),dequeue:async t=>u.cancel(t),dequeueByParent:async t=>u.cancelByParent(t),clearQueue:async()=>u.clear(),addContent:async t=>a?.addContent(t)};return Le.Z.setInternalDeps({ipfsApi:w,mlApi:b}),{init:async(e,s)=>{t.next(e),Promise.all([g(),y(s)])},isInitialized:()=>!!s.value,ipfsApi:(0,n.sj)(w),rune:(0,n.sj)(Be),mlApi:(0,n.sj)(b),ipfsQueue:(0,n.sj)(u),restartSync:t=>h.restart(t),setParams:t=>r.next({...r.value,...t})}})();var dn,ln;dn=self,ln=un,Ze(),void 0!==dn.onconnect?dn.onconnect=t=>{const e=t.ports[0];Qe(e),(0,n.Jj)(ln,e)}:(0,n.Jj)(ln)},34958:function(t,e,s){"use strict";s.d(e,{u:function(){return a}});var n=s(93994).Z;class r extends Error{constructor(t){let e="",s=-1;t instanceof Array?e=t.join("\r\n"):t.rawLog?(e=t.rawLog.toString(),s=t.code):e=e?.error,super(e),n.error(e,{error:t}),this.code=s}}const a=t=>{if(t instanceof Array||0!==t.code)throw new r(t);return t}},76892:function(t,e,s){"use strict";s.d(e,{xh:function(){return o}});var n=s(21466),r=s(67937),a=s(34958);s(82455);const i={amount:[],gas:r.ex.toString()},o=async(t,e,s,{senseApi:r,signingClient:o},c=i)=>{const u=await o.cyberlink(t,e,s,c),d=(0,a.u)(u),{transactionHash:l}=d,p={from:e,to:s,transactionHash:l,timestamp:(0,n.qQ)(),neuron:t};return await(r?.putCyberlink(p)),await(r?.addCyberlinkLocal(p)),l}},5662:function(t,e,s){"use strict";function n(t){const{script:e,markdown:s,hasRune:n}=function(t){const e=/```rune\s*([\s\S]*?)```/g;let s,n="",r=t,a=!1;for(;null!==(s=e.exec(t));)a=!0,n+=s[1]+"\n",r=r.replace(s[0],"");return{script:n.trim(),markdown:r,hasRune:a}}(t);return n?e:s}s.d(e,{P6:function(){return n}})},60666:function(t,e,s){"use strict";var n=s(86515),r=s(95196),a=s(6970),i=s(67937),o=s(9385),c=s(82455),u=s(76892),d=s(5662);const l=(()=>{const t={ipfsApi:new n.X(void 0),rune:new n.X(void 0),queryClient:new n.X(void 0),mlApi:new n.X(void 0),signingClient:new n.X(void 0),senseApi:new n.X(void 0),address:new n.X(void 0)},e=e=>new Promise((s=>{const n=t[e];n.getValue()&&s(n.getValue()),n.pipe((0,r.P)((t=>void 0!==t))).subscribe((t=>{s(t)}))}));(async()=>{const e=await a.CyberClient.connect(i.$G);t.queryClient?.next(e)})();const s=async t=>(await e("ipfsApi")).fetchWithDetails(t,"text");return{setExternalDeps:e=>{Object.keys(e).filter((t=>void 0!==e[t])).forEach((s=>{const n=e[s];t[s].next(n)}))},setInternalDeps:e=>{Object.keys(e).filter((t=>void 0!==e[t])).forEach((s=>{const n=e[s];t[s].next(n)}))},cybApi:{graphSearch:async(t,s=0)=>{const n=await e("queryClient"),r=await(0,o.uP)(t);return(0,o.ae)(n,r,s)},cyberlink:async(s,n)=>{const r=t.address.getValue();if(!r)throw new Error("Connect your wallet first");const a=await e("senseApi"),i=await e("signingClient");return(0,u.xh)(r,s,n,{senseApi:a,signingClient:i})},getPassportByNickname:async t=>{const s=await e("queryClient");return await(0,c.FT)(s,t)},searcByEmbedding:async(t,s=10)=>(await e("mlApi")).searchByEmbedding(t,s),evalScriptFromIpfs:async(t,n,r={})=>{try{const a=await s(t);if(void 0===a?.content)return{action:"error",message:"Particle not found"};const i=(0,d.P6)(a.content);return(await e("rune")).executeFunction(i,n,r)}catch(t){return{action:"error",message:t.toString()}}},getIpfsTextConent:s,addContenToIpfs:async t=>(await e("ipfsApi")).addContent(t),executeScriptCallback:async(t,s={})=>{try{return(await e("rune")).executeCallback(t,s)}catch(t){return{action:"error",message:t.toString()}}}}}})();e.Z=l},81286:function(t,e,s){"use strict";s.d(e,{ZT:function(){return m},yF:function(){return u},D_:function(){return y},eU:function(){return f},rB:function(){return c},gd:function(){return l},YQ:function(){return p},Mv:function(){return d},n1:function(){return h},v$:function(){return g}});var n=s(9385),r=s(60666),a=s(71257),i=s(25108);const o=async(t,e,s={model:"text-davinci-003",maxTokens:500,stop:".",n:1})=>{const n=await a.Z.post("https://api.openai.com/v1/completions",{prompt:t,...s},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});return i.log("response",n),n.data.choices[0].text};s(25108);async function c(t){return r.Z.cybApi.graphSearch(t)}async function u(t,e){return r.Z.cybApi.cyberlink(t,e)}async function d(t){return r.Z.cybApi.getPassportByNickname(t)}async function l(t,e,s={}){return r.Z.cybApi.evalScriptFromIpfs(t,e,s)}async function p(t){return r.Z.getIpfsTextConent(t)}async function m(t){return r.Z.addContenToIpfs(t)}async function h(t,e,s){return await o(t,e,s)}async function g(t,e){return r.Z.cybApi.searcByEmbedding(t,e)}async function y(t){return await(0,n.Aw)(t)}async function f(t){return await(0,n.wt)(t)}},85607:function(t,e,s){"use strict";s.d(e,{p:function(){return n}});var n=(t=>(t.BOSTROM="bostrom",t.SPACE_PUSSY="space-pussy",t.ETH="eth",t.OSMO="osmo",t.TERRA="terra",t.COSMOS="cosmoshub-4",t))(n||{})},26720:function(t,e,s){"use strict";s.d(e,{fE:function(){return n}});const n={STAGE_TWEET_ACTION_BAR:{ADD_AVATAR:"addAvatar",FOLLOW:"follow",TWEET:"tweet"}}},21466:function(t,e,s){"use strict";s.d(e,{VE:function(){return i},gB:function(){return a},qQ:function(){return o}});var n=s(48116),r=s.n(n);const a=t=>r()(new Date(t),'yyyy-mm-dd"T"HH:MM:ss.l',!0),i=t=>Date.parse(t.endsWith("Z")?t:`${t}Z`),o=()=>Date.now()},51573:function(t,e,s){"use strict";s.d(e,{Uy:function(){return o}});var n=s(89862),r=s.n(n),a=s(6581),i=(s(96486),s(66392),s(23085).lW);const o=t=>new Promise(((e,s)=>{const n=new(r())("file",i.from(t)).marshal();a.DAGNode.create(n,((t,n)=>{t&&s(new Error("Cannot create ipfs DAGNode")),a.util.cid(n,((t,s)=>{e(s.toBaseEncodedString())}))}))}))},96407:function(t,e,s){"use strict";s.d(e,{bG:function(){return n}});const n="CYBLOG_BROADCST_CHANNEL"},93994:function(t,e,s){"use strict";s.d(e,{B:function(){return c}});var n=s(96486),r=s.n(n),a=s(96407),i=s(25108);const o=[];const c=(t={})=>{const e=new BroadcastChannel(a.bG);function s(s,n,r){const a={...t,...r};r?.error&&(a.error=JSON.stringify(r.error)),e.postMessage({type:"log",value:{level:s,message:n,context:a}})}return{info:function(t,e){return s("info",t,e)},error:function(t,e){return s("error",t,e)},warn:function(t,e){return s("warn",t,e)},trace:function(t,e){return s("warn",t,e)}}},u=function(t={}){let e={};function s(s,a,c=t){try{const t=c?.formatter?c?.formatter(a):a;!function(t,e=!0){for(o.push(t);e&&o.length>1e3;)o.shift()}({timestamp:new Date,level:s,message:t,stacktrace:c?.stacktrace,context:r().omit(c,["formatter","stacktrace"])});Object.keys(e).reduce(((t,s)=>{const n=e[s],r=c[s];return n&&r?t||"all"===n||0===n.length||n.some((t=>t===r)):t}),!1)&&function(t,e,s){const a=r().omit(s,["formatter","thread","module","unit","data"]),{thread:o="",module:c="",unit:u="",data:d=""}=s,l=(0,n.isEmpty)(a)?"":a;Array.isArray(e)?i[t](...e,l):s?.formatter?i[t](s?.formatter(e),l):i[t](`[${o}:${c}:${u}] ${e}`,d,l)}(s,a,c)}catch(t){i.log("cyblog error",t)}}return new BroadcastChannel(a.bG).onmessage=t=>{"params"===t.data.type&&(e={...e,...t.data.value})},{log:s,info:function(t,e){return s("info",t,e)},error:function(t,e){return s("error",t,e)},warn:function(t,e){return s("warn",t,e)},trace:function(t,e){return s("warn",t,e)},logList:o,getLogs:()=>o.map((t=>{const{context:e,...s}=t,{unit:n="",module:r="",thread:a="",data:i="",error:o="",stacktrace:c=""}=e||{};return{...s,unit:n,module:r,thread:a,data:i,error:o,stacktrace:c}})),clear:()=>o.splice(0,o.length),getConsoleLogParams:()=>e}}({thread:"main"});e.Z=u},9385:function(t,e,s){"use strict";s.d(e,{Aw:function(){return l},ae:function(){return h},uP:function(){return m},wt:function(){return p}});var n=s(71257),r=s(67937),a=s(6998),i=s(66392),o=s(51573),c=s(41360),u=s(25108);const d=async(t,e=a.c.from,{offset:s,limit:i,order:o="ORDER_BY_DESC"})=>{try{return(await(0,n.Z)({method:"get",url:`${r.j9}/cosmos/tx/v1beta1/txs`,params:{"pagination.offset":s,"pagination.limit":i,orderBy:"ORDER_BY_DESC",events:`cyberlink.particle${e===a.c.to?"To":"From"}='${t}'`}})).data}catch(t){return u.log(t),null}},l=async(t,e,s)=>d(t,a.c.from,{offset:e,limit:s}),p=async(t,e,s)=>d(t,a.c.to,{offset:e,limit:s});const m=async t=>t.match(i.fo)?t:(0,o.Uy)((0,c.lG)(t)),h=async(t,e,s)=>{try{return await t.search(e,s)}catch(t){return void u.error(t)}}},41360:function(t,e,s){"use strict";s.d(e,{lG:function(){return n}});s(92882),s(28972),s(79562),s(905),s(67937),s(26720),s(11450),s(33156),s(72717),s(25108),s(23085).lW;const n=t=>t.replace(/%2F/g,"/")},72717:function(t,e,s){"use strict";t.exports=s.p+"large-green.3c95bb997b.png"},33156:function(t,e,s){"use strict";t.exports=s.p+"large-orange-circle.b531e8352d.png"},11450:function(t,e,s){"use strict";t.exports=s.p+"large-purple-circle.23506e149e.png"},67064:function(){},81949:function(){},95856:function(){},35883:function(){},50495:function(){},27147:function(){},31418:function(){},68741:function(){},70319:function(){},78386:function(){},73342:function(){},95926:function(){},80950:function(){},46601:function(){},89214:function(){},96419:function(){},56353:function(){},8623:function(){},7748:function(){},85568:function(){},69386:function(){},31616:function(){},66778:function(){},10465:function(){},52596:function(){},63897:function(){},85104:function(){},83886:function(){},52:function(){},75992:function(){},78110:function(){},56619:function(){},25819:function(){},77108:function(){},81265:function(){},35539:function(){},99283:function(){},43838:function(){},69862:function(){},40964:function(){}},a={};function i(t){var e=a[t];if(void 0!==e)return e.exports;var s=a[t]={id:t,loaded:!1,exports:{}};return r[t].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=r,i.x=function(){var t=i.O(void 0,[86,759,515,805,746,356,958],(function(){return i(69898)}));return t=i.O(t)},i.amdO={},t=[],i.O=function(e,s,n,r){if(!s){var a=1/0;for(d=0;d<t.length;d++){s=t[d][0],n=t[d][1],r=t[d][2];for(var o=!0,c=0;c<s.length;c++)(!1&r||a>=r)&&Object.keys(i.O).every((function(t){return i.O[t](s[c])}))?s.splice(c--,1):(o=!1,r<a&&(a=r));if(o){t.splice(d--,1);var u=n();void 0!==u&&(e=u)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[s,n,r]},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},s=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},i.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var r=Object.create(null);i.r(r);var a={};e=e||[null,s({}),s([]),s(s)];for(var o=2&n&&t;"object"==typeof o&&!~e.indexOf(o);o=s(o))Object.getOwnPropertyNames(o).forEach((function(e){a[e]=function(){return t[e]}}));return a.default=function(){return t},i.d(r,a),r},i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.f={},i.e=function(t){return Promise.all(Object.keys(i.f).reduce((function(e,s){return i.f[s](t,e),e}),[]))},i.u=function(t){return 86===t?"86.05371e7e.js":759===t?"759.65936a36.js":515===t?"515.250357b9.js":t+"."+{356:"cf28752a",746:"35674002",805:"592ce063",827:"75086733",958:"72563390"}[t]+".chunk.js"},i.miniCssF=function(t){},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.hmd=function(t){return(t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},i.p="/",function(){i.b=self.location+"";var t={466:1};i.f.i=function(e,s){t[e]||importScripts(i.p+i.u(e))};var e=self.webpackChunkcyb=self.webpackChunkcyb||[],s=e.push.bind(e);e.push=function(e){var n=e[0],r=e[1],a=e[2];for(var o in r)i.o(r,o)&&(i.m[o]=r[o]);for(a&&a(i);n.length;)t[n.pop()]=1;s(e)}}(),n=i.x,i.x=function(){return Promise.all([86,759,515,805,746,356,958].map(i.e,i)).then(n)};i.x()}();
//# sourceMappingURL=466.53de2ebd.chunk.js.map